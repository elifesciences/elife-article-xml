<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">97543</article-id><article-id pub-id-type="doi">10.7554/eLife.97543</article-id><article-id pub-id-type="doi" specific-use="version">10.7554/eLife.97543.4</article-id><article-version article-version-type="publication-state">version of record</article-version><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Microbiology and Infectious Disease</subject></subj-group></article-categories><title-group><article-title>An improved bacterial single-cell RNA-seq reveals biofilm heterogeneity</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes"><name><surname>Yan</surname><given-names>Xiaodan</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0009-0000-7367-1567</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Liao</surname><given-names>Hebin</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Wang</surname><given-names>Chenyi</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Huang</surname><given-names>Chun</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Zhang</surname><given-names>Wei</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Guo</surname><given-names>Chunming</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Pu</surname><given-names>Yingying</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5735-8199</contrib-id><email>yingyingpu@whu.edu.cn</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/033vjfk17</institution-id><institution>The State Key Laboratory Breeding Base of Basic Science of Stomatology &amp; Key Laboratory of Oral Biomedicine Ministry of Education, School &amp; Hospital of Stomatology, Medical Research Institute, Wuhan University</institution></institution-wrap><addr-line><named-content content-type="city">Wuhan</named-content></addr-line><country>China</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/033vjfk17</institution-id><institution>Frontier Science Center for Immunology and Metabolism, Wuhan University</institution></institution-wrap><addr-line><named-content content-type="city">Wuhan</named-content></addr-line><country>China</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05k3sdc46</institution-id><institution>Translational Medicine Research Center, North Sichuan Medical College</institution></institution-wrap><addr-line><named-content content-type="city">Nanchong</named-content></addr-line><country>China</country></aff><aff id="aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0040axw97</institution-id><institution>Center for Life Sciences, School of Life Sciences, Yunnan University</institution></institution-wrap><addr-line><named-content content-type="city">Kunming</named-content></addr-line><country>China</country></aff><aff id="aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05sqd2v93</institution-id><institution>Department of Immunology, Hubei Province Key Laboratory of Allergy and Immunology, State Key Laboratory of Virology and Medical Research Institute, Wuhan University School of Basic Medical Sciences</institution></institution-wrap><addr-line><named-content content-type="city">Wuhan</named-content></addr-line><country>China</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Soldati-Favre</surname><given-names>Dominique</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01swzsf04</institution-id><institution>University of Geneva</institution></institution-wrap><country>Switzerland</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Soldati-Favre</surname><given-names>Dominique</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01swzsf04</institution-id><institution>University of Geneva</institution></institution-wrap><country>Switzerland</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date publication-format="electronic" date-type="publication"><day>17</day><month>12</month><year>2024</year></pub-date><volume>13</volume><elocation-id>RP97543</elocation-id><history><date date-type="sent-for-review" iso-8601-date="2024-03-26"><day>26</day><month>03</month><year>2024</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint.</event-desc><date date-type="preprint" iso-8601-date="2023-10-03"><day>03</day><month>10</month><year>2023</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.21203/rs.3.rs-3329601/v1"/></event><event><event-desc>This manuscript was published as a reviewed preprint.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-07-24"><day>24</day><month>07</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.97543.1"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-11-15"><day>15</day><month>11</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.97543.2"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-11-26"><day>26</day><month>11</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.97543.3"/></event></pub-history><permissions><copyright-statement>© 2024, Yan, Liao et al</copyright-statement><copyright-year>2024</copyright-year><copyright-holder>Yan, Liao et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-97543-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-97543-figures-v1.pdf"/><abstract><p>In contrast to mammalian cells, bacterial cells lack mRNA polyadenylated tails, presenting a hurdle in isolating mRNA amidst the prevalent rRNA during single-cell RNA-seq. This study introduces a novel method, ribosomal RNA-derived cDNA depletion (RiboD), seamlessly integrated into the PETRI-seq technique, yielding RiboD-PETRI. This innovative approach offers a cost-effective, equipment-free, and high-throughput solution for bacterial single-cell RNA sequencing (scRNA-seq). By efficiently eliminating rRNA reads and substantially enhancing mRNA detection rates (up to 92%), our method enables precise exploration of bacterial population heterogeneity. Applying RiboD-PETRI to investigate biofilm heterogeneity, distinctive subpopulations marked by unique genes within biofilms were successfully identified. Notably, PdeI, a marker for the cell-surface attachment subpopulation, was observed to elevate cyclic diguanylate (c-di-GMP) levels, promoting persister cell formation. Thus, we address a persistent challenge in bacterial single-cell RNA-seq regarding rRNA abundance, exemplifying the utility of this method in exploring biofilm heterogeneity. Our method effectively tackles a long-standing issue in bacterial scRNA-seq: the overwhelming abundance of rRNA. This advancement significantly enhances our ability to investigate the intricate heterogeneity within biofilms at unprecedented resolution.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>bacterial scRNA-seq</kwd><kwd>biofilms</kwd><kwd>heterogeneity</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Bacterial scRNA-seq</kwd><kwd>Biofilms</kwd><kwd>Heterogeneity</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id><institution>National Natural Science Foundation of China</institution></institution-wrap></funding-source><award-id>31970089</award-id><principal-award-recipient><name><surname>Pu</surname><given-names>Yingying</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100012166</institution-id><institution>National Key Research and Development Program of China</institution></institution-wrap></funding-source><award-id>2021YFC2701602</award-id><principal-award-recipient><name><surname>Pu</surname><given-names>Yingying</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100019092</institution-id><institution>Science Fund for Distinguished Young Scholars of Hunan Province</institution></institution-wrap></funding-source><award-id>2022CFA077</award-id><principal-award-recipient><name><surname>Pu</surname><given-names>Yingying</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100012226</institution-id><institution>Fundamental Research Funds for the Central Universities</institution></institution-wrap></funding-source><award-id>2042022dx0003</award-id><principal-award-recipient><name><surname>Pu</surname><given-names>Yingying</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution>Major Project of Guangzhou National Laboratory</institution></institution-wrap></funding-source><award-id>GZNL2024A01023</award-id><principal-award-recipient><name><surname>Pu</surname><given-names>Yingying</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100005273</institution-id><institution>Natural Science Foundation of Yunnan Province</institution></institution-wrap></funding-source><award-id>202001BB050005</award-id><principal-award-recipient><name><surname>Guo</surname><given-names>Chunming</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>RiboD-PETRI, a cost-effective, equipment-free plate-based scRNA-seq technique that integrates a unique bacterial rRNA depletion protocol, significantly enhancing mRNA detection rate and revealing within-population heterogeneity, offering valuable insights for research applications.</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>publishing-route</meta-name><meta-value>prc</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Biofilms, contributing to approximately 80% of chronic and recurrent microbial infections in the human body (<xref ref-type="bibr" rid="bib3">Costerton et al., 1999</xref>), are complex microbial ecosystems characterized by a diverse array of bacterial cells existing in various physiological states (<xref ref-type="bibr" rid="bib3">Costerton et al., 1999</xref>; <xref ref-type="bibr" rid="bib4">Evans et al., 2023</xref>; <xref ref-type="bibr" rid="bib28">Stewart and Franklin, 2008</xref>). This heterogeneity within biofilms is influenced by multiple factors, including bacterial interactions (such as competition, symbiosis, and parasitism) that contribute to stable community structures (<xref ref-type="bibr" rid="bib5">Flemming et al., 2023</xref>; <xref ref-type="bibr" rid="bib26">Shokeen et al., 2021</xref>), environmental factors (like host environment, aquatic conditions, and nutrient concentrations), and spatial organization. Bacteria occupying different positions within the biofilm perform distinct roles (<xref ref-type="bibr" rid="bib23">Qian et al., 2022</xref>): some mediate material exchange between cells and with the extracellular matrix, others facilitate complex communication systems between bacteria and with the host through signaling molecules, while certain bacteria participate in various energy conversion processes. This intricate division of labor not only contributes to bacterial heterogeneity but also enhances the biofilm’s overall resistance to various stresses (<xref ref-type="bibr" rid="bib21">Momeni, 2018</xref>). The resulting cellular and functional diversity reflects the complex nature of the biofilm ecosystem, allowing it to adapt and persist in challenging environments. However, the study of biofilms faces significant limitations, primarily stemming from challenges in investigating heterogeneity within a bacterial population (<xref ref-type="bibr" rid="bib2">Cheng et al., 2023</xref>; <xref ref-type="bibr" rid="bib27">Spormann, 2008</xref>). Single-cell RNA-seq emerges as a promising avenue for addressing this heterogeneity (<xref ref-type="bibr" rid="bib25">Shapiro et al., 2013</xref>; <xref ref-type="bibr" rid="bib29">Tang et al., 2009</xref>; <xref ref-type="bibr" rid="bib1">Blattman et al., 2020</xref>; <xref ref-type="bibr" rid="bib8">Imdahl et al., 2020</xref>; <xref ref-type="bibr" rid="bib11">Kuchina et al., 2021</xref>; <xref ref-type="bibr" rid="bib17">Ma et al., 2023</xref>; <xref ref-type="bibr" rid="bib31">Wang et al., 2023</xref>; <xref ref-type="bibr" rid="bib19">McNulty et al., 2023</xref>; <xref ref-type="bibr" rid="bib16">Lu et al., 2023</xref>). Expending on established protocols for cell fixation and permeabilization which facilitate in-cell barcoding while avoiding cell lysis, combinatorial barcoding-based bacterial scRNA-seq techniques, such as prokaryotic expression profiling by tagging RNA in situ and sequencing (PETRI-seq) (<xref ref-type="bibr" rid="bib1">Blattman et al., 2020</xref>) and microbial split-pool ligation transcriptomics (microSPLiT) (<xref ref-type="bibr" rid="bib11">Kuchina et al., 2021</xref>), have been developed. Nevertheless, these methods encounter challenges in terms of low transcript recovery rates due to overwhelmingly abundant rRNA, restricting the comprehensive analysis of within-population heterogeneity. In comparison to mammalian cells (<xref ref-type="bibr" rid="bib18">Maynard et al., 2020</xref>), the absence of mRNA polyadenylated tails in bacteria necessitates an alternative approach for isolating mRNA (~5%) from the significantly more abundant rRNA (~95%). Here, by integrating a ribosomal RNA-derived cDNA depletion protocol (RiboD) into a PETRI-seq, we developed RiboD-PETRI-seq that efficiently eliminates rRNA reads, thereby significantly improving mRNA detection rates and enabling exploration of within-population heterogeneity.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>In the RiboD protocol, we designed a set of probe primers that spans all regions of the bacterial rRNA sequence (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). The core principle behind our probe design is twofold: the 3'-end of the probes is reverse complementary to the r-cDNA sequences, allowing for specific recognition of r-cDNA, while the 5'-end complements a biotin-labeled universal primer. This design enables the probes to be bound to magnetic beads, facilitating the separation of r-cDNA-probe-bead complexes from the rest of the library. Following template switching and RNaseH treatment on the barcoded cDNA from lysed cells to eliminate hybridized RNA, the library of probe primers and biotin-labeled universal primers is introduced to facilitate adequate hybridization. Pre-treated Streptavidin magnetic beads are then added to the hybridized rRNA-derived cDNA. The mRNA-derived cDNA remains in the supernatant and is collected for subsequent library construction and sequencing (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). To assess the efficiency of single-cell capture in RiboD-PETRI, we calculated the multiplet frequency (<xref ref-type="bibr" rid="bib1">Blattman et al., 2020</xref>) using a Poisson distribution based on our sequencing results (see details in Materials and methods). The multiplet frequency for RiboD-PETRI ranges from 1.16% to 3.35% (<xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>), indicating the technique’s capability to effectively capture transcriptomes at the single-cell level.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Development of RiboD-PETRI and validation of its technical performance in studying population heterogeneity.</title><p>(<bold>A</bold>) Graphic summary of the RiboD-PETRI method illustrating the incorporation of RiboD after cell pooling and lysis in PETRI-seq. The RiboD protocol is represented by the dashed-line box. In this box, first, we perform template-switching oligonucleotides (TSOs) in the mixture of heterozygous chain, then we remove the RNA strand using RNaseH, at this point the system contains r-cDNA and m-cDNA single-stranded mixture. Then we add the r-cDNA probe, which specifically binds to the r-cDNA. The probes are then bound to magnetic beads, allowing the r-cDNA-probe-bead complexes to be separated from the rest of the library. And then we remove the r-cDNA that is attached to the probe by Streptavidin magnetic beads. We then performed amplification of the libraries and sent them for sequencing. We designed separate probe sets for <italic>Escherichia coli</italic>, <italic>Caulobacter crescentus</italic>, and <italic>Staphylococcus aureus</italic>. Each set was specifically constructed to be reverse complementary to the r-cDNA sequences of its respective bacterial species. This species-specific approach ensures high efficiency and specificity in rRNA depletion for each organism. (<bold>B</bold>) Comparison of non-rRNA (tRNA, mRNA, and other non-rRNA) and rRNA unique molecular identifier (UMI) counts ratio among different bacterial scRNA-seq methods. Data from PETRI-seq (<italic>E. coli</italic>), MicroSPLIT-seq (<italic>E. coli</italic>), M3-seq (<italic>E. coli</italic>) cited from previous studies. Error bars represent standard deviations of biological replicates. The ‘ΔΔ’ label represents the RiboD-PETRI protocol. The ‘Ctrl’ label represents the classic PETRI-seq protocol we performed. (<bold>C</bold>) Comparison of UMI counts per cell between RiboD-PETRI (<xref ref-type="supplementary-material" rid="supp7">Supplementary file 7</xref>) and PETRI (<xref ref-type="supplementary-material" rid="supp8">Supplementary file 8</xref>) at the same unsaturated sequencing depth. (<bold>D</bold>) Assessment of the effect of rRNA depletion on transcriptional profiles. The Pearson correlation coefficient (<bold>r</bold>) of UMI counts per gene (log<sub>2</sub> UMIs) between RiboD-PETRI (<xref ref-type="supplementary-material" rid="supp7">Supplementary file 7</xref>) and PETRI (<xref ref-type="supplementary-material" rid="supp9">Supplementary file 9</xref>) was calculated for 3790 out of 4141 total genes, excluding those with zero counts in either library. Each point represents a gene. (<bold>E</bold>) Evaluation of the correlation between RiboD-PETRI (<xref ref-type="supplementary-material" rid="supp7">Supplementary file 7</xref>) data and bulk RNA-seq (<xref ref-type="supplementary-material" rid="supp10">Supplementary file 10</xref>) results. The Pearson correlation coefficient (<bold>r</bold>) of UMI counts per gene (log<sub>2</sub> UMIs) among RiboD-PETRI data and the reads per gene (log<sub>2</sub> reads) of bulk RNA-seq data was calculated for 3814 out of 4141 total genes, excluding those with zero counts in either library. Each point represents a gene. All data presented in <bold>C, D, E</bold> were from our own sequencing experiments.</p><p><supplementary-material id="fig1scode1"><label>Figure 1—source code 1.</label><caption><title>Related to <xref ref-type="fig" rid="fig1">Figure 1</xref>.</title></caption><media mimetype="application" mime-subtype="zip" xlink:href="elife-97543-fig1-code1-v1.zip"/></supplementary-material></p><p><supplementary-material id="fig1sdata1"><label>Figure 1—source data 1.</label><caption><title>Related to <xref ref-type="fig" rid="fig1">Figure 1</xref>.</title></caption><media mimetype="application" mime-subtype="xls" xlink:href="elife-97543-fig1-data1-v1.xls"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97543-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Supplementary analysis of exponential phase <italic>E. coli</italic> sequencing data.</title><p>(<bold>A, B</bold>) The number of unique molecular identifiers (UMIs) detected per cell in recovered cells in different samples (≥15 UMIs/cell): (<bold>A</bold>) PETRI, (B) RiboD-PETRI at the same unsaturated sequencing depth. The cells are ranked from highest to lowest based on the number of detected UMIs, and cells with ≥15 UMIs are selected for plotting. The median number of UMIs is calculated for these selected cells. (<bold>C</bold>) Scatterplot illustrating the relationship between reads per cell and counts of UMIs per cell detected from exponential phase <italic>E. coli</italic> data. Each dot represents a cell. (<bold>D</bold>) Sequencing saturation of data of exponential period <italic>E. coli</italic> (3 hr). We extracted 20%, 40%, 60%, 80%, and 100% of the data and further tested their saturation using the saturation calculation method of 10x Genomics. (<bold>E and F</bold>) Sequencing saturation analysis. We took 20%, 40%, 60%, 80%, and 100% of the sequencing data for single-cell analysis and counted the number of genes and UMIs for each cell in these data. The cells were then sorted from largest to smallest values, and cells were taken to count the median number of genes (<bold>E</bold>) and UMIs (<bold>F</bold>).</p><p><supplementary-material id="fig1s1scode1"><label>Figure 1—figure supplement 1—source code 1.</label><caption><title>Related to <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>.</title></caption><media mimetype="application" mime-subtype="zip" xlink:href="elife-97543-fig1-figsupp1-code1-v1.zip"/></supplementary-material></p><p><supplementary-material id="fig1s1sdata1"><label>Figure 1—figure supplement 1—source data 1.</label><caption><title>Related to <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>.</title></caption><media mimetype="application" mime-subtype="xls" xlink:href="elife-97543-fig1-figsupp1-data1-v1.xls"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97543-fig1-figsupp1-v1.tif"/></fig></fig-group><p>To assess the performance of RiboD-PETRI, we designed a comprehensive assessment of rRNA depletion efficiency under diverse physiological conditions, specifically contrasting exponential and stationary phases. This approach allows us to understand how these different growth states impact rRNA depletion efficacy. Additionally, we included a variety of bacterial species, encompassing both gram-negative and gram-positive organisms, to ensure that our findings are broadly applicable across different types of bacteria. By incorporating these variables, we aim to provide insights into the robustness and reliability of the RiboD-PETRI method in various biological contexts. The results highlight a substantial enhancement in rRNA-derived cDNA depletion, with mRNA ratio increases from 8.2% (Ctrl, the PETRI-seq we performed) to 81% (ΔΔ, RiboD-PETRI) for <italic>E. coli</italic> from exponential phase, from 10% (Ctrl) to 92% (ΔΔ) for <italic>S. aureus</italic> from stationary phase, and from 3.9% (Ctrl) to 54% (ΔΔ) for <italic>C. crescentus</italic> from exponential phase (<xref ref-type="fig" rid="fig1">Figure 1B</xref>; <xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref>). Additionally, we compared our findings with other reported methods (<xref ref-type="fig" rid="fig1">Figure 1B</xref>; <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>). The original PETRI-seq (<xref ref-type="bibr" rid="bib1">Blattman et al., 2020</xref>) protocol, which does not include an rRNA depletion step, exhibited an mRNA detection rate of approximately 5%. The MicroSPLiT-seq (<xref ref-type="bibr" rid="bib11">Kuchina et al., 2021</xref>) method, which utilizes poly A polymerase for mRNA enrichment, achieved a detection rate of 7%. Similarly, M3-seq (<xref ref-type="bibr" rid="bib31">Wang et al., 2023</xref>) and BacDrop-seq (<xref ref-type="bibr" rid="bib17">Ma et al., 2023</xref>), which employ RNaseH to digest rRNA post-DNA probe hybridization in cells, reported mRNA detection rates of 65% and 61%, respectively. MATQ-DASH (<xref ref-type="bibr" rid="bib7">Homberger et al., 2023</xref>), which utilizes Cas9-mediated targeted rRNA depletion, yielded a detection rate of 30%. smRandom-seq utilizes a CRISPR-based rRNA depletion technique, reduced the rRNA proportion from 83% to 32%, increasing the mRNA proportion from 16% to 63% (<xref ref-type="bibr" rid="bib32">Xu et al., 2023</xref>). BaSSSh-seq’s employs a rational probe design for efficient rRNA depletion, though specific efficiency was not reported (<xref ref-type="bibr" rid="bib9">Korshoj and Kielian, 2024</xref>). Among these, RiboD-PETRI demonstrated superior performance in mRNA detection while requiring the least sequencing depth. With equivalent sequencing depth, RiboD-PETRI demonstrates a significantly enhanced unique molecular identifier (UMI) counts detection rate compared to PETRI-seq alone (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). This method recovered approximately 20,175 cells (92.6% recovery rate) with ≥15 UMIs per cell with a median UMI count of 42 per cell, which was significantly higher than PETRI-seq’s recovery rate of 17.9% with a median UMI count of 20 per cell (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1A and B</xref>), indicating the number of detected mRNA per cell increased prominently. Notably, this enhancement was achieved while maintaining mRNA profiles consistent with non-depleted samples (r=0.93; <xref ref-type="fig" rid="fig1">Figure 1D</xref>) and show a significant correlation with profiles from the traditional bulk RNA-seq method (r=0.84; <xref ref-type="fig" rid="fig1">Figure 1E</xref>).</p><p>We subsequently investigated the transcriptome coverage of RiboD-PETRI across different physiological states and bacterial species. For exponential phase <italic>E. coli</italic> cells, we sequenced a library with 60,000 cells, recovering approximately 30,004 cells (50% recovery), each with ≥15 UMIs (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1C</xref>). This analysis revealed 99.86% transcriptome-wide gene coverage across the cell population. The method achieved an average of 128.8 UMIs per single cell, with a median UMI count of 102 per cell. Further examination of high-quality cells showed varying levels of detection: the top 1000, 5000, and 10,000 cells exhibited median UMI counts of 462, 259, and 193, respectively (<xref ref-type="fig" rid="fig2">Figure 2B</xref>), and median gene detection of 362, 236, and 188, respectively (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). These high-performing cells demonstrate the upper limits of the method’s capabilities. For stationary phase <italic>S. aureus</italic> cells, we sequenced a library with 30,000 cells, recovering approximately 9982 cells (33.3% recovery), each with ≥15 UMIs (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>). Analysis showed 99.96% transcriptome-wide gene coverage across the cell population. At the single-cell level, we observed an average of 153.8 UMIs and a median of 142 UMIs. Top high-quality cells exhibited the following median UMI counts: 378 (top 1000 cells), 207 (top 5000 cells), and 167 (top 8000 cells) (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B</xref>). These cells also demonstrated median gene detection of 308, 194, and 158 genes, respectively (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1C</xref>). For exponential phase <italic>C. crescentus</italic> cells, we sequenced a library with 30,000 cells, recovering approximately 13,897 cells (46.3% recovery), each with ≥15 UMIs (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1G</xref>). Analysis showed 99.64% transcriptome-wide gene coverage across the cell population. At the single-cell level, we observed an average of 439.7 UMIs and a median of 182 UMIs. Top high-quality cells demonstrated the following median UMI counts: 2190 (top 1000 cells), 662 (top 5000 cells), and 225 (top 10,000 cells) (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1H</xref>). These cells also exhibited median gene detection of 1262, 529, and 219 genes, respectively (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1I</xref>). These results underscore RiboD-PETRI’s ability to capture a wide range of transcripts across varying cell qualities and species, providing a comprehensive view of gene expression at the single-cell level.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Comprehensive analysis of single-cell mRNA transcriptomic profiles in exponential phase <italic>E. coli</italic> using RiboD-PETRI.</title><p>(<bold>A</bold>) The number of unique molecular identifiers (UMIs) detected per cell in recovered cells in exponential period <italic>E. coli</italic> (≥15 UMIs/cell). The cells are ranked from highest to lowest based on the number of detected UMIs, and cells with ≥15 UMIs are selected for plotting. The median number of UMIs is calculated for these selected cells. (<bold>B</bold>) Distribution of mRNA UMIs captured per cell in RiboD-PETRI data of exponential period <italic>E. coli</italic>, presented as violin plots showing the upper quartile, median, and lower quartile lines. The cells are ranked from highest to lowest based on the number of UMIs detected. Then, specific numbers of cells (indicated above the panel) are selected for plotting. The median number of UMIs is calculated for these selected cells. (<bold>C</bold>) The number of genes detected per cell in exponential period <italic>E. coli</italic>. The cells are ranked from highest to lowest based on the number of genes detected. Then, specific numbers of cells (indicated above the panel) are selected for plotting. The median number of genes is calculated for these selected cells. (<bold>D</bold>) Uniform Manifold Approximation and Projection (UMAP) visualization of <italic>E. coli</italic> bacteria during the exponential phase. Data were filtered for cells with UMIs between 200 and 5000, resulting in 1464 cells. Each dot represents a cell. (<bold>E</bold>) Heatmap illustrating the normalized gene expression levels of marker genes in different clusters of exponential period <italic>E. coli</italic>. Marker genes with relatively high expression levels are depicted in yellow, while lower expression levels are shown in purple. Each row represents a gene, and each column represents a cell. (<bold>F</bold>) Functional enrichment analysis of marker genes of exponential period <italic>E. coli</italic> in cluster 2. Marker genes were selected based on screening criteria of p-value &lt;0.001 and log<sub>2</sub> fold change (FC)&gt;0.2. The color blocks in these figures represent the p-values of the data points. The color scale ranges from red to blue. Red colors indicate smaller p-values, suggesting higher statistical significance and more reliable results. Blue colors indicate larger p-values, suggesting lower statistical significance and less reliable results. Count is the number of genes enriched into this pathway. (<bold>G</bold>) Expression levels of marker genes in cluster 2 during the 3 hr exponential period of <italic>E. coli</italic> overlaid on the UMAP plot. Cells with high expression levels are depicted in blue. Marker genes were selected based on a p-value greater than 0.001 and a log<sub>2</sub> FC greater than 3. (<bold>H</bold>) Principal component analysis (PCA) performed on screened data of exponential phase <italic>E. coli</italic>. The resulting scatterplots show heterogeneity among the populations, with each point representing a cell. (<bold>I</bold>) Distribution of UMIs on the UMAP results for exponential phase <italic>E. coli</italic>. UMAP results reveal heterogeneity among populations, with each point representing a cell and color shading indicating UMI counts (<xref ref-type="supplementary-material" rid="supp11">Supplementary file 11</xref>).</p><p><supplementary-material id="fig2scode1"><label>Figure 2—source code 1.</label><caption><title>Source code for <xref ref-type="fig" rid="fig2">Figure 2</xref> and <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>.</title></caption><media mimetype="application" mime-subtype="zip" xlink:href="elife-97543-fig2-code1-v1.zip"/></supplementary-material></p><p><supplementary-material id="fig2scode2"><label>Figure 2—source code 2.</label><caption><title>Source code for <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref> and <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>.</title></caption><media mimetype="application" mime-subtype="zip" xlink:href="elife-97543-fig2-code2-v1.zip"/></supplementary-material></p><p><supplementary-material id="fig2sdata1"><label>Figure 2—source data 1.</label><caption><title>Related to <xref ref-type="fig" rid="fig2">Figure 2</xref>.</title></caption><media mimetype="application" mime-subtype="xls" xlink:href="elife-97543-fig2-data1-v1.xls"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97543-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Comprehensive single-cell transcriptomic analysis of <italic>S</italic>. <italic>aureus</italic> and <italic>C. crescentus</italic> using RiboD-PETRI.</title><p>Technical application of RiboD-PETRI in <italic>S. aureus</italic> (SA) (<bold>A–F</bold>), cultured for 9 hr in Mueller-Hinton Broth (MHB) medium at 37°C (<xref ref-type="supplementary-material" rid="supp14">Supplementary file 14</xref>) and <italic>C. crescentus</italic> (CC) (G–L), incubated at 37°C for 3 hr (<xref ref-type="supplementary-material" rid="supp15">Supplementary file 15</xref>). (<bold>A, G</bold>) The number of unique molecular identifiers (UMIs) detected per cell in different samples (≥15 UMIs/cell): (<bold>A</bold>) <italic>S. aureus</italic> (SA) and (<bold>G</bold>) C. crescentus (CC). (<bold>B, H</bold>) Distribution of mRNA UMIs captured per cell in RiboD-PETRI data of (<bold>B</bold>) <italic>S. aureus</italic> (SA) and (<bold>H</bold>) <italic>C. crescentus</italic> (CC), presented as violin plots showing the upper quartile, median, and lower quartile lines. The cells are ranked from highest to lowest based on the number of UMIs detected. Then, specific numbers of cells (indicated above the panel) are selected for plotting. The median number of UMIs is calculated for these selected cells. (<bold>C, I</bold>) The number of genes detected per cell in different samples (C) <italic>S. aureus</italic> and (<bold>I</bold>) <italic>C. crescentus</italic>. The cells are ranked from highest to lowest based on the number of genes detected. Then, specific numbers of cells (indicated above the panel) are selected for plotting. The median number of genes is calculated for these selected cells. ‘SA’ denotes <italic>S. aureus</italic>, and ‘CC’ denotes <italic>C. crescentus</italic>. (<bold>D, J</bold>) UMAP visualization of (<bold>D</bold>) <italic>S. aureus</italic> and (<bold>J</bold>) <italic>C. crescentus</italic>, demonstrating the ability of RiboD-PETRI to distinguish population heterogeneity. (<bold>E, K</bold>) Normalized and principal component analysis (PCA) performed on screened data of (<bold>E</bold>) <italic>S. aureus</italic> and (<bold>K</bold>) <italic>C. crescentus</italic>. The resulting scatterplots show heterogeneity among the populations, with each point representing a cell. (<bold>F, L</bold>) Distribution of UMIs on the UMAP results for (F) <italic>S. aureus</italic> and (L) <italic>C. crescentus</italic>. UMAP results reveal heterogeneity among populations, with each point representing a cell and color shading indicating UMI counts.</p><p><supplementary-material id="fig2s1sdata1"><label>Figure 2—figure supplement 1—source data 1.</label><caption><title>Related to <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>.</title></caption><media mimetype="application" mime-subtype="xls" xlink:href="elife-97543-fig2-figsupp1-data1-v1.xls"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97543-fig2-figsupp1-v1.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Profiling of marker genes in exponential phase <italic>E. coli</italic> culture by RiboD-PETRI.</title><p>Expression levels of diverse marker genes across distinct clusters in exponential phase <italic>E. coli</italic> culture, visualized through violin plots. Each individual dot represents a single cell, demonstrating the high-resolution, single-cell nature of the RiboD-PETRI analysis.</p><p><supplementary-material id="fig2s2scode1"><label>Figure 2—figure supplement 2—source code 1.</label><caption><title>Related to <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>.</title></caption><media mimetype="application" mime-subtype="zip" xlink:href="elife-97543-fig2-figsupp2-code1-v1.zip"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97543-fig2-figsupp2-v1.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Marker genes identified in stationary phase <italic>S</italic>. <italic>aureus</italic> culture by RiboD-PETRI.</title><p>Expression levels of different marker genes across different clusters in stationary phase <italic>S. aureus</italic> culture overlaid on the Uniform Manifold Approximation and Projection (UMAP) plot. Marker genes were selected based on a p-value greater than 0.001 and a log<sub>2</sub> fold change (FC) greater than 0.2. Each dot represents a cell and color shading indicating unique molecular identifier (UMI) counts.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97543-fig2-figsupp3-v1.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 4.</label><caption><title>Marker genes identified in exponential phase <italic>C</italic>. <italic>crescentus</italic> culture by RiboD-PETRI.</title><p>Expression levels of different marker genes across different clusters in exponential phase <italic>C. crescentus</italic> culture overlaid on the Uniform Manifold Approximation and Projection (UMAP) plot. Marker genes were selected based on a p-value greater than 0.001 and a log<sub>2</sub> fold change (FC) greater than 0.2. Each dot represents a cell and color shading indicating unique molecular identifier (UMI) counts.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97543-fig2-figsupp4-v1.tif"/></fig></fig-group><p>Our results affirm RiboD-PETRI’s reliability in capturing the bacterial single-cell transcriptome, providing ample coverage and sensitivity for various species. To provide a thorough evaluation of our sequencing depth and library quality, we performed sequencing saturation analysis on our sequencing samples. The findings reveal that our sequencing saturation is greater than 90% (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1D–F</xref>), indicating that our sequencing depth is sufficient to capture the diversity of most transcripts.</p><p>We further investigated its ability to consistently identify within-population heterogeneity across different bacterial species and growth conditions. In the exponential phase of <italic>E. coli,</italic> we recovered 1464 cells and identified three major subpopulations (<xref ref-type="fig" rid="fig2">Figure 2D</xref>), with 17 cells (1.2%) in a unique subpopulation characterized by pentose and glucuronate interconversions (<xref ref-type="fig" rid="fig2">Figure 2E and F</xref>) and the marker genes of cluster 2 included <italic>yfgM, glpG, scpA, elyC, ptsA, carB, actP,</italic> and <italic>pgpB</italic> (<xref ref-type="fig" rid="fig2">Figure 2G</xref>). For the expression levels of marker gene shown in <xref ref-type="fig" rid="fig2">Figure 2E</xref>, violin plots have been created to offer a more comprehensive view of the distribution across different cell populations (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). In stationary phase <italic>S. aureus</italic> cells, we recovered 9386 cells and found six major subpopulations (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1D</xref>), with 437 cells (4.7%) in a distinct subpopulation named cluster 4. The marker genes of cluster 4 included KQ76-13335, KQ76-00740, and KQ76-11725 (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>). In the stationary phase of <italic>C. crescentus</italic> cells, we recovered 5728 cells and identified four major subpopulations (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1J</xref>), with 603 cells (10.5%) in a unique subpopulation named cluster 3. The marker genes of cluster 3 included CCNA-00259, CCNA-03402, CCNA-02361, and CCNA-03119 (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>). These findings highlight RiboD-PETRI’s consistent ability to unveil within-population heterogeneity across different cell physiology and bacterial species (<xref ref-type="fig" rid="fig2">Figure 2H and I</xref>, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1E, F, K, L</xref>), crucial for understanding bacterial population complexity. While RiboD-PETRI consistently detects potential heterogeneity, further experimental validation would be required to confirm the biological significance of the observations.</p><p>We next focused on exploring biological heterogeneity of a biofilm at the early stage of development by utilizing the static biofilm system (<xref ref-type="bibr" rid="bib20">Merritt et al., 2011</xref>). <italic>E. coli</italic> cells were cultured in microtiter dishes overnight, adhered cells were fixed for RiboD-PETRI processing in duplicate experiments. For these two replicates, we sequenced libraries containing 20,000 and 40,000 cells, recovering 5244 and 11,344 cells, which corresponded to recovery rates of 26% and 28%, respectively. The correlations between detected reads and UMIs were found to be 0.87 and 0.90 for the two replicates, respectively (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1A</xref>). The median UMI counts for the recovered cells were 34 and 52 (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). After screening, the final datasets comprised 1621 and 3999 cells for the two replicates, respectively. While no significant batch effects were observed, we applied batch correction as a precautionary measure (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1B–D</xref>). In replicate 1, each cell was sequenced with an average of 1563 reads, while in replicate 2, the average was 2034 reads (<xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref>), yielding median UMI counts of 283.5 and 239 per cell, respectively (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). For gene detection, the median counts were 219 and 193 genes per cell for the respective replicates (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). Additionally, UMAP visualization was employed to illustrate the distribution of cellular UMI numbers, revealing heterogeneity among populations that was independent of UMI counts (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1E and F</xref>). Unsupervised clustering analysis identified four major subpopulations in each replicate, with a consistently identified rare subpopulation (2.6%/2.1%) as cluster 2, driven by cell envelope genes (<xref ref-type="fig" rid="fig3">Figure 3D–F</xref>). Marker genes for this cluster included <italic>yffO, lptE, rdgB, pdeI, sstT, fixA, yjjG, rlmI, accC,</italic> and <italic>yaiA</italic> (<xref ref-type="fig" rid="fig3">Figure 3G, H</xref> and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Single-cell transcriptomic analysis and characterization of static <italic>E. coli</italic> biofilm using RiboD-PETRI.</title><p>(<bold>A–F, H</bold>) RiboD-PETRI data from static E. <italic>coli</italic> biofilm (<italic>E. coli</italic> 24 hr static culture) (<xref ref-type="supplementary-material" rid="supp12 supp13">Supplementary files 12 and 13</xref>). RiboD-PETRI data of static <italic>E. coli</italic> biofilm were screened for cells with unique molecular identifiers (UMIs) between 100 and 2000, resulting in 1621 and 3999 cells. (<bold>A</bold>) The number of UMIs detected per cell in recovered cells in Static <italic>E. coli</italic> biofilms (≥15 UMIs/cell). The cells are ranked from highest to lowest based on the number of detected UMIs, and cells with ≥15 UMIs are selected for plotting. (<bold>B</bold>) Distribution of mRNA UMIs captured per cell in RiboD-PETRI data of static <italic>E. coli</italic> biofilm. (<bold>C</bold>) The number of genes detected per cell in static <italic>E. coli</italic> biofilm. (<bold>D</bold>) UMAP visualization of static <italic>E. coli</italic> biofilm, revealing two small populations of heterogeneous cells in clusters 2 and 3. (<bold>E</bold>) Inferred expression levels of marker genes from static <italic>E. coli</italic> biofilm of <italic>E. coli</italic> across different clusters. (<bold>F</bold>) Enrichment pathways for marker genes of static <italic>E. coli</italic> biofilm data in cluster 2, selected based on screening criteria of p-value&lt;0.001 and log<sub>2</sub> fold change (FC)&gt;0.2. The color blocks in these figures represent the p-values of the data points. (G and H) Dot plot displaying scaled expression levels of marker genes in different clusters of <italic>E. coli</italic> in exponential phase (<bold>G</bold>) and <italic>E. coli</italic> in static <italic>E. coli</italic> biofilm (<bold>H</bold>). These genes were markers of static <italic>E. coli</italic> biofilms in cluster 2, identified with screening criteria of p-value&lt;0.001 and log<sub>2</sub> FC&gt;3. Dot size represents the percentage expression of the gene in the cluster, while color indicates the average expression level normalized from 0 to 1 across all clusters for each gene.</p><p><supplementary-material id="fig3scode1"><label>Figure 3—source code 1.</label><caption><title>Source code for <xref ref-type="fig" rid="fig3">Figure 3</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>.</title></caption><media mimetype="application" mime-subtype="zip" xlink:href="elife-97543-fig3-code1-v1.zip"/></supplementary-material></p><p><supplementary-material id="fig3sdata1"><label>Figure 3—source data 1.</label><caption><title>Related to <xref ref-type="fig" rid="fig3">Figure 3</xref>.</title></caption><media mimetype="application" mime-subtype="xls" xlink:href="elife-97543-fig3-data1-v1.xls"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97543-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Evaluation of transcriptomic consistency and batch effect analysis in static biofilm <italic>E. coli</italic> samples.</title><p>(<bold>A</bold>) Scatterplot demonstrating the relationship between reads per cell and counts of unique molecular identifiers (UMIs) per cell detected from static biofilm <italic>E. coli</italic> data. Two replicates of the sample are included. (<bold>B</bold>) Calculation of the Pearson correlation coefficient (r) of UMI counts per gene between replicate 1 and replicate 2 of static biofilm <italic>E. coli</italic>. The analysis involved 4062 out of 4141 total genes, with a significant correlation (p-value&lt;0.0001, r = 0.96), indicating good replication between samples. Each dot represents a gene. (<bold>C</bold>) Before batch effects were removed, UMAP plot based on the original identity of static biofilm <italic>E. coli</italic> samples (replicate 1 and replicate 2). Each dot represents a cell, with red indicating replicate 1 and green indicating replicate 2. (<bold>D</bold>) After batch effects were removed using Harmony, UMAP plot based on the original identity of static biofilm <italic>E. coli</italic> samples (replicate 1 and replicate 2). (<bold>E</bold>) Principal component analysis (PCA) performed on screened data of two replicates of static biofilm <italic>E. coli</italic>. The resulting scatterplots show heterogeneity among the populations, with each point representing a cell. (<bold>F</bold>) Distribution of UMIs on the UMAP results for two replicates of static biofilm <italic>E. coli</italic>. UMAP results reveal heterogeneity among populations, with each point representing a cell and color shading indicating UMI counts.</p><p><supplementary-material id="fig3s1sdata1"><label>Figure 3—figure supplement 1—source data 1.</label><caption><title>Related to <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>.</title></caption><media mimetype="application" mime-subtype="xls" xlink:href="elife-97543-fig3-figsupp1-data1-v1.xls"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97543-fig3-figsupp1-v1.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Marker genes identified in static <italic>E. coli</italic> biofilms by RiboD-PETRI.</title><p>Expression levels of different marker genes across different clusters in static <italic>E. coli</italic> biofilms overlaid on the Uniform Manifold Approximation and Projection (UMAP) plot. Marker genes were selected based on a p-value greater than 0.001 and a log<sub>2</sub> fold change (FC) greater than 3. Each dot represents a cell and color shading indicating unique molecular identifiers (UMI) counts.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97543-fig3-figsupp2-v1.tif"/></fig></fig-group><p>PdeI, identified among marker genes, was predicted as a phosphodiesterase enzyme hydrolyzing c-di-GMP, a vital bacterial second messenger (<xref ref-type="bibr" rid="bib34">Yu et al., 2023</xref>; <xref ref-type="bibr" rid="bib13">Li et al., 2023</xref>; <xref ref-type="fig" rid="fig4">Figure 4A and B</xref>). However, our comprehensive structural analysis revealed a more complex and novel role for PdeI. While PdeI contains an intact EAL domain typically associated with c-di-GMP degradation, it also possesses a divergent GGDEF domain, generally linked to c-di-GMP synthesis (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). This dual-domain architecture suggested potential complex regulatory roles. To validate PdeI’s function, we created a PdeI-BFP fusion construct under the native <italic>pdeI</italic> promoter, integrated with a ratiometric c-di-GMP sensing system (<xref ref-type="bibr" rid="bib30">Vrabioiu and Berg, 2022</xref>) in <italic>E. coli</italic>. Confocal microscopy revealed PdeI as a membrane protein (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). Single-cell level monitoring showed cell-to-cell variability in c-di-GMP levels and PdeI expression, with a positive correlation observed (<xref ref-type="fig" rid="fig4">Figure 4D</xref>), indicating PdeI upregulated c-di-GMP synthesis rather than degradation. This finding was confirmed by high-pressure liquid chromatography-tandem mass spectrometry (HPLC-MS/MS), which showed an approximately 11-fold increase in c-di-GMP concentration in the PdeI overexpression strain compared to the control strain (<xref ref-type="fig" rid="fig4">Figure 4E</xref>). These results align with previous studies showing that a point mutation (G412S) in PdeI’s divergent GGDEF domain in a strain lacking PdeH, the major phosphodiesterase in <italic>E. coli</italic>, resulted in decreased c-di-GMP levels (<xref ref-type="bibr" rid="bib24">Reinders et al., 2016</xref>). Our additional experiments with a PdeI(G412S)-BFP mutation strain showed constant c-di-GMP levels despite increasing BFP fluorescence, serving as a proxy for PdeI(G412S) expression levels (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). These results, combined with the presence of a CHASE (cyclases/histidine kinase-associated sensory) domain in PdeI, strongly suggest that PdeI functions as a membrane-associated sensor that integrates environmental signals with c-di-GMP production under complex regulatory mechanisms. This discovery challenges the initial prediction of PdeI as solely a phosphodiesterase and highlights its novel role as a c-di-GMP synthetase, contributing significantly to our understanding of bacterial signaling pathways. It’s worth noting that while the other marker genes in this cluster are co-expressed, our analysis indicates that they do not have a significant impact on biofilm formation or a direct relationship with c-di-GMP or PdeI.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Functional investigation of marker gene <italic>pdeI</italic> in static <italic>E. coli</italic> biofilm.</title><p>(<bold>A, B</bold>) Uniform Manifold Approximation and Projection (UMAP) plots showing the distribution of <italic>pdeI</italic> in single-cell data of exponential period <italic>E. coli</italic> (<bold>A</bold>) and static <italic>E. coli</italic> biofilm (<bold>B</bold>). Each dot represents a cell colored by normalized expression levels of genes. (<bold>C</bold>) Subcellular localization of PdeI-GFP and GFP. Scale bar, 1 μm. (<bold>D</bold>) c-di-GMP levels (R<sup>–1</sup> score) in <italic>E. coli</italic> cells with different BFP, PdeI-BFP, PdeI(G412S)-BFP expression levels (low or high), under the control of the <italic>pdeI</italic> native promoter, in static <italic>E. coli</italic> biofilm. c-di-GMP levels are measured using the c-di-GMP sensor system integrated into <italic>E. coli</italic> cells. R<sup>–1</sup> score was determined using the fluorescent intensity of mVenusNB and mScarlet-I in the system. The fluorescent intensity is measured by flow cytometry (n&gt;50). (<bold>E</bold>) Determination of cellular concentrations of c-di-GMP by high-pressure liquid chromatography-tandem mass spectrometry (HPLC-MS/MS) in cells overexpressing PdeI under the control of arabinose promoter, with 0.002% arabinose induction for 2 hr (n=3). (<bold>F, G</bold>) Localization of PdeI-high cells in the biofilm matrix. Cells expressing PdeI-BFP under the control of the <italic>pdeI</italic> native promoter were grown in a glass-bottom cell culture dish and stained with SYTO 24 for bacterial DNA. Cells expressing BFP under the control of arabinose promoter, with 0.00001% arabinose induction for 24 hr in a glass-bottom cell culture dish and stained with SYTO 24 for bacterial DNA. (<bold>H, I</bold>) Heterogeneous expression of PdeI in single-cell data of exponential period <italic>E. coli</italic> (<bold>H</bold>) and <italic>E. coli</italic> in static <italic>E. coli</italic> biofilm (<italic>E. coli</italic> 24 hr static culture) (<bold>I</bold>). Biofilm cells with high or low expression levels of PdeI-BFP were sorted by flow cytometry. (<bold>J</bold>) Persister counting assay using 150 μg/ml ampicillin on cells with high or low expression levels of BFP, PdeI-BFP, and PdeI(G412S)-BFP from static <italic>E. coli</italic> biofilm, sorted by flow cytometry (n=3). These strains were under the control of the <italic>pdeI</italic> native promoter. (<bold>K</bold>) Time-lapse images of the persister assay observed under a microscope. Static biofilm cells of the PdeI-GFP strain were spotted on a gel pad and treated with 150 μg/ml ampicillin in Luria broth (LB). Images were captured over 6 hr at 37°C, followed by the replacement of fresh LB to allow persister cell resuscitation. Scale bar, 2 μm. Error bars represent standard deviations of biological replicates. Significance was ascertained by unpaired Student’s t-test. Statistical significance is denoted as *p&lt;0.05, **p&lt;0.01, ***p&lt;0.001, and ****p&lt;0.0001.</p><p><supplementary-material id="fig4sdata1"><label>Figure 4—source data 1.</label><caption><title>Related to <xref ref-type="fig" rid="fig4">Figure 4</xref>.</title></caption><media mimetype="application" mime-subtype="xls" xlink:href="elife-97543-fig4-data1-v1.xls"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97543-fig4-v1.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Schematic chart for the structure of <italic>E. coli</italic> PdeI.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97543-fig4-figsupp1-v1.tif"/></fig></fig-group><p>Confocal laser scanning microscopy provided further insights into the spatial distribution of PdeI-positive cells within the biofilm structure. In the PdeI-BFP fusion strain, PdeI-BFP-positive cells, characterized by elevated c-di-GMP levels, were predominantly located at the bottom of the static biofilm (<xref ref-type="fig" rid="fig4">Figure 4F</xref>). This localization corresponds to the region of cell-surface attachment, aligning with our hypothesis that PdeI functions as a membrane-associated sensor integrating environmental signals with c-di-GMP production through complex regulatory mechanisms (<xref ref-type="bibr" rid="bib12">Lacanna et al., 2016</xref>). In contrast, in the control strain where BFP was expressed alone under arabinose-induced promoter, BFP-positive cells were observed to be distributed throughout the entire biofilm community (<xref ref-type="fig" rid="fig4">Figure 4G</xref>). This distinct spatial distribution pattern between the PdeI-BFP fusion and the BFP-only control strains provides compelling evidence for PdeI’s specific role in biofilm formation, particularly at the biofilm-surface interface. The concentration of PdeI-positive cells at the bottom of the biofilm suggests that PdeI may be especially crucial in the initial stages of biofilm formation, potentially responding to surface-associated cues to modulate c-di-GMP levels and promote attachment. The uniform distribution of BFP in the control strains suggests that the localization of PdeI-BFP is not affected by BFP labeling. These observations further underscore the complex and nuanced role of PdeI in bacterial signaling and biofilm development, highlighting the importance of considering cell-to-cell heterogeneity in understanding the function of regulatory proteins in microbial communities.</p><p>To investigate the association of the PdeI-high cluster with bacterial drug tolerance in the early stages of biofilm development, we isolated PdeI-high cells using flow cytometry (<xref ref-type="fig" rid="fig4">Figure 4H, I</xref>) and subjected them to an ampicillin antibiotic killing assay to determine their persister frequency. Our results revealed that the PdeI-high population produced a significantly higher ratio of persister cells (~7.3%) compared to the whole biofilm population (~0.6%). Notably, cells expressing high levels of BFP alone or PdeI(G412S)-BFP showed no increase in persister ratios (<xref ref-type="fig" rid="fig4">Figure 4J</xref>). This finding suggests that the increased persistence is specifically linked to PdeI activity. Time-lapse imaging during the antibiotic killing process consistently demonstrated that persisters primarily originated from PdeI-GFP-positive cells (<xref ref-type="fig" rid="fig4">Figure 4K</xref> and <xref ref-type="video" rid="video1">Video 1</xref>). These PdeI-GFP-positive cells, displaying characteristics of dormancy, survived ampicillin treatment for 6 hr without visible growth or division. Upon antibiotic removal and replacement with fresh growth medium, the PdeI-GFP-positive persister cells resumed activity, elongating, dividing, and forming new microcolonies (<xref ref-type="fig" rid="fig4">Figure 4K</xref> and <xref ref-type="video" rid="video1">Video 1</xref>). This dynamic behavior provides direct visual evidence of the persister phenotype associated with PdeI-high cells. These findings strongly suggest that c-di-GMP, a molecule whose intracellular levels are upregulated by PdeI, plays a significant role in generating a persister subpopulation during the early stages of biofilm development. The mechanism by which elevated c-di-GMP levels contribute to antibiotic tolerance may involve modulation of cellular metabolism or activation of stress response pathways, leading to a state of dormancy that enables survival under antibiotic stress. This discovery not only enhances our understanding of the link between biofilm formation and antibiotic tolerance but also identifies PdeI as a potential target for strategies aimed at combating persistent bacterial infections.</p><media mimetype="video" mime-subtype="mp4" xlink:href="elife-97543-video1.mp4" id="video1"><label>Video 1.</label><caption><title>Time-lapse images of the persister assay using cells with different PdeI-BFP.</title></caption></media></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In this study, we introduce RiboD-PETRI, an enhanced bacterial scRNA-seq method that offers a cost-effective (<xref ref-type="supplementary-material" rid="supp6">Supplementary file 6</xref>), equipment-free, and high-throughput solution. By incorporating a probe hybridization-based rRNA-derived cDNA depletion protocol, our approach efficiently removes rRNA reads and significantly improves mRNA detection rates, enabling a more comprehensive exploration of within-population heterogeneity. At $0.0049 per cell, RiboD-PETRI is substantially more economical than the original PETRI-seq ($0.056 per cell), making it an attractive option for budget-conscious researchers. The method demonstrates improved mRNA detection, versatility across various bacterial species and growth conditions, preservation of transcriptome profiles consistent with non-depleted samples (r=0.93) and traditional bulk RNA-seq methods (r=0.84), high transcriptome coverage (&gt;99%), and robust single-cell resolution with median UMI counts ranging from 102 to 182 per cell across different species and conditions.</p><p>The application of RiboD-PETRI to investigate biofilm heterogeneity exemplifies its potential for exploring complex biological systems. Our analysis of early-stage biofilm development uncovered a rare subpopulation (2.1–2.6%) characterized by cell envelope genes, including the previously uncharacterized gene <italic>pdeI</italic>. Further investigation revealed PdeI’s novel role as a c-di-GMP synthetase rather than a phosphodiesterase, challenging initial predictions and contributing significantly to our understanding of bacterial signaling pathways. Moreover, we demonstrated that PdeI-high cells exhibit increased antibiotic tolerance, with a significantly higher proportion of persister cells compared to the general biofilm population. This finding establishes a link between elevated c-di-GMP levels, regulated by PdeI, and the generation of antibiotic-tolerant subpopulations during early biofilm development. The spatial distribution of PdeI-positive cells at the bottom of the static biofilm, corresponding to the cell-surface attachment region, supports our hypothesis that PdeI functions as a membrane-associated sensor integrating environmental signals with c-di-GMP production. This localization pattern suggests PdeI’s crucial role in the initial stages of biofilm formation, potentially responding to surface-associated cues to modulate c-di-GMP levels and promote attachment. While other marker genes in this cluster are co-expressed, our analysis indicates they do not significantly impact biofilm formation or directly relate to c-di-GMP or PdeI.</p><p>In conclusion, RiboD-PETRI represents a significant advancement in bacterial scRNA-seq methodology. Its ability to uncover hidden variations within bacterial populations, as demonstrated in our biofilm analysis, underscores its potential impact on advancing our understanding of microbial behavior and population dynamics. By providing a cost-effective and efficient tool for exploring bacterial heterogeneity, RiboD-PETRI opens new avenues for research in microbiology, potentially leading to novel insights into antibiotic resistance, biofilm formation, and other critical areas of bacterial biology.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Reagent type (species) or resource</th><th align="left" valign="bottom">Designation</th><th align="left" valign="bottom">Source or reference</th><th align="left" valign="bottom">Identifiers</th><th align="left" valign="bottom">Additional information</th></tr></thead><tbody><tr><td align="left" valign="bottom">Strain, strain background (<italic>Escherichia coli</italic>)</td><td align="left" valign="bottom">MG1655</td><td align="left" valign="bottom">Yale Genetic Stock Center</td><td align="left" valign="bottom">CGSC#6300</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Caulobacter crescentus</italic>)</td><td align="left" valign="bottom">NA1000</td><td align="left" valign="bottom">Shenzhen Institutes of Advanced Technology, Chinese Academy of<break/>Sciences</td><td align="left" valign="bottom">NCBI accession number CP001340</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Staphylococcus aureus</italic>)</td><td align="left" valign="bottom">ATCC 25923</td><td align="left" valign="bottom">ATCC</td><td align="left" valign="bottom">ATCC 25923</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Escherichia coli</italic>)</td><td align="left" valign="bottom">MG1655<break/>pBAD::<italic>gfp</italic></td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom"/><td align="left" valign="bottom">Figure legends and <break/>Materials and methods section</td></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Escherichia coli</italic>)</td><td align="left" valign="bottom">MG1655<break/>p(<italic>pdeI</italic> promoter)::<italic>pdeI-gfp</italic></td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom"/><td align="left" valign="bottom">Figure legends and <break/>Materials and methods section</td></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Escherichia coli</italic>)</td><td align="left" valign="bottom">MG1655<break/>p(<italic>pdeI</italic> promoter)::<italic>pdeI-bfp</italic></td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom"/><td align="left" valign="bottom">Figure legends and <break/>Materials and methods section</td></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Escherichia coli</italic>)</td><td align="left" valign="bottom">MG1655 Δ<italic>ara</italic> pBAD::<italic>pdeI</italic></td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom"/><td align="left" valign="bottom">Figure legends and <break/>Materials and methods section</td></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Escherichia coli</italic>)</td><td align="left" valign="bottom">MG1655 Δ<italic>ara</italic> pBAD::vector</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom"/><td align="left" valign="bottom">Figure legends and <break/>Materials and methods section</td></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Escherichia coli</italic>)</td><td align="left" valign="bottom">MG1655<break/>p(<italic>pdeI</italic> promoter)::<italic>bfp</italic></td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom"/><td align="left" valign="bottom">Figure legends and <break/>Materials and methods section</td></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Escherichia coli</italic>)</td><td align="left" valign="bottom">MG1655<break/>p(<italic>pdeI</italic> promoter)::<italic>pdeI</italic>(G412S)-<italic>bfp</italic></td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom"/><td align="left" valign="bottom">Figure legends and <break/>Materials and methods section</td></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Escherichia coli</italic>)</td><td align="left" valign="bottom">MG1655<break/>p(<italic>pdeI</italic> promoter)::<italic>bfp</italic> p15A::c-di-GMP-sensor</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom"/><td align="left" valign="bottom">Figure legends and <break/>Materials and methods section</td></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Escherichia coli</italic>)</td><td align="left" valign="bottom">MG1655<break/>p(<italic>pdeI</italic> promoter)::<italic>pdeI-bfp</italic> p15A::c-di-GMP-sensor</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom"/><td align="left" valign="bottom">Figure legends and <break/>Materials and methods section</td></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Escherichia coli</italic>)</td><td align="left" valign="bottom">MG1655<break/>p(<italic>pdeI</italic> promoter)::<italic>pdeI</italic>(G412S)-<italic>bfp</italic> p15A::c-di-GMP-sensor</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom"/><td align="left" valign="bottom">Figure legends and <break/>Materials and methods section</td></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Escherichia coli</italic>)</td><td align="left" valign="bottom">MG1655 Δ<italic>ara</italic> pBAD::<italic>bfp</italic></td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom"/><td align="left" valign="bottom">Figure legends and <break/>Materials and methods section</td></tr><tr><td align="left" valign="bottom">Recombinant DNA reagent</td><td align="left" valign="bottom">p15A::c-di-GMP-sensor</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom"/><td align="left" valign="bottom">p15A ori</td></tr><tr><td align="left" valign="bottom">Recombinant DNA reagent</td><td align="left" valign="bottom">pBAD::vector</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom"/><td align="left" valign="bottom">Arabinose-induction</td></tr><tr><td align="left" valign="bottom">Recombinant DNA reagent</td><td align="left" valign="bottom">pBAD::<italic>gfp</italic></td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom"/><td align="left" valign="bottom">Arabinose-induction</td></tr><tr><td align="left" valign="bottom">Recombinant DNA reagent</td><td align="left" valign="bottom">pBAD::<italic>bfp</italic></td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom"/><td align="left" valign="bottom">Arabinose-induction</td></tr><tr><td align="left" valign="bottom">Recombinant DNA reagent</td><td align="left" valign="bottom">p(<italic>pdeI</italic> promoter)::<italic>bfp</italic></td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom"/><td align="left" valign="bottom"><italic>pdeI</italic> native promoter induction</td></tr><tr><td align="left" valign="bottom">Recombinant DNA reagent</td><td align="left" valign="bottom">p(<italic>pdeI</italic> promoter)::<italic>pdeI-bfp</italic></td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom"/><td align="left" valign="bottom"><italic>pdeI</italic> native promoter induction</td></tr><tr><td align="left" valign="bottom">Recombinant DNA reagent</td><td align="left" valign="bottom">p(<italic>pdeI</italic> promoter)::<italic>pdeI</italic>(G412S)-<italic>bfp</italic></td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom"/><td align="left" valign="bottom"><italic>pdeI</italic> native promoter induction</td></tr><tr><td align="left" valign="bottom">Recombinant DNA reagent</td><td align="left" valign="bottom">p(<italic>pdeI</italic> promoter)::<italic>pdeI-gfp</italic></td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom"/><td align="left" valign="bottom"><italic>pdeI</italic> native promoter induction</td></tr><tr><td align="left" valign="bottom">Recombinant DNA reagent</td><td align="left" valign="bottom">p(<italic>pdeI</italic> promoter)::<italic>pdeI</italic></td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom"/><td align="left" valign="bottom"><italic>pdeI</italic> native promoter induction</td></tr><tr><td align="left" valign="bottom">Recombinant DNA reagent</td><td align="left" valign="bottom">pBAD::<italic>pdeI-gfp</italic></td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom"/><td align="left" valign="bottom">Arabinose-induction</td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">P-pdeI-F</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">PCR primers</td><td align="left" valign="bottom"><named-content content-type="sequence">AATTGTCTGATTCGTTACCAACTGACCGTACTGGCGTTC</named-content></td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">P-pdeI-R</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">PCR primers</td><td align="left" valign="bottom"><named-content content-type="sequence">TTGCTGCTGCCTCGGCTTCTAGCTCTTTTACTAATTTTCCACTTTTATCCCAGG</named-content></td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">pdeI-F</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">PCR primers</td><td align="left" valign="bottom"><named-content content-type="sequence">GGCTAACAGGAGGAATTAACCATGCTGAGTTTATACGAAAAGATAAAGATAAG</named-content></td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">pdeI-R</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">PCR primers</td><td align="left" valign="bottom"><named-content content-type="sequence">GCTGGAGACCGTTTAAACTCACTACTCTTTTACTAATTTTCCACTTTTATCCC</named-content></td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">pBAD-R</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">PCR primers</td><td align="left" valign="bottom"><named-content content-type="sequence">TTGGTAACGAATCAGACAATTGAC</named-content></td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">pBAD-F</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">PCR primers</td><td align="left" valign="bottom"><named-content content-type="sequence">TGAGTTTAAACGGTCTCCAGC</named-content></td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">pBAD-R2</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">PCR primers</td><td align="left" valign="bottom"><named-content content-type="sequence">GGTTAATTCCTCCTGTTAGCCC</named-content></td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">Bfp-F</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">PCR primers</td><td align="left" valign="bottom"><named-content content-type="sequence">CGAGGCAGCAGCAAAGGCCCTAGAAGGTGGATCCGGCGGTTCTAG</named-content></td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">Gfp-F</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">PCR primers</td><td align="left" valign="bottom"><named-content content-type="sequence">CTAGAAGCCGAGGCAGCAGCAAAGGCCCTAGAAATGAGTAAAGGAGAAGAACTTTTCAC</named-content></td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">G412S-F</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">PCR primers</td><td align="left" valign="bottom"><named-content content-type="sequence">GAAGCGGTGTTTAGTGTTGATG</named-content></td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">G412S-R</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">PCR primers</td><td align="left" valign="bottom"><named-content content-type="sequence">CATCAACACTAAACACCGCTTC</named-content></td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">P-bfp-R</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">PCR primers</td><td align="left" valign="bottom"><named-content content-type="sequence">GTTAATACATTTAACAAAATAACTATCTGA</named-content></td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">P-bfp-F</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">PCR primers</td><td align="left" valign="bottom"><named-content content-type="sequence">ATAGTTATTTTGTTAAATGTATTAACGGTGGATCCGGCGGTTCT</named-content></td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">UP-F</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">PCR primers</td><td align="left" valign="bottom"><named-content content-type="sequence">CATGAATTCTGGCGACGATTTCG</named-content></td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">UP-R</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">PCR primers</td><td align="left" valign="bottom"><named-content content-type="sequence">GTTAATACATTTAACAAAATAACTATCTGA</named-content></td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">ccdB-F</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">PCR primers</td><td align="left" valign="bottom"><named-content content-type="sequence">CACAGCGTTCAGATAGTTATTTTGTTAAATGTATTAACTCTAGAGCGACGCCAGACG</named-content></td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">ccdB-R</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">PCR primers</td><td align="left" valign="bottom"><named-content content-type="sequence">CTGTAAGTACGAACTTATTGATTCTGGACATACGTAAATTACGCCCCGCCCTGCCAC</named-content></td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">Down-F</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">PCR primers</td><td align="left" valign="bottom"><named-content content-type="sequence">TTTACGTATGTCCAGAATCAATAAGTTCGTACTTAC</named-content></td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">Down-R</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">PCR primers</td><td align="left" valign="bottom"><named-content content-type="sequence">ATCTTCGTCAAAGGATTTTCTGCCC</named-content></td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">UP2-R</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">PCR primers</td><td align="left" valign="bottom"><named-content content-type="sequence">ATCTTTTCGTATAAACTCAGCATGTTAATACATTTAACAAAATAACTATCTGAA</named-content></td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">pdeI-G412S-F</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">PCR primers</td><td align="left" valign="bottom"><named-content content-type="sequence">ATGCTGAGTTTATACGAAAAGATAAAGAT</named-content></td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">pdeI-G412S-R</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">PCR primers</td><td align="left" valign="bottom"><named-content content-type="sequence">CTTATTGATTCTGGACATACGTAAACTACTCTTTTACTAATTTTCCACT</named-content></td></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">Down2-F</td><td align="left" valign="bottom">This paper</td><td align="left" valign="bottom">PCR primers</td><td align="left" valign="bottom"><named-content content-type="sequence">TTTACGTATGTCCAGAATCAATAAGTTCGTACTTAC</named-content></td></tr><tr><td align="left" valign="bottom">Commercial assay or kit</td><td align="left" valign="bottom">KAPA HIFI hotStart <break/>ReadyMix PCR Kits</td><td align="left" valign="bottom">KAPA</td><td align="left" valign="bottom">Cat#2602</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Commercial assay or kit</td><td align="left" valign="bottom">VAHTS Universal DNA <break/>Library Prep Kit</td><td align="left" valign="bottom">Vazyme</td><td align="left" valign="bottom">Cat#NR603</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Commercial assay or kit</td><td align="left" valign="bottom">Bacteria RNA Extraction Kit</td><td align="left" valign="bottom">Vazyme</td><td align="left" valign="bottom">Cat#R403-01</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Commercial assay or kit</td><td align="left" valign="bottom">Ribo-off rRNA Depletion <break/>Kit (Bacteria)</td><td align="left" valign="bottom">Vazyme</td><td align="left" valign="bottom">Cat#N407</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Commercial assay or kit</td><td align="left" valign="bottom">2× MultiF Seamless Assembly Mix</td><td align="left" valign="bottom">ABclonal</td><td align="left" valign="bottom">Cat#RK21020</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Commercial assay or kit</td><td align="left" valign="bottom">VAHTS Universal DNA <break/>Library Prep Kit for Illumina V3</td><td align="left" valign="bottom">Vazyme</td><td align="left" valign="bottom">Cat#ND607</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Commercial assay or kit</td><td align="left" valign="bottom">ABScript III RT Master <break/>Mix for qPCR with gDNA Remover</td><td align="left" valign="bottom">ABclonal</td><td align="left" valign="bottom">Cat#RK20429</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Commercial assay or kit</td><td align="left" valign="bottom">SUPERase-In RNase Inhibitor</td><td align="left" valign="bottom">Invitrogen</td><td align="left" valign="bottom">Cat#AM2696</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Chemical compound, drug</td><td align="left" valign="bottom">Streptavidin Magnetic Beads</td><td align="left" valign="bottom">Thermo Fisher</td><td align="left" valign="bottom">Cat#88816</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Chemical compound, drug</td><td align="left" valign="bottom">Syto 24 dye</td><td align="left" valign="bottom">Invitrogen</td><td align="left" valign="bottom">Cat#S7559</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Chemical compound, drug</td><td align="left" valign="bottom">Arabinose</td><td align="left" valign="bottom">Sigma</td><td align="left" valign="bottom">Cat#V900920</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Chemical compound, drug</td><td align="left" valign="bottom">Ampicillin</td><td align="left" valign="bottom">Sangon Biotech</td><td align="left" valign="bottom">Cat#A610028</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Chemical compound, drug</td><td align="left" valign="bottom">Chloramphenicol</td><td align="left" valign="bottom">Sangon Biotech</td><td align="left" valign="bottom">Cat#A600118</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Chemical compound, drug</td><td align="left" valign="bottom">Kanamycin</td><td align="left" valign="bottom">Sangon Biotech</td><td align="left" valign="bottom">Cat#A600286</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">Fiji</td><td align="left" valign="bottom">GitHub</td><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://fiji.sc/">https://fiji.sc/</ext-link>; RRID:<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/RRID:SCR_002285">SCR_002285</ext-link><break/></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">FlowJo</td><td align="left" valign="bottom">Treestar, Inc</td><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://www.flowjo.com/">https://www.flowjo.com/</ext-link></td><td align="left" valign="bottom"/></tr></tbody></table></table-wrap><sec id="s4-1"><title>Resource availability</title><p>Further information and requests for resources and reagents should be directed to and will be fulfilled by the lead contact, Yingying Pu (yingyingpu@whu.edu.cn).</p></sec><sec id="s4-2"><title>Materials availability</title><p>Plasmids generated in this study are available from the lead contact upon request.</p></sec><sec id="s4-3"><title>Bacterial strains and growth conditions</title><p>The bacterial strains used in this study included <italic>E. coli</italic> strains MG1655, <italic>C. crescentus</italic> NA1000, and <italic>S. aureus</italic> strain ATCC 25923. <italic>E. coli</italic> cultures were grown in Luria broth (LB) medium. For the biofilm setup, bacterial cultures were grown overnight. The next day, we diluted the culture 1:100 in a Petri dish. We added 2 ml of LB medium to the dish. If the bacteria contain a plasmid, the appropriate antibiotic needs to be added to LB. The Petri dish was then incubated statically in a growth chamber for 24 hr. After incubation, we performed imaging directly under the microscope. The Petri dishes used were glass-bottom dishes from Biosharp (catalog number BS-20-GJM), allowing for direct microscopic imaging without the need for cover slips or slides. This setup allowed us to grow and image the biofilms in situ, providing a more accurate representation of their natural structure and composition. <italic>C. crescentus</italic> strain NA1000 was grown in peptone yeast extract (PYE) medium. And <italic>S. aureus</italic> strain ATCC 25923 was grown in Mueller-Hinton Broth (MHB) medium. All bacterial strains were routinely grown at 37°C and 220 rpm. To maintain plasmids, when necessary, media were supplemented with chloramphenicol (25 µg/ml) or kanamycin sulfate (50 µg/ml). For arabinose-induction system expression experiments, 0.002% or 0.00002% arabinose was supplemented in the medium.</p><sec id="s4-3-1"><title>Strains construction</title><p>The construction of recombinant plasmids was performed using the 2× MultiF Seamless Assembly Mix (ABclonal, RK21020). For the detection of c-di-GMP levels using c-di-GMP sensor and the detection of persister, the PdeI gene, <italic>pdeI</italic>, along with its native promoter (250 bp), was fused with either <italic>gfp</italic> or <italic>bfp</italic> and cloned into the pBAD backbone. The original promoter region of the pBAD vector was removed to avoid any potential interference. This construction allows the expression of the BFP, PdeI-BFP, and PdeI(G412S)-BFP fusion proteins to be driven by <italic>pdeI</italic>’s native promoter, thus maintaining its physiological control mechanisms. And the BFP coding sequence was fused to the <italic>pdeI</italic> gene to create the PdeI-BFP fusion construct. Besides, for membrane localization and localization in biofilm community, the <italic>pdeI-gfp</italic> and <italic>pdeI-bfp</italic> with native promoter of <italic>pdeI</italic> were cloned into the pBAD backbone, and the original promoter region of the pBAD vector was removed. For the control group, <italic>bfp</italic> and <italic>gfp</italic> was cloned into the pBAD backbone under the control of arabinose-induction system. For HPLC-MS/MS analysis, <italic>pdeI</italic> and empty vector were cloned into the pBAD backbone, induced by arabinose. GFP and BFP were used in different experiments. GFP was used for imaging and time-lapse imaging to observe persister cell growth. BFP was used for cell sorting and detecting the proportion of persister cells. For the c-di-GMP sensor (Addgene: #182291), the plasmid origin was replaced with the p15A ori.</p></sec></sec><sec id="s4-4"><title>RiboD-PETRI</title><sec id="s4-4-1"><title>Cell preparation</title><p><italic>E. coli</italic> MG1655 cells were cultured overnight and subsequently diluted at a ratio of 1:100 into fresh LB medium and grown statically for 24 hr at 37°C. For 3 hr exponential period <italic>E. coli</italic> sample, <italic>E. coli</italic> MG1655 cells were grown overnight and then diluted 1:100 into fresh LB medium and grown for 3 hr at 37°C and 220 rpm. <italic>C. crescentus</italic> strain NA1000 cells were grown overnight and then diluted 1:100 into fresh MHB medium and grown for 9 hr at 37°C and 220 rpm. And <italic>S. aureus</italic> strain ATCC 25923 cells were grown overnight and then diluted 1:100 into fresh PYE medium and grown for 3 hr at 37°C and 220 rpm. All the culture was vigorously shaken using a vortex, and the cells were then centrifuged at 5000×<italic>g</italic> for 2 min at 4°C. The pellet was resuspended in 2 ml of ice-cold 4% formaldehyde (F8775, MilliporeSigma, diluted into PBS). These suspensions were rotated at 4°C for 16 hr.</p></sec><sec id="s4-4-2"><title>Cell permeabilization</title><p>1 ml of fixed cells were centrifuged at 5000×<italic>g</italic> for 5 min at 4°C, then resuspended in 1 ml washing buffer (100 mM Tris-HCl pH 7.0, 0.02 U/μl SUPERase-In RNase Inhibitor, AM2696, Invitrogen). After another centrifugation at 5000×<italic>g</italic> for 5 min at 4°C, the supernatant was removed. The pellet was then resuspended in 250 μl permeabilization buffer (0.04% Tween-20 in PBS-RI, PBS with 0.01 U/μl SUPERase-In RNase Inhibitor) and incubated on ice for 3 min. 1 ml cold PBS-RI was added, and the cells were centrifuged at 5000×<italic>g</italic> for 5 min at 4°C. The pellet was resuspended in 250 μl Lysozyme Mix (250 μg/ml Lysozyme or 5 μg/ml Lysostaphin for <italic>S. aureus</italic> in TEL-RI buffer, comprising 100 mM Tris pH 8.0 [AM9856, Invitrogen], 50 mM EDTA [AM9261, Invitrogen], and 0.1 U/μl SUPERase In RNase Inhibitor). The samples were incubated at 37°C and mixed gently every minute. Then 1 ml cold PBS-RI was added immediately, and cells were centrifuged at 5000×<italic>g</italic> for 5 min at 4°C. The cells underwent another wash with 1 ml cold PBS-RI. Subsequently, cells were resuspended in 40 μl DNaseI-RI buffer (4.4 μl 10× reaction buffer, 0.2 μl SUPERase In RNase inhibitor, 35.4 μl H<sub>2</sub>O), followed by addition of 4 μl DNaseI (AMPD1, MilliporeSigma). The samples were incubated for 30 min at room temperature and mixed gently every 5 min. 4 μl Stop Solution was added, and the samples were incubated for 10 min at 50°C with gentle mixing every minute. Following centrifugation at 5000×<italic>g</italic> for 10 min at 4°C, cells were washed twice with 0.5 ml cold PBS-RI. Finally, cells were resuspended in 200 μl cold PBS-RI, and their count and integrity were assessed using the ACEA NovoCyte flow cytometer with a 100× oil immersion lens.</p></sec><sec id="s4-4-3"><title>Primer preparation</title><p>For the first round of reverse transcription reaction, round 2 and round 3 ligation reactions, all primers design and preparation as previously described (<xref ref-type="bibr" rid="bib1">Blattman et al., 2020</xref>). All primers were purchased from Sangon Biotech (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). For ligation primers preparation, mixtures were prepared as follows: 31.1 μl each R2 primer (100 μM), 28.5 μl SB83 (100 μM), and 21.4 μl H<sub>2</sub>O were splitted to 2.24 μl for one sample. Mixtures containing 63.2 μl each R3 primer (70 μM) and 58 μl SB8 (70 μM) were splitted to 3.49 μl for one sample. Before use, ligation primers were incubated as follows: 95°C for 3 min, then decreasing the temperature to 20°C at a ramp speed of −0.1 °C/s, 37°C for 30 min. For blocking mix preparation, 50 μl primer SB84 (400 μM) and 80 μl primer SB81 (400 μM) were incubated as follows: 94°C for 3 min, then decreasing the temperature to 25°C at a ramp speed of −0.1 °C/s, 4°C for keeping. Round 2 blocking primers were mixed as follows: 37.5 μl 400 μM SB84, 37.5 μl 400 μM SB85, 25 μl 10× T4 ligase buffer, 150 μl H<sub>2</sub>O. Round 3 blocking primers were mixed as follows: 72 μl 400 μM SB81, 72 μl 400 μM SB82, 120 μl 10× T4 ligase buffer, 336 μl H<sub>2</sub>O, 600 μL 0.5 M EDTA.</p></sec><sec id="s4-4-4"><title>Round 1 RT reaction</title><p>About 3×10<sup>7</sup> cells were introduced into an RT reaction mix composed of 240 μl 5× RT buffer, 24 μl dNTPs (N0447L, NEB), 12 μl SUPERase In RNase Inhibitor, and 24 μl Maxima H Minus Reverse Transcriptase (EP0753, Thermo Fisher Scientific), 132 μl PEG8000 (50%). Nuclease-free water was added to achieve a total reaction volume of 960 μl, and the mixture was thoroughly mixed by vortexing. Subsequently, 8 μl of the reaction mixture was dispensed into each well of a 96-well plate, where 2 μl of each RT primer had been added previously. The sealed 96-well plate was inverted repeatedly for thorough mixing, followed by a brief spin. The plate was then incubated as follows: 50°C for 10 min, 8°C for 12 s, 15°C for 45 s, 20°C for 45 s, 30°C for 30 s, 42°C for 6 min, 50°C for 16 min, and finally held at 4°C. After the RT process, all 96 reactions were pooled into one tube. 75 μl of 0.5% Tween-20 was added, and the reactions were incubated on ice for 3 min. Cells were centrifuged at 7000×<italic>g</italic> for 10 min at 4°C and then resuspended in 0.4 ml PBS-RI. Thirty-two microliters of 0.5% Tween-20 was added, and the cells underwent centrifugation at 7000×<italic>g</italic> for 10 min at 4°C.</p></sec><sec id="s4-4-5"><title>Round 2 ligation reaction</title><p>Cells were resuspended in 500 μl 1× T4 ligase buffer, followed by the addition of 107.5 μl PEG8000, 37.5 μl 10× T4 ligase buffer, 16.7 μl SUPERase In RNase Inhibitor, 5.6 μl BSA, and 27.9 μl T4 ligase (M0202L, NEB). The reaction solution was thoroughly mixed by vortexing. Subsequently, 5.76 μl of the reaction mixture was dispensed into each well of a 96-well plate, where 2.24 μl of each round 2 ligation primer had been added previously. The sealed 96-well plate was inverted repeatedly for thorough mixing and then subjected to a short spin. The plate was incubated at 37°C for 45 min. Following this, 2 μl of round 2 blocking mix was added to each well and incubated at 37°C for an additional 45 min. All 96 reactions were pooled into one tube after incubation.</p></sec><sec id="s4-4-6"><title>Round 3 ligation reaction</title><p>A mixture comprising 89 μl H<sub>2</sub>O, 26 μl PEG8000, 46 μl 10× T4 ligase buffer, and 12.65 μl T4 ligase was prepared and thoroughly mixed by vortexing. Subsequently, 8.51 μl of the reaction mixture was dispensed into each well of a 96-well plate, where 3.49 μl of each round 3 ligation primer had been added previously. The sealed 96-well plate was inverted repeatedly for thorough mixing and then subjected to a brief spin. The plate was incubated at 37°C for 45 min. Following this, 10 μl of round 3 blocking mix was added to each well and incubated at 37°C for an additional 45 min. All 96 reactions were combined into one tube after incubation.</p></sec><sec id="s4-4-7"><title>Cells lysis</title><p>42 μl of 0.5% Tween-20 was added, and cells were centrifuged at 7000×<italic>g</italic> for 10 min at 4°C. The cells underwent two washes using 200 μl TEL-RI containing 0.01% Tween-20, each time centrifuged at 7,000×<italic>g</italic> for 10 min at 4°C. Subsequently, cells were resuspended in 30 μl TEL-RI buffer. Cell counting and integrity checks were performed using the ACEA NovoCyte flow cytometer with a 100× oil immersion lens. A moderate amount of cells was then added to the lysis buffer (50 mM Tris pH 8.0, 25 mM EDTA, 200 mM NaCl, 0.5% Triton X-100), and 5 μl of proteinase K (AM2548, Invitrogen) was introduced. Samples were incubated at 55°C for 60 min and gently mixed every minute.</p></sec><sec id="s4-4-8"><title>Library construction</title><p>To facilitate template switching, lysates were purified with VAHTS DNA Clean Beads (N411, Vazyme) at a ratio of 2.0×, and cDNA was eluted in 12 μl of water. The purified cDNA was then combined with 4 μl of 5× RT buffer, 1 μl of dNTPs (N0447L, NEB), 0.5 μl of SUPERase In RNase Inhibitor, 0.5 μl of Maxima H Minus Reverse Transcriptase, and 2 μl of the TSO (<xref ref-type="bibr" rid="bib22">Picelli et al., 2013</xref>) primer (100 mM, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). This reaction solution underwent incubation as follows: 25°C for 30 min, 42°C for 90 min, 85°C for 5 min, and then held at 4°C. Subsequently, 1 μl of RNaseH was added, and the reaction solution was incubated at 37°C for 30 min. The cDNA was purified once again with VAHTS DNA Clean Beads at a ratio of 2.0× and eluted in 13 μl of H<sub>2</sub>O. The integrity of the cDNA was assessed using primers TSO-2 and R1 or R2 or R3 by qPCR (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>).</p></sec><sec id="s4-4-9"><title>Ribosomal RNA-derived cDNA depletion</title><p>We developed a set of cDNA probe primers to selectively deplete r-cDNA (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). These probe primers possess the ability to specifically hybridize with r-cDNA and also hybridize with a biotin-labeled universal primer. In the reaction, 5 μl of r-cDNA probe primers (10 μM), 2.5 μl of 10× hybridization buffer (Tris-HCl pH 8.0 100 mM, NaCl 500 mM, EDTA pH 8.0 10 mM), and 5 μl of biotin primer (10 μM) were added to 12.5 μl of purified cDNA. The reaction solution underwent incubation as follows: 95°C for 2 min, followed by a temperature decrease to 20°C at a ramp speed of −0.1 °C/s, and then held at 37°C for 30 min. Subsequently, 20 μl of Streptavidin magnetic beads (BEAVER, 22307) was washed twice using 1 ml of 1× B&amp;W buffer (Tris-HCl pH 7.5 10 mM, EDTA 1 mM, NaCl 1 M, Tween-20 0.05%) and resuspended in 25 μl of 2× B&amp;W buffer. Twenty-five microliters of washed Streptavidin magnetic beads were added to 25 μl of annealed cDNA. The reaction solution was incubated at room temperature for 30 min with gentle mixing per minute. Following this, the reaction solution tube was placed into a magnetic stand to collect the supernatant. The cDNA depleted of r-cDNA was purified using VAHTS DNA Clean Beads at a ratio of 2.0× and eluted in 12.5 μl of H<sub>2</sub>O. The depletion of r-cDNA could be repeated using the above protocol, and ultimately, the cDNA was eluted in 20 μl of H<sub>2</sub>O. We designed separate probe sets for <italic>E. coli</italic>, <italic>C. crescentus</italic>, and <italic>S. aureus</italic>. Each set was specifically constructed to be reverse complementary to the r-cDNA sequences of its respective bacterial species. This species-specific approach ensures high efficiency and specificity in rRNA depletion for each organism.</p></sec><sec id="s4-4-10"><title>Library amplification and sequencing</title><p>To the 20 μl cDNA solution, the following components were added: 2.4 μl R3 primer (10 mM, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>), 2.4 μl TSO-2 primer (10 mM, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>), 40 μl 2× KAPA HIFI mix (KAPA, 2602), 1.6 μl SYBR Green (25×), 0.8 μl MgCl<sub>2</sub> (0.1 M), and 12.8 μl H<sub>2</sub>O. This PCR solution was placed in a thermocycler and incubated with the following parameters: 98°C for 45 s, followed by cycling of 98°C for 15 s, 60°C for 30 s, and 72°C for 60 s. Cycling continued on a qPCR machine until the reaction approached saturation. PCR products were then purified using VAHTS DNA Clean Beads at a ratio of 0.9× and eluted in 25 μl of H<sub>2</sub>O. Finally, the purified PCR products underwent end repair and adaptor ligation using the VAHTS Universal DNA Library Prep Kit for Illumina V3 (Vazyme, ND607).</p></sec></sec><sec id="s4-5"><title>Bulk RNA-seq library construction</title><p>Total RNA of the samples was extracted utilizing the Bacteria RNA Extraction Kit (R403-01, Vazyme). Subsequently, the RNA underwent mRNA enrichment (N407, Vazyme), fragmentation, cDNA synthesis, and library preparation using the VAHTSTM Total RNA-seq (H/M/R) Library Prep Kit for Illumina (NR603, Vazyme).</p></sec><sec id="s4-6"><title>Bioinformatics analysis methods</title><sec id="s4-6-1"><title>Single-cell analysis</title><p>The sequencing data underwent processing into matrices using scripts and a pipeline as previously described (<xref ref-type="bibr" rid="bib1">Blattman et al., 2020</xref>) in Python 2.7.15, with some modifications (the detailed original code and all the data were deposited in the GEO repository). After the count tables were made, subsequent analysis of single-cell data was conducted using Seurat (<xref ref-type="bibr" rid="bib6">Hao et al., 2021</xref>) package (version 4.3.0; <ext-link ext-link-type="uri" xlink:href="http://satijalab.org/seurat/">http://satijalab.org/seurat/</ext-link>) in R (<ext-link ext-link-type="uri" xlink:href="https://www.r-project.org/">https://www.r-project.org/</ext-link>). Since there were two replicates of static <italic>E. coli</italic> biofilm, these two datasets were merged into one SeuratObject and batch effects were removed. However, the samples for exponential period <italic>E. coli, S. aureus,</italic> and <italic>C. crescentus</italic> only had one sample, so they did not need this process. At the beginning of doing the scRNA-seq analysis, we screened the data of all samples. For preprocessing of static <italic>E. coli</italic> biofilm data, cells were filtered with UMI per cell more than 100 and less than 2000 for replicate 1 and replicate 2 to obtain 1621 and 3999 cells, respectively. For data of exponential period <italic>E. coli</italic>, the data was screened for cells with UMIs greater than 200 and less than 5000 to obtain 1464 cells. The screening criteria of <italic>S. aureus</italic> were cells with UMIs greater than 15 and less than 1000 and genes greater than 30 (1000&gt;UMIs&gt;15, gene counts&gt;30). The screening criteria of <italic>C. crescentus</italic> were cells with UMIs greater than 200 and less than 5000 and gene counts greater than 30 (5000&gt;UMIs&gt;200, gene counts&gt;30). After screening, all the data were normalized using a scale factor of 10,000 through a global-scaling normalization method called ‘LogNormalize’. Highly variable features were then identified, returning 500 features per dataset. Then we combine the data of the two replicates of static <italic>E. coli</italic> biofilm into a single SeuratObject by FindIntegrationAnchors and IntegrateData functions. Then all the data underwent scaling using the ScaleData function, followed by dimension reduction through principal component analysis. To avoid subtle batch effects influencing downstream analyses, we removed batch effects using RunHarmony (<xref ref-type="bibr" rid="bib10">Korsunsky et al., 2019</xref>) for the two replicates of static <italic>E. coli</italic> biofilm data. Then a graph-based clustering approach was employed in all data to identify clusters of gene expression programs using the Louvain algorithm (Seurat 4.3.0). The dims we chose were 6. And the resolution was 0.3 for <italic>C. crescentus</italic> and <italic>S. aureus</italic> or 0.4 for <italic>E. coli</italic> data. Marker genes for each cluster were computed using the Wilcoxon rank-sum test. Specifically, marker genes for each cluster were initially obtained using the FindMarkers function of Seurat. Then we performed pathway enrichment analysis of marker gene by clusterProfiler function (<xref ref-type="bibr" rid="bib33">Yu et al., 2012</xref>) within R. For transcriptome-wide gene coverage across the cell population, we counted the number of genes expressing at least one UMI. Then we calculated the percentage of these genes out of all the genes in each bacterium.</p></sec><sec id="s4-6-2"><title>Comparison of scRNA-seq with bulk RNA-seq</title><p>The bulk RNA-seq clean data reads were mapped to the <italic>E. coli</italic> MG1655 k12 genome (EnsemblBacteria Taxonomy ID: 511145) using the BWA aligner software (v0.7.17-r1188, <ext-link ext-link-type="uri" xlink:href="https://github.com/lh3/bwa">https://github.com/lh3/bwa</ext-link>: <xref ref-type="bibr" rid="bib14">Li, 2024</xref>). Sam files were converted to bam files using samtools (v1.9). The mapping results were counted by featureCounts (<ext-link ext-link-type="uri" xlink:href="https://subread.sourceforge.net/">https://subread.sourceforge.net/</ext-link>; <xref ref-type="bibr" rid="bib15">Liao et al., 2024</xref>) to generate expression results. Single-cell and bulk transcriptomes of <italic>E. coli</italic> were compared by computing the Pearson correlation of log<sub>2</sub> reads per gene of bulk RNA-seq and log<sub>2</sub> UMI per gene of scRNA-seq.</p></sec><sec id="s4-6-3"><title>Sequencing saturation of the libraries</title><p>To assess sequencing saturation, we generated five subsamples from the single-cell sequencing data, representing 20%, 40%, 60%, 80%, and 100% of the total data. Each subsample was analyzed independently following the previously described single-cell sequencing data analysis process. We then created gene expression matrices for each subsample based on the analysis results. The number of UMIs or genes was counted for each cell detected in each subsample. Next, we sorted the cells in descending order based on their UMI counts or gene counts and selected different numbers of cells from this sorted list, starting from those with the highest UMI or gene counts. For each selection of cells, we calculated the median number of UMIs or genes. Finally, we created a line graph representing the median UMI counts and genes using GraphPad Prism 9 software, allowing us to visualize the sequencing saturation across the different subsamples.</p><p>In addition, we used the saturation calculation method of 10x Genomics to further detect the saturation of the data. The formula for calculating this metric is as follows:</p><p>Sequencing Saturation = 1 - (n_deduped_reads / n_reads). Given the differences between RiboD-PETRI and 10x Genomics datasets, we have adapted the calculation as follows:</p><p>n_deduped_reads: The number of UMIs as a measure of unique reads.</p><p>n_reads: The total number of confidently mapped reads.</p></sec><sec id="s4-6-4"><title>Multiplet frequency determination</title><p>Determination of the multiplet frequency was essential in assessing the efficiency of single-cell capture in RiboD-PETRI. This frequency is defined as the probability that a non-empty barcode corresponds to more than one cell. To calculate it, we used a Poisson distribution-based approach involving several key steps. Initially, we calculated the proportion of barcodes corresponding to zero cells using the formula p(0) = <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:msup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mn>0</mml:mn><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:msup><mml:mi mathvariant="normal">e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. Then, we determined the proportion for one cell, p(1)= <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:msup><mml:mi mathvariant="normal">e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, and derived the proportions for more than zero cells <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>≥</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and more than one cell <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>≥</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. These values allow for the calculation of the multiplet frequency as <inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>≥</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula>. The parameter λ plays a vital role in this model, representing the ratio of the number of cells to the total number of possible barcode combinations.</p></sec></sec><sec id="s4-7"><title>Flow cytometry sorting of bacteria and analysis</title><p>All samples were measured using a Beckman CytoFLEX SRT flow cytometer with a 70 μm nozzle, using normal saline as sheath fluid. During the 24 hr static biofilm growth phase, strains labeled with BFP, PdeI-BFP, PdeI(G412S)-BFP, or c-di-GMP sensors were washed and resuspended in sterile PBS. Microorganisms were identified based on forward scatter and side scatter parameters. Cells were sorted into distinct groups according to their fluorescence intensity, with V450 used for BFP, FITC for mVenusNB, and ECD for mScarlet-I. The resulting data were subsequently analyzed using FlowJo V10 software (Tree Star, Inc).</p></sec><sec id="s4-8"><title>Antibiotic killing and persister counting assay</title><p>Cells sorted by flow cytometry were resuspended in fresh LB supplemented with 150 μg/ml ampicillin. The suspension was then incubated at 37°C for 3 hr with continuous shaking at 220 rpm. To determine the initial cell count, an aliquot of the cell suspension was taken before the ampicillin challenge, serially diluted, and plated on LB agar plates for colony-forming unit (CFU) enumeration. These plates were incubated overnight at 37°C. Following the ampicillin challenge, cells were harvested by centrifugation, washed once with sterile PBS to remove residual antibiotic, and resuspended in fresh PBS. This suspension was then serially diluted and plated on LB agar plates for post-challenge CFU counts. The persister ratio was calculated as the number of CFUs after ampicillin challenge divided by the number of CFUs before challenge. All experiments were performed in triplicate, with the results presented as means ± standard deviations of three independent biological replicates.</p></sec><sec id="s4-9"><title>Microscopy</title><sec id="s4-9-1"><title>Bright-field and fluorescence imaging</title><p>Inverted microscopes, specifically the Nikon Eclipse Ti2 and Leica Stellaris 5 WLL, were employed for imaging, utilizing different lasers for illumination: a 405 nm laser for BFP and a 488 nm laser for GFP. Fluorescence emission signals were captured using an sCMOS camera (pco.edge 4.2 bi). Dedicated filter sets corresponding to the spectral characteristics of each fluorophore were utilized. Image analysis was performed with ImageJ software (Fiji). For the analysis of the c-di-GMP sensor, the ratio of mVenusNB to mScarlet-I (R) displayed a negative correlation with c-di-GMP concentration. Consequently, the value of R<sup>−1</sup> demonstrated a positive correlation with c-di-GMP concentration.</p></sec><sec id="s4-9-2"><title>Time-lapse imaging</title><p>To investigate the processes of antibiotic killing and bacterial resuscitation, cells labeled with PdeI-GFP during the 24 hr static growth phase were collected and washed twice with PBS. These cells were then imaged on a gel pad composed of 3% low melting temperature agarose in PBS, which was prepared as a gel island in the center of the FCS3 chamber. The cells were observed under either bright-field or epifluorescence illumination. Following the imaging, the gel pad was surrounded by LB containing 150 μg/ml ampicillin, and the cells were incubated for 6 hr at 35°C. Fresh LB was subsequently flushed in, and the growth medium was refreshed every 3 hr, ensuring sufficient recovery time for the cells.</p></sec></sec><sec id="s4-10"><title>Determination of c-di-GMP concentration by HPLC-MS/MS</title><p>The determination of c-di-GMP concentration by HPLC-MS/MS involved a series of steps. Initially, MG1655 Δara pBAD::<italic>pdeI</italic> and MG1655 Δara pBAD::empty-vector strains were grown to mid-exponential growth phase, followed by induction with 0.002% arabinose. After a 2 hr incubation period, cells were harvested and washed with PBS. The washed cells were then rapidly frozen using liquid nitrogen. Simultaneously, another portion of washed cells was stained with SYTO 24 and quantified using flow cytometry. The determination of c-di-GMP concentration was conducted by Wuhan Lixinheng Technology Co. Ltd. through HPLC-MS/MS. In the experiment, first, for cell samples, addition of 500 μl of extract solvent (precooled at –20°C, acetonitrile-methanol water, 2:2:1), the samples were vortexed for 30 s, homogenized at 38 Hz for 4 min, and sonicated for 5 min in ice-water bath. The homogenate and sonicate circle were repeated for three times, followed by incubation at –20°C for 1 hr and centrifugation at 12,000 rpm and 4°C for 15 min. An 80 μl aliquot of the clear supernatant was transferred to an auto-sampler vial for LC-MS/MS analysis. The UHPLC separation was carried out using an Waters ACQUITY H-class plus UPLC System, equipped with Agilent ZORBAX Eclipse Plus C18 column (2.1 mm × 150 mm, 1.8 μm). An Waters Xevo TQ-XS triple quadrupole mass spectrometer, equipped with an electrospray ionization interface, was applied for assay development. All strains were assayed in biological triplicates, and the measured values were converted into intracellular c-di-GMP concentrations (pg) per cell.</p></sec><sec id="s4-11"><title>Quantification and statistical analysis</title><p>Statistical analysis was conducted using GraphPad Prism 9 software for Windows. The significance of results was determined using a two-tailed Student’s t-test. Error bars in the data representation indicate the standard deviations of the mean from a minimum of three independent experiments. A significance threshold of p&lt;0.05 was applied throughout the analysis. To denote significant differences in the results, a system of asterisks was used: * for p&lt;0.05, ** for p&lt;0.01, *** for p&lt;0.001, and **** for p&lt;0.0001. This comprehensive approach ensured a thorough and statistically sound analysis of the c-di-GMP concentration in the studied bacterial strains.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Project administration, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Resources, Software, Formal analysis, Validation, Investigation, Methodology, Project administration</p></fn><fn fn-type="con" id="con3"><p>Formal analysis, Validation</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Investigation</p></fn><fn fn-type="con" id="con5"><p>Software, Validation</p></fn><fn fn-type="con" id="con6"><p>Resources, Funding acquisition</p></fn><fn fn-type="con" id="con7"><p>Conceptualization, Resources, Supervision, Funding acquisition, Writing – original draft, Project administration, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Primers used in this study.</title><p>Related to RiboD-PETRI library construction.</p></caption><media mimetype="application" mime-subtype="xls" xlink:href="elife-97543-supp1-v1.xls"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>Multiplet frequency.</title><p>The specific calculation process for multiplet frequency.</p></caption><media mimetype="application" mime-subtype="xls" xlink:href="elife-97543-supp2-v1.xls"/></supplementary-material><supplementary-material id="supp3"><label>Supplementary file 3.</label><caption><title>rRNA and mRNA expression of PETRI-seq and RiboD-PETRI.</title></caption><media mimetype="application" mime-subtype="xls" xlink:href="elife-97543-supp3-v1.xls"/></supplementary-material><supplementary-material id="supp4"><label>Supplementary file 4.</label><caption><title>Various methods in rRNA depletion.</title></caption><media mimetype="application" mime-subtype="xls" xlink:href="elife-97543-supp4-v1.xls"/></supplementary-material><supplementary-material id="supp5"><label>Supplementary file 5.</label><caption><title>Sequencing information.</title><p>The detailed information of RiboD-PETRI libraries.</p></caption><media mimetype="application" mime-subtype="xls" xlink:href="elife-97543-supp5-v1.xls"/></supplementary-material><supplementary-material id="supp6"><label>Supplementary file 6.</label><caption><title>The cost of RiboD-PETRI.</title><p>The detailed cost breakdown of RiboD-PETRI.</p></caption><media mimetype="application" mime-subtype="xls" xlink:href="elife-97543-supp6-v1.xls"/></supplementary-material><supplementary-material id="supp7"><label>Supplementary file 7.</label><caption><title>Matrix_of_<italic>E. coli</italic>_3h_data_by_RiboD-PETRI_in_<xref ref-type="fig" rid="fig1">Figure 1C–E</xref>.</title></caption><media xlink:href="elife-97543-supp7-v1.zip" mimetype="application" mime-subtype="zip"/></supplementary-material><supplementary-material id="supp8"><label>Supplementary file 8.</label><caption><title>Matrix_of_<italic>E. coli</italic>_data_by_PETRI-seq_in_<xref ref-type="fig" rid="fig1">Figure 1C</xref>.</title></caption><media xlink:href="elife-97543-supp8-v1.zip" mimetype="application" mime-subtype="zip"/></supplementary-material><supplementary-material id="supp9"><label>Supplementary file 9.</label><caption><title>Matrix_of_<italic>E. coli</italic>_data_by_PETRI-seq_in_<xref ref-type="fig" rid="fig1">Figure 1D</xref>.</title></caption><media xlink:href="elife-97543-supp9-v1.zip" mimetype="application" mime-subtype="zip"/></supplementary-material><supplementary-material id="supp10"><label>Supplementary file 10.</label><caption><title><italic>E. coli</italic> RNA-seq data.</title><p>The result of bulk RNA-seq of exponential period <italic>E. coli</italic> sample in <xref ref-type="fig" rid="fig1">Figure 1E</xref>.</p></caption><media mimetype="application" mime-subtype="xls" xlink:href="elife-97543-supp10-v1.xls"/></supplementary-material><supplementary-material id="supp11"><label>Supplementary file 11.</label><caption><title>Matrix_of_Exponential_period_<italic>E. coli</italic>_data.</title></caption><media xlink:href="elife-97543-supp11-v1.zip" mimetype="application" mime-subtype="zip"/></supplementary-material><supplementary-material id="supp12"><label>Supplementary file 12.</label><caption><title>Matrix_of_Static_<italic>E. coli</italic>_biofilm-1_data.</title></caption><media xlink:href="elife-97543-supp12-v1.zip" mimetype="application" mime-subtype="zip"/></supplementary-material><supplementary-material id="supp13"><label>Supplementary file 13.</label><caption><title>Matrix_of_Static_<italic>E. coli</italic>_biofilm-2_data.</title></caption><media xlink:href="elife-97543-supp13-v1.zip" mimetype="application" mime-subtype="zip"/></supplementary-material><supplementary-material id="supp14"><label>Supplementary file 14.</label><caption><title>Matrix_of_SA_data.</title></caption><media xlink:href="elife-97543-supp14-v1.zip" mimetype="application" mime-subtype="zip"/></supplementary-material><supplementary-material id="supp15"><label>Supplementary file 15.</label><caption><title>Matrix_of_CC_data.</title></caption><media xlink:href="elife-97543-supp15-v1.zip" mimetype="application" mime-subtype="zip"/></supplementary-material><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-97543-mdarchecklist1-v1.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>Sequencing data have been deposited in GEO under accession codes GSE260458. All data generated or analysed during this study are included in the manuscript and supporting files; source data files have been provided for <xref ref-type="fig" rid="fig1">Figures 1</xref>—<xref ref-type="fig" rid="fig4">4</xref> and <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref> and <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>.</p><p>The following dataset was generated:</p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset1"><person-group person-group-type="author"><name><surname>Yan</surname><given-names>X</given-names></name><name><surname>Liao</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Huang</surname><given-names>C</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Guo</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>An improved bacterial single-cell RNA-seq reveals biofilm heterogeneity</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE260458">GSE260458</pub-id></element-citation></p><p>The following previously published datasets were used:</p><p><element-citation publication-type="data" specific-use="references" id="dataset2"><person-group person-group-type="author"><name><surname>Kuchina</surname><given-names>A</given-names></name><name><surname>Brettner</surname><given-names>LM</given-names></name><name><surname>Paleologu</surname><given-names>L</given-names></name><name><surname>Roco</surname><given-names>CM</given-names></name><name><surname>Rosenberg</surname><given-names>AB</given-names></name><name><surname>Carignano</surname><given-names>A</given-names></name><name><surname>Kibler</surname><given-names>R</given-names></name><name><surname>Hirano</surname><given-names>W</given-names></name><name><surname>William DePaolo</surname><given-names>R</given-names></name><name><surname>Seelig</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Microbial single-cell RNA sequencing by split-pool barcoding</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE151940">GSE151940</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset3"><person-group person-group-type="author"><name><surname>Blattman</surname><given-names>SB</given-names></name><name><surname>Jiang</surname><given-names>W</given-names></name><name><surname>Oikonomou</surname><given-names>P</given-names></name><name><surname>Tavazoie</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Prokaryotic Single-Cell RNA Sequencing by In Situ Combinatorial Indexing</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE141018">GSE141018</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset4"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>B</given-names></name><name><surname>Lin</surname><given-names>AE</given-names></name><name><surname>Yuan</surname><given-names>J</given-names></name><name><surname>Novak</surname><given-names>KE</given-names></name><name><surname>Koch</surname><given-names>MD</given-names></name><name><surname>Wingreen</surname><given-names>NS</given-names></name><name><surname>Adamson</surname><given-names>B</given-names></name><name><surname>Gitai</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>Massively-parallel Microbial mRNA Sequencing (M3-Seq) reveals heterogenous behaviors in bacteria at single-cell resolution</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE231935">GSE231935</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset5"><person-group person-group-type="author"><name><surname>Imdahl</surname><given-names>F</given-names></name><name><surname>Vafadarnejad</surname><given-names>V</given-names></name><name><surname>Homberger</surname><given-names>C</given-names></name><name><surname>Saliba</surname><given-names>A-E</given-names></name><name><surname>Vogel</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Single-cell RNA-seq reports growth condition-specific global transcriptomes of individual bacteria</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE119888">GSE119888</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset6"><person-group person-group-type="author"><name><surname>Ma</surname><given-names>P</given-names></name><name><surname>Amemiya</surname><given-names>HM</given-names></name><name><surname>He</surname><given-names>L</given-names></name><name><surname>Gandhi</surname><given-names>SJ</given-names></name><name><surname>Nicol</surname><given-names>R</given-names></name><name><surname>Bhattacharyya</surname><given-names>RB</given-names></name><name><surname>Smillie</surname><given-names>CS</given-names></name><name><surname>Hung</surname><given-names>DT</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>Bacterial droplet-based single-cell RNA-seq reveals antibiotic-associated heterogeneous cellular states</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE180237">GSE180237</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank Prof. Fan Bai (Peking University) for valuable discussions. We thank Drs. Jidong Xing and Ziyang Liu for support in bioinformatics. We also thank the members of our laboratory for helpful discussion. This work is supported by the grants to YP from the National Key R&amp;D Program of China (2021YFC2701602), the National Natural Science Foundation of China (31970089), Science Fund for Distinguished Young Scholars of Hubei Province (2022CFA077),</p><p>Major Project of Guangzhou National Laboratory (GZNL2024A01023), and the Fundamental Research Funds for the Central Universities (2042022dx0003). This work is also supported by CG from the Natural Science Foundation of Yunnan Province of China (202001BB050005). We also thank all the staff in the Core Facilities of Medical Research Institute at Wuhan University and the Core Facilities at School of Life Sciences at Peking University for their technical support.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blattman</surname><given-names>SB</given-names></name><name><surname>Jiang</surname><given-names>W</given-names></name><name><surname>Oikonomou</surname><given-names>P</given-names></name><name><surname>Tavazoie</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Prokaryotic single-cell RNA sequencing by in situ combinatorial indexing</article-title><source>Nature Microbiology</source><volume>5</volume><fpage>1192</fpage><lpage>1201</lpage><pub-id pub-id-type="doi">10.1038/s41564-020-0729-6</pub-id><pub-id pub-id-type="pmid">32451472</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cheng</surname><given-names>J</given-names></name><name><surname>Gan</surname><given-names>G</given-names></name><name><surname>Zheng</surname><given-names>S</given-names></name><name><surname>Zhang</surname><given-names>G</given-names></name><name><surname>Zhu</surname><given-names>C</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Hu</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Biofilm heterogeneity-adaptive photoredox catalysis enables red light-triggered nitric oxide release for combating drug-resistant infections</article-title><source>Nature Communications</source><volume>14</volume><elocation-id>7510</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-023-43415-8</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Costerton</surname><given-names>JW</given-names></name><name><surname>Stewart</surname><given-names>PS</given-names></name><name><surname>Greenberg</surname><given-names>EP</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Bacterial biofilms: a common cause of persistent infections</article-title><source>Science</source><volume>284</volume><fpage>1318</fpage><lpage>1322</lpage><pub-id pub-id-type="doi">10.1126/science.284.5418.1318</pub-id><pub-id pub-id-type="pmid">10334980</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Evans</surname><given-names>CR</given-names></name><name><surname>Smiley</surname><given-names>MK</given-names></name><name><surname>Asahara Thio</surname><given-names>S</given-names></name><name><surname>Wei</surname><given-names>M</given-names></name><name><surname>Florek</surname><given-names>LC</given-names></name><name><surname>Dayton</surname><given-names>H</given-names></name><name><surname>Price-Whelan</surname><given-names>A</given-names></name><name><surname>Min</surname><given-names>W</given-names></name><name><surname>Dietrich</surname><given-names>LEP</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Spatial heterogeneity in biofilm metabolism elicited by local control of phenazine methylation</article-title><source>PNAS</source><volume>120</volume><elocation-id>e2313208120</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2313208120</pub-id><pub-id pub-id-type="pmid">37847735</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flemming</surname><given-names>HC</given-names></name><name><surname>van Hullebusch</surname><given-names>ED</given-names></name><name><surname>Neu</surname><given-names>TR</given-names></name><name><surname>Nielsen</surname><given-names>PH</given-names></name><name><surname>Seviour</surname><given-names>T</given-names></name><name><surname>Stoodley</surname><given-names>P</given-names></name><name><surname>Wingender</surname><given-names>J</given-names></name><name><surname>Wuertz</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>The biofilm matrix: multitasking in a shared space</article-title><source>Nature Reviews. Microbiology</source><volume>21</volume><fpage>70</fpage><lpage>86</lpage><pub-id pub-id-type="doi">10.1038/s41579-022-00791-0</pub-id><pub-id pub-id-type="pmid">36127518</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hao</surname><given-names>Y</given-names></name><name><surname>Hao</surname><given-names>S</given-names></name><name><surname>Andersen-Nissen</surname><given-names>E</given-names></name><name><surname>Zheng</surname><given-names>S</given-names></name><name><surname>Butler</surname><given-names>A</given-names></name><name><surname>Lee</surname><given-names>MJ</given-names></name><name><surname>Wilk</surname><given-names>AJ</given-names></name><name><surname>Darby</surname><given-names>C</given-names></name><name><surname>Zager</surname><given-names>M</given-names></name><name><surname>Hoffman</surname><given-names>P</given-names></name><name><surname>Stoeckius</surname><given-names>M</given-names></name><name><surname>Papalexi</surname><given-names>E</given-names></name><name><surname>Mimitou</surname><given-names>EP</given-names></name><name><surname>Jain</surname><given-names>J</given-names></name><name><surname>Srivastava</surname><given-names>A</given-names></name><name><surname>Stuart</surname><given-names>T</given-names></name><name><surname>Fleming</surname><given-names>LM</given-names></name><name><surname>Yeung</surname><given-names>B</given-names></name><name><surname>Rogers</surname><given-names>AJ</given-names></name><name><surname>McElrath</surname><given-names>JM</given-names></name><name><surname>Blish</surname><given-names>CA</given-names></name><name><surname>Gottardo</surname><given-names>R</given-names></name><name><surname>Smibert</surname><given-names>P</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Integrated analysis of multimodal single-cell data</article-title><source>Cell</source><volume>184</volume><fpage>3573</fpage><lpage>3587</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2021.04.048</pub-id><pub-id pub-id-type="pmid">34062119</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Homberger</surname><given-names>C</given-names></name><name><surname>Hayward</surname><given-names>RJ</given-names></name><name><surname>Barquist</surname><given-names>L</given-names></name><name><surname>Vogel</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Improved bacterial single-cell RNA-seq through automated MATQ-seq and cas9-based removal of rRNA reads</article-title><source>mBio</source><volume>14</volume><elocation-id>e0355722</elocation-id><pub-id pub-id-type="doi">10.1128/mbio.03557-22</pub-id><pub-id pub-id-type="pmid">36880749</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Imdahl</surname><given-names>F</given-names></name><name><surname>Vafadarnejad</surname><given-names>E</given-names></name><name><surname>Homberger</surname><given-names>C</given-names></name><name><surname>Saliba</surname><given-names>AE</given-names></name><name><surname>Vogel</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Single-cell RNA-sequencing reports growth-condition-specific global transcriptomes of individual bacteria</article-title><source>Nature Microbiology</source><volume>5</volume><fpage>1202</fpage><lpage>1206</lpage><pub-id pub-id-type="doi">10.1038/s41564-020-0774-1</pub-id><pub-id pub-id-type="pmid">32807892</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Korshoj</surname><given-names>LE</given-names></name><name><surname>Kielian</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Bacterial Single-Cell RNA Sequencing Captures Biofilm Transcriptional Heterogeneity and Differential Responses to Immune Pressure</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2024.06.28.601229</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Korsunsky</surname><given-names>I</given-names></name><name><surname>Millard</surname><given-names>N</given-names></name><name><surname>Fan</surname><given-names>J</given-names></name><name><surname>Slowikowski</surname><given-names>K</given-names></name><name><surname>Zhang</surname><given-names>F</given-names></name><name><surname>Wei</surname><given-names>K</given-names></name><name><surname>Baglaenko</surname><given-names>Y</given-names></name><name><surname>Brenner</surname><given-names>M</given-names></name><name><surname>Loh</surname><given-names>PR</given-names></name><name><surname>Raychaudhuri</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Fast, sensitive and accurate integration of single-cell data with Harmony</article-title><source>Nature Methods</source><volume>16</volume><fpage>1289</fpage><lpage>1296</lpage><pub-id pub-id-type="doi">10.1038/s41592-019-0619-0</pub-id><pub-id pub-id-type="pmid">31740819</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuchina</surname><given-names>A</given-names></name><name><surname>Brettner</surname><given-names>LM</given-names></name><name><surname>Paleologu</surname><given-names>L</given-names></name><name><surname>Roco</surname><given-names>CM</given-names></name><name><surname>Rosenberg</surname><given-names>AB</given-names></name><name><surname>Carignano</surname><given-names>A</given-names></name><name><surname>Kibler</surname><given-names>R</given-names></name><name><surname>Hirano</surname><given-names>M</given-names></name><name><surname>DePaolo</surname><given-names>RW</given-names></name><name><surname>Seelig</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Microbial single-cell RNA sequencing by split-pool barcoding</article-title><source>Science</source><volume>371</volume><elocation-id>eaba5257</elocation-id><pub-id pub-id-type="doi">10.1126/science.aba5257</pub-id><pub-id pub-id-type="pmid">33335020</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lacanna</surname><given-names>E</given-names></name><name><surname>Bigosch</surname><given-names>C</given-names></name><name><surname>Kaever</surname><given-names>V</given-names></name><name><surname>Boehm</surname><given-names>A</given-names></name><name><surname>Becker</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Evidence for <italic>Escherichia coli</italic> diguanylate cyclase DgcZ interlinking surface sensing and adhesion via multiple regulatory routes</article-title><source>Journal of Bacteriology</source><volume>198</volume><fpage>2524</fpage><lpage>2535</lpage><pub-id pub-id-type="doi">10.1128/JB.00320-16</pub-id><pub-id pub-id-type="pmid">27402625</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>S</given-names></name><name><surname>Liu</surname><given-names>Q</given-names></name><name><surname>Duan</surname><given-names>C</given-names></name><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Sun</surname><given-names>H</given-names></name><name><surname>Xu</surname><given-names>L</given-names></name><name><surname>Yang</surname><given-names>Q</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Shen</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>c-di-GMP inhibits the DNA binding activity of H-NS in <italic>Salmonella</italic></article-title><source>Nature Communications</source><volume>14</volume><elocation-id>7502</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-023-43442-5</pub-id><pub-id pub-id-type="pmid">37980414</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>Bwa</data-title><version designator="79b230d">79b230d</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/lh3/bwa">https://github.com/lh3/bwa</ext-link></element-citation></ref><ref id="bib15"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Liao</surname><given-names>Y</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name><name><surname>Shi</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>Subread package: high-performance read alignment, quantification and mutation discovery</data-title><source>SourceForge</source><ext-link ext-link-type="uri" xlink:href="https://subread.sourceforge.net/">https://subread.sourceforge.net/</ext-link></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>J</given-names></name><name><surname>Sheng</surname><given-names>Y</given-names></name><name><surname>Qian</surname><given-names>W</given-names></name><name><surname>Pan</surname><given-names>M</given-names></name><name><surname>Zhao</surname><given-names>X</given-names></name><name><surname>Ge</surname><given-names>Q</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>scRNA-seq data analysis method to improve analysis performance</article-title><source>IET Nanobiotechnology</source><volume>17</volume><fpage>246</fpage><lpage>256</lpage><pub-id pub-id-type="doi">10.1049/nbt2.12115</pub-id><pub-id pub-id-type="pmid">36727937</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ma</surname><given-names>P</given-names></name><name><surname>Amemiya</surname><given-names>HM</given-names></name><name><surname>He</surname><given-names>LL</given-names></name><name><surname>Gandhi</surname><given-names>SJ</given-names></name><name><surname>Nicol</surname><given-names>R</given-names></name><name><surname>Bhattacharyya</surname><given-names>RP</given-names></name><name><surname>Smillie</surname><given-names>CS</given-names></name><name><surname>Hung</surname><given-names>DT</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Bacterial droplet-based single-cell RNA-seq reveals antibiotic-associated heterogeneous cellular states</article-title><source>Cell</source><volume>186</volume><fpage>877</fpage><lpage>891</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2023.01.002</pub-id><pub-id pub-id-type="pmid">36708705</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maynard</surname><given-names>A</given-names></name><name><surname>McCoach</surname><given-names>CE</given-names></name><name><surname>Rotow</surname><given-names>JK</given-names></name><name><surname>Harris</surname><given-names>L</given-names></name><name><surname>Haderk</surname><given-names>F</given-names></name><name><surname>Kerr</surname><given-names>DL</given-names></name><name><surname>Yu</surname><given-names>EA</given-names></name><name><surname>Schenk</surname><given-names>EL</given-names></name><name><surname>Tan</surname><given-names>W</given-names></name><name><surname>Zee</surname><given-names>A</given-names></name><name><surname>Tan</surname><given-names>M</given-names></name><name><surname>Gui</surname><given-names>P</given-names></name><name><surname>Lea</surname><given-names>T</given-names></name><name><surname>Wu</surname><given-names>W</given-names></name><name><surname>Urisman</surname><given-names>A</given-names></name><name><surname>Jones</surname><given-names>K</given-names></name><name><surname>Sit</surname><given-names>R</given-names></name><name><surname>Kolli</surname><given-names>PK</given-names></name><name><surname>Seeley</surname><given-names>E</given-names></name><name><surname>Gesthalter</surname><given-names>Y</given-names></name><name><surname>Le</surname><given-names>DD</given-names></name><name><surname>Yamauchi</surname><given-names>KA</given-names></name><name><surname>Naeger</surname><given-names>DM</given-names></name><name><surname>Bandyopadhyay</surname><given-names>S</given-names></name><name><surname>Shah</surname><given-names>K</given-names></name><name><surname>Cech</surname><given-names>L</given-names></name><name><surname>Thomas</surname><given-names>NJ</given-names></name><name><surname>Gupta</surname><given-names>A</given-names></name><name><surname>Gonzalez</surname><given-names>M</given-names></name><name><surname>Do</surname><given-names>H</given-names></name><name><surname>Tan</surname><given-names>L</given-names></name><name><surname>Bacaltos</surname><given-names>B</given-names></name><name><surname>Gomez-Sjoberg</surname><given-names>R</given-names></name><name><surname>Gubens</surname><given-names>M</given-names></name><name><surname>Jahan</surname><given-names>T</given-names></name><name><surname>Kratz</surname><given-names>JR</given-names></name><name><surname>Jablons</surname><given-names>D</given-names></name><name><surname>Neff</surname><given-names>N</given-names></name><name><surname>Doebele</surname><given-names>RC</given-names></name><name><surname>Weissman</surname><given-names>J</given-names></name><name><surname>Blakely</surname><given-names>CM</given-names></name><name><surname>Darmanis</surname><given-names>S</given-names></name><name><surname>Bivona</surname><given-names>TG</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Therapy-induced evolution of human lung cancer revealed by single-cell RNA sequencing</article-title><source>Cell</source><volume>182</volume><fpage>1232</fpage><lpage>1251</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2020.07.017</pub-id><pub-id pub-id-type="pmid">32822576</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McNulty</surname><given-names>R</given-names></name><name><surname>Sritharan</surname><given-names>D</given-names></name><name><surname>Pahng</surname><given-names>SH</given-names></name><name><surname>Meisch</surname><given-names>JP</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Brennan</surname><given-names>MA</given-names></name><name><surname>Saxer</surname><given-names>G</given-names></name><name><surname>Hormoz</surname><given-names>S</given-names></name><name><surname>Rosenthal</surname><given-names>AZ</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Probe-based bacterial single-cell RNA sequencing predicts toxin regulation</article-title><source>Nature Microbiology</source><volume>8</volume><fpage>934</fpage><lpage>945</lpage><pub-id pub-id-type="doi">10.1038/s41564-023-01348-4</pub-id><pub-id pub-id-type="pmid">37012420</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Merritt</surname><given-names>JH</given-names></name><name><surname>Kadouri</surname><given-names>DE</given-names></name><name><surname>O’Toole</surname><given-names>GA</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Growing and analyzing static biofilms</article-title><source>Current Protocols in Microbiology</source><volume>22</volume><elocation-id>1</elocation-id><pub-id pub-id-type="doi">10.1002/9780471729259.mc01b01s22</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Momeni</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Division of labor: how microbes split their responsibility</article-title><source>Current Biology</source><volume>28</volume><fpage>R697</fpage><lpage>R699</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2018.05.024</pub-id><pub-id pub-id-type="pmid">29920261</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Picelli</surname><given-names>S</given-names></name><name><surname>Björklund</surname><given-names>ÅK</given-names></name><name><surname>Faridani</surname><given-names>OR</given-names></name><name><surname>Sagasser</surname><given-names>S</given-names></name><name><surname>Winberg</surname><given-names>G</given-names></name><name><surname>Sandberg</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Smart-seq2 for sensitive full-length transcriptome profiling in single cells</article-title><source>Nature Methods</source><volume>10</volume><fpage>1096</fpage><lpage>1098</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2639</pub-id><pub-id pub-id-type="pmid">24056875</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qian</surname><given-names>PY</given-names></name><name><surname>Cheng</surname><given-names>A</given-names></name><name><surname>Wang</surname><given-names>R</given-names></name><name><surname>Zhang</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Marine biofilms: diversity, interactions and biofouling</article-title><source>Nature Reviews. Microbiology</source><volume>20</volume><fpage>671</fpage><lpage>684</lpage><pub-id pub-id-type="doi">10.1038/s41579-022-00744-7</pub-id><pub-id pub-id-type="pmid">35614346</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reinders</surname><given-names>A</given-names></name><name><surname>Hee</surname><given-names>CS</given-names></name><name><surname>Ozaki</surname><given-names>S</given-names></name><name><surname>Mazur</surname><given-names>A</given-names></name><name><surname>Boehm</surname><given-names>A</given-names></name><name><surname>Schirmer</surname><given-names>T</given-names></name><name><surname>Jenal</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Expression and genetic activation of cyclic Di-GMP-specific phosphodiesterases in <italic>Escherichia coli</italic></article-title><source>Journal of Bacteriology</source><volume>198</volume><fpage>448</fpage><lpage>462</lpage><pub-id pub-id-type="doi">10.1128/JB.00604-15</pub-id><pub-id pub-id-type="pmid">26553851</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shapiro</surname><given-names>E</given-names></name><name><surname>Biezuner</surname><given-names>T</given-names></name><name><surname>Linnarsson</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Single-cell sequencing-based technologies will revolutionize whole-organism science</article-title><source>Nature Reviews. Genetics</source><volume>14</volume><fpage>618</fpage><lpage>630</lpage><pub-id pub-id-type="doi">10.1038/nrg3542</pub-id><pub-id pub-id-type="pmid">23897237</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shokeen</surname><given-names>B</given-names></name><name><surname>Dinis</surname><given-names>MDB</given-names></name><name><surname>Haghighi</surname><given-names>F</given-names></name><name><surname>Tran</surname><given-names>NC</given-names></name><name><surname>Lux</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Omics and interspecies interaction</article-title><source>Periodontology</source><volume>85</volume><fpage>101</fpage><lpage>111</lpage><pub-id pub-id-type="doi">10.1111/prd.12354</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spormann</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Physiology of microbes in biofilms</article-title><source>Current Topics in Microbiology and Immunology</source><volume>322</volume><fpage>17</fpage><lpage>36</lpage><pub-id pub-id-type="doi">10.1007/978-3-540-75418-3_2</pub-id><pub-id pub-id-type="pmid">18453270</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stewart</surname><given-names>PS</given-names></name><name><surname>Franklin</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Physiological heterogeneity in biofilms</article-title><source>Nature Reviews. Microbiology</source><volume>6</volume><fpage>199</fpage><lpage>210</lpage><pub-id pub-id-type="doi">10.1038/nrmicro1838</pub-id><pub-id pub-id-type="pmid">18264116</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>F</given-names></name><name><surname>Barbacioru</surname><given-names>C</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Nordman</surname><given-names>E</given-names></name><name><surname>Lee</surname><given-names>C</given-names></name><name><surname>Xu</surname><given-names>N</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Bodeau</surname><given-names>J</given-names></name><name><surname>Tuch</surname><given-names>BB</given-names></name><name><surname>Siddiqui</surname><given-names>A</given-names></name><name><surname>Lao</surname><given-names>K</given-names></name><name><surname>Surani</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>mRNA-Seq whole-transcriptome analysis of a single cell</article-title><source>Nature Methods</source><volume>6</volume><fpage>377</fpage><lpage>382</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1315</pub-id><pub-id pub-id-type="pmid">19349980</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vrabioiu</surname><given-names>AM</given-names></name><name><surname>Berg</surname><given-names>HC</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Signaling events that occur when cells of <italic>Escherichia coli</italic> encounter a glass surface</article-title><source>PNAS</source><volume>119</volume><elocation-id>e2116830119</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2116830119</pub-id><pub-id pub-id-type="pmid">35131853</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>B</given-names></name><name><surname>Lin</surname><given-names>AE</given-names></name><name><surname>Yuan</surname><given-names>J</given-names></name><name><surname>Novak</surname><given-names>KE</given-names></name><name><surname>Koch</surname><given-names>MD</given-names></name><name><surname>Wingreen</surname><given-names>NS</given-names></name><name><surname>Adamson</surname><given-names>B</given-names></name><name><surname>Gitai</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Single-cell massively-parallel multiplexed microbial sequencing (M3-seq) identifies rare bacterial populations and profiles phage infection</article-title><source>Nature Microbiology</source><volume>8</volume><fpage>1846</fpage><lpage>1862</lpage><pub-id pub-id-type="doi">10.1038/s41564-023-01462-3</pub-id><pub-id pub-id-type="pmid">37653008</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>Z</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Sheng</surname><given-names>K</given-names></name><name><surname>Rosenthal</surname><given-names>R</given-names></name><name><surname>Liu</surname><given-names>N</given-names></name><name><surname>Hua</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>T</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Song</surname><given-names>M</given-names></name><name><surname>Lv</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>S</given-names></name><name><surname>Huang</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Cao</surname><given-names>T</given-names></name><name><surname>Shen</surname><given-names>Y</given-names></name><name><surname>Jiang</surname><given-names>Y</given-names></name><name><surname>Yu</surname><given-names>Y</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Guo</surname><given-names>G</given-names></name><name><surname>Yin</surname><given-names>P</given-names></name><name><surname>Weitz</surname><given-names>DA</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Droplet-based high-throughput single microbe RNA sequencing by smRandom-seq</article-title><source>Nature Communications</source><volume>14</volume><elocation-id>5130</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-023-40137-9</pub-id><pub-id pub-id-type="pmid">37612289</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>G</given-names></name><name><surname>Wang</surname><given-names>LG</given-names></name><name><surname>Han</surname><given-names>Y</given-names></name><name><surname>He</surname><given-names>QY</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>clusterProfiler: an R package for comparing biological themes among gene clusters</article-title><source>Omics</source><volume>16</volume><fpage>284</fpage><lpage>287</lpage><pub-id pub-id-type="doi">10.1089/omi.2011.0118</pub-id><pub-id pub-id-type="pmid">22455463</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>Z</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Yang</surname><given-names>H</given-names></name><name><surname>Chou</surname><given-names>SH</given-names></name><name><surname>Galperin</surname><given-names>MY</given-names></name><name><surname>He</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Gas and light: triggers of c-di-GMP-mediated regulation</article-title><source>FEMS Microbiology Reviews</source><volume>47</volume><elocation-id>fuad034</elocation-id><pub-id pub-id-type="doi">10.1093/femsre/fuad034</pub-id><pub-id pub-id-type="pmid">37339911</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.97543.4.sa0</article-id><title-group><article-title>eLife Assessment</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Soldati-Favre</surname><given-names>Dominique</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>University of Geneva</institution><country>Switzerland</country></aff></contrib></contrib-group><kwd-group kwd-group-type="evidence-strength"><kwd>Convincing</kwd></kwd-group><kwd-group kwd-group-type="claim-importance"><kwd>Important</kwd></kwd-group></front-stub><body><p>This work introduces an <bold>important</bold> new method for depleting ribosomal RNA from bacterial single-cell RNA sequencing libraries, demonstrating its applicability for studying heterogeneity in microbial biofilms. The findings provide <bold>convincing</bold> evidence for a distinct subpopulation of cells at the biofilm base that upregulates PdeI expression. Future studies exploring the functional relationship between PdeI and c-di-GMP levels, along with the roles of co-expressed genes within the same cluster, could further enhance the depth and impact of these conclusions.</p></body></sub-article><sub-article article-type="referee-report" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.97543.4.sa1</article-id><title-group><article-title>Reviewer #1 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>In this manuscript, Yan and colleagues introduce a modification to the previously published PETRI-seq bacterial single cell protocol to include a ribosomal depletion step based on a DNA probe set that selectively hybridizes with ribosome-derived (rRNA) cDNA fragments. They show that their modification of the PETRI-seq protocol increases the fraction of informative non-rRNA reads from ~4-10% to 54-92%. The authors apply their protocol to investigating heterogeneity in a biofilm model of <italic>E. coli</italic>, and convincingly show how their technology can detect minority subpopulations within a complex community.</p><p>Strengths:</p><p>The method the authors propose is a straightforward and inexpensive modification of an established split-pool single cell RNA-seq protocol that greatly increases its utility, and should be of interest to a wide community working in the field of bacterial single cell RNA-seq.</p><p>Comments on revised version:</p><p>The reviewers have responded thoughtfully and comprehensively to all of my comments. I believe the details of the protocol are now much easier to understand, and the text and methods have been significantly clarified. I have no further comments.</p></body></sub-article><sub-article article-type="referee-report" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.97543.4.sa2</article-id><title-group><article-title>Reviewer #2 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>This work introduces a new method of depleting the ribosomal reads from the single-cell RNA sequencing library prepared with one of the prokaryotic scRNA-seq techniques, PETRI-seq. The advance is very useful since it allows broader access to the technology by lowering the cost of sequencing. It also allows more transcript recovery with fewer sequencing reads. The authors demonstrate the utility and performance of the method for three different model species and find a subpopulation of cells in the <italic>E. coli</italic> biofilm that express a protein, PdeI, which causes elevated c-di-GMP levels. These cells were shown to be in a state that promotes persister formation in response to ampicillin treatment.</p><p>Strengths:</p><p>The introduced rRNA depletion method is highly efficient, with the depletion for <italic>E. coli</italic> resulting in over 90% of reads containing mRNA. The method is ready to use with existing PETRI-seq libraries which is a large advantage, given that no other rRNA depletion methods were published for split-pool bacterial scRNA-seq methods. Therefore, the value of the method for the field is high. There is also evidence that a small number of cells at the bottom of a static biofilm express PdeI which is causing the elevated c-di-GMP levels that are associated with persister formation. This finding highlights the potentially complex role of PdeI in regulation of c-di-GMP levels and persister formation in microbial biofilms.</p><p>Comments on revised version:</p><p>The authors edited the manuscript thoroughly in response to the comments, including both performing new experiments and showing more data and information. Most of the major points raised between both reviewers were addressed. The authors explained the seeming contradiction between c-di-GMP levels and PdeI expression.</p></body></sub-article><sub-article article-type="author-comment" id="sa3"><front-stub><article-id pub-id-type="doi">10.7554/eLife.97543.4.sa3</article-id><title-group><article-title>Author response</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Yan</surname><given-names>Xiaodan</given-names></name><role specific-use="author">Author</role><aff><institution>Wuhan University</institution><addr-line><named-content content-type="city">Wuhan</named-content></addr-line><country>China</country></aff></contrib><contrib contrib-type="author"><name><surname>Liao</surname><given-names>Hebin</given-names></name><role specific-use="author">Author</role><aff><institution>Wuhan University</institution><addr-line><named-content content-type="city">Wuhan</named-content></addr-line><country>China</country></aff></contrib><contrib contrib-type="author"><name><surname>Wang</surname><given-names>Chenyi</given-names></name><role specific-use="author">Author</role><aff><institution>Wuhan University</institution><addr-line><named-content content-type="city">Wuhan</named-content></addr-line><country>China</country></aff></contrib><contrib contrib-type="author"><name><surname>Huang</surname><given-names>Chun</given-names></name><role specific-use="author">Author</role><aff><institution>Wuhan University</institution><addr-line><named-content content-type="city">Wuhan</named-content></addr-line><country>China</country></aff></contrib><contrib contrib-type="author"><name><surname>Zhang</surname><given-names>Wei</given-names></name><role specific-use="author">Author</role><aff><institution>Wuhan University</institution><addr-line><named-content content-type="city">Wuhan</named-content></addr-line><country>China</country></aff></contrib><contrib contrib-type="author"><name><surname>Guo</surname><given-names>Chunming</given-names></name><role specific-use="author">Author</role><aff><institution>Yunnan University</institution><addr-line><named-content content-type="city">Kunming</named-content></addr-line><country>China</country></aff></contrib><contrib contrib-type="author"><name><surname>Pu</surname><given-names>Yingying</given-names></name><role specific-use="author">Author</role><aff><institution>Wuhan University</institution><addr-line><named-content content-type="city">Wuhan</named-content></addr-line><country>China</country></aff></contrib></contrib-group></front-stub><body><p>The following is the authors’ response to the previous reviews.</p><disp-quote content-type="editor-comment"><p><bold>eLife Assessment</bold></p><p>This work presents an important method for depleting ribosomal RNA from bacterial single-cell RNA sequencing libraries, enabling the study of cellular heterogeneity within microbial biofilms. The approach convincingly identifies a small subpopulation of cells at the biofilm's base with upregulated PdeI expression, offering invaluable insights into the biology of bacterial biofilms and the formation of persister cells. Further integrated analysis of gene interactions within these datasets could deepen our understanding of biofilm dynamics and resilience.</p></disp-quote><p>Thank you for your valuable feedback and for recognizing the importance of our method for depleting ribosomal RNA from bacterial single-cell RNA sequencing libraries. We are pleased that our approach has convincingly identified a small subpopulation of cells at the base of the biofilm with upregulated PdeI expression, providing significant insights into the biology of bacterial biofilms and the formation of persister cells.</p><p>We acknowledge your suggestion for a more comprehensive analysis of multiple genes and their interactions. While we conducted a broad analysis across the transcriptome, our decision to focus on the heterogeneously expressed gene PdeI was primarily informed by its critical role in biofilm biology. In addition to PdeI, we investigated other marker genes and noted that <italic>lptE</italic> and <italic>sstT</italic> exhibited potential associations with persister cells. However, our interaction analysis revealed that LptE and SstT did not demonstrate significant relationships with c-di-GMP and PdeI based on current knowledge. This insight led us to concentrate on PdeI, given its direct relevance to biofilm formation and its close connection to the c-di-GMP signaling pathway.</p><p>We fully agree that other marker genes may also have important regulatory roles in different aspects of biofilm dynamics. Thus, we plan to explore the expression patterns and potential functions of these genes in our future research. Specifically, we intend to conduct more extensive gene network analyses to uncover the complex regulatory mechanisms involved in biofilm formation and resilience.</p><disp-quote content-type="editor-comment"><p><bold>Public Reviews:</bold></p><p><bold>Reviewer #1 (Public review):</bold></p><p>Summary:</p><p>In this manuscript, Yan and colleagues introduce a modification to the previously published PETRI-seq bacterial single cell protocol to include a ribosomal depletion step based on a DNA probe set that selectively hybridizes with ribosome-derived (rRNA) cDNA fragments. They show that their modification of the PETRI-seq protocol increases the fraction of informative non-rRNA reads from ~4-10% to 54-92%. The authors apply their protocol to investigating heterogeneity in a biofilm model of <italic>E. coli</italic>, and convincingly show how their technology can detect minority subpopulations within a complex community.</p><p>Strengths:</p><p>The method the authors propose is a straightforward and inexpensive modification of an established split-pool single cell RNA-seq protocol that greatly increases its utility, and should be of interest to a wide community working in the field of bacterial single cell RNA-seq.</p></disp-quote><p>We sincerely thank the reviewer for their thoughtful and positive evaluation of our work. We appreciate the recognition of our modification to the PETRI-seq bacterial single-cell RNA sequencing protocol by incorporating a ribosomal depletion step. The significant increase in the fraction of informative non-rRNA reads, as noted in the reviewer’s summary, underscores the effectiveness of our method in enhancing the utility of the PETRI-seq approach. We are also encouraged by the reviewer's acknowledgment of our ability to detect minority subpopulations within complex biofilm communities. Our team is committed to further validating and optimizing this method, and we believe that RiboD-PETRI will contribute meaningfully to the field of bacterial single-cell transcriptomics. We hope this innovative approach will facilitate new discoveries in microbial ecology and biofilm research.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Public review):</bold></p><p>Summary:</p><p>This work introduces a new method of depleting the ribosomal reads from the single-cell RNA sequencing library prepared with one of the prokaryotic scRNA-seq techniques, PETRI-seq. The advance is very useful since it allows broader access to the technology by lowering the cost of sequencing. It also allows more transcript recovery with fewer sequencing reads. The authors demonstrate the utility and performance of the method for three different model species and find a subpopulation of cells in the <italic>E. coli</italic> biofilm that express a protein, PdeI, which causes elevated c-di-GMP levels. These cells were shown to be in a state that promotes persister formation in response to ampicillin treatment.</p><p>Strengths:</p><p>The introduced rRNA depletion method is highly efficient, with the depletion for <italic>E. coli</italic> resulting in over 90% of reads containing mRNA. The method is ready to use with existing PETRI-seq libraries which is a large advantage, given that no other rRNA depletion methods were published for split-pool bacterial scRNA-seq methods. Therefore, the value of the method for the field is high. There is also evidence that a small number of cells at the bottom of a static biofilm express PdeI which is causing the elevated c-di-GMP levels that are associated with persister formation. This finding highlights the potentially complex role of PdeI in regulation of c-di-GMP levels and persister formation in microbial biofilms.</p><p>Weaknesses:</p><p>Given many current methods that also introduce different techniques for ribosomal RNA depletion in bacterial single-cell RNA sequencing, it is unclear what is the place and role of RiboD-PETRI. The efficiency of rRNA depletion varies greatly between species for the majority of the available methods, so it is not easy to select the best fitting technique for a specific application.</p></disp-quote><p>Thank you for your insightful comments regarding the place and role of RiboD-PETRI in the landscape of ribosomal RNA depletion techniques for bacterial single-cell RNA sequencing. We appreciate the opportunity to address your concerns and clarify the significance of our method.</p><p>We acknowledge that the field of rRNA depletion in bacterial single-cell RNA sequencing is diverse, with many methods offering different approaches. We also recognize the challenge of selecting the best technique for a specific application, given the variability in rRNA depletion efficiency across species for many available methods. In light of these considerations, we believe RiboD-PETRI occupies a distinct and valuable niche in this landscape due to following reasons: (1) Low-input compatibility: Our method is specifically tailored for the low-input requirements of single-cell RNA sequencing, maintaining high efficiency even with limited starting material. This makes RiboD-PETRI particularly suitable for single-cell studies where sample quantity is often a limiting factor. (2) Equipment-free protocol: One of the unique advantages of RiboD-PETRI is that it can be conducted in any lab without the need for specialized equipment. This accessibility ensures that a wide range of researchers can implement our method, regardless of their laboratory setup. (3) Broad species coverage: Through comprehensive probe design targeting highly conserved regions of bacterial rRNA, RiboD-PETRI offers a robust solution for samples involving multiple bacterial species or complex microbial communities. This approach aims to provide consistent performance across diverse taxa, addressing the variability issue you mentioned. (4) Versatility and compatibility: RiboD-PETRI is designed to be compatible with various downstream single-cell RNA sequencing protocols, enhancing its utility in different experimental setups and research contexts.</p><p>In conclusion, RiboD-PETRI's unique combination of low-input compatibility, equipment-free protocol, broad species coverage, and versatility positions it as a robust and accessible option in the landscape of rRNA depletion methods for bacterial single-cell RNA sequencing. We are committed to further validating and improving our method to ensure its valuable contribution to the field and to provide researchers with a reliable tool for their diverse experimental needs.</p><disp-quote content-type="editor-comment"><p>Despite transcriptome-wide coverage, the authors focused on the role of a single heterogeneously expressed gene, PdeI. A more integrated analysis of multiple genes and\or interactions between them using these data could reveal more insights into the biofilm biology.</p></disp-quote><p>Thank you for your valuable feedback. We understand your suggestion for a more comprehensive analysis of multiple genes and their interactions. While we indeed conducted a broad analysis across the transcriptome, our decision to focus on the heterogeneously expressed gene PdeI was primarily based on its crucial role in biofilm biology. Beyond PdeI, we also conducted overexpression experiments on several other marker genes and examined their phenotypes. Notably, the lptE and sstT genes showed potential associations with persister cells. We performed an interaction analysis, which revealed that LptE and SstT did not show significant relationships with c-di-GMP and PdeI based on current knowledge. This finding led us to concentrate our attention on PdeI. Given PdeI's direct relevance to biofilm formation and its close connection to the c-di-GMP signaling pathway, we believed that an in-depth study of PdeI was most likely to reveal key biological mechanisms.</p><p>We fully agree with your point that other marker genes may play regulatory roles in different aspects. The expression patterns and potential functions of these genes will be an important direction in our future research. In our future work, we plan to conduct more extensive gene network analyses to uncover the complex regulatory mechanisms of biofilm formation.</p><fig id="sa3fig1" position="float"><label>Author response image 1.</label><caption><title>The proportion of persister cells in the partially maker genes and empty vector control groups.</title><p>Following induction of expression with 0.002% arabinose for 2 hours, a persister counting assay was conducted on the strains using 150 μg/ml ampicillin.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97543-sa3-fig1-v1.tif"/></fig><disp-quote content-type="editor-comment"><p>The authors should also present the UMIs capture metrics for RiboD-PETRI method for all cells passing initial quality filter (&gt;=15 UMIs/cell) both in the text and in the figures. Selection of the top few cells with higher UMI count may introduce biological biases in the analysis (the top 5% of cells could represent a distinct subpopulation with very high gene expression due to a biological process). For single-cell RNA sequencing, showing the statistics for a 'top' group of cells creates confusion and inflates the perceived resolution, especially when used to compare to other methods (e.g. the parent method PETRI-seq itself).</p></disp-quote><p>Thank you for your valuable feedback regarding the presentation of UMI capture metrics for the RiboD-PETRI method. We appreciate your concern about potential biological biases and the importance of comprehensive data representation in single-cell RNA sequencing analysis. We have now included the UMI capture metrics for all cells passing the initial quality filter (≥15 UMIs/cell) for the RiboD-PETRI method. This information has been added to both the main text and the relevant figures, providing a more complete picture of our method's performance across the entire range of captured cells. These revisions strengthen our manuscript and provide readers with a more complete understanding of the RiboD-PETRI method in the context of single-cell RNA sequencing.</p><disp-quote content-type="editor-comment"><p><bold>Recommendations for the authors:</bold></p><p><bold>Reviewer #1 (Recommendations for the authors):</bold></p><p>The reviewers have responded thoughtfully and comprehensively to all of my comments. I believe the details of the protocol are now much easier to understand, and the text and methods have been significantly clarified. I have no further comments.</p><p><bold>Reviewer #2 (Recommendations for the authors):</bold></p><p>The authors edited the manuscript thoroughly in response to the comments, including both performing new experiments and showing more data and information. Most of the major points raised between both reviewers were addressed. The authors explained the seeming contradiction between c-di-GMP levels and PdeI expression. Despite these improvements, a few issues remain:</p></disp-quote><p>- Despite now depositing the data and analysis files to GEO, the access is embargoed and the reviewer token was not provided to evaluate the shared data and accessory files.</p><p>Please note that although the data and analysis files have been deposited to GEO, access is currently embargoed. To evaluate the shared data and accessory files, you will need a reviewer token, which appears to have not been provided.</p><p>To gain access, please follow these steps:</p><p>Visit the GEO accession page at: https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE260458</p><p>In the designated field, enter the reviewer token: ehipgqiohhcvjev</p><disp-quote content-type="editor-comment"><p>- Despite now discussing performance metrics for RiboD-PETRI method for all cells passing initial quality filter (&gt;=15 UMIs/cell) in the text, the authors continued to also include the statistics for top 1000 cells, 5,000 cells and so on. Critically, Figure 2A-B is still showing the UMI and gene distributions per cell only for these select groups of cells. The intent to focus on these metrics is not quite clear, as selection of the top few cells with higher UMI count may introduce biological biases in the analysis (what if the top 5% of cells are unusual because they represent a distinct subpopulation with very high gene expression due to a biological process). I understand the desire to demonstrate the performance of the method by highlighting a few select 'best' cells, however, for single-cell RNA sequencing showing the statistics for a 'top' group of cells is not appropriate and creates confusion, especially when used to compare to other methods (e.g. the parent method PETRI-seq itself).</p></disp-quote><p>We appreciate your insightful feedback regarding our presentation of the RiboD-PETRI method's performance metrics. We acknowledge the concerns you've raised and agree that our current approach requires refinement. We have revised our analysis to prominently feature metrics for all cells that pass the initial quality filter (≥15 UMIs/cell) (Fig. 2A, Fig. 3A, Supplementary Fig. 1A, B and Supplementary Fig. 2A, G). This approach provides a more representative view of the method's performance across the entire dataset, avoiding potential biases introduced by focusing solely on top-performing cells.</p><p>We recognize that selecting only the top cells based on UMI counts can indeed introduce biological biases, as these cells may represent distinct subpopulations with unique biological processes rather than typical cellular states. To address this, we have clearly stated the potential for bias when highlighting select 'best' cells. We also provided context for why these high-performing cells are shown, explaining that they demonstrate the upper limits of the method's capabilities (lines 139). In addition, when comparing RiboD-PETRI to other methods, including the parent PETRI-seq, we ensured that comparisons are made using consistent criteria across all methods.</p><p>By implementing these changes, we aim to provide a more accurate, unbiased, and comprehensive representation of the RiboD-PETRI method's performance while maintaining scientific rigor and transparency. We appreciate your critical feedback, as it helps us improve the quality and reliability of our research presentation.</p><disp-quote content-type="editor-comment"><p>- Line 151 &quot; The findings reveal that our sequencing saturation is 100% (Fig. S1B, C)&quot; - I suggest the authors revisit this calculation as this parameter is typically very challenging to get above 95-96%. The sequencing saturation should be calculated from the statistics of alignment themselves, i.e. the parameter calculated by Cell Ranger as described here https://kb.10xgenomics.com/hc/en-us/articles/115003646912-How-is-sequencing-saturation-calculated :</p><p>&quot;The web_summary.html output from cellranger count includes a metric called &quot;Sequencing Saturation&quot;. This metric quantifies the fraction of reads originating from an already-observed UMI. More specifically, this is the fraction of confidently mapped, valid cell-barcode, valid UMI reads that are non-unique (match an existing cell-barcode, UMI, gene combination).</p><p>The formula for calculating this metric is as follows:</p><p>Sequencing Saturation = 1 - (n_deduped_reads / n_reads)</p><p>where</p><p>n_deduped_reads = Number of unique (valid cell-barcode, valid UMI, gene) combinations among confidently mapped reads.</p><p>n_reads = Total number of confidently mapped, valid cell-barcode, valid UMI reads.</p><p>Note that the numerator of the fraction is n_deduped_reads, not the non-unique reads that are mentioned in the definition. n_deduped_reads is a degree of uniqueness, not a degree of duplication/saturation. Therefore we take the complement of (n_deduped_reads / n_reads) to measure saturation.&quot;</p></disp-quote><p>We appreciate your insightful comment regarding our sequencing saturation calculation. The sequencing saturation algorithm we initially employed was based on the methodology used in the BacDrop study (PMID: PMC10014032, https://pmc.ncbi.nlm.nih.gov/articles/PMC10014032/).</p><p>We acknowledge the importance of using standardized and widely accepted methods for calculating sequencing saturation. As per your suggestion, we have recalculated our sequencing saturation using the method described by 10x Genomics. Given the differences between RiboD-PETRI and 10x Genomics datasets, we have adapted the calculation as follows:</p><p>· n_deduped_reads: We used the number of UMIs as a measure of unique reads.</p><p>· n_reads: We used the total number of confidently mapped reads.</p><p>After applying this adapted calculation method, we found that our sequencing saturation ranges from 92.16% to 93.51%. This range aligns more closely with typical expectations for sequencing saturation in single-cell RNA sequencing experiments, suggesting that we have captured a substantial portion of the transcript diversity in our samples. We also updated Figure S1 to reflect these recalculated sequencing saturation values. We will also provide a detailed description of our calculation method in the methods section to ensure transparency and reproducibility. It's important to note that this saturation calculation method was originally designed for 10× Genomics data. While we've adapted it for our study, we acknowledge that its applicability to our specific experimental setup may be limited.</p><p>We thank you for bringing this important point to our attention. This recalculation not only improves the accuracy of our reported results but also aligns our methodology more closely with established standards in the field. We believe these revisions strengthen the overall quality and reliability of our study.</p><disp-quote content-type="editor-comment"><p>- Further, this calculated saturation should be taken into account when comparing the performance of the method in terms of retrieving diverse transcripts from cells. I.e., if the RiboD-Petri dataset was subsampled to the same saturation as the original PETRI-seq dataset was obtained with, would the median UMIs/cell for all cells above filter be comparable? In other words, does rRNA depletion just decreases the cost to sequence to saturation, or does it provide UMI capture benefits at a comparable saturation?</p></disp-quote><p>We appreciate your insightful question regarding the comparison of method performance in terms of transcript retrieval diversity and the impact of saturation. To address your concerns, we conducted an additional analysis comparing the RiboD-PETRI and original PETRI-seq datasets at equivalent saturation levels besides our original analysis with equivalent sequencing depth.</p><p>With equivalent sequencing depth, RiboD-PETRI demonstrates a significantly enhanced Unique Molecular Identifier (UMI) counts detection rate compared to PETRI-seq alone (Fig. 1C). This method recovered approximately 20175 cells (92.6% recovery rate) with ≥ 15 UMIs per cell with a median UMI count of 42 per cell, which was significantly higher than PETRI-seq's recovery rate of 17.9% with a median UMI count of 20 per cell (Figure S1A, B), indicating the number of detected mRNA per cell increased prominently.</p><p>When we subsampled the RiboD-PETRI dataset to match the saturation level of the original PETRI-seq dataset (i.e., equalizing the n_deduped_reads/n_reads ratio), we found that the median UMIs/cell for all cells above the filter threshold was higher in the RiboD-PETRI dataset compared to the original PETRI-seq (as shown in Author response image 2). This observation can be primarily attributed to the introduction of the rRNA depletion step in the RiboD-PETRI method. Our analysis suggests that rRNA depletion not only reduces the cost of sequencing to saturation but also provides additional benefits in UMI capture efficiency at comparable saturation levels.The rRNA depletion step effectively reduces the proportion of rRNA-derived reads in the sequencing output. Consequently, at equivalent saturation levels, this leads to a relative increase in the number of n_deduped_reads corresponding to mRNA transcripts. This shift in read composition enhances the capture of informative UMIs, resulting in improved transcript diversity and detection.</p><p>In conclusion, our findings indicate that the rRNA depletion step in RiboD-PETRI offers dual advantages: it decreases the cost to sequence to saturation and provides enhanced UMI capture benefits at comparable saturation levels, ultimately leading to more efficient and informative single-cell transcriptome profiling.</p><fig id="sa3fig2" position="float"><label>Author response image 2.</label><caption><title>At almost the same sequencing saturation (64% and 67%), the number of cells exceeding the screening criteria (≥15 UMIs) and the median number of UMIs in cells in Ribod-PETRI and PETRI-seq data of exponential period <italic>E. coli</italic> (3h).</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97543-sa3-fig2-v1.tif"/></fig><disp-quote content-type="editor-comment"><p>- smRandom-seq and BaSSSh-seq need to also be discussed since these newer methods are also demonstrating rRNA depletion techniques. (https://doi.org/10.1038/s41467-023-40137-9 and https://doi.org/10.1101/2024.06.28.601229)</p></disp-quote><p>Thank you for your valuable feedback. We appreciate the opportunity to discuss our method, RiboD-PETRI, in the context of other recent advances in bacterial RNA sequencing techniques, particularly smRandom-seq and BaSSSh-seq.</p><p>RiboD-PETRI employs a Ribosomal RNA-derived cDNA Depletion (RiboD) protocol. This method uses probe primers that span all regions of the bacterial rRNA sequence, with the 3'-end complementary to rRNA-derived cDNA and the 5'-end complementary to a biotin-labeled universal primer. After hybridization, Streptavidin magnetic beads are used to eliminate the hybridized rRNA-derived cDNA, leaving mRNA-derived cDNA in the supernatant. smRandom-seq utilizes a CRISPR-based rRNA depletion technique. This method is designed for high-throughput single-microbe RNA sequencing and has been shown to reduce the rRNA proportion from 83% to 32%, effectively increasing the mRNA proportion four times (from 16% to 63%). While specific details about BaSSSh-seq's rRNA depletion technique are not provided in the available information, it is described as employing a rational probe design for efficient rRNA depletion. This technique aims to minimize the loss of mRNA during the depletion process, ensuring a more accurate representation of the transcriptome.</p><p>RiboD-PETRI demonstrates significant enhancement in rRNA-derived cDNA depletion across both gram-negative and gram-positive bacterial species. It increases the mRNA ratio from 8.2% to 81% for <italic>E. coli</italic> in exponential phase, from 10% to 92% for <italic>S. aureus</italic> in stationary phase, and from 3.9% to 54% for C. crescentus in exponential phase. smRandom-seq shows high species specificity (99%), a minor doublet rate (1.6%), and a reduced rRNA percentage (32%). These metrics indicate its efficiency in single-microbe RNA sequencing. While specific performance metrics for BaSSSh-seq are not provided in the available information, its rational probe design approach suggests a focus on maintaining mRNA integrity during the depletion process.</p><p>RiboD-PETRI is described as a cost-effective ($0.0049 per cell), equipment-free, and high-throughput solution for bacterial scRNA-seq. This makes it an attractive option for researchers with budget constraints. While specific cost information is not provided, the efficiency of smRandom-seq is noted to be affected by the overwhelming quantity of rRNAs (&gt;80% of mapped reads). The CRISPR-based depletion technique likely adds to the complexity and cost of the method. Cost and accessibility information for BaSSSh-seq is not provided in the available data, making a direct comparison difficult.</p><p>All three methods represent significant advancements in bacterial RNA sequencing, each offering unique approaches to the challenge of rRNA depletion. RiboD-PETRI stands out for its cost-effectiveness and demonstrated success in complex systems like biofilms. Its ability to significantly increase mRNA ratios across different bacterial species and growth phases is particularly noteworthy. smRandom-seq's CRISPR-based approach offers high specificity and efficiency, which could be advantageous in certain research contexts, particularly where single-microbe resolution is crucial. However, the complexity of the CRISPR system might impact its accessibility and cost-effectiveness. BaSSSh-seq's focus on minimizing mRNA loss during depletion could be beneficial for studies requiring highly accurate transcriptome representations, although more detailed performance data would be needed for a comprehensive comparison. The choice between these methods would depend on specific research needs. RiboD-PETRI's cost-effectiveness and proven application in biofilm studies make it particularly suitable for complex bacterial community analyses. smRandom-seq might be preferred for studies requiring high-throughput single-cell resolution. BaSSSh-seq could be the method of choice when preserving the integrity of the mRNA profile is paramount.</p><p>In conclusion, while all three methods offer valuable solutions for rRNA depletion in bacterial RNA sequencing, RiboD-PETRI's combination of efficiency, cost-effectiveness, and demonstrated application in complex biological systems positions it as a highly competitive option in the field of bacterial transcriptomics.</p><p>We have revised our discussion in the manuscript according to the above analysis (lines 116-119)</p><disp-quote content-type="editor-comment"><p>- Ctrl and Delta-Delta abbreviations are used in main text but not defined there (lines 107-110).</p></disp-quote><p>Thank you for your valuable feedback. We have now defined the abbreviations &quot;Ctrl&quot; and &quot;Delta-Delta&quot; in the main text for clarity.</p><disp-quote content-type="editor-comment"><p>- The utility of Figs 2E and 3E is questionable - the same information can be conveyed in text.</p></disp-quote><p>Thank you for your thoughtful observation regarding Figures 2E and 3E. We appreciate your feedback and would like to address the concerns you've raised.</p><p>While we acknowledge that some of the information in these figures could be conveyed textually, we believe that their visual representation offers several advantages. Figures 2E and 3E provide a comprehensive visual overview of the pathway enrichment analysis for marker genes, which may be more easily digestible than a textual description. This analysis was conducted in response to another reviewer's request, demonstrating our commitment to addressing diverse perspectives in our research.</p><p>These figures allow for a systematic interpretation of gene expression data, revealing complex interactions between genes and their involvement in biological pathways that might be less apparent in a text-only format. Visual representations can make complex data more accessible to readers with different learning styles or those who prefer graphical summaries. Additionally, including such figures is consistent with standard practices in our field, facilitating comparison with other studies. We believe that the pathway enrichment analysis results presented in these figures provide valuable insights that merit inclusion as visual elements. However, we are open to discussing alternative ways to present this information if you have specific suggestions for improvement.</p></body></sub-article></article>