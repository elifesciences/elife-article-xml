<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">82734</article-id><article-id pub-id-type="doi">10.7554/eLife.82734</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Ecology</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>Spatiotemporal ecological chaos enables gradual evolutionary diversification without niches or tradeoffs</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-291236"><name><surname>Mahadevan</surname><given-names>Aditya</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0009-0000-5571-9993</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-291235"><name><surname>Pearce</surname><given-names>Michael T</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="pa1">‡</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-54545"><name><surname>Fisher</surname><given-names>Daniel S</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5559-2491</contrib-id><email>dsfisher@stanford.edu</email><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00f54p054</institution-id><institution>Department of Physics, Stanford University</institution></institution-wrap><addr-line><named-content content-type="city">Stanford</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00f54p054</institution-id><institution>Department of Applied Physics, Stanford University</institution></institution-wrap><addr-line><named-content content-type="city">Stanford</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Nourmohammad</surname><given-names>Armita</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00cvxb145</institution-id><institution>University of Washington</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02feahw73</institution-id><institution>CNRS</institution></institution-wrap><country>France</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn><fn fn-type="present-address" id="pa1"><label>‡</label><p>Meta Data Science, Menlo Park, United States</p></fn></author-notes><pub-date publication-format="electronic" date-type="publication"><day>28</day><month>04</month><year>2023</year></pub-date><pub-date pub-type="collection"><year>2023</year></pub-date><volume>12</volume><elocation-id>e82734</elocation-id><history><date date-type="received" iso-8601-date="2022-08-16"><day>16</day><month>08</month><year>2022</year></date><date date-type="accepted" iso-8601-date="2023-04-27"><day>27</day><month>04</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2022-05-28"><day>28</day><month>05</month><year>2022</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.05.25.493518"/></event></pub-history><permissions><copyright-statement>© 2023, Mahadevan, Pearce et al</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Mahadevan, Pearce et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-82734-v2.pdf"/><abstract><p>Ecological and evolutionary dynamics are intrinsically entwined. On short timescales, ecological interactions determine the fate and impact of new mutants, while on longer timescales evolution shapes the entire community. Here, we study the evolution of large numbers of closely related strains with generalized Lotka Volterra interactions but no niche structure. Host-pathogen-like interactions drive the community into a spatiotemporally chaotic state characterized by continual, spatially-local, blooms and busts. Upon the slow serial introduction of new strains, the community diversifies indefinitely, accommodating an arbitrarily large number of strains in spite of the absence of stabilizing niche interactions. The diversifying phase persists — albeit with gradually slowing diversification — in the presence of general, nonspecific, fitness differences between strains, which break the assumption of tradeoffs inherent in much previous work. Building on a dynamical-mean field-theory analysis of the ecological dynamics, an approximate effective model captures the evolution of the diversity and distributions of key properties. This work establishes a potential scenario for understanding how the interplay between evolution and ecology — in particular coevolution of a bacterial and a generalist phage species — could give rise to the extensive fine-scale diversity that is ubiquitous in the microbial world.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>strain diversity</kwd><kwd>modeling</kwd><kwd>evolution</kwd><kwd>ecology</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>PHY-160760</award-id><principal-award-recipient><name><surname>Mahadevan</surname><given-names>Aditya</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R01AI13699201</award-id><principal-award-recipient><name><surname>Mahadevan</surname><given-names>Aditya</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000893</institution-id><institution>Simons Foundation</institution></institution-wrap></funding-source><award-id>Sabbatical Fellowship</award-id><principal-award-recipient><name><surname>Fisher</surname><given-names>Daniel S</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100008982</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>PHY-2210386</award-id><principal-award-recipient><name><surname>Mahadevan</surname><given-names>Aditya</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Evolution of multiple closely related strains with host-pathogen-like interactions but only one niche and no tradeoffs, can give rise to a spatiotemporally chaotic ecological state that continually diversifies even with generalist mutations that slow the evolution.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>A remarkable discovery of the DNA sequencing revolution is the vast diversity of microbes (<xref ref-type="bibr" rid="bib5">Biller et al., 2015</xref>; <xref ref-type="bibr" rid="bib1">Acinas et al., 2004</xref>; <xref ref-type="bibr" rid="bib27">Kashtan et al., 2017</xref>; <xref ref-type="bibr" rid="bib40">Rosen et al., 2018</xref>). Increasingly it has become clear that this diversity extends far below the level of conventionally defined species to finer and finer genetic scales (<xref ref-type="bibr" rid="bib6">Bonilla-Rosso et al., 2020</xref>; <xref ref-type="bibr" rid="bib26">Kashtan et al., 2014</xref>; <xref ref-type="bibr" rid="bib39">Rosen et al., 2015</xref>; <xref ref-type="bibr" rid="bib48">Tikhonov et al., 2015</xref>), and in some cases, a great multitude of strains coexist and compete in the same spatial location. Why doesn’t “survival of the fittest” drive almost all strains extinct, at least locally? Traditional explanations invoke the existence of a great many spatial or functional niches which limit competition between strains, down to “micro-niches” involving finer differences. However, especially for bacteria in relatively simple environments such as the marine cyanobacterium <italic>Prochlorococcus</italic> (<xref ref-type="bibr" rid="bib26">Kashtan et al., 2014</xref>), does it make sense to postulate nano- or pico-niches, <italic>ad absurdum</italic>? Or is a statistical description of the small subtle differences more appropriate? Community ecology models with many similar strains competing for a mixture of resources have been much studied, but in their simplest manifestations the maximum number of coexisting strains is limited by the number of chemicals via which they interact, which in effect create a series of niches, each of which can be occupied by at most one strain (<xref ref-type="bibr" rid="bib11">Chesson, 1990</xref>). Perfect “tradeoffs” are sometimes invoked to enable higher diversity (<xref ref-type="bibr" rid="bib34">Posfai et al., 2017</xref>; <xref ref-type="bibr" rid="bib3">Beardmore et al., 2011</xref>; <xref ref-type="bibr" rid="bib15">Erez et al., 2020</xref>) but even tiny differences will destroy this coexistence (<xref ref-type="bibr" rid="bib9">Caetano et al., 2021</xref>).</p><p>An alternative to the multi-niche scenario is the <italic>neutral theory</italic> of ecology which postulates that species are similar enough that they are somehow ecologically equivalent, with their population dynamics dominated by stochastic births, deaths, and migration. The predictions of this theory for abundance and spatial distributions are intriguingly similar to some data (<xref ref-type="bibr" rid="bib51">Volkov et al., 2003</xref>; <xref ref-type="bibr" rid="bib52">Volkov et al., 2007</xref>). However for microbes with short generation times and huge populations without tight bottlenecks, the neutral scenario is not viable: Even if the differences between strains could be neglected over the long times for which they have coexisted, the dynamics from stochastic fluctuations are far too slow. Instead, rapid population dynamics with large changes of relative abundance are often observed (<xref ref-type="bibr" rid="bib25">Ignacio-Espinoza et al., 2020</xref>; <xref ref-type="bibr" rid="bib30">Martin-Platero et al., 2018</xref>). “Selection”, in the broad sense of differential population growth rates, is clearly involved. Thus if a highly diverse population <italic>appears</italic> “neutral” in some respects (including close-to-perfect tradeoffs) this must <italic>emerge</italic> from the complex ecological and evolutionary dynamics; it should not be assumed.</p><p>It is often said that pathogens promote diversity (<xref ref-type="bibr" rid="bib4">Bever et al., 2015</xref>; <xref ref-type="bibr" rid="bib38">Rodriguez-Valera et al., 2009</xref>; <xref ref-type="bibr" rid="bib46">Thingstad, 2000</xref>; <xref ref-type="bibr" rid="bib47">Thingstad et al., 2014</xref>). However, there is thus far little understanding of how or under what circumstances ongoing coevolution of hosts and pathogens could cause and sustain extensive coexisting within-species diversity. Understanding this process theoretically is a long-term goal, towards which the present work is a step. To make progress, we need to distill the general phenomenon of fine-scale diversity to its most basic, and endeavor to develop potential scenarios in which evolution, coupled with ecology, might play out. For closely related strains, there is no compelling reason why interactions with siblings should be much stronger than those between distant cousins. Thus, we ask: Without assuming niche-like interactions, perfect tradeoffs, or spatial gradients, can a highly diverse collection of closely related strains stably and robustly coexist? If so, can such a highly diverse “phase” evolve and continue to evolve and diversify? If the evolution is fast, some amount of diversity will always exist (although the common ancestors of the population at any time may be recent and few). Thus we consider the most difficult regime for diversity: when the evolutionary dynamics are much slower than the ecological and spatial population dynamics.</p><p>In recent work (<xref ref-type="bibr" rid="bib33">Pearce et al., 2020</xref>), referred to henceforth as PAF, we developed a new scenario for the coexistence of multiple closely related strains that are <italic>assembled</italic> all together into a community, leaving aside the question of their past or future evolution (or even how the community is assembled). In this scenario, we explored a particular key feature of models of many similar strains: the nature of interactions between pairs of strains. It is known that competition for resources in a well-mixed environment leads to positive correlations: if more <inline-formula><mml:math id="inf1"><mml:mi>A</mml:mi></mml:math></inline-formula> individuals are worse for <inline-formula><mml:math id="inf2"><mml:mi>B</mml:mi></mml:math></inline-formula>, then more <inline-formula><mml:math id="inf3"><mml:mi>B</mml:mi></mml:math></inline-formula> are worse for <inline-formula><mml:math id="inf4"><mml:mi>A</mml:mi></mml:math></inline-formula>. We consider the opposite case where the interactions are anticorrelated. This can arise if the competition is one-on-one: if <inline-formula><mml:math id="inf5"><mml:mi>A</mml:mi></mml:math></inline-formula> beats <inline-formula><mml:math id="inf6"><mml:mi>B</mml:mi></mml:math></inline-formula>, then <inline-formula><mml:math id="inf7"><mml:mi>B</mml:mi></mml:math></inline-formula> loses to <inline-formula><mml:math id="inf8"><mml:mi>A</mml:mi></mml:math></inline-formula>. A compelling biological motivation for anticorrelated interactions arises from a different scenario: a spectrum of generalist phage strains that prey, with varying efficacies, on a spectrum of bacterial strains. If a particular phage strain, <inline-formula><mml:math id="inf9"><mml:mi>a</mml:mi></mml:math></inline-formula>, does better than average against a particular bacterial strain, <inline-formula><mml:math id="inf10"><mml:mi>b</mml:mi></mml:math></inline-formula>, then more <inline-formula><mml:math id="inf11"><mml:mi>b</mml:mi></mml:math></inline-formula> individuals are better for <inline-formula><mml:math id="inf12"><mml:mi>a</mml:mi></mml:math></inline-formula>, and more <inline-formula><mml:math id="inf13"><mml:mi>a</mml:mi></mml:math></inline-formula> are worse for <inline-formula><mml:math id="inf14"><mml:mi>b</mml:mi></mml:math></inline-formula>, leading to anticorrelated interactions. While we are particularly interested in coevolving bacteria-phage diversity, to build up an understanding of the complex eco-evolutionary dynamics, we focus in this paper on simpler models that — as we have shown in PAF — capture many of the key features.</p><p>Host-pathogen, and other anticorrelated interactions, give rise to “kill the winner” ecological dynamics (<xref ref-type="bibr" rid="bib46">Thingstad, 2000</xref>). If a strain rises to high abundance, other strains that do well against it will bloom and drive down the abundance of the first, and the process repeats. With many strains that do not have their own niches, this leads to wilder and wilder chaotic variations of abundances, soon driving most types extinct. In PAF we showed that rudimentary spatial structure — a large set of <inline-formula><mml:math id="inf15"><mml:mi>I</mml:mi></mml:math></inline-formula> islands with a low migration rate between all pairs of islands — can maintain much diversity without a commonly-invoked mainland (<xref ref-type="bibr" rid="bib29">MacArthur and Wilson, 1967</xref>). In this spatial model, many strains go globally extinct, but a large fraction persists indefinitely in a spatiotemporally chaotic phase (hereafter STC). Crucially, the chaotic dynamics desynchronize across the islands allowing strains that go extinct locally to be repopulated from other islands. This mechanism is a manifestation of the “spatial storage effect” (<xref ref-type="bibr" rid="bib12">Chesson, 2000</xref>). On each island, each persistent strain occasionally blooms up to high abundance and subsequently crashes (<xref ref-type="fig" rid="fig1">Figure 1</xref>). While it is at low abundance, dispersal from blooms on other islands rescues the strain from local extinction until conditions are favorable and its population blooms again, sends out migrants, and crashes. This STC is very robust: strains either go extinct rapidly, or persist globally for times that are exponentially long in the number of islands.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Dynamics of strain abundances on a <italic>single island</italic> in the spatiotemporally chaotic state (STC).</title><p>A subset of strains is plotted. Each persistent strain occasionally blooms up to high abundance and between blooms its abundance is sustained above a migration floor (here <inline-formula><mml:math id="inf16"><mml:mrow><mml:mi/><mml:mo>≅</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) set by migration from other islands, although a few marginal strains fluctuate below this threshold. (<bold>A</bold>) An example of the evolutionary process: at the beginning of an <italic>epoch</italic> (vertical dashed line), a new (here unrelated) strain, (black), is introduced at intermediate abundance. This new strain establishes and persists, causing two (red) strains, which persisted in the previous epoch, to go globally extinct by the end of this epoch. (<bold>B</bold>) Strains that would go extinct on a single island, can persist, and invade from low abundance, due to migration. The purple strain successfully invades. But at the vertical dashed line, migration is turned off for the purple strain only, and it proceeds to go extinct with average exponential decay rate given by its negative <italic>bias</italic>, schematically indicated by the dashed black line (with an extended range of log-abundance shown).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82734-fig1-v2.tif"/></fig><p>Complementary work (<xref ref-type="bibr" rid="bib42">Roy et al., 2020</xref>; <xref ref-type="bibr" rid="bib41">Roy et al., 2019</xref>) suggests the generality of the STC beyond anticorrelated pairwise interactions, although in the Lotka-Volterra models studied in these works of Roy et al., the diversity is limited by the strength of self-interactions, which also limits the diversity of stable communities. Indeed, much previous work has focused on ecological dynamics that reach a stable state, where diversity is limited by strength of niche interactions compared to inter-species interactions (<xref ref-type="bibr" rid="bib8">Bunin, 2017</xref>). Here we approach evolutionary dynamics in similar generalized Lotka-Volterra models, but from the opposite starting point: all interactions are of comparable magnitude which makes the effects of self-interactions negligible compared to the effects of the total interactions from all other strains. Then there is no large stable community, and the diversity is maintained by spatial structure and chaotic dynamics.</p><p>With anticorrelated interactions, arbitrarily large numbers of strains can coexist in the STC even when spatial mixing — and hence competition — occur on timescales comparable to those of the local ecological dynamics. However, if the strains differ somewhat in their overall growth rate, or other ways that make some <italic>generally</italic> better, these advantages can limit the diversity of the community. A natural assumption is that, having all survived on evolutionary timescales, the persistent strains will be similar enough that such differences are very small. But this assumption — and even more so assumptions of close-to-rigid tradeoffs, (<xref ref-type="bibr" rid="bib34">Posfai et al., 2017</xref>; <xref ref-type="bibr" rid="bib2">Amicone and Gordo, 2021</xref>; <xref ref-type="bibr" rid="bib16">Farahpour et al., 2018</xref>) — should surely be questioned. Such features must emerge from the evolution rather than being assumed.</p><p>Many theoretical (and some experimental) analyses, have, like our prior work, focused on ecological communities that are assembled without conditioning on their evolutionary histories: a number of species (or strains) is brought together, and the resulting community consists of the species that do not go extinct (<xref ref-type="bibr" rid="bib7">Bunin, 2016</xref>; <xref ref-type="bibr" rid="bib8">Bunin, 2017</xref>; <xref ref-type="bibr" rid="bib43">Serván and Allesina, 2021</xref>; <xref ref-type="bibr" rid="bib19">Friedman et al., 2017</xref>; <xref ref-type="bibr" rid="bib22">Goldford et al., 2018</xref>; <xref ref-type="bibr" rid="bib24">Hu et al., 2021</xref>). Although this is an important starting point, it is essential to incorporate evolution to understand how the processes of mutation, inheritance, selection, and extinction could give rise to highly diverse communities.</p><p>Previous theoretical work has shown that diverse communities in certain consumer-resource models are destabilized by evolution (<xref ref-type="bibr" rid="bib44">Shoresh et al., 2008</xref>), at odds with the highly diverse continuously evolving microbial populations in nature. Others have focused on eco-evolutionary dynamics when the mutation rate is high enough to sustain diversity: in this case the common ancestor of coexisting strains is recent and extensive diversity over a wide range of genetic divergence does not have time to evolve (<xref ref-type="bibr" rid="bib54">Xue and Goldenfeld, 2017</xref>). Yet others have shown that when niches in phenotype space are assumed, boom-bust dynamics can result in the evolution of higher diversity than occurs in stable equilibrium (<xref ref-type="bibr" rid="bib14">Doebeli et al., 2021</xref>). But overall there is no clear consensus on whether evolution tends to destabilize or to increase diversity in ecologically interacting communities — indeed the answer to this question is likely context-dependent — though observations of the natural world suggest that evolution often results in increased diversity. Here, we investigate evolution starting from a state with spatiotemporally chaotic ecological dynamics as studied in PAF, where niches are absent and the diversity — at least initially — is stabilized by the interplay between endogenous ecological dynamical fluctuations and migration.</p><p>We are interested in understanding diversity that has existed for a very broad spectrum of evolutionary timescales, far longer than ecological or spatial mixing timescales. We thus study the extreme limit where the mutation rate is small enough that the ecological and migratory dynamics reach steady state before the introduction of each new strain. This <italic>quasistatic</italic> limit of evolution is the “hardest” for diversification. In addition, and in contrast to some previous work (<xref ref-type="bibr" rid="bib49">Tikhonov and Monasson, 2018</xref>), we assume that global extinctions of a strain are permanent: an extinct organism cannot be resurrected even if conditions later become favorable for it. Focusing on the STC phase, we endeavor to answer: Can a highly diverse STC phase evolve? Under what conditions? Can this phase continue to diversify? Is the diversity stable to <italic>general fitness</italic> mutations that are not artificially constrained by assumptions of tradeoffs? How do statistical properties of the community change during evolution?</p><sec id="s1-1"><title>Summary of main results</title><p>We first summarize the main results of this work, which concern the behavior of the STC phase under serial invasion of new strains. A parent strain in the community occasionally gives rise to a mutant strain whose properties are correlated with those of its parent with correlations parametrized by <inline-formula><mml:math id="inf17"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Many of the behaviors are similar across this range, from independent invaders with <inline-formula><mml:math id="inf18"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> to small-effect mutations with <inline-formula><mml:math id="inf19"><mml:mi>ρ</mml:mi></mml:math></inline-formula> close to 1. In all cases, extinctions are irreversible. Key properties of interest are the number of extant strains in the ecosystem, <inline-formula><mml:math id="inf20"><mml:mi>L</mml:mi></mml:math></inline-formula>, the number of successful invasions <inline-formula><mml:math id="inf21"><mml:mi>Z</mml:mi></mml:math></inline-formula>, and how these evolve with evolutionary time, parametrized by the number of attempted invasions, <inline-formula><mml:math id="inf22"><mml:mi>T</mml:mi></mml:math></inline-formula>.</p><p>We find that for a wide range of <inline-formula><mml:math id="inf23"><mml:mi>ρ</mml:mi></mml:math></inline-formula> (and expect for any <inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) the STC can enter a steadily diversifying state wherein the number of successful invasions, <inline-formula><mml:math id="inf25"><mml:mi>Z</mml:mi></mml:math></inline-formula>, and the number of coexisting strains, <inline-formula><mml:math id="inf26"><mml:mi>L</mml:mi></mml:math></inline-formula>, both increase linearly with <inline-formula><mml:math id="inf27"><mml:mi>T</mml:mi></mml:math></inline-formula> on average, with only small fluctuations when <inline-formula><mml:math id="inf28"><mml:mi>L</mml:mi></mml:math></inline-formula> is large. Whether diversification occurs, and the rate of the diversification if it does, depends on various parameters, but it is robust over a range of the parameters. If initially the ecosystem has only a modest number of strains, the evolutionary dynamics tend to cause the diversity to crash, after which is it extremely unlikely to transition into the diversifying phase. However, if the initial ecosystem is sufficiently diverse, it is highly likely to diversify further.</p><p>We then study the effects of general fitness differences that augment the average growth rate of a strain by an intrinsic amount irrespective of its interactions with the other strains. Focusing on unrelated invaders, we show that a distribution of such general fitness differences (denoted by <inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> for strain <inline-formula><mml:math id="inf30"><mml:mi>i</mml:mi></mml:math></inline-formula>) can either slow down, prevent, or reverse diversification. For distributions of the <inline-formula><mml:math id="inf31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> whose tails decay faster than exponentially, the diversifying phase still exists, but with the diversification rate gradually slowing down: <inline-formula><mml:math id="inf32"><mml:mi>L</mml:mi></mml:math></inline-formula> increases only as a power of <inline-formula><mml:math id="inf33"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. If the distribution of the <inline-formula><mml:math id="inf34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> has a broader-than-exponential tail, the diversity decreases and crashes.</p><p>The key property of a strain, in terms of which one can understand its behavior, is its <italic>bias</italic>: defined as the rate at which its population would change when at low-abundance and without migration (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). The crucial effect of migration in the STC is to stabilize many strains with negative bias which would have gone extinct without migration. Only if its bias is strongly negative will a strain go globally extinct. The bias of strain <inline-formula><mml:math id="inf35"><mml:mi>i</mml:mi></mml:math></inline-formula>, denoted by <inline-formula><mml:math id="inf36"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, has an intrinsic contribution from its general fitness <inline-formula><mml:math id="inf37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, and an extrinsic contribution from the interactions of strain <inline-formula><mml:math id="inf38"><mml:mi>i</mml:mi></mml:math></inline-formula> with all other strains, which includes both an <inline-formula><mml:math id="inf39"><mml:mi>i</mml:mi></mml:math></inline-formula>-dependent part determined by the interactions with the other strains in the community, and an <inline-formula><mml:math id="inf40"><mml:mi>i</mml:mi></mml:math></inline-formula>-independent part that keeps the total population constant. The extrinsic part of the bias of each strain changes as the community evolves, but its intrinsic part says the same.</p><p>Building upon the theoretical understanding of the STC phase, developed in PAF, we first analyze evolution in the simplest case of unrelated invaders (<inline-formula><mml:math id="inf41"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) with no general fitnesses (<inline-formula><mml:math id="inf42"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>). The bias of each strain undergoes a random walk on evolutionary timescales, and we find that for large communities, the number of strains changes at a steady rate. For a range of parameters, this diversification rate is positive, yielding a steadily diversifying phase with the distribution of biases scaling with <inline-formula><mml:math id="inf43"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>, as observed in numerics. We then extend our analysis of the changing bias distribution to include the effects of general fitness differences. This yields predictions of how the rate of diversity increase (or decrease) depends on the distribution of the <inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, corroborating the behaviors found in simulations.</p><p>The distributions of biases and abundances in evolved communities differ subtly from those of the initial communities that were assembled all-at-once from unrelated strains. At early stages of the evolution, most of the close-to-marginal, low-abundance strains are pushed out by the perturbations caused by the invading strains. This extinction process causes the shape of the abundance distributions of assembled and evolved communities to differ at low abundances. Later, in the steadily diversifying state, the numbers of extinctions caused by each invader has a roughly exponential distribution, which is consistent with our theoretical expectations. In contrast to the qualitative (albeit modest) changes in abundance distributions, we find that evolution has only a small effect on the statistics of the interactions between strains.</p></sec><sec id="s1-2"><title>Outline</title><p>The structure of this paper is as follows: ‘Models’ introduces the main model and its relation to previous work. ‘Results’ describes the phenomenology of an evolving community in the STC phase, studying the effects of correlated mutants, interaction statistics, and general fitness differences on the ecological diversification. Then ‘Analysis’ develops the theory and analysis that are needed to understand these phenomena. Building upon the dynamical mean field theory developed in PAF, we present an approximate framework, and more general scaling arguments, for understanding the evolutionary dynamics, and compare the predictions with simulations. Finally ‘Discussion’ raises additional questions and discusses possible extensions. Many of the details and further analyses are relegated to appendices.</p></sec></sec><sec id="s2"><title>Models</title><p>We here define the model, discussing the various roles played by local deterministic population dynamics, demographic stochasticity, spatial migration and evolutionary dynamics. Our notation is summarized in <xref ref-type="table" rid="table1">Table 1</xref>.</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Definitions of commonly used quantities.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Ecology</th><th align="left" valign="bottom"/></tr></thead><tbody><tr><td align="left" valign="bottom">STC</td><td align="left" valign="bottom">Spatiotemporally chaotic state</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf45"><mml:mi>K</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Number of strains put into the initial assembled community</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf46"><mml:mi>V</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Matrix of pairwise strain interactions</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf47"><mml:mi>γ</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Symmetry parameter of the interaction matrix; <inline-formula><mml:math id="inf48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf49"><mml:mi>I</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Number of islands</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf50"><mml:mi>N</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Population size on each island, fixed to be constant</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf51"><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">Fractional abundance of strain <inline-formula><mml:math id="inf52"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> on island <inline-formula><mml:math id="inf53"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf54"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">Time (or space) average of strain <inline-formula><mml:math id="inf55"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> abundance</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf56"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Migration floor <inline-formula><mml:math id="inf57"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>∼</mml:mo><mml:mi>m</mml:mi><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:msqrt><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mstyle></mml:math></inline-formula>: ~ lower range of local abundances</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf58"><mml:msub><mml:mi mathvariant="normal">Υ</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">Lagrange multiplier maintaining <inline-formula><mml:math id="inf59"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>; <inline-formula><mml:math id="inf60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Υ</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf61"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">General fitness of strain <inline-formula><mml:math id="inf62"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf63"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Probability distribution of the <inline-formula><mml:math id="inf64"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf65"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Characteristic scale of the <inline-formula><mml:math id="inf66"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> distribution</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf67"><mml:mi>ψ</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Exponent characterizing tail of of <inline-formula><mml:math id="inf68"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>ψ</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf69"><mml:mi>m</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Migration rate between islands</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf70"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Range of fluctuations in <inline-formula><mml:math id="inf71"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>; <inline-formula><mml:math id="inf72"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><th align="left" valign="bottom">Evolution</th><th align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf73"><mml:mi>ρ</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Correlation between parent’s and mutant’s interactions with other strains</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf74"><mml:mi>T</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Evolutionary time in epochs, equal to number of attempted invasions</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf75"><mml:mi>Z</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Number of successful invasions</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf76"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Number of extant strains at any point in the evolution</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Number of strains surviving in initial assembled community</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf78"><mml:mi>U</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Average diversification rate; <inline-formula><mml:math id="inf79"><mml:mrow><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf80"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula></td><td align="left" valign="bottom">Mean general fitness of extant strains;  <inline-formula><mml:math id="inf81"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf82"><mml:mover accent="true"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula></td><td align="left" valign="bottom">The scale of <inline-formula><mml:math id="inf83"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> of extant strains; <inline-formula><mml:math id="inf84"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><th align="left" valign="bottom">Analysis</th><th align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf85"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">Bias of strain <inline-formula><mml:math id="inf86"><mml:mi>i</mml:mi></mml:math></inline-formula>, its growth rate at low abundance without migration; <inline-formula><mml:math id="inf87"><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>, scales as  <inline-formula><mml:math id="inf88"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo mathvariant="script" stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo mathvariant="script" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Mean abundance of a strain as a function of its bias</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf90"><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">Critical bias (negative in the STC) below which strains go extinct, scales as <inline-formula><mml:math id="inf91"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf92"><mml:msub><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">Mean drive on strain <inline-formula><mml:math id="inf93"><mml:mi>i</mml:mi></mml:math></inline-formula> by other strains in its absence; <inline-formula><mml:math id="inf94"><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>∖</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf95"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Effective number of extant strains; <inline-formula><mml:math id="inf96"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>; scales with  <inline-formula><mml:math id="inf97"><mml:mi>L</mml:mi></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf98"><mml:msub><mml:mi>χ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">Static response of strain <inline-formula><mml:math id="inf99"><mml:mi>i</mml:mi></mml:math></inline-formula> to perturbations; <inline-formula><mml:math id="inf100"><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf101"><mml:mi>X</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Total static response;  <inline-formula><mml:math id="inf102"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>χ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf103"><mml:mi mathvariant="normal">Ξ</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Fragility of the community to perturbations;  <inline-formula><mml:math id="inf104"><mml:mrow><mml:mi mathvariant="normal">Ξ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr></tbody></table></table-wrap><sec id="s2-1"><title>Ecological interactions</title><p>We first consider an assembled community of <inline-formula><mml:math id="inf105"><mml:mi>K</mml:mi></mml:math></inline-formula> unrelated strains, labelled by <inline-formula><mml:math id="inf106"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, with all possible pairwise interactions between them. A paradigmatic model for the ecological dynamics of the strain populations <inline-formula><mml:math id="inf107"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> is the generalized Lotka-Volterra model (<xref ref-type="bibr" rid="bib21">Goel et al., 1971</xref>), with each strain <inline-formula><mml:math id="inf108"><mml:mi>i</mml:mi></mml:math></inline-formula> having an intrinsic growth rate which is modulated by its interactions with all the other strains. These interactions are conveniently represented in a matrix <inline-formula><mml:math id="inf109"><mml:mi>W</mml:mi></mml:math></inline-formula> where <inline-formula><mml:math id="inf110"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> describes the effect of strain <inline-formula><mml:math id="inf111"><mml:mi>j</mml:mi></mml:math></inline-formula> on the growth rate of strain <inline-formula><mml:math id="inf112"><mml:mi>i</mml:mi></mml:math></inline-formula>. Since we are interested in closely related strains for which all interactions are similar, the total population will be roughly fixed at some <inline-formula><mml:math id="inf113"><mml:mi>N</mml:mi></mml:math></inline-formula> by the balance between the effects of positive intrinsic growth rate and negative competitive interactions. It is convenient to replace these large terms by a Lagrange multiplier <inline-formula><mml:math id="inf114"><mml:mrow><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> that fixes the total population to <inline-formula><mml:math id="inf115"><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, and work with fractional abundances, <inline-formula><mml:math id="inf116"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≡</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. This parameterization yields what are known as “replicator equations” (<xref ref-type="bibr" rid="bib10">Chawanya and Tokita, 2002</xref>; <xref ref-type="bibr" rid="bib55">Yoshino et al., 2008</xref>; <xref ref-type="bibr" rid="bib50">Tokita, 2004</xref>).</p><p>Variations in intrinsic growth rates and net interactions on a strain can be combined to yield <italic>general fitness differences</italic>, <inline-formula><mml:math id="inf117"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, between the strains. We parameterize the residual variations in interactions among the strains (after subtracting off <inline-formula><mml:math id="inf118"><mml:mi mathvariant="normal">Υ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf119"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) by <inline-formula><mml:math id="inf120"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Since the <inline-formula><mml:math id="inf121"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf122"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> are sums and differences of similar magnitude terms, it is natural to approximate them as random variables with the hope that the model will yield behaviors that are robust to specific choices of their statistics: testing this assumption is one of the goals of this paper. For simplicity, we choose <inline-formula><mml:math id="inf123"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf124"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf125"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula> — setting the overall ecological timescales — and choose the covariances to be zero except for, importantly, correlations between how <inline-formula><mml:math id="inf126"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf127"><mml:mi>j</mml:mi></mml:math></inline-formula> affect each other, defining <inline-formula><mml:math id="inf128"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:math></inline-formula>. For convenience, we choose <inline-formula><mml:math id="inf129"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> but this choice has negligible effect in large communities.</p><p>The parameter <inline-formula><mml:math id="inf130"><mml:mi>γ</mml:mi></mml:math></inline-formula> controls whether the interactions are mainly competitive (<inline-formula><mml:math id="inf131"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) or host-pathogen-like (<inline-formula><mml:math id="inf132"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), the latter being the focus of this work. We have shown in PAF that random interaction matrices with such anticorrelations behave very similarly to host-pathogen models with the appropriate block sub-matrix structure, as discussed further in ‘Bacteria-phage interactions and coevolution’.</p></sec><sec id="s2-2"><title>Ecological dynamics</title><p>We study the simplest model with spatial structure: a large number, <inline-formula><mml:math id="inf133"><mml:mi>I</mml:mi></mml:math></inline-formula>, of identical islands (or demes) with interactions only within each island and migration between all pairs of islands. With Greek indices labeling islands, the dynamics of the abundances obey<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="normal">Υ</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>with <inline-formula><mml:math id="inf134"><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> the migration rate (per individual) from island <inline-formula><mml:math id="inf135"><mml:mi>β</mml:mi></mml:math></inline-formula> to island <inline-formula><mml:math id="inf136"><mml:mi>α</mml:mi></mml:math></inline-formula> and the local Lagrange multiplier, <inline-formula><mml:math id="inf137"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Υ</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, keeping the total population on each island fixed at <inline-formula><mml:math id="inf138"><mml:mi>N</mml:mi></mml:math></inline-formula>, (i.e. <inline-formula><mml:math id="inf139"><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> for each island). Here, we focus on the spatial mean field limit in which the migration rate is the same, given by <inline-formula><mml:math id="inf140"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>, between every pair of islands. The total migration of strain <inline-formula><mml:math id="inf141"><mml:mi>i</mml:mi></mml:math></inline-formula> into and out of island <inline-formula><mml:math id="inf142"><mml:mi>α</mml:mi></mml:math></inline-formula> is then simply <inline-formula><mml:math id="inf143"><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="inf144"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> the average of <inline-formula><mml:math id="inf145"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> across islands. As the number of islands becomes large, in steady state, each <inline-formula><mml:math id="inf146"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> becomes constant in time — some being zero corresponding to global extinction. In the STC, the dynamics are asynchronous across islands and ergodicity implies the spatial average, <inline-formula><mml:math id="inf147"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, is equal to the time-averaged abundance of strain <inline-formula><mml:math id="inf148"><mml:mi>i</mml:mi></mml:math></inline-formula> on a single island; this is a crucial self-consistency condition. The magnitude, <inline-formula><mml:math id="inf149"><mml:mi>m</mml:mi></mml:math></inline-formula> of the migration rate, is also of fundamental importance. If <inline-formula><mml:math id="inf150"><mml:mi>m</mml:mi></mml:math></inline-formula> is too small the migration is too rare to repopulate islands after local extinctions. If <inline-formula><mml:math id="inf151"><mml:mi>m</mml:mi></mml:math></inline-formula> is too large and the local dynamics is chaotic, the chaos will synchronize across the islands and the total population of each strain will fluctuate wildly, rapidly driving most strains extinct. We will focus on the wide intermediate <inline-formula><mml:math id="inf152"><mml:mi>m</mml:mi></mml:math></inline-formula> regime, which spans several orders of magnitude when <inline-formula><mml:math id="inf153"><mml:mi>K</mml:mi></mml:math></inline-formula> is large [PAF].</p><p>With large populations on each island, demographic fluctuations have little effect on the dynamics. Even when the local population of a strain is small, if it has positive growth rate, fluctuations will not matter much, while if it has negative growth rate it will go deterministically extinct which occurs when the fractional abundance drops below the extinction threshold of <inline-formula><mml:math id="inf154"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> indicated in <xref ref-type="fig" rid="fig1">Figure 1A</xref> by the horizontal purple line. The value of the extinction threshold does not much affect the behavior as long as it is much below the lower limit of the abundance caused by migration — which we term the <italic>migration floor</italic>: <inline-formula><mml:math id="inf155"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mrow><mml:mtext mathvariant="italic">floor</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>m</mml:mi><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. For strains near local extinction (when the fractional abundance is close to <inline-formula><mml:math id="inf156"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>) demographic fluctuations are potentially important. But with <inline-formula><mml:math id="inf157"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> very large, local extinctions for viable strains will be rare: thus we model the population dynamics as fully deterministic. If the fractional abundance on an island drops below <inline-formula><mml:math id="inf158"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, it is set equal to zero. Global extinction occurs when a strain’s bias becomes too negative, which results in it going below the extinction threshold everywhere. The choice of <inline-formula><mml:math id="inf159"><mml:mi>N</mml:mi></mml:math></inline-formula> does not matter much as long as <inline-formula><mml:math id="inf160"><mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mo>≫</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, to which we restrict consideration. Related details of numerical implementation are discussed in ‘Appendix 2’. In ‘Spatial structure and dynamics’, we comment on the effects of local extinctions in the context of real spatial dynamics.</p><p>The key properties of the STC phase [PAF] are chaotic coexistence of strains, desynchronized across islands, with the local abundances fluctuating over a range in <inline-formula><mml:math id="inf161"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> of <inline-formula><mml:math id="inf162"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mo>≡</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, which is quite wide for the typical <inline-formula><mml:math id="inf163"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> that we use in simulations. Some strains go globally extinct but each persistent strain on each island occasionally has a bloom up to high abundance <inline-formula><mml:math id="inf164"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ν</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. These localized blooms are crucial for stabilizing a strain, as they dominate the migration to other islands needed to recover from local extinctions or near-extinctions. On a single island, at any given moment, <inline-formula><mml:math id="inf165"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> strains are at high abundance. A snapshot of the abundances on a single island shows the strains distributed roughly uniformly in <inline-formula><mml:math id="inf166"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> down to the migration floor, only occasionally fluctuating substantially lower (<xref ref-type="fig" rid="fig1">Figure 1</xref>).</p></sec><sec id="s2-3"><title>Evolutionary dynamics</title><p>The evolutionary process we model is much slower than the ecological and migratory dynamics. Simulations are divided into long <italic>epochs</italic>, with new strains added only at the end of an epoch. The epochs are chosen long enough that the ecological and migratory dynamics have reached a steady state, with some fraction of the strains having gone <italic>permanently extinct</italic> globally, leaving <inline-formula><mml:math id="inf167"><mml:mi>L</mml:mi></mml:math></inline-formula> persistent strains. A single new strain is then introduced and the process repeated.</p><p>The new strain, generically labeled <inline-formula><mml:math id="inf168"><mml:mi>A</mml:mi></mml:math></inline-formula>, is parameterized by its interactions with all other strains in the community, given by <inline-formula><mml:math id="inf169"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf170"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and its general fitness, <inline-formula><mml:math id="inf171"><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula>. In the simplest case, a new strain is unrelated to extant (or extinct) strains. More generally, mutant strains, labelled <inline-formula><mml:math id="inf172"><mml:mi>M</mml:mi></mml:math></inline-formula>, are characterized by their degree of correlation, <inline-formula><mml:math id="inf173"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, with a parent strain <inline-formula><mml:math id="inf174"><mml:mi>P</mml:mi></mml:math></inline-formula> chosen from the existing community with probability proportional to its mean abundance <inline-formula><mml:math id="inf175"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>P</mml:mi></mml:msub></mml:math></inline-formula>. These correlations are realized such that <inline-formula><mml:math id="inf176"><mml:mrow><mml:mrow><mml:mi>Corr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>Corr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf177"><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. The detailed choices for <inline-formula><mml:math id="inf178"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> are given in ‘Appendix 2’. The general fitness, <inline-formula><mml:math id="inf179"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mtext mathvariant="italic">M</mml:mtext></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, can also be correlated with <inline-formula><mml:math id="inf180"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mtext mathvariant="italic">P</mml:mtext></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Unrelated invaders are equivalent to <inline-formula><mml:math id="inf181"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and hence have no parent.</p><p>The actual process of invasion from low abundance on one island is complicated, and often leads to failure. To avoid a proliferation of such failed invasions, we instead assess whether the invader <italic>could</italic> successfully invade and persist if it were lucky initially. To do this, we set the mutant’s abundance to <inline-formula><mml:math id="inf182"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> on all the islands at the same time (and proportionately decrease the abundances of the other strains to maintain <inline-formula><mml:math id="inf183"><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>).</p></sec><sec id="s2-4"><title>Timescales</title><p>There are multiple timescales involved in the dynamics: these are discussed more fully in ‘Appendix 1’. The basic timescale for <italic>differential growth or decay</italic> of strains is set by the magnitude of the interactions and the number, <inline-formula><mml:math id="inf184"><mml:mi>L</mml:mi></mml:math></inline-formula>, of extant strains. The extant strains have average abundances of order <inline-formula><mml:math id="inf185"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, so the average total interaction on a strain, <inline-formula><mml:math id="inf186"><mml:mi>i</mml:mi></mml:math></inline-formula>, is the sum of <inline-formula><mml:math id="inf187"><mml:mi>L</mml:mi></mml:math></inline-formula> random terms, each of order <inline-formula><mml:math id="inf188"><mml:mrow><mml:mi>V</mml:mi><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> for typical interaction strength <inline-formula><mml:math id="inf189"><mml:mi>V</mml:mi></mml:math></inline-formula>. With the <inline-formula><mml:math id="inf190"><mml:mi>V</mml:mi></mml:math></inline-formula> having variance unity, the average net interactions of other strains on strain <inline-formula><mml:math id="inf191"><mml:mi>i</mml:mi></mml:math></inline-formula> is roughly its <italic>mean drive</italic>, <inline-formula><mml:math id="inf192"><mml:msub><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, which is of order <inline-formula><mml:math id="inf193"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>, implying that the timescale for systematic population growth or decay is of order <inline-formula><mml:math id="inf194"><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:math></inline-formula>. The mean drive is defined more precisely in Results. When there are general fitness differences, <inline-formula><mml:math id="inf195"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, these also contribute to variations in average growth rates. The variations in the <inline-formula><mml:math id="inf196"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> within the community have substantial effects over a time <inline-formula><mml:math id="inf197"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="inf198"><mml:msub><mml:mi>σ</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> roughly the width of the <inline-formula><mml:math id="inf199"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> distribution of the <italic>extant</italic> strains. Together, the mean drive and general fitness of a strain determine its crucial property: the bias <inline-formula><mml:math id="inf200"><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, with angular brackets denoting a time average. As introduced earlier, the bias of strain <inline-formula><mml:math id="inf201"><mml:mi>i</mml:mi></mml:math></inline-formula> is its average growth rate at low abundance in the absence of migration (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). As we shall see, the size of the community is limited by the condition that the inter-strain variation in general fitness is no larger than variation in average drive from interactions. This means that the biases are of order <inline-formula><mml:math id="inf202"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>.</p><p>The local population of each strain undergoes wild fluctuations over a logarithmic range <inline-formula><mml:math id="inf203"><mml:mrow><mml:mi mathvariant="script">M</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> which is quite large. During blooms, the instantaneous growth and decay rates of local populations are substantially larger than the systematic biases (‘Appendix 1’) and change rapidly from growth to decay as seen in <xref ref-type="fig" rid="fig1">Figure 1</xref>. The time for abundances to fluctuate from large to small — the <italic>duration of blooms</italic> — is of order <inline-formula><mml:math id="inf204"><mml:mrow><mml:mi mathvariant="script">M</mml:mi><mml:mo>⁢</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula> with systematic and fluctuation contributions comparable.</p><p>An important timescale for studying slow evolution is the time to reach the STC steady state: the <italic>ecological relaxation time</italic>. This is determined by the strains that are just barely going extinct and is of order <inline-formula><mml:math id="inf205"><mml:mrow><mml:mi mathvariant="script">M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> for an evolved community, as discussed in ‘Continual assembly and diversification’. We have chosen the evolutionary timescale to be much longer than all the other important timescales. Thus, each epoch between the addition of invaders is chosen to be several times the ecological relaxation time, typically <inline-formula><mml:math id="inf206"><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="script">M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, and we show in ‘Appendix 2’ that increasing this epoch length by a factor of 10 makes little difference in the diversification dynamics.</p></sec></sec><sec id="s3" sec-type="results"><title>Results</title><p>The STC is robust, with strains persisting for times that are exponentially long in the number of islands. However, evolutionary perturbations caused by an invading strain can drive strains deterministically extinct. This process can be understood in terms of the biases of the strains.</p><p>The bias of a strain, is determined by the community <italic>in its absence</italic>. It can be written precisely as <inline-formula><mml:math id="inf207"><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi mathvariant="normal">Υ</mml:mi><mml:mrow><mml:mo>∖</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> with the mean drive <inline-formula><mml:math id="inf208"><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>∖</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where the notation <inline-formula><mml:math id="inf209"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>∖</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf210"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi mathvariant="normal">Υ</mml:mi><mml:mrow><mml:mo>∖</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula> denote the time-averaged abundance of strain <inline-formula><mml:math id="inf211"><mml:mi>j</mml:mi></mml:math></inline-formula> and average Lagrange multiplier in the absence of strain <inline-formula><mml:math id="inf212"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. The <inline-formula><mml:math id="inf213"><mml:mi mathvariant="normal">Υ</mml:mi></mml:math></inline-formula> is not much changed by the absence of the one strain, but the abundances of the other strains are affected in small but collectively essential ways by whether or not strain <inline-formula><mml:math id="inf214"><mml:mi>i</mml:mi></mml:math></inline-formula> is present, as discussed in ‘Dynamical mean field theory’. This negative feedback — proportional to <inline-formula><mml:math id="inf215"><mml:mi>γ</mml:mi></mml:math></inline-formula> — is what stabilizes strains whose abundance would otherwise keep growing.</p><p>With many strains participating in the chaos on each island, and desynchronization across islands, we expect the chaos to be ergodic, so that the <inline-formula><mml:math id="inf216"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> time averages and spatial averages (across islands) of all quantities are equal in the STC steady state. Therefore we will use spatial average notation <inline-formula><mml:math id="inf217"><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> instead of time average notation <inline-formula><mml:math id="inf218"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi>ν</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula>, except when conceptually the latter is clearer. In practice, the <inline-formula><mml:math id="inf219"><mml:mrow><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mn>40</mml:mn></mml:mrow></mml:math></inline-formula> islands used in numerics are enough that the persistence times of almost all surviving strains are very long and averages across islands of the more important quantities do not fluctuate much in steady state.</p><p>A crucial feature of the STC phase is that strains with somewhat negative bias can persist due to migration between desynchronized islands (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). This stabilization is enabled by a nontrivial feature of the STC phase: during a bloom, the systematic changes in <inline-formula><mml:math id="inf220"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> caused by the bias are comparable to the cumulative stochastic growth and decay caused by the endogenous fluctuations — the zigs and zags in the dynamics of <inline-formula><mml:math id="inf221"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1">Figure 1</xref>). This is a manifestation of the system “self-tuning” to a special self-consistently chaotic state [PAF].</p><p>Despite the possibility of rescue from extinction via rare blooms, there is a critical negative bias, <inline-formula><mml:math id="inf222"><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula>, (sharp for large <inline-formula><mml:math id="inf223"><mml:mi>L</mml:mi></mml:math></inline-formula> and large <inline-formula><mml:math id="inf224"><mml:mi>I</mml:mi></mml:math></inline-formula>) below which strains no longer persist even as <inline-formula><mml:math id="inf225"><mml:mrow><mml:mi>I</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula>. For strains with <inline-formula><mml:math id="inf226"><mml:mi>ξ</mml:mi></mml:math></inline-formula> below <inline-formula><mml:math id="inf227"><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula> (which depends on the parameters and the number of strains), blooms up to high abundance are not frequent enough to repopulate local extinctions and deterministic global extinction ensues. For large <inline-formula><mml:math id="inf228"><mml:mi>I</mml:mi></mml:math></inline-formula> and large <inline-formula><mml:math id="inf229"><mml:mi>L</mml:mi></mml:math></inline-formula>, strains with <inline-formula><mml:math id="inf230"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> go extinct, while strains with <inline-formula><mml:math id="inf231"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> persist indefinitely. Finite <inline-formula><mml:math id="inf232"><mml:mi>L</mml:mi></mml:math></inline-formula> and finite <inline-formula><mml:math id="inf233"><mml:mi>I</mml:mi></mml:math></inline-formula> effects, together with the finite time for each epoch, will round out the sharpness of the borderline between persistent and extinct. However the marginal strains involved have little effect on others and whether or not they persist does not much matter for the current epoch: we are interested in <italic>deterministic</italic> extinction caused by the introduction of new strains. Therefore, we need to study how the <italic>distribution</italic> of biases in the ecosystem evolves.</p><sec id="s3-1"><title>Continual assembly and diversification</title><p>The evolutionary process we study starts from an assembled collection of <inline-formula><mml:math id="inf234"><mml:mi>K</mml:mi></mml:math></inline-formula> unrelated strains. After the ecological and migratory dynamics have reached steady state, some of the strains will persist: we call the size of this initial persistent community <inline-formula><mml:math id="inf235"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. The <inline-formula><mml:math id="inf236"><mml:mrow><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> strains that have gone globally extinct are permanently removed.</p><p>When a new strain is introduced into the ecosystem, if it successfully invades it perturbs the biases of the extant strains, and can trigger extinctions of some of them by shifting their bias below <inline-formula><mml:math id="inf237"><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1">Figure 1A</xref>) by an amount of order <inline-formula><mml:math id="inf238"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>. We study the slowly evolving regime in which the ecosystem dynamics reach steady state between each introduction of a new strain — this takes time of order <inline-formula><mml:math id="inf239"><mml:mrow><mml:mi mathvariant="script">M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>. The number of persistent strains and number of successful invasions as a function of the number of attempted invasions, <inline-formula><mml:math id="inf240"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf241"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> respectively, are of fundamental interest.</p><p>We first describe the evolutionary dynamics when the general fitness differences between the strains can be neglected. For <inline-formula><mml:math id="inf242"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and <italic>unrelated invaders</italic> (<inline-formula><mml:math id="inf243"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), multiple simulation runs starting with different sets of <inline-formula><mml:math id="inf244"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> initial strains reveal that around one fifth of the replicates enter a steadily diversifying regime in which <inline-formula><mml:math id="inf245"><mml:mi>L</mml:mi></mml:math></inline-formula> increases roughly linearly with the number of attempted invasions, at a rate of around 0.25 per attempt. The remaining replicates crash down to only a few persistent strains. Subsequent invasions can cause <inline-formula><mml:math id="inf246"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to increase somewhat, but it quickly crashes back down and the community does not steadily diversify (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). The low diversity regime that occurs after a crash (or with a very small initial community) is discussed further in ‘Appendix 3’.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Evolution of number of strains without general fitness differences.</title><p>(<bold>A</bold>) With <inline-formula><mml:math id="inf247"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf248"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and initial number of strains <inline-formula><mml:math id="inf249"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula>, under serial invasion of <italic>unrelated strains</italic> most initial communities (red) crash and fail to recover, while others (about 20%, blue) continually diversify. Once the communities are large, around 80% of further invasions are successful and the mean number of extinctions per successful invasion is <inline-formula><mml:math id="inf250"><mml:mrow><mml:mi/><mml:mo>≅</mml:mo><mml:mn>0.7</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1</xref>) so that on average the number of strains in the community grows linearly with rate <inline-formula><mml:math id="inf251"><mml:mrow><mml:mi>U</mml:mi><mml:mo>≅</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math></inline-formula> per invasion attempt (dashed line). (<bold>B</bold>) Whether diversification occurs, and its rate if it does, depends on the symmetry parameter, <inline-formula><mml:math id="inf252"><mml:mi>γ</mml:mi></mml:math></inline-formula>, as seen here with <inline-formula><mml:math id="inf253"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>400</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf254"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. For <inline-formula><mml:math id="inf255"><mml:mi>γ</mml:mi></mml:math></inline-formula> close to <inline-formula><mml:math id="inf256"><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.7</mml:mn></mml:mrow></mml:math></inline-formula>, evolution reduces the diversity. For less negative <inline-formula><mml:math id="inf257"><mml:mi>γ</mml:mi></mml:math></inline-formula>, the STC breaks down and the diversity crashes immediately. For more negative <inline-formula><mml:math id="inf258"><mml:mi>γ</mml:mi></mml:math></inline-formula>, steady diversification occurs, fastest here with <inline-formula><mml:math id="inf259"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, though again slowing down as <inline-formula><mml:math id="inf260"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>→</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. (<bold>C</bold>) Evolving communities under successive introduction of <italic>mutants</italic>, each with correlation <inline-formula><mml:math id="inf261"><mml:mi>ρ</mml:mi></mml:math></inline-formula> with its parent (<inline-formula><mml:math id="inf262"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>). The diversification rate varies nonmonotonically with <inline-formula><mml:math id="inf263"><mml:mi>ρ</mml:mi></mml:math></inline-formula>, with fastest diversification for <inline-formula><mml:math id="inf264"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>≈</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula>. There is a significant slowdown for <inline-formula><mml:math id="inf265"><mml:mi>ρ</mml:mi></mml:math></inline-formula> close to unity. Here <inline-formula><mml:math id="inf266"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> and trajectories are shown conditional on not crashing, except for <inline-formula><mml:math id="inf267"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.99</mml:mn></mml:mrow></mml:math></inline-formula>, which renders the evolving community very susceptible to crashing from <inline-formula><mml:math id="inf268"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula>. However the inset shows that even with <inline-formula><mml:math id="inf269"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.99</mml:mn></mml:mrow></mml:math></inline-formula>, it is possible to reach a diversifying regime starting from <inline-formula><mml:math id="inf270"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82734-fig2-v2.tif"/></fig><p>The observations in <xref ref-type="fig" rid="fig2">Figure 2</xref> illustrate one of the crucial findings of this work: spatiotemporally chaotic ecological dynamics can allow — but do not guarantee — gradual strain-level diversification up to arbitrarily high number of strains. The behavior depends on the symmetry parameter <inline-formula><mml:math id="inf271"><mml:mi>γ</mml:mi></mml:math></inline-formula>, which must be substantially negative for the STC to exist. <xref ref-type="fig" rid="fig2">Figure 2B</xref> shows that the average rate of diversification, <inline-formula><mml:math id="inf272"><mml:mrow><mml:mi>U</mml:mi><mml:mo>≡</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, is nonmonotonic in <inline-formula><mml:math id="inf273"><mml:mi>γ</mml:mi></mml:math></inline-formula>, with slow diversification close to <inline-formula><mml:math id="inf274"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> (its lower limit). As <inline-formula><mml:math id="inf275"><mml:mi>γ</mml:mi></mml:math></inline-formula> becomes less negative the rate of diversification increases at first. However for <inline-formula><mml:math id="inf276"><mml:mi>γ</mml:mi></mml:math></inline-formula> even less negative, the STC still supports chaotic coexistence of many strains (since <inline-formula><mml:math id="inf277"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is still large), but the diversity decreases under evolutionary dynamics. The community diversifies most rapidly for <inline-formula><mml:math id="inf278"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. As we are interested in what can happen with various other additional features, we chose <inline-formula><mml:math id="inf279"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf280"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> for all further simulations as shorter runs are needed near these values. We expect that the qualitative conclusions will be similar for a range of <inline-formula><mml:math id="inf281"><mml:mi>γ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf282"><mml:mi>m</mml:mi></mml:math></inline-formula> around these.</p></sec><sec id="s3-2"><title>Evolution with correlated mutants</title><p>In addition to studying independent invasions, we study evolution via mutations of existing strains. At the start of each epoch, a parent to mutate is chosen with probability proportional to its mean abundance. The interactions of the mutant with other strains are drawn from the same marginal distribution as the original interactions, but with correlation <inline-formula><mml:math id="inf283"><mml:mi>ρ</mml:mi></mml:math></inline-formula> with the interactions of the parent (Evolutionary dynamics). The direct interactions between the parent and mutant have to be chosen separately as specified in ‘Appendix 2’ but, as they only account for a small fraction of the total abundance in diverse communities, the specific choice is not important. As a function of <inline-formula><mml:math id="inf284"><mml:mi>ρ</mml:mi></mml:math></inline-formula> (with <inline-formula><mml:math id="inf285"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>), the rate of diversification is nonmonotonic being fastest for <inline-formula><mml:math id="inf286"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>≈</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula>, and only weakly varying for smaller <inline-formula><mml:math id="inf287"><mml:mi>ρ</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). As <inline-formula><mml:math id="inf288"><mml:mi>ρ</mml:mi></mml:math></inline-formula> nears 1, the mutant and parent are more similar, and it becomes harder for them to coexist, since any difference between them is likely to result in a systematic change in their relative abundance, eventually driving one of them to extinction (see ‘Appendix 9’). Since <inline-formula><mml:math id="inf289"><mml:mi>L</mml:mi></mml:math></inline-formula> can only increase when both the mutant and parent coexist, increasing <inline-formula><mml:math id="inf290"><mml:mi>ρ</mml:mi></mml:math></inline-formula> slows the rate of diversification but <inline-formula><mml:math id="inf291"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> still increases linearly.</p><p>This observation implies that, for a large range of <inline-formula><mml:math id="inf292"><mml:mi>ρ</mml:mi></mml:math></inline-formula>, despite not enforcing any precise constraints or perfect tradeoffs, strains that would outcompete all extant members of the community are too rare to emerge and reduce diversity. Therefore, we conjecture that a continually diversifying phase exists even for <inline-formula><mml:math id="inf293"><mml:mi>ρ</mml:mi></mml:math></inline-formula> arbitrarily close to 1.</p></sec><sec id="s3-3"><title>Evolutionary dynamics with general fitness differences</title><p>So far we have observed that when mutants or invaders differ only by their interactions with each other, there is robust and rapid diversification, provided that the initial diversity in the STC phase is high enough. Now we include general fitness differences <inline-formula><mml:math id="inf294"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> between strains and show how these affect the evolutionary dynamics.</p><sec id="s3-3-1"><title>Exponential distribution of <inline-formula><mml:math id="inf295"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></title><p>We first analyze the simplest case: exponentially distributed selective differences with scale <inline-formula><mml:math id="inf296"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula> and probability density <inline-formula><mml:math id="inf297"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi mathvariant="normal">Σ</mml:mi></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> where <inline-formula><mml:math id="inf298"><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the Heaviside step function. We consider the evolutionary dynamics in the case of unrelated invaders. As a community evolves, the distribution of the <inline-formula><mml:math id="inf299"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> of the community will change, and we are particularly interested in the dynamics of the <italic>population-weighted mean</italic> <inline-formula><mml:math id="inf300"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>The width of the distribution of <inline-formula><mml:math id="inf301"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, here <inline-formula><mml:math id="inf302"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula>, plays a controlling role. If one strain has a substantially higher growth rate than all other strains, it will outcompete them, driving many extinct. Thus a broad distribution of <inline-formula><mml:math id="inf303"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is likely inconsistent with a diverse community. We therefore focus on narrow distributions: that is small <inline-formula><mml:math id="inf304"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula>. The typical magnitude of the drive of a strain is of order <inline-formula><mml:math id="inf305"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>; therefore, when <inline-formula><mml:math id="inf306"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula> is much smaller than this, it will not matter much. On the other hand, if <inline-formula><mml:math id="inf307"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula> were to be much larger than <inline-formula><mml:math id="inf308"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>, the differences in the <inline-formula><mml:math id="inf309"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> would dominate over the drives and only the strains with the highest and quite similar <inline-formula><mml:math id="inf310"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> would survive. Thus <inline-formula><mml:math id="inf311"><mml:mrow><mml:mi>L</mml:mi><mml:mo>≫</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> seems inconsistent. Even for the initial community with <inline-formula><mml:math id="inf312"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> strains, we expect that <inline-formula><mml:math id="inf313"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> cannot be larger than order <inline-formula><mml:math id="inf314"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> (although it can be much smaller if <inline-formula><mml:math id="inf315"><mml:mrow><mml:mi>K</mml:mi><mml:mo>≪</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>). Indeed, in ‘Appendix 6’ we show that <inline-formula><mml:math id="inf316"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula> sets the initial persistent community size, <inline-formula><mml:math id="inf317"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, in a particular limit of the model where <inline-formula><mml:math id="inf318"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>A natural conjecture is that for small <inline-formula><mml:math id="inf319"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula> with an exponential distribution, steady diversification can occur until the breadth of the <inline-formula><mml:math id="inf320"><mml:mi>s</mml:mi></mml:math></inline-formula> distribution becomes important — when <inline-formula><mml:math id="inf321"><mml:mrow><mml:mi>L</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> — and after that <inline-formula><mml:math id="inf322"><mml:mi>L</mml:mi></mml:math></inline-formula> will saturate, as seen in <xref ref-type="fig" rid="fig3">Figure 3</xref>. Thereafter, <inline-formula><mml:math id="inf323"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> will grow and invasions of unrelated strains are less and less likely to be successful — in ‘Diversification rate with a distribution of general fitnesses’ we show that the number of successful invasions <inline-formula><mml:math id="inf324"><mml:mi>Z</mml:mi></mml:math></inline-formula>, increases as <inline-formula><mml:math id="inf325"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. However, successful invasions will on average drive exactly one other strain extinct. <xref ref-type="fig" rid="fig3">Figure 3</xref> illustrates this behavior, including the large initial drop from <inline-formula><mml:math id="inf326"><mml:mi>K</mml:mi></mml:math></inline-formula> to <inline-formula><mml:math id="inf327"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> when <inline-formula><mml:math id="inf328"><mml:mrow><mml:mi>K</mml:mi><mml:mo>≫</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, the <inline-formula><mml:math id="inf329"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula>-dependence of the steady-state <inline-formula><mml:math id="inf330"><mml:mi>L</mml:mi></mml:math></inline-formula>, and the linear increase of <inline-formula><mml:math id="inf331"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> with number of successful invasions.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Effects of exponentially distributed general fitnesses, <inline-formula><mml:math id="inf332"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> on community evolution.</title><p>Here <inline-formula><mml:math id="inf333"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>250</mml:mn></mml:mrow></mml:math></inline-formula> initial strains and <inline-formula><mml:math id="inf334"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, with various <inline-formula><mml:math id="inf335"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula>. (<bold>A</bold>) Community size, <inline-formula><mml:math id="inf336"><mml:mi>L</mml:mi></mml:math></inline-formula>, as a function of evolutionary time <inline-formula><mml:math id="inf337"><mml:mi>T</mml:mi></mml:math></inline-formula> (the number of attempted invasions) approaching an evolutionary steady state with <inline-formula><mml:math id="inf338"><mml:mrow><mml:mi>L</mml:mi><mml:mo>∼</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> at long times. The dashed lines indicate <inline-formula><mml:math id="inf339"><mml:mrow><mml:mn>0.7</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, which captures the predicted scaling between the steady-state <inline-formula><mml:math id="inf340"><mml:mi>L</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf341"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula>. Data are averaged over 50 runs, conditional on not crashing, with the shaded region showing the standard error. Only single runs are shown for <inline-formula><mml:math id="inf342"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> and 0.02, the former caused crashing and the latter saturation beyond the range of the simulations. For a narrow distribution of the general fitnesses (<inline-formula><mml:math id="inf343"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>≪</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>), <inline-formula><mml:math id="inf344"><mml:mi>L</mml:mi></mml:math></inline-formula> increases linearly before saturating. For larger <inline-formula><mml:math id="inf345"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula> with many initial strains, immediate extinctions drive <inline-formula><mml:math id="inf346"><mml:mi>L</mml:mi></mml:math></inline-formula> down to <inline-formula><mml:math id="inf347"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> (‘Appendix 6’). (<bold>B</bold>) The average fitness of the community, <inline-formula><mml:math id="inf348"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, grows linearly in the number of <italic>successful</italic> invasions, <inline-formula><mml:math id="inf349"><mml:mi>Z</mml:mi></mml:math></inline-formula>, with <inline-formula><mml:math id="inf350"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow><mml:mo>∼</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>: the dashed lines have slope <inline-formula><mml:math id="inf351"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula>, indicating this expected scaling relationship. The inset shows the rate of successful invasions slowing down with attempted invasions, as it gets harder to draw a general fitness that is sufficiently far into the tail of <inline-formula><mml:math id="inf352"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82734-fig3-v2.tif"/></fig></sec><sec id="s3-3-2"><title>More general distributions of <inline-formula><mml:math id="inf353"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></title><p>Building on an understanding of the case of exponentially distributed <inline-formula><mml:math id="inf354"><mml:mi>s</mml:mi></mml:math></inline-formula>, we consider a more general family of distributions, motivated by the expectation that the tail of the <inline-formula><mml:math id="inf355"><mml:mi>s</mml:mi></mml:math></inline-formula> distribution is particularly important for evolution:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>ψ</mml:mi></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mi>s</mml:mi><mml:mi mathvariant="normal">Σ</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Anomalously small <inline-formula><mml:math id="inf356"><mml:mi>s</mml:mi></mml:math></inline-formula> strains are very unlikely to successfully invade, so the sharp cutoff at the lower end does not matter. Although we consider only positive <inline-formula><mml:math id="inf357"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, all <inline-formula><mml:math id="inf358"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> can be shifted by a constant without affecting the dynamics because this constant gets absorbed into <inline-formula><mml:math id="inf359"><mml:mrow><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>As we will analyze in ‘Diversification rate with a distribution of general fitnesses’, the evolution of diversity is seen to depend crucially on <inline-formula><mml:math id="inf360"><mml:mi>ψ</mml:mi></mml:math></inline-formula>. If the tail of the <inline-formula><mml:math id="inf361"><mml:mi>s</mml:mi></mml:math></inline-formula> distribution falls off faster than a simple exponential, <inline-formula><mml:math id="inf362"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, the community continually diversifies, albeit more and more slowly with <inline-formula><mml:math id="inf363"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> increasing only as a power of <inline-formula><mml:math id="inf364"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Concomitantly, the mean <inline-formula><mml:math id="inf365"><mml:mi>s</mml:mi></mml:math></inline-formula> of the community, <inline-formula><mml:math id="inf366"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>, gradually increases. But if the <inline-formula><mml:math id="inf367"><mml:mi>s</mml:mi></mml:math></inline-formula> distribution decays slower than a simple exponential, <inline-formula><mml:math id="inf368"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, the diversity decreases (after an initial increase if <inline-formula><mml:math id="inf369"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula> is sufficiently small) and eventually crashes. In the marginal case of a simple exponential tail, <inline-formula><mml:math id="inf370"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, as seen above, the diversity saturates and fluctuates around a steady state value while the mean <inline-formula><mml:math id="inf371"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> increases linearly with the number of successful invasions. Therefore we conclude that for the evolutionary process in our models to <italic>continually</italic> generate higher diversity, the distribution of general fitnesses must decay sufficiently rapidly. Such rapid decrease of the distribution of available beneficial mutants with ongoing evolution roughly corresponds to “diminishing-returns epistasis”.</p></sec><sec id="s3-3-3"><title>Mutants with correlated general fitnesses</title><p>What happens if — as one would expect — the invaders are mutants with general fitnesses correlated with their parents? With such mutants, it is possible for the evolution to proceed with less slowing down than for independent invaders. Indeed, with an exponential distribution of the <inline-formula><mml:math id="inf372"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (<inline-formula><mml:math id="inf373"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) analysis suggests that evolution proceeds at a constant rate, with both <inline-formula><mml:math id="inf374"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf375"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> growing linearly as in the absence of general fitness differences, but <inline-formula><mml:math id="inf376"><mml:mi>L</mml:mi></mml:math></inline-formula> still saturating. In ‘Appendix 7’ simulation results are shown for an exponential <inline-formula><mml:math id="inf377"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> with correlations in both interactions and general fitnesses. The saturating value of <inline-formula><mml:math id="inf378"><mml:mi>L</mml:mi></mml:math></inline-formula> is quite similar in both the correlated and uncorrelated cases. However, for correlated mutants <inline-formula><mml:math id="inf379"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> pushes rapidly into the exponential tail — and surely toward the breakdown of the assumption of the existence of such large <inline-formula><mml:math id="inf380"><mml:mi>s</mml:mi></mml:math></inline-formula> mutations.</p><p>For <inline-formula><mml:math id="inf381"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> that decays faster than exponentially, <inline-formula><mml:math id="inf382"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, the behavior is more complicated. However, as discussed in ‘Appendix 7’, even with correlated mutants, evolution will eventually become very slow, as for uncorrelated invaders. With mutants instead of unrelated invaders, this is a direct example of the effects of diminishing-returns epistasis.</p></sec></sec></sec><sec id="s4"><title>Analysis</title><p>In this section we develop an approximate analytical theory of the evolutionary dynamics and provide heuristic understanding for most of the observed phenomena described above. The underlying basis is the dynamical mean field theory (DMFT) of the STC phase developed in PAF. This takes advantage of the large number of strains and the large number of islands in order to simplify the descriptions and analyses of the behaviors.</p><p>The natural quantities that characterize strains in the DMFT are their biases, <inline-formula><mml:math id="inf383"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, and how these set their mean abundances, <inline-formula><mml:math id="inf384"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>. For a large randomly assembled or evolved community the mean abundances will be a function of the biases: <inline-formula><mml:math id="inf385"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, with the function <inline-formula><mml:math id="inf386"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> depending on the parameters, evolutionary history, and feedback from other strains. As shown in PAF, <inline-formula><mml:math id="inf387"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is linear for large argument and decays as <inline-formula><mml:math id="inf388"><mml:mi>ξ</mml:mi></mml:math></inline-formula> becomes negative, vanishing at <inline-formula><mml:math id="inf389"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>The relation between <inline-formula><mml:math id="inf390"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf391"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and the total average force on strain <inline-formula><mml:math id="inf392"><mml:mi>i</mml:mi></mml:math></inline-formula> — from both direct effects and feedback — enables one to estimate the bias from the simulations (‘Appendix 2’). Armed with the DMFT description, we can understand how the biases of extant strains change over the course of invasions. We do this in detail for the simplest case — invasions of unrelated strains without general fitness differences — and show that the evolution causes <inline-formula><mml:math id="inf393"><mml:mi>L</mml:mi></mml:math></inline-formula> to change linearly with the number of invasions — decreasing or increasing depending on the parameters. A simple approximation to the evolution of the biases enables semi-quantitative results. Of particular importance is the result that in evolving communities, the density of biases vanishes linearly as <inline-formula><mml:math id="inf394"><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. A corollary of this, as discussed in ‘Distribution of biases and number of extinctions’, is that the number of extinctions per successful invasion is roughly exponentially distributed. We then analyze the effects of general fitness differences, using our understanding of the exponential <inline-formula><mml:math id="inf395"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> to generalize to other shapes of the tail of <inline-formula><mml:math id="inf396"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, parametrized by <inline-formula><mml:math id="inf397"><mml:mi>ψ</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref>), and showing how the steepness of the tail affects the rate at which <inline-formula><mml:math id="inf398"><mml:mi>L</mml:mi></mml:math></inline-formula> increases or decreases.</p><sec id="s4-1"><title>Dynamical mean field theory</title><p>The DMFT approximation, which is exact in the limit of a large number of strains with random interactions between them, replaces the full statistical dynamics by the stochastic effects of the others on one chosen strain, with the statistical properties then determined self-consistently from the properties of the distributions over the strains. This approach was first used in the physics of disordered systems such as spin glasses (<xref ref-type="bibr" rid="bib45">Sompolinsky and Zippelius, 1982</xref>), but has been applied to ecological dynamics in a number of subsequent works (<xref ref-type="bibr" rid="bib13">Diederich and Opper, 1989</xref>; <xref ref-type="bibr" rid="bib32">Opper and Diederich, 1992</xref>; <xref ref-type="bibr" rid="bib20">Galla, 2006</xref>; <xref ref-type="bibr" rid="bib41">Roy et al., 2019</xref>; <xref ref-type="bibr" rid="bib35">Rieger, 1989</xref>; <xref ref-type="bibr" rid="bib55">Yoshino et al., 2008</xref>).</p><p>When strain <inline-formula><mml:math id="inf399"><mml:mi>i</mml:mi></mml:math></inline-formula> has very low abundance, its effects on the others are very small and the forces of the others on it, <inline-formula><mml:math id="inf400"><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, are comprised of roughly independent random variables and thus act like gaussian noise with correlations <inline-formula><mml:math id="inf401"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. However, when it rises to substantial abundance, it will weakly affect the other strains. Because of the correlation <inline-formula><mml:math id="inf402"><mml:mi>γ</mml:mi></mml:math></inline-formula> between <inline-formula><mml:math id="inf403"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf404"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, these feedback terms add coherently, resulting in a contribution to growth rate of <inline-formula><mml:math id="inf405"><mml:mi>i</mml:mi></mml:math></inline-formula> of form <inline-formula><mml:math id="inf406"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>γ</mml:mi><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, with <inline-formula><mml:math id="inf407"><mml:mi>R</mml:mi></mml:math></inline-formula> a response function determined by feedback from the total impact on the community of the strain’s own past history (see ‘Appendix 5’). The DMFT allows one to recast the generalized Lotka Volterra equations as an effective single-strain problem, with self consistency conditions on the bias correlations and response function.</p><p>With the dynamical mean field understanding of an assembled STC phase in hand, we can proceed to describe the evolutionary process in terms of the distributions of properties of the extant and newly invading strains — in particular their biases and consequent mean abundances. The distribution of biases is perturbed by the introduction of new strains and this can push some of the extant biases below <inline-formula><mml:math id="inf408"><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula>, which itself depends on the bias distribution as modified by prior evolution, and on the number of extant strains, <inline-formula><mml:math id="inf409"><mml:mi>L</mml:mi></mml:math></inline-formula>. It is convenient to define an effective community size <inline-formula><mml:math id="inf410"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> which controls the variances of the mean-drive part of the bias; <inline-formula><mml:math id="inf411"><mml:mi mathvariant="script">L</mml:mi></mml:math></inline-formula> scales with the actual <inline-formula><mml:math id="inf412"><mml:mi>L</mml:mi></mml:math></inline-formula> but discounts strains that are close to extinction.</p></sec><sec id="s4-2"><title>Evolution without general fitness differences</title><p>We first analyze invasion of unrelated strains without general fitness differences. The bias of an attempted invader, labelled <inline-formula><mml:math id="inf413"><mml:mi>A</mml:mi></mml:math></inline-formula>, is given by <inline-formula><mml:math id="inf414"><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>, in terms of its interactions, <inline-formula><mml:math id="inf415"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> with the extant strains: for unrelated invaders, this is gaussian distributed with mean <inline-formula><mml:math id="inf416"><mml:mrow><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and standard deviation of <inline-formula><mml:math id="inf417"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi mathvariant="script">L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula> <italic>independent</italic> of correlations among the extant strains, though correlations in the existing community will affect the <inline-formula><mml:math id="inf418"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and hence <inline-formula><mml:math id="inf419"><mml:mi mathvariant="script">L</mml:mi></mml:math></inline-formula>.</p><p>Strain <inline-formula><mml:math id="inf420"><mml:mi>A</mml:mi></mml:math></inline-formula> can successfully invade the community and persist if <inline-formula><mml:math id="inf421"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. The probability of successful invasion is thus <inline-formula><mml:math id="inf422"><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msqrt><mml:mi mathvariant="script">L</mml:mi></mml:msqrt></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="inf423"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula> the standard normal cumulative distribution function. In the initial assembled community, <inline-formula><mml:math id="inf424"><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msqrt><mml:mi mathvariant="script">L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf425"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msqrt><mml:mi mathvariant="script">L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula> are independent of <inline-formula><mml:math id="inf426"><mml:mi mathvariant="script">L</mml:mi></mml:math></inline-formula>. We make the <italic>Ansatz</italic> that after a long period of evolution the distribution of extant biases, scaled by <inline-formula><mml:math id="inf427"><mml:msqrt><mml:mi mathvariant="script">L</mml:mi></mml:msqrt></mml:math></inline-formula>, reaches a steady state — albeit a different state than the initial assembled community. Then the probability of successful invasion will become independent of <inline-formula><mml:math id="inf428"><mml:mi>L</mml:mi></mml:math></inline-formula> for large <inline-formula><mml:math id="inf429"><mml:mi>L</mml:mi></mml:math></inline-formula>. If the mean number of extinctions per successful invasion also reaches a steady state value which is less than unity, this explains the steady linear growth of <inline-formula><mml:math id="inf430"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> seen in <xref ref-type="fig" rid="fig2">Figure 2</xref>.</p><p>With the one-by-one introduction of new strains, the bias of each extant strain undergoes some kind of random walk, and the strain goes extinct if its bias ventures below <inline-formula><mml:math id="inf431"><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula>. In <xref ref-type="fig" rid="fig4">Figure 4A</xref>, we show the evolutionary trajectories of the biases of 5 individual strains that started from similar initial values in a simulation where the community diversified from 50 to 500 strains. Extinctions are caused by <inline-formula><mml:math id="inf432"><mml:mi>ξ</mml:mi></mml:math></inline-formula> being pushed below <inline-formula><mml:math id="inf433"><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula> by an invading strain. For finite <inline-formula><mml:math id="inf434"><mml:mi>L</mml:mi></mml:math></inline-formula>, the sharpness of <inline-formula><mml:math id="inf435"><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula> will be smeared by an amount of order <inline-formula><mml:math id="inf436"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> due to variability in the dynamic noise from strain to strain, which we have not explored.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Trajectories of biases of persistent strains (normalized by <inline-formula><mml:math id="inf437"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi mathvariant="script">L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>) under the influence of successive unrelated invaders with <inline-formula><mml:math id="inf438"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</title><p>(<bold>A</bold>) Bias trajectories of individual strains that invaded and persisted for a number of epochs. Extinctions (shown by a vertical line), occur when the bias goes below the critical bias, seen here to be around <inline-formula><mml:math id="inf439"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>2.5</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi mathvariant="script">L</mml:mi></mml:msqrt></mml:mrow></mml:mrow></mml:math></inline-formula>. The horizontal dashed line shows <inline-formula><mml:math id="inf440"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msqrt><mml:mi mathvariant="script">L</mml:mi></mml:msqrt></mml:mrow></mml:mrow></mml:math></inline-formula>. (<bold>B</bold>) Bias trajectories for all strains binned into groups by their starting value and averaged within bins for as long as the strains persist. Without conditioning on success, the biases of new invaders have mean <inline-formula><mml:math id="inf441"><mml:mrow><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and standard deviation <inline-formula><mml:math id="inf442"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi mathvariant="script">L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>. However, conditioned on survival, the biases converge to and fluctuate around a larger value. Data in (<bold>A</bold>) are from a single simulation where the community diversifies from 50 to 500 strains, and in (<bold>B</bold>) data are pooled from 10 replicates of the same process.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82734-fig4-v2.tif"/></fig><p>To numerically investigate any systematic components of the random walk of biases, we average over a large number of strains, binning them according to their initial values normalized by <inline-formula><mml:math id="inf443"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi mathvariant="script">L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>. We observe a strong tendency of anomalously positive and negative biases to regress toward an intermediate value. In this plot, as evolution proceeds, the asymptotic average bias conditioned on survival is larger than <inline-formula><mml:math id="inf444"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msqrt><mml:mi mathvariant="script">L</mml:mi></mml:msqrt></mml:mrow></mml:mrow></mml:math></inline-formula>. (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). This is likely due to conditioning on survival of the strains: those that persist for many epochs tend to have larger-than-average (but still negative) bias.</p><p>In ‘Appendix 8’, we carry out an analysis of the bias dynamics by approximating these by a Markov process in which the dynamics of the biases depend only on their current values. This analysis shows that when there is a successful invasion, each strain’s drive undergoes both a systematic and random change, consistent with our numerical results.</p><p>It is convenient to work with the mean drives, <inline-formula><mml:math id="inf445"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> (when <inline-formula><mml:math id="inf446"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, this is just <inline-formula><mml:math id="inf447"><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Υ</mml:mi></mml:mrow></mml:math></inline-formula>). Both the systematic and the random changes in the drive are proportional to the average abundance of the invading strain, which is of order <inline-formula><mml:math id="inf448"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>. The stochastic change is <inline-formula><mml:math id="inf449"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:mo>±</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, but the systematic change in the drive is smaller and depends on its current value: <inline-formula><mml:math id="inf450"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>δ</mml:mi><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>∼</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. In the Markovian approximation, there is a simple Langevin equation for the change of the drive of a strain due to invasions:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>B</mml:mi><mml:mfrac><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msqrt><mml:mn>2</mml:mn><mml:mi>D</mml:mi></mml:msqrt><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>with <inline-formula><mml:math id="inf451"><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> approximately gaussian with mean zero and unit variance — an approximation that should be good if one coarse-grains over a substantial range of <inline-formula><mml:math id="inf452"><mml:mi>T</mml:mi></mml:math></inline-formula> (but with range much smaller than <inline-formula><mml:math id="inf453"><mml:mi>L</mml:mi></mml:math></inline-formula>). From our analysis in ‘Appendix 8’, we see that <inline-formula><mml:math id="inf454"><mml:mi>B</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf455"><mml:mi>D</mml:mi></mml:math></inline-formula> are order-unity coefficients which respectively characterize the average and mean-squared response of the bias to the invasion of a new strain. Both are proportional to <inline-formula><mml:math id="inf456"><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> times the <italic>fragility</italic>, <inline-formula><mml:math id="inf457"><mml:mi mathvariant="normal">Ξ</mml:mi></mml:math></inline-formula>, of the extant community which is given by <inline-formula><mml:math id="inf458"><mml:mrow><mml:mi mathvariant="normal">Ξ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> in terms of the individual susceptibilities of strains to changes in their biases, <inline-formula><mml:math id="inf459"><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. This fragility characterizes the mean-square response of the system to a random perturbation applied simultaneously on all the strains — precisely the effect of a successful invasion. The Langevin equation for the drives must be supplemented by a boundary condition that if <inline-formula><mml:math id="inf460"><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="normal">Υ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> goes below <inline-formula><mml:math id="inf461"><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula>, the strain disappears.</p><p>Analysis of the Langevin equation, which can be converted into a Fokker Planck equation for the distribution of the drives (‘Appendix 8’), shows that there is an eigenvalue-like condition which determines whether the diversification rate of the community is negative or positive, and that the coefficients <inline-formula><mml:math id="inf462"><mml:mi>B</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf463"><mml:mi>D</mml:mi></mml:math></inline-formula> play a role in determining whether the community diversifies or not. This is consistent with our numerical results, which show that certain parameter regimes allow diversification and other regimes do not — even in the absence of general fitness differerences.</p></sec><sec id="s4-3"><title>Distribution of biases and number of extinctions</title><p>The approximate model of the evolution of the biases makes predictions about the shape of the bias distribution as a function of attempted invasions. Before the onset of evolution, the distribution of biases is a truncated gaussian, with a lower cutoff set by <inline-formula><mml:math id="inf464"><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula>. However as the distribution evolves according to <xref ref-type="disp-formula" rid="equ35">Equation A8.3</xref> with the absorbing boundary condition at the critical bias, it smooths out near this cutoff, going linearly to 0 as <inline-formula><mml:math id="inf465"><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>→</mml:mo><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula> (or, equivalently, as <inline-formula><mml:math id="inf466"><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>).</p><p>Simulations confirm the expectation that the typical bias scales as <inline-formula><mml:math id="inf467"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula> over one order of magnitude in <inline-formula><mml:math id="inf468"><mml:mi>L</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="app3fig4">Appendix 3—figure 4</xref>). As predicted, one observes a smoothing out of the bias distribution toward <inline-formula><mml:math id="inf469"><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula> when comparing evolved and assembled communities of the same <inline-formula><mml:math id="inf470"><mml:mi>L</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig5">Figure 5B</xref>), and our analysis allows us to obtain the theory curve for the evolved ecosystem in <xref ref-type="fig" rid="fig5">Figure 5B</xref> as the solution of the approximate boundary value problem. However, the critical bias is sufficiently negative that the number of strains affected by the differences between the initial and evolved communities is small and the distinctions hard to see numerically.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Distributions of mean abundances and biases before and after evolution with <inline-formula><mml:math id="inf471"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf472"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</title><p>(<bold>A</bold>) Mean abundances: all these communities have <inline-formula><mml:math id="inf473"><mml:mrow><mml:mi>L</mml:mi><mml:mo>≅</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math></inline-formula>, but evolved communities have diversified from <inline-formula><mml:math id="inf474"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> initial strains so that they lose memory of their initial assembly conditions, while assembled communities had <inline-formula><mml:math id="inf475"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>650</mml:mn></mml:mrow></mml:math></inline-formula> strains with <inline-formula><mml:math id="inf476"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>≅</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math></inline-formula> surviving after the initial epoch. Data are pooled across 10 simulation runs of each. Though the distributions are mostly similar, there is a marked depletion in both rare and abundant strains in the evolved community. (<bold>B</bold>) The low end of the bias distribution changes from a truncated gaussian for the initial unevolved community (blue), to a linearly vanishing function (orange) because of evolution-driven extinctions of close-to-marginal strains. Bars show histograms from simulation, and solid lines show theory as detailed in ‘Appendix 8’. Inset shows the normalized bias by rank order, illustrating the smoothing of the lower end of the distribution caused by the evolution.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82734-fig5-v2.tif"/></fig><p>However, the density of biases near <inline-formula><mml:math id="inf477"><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula> determines the response of the community to evolutionary perturbations, since these low-bias strains are the ones most susceptible to extinction. In particular, the predicted linearly vanishing density of biases determines the distribution of the number, <inline-formula><mml:math id="inf478"><mml:mi mathvariant="normal">ℓ</mml:mi></mml:math></inline-formula>, of extinctions per successful invasion (<xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1B</xref>). To estimate this distribution — particular the probability that <inline-formula><mml:math id="inf479"><mml:mi mathvariant="normal">ℓ</mml:mi></mml:math></inline-formula> is large — we use the fact that an invader will perturb the extant strains' biases by a random amount of order <inline-formula><mml:math id="inf480"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> and proportional to the mean abundance of the invader. The positive tail of the invader’s mean abundance, <inline-formula><mml:math id="inf481"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula>, is gaussian, since for positive <inline-formula><mml:math id="inf482"><mml:msub><mml:mi>ξ</mml:mi><mml:mtext>inv</mml:mtext></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf483"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mtext>inv</mml:mtext></mml:msub><mml:mo>∼</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mtext>inv</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> and the invader’s bias <inline-formula><mml:math id="inf484"><mml:msub><mml:mi>ξ</mml:mi><mml:mtext>inv</mml:mtext></mml:msub></mml:math></inline-formula> is itself gaussian distributed. The number of strains whose biases are within <inline-formula><mml:math id="inf485"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula> of <inline-formula><mml:math id="inf486"><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula> is proportional to <inline-formula><mml:math id="inf487"><mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>, because the distribution of strains' biases vanishes linearly at <inline-formula><mml:math id="inf488"><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula>. Thus for fixed <inline-formula><mml:math id="inf489"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula>, the number of strains that are driven extinct is Poisson distributed with mean proportional to <inline-formula><mml:math id="inf490"><mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>: this is of order one for large <inline-formula><mml:math id="inf491"><mml:mi>L</mml:mi></mml:math></inline-formula> as expected. That the tail of the distribution of <inline-formula><mml:math id="inf492"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula> is gaussian implies <inline-formula><mml:math id="inf493"><mml:msubsup><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> is approximately exponentially distributed in its tail. Integrating the Poisson distribution over this yields, for large <inline-formula><mml:math id="inf494"><mml:mi mathvariant="normal">ℓ</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf495"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mi>ℓ</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msqrt><mml:mi>ℓ</mml:mi></mml:msqrt></mml:mrow></mml:mstyle></mml:math></inline-formula> (with <inline-formula><mml:math id="inf496"><mml:mi>β</mml:mi></mml:math></inline-formula> an order-unity coefficient) which is close to exponential as observed in <xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1B</xref>.</p><p>A similar analysis for the initial randomly-assembled community shows that for fixed <inline-formula><mml:math id="inf497"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula>, the mean number of extinctions triggered by the first successful invasion is of order <inline-formula><mml:math id="inf498"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>L</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mn>3</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>A</mml:mi></mml:msub></mml:mrow><mml:mo>∼</mml:mo><mml:msqrt><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msqrt></mml:mrow></mml:math></inline-formula>; much larger than after evolution has proceeded for a while. As the Poisson with this mean has a narrow distribution, the probability of an anomalously large number of extinctions will be dominated by the gaussian tail of the distribution of <inline-formula><mml:math id="inf499"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula> and hence itself be roughly gaussian, though unless the initial <inline-formula><mml:math id="inf500"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is huge, the tail is unlikely to still be in the asymptotic regime. The transient caused by a set of early invasions will likely cause a total of order <inline-formula><mml:math id="inf501"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> strains — with a relatively small coefficient — to go extinct before <inline-formula><mml:math id="inf502"><mml:mi>L</mml:mi></mml:math></inline-formula> starts steadily increasing, and this will occur over of order <inline-formula><mml:math id="inf503"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> invasions. For <inline-formula><mml:math id="inf504"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> this effect appears to be very small — the critical bias is quite negative — but for smaller or larger <inline-formula><mml:math id="inf505"><mml:mi>γ</mml:mi></mml:math></inline-formula> the effects are noticeable (<xref ref-type="fig" rid="fig2">Figure 2</xref>).</p><p>The distribution of mean abundances, <inline-formula><mml:math id="inf506"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, is related to that of the biases via the function <inline-formula><mml:math id="inf507"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>: therefore, we expect this also to evolve as the community diversifies. In particular, there should be a reduction in the number of strains at low mean abundance, since these correspond to those with close-to-marginal bias. In <xref ref-type="fig" rid="fig5">Figure 5A</xref>, we see that the mean abundances in an evolved community are more narrowly distributed than in an assembled community, with both fewer highly abundant and fewer rare strains. This is consistent with our picture of the bias distribution being smoothed out toward <inline-formula><mml:math id="inf508"><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula> due to invasion-triggered extinctions, resulting in the depletion of low-abundance strains. The depletion of abundant strains is likely due to the kill-the-winner dynamics which rewards invading strains that push the most abundant extant strains down.</p><p>Although the mean abundances are not broadly distributed on a log scale, the <italic>snapshot abundance distributions</italic> are, as seen in <xref ref-type="fig" rid="fig1">Figure 1</xref>. Note that most widely-used measures of diversity are not really informative for these kinds of logarithmically broad distributions. For example, the Shannon entropy would weight mostly the highly abundant strains, while the “species richness” would be highly sensitive to the lower cutoff in observable abundance.</p></sec><sec id="s4-4"><title>Diversification rate with a distribution of general fitnesses</title><p>Armed with understanding of the scaling of the bias and mean drives with <inline-formula><mml:math id="inf509"><mml:mi>L</mml:mi></mml:math></inline-formula>, we can build upon the analysis of the simple exponential distribution of general fitness (‘Evolutionary dynamics with general fitness differences’) to analyze the evolution when <inline-formula><mml:math id="inf510"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> decays faster or slower than exponentially. A heuristic understanding of how the dynamics of <inline-formula><mml:math id="inf511"><mml:mi>L</mml:mi></mml:math></inline-formula> depend on <inline-formula><mml:math id="inf512"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> follows from the fact that without general fitness differences, the biases are distributed with characteristic scale <inline-formula><mml:math id="inf513"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>. As <inline-formula><mml:math id="inf514"><mml:mi>L</mml:mi></mml:math></inline-formula> increases, the distribution of these biases gets narrower, and the system becomes progressively more “neutral&quot; with overall differences in strain biases becoming smaller. The contribution of the general fitnesses is to add a random extra piece to each bias, broadening the distribution of extant <inline-formula><mml:math id="inf515"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. In the limit of many invasions, the width of the drive distribution becomes comparable to the width of the distribution of the extant <inline-formula><mml:math id="inf516"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and cannot decrease further. Thereafter, the shape of <inline-formula><mml:math id="inf517"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> determines both the width of the bias distribution, and the number of coexisting strains.</p><p>If <inline-formula><mml:math id="inf518"><mml:mrow><mml:mi>L</mml:mi><mml:mo>≪</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> initially, the <inline-formula><mml:math id="inf519"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> play little role and the population-weighted mean fitness, <inline-formula><mml:math id="inf520"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>, only increases gradually. But once <inline-formula><mml:math id="inf521"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> is a few times <inline-formula><mml:math id="inf522"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula>, the tail of <inline-formula><mml:math id="inf523"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> will determine the rate of increase of <inline-formula><mml:math id="inf524"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>. Henceforth, <inline-formula><mml:math id="inf525"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> will grow steadily with subsequent successful invasions, since strains with <inline-formula><mml:math id="inf526"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≪</mml:mo><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> are very unlikely to persist, and strains with <inline-formula><mml:math id="inf527"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≫</mml:mo><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> are unlikely to have yet occurred. Thus, the range of <italic>extant</italic> <inline-formula><mml:math id="inf528"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> will become much narrower than <inline-formula><mml:math id="inf529"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula>. This implies that the distribution over the currently relevant range can be approximated by an exponential distribution <inline-formula><mml:math id="inf530"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> with the effective width of the extant <inline-formula><mml:math id="inf531"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> distribution given by<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the second equality is for the specific models we study (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref>). Provided evolution has proceeded long enough that no strains with <inline-formula><mml:math id="inf532"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> smaller than the original scale <inline-formula><mml:math id="inf533"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula> survive, <inline-formula><mml:math id="inf534"><mml:mover accent="true"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> will vary slowly for a range of evolutionary time and this sets the scale for variations of <inline-formula><mml:math id="inf535"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> of <italic>both</italic> extant strains and of potentially-successful invaders. This suggests that understanding the general behavior at long evolutionary times can be built on understanding the case of the simple exponential distribution (<inline-formula><mml:math id="inf536"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> for which <inline-formula><mml:math id="inf537"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:math></inline-formula>). The main difference is that now the community size will change as <inline-formula><mml:math id="inf538"><mml:mrow><mml:mi>L</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="inf539"><mml:mover accent="true"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> changing as <inline-formula><mml:math id="inf540"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> increases: this will govern how <inline-formula><mml:math id="inf541"><mml:mi>L</mml:mi></mml:math></inline-formula> changes as invasions are attempted and occasionally occur.</p><p>In the slow evolution regime at long times, successful invaders must have <inline-formula><mml:math id="inf542"><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula> comparable to <inline-formula><mml:math id="inf543"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>. A simple argument gives an upper bound on how fast <inline-formula><mml:math id="inf544"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> can increase with <inline-formula><mml:math id="inf545"><mml:mi>T</mml:mi></mml:math></inline-formula>. In order to get a mean of <inline-formula><mml:math id="inf546"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> in a community of <inline-formula><mml:math id="inf547"><mml:mi>L</mml:mi></mml:math></inline-formula> strains, at least <inline-formula><mml:math id="inf548"><mml:mi>L</mml:mi></mml:math></inline-formula> attempted invaders must have occurred with <inline-formula><mml:math id="inf549"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>≳</mml:mo><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>. This requires a number of invasion attempts, <inline-formula><mml:math id="inf550"><mml:mi>T</mml:mi></mml:math></inline-formula>, such that <inline-formula><mml:math id="inf551"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>s</mml:mi><mml:mo>≥</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. But if <inline-formula><mml:math id="inf552"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> were substantially smaller than this upper bound, many strains would have already occurred with <inline-formula><mml:math id="inf553"><mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>≫</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and these would persist for a long time, driving <inline-formula><mml:math id="inf554"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> up. We thus make the <italic>Ansatz</italic>, justified by the analysis and simulation data of ‘Appendix 6’ and <xref ref-type="fig" rid="fig6">Figure 6</xref>, that <inline-formula><mml:math id="inf555"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> grows with <inline-formula><mml:math id="inf556"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at a rate asymptotically given by this upper bound. For the distributions of interest we then have<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thickmathspace"/><mml:mo stretchy="false">⟹</mml:mo><mml:mspace width="thickmathspace"/><mml:mfrac><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mfrac><mml:mo>≈</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>ψ</mml:mi><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>ψ</mml:mi></mml:mrow></mml:msup><mml:mspace width="1em"/><mml:mtext>and</mml:mtext><mml:mspace width="1em"/><mml:mfrac><mml:mrow><mml:mover><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="thickmathspace"/><mml:mo stretchy="false">⟹</mml:mo><mml:mspace width="thickmathspace"/><mml:mi>L</mml:mi><mml:mo>∼</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">[</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>ψ</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the last implication is due to <inline-formula><mml:math id="inf557"><mml:mrow><mml:mi>L</mml:mi><mml:mo>∼</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. These scalings become valid once the distribution of the extant <inline-formula><mml:math id="inf558"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is pushed into the tail of <inline-formula><mml:math id="inf559"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. To crudely take into account the effect of a large initial number of strains when <inline-formula><mml:math id="inf560"><mml:mrow><mml:mi>K</mml:mi><mml:mo>≳</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf561"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> can be replaced by <inline-formula><mml:math id="inf562"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, as for the plots of <inline-formula><mml:math id="inf563"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf564"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in <xref ref-type="fig" rid="fig6">Figure 6</xref>. <xref ref-type="fig" rid="fig6">Figure 6B</xref> shows the theoretical prediction for <inline-formula><mml:math id="inf565"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in the simplest case of <inline-formula><mml:math id="inf566"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, and we see that <inline-formula><mml:math id="inf567"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:math></inline-formula> is reduced from the <inline-formula><mml:math id="inf568"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> prediction by only an <inline-formula><mml:math id="inf569"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> constant, as expected.</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Evolutionary dynamics for unrelated invaders (<inline-formula><mml:math id="inf570"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), with general fitnesses drawn from distributions parametrized by various values of <inline-formula><mml:math id="inf571"><mml:mi>ψ</mml:mi></mml:math></inline-formula>: faster-than-exponential decay for <inline-formula><mml:math id="inf572"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and slower-than-exponential for <inline-formula><mml:math id="inf573"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</title><p>Data are shown averaged over 50 replicates, conditional on not crashing, starting from <inline-formula><mml:math id="inf574"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>300</mml:mn></mml:mrow></mml:math></inline-formula> initial strains, with the shaded region showing the standard error. For <inline-formula><mml:math id="inf575"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula>, which results in decreasing diversity and crashes, a few individual trajectories are shown instead of an average. (<bold>A</bold>) Size of community as a function of the total number of strains introduced, <inline-formula><mml:math id="inf576"><mml:mrow><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>. For very long evolutionary times, we expect <inline-formula><mml:math id="inf577"><mml:mrow><mml:mi>L</mml:mi><mml:mo>∼</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, but transients due to initial conditions are substantial. In order to push up into the tails of the <inline-formula><mml:math id="inf578"><mml:mi>s</mml:mi></mml:math></inline-formula> distributions, the parameters of <inline-formula><mml:math id="inf579"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> are chosen differently for each <inline-formula><mml:math id="inf580"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> for <inline-formula><mml:math id="inf581"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.8</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> respectively. (<bold>B</bold>) Increase of the community-average <inline-formula><mml:math id="inf582"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> with <inline-formula><mml:math id="inf583"><mml:mi>T</mml:mi></mml:math></inline-formula>, shown pushing into the tail of <inline-formula><mml:math id="inf584"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. For <inline-formula><mml:math id="inf585"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> the dotted line shows the theory prediction <inline-formula><mml:math id="inf586"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, with deviations from this expected to be an <inline-formula><mml:math id="inf587"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> constant for large <inline-formula><mml:math id="inf588"><mml:mi>T</mml:mi></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82734-fig6-v2.tif"/></fig><p>At long times, the probability of successful invasion decreases very rapidly with <inline-formula><mml:math id="inf589"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> and, as we show in ‘Appendix 6’, the cumulative number of successful invasions for <inline-formula><mml:math id="inf590"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> grows very slowly, with <inline-formula><mml:math id="inf591"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. Nevertheless, for <inline-formula><mml:math id="inf592"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, the number of strains grows without bound albeit as a sub-linear power of the cumulative number of successful invasions. The average number of extinctions per successful invasion gradually decreases towards one as <inline-formula><mml:math id="inf593"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> in the pertinent range, <inline-formula><mml:math id="inf594"><mml:mrow><mml:mi>s</mml:mi><mml:mo>≈</mml:mo><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, becomes closer and closer to exponential.</p><p>For longer-than-exponential tails, <inline-formula><mml:math id="inf595"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, the diversity will decrease (possibly after an initial increase if <inline-formula><mml:math id="inf596"><mml:mrow><mml:mi>K</mml:mi><mml:mo>≫</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>) and eventually — in practice rather soon — crash as seen in <xref ref-type="fig" rid="fig6">Figure 6A</xref>.</p></sec></sec><sec id="s5" sec-type="discussion"><title>Discussion</title><p>In this paper, we have answered an important issue of principle: Without any assumption of niche-like differences between strains, can diversity continually grow under slow evolution? We have found that this can indeed occur if the community forms a spatiotemporally chaotic phase that we have studied previously in PAF. As new strains are introduced — either separately evolved invaders or mutants of extant strains — some successfully invade, potentially driving extinctions of strains in the community. In a range of parameters, the size of the persistent community continually grows on average, while for other parameters, the diversity decreases and eventually crashes. How fast the diversification proceeds depends on the statistical properties of the strains. If each strain has a different general fitness, <inline-formula><mml:math id="inf597"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, then as evolution proceeds the average <inline-formula><mml:math id="inf598"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> of the population gradually increases and pushes into the tail of the <inline-formula><mml:math id="inf599"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> distribution. If this tail falls off faster than exponentially, the community continues to diversify but more and more slowly, since fewer new strains will have sufficiently large <inline-formula><mml:math id="inf600"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> to invade. For broader-than-exponential distributions, the diversity eventually crashes as the general fitness differences dominate over the effects of interactions with other strains.</p><p>Building on an analytic and scaling understanding of the STC phase for an assembled community, we have developed a substantial understanding of the dynamics of the diversification or de-diversification. However even for the simple models on which we have focused, there are aspects that we do not understand.</p><sec id="s5-1"><title>Unresolved issues with the simple island models</title><sec id="s5-1-1"><title>Development of correlations</title><p>Even with invaders uncorrelated with the extant strains, subtle correlations build up in the interaction matrix and — although they appear rather weak (‘Appendix 4’) — the memory of earlier evolution will affect the way strain abundances change under further evolution, potentially mandating a better treatment of the evolution than the Markovian approximation we have used in ‘Evolution without general fitness differences’. With several complicating features — mutants, correlated general fitness differences, and substantial-sized initial communities — included, there are a number of crossovers that we have not attempted to analyze (‘Appendix 7’). These, and which aspects promote, slow down, or prevent, continual diversification, are likely to be quantitative and strongly model-dependent.</p></sec><sec id="s5-1-2"><title>Nucleation of diversifying “phase’</title><p>An observation from the simulations (‘Continual assembly and diversification’) gives rise to a broader question: Why is it so hard to nucleate the diversifying STC phase? And, concomitantly, why do initially diverse communities so often crash unless the diversity is rather large? It is likely that the limited number of strains that dominate on each island over any short time interval — of order <inline-formula><mml:math id="inf601"><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mi mathvariant="script">M</mml:mi></mml:mrow></mml:math></inline-formula> — plays a role, but unclear how. Whether the difficulty of nucleating a diverse STC community is special to the structure of the models and spatial dynamics assumed, or is true more generally, certainly needs further investigation.</p></sec><sec id="s5-1-3"><title>Spectrum of mutants and coexistence of parents and mutants</title><p>When invaders are mutants of extant strains that differ from their parent only very slightly, (with correlation coefficient <inline-formula><mml:math id="inf602"><mml:mi>ρ</mml:mi></mml:math></inline-formula> very close to unity), we have found that the parent and mutant coexist surprisingly frequently. Understanding this, even for the first mutant, requires analyzing the dynamics of strains with strongly correlated noise which we have not carried out, although we suspect that the very large local abundance variations that occur with low-migration rate give rise to a small decorrelation scale needed for coexistence. In each simulation, we have considered only mutants with a fixed level of correlation with their parents, leaving a number of natural questions: What are the effects of a distribution of magnitudes of mutational differences? How do these affect the invasion, coexistence, and subsequent properties of the evolving communities?</p></sec><sec id="s5-1-4"><title>Invasion dynamics</title><p>Because of the local chaos and low migration, the invasion of a potentially-successful new strain is complex. To avoid this complication, we have introduced new strains at substantial abundance and on all islands simultaneously. In actuality, most initial invasion attempts on an island will fail: only if the strain arrives when the conditions are ripe for it to bloom, can it avoid quick extinction and send out enough offspring to other islands, which — if also sufficiently good timing — allow it to spread. How this process depends on the relatedness of mutant and parent complicates matters greatly because of the boom-bust dynamics. Strains are most likely to beget mutant offspring when their abundances are high, but at that stage of a bloom, a crash in the local population will soon follow. Therefore, although many mutants may arise when a parent strain is doing well, the correlation between their dynamics and those of their parent means that they are likely to quickly go extinct when their parent crashes down from high abundance. In contrast, mutants that emerge right before a parent blooms up to high abundance can ride the bloom and establish more readily, but would have to arise in a small parental population. Understanding the balance between these effects and their consequence for invasion probabilities is a challenge for future work — especially with real spatial structure and dynamics, discussed below.</p></sec></sec><sec id="s5-2"><title>Spatial structure and dynamics</title><p>While for some microbial populations — for example common human gut commensals — a collection of connected “islands” without much spatial structure may be a rough caricature, for most populations there is spatial structure that makes dispersal from one location to another dependent on the distance in one, two or three dimensions. Thus, instead of having all pairs of islands connected by migration, one could model a <inline-formula><mml:math id="inf603"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>-dimensional array of islands with nearest-neighbor migration; a spatial continuum with diffusive dispersal; or a mixture of long and short distance dispersal events as driven by wind, ocean currents, or hitchhiking on migrant animals (<xref ref-type="bibr" rid="bib23">Hallatschek and Fisher, 2014</xref>). With real spatial structure, local sub-populations are much more prone to extinction and cannot be as readily rescued by migration from another location where the strain is blooming. Thus, in contrast to the regime we have worked in for this paper, recovery from local extinctions must play a crucial role. The dynamics of invasions, extinctions, and repopulation is very different than in the spatial mean field model: if the underlying dynamics is diffusive, invasion and repopulation will occur by propagating Fisher-Kolmogorov-Petrovsky-Piscunov (FKPP) fronts (<xref ref-type="bibr" rid="bib17">Fisher, 1937</xref>). The properties of FKPP waves are known to be highly sensitive to dynamics at the wavefront, and the effects of demographic fluctuations have been investigated (<xref ref-type="bibr" rid="bib28">Korolev et al., 2010</xref>). But the approximately multiplicative “noise” from the ecological interactions will surely change this, and even for a single wave understanding the impact of these larger fluctuations is still an open question (<xref ref-type="bibr" rid="bib37">Rocco et al., 2002</xref>; <xref ref-type="bibr" rid="bib36">Rocco et al., 2000</xref>).</p><p>With long-range dispersal over a multitude of length scales, the dynamics of invasion, extinction and repopulation will be very different, as already occurs for a single successful invader without ecological variations (<xref ref-type="bibr" rid="bib23">Hallatschek and Fisher, 2014</xref>). Generally, understanding of the STC phase will have to build on better understanding of repopulation dynamics in the presence of large ecological fluctuations, and then understanding the evolution of communities on top of that. We leave investigations of this for future work. But we conjecture that a continually diversifying STC phase can still occur with more realistic spatial dynamics.</p></sec><sec id="s5-3"><title>Bacteria-phage interactions and coevolution</title><p>An obvious weakness of the Lotka-Volterra models studied here is that the strains do not carry their own phenotypes, but are characterized by their interaction with all possible other strains. Furthermore, the antisymmetric correlations in the interaction matrix (especially without substantial general fitness differences) are rather unnatural for multiple strains of a single species. Thus, the most interesting extension of this work is to much more natural models: multiple strains of a phage species that prey on multiple strains of a bacterial species, with varying effectiveness that is a function of phenotypic properties of the particular phage and bacterial strains. Of particular importance is the interaction between a phage tail and bacterial receptor, as modelled in <xref ref-type="bibr" rid="bib53">Weitz et al., 2005</xref>. We showed previously [PAF] that the block-antisymmetrically-correlated structure of the interaction matrix with the bacteria having no niche-structure (differing only in the way they interact with the phages) can give rise to an STC phase that is very similar to that of the antisymmetrically correlated Lotka-Volterra model studied here: a similar model was further explored in <xref ref-type="bibr" rid="bib31">Martis, 2022</xref>. Such a bacteria-phage model can naturally accommodate general fitness advantages through phenotypic changes, eliminating the need to introduce them on separate footing. In ongoing work, we show that much of the basic phenomenology we have found here also occurs in evolving bacteria-phage phenotype models — at this stage only roughly and qualitatively.</p><p>For bacteria phage models, studying phylogenies and relatedness questions are natural. Whether more specialist phages tend to evolve, making the interaction matrix sparser and perhaps more hierarchical — and if so under what circumstances — is a particularly interesting question.</p></sec><sec id="s5-4"><title>Concluding questions</title><p>We have studied evolution of communities of many closely related strains in the limit that the evolutionary dynamics is slow compared to ecological and spatial dynamics. For a class of models, and in a particular ecological “phase”, evolution drives continual diversification, provided there is sufficient diversity initially. However mutations that change general fitness of strains tend to strongly slow down or even reverse the diversification. Thus we ask: How ubiquitous is diversification in the absence of any niche-like structure? Are there models in which a diversifying phase is easier to nucleate? Will the diversification always tend to be limited or strongly-slowed by general-fitness mutational effects? Or might “entropic” effects associated with difficulty of finding such general fitness mutations — for example from discrete genomes rather than continuous phenotypic parameters, or from soft tradeoffs — counter this slowdown, or perhaps produce evolutionary dynamics that lead to sparse interaction matrices and broader distributions of biases? Conversely, if strains are initially separated in “niche space” but then start to overlap and interact as the number of strains increases, how does the behavior differ? Is continual diversification easier to nucleate? Are the statistical properties of the phylogenies resulting from this evolutionary process — here driven entirely by “selection” in the broad sense, with ecological interactions creating a balance between the many extant strains — similar to a known class of coalescent trees?</p><p>What happens when, as in large microbial populations, evolutionary processes are not slow? Faster evolution is likely to make diversification easier, but understanding this even in simple models will require much better understanding of the invasion probabilities of mutants. Other than our scenario in which spatiotemporal chaos is the key to stabilizing coexisting diversity, what other robust continually diversifying scenarios are there? And of course, most crucially, what observable features of the strain, sub-strain, and sub-sub-strain level diversity in a microbial population (or interacting populations) could provide hints to the underlying causes of extensive diversity?</p></sec></sec></body><back><sec sec-type="additional-information" id="s6"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Software, Formal analysis, Investigation, Visualization, Writing - original draft</p></fn><fn fn-type="con" id="con2"><p>Software, Formal analysis, Investigation, Visualization, Methodology</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Formal analysis, Supervision, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s7"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-82734-mdarchecklist1-v2.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s8"><title>Data availability</title><p>The current manuscript is a computational study, so no data have been generated for this manuscript. Simulations use only standard algorithms: details in paper.</p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank Pankaj Mehta for useful discussions and comments on the manuscript. This work was supported in part by the National Science Foundation via PHY-1607606,and PHY-2210386, the National Institutes of Health via R01AI13699201, the Simons Foundation via a sabbatical Fellowship to DSF, and the Stanford University Sherlock Cluster for the computations.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Acinas</surname><given-names>SG</given-names></name><name><surname>Klepac-Ceraj</surname><given-names>V</given-names></name><name><surname>Hunt</surname><given-names>DE</given-names></name><name><surname>Pharino</surname><given-names>C</given-names></name><name><surname>Ceraj</surname><given-names>I</given-names></name><name><surname>Distel</surname><given-names>DL</given-names></name><name><surname>Polz</surname><given-names>MF</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Fine-scale phylogenetic architecture of a complex bacterial community</article-title><source>Nature</source><volume>430</volume><fpage>551</fpage><lpage>554</lpage><pub-id pub-id-type="doi">10.1038/nature02649</pub-id><pub-id pub-id-type="pmid">15282603</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amicone</surname><given-names>M</given-names></name><name><surname>Gordo</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Molecular signatures of resource competition: Clonal interference favors ecological diversification and can lead to incipient Speciation</article-title><source>Evolution; International Journal of Organic Evolution</source><volume>75</volume><fpage>2641</fpage><lpage>2657</lpage><pub-id pub-id-type="doi">10.1111/evo.14315</pub-id><pub-id pub-id-type="pmid">34341983</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beardmore</surname><given-names>RE</given-names></name><name><surname>Gudelj</surname><given-names>I</given-names></name><name><surname>Lipson</surname><given-names>DA</given-names></name><name><surname>Hurst</surname><given-names>LD</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Metabolic trade-offs and the maintenance of the fittest and the flattest</article-title><source>Nature</source><volume>472</volume><fpage>342</fpage><lpage>346</lpage><pub-id pub-id-type="doi">10.1038/nature09905</pub-id><pub-id pub-id-type="pmid">21441905</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bever</surname><given-names>JD</given-names></name><name><surname>Mangan</surname><given-names>SA</given-names></name><name><surname>Alexander</surname><given-names>HM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Maintenance of plant species diversity by pathogens</article-title><source>Annual Review of Ecology, Evolution, and Systematics</source><volume>46</volume><fpage>305</fpage><lpage>325</lpage><pub-id pub-id-type="doi">10.1146/annurev-ecolsys-112414-054306</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Biller</surname><given-names>SJ</given-names></name><name><surname>Berube</surname><given-names>PM</given-names></name><name><surname>Lindell</surname><given-names>D</given-names></name><name><surname>Chisholm</surname><given-names>SW</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Prochlorococcus: the structure and function of collective diversity</article-title><source>Nature Reviews. Microbiology</source><volume>13</volume><fpage>13</fpage><lpage>27</lpage><pub-id pub-id-type="doi">10.1038/nrmicro3378</pub-id><pub-id pub-id-type="pmid">25435307</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bonilla-Rosso</surname><given-names>G</given-names></name><name><surname>Steiner</surname><given-names>T</given-names></name><name><surname>Wichmann</surname><given-names>F</given-names></name><name><surname>Bexkens</surname><given-names>E</given-names></name><name><surname>Engel</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Honey bees harbor a diverse gut virome engaging in nested strain-level interactions with the microbiota</article-title><source>PNAS</source><volume>117</volume><fpage>7355</fpage><lpage>7362</lpage><pub-id pub-id-type="doi">10.1073/pnas.2000228117</pub-id><pub-id pub-id-type="pmid">32179689</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Bunin</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Interaction patterns and diversity in assembled ecological communities</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1607.04734">https://arxiv.org/abs/1607.04734</ext-link><pub-id pub-id-type="doi">10.48550/arXiv.1607.04734</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bunin</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Ecological communities with Lotka-Volterra dynamics</article-title><source>Physical Review. E</source><volume>95</volume><elocation-id>042414</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.95.042414</pub-id><pub-id pub-id-type="pmid">28505745</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caetano</surname><given-names>R</given-names></name><name><surname>Ispolatov</surname><given-names>Y</given-names></name><name><surname>Doebeli</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Evolution of diversity in metabolic strategies</article-title><source>eLife</source><volume>10</volume><elocation-id>e67764</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.67764</pub-id><pub-id pub-id-type="pmid">34350825</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chawanya</surname><given-names>T</given-names></name><name><surname>Tokita</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Large-dimensional replicator equations with antisymmetric random interactions</article-title><source>Journal of the Physical Society of Japan</source><volume>71</volume><fpage>429</fpage><lpage>431</lpage><pub-id pub-id-type="doi">10.1143/JPSJ.71.429</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chesson</surname><given-names>P</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Macarthur’s consumer-resource model</article-title><source>Theoretical Population Biology</source><volume>37</volume><fpage>26</fpage><lpage>38</lpage><pub-id pub-id-type="doi">10.1016/0040-5809(90)90025-Q</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chesson</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>General theory of competitive coexistence in spatially-varying environments</article-title><source>Theoretical Population Biology</source><volume>58</volume><fpage>211</fpage><lpage>237</lpage><pub-id pub-id-type="doi">10.1006/tpbi.2000.1486</pub-id><pub-id pub-id-type="pmid">11120650</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diederich</surname><given-names>S</given-names></name><name><surname>Opper</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Replicators with random interactions: A solvable model</article-title><source>Physical Review. A, General Physics</source><volume>39</volume><fpage>4333</fpage><lpage>4336</lpage><pub-id pub-id-type="doi">10.1103/physreva.39.4333</pub-id><pub-id pub-id-type="pmid">9901778</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doebeli</surname><given-names>M</given-names></name><name><surname>Jaque</surname><given-names>EC</given-names></name><name><surname>Ispolatov</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Boom-bust population dynamics increase diversity in evolving competitive communities</article-title><source>Communications Biology</source><volume>4</volume><elocation-id>502</elocation-id><pub-id pub-id-type="doi">10.1038/s42003-021-02021-4</pub-id><pub-id pub-id-type="pmid">33893395</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Erez</surname><given-names>A</given-names></name><name><surname>Lopez</surname><given-names>JG</given-names></name><name><surname>Weiner</surname><given-names>BG</given-names></name><name><surname>Meir</surname><given-names>Y</given-names></name><name><surname>Wingreen</surname><given-names>NS</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Nutrient levels and trade-offs control diversity in a serial dilution Ecosystem</article-title><source>eLife</source><volume>9</volume><elocation-id>e57790</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.57790</pub-id><pub-id pub-id-type="pmid">32915132</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farahpour</surname><given-names>F</given-names></name><name><surname>Saeedghalati</surname><given-names>M</given-names></name><name><surname>Brauer</surname><given-names>VS</given-names></name><name><surname>Hoffmann</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Trade-off shapes diversity in eco-evolutionary dynamics</article-title><source>eLife</source><volume>7</volume><elocation-id>e36273</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.36273</pub-id><pub-id pub-id-type="pmid">30117415</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fisher</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="1937">1937</year><article-title>The wave of advance of advantageous genes</article-title><source>Annals of Eugenics</source><volume>7</volume><fpage>355</fpage><lpage>369</lpage><pub-id pub-id-type="doi">10.1111/j.1469-1809.1937.tb02153.x</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fisher</surname><given-names>DS</given-names></name><name><surname>Huse</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>Nonequilibrium dynamics of spin glasses</article-title><source>Physical Review B</source><volume>38</volume><fpage>373</fpage><lpage>385</lpage><pub-id pub-id-type="doi">10.1103/PhysRevB.38.373</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friedman</surname><given-names>J</given-names></name><name><surname>Higgins</surname><given-names>LM</given-names></name><name><surname>Gore</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Community structure follows simple assembly rules in microbial microcosms</article-title><source>Nature Ecology &amp; Evolution</source><volume>1</volume><fpage>1</fpage><lpage>7</lpage><pub-id pub-id-type="doi">10.1038/s41559-017-0109</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Galla</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Random replicators with asymmetric couplings</article-title><source>Journal of Physics A</source><volume>39</volume><fpage>3853</fpage><lpage>3869</lpage><pub-id pub-id-type="doi">10.1088/0305-4470/39/15/001</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goel</surname><given-names>NS</given-names></name><name><surname>Maitra</surname><given-names>SC</given-names></name><name><surname>Montroll</surname><given-names>EW</given-names></name></person-group><year iso-8601-date="1971">1971</year><article-title>On the volterra and other nonlinear models of interacting populations</article-title><source>Reviews of Modern Physics</source><volume>43</volume><fpage>231</fpage><lpage>276</lpage><pub-id pub-id-type="doi">10.1103/RevModPhys.43.231</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldford</surname><given-names>JE</given-names></name><name><surname>Lu</surname><given-names>N</given-names></name><name><surname>Bajić</surname><given-names>D</given-names></name><name><surname>Estrela</surname><given-names>S</given-names></name><name><surname>Tikhonov</surname><given-names>M</given-names></name><name><surname>Sanchez-Gorostiaga</surname><given-names>A</given-names></name><name><surname>Segrè</surname><given-names>D</given-names></name><name><surname>Mehta</surname><given-names>P</given-names></name><name><surname>Sanchez</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Emergent simplicity in microbial community assembly</article-title><source>Science</source><volume>361</volume><fpage>469</fpage><lpage>474</lpage><pub-id pub-id-type="doi">10.1126/science.aat1168</pub-id><pub-id pub-id-type="pmid">30072533</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hallatschek</surname><given-names>O</given-names></name><name><surname>Fisher</surname><given-names>DS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Acceleration of evolutionary spread by long-range dispersal</article-title><source>PNAS</source><volume>111</volume><fpage>E4911</fpage><lpage>E4919</lpage><pub-id pub-id-type="doi">10.1073/pnas.1404663111</pub-id><pub-id pub-id-type="pmid">25368183</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>J</given-names></name><name><surname>Amor</surname><given-names>DR</given-names></name><name><surname>Barbier</surname><given-names>M</given-names></name><name><surname>Bunin</surname><given-names>G</given-names></name><name><surname>Gore</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Emergent phases of ecological diversity and dynamics mapped in microcosms</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.10.28.466339</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ignacio-Espinoza</surname><given-names>JC</given-names></name><name><surname>Ahlgren</surname><given-names>NA</given-names></name><name><surname>Fuhrman</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Long-term stability and red queen-like strain dynamics in marine viruses</article-title><source>Nature Microbiology</source><volume>5</volume><fpage>265</fpage><lpage>271</lpage><pub-id pub-id-type="doi">10.1038/s41564-019-0628-x</pub-id><pub-id pub-id-type="pmid">31819214</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kashtan</surname><given-names>N</given-names></name><name><surname>Roggensack</surname><given-names>SE</given-names></name><name><surname>Rodrigue</surname><given-names>S</given-names></name><name><surname>Thompson</surname><given-names>JW</given-names></name><name><surname>Biller</surname><given-names>SJ</given-names></name><name><surname>Coe</surname><given-names>A</given-names></name><name><surname>Ding</surname><given-names>H</given-names></name><name><surname>Marttinen</surname><given-names>P</given-names></name><name><surname>Malmstrom</surname><given-names>RR</given-names></name><name><surname>Stocker</surname><given-names>R</given-names></name><name><surname>Follows</surname><given-names>MJ</given-names></name><name><surname>Stepanauskas</surname><given-names>R</given-names></name><name><surname>Chisholm</surname><given-names>SW</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Single-cell genomics reveals hundreds of coexisting subpopulations in wild prochlorococcus</article-title><source>Science</source><volume>344</volume><fpage>416</fpage><lpage>420</lpage><pub-id pub-id-type="doi">10.1126/science.1248575</pub-id><pub-id pub-id-type="pmid">24763590</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kashtan</surname><given-names>N</given-names></name><name><surname>Roggensack</surname><given-names>SE</given-names></name><name><surname>Berta-Thompson</surname><given-names>JW</given-names></name><name><surname>Grinberg</surname><given-names>M</given-names></name><name><surname>Stepanauskas</surname><given-names>R</given-names></name><name><surname>Chisholm</surname><given-names>SW</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Fundamental differences in diversity and genomic population structure between Atlantic and Pacific prochlorococcus</article-title><source>The ISME Journal</source><volume>11</volume><fpage>1997</fpage><lpage>2011</lpage><pub-id pub-id-type="doi">10.1038/ismej.2017.64</pub-id><pub-id pub-id-type="pmid">28524867</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Korolev</surname><given-names>KS</given-names></name><name><surname>Avlund</surname><given-names>M</given-names></name><name><surname>Hallatschek</surname><given-names>O</given-names></name><name><surname>Nelson</surname><given-names>DR</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Genetic demixing and evolution in linear stepping stone models</article-title><source>Reviews of Modern Physics</source><volume>82</volume><fpage>1691</fpage><lpage>1718</lpage><pub-id pub-id-type="doi">10.1103/RevModPhys.82.1691</pub-id><pub-id pub-id-type="pmid">21072144</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>MacArthur</surname><given-names>RH</given-names></name><name><surname>Wilson</surname><given-names>EO</given-names></name></person-group><year iso-8601-date="1967">1967</year><source>The Theory of Island Biogeography</source><publisher-name>Princeton University Press</publisher-name></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin-Platero</surname><given-names>AM</given-names></name><name><surname>Cleary</surname><given-names>B</given-names></name><name><surname>Kauffman</surname><given-names>K</given-names></name><name><surname>Preheim</surname><given-names>SP</given-names></name><name><surname>McGillicuddy</surname><given-names>DJ</given-names></name><name><surname>Alm</surname><given-names>EJ</given-names></name><name><surname>Polz</surname><given-names>MF</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>High resolution time series reveals cohesive but short-lived communities in coastal plankton</article-title><source>Nature Communications</source><volume>9</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1038/s41467-017-02571-4</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Martis</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Eco-evolutionary feedback can stabilize diverse predator-prey communities</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2022.07.29.502084</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Opper</surname><given-names>M</given-names></name><name><surname>Diederich</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Phase transition and 1/f noise in a game dynamical model</article-title><source>Physical Review Letters</source><volume>69</volume><fpage>1616</fpage><lpage>1619</lpage><pub-id pub-id-type="doi">10.1103/PhysRevLett.69.1616</pub-id><pub-id pub-id-type="pmid">10046267</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pearce</surname><given-names>MT</given-names></name><name><surname>Agarwala</surname><given-names>A</given-names></name><name><surname>Fisher</surname><given-names>DS</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Stabilization of extensive fine-scale diversity by ecologically driven spatiotemporal chaos</article-title><source>PNAS</source><volume>117</volume><fpage>14572</fpage><lpage>14583</lpage><pub-id pub-id-type="doi">10.1073/pnas.1915313117</pub-id><pub-id pub-id-type="pmid">32518107</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Posfai</surname><given-names>A</given-names></name><name><surname>Taillefumier</surname><given-names>T</given-names></name><name><surname>Wingreen</surname><given-names>NS</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Metabolic trade-offs promote diversity in a model ecosystem</article-title><source>Physical Review Letters</source><volume>118</volume><elocation-id>028103</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.118.028103</pub-id><pub-id pub-id-type="pmid">28128613</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rieger</surname><given-names>H</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Solvable model of a complex ecosystem with randomly interacting species</article-title><source>Journal of Physics A</source><volume>22</volume><fpage>3447</fpage><lpage>3460</lpage><pub-id pub-id-type="doi">10.1088/0305-4470/22/17/011</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rocco</surname><given-names>A</given-names></name><name><surname>Ebert</surname><given-names>U</given-names></name><name><surname>Saarloos</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Subdiffusive fluctuations of &quot;pulled&quot; fronts with multiplicative noise</article-title><source>Physical Review. E, Statistical Physics, Plasmas, Fluids, and Related Interdisciplinary Topics</source><volume>62</volume><fpage>R13</fpage><lpage>R16</lpage><pub-id pub-id-type="doi">10.1103/physreve.62.r13</pub-id><pub-id pub-id-type="pmid">11088513</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rocco</surname><given-names>A</given-names></name><name><surname>Casademunt</surname><given-names>J</given-names></name><name><surname>Ebert</surname><given-names>U</given-names></name><name><surname>van Saarloos</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Diffusion coefficient of propagating fronts with multiplicative noise</article-title><source>Physical Review. E, Statistical, Nonlinear, and Soft Matter Physics</source><volume>65</volume><elocation-id>012102</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.65.012102</pub-id><pub-id pub-id-type="pmid">11800717</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rodriguez-Valera</surname><given-names>F</given-names></name><name><surname>Martin-Cuadrado</surname><given-names>A-B</given-names></name><name><surname>Rodriguez-Brito</surname><given-names>B</given-names></name><name><surname>Pasić</surname><given-names>L</given-names></name><name><surname>Thingstad</surname><given-names>TF</given-names></name><name><surname>Rohwer</surname><given-names>F</given-names></name><name><surname>Mira</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Explaining microbial population genomics through phage predation</article-title><source>Nature Reviews. Microbiology</source><volume>7</volume><fpage>828</fpage><lpage>836</lpage><pub-id pub-id-type="doi">10.1038/nrmicro2235</pub-id><pub-id pub-id-type="pmid">19834481</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosen</surname><given-names>MJ</given-names></name><name><surname>Davison</surname><given-names>M</given-names></name><name><surname>Bhaya</surname><given-names>D</given-names></name><name><surname>Fisher</surname><given-names>DS</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Microbial diversity. Fine-scale diversity and extensive recombination in a quasisexual bacterial population occupying a broad niche</article-title><source>Science</source><volume>348</volume><fpage>1019</fpage><lpage>1023</lpage><pub-id pub-id-type="doi">10.1126/science.aaa4456</pub-id><pub-id pub-id-type="pmid">26023139</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosen</surname><given-names>MJ</given-names></name><name><surname>Davison</surname><given-names>M</given-names></name><name><surname>Fisher</surname><given-names>DS</given-names></name><name><surname>Bhaya</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Probing the ecological and evolutionary history of a thermophilic cyanobacterial population via statistical properties of its microdiversity</article-title><source>PLOS ONE</source><volume>13</volume><elocation-id>e0205396</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0205396</pub-id><pub-id pub-id-type="pmid">30427861</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roy</surname><given-names>F</given-names></name><name><surname>Biroli</surname><given-names>G</given-names></name><name><surname>Bunin</surname><given-names>G</given-names></name><name><surname>Cammarota</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Numerical implementation of dynamical mean field theory for disordered systems: Application to the Lotka–Volterra model of ecosystems</article-title><source>Journal of Physics A</source><volume>52</volume><elocation-id>484001</elocation-id><pub-id pub-id-type="doi">10.1088/1751-8121/ab1f32</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roy</surname><given-names>F</given-names></name><name><surname>Barbier</surname><given-names>M</given-names></name><name><surname>Biroli</surname><given-names>G</given-names></name><name><surname>Bunin</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Complex interactions can create persistent fluctuations in high-diversity ecosystems</article-title><source>PLOS Computational Biology</source><volume>16</volume><elocation-id>e1007827</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1007827</pub-id><pub-id pub-id-type="pmid">32413026</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Serván</surname><given-names>CA</given-names></name><name><surname>Allesina</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Tractable models of ecological assembly</article-title><source>Ecology Letters</source><volume>24</volume><fpage>1029</fpage><lpage>1037</lpage><pub-id pub-id-type="doi">10.1111/ele.13702</pub-id><pub-id pub-id-type="pmid">33773006</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shoresh</surname><given-names>N</given-names></name><name><surname>Hegreness</surname><given-names>M</given-names></name><name><surname>Kishony</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Evolution exacerbates the paradox of the plankton</article-title><source>PNAS</source><volume>105</volume><fpage>12365</fpage><lpage>12369</lpage><pub-id pub-id-type="doi">10.1073/pnas.0803032105</pub-id><pub-id pub-id-type="pmid">18713864</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sompolinsky</surname><given-names>H</given-names></name><name><surname>Zippelius</surname><given-names>A</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>Relaxational dynamics of the Edwards-Anderson model and the mean-field theory of spin-glasses</article-title><source>Physical Review B</source><volume>25</volume><fpage>6860</fpage><lpage>6875</lpage><pub-id pub-id-type="doi">10.1103/PhysRevB.25.6860</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thingstad</surname><given-names>TF</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Elements of a theory for the mechanisms controlling abundance, diversity, and Biogeochemical role of Lytic bacterial viruses in aquatic systems</article-title><source>Limnology and Oceanography</source><volume>45</volume><fpage>1320</fpage><lpage>1328</lpage><pub-id pub-id-type="doi">10.4319/lo.2000.45.6.1320</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thingstad</surname><given-names>TF</given-names></name><name><surname>Våge</surname><given-names>S</given-names></name><name><surname>Storesund</surname><given-names>JE</given-names></name><name><surname>Sandaa</surname><given-names>RA</given-names></name><name><surname>Giske</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A theoretical analysis of how strain-specific viruses can control microbial species diversity</article-title><source>PNAS</source><volume>111</volume><fpage>7813</fpage><lpage>7818</lpage><pub-id pub-id-type="doi">10.1073/pnas.1400909111</pub-id><pub-id pub-id-type="pmid">24825894</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tikhonov</surname><given-names>M</given-names></name><name><surname>Leach</surname><given-names>RW</given-names></name><name><surname>Wingreen</surname><given-names>NS</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Interpreting 16S metagenomic data without clustering to achieve sub-OTU resolution</article-title><source>The ISME Journal</source><volume>9</volume><fpage>68</fpage><lpage>80</lpage><pub-id pub-id-type="doi">10.1038/ismej.2014.117</pub-id><pub-id pub-id-type="pmid">25012900</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tikhonov</surname><given-names>M</given-names></name><name><surname>Monasson</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Innovation rather than improvement: A solvable high-dimensional model highlights the limitations of scalar fitness</article-title><source>Journal of Statistical Physics</source><volume>172</volume><fpage>74</fpage><lpage>104</lpage><pub-id pub-id-type="doi">10.1007/s10955-018-1956-6</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tokita</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Species abundance patterns in complex evolutionary dynamics</article-title><source>Physical Review Letters</source><volume>93</volume><elocation-id>178102</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.93.178102</pub-id><pub-id pub-id-type="pmid">15525129</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Volkov</surname><given-names>I</given-names></name><name><surname>Banavar</surname><given-names>JR</given-names></name><name><surname>Hubbell</surname><given-names>SP</given-names></name><name><surname>Maritan</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Neutral theory and relative species abundance in ecology</article-title><source>Nature</source><volume>424</volume><fpage>1035</fpage><lpage>1037</lpage><pub-id pub-id-type="doi">10.1038/nature01883</pub-id><pub-id pub-id-type="pmid">12944964</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Volkov</surname><given-names>I</given-names></name><name><surname>Banavar</surname><given-names>JR</given-names></name><name><surname>Hubbell</surname><given-names>SP</given-names></name><name><surname>Maritan</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Patterns of relative species abundance in rainforests and coral reefs</article-title><source>Nature</source><volume>450</volume><fpage>45</fpage><lpage>49</lpage><pub-id pub-id-type="doi">10.1038/nature06197</pub-id><pub-id pub-id-type="pmid">17972874</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weitz</surname><given-names>JS</given-names></name><name><surname>Hartman</surname><given-names>H</given-names></name><name><surname>Levin</surname><given-names>SA</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Coevolutionary arms races between bacteria and bacteriophage</article-title><source>PNAS</source><volume>102</volume><fpage>9535</fpage><lpage>9540</lpage><pub-id pub-id-type="doi">10.1073/pnas.0504062102</pub-id><pub-id pub-id-type="pmid">15976021</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xue</surname><given-names>C</given-names></name><name><surname>Goldenfeld</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Coevolution maintains diversity in the stochastic &quot;kill the winner&quot; model</article-title><source>Physical Review Letters</source><volume>119</volume><elocation-id>268101</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.119.268101</pub-id><pub-id pub-id-type="pmid">29328693</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yoshino</surname><given-names>Y</given-names></name><name><surname>Galla</surname><given-names>T</given-names></name><name><surname>Tokita</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Rank abundance relations in evolutionary dynamics of random replicators</article-title><source>Physical Review. E, Statistical, Nonlinear, and Soft Matter Physics</source><volume>78</volume><elocation-id>031924</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.78.031924</pub-id><pub-id pub-id-type="pmid">18851082</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec sec-type="appendix" id="s9"><title>Spectrum of timescales</title><p>The primary timescale that governs the interplay of evolution and ecology is the <italic>ecological relaxation time</italic> which is <inline-formula><mml:math id="inf604"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, with <inline-formula><mml:math id="inf605"><mml:mrow><mml:mi mathvariant="script">M</mml:mi><mml:mo>≡</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, as discussed in ‘Timescales’. However the STC exhibits a number of other timescales. Although it does not play a role in the current work, there is a short timescale associated with the dynamic fluctuations: roughly the time that a strain spends near the peak of a bloom, which is similar to the inverse of its instantaneous growth or decay rate. This is dominated by the net effect of its interactions with the small subset of <inline-formula><mml:math id="inf606"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> strains that happen to be abundant at that time: the variance of this is <inline-formula><mml:math id="inf607"><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="script">M</mml:mi><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, which makes the <italic>dynamic fluctuation time</italic> <inline-formula><mml:math id="inf608"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:msqrt><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mi mathvariant="script">M</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>. Between this dynamic fluctuation timescale and the timescale for blooms, correlations in the growth rates decay as a power of the time difference. During a bloom, each strain experiences multiple reversals from growth to decay: this is a special property of the self-organized chaotic state.</p><p>The time to go extinct for a strain destined to do so depends logarithmically on the extinction threshold <inline-formula><mml:math id="inf609"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, but as long as <inline-formula><mml:math id="inf610"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> is very large, whether extinctions occur is not strongly dependent on <inline-formula><mml:math id="inf611"><mml:mi>N</mml:mi></mml:math></inline-formula>, as analyzed in PAF. In our simulations we choose for convenience <inline-formula><mml:math id="inf612"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi><mml:mi>m</mml:mi><mml:mo>≫</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> so that <inline-formula><mml:math id="inf613"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> is a few times <inline-formula><mml:math id="inf614"><mml:mi mathvariant="script">M</mml:mi></mml:math></inline-formula>.</p><p>The timescale for migration to be effective would, if there were no differences between the strains, be of order <inline-formula><mml:math id="inf615"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> which is very long. However, the spatial dynamics are much faster than this because of the exponential growth of local populations when they happen to be in a favorable community. This makes the timescale for <italic>exponential spread across islands</italic> of a successful invader be on the order of the bloom time on a single island, <inline-formula><mml:math id="inf616"><mml:mrow><mml:mi mathvariant="script">M</mml:mi><mml:mo>⁢</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>. This is analogous to the rapid spread of a Fisher wave driven by selection, even when the spatial dynamics is diffusive <xref ref-type="bibr" rid="bib17">Fisher, 1937</xref>; <xref ref-type="bibr" rid="bib28">Korolev et al., 2010</xref>.</p><p>The timescale of demographic fluctuations — even if some strains were phenotypically identical — would be very slow <inline-formula><mml:math id="inf617"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gen</mml:mtext></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> with <inline-formula><mml:math id="inf618"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gen</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mo>≪</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (in our units) a generation time. In practice, these fluctuations only matter when the populations happens to be very small and is being driven extinct on the deterministic dynamic timescale <inline-formula><mml:math id="inf619"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:msqrt><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mi mathvariant="script">M</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>. But as long as <inline-formula><mml:math id="inf620"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mi>m</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gen</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mo>≫</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, there are many migrants arriving and the dynamics is essentially deterministic. If the island-average <inline-formula><mml:math id="inf621"><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> drops enough then the migrations become stochastic with time intervals between them of order <inline-formula><mml:math id="inf622"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. But when this occurs for substantial time, the global population is likely to be on the way to extinction. We focus on <inline-formula><mml:math id="inf623"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi><mml:mi>m</mml:mi><mml:mo>≫</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> for which the population dynamics of the persistent strains are not strongly influenced by the stochastic or migratory demographic fluctuations.</p></sec></app><app id="appendix-2"><title>Appendix 2</title><sec sec-type="appendix" id="s10"><title>Numerics</title><sec sec-type="appendix" id="s10-1"><title>Parameters and integration</title><p>For all numerics, parameter values unless otherwise mentioned are <inline-formula><mml:math id="inf624"><mml:mrow><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mn>40</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf625"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf626"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf627"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>20</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>. In order to integrate the dynamics, we use an adaptive forward Euler step, with the time step chosen so that the maximum fractional change in the abundance of any strain is no greater than <inline-formula><mml:math id="inf628"><mml:mrow><mml:mn>3</mml:mn><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>. This means that the time step scales with the dynamic fluctuation time (‘Appendix 1’) which is <inline-formula><mml:math id="inf629"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. Therefore, in a single time step an abundance can change to anywhere from <inline-formula><mml:math id="inf630"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf631"><mml:mrow><mml:mn>7</mml:mn><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> of its current value. Because of the wide range over which abundances vary, such large changes do not cause numerical problems. Extinctions and invasions are treated deterministically, with local extinctions occurring for strain <inline-formula><mml:math id="inf632"><mml:mi>i</mml:mi></mml:math></inline-formula> on island <inline-formula><mml:math id="inf633"><mml:mi>α</mml:mi></mml:math></inline-formula> if <inline-formula><mml:math id="inf634"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. In this case <inline-formula><mml:math id="inf635"><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is set to 0. An irreversible global extinction of strain <inline-formula><mml:math id="inf636"><mml:mi>i</mml:mi></mml:math></inline-formula> occurs if <inline-formula><mml:math id="inf637"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for all <inline-formula><mml:math id="inf638"><mml:mi>α</mml:mi></mml:math></inline-formula> simultaneously. Recolonization of a locally extinct strain happens when <inline-formula><mml:math id="inf639"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf640"><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> is the time step of the integration. Since this time step is chosen to reflect the basic timescale of the abundance dynamics, this choice of the recolonization threshold is consistent.</p><p>At the start of a new epoch, one strain is introduced into the community: this is done deterministically, with fractional abundance of the new strain set at <inline-formula><mml:math id="inf641"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> on all islands and the other strains” abundances adjusted proportionately to maintain the overall population constraint. To save computational time, some incoming strains are rejected because they are very unlikely to successfully invade. This can be estimated by calculating their biases from the properties of the community before their introduction. By roughly estimating the critical bias from earlier successful invasions, we can conservatively reject some incoming strains without having to run the dynamics. With general fitness differences this can yield substantial speed-up by, for a community with population mean <inline-formula><mml:math id="inf642"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>, rejecting strains with <inline-formula><mml:math id="inf643"><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> sufficiently negative.</p><p>Since the epoch length is <inline-formula><mml:math id="inf644"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (set by the ecological relaxation time) and the time step scales as <inline-formula><mml:math id="inf645"><mml:msqrt><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mi mathvariant="script">M</mml:mi></mml:mrow></mml:msqrt></mml:math></inline-formula>, with each timestep requiring <inline-formula><mml:math id="inf646"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> computations to compute the instantaneous growth rates of the strains, the runtime of a single epoch scales as <inline-formula><mml:math id="inf647"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mn>5</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec sec-type="appendix" id="s10-2"><title>Correlations between mutant and parent interactions</title><p>Mutation of a parent strain to create an invader is comprised of two parts: changes in the parent’s <italic>interactions</italic> with the other strains, and a change in the parent’s general fitness. To generate the interaction part of a mutation, we append a new row and column to <inline-formula><mml:math id="inf648"><mml:mi>V</mml:mi></mml:math></inline-formula> which parameterizes the interaction between the new strain <inline-formula><mml:math id="inf649"><mml:mi>M</mml:mi></mml:math></inline-formula> and the parent strain <inline-formula><mml:math id="inf650"><mml:mi>P</mml:mi></mml:math></inline-formula>, each with another strain, <inline-formula><mml:math id="inf651"><mml:mi>k</mml:mi></mml:math></inline-formula>, according to <inline-formula><mml:math id="inf652"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf653"><mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>. In order to preserve the correlation <inline-formula><mml:math id="inf654"><mml:mi>γ</mml:mi></mml:math></inline-formula> between across-diagonal entries of <inline-formula><mml:math id="inf655"><mml:mi>V</mml:mi></mml:math></inline-formula>, we take <inline-formula><mml:math id="inf656"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>⁢</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf657"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>⁢</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> where the <inline-formula><mml:math id="inf658"><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> are i.i.d. standard normal random variables. This preserves the desired correlations, with <inline-formula><mml:math id="inf659"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:math></inline-formula>.</p><p>However, we have to treat the direct interactions between the parent and mutant, <inline-formula><mml:math id="inf660"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, more carefully, since it is not always possible to preserve <inline-formula><mml:math id="inf661"><mml:mi>γ</mml:mi></mml:math></inline-formula> while also having the desired correlations between <inline-formula><mml:math id="inf662"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf663"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf664"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Defining <inline-formula><mml:math id="inf665"><mml:mi>D</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf666"><mml:mi>H</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf667"><mml:mi>J</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf668"><mml:mi>K</mml:mi></mml:math></inline-formula> as<disp-formula id="equ6"> <label>(A2.1)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mi>D</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi>H</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>J</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi>K</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>the symmetry conditions we enforce are<disp-formula id="equ7"><label>(A2.2)</label><mml:math id="m7"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:mrow><mml:mo rspace="12.5pt">,</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>H</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>J</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo rspace="12.5pt">,</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mi>J</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>⁢</mml:mo><mml:mi>J</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>γ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In addition, we require that <inline-formula><mml:math id="inf669"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula> in the limit <inline-formula><mml:math id="inf670"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>→</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf671"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mi>J</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:math></inline-formula> as <inline-formula><mml:math id="inf672"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. The parameterization that we choose which respects these conditions is<disp-formula id="equ8"><label>(A2.3)</label><mml:math id="m8"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msqrt><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ9"><label>(A2.4)</label><mml:math id="m9"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msqrt><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:mo stretchy="false">(</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msqrt><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>γ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ10"><label>(A2.5)</label><mml:math id="m10"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo>+</mml:mo><mml:mi>J</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msqrt><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>γ</mml:mi></mml:msqrt><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the <inline-formula><mml:math id="inf673"><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> are i.i.d. standard normal random variables. Now we have <inline-formula><mml:math id="inf674"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mi>J</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, which does not precisely preserve the desired correlation <inline-formula><mml:math id="inf675"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mi>J</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:math></inline-formula>, but it has the correct limit as <inline-formula><mml:math id="inf676"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Our parameterization gives <inline-formula><mml:math id="inf677"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>γ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, but it is possible to choose an alternative parameterization which has a different value of <inline-formula><mml:math id="inf678"><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> but still respects the desired symmetries.</p><p>The dominant interaction between the parent and the mutant is mediated by the other strains in the ecosystem, with the direct influence of the parent on the growth rate of the mutant and vice versa smaller than the contributions mediated by all the other strains by a factor of <inline-formula><mml:math id="inf679"><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:math></inline-formula>. Therefore the choice of the direct parent-mutant interaction ought not to be of much importance — unless sufficiently strong correlations develop under continuing evolution, for which we do not see evidence.</p></sec><sec sec-type="appendix" id="s10-3"><title>Epoch length in the diversifying phase</title><p>At the beginning of each simulation run, an ensemble of <inline-formula><mml:math id="inf680"><mml:mi>K</mml:mi></mml:math></inline-formula> randomly drawn strains is assembled and run to reach a chaotic steady state under the dynamics of <xref ref-type="disp-formula" rid="equ1">Equation 1</xref> for time <inline-formula><mml:math id="inf681"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:msqrt><mml:mi>K</mml:mi></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. Between the introductions of new strains the ecological dynamics are run for epochs of length <inline-formula><mml:math id="inf682"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>epoch</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi mathvariant="script">M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="inf683"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>epoch</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>. In addition, for most simulations we intersperse regular-length epochs with longer epochs to get rid of any marginal strains which may be barely surviving. These longer epochs (longer than the others by a factor of <inline-formula><mml:math id="inf684"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>) occur every 100 epochs.</p><p>The duration of the initial epoch with an assembled community of <inline-formula><mml:math id="inf685"><mml:mi>K</mml:mi></mml:math></inline-formula> strains was usually chosen to be shorter than later epochs. But for the evolutions this does not much matter as the distribution of close-to-marginal strains is different than in later epochs and these are in any case quite likely to go extinct in subsequent epochs. However, for the simulations for which we compared assembled and evolved communities (e.g. <xref ref-type="fig" rid="fig5">Figure 5</xref>), the dynamics of the initial assembled communities were run for a longer time <inline-formula><mml:math id="inf686"><mml:mrow><mml:mn>12</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="script">M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>.</p><p>In order to check that the evolutionary dynamics are in the quasistatic limit, where the strains are introduced slowly enough that their introduction rate does not matter, we look at how the diversification rate depends on the length of the epochs between strain introductions. In <xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref> we vary <inline-formula><mml:math id="inf687"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mtext>epoch</mml:mtext></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> over one order of magnitude and find similar evolutionary dynamics for all epoch lengths. In the case of <inline-formula><mml:math id="inf688"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, there is a longer transient for the long epochs, though once in the diversifying regime, <inline-formula><mml:math id="inf689"><mml:mi>L</mml:mi></mml:math></inline-formula> increases at a similar rate for all epoch lengths. Based on this, all data presented in the paper were generated with <inline-formula><mml:math id="inf690"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>epoch</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, which makes numerics faster, and should not change qualitative conclusions about the slowly diversifying regime.</p><fig id="app2fig1" position="float"><label>Appendix 2—figure 1.</label><caption><title><inline-formula><mml:math id="inf691"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>400</mml:mn></mml:mrow></mml:math></inline-formula>.</title><p>(<bold>A</bold>) <inline-formula><mml:math id="inf692"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. (<bold>B</bold>) <inline-formula><mml:math id="inf693"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>. Rates of diversification (measured per attempted invasion) are insensitive to a factor-of-10 change in the intervals between the introduction of the new types: the epoch durations shown are <inline-formula><mml:math id="inf694"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>epoch</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi mathvariant="script">M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> with several values of <inline-formula><mml:math id="inf695"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Although it can take more invasions to get into the steadily diversifying regime for long epochs, the rates of diversity increase depend little on the epoch lengths. Both dashed lines both have slope 0.2 (diversification rates happen to be similar for <inline-formula><mml:math id="inf696"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf697"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82734-app2-fig1-v2.tif"/></fig></sec><sec sec-type="appendix" id="s10-4"><title>Estimation of drive and bias</title><p>The mean drive and bias are emergent quantities from the mean field analysis (‘Appendix 5’), and are therefore not manifest in our direct numerical integration of the dynamics: however we can extract them from numerics as detailed below. Here, we use the notation <inline-formula><mml:math id="inf698"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>∖</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for the average abundance of strain <inline-formula><mml:math id="inf699"><mml:mi>i</mml:mi></mml:math></inline-formula> in the absence of strain <inline-formula><mml:math id="inf700"><mml:mi>j</mml:mi></mml:math></inline-formula>. The averaged growth rate of a strain, excluding migration, can be measured directly. In the mean field approximation, this is decomposed as the sum of its bias and feedback from it perturbing the other strains::<disp-formula id="equ11"><label>(A2.6)</label><mml:math id="m11"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ12"><label>(A2.7)</label><mml:math id="m12"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mi>X</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ13"><label>(A2.8)</label><mml:math id="m13"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mi>X</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the drive, <inline-formula><mml:math id="inf701"><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>∖</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, can be written in terms of mean field quantities as <inline-formula><mml:math id="inf702"><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. The term <inline-formula><mml:math id="inf703"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> captures the feedback of strain <inline-formula><mml:math id="inf704"><mml:mi>i</mml:mi></mml:math></inline-formula> back onto itself via the other strains. Therefore, if we know the susceptibility, <inline-formula><mml:math id="inf705"><mml:mi>X</mml:mi></mml:math></inline-formula>, we can calculate the drive and bias of a strain: since <inline-formula><mml:math id="inf706"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf707"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> are measurable in our simulation, we need only to subtract off the <inline-formula><mml:math id="inf708"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> term from <inline-formula><mml:math id="inf709"><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> to get <inline-formula><mml:math id="inf710"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. We can find <inline-formula><mml:math id="inf711"><mml:mi>X</mml:mi></mml:math></inline-formula> using the self consistency condition that <inline-formula><mml:math id="inf712"><mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula></p><p>First, we make a guess for the susceptibility <inline-formula><mml:math id="inf713"><mml:mi>X</mml:mi></mml:math></inline-formula> which allows a provisional calculation of the <inline-formula><mml:math id="inf714"><mml:msub><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. Then, using our numerical simulation data, we fit parameters <inline-formula><mml:math id="inf715"><mml:mi>a</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf716"><mml:mi>b</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf717"><mml:mi>c</mml:mi></mml:math></inline-formula> to a functional form giving the mean abundance in terms of the drive and <inline-formula><mml:math id="inf718"><mml:mi>s</mml:mi></mml:math></inline-formula>:<disp-formula id="equ14"><label>(A2.9)</label><mml:math id="m14"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The justification for this form is that it gives <inline-formula><mml:math id="inf719"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf720"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. This is the expectation that <inline-formula><mml:math id="inf721"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> becomes proportional to <inline-formula><mml:math id="inf722"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> for positive <inline-formula><mml:math id="inf723"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> — though here we include an offset via the parameter <inline-formula><mml:math id="inf724"><mml:mi>c</mml:mi></mml:math></inline-formula> which roughly represents the expected correction to the linear function <inline-formula><mml:math id="inf725"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> at large bias. The quantity <inline-formula><mml:math id="inf726"><mml:mrow><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:math></inline-formula> is similar to <inline-formula><mml:math id="inf727"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> but not quite the same due to a systematic difference between <inline-formula><mml:math id="inf728"><mml:mi>c</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf729"><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula>. For large negative bias, the fitted form captures the roughly exponential decrease of <inline-formula><mml:math id="inf730"><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> due to the rareness of blooms.</p><p>The data are fit by this functional form quite well (<xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2</xref>). We observe that <inline-formula><mml:math id="inf731"><mml:mi>c</mml:mi></mml:math></inline-formula> tends to be smaller than the measured <inline-formula><mml:math id="inf732"><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> within a given epoch, which could be due to the effect of migration which elevates <inline-formula><mml:math id="inf733"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> for strains with negative <inline-formula><mml:math id="inf734"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. The parameter combination <inline-formula><mml:math id="inf735"><mml:mrow><mml:mi>b</mml:mi><mml:mo>/</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:math></inline-formula> is roughly equal to <inline-formula><mml:math id="inf736"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>γ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, as expected from the mean field analysis. From the hypothesized form of <inline-formula><mml:math id="inf737"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> we can recalculate the susceptibility via <inline-formula><mml:math id="inf738"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></inline-formula> (where the derivative is calculated numerically). We then update our value of <inline-formula><mml:math id="inf739"><mml:mi>X</mml:mi></mml:math></inline-formula> by averaging the old guess with the new estimate.</p><fig id="app2fig2" position="float"><label>Appendix 2—figure 2.</label><caption><title>Inference of the drives, <inline-formula><mml:math id="inf740"><mml:msub><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, for (<bold>A</bold>) communities evolving with <inline-formula><mml:math id="inf741"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and (<bold>B</bold>) communities evolving with <inline-formula><mml:math id="inf742"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>.</title><p>In both cases, all <inline-formula><mml:math id="inf743"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. The black lines shows the fit of the functional form for <inline-formula><mml:math id="inf744"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ζ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> after <inline-formula><mml:math id="inf745"><mml:mi>X</mml:mi></mml:math></inline-formula> has converged to a self-consistent value. Data are pooled (both for fitting and for plotting) over 5 consecutive epochs, each with <inline-formula><mml:math id="inf746"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mn>300</mml:mn></mml:mrow></mml:math></inline-formula> extant strains. For <inline-formula><mml:math id="inf747"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula> it seems that correlations in the interactions that have accumulated due to the relatedness are affecting the relationship between <inline-formula><mml:math id="inf748"><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf749"><mml:mi>ζ</mml:mi></mml:math></inline-formula>. Certain strains are visible outliers from the average dependence of <inline-formula><mml:math id="inf750"><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> on <inline-formula><mml:math id="inf751"><mml:mi>ζ</mml:mi></mml:math></inline-formula>, and appear multiple times on plots since data are pooled across 5 epochs.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82734-app2-fig2-v2.tif"/></fig><p>By iterating over the susceptibility until it converges to a value where the assumed drives <inline-formula><mml:math id="inf752"><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> reproduce the susceptibility via the self-consistency condition, we can get an estimate for the susceptibility and therefore the drive as well. Then the bias is <inline-formula><mml:math id="inf753"><mml:mrow><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> where we have subtracted the Lagrange multiplier (neglecting effects of order <inline-formula><mml:math id="inf754"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mrow><mml:mo>∖</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> which are smaller by of order <inline-formula><mml:math id="inf755"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>) and added back in the general fitness. We can validate that our bias estimator is reasonably accurate by comparing the inferred biases to the biases of strains in their first epoch of invasion — the latter can be measured directly from simulations since they are simply the invasion eigenvalues for incoming strains. As this works well, we use it to infer the biases for all the other strains in the community. (Note that in contrast to the assembled communities studied in PAF, we cannot use the condition that the drive averaged over all the initial <inline-formula><mml:math id="inf756"><mml:mi>K</mml:mi></mml:math></inline-formula> strains, is zero. PAF used this — along with the expected truncated gaussian shape with variance <inline-formula><mml:math id="inf757"><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> and lower limit <inline-formula><mml:math id="inf758"><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> — as a check in calculating the drives. This no longer works here because conditioning on evolution means that the mean drive is no longer  and the drive distribution is no longer a truncated gaussian.)</p><p>To increase the quantity of data on which to perform our fit for <inline-formula><mml:math id="inf759"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ζ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> in a given epoch, we pool data from up to 20 epochs around the focal epoch, provided their <inline-formula><mml:math id="inf760"><mml:mi>L</mml:mi></mml:math></inline-formula> is within 5% of the <inline-formula><mml:math id="inf761"><mml:mi>L</mml:mi></mml:math></inline-formula> in the focal epoch, with the hypothesis that these communities are statistically similar and therefore have a similar <inline-formula><mml:math id="inf762"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ζ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>The function <inline-formula><mml:math id="inf763"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> for the evolved communities with <inline-formula><mml:math id="inf764"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> looks quite similar to the function for assembled communities However for communities evolved with <inline-formula><mml:math id="inf765"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf766"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> looks substantially different. This indicates that the build-up of correlations in the community requires modifications of the independence assumptions of the mean field theory.</p><p>After inferring the function <inline-formula><mml:math id="inf767"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ζ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and the drive for each strain, we can calculate the fragility, defined as <inline-formula><mml:math id="inf768"><mml:mrow><mml:mi mathvariant="normal">Ξ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. The closer <inline-formula><mml:math id="inf769"><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> is to 1, the more unstable the community is to perturbations. Indeed we find that for simulations diversifying from 50 to 500 strains, <inline-formula><mml:math id="inf770"><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>≅</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math></inline-formula> for the evolved community of <inline-formula><mml:math id="inf771"><mml:mrow><mml:mi/><mml:mo>≅</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math></inline-formula> strains, while early in the simulations, when <inline-formula><mml:math id="inf772"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, we find <inline-formula><mml:math id="inf773"><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>≅</mml:mo><mml:mn>0.75</mml:mn></mml:mrow></mml:math></inline-formula>. When comparing <inline-formula><mml:math id="inf774"><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> for assembled and evolved communities, both of 500 strains, there is not a clear difference. Note that the close-to-marginal strains, which are more abundant in the assembled community, only contribute small amounts to <inline-formula><mml:math id="inf775"><mml:mi mathvariant="normal">Ξ</mml:mi></mml:math></inline-formula>, so this is not surprising.</p></sec></sec></app><app id="appendix-3"><title>Appendix 3</title><sec sec-type="appendix" id="s11"><title>Dynamics of diversification</title><sec sec-type="appendix" id="s11-1"><title>Extinctions, diversity crashes, and nucleation from low diversity</title><fig id="app3fig1" position="float"><label>Appendix 3—figure 1.</label><caption><title>Crashes and distribution of number of extinctions per invasion.</title><p>(<bold>A</bold>) The fate of an evolving community depends on the number of initial strains <inline-formula><mml:math id="inf776"><mml:mi>K</mml:mi></mml:math></inline-formula>. The characteristic size below which crashes dominate is <inline-formula><mml:math id="inf777"><mml:mrow><mml:mi/><mml:mo>≅</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> for the parameters <inline-formula><mml:math id="inf778"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf779"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> as shown here. (<bold>B</bold>) The distribution of the number of extinctions per successful invasion depends on the size of the community. Data are aggregated across a range of <inline-formula><mml:math id="inf780"><mml:mi>K</mml:mi></mml:math></inline-formula>, each run with 100 replicates. For small community size, <inline-formula><mml:math id="inf781"><mml:mi>L</mml:mi></mml:math></inline-formula>, invasions occur in which a substantial fraction of the strains go extinct. But for large <inline-formula><mml:math id="inf782"><mml:mi>L</mml:mi></mml:math></inline-formula>, multiple extinction events are very rare and the distribution is close to geometric: the dotted line is <inline-formula><mml:math id="inf783"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> for the probability of <inline-formula><mml:math id="inf784"><mml:mi mathvariant="normal">ℓ</mml:mi></mml:math></inline-formula> extinctions, with <inline-formula><mml:math id="inf785"><mml:mrow><mml:mi>α</mml:mi><mml:mo>≅</mml:mo><mml:mn>0.41</mml:mn></mml:mrow></mml:math></inline-formula>, corresponding to an average of 0.7 extinctions per successful invasion as shown in <xref ref-type="fig" rid="fig2">Figure 2A</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82734-app3-fig1-v2.tif"/></fig><p>A crucial question is whether it is possible to build up a highly diverse community from a small initial number of strains and, if so, on what this depends. Starting simulations at values of <inline-formula><mml:math id="inf786"><mml:mi>K</mml:mi></mml:math></inline-formula> between 10 and 90, we observe a crossover size, <inline-formula><mml:math id="inf787"><mml:msup><mml:mi>K</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, of the initial number of strains above which diversification is robust, and below which the diversity typically crashes under the evolutionary dynamics and does not again increase substantially for the duration of the simulations, (<xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1A</xref>). The presence of a crossover <inline-formula><mml:math id="inf788"><mml:msup><mml:mi>K</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> suggests that once the system is sufficiently diverse, it tends toward further diversity. Thus the main obstacle to diversification in these models is going from a single strain to <inline-formula><mml:math id="inf789"><mml:mrow><mml:mi/><mml:mo>≅</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> strains. We define <inline-formula><mml:math id="inf790"><mml:msup><mml:mi>K</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> heuristically as the lowest <inline-formula><mml:math id="inf791"><mml:mi>K</mml:mi></mml:math></inline-formula> that diversifies with probability more than <inline-formula><mml:math id="inf792"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> (see <xref ref-type="fig" rid="app3fig2">Appendix 3—figure 2</xref>). For each <inline-formula><mml:math id="inf793"><mml:mi>K</mml:mi></mml:math></inline-formula>, there is a corresponding <inline-formula><mml:math id="inf794"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>: the number of strains that persists after the initial drop in diversity. This somewhat-variable <inline-formula><mml:math id="inf795"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> appears to be the primary determinant of a community’s stability to evolutionary perturbations. However this stability also depends on the community’s history. For example, if the community has evolved gradually from a smaller number of strains to some current size <inline-formula><mml:math id="inf796"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mrow><mml:mtext mathvariant="italic">E</mml:mtext></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, its response to continued evolution may be different than if it has been assembled from an initial number <inline-formula><mml:math id="inf797"><mml:mi>K</mml:mi></mml:math></inline-formula> that dropped through its initial evolution to an ecologically stable community of size <inline-formula><mml:math id="inf798"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mrow><mml:mtext mathvariant="italic">E</mml:mtext></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. This motivates definition of a crossover size <inline-formula><mml:math id="inf799"><mml:msup><mml:mi>L</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, different from <inline-formula><mml:math id="inf800"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, given by the minimum size of an <italic>evolved</italic> community for which the probability of entering the diversifying phase is greater than <inline-formula><mml:math id="inf801"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. We discuss the differences between assembled and gradually evolved communities further in ‘Appendix 4’, but leave an analysis of how these properties affect the nucleation probability for future work. The size <inline-formula><mml:math id="inf802"><mml:msup><mml:mi>L</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> is a natural quantity to work with, as it is the relevant one when considering how a community might nucleate from a small number of strains into a diversifying regime. As we discuss later, we expect <inline-formula><mml:math id="inf803"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> since just-assembled communities are more susceptible to perturbations than gradually assembled ones.</p><fig id="app3fig2" position="float"><label>Appendix 3—figure 2.</label><caption><title>The probability of establishing the steadily diversifying regime increases with the initial number of strains and decreases with the migration rate.</title><p>Although changing the migration rate from 10<sup>–5</sup> to 10<sup>–10</sup> changes the establishment probability significantly, further reducing <inline-formula><mml:math id="inf804"><mml:mi>m</mml:mi></mml:math></inline-formula> has little noticeable effect, indicating that the dependence of establishment probability on <inline-formula><mml:math id="inf805"><mml:mi>m</mml:mi></mml:math></inline-formula> is rather weak over several orders of magnitude. Data are averaged over 100 simulations for each set of parameter values. If <inline-formula><mml:math id="inf806"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, then migration cannot stabilize the spatiotemporal chaos, and so the establishment probability should vanish — but this is a very singular limit.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82734-app3-fig2-v2.tif"/></fig><p>We can quantify how likely the system is to diversify or crash by inspecting the number of extinctions, <inline-formula><mml:math id="inf807"><mml:mi mathvariant="normal">ℓ</mml:mi></mml:math></inline-formula>, that occur for each invader that successfully enters the ecosystem. The distribution of <inline-formula><mml:math id="inf808"><mml:mi mathvariant="normal">ℓ</mml:mi></mml:math></inline-formula> is dependent on <inline-formula><mml:math id="inf809"><mml:mi>L</mml:mi></mml:math></inline-formula> and shows that more diverse ecosystems suffer on average fewer extinctions triggered by invasion of each new strain (<xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1B</xref>). For small communities <inline-formula><mml:math id="inf810"><mml:mi>L</mml:mi></mml:math></inline-formula> of order <inline-formula><mml:math id="inf811"><mml:msup><mml:mi>L</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> or less, extinctions of a substantial fraction of the strains occur, and cascades of extinctions in response to successive invasions cause <inline-formula><mml:math id="inf812"><mml:mi>L</mml:mi></mml:math></inline-formula> to crash. The fragility of the communities with <inline-formula><mml:math id="inf813"><mml:mrow><mml:mi>L</mml:mi><mml:mo>≅</mml:mo><mml:msup><mml:mi>L</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> to evolutionary perturbations and their strong tendency not to recover after a crash (<xref ref-type="fig" rid="fig2">Figure 2A</xref>), implies that the process by which a low diversity community <italic>could</italic> diversify is very different than the steady diversification of already large communities. The transition from the low diversity to the diversifying regimes must be mediated by a very rare nucleation event in which <inline-formula><mml:math id="inf814"><mml:mi>L</mml:mi></mml:math></inline-formula> becomes roughly larger than <inline-formula><mml:math id="inf815"><mml:msup><mml:mi>L</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>. We discuss the low diversity regime and speculate about such nucleations in ‘Appendix 3’.</p><p>In the steadily diversifying regime the distribution of extinctions per successful invasion is close to exponential — a result that we derive in ‘Distribution of biases and number of extinctions’. For large <inline-formula><mml:math id="inf816"><mml:mi>L</mml:mi></mml:math></inline-formula>, the chances that a substantial fraction of the strains go extinct is extremely small and decreases exponentially as <inline-formula><mml:math id="inf817"><mml:mi>L</mml:mi></mml:math></inline-formula> increases further: thus for large <inline-formula><mml:math id="inf818"><mml:mi>L</mml:mi></mml:math></inline-formula> the continual diversification is essentially deterministic.</p></sec><sec sec-type="appendix" id="s11-2"><title>Probability of diversification as a function of initial community size</title><p>The initial community size beyond which diversification becomes likely depends <inline-formula><mml:math id="inf819"><mml:mi>m</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf820"><mml:mi>γ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf821"><mml:mi>ρ</mml:mi></mml:math></inline-formula>, and is defined as <inline-formula><mml:math id="inf822"><mml:msup><mml:mi>K</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>. For some range of <inline-formula><mml:math id="inf823"><mml:mi>γ</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2B</xref>), <inline-formula><mml:math id="inf824"><mml:msup><mml:mi>K</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> is infinite: the system always eventually crashes. The role of <inline-formula><mml:math id="inf825"><mml:mi>m</mml:mi></mml:math></inline-formula> in determining <inline-formula><mml:math id="inf826"><mml:msup><mml:mi>K</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> can be partially understood from the mechanism of diversity crashes due to synchronization of dynamics between islands. This occurs more frequently when <inline-formula><mml:math id="inf827"><mml:mi>m</mml:mi></mml:math></inline-formula> is larger, but its dynamics are subtle because of local blooms up to high abundance which can can have outsize effects. Though we have not studied the synchronization and diversity crash process here, it suggests an interpretation of our simulation results (<xref ref-type="fig" rid="app3fig2">Appendix 3—figure 2</xref>) which show that decreasing <inline-formula><mml:math id="inf828"><mml:mi>m</mml:mi></mml:math></inline-formula> lowers <inline-formula><mml:math id="inf829"><mml:msup><mml:mi>K</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, presumably because it makes the STC more difficult to spatially synchronize and hence less likely to crash.</p></sec><sec sec-type="appendix" id="s11-3"><title>Nucleation from low diversity</title><p>Here we further investigate the evolutionary dynamics when the diversity is low. We are particularly interested in the nucleation process by which an ecosystem could transition from the <inline-formula><mml:math id="inf830"><mml:mrow><mml:mi>L</mml:mi><mml:mo>≪</mml:mo><mml:msup><mml:mi>L</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> regime to the steadily diversifying regime, where <inline-formula><mml:math id="inf831"><mml:msup><mml:mi>L</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> is the crossover beyond which continual diversification becomes likely. For the parameters we have investigated, this turns out to be extremely rare. Even in runs of 10<sup>5</sup> attempted invasions starting from a single strain, the community always remains small. We observe that the number of extinctions per successful invasion is broadly distributed (as when starting with a larger community <inline-formula><mml:math id="inf832"><mml:mrow><mml:mi>L</mml:mi><mml:mo>∼</mml:mo><mml:msup><mml:mi>L</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> in <xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1</xref>) and the evolutionary dynamics of <inline-formula><mml:math id="inf833"><mml:mi>L</mml:mi></mml:math></inline-formula> typically proceeds by incremental increases punctuated by large decreases. In this regime, the steady state distribution of <inline-formula><mml:math id="inf834"><mml:mi>L</mml:mi></mml:math></inline-formula> is observed to be very close to Poisson (<xref ref-type="fig" rid="app3fig3">Appendix 3—figure 3</xref>) — a result that we do not have a theory for. From this Poisson behavior, one can attempt to extrapolate the probability of reaching <inline-formula><mml:math id="inf835"><mml:msup><mml:mi>L</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> and transitioning to steady diversification by a lucky fluctuation in <inline-formula><mml:math id="inf836"><mml:mi>L</mml:mi></mml:math></inline-formula>. Taking <inline-formula><mml:math id="inf837"><mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>≈</mml:mo><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>≈</mml:mo><mml:mn>70</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mn>55</mml:mn></mml:mrow></mml:math></inline-formula> based on Figures <xref ref-type="fig" rid="app3fig2">Appendix 3—figure 2</xref> and <xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1</xref>, this estimate suggests <inline-formula><mml:math id="inf838"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>60</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> attempted invasions would be needed. However, the probability distribution of <inline-formula><mml:math id="inf839"><mml:mi>L</mml:mi></mml:math></inline-formula> will surely deviate from Poisson long before <inline-formula><mml:math id="inf840"><mml:msup><mml:mi>L</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, so our prediction for the chance of nucleation is likely too small by many orders of magnitude, depending on the value of <inline-formula><mml:math id="inf841"><mml:mi>L</mml:mi></mml:math></inline-formula> for which the probability distribution starts to be significantly higher than the Poisson extrapolation. At this point we do not have even conjectures for the shape of this distribution, nor for how the value of <inline-formula><mml:math id="inf842"><mml:msup><mml:mi>L</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> changes with <inline-formula><mml:math id="inf843"><mml:mi>γ</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf844"><mml:mi>ρ</mml:mi></mml:math></inline-formula> or <inline-formula><mml:math id="inf845"><mml:mi>m</mml:mi></mml:math></inline-formula>. At the marginal point <inline-formula><mml:math id="inf846"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, we have the special antisymmetric model (‘Appendix 6’), and diversification becomes impossible, so near there we expect that <inline-formula><mml:math id="inf847"><mml:msup><mml:mi>L</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, along with the fragility, diverges.</p><fig id="app3fig3" position="float"><label>Appendix 3—figure 3.</label><caption><title>Distribution of community size <inline-formula><mml:math id="inf848"><mml:mi>L</mml:mi></mml:math></inline-formula> starting from a single strain, over 10<sup>5</sup> attempted invasions with <inline-formula><mml:math id="inf849"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf850"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>.</title><p>The solid line shows a Poisson fit with mean 1.6, excluding <inline-formula><mml:math id="inf851"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. This fit is remarkably good. The inset shows the trajectory of <inline-formula><mml:math id="inf852"><mml:mi>L</mml:mi></mml:math></inline-formula> as it reached its maximum value which occurred only once, followed by a crash back down.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82734-app3-fig3-v2.tif"/></fig><p>Results from ‘Appendix 3’ suggest that the nucleation process may be related to desynchronization which is necessary to enter the steadily diversifying regime. In fact we observed that decreasing the migration rate <inline-formula><mml:math id="inf853"><mml:mi>m</mml:mi></mml:math></inline-formula> increases the mean of the Poisson-like distribution of <inline-formula><mml:math id="inf854"><mml:mi>L</mml:mi></mml:math></inline-formula> in the low-diversity regime, and also reduces <inline-formula><mml:math id="inf855"><mml:msup><mml:mi>L</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> (<xref ref-type="fig" rid="app3fig2">Appendix 3—figure 2</xref>), thereby perhaps substantially increasing the probability of nucleation — although it is still too improbable to observe.</p></sec><sec sec-type="appendix" id="s11-4"><title>Scaling relationship between bias distribution and <inline-formula><mml:math id="inf856"><mml:mi>L</mml:mi></mml:math></inline-formula></title><fig id="app3fig4" position="float"><label>Appendix 3—figure 4.</label><caption><title>Scaling relationship between the effective community size, <inline-formula><mml:math id="inf857"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo>≡</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mrow></mml:math></inline-formula>, and the inverse variance of the bias distribution, <inline-formula><mml:math id="inf858"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>, for unrelated invaders with <inline-formula><mml:math id="inf859"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</title><p>The dashed line has slope 0.47. Data are pooled over 3 runs from <inline-formula><mml:math id="inf860"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> to 500 strains (inset) so that when <inline-formula><mml:math id="inf861"><mml:mi>L</mml:mi></mml:math></inline-formula> becomes large the initial conditions have been forgotten. Inset shows that <inline-formula><mml:math id="inf862"><mml:mi>L</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf863"><mml:mi mathvariant="script">L</mml:mi></mml:math></inline-formula> are proportional as expected. (The bend in <inline-formula><mml:math id="inf864"><mml:mi mathvariant="script">L</mml:mi></mml:math></inline-formula> versus <inline-formula><mml:math id="inf865"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> toward the end of the curve is likely due to stopping the simulation the first time <inline-formula><mml:math id="inf866"><mml:mi>L</mml:mi></mml:math></inline-formula> reaches 500, which truncates the curve asymmetrically.).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82734-app3-fig4-v2.tif"/></fig><p>The central scaling relationship from which our theoretical results follow is that the width of the bias distribution scales as <inline-formula><mml:math id="inf867"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>, which scales the same way as <inline-formula><mml:math id="inf868"><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi mathvariant="script">L</mml:mi></mml:msqrt></mml:mrow><mml:mo>≡</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>. In <xref ref-type="fig" rid="app3fig4">Appendix 3—figure 4</xref>, we confirm these relationships by calculating the standard deviation of the bias distribution in a diversifying community where <inline-formula><mml:math id="inf869"><mml:mi>L</mml:mi></mml:math></inline-formula> ranges over one order of magnitude. We find the the relationship holds for both <inline-formula><mml:math id="inf870"><mml:mi>L</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf871"><mml:mi mathvariant="script">L</mml:mi></mml:math></inline-formula>, which are proportional to each other with <inline-formula><mml:math id="inf872"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mn>0.74</mml:mn><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec sec-type="appendix" id="s11-5"><title>Diversifying phase with <inline-formula><mml:math id="inf873"><mml:mi>ρ</mml:mi></mml:math></inline-formula> close to 1</title><p>One of the important results of this work is that there is a continually diversifying phase of eco-evolutionary dynamics both for unrelated invaders and for small-effect mutations, across the whole range of <inline-formula><mml:math id="inf874"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. In <xref ref-type="fig" rid="app3fig5">Appendix 3—figure 5</xref>, we illustrate the robustness of this phenomenon for highly correlated parents and mutants with <inline-formula><mml:math id="inf875"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.97</mml:mn></mml:mrow></mml:math></inline-formula>, running a large number of replicate simulations and seeing that about 10% of these enter the diversifying phase, when <inline-formula><mml:math id="inf876"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula>. Although the community is less likely to nucleate into the diversifying phase than when <inline-formula><mml:math id="inf877"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf878"><mml:mi>L</mml:mi></mml:math></inline-formula> still increases linearly with attempted invasions once the community is nucleated.</p><fig id="app3fig5" position="float"><label>Appendix 3—figure 5.</label><caption><title>The diversifying phase persists for <inline-formula><mml:math id="inf879"><mml:mi>ρ</mml:mi></mml:math></inline-formula> close to 1.</title><p>Here we show 99 simulation replicates, starting from <inline-formula><mml:math id="inf880"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula>. Out of these, 11 nucleated into the diversifying phase, albeit with diversity increasing at a slower rate than with <inline-formula><mml:math id="inf881"><mml:mi>ρ</mml:mi></mml:math></inline-formula> smaller (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Simulations which crashed are shown in red while those that entered the diversifying phase are shown in blue.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82734-app3-fig5-v2.tif"/></fig></sec></sec></app><app id="appendix-4"><title>Appendix 4</title><sec sec-type="appendix" id="s12"><title>Statistics of <inline-formula><mml:math id="inf882"><mml:mi>V</mml:mi></mml:math></inline-formula> conditioned on evolution</title><p>How do the statistics of the interaction matrix <inline-formula><mml:math id="inf883"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> change when conditioned on evolutionary history? How does this compare to conditioning on non-extinction in an assembled community? We ran a set of 10 replicates without general fitness differences over a period where the community grows from 50 initial strains to <inline-formula><mml:math id="inf884"><mml:mrow><mml:mi/><mml:mo>≅</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math></inline-formula> strains, for both <inline-formula><mml:math id="inf885"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf886"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>. From these, we obtained ensembles of interaction matrices conditioned on gradual evolution with <inline-formula><mml:math id="inf887"><mml:mi>ρ</mml:mi></mml:math></inline-formula> both 0 and close to 1.</p><p>We also examined the interaction matrices of communities that evolved with a steady state <inline-formula><mml:math id="inf888"><mml:mi>L</mml:mi></mml:math></inline-formula>, by using an exponential distribution of <inline-formula><mml:math id="inf889"><mml:mi>s</mml:mi></mml:math></inline-formula> with <inline-formula><mml:math id="inf890"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.07</mml:mn></mml:mrow></mml:math></inline-formula>, starting from <inline-formula><mml:math id="inf891"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> and reaching steady state with <inline-formula><mml:math id="inf892"><mml:mrow><mml:mi>L</mml:mi><mml:mo>≅</mml:mo><mml:mn>150</mml:mn></mml:mrow></mml:math></inline-formula> while evolving over the course of <inline-formula><mml:math id="inf893"><mml:mrow><mml:mi/><mml:mo>≅</mml:mo><mml:mn>4000</mml:mn></mml:mrow></mml:math></inline-formula> successful invasions. In this case one might be more likely to see correlations building up, since new strains might not dilute the correlations building up in <inline-formula><mml:math id="inf894"><mml:mi>V</mml:mi></mml:math></inline-formula>. For comparison, we studied assembled (but not evolved) communities starting with sufficiently large <inline-formula><mml:math id="inf895"><mml:mi>K</mml:mi></mml:math></inline-formula> to have <inline-formula><mml:math id="inf896"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> similar to the evolved condition.</p><table-wrap id="app4table1" position="float"><label>Appendix 4—table 1.</label><caption><title>Definition of some statistics of the interaction matrix of a community. The standard deviation is calculated as <inline-formula><mml:math id="inf897"><mml:mrow><mml:mrow><mml:msub><mml:mi>Stdev</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>L</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>L</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> (the population standard deviation) and <inline-formula><mml:math id="inf898"><mml:mrow><mml:mi>Corr</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the Pearson correlation coefficient calculated for a sample (the covariance normalized by the product of standard deviations).</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"><inline-formula><mml:math id="inf899"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf900"><mml:mover accent="true"><mml:msub><mml:mi>σ</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf901"><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf902"><mml:mover accent="true"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula></th></tr></thead><tbody><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf903"><mml:mrow><mml:mrow><mml:mrow><mml:mi>Corr</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf904"><mml:mrow><mml:msub><mml:mi>Stdev</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf905"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf906"><mml:mrow><mml:msub><mml:mi>Stdev</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>L</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr></tbody></table></table-wrap><p>In <xref ref-type="table" rid="app4table1">Appendix 4—table 1</xref>, we list the summary statistics of the interaction matrices that we analyzed: <inline-formula><mml:math id="inf907"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> is the empirical cross-diagonal correlation in the <inline-formula><mml:math id="inf908"><mml:mi>V</mml:mi></mml:math></inline-formula> matrix of extant strains, <inline-formula><mml:math id="inf909"><mml:mover accent="true"><mml:msub><mml:mi>σ</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> is the empirical width of the interaction strength distribution after evolution, <inline-formula><mml:math id="inf910"><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> is the average of the interactions and <inline-formula><mml:math id="inf911"><mml:mover accent="true"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> is the standard deviation, over <inline-formula><mml:math id="inf912"><mml:mi>i</mml:mi></mml:math></inline-formula>, of <inline-formula><mml:math id="inf913"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>L</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, which acts like an effective <italic>s</italic><sub><italic>i</italic></sub>, crudely approximating the width of the bias distribution. Aside from <inline-formula><mml:math id="inf914"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>, all the quantities are defined including the diagonal terms in <inline-formula><mml:math id="inf915"><mml:mi>V</mml:mi></mml:math></inline-formula>.</p><table-wrap id="app4table2" position="float"><label>Appendix 4—table 2.</label><caption><title>Means (up to corrections due to diagonal entries) and standard deviations of the chosen statistics from 500 realizations of the matrix <inline-formula><mml:math id="inf916"><mml:mi>V</mml:mi></mml:math></inline-formula> from the original ensemble with <inline-formula><mml:math id="inf917"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, and two values of <inline-formula><mml:math id="inf918"><mml:mi>L</mml:mi></mml:math></inline-formula> pertaining to the different evolutionary conditions. Here we do not condition on either non-extinction or evolution.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="left" valign="bottom"><inline-formula><mml:math id="inf919"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf920"><mml:mover accent="true"><mml:msub><mml:mi>σ</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf921"><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf922"><mml:mover accent="true"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula></th></tr></thead><tbody><tr><td align="left" valign="bottom">mean (<inline-formula><mml:math id="inf923"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 500)</td><td align="char" char="." valign="bottom">−0.8</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">0.0446</td></tr><tr><td align="left" valign="bottom">standard deviation (<inline-formula><mml:math id="inf924"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 500)</td><td align="char" char="." valign="bottom">0.001</td><td align="char" char="." valign="bottom">0.002</td><td align="char" char="." valign="bottom">0.001</td><td align="char" char="." valign="bottom">0.0015</td></tr><tr><td align="left" valign="bottom">mean (<inline-formula><mml:math id="inf925"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 150)</td><td align="char" char="." valign="bottom">−0.8</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">0.0816</td></tr><tr><td align="left" valign="bottom">standard deviation (<inline-formula><mml:math id="inf926"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 150)</td><td align="char" char="." valign="bottom">0.0036</td><td align="char" char="." valign="bottom">0.006</td><td align="char" char="." valign="bottom">0.0031</td><td align="char" char="." valign="bottom">0.0046</td></tr></tbody></table></table-wrap><table-wrap id="app4table3" position="float"><label>Appendix 4—table 3.</label><caption><title>Statistics of the interaction matrix for both evolved and assembled communities. Evolved communities grew to <inline-formula><mml:math id="inf927"><mml:mrow><mml:mi/><mml:mo>≅</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math></inline-formula> strains from an initial <inline-formula><mml:math id="inf928"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> and assembled communities had <inline-formula><mml:math id="inf929"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>≅</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math></inline-formula> after a single epoch of duration <inline-formula><mml:math id="inf930"><mml:mrow><mml:mn>12</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="script">M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, both with <inline-formula><mml:math id="inf931"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. The last row is from a simulation with exponential <inline-formula><mml:math id="inf932"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf933"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.07</mml:mn></mml:mrow></mml:math></inline-formula>, which results in <inline-formula><mml:math id="inf934"><mml:mrow><mml:mi>L</mml:mi><mml:mo>≅</mml:mo><mml:mn>150</mml:mn></mml:mrow></mml:math></inline-formula> at steady state. The mean of each statistic is reported across 10 simulation replicates. In <xref ref-type="table" rid="app4table4">Appendix 4—table 4</xref> we show these statistics appropriately normalized with respect to the original <inline-formula><mml:math id="inf935"><mml:mi>V</mml:mi></mml:math></inline-formula> ensemble. Bold entries correspond to those more than 3 standard deviations away from the original ensemble mean.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="left" valign="bottom"><inline-formula><mml:math id="inf936"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf937"><mml:mover accent="true"><mml:msub><mml:mi>σ</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf938"><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf939"><mml:mover accent="true"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula></th></tr></thead><tbody><tr><td align="left" valign="bottom">assembled (<inline-formula><mml:math id="inf940"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>)</td><td align="char" char="." valign="bottom">−0.8014</td><td align="char" char="." valign="bottom">1.0012</td><td align="char" char="." valign="bottom">0.0026</td><td align="char" char="." valign="bottom"><bold>0.0337</bold></td></tr><tr><td align="left" valign="bottom">diversifying (<inline-formula><mml:math id="inf941"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf942"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>)</td><td align="char" char="." valign="bottom">−0.8015</td><td align="char" char="." valign="bottom">1.0028</td><td align="char" char="." valign="bottom"><bold>0.0061</bold></td><td align="char" char="." valign="bottom"><bold>0.0289</bold></td></tr><tr><td align="left" valign="bottom">diversifying (<inline-formula><mml:math id="inf943"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf944"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>)</td><td align="char" char="." valign="bottom"><bold>−0.8082</bold></td><td align="char" char="." valign="bottom"><bold>1.0427</bold></td><td align="char" char="." valign="bottom"><bold>0.1422</bold></td><td align="char" char="." valign="bottom"><bold>0.0328</bold></td></tr><tr><td align="left" valign="bottom">steady state (<inline-formula><mml:math id="inf945"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.07</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf946"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>)</td><td align="char" char="." valign="bottom">−0.8074</td><td align="char" char="." valign="bottom"><bold>1.0205</bold></td><td align="char" char="." valign="bottom"><bold>0.0165</bold></td><td align="char" char="." valign="bottom"><bold>0.0977</bold></td></tr></tbody></table></table-wrap><p>To check for statistical significance, we normalize each statistic of the evolved interaction matrices by the standard deviation of the estimator of the corresponding statistic from matrices drawn from the original ensemble without any conditioning. This indicates how atypical the measured statistics are for the matrices of size <inline-formula><mml:math id="inf947"><mml:mrow><mml:mi>L</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>. We thus define quantities <inline-formula><mml:math id="inf948"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math></inline-formula>, <inline-formula><mml:math id="inf949"><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf950"><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf951"><mml:mover accent="true"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math></inline-formula> to be the empirical matrix statistics measured in units of standard deviations away from their mean in the original <inline-formula><mml:math id="inf952"><mml:mi>V</mml:mi></mml:math></inline-formula> ensemble.</p><table-wrap id="app4table4" position="float"><label>Appendix 4—table 4.</label><caption><title>Properties of the interaction matrix for evolved and assembled communities, displayed in terms of number of standard deviations from the mean in the original <inline-formula><mml:math id="inf953"><mml:mi>V</mml:mi></mml:math></inline-formula> ensemble. These are the same data as in <xref ref-type="table" rid="app4table3">Appendix 4—table 3</xref>, but normalized according to appropriate scale of deviations calculated from original <inline-formula><mml:math id="inf954"><mml:mi>V</mml:mi></mml:math></inline-formula> ensemble. Numbers in boldface have magnitude greater than 3, and are thus clearly statistically significant.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="left" valign="bottom"><inline-formula><mml:math id="inf955"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf956"><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf957"><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf958"><mml:mover accent="true"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math></inline-formula></th></tr></thead><tbody><tr><td align="left" valign="bottom">assembled (<inline-formula><mml:math id="inf959"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>)</td><td align="char" char="." valign="bottom">−1.4</td><td align="char" char="." valign="bottom">0.6</td><td align="char" char="." valign="bottom">2.6</td><td align="char" char="." valign="bottom"><bold>−7.2</bold></td></tr><tr><td align="left" valign="bottom">diversifying (<inline-formula><mml:math id="inf960"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf961"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>)</td><td align="char" char="." valign="bottom">−1.5</td><td align="char" char="." valign="bottom">1.4</td><td align="char" char="." valign="bottom"><bold>6.1</bold></td><td align="char" char="." valign="bottom"><bold>−10.4</bold></td></tr><tr><td align="left" valign="bottom">diversifying (<inline-formula><mml:math id="inf962"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf963"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>)</td><td align="char" char="." valign="bottom"><bold>−8.2</bold></td><td align="char" char="." valign="bottom"><bold>21.4</bold></td><td align="char" char="." valign="bottom"><bold>142.2</bold></td><td align="char" char="." valign="bottom"><bold>−7.9</bold></td></tr><tr><td align="left" valign="bottom">steady state (<inline-formula><mml:math id="inf964"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.07</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf965"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>)</td><td align="char" char="." valign="bottom">−2.1</td><td align="char" char="." valign="bottom"><bold>3.4</bold></td><td align="char" char="." valign="bottom"><bold>5.3</bold></td><td align="char" char="." valign="bottom"><bold>3.5</bold></td></tr></tbody></table></table-wrap><p>Although a considerable number of statistics are significantly different from their original ensemble values, few incur substantial changes, with the largest change by far occurring in the <inline-formula><mml:math id="inf966"><mml:msub><mml:mi>μ</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> for the simulations with <inline-formula><mml:math id="inf967"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>; however even this is a relatively small effect.</p><p>Our results show that both evolution and assembly tend to make <inline-formula><mml:math id="inf968"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> slightly more negative than the <inline-formula><mml:math id="inf969"><mml:mi>γ</mml:mi></mml:math></inline-formula> of the original ensemble, and that these processes also favor — as might have been expected — an increasing mean interaction strength, <inline-formula><mml:math id="inf970"><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula>. Of particular interest, given previous discussion, is <inline-formula><mml:math id="inf971"><mml:mover accent="true"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>, which is similar to the width of the bias distribution. For <inline-formula><mml:math id="inf972"><mml:mrow><mml:mi>L</mml:mi><mml:mo>≅</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math></inline-formula>, the statistics of the matrices from the original ensemble have <inline-formula><mml:math id="inf973"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>≅</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mn>500</mml:mn></mml:msqrt></mml:mrow><mml:mo>≅</mml:mo><mml:mn>0.0447</mml:mn></mml:mrow></mml:math></inline-formula>. However, once we condition on assembly or evolution, the value of <inline-formula><mml:math id="inf974"><mml:mover accent="true"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> can be expected to decrease, because we eliminate those strains with negative bias, meaning that strains <inline-formula><mml:math id="inf975"><mml:mi>i</mml:mi></mml:math></inline-formula> with an anomalously small value of <inline-formula><mml:math id="inf976"><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> will go extinct, making the range of <inline-formula><mml:math id="inf977"><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> narrower. This is indeed observed in <xref ref-type="table" rid="app4table3">Appendix 4—table 3</xref>, at least for simulations without general fitness differences. Interestingly we see that <inline-formula><mml:math id="inf978"><mml:mover accent="true"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> decreases with evolution more for <inline-formula><mml:math id="inf979"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> than for <inline-formula><mml:math id="inf980"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, which could be because, in the latter case, the elements in a single row of <inline-formula><mml:math id="inf981"><mml:mi>V</mml:mi></mml:math></inline-formula> are correlated with those of a high-abundance parent, which could increase the width of the <inline-formula><mml:math id="inf982"><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> distribution. Nonetheless, we still expect that <inline-formula><mml:math id="inf983"><mml:mover accent="true"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> scales as <inline-formula><mml:math id="inf984"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula> for evolved communities.</p><p>For the evolution with <inline-formula><mml:math id="inf985"><mml:mi>L</mml:mi></mml:math></inline-formula> roughly constant from exponential <inline-formula><mml:math id="inf986"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, we see that <inline-formula><mml:math id="inf987"><mml:mover accent="true"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> after evolution is actually larger than in an unconditioned matrix. However, here the bias has an extra contribution from the general fitness, so <inline-formula><mml:math id="inf988"><mml:mover accent="true"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> is no longer as good an estimate of the bias distribution width (though it should still be similar).</p><p>We can compare these results to previous results of <xref ref-type="bibr" rid="bib7">Bunin, 2016</xref> in which he calculated the statistics of the interaction matrix conditioned on assembly in the stable fixed-point phase where niche interactions — large negative diagonal terms in <inline-formula><mml:math id="inf989"><mml:mi>V</mml:mi></mml:math></inline-formula> — stabilize the diversity instead of spatial structure. Bunin observed that, conditional on assembly, correlations between the effect of strains <inline-formula><mml:math id="inf990"><mml:mi>k</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf991"><mml:mi>l</mml:mi></mml:math></inline-formula> both on strain <inline-formula><mml:math id="inf992"><mml:mi>i</mml:mi></mml:math></inline-formula> become negative, that is <inline-formula><mml:math id="inf993"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> with small magnitude of order <inline-formula><mml:math id="inf994"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>. This is consistent with our observation that the distribution of the sum of these interactions for each strain, <inline-formula><mml:math id="inf995"><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, will have a smaller width than in the original ensemble. In addition, Bunin finds an <inline-formula><mml:math id="inf996"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> shift in the mean of the interaction matrix toward less competition, which is consistent with <inline-formula><mml:math id="inf997"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. We also see slight but systematic changes in <inline-formula><mml:math id="inf998"><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf999"><mml:mover accent="true"><mml:msub><mml:mi>σ</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>, particularly in the case of evolution of correlated mutants with <inline-formula><mml:math id="inf1000"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>Although many of the changes of the interaction statistics of assembled or evolved communities are statistically significant, they are mostly very small, with the possible exception of <inline-formula><mml:math id="inf1001"><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> for <inline-formula><mml:math id="inf1002"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>. We conjecture that for <inline-formula><mml:math id="inf1003"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> all the effects are small by some power of <inline-formula><mml:math id="inf1004"><mml:mi>L</mml:mi></mml:math></inline-formula>. But for <inline-formula><mml:math id="inf1005"><mml:mi>ρ</mml:mi></mml:math></inline-formula> near one, this is less clear: whether for <inline-formula><mml:math id="inf1006"><mml:mi>L</mml:mi></mml:math></inline-formula> large compared to some inverse power of <inline-formula><mml:math id="inf1007"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:math></inline-formula>, the correlations induced by evolution will still be small, or whether the correlations will persist for arbitrarily large <inline-formula><mml:math id="inf1008"><mml:mi>L</mml:mi></mml:math></inline-formula>, we leave as an open question.</p></sec></app><app id="appendix-5"><title>Appendix 5</title><sec sec-type="appendix" id="s13"><title>Dynamical mean field theory</title><p>In this section we provide some more background on the dynamical mean field theory used as a basis for the heuristics and scaling arguments throughout the paper. The main idea of dynamical mean field theory is to reduce an interacting many-body problem into a single-body stochastic problem, with the statistics of the stochasticity to be determined self consistently. As discussed in PAF, a dynamical mean field theory analysis of <xref ref-type="disp-formula" rid="equ1">Equation 1</xref> results in autonomous stochastic integro-differential equations for each strain independently. Since the strains are statistically equivalent on each island, we drop the island subscript:<disp-formula id="equ15"><label>(A5.1)</label><mml:math id="m15"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:msup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Here, the correlation function <inline-formula><mml:math id="inf1009"><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of <inline-formula><mml:math id="inf1010"><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the response function <inline-formula><mml:math id="inf1011"><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and the island-averaged abundance <inline-formula><mml:math id="inf1012"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, must be determined self-consistently. In order to use this description for the evolved (in addition to assembled) communities we have assumed that the statistics of the <inline-formula><mml:math id="inf1013"><mml:mi>V</mml:mi></mml:math></inline-formula> do not change substantially in evolved communities: we show in ‘Appendix 4’ that our simulation results are consistent with this <italic>Ansatz</italic>. Here, we have made the time-dependence in <inline-formula><mml:math id="inf1014"><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> explicit — but elsewhere in the paper when we refer to the time-averaged or mean drive <inline-formula><mml:math id="inf1015"><mml:msub><mml:mover accent="true"><mml:mi>ζ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, we have dropped the overbar for readability.</p><p>In ecological steady state, some of the strains will have gone extinct, and the correlations and responses of the persistent strains will only depend on time differences <inline-formula><mml:math id="inf1016"><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, and quantities will have well-behaved time averages equal to island averages, denoted by overbars. The average growth rate of strain <inline-formula><mml:math id="inf1017"><mml:mi>i</mml:mi></mml:math></inline-formula> on a single island excluding migration is<disp-formula id="equ16"><label>(A5.2)</label><mml:math id="m16"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mi>X</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mi>X</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the static susceptibility, <inline-formula><mml:math id="inf1018"><mml:mi>X</mml:mi></mml:math></inline-formula>, is the time-integrated total response function <inline-formula><mml:math id="inf1019"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>χ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Here, we define the individual strain static susceptibility as <inline-formula><mml:math id="inf1020"><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≡</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. In steady state with migration, <inline-formula><mml:math id="inf1021"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>; therefore <inline-formula><mml:math id="inf1022"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> must be exactly compensated by the average effect of the migration term <inline-formula><mml:math id="inf1023"><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which is always positive (by the Cauchy-Schwarz inequality) and can be much larger than <inline-formula><mml:math id="inf1024"><mml:mi>m</mml:mi></mml:math></inline-formula> when <inline-formula><mml:math id="inf1025"><mml:msub><mml:mi>ν</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is small.</p><p>The stochastic DMFT equations cannot be reduced to equations for the correlation and response function and must be treated directly. Their self-consistent solutions in the STC phase were analyzed in our previous work [PAF], by asymptotics in the large parameter <inline-formula><mml:math id="inf1026"><mml:mi mathvariant="script">M</mml:mi></mml:math></inline-formula>. This analysis yields super-diffusive random walks of the log-abundances, persistence around the migration floor, and the statistics of the occasional blooms that occur for all persistent strains with negative bias. These aspects together determine how the mean abundance of a strain depends on its bias, via <inline-formula><mml:math id="inf1027"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> with corrections smaller by factors of <inline-formula><mml:math id="inf1028"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>When the bias of a strain is positive the average input from migration will be relatively small, and hence <inline-formula><mml:math id="inf1029"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> which implies that <inline-formula><mml:math id="inf1030"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. For strains with negative bias, the migration is essential and the statistics of the blooms, which are rarer the more negative the bias, make <inline-formula><mml:math id="inf1031"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> exponentially small in <inline-formula><mml:math id="inf1032"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> [PAF]. For strains with more negative bias, <inline-formula><mml:math id="inf1033"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, the migration cannot sustain their local populations and they go globally extinct with their spatially averaged frequency decaying exponentially in time.</p><p>The distribution of the biases of a community plays a crucial role in determining its response to invasions. In a randomly assembled community of unrelated strains, the biases are essentially independent up to corrections smaller by <inline-formula><mml:math id="inf1034"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, with the mean drives, <inline-formula><mml:math id="inf1035"><mml:msub><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, gaussian distributed with average zero and standard deviation of order <inline-formula><mml:math id="inf1036"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>. More precisely, since <inline-formula><mml:math id="inf1037"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is determined by the community in the absence of <inline-formula><mml:math id="inf1038"><mml:mi>i</mml:mi></mml:math></inline-formula>, the <inline-formula><mml:math id="inf1039"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> that determine it are independent of the abundances in the community. The variance of <inline-formula><mml:math id="inf1040"><mml:mi>ζ</mml:mi></mml:math></inline-formula> is <inline-formula><mml:math id="inf1041"><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mo>≡</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> (with only small corrections from the neglect of the strain itself): this simple result is explicit in the self-consistency condition of the DMFT correlation function. We therefore use <inline-formula><mml:math id="inf1042"><mml:mi mathvariant="script">L</mml:mi></mml:math></inline-formula> as a measure of the <italic>effective size</italic> of a community which weights the contributions of strains by their mean abundances and, unlike <inline-formula><mml:math id="inf1043"><mml:mi>L</mml:mi></mml:math></inline-formula>, is insensitive to whether the close to marginal strains have or have not gone extinct. The distribution of the biases of the persistent strains in the randomly assembled community is a truncated gaussian with lower limit <inline-formula><mml:math id="inf1044"><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula>, which is of order <inline-formula><mml:math id="inf1045"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi mathvariant="script">L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula> — the magnitude of <inline-formula><mml:math id="inf1046"><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf1047"><mml:mi mathvariant="script">L</mml:mi></mml:math></inline-formula> must be determined self-consistently. Crucially, these will depend on the dynamics — especially the blooms — not just the mean quantities.</p></sec></app><app id="appendix-6"><title>Appendix 6</title><sec sec-type="appendix" id="s14"><title>Analysis of general fitnesses</title><sec sec-type="appendix" id="s14-1"><title>Number of persistent strains with exponential <inline-formula><mml:math id="inf1048"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> in perfectly antisymmetric model</title><p>The antisymmetric model with <inline-formula><mml:math id="inf1049"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and no migration (considering only a single island) provides a situation in which we can calculate various quantities analytically and anchor the DMFT analysis. As analyzed in PAF, there is a unique uninvadable fixed point characterized by abundances <inline-formula><mml:math id="inf1050"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> with half the strains having gone extinct, and this fixed point is marginally stable. Indeed, there is a family of chaotic steady states, parametrized a temperature-like quantity <inline-formula><mml:math id="inf1051"><mml:mi mathvariant="normal">Θ</mml:mi></mml:math></inline-formula> which is roughly the range of the fluctuations in <inline-formula><mml:math id="inf1052"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, with the average abundances <inline-formula><mml:math id="inf1053"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p><p>Here we analyze the effect of introducing independent exponentially distributed <inline-formula><mml:math id="inf1054"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> for each strain, and find the number of strains that persist at the fixed point. Since there is no migration, the relationship between the biases and abundances is especially simple, as detailed below. The critical bias is <inline-formula><mml:math id="inf1055"><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and the mean <inline-formula><mml:math id="inf1056"><mml:mi>s</mml:mi></mml:math></inline-formula> is simply <inline-formula><mml:math id="inf1057"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>. In the limit <inline-formula><mml:math id="inf1058"><mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>≫</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, the distribution of the drives with scale <inline-formula><mml:math id="inf1059"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>K</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula> will be much narrower than that of the <inline-formula><mml:math id="inf1060"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Let us define <inline-formula><mml:math id="inf1061"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≡</mml:mo><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> for convenience. The scale of <inline-formula><mml:math id="inf1062"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the <italic>x</italic><sub><italic>i</italic></sub> distribution, will be <inline-formula><mml:math id="inf1063"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula> and it will decay exponentially for large <inline-formula><mml:math id="inf1064"><mml:mi>x</mml:mi></mml:math></inline-formula>. We can get the distribution of <inline-formula><mml:math id="inf1065"><mml:mi>x</mml:mi></mml:math></inline-formula> from the convolution of an exponential and gaussian distribution, with the drives having variance <inline-formula><mml:math id="inf1066"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>ζ</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>:<disp-formula id="equ17"><label>(A6.1)</label><mml:math id="m17"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mi mathvariant="normal">Σ</mml:mi></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mrow><mml:mtext> for </mml:mtext><mml:mrow><mml:mi>x</mml:mi><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">Σ</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>With the Lagrange multiplier <inline-formula><mml:math id="inf1067"><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula>, the average abundances <inline-formula><mml:math id="inf1068"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> at the mean field fixed point will be <inline-formula><mml:math id="inf1069"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mi>X</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="inf1070"><mml:mi>X</mml:mi></mml:math></inline-formula> the total static susceptibility given by <inline-formula><mml:math id="inf1071"><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>χ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Let us define <inline-formula><mml:math id="inf1072"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> as the fraction of strains that persists with positive bias. When <inline-formula><mml:math id="inf1073"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, we can make the approximation<disp-formula id="equ18"><label>(A6.2)</label><mml:math id="m18"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msubsup><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>≈</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Self consistency requires that the average abundance over the initial <inline-formula><mml:math id="inf1074"><mml:mi>K</mml:mi></mml:math></inline-formula> strains is<disp-formula id="equ19"><label>(A6.3)</label><mml:math id="m19"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mi>X</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac><mml:mspace width="thickmathspace"/><mml:mo stretchy="false">⟹</mml:mo><mml:mspace width="thickmathspace"/><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mfrac><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>X</mml:mi></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:msup><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac><mml:mspace width="thickmathspace"/><mml:mo stretchy="false">⟹</mml:mo><mml:mspace width="thickmathspace"/><mml:mfrac><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>X</mml:mi></mml:mfrac><mml:mi>ϕ</mml:mi><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Now we combine this relation with the self consistency condition<disp-formula id="equ20"><label>(A6.4)</label><mml:math id="m20"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>K</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mi>X</mml:mi></mml:mfrac><mml:mspace width="thickmathspace"/><mml:mo stretchy="false">⟹</mml:mo><mml:mspace width="thickmathspace"/><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mi>K</mml:mi><mml:mi>ϕ</mml:mi></mml:msqrt><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>to obtain <inline-formula><mml:math id="inf1075"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>K</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. Therefore, the number of persistent strains, when <inline-formula><mml:math id="inf1076"><mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>≫</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> is <inline-formula><mml:math id="inf1077"><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, with coefficient one.</p><p>To obtain the behavior for arbitrary <inline-formula><mml:math id="inf1078"><mml:mi>K</mml:mi></mml:math></inline-formula>, one must solve the mean field self consistency equations, with the exact distribution<disp-formula id="equ21"><label>(A6.5)</label><mml:math id="m21"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi mathvariant="normal">Σ</mml:mi></mml:mfrac><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>x</mml:mi><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf1079"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula> is the standard normal cumulative distribution function. There are three mean field equations for the three unknowns <inline-formula><mml:math id="inf1080"><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula>, <inline-formula><mml:math id="inf1081"><mml:msub><mml:mi>σ</mml:mi><mml:mi>ζ</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf1082"><mml:mi>X</mml:mi></mml:math></inline-formula>.<disp-formula id="equ22"><label>(A6.6)</label><mml:math id="m22"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mi>X</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ23"><label>(A6.7)</label><mml:math id="m23"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>K</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mi>X</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ24"><label>(A6.8)</label><mml:math id="m24"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>K</mml:mi><mml:mi>X</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msubsup><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The number of persistent strains is <inline-formula><mml:math id="inf1083"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msubsup><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf1084"><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> solves the above equations. Since for perfectly antisymmetric interactions, <inline-formula><mml:math id="inf1085"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, the solution of these allows us to check that <inline-formula><mml:math id="inf1086"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:math></inline-formula> increases with <inline-formula><mml:math id="inf1087"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula>, as seen in <xref ref-type="fig" rid="fig3">Figure 3</xref>. Though one could solve the mean field equations numerically, we can obtain asymptotic results using the approximation in <xref ref-type="disp-formula" rid="equ17">Equation A6.1</xref>.</p><p>For <inline-formula><mml:math id="inf1088"><mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>≫</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, we have <inline-formula><mml:math id="inf1089"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>≈</mml:mo><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1090"><mml:mrow><mml:mi>X</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf1091"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>ζ</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, which is consistent with the asymptotic <italic>Ansatz</italic> for <inline-formula><mml:math id="inf1092"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for the present strains: since <inline-formula><mml:math id="inf1093"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>ζ</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:mrow><mml:mo>≫</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>ζ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> all persistent strains have large enough <inline-formula><mml:math id="inf1094"><mml:mi>x</mml:mi></mml:math></inline-formula> for the approximation to be valid. Then the distribution of <inline-formula><mml:math id="inf1095"><mml:mi>ζ</mml:mi></mml:math></inline-formula> for the <italic>persistent</italic> strains is<disp-formula id="equ25"><label>(A6.9)</label><mml:math id="m25"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ζ</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext>persistent</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msqrt><mml:mi>π</mml:mi></mml:msqrt><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>ζ</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>valid except for <inline-formula><mml:math id="inf1096"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>&gt;</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> which is a negligible fraction of the distribution. The width of both the <inline-formula><mml:math id="inf1097"><mml:mi>ζ</mml:mi></mml:math></inline-formula> and the <inline-formula><mml:math id="inf1098"><mml:mi>s</mml:mi></mml:math></inline-formula> distributions for the persistent strains is of order <inline-formula><mml:math id="inf1099"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula>. As expected more generally, these are comparable once <inline-formula><mml:math id="inf1100"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> is in the tail of <inline-formula><mml:math id="inf1101"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. This calculation could be done for any choice of <inline-formula><mml:math id="inf1102"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, and should give the behavior of <inline-formula><mml:math id="inf1103"><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> with <inline-formula><mml:math id="inf1104"><mml:mi>K</mml:mi></mml:math></inline-formula>, which is the same as the behavior of <inline-formula><mml:math id="inf1105"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> with <inline-formula><mml:math id="inf1106"><mml:mi>T</mml:mi></mml:math></inline-formula> in the evolving phase of the STC: namely <inline-formula><mml:math id="inf1107"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec sec-type="appendix" id="s14-2"><title>Joint distribution of <inline-formula><mml:math id="inf1108"><mml:mi>ζ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf1109"><mml:mi>s</mml:mi></mml:math></inline-formula> of successful invaders</title><p>Here, the statistical properties of uncorrelated invaders, needed to understand the evolution of the STC state, are analyzed. Every successful invader <inline-formula><mml:math id="inf1110"><mml:mi>A</mml:mi></mml:math></inline-formula> must have <inline-formula><mml:math id="inf1111"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Since the invader’s bias is a sum of <inline-formula><mml:math id="inf1112"><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf1113"><mml:msub><mml:mi>ζ</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf1114"><mml:mrow><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, we can calculate the distributions of <inline-formula><mml:math id="inf1115"><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf1116"><mml:msub><mml:mi>ζ</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula> conditional on invasion.</p><p>We analyze the case with an exponential distribution of the <inline-formula><mml:math id="inf1117"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> with scale <inline-formula><mml:math id="inf1118"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula>. Since the distribution of the invader <inline-formula><mml:math id="inf1119"><mml:msub><mml:mi>ζ</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf1120"><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula> are independent, we can write their joint distribution as<disp-formula id="equ26"><label>(A6.10)</label><mml:math id="m26"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi mathvariant="normal">Σ</mml:mi></mml:mfrac><mml:msqrt><mml:mfrac><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac></mml:msqrt><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">Σ</mml:mi></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Conditioning on successful invasion multiplies by a factor of <inline-formula><mml:math id="inf1121"><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which enforces that <inline-formula><mml:math id="inf1122"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. We are interested in the large time limit when <inline-formula><mml:math id="inf1123"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≫</mml:mo><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. In this limit, the restriction that <inline-formula><mml:math id="inf1124"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> has negligible effect and the analysis is simple.</p><p>The invasion probability is<disp-formula id="equ27"><label>(A6.11)</label><mml:math id="m27"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mtext>invade</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msubsup><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which decays exponentially as <inline-formula><mml:math id="inf1125"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula>, as expected. The marginal distribution of <inline-formula><mml:math id="inf1126"><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula> conditioned on invasion is<disp-formula id="equ28"><label>(A6.12)</label><mml:math id="m28"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mtext>invade</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msqrt><mml:mi mathvariant="script">L</mml:mi></mml:msqrt><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf1127"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula> is the standard normal cdf. Similarly, the distribution of <inline-formula><mml:math id="inf1128"><mml:msub><mml:mi>ζ</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula> conditioned on invasion is<disp-formula id="equ29"><label>(A6.13)</label><mml:math id="m29"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mtext>invade</mml:mtext></mml:mrow></mml:msub></mml:mfrac><mml:msqrt><mml:mfrac><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac></mml:msqrt><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">Σ</mml:mi></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>and the bias distribution conditioned on invasion is<disp-formula id="equ30"><label>(A6.14)</label><mml:math id="m30"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi mathvariant="normal">Σ</mml:mi></mml:mfrac><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mfrac><mml:mo>]</mml:mo></mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Of particular interest is the mean <inline-formula><mml:math id="inf1129"><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula>:<disp-formula id="equ31"><label>(A6.15)</label><mml:math id="m31"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow></mml:mrow></mml:mfrac><mml:mo>≈</mml:mo><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>since <inline-formula><mml:math id="inf1130"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>invasion</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf1131"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>invasion</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec sec-type="appendix" id="s14-3"><title>Effects of shape of tail of general fitness distribution</title><p>Here, we analyze the evolutionary dynamics for the class of general-fitness distributions with high-<inline-formula><mml:math id="inf1132"><mml:mi>s</mml:mi></mml:math></inline-formula> tails parametrized by <inline-formula><mml:math id="inf1133"><mml:mi>ψ</mml:mi></mml:math></inline-formula>, and show support from numerical simulations for the scaling <italic>Ansatz</italic> and results given in the main text.</p><p>For attempted invasions by unrelated strains, as the evolution progresses, <inline-formula><mml:math id="inf1134"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> increases past <inline-formula><mml:math id="inf1135"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula> and pushes up into the tail of <inline-formula><mml:math id="inf1136"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. The rate of successful invasions then decreases rapidly since invaders need general fitness (at least) comparable to <inline-formula><mml:math id="inf1137"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> in order to invade: the probability of successful invasion is of order <inline-formula><mml:math id="inf1138"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mtext>invade</mml:mtext></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> with the prefactor from the width of the distribution of <inline-formula><mml:math id="inf1139"><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula> near <inline-formula><mml:math id="inf1140"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>. In this regime, the analysis of ‘Appendix 6’ can be carried over with <inline-formula><mml:math id="inf1141"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula> replaced by <inline-formula><mml:math id="inf1142"><mml:mover accent="true"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>. The drive on the invader from the extant community, <inline-formula><mml:math id="inf1143"><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:mrow></mml:math></inline-formula>, will be of order <inline-formula><mml:math id="inf1144"><mml:mover accent="true"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>, yielding the key scaling prediction <inline-formula><mml:math id="inf1145"><mml:mrow><mml:mi>L</mml:mi><mml:mo>∼</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> which is tested in <xref ref-type="fig" rid="app6fig1">Appendix 6—figure 1A</xref>.</p><fig id="app6fig1" position="float"><label>Appendix 6—figure 1.</label><caption><title>Consistency of predicted scaling <italic>Ansatz</italic> with simulations.</title><p>(<bold>A</bold>) The combination <inline-formula><mml:math id="inf1146"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> is predicted to approach a constant independent of <inline-formula><mml:math id="inf1147"><mml:mi>ψ</mml:mi></mml:math></inline-formula> for long evolutionary times. Solid lines indicate the mean value and shaded regions indicate standard error over 50 replicates, conditional on the diversity not crashing. The curves for <inline-formula><mml:math id="inf1148"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula> are shown individually as this value of <inline-formula><mml:math id="inf1149"><mml:mi>ψ</mml:mi></mml:math></inline-formula> results in crashing and the fluctuations are large. The dashed horizontal line is at 0.7, the value found for <inline-formula><mml:math id="inf1150"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> from the data of <xref ref-type="fig" rid="fig3">Figure 3A</xref>. Note that for <inline-formula><mml:math id="inf1151"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, transients are still substantial. (<bold>B</bold>) Theory predicts that <inline-formula><mml:math id="inf1152"><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula> scales as <inline-formula><mml:math id="inf1153"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>. The dashed line has slope 1/9 with evolutionary time increasing along the direction of the arrow. Data for <inline-formula><mml:math id="inf1154"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula> are quite noisy and not shown. Here the curves are smoothed by a moving average over 1000 successful invasions for both <inline-formula><mml:math id="inf1155"><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf1156"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, and further averaged over 50 replicates conditional on not crashing. Transients from the initial conditions are observable at the upper right.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82734-app6-fig1-v2.tif"/></fig><p>Successful invaders will have <inline-formula><mml:math id="inf1157"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, since <inline-formula><mml:math id="inf1158"><mml:mover accent="true"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> is the typical amount by which the invader’s general fitness is likely to be larger (or smaller) than the <inline-formula><mml:math id="inf1159"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> of the extant community. Therefore, we expect that the change in the community-mean <inline-formula><mml:math id="inf1160"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> per successful invasion will be <inline-formula><mml:math id="inf1161"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> (obtainable from ‘Appendix 6’): this scaling is tested in <xref ref-type="fig" rid="app6fig1">Appendix 6—figure 1B</xref>. Substituting for <inline-formula><mml:math id="inf1162"><mml:mrow><mml:mi>L</mml:mi><mml:mo>∼</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, we have <inline-formula><mml:math id="inf1163"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow><mml:mo>∼</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>. Integrating this equation and using <inline-formula><mml:math id="inf1164"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>ψ</mml:mi></mml:msup><mml:mo>/</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> one obtains scaling laws quoted in the main text, valid for <inline-formula><mml:math id="inf1165"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>≫</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf1166"><mml:mrow><mml:mi>L</mml:mi><mml:mo>∼</mml:mo><mml:msup><mml:mi>Z</mml:mi><mml:mfrac><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>ψ</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mi>ψ</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:msup></mml:mrow></mml:math></inline-formula> with the latter exponent less than one for the relevant range of <inline-formula><mml:math id="inf1167"><mml:mi>ψ</mml:mi></mml:math></inline-formula>.</p><p>For <inline-formula><mml:math id="inf1168"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, both <inline-formula><mml:math id="inf1169"><mml:mi>L</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf1170"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> increase sub-linearly with <inline-formula><mml:math id="inf1171"><mml:mi>Z</mml:mi></mml:math></inline-formula>, but <inline-formula><mml:math id="inf1172"><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula> decreases steadily with <inline-formula><mml:math id="inf1173"><mml:mi>Z</mml:mi></mml:math></inline-formula> since the evolution gets closer to an average of one extinction per successful invasion, which obtains exactly in the steady state for the exponential distribution. By contrast, for <inline-formula><mml:math id="inf1174"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf1175"><mml:mi>L</mml:mi></mml:math></inline-formula> decreases with <inline-formula><mml:math id="inf1176"><mml:mi>Z</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf1177"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> increases super-linearly with <inline-formula><mml:math id="inf1178"><mml:mi>Z</mml:mi></mml:math></inline-formula>, as the distribution does not decay fast enough to prevent increasingly fit mutants from emerging and outcompeting more than one strain per successful invasion.</p><p>The behaviors of the scaling combination <inline-formula><mml:math id="inf1179"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> is shown versus <inline-formula><mml:math id="inf1180"><mml:mi>Z</mml:mi></mml:math></inline-formula> in <xref ref-type="fig" rid="app6fig1">Appendix 6—figure 1A</xref>. this combination is predicted to approach a <inline-formula><mml:math id="inf1181"><mml:mi>ψ</mml:mi></mml:math></inline-formula>-independent constant for large <inline-formula><mml:math id="inf1182"><mml:mi>Z</mml:mi></mml:math></inline-formula>. The value of this constant is consistent with the 0.7 found for <inline-formula><mml:math id="inf1183"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> in <xref ref-type="fig" rid="fig3">Figure 3A</xref>. The other key scaling law, <inline-formula><mml:math id="inf1184"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, is tested in <xref ref-type="fig" rid="app6fig1">Appendix 6—figure 1B</xref>, with the predicted coefficient of <inline-formula><mml:math id="inf1185"><mml:mrow><mml:mi/><mml:mo>≅</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> from <xref ref-type="fig" rid="fig3">Figure 3</xref>. Although these show convincing evidence for the predicted asymptotic scaling forms, much of the observed evolution is not yet in the late-time asymptotic regime.</p><p>To get the growth of <inline-formula><mml:math id="inf1186"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> — and hence the other quantities — with the number of attempted invasions, we write; <inline-formula><mml:math id="inf1187"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>invade</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and integrate this using the scaling relations to get<disp-formula id="equ32"> <label>(A6.16)</label><mml:math id="m32"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mfrac><mml:mo>≈</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>ψ</mml:mi><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>ψ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>ψ</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>with the unknown <inline-formula><mml:math id="inf1188"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> correction reflecting an additive uncertainty of order <inline-formula><mml:math id="inf1189"><mml:mover accent="true"><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> in <inline-formula><mml:math id="inf1190"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>. Up to this correction, the expression has an identical <italic>form</italic> to the upper limit from <inline-formula><mml:math id="inf1191"><mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>invade</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>≥</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> as explained in the main text, and quoted there without the <inline-formula><mml:math id="inf1192"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>log</mml:mi></mml:mrow></mml:math></inline-formula> correction (which vanishes for <inline-formula><mml:math id="inf1193"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>). This prediction, with <inline-formula><mml:math id="inf1194"><mml:mi>T</mml:mi></mml:math></inline-formula> replaced by <inline-formula><mml:math id="inf1195"><mml:mrow><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula> (without the <inline-formula><mml:math id="inf1196"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>log</mml:mi></mml:mrow></mml:math></inline-formula> part or the <inline-formula><mml:math id="inf1197"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> correction), is plotted in <xref ref-type="fig" rid="fig6">Figure 6B</xref>. Slow crossovers from the initial non-universal behavior towards the predicted behaviors are observable with the asymptotic predictions thus not well-testable in the time-dependences.</p></sec></sec></app><app id="appendix-7"><title>Appendix 7</title><sec sec-type="appendix" id="s15"><title>Correlated general fitness mutations</title><p>We have shown that including general fitnesses with <inline-formula><mml:math id="inf1198"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> causes evolution with unrelated invaders to slow down, with <inline-formula><mml:math id="inf1199"><mml:mi>Z</mml:mi></mml:math></inline-formula> increasing only as power of <inline-formula><mml:math id="inf1200"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>. Here we analyze what happens if the general fitnesses of mutants are correlated with those of their parent. In order to generate such mutant general fitnesses that are still drawn from the overall <inline-formula><mml:math id="inf1201"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, we can take the mutant fitness to be sampled from a Markov chain starting at the parent, with stationary measure given by <inline-formula><mml:math id="inf1202"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, and a “time” between samples that depends on the desired correlation between mutant and parent fitnesses.</p><sec sec-type="appendix" id="s15-1"><title>Exponential distribution of <inline-formula><mml:math id="inf1203"><mml:mi>s</mml:mi></mml:math></inline-formula></title><p>The case of exponential <inline-formula><mml:math id="inf1204"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is simple: one can choose the mutant fitness to be gaussian distributed with mean given by the parent’s general fitness minus a constant offset which can be tuned so that the stationary distribution is exponential with the desired <inline-formula><mml:math id="inf1205"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula>. The variance of the gaussian determines the degree to which the parent and mutant are correlated, parametrized by <inline-formula><mml:math id="inf1206"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula>, which need not be the same <inline-formula><mml:math id="inf1207"><mml:mi>ρ</mml:mi></mml:math></inline-formula> defined by the correlations between parent and mutant interactions. The crucial difference from uncorrelated <inline-formula><mml:math id="inf1208"><mml:mi>s</mml:mi></mml:math></inline-formula> is that the probability of <inline-formula><mml:math id="inf1209"><mml:mrow><mml:mi>s</mml:mi><mml:mo>≳</mml:mo><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is now independent of <inline-formula><mml:math id="inf1210"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> rather than decreasing exponentially with <inline-formula><mml:math id="inf1211"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:math></inline-formula>. This enables <inline-formula><mml:math id="inf1212"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf1213"><mml:mi>Z</mml:mi></mml:math></inline-formula> to increase linearly in <inline-formula><mml:math id="inf1214"><mml:mi>T</mml:mi></mml:math></inline-formula>. However, <inline-formula><mml:math id="inf1215"><mml:mi>L</mml:mi></mml:math></inline-formula> still saturates to a value of order <inline-formula><mml:math id="inf1216"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, with a coefficient that depends on the correlations. <xref ref-type="fig" rid="app7fig1">Appendix 7—figure 1</xref> shows simulations that confirm these predictions.</p><fig id="app7fig1" position="float"><label>Appendix 7—figure 1.</label><caption><title>Simulation results for correlated mutants with an exponential <inline-formula><mml:math id="inf1217"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>.</title><p>The primary difference from the independent-invaders case (<xref ref-type="fig" rid="fig3">Figure 3</xref>) is that the number of successful invasions is proportional to the number of attempted invasions, since a mutant <inline-formula><mml:math id="inf1218"><mml:mi>s</mml:mi></mml:math></inline-formula> is correlated with that of its parent, so invasions do not slow down with increasing <inline-formula><mml:math id="inf1219"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>. Here <inline-formula><mml:math id="inf1220"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula> for the interactions and for the general fitnesses the correlation is <inline-formula><mml:math id="inf1221"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula>. Note that for the same <inline-formula><mml:math id="inf1222"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula> with unrelated invaders (<inline-formula><mml:math id="inf1223"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf1224"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) the steady state values of <inline-formula><mml:math id="inf1225"><mml:mi>L</mml:mi></mml:math></inline-formula> are quite similar to those shown here.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82734-app7-fig1-v2.tif"/></fig></sec><sec sec-type="appendix" id="s15-2"><title>Non-exponential <inline-formula><mml:math id="inf1226"><mml:mi>s</mml:mi></mml:math></inline-formula> distributions with correlated mutants</title><p>Incorporating correlations in the general fitnesses of parent and mutant for other distributions of <inline-formula><mml:math id="inf1227"><mml:mi>s</mml:mi></mml:math></inline-formula> gives rise to other complications. In the <inline-formula><mml:math id="inf1228"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> case of particular interest, as <inline-formula><mml:math id="inf1229"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> grows the mean <inline-formula><mml:math id="inf1230"><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> of mutants becomes more and more negative and overwhelms the random part of <inline-formula><mml:math id="inf1231"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. There is a then a scale of <inline-formula><mml:math id="inf1232"><mml:mi>s</mml:mi></mml:math></inline-formula> that diverges as <inline-formula><mml:math id="inf1233"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, such that for <inline-formula><mml:math id="inf1234"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> above this scale, successful invasions become very unlikely and the diversification slows down even with strongly correlated mutants. This gives rise to complicated crossovers that we do not fully understand and are hard to disentangle in the simulations.</p></sec></sec></app><app id="appendix-8"><title>Appendix 8</title><sec sec-type="appendix" id="s16"><title>Dynamics of drive distribution</title><sec sec-type="appendix" id="s16-1"><title>Markov approximation</title><p>In ‘Evolution without general fitness differences’, we describe how the serial invasion of strains causes the biases of extant strains to undergo a random walk with an absorbing boundary condition. In general the statistics of this random walk are complicated and depend on the conditioning on evolutionary history. In order to make analytical progress, we make a Markov approximation of the effects of the evolutionary history and assume that the distribution of the biases at epoch <inline-formula><mml:math id="inf1235"><mml:mrow><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> only depends on itself at epoch <inline-formula><mml:math id="inf1236"><mml:mi>T</mml:mi></mml:math></inline-formula>. The average drive of probe strain 0 before the successful addition of strain <inline-formula><mml:math id="inf1237"><mml:mi>A</mml:mi></mml:math></inline-formula> is <inline-formula><mml:math id="inf1238"><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, while after the invasion it changes to<disp-formula id="equ33"><label>(A8.1)</label><mml:math id="m33"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>ζ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∖</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf1239"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula> is the mean abundance at which strain <inline-formula><mml:math id="inf1240"><mml:mi>A</mml:mi></mml:math></inline-formula> establishes and <inline-formula><mml:math id="inf1241"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>∖</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the average abundance of strain <inline-formula><mml:math id="inf1242"><mml:mi>j</mml:mi></mml:math></inline-formula> before <inline-formula><mml:math id="inf1243"><mml:mi>A</mml:mi></mml:math></inline-formula> invades. The sum on <inline-formula><mml:math id="inf1244"><mml:mi>j</mml:mi></mml:math></inline-formula> does not include 0 or <inline-formula><mml:math id="inf1245"><mml:mi>A</mml:mi></mml:math></inline-formula> and the <inline-formula><mml:math id="inf1246"><mml:mi>δ</mml:mi></mml:math></inline-formula>’s denote changes that result from the invasion. Since <inline-formula><mml:math id="inf1247"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula> is of order <inline-formula><mml:math id="inf1248"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, its <italic>direct</italic> effect on the drive is smaller than <inline-formula><mml:math id="inf1249"><mml:msub><mml:mi>ζ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> by a factor of <inline-formula><mml:math id="inf1250"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>. However <inline-formula><mml:math id="inf1251"><mml:mi>A</mml:mi></mml:math></inline-formula> will also change all of the other biases by similar-magnitude random amounts with uncorrelated signs, causing <inline-formula><mml:math id="inf1252"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. Thus <inline-formula><mml:math id="inf1253"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> with the expectation over the interactions with the probe strain. Since the properties of the extant strains depend neither on the <inline-formula><mml:math id="inf1254"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> nor the perturbations via <inline-formula><mml:math id="inf1255"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, the averages over each of the squared factors can be performed separately, leaving <inline-formula><mml:math id="inf1256"><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> times the average over <inline-formula><mml:math id="inf1257"><mml:mi>j</mml:mi></mml:math></inline-formula> of <inline-formula><mml:math id="inf1258"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>. But now we can consider each strain separately to be the probe strain so that the average over the extant strains must be the same on both sides. This yields <inline-formula><mml:math id="inf1259"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">E</mml:mi><mml:mtext>strains</mml:mtext></mml:msub><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. The more directly measurable quantity is the total squared abundance change of the extant strains caused by a random change in growth rate of each. With the perturbation caused by the invader, we have <inline-formula><mml:math id="inf1260"><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Ξ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> in terms of the nonlinear response, which we call the <italic>fragility</italic>: <inline-formula><mml:math id="inf1261"><mml:mrow><mml:mi mathvariant="normal">Ξ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. This quantity is analogous to the spin-glass susceptibility of random magnets <xref ref-type="bibr" rid="bib18">Fisher and Huse, 1988</xref>. The fragility is of order unity and the form of the denominator shows that it can diverge: such divergence indicates an instability of the community and breakdown of the DMFT <italic>Ansatz</italic>. Note that the fragility is a general measure of the sensitivity of a community to perturbations. In the stable niche-phase of the Lotka Volterra model with large negative diagonal interactions of magnitude <inline-formula><mml:math id="inf1262"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, the fragility diverges as <inline-formula><mml:math id="inf1263"><mml:mi>K</mml:mi></mml:math></inline-formula> increases to the stability boundary at <inline-formula><mml:math id="inf1264"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mtext>crit</mml:mtext></mml:msub><mml:mo>∼</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, indicating an instability in the mean field solution <xref ref-type="bibr" rid="bib8">Bunin, 2017</xref>. The fragility is infinite in the perfectly antisymmetric model (where <inline-formula><mml:math id="inf1265"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), corresponding to being exactly marginal and highly sensitive to added strains.</p><p>In addition to the random change of a <inline-formula><mml:math id="inf1266"><mml:msub><mml:mi>ζ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> induced by a successful invader, there is also a systematic change, as seen in <xref ref-type="fig" rid="fig4">Figure 4</xref>. This is because <inline-formula><mml:math id="inf1267"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf1268"><mml:msub><mml:mi>ζ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> involve the same set of random <inline-formula><mml:math id="inf1269"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and are thus correlated. We can use the fact that <inline-formula><mml:math id="inf1270"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>Cov</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>Var</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> for zero mean gaussian random variables <inline-formula><mml:math id="inf1271"><mml:mi>X</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf1272"><mml:mi>Y</mml:mi></mml:math></inline-formula> to see that the conditional expectation is <inline-formula><mml:math id="inf1273"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Since each <inline-formula><mml:math id="inf1274"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf1275"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are correlated as a consequence of <inline-formula><mml:math id="inf1276"><mml:msub><mml:mi>ζ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf1277"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> being correlated, we again have to self-consistently determine this correlation. Unfortunately this is more complicated as the <inline-formula><mml:math id="inf1278"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> also have a contribution from small changes in the function <inline-formula><mml:math id="inf1279"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ζ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> caused by the invaded strain. However one can understand the <italic>form</italic> of the conditional expectations by noting that after the new strain has invaded,<disp-formula id="equ34"><label>(A8.2)</label><mml:math id="m34"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>δ</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>This implies that the last term must be negative if <inline-formula><mml:math id="inf1280"><mml:mi>L</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf1281"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> are increasing or staying constant. Therefore the correlation between <inline-formula><mml:math id="inf1282"><mml:msub><mml:mi>ζ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf1283"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> caused by the invader strain is negative (this is true also if only considering the direct effect of <inline-formula><mml:math id="inf1284"><mml:mi>A</mml:mi></mml:math></inline-formula> on <inline-formula><mml:math id="inf1285"><mml:mi>j</mml:mi></mml:math></inline-formula>). The additional effects on <inline-formula><mml:math id="inf1286"><mml:mi>j</mml:mi></mml:math></inline-formula> from the changes in other strains is enhanced by the fragility, <inline-formula><mml:math id="inf1287"><mml:mi mathvariant="normal">Ξ</mml:mi></mml:math></inline-formula>. If the fragility is high, one can show that <inline-formula><mml:math id="inf1288"><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is proportional to <inline-formula><mml:math id="inf1289"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="normal">Ξ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>ν</mml:mi><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, since the last two terms in <xref ref-type="disp-formula" rid="equ34">Equation A8.2</xref> should be of similar magnitude to preserve <inline-formula><mml:math id="inf1290"><mml:mi mathvariant="script">L</mml:mi></mml:math></inline-formula>: in this limit, as argued below, the diversity will decrease.</p><p>The above Markovian analysis is an approximation because <inline-formula><mml:math id="inf1291"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> for each extant strain is correlated with its whole past trajectory — as it involves many of the same <inline-formula><mml:math id="inf1292"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> — and its conditional expectation will be a weighted sum over the full past <inline-formula><mml:math id="inf1293"><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Furthermore, it is possible that conditioning on all this past could suppress <inline-formula><mml:math id="inf1294"><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>ζ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> by a substantial factor (in the Markovian approximation the analogous correction is smaller by a <inline-formula><mml:math id="inf1295"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> factor). However the basic structure of the stochastic changes is correctly captured by the Markovian approximation. This approximation is summarized in <xref ref-type="disp-formula" rid="equ3">Equation 3</xref>, which writes the change in bias after one invasion attempt as the sum of a systematic and stochastic part.</p><p>If neither extinctions nor invasions occurred, there would be a trivial steady state with a gaussian distribution of the biases with width <inline-formula><mml:math id="inf1296"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:mrow></mml:math></inline-formula> as expected for an assembled community. With a source of new strains, which come in with drives that are gaussian distributed with width <inline-formula><mml:math id="inf1297"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi mathvariant="script">L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>, the effective community size is <inline-formula><mml:math id="inf1298"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="inf1299"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>C</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. We thence obtain a Fokker Planck equation for the number density <inline-formula><mml:math id="inf1300"><mml:mi>N</mml:mi></mml:math></inline-formula> of the drives:<disp-formula id="equ35"><label>(A8.3)</label><mml:math id="m35"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ζ</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mi>ζ</mml:mi><mml:mi>L</mml:mi></mml:mfrac><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ζ</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:msubsup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ζ</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:mi>C</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac></mml:msqrt><mml:mtext> </mml:mtext><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>ζ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>C</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ζ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where we impose the absorbing boundary condition at the critical bias corresponding to <inline-formula><mml:math id="inf1301"><mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="inf1302"><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf1303"><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> both scaling as <inline-formula><mml:math id="inf1304"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>. The last term in <xref ref-type="disp-formula" rid="equ35">Equation A8.3</xref> is the truncated-gaussian drive distribution of successfully invading strains with scale <inline-formula><mml:math id="inf1305"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi mathvariant="script">L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>. The fraction of invasions that are successful, <inline-formula><mml:math id="inf1306"><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>, is just the integral of the truncated gaussian, <inline-formula><mml:math id="inf1307"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msqrt><mml:mi mathvariant="script">L</mml:mi></mml:msqrt><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. The number of strains, <inline-formula><mml:math id="inf1308"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, is changing and at this point unknown: it is determined self-consistently from <inline-formula><mml:math id="inf1309"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mi>d</mml:mi><mml:mi>ζ</mml:mi><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ζ</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. It is straightforward to show, as we do in ‘Appendix 8’, that this Fokker-Planck equation admits a scaling solution with the <italic>Ansatz</italic> that all the quantities scale as <inline-formula><mml:math id="inf1310"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>. The rate of diversification, <inline-formula><mml:math id="inf1311"><mml:mrow><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, is of order one and determined by an eigenvalue-like condition: it can be either positive or negative depending on <inline-formula><mml:math id="inf1312"><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and the coefficients, <inline-formula><mml:math id="inf1313"><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula>. If the community is very fragile (<inline-formula><mml:math id="inf1314"><mml:mi mathvariant="normal">Ξ</mml:mi></mml:math></inline-formula> large), then the <inline-formula><mml:math id="inf1315"><mml:mi>B</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf1316"><mml:mi>D</mml:mi></mml:math></inline-formula> terms will dominate over the input and the loss of strains per successful invasion will be large: in this regime the diversification rate is negative. On the other hand if <inline-formula><mml:math id="inf1317"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msqrt><mml:mi mathvariant="script">L</mml:mi></mml:msqrt></mml:mrow></mml:mrow></mml:math></inline-formula> is large, few strains will go extinct and the community will diversify. Of course, these quantities are determined self-consistently, depending on both the distribution of biases and the function <inline-formula><mml:math id="inf1318"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, which itself will evolve, reaching a scaling form in the steadily diversifying state.</p><p>How good is the Markov approximation? The average change in the drive should really be a weighted integral over the history of the drive, <inline-formula><mml:math id="inf1319"><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, over all <inline-formula><mml:math id="inf1320"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. If one makes the <italic>Ansatz</italic> of a scaling solution with <inline-formula><mml:math id="inf1321"><mml:mi>L</mml:mi></mml:math></inline-formula> steadily increasing, then for large <inline-formula><mml:math id="inf1322"><mml:mi>T</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf1323"><mml:mrow><mml:mi>L</mml:mi><mml:mo>∼</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> and in the variables scaled by <inline-formula><mml:math id="inf1324"><mml:mi>T</mml:mi></mml:math></inline-formula> the weighting function should be a function of of <inline-formula><mml:math id="inf1325"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>/</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, so that the integral over the history is a convolution in <inline-formula><mml:math id="inf1326"><mml:mi>q</mml:mi></mml:math></inline-formula>. In general, the steady state could, of course, not be found even if this weighting function were known, and the integro-differential generalization of the Fokker-Planck equation would have to be analyzed numerically. But with the widths of the distributions of the extant and invader biases being similar, as observed, the details of the weighting function might not much affect the bias distribution.</p></sec><sec sec-type="appendix" id="s16-2"><title>Fokker-Planck equation without general fitness differences</title><p>Without general fitness differences or correlations, the evolution of the average drive of a strain in the Markovian approximation obeys a Langevin equation (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref>). With a source term corresponding to incoming strains, this yields a Fokker Planck equation (<xref ref-type="disp-formula" rid="equ35">Equation A8.3</xref>) for the number density <inline-formula><mml:math id="inf1327"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ζ</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> whose integral at any time gives us the number of strains. The crucial <italic>Ansatz</italic> is that all the quantities (<inline-formula><mml:math id="inf1328"><mml:mi>ζ</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf1329"><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf1330"><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula>) scale as <inline-formula><mml:math id="inf1331"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>, and we now take <inline-formula><mml:math id="inf1332"><mml:mi>L</mml:mi></mml:math></inline-formula> to be a function of <inline-formula><mml:math id="inf1333"><mml:mi>T</mml:mi></mml:math></inline-formula>. Then we can hypothesize a scaling solution <inline-formula><mml:math id="inf1334"><mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ζ</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>⁢</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> for some function <inline-formula><mml:math id="inf1335"><mml:mi>g</mml:mi></mml:math></inline-formula> so that <inline-formula><mml:math id="inf1336"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>∫</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ζ</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>ζ</mml:mi><mml:mo>∼</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, as the integral over the distribution of drives gives us the total number of strains. For ease of notation, we define the similarity variable <inline-formula><mml:math id="inf1337"><mml:mrow><mml:mi>u</mml:mi><mml:mo>≡</mml:mo><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>⁢</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:mrow></mml:math></inline-formula>, and derivatives with respect to <inline-formula><mml:math id="inf1338"><mml:mi>u</mml:mi></mml:math></inline-formula> by primes: then <xref ref-type="disp-formula" rid="equ35">Equation A8.3</xref> becomes<disp-formula id="equ36"> <label>(A8.4)</label><mml:math id="m36"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>u</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msqrt><mml:mfrac><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac></mml:msqrt><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>C</mml:mi><mml:msup><mml:mi>u</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mi>u</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where we define <inline-formula><mml:math id="inf1339"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>≡</mml:mo><mml:mrow><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. We can make an <italic>Ansatz</italic> of the form<disp-formula id="equ37"><label>(A8.5)</label><mml:math id="m37"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>U</mml:mi><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the coefficient <inline-formula><mml:math id="inf1340"><mml:mi>U</mml:mi></mml:math></inline-formula> is the average rate of increase or decrease of the diversity per invasion attempt.</p><p>The equation for <inline-formula><mml:math id="inf1341"><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> then becomes<disp-formula id="equ38"><label>(A8.6)</label><mml:math id="m38"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>3</mml:mn><mml:mi>U</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>g</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mi>U</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>u</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msqrt><mml:mfrac><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac></mml:msqrt><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>C</mml:mi><mml:msup><mml:mi>u</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0.</mml:mn></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We can solve this equation numerically with boundary conditions <inline-formula><mml:math id="inf1342"><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf1343"><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">∞</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (exact solutions are available for certain values of <inline-formula><mml:math id="inf1344"><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf1345"><mml:mi>U</mml:mi></mml:math></inline-formula>). The first of these boundary conditions comes from the extinction criterion that enforces <inline-formula><mml:math id="inf1346"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for every extant strain, and second comes from the need to have <inline-formula><mml:math id="inf1347"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi><mml:mo>&lt;</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. The solution depends on the parameters <italic>u</italic><sub>0</sub>, <inline-formula><mml:math id="inf1348"><mml:mi>B</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf1349"><mml:mi>D</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf1350"><mml:mi>U</mml:mi></mml:math></inline-formula>. By enforcing <inline-formula><mml:math id="inf1351"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msubsup><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, we can find the value of <inline-formula><mml:math id="inf1352"><mml:mi>U</mml:mi></mml:math></inline-formula> in terms of <inline-formula><mml:math id="inf1353"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf1354"><mml:mi>D</mml:mi></mml:math></inline-formula>. One can see, numerically, that for <inline-formula><mml:math id="inf1355"><mml:mi>B</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf1356"><mml:mi>D</mml:mi></mml:math></inline-formula> both large, the consistent value of <inline-formula><mml:math id="inf1357"><mml:mi>U</mml:mi></mml:math></inline-formula> is negative, implying loss of diversity.</p><p>In <xref ref-type="fig" rid="fig5">Figure 5B</xref>, we use the measured values of <inline-formula><mml:math id="inf1358"><mml:mi>U</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf1359"><mml:mi>C</mml:mi></mml:math></inline-formula>, and adjust the values of <inline-formula><mml:math id="inf1360"><mml:mi>B</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf1361"><mml:mi>D</mml:mi></mml:math></inline-formula> to give a normalized function <inline-formula><mml:math id="inf1362"><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The blue curve is a truncated unit-variance gaussian for the initial assembled community, with mean and lower limit fit by hand, and the orange curve is a numerical solution to <xref ref-type="disp-formula" rid="equ38">Equation A8.6</xref> with <inline-formula><mml:math id="inf1363"><mml:mrow><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>≅</mml:mo><mml:mn>0.24</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf1364"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>2.11</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf1365"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>1.79</mml:mn></mml:mrow></mml:math></inline-formula> adjusted to enforce normalization. Note that <inline-formula><mml:math id="inf1366"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>≅</mml:mo><mml:mn>0.74</mml:mn></mml:mrow></mml:math></inline-formula>. The mode of the truncated gaussian is <inline-formula><mml:math id="inf1367"><mml:mrow><mml:mi/><mml:mo>≅</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msqrt><mml:mi mathvariant="script">L</mml:mi></mml:msqrt></mml:mrow></mml:mrow></mml:math></inline-formula> as expected from <xref ref-type="fig" rid="fig4">Figure 4</xref>. The bias distributions for assembled and evolved communities are very similar except near <inline-formula><mml:math id="inf1368"><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula>, which is what one expects from the Markov approximation. For <inline-formula><mml:math id="inf1369"><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">Υ</mml:mi></mml:mrow><mml:mo>≫</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi mathvariant="script">L</mml:mi></mml:msqrt></mml:mrow></mml:mrow></mml:math></inline-formula>, when the ratio of extant to invading widths, <inline-formula><mml:math id="inf1370"><mml:mrow><mml:msqrt><mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msqrt><mml:mo>≅</mml:mo><mml:mn>0.79</mml:mn></mml:mrow></mml:math></inline-formula>, is close to unity, the bulk of the drive distribution is close to gaussian with mean zero, which is reflected in <xref ref-type="fig" rid="fig5">Figure 5B</xref>.</p></sec><sec sec-type="appendix" id="s16-3"><title>Fokker-Planck equation with independent general fitness differences</title><p>If incoming strains have independently drawn general fitnesses, <inline-formula><mml:math id="inf1371"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, then we can write an evolution equation for the joint distribution of the drives and the <inline-formula><mml:math id="inf1372"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ39"><label>(A8.7)</label><mml:math id="m39"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ζ</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mi>ζ</mml:mi><mml:mi>L</mml:mi></mml:mfrac><mml:mi>N</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mi>D</mml:mi><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:msubsup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:mi>C</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac></mml:msqrt><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>ζ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>C</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ζ</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where we abbreviate <inline-formula><mml:math id="inf1373"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>s</mml:mi><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:mi>ζ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> by <inline-formula><mml:math id="inf1374"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. However, unlike the case with general fitness differences, now <inline-formula><mml:math id="inf1375"><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> does not scale as <inline-formula><mml:math id="inf1376"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>. Indeed, the scaling of <inline-formula><mml:math id="inf1377"><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> with <inline-formula><mml:math id="inf1378"><mml:mi>Z</mml:mi></mml:math></inline-formula> determines how <inline-formula><mml:math id="inf1379"><mml:mi>L</mml:mi></mml:math></inline-formula> depends on <inline-formula><mml:math id="inf1380"><mml:mi>Z</mml:mi></mml:math></inline-formula>. If we specify the form of <inline-formula><mml:math id="inf1381"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula>, then we can look for solutions which travel up in the <inline-formula><mml:math id="inf1382"><mml:mi>s</mml:mi></mml:math></inline-formula> direction at the same speed as <inline-formula><mml:math id="inf1383"><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula>.</p><p>We can define similarity variables <inline-formula><mml:math id="inf1384"><mml:mrow><mml:mi>u</mml:mi><mml:mo>≡</mml:mo><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>⁢</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf1385"><mml:mrow><mml:mi>v</mml:mi><mml:mo>≡</mml:mo><mml:mrow><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Then we look for solutions of the form <inline-formula><mml:math id="inf1386"><mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ζ</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> so that the integral of <inline-formula><mml:math id="inf1387"><mml:mi>N</mml:mi></mml:math></inline-formula> over <inline-formula><mml:math id="inf1388"><mml:mi>ζ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf1389"><mml:mi>s</mml:mi></mml:math></inline-formula> is proportional to <inline-formula><mml:math id="inf1390"><mml:mi>L</mml:mi></mml:math></inline-formula>. The boundary condition is that <inline-formula><mml:math id="inf1391"><mml:mi>g</mml:mi></mml:math></inline-formula> vanishes along the line <inline-formula><mml:math id="inf1392"><mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mo>+</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mtext>crit</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>. Plugging this into our Fokker Planck equation, and defining <inline-formula><mml:math id="inf1393"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mtext>crit</mml:mtext></mml:msub><mml:mo>≡</mml:mo><mml:mrow><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, we obtain<disp-formula id="equ40"><label>(A8.8)</label><mml:math id="m40"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>Z</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>g</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>Z</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msqrt><mml:mfrac><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac></mml:msqrt><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>C</mml:mi><mml:msup><mml:mi>u</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mtext>crit</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mi>g</mml:mi><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mi>u</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where subscripts denote derivatives of <inline-formula><mml:math id="inf1394"><mml:mi>g</mml:mi></mml:math></inline-formula>. We can see that the <inline-formula><mml:math id="inf1395"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> distribution generically breaks the scaling — because it depends on <inline-formula><mml:math id="inf1396"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>/</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:mrow></mml:math></inline-formula>, not only on <inline-formula><mml:math id="inf1397"><mml:mi>v</mml:mi></mml:math></inline-formula>. But we can look for solutions which obey the scaling with <inline-formula><mml:math id="inf1398"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>. Take <inline-formula><mml:math id="inf1399"><mml:mrow><mml:mi>v</mml:mi><mml:mo>/</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula> as exponentially distributed with scale <inline-formula><mml:math id="inf1400"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula>. Then in order for our scaling <italic>Ansatz</italic> to be valid, the quantity <inline-formula><mml:math id="inf1401"><mml:mfrac><mml:mi>v</mml:mi><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>⁢</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:mfrac></mml:math></inline-formula> must be independent of <inline-formula><mml:math id="inf1402"><mml:mi>L</mml:mi></mml:math></inline-formula>, so we must have <inline-formula><mml:math id="inf1403"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt><mml:mo>∼</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi><mml:mspace width="thickmathspace"/><mml:mo stretchy="false">⟹</mml:mo><mml:mspace width="thickmathspace"/><mml:mi>L</mml:mi><mml:mo>∼</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. This requires <inline-formula><mml:math id="inf1404"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:mfrac><mml:mo>∼</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> in order to make the left hand side of <xref ref-type="disp-formula" rid="equ40">Equation A8.8</xref> independent of <inline-formula><mml:math id="inf1405"><mml:mi>L</mml:mi></mml:math></inline-formula>. Furthermore, we have <inline-formula><mml:math id="inf1406"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> since <inline-formula><mml:math id="inf1407"><mml:mrow><mml:mi>L</mml:mi><mml:mo>∼</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Therefore, we have<disp-formula id="equ41"><label>(A8.9)</label><mml:math id="m41"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>Z</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msqrt><mml:mfrac><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac></mml:msqrt><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>C</mml:mi><mml:msup><mml:mi>u</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mtext>crit</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mi>g</mml:mi><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mi>u</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>g</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Setting this to 0 would allow us to solve for <inline-formula><mml:math id="inf1408"><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and therefore find the scaling solution for the joint distribution of mean drives and the <italic>s</italic><sub><italic>i</italic></sub>.</p></sec></sec></app><app id="appendix-9"><title>Appendix 9</title><sec sec-type="appendix" id="s17"><title>Coexistence of correlated strains</title><p>The simulations show that even strains which interact very similarly with the rest of the community can coexist. Here, we present some of the numerical data and show how simple approximations fail to explain this behavior.</p><sec sec-type="appendix" id="s17-1"><title>Lotka-Volterra approximation ignoring migration</title><p>A natural way to understand very closely related strains (e.g. a mutant and parent) is via an effective Lotka Volterra model for the dynamics of just these two strains in the presence of all the others. For a correlation <inline-formula><mml:math id="inf1409"><mml:mi>ρ</mml:mi></mml:math></inline-formula> between the parent and mutant interactions, one can obtain a pair of DMFT equations describing the correlated dynamics of parent and mutant in the form of <xref ref-type="disp-formula" rid="equ15">Equation A5.1</xref>. Here, we consider the crude approximation of neglecting the effects of migration and averaging the dynamics of <inline-formula><mml:math id="inf1410"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:math></inline-formula> to obtain equations for parent and mutant frequencies <inline-formula><mml:math id="inf1411"><mml:msub><mml:mi>ν</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf1412"><mml:msub><mml:mi>ν</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:math></inline-formula>:<disp-formula id="equ42"><label>(A9.1)</label><mml:math id="m42"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mover accent="true"><mml:msub><mml:mi>ν</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>˙</mml:mo></mml:mover></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><disp-formula id="equ43"><label>(A9.2)</label><mml:math id="m43"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mover accent="true"><mml:msub><mml:mi>ν</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>˙</mml:mo></mml:mover></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>This analysis is appropriate only for strains with positive bias — and even then approximate – but the following results provide a null model against which one can compare the dynamics of parent-mutant replacement in the evolving STC.</p><p>In the absence of the mutant, <inline-formula><mml:math id="inf1413"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>P</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (which is the correct behavior for large positive <inline-formula><mml:math id="inf1414"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math></inline-formula>). The condition for invasion of a mutant into an environment containing only the parent is that its invasion eigenvalue, suppressed by the effects of the parent, is greater than the critical bias which amounts to <inline-formula><mml:math id="inf1415"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>ρ</mml:mi><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and the condition for invasion of the parent into the mutant is likewise <inline-formula><mml:math id="inf1416"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>ρ</mml:mi><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. In terms of the drives, these conditions are <inline-formula><mml:math id="inf1417"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>ρ</mml:mi><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> for the mutant to invade the parent, and the same condition with <inline-formula><mml:math id="inf1418"><mml:mi>M</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf1419"><mml:mi>P</mml:mi></mml:math></inline-formula> flipped for the parent to invade the mutant. With the mutant drive parameterized as <inline-formula><mml:math id="inf1420"><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>⁢</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="inf1421"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> a gaussian random variable with mean 0 and scale <inline-formula><mml:math id="inf1422"><mml:msub><mml:mi>ζ</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math></inline-formula>, the probabilities of coexistence between parent and mutant, and of replacement of the parent, are<disp-formula id="equ44"> <label>(A9.3)</label><mml:math id="m44"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mtext>coexist</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>ξ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>ρ</mml:mi><mml:mo>−</mml:mo><mml:mi>ρ</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msqrt><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt></mml:mfrac><mml:mo>]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>ξ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msqrt><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ45"><label>(A9.4)</label><mml:math id="m45"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mtext>replace</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>ξ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>ρ</mml:mi><mml:mo>−</mml:mo><mml:mi>ρ</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msqrt><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf1423"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula> is the standard normal cdf, and <inline-formula><mml:math id="inf1424"><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf1425"><mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula> are the Lagrange multiplier and critical bias, both normalized by the scale of the <inline-formula><mml:math id="inf1426"><mml:mi>ζ</mml:mi></mml:math></inline-formula> distribution. Note that the expressions are only valid for <inline-formula><mml:math id="inf1427"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mover><mml:mi>ξ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula>: otherwise, in this approximation, the coexistence probability vanishes and all invasions are replacements. The probability of mutant invasion is <inline-formula><mml:math id="inf1428"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>invade</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. For <inline-formula><mml:math id="inf1429"><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>≪</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf1430"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, the invasion probability is <inline-formula><mml:math id="inf1431"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>invade</mml:mtext></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msqrt><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and the coexistence probability predicted by this simple approximation is <inline-formula><mml:math id="inf1432"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>coexist</mml:mtext></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msqrt><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mrow></mml:math></inline-formula>. With <inline-formula><mml:math id="inf1433"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.99</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf1434"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (in the STC <inline-formula><mml:math id="inf1435"><mml:mover accent="true"><mml:mi mathvariant="normal">Υ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math></inline-formula> should be nonnegative, and setting it to 0 maximizes the coexistence probability), this predicts that the probability of coexistence <italic>conditional on the mutant invading</italic> is <inline-formula><mml:math id="inf1436"><mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>coexist</mml:mtext></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mtext>invade</mml:mtext></mml:msub></mml:mrow><mml:mo>≅</mml:mo><mml:mn>0.12</mml:mn></mml:mrow></mml:math></inline-formula> which is much smaller than the observed <inline-formula><mml:math id="inf1437"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mtext>coexist</mml:mtext><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext>invade</mml:mtext></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="app9fig1">Appendix 9—figure 1</xref>).</p><fig id="app9fig1" position="float"><label>Appendix 9—figure 1.</label><caption><title>The coexistence probability between parent and mutant conditioned on successful invasion of the mutant (with <inline-formula><mml:math id="inf1438"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>).</title><p>The probability is averaged over 4 simulations of a diversifying community for each value of <inline-formula><mml:math id="inf1439"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, with error bars showing the standard error. Here <inline-formula><mml:math id="inf1440"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is shown on a logit scale to emphasize the difference between the points as <inline-formula><mml:math id="inf1441"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. Even for <inline-formula><mml:math id="inf1442"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.999</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, the coexistence probability is order 1/2 over he epoch of duration <inline-formula><mml:math id="inf1443"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>30</mml:mn><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, likely long enough to enable small differences between closely related strains to have an effect.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82734-app9-fig1-v2.tif"/></fig><p>The main problem with this approximation is that it needs to be used when the biases are close to the critical <inline-formula><mml:math id="inf1444"><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula> which is substantially negative, while the approximation of ignoring migration certainly breaks down in this regime. Properly understanding the coexistence of replacement of related mutant and parent requires a fuller understanding of their coupled dynamics, including migration.</p></sec><sec sec-type="appendix" id="s17-2"><title>Coexistence probability</title><p>Of particular interest is the probability with which mutant and parent coexist when they are correlated by amount <inline-formula><mml:math id="inf1445"><mml:mi>ρ</mml:mi></mml:math></inline-formula>. The effects of the persistent chaos on this coexistence probability are subtle, and here we show that the simulation results cannot be captured by the null model of ‘Appendix 9’, which neglects migration and blooms.</p><p>Comparing numerical results from simulation of the dynamics to those of ‘Appendix 9’, we find that the probability of coexistence between parent and mutant, conditioned on mutant invasion, is substantially larger than predicted by <xref ref-type="disp-formula" rid="equ42">Equation A9.1</xref> and <xref ref-type="disp-formula" rid="equ43">Equation A9.2</xref>. This is likely due to the fact that in the STC, a majority of persistent strains have negative bias and even for those with positive bias, the effect of migration is not small. The boom-bust dynamics with migration makes coexistence much easier, but understanding this even semi-quantitatively is challenging because of the correlations in the dynamical drive which makes parental blooms suppress the mutants and vice versa. Nevertheless, we expect that if <inline-formula><mml:math id="inf1446"><mml:mi>ρ</mml:mi></mml:math></inline-formula> is extremely close to unity, the coexistence probability of parent and mutant will go to zero as <inline-formula><mml:math id="inf1447"><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msqrt></mml:math></inline-formula>, as in the simple approximation from ‘Appendix 9’, but with a small coefficient that might be of order some inverse power of <inline-formula><mml:math id="inf1448"><mml:mi mathvariant="script">M</mml:mi></mml:math></inline-formula>. In addition one should note that the natural timescale over which differences between the parent and mutant will accumulate is of order <inline-formula><mml:math id="inf1449"><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mi mathvariant="script">M</mml:mi><mml:mo>⁢</mml:mo><mml:msqrt><mml:mi>L</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula> with the coefficient only <inline-formula><mml:math id="inf1450"><mml:mrow><mml:mi/><mml:mo>≅</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf1451"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.999</mml:mn></mml:mrow></mml:math></inline-formula>. Therefore even for <inline-formula><mml:math id="inf1452"><mml:mi>ρ</mml:mi></mml:math></inline-formula> this close to 1, the typical differences between parent and mutant will still be felt on timescales of order <inline-formula><mml:math id="inf1453"><mml:mrow><mml:mi mathvariant="script">M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> over which the close-to-marginal strains rise or die out.</p><p>A dynamical analysis of a parent and mutant including migration becomes far more complicated once the community has evolved long enough that a substantial fraction of the strains have turned over (or coexist with relatives). The underlying simplification that makes DMFT valid for assembled communities, the approximate independence of the biases, will break down because of correlations among many of the strains due to their common ancestry. While some of the heuristic behavior of such communities and how they evolve may not change much even for <inline-formula><mml:math id="inf1454"><mml:mi>ρ</mml:mi></mml:math></inline-formula> quite close to 1, there will certainly be quantitative changes.</p><p>The approximate Markovian analysis of the evolution of the bias distribution (‘Evolution without general fitness differences’), can be modified to roughly account for correlations between mutants and parents, <inline-formula><mml:math id="inf1455"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. Such correlations will modify the effects of invading strains on the bias of the extant strains. This is most readily understood in the limit that <inline-formula><mml:math id="inf1456"><mml:mi>ρ</mml:mi></mml:math></inline-formula> is very close to unity. In this case, one expects that the total abundance of the parent and mutant after the invasion will be similar to that of the parent before the invasion and, because of the high correlations, their effects on the other strains will be very similar. This suggests that both the stochastic and systematic changes of the biases should be multiplied by a factor of order <inline-formula><mml:math id="inf1457"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> on the right hand side of <xref ref-type="disp-formula" rid="equ3">Equation 3</xref>. For the first few mutants, the analysis could be carried through similarly. However once the number of successfully invaded mutants is comparable to the original <inline-formula><mml:math id="inf1458"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, the correlations between the biases of the extant strains can not be ignored and the approximation of independent <inline-formula><mml:math id="inf1459"><mml:msub><mml:mi>ζ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> breaks down. We leave analysis of this for future work.</p></sec></sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.82734.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Nourmohammad</surname><given-names>Armita</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00cvxb145</institution-id><institution>University of Washington</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><related-object id="sa0ro1" object-id-type="id" object-id="10.1101/2022.05.25.493518" link-type="continued-by" xlink:href="https://sciety.org/articles/activity/10.1101/2022.05.25.493518"/></front-stub><body><p>This important study explores the question of “what gives rise to diversity in ecological settings?”. By considering the interplay between ecology and evolution, this study proposes a scenario of spatiotemporal chaos, in which interactions between strains drive large changes in the relative abundances of strains. The presented theoretical approach is compelling and goes beyond the current state of the art. This innovative theoretical work is of broad interest to the field of ecology and evolution.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.82734.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Nourmohammad</surname><given-names>Armita</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00cvxb145</institution-id><institution>University of Washington</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Mehta</surname><given-names>Pankaj</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05qwgg493</institution-id><institution>Boston University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2022.05.25.493518">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2022.05.25.493518v1">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Spatiotemporal Ecological Chaos Enables Gradual Evolutionary Diversification Without Niches or Tradeoffs&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 2 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Aleksandra Walczak as the Senior Editor. The following individual involved in the review of your submission has agreed to reveal their identity: Pankaj Mehta (Reviewer #1).</p><p><italic>Reviewer #1 (Public review):</italic></p><p>In there paper &quot;Spatiotemporal Ecological Chaos Enables Gradual Evolutionary Diver- sification Without Niches or Tradeoffs&quot;, Mahadevan, Pearce, and Fisher build on previous works to explore a compelling potential answer (what they term a &quot;scenario&quot;) to an important open and fascinating question: what gives rise to micro strain-level diversity?</p><p>Naively, the ecological principle of competitive exclusion would suggest that closely related strains should not be able to co-exist. However, Fisher and collaborators have previously proposed an interesting and potentially novel and powerful solution to this paradox. If the species have (extremely) anti-correlated species-species interactions (i.e more A helps B but more B hurts A) then there is a reasonably large set of parameters under which you can have infinite diversity due to spatial temporal chaos (STC). This is really an interesting and compelling picture.</p><p>The purpose of this paper is to explore a natural follow up question: does the STC phase still support infinite diversity even when communities are assembled using evolution, or more accurately undergo evolution starting with a sufficiently large randomly assembled community? In other words, is STC still a reasonable explanation for strain-level diversity once evolution is considered. This is an extremely interesting question since evolution and ecology are so deeply intertwined at the time scales on which strain evolve. The work is especially impressive due to the extreme dearth of analytic and computational tools to really understand eco-evolutionary dynamics.</p><p><italic>Reviewer #2 (Public review):</italic></p><p>The manuscript sets out to explain how the large micro-diversity of closely-related microbial strains might be produced and maintained. It proposes a scenario of spatiotemporal chaos, in which interactions between strains drive large changes in the relative abundances; space helps strains survive by migration between islands; and evolution produces new strains. The work presents a mathematical framework and discusses its biological relevance, and then examines its outcomes through a combination of simulations and mathematical analysis.</p><p>An important main result is that, under certain conditions, the diversity (number of extant strains) can grow continually and indefinitely. It is presented through simulations and then analyzed theoretically. Much of the work goes into understanding this increase in diversity, and the conditions required for it to happen. In particular, the effects of the distribution of mutant fitnesses, and of correlations between mutant and parent are examined.</p><p>This main result represents a significant conceptual advance on a central question in ecology, that justifies publication of this work. It is of broad interest in the field of ecology and evolution, likely to generate significant interest and lead to future work in a number of directions.</p><p>The simulations strongly support the results. The mathematical analysis provides significant insight into the phenomenology. It also develops tools that are be of interest in their own right.</p><p>In tackling this difficult and general question, the authors must make simplifying assumptions in the modeling.</p><p>The theoretical model does not assume the existence of niches (in the form of significant differences between inter- and intra-species interactions), or fine-tuned tradeoffs except as they may emerge from the evolutionary process. That such assumptions are not made is very appealing for microbial ecology.</p><p>The interactions between species are taken to be anti-symmetric or close to that, as in predator-prey interactions. The authors motivate this assumption by bacteria-phage interactions. As the authors note, in a community with many strains of both bacteria and phage, the interactions are also expected to have a block structure, with different interactions between and within each group. This additional block structure could potentially have significant effect on the phenomenology. It is not implemented in the present work, and only briefly discussed in the Discussion section, referring to unpublished work-in-progress.</p></body></sub-article></article>