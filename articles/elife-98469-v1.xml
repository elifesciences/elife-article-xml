<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">98469</article-id><article-id pub-id-type="doi">10.7554/eLife.98469</article-id><article-id pub-id-type="doi" specific-use="version">10.7554/eLife.98469.3</article-id><article-version article-version-type="publication-state">version of record</article-version><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group></article-categories><title-group><article-title>Artificial intelligence approaches for tumor phenotype stratification from single-cell transcriptomic data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Bhattacharya</surname><given-names>Namrata</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5666-2551</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Rockstroh</surname><given-names>Anja</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Deshpande</surname><given-names>Sanket Suhas</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Thomas</surname><given-names>Sam Koshy</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Yadav</surname><given-names>Anunay</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Goswami</surname><given-names>Chitrita</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Chawla</surname><given-names>Smriti</given-names></name><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Solomon</surname><given-names>Pierre</given-names></name><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Fourgeux</surname><given-names>Cynthia</given-names></name><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Ahuja</surname><given-names>Gaurav</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2837-9361</contrib-id><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="aff" rid="aff8">8</xref><xref ref-type="fn" rid="con10"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author"><name><surname>Hollier</surname><given-names>Brett</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con11"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Kumar</surname><given-names>Himanshu</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5246-2694</contrib-id><xref ref-type="aff" rid="aff9">9</xref><xref ref-type="fn" rid="con12"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Roquilly</surname><given-names>Antoine</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1029-6242</contrib-id><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="fn" rid="con13"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Poschmann</surname><given-names>Jeremie</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9613-5297</contrib-id><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="fn" rid="con14"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Lehman</surname><given-names>Melanie</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff10">10</xref><xref ref-type="fn" rid="con15"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Nelson</surname><given-names>Colleen C</given-names></name><email>colleen.nelson@qut.edu.au</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con16"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Sengupta</surname><given-names>Debarka</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6353-5411</contrib-id><email>debarka@iiitd.ac.in</email><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="aff" rid="aff8">8</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con17"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03pnv4752</institution-id><institution>Australian Prostate Cancer Research Centre-Queensland, Faculty of Health, School of Biomedical Sciences, Centre for Genomics and Personalised Health, Queensland University of Technology</institution></institution-wrap><addr-line><named-content content-type="city">Brisbane</named-content></addr-line><country>Australia</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03vfp4g33</institution-id><institution>Department of Computer Science and Engineering, Indraprastha Institute of Information Technology-Delhi (IIIT-Delhi), Okhla, Phase III</institution></institution-wrap><addr-line><named-content content-type="city">New Delhi</named-content></addr-line><country>India</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00v807439</institution-id><institution>Translational Research Institute, Princess Alexandra Hospital</institution></institution-wrap><addr-line><named-content content-type="city">Woolloongabba</named-content></addr-line><country>Australia</country></aff><aff id="aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03vfp4g33</institution-id><institution>Department of Computational Biology, Indraprastha Institute of Information Technology-Delhi (IIIT-Delhi), Okhla, Phase III</institution></institution-wrap><addr-line><named-content content-type="city">New Delhi</named-content></addr-line><country>India</country></aff><aff id="aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00892tw58</institution-id><institution>School of Mathematical Sciences, The University of Adelaide</institution></institution-wrap><addr-line><named-content content-type="city">Adelaide</named-content></addr-line><country>Australia</country></aff><aff id="aff6"><label>6</label><institution>Center for Computational Biomedicine, Harvard Medical School</institution><addr-line><named-content content-type="city">Boston</named-content></addr-line><country>United States</country></aff><aff id="aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01165k395</institution-id><institution>Nantes Université, CHU Nantes, INSERM, Center for Research in Transplantation and Translational Immunology, UMR</institution></institution-wrap><addr-line><named-content content-type="city">Nantes</named-content></addr-line><country>France</country></aff><aff id="aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03vfp4g33</institution-id><institution>Centre for Artificial Intelligence, Indraprastha Institute of Information Technology-Delhi (IIIT-Delhi), Okhla, Phase III</institution></institution-wrap><addr-line><named-content content-type="city">New Delhi</named-content></addr-line><country>India</country></aff><aff id="aff9"><label>9</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02rb21j89</institution-id><institution>Laboratory of Immunology and Infectious Disease Biology, Department of Biological Sciences, Indian Institute of Science Education and Research (IISER)</institution></institution-wrap><addr-line><named-content content-type="city">Bhopal</named-content></addr-line><country>India</country></aff><aff id="aff10"><label>10</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03rmrcq20</institution-id><institution>Vancouver Prostate Centre, Department of Urologic Sciences, University of British Columbia</institution></institution-wrap><addr-line><named-content content-type="city">Vancouver</named-content></addr-line><country>Canada</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Hong</surname><given-names>Seunghee</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01wjejq96</institution-id><institution>Yonsei University</institution></institution-wrap><country>Republic of Korea</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Choi</surname><given-names>Murim</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04h9pn542</institution-id><institution>Seoul National University</institution></institution-wrap><country>Republic of Korea</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>13</day><month>06</month><year>2025</year></pub-date><volume>13</volume><elocation-id>RP98469</elocation-id><history><date date-type="sent-for-review" iso-8601-date="2024-05-13"><day>13</day><month>05</month><year>2024</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint.</event-desc><date date-type="preprint" iso-8601-date="2024-04-01"><day>01</day><month>04</month><year>2024</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.12.28.522060"/></event><event><event-desc>This manuscript was published as a reviewed preprint.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-08-20"><day>20</day><month>08</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.98469.1"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2025-04-22"><day>22</day><month>04</month><year>2025</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.98469.2"/></event></pub-history><permissions><copyright-statement>© 2024, Bhattacharya et al</copyright-statement><copyright-year>2024</copyright-year><copyright-holder>Bhattacharya et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-98469-v1.pdf"/><abstract><p>Single-cell RNA-sequencing (scRNA-seq) coupled with robust computational analysis facilitates the characterization of phenotypic heterogeneity within tumors. Current scRNA-seq analysis pipelines are capable of identifying a myriad of malignant and non-malignant cell subtypes from single-cell profiling of tumors. However, given the extent of intra-tumoral heterogeneity, it is challenging to assess the risk associated with individual cell subpopulations, primarily due to the complexity of the cancer phenotype space and the lack of clinical annotations associated with tumor scRNA-seq studies. To this end, we introduce SCellBOW, a scRNA-seq analysis framework inspired by document embedding techniques from the domain of Natural Language Processing (NLP). SCellBOW is a novel computational approach that facilitates effective identification and high-quality visualization of single-cell subpopulations. We compared SCellBOW with existing best practice methods for its ability to precisely represent phenotypically divergent cell types across multiple scRNA-seq datasets, including our in-house generated human splenocyte and matched peripheral blood mononuclear cell (PBMC) dataset. For tumor cells, SCellBOW estimates the relative risk associated with each cluster and stratifies them based on their aggressiveness. This is achieved by simulating how the presence or absence of a specific cell subpopulation influences disease prognosis. Using SCellBOW, we identified a hitherto unknown and pervasive AR−/NE<sub>low</sub> (androgen-receptor-negative, neuroendocrine-low) malignant subpopulation in metastatic prostate cancer with conspicuously high aggressiveness. Overall, the risk-stratification capabilities of SCellBOW hold promise for formulating tailored therapeutic interventions by identifying clinically relevant tumor subpopulations and their impact on prognosis.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>single-cell RNA-seq</kwd><kwd>risk stratification</kwd><kwd>transfer learning</kwd><kwd>prostate cancer</kwd><kwd>marker-free</kwd><kwd>language model</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001407</institution-id><institution>Department of Biotechnology</institution></institution-wrap></funding-source><award-id>IC-12044(12)/4/2022-ICD-DBT</award-id><principal-award-recipient><name><surname>Sengupta</surname><given-names>Debarka</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001843</institution-id><institution>Science and Engineering Research Board</institution></institution-wrap></funding-source><award-id>CRG/2022/007706</award-id><principal-award-recipient><name><surname>Sengupta</surname><given-names>Debarka</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>SCellBOW is a language model-based scRNA-seq analysis method that identifies malignant cell subpopulations and infers marker-free survival risks using transfer learning.</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>publishing-route</meta-name><meta-value>prc</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Intra- and inter-tumoral heterogeneity are pervasive in cancer and manifest as a constellation of molecular alterations in tumor tissues. The late-stage clonal proliferation, partial selective sweeps, and spatial segregation within the tumor mass collectively orchestrate lineage plasticity and metastasis (<xref ref-type="bibr" rid="bib25">Dentro et al., 2021</xref>). In collaboration with non-malignant cell types in the tumor stroma, malignant cells with distinct genetic and phenotypic properties create complex and dynamic ecosystems, rendering the tumors recalcitrant to therapies (<xref ref-type="bibr" rid="bib56">Lawson et al., 2018</xref>). Thus, the phenotypic characterization of malignant cell subpopulations is critical to understanding the underlying mechanisms of resistive behavior. The widespread adoption of single-cell RNA-sequencing (scRNA-seq) has enabled the profiling of individual cells, thereby obtaining a high-resolution snapshot of their unique molecular landscapes (<xref ref-type="bibr" rid="bib10">Bhattacharya et al., 2021</xref>; <xref ref-type="bibr" rid="bib49">Kanev et al., 2021</xref>). A precise understanding of cell-to-cell functional variability captured by scRNA-seq profiles is crucial in this context. These molecular profiles assist in robust deconvolution of the oncogenic processes instigated by various selection pressures exerted by anticancer agents. They also facilitate understanding the cross-talks between malignant and non-malignant cell types within the tumor microenvironment (<xref ref-type="bibr" rid="bib23">Dagogo-Jack and Shaw, 2018</xref>). To effectively analyze tumor scRNA-seq data, various specialized techniques have been developed. These techniques assist in proactive investigation of complex and elusive cell populations (<xref ref-type="bibr" rid="bib75">Pang et al., 2024</xref>; <xref ref-type="bibr" rid="bib81">Poonia et al., 2023</xref>), regulatory gene interactions (<xref ref-type="bibr" rid="bib20">Chapman et al., 2022</xref>), neoplastic cell lineage trajectories (<xref ref-type="bibr" rid="bib84">Simeonov et al., 2021</xref>), and expression-based inference of copy number variations (<xref ref-type="bibr" rid="bib91">Tickle et al., 2019</xref>). While these computational techniques have been successful in gaining novel biological insights, their adoption in clinical settings is still elusive.</p><p>Over the past years, leading consortia such as The Cancer Genome Atlas (TCGA; <xref ref-type="bibr" rid="bib101">Weinstein et al., 2013</xref>) and other large-scale independent studies have established reproducible molecular subtypes of cancers with divergent prognoses. For instance, metastatic prostate cancer has typically been categorized based on the androgen receptor (AR) activity or neuroendocrine (NE) program: the less aggressive AR+/NE– (AR prostate cancer, ARPC) and the highly aggressive AR–/NE+ (NE prostate cancer, NEPC; <xref ref-type="bibr" rid="bib8">Beltran et al., 2016</xref>). More recent studies have identified additional phenotypes, such as the AR–/NE– (double-negative prostate cancer, DNPC) and AR+/NE+ (amphicrine prostate cancer, AMPC) (<xref ref-type="bibr" rid="bib14">Brady et al., 2021</xref>; <xref ref-type="bibr" rid="bib37">Han et al., 2022</xref>). These findings underscore the importance of considering tumor heterogeneity while dictating the differential treatment regimes to improve patient outcomes (<xref ref-type="bibr" rid="bib21">Chawla et al., 2022</xref>). These studies are predominantly based on bulk omics assays, which precludes the detectability of fine-grained molecular subtypes of clinical relevance. To address this, there is an urgent need to develop novel analytical approaches that are capable of exploiting single-cell omics profiles for risk attribution to malignant cell subtypes.</p><p>A growing number of NLP-based methods have recently been gaining popularity for their ability to predict patients’ survival based on their clinical records and for facilitating efficient analyses of high-dimensional scRNA-seq data (<xref ref-type="bibr" rid="bib74">Nunez et al., 2023</xref>; <xref ref-type="bibr" rid="bib54">Kim et al., 2021</xref>; <xref ref-type="bibr" rid="bib111">Zhao et al., 2021</xref>; <xref ref-type="bibr" rid="bib107">Yang et al., 2022</xref>). For instance, (<xref ref-type="bibr" rid="bib74">Nunez et al., 2023</xref>) employ language models to predict the survival outcomes of breast cancer patients based on their initial oncologist consultation documents. Similarly, in the domain of scRNA-seq analysis, scETM (<xref ref-type="bibr" rid="bib111">Zhao et al., 2021</xref>) uses topic models to infer biologically relevant cellular states from single-cell gene expression data. Recently, scBERT (<xref ref-type="bibr" rid="bib107">Yang et al., 2022</xref>), an adaptation of attention-based transformer architecture, has been developed for cell type annotation in single-cell. Motivated by the objective to efficiently associate survival risk directly with cellular subpopulations extracted from scRNA-seq data, we introduce SCellBOW (single-cell bag-of-words), a Doc2vec (<xref ref-type="bibr" rid="bib57">Le and Mikolov, 2014</xref>) inspired transfer learning framework for single-cell representation learning, clustering, visualization, and relative risk stratification of cell types within a tumor microenvironment. SCellBOW intuitively treats cells as documents and genes as words. SCellBOW learned latent representations capture the semantic meanings of cells based on their gene expression levels. Due to this, cell type or condition-specific expression patterns get adequately captured in cell embeddings. We demonstrate the utility of SCellBOW in clustering cells based on their semantic similarities across multiple scRNA-seq datasets, spanning from normal prostate to pancreas and peripheral blood mononuclear cells (PBMC). As an extended validation, we apply SCellBOW to an in-house scRNA-seq dataset comprising human PBMC and matched splenocytes. We observed that SCellBOW outperforms existing best-practice single-cell clustering methods in its ability to precisely represent phenotypically divergent cell types.</p><p>Beyond robust identification of cellular clusters, the latent representation of single cells provided by SCellBOW captures the ‘semantics’ associated with cellular phenotypes. In line with <italic>word algebra</italic> supported by NLP models, which explores word analogies based on semantic closeness (e.g. adding a word vector associated <italic>royal</italic> to <italic>man</italic> brings it closer to <italic>king</italic>), we conjectured that cellular embedding could reveal biologically intuitive outcomes through algebraic operations. Thus, we aimed to replicate this feature in the single-cell phenotype space to introduce <italic>phenotype algebra</italic> and apply the same to attribute prognostic value to cancer cell subpopulations identified from scRNA-seq studies. With the help of <italic>phenotype algebra,</italic> it is possible to simulate the exclusion of the phenotype associated with a specific subpopulation within the tumor microenvironment and relate the same to the disease outcome. Selectively removing a specific subtype from the whole tumor allows us to categorize the aggressiveness of individual subtypes under negative selection pressure while preserving the impact of the residual tumor. This information can ultimately aid therapeutic decision-making and improve patient outcomes. As a proof of concept, we validate the <italic>phenotype algebra</italic> module of SCellBOW for risk-stratification of malignant and non-malignant cell subtypes across three independent cancer types: glioblastoma multiforme, breast cancer, and metastatic prostate cancer.</p><p>Finally, we demonstrate the utility of SCellBOW to uncover and define novel subpopulations in a cancer type based on biological features relating to disease aggressiveness and survival probability. Metastatic prostate cancer encompasses a range of malignant cell subpopulations, and characterizing novel or more fine-grained subtypes with clinical implications on patient prognosis is an active field of research (<xref ref-type="bibr" rid="bib52">Kfoury et al., 2021</xref>; <xref ref-type="bibr" rid="bib32">Feng et al., 2022</xref>). To explore this, we applied our <italic>phenotype algebra</italic> on the SCellBOW clusters as opposed to predefined subtypes. Through our analysis using SCellBOW, we identify a dedifferentiated metastatic prostate cancer subpopulation. This subpopulation is nearly ubiquitous across numerous metastatic prostate cancer samples and demonstrates greater aggressiveness compared to any known molecular subtypes. To the best of our knowledge, SCellBOW pioneered the application of a NLP-based model to attribute survival risk to malignant and non-malignant cell subpopulations from patient tumors. SCellBOW holds promise for tailored therapeutic interventions by identifying clinically relevant subpopulations and their impact on prognosis.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Overview of SCellBOW</title><p>Correlating genomic readouts of tumors with clinical parameters has helped us associate molecular signatures with disease prognosis (<xref ref-type="bibr" rid="bib1">Abida et al., 2019</xref>). Given the prominence of phenotypic heterogeneity in tumors, it is important to understand the connection between molecular signatures of cellular populations and disease aggressiveness. Existing methods map tumor samples to a handful of well-characterized molecular subtypes with known survival patterns primarily obtained from bulk RNA-seq studies. However, bulk RNA-seq measures the average level of gene expression distributed across millions of cells in a tissue sample, thereby obscuring the intra-tumoral heterogeneity (<xref ref-type="bibr" rid="bib114">Zhu et al., 2017</xref>). This limitation prompted us to turn to tumor scRNA-seq. Tumor scRNA-seq studies have successfully revealed the extent of gene expression variance across individual malignant cells, contributing to an in-depth understanding of the mechanisms driving cancer progression (<xref ref-type="bibr" rid="bib6">Baslan and Hicks, 2017</xref>). However, to date, most studies use marker genes identified from bulk RNA-seq studies to characterize malignant cell clusters identified from scRNA-seq data. This approach is inadequate since every tumor is unique when looked through the lenses of single-cell expression profiles (<xref ref-type="bibr" rid="bib110">Zhang et al., 2021</xref>). Bulk markers alone cannot adequately capture the intricate heterogeneity present within tumors, as different tumors may exhibit distinct phenotypes with varying degrees of aggressiveness at the single-cell level. While existing methods effectively reveal the subpopulations, they are insufficient in associating malignant risk with specific cellular subpopulations identified from scRNA-seq data. The proposed approach, SCellBOW, can effectively capture the heterogeneity and risk associated with each phenotype, enabling the identification and assessment of malignant cell subtypes in tumor microenvironment directly from scRNA-seq gene expression profiles, thereby eliminating the need for marker genes (<xref ref-type="fig" rid="fig1">Figure 1</xref>). Below, we highlight key constructions and benefits of this new approach.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>SCellBOW workflow.</title><p>(<bold>a</bold>) Schematic overview of SCellBOW workflow for identifying cellular clusters and assessing the aggressiveness of the predicted clusters. For SCellBOW clustering, firstly, a corpus was created from the gene expression matrix, where cells were analogous to documents and genes to words. Next, the pre-trained model was retrained with the vocabulary of the target dataset. Then, clustering was performed on embeddings generated from the neural network. For SCellBOW <italic>phenotype algebra</italic>, vectors were created for reference (<italic>total tumor</italic>) and queries. Then, the query vector was subtracted from the reference vector to calculate the predicted risk score using a bootstrapped random survival forest. Finally, survival probability was evaluated, and phenotypes were stratified by the median predicted risk score. Created using <ext-link ext-link-type="uri" xlink:href="https://BioRender.com/syu9el4">BioRender.com</ext-link>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98469-fig1-v1.tif"/></fig><p>SCellBOW adapts the popular document-embedding model Doc2vec for single-cell latent representation learning, which can be used for downstream analysis. SCellBOW represents cells as documents and gene names as words. Gene expression levels are encoded by 'word frequencies’, that is variation in gene expression values is captured by introducing gene names in proportion to their intensities in cells. SCellBOW encodes each cell into low-dimensional embeddings. SCellBOW extracts the gene expression patterns of individual cells from a relatively large unlabeled source scRNA-seq dataset by pre-training a shallow source network. The neuronal weights estimated during pre-training are transferred to a relatively smaller unlabeled scRNA-seq dataset, where they are refined based on the gene expression patterns in the target dataset. SCellBOW leverages the variability in gene expression values to subsequently cluster cells according to their semantic similarity.</p><p>Building upon capability of SCellBOW to preserve the semantic meaning of individual cells, we established meaningful associations among cellular phenotypes. SCellBOW offers a remarkable feature for executing algebraic operations such as '+' and '–' on single cells in the latent space while preserving the biological meanings. This feature catalyzes the simulation of the residual phenotype of tumors, following positive and negative selection of specific cell subtype in a tumor. This could potentially be used to identify the contribution of that phenotype to patient survival. For example, the '–' operation can be used to predict the likelihood of survival by eliminating the impact of a specific aggressive cellular phenotype from the whole tumor. We empirically show the retention of such semantic relationships in the context of cellular phenotypes of cancer cells using <italic>phenotype algebra</italic>. SCellBOW uses algebraic operations to compare and analyze the importance of cellular phenotypes working independently or in combination toward the aggressiveness of the tumor in a way that is not possible using traditional methods. <italic>Phenotype algebra</italic> can be performed either on the pre-defined cancer subtypes or SCellBOW clusters. Drawing from the overall performance of SCellBOW in accurately clustering and ranking cellular phenotypes by aggressiveness, we further analyzed multi-patient scRNA-seq data of metastatic prostate cancer and characterized an unknown, de-differentiated AR−/NE<sub>low</sub> subpopulation of malignant cells.</p></sec><sec id="s2-2"><title>SCellBOW effectively captures latent space of single-cell phenotypes</title><p>Malignant cells are far more heterogeneous compared to associated normal cells. Clustering is often the first step toward recognizing cellular lineages in a tumor sample. Clustering single cells based on their molecular profiles can potentially identify rare cell populations with distinct phenotypes and clinical outcomes. To evaluate the strength of the clustering ability of SCellBOW, we benchmarked our method against five existing scRNA-seq clustering methods (<xref ref-type="bibr" rid="bib111">Zhao et al., 2021</xref>; <xref ref-type="bibr" rid="bib15">Butler et al., 2018</xref>; <xref ref-type="bibr" rid="bib102">Wolf et al., 2018</xref>; <xref ref-type="bibr" rid="bib60">Li et al., 2020</xref>; <xref ref-type="bibr" rid="bib44">Hu et al., 2020</xref>; <xref ref-type="table" rid="app1table1">Appendix 1—table 1</xref>). Among these packages, Seurat (<xref ref-type="bibr" rid="bib15">Butler et al., 2018</xref>) and Scanpy (<xref ref-type="bibr" rid="bib102">Wolf et al., 2018</xref>) are the most popular, and both employ graph-based clustering techniques. DESC (<xref ref-type="bibr" rid="bib60">Li et al., 2020</xref>) is a deep neural network-based scRNA-seq clustering package, whereas ItClust (<xref ref-type="bibr" rid="bib44">Hu et al., 2020</xref>) and scETM (<xref ref-type="bibr" rid="bib111">Zhao et al., 2021</xref>) are transfer learning methods. All the packages are resolution-dependent except for ItClust. ItClust automatically selects the resolution with the highest silhouette score. We used a number of scRNA-seq datasets to evaluate the methods cited above (<xref ref-type="table" rid="app1table2">Appendix 1—table 2</xref>). For the objective evaluation of performance, we used an adjusted Rand index (ARI) and normalized mutual information (NMI) to compare clusters with known cell annotations (<xref ref-type="table" rid="app1table3">Appendix 1—table 3</xref>). For all methods, except for ItClust, we computed overall ARI and NMI for different resolution values ranging between 0.2 and 2.0. We computed the cell type silhouette index (SI) based on known annotations to measure the signal-to-noise ratio of low-dimensional single-cell embeddings.</p><p>We constructed three use cases leveraging publicly available scRNA-seq datasets. Each instance constitutes a pair of single-cell expression datasets of which the source data is used for self-supervised model training and the target data for model fine-tuning and analysis of the clustering outcomes. In all cases, the target data has associated cell type annotations derived from fluorescence-activated cell sorting (FACS) enriched pure cell subpopulations. The first use case consists of non-cancerous cells from prostate cancer patients (<xref ref-type="bibr" rid="bib51">Karthaus et al., 2020</xref>; 120,300 cells) as the source data and cells from healthy prostate tissues (<xref ref-type="bibr" rid="bib43">Henry et al., 2018</xref>; 28,606 cells) as the target data. This use case was designed to assess the resiliency of SCellBOW to the presence of disease covariates in a large scRNA-seq dataset. The second use case comprises a large PBMC dataset (<xref ref-type="bibr" rid="bib112">Zheng et al., 2017</xref>; 68,579 cells) as the source data, whereas the target data was sourced from a relatively small FACS-annotated PBMC dataset (2700 cells) from the same study. The third use case, as source data, comprises pancreatic cells from three independent studies processed with different single-cell profiling technologies (inDrop <xref ref-type="bibr" rid="bib5">Baron et al., 2016</xref>, CEL-Seq2 <xref ref-type="bibr" rid="bib71">Muraro et al., 2016</xref>, SMARTer <xref ref-type="bibr" rid="bib99">Wang et al., 2016</xref>). The target data used in this case was from an independent study processed with a different technology, Smart-Seq2 (<xref ref-type="bibr" rid="bib83">Segerstolpe et al., 2016</xref>; <xref ref-type="fig" rid="fig2">Figure 2</xref>, <xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref>). For the normal prostate, PBMC, and pancreas datasets, SCellBOW produced the highest ARI scores across most notches of the resolution spectrum (0.2–2.0; <xref ref-type="fig" rid="fig2">Figure 2g–i</xref>). We observed a similar trend in the case of NMI (<xref ref-type="fig" rid="fig2">Figure 2j</xref>). SCellBOW exhibited the highest NMI compared to other methods for the normal prostate, PBMC, and pancreas datasets. For further deterministic evaluation of the different methods across the datasets, we set 1.0 as the default resolution for calculating cell type SI (<xref ref-type="fig" rid="fig2">Figure 2k</xref>). In the PBMC and pancreas datasets, SCellBOW yielded the highest cell type SI for both datasets. SCellBOW and Seurat were comparable in performance for the pancreas dataset, outperforming other methods. We observed poor performance by DESC and ItClust across all the datasets in terms of cell type SI. In terms of cell type SI, Seurat and scETM, showed improved results in the normal prostate dataset. However, SCellBOW outperformed both Seurat and scETM in terms of overall ARI and NMI for the same dataset, indicating higher clustering accuracy. To further evaluate the cluster quality in the normal prostate dataset, we compared the known cell types to the predicted clusters. Known cell types such as basal epithelial, luminal epithelial, and smooth muscle cells were grouped into homogeneous clusters by SCellBOW (<xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2</xref>). We observed that the majority of fibroblasts and endothelial cells were mapped by SCellBOW to single clusters, unlike Seurat and scETM. SCellBOW retained hillock cells in close proximity to both basal epithelial and club cells, in contrast to Seurat, which only includes basal epithelial cells. We compared SCellBOW with two additional methods– scBERT (<xref ref-type="bibr" rid="bib107">Yang et al., 2022</xref>) and scPhere (<xref ref-type="bibr" rid="bib28">Ding and Regev, 2021</xref>). Among these, scBERT is a transfer learning-based method built upon BERT (<xref ref-type="bibr" rid="bib26">Devlin et al., 2018</xref>). scPhere is a deep generative model designed for embedding single cells into low-dimensional hyperspherical or hyperbolic spaces. While scBERT offers competitive performance, scPhere consistently falls behind the other methods (<xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3</xref>, Appendix 2—note 1).</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Evaluation of single-cell representations using SCellBOW.</title><p>(<bold>a–c</bold>) UMAP plots for the normal prostate (<bold>a</bold>), PBMC (<bold>b</bold>), and pancreas (<bold>c</bold>) datasets. The coordinates are colored by cell types. (<bold>d-f</bold>) UMAP plots for normal prostate (<bold>d</bold>), PBMC (<bold>e</bold>), and pancreas (<bold>f</bold>) datasets, where the coordinates are colored by SCellBOW clusters. CL is used as an abbreviation for cluster. (<bold>g–i</bold>) Radial plot for the percentage of contribution of different methods towards ARI for various resolutions ranging from 0.2 to 2.0. ItClust is a resolution-independent method; thus, the ARI is kept constant across all the resolutions. (<bold>j</bold>) Box plot for the NMI of different methods across different resolutions ranging from 0.2 to 2.0 in steps of 0.2. (<bold>k</bold>) Bar plot for the cell type silhouette index (SI) for different methods. The default resolution was set to 1.0.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98469-fig2-v1.tif"/></fig><p>Our analyses of the public datasets confirm the robustness of SCellBOW compared to the prominent single-cell analysis methods, including the prominent transfer learning methods. To this end, we applied SCellBOW to investigate a more challenging task of analyzing an in-house scRNA-seq data comprising splenocytes and matched PBMCs from two healthy and two brain-dead donors (<xref ref-type="fig" rid="fig3">Figure 3a</xref>). Given multiple covariates, such as the origin of the cells and the physiological states of the donors, analysis of this scRNA-seq data presents a challenging use case (<xref ref-type="fig" rid="fig3">Figure 3b and c</xref>). We used the established high-throughput scRNA-seq platform CITE-seq (<xref ref-type="bibr" rid="bib86">Stoeckius et al., 2017</xref>) to pool eight samples into a single experiment. After post-sequencing quality control, we were left with 4819 cells. We annotated the cells using Azimuth (<xref ref-type="bibr" rid="bib40">Hao et al., 2021</xref>), with occasional manual interventions (<xref ref-type="fig" rid="fig3">Figure 3d</xref><bold>,</bold> <xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4d–f</xref>, Appendix 2—note 2). We quantitatively evaluated SCellBOW and the rest of the benchmarking methods by measuring ARI, NMI, and cell type SI (<xref ref-type="fig" rid="fig3">Figure 3e</xref>, <xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3d–f</xref>). While most methods did reasonably well, SCellBOW offered an edge. We observed the best results in SCellBOW in terms of ARI, NMI, and cell type SI compared to other methods (<xref ref-type="table" rid="app1table3">Appendix 1—table 3</xref>). SCellBOW yielded clusters largely coherent with the independently done cell type annotation using Azimuth (<xref ref-type="fig" rid="fig3">Figure 3</xref>, <xref ref-type="fig" rid="app2fig5">Appendix 2—figure 5</xref>). Further, most clusters harbor cells from all the donors, indicating that the sample pooling strategy was effective in reducing batch effects. B cells, T cells, and NK cells map to SCellBOW clusters where the respective cell types are the majority. Most CD4 +T cells map to CL0 and CL9 (here, CL is used as an abbreviation for cluster; <xref ref-type="fig" rid="fig3">Figure 3f</xref>). CL0 is shared between CD8 +T cells, CD4 +T cells, and Treg cells, which originate from the same lineage. CL4 majorly consists of NK cells with a small fraction of CD8 +T cells, which is not unduly deviant from the PBMC lineage tree. As a control, we performed similar analyses of the Scanpy clusters (<xref ref-type="fig" rid="fig3">Figure 3g</xref>). While Scanpy performed reasonably well, misalignments could be spotted. For example, CD4 +and CD8+T cells were split across many clusters with mixed cell type mappings. SCellBOW maps CD14 monocytes to a single cluster, whereas Scanpy distributes CD14 monocytes across two clusters (CL1 and CL8), wherein CL8 is equally shared with conventional Dendritic Cells (cDC). 'Eryth' annotated cells are indignantly mapped to different clusters by both SCellBOW and Scanpy. This could be due to the Azimuth’s reliance on high mitochondrial gene expression levels for annotating erythroid cells (Appendix 2—note 3). However, SCellBOW CL6 is dominated by Erythroid cells with marginal interference from other cell types. In the case of Scanpy, no such cluster could be detected. Discerning phenotypic heterogeneity from the expression profiles of seemingly similar cells is a challenging task. The performance of SCellBOW, with near-ground-truth cell type annotation, in such a scenario confirmed its ability to adequately decipher the underlying cellular heterogeneity and provide robust cell type clustering.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Evaluation of in-house splenocytes and matched PBMC dataset.</title><p>(<bold>a</bold>) An experiment schematic diagram highlighting the sites of the organs for tissue collection and sample processing. In this matched PBMC-splenocyte CITE-seq experiment, PBMCs and splenocytes were collected, followed by high-throughput sequencing and downstream analyses. Created using <ext-link ext-link-type="uri" xlink:href="https://BioRender.com/syu9el4">BioRender.com</ext-link>. (<bold>b, c</bold>) UMAP plots for SCellBOW embedding colored by donors (<bold>b</bold>) and cell types (<bold>c</bold>). (<bold>d</bold>) The UMAP plots for the embedding of SCellBOW compared to different benchmarking methods. The coordinates of all the plots are colored by cell type annotation results using Azimuth. (<bold>e</bold>) Bar plot for ARI, NMI, cell type SI at resolution 1.0. (<bold>f, g</bold>) Alluvial plots for Azimuth cell types mapped to SCellBOW clusters (<bold>f</bold>) and Scanpy clusters (<bold>g</bold>). The resolution of SCellBOW was set to 1.0. CL is used as an abbreviation for cluster.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98469-fig3-v1.tif"/></fig></sec><sec id="s2-3"><title>SCellBOW enables survival risk attribution of tumor subpopulations</title><p>Every cancer features unique genotypic as well as phenotypic diversity, impeding the personalized management of the disease. The widespread adoption of genomics in cancer care has allowed correlating molecular portraits of tumors with patient survival in all major cancers. A few studies suggested that there is an association between the tumorigenicity of stromal cells in tumor microenvironments and patient survival (<xref ref-type="bibr" rid="bib30">Dwivedi et al., 2022</xref>). This has sparked debate about the utility of single-cell gene expression in profiling single tumor cells. The <italic>phenotype algebra</italic> module of SCellBOW estimates the relative aggressiveness of different malignant and non-malignant cell subtypes using survival information as a surrogate. This presents an opportunity to gauge the aggressiveness of each cancer cell subtype in a tumor. For example, subtracting an aggressive phenotype from the <italic>total tumor</italic> (average of SCellBOW embeddings across all cells in a tumor) would better the odds of survival relative to dropping a subtype under negative selection pressure. By associating the embedding vectors, representing <italic>total tumor – a specific cell cluster,</italic> with tumor aggressiveness, <italic>phenotype algebra</italic> immediately opens a way to infer the level of aggressiveness of a particular cluster of cancer cells obtained through single-cell clustering.</p><p>As proof of concept, we first validated our approach on glioblastoma multiforme (GBM), which has been studied widely employing single-cell technologies. GBM has three well-characterized malignant subtypes: proneural (PRO), classical (CLA), and mesenchymal (MES; <xref ref-type="bibr" rid="bib89">Tang et al., 2021</xref>; <xref ref-type="bibr" rid="bib7">Behnan et al., 2019</xref>). We obtained known markers of PRO, CLA, and MES to annotate 4508 malignant GBM cells obtained from a single patient reported by Couturier and colleagues (<xref ref-type="bibr" rid="bib22">Couturier et al., 2020</xref>) and used it as our target data (<xref ref-type="fig" rid="fig4">Figure 4a</xref>; for details on cell type annotation, refer to Appendix 1, Supplementary methods 2.1). As the source data, we used the GBM scRNA-seq data from <xref ref-type="bibr" rid="bib72">Neftel et al., 2019</xref>. The survival data consisted of 613 bulk GBM samples with paired survival information from the TCGA consortium. We constructed the following query vectors for the survival prediction task: <italic>total tumor</italic>, i.e., average of embeddings of all malignant cells, <italic>total tumor</italic> – (MES +CLA), <italic>total tumor</italic> – MES/CLA/PRO (individually). We conjectured that for the most aggressive malignant cell subtype, <italic>total tumor – subtype specific pseudo-bulk</italic>, would yield the biggest drop in survival risk relative to the <italic>total tumor</italic>. Survival risk predictions associated with <italic>total tumor</italic> – MES/CLA/PRO thus obtained reaffirmed the clinically known aggressiveness order, that is CLA ≻ MES ≻ PRO, where CLA succeeds the rest of the subtypes in aggressiveness (<xref ref-type="bibr" rid="bib62">Lin et al., 2014</xref>; <xref ref-type="fig" rid="fig4">Figure 4c and d</xref>). More complex queries can be formulated, such as <italic>total tumor</italic> – (MES +CLA)<italic>,</italic> which indicates that the tumor does not comprise the two most aggressive phenotypes, CLA and MES, and instead consists only of PRO cells. Hypothetically, this represents the most favorable scenario, as testified by the <italic>phenotype algebra</italic> (<xref ref-type="bibr" rid="bib7">Behnan et al., 2019</xref>; <xref ref-type="bibr" rid="bib77">Patel et al., 2014</xref>).</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title><italic>Phenotype algebra</italic> on GBM and BRCA known molecular subtypes.</title><p>(<bold>a</bold>) Heatmap for GSVA score for three molecular subtypes of GBM: CLA, MES, and PRO, grouped by SCellBOW clusters at resolution 1.0. (<bold>b</bold>) UMAP plot for the embedding of BRCA target dataset colored by PAM50 molecular subtype. (<bold>c</bold>) Survival plot for GBM molecular subtypes based on <italic>phenotype algebra</italic>. (<bold>d</bold>) Violin plot for predicted risk scores for GBM molecular subtypes, with n = 50 bootstrapped models per subtype. (<bold>e</bold>) Survival plot for BRCA molecular subtypes based on <italic>phenotype algebra</italic>. The <italic>total tumor</italic> is denoted by <italic>T</italic>. (<bold>f</bold>) Violin plot for predicted risk scores for BRCA molecular subtypes with n = 50 bootstrapped models per subtype.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98469-fig4-v1.tif"/></fig><p>We performed a similar benchmarking on well-established PAM50-based (<xref ref-type="bibr" rid="bib76">Parker et al., 2009</xref>) breast cancer (BRCA) subtypes: luminal A (LUMA), luminal B (LUMB), HER2-enriched (HER2), basal-like (BASAL), and normal-like (NORMAL; <xref ref-type="fig" rid="fig4">Figure 4b</xref>). We used 24,271 cancer cells from <xref ref-type="bibr" rid="bib104">Wu et al., 2020</xref> as the source data, 545 single-cell samples from <xref ref-type="bibr" rid="bib113">Zhou et al., 2021</xref> as the target data. We used 1,079 bulk BRCA samples with paired survival information from TCGA as the survival data. SCellBOW-predicted survival risks for the different subtypes were generally in agreement with the clinical grading of the PAM50 subtypes (<xref ref-type="bibr" rid="bib67">Mathews et al., 2019</xref>; <xref ref-type="bibr" rid="bib100">Weigelt et al., 2010</xref>). Exclusion of LUMA from <italic>total tumor</italic> yielded the highest risk score, indicating that LUMA has the best prognosis, followed by HER2 and LUMB, whereas BASAL and NORMAL were assigned worse prognosis (<xref ref-type="bibr" rid="bib42">Hennigs et al., 2016</xref>; <xref ref-type="bibr" rid="bib3">Ahn et al., 2015</xref>; <xref ref-type="bibr" rid="bib108">Yersal and Barutca, 2014</xref>; <xref ref-type="fig" rid="fig4">Figure 4e and f</xref>). We observed an interesting misalignment from the general perception about the relative aggressiveness of the NORMAL subtype- removal of this subtype from <italic>total tumor</italic> indicated the highest improvement in prognosis. The NORMAL subtype is a poorly characterized and rather heterogeneous category. Recent evidence suggests that these tumors potentially represent an aggressive molecular subtype and are often associated with highly aggressive claudin-low tumors (<xref ref-type="bibr" rid="bib67">Mathews et al., 2019</xref>; <xref ref-type="bibr" rid="bib64">Liu et al., 2014</xref>).</p><p>To evaluate the dependence of <italic>phenotype algebra</italic> on SCellBOW embeddings, we first applied <italic>phenotype algebra</italic> directly to the raw gene expression data instead of the SCellBOW-derived embeddings. The results demonstrated that raw gene expression data alone was insufficient for accurate risk stratification (<xref ref-type="fig" rid="app2fig6">Appendix 2—figure 6a and b</xref>; further description in Appendix 2—note 4). To further validate the efficiency of SCellBOW in learning meaningful single-cell latent representation, we compared its fixed-length embeddings for <italic>phenotype algebra</italic> to those generated by other methods- scETM, scBERT, and scPhere (<xref ref-type="fig" rid="app2fig7">Appendix 2—figure 7a–f</xref>). Our results showed that SCellBOW learned latent representation of single cells accurately captures the ‘semantics' associated with cellular phenotypes. Whereas scETM, scBERT, and scPhere fail to stratify cancer clones in terms of their aggressiveness and contribution to disease prognosis. These benchmarking studies on the well-characterized cancer subtypes of GBM and BRCA affirm capability of SCellBOW to preserve the desirable characteristics in the resulting phenotypes obtained as outputs of algebraic expressions involving other independent phenotypes and operators such as +/–.</p></sec><sec id="s2-4"><title>SCellBOW enables accurate phenotype stratification across tumor microenvironment</title><p>In prostate cancer, the processes of transdifferentiation and dedifferentiation are vital in metastasis and treatment resistance (<xref ref-type="bibr" rid="bib36">Gupta et al., 2019</xref>; <xref ref-type="fig" rid="fig5">Figure 5a</xref>). Prostate cancer originates from secretory prostate epithelial cells, where AR, a transcription factor regulated by androgen, plays a key role in driving the differentiation (<xref ref-type="bibr" rid="bib33">Formaggio et al., 2021</xref>; <xref ref-type="bibr" rid="bib85">Stelloo et al., 2015</xref>). Androgen-targeted therapies (ATTs) constitute the primary treatment options for metastatic prostate cancer, and they are most effective in well-differentiated prostate cancer cells with high AR activity. After prolonged treatment with ATTs, the cancers eventually progress towards metastatic castration-resistant prostate cancer (mCRPC), which is highly recalcitrant to therapy (<xref ref-type="bibr" rid="bib31">Einstein et al., 2021</xref>). In response to more potent ATTs, the prostate cancer cells adapt to escape reliance on AR with low AR activity. The loss of differentiation pressure results in altered states of lineage plasticity in prostate tumors (<xref ref-type="bibr" rid="bib4">Antonarakis, 2019</xref>; <xref ref-type="bibr" rid="bib9">Beltran et al., 2019</xref>). The most well-defined form of treatment-induced plasticity is neuroendocrine transformation. NEPC is highly aggressive, that often manifests with visceral metastases and currently lacks effective therapeutic options (<xref ref-type="bibr" rid="bib4">Antonarakis, 2019</xref>; <xref ref-type="bibr" rid="bib106">Yamada and Beltran, 2021</xref>). Recent studies have pointed toward the existence of additional prostate cancer phenotypes that emerge through lineage plasticity and metastasis of malignant cells (<xref ref-type="bibr" rid="bib37">Han et al., 2022</xref>). This includes malignant phenotypes such as low AR signaling and DNPC, which lack AR activity and NE features. These additional phenotypes, resulting from the mechanisms of resistance to AR inhibition, can likewise be characterized by distinct gene expression patterns. Presumably, these phenotypes represent an intermediate or transitory state of the progression trajectory from high AR activity to neuroendocrine transdifferentiation (<xref ref-type="bibr" rid="bib55">Labrecque et al., 2019</xref>).</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title><italic>Phenotype algebra</italic> on mCRPC known molecular subtypes based on AR- and NE-activity.</title><p>(<bold>a</bold>) Schematic of the transdifferentiation states underlying lineage plasticity that occurs during mCRPC progression from an ARPC to NEPC. Created using <ext-link ext-link-type="uri" xlink:href="https://BioRender.com/syu9el4">BioRender.com</ext-link>. (<bold>b</bold>) Scatter plot of GSVA scores of ARPC and NEPC gene sets, K-means clustering was used to allocate cells into the three high-level ARAH, ARAL, and NEPC categories. (<bold>c</bold>) UMAP plot for projection of SCellBOW embedding colored by ARAH, ARAL, and NEPC. (<bold>d</bold>) Heatmap showing the top differentially expressed genes (y-axis) between each high-level category (x-axis) and all other cells, tested with a Wilcoxon rank-sum test. (<bold>e</bold>) Survival plot for mCRPC cancer phenotypes based on <italic>phenotype algebra</italic>. The t<italic>otal tumor</italic> is denoted by <italic>T</italic>. (<bold>f</bold>) Violin plot for predicted risk scores for mCRPC phenotypes - ARAH, ARAL, and NEPC, with n = 50 bootstrapped models per subtype. (<bold>g</bold>) Survival plot for mCRPC tumor microenvironment phenotypes based on <italic>phenotype algebra</italic>. The t<italic>otal tumor</italic> is denoted by <italic>T</italic>. (<bold>h</bold>) Violin plot of predicted risk scores for mCRPC tumor microenvironment phenotypes, comparing tumor and normal cells, with n = 50 bootstrapped models per group.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98469-fig5-v1.tif"/></fig><p>Here, we performed a pooled analysis of scRNA-seq target data consisting of 836 malignant cells derived from tumors collected from 11 tumors (mCRPC) (<xref ref-type="bibr" rid="bib41">He et al., 2021</xref>). We initially classified cells into three categories - AR activity high (AR+/NE–, ARAH), AR activity low (AR<sub>low</sub>/NE–, ARAL), and neuroendocrine (AR–/NE+, NE). The classification was based on the known molecular signatures associated with ARPC and NEPC genes (<xref ref-type="bibr" rid="bib68">Merkens et al., 2022</xref>; <xref ref-type="fig" rid="fig5">Figure 5b</xref>; for details on cell type annotation, refer to Appendix 1, Supplementary methods 2.2). We used the pre-trained model built on the (<xref ref-type="bibr" rid="bib51">Karthaus et al., 2020</xref>) dataset for transfer learning. We used 81 advanced metastatic prostate cancer patient samples with paired survival information from <xref ref-type="bibr" rid="bib1">Abida et al., 2019</xref> as the survival data. We subsequently assessed the relative aggressiveness of these high-level categories using <italic>phenotype algebra</italic> (<xref ref-type="fig" rid="fig5">Figure 5e and f</xref>). We observed that subtracting the latent signature associated with the NE subtype from the tumor led to the largest drop in the predicted risk score, aligning with the anticipated order of survival (<xref ref-type="bibr" rid="bib19">Catapano et al., 2022</xref>). In contrast, removing the ARAH subtype from the <italic>total tumor</italic> had a minimal impact on the predicted risk score. Furthermore, subtracting the ARAL subtype resulted in a predicted risk score between ARAH and NE, which supports the hypothesis that ARAL represents an intermediate state between ARAH and NE (<xref ref-type="bibr" rid="bib68">Merkens et al., 2022</xref>). Upon further examination of the tumor prognosis by removing the subtypes in a combined state (ARAH +ARAL + NE), the <italic>total tumor</italic> had the highest positive improvement. The survival probability graph also followed the same order. Furthermore, when compared to other methods—scETM, scBERT, and scPhere—as well as raw gene expression data, these tools struggled to accurately stratify the subtypes based on their aggressiveness (<xref ref-type="fig" rid="app2fig6">Appendix 2—figure 6c</xref>, <xref ref-type="fig" rid="app2fig7">Appendix 2—figure 7g–i</xref>, Appendix 2—note 4).</p><p>Till now, <italic>phenotype algebra</italic> has been used primarily for the stratification of cancer subpopulations. The tumor microenvironment includes malignant cells as well as various non-malignant cell types. This diverse cellular composition significantly influences the response to drug treatments. While malignant cells within a tumor typically show a great extent of heterogeneity, other cell types, such as immune cells, fibroblasts, and others, go through functional changes and variations in the amount of tumor infiltration. Therefore, it is crucial to distinguish and analyze the expression signals originating from the tumor cells in order to get a clearer picture of the gene expression changes in the cancer cells. This approach allows for a more accurate characterization of cancer subtypes based on the intrinsic properties of the malignant cells themselves. However, it is not always straightforward to unambiguously distinguish malignant from non-malignant cells in the complex environment of a tumor. To evaluate the capability of <italic>phenotype algebra</italic> in distinguishing between malignant and non-malignant cells, we applied it to single-cell transcriptome profiles of the mCRPC tumor microenvironment. This dataset, obtained from <xref ref-type="bibr" rid="bib41">He et al., 2021</xref>, consists of 2170 cells, including malignant cells as well as various immune and stromal cell types (<xref ref-type="fig" rid="app2fig8">Appendix 2—figure 8h</xref>). We used the authors' annotations for cell-type classification. We observed that the predicted risk score decreases when aggressive cancer subtypes are removed from the whole tumor population (<xref ref-type="fig" rid="fig5">Figure 5g and h</xref>). Conversely, the risk score increases when immune cells are removed, suggesting that immune presence influences overall tumor aggressiveness. These results highlight the ability of <italic>phenotype algebra</italic> to capture and quantify risk signals from gene expression data, effectively distinguishing between malignant and non-malignant subpopulations in the tumor microenvironment.</p></sec><sec id="s2-5"><title>SCellBOW identifies malignant subpopulations with distinct risk profiles</title><p>Grouping prostate cancer cells into three high-level categories is an oversimplified view of the actual heterogeneity of advanced prostate cancer biology. Herein, SCellBOW clusters could be utilized to discover novel subpopulations based on the single-cell expression profiles that result from therapy-induced lineage plasticity. Subsequently, <italic>phenotype algebra</italic> can assign a relative rank to these clusters under a negative selection pressure based on their aggressiveness. We utilized this concept to cluster the malignant cells from <xref ref-type="bibr" rid="bib41">He et al., 2021</xref> using SCellBOW, resulting in eight clusters, and then we predicted the relative risk for each cluster (<xref ref-type="fig" rid="fig6">Figure 6a and b</xref>). This approach enables a novel and more refined understanding of lineage plasticity states and characteristics that determine aggressiveness during prostate cancer progression. This goes beyond the conventional categorization into ARAH, ARAL, and NE.</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Phenotype algebra on <xref ref-type="bibr" rid="bib41">He et al., 2021</xref> mCRPC data based on SCellBOW clusters.</title><p>(<bold>a</bold>) UMAP plot for projection of embeddings with coloring based on the SCellBOW clusters at resolution 0.8. CL is used as an abbreviation for cluster. (<bold>b</bold>) Violin plot of <italic>phenotype algebra</italic>-based cluster-wise risk scores for SCellBOW clusters based on <italic>phenotype algebra</italic>-based predictions. (<bold>c</bold>) Patient and organ site distribution across the SCellBOW clusters. (<bold>d</bold>) Illustration of the distribution of cells from the three high-level groups- ARAH, ARAL, and NEPC across the SCellBOW clusters. (<bold>e</bold>) Bubble plot of row-scaled GSVA scores for custom curated gene sets containing activated and repressed AR- and NE- signatures. (<bold>f</bold>) Correlation plot of six phenotypic categories based on DSP gene expression correlated with the SCellBOW clusters based on scRNA-seq gene expression. The six phenotypic categories are defined by <xref ref-type="bibr" rid="bib14">Brady et al., 2021</xref> based on the activity of AR and NE programs. (<bold>g</bold>) Top gene sets correlated with SCellBOW clusters. Signatures were collected from the C2 ‘‘curated’’, C5 ‘‘Gene Ontology’’, and H ‘‘hallmark’’ gene sets from mSigDB (<xref ref-type="bibr" rid="bib61">Liberzon et al., 2015</xref>). Ranking by row scaled GSVA scores of one cluster against all others.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98469-fig6-v1.tif"/></fig><p>To further elucidate these altered cellular programs, we performed a gene set variation analysis (GSVA; <xref ref-type="bibr" rid="bib39">Hänzelmann et al., 2013</xref>) based on the AR- and NE- activity (Appendix 1, Supplementary methods 3, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). Our result showed that CL4 is characterized by the highest expression of NE-associated genes and the absence of AR-regulated genes, indicating the conventional NEPC subtype. Despite CL4 having the strongest NEPC signatures, eliminating CL2 from the tumor conferred an even higher aggressiveness level. Overall, we observed that, unlike other clusters, CL2 is composed of cells from the majority of drug-treated patients and multiple metastatic sites (<xref ref-type="fig" rid="fig6">Figure 6c</xref>). This highlights that the clustering is not confounded by the individuals or the tissue origin, as often observed during integrative analysis of tumor scRNA-seq data. CL2 instead features a unique gene expression profile common to these cells. Moreover, CL2 has a mixed signature entailing ARAH, ARAL, and NE, indicating the emergence of a more transdifferentiated subtype as a consequence of therapy-induced lineage plasticity (<xref ref-type="fig" rid="fig6">Figure 6d</xref>). Even though CL2 shows NE signature, it is distinguished by the gene expression signature induced by the inactivation of the androgen signaling pathway due to ATTs. As a consequence, cells manifesting this novel signature are grouped into a single cluster (<xref ref-type="fig" rid="fig6">Figure 6e</xref>). Among all clusters, CL1 and CL3 resemble the traditional ARAH subtype. According to our <italic>phenotype algebra</italic> model, excluding CL6 and CL7 from the <italic>total tumor</italic> yielded the highest risk score. <xref ref-type="bibr" rid="bib14">Brady et al., 2021</xref> have broadly partitioned metastatic prostate cancer into six phenotypic categories using digital spatial profiling (DSP) transcript and protein abundance data in spatially defined metastasis regions. To categorize the SCellBOW clusters into these broad phenotypes, we performed Pearson’s correlation test between averaged DSP expression measurements of the six phenotypes and averaged scRNA-seq expression of the SCellBOW clusters (<xref ref-type="fig" rid="fig6">Figure 6f</xref>). The results revealed that CL2 has the highest correlation with the phenotype defined by lack of expression of AR signature genes and low or heterogeneous expression of NE-associated genes (AR–/NE<sub>low</sub>). Similarly, as expected, CL4 showed the highest correlation with the NEPC phenotype defined by positive expression of NE-associated genes without AR activity (AR–/NE+). Meanwhile, CL6 exhibits a closer resemblance to a DNPC phenotype (AR–/NE–).</p><p>To gain a deeper understanding of these modified cellular processes in CL2 compared to other clusters, we conducted cluster-wise functional GSVA based on the hallmarks of cancer (<xref ref-type="fig" rid="fig6">Figure 6g</xref>). We observed that CL2 exhibited the least prostate cancer signature, indicating that this cluster has deviated from prototypical prostate cancer behavior. It has rather dedifferentiated into a more aggressive phenotype as a consequence of therapy-induced lineage plasticity (<xref ref-type="bibr" rid="bib98">Wang et al., 2014</xref>; <xref ref-type="bibr" rid="bib68">Merkens et al., 2022</xref>). CL2 exhibited the highest enrichment of genes related to cancer stemness compared to other clusters. CL2 showed pronounced repression of epithelial genes that are downregulated during the epithelial-to-mesenchymal transition (EMT). Furthermore, there is a lack of expression of genes that are upregulated during the reversion of mesenchymal-to-epithelial phenotype (MET). Thus, the cells in CL2 are undergoing a process of dedifferentiation from being epithelial cells and activating the mesenchymal gene networks. Existing studies have reported that adaptive resistance is positively correlated with the acquisition of mesenchymal traits in cancer (<xref ref-type="bibr" rid="bib38">Hangauer et al., 2017</xref>; <xref ref-type="bibr" rid="bib19">Catapano et al., 2022</xref>). CL2 was enriched with signatures associated with metastasis and drug resistance. Specifically, CL2 showed downregulation of the genes involved in drug metabolism and cellular response while upregulation of the genes associated with drug resistance. In cancer cells, the acquisition of stemness-like as well as cell dedifferentiation (mesenchymal) traits can facilitate the formation of metastases and lead to the development of drug resistance (<xref ref-type="bibr" rid="bib18">Castellón et al., 2022</xref>). Further analysis of the metastatic potential of CL2 indicated that the cluster is enriched with genes associated with vasculature and angiogenesis. Tumors induce angiogenesis in the veins and capillaries of the host tissue to become vascularized, which is crucial for their growth and metastasis (<xref ref-type="bibr" rid="bib66">Lugano et al., 2020</xref>). Thus, based on our findings, we anticipate that CL2 corresponds to a highly aggressive and dedifferentiated subpopulation of mCRPC within the lineage plasticity continuum, correlating to poor patient survival and positive metastatic status. Our cluster-wise <italic>phenotype algebra</italic> results imply that the traits of the androgen and neuroendocrine signaling axes are not the exclusive defining features of the predicted risk ranking and that other, yet under-explored biological programs play additional important roles.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In this work SCellBOW, a scRNA-seq analysis framework inspired by NLP-based transfer learning approach can be utilized to decipher molecular heterogeneity from scRNA-seq profiles and infer survival risks associated with the individual cell subpopulations in tumor microenvironment. In this novel approach, cells are treated as a bag-of-molecules, similar to representing a document as a ‘bag’ of words (BOW), representing molecules in proportion to their abundance within each cell. SCellBOW uses a document embedding architecture to preserve the cellular similarities observed in the gene expression space. SCellBOW-learned neuronal weights are transferable. The model can use the knowledge acquired from a source dataset to warm start the learning process on a target dataset. Although Doc2vec is not commonly used for transfer learning, our experiments, which involve repurposing a pre-trained, modified Doc2vec model for scRNA-seq analysis, establish promising use cases for transfer learning (<xref ref-type="fig" rid="app2fig9">Appendix 2—figure 9</xref>, Appendix 2—note 5). SCellBOW accomplishes two major tasks: a. single-cell representation learning under a transfer learning framework facilitating high-quality cell clustering and visualization of scRNA-seq profiles. b. <italic>phenotype algebra</italic>, enabling the attribution of survival risk to tumor cell clusters obtained from tumor scRNA-seq data. For both tasks, we compared SCellBOW with several state-of-the-art single-cell analysis methods, including ones based on complex language modeling architectures (e.g. scETM uses a topic model, scBERT uses a transformer-inspired model). SCellBOW exhibited consistency in characterizing cellular heterogeneity through clustering and survival risk (aggressiveness) stratification of tumor cell subtypes.</p><p>With the SCellBOW, we observe considerable improvement in the quality of clustering and <italic>phenotype algebra</italic> results obtained from scRNA-seq target datasets. The existing single-cell transfer learning methods, such as scETM, ItClust, and scBERT, are pre-trained on large amounts of pre-annotated single-cell data to achieve good performance. However, using source data annotations as a reference limits the identification of new cell types in the target data. Moreover, the degree of imbalance in the cell type distribution substantially influences the performance of these methods (<xref ref-type="bibr" rid="bib53">Khan et al., 2023</xref>). It is important to realize that exploratory studies involving single-cell expression profiling require unsupervised data analysis. SCellBOW addresses these challenges by allowing self-supervised pre-training on gene expression datasets, learning the general syntax and semantic patterns from the unlabeled scRNA-seq dataset. Additionally, it is less susceptible to overfitting (<xref ref-type="bibr" rid="bib105">Wu et al., 2021</xref>), especially with small training datasets, owing to the shallow neural network used in SCellBOW, which enables faster convergence compared to other studied transfer learning methods (<xref ref-type="table" rid="app1table5">Appendix 1—table 5</xref>). Notably, SCellBOW, unlike ItClust and scETM, does not limit model training to genes intersecting between the source and the target datasets and is independent of the source data cell type annotation. Moreover, while methods such as scETM, ItClust, and scBERT utilize numerical gene expression values directly as an input to their network architectures, SCellBOW, for the first time, encodes gene expression profiles into documents in their native format.</p><p>We compared the clustering capability of SCellBOW to popular single-cell analysis techniques as well as some recently proposed transfer learning approaches. An array of scRNA-seq datasets was used for the same, representing different sizes, cell types, batches, and diseases. As evident from the comparative analyses, SCellBOW exhibits robustness and consistency across all data and metrics. We also reported tangible benefits of transfer learning from apt source data. For example, transfer learning with a large number of tumor-adjacent normal cells from the prostate as the source and healthy prostate cells as the target adequately portrayed the cell type diversity therein. SCellBOW reliably clustered pancreatic islet-specific cells that were processed using varied single-cell technologies. The prevalence of single-cell expression profiling and the heterogeneity of PBMCs make it one of the best-studied tissue systems in humans (<xref ref-type="bibr" rid="bib79">Phongpreecha et al., 2020</xref>). We isolated matched PBMCs and splenocytes from two healthy donors and two brain-dead donors (the cause of death is subarachnoid hemorrhage on aneurysm rupture). The utilization of this data presents a more intricate problem, where the cells originate from diverse biological and technical replicates, conditions, individuals, and organs. SCellBOW-based analysis of PBMCs with near-ground-truth cell type annotation confirmed its ability to adequately decipher underlying cellular heterogeneity. Our results allude to a visible improvement in scRNA-seq analysis outcomes, even with small sample sizes and multiple covariates, when contrasted with other best-practice single-cell clustering methods.</p><p>Beyond robust identification of cell type clusters, SCellBOW uses algebraic operations to analyze the cellular phenotypes that could potentially identify their contribution to patient survival outcomes. We have leveraged the power of word algebra through document embeddings to perform risk stratification of cancer subtypes based on their aggressiveness. This involves comparing the likelihood of a subtype being eliminated from the entire tumor under negative selection pressure. In addition to overall survival probability, SCellBOW assigns a risk score to discern the differences between equally aggressive subpopulations that may be hard to decipher from their survivability profiles. The <italic>phenotype algebra</italic> module exhibits resilience in describing the risk associated with malignant cell subpopulations arising from various types of cancer, which otherwise cannot be accomplished using gene expression data. We demonstrated a potential use case in estimating the survival risk of known molecular subtypes of three cancer types: GBM, BRCA, and mCRPC. Several examples were shown where simple algebraic operators such as '+' and '–' could derive clinically intuitive outcomes. For example, subtracting the CLA phenotype from the whole tumor resulted in an improvement in the survival risk in a GBM patient compared to MES and PRO subtypes. Upon further probing of the tumor prognosis by removal of the subtypes in combinations from the tumor, specifically, CLA and MES subtypes, which are known to be the most aggressive, we observed the highest improvement. To summarize, SCellBOW allows simulations involving multiple phenotypes. Our subsequent investigation focused on a BRCA dataset that harbors a more complex subtype structure. We observed a deviance in our results from the general perception about the relative aggressiveness of the NORMAL subtype in breast cancer. Notably, removing the NORMAL subtype from the <italic>total tumor</italic> was associated with the highest improvement in prognosis. This contradicts the common assumption that a NORMAL subtype is an artifact resulting from a high proportion of normal cells in the tumor specimen (<xref ref-type="bibr" rid="bib88">Strehl et al., 2011</xref>). Despite indications that these tumors often do not respond to neoadjuvant chemotherapy (<xref ref-type="bibr" rid="bib108">Yersal and Barutca, 2014</xref>), the clinical significance of the NORMAL subtype remains uncertain due to a limited number of studies. The NORMAL breast cancer cells are poorly characterized and heterogeneous in nature. As per the recent classification of the breast cancer subtypes, the NORMAL subtype has been identified to be a potentially aggressive molecular subtype, referred to as claudin-low tumors (<xref ref-type="bibr" rid="bib64">Liu et al., 2014</xref>). This evidence suggests that the NORMAL subtype of breast cancer is potentially an aggressive molecular subtype, which is consistent with the prediction made by SCellBOW.</p><p>In advanced metastatic prostate cancer, molecular subtypes are still poorly defined, and characterizing novel or more fine-grained subtypes with clinical implications on patient prognosis is an active field of research. As a proof-of-concept, we executed SCellBOW on the three mCRPC subtypes, namely ARAH, ARAH, and NE. We observed that eliminating the subtypes individually and in combinations (ARAH +ARAL + NE) exhibited a clinically intuitive change in prognosis using SCellBOW. We further expanded the application of <italic>phenotype algebra</italic> beyond its previous application solely to cancer cells by including non-malignant cells from the tumor microenvironment. We observed that eliminating cancer subtypes from the tumor decreased its aggressiveness, whereas removing the immune component increased aggressiveness, highlighting the critical role of the tumor microenvironment in modulating cancer progression. To date, mCPRC classification has largely been confined to the gradients of AR and NE activities. There is considerable scope for embracing more fine-grained subtypes to better explain clonal selection and epithelial plasticity in drug resistance in wider use cases. Convinced by the overall performance of SCellBOW, we applied <italic>phenotype algebra</italic> on the SCellBOW clusters obtained from the <xref ref-type="bibr" rid="bib41">He et al., 2021</xref> mCRPC dataset. We observed a misalignment from the general perception that the neuroendocrine subtype features the worst prognosis. Our results pointed towards the existence of a more aggressive and dedifferentiated subpopulation in the lineage plasticity continuum. This subpopulation of de-differentiated cells in mCRPC, AR−/NE<sub>low</sub>, exhibit greater aggressiveness and have distinct gene expression patterns that do not match those of any previously identified molecular subtypes. This novel subpopulation shares gene expression signatures with both androgen-repressed and neuroendocrine-activated genes. GSVA analysis of this hitherto unknown phenotype offered insights into its putative functional characteristics, which can be broadly defined by stemness, EMT, MET, and drug resistance. To summarize, SCellBOW clustering combined with <italic>phenotype algebra</italic> can provide novel insights into factettes of cancer biology. This can be used to delineate features of lineage plasticity and aid in better classification of molecular phenotypes with clinical significance. Once the subpopulations are identified, delving into the intricate mechanisms governing their resistant behavior can provide invaluable insights for designing new drugs. Further, such a tool can empower medical oncologists and oncology researchers to develop more personalized and systemic treatment regimes for cancer patients.</p><sec id="s3-1"><title>Conclusion</title><p>SCellBOW is a scRNA-seq analysis tool that can be utilized to decipher molecular heterogeneity from scRNA-seq profiles and infer survival risks associated with the individual subpopulations in tumors. Our main contributions are as follows: a. We proposed SCellBOW which learns a distributed representation (fixed-length embedding per cell) of single cells. Despite being a computationally inexpensive and simple architecture, SCellBOW outperforms transformer-based approaches such as scBERT on both single-cell clustering and cancer cell risk stratification tasks. b. We also introduced the task of inferring cellular aggressiveness as a computationally tractable problem. The <italic>phenotype algebra</italic> module of SCellBOW performs joint representation learning of externally sourced tumor bulk RNA sequencing data (e.g. TCGA) and tumor scRNA-seq data of interest. Finally, a survival prediction model trained on bulk expression profiles is used for survival risk stratification for each of the malignant and non-malignant cell clusters derived from the tumor scRNA-seq data. We compared SCellBOW with existing best practice methods for its ability to precisely represent phenotypically divergent cell types across multiple scRNA-seq datasets, including an in-house generated human splenocyte and matched PBMC dataset. SCellBOW has proven effective in characterizing poorly defined metastatic prostate cancer. We identified a subpopulation of dedifferentiated cells in mCRPC, AR−/NElow, that exhibit greater aggressiveness and have distinct gene expression patterns that do not match those of any previously identified molecular subtypes. We could trace this back in a large-scale spatial omics atlas of 141 well-characterized metastatic prostate cancer samples at the spot resolution. In the case of breast cancer, our results indicated that the normal-like subtype, which was previously considered an artifact of high normal cell content in the tumor sample, may be among the most aggressive ones, which is concordant with recent reports. In conclusion, the robust clustering and risk-stratification capabilities of SCellBOW hold promise for tailored therapeutic interventions by identifying clinically relevant subpopulations and their impact on prognosis.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Overview of SCellBOW components and functionalities</title><p>SCellBOW has two main applications: a. <italic>Cell embedding and clustering.</italic> In this work, we demonstrate single-cell representation learning using a source and target scRNA-seq data. The source data is typically any large scRNA-seq data capable of priming a neural architecture for improved representation learning on the target data of interest. Note that in this case, cells in the source or the target data need not be annotated. This transfer learning capability is meant to obtain improved fixed-length embeddings for cells in the target data by leveraging the transcriptomic patterns from existing datasets. b. <italic>Survival risk attribution.</italic> The <italic>phenotype algebra</italic> module predicts the aggressiveness associated with each malignant and non-malignant cell cluster. SCellBOW computes fixed-length embeddings jointly for the scRNA-seq target dataset (from the tumor under study) and tumor bulk RNA-seq profiles with patient-survival data (e.g. TCGA). Notably, embeddings of transcriptomes from scRNA-seq target data and bulk RNA-seq survival data have been determined concurrently by recalibrating the pre-trained model. A survival prediction model trained on the bulk RNA-seq embeddings and patient-survival data is then tested on the embeddings of the target data to make predictions about the degree of aggressiveness exhibited by the tumor variants. The steps involved in the above two tasks are depicted in <xref ref-type="fig" rid="fig1">Figure 1</xref>. The granular details involved in each of these steps can be found in the below subsections.</p></sec><sec id="s4-2"><title>Data preparation for clustering</title><p>SCellBOW follows the same preprocessing procedure for the source and target data. SCellBOW first filters the cells with less than 200 genes expressed and genes that are expressed in less than 20 cells. The thresholds may vary depending on the dimension of the dataset (<xref ref-type="table" rid="app1table2">Appendix 1—table 2</xref>). After eliminating low-quality cells and genes, SCellBOW log-normalizes the gene expression data matrix. In the first step, CPM normalization is performed, where the expression of each gene in each cell is divided by the total gene expression of the cell, multiplied by 10,000. In the second step, the normalized expression matrix is natural-log transformed after adding one as a pseudo-count. Highly variable genes are selected using the highly_variable_genes() function from the Scanpy package. SCellBOW performs a z-score scaling on the log-normalized expression matrix with the selected highly variable genes. SCellBOW can handle data in different formats, including UMI count, FPKM, and TPM. The UMI count data follow the same preprocessing procedure as above. SCellBOW skips the normalization step for TPM and FPKM since their lengths have been normalized.</p></sec><sec id="s4-3"><title>Creating a corpus from source and target data</title><p>The gene expression data matrix is analogous to the term-frequency matrix, which represents the frequency of different words in a set of documents. In the context of genomic data, a similar concept can be used to represent the expression level of a gene (words) in a set of cells (documents). Let <inline-formula><alternatives><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>E</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math><tex-math id="inft1">\begin{document}$E\in R^{G\times C}$\end{document}</tex-math></alternatives></inline-formula> be the gene expression matrix obtained from a scRNA-seq experiment, where each value <inline-formula><alternatives><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math><tex-math id="inft2">\begin{document}$E_{g,c} $\end{document}</tex-math></alternatives></inline-formula> of the matrix indicates the expression value of a gene <inline-formula><alternatives><mml:math id="inf3"><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:math><tex-math id="inft3">\begin{document}$g\in G$\end{document}</tex-math></alternatives></inline-formula> in a cell <inline-formula><alternatives><mml:math id="inf4"><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi></mml:math><tex-math id="inft4">\begin{document}$c\in C$\end{document}</tex-math></alternatives></inline-formula> obtained after Scanpy preprocessing. SCellBOW generates embeddings by taking two input datasets: a source and a target data matrix. The source dataset contains the initial weights of the neural network model, while the target data contains the cells that require clustering or malignancy potential ranking. Before generating the embeddings, SCellBOW performs feature scaling on the data matrix, rescaling each feature to a range of [0, 10] as follows.<disp-formula id="equ1"><label>(1)</label><alternatives><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t1">\begin{document}$$\displaystyle \mathrm{E}^{\mathrm{'}}_{\mathrm{g},\mathrm{c}}=\mathrm{i}\mathrm{n}\mathrm{t}\left (\frac{\mathrm{E}_{\mathrm{g},\mathrm{c}}-\mathrm{m}\mathrm{i}\mathrm{n}}{\mathrm{m}\mathrm{a}\mathrm{x}-\mathrm{m}\mathrm{i}\mathrm{n}}\right),$$\end{document}</tex-math></alternatives></disp-formula></p><p>where scaling is applied to each entry with max = 10 and min = 0. This establishes the equivalence between term-frequency and gene expression matrix. Here, we consider that a specific gene is a word, and the expression of the gene in a cell corresponds to the number of copies of the word in a document. To scale the data matrix, we have used the MinMaxScaler() function from the scikit-learn package (<xref ref-type="bibr" rid="bib78">Pedregosa, 2011</xref>). To create the corpus, SCellBOW duplicates the name of the expressed gene in a cell as many times as the gene is expressed. SCellBOW shuffles the genes in each cell to ensure a uniform distribution of genes across the cell, removing any positional bias within the dataset. We verified that this randomization does not change the outcomes dramatically (<xref ref-type="fig" rid="app2fig10">Appendix 2—figure 10</xref>). The resulting gene names are treated as the words in the document. To build the vocabulary from a sequence of cells, a tag number is associated with each cell using the TaggedDocument() function in the Gensim package (<xref ref-type="bibr" rid="bib82">Rehurek and Sojka, 2011</xref>). For each gene in the documents, a token is assigned using a module called tokenize with a word_tokenize() function in NLTK package (<xref ref-type="bibr" rid="bib12">Bird et al., 2009</xref>) that splits gene names into tokens.</p></sec><sec id="s4-4"><title>The SCellBOW network</title><p>SCellBOW produces a low-dimensional fixed-length embedding of the single-cell transcriptome using transfer learning. The data matrix is transformed from <inline-formula><alternatives><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math><tex-math id="inft5">\begin{document}$E'\in Z^{G\times C}$\end{document}</tex-math></alternatives></inline-formula> feature space to <inline-formula><alternatives><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mo>″</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>×</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math><tex-math id="inft6">\begin{document}$E'' \in R^{d\times C}$\end{document}</tex-math></alternatives></inline-formula> latent feature space of d dimensions, with <inline-formula><alternatives><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi><mml:mo>≪</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math><tex-math id="inft7">\begin{document}$d\ll G$\end{document}</tex-math></alternatives></inline-formula>. To generate the embeddings, SCellBOW trains a Doc2vec distributed memory model of paragraph vectors (PV-DM) model. The PV-DM model is similar to bag-of-words models in Word2vec (<xref ref-type="bibr" rid="bib69">Mikolov et al., 2013a</xref>). The training corpus in Doc2vec contains a set of documents, each containing a sequence of words <inline-formula><alternatives><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math><tex-math id="inft8">\begin{document}$W=\left \{w_{1}, w_{2},..,w_{T}\right\}$\end{document}</tex-math></alternatives></inline-formula> that forms a vocabulary <inline-formula><alternatives><mml:math id="inf9"><mml:mi>V</mml:mi></mml:math><tex-math id="inft9">\begin{document}$V$\end{document}</tex-math></alternatives></inline-formula>. The words within each document are treated as shared among all documents. The training objective of the model is to maximize the probability of predicting the target word <inline-formula><alternatives><mml:math id="inf10"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft10">\begin{document}$w_{t}$\end{document}</tex-math></alternatives></inline-formula>, given the context words that occur within a fixed-size window of size  <inline-formula><alternatives><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mstyle></mml:math><tex-math id="inft11">\begin{document}$n$\end{document}</tex-math></alternatives></inline-formula> around  <inline-formula><alternatives><mml:math id="inf12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math><tex-math id="inft12">\begin{document}$w_{t}$\end{document}</tex-math></alternatives></inline-formula> in the whole corpus as follows<disp-formula id="equ2"><label>(2)</label><alternatives><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">z</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi mathvariant="normal">T</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi mathvariant="normal">w</mml:mi><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">n</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">W</mml:mi><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t2">\begin{document}$$\displaystyle \rm maximize\left(\frac{1}{T}\sum\limits_{t=1}^{T}{\log Pr(w_t\mid w_{t-n,..,W_{t+n}})}\right) .$$\end{document}</tex-math></alternatives></disp-formula></p><p>The probability can be modeled using the hierarchical SoftMax function as follows<disp-formula id="equ3"><label>(3)</label><alternatives><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">y</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t3">\begin{document}$$\displaystyle \mathrm{P}\mathrm{r}\left (\mathrm{w}_{\mathrm{t}}|\mathrm{w}_{\mathrm{t}-\mathrm{n}},..,\mathrm{w}_{\mathrm{t}+\mathrm{n}}\right)=\frac{\mathrm{e}^{\mathrm{y}_{\mathrm{w}_{\mathrm{t}}}}}{\sum _{\mathrm{i}}\mathrm{e}^{\mathrm{y}_{\mathrm{i}}}},$$\end{document}</tex-math></alternatives></disp-formula></p><p>where each of <inline-formula><alternatives><mml:math id="inf13"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft13">\begin{document}$y_{i}$\end{document}</tex-math></alternatives></inline-formula> computes the log probability of the word <inline-formula><alternatives><mml:math id="inf14"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft14">\begin{document}$w_{t}$\end{document}</tex-math></alternatives></inline-formula> normalized by the sum of the log probabilities of all words in V. This is achieved by adjusting the weights of the hidden layer of a neural network. To build the Doc2vec model, we used the doc2vec() function in the Gensim library. The initial learning rate was set to 0.025, and the window size to 5. We chose the PV-DM training algorithm and set the embedding vector size to 300 as the default parameter. The choice of embedding vector size may be adjusted according to the size and dimensionality of the dataset.</p></sec><sec id="s4-5"><title>Fine-tuning using transfer learning</title><p>At first, SCellBOW is pre-trained with a source data matrix <inline-formula><alternatives><mml:math id="inf15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">Z</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math><tex-math id="inft15">\begin{document}$\mathrm{E}\mathrm{'}_{\mathrm{s}\mathrm{r}\mathrm{c}}\in \mathrm{Z}^{\mathrm{G}_{\mathrm{s}\mathrm{r}\mathrm{c}}\times \mathrm{C}_{\mathrm{s}\mathrm{r}\mathrm{c}}}$\end{document}</tex-math></alternatives></inline-formula> with <inline-formula><alternatives><mml:math id="inf16"><mml:msub><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft16">\begin{document}$\mathrm{G}_{\mathrm{s}\mathrm{r}\mathrm{c}}$\end{document}</tex-math></alternatives></inline-formula> genes and <inline-formula><alternatives><mml:math id="inf17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math><tex-math id="inft17">\begin{document}$C_{src}$\end{document}</tex-math></alternatives></inline-formula> cells. The source data matrix sets the initial weights of the neural network model. During transfer learning, SCellBOW fine-tunes the weights learned by the pre-trained model from <inline-formula><alternatives><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:mstyle></mml:math><tex-math id="inft18">\begin{document}$E'_{src}$\end{document}</tex-math></alternatives></inline-formula> using a target dataset <inline-formula><alternatives><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">Z</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math><tex-math id="inft19">\begin{document}$\mathrm{E}\mathrm{'}_{\mathrm{t}\mathrm{r}\mathrm{g}}\in \mathrm{Z}^{\mathrm{G}_{\mathrm{t}\mathrm{r}\mathrm{g}}\times \mathrm{C}_{\mathrm{t}\mathrm{r}\mathrm{g}}}$\end{document}</tex-math></alternatives></inline-formula> with <inline-formula><alternatives><mml:math id="inf20"><mml:msub><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft20">\begin{document}$\mathrm{G}_{\mathrm{t}\mathrm{r}\mathrm{g}}$\end{document}</tex-math></alternatives></inline-formula> genes and <inline-formula><alternatives><mml:math id="inf21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math><tex-math id="inft21">\begin{document}$\mathrm{C}_{\mathrm{t}\mathrm{r}\mathrm{g}}$\end{document}</tex-math></alternatives></inline-formula> cells. This facilitates faster convergence of the neural network compared to starting from randomly initialized weights. The output layer of the network is a fixed-length low-dimension embedding (a vector representation) for each cell <inline-formula><alternatives><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math><tex-math id="inft22">\begin{document}$\mathrm{c}\in\mathrm{C}_{\mathrm{t}\mathrm{r}\mathrm{g}}$\end{document}</tex-math></alternatives></inline-formula>. To infer the latent structure of <inline-formula><alternatives><mml:math id="inf23"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft23">\begin{document}$E_{trg}$\end{document}</tex-math></alternatives></inline-formula> single-cell corpus, we used the infer_vector() function in the Gensim package to produce the dimension-reduced vectors for each cell in <inline-formula><alternatives><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math><tex-math id="inft24">\begin{document}$\mathrm{C}_{\mathrm{t}\mathrm{r}\mathrm{g}}$\end{document}</tex-math></alternatives></inline-formula>. This step ensures the network can map the target data into a low dimensional embedding space <inline-formula><alternatives><mml:math id="inf25"><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:math><tex-math id="inft25">\begin{document}$R^{d}$\end{document}</tex-math></alternatives></inline-formula>; that is  <inline-formula><alternatives><mml:math id="inf26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">E</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">→</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="normal">E</mml:mi><mml:mo>″</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:mstyle></mml:math><tex-math id="inft26">\begin{document}$\mathrm{E'} \rightarrow \mathrm{E''} $\end{document}</tex-math></alternatives></inline-formula>,where <inline-formula><alternatives><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold">E</mml:mi><mml:mo>″</mml:mo></mml:msup></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>×</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math><tex-math id="inft27">\begin{document}$\mathbf{E''} \in \mathbb{R}^{d \times C} $\end{document}</tex-math></alternatives></inline-formula>. The resulting embeddings can be used for various downstream analyses of the single-cell data, such as clustering, visualization of cell types, and <italic>phenotype algebra</italic>.</p></sec><sec id="s4-6"><title>Visualization of SCellBOW clusters</title><p>SCellBOW maps the cells to low-dimensional vectors in such a way that two cells with similar gene expression patterns will have the least cosine distance between their inferred vectors.<disp-formula id="equ4"><label>(4)</label><alternatives><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mo>.</mml:mo><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">∥</mml:mo><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mo>∥</mml:mo><mml:mo>×</mml:mo><mml:mo>∥</mml:mo><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow><mml:mo stretchy="false">∥</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t4">\begin{document}$$\displaystyle \mathrm{s}\mathrm{i}\mathrm{m}\mathrm{i}\mathrm{l}\mathrm{a}\mathrm{r}\mathrm{i}\mathrm{t}\mathrm{y}\left (\mathrm{a},\mathrm{b}\right)=\frac{\mathrm{a}.\mathrm{b}}{\parallel \mathrm{a}\parallel \times \parallel \mathrm{b}\parallel}.$$\end{document}</tex-math></alternatives></disp-formula></p><p>After generating low-dimensional embeddings for the cells, SCellBOW identifies the groups of cells with similar gene expression patterns. To determine the clusters, SCellBOW uses the Leiden algorithm (<xref ref-type="bibr" rid="bib92">Traag et al., 2019</xref>) on the embedding matrix of the target dataset. We used the leiden() function in the Scanpy package with a default resolution of 1.0. The resolution might vary in the reported results depending on the dimension of the target dataset. To visualize the clusters within a two-dimensional space, SCellBOW uses the umap() function from the Scanpy library.</p></sec><sec id="s4-7"><title>Data preparation for <italic>phenotype algebra</italic></title><p>Three independent datasets are required to perform <italic>phenotype algebra</italic>. Two of the three datasets are scRNA-seq datasets used for transfer learning (source and target data). SCellBOW preprocesses the source data matrix using the standard preprocessing steps. SCellBOW uses an additional bulk RNA-seq gene expression matrix (referred to as survival data). The samples are paired with survival information (e.g. vital status, days to follow-up, days to death). In the survival data, samples without follow-up time or survival status and samples with clinical information but no corresponding RNA-seq data were excluded. SCellBOW accounts for unequal cell distribution across different classes in the target data matrix. SCellBOW up samples the imbalanced target dataset by generating synthetic samples from the minority class. The value of the synthetic minority class sample is determined by interpolating between its neighboring cells from the same class. We used SMOTE (<xref ref-type="bibr" rid="bib46">Huang, 2015</xref>) from the imblearn python library (<xref ref-type="bibr" rid="bib58">Lemaitre et al., 2016</xref>). This confirms that the cell type proportions do not confound the output of <italic>phenotype algebra</italic>.</p></sec><sec id="s4-8"><title>Generating pseudo-bulk vectors for algebraic operations</title><p>SCellBOW constructs two types of pseudo-bulk vectors from the target dataset. First, it creates a pseudo-bulk reference vector by averaging the gene expression of all cells in the tumor (<italic>total tumor</italic>). This serves as a baseline representation of the entire tumor and acts as a reference for ranking different groups based on their relative expression profiles. Next, for each group in the dataset, SCellBOW generates a pseudo-bulk phenotype vector by averaging the gene expression of the cells within that specific group. This allows for a direct comparison between different cellular phenotypes. The phenotype vectors are constructed either based on the user-defined cell populations or SCellBOW clusters. Additionally, SCellBOW can perform algebraic operations, such as addition or subtraction, on multiple phenotype vectors to assess the combined risk of two or more cellular phenotypes. For example, in the equation <inline-formula><alternatives><mml:math id="inf28"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><tex-math id="inft28">\begin{document}$\left (\mathrm{P}_{\mathrm{a}}+\mathrm{P}_{\mathrm{b}}\right)$\end{document}</tex-math></alternatives></inline-formula>, <inline-formula><alternatives><mml:math id="inf29"><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft29">\begin{document}$\mathrm{P}_{\mathrm{a}}$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf30"><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="inft30">\begin{document}$\mathrm{P}_{\mathrm{b}}$\end{document}</tex-math></alternatives></inline-formula> represents the phenotype vectors of two distinct cellular phenotypes. Following this, SCellBOW concatenates the bulk RNA-seq data matrix, and the reference and phenotype vectors based on common genes. We used the concatenate() function in the AnnData python package (<xref ref-type="bibr" rid="bib97">Virshup et al., 2021</xref>). The resulting combined dataset is then passed to the pre-trained model, which maps it to a lower-dimensional embedding space.</p></sec><sec id="s4-9"><title>Survival risk attribution</title><p>SCellBOW infers the survival probability and predicted risk score for the user-defined tumor subtypes and SCellBOW clusters. The survival risk of the different groups is predicted by fitting a random survival forest (RSF; <xref ref-type="bibr" rid="bib48">Ishwaran et al., 2008</xref>) machine learning model with SCellBOW embeddings. At first, the RSF is trained with the survival information combined with bulk RNA-seq embeddings obtained from transfer learning. During the prediction step, pseudo-bulk embeddings generated from the target dataset, serving as the test data, undergo a subtraction operation in which the cosine distance between each query embedding and the reference embedding is calculated. For example, the equations:<disp-formula id="equ5"><label>(5)</label><alternatives><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="normal">E</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math><tex-math id="t5">\begin{document}$$\Delta{\rm E_{1} }=\mathrm{E}\left (\mathrm{T}\right)-\mathrm{E}\left (\mathrm{P}_{\mathrm{a}}\right),$$\end{document}</tex-math></alternatives></disp-formula><disp-formula id="equ6"><label>(6)</label><alternatives><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="normal">E</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t6">\begin{document}$$\displaystyle \Delta \mathrm{E_2}=\mathrm{E}\left (\mathrm{T}\right)-\mathrm{E}\left (\mathrm{P}_{\mathrm{a}}+\mathrm{P}_{\mathrm{b}}\right),$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf31"><mml:mi mathvariant="normal">E</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="normal">T</mml:mi><mml:mo>)</mml:mo></mml:math><tex-math id="inft31">\begin{document}$\mathrm{E}\left (\mathrm{T}\right)$\end{document}</tex-math></alternatives></inline-formula> represents the embedding of the average expression for the total tumor, while <inline-formula><alternatives><mml:math id="inf32"><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><tex-math id="inft32">\begin{document}$\mathrm{E}\left (\mathrm{P}_{\mathrm{a}}\right)$\end{document}</tex-math></alternatives></inline-formula> and <inline-formula><alternatives><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math><tex-math id="inft33">\begin{document}$\mathrm{E}\left (\mathrm{P}_{\mathrm{a}}+\mathrm{P}_{\mathrm{b}}\right)$\end{document}</tex-math></alternatives></inline-formula> represent the embeddings of the phenotype vectors, individually and in combination, respectively. Here, Δ <inline-formula><alternatives><mml:math id="inf34"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft34">\begin{document}$E_{1}$\end{document}</tex-math></alternatives></inline-formula> and Δ <inline-formula><alternatives><mml:math id="inf35"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><tex-math id="inft35">\begin{document}$E_{2}$\end{document}</tex-math></alternatives></inline-formula> represent the differences between the embeddings, simulating the removal of subtypes from the whole tumor under negative selection pressure. The resulting difference is then used as input to the RSF model to infer the survival probability <inline-formula><alternatives><mml:math id="inf36"><mml:mi mathvariant="normal">S</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo>)</mml:mo></mml:math><tex-math id="inft36">\begin{document}$\mathrm{S}\left (\mathrm{t}\right)$\end{document}</tex-math></alternatives></inline-formula>. The survival probability computes the probability of occurrence of an event beyond a given time point <inline-formula><alternatives><mml:math id="inf37"><mml:mi>t</mml:mi></mml:math><tex-math id="inft37">\begin{document}$t$\end{document}</tex-math></alternatives></inline-formula> as follows.<disp-formula id="equ7"><label>(7)</label><alternatives><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t7">\begin{document}$$\displaystyle \mathrm{P}\mathrm{r}\left [\mathrm{T}\lt \mathrm{t}\right]=\int _{-\mathrm{\infty}}^{\mathrm{t}}\mathrm{f}\left (\mathrm{x}\right)\mathrm{d}\mathrm{x},$$\end{document}</tex-math></alternatives></disp-formula><disp-formula id="equ8"><label>(8)</label><alternatives><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math><tex-math id="t8">\begin{document}$$\displaystyle \mathrm{S}\left (\mathrm{t}\right)=1-\mathrm{P}\mathrm{r}\left [\mathrm{T}\lt \mathrm{t}\right]=\mathrm{P}\mathrm{r}\left [\mathrm{T}\gt \mathrm{t}\right],$$\end{document}</tex-math></alternatives></disp-formula></p><p>where <inline-formula><alternatives><mml:math id="inf38"><mml:mi>T</mml:mi></mml:math><tex-math id="inft38">\begin{document}$T$\end{document}</tex-math></alternatives></inline-formula> denotes the waiting time until the event occurs and <inline-formula><alternatives><mml:math id="inf39"><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:math><tex-math id="inft39">\begin{document}$f\left (x\right)$\end{document}</tex-math></alternatives></inline-formula> is the probability density function for the occurrence of an event. SCellBOW computes the survival probability using the predict_survival_function() from the scikit-survival RandomSurvivalForest python package (<xref ref-type="bibr" rid="bib80">Pölsterl, 2020</xref>) with n_estimators = 1000.</p><p>In addition to survival probability, SCellBOW can estimate the relative aggressiveness of different phenotypes by assigning a risk score for distinct groups. To infer the predicted risk score, SCellBOW first trains 50 bootstrapped RSF models using 80% of the training set for each iteration. The training data is sub-sampled using different seeds for every iteration. We used the predict() function from the scikit-survival package to compute the risk score of each of the input vectors. SCellBOW derives the median of the predicted risk score for each group from the 50 bootstrapped models. The <italic>phenotype algebra</italic> model assigns groups with shorter survival times a lower rank by considering all possible pairs of groups in the data. The groups with a lower predicted risk score after removal from the reference pseudo-bulk are considered more aggressive, as they are associated with shorter survival times.</p></sec><sec id="s4-10"><title>Description of datasets for model evaluation</title><p>To evaluate the performance of SCellBOW, we used 15 publicly available scRNA-seq datasets and an in-house scRNA-seq dataset spanning different cell types, sizes, and diseases (<xref ref-type="table" rid="app1table2">Appendix 1—table 2</xref>). Four use cases were constructed to benchmark the clustering efficiency, each involving a pair of single-cell expression datasets. In the first use case, we used ~120,300 non-cancerous human prostate cells from <xref ref-type="bibr" rid="bib51">Karthaus et al., 2020</xref> and ~28,600 healthy prostate cells from <xref ref-type="bibr" rid="bib43">Henry et al., 2018</xref>. The second use case consisted of two PBMC datasets from <xref ref-type="bibr" rid="bib112">Zheng et al., 2017</xref> containing approximately 68,000 cells and 2700 cells. For the third use case, we combined three independent batches of pancreatic islet cells from <xref ref-type="bibr" rid="bib5">Baron et al., 2016</xref>, <xref ref-type="bibr" rid="bib71">Muraro et al., 2016</xref>, and <xref ref-type="bibr" rid="bib99">Wang et al., 2016</xref>, with a total of 11,181 cells as the source data and 2068 cells from <xref ref-type="bibr" rid="bib83">Segerstolpe et al., 2016</xref> as the target data. In the fourth use case, we used the (<xref ref-type="bibr" rid="bib112">Zheng et al., 2017</xref>) data containing approximately 68,000 cells as the source data and the in-house dataset isolated from matched spleen and PBMC samples from multiple patients as the target data.</p><p>To validate the accuracy of <italic>phenotype algebra</italic>, we constructed three use cases from publicly available tumor datasets comprising cells from GBM, BRCA, and mCRPC patient tumors. Each instance involved a pair of single-cell expression datasets and a bulk RNA-seq dataset paired with clinical information. For ease of reference, we stick to the following nomenclature – (a) the source data comprises the scRNA-seq dataset used for model pre-training, (b) the target data comprises cells under investigation, and (c) the survival data comprises tumor bulk RNA-seq samples. In the case of GBM, we used two scRNA-seq datasets comprising approximately 12,074 cells and 4508 cells obtained from <xref ref-type="bibr" rid="bib72">Neftel et al., 2019</xref> and <xref ref-type="bibr" rid="bib22">Couturier et al., 2020</xref><italic>,</italic> respectively. In the case of BRCA, we retrieved triple-negative breast cancer scRNA-seq datasets from <xref ref-type="bibr" rid="bib104">Wu et al., 2020</xref> and <xref ref-type="bibr" rid="bib113">Zhou et al., 2021</xref> with approximately 24,271 cells and 545 malignant cells, respectively. In both the use cases, the bulk RNA-seq was obtained from TCGA (<ext-link ext-link-type="uri" xlink:href="https://portal.gdc.cancer.gov">https://portal.gdc.cancer.gov</ext-link>). In the third use case, we acquired author-annotated malignant cells from <xref ref-type="bibr" rid="bib41">He et al., 2021</xref>. A total of 836 malignant cells and 1334 non-malignant cells were derived from 11 patients and three metastasis sites: bone, lymph node, and liver. We retrieved 81 mCRPC bulk RNA-seq samples with paired survival from <xref ref-type="bibr" rid="bib1">Abida et al., 2019</xref>. We obtained the gene expression of 141 regions of interest determined by digital spatial gene expression profiling of mCRPC from <xref ref-type="bibr" rid="bib14">Brady et al., 2021</xref>. We used this data to correlate the (<xref ref-type="bibr" rid="bib41">He et al., 2021</xref>) scRNA-seq gene expression with the DSP gene expression of the six phenotypic categories based on the AR- and NE- activity: AR+/NE−, AR<sub>low</sub>/NE−, AR−/NE−, AR−/NE<sub>low</sub>, AR+/NE+, and AR−/NE+ (Details of the datasets are described in Appendix 1, Supplementary methods 1).</p></sec><sec id="s4-11"><title>Isolation of matched PBMC and splenocyte samples</title><p>In this study, we isolated PBMC and splenocyte from four patients (two healthy donors, HD1 18 years old male and HD2 61 years old female; two brain-dead donors, BD1 57 years old female and BD2 58 years old female). PBMCs were isolated from blood after Ficoll gradient selection. Spleen tissue was mechanically dissociated and then digested with Collagenase and DNAseq. Splenocytes were finally isolated after Ficoll gradient selection. Splenocytes and PBMCs were stored in DMSO with 10% FBS in liquid nitrogen at the Biological Resource Centre for Biobanking (CHU Nantes, Hotel Dieu, Centre de Ressources Biologiques). This biocollection was authorized in May 2013 by the French Agence de la Biomedecine (PFS13-009).</p></sec><sec id="s4-12"><title>Library preparation</title><p>For the in-house dataset, we performed CITE-seq using Hashtag Oligos (HTO) to pool samples into a single 10 X Genomics channel for scRNA-seq (<xref ref-type="bibr" rid="bib2">Abidi et al., 2020</xref>). The HTO binding was performed following the specified protocol (Total-seq B). After thawing and cell washing, 1 M cells were centrifuged and resuspended in 100 µL PSE buffer (PBS/FBS/EDTA). Cells were incubated with 10 µl human FcR blocking reagent for 10 min at 4 °C. 1 µL of a Hashtag oligonucleotide (HTO) antibody (Biolegend) was then added to each sample and incubated at 4 °C for 30 min. Cells were then washed in 1 mL PSE, centrifuged at 500 × <italic>g</italic> for 5 min, and resuspended in 200 µL PSE. Cells were stained with 2 µL DAPI, 60 µM filtered, and viable cells were sorted (ARIA). Cells were checked for counting and viability, then pooled and counted again. Cell viability was set to &lt;95%. Cells of HD1 spleen were lost during the washing step and thus not used during further downstream processing. Cells were then loaded on one channel of Chromium Next Controller with a 3' single-cell Next v3 kit. We followed protocol CG000185, Rev C, until the library generation stage. For the HTO library, we followed the protocol of the 10 X genomics 3' feature barcode kit (PN-1000079) to generate HTO libraries.</p></sec><sec id="s4-13"><title>Next-generation sequencing and post-sequencing quality control</title><p>We sequenced 310pM of pooled libraries on a NOVAseq6000 instrument with an S1(v1) flow-cell. The program was run as follows: Read1 29 cycles / 8 cycles (i7) /0 (i5)/Read2 93 cycles (Standard module, paired-end, two lanes). The FASTQ files were demultiplexed with CellRanger v3.0.1 (10X Genomics) and aligned on the GRCh38 human reference genome. We recovered a total of 6296 cells with CellRanger, and their gene expression matrices were loaded on R. We performed the downstream analysis of the in-house matched PBMC-splenocyte dataset in R using Seurat 4.0. For RNA and HTO quantification, we selected cell barcodes detected by both RNA and HTO. We demultiplexed the cells based on their HTO enrichment using the HTODemux() function in the Seurat R package with default parameters (<xref ref-type="bibr" rid="bib15">Butler et al., 2018</xref>; <xref ref-type="bibr" rid="bib87">Stoeckius et al., 2018</xref>). We subsequently eliminated doublet HTOs (maximum HTO count  &gt; 1) and negative HTOs. Singlets were used for further analysis, leaving 4819 cells and 33,538 genes. We annotated each of the cell barcodes using HTO classification as PBMC and Spleen based on the origin of cells and HD1, HD2, BD1, and BD2 based on the patients (<xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4</xref>). We performed automatic cell annotation using the Seurat-based Azimuth using human PBMC as the reference atlas (<xref ref-type="bibr" rid="bib40">Hao et al., 2021</xref>; Appendix 2—note 2). We defined six major cell populations: B cells, CD4 T cells, CD8 T cells, natural killer (NK) cells, monocytes, and dendritic cells. We then manually verified the annotation based on the RNA expression of known marker genes (<xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4d</xref>, <xref ref-type="table" rid="app1table4">Appendix 1—table 4</xref>).</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>is a stockholder at CareOnco BioTech Pvt. Ltd</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Supervision, Validation, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Data curation, Methodology</p></fn><fn fn-type="con" id="con4"><p>Software</p></fn><fn fn-type="con" id="con5"><p>Software</p></fn><fn fn-type="con" id="con6"><p>Methodology</p></fn><fn fn-type="con" id="con7"><p>Methodology</p></fn><fn fn-type="con" id="con8"><p>Resources, Data curation</p></fn><fn fn-type="con" id="con9"><p>Resources</p></fn><fn fn-type="con" id="con10"><p>Supervision, Methodology</p></fn><fn fn-type="con" id="con11"><p>Supervision</p></fn><fn fn-type="con" id="con12"><p>Validation, Investigation, Writing – original draft</p></fn><fn fn-type="con" id="con13"><p>Resources</p></fn><fn fn-type="con" id="con14"><p>Resources, Software</p></fn><fn fn-type="con" id="con15"><p>Supervision, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con16"><p>Supervision, Funding acquisition, Writing – review and editing</p></fn><fn fn-type="con" id="con17"><p>Supervision, Investigation, Writing – original draft</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Result of differential expression analysis for the <xref ref-type="bibr" rid="bib41">He et al., 2021</xref> metastatic prostate cancer dataset.</title><p>This file also includes information on custom gene sets used for ARPC and NEPC analysis.</p></caption><media xlink:href="elife-98469-supp1-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>Result of differential expression analysis for the in-house matched PBMC and splenocyte dataset.</title></caption><media xlink:href="elife-98469-supp2-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-98469-mdarchecklist1-v1.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>The in-house matched PBMC-splenocyte scRNA-seq expression data generated in this study is available in the GEO with accession number GSE221007. Details of the public datasets analyzed in this paper are described in <xref ref-type="table" rid="app1table2">Appendix 1—table 2</xref>. All source codes are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/cellsemantics/SCellBOW">GitHub</ext-link> (<xref ref-type="bibr" rid="bib11">Bhattacharya, 2025</xref>).</p><p>The following dataset was generated:</p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset1"><person-group person-group-type="author"><name><surname>Bhattacharya</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>Single cell sequencing of peripheral blood mononuclear cells and spleenocytes from 4 polytraumatized patients with splenectomy</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE221007">GSE221007</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>DS acknowledges the support of the ihub-Anubhuti-iiitd Foundation set up under the NM-ICPS scheme of the DST. JP, AR, PS, and SF thank the biological resource centre for biobanking (CHU Nantes, Hôtel Dieu, Centre de Ressources Biologiques (CRB), Nantes, F-44093, France (BRIF: BB-0033–00040)) and the Genomics Core Facility GenoA, member of Biogenouest and France Genomique, and to the Bioinformatics Core Facility BiRD, member of Biogenouest and Institut Français de Bioinformatique (IFB) (ANR-11-INBS-0013) for the use of their resources and their technical support.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abida</surname><given-names>W</given-names></name><name><surname>Cyrta</surname><given-names>J</given-names></name><name><surname>Heller</surname><given-names>G</given-names></name><name><surname>Prandi</surname><given-names>D</given-names></name><name><surname>Armenia</surname><given-names>J</given-names></name><name><surname>Coleman</surname><given-names>I</given-names></name><name><surname>Cieslik</surname><given-names>M</given-names></name><name><surname>Benelli</surname><given-names>M</given-names></name><name><surname>Robinson</surname><given-names>D</given-names></name><name><surname>Van Allen</surname><given-names>EM</given-names></name><name><surname>Sboner</surname><given-names>A</given-names></name><name><surname>Fedrizzi</surname><given-names>T</given-names></name><name><surname>Mosquera</surname><given-names>JM</given-names></name><name><surname>Robinson</surname><given-names>BD</given-names></name><name><surname>De Sarkar</surname><given-names>N</given-names></name><name><surname>Kunju</surname><given-names>LP</given-names></name><name><surname>Tomlins</surname><given-names>S</given-names></name><name><surname>Wu</surname><given-names>YM</given-names></name><name><surname>Nava Rodrigues</surname><given-names>D</given-names></name><name><surname>Loda</surname><given-names>M</given-names></name><name><surname>Gopalan</surname><given-names>A</given-names></name><name><surname>Reuter</surname><given-names>VE</given-names></name><name><surname>Pritchard</surname><given-names>CC</given-names></name><name><surname>Mateo</surname><given-names>J</given-names></name><name><surname>Bianchini</surname><given-names>D</given-names></name><name><surname>Miranda</surname><given-names>S</given-names></name><name><surname>Carreira</surname><given-names>S</given-names></name><name><surname>Rescigno</surname><given-names>P</given-names></name><name><surname>Filipenko</surname><given-names>J</given-names></name><name><surname>Vinson</surname><given-names>J</given-names></name><name><surname>Montgomery</surname><given-names>RB</given-names></name><name><surname>Beltran</surname><given-names>H</given-names></name><name><surname>Heath</surname><given-names>EI</given-names></name><name><surname>Scher</surname><given-names>HI</given-names></name><name><surname>Kantoff</surname><given-names>PW</given-names></name><name><surname>Taplin</surname><given-names>ME</given-names></name><name><surname>Schultz</surname><given-names>N</given-names></name><name><surname>deBono</surname><given-names>JS</given-names></name><name><surname>Demichelis</surname><given-names>F</given-names></name><name><surname>Nelson</surname><given-names>PS</given-names></name><name><surname>Rubin</surname><given-names>MA</given-names></name><name><surname>Chinnaiyan</surname><given-names>AM</given-names></name><name><surname>Sawyers</surname><given-names>CL</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Genomic correlates of clinical outcome in advanced prostate cancer</article-title><source>PNAS</source><volume>116</volume><fpage>11428</fpage><lpage>11436</lpage><pub-id pub-id-type="doi">10.1073/pnas.1902651116</pub-id><pub-id pub-id-type="pmid">31061129</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abidi</surname><given-names>A</given-names></name><name><surname>Laurent</surname><given-names>T</given-names></name><name><surname>Bériou</surname><given-names>G</given-names></name><name><surname>Bouchet-Delbos</surname><given-names>L</given-names></name><name><surname>Fourgeux</surname><given-names>C</given-names></name><name><surname>Louvet</surname><given-names>C</given-names></name><name><surname>Triki-Marrakchi</surname><given-names>R</given-names></name><name><surname>Poschmann</surname><given-names>J</given-names></name><name><surname>Josien</surname><given-names>R</given-names></name><name><surname>Martin</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Characterization of rat ILCs reveals ILC2 as the dominant intestinal subset</article-title><source>Frontiers in Immunology</source><volume>11</volume><elocation-id>255</elocation-id><pub-id pub-id-type="doi">10.3389/fimmu.2020.00255</pub-id><pub-id pub-id-type="pmid">32140157</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahn</surname><given-names>HJ</given-names></name><name><surname>Jung</surname><given-names>SJ</given-names></name><name><surname>Kim</surname><given-names>TH</given-names></name><name><surname>Oh</surname><given-names>MK</given-names></name><name><surname>Yoon</surname><given-names>HK</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Differences in clinical outcomes between luminal A and B type breast cancers according to the St. Gallen Consensus 2013</article-title><source>Journal of Breast Cancer</source><volume>18</volume><fpage>149</fpage><lpage>159</lpage><pub-id pub-id-type="doi">10.4048/jbc.2015.18.2.149</pub-id><pub-id pub-id-type="pmid">26155291</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Antonarakis</surname><given-names>ES</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Targeting lineage plasticity in prostate cancer</article-title><source>The Lancet. Oncology</source><volume>20</volume><fpage>1338</fpage><lpage>1340</lpage><pub-id pub-id-type="doi">10.1016/S1470-2045(19)30497-8</pub-id><pub-id pub-id-type="pmid">31515155</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baron</surname><given-names>M</given-names></name><name><surname>Veres</surname><given-names>A</given-names></name><name><surname>Wolock</surname><given-names>SL</given-names></name><name><surname>Faust</surname><given-names>AL</given-names></name><name><surname>Gaujoux</surname><given-names>R</given-names></name><name><surname>Vetere</surname><given-names>A</given-names></name><name><surname>Ryu</surname><given-names>JH</given-names></name><name><surname>Wagner</surname><given-names>BK</given-names></name><name><surname>Shen-Orr</surname><given-names>SS</given-names></name><name><surname>Klein</surname><given-names>AM</given-names></name><name><surname>Melton</surname><given-names>DA</given-names></name><name><surname>Yanai</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure</article-title><source>Cell Systems</source><volume>3</volume><fpage>346</fpage><lpage>360</lpage><pub-id pub-id-type="doi">10.1016/j.cels.2016.08.011</pub-id><pub-id pub-id-type="pmid">27667365</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baslan</surname><given-names>T</given-names></name><name><surname>Hicks</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Unravelling biology and shifting paradigms in cancer with single-cell sequencing</article-title><source>Nature Reviews. Cancer</source><volume>17</volume><fpage>557</fpage><lpage>569</lpage><pub-id pub-id-type="doi">10.1038/nrc.2017.58</pub-id><pub-id pub-id-type="pmid">28835719</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Behnan</surname><given-names>J</given-names></name><name><surname>Finocchiaro</surname><given-names>G</given-names></name><name><surname>Hanna</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The landscape of the mesenchymal signature in brain tumours</article-title><source>Brain</source><volume>142</volume><fpage>847</fpage><lpage>866</lpage><pub-id pub-id-type="doi">10.1093/brain/awz044</pub-id><pub-id pub-id-type="pmid">30946477</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beltran</surname><given-names>H</given-names></name><name><surname>Prandi</surname><given-names>D</given-names></name><name><surname>Mosquera</surname><given-names>JM</given-names></name><name><surname>Benelli</surname><given-names>M</given-names></name><name><surname>Puca</surname><given-names>L</given-names></name><name><surname>Cyrta</surname><given-names>J</given-names></name><name><surname>Marotz</surname><given-names>C</given-names></name><name><surname>Giannopoulou</surname><given-names>E</given-names></name><name><surname>Chakravarthi</surname><given-names>B</given-names></name><name><surname>Varambally</surname><given-names>S</given-names></name><name><surname>Tomlins</surname><given-names>SA</given-names></name><name><surname>Nanus</surname><given-names>DM</given-names></name><name><surname>Tagawa</surname><given-names>ST</given-names></name><name><surname>Van Allen</surname><given-names>EM</given-names></name><name><surname>Elemento</surname><given-names>O</given-names></name><name><surname>Sboner</surname><given-names>A</given-names></name><name><surname>Garraway</surname><given-names>LA</given-names></name><name><surname>Rubin</surname><given-names>MA</given-names></name><name><surname>Demichelis</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Divergent clonal evolution of castration-resistant neuroendocrine prostate cancer</article-title><source>Nature Medicine</source><volume>22</volume><fpage>298</fpage><lpage>305</lpage><pub-id pub-id-type="doi">10.1038/nm.4045</pub-id><pub-id pub-id-type="pmid">26855148</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beltran</surname><given-names>H</given-names></name><name><surname>Hruszkewycz</surname><given-names>A</given-names></name><name><surname>Scher</surname><given-names>HI</given-names></name><name><surname>Hildesheim</surname><given-names>J</given-names></name><name><surname>Isaacs</surname><given-names>J</given-names></name><name><surname>Yu</surname><given-names>EY</given-names></name><name><surname>Kelly</surname><given-names>K</given-names></name><name><surname>Lin</surname><given-names>D</given-names></name><name><surname>Dicker</surname><given-names>A</given-names></name><name><surname>Arnold</surname><given-names>J</given-names></name><name><surname>Hecht</surname><given-names>T</given-names></name><name><surname>Wicha</surname><given-names>M</given-names></name><name><surname>Sears</surname><given-names>R</given-names></name><name><surname>Rowley</surname><given-names>D</given-names></name><name><surname>White</surname><given-names>R</given-names></name><name><surname>Gulley</surname><given-names>JL</given-names></name><name><surname>Lee</surname><given-names>J</given-names></name><name><surname>Diaz Meco</surname><given-names>M</given-names></name><name><surname>Small</surname><given-names>EJ</given-names></name><name><surname>Shen</surname><given-names>M</given-names></name><name><surname>Knudsen</surname><given-names>K</given-names></name><name><surname>Goodrich</surname><given-names>DW</given-names></name><name><surname>Lotan</surname><given-names>T</given-names></name><name><surname>Zoubeidi</surname><given-names>A</given-names></name><name><surname>Sawyers</surname><given-names>CL</given-names></name><name><surname>Rudin</surname><given-names>CM</given-names></name><name><surname>Loda</surname><given-names>M</given-names></name><name><surname>Thompson</surname><given-names>T</given-names></name><name><surname>Rubin</surname><given-names>MA</given-names></name><name><surname>Tawab-Amiri</surname><given-names>A</given-names></name><name><surname>Dahut</surname><given-names>W</given-names></name><name><surname>Nelson</surname><given-names>PS</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The role of lineage plasticity in prostate cancer therapy resistance</article-title><source>Clinical Cancer Research</source><volume>25</volume><fpage>6916</fpage><lpage>6924</lpage><pub-id pub-id-type="doi">10.1158/1078-0432.CCR-19-1423</pub-id><pub-id pub-id-type="pmid">31363002</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bhattacharya</surname><given-names>N</given-names></name><name><surname>Nelson</surname><given-names>CC</given-names></name><name><surname>Ahuja</surname><given-names>G</given-names></name><name><surname>Sengupta</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Big data analytics in single‐cell transcriptomics: Five grand opportunities</article-title><source>WIREs Data Mining and Knowledge Discovery</source><volume>11</volume><elocation-id>1414</elocation-id><pub-id pub-id-type="doi">10.1002/widm.1414</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Bhattacharya</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2025">2025</year><data-title>SCellBOW</data-title><version designator="eabc2cc">eabc2cc</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/cellsemantics/SCellBOW">https://github.com/cellsemantics/SCellBOW</ext-link></element-citation></ref><ref id="bib12"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bird</surname><given-names>S</given-names></name><name><surname>Klein</surname><given-names>E</given-names></name><name><surname>Loper</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2009">2009</year><source>Natural Language Processing with Python: Analyzing Text with the Natural Language Toolkit</source><publisher-name>O’Reilly Media, Inc</publisher-name></element-citation></ref><ref id="bib13"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Bourgey</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>ScRNA_GBM</data-title><version designator="18a7033">18a7033</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/mbourgey/scRNA_GBM">https://github.com/mbourgey/scRNA_GBM</ext-link></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brady</surname><given-names>L</given-names></name><name><surname>Kriner</surname><given-names>M</given-names></name><name><surname>Coleman</surname><given-names>I</given-names></name><name><surname>Morrissey</surname><given-names>C</given-names></name><name><surname>Roudier</surname><given-names>M</given-names></name><name><surname>True</surname><given-names>LD</given-names></name><name><surname>Gulati</surname><given-names>R</given-names></name><name><surname>Plymate</surname><given-names>SR</given-names></name><name><surname>Zhou</surname><given-names>Z</given-names></name><name><surname>Birditt</surname><given-names>B</given-names></name><name><surname>Meredith</surname><given-names>R</given-names></name><name><surname>Geiss</surname><given-names>G</given-names></name><name><surname>Hoang</surname><given-names>M</given-names></name><name><surname>Beechem</surname><given-names>J</given-names></name><name><surname>Nelson</surname><given-names>PS</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Inter- and intra-tumor heterogeneity of metastatic prostate cancer determined by digital spatial gene expression profiling</article-title><source>Nature Communications</source><volume>12</volume><elocation-id>1426</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-021-21615-4</pub-id><pub-id pub-id-type="pmid">33658518</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Butler</surname><given-names>A</given-names></name><name><surname>Hoffman</surname><given-names>P</given-names></name><name><surname>Smibert</surname><given-names>P</given-names></name><name><surname>Papalexi</surname><given-names>E</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title><source>Nature Biotechnology</source><volume>36</volume><fpage>411</fpage><lpage>420</lpage><pub-id pub-id-type="doi">10.1038/nbt.4096</pub-id><pub-id pub-id-type="pmid">29608179</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Butler</surname><given-names>A</given-names></name><name><surname>Hoffman</surname><given-names>P</given-names></name><name><surname>Hao</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Seurat</data-title><version designator="4.1.1">4.1.1</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/satijalab/seurat">https://github.com/satijalab/seurat</ext-link></element-citation></ref><ref id="bib17"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Cai</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>ScETM</data-title><version designator="0.4.9">0.4.9</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/hui2000ji/scETM">https://github.com/hui2000ji/scETM</ext-link></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Castellón</surname><given-names>EA</given-names></name><name><surname>Indo</surname><given-names>S</given-names></name><name><surname>Contreras</surname><given-names>HR</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Cancer stemness/epithelial-mesenchymal transition axis influences metastasis and castration resistance in prostate cancer: potential therapeutic target</article-title><source>International Journal of Molecular Sciences</source><volume>23</volume><elocation-id>14917</elocation-id><pub-id pub-id-type="doi">10.3390/ijms232314917</pub-id><pub-id pub-id-type="pmid">36499245</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Catapano</surname><given-names>J</given-names></name><name><surname>Luty</surname><given-names>M</given-names></name><name><surname>Wróbel</surname><given-names>T</given-names></name><name><surname>Pudełek</surname><given-names>M</given-names></name><name><surname>Piwowarczyk</surname><given-names>K</given-names></name><name><surname>Kędracka-Krok</surname><given-names>S</given-names></name><name><surname>Siedlar</surname><given-names>M</given-names></name><name><surname>Madeja</surname><given-names>Z</given-names></name><name><surname>Czyż</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Acquired drug resistance interferes with the susceptibility of prostate cancer cells to metabolic stress</article-title><source>Cellular &amp; Molecular Biology Letters</source><volume>27</volume><elocation-id>100</elocation-id><pub-id pub-id-type="doi">10.1186/s11658-022-00400-1</pub-id><pub-id pub-id-type="pmid">36401206</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chapman</surname><given-names>AR</given-names></name><name><surname>Lee</surname><given-names>DF</given-names></name><name><surname>Cai</surname><given-names>W</given-names></name><name><surname>Ma</surname><given-names>W</given-names></name><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Sun</surname><given-names>W</given-names></name><name><surname>Xie</surname><given-names>XS</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Correlated gene modules uncovered by high-precision single-cell transcriptomics</article-title><source>PNAS</source><volume>119</volume><elocation-id>e2206938119</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2206938119</pub-id><pub-id pub-id-type="pmid">36508663</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chawla</surname><given-names>S</given-names></name><name><surname>Rockstroh</surname><given-names>A</given-names></name><name><surname>Lehman</surname><given-names>M</given-names></name><name><surname>Ratther</surname><given-names>E</given-names></name><name><surname>Jain</surname><given-names>A</given-names></name><name><surname>Anand</surname><given-names>A</given-names></name><name><surname>Gupta</surname><given-names>A</given-names></name><name><surname>Bhattacharya</surname><given-names>N</given-names></name><name><surname>Poonia</surname><given-names>S</given-names></name><name><surname>Rai</surname><given-names>P</given-names></name><name><surname>Das</surname><given-names>N</given-names></name><name><surname>Majumdar</surname><given-names>A</given-names></name><name><surname>Ahuja</surname><given-names>G</given-names></name><name><surname>Hollier</surname><given-names>BG</given-names></name><name><surname>Nelson</surname><given-names>CC</given-names></name><name><surname>Sengupta</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Gene expression based inference of cancer drug sensitivity</article-title><source>Nature Communications</source><volume>13</volume><elocation-id>5680</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-022-33291-z</pub-id><pub-id pub-id-type="pmid">36167836</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Couturier</surname><given-names>CP</given-names></name><name><surname>Ayyadhury</surname><given-names>S</given-names></name><name><surname>Le</surname><given-names>PU</given-names></name><name><surname>Nadaf</surname><given-names>J</given-names></name><name><surname>Monlong</surname><given-names>J</given-names></name><name><surname>Riva</surname><given-names>G</given-names></name><name><surname>Allache</surname><given-names>R</given-names></name><name><surname>Baig</surname><given-names>S</given-names></name><name><surname>Yan</surname><given-names>X</given-names></name><name><surname>Bourgey</surname><given-names>M</given-names></name><name><surname>Lee</surname><given-names>C</given-names></name><name><surname>Wang</surname><given-names>YCD</given-names></name><name><surname>Wee Yong</surname><given-names>V</given-names></name><name><surname>Guiot</surname><given-names>MC</given-names></name><name><surname>Najafabadi</surname><given-names>H</given-names></name><name><surname>Misic</surname><given-names>B</given-names></name><name><surname>Antel</surname><given-names>J</given-names></name><name><surname>Bourque</surname><given-names>G</given-names></name><name><surname>Ragoussis</surname><given-names>J</given-names></name><name><surname>Petrecca</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Single-cell RNA-seq reveals that glioblastoma recapitulates a normal neurodevelopmental hierarchy</article-title><source>Nature Communications</source><volume>11</volume><elocation-id>3406</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-020-17186-5</pub-id><pub-id pub-id-type="pmid">32641768</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dagogo-Jack</surname><given-names>I</given-names></name><name><surname>Shaw</surname><given-names>AT</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Tumour heterogeneity and resistance to cancer therapies</article-title><source>Nature Reviews. Clinical Oncology</source><volume>15</volume><fpage>81</fpage><lpage>94</lpage><pub-id pub-id-type="doi">10.1038/nrclinonc.2017.166</pub-id><pub-id pub-id-type="pmid">29115304</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Denisenko</surname><given-names>E</given-names></name><name><surname>Guo</surname><given-names>BB</given-names></name><name><surname>Jones</surname><given-names>M</given-names></name><name><surname>Hou</surname><given-names>R</given-names></name><name><surname>de Kock</surname><given-names>L</given-names></name><name><surname>Lassmann</surname><given-names>T</given-names></name><name><surname>Poppe</surname><given-names>D</given-names></name><name><surname>Clément</surname><given-names>O</given-names></name><name><surname>Simmons</surname><given-names>RK</given-names></name><name><surname>Lister</surname><given-names>R</given-names></name><name><surname>Forrest</surname><given-names>ARR</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Systematic assessment of tissue dissociation and storage biases in single-cell and single-nucleus RNA-seq workflows</article-title><source>Genome Biology</source><volume>21</volume><elocation-id>130</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-020-02048-6</pub-id><pub-id pub-id-type="pmid">32487174</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dentro</surname><given-names>SC</given-names></name><name><surname>Leshchiner</surname><given-names>I</given-names></name><name><surname>Haase</surname><given-names>K</given-names></name><name><surname>Tarabichi</surname><given-names>M</given-names></name><name><surname>Wintersinger</surname><given-names>J</given-names></name><name><surname>Deshwar</surname><given-names>AG</given-names></name><name><surname>Yu</surname><given-names>K</given-names></name><name><surname>Rubanova</surname><given-names>Y</given-names></name><name><surname>Macintyre</surname><given-names>G</given-names></name><name><surname>Demeulemeester</surname><given-names>J</given-names></name><name><surname>Vázquez-García</surname><given-names>I</given-names></name><name><surname>Kleinheinz</surname><given-names>K</given-names></name><name><surname>Livitz</surname><given-names>DG</given-names></name><name><surname>Malikic</surname><given-names>S</given-names></name><name><surname>Donmez</surname><given-names>N</given-names></name><name><surname>Sengupta</surname><given-names>S</given-names></name><name><surname>Anur</surname><given-names>P</given-names></name><name><surname>Jolly</surname><given-names>C</given-names></name><name><surname>Cmero</surname><given-names>M</given-names></name><name><surname>Rosebrock</surname><given-names>D</given-names></name><name><surname>Schumacher</surname><given-names>SE</given-names></name><name><surname>Fan</surname><given-names>Y</given-names></name><name><surname>Fittall</surname><given-names>M</given-names></name><name><surname>Drews</surname><given-names>RM</given-names></name><name><surname>Yao</surname><given-names>X</given-names></name><name><surname>Watkins</surname><given-names>TBK</given-names></name><name><surname>Lee</surname><given-names>J</given-names></name><name><surname>Schlesner</surname><given-names>M</given-names></name><name><surname>Zhu</surname><given-names>H</given-names></name><name><surname>Adams</surname><given-names>DJ</given-names></name><name><surname>McGranahan</surname><given-names>N</given-names></name><name><surname>Swanton</surname><given-names>C</given-names></name><name><surname>Getz</surname><given-names>G</given-names></name><name><surname>Boutros</surname><given-names>PC</given-names></name><name><surname>Imielinski</surname><given-names>M</given-names></name><name><surname>Beroukhim</surname><given-names>R</given-names></name><name><surname>Sahinalp</surname><given-names>SC</given-names></name><name><surname>Ji</surname><given-names>Y</given-names></name><name><surname>Peifer</surname><given-names>M</given-names></name><name><surname>Martincorena</surname><given-names>I</given-names></name><name><surname>Markowetz</surname><given-names>F</given-names></name><name><surname>Mustonen</surname><given-names>V</given-names></name><name><surname>Yuan</surname><given-names>K</given-names></name><name><surname>Gerstung</surname><given-names>M</given-names></name><name><surname>Spellman</surname><given-names>PT</given-names></name><name><surname>Wang</surname><given-names>W</given-names></name><name><surname>Morris</surname><given-names>QD</given-names></name><name><surname>Wedge</surname><given-names>DC</given-names></name><name><surname>Van Loo</surname><given-names>P</given-names></name><collab>PCAWG Evolution and Heterogeneity Working Group and the PCAWG Consortium</collab></person-group><year iso-8601-date="2021">2021</year><article-title>Characterizing genetic intra-tumor heterogeneity across 2,658 human cancer genomes</article-title><source>Cell</source><volume>184</volume><fpage>2239</fpage><lpage>2254</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2021.03.009</pub-id><pub-id pub-id-type="pmid">33831375</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Devlin</surname><given-names>J</given-names></name><name><surname>Chang</surname><given-names>MW</given-names></name><name><surname>Lee</surname><given-names>K</given-names></name><name><surname>Toutanova</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>BERT: pre-training of deep bidirectional transformers for language understanding</article-title><source>arXiv</source><pub-id pub-id-type="doi">10.48550/arXiv.1810.04805</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Ding</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>ScPhere</data-title><version designator="1.0.0">1.0.0</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/klarman-cell-observatory/scPhere">https://github.com/klarman-cell-observatory/scPhere</ext-link></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ding</surname><given-names>J</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Deep generative model embedding of single-cell RNA-Seq profiles on hyperspheres and hyperbolic spaces</article-title><source>Nature Communications</source><volume>12</volume><elocation-id>2554</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-021-22851-4</pub-id><pub-id pub-id-type="pmid">33953202</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doucette</surname><given-names>T</given-names></name><name><surname>Rao</surname><given-names>G</given-names></name><name><surname>Rao</surname><given-names>A</given-names></name><name><surname>Shen</surname><given-names>L</given-names></name><name><surname>Aldape</surname><given-names>K</given-names></name><name><surname>Wei</surname><given-names>J</given-names></name><name><surname>Dziurzynski</surname><given-names>K</given-names></name><name><surname>Gilbert</surname><given-names>M</given-names></name><name><surname>Heimberger</surname><given-names>AB</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Immune heterogeneity of glioblastoma subtypes: extrapolation from the cancer genome atlas</article-title><source>Cancer Immunology Research</source><volume>1</volume><fpage>112</fpage><lpage>122</lpage><pub-id pub-id-type="doi">10.1158/2326-6066.CIR-13-0028</pub-id><pub-id pub-id-type="pmid">24409449</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dwivedi</surname><given-names>B</given-names></name><name><surname>Mumme</surname><given-names>H</given-names></name><name><surname>Satpathy</surname><given-names>S</given-names></name><name><surname>Bhasin</surname><given-names>SS</given-names></name><name><surname>Bhasin</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Survival Genie, a web platform for survival analysis across pediatric and adult cancers</article-title><source>Scientific Reports</source><volume>12</volume><elocation-id>3069</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-022-06841-0</pub-id><pub-id pub-id-type="pmid">35197510</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Einstein</surname><given-names>DJ</given-names></name><name><surname>Arai</surname><given-names>S</given-names></name><name><surname>Calagua</surname><given-names>C</given-names></name><name><surname>Xie</surname><given-names>F</given-names></name><name><surname>Voznesensky</surname><given-names>O</given-names></name><name><surname>Capaldo</surname><given-names>BJ</given-names></name><name><surname>Luffman</surname><given-names>C</given-names></name><name><surname>Hecht</surname><given-names>JL</given-names></name><name><surname>Balk</surname><given-names>SP</given-names></name><name><surname>Sowalsky</surname><given-names>AG</given-names></name><name><surname>Russo</surname><given-names>JW</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Metastatic castration-resistant prostate cancer remains dependent on oncogenic drivers found in primary tumors</article-title><source>JCO Precision Oncology</source><volume>5</volume><fpage>1514</fpage><lpage>1522</lpage><pub-id pub-id-type="doi">10.1200/PO.21.00059</pub-id><pub-id pub-id-type="pmid">34568716</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>E</given-names></name><name><surname>Rydzewski</surname><given-names>NR</given-names></name><name><surname>Zhang</surname><given-names>M</given-names></name><name><surname>Lundberg</surname><given-names>A</given-names></name><name><surname>Bootsma</surname><given-names>M</given-names></name><name><surname>Helzer</surname><given-names>KT</given-names></name><name><surname>Lang</surname><given-names>JM</given-names></name><name><surname>Aggarwal</surname><given-names>R</given-names></name><name><surname>Small</surname><given-names>EJ</given-names></name><name><surname>Quigley</surname><given-names>DA</given-names></name><name><surname>Sjöström</surname><given-names>M</given-names></name><name><surname>Zhao</surname><given-names>SG</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Intrinsic molecular subtypes of metastatic castration-resistant prostate cancer</article-title><source>Clinical Cancer Research</source><volume>28</volume><fpage>5396</fpage><lpage>5404</lpage><pub-id pub-id-type="doi">10.1158/1078-0432.CCR-22-2567</pub-id><pub-id pub-id-type="pmid">36260524</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Formaggio</surname><given-names>N</given-names></name><name><surname>Rubin</surname><given-names>MA</given-names></name><name><surname>Theurillat</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Loss and revival of androgen receptor signaling in advanced prostate cancer</article-title><source>Oncogene</source><volume>40</volume><fpage>1205</fpage><lpage>1216</lpage><pub-id pub-id-type="doi">10.1038/s41388-020-01598-0</pub-id><pub-id pub-id-type="pmid">33420371</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gendoo</surname><given-names>DMA</given-names></name><name><surname>Ratanasirigulchai</surname><given-names>N</given-names></name><name><surname>Schröder</surname><given-names>MS</given-names></name><name><surname>Paré</surname><given-names>L</given-names></name><name><surname>Parker</surname><given-names>JS</given-names></name><name><surname>Prat</surname><given-names>A</given-names></name><name><surname>Haibe-Kains</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Genefu: an R/Bioconductor package for computation of gene expression-based signatures in breast cancer</article-title><source>Bioinformatics</source><volume>32</volume><fpage>1097</fpage><lpage>1099</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btv693</pub-id><pub-id pub-id-type="pmid">26607490</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gonzalez-Ibanez</surname><given-names>AM</given-names></name><name><surname>Ruiz</surname><given-names>LM</given-names></name><name><surname>Jensen</surname><given-names>E</given-names></name><name><surname>Echeverria</surname><given-names>CA</given-names></name><name><surname>Romero</surname><given-names>V</given-names></name><name><surname>Stiles</surname><given-names>L</given-names></name><name><surname>Shirihai</surname><given-names>OS</given-names></name><name><surname>Elorza</surname><given-names>AA</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Erythroid differentiation and heme biosynthesis are dependent on a shift in the balance of mitochondrial fusion and fission dynamics</article-title><source>Frontiers in Cell and Developmental Biology</source><volume>8</volume><elocation-id>592035</elocation-id><pub-id pub-id-type="doi">10.3389/fcell.2020.592035</pub-id><pub-id pub-id-type="pmid">33330472</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gupta</surname><given-names>PB</given-names></name><name><surname>Pastushenko</surname><given-names>I</given-names></name><name><surname>Skibinski</surname><given-names>A</given-names></name><name><surname>Blanpain</surname><given-names>C</given-names></name><name><surname>Kuperwasser</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Phenotypic plasticity: driver of cancer initiation, progression, and therapy resistance</article-title><source>Cell Stem Cell</source><volume>24</volume><fpage>65</fpage><lpage>78</lpage><pub-id pub-id-type="doi">10.1016/j.stem.2018.11.011</pub-id><pub-id pub-id-type="pmid">30554963</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Han</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Curto</surname><given-names>J</given-names></name><name><surname>Gurrapu</surname><given-names>S</given-names></name><name><surname>Laudato</surname><given-names>S</given-names></name><name><surname>Rumandla</surname><given-names>A</given-names></name><name><surname>Chakraborty</surname><given-names>G</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Chen</surname><given-names>H</given-names></name><name><surname>Jiang</surname><given-names>Y</given-names></name><name><surname>Kumar</surname><given-names>D</given-names></name><name><surname>Caggiano</surname><given-names>EG</given-names></name><name><surname>Capogiri</surname><given-names>M</given-names></name><name><surname>Zhang</surname><given-names>B</given-names></name><name><surname>Ji</surname><given-names>Y</given-names></name><name><surname>Maity</surname><given-names>SN</given-names></name><name><surname>Hu</surname><given-names>M</given-names></name><name><surname>Bai</surname><given-names>S</given-names></name><name><surname>Aparicio</surname><given-names>AM</given-names></name><name><surname>Efstathiou</surname><given-names>E</given-names></name><name><surname>Logothetis</surname><given-names>CJ</given-names></name><name><surname>Navin</surname><given-names>N</given-names></name><name><surname>Navone</surname><given-names>NM</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Giancotti</surname><given-names>FG</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Mesenchymal and stem-like prostate cancer linked to therapy-induced lineage plasticity and metastasis</article-title><source>Cell Reports</source><volume>39</volume><elocation-id>110595</elocation-id><pub-id pub-id-type="doi">10.1016/j.celrep.2022.110595</pub-id><pub-id pub-id-type="pmid">35385726</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hangauer</surname><given-names>MJ</given-names></name><name><surname>Viswanathan</surname><given-names>VS</given-names></name><name><surname>Ryan</surname><given-names>MJ</given-names></name><name><surname>Bole</surname><given-names>D</given-names></name><name><surname>Eaton</surname><given-names>JK</given-names></name><name><surname>Matov</surname><given-names>A</given-names></name><name><surname>Galeas</surname><given-names>J</given-names></name><name><surname>Dhruv</surname><given-names>HD</given-names></name><name><surname>Berens</surname><given-names>ME</given-names></name><name><surname>Schreiber</surname><given-names>SL</given-names></name><name><surname>McCormick</surname><given-names>F</given-names></name><name><surname>McManus</surname><given-names>MT</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Drug-tolerant persister cancer cells are vulnerable to GPX4 inhibition</article-title><source>Nature</source><volume>551</volume><fpage>247</fpage><lpage>250</lpage><pub-id pub-id-type="doi">10.1038/nature24297</pub-id><pub-id pub-id-type="pmid">29088702</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hänzelmann</surname><given-names>S</given-names></name><name><surname>Castelo</surname><given-names>R</given-names></name><name><surname>Guinney</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>GSVA: gene set variation analysis for microarray and RNA-seq data</article-title><source>BMC Bioinformatics</source><volume>14</volume><fpage>1</fpage><lpage>15</lpage><pub-id pub-id-type="doi">10.1186/1471-2105-14-7</pub-id><pub-id pub-id-type="pmid">23323831</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hao</surname><given-names>Y</given-names></name><name><surname>Hao</surname><given-names>S</given-names></name><name><surname>Andersen-Nissen</surname><given-names>E</given-names></name><name><surname>Mauck</surname><given-names>WM</given-names></name><name><surname>Zheng</surname><given-names>S</given-names></name><name><surname>Butler</surname><given-names>A</given-names></name><name><surname>Lee</surname><given-names>MJ</given-names></name><name><surname>Wilk</surname><given-names>AJ</given-names></name><name><surname>Darby</surname><given-names>C</given-names></name><name><surname>Zager</surname><given-names>M</given-names></name><name><surname>Hoffman</surname><given-names>P</given-names></name><name><surname>Stoeckius</surname><given-names>M</given-names></name><name><surname>Papalexi</surname><given-names>E</given-names></name><name><surname>Mimitou</surname><given-names>EP</given-names></name><name><surname>Jain</surname><given-names>J</given-names></name><name><surname>Srivastava</surname><given-names>A</given-names></name><name><surname>Stuart</surname><given-names>T</given-names></name><name><surname>Fleming</surname><given-names>LM</given-names></name><name><surname>Yeung</surname><given-names>B</given-names></name><name><surname>Rogers</surname><given-names>AJ</given-names></name><name><surname>McElrath</surname><given-names>JM</given-names></name><name><surname>Blish</surname><given-names>CA</given-names></name><name><surname>Gottardo</surname><given-names>R</given-names></name><name><surname>Smibert</surname><given-names>P</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Integrated analysis of multimodal single-cell data</article-title><source>Cell</source><volume>184</volume><fpage>3573</fpage><lpage>3587</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2021.04.048</pub-id><pub-id pub-id-type="pmid">34062119</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>MX</given-names></name><name><surname>Cuoco</surname><given-names>MS</given-names></name><name><surname>Crowdis</surname><given-names>J</given-names></name><name><surname>Bosma-Moody</surname><given-names>A</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Bi</surname><given-names>K</given-names></name><name><surname>Kanodia</surname><given-names>A</given-names></name><name><surname>Su</surname><given-names>M-J</given-names></name><name><surname>Ku</surname><given-names>S-Y</given-names></name><name><surname>Garcia</surname><given-names>MM</given-names></name><name><surname>Sweet</surname><given-names>AR</given-names></name><name><surname>Rodman</surname><given-names>C</given-names></name><name><surname>DelloStritto</surname><given-names>L</given-names></name><name><surname>Silver</surname><given-names>R</given-names></name><name><surname>Steinharter</surname><given-names>J</given-names></name><name><surname>Shah</surname><given-names>P</given-names></name><name><surname>Izar</surname><given-names>B</given-names></name><name><surname>Walk</surname><given-names>NC</given-names></name><name><surname>Burke</surname><given-names>KP</given-names></name><name><surname>Bakouny</surname><given-names>Z</given-names></name><name><surname>Tewari</surname><given-names>AK</given-names></name><name><surname>Liu</surname><given-names>D</given-names></name><name><surname>Camp</surname><given-names>SY</given-names></name><name><surname>Vokes</surname><given-names>NI</given-names></name><name><surname>Salari</surname><given-names>K</given-names></name><name><surname>Park</surname><given-names>J</given-names></name><name><surname>Vigneau</surname><given-names>S</given-names></name><name><surname>Fong</surname><given-names>L</given-names></name><name><surname>Russo</surname><given-names>JW</given-names></name><name><surname>Yuan</surname><given-names>X</given-names></name><name><surname>Balk</surname><given-names>SP</given-names></name><name><surname>Beltran</surname><given-names>H</given-names></name><name><surname>Rozenblatt-Rosen</surname><given-names>O</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Rotem</surname><given-names>A</given-names></name><name><surname>Taplin</surname><given-names>M-E</given-names></name><name><surname>Van Allen</surname><given-names>EM</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Transcriptional mediators of treatment resistance in lethal prostate cancer</article-title><source>Nature Medicine</source><volume>27</volume><fpage>426</fpage><lpage>433</lpage><pub-id pub-id-type="doi">10.1038/s41591-021-01244-6</pub-id><pub-id pub-id-type="pmid">33664492</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hennigs</surname><given-names>A</given-names></name><name><surname>Riedel</surname><given-names>F</given-names></name><name><surname>Gondos</surname><given-names>A</given-names></name><name><surname>Sinn</surname><given-names>P</given-names></name><name><surname>Schirmacher</surname><given-names>P</given-names></name><name><surname>Marmé</surname><given-names>F</given-names></name><name><surname>Jäger</surname><given-names>D</given-names></name><name><surname>Kauczor</surname><given-names>HU</given-names></name><name><surname>Stieber</surname><given-names>A</given-names></name><name><surname>Lindel</surname><given-names>K</given-names></name><name><surname>Debus</surname><given-names>J</given-names></name><name><surname>Golatta</surname><given-names>M</given-names></name><name><surname>Schütz</surname><given-names>F</given-names></name><name><surname>Sohn</surname><given-names>C</given-names></name><name><surname>Heil</surname><given-names>J</given-names></name><name><surname>Schneeweiss</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Prognosis of breast cancer molecular subtypes in routine clinical care: A large prospective cohort study</article-title><source>BMC Cancer</source><volume>16</volume><elocation-id>734</elocation-id><pub-id pub-id-type="doi">10.1186/s12885-016-2766-3</pub-id><pub-id pub-id-type="pmid">27634735</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Henry</surname><given-names>GH</given-names></name><name><surname>Malewska</surname><given-names>A</given-names></name><name><surname>Joseph</surname><given-names>DB</given-names></name><name><surname>Malladi</surname><given-names>VS</given-names></name><name><surname>Lee</surname><given-names>J</given-names></name><name><surname>Torrealba</surname><given-names>J</given-names></name><name><surname>Mauck</surname><given-names>RJ</given-names></name><name><surname>Gahan</surname><given-names>JC</given-names></name><name><surname>Raj</surname><given-names>GV</given-names></name><name><surname>Roehrborn</surname><given-names>CG</given-names></name><name><surname>Hon</surname><given-names>GC</given-names></name><name><surname>MacConmara</surname><given-names>MP</given-names></name><name><surname>Reese</surname><given-names>JC</given-names></name><name><surname>Hutchinson</surname><given-names>RC</given-names></name><name><surname>Vezina</surname><given-names>CM</given-names></name><name><surname>Strand</surname><given-names>DW</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A cellular anatomy of the normal adult human prostate and prostatic urethra</article-title><source>Cell Reports</source><volume>25</volume><fpage>3530</fpage><lpage>3542</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2018.11.086</pub-id><pub-id pub-id-type="pmid">30566875</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Hu</surname><given-names>G</given-names></name><name><surname>Lyu</surname><given-names>Y</given-names></name><name><surname>Susztak</surname><given-names>K</given-names></name><name><surname>Li</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Iterative transfer learning with neural network for clustering and cell type classification in single-cell RNA-seq analysis</article-title><source>Nature Machine Intelligence</source><volume>2</volume><fpage>607</fpage><lpage>618</lpage><pub-id pub-id-type="doi">10.1038/s42256-020-00233-7</pub-id><pub-id pub-id-type="pmid">33817554</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>ItClust</data-title><version designator="1.2.0">1.2.0</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/jianhuupenn/ItClust">https://github.com/jianhuupenn/ItClust</ext-link></element-citation></ref><ref id="bib46"><element-citation publication-type="thesis"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>PJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Classification of Imbalanced Data Using Synthetic Over-Sampling</article-title><publisher-name>ProQuest</publisher-name></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Infantino</surname><given-names>S</given-names></name><name><surname>Light</surname><given-names>A</given-names></name><name><surname>O’Donnell</surname><given-names>K</given-names></name><name><surname>Bryant</surname><given-names>V</given-names></name><name><surname>Avery</surname><given-names>DT</given-names></name><name><surname>Elliott</surname><given-names>M</given-names></name><name><surname>Tangye</surname><given-names>SG</given-names></name><name><surname>Belz</surname><given-names>G</given-names></name><name><surname>Mackay</surname><given-names>F</given-names></name><name><surname>Richard</surname><given-names>S</given-names></name><name><surname>Tarlinton</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Arginine methylation catalyzed by PRMT1 is required for B cell activation and differentiation</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>891</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-017-01009-1</pub-id><pub-id pub-id-type="pmid">29026071</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ishwaran</surname><given-names>H</given-names></name><name><surname>Kogalur</surname><given-names>UB</given-names></name><name><surname>Blackstone</surname><given-names>EH</given-names></name><name><surname>Lauer</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Random survival forests</article-title><source>The Annals of Applied Statistics</source><volume>2</volume><elocation-id>AOAS169</elocation-id><pub-id pub-id-type="doi">10.1214/08-AOAS169</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kanev</surname><given-names>K</given-names></name><name><surname>Roelli</surname><given-names>P</given-names></name><name><surname>Wu</surname><given-names>M</given-names></name><name><surname>Wurmser</surname><given-names>C</given-names></name><name><surname>Delorenzi</surname><given-names>M</given-names></name><name><surname>Pfaffl</surname><given-names>MW</given-names></name><name><surname>Zehn</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Tailoring the resolution of single-cell RNA sequencing for primary cytotoxic T cells</article-title><source>Nature Communications</source><volume>12</volume><elocation-id>569</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-020-20751-7</pub-id><pub-id pub-id-type="pmid">33495472</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karaayvaz</surname><given-names>M</given-names></name><name><surname>Cristea</surname><given-names>S</given-names></name><name><surname>Gillespie</surname><given-names>SM</given-names></name><name><surname>Patel</surname><given-names>AP</given-names></name><name><surname>Mylvaganam</surname><given-names>R</given-names></name><name><surname>Luo</surname><given-names>CC</given-names></name><name><surname>Specht</surname><given-names>MC</given-names></name><name><surname>Bernstein</surname><given-names>BE</given-names></name><name><surname>Michor</surname><given-names>F</given-names></name><name><surname>Ellisen</surname><given-names>LW</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Unravelling subclonal heterogeneity and aggressive disease states in TNBC through single-cell RNA-seq</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>3588</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-06052-0</pub-id><pub-id pub-id-type="pmid">30181541</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karthaus</surname><given-names>WR</given-names></name><name><surname>Hofree</surname><given-names>M</given-names></name><name><surname>Choi</surname><given-names>D</given-names></name><name><surname>Linton</surname><given-names>EL</given-names></name><name><surname>Turkekul</surname><given-names>M</given-names></name><name><surname>Bejnood</surname><given-names>A</given-names></name><name><surname>Carver</surname><given-names>B</given-names></name><name><surname>Gopalan</surname><given-names>A</given-names></name><name><surname>Abida</surname><given-names>W</given-names></name><name><surname>Laudone</surname><given-names>V</given-names></name><name><surname>Biton</surname><given-names>M</given-names></name><name><surname>Chaudhary</surname><given-names>O</given-names></name><name><surname>Xu</surname><given-names>T</given-names></name><name><surname>Masilionis</surname><given-names>I</given-names></name><name><surname>Manova</surname><given-names>K</given-names></name><name><surname>Mazutis</surname><given-names>L</given-names></name><name><surname>Pe’er</surname><given-names>D</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Sawyers</surname><given-names>CL</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Regenerative potential of prostate luminal cells revealed by single-cell analysis</article-title><source>Science</source><volume>368</volume><fpage>497</fpage><lpage>505</lpage><pub-id pub-id-type="doi">10.1126/science.aay0267</pub-id><pub-id pub-id-type="pmid">32355025</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kfoury</surname><given-names>Y</given-names></name><name><surname>Baryawno</surname><given-names>N</given-names></name><name><surname>Severe</surname><given-names>N</given-names></name><name><surname>Mei</surname><given-names>S</given-names></name><name><surname>Gustafsson</surname><given-names>K</given-names></name><name><surname>Hirz</surname><given-names>T</given-names></name><name><surname>Brouse</surname><given-names>T</given-names></name><name><surname>Scadden</surname><given-names>EW</given-names></name><name><surname>Igolkina</surname><given-names>AA</given-names></name><name><surname>Kokkaliaris</surname><given-names>K</given-names></name><name><surname>Choi</surname><given-names>BD</given-names></name><name><surname>Barkas</surname><given-names>N</given-names></name><name><surname>Randolph</surname><given-names>MA</given-names></name><name><surname>Shin</surname><given-names>JH</given-names></name><name><surname>Saylor</surname><given-names>PJ</given-names></name><name><surname>Scadden</surname><given-names>DT</given-names></name><name><surname>Sykes</surname><given-names>DB</given-names></name><name><surname>Kharchenko</surname><given-names>PV</given-names></name><collab>as part of the Boston Bone Metastases Consortium</collab></person-group><year iso-8601-date="2021">2021</year><article-title>Human prostate cancer bone metastases have an actionable immunosuppressive microenvironment</article-title><source>Cancer Cell</source><volume>39</volume><fpage>1464</fpage><lpage>1478</lpage><pub-id pub-id-type="doi">10.1016/j.ccell.2021.09.005</pub-id><pub-id pub-id-type="pmid">34719426</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khan</surname><given-names>SA</given-names></name><name><surname>Maillo</surname><given-names>A</given-names></name><name><surname>Lagani</surname><given-names>V</given-names></name><name><surname>Lehmann</surname><given-names>R</given-names></name><name><surname>Kiani</surname><given-names>NA</given-names></name><name><surname>Gomez-Cabrero</surname><given-names>D</given-names></name><name><surname>Tegner</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Reusability report: Learning the transcriptional grammar in single-cell RNA-sequencing data using transformers</article-title><source>Nature Machine Intelligence</source><volume>5</volume><fpage>1437</fpage><lpage>1446</lpage><pub-id pub-id-type="doi">10.1038/s42256-023-00757-8</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>S</given-names></name><name><surname>Lee</surname><given-names>CK</given-names></name><name><surname>Choi</surname><given-names>Y</given-names></name><name><surname>Baek</surname><given-names>ES</given-names></name><name><surname>Choi</surname><given-names>JE</given-names></name><name><surname>Lim</surname><given-names>JS</given-names></name><name><surname>Kang</surname><given-names>J</given-names></name><name><surname>Shin</surname><given-names>SJ</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Deep-learning-based natural language processing of serial free-text radiological reports for predicting rectal cancer patient survival</article-title><source>Frontiers in Oncology</source><volume>11</volume><elocation-id>747250</elocation-id><pub-id pub-id-type="doi">10.3389/fonc.2021.747250</pub-id><pub-id pub-id-type="pmid">34868947</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Labrecque</surname><given-names>MP</given-names></name><name><surname>Coleman</surname><given-names>IM</given-names></name><name><surname>Brown</surname><given-names>LG</given-names></name><name><surname>True</surname><given-names>LD</given-names></name><name><surname>Kollath</surname><given-names>L</given-names></name><name><surname>Lakely</surname><given-names>B</given-names></name><name><surname>Nguyen</surname><given-names>HM</given-names></name><name><surname>Yang</surname><given-names>YC</given-names></name><name><surname>da Costa</surname><given-names>RMG</given-names></name><name><surname>Kaipainen</surname><given-names>A</given-names></name><name><surname>Coleman</surname><given-names>R</given-names></name><name><surname>Higano</surname><given-names>CS</given-names></name><name><surname>Yu</surname><given-names>EY</given-names></name><name><surname>Cheng</surname><given-names>HH</given-names></name><name><surname>Mostaghel</surname><given-names>EA</given-names></name><name><surname>Montgomery</surname><given-names>B</given-names></name><name><surname>Schweizer</surname><given-names>MT</given-names></name><name><surname>Hsieh</surname><given-names>AC</given-names></name><name><surname>Lin</surname><given-names>DW</given-names></name><name><surname>Corey</surname><given-names>E</given-names></name><name><surname>Nelson</surname><given-names>PS</given-names></name><name><surname>Morrissey</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Molecular profiling stratifies diverse phenotypes of treatment-refractory metastatic castration-resistant prostate cancer</article-title><source>The Journal of Clinical Investigation</source><volume>129</volume><fpage>4492</fpage><lpage>4505</lpage><pub-id pub-id-type="doi">10.1172/JCI128212</pub-id><pub-id pub-id-type="pmid">31361600</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawson</surname><given-names>DA</given-names></name><name><surname>Kessenbrock</surname><given-names>K</given-names></name><name><surname>Davis</surname><given-names>RT</given-names></name><name><surname>Pervolarakis</surname><given-names>N</given-names></name><name><surname>Werb</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Tumour heterogeneity and metastasis at single-cell resolution</article-title><source>Nature Cell Biology</source><volume>20</volume><fpage>1349</fpage><lpage>1360</lpage><pub-id pub-id-type="doi">10.1038/s41556-018-0236-7</pub-id><pub-id pub-id-type="pmid">30482943</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Le</surname><given-names>Q</given-names></name><name><surname>Mikolov</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Distributed representations of sentences and documents</article-title><conf-name>Proceedings of the 31st International Conference on Machine Learning</conf-name><fpage>1188</fpage><lpage>1196</lpage></element-citation></ref><ref id="bib58"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Lemaitre</surname><given-names>G</given-names></name><name><surname>Nogueira</surname><given-names>F</given-names></name><name><surname>Aridas</surname><given-names>CK</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Imbalanced-learn: a python toolbox to tackle the curse of imbalanced datasets in machine learning</article-title><source>arXiv</source><pub-id pub-id-type="doi">10.48550/arXiv.1609.06570</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Lyu</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Desc</data-title><version designator="2.1.1">2.1.1</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/eleozzr/desc">https://github.com/eleozzr/desc</ext-link></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>K</given-names></name><name><surname>Lyu</surname><given-names>Y</given-names></name><name><surname>Pan</surname><given-names>H</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Stambolian</surname><given-names>D</given-names></name><name><surname>Susztak</surname><given-names>K</given-names></name><name><surname>Reilly</surname><given-names>MP</given-names></name><name><surname>Hu</surname><given-names>G</given-names></name><name><surname>Li</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Deep learning enables accurate clustering with batch effect removal in single-cell RNA-seq analysis</article-title><source>Nature Communications</source><volume>11</volume><elocation-id>2338</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-020-15851-3</pub-id><pub-id pub-id-type="pmid">32393754</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liberzon</surname><given-names>A</given-names></name><name><surname>Birger</surname><given-names>C</given-names></name><name><surname>Thorvaldsdóttir</surname><given-names>H</given-names></name><name><surname>Ghandi</surname><given-names>M</given-names></name><name><surname>Mesirov</surname><given-names>JP</given-names></name><name><surname>Tamayo</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The molecular signatures database (MSigDB) hallmark gene set collection</article-title><source>Cell Systems</source><volume>1</volume><fpage>417</fpage><lpage>425</lpage><pub-id pub-id-type="doi">10.1016/j.cels.2015.12.004</pub-id><pub-id pub-id-type="pmid">26771021</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>N</given-names></name><name><surname>Yan</surname><given-names>W</given-names></name><name><surname>Gao</surname><given-names>K</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>You</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Prevalence and clinicopathologic characteristics of the molecular subtypes in malignant glioma: a multi-institutional analysis of 941 cases</article-title><source>PLOS ONE</source><volume>9</volume><elocation-id>e94871</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0094871</pub-id><pub-id pub-id-type="pmid">24755548</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>C</given-names></name><name><surname>Miller</surname><given-names>H</given-names></name><name><surname>Sharma</surname><given-names>S</given-names></name><name><surname>Beaven</surname><given-names>A</given-names></name><name><surname>Upadhyaya</surname><given-names>A</given-names></name><name><surname>Song</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Analyzing actin dynamics during the activation of the B cell receptor in live B cells</article-title><source>Biochemical and Biophysical Research Communications</source><volume>427</volume><fpage>202</fpage><lpage>206</lpage><pub-id pub-id-type="doi">10.1016/j.bbrc.2012.09.046</pub-id><pub-id pub-id-type="pmid">22995298</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>Z</given-names></name><name><surname>Zhang</surname><given-names>XS</given-names></name><name><surname>Zhang</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Breast tumor subgroups reveal diverse clinical prognostic power</article-title><source>Scientific Reports</source><volume>4</volume><elocation-id>4002</elocation-id><pub-id pub-id-type="doi">10.1038/srep04002</pub-id><pub-id pub-id-type="pmid">24499868</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lloyd</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>Least squares quantization in PCM</article-title><source>IEEE Transactions on Information Theory</source><volume>28</volume><fpage>129</fpage><lpage>137</lpage><pub-id pub-id-type="doi">10.1109/TIT.1982.1056489</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lugano</surname><given-names>R</given-names></name><name><surname>Ramachandran</surname><given-names>M</given-names></name><name><surname>Dimberg</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Tumor angiogenesis: causes, consequences, challenges and opportunities</article-title><source>Cellular and Molecular Life Sciences</source><volume>77</volume><fpage>1745</fpage><lpage>1770</lpage><pub-id pub-id-type="doi">10.1007/s00018-019-03351-7</pub-id><pub-id pub-id-type="pmid">31690961</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mathews</surname><given-names>JC</given-names></name><name><surname>Nadeem</surname><given-names>S</given-names></name><name><surname>Levine</surname><given-names>AJ</given-names></name><name><surname>Pouryahya</surname><given-names>M</given-names></name><name><surname>Deasy</surname><given-names>JO</given-names></name><name><surname>Tannenbaum</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Robust and interpretable PAM50 reclassification exhibits survival advantage for myoepithelial and immune phenotypes</article-title><source>NPJ Breast Cancer</source><volume>5</volume><elocation-id>30</elocation-id><pub-id pub-id-type="doi">10.1038/s41523-019-0124-8</pub-id><pub-id pub-id-type="pmid">31531391</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Merkens</surname><given-names>L</given-names></name><name><surname>Sailer</surname><given-names>V</given-names></name><name><surname>Lessel</surname><given-names>D</given-names></name><name><surname>Janzen</surname><given-names>E</given-names></name><name><surname>Greimeier</surname><given-names>S</given-names></name><name><surname>Kirfel</surname><given-names>J</given-names></name><name><surname>Perner</surname><given-names>S</given-names></name><name><surname>Pantel</surname><given-names>K</given-names></name><name><surname>Werner</surname><given-names>S</given-names></name><name><surname>von Amsberg</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Aggressive variants of prostate cancer: underlying mechanisms of neuroendocrine transdifferentiation</article-title><source>Journal of Experimental &amp; Clinical Cancer Research</source><volume>41</volume><elocation-id>46</elocation-id><pub-id pub-id-type="doi">10.1186/s13046-022-02255-y</pub-id><pub-id pub-id-type="pmid">35109899</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Mikolov</surname><given-names>T</given-names></name><name><surname>Chen</surname><given-names>K</given-names></name><name><surname>Corrado</surname><given-names>G</given-names></name><name><surname>Dean</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2013">2013a</year><article-title>Efficient estimation of word representations in vector space</article-title><source>arXiv</source><pub-id pub-id-type="doi">10.48550/arXiv.1301.3781</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Mikolov</surname><given-names>T</given-names></name><name><surname>Sutskever</surname><given-names>I</given-names></name><name><surname>Chen</surname><given-names>K</given-names></name><name><surname>Corrado</surname><given-names>G</given-names></name><name><surname>Dean</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2013">2013b</year><article-title>Distributed representations of words and phrases and their compositionality</article-title><source>arXiv</source><pub-id pub-id-type="doi">10.48550/arXiv.1310.4546</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muraro</surname><given-names>MJ</given-names></name><name><surname>Dharmadhikari</surname><given-names>G</given-names></name><name><surname>Grün</surname><given-names>D</given-names></name><name><surname>Groen</surname><given-names>N</given-names></name><name><surname>Dielen</surname><given-names>T</given-names></name><name><surname>Jansen</surname><given-names>E</given-names></name><name><surname>van Gurp</surname><given-names>L</given-names></name><name><surname>Engelse</surname><given-names>MA</given-names></name><name><surname>Carlotti</surname><given-names>F</given-names></name><name><surname>de Koning</surname><given-names>EJP</given-names></name><name><surname>van Oudenaarden</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A single-cell transcriptome atlas of the human pancreas</article-title><source>Cell Systems</source><volume>3</volume><fpage>385</fpage><lpage>394</lpage><pub-id pub-id-type="doi">10.1016/j.cels.2016.09.002</pub-id><pub-id pub-id-type="pmid">27693023</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neftel</surname><given-names>C</given-names></name><name><surname>Laffy</surname><given-names>J</given-names></name><name><surname>Filbin</surname><given-names>MG</given-names></name><name><surname>Hara</surname><given-names>T</given-names></name><name><surname>Shore</surname><given-names>ME</given-names></name><name><surname>Rahme</surname><given-names>GJ</given-names></name><name><surname>Richman</surname><given-names>AR</given-names></name><name><surname>Silverbush</surname><given-names>D</given-names></name><name><surname>Shaw</surname><given-names>ML</given-names></name><name><surname>Hebert</surname><given-names>CM</given-names></name><name><surname>Dewitt</surname><given-names>J</given-names></name><name><surname>Gritsch</surname><given-names>S</given-names></name><name><surname>Perez</surname><given-names>EM</given-names></name><name><surname>Gonzalez Castro</surname><given-names>LN</given-names></name><name><surname>Lan</surname><given-names>X</given-names></name><name><surname>Druck</surname><given-names>N</given-names></name><name><surname>Rodman</surname><given-names>C</given-names></name><name><surname>Dionne</surname><given-names>D</given-names></name><name><surname>Kaplan</surname><given-names>A</given-names></name><name><surname>Bertalan</surname><given-names>MS</given-names></name><name><surname>Small</surname><given-names>J</given-names></name><name><surname>Pelton</surname><given-names>K</given-names></name><name><surname>Becker</surname><given-names>S</given-names></name><name><surname>Bonal</surname><given-names>D</given-names></name><name><surname>Nguyen</surname><given-names>QD</given-names></name><name><surname>Servis</surname><given-names>RL</given-names></name><name><surname>Fung</surname><given-names>JM</given-names></name><name><surname>Mylvaganam</surname><given-names>R</given-names></name><name><surname>Mayr</surname><given-names>L</given-names></name><name><surname>Gojo</surname><given-names>J</given-names></name><name><surname>Haberler</surname><given-names>C</given-names></name><name><surname>Geyeregger</surname><given-names>R</given-names></name><name><surname>Czech</surname><given-names>T</given-names></name><name><surname>Slavc</surname><given-names>I</given-names></name><name><surname>Nahed</surname><given-names>BV</given-names></name><name><surname>Curry</surname><given-names>WT</given-names></name><name><surname>Carter</surname><given-names>BS</given-names></name><name><surname>Wakimoto</surname><given-names>H</given-names></name><name><surname>Brastianos</surname><given-names>PK</given-names></name><name><surname>Batchelor</surname><given-names>TT</given-names></name><name><surname>Stemmer-Rachamimov</surname><given-names>A</given-names></name><name><surname>Martinez-Lage</surname><given-names>M</given-names></name><name><surname>Frosch</surname><given-names>MP</given-names></name><name><surname>Stamenkovic</surname><given-names>I</given-names></name><name><surname>Riggi</surname><given-names>N</given-names></name><name><surname>Rheinbay</surname><given-names>E</given-names></name><name><surname>Monje</surname><given-names>M</given-names></name><name><surname>Rozenblatt-Rosen</surname><given-names>O</given-names></name><name><surname>Cahill</surname><given-names>DP</given-names></name><name><surname>Patel</surname><given-names>AP</given-names></name><name><surname>Hunter</surname><given-names>T</given-names></name><name><surname>Verma</surname><given-names>IM</given-names></name><name><surname>Ligon</surname><given-names>KL</given-names></name><name><surname>Louis</surname><given-names>DN</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Bernstein</surname><given-names>BE</given-names></name><name><surname>Tirosh</surname><given-names>I</given-names></name><name><surname>Suvà</surname><given-names>ML</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>An integrative model of cellular states, plasticity, and genetics for glioblastoma</article-title><source>Cell</source><volume>178</volume><fpage>835</fpage><lpage>849</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2019.06.024</pub-id><pub-id pub-id-type="pmid">31327527</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nolte</surname><given-names>MA</given-names></name><name><surname>Arens</surname><given-names>R</given-names></name><name><surname>Kraus</surname><given-names>M</given-names></name><name><surname>van Oers</surname><given-names>MHJ</given-names></name><name><surname>Kraal</surname><given-names>G</given-names></name><name><surname>van Lier</surname><given-names>RAW</given-names></name><name><surname>Mebius</surname><given-names>RE</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>B cells are crucial for both development and maintenance of the splenic marginal zone</article-title><source>Journal of Immunology</source><volume>172</volume><fpage>3620</fpage><lpage>3627</lpage><pub-id pub-id-type="doi">10.4049/jimmunol.172.6.3620</pub-id><pub-id pub-id-type="pmid">15004164</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nunez</surname><given-names>JJ</given-names></name><name><surname>Leung</surname><given-names>B</given-names></name><name><surname>Ho</surname><given-names>C</given-names></name><name><surname>Bates</surname><given-names>AT</given-names></name><name><surname>Ng</surname><given-names>RT</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Predicting the survival of patients with cancer from their initial oncology consultation document using natural language processing</article-title><source>JAMA Network Open</source><volume>6</volume><elocation-id>e230813</elocation-id><pub-id pub-id-type="doi">10.1001/jamanetworkopen.2023.0813</pub-id><pub-id pub-id-type="pmid">36848085</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pang</surname><given-names>L</given-names></name><name><surname>Xiang</surname><given-names>F</given-names></name><name><surname>Yang</surname><given-names>H</given-names></name><name><surname>Shen</surname><given-names>X</given-names></name><name><surname>Fang</surname><given-names>M</given-names></name><name><surname>Li</surname><given-names>R</given-names></name><name><surname>Long</surname><given-names>Y</given-names></name><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Yu</surname><given-names>Y</given-names></name><name><surname>Pang</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Single-cell integrative analysis reveals consensus cancer cell states and clinical relevance in breast cancer</article-title><source>Scientific Data</source><volume>11</volume><elocation-id>289</elocation-id><pub-id pub-id-type="doi">10.1038/s41597-024-03127-0</pub-id><pub-id pub-id-type="pmid">38472225</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parker</surname><given-names>JS</given-names></name><name><surname>Mullins</surname><given-names>M</given-names></name><name><surname>Cheang</surname><given-names>MCU</given-names></name><name><surname>Leung</surname><given-names>S</given-names></name><name><surname>Voduc</surname><given-names>D</given-names></name><name><surname>Vickery</surname><given-names>T</given-names></name><name><surname>Davies</surname><given-names>S</given-names></name><name><surname>Fauron</surname><given-names>C</given-names></name><name><surname>He</surname><given-names>X</given-names></name><name><surname>Hu</surname><given-names>Z</given-names></name><name><surname>Quackenbush</surname><given-names>JF</given-names></name><name><surname>Stijleman</surname><given-names>IJ</given-names></name><name><surname>Palazzo</surname><given-names>J</given-names></name><name><surname>Marron</surname><given-names>JS</given-names></name><name><surname>Nobel</surname><given-names>AB</given-names></name><name><surname>Mardis</surname><given-names>E</given-names></name><name><surname>Nielsen</surname><given-names>TO</given-names></name><name><surname>Ellis</surname><given-names>MJ</given-names></name><name><surname>Perou</surname><given-names>CM</given-names></name><name><surname>Bernard</surname><given-names>PS</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Supervised risk predictor of breast cancer based on intrinsic subtypes</article-title><source>Journal of Clinical Oncology</source><volume>27</volume><fpage>1160</fpage><lpage>1167</lpage><pub-id pub-id-type="doi">10.1200/JCO.2008.18.1370</pub-id><pub-id pub-id-type="pmid">19204204</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patel</surname><given-names>AP</given-names></name><name><surname>Tirosh</surname><given-names>I</given-names></name><name><surname>Trombetta</surname><given-names>JJ</given-names></name><name><surname>Shalek</surname><given-names>AK</given-names></name><name><surname>Gillespie</surname><given-names>SM</given-names></name><name><surname>Wakimoto</surname><given-names>H</given-names></name><name><surname>Cahill</surname><given-names>DP</given-names></name><name><surname>Nahed</surname><given-names>BV</given-names></name><name><surname>Curry</surname><given-names>WT</given-names></name><name><surname>Martuza</surname><given-names>RL</given-names></name><name><surname>Louis</surname><given-names>DN</given-names></name><name><surname>Rozenblatt-Rosen</surname><given-names>O</given-names></name><name><surname>Suvà</surname><given-names>ML</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Bernstein</surname><given-names>BE</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Single-cell RNA-seq highlights intratumoral heterogeneity in primary glioblastoma</article-title><source>Science</source><volume>344</volume><fpage>1396</fpage><lpage>1401</lpage><pub-id pub-id-type="doi">10.1126/science.1254257</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pedregosa</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Scikit-learn: machine learning in python</article-title><source>The Journal of Machine Learning Research</source><volume>12</volume><fpage>2825</fpage><lpage>2830</lpage></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Phongpreecha</surname><given-names>T</given-names></name><name><surname>Fernandez</surname><given-names>R</given-names></name><name><surname>Mrdjen</surname><given-names>D</given-names></name><name><surname>Culos</surname><given-names>A</given-names></name><name><surname>Gajera</surname><given-names>CR</given-names></name><name><surname>Wawro</surname><given-names>AM</given-names></name><name><surname>Stanley</surname><given-names>N</given-names></name><name><surname>Gaudilliere</surname><given-names>B</given-names></name><name><surname>Poston</surname><given-names>KL</given-names></name><name><surname>Aghaeepour</surname><given-names>N</given-names></name><name><surname>Montine</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Single-cell peripheral immunoprofiling of Alzheimer’s and Parkinson’s diseases</article-title><source>Science Advances</source><volume>6</volume><elocation-id>eabd5575</elocation-id><pub-id pub-id-type="doi">10.1126/sciadv.abd5575</pub-id><pub-id pub-id-type="pmid">33239300</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pölsterl</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>scikit-surviva: lA library for time-to-event analysis built on top of scikit-learn</article-title><source>Journal of Machine Learning Research: JMLR</source><volume>21</volume><fpage>1</fpage><lpage>6</lpage><pub-id pub-id-type="doi">10.1007/978-1-4842-5373-1_1</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poonia</surname><given-names>S</given-names></name><name><surname>Goel</surname><given-names>A</given-names></name><name><surname>Chawla</surname><given-names>S</given-names></name><name><surname>Bhattacharya</surname><given-names>N</given-names></name><name><surname>Rai</surname><given-names>P</given-names></name><name><surname>Lee</surname><given-names>YF</given-names></name><name><surname>Yap</surname><given-names>YS</given-names></name><name><surname>West</surname><given-names>J</given-names></name><name><surname>Bhagat</surname><given-names>AA</given-names></name><name><surname>Tayal</surname><given-names>J</given-names></name><name><surname>Mehta</surname><given-names>A</given-names></name><name><surname>Ahuja</surname><given-names>G</given-names></name><name><surname>Majumdar</surname><given-names>A</given-names></name><name><surname>Ramalingam</surname><given-names>N</given-names></name><name><surname>Sengupta</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Marker-free characterization of full-length transcriptomes of single live circulating tumor cells</article-title><source>Genome Research</source><volume>33</volume><fpage>80</fpage><lpage>95</lpage><pub-id pub-id-type="doi">10.1101/gr.276600.122</pub-id><pub-id pub-id-type="pmid">36414416</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Rehurek</surname><given-names>R</given-names></name><name><surname>Sojka</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2011">2011</year><source>Gensim–Python Framework for Vector Space Modelling</source><publisher-name>NLP Centre, Faculty of Informatics, Masaryk University</publisher-name></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Segerstolpe</surname><given-names>Å</given-names></name><name><surname>Palasantza</surname><given-names>A</given-names></name><name><surname>Eliasson</surname><given-names>P</given-names></name><name><surname>Andersson</surname><given-names>E-M</given-names></name><name><surname>Andréasson</surname><given-names>A-C</given-names></name><name><surname>Sun</surname><given-names>X</given-names></name><name><surname>Picelli</surname><given-names>S</given-names></name><name><surname>Sabirsh</surname><given-names>A</given-names></name><name><surname>Clausen</surname><given-names>M</given-names></name><name><surname>Bjursell</surname><given-names>MK</given-names></name><name><surname>Smith</surname><given-names>DM</given-names></name><name><surname>Kasper</surname><given-names>M</given-names></name><name><surname>Ämmälä</surname><given-names>C</given-names></name><name><surname>Sandberg</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Single-cell transcriptome profiling of human pancreatic islets in health and type 2 diabetes</article-title><source>Cell Metabolism</source><volume>24</volume><fpage>593</fpage><lpage>607</lpage><pub-id pub-id-type="doi">10.1016/j.cmet.2016.08.020</pub-id><pub-id pub-id-type="pmid">27667667</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simeonov</surname><given-names>KP</given-names></name><name><surname>Byrns</surname><given-names>CN</given-names></name><name><surname>Clark</surname><given-names>ML</given-names></name><name><surname>Norgard</surname><given-names>RJ</given-names></name><name><surname>Martin</surname><given-names>B</given-names></name><name><surname>Stanger</surname><given-names>BZ</given-names></name><name><surname>Shendure</surname><given-names>J</given-names></name><name><surname>McKenna</surname><given-names>A</given-names></name><name><surname>Lengner</surname><given-names>CJ</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Single-cell lineage tracing of metastatic cancer reveals selection of hybrid EMT states</article-title><source>Cancer Cell</source><volume>39</volume><fpage>1150</fpage><lpage>1162</lpage><pub-id pub-id-type="doi">10.1016/j.ccell.2021.05.005</pub-id><pub-id pub-id-type="pmid">34115987</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stelloo</surname><given-names>S</given-names></name><name><surname>Nevedomskaya</surname><given-names>E</given-names></name><name><surname>van der Poel</surname><given-names>HG</given-names></name><name><surname>de Jong</surname><given-names>J</given-names></name><name><surname>van Leenders</surname><given-names>GJLH</given-names></name><name><surname>Jenster</surname><given-names>G</given-names></name><name><surname>Wessels</surname><given-names>LFA</given-names></name><name><surname>Bergman</surname><given-names>AM</given-names></name><name><surname>Zwart</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Androgen receptor profiling predicts prostate cancer outcome</article-title><source>EMBO Molecular Medicine</source><volume>7</volume><fpage>1450</fpage><lpage>1464</lpage><pub-id pub-id-type="doi">10.15252/emmm.201505424</pub-id><pub-id pub-id-type="pmid">26412853</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stoeckius</surname><given-names>M</given-names></name><name><surname>Hafemeister</surname><given-names>C</given-names></name><name><surname>Stephenson</surname><given-names>W</given-names></name><name><surname>Houck-Loomis</surname><given-names>B</given-names></name><name><surname>Chattopadhyay</surname><given-names>PK</given-names></name><name><surname>Swerdlow</surname><given-names>H</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name><name><surname>Smibert</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Simultaneous epitope and transcriptome measurement in single cells</article-title><source>Nature Methods</source><volume>14</volume><fpage>865</fpage><lpage>868</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4380</pub-id><pub-id pub-id-type="pmid">28759029</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stoeckius</surname><given-names>M</given-names></name><name><surname>Zheng</surname><given-names>S</given-names></name><name><surname>Houck-Loomis</surname><given-names>B</given-names></name><name><surname>Hao</surname><given-names>S</given-names></name><name><surname>Yeung</surname><given-names>BZ</given-names></name><name><surname>Mauck</surname><given-names>WM</given-names></name><name><surname>Smibert</surname><given-names>P</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Cell Hashing with barcoded antibodies enables multiplexing and doublet detection for single cell genomics</article-title><source>Genome Biology</source><volume>19</volume><elocation-id>224</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-018-1603-1</pub-id><pub-id pub-id-type="pmid">30567574</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Strehl</surname><given-names>JD</given-names></name><name><surname>Wachter</surname><given-names>DL</given-names></name><name><surname>Fasching</surname><given-names>PA</given-names></name><name><surname>Beckmann</surname><given-names>MW</given-names></name><name><surname>Hartmann</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Invasive breast cancer: recognition of molecular subtypes</article-title><source>Breast Care</source><volume>6</volume><fpage>258</fpage><lpage>264</lpage><pub-id pub-id-type="doi">10.1159/000331339</pub-id><pub-id pub-id-type="pmid">22135623</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>Y</given-names></name><name><surname>Qazi</surname><given-names>MA</given-names></name><name><surname>Brown</surname><given-names>KR</given-names></name><name><surname>Mikolajewicz</surname><given-names>N</given-names></name><name><surname>Moffat</surname><given-names>J</given-names></name><name><surname>Singh</surname><given-names>SK</given-names></name><name><surname>McNicholas</surname><given-names>PD</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Identification of five important genes to predict glioblastoma subtypes</article-title><source>Neuro-Oncology Advances</source><volume>3</volume><elocation-id>vdab144</elocation-id><pub-id pub-id-type="doi">10.1093/noajnl/vdab144</pub-id><pub-id pub-id-type="pmid">34765972</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="software"><person-group person-group-type="author"><collab>Tencent AI Lab Healthcare</collab></person-group><year iso-8601-date="2022">2022</year><data-title>ScBERT</data-title><version designator="1.0.0">1.0.0</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/TencentAILabHealthcare/scBERT">https://github.com/TencentAILabHealthcare/scBERT</ext-link></element-citation></ref><ref id="bib91"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Tickle</surname><given-names>T</given-names></name><name><surname>Tirosh</surname><given-names>I</given-names></name><name><surname>Georgescu</surname><given-names>C</given-names></name><name><surname>Brown</surname><given-names>M</given-names></name><name><surname>Haas</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>InferCNV of the trinity CTAT project</data-title><version designator="1.24.0">1.24.0</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/broadinstitute/inferCNV">https://github.com/broadinstitute/inferCNV</ext-link></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Traag</surname><given-names>VA</given-names></name><name><surname>Waltman</surname><given-names>L</given-names></name><name><surname>van Eck</surname><given-names>NJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>From Louvain to Leiden: guaranteeing well-connected communities</article-title><source>Scientific Reports</source><volume>9</volume><elocation-id>5233</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-019-41695-z</pub-id><pub-id pub-id-type="pmid">30914743</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsai</surname><given-names>DY</given-names></name><name><surname>Hung</surname><given-names>KH</given-names></name><name><surname>Chang</surname><given-names>CW</given-names></name><name><surname>Lin</surname><given-names>KI</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Regulatory mechanisms of B cell responses and the implication in B cell-related diseases</article-title><source>Journal of Biomedical Science</source><volume>26</volume><elocation-id>64</elocation-id><pub-id pub-id-type="doi">10.1186/s12929-019-0558-1</pub-id><pub-id pub-id-type="pmid">31472685</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsubata</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>CD22 and CD72 are inhibitory receptors dominantly expressed in B lymphocytes and regulate systemic autoimmune diseases. German version</article-title><source>Zeitschrift Fur Rheumatologie</source><volume>75</volume><fpage>86</fpage><lpage>89</lpage><pub-id pub-id-type="doi">10.1007/s00393-015-0038-2</pub-id><pub-id pub-id-type="pmid">26830296</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van den Brink</surname><given-names>SC</given-names></name><name><surname>Sage</surname><given-names>F</given-names></name><name><surname>Vértesy</surname><given-names>Á</given-names></name><name><surname>Spanjaard</surname><given-names>B</given-names></name><name><surname>Peterson-Maduro</surname><given-names>J</given-names></name><name><surname>Baron</surname><given-names>CS</given-names></name><name><surname>Robin</surname><given-names>C</given-names></name><name><surname>van Oudenaarden</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Single-cell sequencing reveals dissociation-induced gene expression in tissue subpopulations</article-title><source>Nature Methods</source><volume>14</volume><fpage>935</fpage><lpage>936</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4437</pub-id><pub-id pub-id-type="pmid">28960196</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Verhaak</surname><given-names>RGW</given-names></name><name><surname>Hoadley</surname><given-names>KA</given-names></name><name><surname>Purdom</surname><given-names>E</given-names></name><name><surname>Wang</surname><given-names>V</given-names></name><name><surname>Qi</surname><given-names>Y</given-names></name><name><surname>Wilkerson</surname><given-names>MD</given-names></name><name><surname>Miller</surname><given-names>CR</given-names></name><name><surname>Ding</surname><given-names>L</given-names></name><name><surname>Golub</surname><given-names>T</given-names></name><name><surname>Mesirov</surname><given-names>JP</given-names></name><name><surname>Alexe</surname><given-names>G</given-names></name><name><surname>Lawrence</surname><given-names>M</given-names></name><name><surname>O’Kelly</surname><given-names>M</given-names></name><name><surname>Tamayo</surname><given-names>P</given-names></name><name><surname>Weir</surname><given-names>BA</given-names></name><name><surname>Gabriel</surname><given-names>S</given-names></name><name><surname>Winckler</surname><given-names>W</given-names></name><name><surname>Gupta</surname><given-names>S</given-names></name><name><surname>Jakkula</surname><given-names>L</given-names></name><name><surname>Feiler</surname><given-names>HS</given-names></name><name><surname>Hodgson</surname><given-names>JG</given-names></name><name><surname>James</surname><given-names>CD</given-names></name><name><surname>Sarkaria</surname><given-names>JN</given-names></name><name><surname>Brennan</surname><given-names>C</given-names></name><name><surname>Kahn</surname><given-names>A</given-names></name><name><surname>Spellman</surname><given-names>PT</given-names></name><name><surname>Wilson</surname><given-names>RK</given-names></name><name><surname>Speed</surname><given-names>TP</given-names></name><name><surname>Gray</surname><given-names>JW</given-names></name><name><surname>Meyerson</surname><given-names>M</given-names></name><name><surname>Getz</surname><given-names>G</given-names></name><name><surname>Perou</surname><given-names>CM</given-names></name><name><surname>Hayes</surname><given-names>DN</given-names></name><collab>Cancer Genome Atlas Research Network</collab></person-group><year iso-8601-date="2010">2010</year><article-title>Integrated genomic analysis identifies clinically relevant subtypes of glioblastoma characterized by abnormalities in PDGFRA, IDH1, EGFR, and NF1</article-title><source>Cancer Cell</source><volume>17</volume><fpage>98</fpage><lpage>110</lpage><pub-id pub-id-type="doi">10.1016/j.ccr.2009.12.020</pub-id><pub-id pub-id-type="pmid">20129251</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Virshup</surname><given-names>I</given-names></name><name><surname>Rybakov</surname><given-names>S</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name><name><surname>Angerer</surname><given-names>P</given-names></name><name><surname>Wolf</surname><given-names>FA</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Anndata: annotated data</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.12.16.473007</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>HT</given-names></name><name><surname>Yao</surname><given-names>YH</given-names></name><name><surname>Li</surname><given-names>BG</given-names></name><name><surname>Tang</surname><given-names>Y</given-names></name><name><surname>Chang</surname><given-names>JW</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Neuroendocrine Prostate Cancer (NEPC) progressing from conventional prostatic adenocarcinoma: factors associated with time to development of NEPC and survival from NEPC diagnosis—a systematic review and pooled analysis</article-title><source>Journal of Clinical Oncology</source><volume>32</volume><fpage>3383</fpage><lpage>3390</lpage><pub-id pub-id-type="doi">10.1200/JCO.2013.54.3553</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>YJ</given-names></name><name><surname>Schug</surname><given-names>J</given-names></name><name><surname>Won</surname><given-names>K-J</given-names></name><name><surname>Liu</surname><given-names>C</given-names></name><name><surname>Naji</surname><given-names>A</given-names></name><name><surname>Avrahami</surname><given-names>D</given-names></name><name><surname>Golson</surname><given-names>ML</given-names></name><name><surname>Kaestner</surname><given-names>KH</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Single-cell transcriptomics of the human endocrine pancreas</article-title><source>Diabetes</source><volume>65</volume><fpage>3028</fpage><lpage>3038</lpage><pub-id pub-id-type="doi">10.2337/db16-0405</pub-id><pub-id pub-id-type="pmid">27364731</pub-id></element-citation></ref><ref id="bib100"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weigelt</surname><given-names>B</given-names></name><name><surname>Mackay</surname><given-names>A</given-names></name><name><surname>A’hern</surname><given-names>R</given-names></name><name><surname>Natrajan</surname><given-names>R</given-names></name><name><surname>Tan</surname><given-names>DSP</given-names></name><name><surname>Dowsett</surname><given-names>M</given-names></name><name><surname>Ashworth</surname><given-names>A</given-names></name><name><surname>Reis-Filho</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Breast cancer molecular profiling with single sample predictors: a retrospective analysis</article-title><source>The Lancet. Oncology</source><volume>11</volume><fpage>339</fpage><lpage>349</lpage><pub-id pub-id-type="doi">10.1016/S1470-2045(10)70008-5</pub-id><pub-id pub-id-type="pmid">20181526</pub-id></element-citation></ref><ref id="bib101"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weinstein</surname><given-names>JN</given-names></name><name><surname>Collisson</surname><given-names>EA</given-names></name><name><surname>Mills</surname><given-names>GB</given-names></name><name><surname>Shaw</surname><given-names>KRM</given-names></name><name><surname>Ozenberger</surname><given-names>BA</given-names></name><name><surname>Ellrott</surname><given-names>K</given-names></name><name><surname>Shmulevich</surname><given-names>I</given-names></name><name><surname>Sander</surname><given-names>C</given-names></name><name><surname>Stuart</surname><given-names>JM</given-names></name><collab>Cancer Genome Atlas Research Network</collab></person-group><year iso-8601-date="2013">2013</year><article-title>The cancer genome atlas pan-cancer analysis project</article-title><source>Nature Genetics</source><volume>45</volume><fpage>1113</fpage><lpage>1120</lpage><pub-id pub-id-type="doi">10.1038/ng.2764</pub-id><pub-id pub-id-type="pmid">24071849</pub-id></element-citation></ref><ref id="bib102"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>FA</given-names></name><name><surname>Angerer</surname><given-names>P</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title><source>Genome Biology</source><volume>19</volume><elocation-id>15</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id><pub-id pub-id-type="pmid">29409532</pub-id></element-citation></ref><ref id="bib103"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>A</given-names></name><name><surname>Angerer</surname><given-names>P</given-names></name><name><surname>Virshup</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>Scanpy</data-title><version designator="1.9.1">1.9.1</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/scverse/scanpy">https://github.com/scverse/scanpy</ext-link></element-citation></ref><ref id="bib104"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>SZ</given-names></name><name><surname>Roden</surname><given-names>DL</given-names></name><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Holliday</surname><given-names>H</given-names></name><name><surname>Harvey</surname><given-names>K</given-names></name><name><surname>Cazet</surname><given-names>AS</given-names></name><name><surname>Murphy</surname><given-names>KJ</given-names></name><name><surname>Pereira</surname><given-names>B</given-names></name><name><surname>Al-Eryani</surname><given-names>G</given-names></name><name><surname>Bartonicek</surname><given-names>N</given-names></name><name><surname>Hou</surname><given-names>R</given-names></name><name><surname>Torpy</surname><given-names>JR</given-names></name><name><surname>Junankar</surname><given-names>S</given-names></name><name><surname>Chan</surname><given-names>C-L</given-names></name><name><surname>Lam</surname><given-names>CE</given-names></name><name><surname>Hui</surname><given-names>MN</given-names></name><name><surname>Gluch</surname><given-names>L</given-names></name><name><surname>Beith</surname><given-names>J</given-names></name><name><surname>Parker</surname><given-names>A</given-names></name><name><surname>Robbins</surname><given-names>E</given-names></name><name><surname>Segara</surname><given-names>D</given-names></name><name><surname>Mak</surname><given-names>C</given-names></name><name><surname>Cooper</surname><given-names>C</given-names></name><name><surname>Warrier</surname><given-names>S</given-names></name><name><surname>Forrest</surname><given-names>A</given-names></name><name><surname>Powell</surname><given-names>J</given-names></name><name><surname>O’Toole</surname><given-names>S</given-names></name><name><surname>Cox</surname><given-names>TR</given-names></name><name><surname>Timpson</surname><given-names>P</given-names></name><name><surname>Lim</surname><given-names>E</given-names></name><name><surname>Liu</surname><given-names>XS</given-names></name><name><surname>Swarbrick</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Stromal cell diversity associated with immune evasion in human triple-negative breast cancer</article-title><source>The EMBO Journal</source><volume>39</volume><elocation-id>e104063</elocation-id><pub-id pub-id-type="doi">10.15252/embj.2019104063</pub-id><pub-id pub-id-type="pmid">32790115</pub-id></element-citation></ref><ref id="bib105"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>X</given-names></name><name><surname>Yang</surname><given-names>F</given-names></name><name><surname>Zhou</surname><given-names>T</given-names></name><name><surname>Lin</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Rethinking the impacts of overfitting and feature quality on small-scale video classification</article-title><conf-name>Proceedings of the 29th ACM International Conference on Multimedia</conf-name><pub-id pub-id-type="doi">10.1145/3474085.3479226</pub-id></element-citation></ref><ref id="bib106"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yamada</surname><given-names>Y</given-names></name><name><surname>Beltran</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Clinical and biological features of neuroendocrine prostate cancer</article-title><source>Current Oncology Reports</source><volume>23</volume><elocation-id>15</elocation-id><pub-id pub-id-type="doi">10.1007/s11912-020-01003-9</pub-id><pub-id pub-id-type="pmid">33433737</pub-id></element-citation></ref><ref id="bib107"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>F</given-names></name><name><surname>Wang</surname><given-names>W</given-names></name><name><surname>Wang</surname><given-names>F</given-names></name><name><surname>Fang</surname><given-names>Y</given-names></name><name><surname>Tang</surname><given-names>D</given-names></name><name><surname>Huang</surname><given-names>J</given-names></name><name><surname>Lu</surname><given-names>H</given-names></name><name><surname>Yao</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>scBERT as a large-scale pretrained deep language model for cell type annotation of single-cell RNA-seq data</article-title><source>Nature Machine Intelligence</source><volume>4</volume><fpage>852</fpage><lpage>866</lpage><pub-id pub-id-type="doi">10.1038/s42256-022-00534-z</pub-id></element-citation></ref><ref id="bib108"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yersal</surname><given-names>O</given-names></name><name><surname>Barutca</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Biological subtypes of breast cancer: Prognostic and therapeutic implications</article-title><source>World Journal of Clinical Oncology</source><volume>5</volume><fpage>412</fpage><lpage>424</lpage><pub-id pub-id-type="doi">10.5306/wjco.v5.i3.412</pub-id><pub-id pub-id-type="pmid">25114856</pub-id></element-citation></ref><ref id="bib109"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zandvoort</surname><given-names>A</given-names></name><name><surname>Lodewijk</surname><given-names>ME</given-names></name><name><surname>de Boer</surname><given-names>NK</given-names></name><name><surname>Dammers</surname><given-names>PM</given-names></name><name><surname>Kroese</surname><given-names>FG</given-names></name><name><surname>Timens</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>CD27 expression in the human splenic marginal zone: the infant marginal zone is populated by naive B cells</article-title><source>Tissue Antigens</source><volume>58</volume><fpage>234</fpage><lpage>242</lpage><pub-id pub-id-type="doi">10.1034/j.1399-0039.2001.580403.x</pub-id><pub-id pub-id-type="pmid">11782274</pub-id></element-citation></ref><ref id="bib110"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>D</given-names></name><name><surname>Meng</surname><given-names>Q</given-names></name><name><surname>Liu</surname><given-names>Z</given-names></name><name><surname>Xie</surname><given-names>H</given-names></name><name><surname>Liu</surname><given-names>L</given-names></name><name><surname>Xu</surname><given-names>F</given-names></name><name><surname>Chen</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Precision treatment exploration of breast cancer based on heterogeneity analysis of lncRNAs at the single-cell level</article-title><source>BMC Cancer</source><volume>21</volume><elocation-id>918</elocation-id><pub-id pub-id-type="doi">10.1186/s12885-021-08617-7</pub-id><pub-id pub-id-type="pmid">34388989</pub-id></element-citation></ref><ref id="bib111"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>Y</given-names></name><name><surname>Cai</surname><given-names>H</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Tang</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Learning interpretable cellular and gene signature embeddings from single-cell transcriptomic data</article-title><source>Nature Communications</source><volume>12</volume><elocation-id>5261</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-021-25534-2</pub-id><pub-id pub-id-type="pmid">34489404</pub-id></element-citation></ref><ref id="bib112"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>GXY</given-names></name><name><surname>Terry</surname><given-names>JM</given-names></name><name><surname>Belgrader</surname><given-names>P</given-names></name><name><surname>Ryvkin</surname><given-names>P</given-names></name><name><surname>Bent</surname><given-names>ZW</given-names></name><name><surname>Wilson</surname><given-names>R</given-names></name><name><surname>Ziraldo</surname><given-names>SB</given-names></name><name><surname>Wheeler</surname><given-names>TD</given-names></name><name><surname>McDermott</surname><given-names>GP</given-names></name><name><surname>Zhu</surname><given-names>J</given-names></name><name><surname>Gregory</surname><given-names>MT</given-names></name><name><surname>Shuga</surname><given-names>J</given-names></name><name><surname>Montesclaros</surname><given-names>L</given-names></name><name><surname>Underwood</surname><given-names>JG</given-names></name><name><surname>Masquelier</surname><given-names>DA</given-names></name><name><surname>Nishimura</surname><given-names>SY</given-names></name><name><surname>Schnall-Levin</surname><given-names>M</given-names></name><name><surname>Wyatt</surname><given-names>PW</given-names></name><name><surname>Hindson</surname><given-names>CM</given-names></name><name><surname>Bharadwaj</surname><given-names>R</given-names></name><name><surname>Wong</surname><given-names>A</given-names></name><name><surname>Ness</surname><given-names>KD</given-names></name><name><surname>Beppu</surname><given-names>LW</given-names></name><name><surname>Deeg</surname><given-names>HJ</given-names></name><name><surname>McFarland</surname><given-names>C</given-names></name><name><surname>Loeb</surname><given-names>KR</given-names></name><name><surname>Valente</surname><given-names>WJ</given-names></name><name><surname>Ericson</surname><given-names>NG</given-names></name><name><surname>Stevens</surname><given-names>EA</given-names></name><name><surname>Radich</surname><given-names>JP</given-names></name><name><surname>Mikkelsen</surname><given-names>TS</given-names></name><name><surname>Hindson</surname><given-names>BJ</given-names></name><name><surname>Bielas</surname><given-names>JH</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Massively parallel digital transcriptional profiling of single cells</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>14049</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms14049</pub-id><pub-id pub-id-type="pmid">28091601</pub-id></element-citation></ref><ref id="bib113"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>S</given-names></name><name><surname>Huang</surname><given-names>Y-E</given-names></name><name><surname>Liu</surname><given-names>H</given-names></name><name><surname>Zhou</surname><given-names>X</given-names></name><name><surname>Yuan</surname><given-names>M</given-names></name><name><surname>Hou</surname><given-names>F</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Jiang</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Single-cell RNA-seq dissects the intratumoral heterogeneity of triple-negative breast cancer based on gene regulatory networks</article-title><source>Molecular Therapy. Nucleic Acids</source><volume>23</volume><fpage>682</fpage><lpage>690</lpage><pub-id pub-id-type="doi">10.1016/j.omtn.2020.12.018</pub-id><pub-id pub-id-type="pmid">33575114</pub-id></element-citation></ref><ref id="bib114"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>S</given-names></name><name><surname>Qing</surname><given-names>T</given-names></name><name><surname>Zheng</surname><given-names>Y</given-names></name><name><surname>Jin</surname><given-names>L</given-names></name><name><surname>Shi</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Advances in single-cell RNA sequencing and its applications in cancer research</article-title><source>Oncotarget</source><volume>8</volume><fpage>53763</fpage><lpage>53779</lpage><pub-id pub-id-type="doi">10.18632/oncotarget.17893</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><table-wrap id="app1table1" position="float"><label>Appendix 1—table 1.</label><caption><title>Overview of tools and benchmarking methods used in this paper.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Tool</th><th align="left" valign="bottom">Version</th><th align="left" valign="bottom">URL</th><th align="left" valign="bottom">Resolution dependent</th><th align="left" valign="bottom">Visualization</th><th align="left" valign="bottom">Clustering algorithm</th><th align="left" valign="bottom">Reference</th></tr></thead><tbody><tr><td align="left" valign="bottom">Scanpy</td><td align="left" valign="bottom">1.9.1</td><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://github.com/scverse/scanpy">https://github.com/scverse/scanpy</ext-link></td><td align="left" valign="bottom">Yes</td><td align="left" valign="bottom">UMAP</td><td align="left" valign="bottom">Louvain</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib102">Wolf et al., 2018</xref>; <xref ref-type="bibr" rid="bib103">Wolf et al., 2023</xref></td></tr><tr><td align="left" valign="bottom">ItClust</td><td align="left" valign="bottom">1.2.0</td><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://github.com/jianhuupenn/ItClust">https://github.com/jianhuupenn/ItClust</ext-link></td><td align="left" valign="bottom">No</td><td align="left" valign="bottom">UMAP</td><td align="left" valign="bottom">ItClust</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib44">Hu et al., 2020</xref>; <xref ref-type="bibr" rid="bib45">Hu, 2022</xref></td></tr><tr><td align="left" valign="bottom">Seurat</td><td align="left" valign="bottom">4.1.1</td><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://github.com/satijalab/seurat">https://github.com/satijalab/seurat</ext-link></td><td align="left" valign="bottom">Yes</td><td align="left" valign="bottom">UMAP</td><td align="left" valign="bottom">Louvian</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib15">Butler et al., 2018</xref>; <xref ref-type="bibr" rid="bib16">Butler et al., 2022</xref></td></tr><tr><td align="left" valign="bottom">DESC</td><td align="left" valign="bottom">2.1.1</td><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://github.com/eleozzr/desc">https://github.com/eleozzr/desc</ext-link></td><td align="left" valign="bottom">Yes</td><td align="left" valign="bottom">UMAP</td><td align="left" valign="bottom">Louvain</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib60">Li et al., 2020</xref>; <xref ref-type="bibr" rid="bib59">Li and Lyu, 2020</xref></td></tr><tr><td align="left" valign="bottom">scBERT</td><td align="left" valign="bottom">1.0.0</td><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://github.com/TencentAILabHealthcare/scBERT">https://github.com/TencentAILabHealthcare/scBERT</ext-link></td><td align="left" valign="bottom">Yes</td><td align="left" valign="bottom">UMAP</td><td align="left" valign="bottom">Leiden</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib107">Yang et al., 2022</xref>; <xref ref-type="bibr" rid="bib90">Tencent AI Lab Healthcare, 2022</xref></td></tr><tr><td align="left" valign="bottom">scPhere</td><td align="left" valign="bottom">1.0.0</td><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://github.com/klarman-cell-observatory/scPhere">https://github.com/klarman-cell-observatory/scPhere</ext-link></td><td align="left" valign="bottom">Yes</td><td align="left" valign="bottom">UMAP</td><td align="left" valign="bottom">Louvain</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib28">Ding and Regev, 2021</xref>; <xref ref-type="bibr" rid="bib27">Ding, 2021</xref></td></tr><tr><td align="left" valign="bottom">scETM</td><td align="left" valign="bottom">0.4.9</td><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://github.com/hui2000ji/scETM">https://github.com/hui2000ji/scETM</ext-link></td><td align="left" valign="bottom">Yes</td><td align="left" valign="bottom">UMAP</td><td align="left" valign="bottom">Leiden</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib111">Zhao et al., 2021</xref>; <xref ref-type="bibr" rid="bib17">Cai, 2021</xref></td></tr></tbody></table></table-wrap><table-wrap id="app1table2" position="float"><label>Appendix 1—table 2.</label><caption><title>Summary of datasets analyzed in this paper.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Model</th><th align="left" valign="bottom">Dataset</th><th align="left" valign="bottom">Tissue</th><th align="left" valign="bottom">Technology</th><th align="left" valign="bottom">Data Type</th><th align="left" valign="bottom">Cell/sampleDetected</th><th align="left" valign="bottom">Used inSCellBOW</th><th align="left" valign="bottom">Data used as</th><th align="left" valign="bottom">Cell filter</th><th align="left" valign="bottom">Gene filter</th><th align="left" valign="bottom">HVG</th></tr></thead><tbody><tr><td align="left" valign="bottom" rowspan="2">Normal Prostate</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib51">Karthaus et al., 2020</xref></td><td align="left" valign="bottom">Human primary prostate cancer</td><td align="left" valign="bottom">10 X</td><td align="left" valign="bottom">TPM</td><td align="left" valign="bottom">120,300</td><td align="left" valign="bottom">Clustering</td><td align="left" valign="bottom">Source</td><td align="left" valign="bottom">200</td><td align="left" valign="bottom">20</td><td align="left" valign="bottom">5000</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib43">Henry et al., 2018</xref></td><td align="left" valign="bottom">Human normal prostate</td><td align="left" valign="bottom">10 X</td><td align="left" valign="bottom">Raw count</td><td align="left" valign="bottom">28,702</td><td align="left" valign="bottom">Clustering</td><td align="left" valign="bottom">Target</td><td align="left" valign="bottom">200</td><td align="left" valign="bottom">3</td><td align="left" valign="bottom">3000</td></tr><tr><td align="left" valign="bottom" rowspan="2">PBMC</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib112">Zheng et al., 2017</xref></td><td align="left" valign="bottom">Human PBMC</td><td align="left" valign="bottom">10 X</td><td align="left" valign="bottom">Raw count</td><td align="left" valign="bottom">68, 579</td><td align="left" valign="bottom">Clustering</td><td align="left" valign="bottom">Source</td><td align="left" valign="bottom">200</td><td align="left" valign="bottom">20</td><td align="left" valign="bottom">5000</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib112">Zheng et al., 2017</xref></td><td align="left" valign="bottom">Human PBMC</td><td align="left" valign="bottom">10 X</td><td align="left" valign="bottom">Raw count</td><td align="left" valign="bottom">2,700</td><td align="left" valign="bottom">Clustering</td><td align="left" valign="bottom">Target</td><td align="left" valign="bottom">200</td><td align="left" valign="bottom">20</td><td align="left" valign="bottom">2000</td></tr><tr><td align="left" valign="bottom" rowspan="4">Pancreas</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib5">Baron et al., 2016</xref></td><td align="left" valign="bottom">Human pancreas</td><td align="left" valign="bottom">inDrop</td><td align="left" valign="bottom">Raw count</td><td align="left" valign="bottom">8,562</td><td align="left" valign="bottom">Clustering</td><td align="left" valign="bottom">Source</td><td align="left" valign="bottom">200</td><td align="left" valign="bottom">20</td><td align="left" valign="bottom">2000</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib71">Muraro et al., 2016</xref></td><td align="left" valign="bottom">Human pancreas</td><td align="left" valign="bottom">CEL-Seq2</td><td align="left" valign="bottom">Raw count</td><td align="left" valign="bottom">2,042</td><td align="left" valign="bottom">Clustering</td><td align="left" valign="bottom">Source</td><td align="left" valign="bottom"> </td><td align="left" valign="bottom"> </td><td align="left" valign="bottom"> </td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib99">Wang et al., 2016</xref></td><td align="left" valign="bottom">Human pancreas</td><td align="left" valign="bottom">SMARTer</td><td align="left" valign="bottom">Raw count</td><td align="left" valign="bottom">430</td><td align="left" valign="bottom">Clustering</td><td align="left" valign="bottom">Source</td><td align="left" valign="bottom"> </td><td align="left" valign="bottom"> </td><td align="left" valign="bottom"> </td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib83">Segerstolpe et al., 2016</xref></td><td align="left" valign="bottom">Human pancreas</td><td align="left" valign="bottom">Smart-Seq2</td><td align="left" valign="bottom">Raw count</td><td align="left" valign="bottom">2,068</td><td align="left" valign="bottom">Clustering</td><td align="left" valign="bottom">Target</td><td align="left" valign="bottom">200</td><td align="left" valign="bottom">3</td><td align="left" valign="bottom">2000</td></tr><tr><td align="left" valign="bottom" rowspan="3">GBM</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib72">Neftel et al., 2019</xref></td><td align="left" valign="bottom">Human glioblastoma</td><td align="left" valign="bottom">10 X</td><td align="left" valign="bottom">Raw count</td><td align="left" valign="bottom">12,074</td><td align="left" valign="bottom">Algebra</td><td align="left" valign="bottom">Source</td><td align="left" valign="bottom">200</td><td align="left" valign="bottom">20</td><td align="left" valign="bottom">1000</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib22">Couturier et al., 2020</xref></td><td align="left" valign="bottom">Human glioblastoma</td><td align="left" valign="bottom">10 X</td><td align="left" valign="bottom">Raw count</td><td align="left" valign="bottom">4,508</td><td align="left" valign="bottom">Algebra</td><td align="left" valign="bottom">Target</td><td align="left" valign="bottom">200</td><td align="left" valign="bottom">3</td><td align="left" valign="bottom">1000</td></tr><tr><td align="left" valign="bottom">TCGA-GBM <xref ref-type="bibr" rid="bib101">Weinstein et al., 2013</xref>*</td><td align="left" valign="bottom">Human glioblastoma</td><td align="left" valign="bottom">Bulk RNA-seq</td><td align="left" valign="bottom">Raw count</td><td align="left" valign="bottom">613</td><td align="left" valign="bottom">Algebra</td><td align="left" valign="bottom">Survival</td><td align="left" valign="bottom"> </td><td align="left" valign="bottom"> </td><td align="left" valign="bottom"> </td></tr><tr><td align="left" valign="bottom" rowspan="3">BRCA</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib104">Wu et al., 2020</xref></td><td align="left" valign="bottom">Human breast cancer</td><td align="left" valign="bottom">10 X</td><td align="left" valign="bottom">Raw count</td><td align="left" valign="bottom">24,271</td><td align="left" valign="bottom">Algebra</td><td align="left" valign="bottom">Source</td><td align="left" valign="bottom">200</td><td align="left" valign="bottom">20</td><td align="left" valign="bottom">1000</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib113">Zhou et al., 2021</xref></td><td align="left" valign="bottom">Human Breast cancer</td><td align="left" valign="bottom">Smart-seq2</td><td align="left" valign="bottom">Raw count</td><td align="left" valign="bottom">545</td><td align="left" valign="bottom">Algebra</td><td align="left" valign="bottom">Target</td><td align="left" valign="bottom">200</td><td align="left" valign="bottom">3</td><td align="left" valign="bottom">1000</td></tr><tr><td align="left" valign="bottom">TCGA-BRCA <xref ref-type="bibr" rid="bib101">Weinstein et al., 2013</xref>*</td><td align="left" valign="bottom">Human Breast cancer</td><td align="left" valign="bottom">Bulk RNA-seq</td><td align="left" valign="bottom">Raw count</td><td align="left" valign="bottom">1,079</td><td align="left" valign="bottom">Algebra</td><td align="left" valign="bottom">Survival</td><td align="left" valign="bottom"> </td><td align="left" valign="bottom"> </td><td align="left" valign="bottom"> </td></tr><tr><td align="left" valign="bottom" rowspan="2">mCRPC</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib41">He et al., 2021</xref></td><td align="left" valign="bottom">Human metastatic prostate cancer</td><td align="left" valign="bottom">Smart-Seq2</td><td align="left" valign="bottom">TPM</td><td align="left" valign="bottom">836</td><td align="left" valign="bottom">Algebra</td><td align="left" valign="bottom">Target</td><td align="left" valign="bottom">200</td><td align="left" valign="bottom">3</td><td align="left" valign="bottom">1000</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib1">Abida et al., 2019</xref></td><td align="left" valign="bottom">Human metastatic prostate cancer</td><td align="left" valign="bottom">Bulk RNA-seq</td><td align="left" valign="bottom">TPM</td><td align="left" valign="bottom">81</td><td align="left" valign="bottom">Algebra</td><td align="left" valign="bottom">Survival</td><td align="left" valign="bottom"> </td><td align="left" valign="bottom"> </td><td align="left" valign="bottom"> </td></tr></tbody></table><table-wrap-foot><fn><p>Data downloaded from <ext-link ext-link-type="uri" xlink:href="https://www.cancer.gov/tcga">https://www.cancer.gov/tcga</ext-link>.</p></fn></table-wrap-foot></table-wrap><table-wrap id="app1table3" position="float"><label>Appendix 1—table 3.</label><caption><title>Summary of evaluation metric for all target datasets at resolution = 1.0 analyzed in this paper.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom" rowspan="2"/><th align="left" valign="bottom" colspan="3">Normal Prostate</th><th align="left" valign="bottom" colspan="3">3 K PBMC</th><th align="left" valign="bottom" colspan="3">Pancreas</th><th align="left" valign="bottom" colspan="3">In-house CITE-seq</th></tr><tr><th align="left" valign="bottom">ARI</th><th align="left" valign="bottom">NMI</th><th align="left" valign="bottom">SI(Cell type)</th><th align="left" valign="bottom">ARI</th><th align="left" valign="bottom">NMI</th><th align="left" valign="bottom">SI(Cell type)</th><th align="left" valign="bottom">ARI</th><th align="left" valign="bottom">NMI</th><th align="left" valign="bottom">SI(Cell type)</th><th align="left" valign="bottom">ARI</th><th align="left" valign="bottom">NMI</th><th align="left" valign="bottom">SI(Cell type)</th></tr></thead><tbody><tr><td align="left" valign="bottom"><bold>SCellBOW</bold></td><td align="left" valign="bottom">0.26</td><td align="left" valign="bottom">0.56</td><td align="left" valign="bottom">0.13</td><td align="left" valign="bottom">0.49</td><td align="left" valign="bottom">0.52</td><td align="left" valign="bottom">0.11</td><td align="left" valign="bottom">0.56</td><td align="left" valign="bottom">0.82</td><td align="left" valign="bottom">0.53</td><td align="left" valign="bottom">0.65</td><td align="left" valign="bottom">0.72</td><td align="left" valign="bottom">0.06</td></tr><tr><td align="left" valign="bottom"><bold>Scanpy</bold></td><td align="left" valign="bottom">0.16</td><td align="left" valign="bottom">0.53</td><td align="left" valign="bottom">0.13</td><td align="left" valign="bottom">0.36</td><td align="left" valign="bottom">0.5</td><td align="left" valign="bottom">0.1</td><td align="left" valign="bottom">0.38</td><td align="left" valign="bottom">0.73</td><td align="left" valign="bottom">0.24</td><td align="left" valign="bottom">0.51</td><td align="left" valign="bottom">0.66</td><td align="left" valign="bottom">0.08</td></tr><tr><td align="left" valign="bottom"><bold>Seurat</bold></td><td align="left" valign="bottom">0.15</td><td align="left" valign="bottom">0.52</td><td align="left" valign="bottom">0.21</td><td align="left" valign="bottom">0.31</td><td align="left" valign="bottom">0.48</td><td align="left" valign="bottom">0.1</td><td align="left" valign="bottom">0.52</td><td align="left" valign="bottom">0.79</td><td align="left" valign="bottom">0.53</td><td align="left" valign="bottom">0.47</td><td align="left" valign="bottom">0.66</td><td align="left" valign="bottom">0.04</td></tr><tr><td align="left" valign="bottom"><bold>ItClust</bold></td><td align="left" valign="bottom">0.01</td><td align="left" valign="bottom">0.02</td><td align="left" valign="bottom">–0.05</td><td align="left" valign="bottom">0.33</td><td align="left" valign="bottom">0.46</td><td align="left" valign="bottom">–0.05</td><td align="left" valign="bottom">0.31</td><td align="left" valign="bottom">0.29</td><td align="left" valign="bottom">–0.05</td><td align="left" valign="bottom">0.43</td><td align="left" valign="bottom">0.55</td><td align="left" valign="bottom">–0.13</td></tr><tr><td align="left" valign="bottom"><bold>scETM</bold></td><td align="left" valign="bottom">0.11</td><td align="left" valign="bottom">0.37</td><td align="left" valign="bottom">0.04</td><td align="left" valign="bottom">0.38</td><td align="left" valign="bottom">0.5</td><td align="left" valign="bottom">0.08</td><td align="left" valign="bottom">0.35</td><td align="left" valign="bottom">0.67</td><td align="left" valign="bottom">0.46</td><td align="left" valign="bottom">0.41</td><td align="left" valign="bottom">0.61</td><td align="left" valign="bottom">–0.03</td></tr><tr><td align="left" valign="bottom"><bold>scBERT</bold></td><td align="left" valign="bottom">0.18</td><td align="left" valign="bottom">0.51</td><td align="left" valign="bottom">0.22</td><td align="left" valign="bottom">0.32</td><td align="left" valign="bottom">0.47</td><td align="left" valign="bottom">0.07</td><td align="left" valign="bottom">0.35</td><td align="left" valign="bottom">0.72</td><td align="left" valign="bottom">0.35</td><td align="left" valign="bottom">0.58</td><td align="left" valign="bottom">0.70</td><td align="left" valign="bottom">0.06</td></tr><tr><td align="left" valign="bottom"><bold>scPhere</bold></td><td align="left" valign="bottom">0.04</td><td align="left" valign="bottom">0.42</td><td align="left" valign="bottom">0.05</td><td align="left" valign="bottom">0.19</td><td align="left" valign="bottom">0.38</td><td align="left" valign="bottom">0.04</td><td align="left" valign="bottom">0.23</td><td align="left" valign="bottom">0.63</td><td align="left" valign="bottom">0.33</td><td align="left" valign="bottom">0.24</td><td align="left" valign="bottom">0.55</td><td align="left" valign="bottom">0.21</td></tr><tr><td align="left" valign="bottom"><bold>DESC</bold></td><td align="left" valign="bottom">0.17</td><td align="left" valign="bottom">0.52</td><td align="left" valign="bottom">0.02</td><td align="left" valign="bottom">0.46</td><td align="left" valign="bottom">0.49</td><td align="left" valign="bottom">–0.06</td><td align="left" valign="bottom">0.39</td><td align="left" valign="bottom">0.72</td><td align="left" valign="bottom">0.2</td><td align="left" valign="bottom">0.54</td><td align="left" valign="bottom">0.65</td><td align="left" valign="bottom">0.01</td></tr></tbody></table></table-wrap><table-wrap id="app1table4" position="float"><label>Appendix 1—table 4.</label><caption><title>Marker gene set major immune cell types.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Major cell types</th><th align="left" valign="bottom">Marker genes</th></tr></thead><tbody><tr><td align="left" valign="bottom">B cells</td><td align="left" valign="bottom"><italic>CD19, CD79A, MS4A1, CD74, HLA-DRA</italic></td></tr><tr><td align="left" valign="bottom">CD4 T</td><td align="left" valign="bottom"><italic>IL7R, CCR7, CD3D, CD4</italic></td></tr><tr><td align="left" valign="bottom">CD8 T</td><td align="left" valign="bottom"><italic>GZMK, CD8A, CD8B, GZMB</italic></td></tr><tr><td align="left" valign="bottom">DC</td><td align="left" valign="bottom"><italic>CST3, CD14, ITGAM, ITGAX</italic></td></tr><tr><td align="left" valign="bottom">MAIT</td><td align="left" valign="bottom"><italic>CD3D, KLRB1, RORA, ZBTB16</italic></td></tr><tr><td align="left" valign="bottom">Mono</td><td align="left" valign="bottom"><italic>CD14, S100A12</italic></td></tr><tr><td align="left" valign="bottom">NK cells</td><td align="left" valign="bottom"><italic>NKG7, GNLY, CD247, CCL3, GZMB, CD3D</italic></td></tr></tbody></table></table-wrap><table-wrap id="app1table5" position="float"><label>Appendix 1—table 5.</label><caption><title>Computation time across different transfer learning methods under the same hardware conditions (128 GB RAM, 16 core processor).</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom" colspan="4">Wall time (Pancreas dataset)</th></tr><tr><th align="left" valign="bottom">Methods</th><th align="left" valign="bottom">Source Model (~12 K cells)</th><th align="left" valign="bottom">Target Model (~2 K cells)</th><th align="left" valign="bottom">Total time</th></tr></thead><tbody><tr><td align="left" valign="bottom">ItClust</td><td align="left" valign="bottom" colspan="2">2 min 4 s</td><td align="left" valign="bottom">~2 min</td></tr><tr><td align="left" valign="bottom">SCellBOW (thread = 16)</td><td align="left" valign="bottom">2 min 5 s</td><td align="left" valign="bottom">1 min 20 s</td><td align="left" valign="bottom">~3 min</td></tr><tr><td align="left" valign="bottom">SCellBOW (thread = 1)</td><td align="left" valign="bottom">6 min 21 s</td><td align="left" valign="bottom">2 min 8 s</td><td align="left" valign="bottom">~8 min</td></tr><tr><td align="left" valign="bottom">scETM (600 epoch, thread = 16)</td><td align="left" valign="bottom">22 min 38 s</td><td align="left" valign="bottom">5 min 46 s</td><td align="left" valign="bottom">~27 min</td></tr><tr><td align="left" valign="bottom">scETM (600 epoch, thread = 1)</td><td align="left" valign="bottom">23 min 49 s</td><td align="left" valign="bottom">5 min 58 s</td><td align="left" valign="bottom">~28 min</td></tr><tr><td align="left" valign="bottom">scBERT</td><td align="left" valign="bottom">3 hrs 33 min</td><td align="left" valign="bottom">2 min</td><td align="left" valign="bottom">~3 hrs</td></tr></tbody></table><table-wrap-foot><fn><p>The term ‘thread’ represents the number of threads used: thread = 1 indicates single-threaded execution, while thread &gt;1 indicates multi-threaded execution.</p></fn></table-wrap-foot></table-wrap><sec sec-type="appendix" id="s8"><title>Supplementary methods</title><sec sec-type="appendix" id="s8-1"><title>1. Datasets overview</title><sec sec-type="appendix" id="s8-1-1"><title>1.1 Normal prostate data</title><p>We built our pre-trained normal prostate tissue model using the large (<xref ref-type="bibr" rid="bib51">Karthaus et al., 2020</xref>) dataset with approximately 120,300 cells as the source data. Cells in this study were isolated from histologically normal prostate regions of men treated for prostate cancer by radical prostatectomy. We obtained the processed TPM expression data from <ext-link ext-link-type="uri" xlink:href="https://singlecell.broadinstitute.org/single_cell/study/SCP864">https://singlecell.broadinstitute.org/single_cell/study/SCP864</ext-link>, which was then log1p transformed, and 5000 HVGs were selected for model training. We analyzed the clustering ability of the pre-trained model on the (<xref ref-type="bibr" rid="bib43">Henry et al., 2018</xref>) target dataset with approximately 28,702 cells from normal prostate specimens (young adult human prostate and prostatic urethra). The cells had been pre-annotated based on their similarity with matched single-cell transcriptomes of 9 FACS-purified cell subpopulations (Smooth Muscle (SM), Neuroendocrine epithelial (NE), Leukocytes (Leu), Luminal epithelial (LE), Hillock, Fibroblast (Fib), Endothelial (Endo), Club, and Basal epithelial (BE)). We retrieved the raw count data and cell type annotation from the GUDMAP database (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.25548/W-R8CM">https://doi.org/10.25548/W-R8CM</ext-link>). Raw counts were preprocessed according to ‘<italic>Data preparation for clustering</italic>’ in the main methods section, and 3000 HVGs were selected for retraining. The 10 x Chromium protocol was used for sequencing both source and target sample sets.</p></sec><sec sec-type="appendix" id="s8-1-2"><title>1.2 Peripheral blood mononuclear cell (PBMC) data</title><p>We used a well-characterized reference 68 K PBMC dataset from <xref ref-type="bibr" rid="bib112">Zheng et al., 2017</xref>, with approximately 68,579 cells obtained fresh from a healthy donor as the source dataset. We used the 3 K PBMC dataset from the same donor, consisting of 2700 cryopreserved cells, as our target data. Both datasets are hosted on the 10 x genomics website (<ext-link ext-link-type="uri" xlink:href="https://www.10xgenomics.com/">https://www.10xgenomics.com/</ext-link>). We downloaded the gene-cell raw count matrix for the ‘Fresh 68 k PBMCs (Donor A)’ and ‘Frozen PBMCs (Donor A)’ as our source and target datasets, respectively. We annotated the cell types in the target dataset based on similarity with expression profiles of 11 purified subpopulations of PBMCs (CD14 +Monocyte, CD19 +B, CD34+, CD4 +Memory T, CD4 +Naive T, CD4 +T Helper2, CD4 +T Reg, CD56 +NK, CD8 +Cytotoxic T, CD8 +Naive T, Dendritic) as a reference, as described by Zheng et al. Raw counts of both data sets were preprocessed according to ‘<italic>Data preparation for clustering</italic>’ in the main methods section. We selected a subset of 5000 HVGs for the 68 K PBMC and 2000 HVGs for the 3 K PBMC dataset for further analysis.</p></sec><sec sec-type="appendix" id="s8-1-3"><title>1.3 Pancreatic islet data</title><p>We used four single-cell RNA-seq (scRNA-seq) datasets (<xref ref-type="bibr" rid="bib5">Baron et al., 2016</xref>, <xref ref-type="bibr" rid="bib71">Muraro et al., 2016</xref>, <xref ref-type="bibr" rid="bib99">Wang et al., 2016</xref>, and <xref ref-type="bibr" rid="bib83">Segerstolpe et al., 2016</xref>) from the human pancreatic islet. The datasets are from multiple individual samples sequenced using different sequencing protocols. In the Baron dataset, the cells were sequenced using the inDrop protocol and are available on GEO: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE84133">GSE84133</ext-link>. The Muraro dataset is available with series number GEO: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE85241">GSE85241</ext-link> and was sequenced using the CEL-Seq2 protocol. The Wang dataset is sequenced by the SMARTer protocol and is available under accession GEO: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE83139">GSE83139</ext-link>. The Segerstolpe dataset was sequenced by the Smart-Seq2 protocol and was retrieved from ArrayExpress (EBI) with accession number E-MTAB-5061. We used Baron, Muraro, and Wang datasets as our source data for the pre-trained model. A total of 11,181 cells were selected. We used the Segerstolpe dataset with 2,068 cells as the target dataset. Raw counts of both data sets were preprocessed according to ‘<italic>Data preparation for clustering</italic>’ in the main methods section, and 2000 HVGs were selected for further analysis. For these datasets, we used the cell labels given by the authors as ground truth. We filtered the unclassified and unclear cells from these datasets.</p></sec><sec sec-type="appendix" id="s8-1-4"><title>1.4 Glioblastoma data</title><p>Glioblastoma multiforme (GBM) is the most aggressive, invasive, and undifferentiated type of tumor. Glioblastomas are highly heterogeneous and have well-characterized aggressive malignant subtypes: proneural (PN), classical (CL), and mesenchymal (MES) (<xref ref-type="bibr" rid="bib29">Doucette et al., 2013</xref>). We have applied <italic>phenotype algebra</italic> to the GBM dataset from , which consists of 4,508 malignant cells from one GBM patient (BT400). The 10 X Genomics dataset sample BT400 was downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/mbourgey/scRNA_GBM">https://github.com/mbourgey/scRNA_GBM</ext-link> (<xref ref-type="bibr" rid="bib13">Bourgey, 2021</xref>). We clustered the scRNA-seq dataset using the Leiden clustering algorithm <xref ref-type="bibr" rid="bib92">Traag et al., 2019</xref> at a resolution of 1.0. We used well-known markers of cell types to perform cluster-level annotation of the dataset based on Gene Set Variation Analysis (GSVA) (<xref ref-type="bibr" rid="bib39">Hänzelmann et al., 2013</xref>) scores (see Appendix 1, Supplementary methods 2.1). We have used the single-cell GBM dataset from <xref ref-type="bibr" rid="bib72">Neftel et al., 2019</xref> with 12,074 cells as our source data for transfer learning. The Neftel et al. 10 X dataset was retrieved from GEO: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE131928">GSE131928</ext-link>. The source dataset was log normalized using Scanpy, and 1000 HVGs were selected. For survival model training, we retrieved the survival and bulk RNA-seq expression data of the TCGA GBM subset with 613 samples from <ext-link ext-link-type="uri" xlink:href="https://portal.gdc.cancer.gov">https://portal.gdc.cancer.gov</ext-link>. We used raw count expression matrices for all the datasets.</p></sec><sec sec-type="appendix" id="s8-1-5"><title>1.5 Breast cancer data</title><p>We executed <italic>phenotype algebra</italic> on PAM50-subtyped breast cancer cells from the (<xref ref-type="bibr" rid="bib113">Zhou et al., 2021</xref>) study, with the raw count data available at GEO: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE118390">GSE118390</ext-link>. The authors annotated 545 malignant cells of six triple- negative breast cancer (TNBC) patients from <xref ref-type="bibr" rid="bib50">Karaayvaz et al., 2018</xref>, using the SubPred_pam50() function of the genefu R package (<xref ref-type="bibr" rid="bib34">Gendoo et al., 2016</xref>). As our source data for transfer learning, we used the single-cell TNBC dataset from <xref ref-type="bibr" rid="bib104">Wu et al., 2020</xref> with 24,271 cells from five patients, with the raw count data matrix downloaded from <ext-link ext-link-type="uri" xlink:href="https://singlecell.broadinstitute.org/single_cell/study/SCP1106/">https://singlecell.broadinstitute.org/single_cell/study/SCP1106/</ext-link>. Raw counts were preprocessed according to ‘<italic>Data preparation for clustering</italic>’ in the main methods section, and 1000 HVGs were chosen for further analysis. For training the <italic>phenotype algebra</italic> survival model, we used the survival and bulk RNA-seq expression data of the TCGA BRCA subset from 1079 samples retrieved from <ext-link ext-link-type="uri" xlink:href="https://portal.gdc.cancer.gov">https://portal.gdc.cancer.gov</ext-link>.</p></sec><sec sec-type="appendix" id="s8-1-6"><title>1.6 Metastatic prostate cancer data</title><p>We have used a publicly available metastatic castration-resistant prostate cancer (mCRPC) scRNA-seq data set originating from multiple donors and three metastatic tumor sites (lymph node, bone, and liver) (<xref ref-type="bibr" rid="bib41">He et al., 2021</xref>). In this dataset, we removed non-malignant cells based on the given cell type annotation published by the authors and focused further analysis on the 836 malignant cells derived from 11 patients. In prostate cancer, molecular subtypes are still poorly defined, and characterizing novel or more refined subtypes with clinical impact on patient prognosis is an active field of research. We employed GSVA scoring using established gene sets describing the molecular traits to classify 836 malignant cells. We annotated the tumor cells into one of the three categories: ARAH, NE, and ARAL (see Appendix 1, Supplementary methods 2.2). We used the gene expression data and metadata from the publication. We retrieved survival and bulk RNA-seq expression data for 81 mCRPC patients provided by <xref ref-type="bibr" rid="bib1">Abida et al., 2019</xref> for training the survival model. We retrieved the dataset from <ext-link ext-link-type="uri" xlink:href="https://www.cbioportal.org/">https://www.cbioportal.org/</ext-link> (prad_su2c_2019). We have used the Karthaus et al. pre-trained model as our source model for transfer learning. All samples available were individually normalized with transcripts per million (TPM).</p></sec></sec><sec sec-type="appendix" id="s8-2"><title>2. Molecular characterization of the cancer datasets</title><sec sec-type="appendix" id="s8-2-1"><title>2.1 Annotation of Couturier et al. GBM dataset</title><p>For molecular characterization of the Couturier et al. datasets, we performed gene set enrichment analysis using GSVA scoring with default settings on the raw expression data. The gene sets comprise known marker genes (<xref ref-type="bibr" rid="bib96">Verhaak et al., 2010</xref>) for the Proneural (PRO), Classical (CLA), and Mesenchymal (MES) subtypes, as outlined in <xref ref-type="table" rid="app1table6">Appendix 1—table 6</xref>.</p><table-wrap id="app1table6" position="float"><label>Appendix 1—table 6.</label><caption><title>Gene set for molecular subtypes of Glioblastoma.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top">Subtype</th><th align="left" valign="top">Marker genes</th></tr></thead><tbody><tr><td align="left" valign="top">Proneural</td><td align="left" valign="top"><italic>DLL3, BCAN, OLIG2, NCAM1, NKX2-2, ASCL1, PDGFRA</italic></td></tr><tr><td align="left" valign="top">Classical</td><td align="left" valign="top"><italic>EGFR, CDKN2A, RB1, CDK4, CCDN2</italic></td></tr><tr><td align="left" valign="top">Mesenchymal</td><td align="left" valign="top"><italic>CHI3L1, CD44, VIM, RELB, TRADD, PDPN, YKL40, MET, NF1, TNFRSF1A</italic></td></tr></tbody></table></table-wrap><p>We applied SCellBOW clustering on the dataset at a resolution of 1.0 and obtained 10 clusters. We performed a cluster-level subtype annotation based on the GSVA scores of the cells. For each cluster, we have assigned a molecular subtype based on the prevalent subtype (percentage of the cells) in that cluster. Clusters CL3, CL4, CL5, and CL6 have a higher percentage of PRO than MES and CLA and have thus been annotated as PRO. Similarly, clusters CL2, CL7, and CL8 were assigned MES, and clusters CL0, CL1, and CL9 were assigned CLA.</p></sec><sec sec-type="appendix" id="s8-2-2"><title>2.2 Annotation of He et al. mCRPC dataset</title><p>For phenotypic characterization of the metastatic cells in the mCRPC target data, we performed GSVA scoring with default parameters on the preprocessed log1p(TPM) expression data. We used published marker gene sets (<xref ref-type="table" rid="app1table7">Appendix 1—table 7</xref>) for ‘androgen receptor-positive prostate cancer’ (ARPC) and ‘neuroendocrine prostate cancer’ (NEPC) from <xref ref-type="bibr" rid="bib55">Labrecque et al., 2019</xref>, two well-described types of advanced prostate cancer.</p><table-wrap id="app1table7" position="float"><label>Appendix 1—table 7.</label><caption><title><xref ref-type="bibr" rid="bib55">Labrecque et al., 2019</xref> gene sets for molecular subtypes of mCRPC.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top">Subtype</th><th align="left" valign="top">Marker genes</th></tr></thead><tbody><tr><td align="left" valign="top">NEPC</td><td align="left" valign="top"><italic>CHGA, SYP, ACTL6B, SNAP25, INSM1, ASCL1, CHRNB2, SRRM4</italic></td></tr><tr><td align="left" valign="top">ARPC</td><td align="left" valign="top"><italic>AR, NKX3-1, KLK3, CHRNA2, SLC45A3, NAP1L2, S100A14, TRGC1, TARP</italic></td></tr></tbody></table></table-wrap><p>To obtain a high-level subgrouping, we performed K-means (<xref ref-type="bibr" rid="bib65">Lloyd, 1982</xref>) clustering on the ARPC and NEPC signature scores from GSVA using K-means++initialization (<xref ref-type="fig" rid="app2fig8">Appendix 2—figure 8a and b</xref>). Based on the elbow method, the optimal number of clusters was determined to be 3. For further molecular characterization, we performed differential gene expression analysis on the obtained clusters using the <italic>rank_genes_groups</italic> function in Scanpy python library and, based on the results, annotated three subgroups of (i) ‘Androgen Receptor Activity High’ (ARAH), (ii) ‘Androgen Receptor Activity Low’ (ARAL), and (iii) ‘neuroendocrine-like’ (NE) cells. (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). The ARAH cluster was characterized by high expression of AR-activated (<italic>TRGC1</italic>, <italic>TRGC2</italic>, <italic>KLK3</italic>, <italic>KLK2</italic>, <italic>GNMT</italic>, <italic>NKX3-1</italic>, <italic>NAP1L2</italic>, <italic>TMPRSS2</italic>, <italic>SLC45A3</italic>, <italic>C1orf116</italic>) and NE-repressed genes (AR, SLC25A37, RGS10); while showing low expression of NE-activated genes (<italic>SRRM4</italic>, <italic>SYP</italic>, <italic>SYT11</italic>, <italic>GNA01</italic>, <italic>KCNB2</italic>, <italic>GPX2</italic>, <italic>ETV5</italic>, <italic>INSM1</italic>, <italic>DNMT1</italic>, <italic>TRIM9</italic>, <italic>SNAP25</italic>). The NE cluster exhibited high expression of NE-activated genes (<italic>CHGA</italic>, <italic>SCG3</italic>, <italic>PROX1</italic>, <italic>ASCL1</italic>, <italic>SNAP25</italic>, <italic>TRIM9</italic>, <italic>INSM1</italic>, <italic>GPX2</italic>, <italic>EZH2</italic>, <italic>DNMT1</italic>, <italic>KCNB2</italic>, <italic>SYP</italic>, <italic>SYT11</italic>, <italic>SRRM4</italic>); as wells as low expression of NE-repressed (<italic>GATA2</italic>, <italic>RGS10</italic>, <italic>SLC25A37</italic>, <italic>MAPKAPK3</italic>, <italic>RIPK2</italic>, <italic>RGS10</italic>) and AR activated genes (<italic>ABCC4</italic>, <italic>CENPN</italic>, <italic>SLC45A3</italic>, <italic>NAP1L2</italic>, <italic>C1orf116</italic>, <italic>GNMT</italic>, <italic>FKBP5</italic>, <italic>PMEPA1</italic>, <italic>TRGC1</italic>). The ARAL cluster had attenuated AR expression with measurable but low expression of some AR-activated (<italic>GNMT</italic>, <italic>NAP1L2</italic>, <italic>TRGC1</italic>, <italic>TRGC2</italic>) and NE-activated genes (<italic>SYP</italic>, <italic>SYT11</italic>, <italic>GNAO1</italic>, <italic>GPX2</italic>, <italic>KCNB2</italic>, <italic>INSM1</italic>, <italic>PROX1</italic>, <italic>SCG3</italic>, <italic>ASCL1</italic>, <italic>CHGA</italic>). Executing <italic>phenotype algebra</italic> on these broad subgroups resulted in a risk prediction matching the expectation and current knowledge.</p></sec></sec><sec sec-type="appendix" id="s8-3"><title>3. Gene set enrichment analysis on the mCRPC He et al. dataset</title><p>For further characterization of the metastatic data set, not biased by previous knowledge or expectations, we performed SCellBOW clustering on the preprocessed in Scanpy log1p function on TPM expression data of the 836 malignant cells using resolution 0.8 and obtained eight clusters. We GSVA-scored as above, but against an extensive collection of ~16,500 gene sets describing a wide variety of cellular processes. We utilized gene sets from the Molecular Signatures Database (MSigDB.v.7.1:<ext-link ext-link-type="uri" xlink:href="http://www.gsea-msigdb.org/gsea/downloads_archive.jsp">http://www.gsea-msigdb.org/gsea/downloads_archive.jsp</ext-link> H: hallmark gene sets, C2: curated gene sets and C5: ontology gene sets) in combination with in-house curated custom gene signatures (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). Performing differential gene set analysis across the SCellBOW clusters using rank_genes_groups function in Scanpy python library. with default settings using a Wilcoxon Rank Sum test and Bonferroni p-value adjustment revealed activated and repressed pathways that were employed to describe the biology of clusters.</p></sec></sec></app><app id="appendix-2"><title>Appendix 2</title><sec sec-type="appendix" id="s9"><title>Supplementary Notes</title><sec sec-type="appendix" id="s9-1"><title>Note 1: Comparison of SCellBOW clustering efficacy with additional methods</title><p>For benchmarking, we further compared the performance of SCellBOW with two recently published tools- scPhere (<xref ref-type="bibr" rid="bib28">Ding and Regev, 2021</xref>) and scBERT (<xref ref-type="bibr" rid="bib107">Yang et al., 2022</xref>). scBERT handles scRNA-seq data by leveraging contextualized embeddings built upon BERT (<xref ref-type="bibr" rid="bib26">Devlin et al., 2018</xref>), which capture the context and relationships between genes in a cell’s transcriptional profile. Its primary emphasis lies in cell annotation, particularly focusing on cell type classification. On the other hand, scPhere is a deep generative model that embeds cells into geometric spaces, enabling a unique way of representing cells within specialized geometric dimensions compared to traditional Euclidean spaces. For comparing the clustering ability, we used the Normal prostate, pancreatic islet, 3 K PBMC, and our in-house PBMC-spleen datasets for our benchmarking (see SCellBOW effectively captures latent space of single-cell phenotypes in the main text).</p><p>We computed the adjusted Rand index (ARI) for a resolution ranging from 0.2 to 2.0 in 0.2 intervals and found that SCellBOW consistently outperformed scBERT and scPhere across all resolutions (<xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3a–d</xref>). Then, for the same range of resolutions, we computed the normalized mutual information (NMI) (<xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3e</xref>) and observed that scPhere consistently exhibited poorer performance compared to SCellBOW and scBERT across all datasets. SCellBOW outperformed scBERT across all public datasets. In terms of the Silhouette Index (SI) for cell types, SCellBOW demonstrated superior performance over scPhere and scBERT in the 3 K PBMC and Pancreas datasets (<xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3f</xref>). However, in the in-house CITE-seq dataset, scPhere displayed improved results, while scBERT exhibited enhanced performance in the normal prostate dataset.</p></sec><sec sec-type="appendix" id="s9-2"><title>Note 2: Processing of in-house PBMC-spleen dataset in SCellBOW</title><sec sec-type="appendix" id="s9-2-1"><title>Dataset</title><p>This CITE-seq dataset includes 4,819 cells and 33,538 genes from the spleen and matching PBMC of 4 polytraumatized patients with splenectomy hemostasis, generated by us using 10 X.</p></sec><sec sec-type="appendix" id="s9-2-2"><title>Cell and gene filtering criteria</title><p>(1) eliminated cells with gene counts &lt;200 using filter_cells() function from Scanpy Python package; (2) eliminated genes if the number of cells expressing this gene is &lt;3 filter_genes() function.</p></sec><sec sec-type="appendix" id="s9-2-3"><title>Data processing</title><p>(1) gene expression levels for each cell were normalized using the normalize_total() function in Scanpy with target_sum = 10,000; (2) normalized gene expression was then transformed using log(1+x) transformation with natural logarithm using log1p function; (3) top 3,000 highly variable genes were selected using the highly_variable_genes() function in Scanpy; (4) the expression is further standardized to a z-score using scale function, and the standardized gene expression values were used as input for SCellBOW. After the above filtering and data processing, 4,785 cells and 3,000 highly variable genes remained for downstream analysis.</p></sec><sec sec-type="appendix" id="s9-2-4"><title>Clustering and visualization using SCellBOW</title><p>All 4,785 cells were clustered by SCellBOW with default parameters using the leiden() function. We used the umap to visualize the 2D plot of the clusters in SCellBOW.</p></sec><sec sec-type="appendix" id="s9-2-5"><title>Cell type labeling of CITE-seq using Azimuth</title><p>Cell type annotation was performed using Seurat-based Azimuth (<xref ref-type="bibr" rid="bib40">Hao et al., 2021</xref>). The molecular reference atlas for Human-PBMC was used for annotation from <ext-link ext-link-type="uri" xlink:href="https://azimuth.hubmapconsortium.org/">https://azimuth.hubmapconsortium.org/</ext-link>. We eliminated the cells with a cell type count &lt;5. There were 4,817 remaining cells.</p></sec></sec><sec sec-type="appendix" id="s9-3"><title>Note 3: Erythroid cells in the PBMC-spleen dataset</title><p>In our analysis, we observed that cells identified as ‘Eryth’ by Azimuth are scattered across all the clusters. Since erythroid cells were removed during the CITE-seq experiments, erythroid cells are not part of PBMCs in this dataset. Thus, we assumed that if erythrocytes are present, it is most likely due to contamination. Since erythroid cells form a majority of cluster CL6 amidst T cells, they are putative ambient RNA contaminations misguiding the Azimuth annotation (<xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4e</xref>). We further performed differential gene expression analysis based on cell types using the Scanpy rank_genes_groups function on the PBMC-spleen dataset. We observed that they have mitochondrial genes as highly differentially expressed genes. This can be attributed to the process of erythropoiesis in cells (<xref ref-type="bibr" rid="bib35">Gonzalez-Ibanez et al., 2020</xref>). However, given the spatial distribution of cells classified as ‘Eryth’ across multiple clusters combined with high mitochondrial gene content in the cells, we assume that ‘Eryth’ cells are misclassified/unclassified cells (<xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4g</xref>).</p></sec><sec sec-type="appendix" id="s9-4"><title>Note 4: Dependency of <italic>phenotype algebra</italic> on SCellBOW embeddings</title><p>The concept of <italic>phenotype algebra</italic> is new, and there is no algorithm that is directly comparable to <italic>phenotype algebra</italic> on the specific task of sub-clonal survival risk (aggressiveness) stratification. However, <italic>phenotype algebra</italic> is built upon fixed-length embeddings generated in SCellBOW. To assess the dependency of <italic>phenotype algebra</italic> on these embeddings, we examined the possibility of achieving risk inference directly from raw gene expression data for known molecular subtypes of specific cancers (BRCA, GBM, mCRPC). In the case of GBM, we observed that the gene expression model failed to correctly position CLA, MES, and (CLA +MES) in terms of their aggressiveness (<xref ref-type="fig" rid="app2fig6">Appendix 2—figure 6i</xref>). For BRCA, while it effectively positioned LUMA and HER2, it incorrectly categorized LUMB as the most aggressive subtype, despite LUMB typically having a favorable prognosis (<xref ref-type="fig" rid="app2fig6">Appendix 2—figure 6j</xref>). Similarly, in mCRPC, the gene expression-based model identified the NE subtype as the least aggressive, contradicting established literature, which recognizes NE as the most aggressive subtype (<xref ref-type="fig" rid="app2fig6">Appendix 2—figure 6k</xref>). These results demonstrated that using the survival modeling techniques directly on gene expression data, as opposed to SCellBOW embeddings, failed to accomplish accurate risk stratification.</p><p>To illustrate the effectiveness of fixed-length embeddings obtained from SCellBOW for <italic>phenotype algebra,</italic> we compared them to other tools such as scETM (<xref ref-type="bibr" rid="bib40">Hao et al., 2021</xref>), scPhere (<xref ref-type="bibr" rid="bib28">Ding and Regev, 2021</xref>), and scBERT (<xref ref-type="bibr" rid="bib107">Yang et al., 2022</xref>). Unlike SCellBOW, which is an unsupervised transfer learning-based model, the limitation of scETM and scBERT is the dependency on the cell type labeling of the source dataset. Due to the lack of source data annotation in Neftel et al. GBM dataset, we used the Scanpy clusters as the source annotation. scPhere is a deep generative model that embeds cells into low-dimensional space and doesn’t need any source data. In the case of scPhere and scBERT, we have used embedding size = 300 to match SCellBOW. However, in the case of scETM, we adhered to the default embedding size of 50, since it does not explicitly allow the tuning of this parameter.</p><p>In the case of GBM and mCRPC, we observed that all the tools (scETM, scPhere, and scBERT) failed to detect the relative position of the subtypes in the combined state ((MES +CLA) for GBM and (ARAH +ARAL + NE) for mCRPC) (<xref ref-type="fig" rid="app2fig7">Appendix 2—figure 7</xref>). While scETM and scPhere correctly identified the least aggressive subtype in GBM as PRO; it failed to position CLA and MES accurately (<xref ref-type="fig" rid="app2fig7">Appendix 2—figure 7a–c</xref>). Similarly, in BRCA, we observed that scETM and scPhere could identify LUMA as the least aggressive subtype, however, they failed to detect the relative position of the remaining subtypes (<xref ref-type="fig" rid="app2fig7">Appendix 2—figure 7d–f</xref>). scBERT outcomes didn't align with the established aggressiveness order both in GBM and BRCA. In mCRPC, the known aggressiveness order is NE ≻ ARAL ≻ ARAH. scETM, scPhere, and scBERT disagreed with the known relationship among these subtypes (<xref ref-type="fig" rid="app2fig7">Appendix 2—figure 7g–i</xref>). scETM, scBERT, and scPhere struggle to differentiate cancer clones based on their aggressiveness and their impact on disease prognosis.</p></sec><sec sec-type="appendix" id="s9-5"><title>Note 5: The importance of choosing Doc2vec as our base model</title><p>Single-cell RNA-seq profiles can relate cellular states and mRNA expression relationships, revealing gene expression programs corresponding to tumorigenesis. Identifying the groups of cells with similar phenotypic profiles is a critical step in cellular heterogeneity dissection. Natural language is a valuable analogy for cell signals where cells are analogous to sentences, and genes are analogous to words. Any downstream analysis of the scRNA-seq requires data to be represented in fewer dimensions. Embeddings are fixed-length vector representations. Using the cell sentences analogy, SCellBOW creates single-cell embedding based on the natural language processing (NLP) - Doc2vec language model (<xref ref-type="bibr" rid="bib70">Mikolov et al., 2013b</xref>). We have tested the performance of SCellBOW compared to Scanpy and Doc2Vec (<xref ref-type="bibr" rid="bib57">Le and Mikolov, 2014</xref>) on Segerstolpe et al. pancreas data. As source data for SCellBOW pre-trained model, we have taken Baron et al. Both datasets were retrieved from ItClust (<ext-link ext-link-type="uri" xlink:href="https://github.com/jianhuupenn/ItClust">https://github.com/jianhuupenn/ItClust</ext-link>; <xref ref-type="bibr" rid="bib45">Hu, 2022</xref>).</p><p>In <xref ref-type="fig" rid="app2fig9">Appendix 2—figure 9</xref>, we observed that the majority of cells of similar cell types are more localized in the 2-dimensional space compared to other Scanpy and Doc2vec. After SCellBOW, Doc2vec was able to group cells with similar signatures closer to each other (<xref ref-type="fig" rid="app2fig9">Appendix 2—figure 9g–i</xref>). Thus, embedding generated by the Doc2vec-based approaches preserves spatial segregation across the clusters. We observed the highest overall quality scores (ARI, NMI, and cell type SI) in SCellBOW (see <xref ref-type="fig" rid="app2fig9">Appendix 2—figure 9j</xref>). The SCellBOW score being higher than the Doc2Vec embedding and Scanpy embeddings suggest that although the Doc2vec model has good performance compared to Scanpy, transfer learning using the Doc2vec model yields higher clustering accuracy.</p></sec><sec sec-type="appendix" id="s9-6"><title>Note 6: Extended analysis of differentially expressed genes in spleen against PBMC</title><p>Spleen is the largest secondary lymphoid organ in the body and orchestrates a wide range of immunological functions. The physical organization of the spleen allows it to filter blood-borne pathogens and antigens. Differential expression analysis between immune cells originating from the spleen and peripheral blood exhibited spleen-specific elevated expression of dissociation-associated genes (<italic>JUNB</italic>, <italic>FOSB</italic>, <italic>JUND</italic>, <italic>JUN</italic>) and stress response heat shock genes (<italic>HSP</italic>, <italic>HSP90AB1</italic>, <italic>HSPD1</italic>, <italic>DNAJB1</italic>) (<xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4h and i</xref> and <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>). Upregulation of dissociation and stress response-associated gene families can be attributed to the additional dissociation step during sample preparation, which is exclusive to the splenocytes (<xref ref-type="bibr" rid="bib24">Denisenko et al., 2020</xref>; <xref ref-type="bibr" rid="bib95">Van den Brink et al., 2017</xref>). Furthermore, B cell differentiation-related genes such as <italic>VPREB3</italic>, <italic>MS4A1</italic>, and <italic>CD83</italic> were found upregulated among splenocytes as compared to PBMC, suggesting the dominance of various stages of development, differentiation, and maturation of B cells in the spleen. Notably, the spleen has different structures, such as primary follicles and the germinal center within the white pulp where various stages of B cells reside. We also spotted spleen-specific upregulation of nuclear receptors (<italic>NR4A1</italic>, <italic>NR4A2</italic>) and B cell receptors (BCR) (<italic>BANK1</italic>, <italic>CD79A</italic>, <italic>CD79B</italic>), indicating that B cells are inherently different between circulation and the spleen and likely undergo additional maturation steps in the spleen. We also observed spleen-specific expression of B cell inhibitory receptors (BCIR) (<italic>CD22</italic>, <italic>CD72</italic>, <italic>LY9</italic>), suggesting that multipotent progenitors reside in the spleen. These multipotent progenitors of the spleen stem cells could be differentiating to myeloid and erythroid lineage cells in addition to differentiation of the lymphoid lineage cells (primarily to B cells and to some extent to T cells) (<xref ref-type="bibr" rid="bib94">Tsubata, 2016</xref>). Overall, the BCR and BCIR are two important receptors that play complementary roles in regulating B cell activation and tolerance. While the BCR initiates signaling cascades that lead to B cell activation, the BCIR limits these signals and helps maintain B cell tolerance.</p><p>B cells are capable of developing a wide range of effector functions, including antibody secretion via differentiating to plasma cells, antigen processing and presentation to T helper cells, cytokine production, and generation of immunological memory. The mature spleen plays an important role in B cell development and antigen-dependent maturation because it is the site of terminal differentiation for developing B cells that arrive from the bone marrow known as Transitional B cells of type 1 (T1), and these cells develop to transitional B cells of type 2 (T2) and reside to the primary follicles of the spleen (<xref ref-type="bibr" rid="bib73">Nolte et al., 2004</xref>). Naive B cells enter the spleen from the circulation, where they differentiate into either B effectors that differentiate into antibody-secreting plasma cells or B memory cells (<xref ref-type="bibr" rid="bib93">Tsai et al., 2019</xref>). The prominent role of the spleen in B cell differentiation and activation inspired us to delve deeper into compositional and phenotypic differences associated with B cell subtypes across peripheral blood and spleen. Based on annotation, as expected, we noted enrichment of B effectors in the spleen (<xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4j</xref>). SCellBOW embedding could spatially segregate B effectors, B naive cells, and plasmablasts, although effectors and naive cells were not split into two distinct clusters (<xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4k</xref>).</p><p>Further analysis of B cell subtypes showed higher expression of the dissociation genes and stress response of genes in spleen B effector and B naive cells as compared to their peripheral blood counterpart (<xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4l and m</xref>). B naive has higher expression of actin genes (<italic>ACTB</italic>, <italic>ACTG1</italic>) as compared to B effectors, suggesting the naive B cells are more dynamic for differentiation to any of B cell subtypes, such as the effector or memory (<xref ref-type="bibr" rid="bib63">Liu et al., 2012</xref>). Notably, the mutation in these genes results in the development of large B-cell lymphoma. In the case of the B effector, we observed that the expression of <italic>CD27</italic>, <italic>HLADQA1</italic>, <italic>CD83</italic>, <italic>PRMT1</italic>, and <italic>CD69</italic> are significantly higher in the mature effector B cells (<xref ref-type="bibr" rid="bib47">Infantino et al., 2017</xref>; <xref ref-type="bibr" rid="bib109">Zandvoort et al., 2001</xref>). Collectively, genes upregulated in the B cells from the spleen were found to be involved in cell-cell adhesion, activation of the B cell receptor signaling pathway, and differentiation of B cells during hematopoiesis and our analysis very well corroborates with known B cell development biology under physiological conditions.</p><fig id="app2fig1" position="float"><label>Appendix 2—figure 1.</label><caption><title>Cell embeddings visualization.</title><p>(<bold>a-c</bold>) The UMAP plots showing embedding of SCellBOW compared to different existing methods benchmarked on normal prostate (<bold>a</bold>), peripheral blood mononuclear cells (PBMC) (<bold>b</bold>), and pancreas datasets (<bold>c</bold>). The coordinates of all the plots are colored by true cell types.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98469-app2-fig1-v1.tif"/></fig><fig id="app2fig2" position="float"><label>Appendix 2—figure 2.</label><caption><title>Cell embedding visualization of the normal prostate scRNA-seq dataset.</title><p>(<bold>a–f</bold>) The UMAP plots showing embedding of SCellBOW, Scanpy, Seurat, ItClust, ProjectR, and DESC on normal prostate. The coordinates of all the plots are colored by clusters. (<bold>g–l</bold>) Alluvial plots showing the mapping of clusters resulting from the benchmarking tools onto the true cell types from Henry et al. normal prostate dataset. CL is used as an abbreviation for cluster.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98469-app2-fig2-v1.tif"/></fig><fig id="app2fig3" position="float"><label>Appendix 2—figure 3.</label><caption><title>Extended performance evaluation of SCellBOW with scBERT and scPhere.</title><p>(<bold>a–d</bold>) Radial plot for the percentage of contribution of different methods towards ARI for various resolutions ranging from 0.2 to 2.0 for normal prostate (<bold>a</bold>), PBMC (<bold>b</bold>), pancreas (<bold>c</bold>), and CITE-seq (<bold>d</bold>) datasets. (<bold>e</bold>) Box plot for the NMI of different methods across different resolutions ranging from 0.2 to 2.0 in steps of 0.2. (<bold>f</bold>) Bar plot for the cell type silhouette index (SI) for different methods. The default resolution was set to 1.0.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98469-app2-fig3-v1.tif"/></fig><fig id="app2fig4" position="float"><label>Appendix 2—figure 4.</label><caption><title>Extended analysis of in-house CITE-seq dataset.</title><p>(<bold>a</bold>) Violin plot showing the distribution of UMIs for singlets, doublets, and negative cells. (<bold>b</bold>) The UMAP plots showing embedding of SCellBOW colored by donors. (<bold>c</bold>) The UMAP plots showing embedding of SCellBOW colored by tissue of origin. (<bold>d</bold>) Dot plot to check the expression of marker genes of PBMC per cell type identified by Azimuth. (<bold>e</bold>) Bar plot showing the proportion of annotated cell types across different clusters of SCellBOW. (<bold>f</bold>) Compositional difference in proportion annotated cell types in PBMC vs. splenocytes. (<bold>g</bold>) Heatmap for annotated cell type-wise differentially expressed genes in each cell type. (<bold>h</bold>) UMAP plots of the cells colored by their tissue source. (<bold>i</bold>) Volcano plot showing the differential genes (red dots) in the spleen and PBMC for B cells (p-value &lt; 0.05, False discovery rate (FDR)&lt;0.01). (<bold>j</bold>) Donut plot showing the compositional difference in the proportion of B cell subtypes (B naive, B effector, and plasmablast) in PBMC and spleen. (<bold>k</bold>) UMAP plot showing the embedding of SCellBOW colored by B cell subtypes. (<bold>l, m</bold>) Volcano plot showing the differential genes (red dots) in the spleen and PBMC for B effector (<bold>l</bold>) and B naive cells (<bold>m</bold>) (p-value &lt;0.05, FDR &lt; 0.01).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98469-app2-fig4-v1.tif"/></fig><fig id="app2fig5" position="float"><label>Appendix 2—figure 5.</label><caption><title>Cell embedding visualization of the in-house CITE-seq scRNA-seq dataset.</title><p>(<bold>a–f</bold>) The UMAP plots showing embedding of SCellBOW, Scanpy, Seurat, ItClust, ProjectR, and DESC on the PBMC-spleen dataset. The coordinates of all the plots are colored by clusters. (<bold>g–l</bold>) The alluvial plots showing the mapping of clusters resulting from the benchmarking tools onto the cell types identified by Azimuth.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98469-app2-fig5-v1.tif"/></fig><fig id="app2fig6" position="float"><label>Appendix 2—figure 6.</label><caption><title>Survival risk inference using <italic>phenotype algebra</italic> on raw gene expression data.</title><p>(<bold>a–c</bold>) <italic>Phenotype algebra</italic>-based risk scores using gene expression profile of GBM molecular subtypes (<bold>a</bold>), PAM50 molecular subtypes of BRCA (<bold>b</bold>), three high-level categories of mCRPC (<bold>c</bold>). The <italic>total tumor</italic> is denoted by <italic>T</italic>. (<bold>d-f</bold>) Heatmap for -log<sub>10</sub>(p-value) of the predicted risk scores for GBM subtype (<bold>d</bold>), BRCA subtype (<bold>e</bold>), and mCRPC clusters (<bold>f</bold>), and using Wilcoxon unpaired one-sided test.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98469-app2-fig6-v1.tif"/></fig><fig id="app2fig7" position="float"><label>Appendix 2—figure 7.</label><caption><title>Survival risk inference using fixed-length embeddings from scETM, scPhere, and scBERT.</title><p>(<bold>a–c</bold>) <italic>Phenotype algebra</italic>-based risk scores of GBM molecular subtypes using fixed-length embeddings from scETM (<bold>a</bold>), scPhere (<bold>b</bold>), and scBERT (<bold>c</bold>). The <italic>total tumor</italic> is denoted by <italic>T</italic>. (<bold>d-f</bold>) <italic>Phenotype algebra</italic>-based risk scores of PAM50 molecular subtypes of BRCA using fixed-length embeddings from scETM (<bold>a</bold>), scPhere (<bold>b</bold>), and scBERT (<bold>c</bold>). (<bold>g–i</bold>) <italic>Phenotype algebra</italic>-based risk scores of three high-level categories of mCRPC using fixed-length embeddings from scETM (<bold>a</bold>), scPhere (<bold>b</bold>), and scBERT (<bold>c</bold>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98469-app2-fig7-v1.tif"/></fig><fig id="app2fig8" position="float"><label>Appendix 2—figure 8.</label><caption><title>Extended analysis of <xref ref-type="bibr" rid="bib41">He et al., 2021</xref> single-cell mCPRC dataset.</title><p>(<bold>a</bold>) Elbow plot for selecting the best K for K-means clustering. (<bold>b, c</bold>) Scatter plot of GSVA scores of ARPC and NEPC gene sets colored by the K-means clusters (E) and SCellBOW clusters (F). (<bold>d</bold>) UMAP plot visualizing the high-level ARAH, ARAL, and NEPC categories on SCellBOW embeddings. (<bold>e, f</bold>) The UMAP plots showing the embedding of SCellBOW colored by metastasis site (<bold>a</bold>) and donors (<bold>b</bold>). (<bold>g</bold>) Alluvial plot to visualize tumor metastasis site of the donors. (<bold>h</bold>) UMAP plot visualizing SCellBOW embeddings of tumor microenvironment cells (malignant +non-malignant) in the He et al. dataset based on author annotations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98469-app2-fig8-v1.tif"/></fig><fig id="app2fig9" position="float"><label>Appendix 2—figure 9.</label><caption><title>Assessing the quality of clustering using transfer learning on BOW models using the pancreas dataset.</title><p>(<bold>a–c</bold>) UMAP plot of Scanpy embedding (<bold>a</bold>), Doc2Vec embedding (<bold>b</bold>), and SCellBOW embedding (<bold>c</bold>) of pancreas dataset using Leiden clustering at resolution 1.0. (<bold>d-f</bold>) UMAP plot of Scanpy embedding (<bold>d</bold>), Doc2Vec embedding (<bold>e</bold>), and SCellBOW embedding (<bold>f</bold>) of pancreas dataset colored with their annotated cell types (<bold>g–i</bold>) Alluvial plot for cell types against Leiden clusters for Scanpy (<bold>g</bold>) Doc2vec (<bold>h</bold>) SCellBOW (<bold>i</bold>). (<bold>j</bold>) Barplot for ARI, NMI, cluster purity, Silhouette index (cell type and cluster).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98469-app2-fig9-v1.tif"/></fig><fig id="app2fig10" position="float"><label>Appendix 2—figure 10.</label><caption><title>Assessing the effect of random seed on the quality of cell sentence generation using the pancreas dataset.</title><p>(<bold>a–f</bold>) The UMAP plots showing the embedding of SCellBOW generated using cell sentences with different random seeds ranging from 2 to 25. The colors of the cells in the UMAP plots indicate clusters. (<bold>g</bold>) Heatmap showing the ARI between each pair of clustering outcomes with distinct seeds.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98469-app2-fig10-v1.tif"/></fig></sec></sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.98469.3.sa0</article-id><title-group><article-title>eLife Assessment</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Hong</surname><given-names>Seunghee</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>Yonsei University</institution><country>Republic of Korea</country></aff></contrib></contrib-group><kwd-group kwd-group-type="evidence-strength"><kwd>Convincing</kwd></kwd-group><kwd-group kwd-group-type="claim-importance"><kwd>Important</kwd></kwd-group></front-stub><body><p>This manuscript presents an <bold>important</bold> contribution to the field of single-cell transcriptomic analysis in cancer by introducing a novel computational framework-SCellBOW-which applies embedding techniques from natural language processing to model phenotypic heterogeneity in tumors. The revised version includes new validation experiments and significant clarifications that provide <bold>convincing</bold> evidence for the method's utility. The authors have benchmarked SCellBOW across diverse datasets, including glioblastoma, breast, and metastatic prostate cancer, and have demonstrated its superior performance compared to existing state-of-the-art methods.</p></body></sub-article><sub-article article-type="referee-report" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.98469.3.sa1</article-id><title-group><article-title>Reviewer #2 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>The authors developed a novel tool, SCellBOW, to perform cell clustering and infer survival risks on individual cancer cell clusters from the single cell RNA seq dataset. The key ideas/techniques used in the tool include transfer learning, bag of words (BOW), and phenotype algebra which is similar to word algebra from natural language processing (NLP). Comparisons with existing methods demonstrated that SCellBOW provides superior clustering results and exhibits robust performance across a wide range of datasets. Importantly, a distinguishing feature of SCellBOW compared to other tools is its ability to assign risk scores to specific cancer cell clusters. Using SCellBOW, the authors identified a new group of prostate cancer cells characterized by a highly aggressive and dedifferentiated phenotype.</p><p>Strengths:</p><p>The application of natural language processing (NLP) to single-cell RNA sequencing (scRNA-seq) datasets is both smart and insightful. Encoding gene expression levels as word frequencies is a creative way to apply text analysis techniques to biological data. When combined with transfer learning, this approach enhances our ability to describe the heterogeneity of different cells, offering a novel method for understanding the biological behavior of individual cells and surpassing the capabilities of existing cell clustering methods. Moreover, the ability of the package to predict risk, particularly within cancer datasets, significantly expands the potential applications.</p><p>Weaknesses:</p><p>Given the promising nature of this tool, it would be beneficial for the authors to test the risk-stratification functionality on other types of tumors with high heterogeneity, such as liver and pancreatic cancers, which currently lack clinically relevant and well-recognized stratification methods. Additionally, it would be worthwhile to investigate how the tool could be applied to spatial transcriptomics by analyzing cell embeddings from different layers within these tissues.</p></body></sub-article><sub-article article-type="author-comment" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.98469.3.sa2</article-id><title-group><article-title>Author response</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Bhattacharya</surname><given-names>Namrata</given-names></name><role specific-use="author">Author</role><aff><institution>Queensland University of Technology</institution><addr-line><named-content content-type="city">Brisbane</named-content></addr-line><country>Australia</country></aff></contrib><contrib contrib-type="author"><name><surname>Rockstroh</surname><given-names>Anja</given-names></name><role specific-use="author">Author</role><aff><institution>Queensland University of Technology</institution><addr-line><named-content content-type="city">Brisbane</named-content></addr-line><country>Australia</country></aff></contrib><contrib contrib-type="author"><name><surname>Deshpande</surname><given-names>Sanket Suhas</given-names></name><role specific-use="author">Author</role><aff><institution>Indraprastha Institute of Information Technology Delhi</institution><addr-line><named-content content-type="city">Delhi</named-content></addr-line><country>India</country></aff></contrib><contrib contrib-type="author"><name><surname>Thomas</surname><given-names>Sam Koshy</given-names></name><role specific-use="author">Author</role><aff><institution>The University of Adelaide</institution><addr-line><named-content content-type="city">Adelaide</named-content></addr-line><country>Australia</country></aff></contrib><contrib contrib-type="author"><name><surname>Yadav</surname><given-names>Anunay</given-names></name><role specific-use="author">Author</role><aff><institution>Indraprastha Institute of Information Technology Delhi</institution><addr-line><named-content content-type="city">Delhi</named-content></addr-line><country>India</country></aff></contrib><contrib contrib-type="author"><name><surname>Goswami</surname><given-names>Chitrita</given-names></name><role specific-use="author">Author</role><aff><institution>Indraprastha Institute of Information Technology Delhi</institution><addr-line><named-content content-type="city">Delhi</named-content></addr-line><country>India</country></aff></contrib><contrib contrib-type="author"><name><surname>Chawla</surname><given-names>Smriti</given-names></name><role specific-use="author">Author</role><aff><institution>Indraprastha Institute of Information Technology Delhi</institution><addr-line><named-content content-type="city">Delhi</named-content></addr-line><country>India</country></aff></contrib><contrib contrib-type="author"><name><surname>Solomon</surname><given-names>Pierre</given-names></name><role specific-use="author">Author</role><aff><institution>University of Nantes</institution><addr-line><named-content content-type="city">Nantes</named-content></addr-line><country>France</country></aff></contrib><contrib contrib-type="author"><name><surname>Fourgeux</surname><given-names>Cynthia</given-names></name><role specific-use="author">Author</role><aff><institution>University of Nantes</institution><addr-line><named-content content-type="city">Nantes</named-content></addr-line><country>France</country></aff></contrib><contrib contrib-type="author"><name><surname>Ahuja</surname><given-names>Gaurav</given-names></name><role specific-use="author">Author</role><aff><institution>Indraprastha Institute of Information Technology Delhi</institution><addr-line><named-content content-type="city">New Delhi</named-content></addr-line><country>India</country></aff></contrib><contrib contrib-type="author"><name><surname>Hollier</surname><given-names>Brett</given-names></name><role specific-use="author">Author</role><aff><institution>Queensland University of Technology</institution><addr-line><named-content content-type="city">Brisbane</named-content></addr-line><country>Australia</country></aff></contrib><contrib contrib-type="author"><name><surname>Kumar</surname><given-names>Himanshu</given-names></name><role specific-use="author">Author</role><aff><institution>Indian Institute of Science Education and Research, Bhopal</institution><addr-line><named-content content-type="city">Bhopal</named-content></addr-line><country>India</country></aff></contrib><contrib contrib-type="author"><name><surname>Roquilly</surname><given-names>Antoine</given-names></name><role specific-use="author">Author</role><aff><institution>University of Nantes</institution><addr-line><named-content content-type="city">Nantes</named-content></addr-line><country>France</country></aff></contrib><contrib contrib-type="author"><name><surname>Poschmann</surname><given-names>Jeremie</given-names></name><role specific-use="author">Author</role><aff><institution>University of Nantes</institution><addr-line><named-content content-type="city">Nantes</named-content></addr-line><country>France</country></aff></contrib><contrib contrib-type="author"><name><surname>Lehman</surname><given-names>Melanie</given-names></name><role specific-use="author">Author</role><aff><institution>Queensland University of Technology</institution><addr-line><named-content content-type="city">Brisbane</named-content></addr-line><country>Australia</country></aff></contrib><contrib contrib-type="author"><name><surname>Nelson</surname><given-names>Colleen</given-names></name><role specific-use="author">Author</role><aff><institution>Queensland University of Technology</institution><addr-line><named-content content-type="city">Queensland</named-content></addr-line><country>Australia</country></aff></contrib><contrib contrib-type="author"><name><surname>Sengupta</surname><given-names>Debarka</given-names></name><role specific-use="author">Author</role><aff><institution>Indraprastha Institute of Information Technology Delhi</institution><addr-line><named-content content-type="city">Delhi</named-content></addr-line><country>India</country></aff></contrib></contrib-group></front-stub><body><p>The following is the authors’ response to the original reviews</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #1 (Public Review):</bold></p><p>This review evaluates the SCellBOW framework, which applies phenotype algebra to obtain vectors from cancer subclusters or user-defined subclusters.</p><p>Strengths:</p><p>SCellBOW employs an innovative application of NLP-inspired techniques to analyze scRNA-seq data, facilitating the identification and visualization of phenotypically divergent cell subpopulations. The framework demonstrates robustness in accurately representing various cell types across multiple datasets, highlighting its versatility and utility in different biological contexts. By simulating the impact of specific malignant subpopulations on disease prognosis, SCellBOW provides valuable insights into the relative risk and aggressiveness of cancer subpopulations, which is crucial for personalized therapeutic strategies. The identification of a previously unknown and aggressive AR−/NElow subpopulation in metastatic prostate cancer underscores the potential of SCellBOW in uncovering clinically significant findings.</p><p>Major concerns:</p><p>The reliance on bulk RNA-seq data as a reference raises concerns about potentially misleading results due to the presence of RNA expression from immune cells in the TME. It is unclear if SCellBOW adequately addresses this issue, which could affect the accuracy of the cancer subcluster vectors.</p></disp-quote><p>We appreciate the reviewer's concerns. To address the concern about potentially misleading results due to the TME when using bulk RNA-seq data as a reference:</p><p>a. We account for systematic biases between the single-cell and bulk transcriptomics readouts by creating pseudo-bulk profiles for single-cell clusters, enabling more accurate comparisons [Section Materials and methods, Data preparation for phenotype algebra].</p><p>b. We encode expressions into word vectors and co-embed them together. By doing this, we mitigate any possibility of systematic differences in the embedding. It is imperative that we subject both single-cell and bulk data through the same treatments because otherwise, it will be difficult to perform algebraic operations on them [Section Materials and methods, Generating vectors for phenotype algebra].</p><p>c. In our new analysis of the tumor microenvironment, we have shown that SCellBOW effectively differentiates between malignant and non-malignant cells, confirming that it is not biased by the immune cell composition in the bulk RNA-seq data [Section SCellBOW facilitates survival-risk attribution of tumor subpopulations, Fig. 5g-h].</p><disp-quote content-type="editor-comment"><p>The method of extracting vectors in phenotype algebra appears to be a straightforward subtraction operation. This simplicity might limit its efficiency in excluding associations with phenotypes from specific subpopulations, potentially leading to inaccurate interpretations of the data.</p></disp-quote><p>Thanks for this excellent query. Vector algebra operations are not done in the gene expression space (i.e., gene expression vectors associated with tumor samples), rather we process the single cell and bulk expression profiles through multiple steps (pseudo-bulk vector generation for single cell clusters, mapping gene expression values to word frequencies as better understood by the Doc2vec neural networks etc.) to ensure their embeddings are consistent and capture intricate phenotypic information. We have demonstrated this through rigorous validation of the clusters yielded on various types of healthy and diseased samples. Furthermore, we have demonstrated the consistency of the vector algebra operations on known cancer subtypes in breast cancer, glioblastoma, and prostate cancer. We have clarified this further in text. [Section Materials and methods, ‘Generating vectors for phenotype algebra’, ‘Survival risk attribution’].</p><disp-quote content-type="editor-comment"><p>The review would benefit from additional validation studies to assess the effectiveness of SCellBOW in distinguishing between cancerous and non-cancerous signals, particularly in heterogeneous tumor environments.</p></disp-quote><p>We thank the reviewer for advising this additional validation. While our study primarily focused on signals from malignant cells, we have now considered the impact of the tumor microenvironment. We observed that the predicted risk score increases when the immune component is subtracted from the tumor, suggesting that tumor aggressiveness increases in the absence of immune components. Importantly, the aggressiveness ranking of tumor subtypes (NE &gt; ARAL &gt; ARAH) remained consistent, confirming that SCellBOW effectively preserves subtype-specific risk stratification [Section SCellBOW facilitates survival-risk attribution of tumor subpopulations, Fig. 5g-h].</p><disp-quote content-type="editor-comment"><p>Further clarification on how SCellBOW handles mixed-cell populations within bulk RNA-seq data would strengthen the evaluation of its applicability and reliability in diverse research settings.</p></disp-quote><p>We really appreciate the reviewer’s observation. We clarify that rather than relying on absolute gene expression values, SCellBOW maps bulk RNA-seq data into an embedding space, where we extract the latent representation of the tumor. This process effectively masks the influence of mixed-cell populations, reducing biases introduced by immune or stromal components. Furthermore, <italic>phenotype algebra</italic> operates within this embedding space by comparing cosine similarities between latent representations of bulk and pseudo-bulk datasets, rather than using direct gene expression values. This allows SCellBOW to capture biologically meaningful relationships and infer tumor-specific signals effectively, even in the presence of heterogeneous cell populations. Our benchmarking across diverse cancer types confirms its effectiveness [Section Results, ‘SCellBOW enables pseudo-grading of metastatic prostate cancer tumor microenvironment’, ‘Unsupervised risk-stratification of metastatic prostate cancer clusters using SCellBOW’].</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Public Review):</bold></p><p>The authors developed a novel tool, SCellBOW, to perform cell clustering and infer survival risks on individual cancer cell clusters from the single-cell RNA seq dataset. The key ideas/techniques used in the tool include transfer learning, bag of words (BOW), and phenotype algebra which is similar to word algebra from natural language processing (NLP). Comparisons with existing methods demonstrated that SCellBOW provides superior clustering results and exhibits robust performance across a wide range of datasets. Importantly, a distinguishing feature of SCellBOW compared to other tools is its ability to assign risk scores to specific cancer cell clusters. Using SCellBOW, the authors identified a new group of prostate cancer cells characterized by a highly aggressive and dedifferentiated phenotype.</p><p>Strengths:</p><p>The application of natural language processing (NLP) to single-cell RNA sequencing (scRNA-seq) datasets is both smart and insightful. Encoding gene expression levels as word frequencies is a creative way to apply text analysis techniques to biological data. When combined with transfer learning, this approach enhances our ability to describe the heterogeneity of different cells, offering a novel method for understanding the biological behavior of individual cells and surpassing the capabilities of existing cell clustering methods. Moreover, the ability of the package to predict risk, particularly within cancer datasets, significantly expands the potential applications.</p><p>Major concerns:</p><p>Given the promising nature of this tool, it would be beneficial for the authors to test the risk-stratification functionality on other types of tumors with high heterogeneity, such as liver and pancreatic cancers, which currently lack clinically relevant and well-recognized stratification methods. Additionally, it would be worthwhile to investigate how the tool could be applied to spatial transcriptomics by analyzing cell embeddings from different layers within these tissue</p></disp-quote><p>(1) We completely agree with the reviewer’s view. Our selection of glioblastoma and breast cancer for this study was primarily driven by the focus on extensively studied and well-defined cancer types. To demonstrate the effectiveness of our model, we tested it on advanced prostate cancer, which currently lacks clinically relevant and well-recognized stratification methods. This application to metastatic prostate cancer serves as a proof of concept, illustrating our model's potential to provide valuable insights into cancer types where established stratification approaches are limited or absent.</p><p>(2) Regarding the application of our tool to spatial transcriptomics, we have already analyzed data from Digital Spatial Profiling (DSP). The article is already quite complex and involved, and we are afraid the inclusion of spatial transcriptomics may amount to a significant extension of the method. To this end, although we will discuss the future possibilities, we will skip the method validity check on spatial transcriptomics data.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Recommendations For The Authors):</bold></p><p>(1) &quot;SCellBOW adapts the popular document-embedding model Doc2vec for single-cell latent representation learning, which can be used for downstream analysis...&quot;: Using only simple gene frequency might overlook the dependent relationships between genes, potentially compromising the biological significance. This could be discussed further.</p></disp-quote><p>This is an excellent point raised by the reviewer. We acknowledge that using only simple gene frequency may overlook dependent relationships between genes, potentially compromising biological significance. To address this, we have now compared SCellBOW on the specific task of <italic>phenotype algebra</italic> and demonstrated its effectiveness in capturing meaningful biological relationships which is overlooked by simple gene frequency. We have now added the results of this comparison and showed that gene expression data alone couldn't cut it for accurate risk stratification [Section Overall discussion, Supplementary Note 7, Supplementary Fig. 8i-k].</p><disp-quote content-type="editor-comment"><p>(2) &quot;While existing methods effectively reveal the subpopulations, they are insufficient in associating malignant risk with specific cellular subpopulations identified from scRNA-seq data....&quot;: Perhaps I missed it in the methods section, but how does SCellBOW compare to simply performing pseudobulk analysis on separate cell clusters, treating them as bulk RNA-seq, and then associating the signatures with disease prognosis?</p></disp-quote><p>This is an insightful point, and we appreciate the opportunity to clarify it.</p><p>(1) While pseudobulk analysis on separate cell clusters, followed by associating their signatures with disease prognosis, is a common approach, SCellBOW achieves this without requiring a priori knowledge of prognostic biomarkers to determine whether a subpopulation is aggressive.</p><p>(2) Moreover, pseudobulk analysis aggregates gene expression across cells, which can potentially mask intra-cluster heterogeneity, thereby obscuring important signatures associated with disease prognosis. In contrast, the latent representation in SCellBOW captures the semantic meaning of disease aggressiveness, allowing for a more nuanced and biologically meaningful risk assessment.</p><disp-quote content-type="editor-comment"><p>(3) &quot;The proposed approach, SCellBOW, can effectively capture the heterogeneity and risk associated with each phenotype, enabling the identification and assessment of malignant cell subtypes in tumors directly from scRNA-seq gene expression profiles, thereby eliminating the need for marker genes...&quot;: Have the author compared the resulting group with well-known markers and do they overlap?</p></disp-quote><p>We appreciate this thoughtful question. While SCellBOW does not rely on predefined marker genes for clustering or risk stratification, we have systematically evaluated whether the resulting subpopulations align with well-known markers. To assess this, we compared SCellBOW-derived clusters with established marker-based annotations across multiple datasets. We observed a significant overlap between SCellBOW clusters and canonical marker-defined cell types in various cancers, including GBM, BRCA, and mCRPC.</p><disp-quote content-type="editor-comment"><p>(4) &quot;We constructed three use cases leveraging publicly available scRNA-seq datasets...&quot;: The three training and testing datasets are all from healthy tissue. How about in tumor tissue? i.e., Could SCellBOW also identify better cell clusters in tumor datasets?</p></disp-quote><p>We appreciate the reviewer’s inquiry. For benchmarking and method validation, we primarily selected normal tissue datasets as they are heavily annotated and well-characterized. Our goal was to extensively evaluate SCellBOW across different clustering metrics, including ARI, NMI, and SI, which required datasets with reliable ground truth. Tumor datasets, in contrast, often lack confirmatory ground truth, making direct benchmarking more challenging. However, to assess SCellBOW’s applicability in tumor settings, we performed downstream analyses on tumor scRNA-seq datasets using phenotype algebra. Our results demonstrate that SCellBOW effectively identifies distinct cell clusters, including malignant and non-malignant populations, reinforcing its applicability in tumor settings [Section Results, ‘Unsupervised risk-stratification of metastatic prostate cancer clusters using SCellBOW’].</p><disp-quote content-type="editor-comment"><p>Minor issues:</p><p>(1) Labels of subplots within the manu/figure should be revised to ensure correct order (missing Figures 3a-d, 4b before 4a, etc).</p></disp-quote><p>We thank the reviewer for pointing this out. We have corrected the figure labels and ensured that all subplots follow the correct order, aligning with the manuscript.</p><disp-quote content-type="editor-comment"><p>(2) &quot;reaffirmed the clinically known aggressiveness order, i.e., CLA &gt;-MES &gt;-PRO, where CLA succeeds the rest of the subtypes in aggressiveness48 (Figures 4c, d)...&quot;: &quot;Fig. 4c, d&quot; should be &quot;Fig. 4e, f&quot;. Also please put Figure 4a before 4b. Overall the order of Figure 4 needs to be revised to match the order in the manu. Similar to Figure 6.</p></disp-quote><p>We have corrected the figure reference to Fig. 4e, f and revised the order of Figure 4 to maintain consistency with the manuscript.</p><disp-quote content-type="editor-comment"><p>(3) &quot;Our results showed that SCellBOW learned latent representation of single-cells accurately captures the 'semantics' associated with cellular phenotypes and allows algebraic operations such as'+' and'-'.&quot; Figure 5f (SCellBOW performances on mCRPC) should also be cited here since Supplementary Figure 6 contains three datasets (GBM, BRCA, mCRPC) while in Figure 4 only GBM and BRCA were shown?</p></disp-quote><p>We thank the reviewer for this suggestion. We have now cited Figure 5f in this section to ensure that all datasets, including mCRPC, are appropriately referenced.</p><disp-quote content-type="editor-comment"><p>(4) Under the subheading &quot;SCellBOW facilitates survival-risk attribution of tumor subpopulations&quot;, the lines start with &quot;We refer to this as phenotype algebra. We utilized this ability to find an association between the embedding vectors, representing total tumor - a specific malignant cell cluster with tumor aggressiveness...&quot; could be reduced a little bit especially the re-intro of phenotype algebra since the author has already discussed previously (under &quot;overview of SCellBOW&quot;).</p></disp-quote><p>We appreciate the feedback and have condensed this section to avoid redundancy while maintaining clarity in connecting phenotype algebra to survival-risk attribution.</p><disp-quote content-type="editor-comment"><p>(5) &quot;Most CD4+ T cells map to CL0 and CL9 (here, CL is used as an abbreviation for cluster) (Figure 3f)...&quot; &quot;(here, CL is used as an abbreviation for cluster)&quot; this note could be moved forward to SF2 since CL is first introduced in SF2.</p></disp-quote><p>We thank the reviewer for the suggestion. We have moved the definition of CL (cluster) to Supplementary Figure 2 (SF2), where it is first introduced, for improved clarity.</p></body></sub-article></article>