<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">81279</article-id><article-id pub-id-type="doi">10.7554/eLife.81279</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group><subj-group subj-group-type="heading"><subject>Physics of Living Systems</subject></subj-group></article-categories><title-group><article-title>Granger causality analysis for calcium transients in neuronal networks, challenges and improvements</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-284451"><name><surname>Chen</surname><given-names>Xiaowen</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4029-1805</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-284452"><name><surname>Ginoux</surname><given-names>Faustine</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5031-7346</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-140371"><name><surname>Carbo-Tano</surname><given-names>Martin</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1936-7174</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-300161"><name><surname>Mora</surname><given-names>Thierry</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5456-9361</contrib-id><email>thierry.mora@phys.ens.fr</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-50904"><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2686-5702</contrib-id><email>aleksandra.walczak@phys.ens.fr</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-28504"><name><surname>Wyart</surname><given-names>Claire</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1668-4975</contrib-id><email>claire.wyart@icm-institute.org</email><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf3"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02feahw73</institution-id><institution>Laboratoire de physique de l'École normale supérieure, CNRS, PSL University</institution></institution-wrap><addr-line><named-content content-type="city">Paris</named-content></addr-line><country>France</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02en5vm52</institution-id><institution>Spinal Sensory Signaling team, Sorbonne Université, Paris Brain Institute (Institut du Cerveau, ICM)</institution></institution-wrap><addr-line><named-content content-type="city">Paris</named-content></addr-line><country>France</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Berman</surname><given-names>Gordon J</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03czfpz43</institution-id><institution>Emory University</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Behrens</surname><given-names>Timothy E</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/052gg0110</institution-id><institution>University of Oxford</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn><fn fn-type="con" id="equal-contrib2"><label>‡</label><p>These authors also contributed equally to this work</p></fn></author-notes><pub-date publication-format="electronic" date-type="publication"><day>07</day><month>02</month><year>2023</year></pub-date><pub-date pub-type="collection"><year>2023</year></pub-date><volume>12</volume><elocation-id>e81279</elocation-id><history><date date-type="received" iso-8601-date="2022-06-22"><day>22</day><month>06</month><year>2022</year></date><date date-type="accepted" iso-8601-date="2023-02-06"><day>06</day><month>02</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2022-06-29"><day>29</day><month>06</month><year>2022</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.06.27.497721"/></event></pub-history><permissions><copyright-statement>© 2023, Chen, Ginoux et al</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Chen, Ginoux et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-81279-v2.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-81279-figures-v2.pdf"/><abstract><p>One challenge in neuroscience is to understand how information flows between neurons <italic>in vivo</italic> to trigger specific behaviors. Granger causality (GC) has been proposed as a simple and effective measure for identifying dynamical interactions. At single-cell resolution however, GC analysis is rarely used compared to directionless correlation analysis. Here, we study the applicability of GC analysis for calcium imaging data in diverse contexts. We first show that despite underlying linearity assumptions, GC analysis successfully retrieves non-linear interactions in a synthetic network simulating intracellular calcium fluctuations of spiking neurons. We highlight the potential pitfalls of applying GC analysis on real <italic>in vivo</italic> calcium signals, and offer solutions regarding the choice of GC analysis parameters. We took advantage of calcium imaging datasets from motoneurons in embryonic zebrafish to show how the improved GC can retrieve true underlying information flow. Applied to the network of brainstem neurons of larval zebrafish, our pipeline reveals strong driver neurons in the locus of the mesencephalic locomotor region (MLR), driving target neurons matching expectations from anatomical and physiological studies. Altogether, this practical toolbox can be applied on <italic>in vivo</italic> population calcium signals to increase the selectivity of GC to infer flow of information across neurons.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>causality</kwd><kwd>information flow</kwd><kwd>neural networks</kwd><kwd>locomotion</kwd><kwd>calcium imaging</kwd><kwd>statistical analysis</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Zebrafish</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000781</institution-id><institution>European Research Council</institution></institution-wrap></funding-source><award-id>COG 724208</award-id><principal-award-recipient><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000781</institution-id><institution>European Research Council</institution></institution-wrap></funding-source><award-id>COG 101002870</award-id><principal-award-recipient><name><surname>Wyart</surname><given-names>Claire</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100003194</institution-id><institution>New York Stem Cell Foundation</institution></institution-wrap></funding-source><award-id>NYSCF-R-NI39</award-id><principal-award-recipient><name><surname>Wyart</surname><given-names>Claire</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000854</institution-id><institution>Human Frontier Science Program</institution></institution-wrap></funding-source><award-id>RGP0063/2018</award-id><principal-award-recipient><name><surname>Wyart</surname><given-names>Claire</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002915</institution-id><institution>Fondation pour la Recherche Médicale</institution></institution-wrap></funding-source><award-id>FRM- EQU202003010612</award-id><principal-award-recipient><name><surname>Wyart</surname><given-names>Claire</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution>Fondation Bettencourt-Schueller</institution></institution-wrap></funding-source><award-id>FBS-don-0031</award-id><principal-award-recipient><name><surname>Wyart</surname><given-names>Claire</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A practical toolbox for application of Granger causality inference to calcium imaging data identifies strong driver neurons in the locus of the mesencephalic locomoter region in larval zebrafish.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The prompt integration of sensory inputs by motor command neurons in the nervous systems can become a matter of life and death, often requiring fast and precise movements in response to the stimulus. Understanding how large neuronal networks coordinate to generate cognitive activities requires knowing how information from the stimuli flows between neurons to result in the observed behavior. Recent developments in optogenetics (<xref ref-type="bibr" rid="bib16">Deisseroth, 2011</xref>; <xref ref-type="bibr" rid="bib18">Fenno et al., 2011</xref>), and whole-brain imaging with single-cell resolution (<xref ref-type="bibr" rid="bib1">Ahrens et al., 2013</xref>; <xref ref-type="bibr" rid="bib38">Nguyen et al., 2016</xref>; <xref ref-type="bibr" rid="bib56">Venkatachalam et al., 2016</xref>; <xref ref-type="bibr" rid="bib14">Cong et al., 2017</xref>) allow us to observe collective firing patterns of many neurons and give the basis for reconstructing a causality network that describes how neurons influence each other. However, despite the existing data, assessing the direction of neuronal communication or causality in order to understand how information flows in the brain during integrative reflexive behaviors remains a major challenge in neuroscience (<xref ref-type="bibr" rid="bib25">Goulding, 2009</xref>).</p><p>Apart from perturbing individual neurons and observing the activity of downstream neurons, non-invasive methods for obtaining functional connectivity have been developed (<xref ref-type="bibr" rid="bib5">Bastos and Schoffelen, 2016</xref>). The widely-used correlation analysis (<xref ref-type="bibr" rid="bib13">Cohen and Kohn, 2011</xref>; <xref ref-type="bibr" rid="bib29">Haesemeyer et al., 2018</xref>; <xref ref-type="bibr" rid="bib54">Stringer et al., 2019</xref>) identifies pairs or groups of neurons that are active at the same time, suggesting either that they drive each other, or are driven by a common input. By contrast, Granger causality (GC) identifies directed interactions (<xref ref-type="bibr" rid="bib27">Granger, 1969</xref>; <xref ref-type="bibr" rid="bib23">Geweke, 1982</xref>; <xref ref-type="bibr" rid="bib24">Geweke, 1984</xref>). Assuming that the two time-series are well described by Gaussian autoregressive processes, GC quantifies the ability to predict the future values of the time series of a given neuron using prior values of the time series of other neurons. In the field of neuroscience, GC has been used to analyze data from diverse sources (<xref ref-type="bibr" rid="bib47">Seth et al., 2015</xref>), including electroencephalography (EEG), magnetoencephalography (MEG) (<xref ref-type="bibr" rid="bib26">Gow et al., 2008</xref>), functional magnetic resonance imaging (fMRI) (<xref ref-type="bibr" rid="bib43">Roebroeck et al., 2005</xref>; <xref ref-type="bibr" rid="bib17">Deshpande et al., 2009</xref>; <xref ref-type="bibr" rid="bib60">Wen et al., 2013</xref>), and local field potentials (LFP) (<xref ref-type="bibr" rid="bib7">Brovelli et al., 2004</xref>). Despite criticisms such as sensitivity to data preprocessing (<xref ref-type="bibr" rid="bib19">Florin et al., 2010</xref>), internal dynamics of the neuron (<xref ref-type="bibr" rid="bib53">Stokes and Purdon, 2017</xref>), additive noise that can be correlated among regions of interest or not (<xref ref-type="bibr" rid="bib37">Nalatore et al., 2007</xref>; <xref ref-type="bibr" rid="bib58">Vinck et al., 2015</xref>), and sampling frequency (<xref ref-type="bibr" rid="bib61">Zhou et al., 2014</xref>; <xref ref-type="bibr" rid="bib3">Barnett and Seth, 2017</xref>), GC and its extensions (<xref ref-type="bibr" rid="bib51">Shojaie and Fox, 2021</xref>; <xref ref-type="bibr" rid="bib4">Barnett et al., 2018</xref>) have been useful to construct functional connectomes, to identify important neurons acting as information hubs, or to classify different brain states (<xref ref-type="bibr" rid="bib39">Nicolaou et al., 2012</xref>).</p><p>While most GC analyses in neuroscience focus on large scale ensemble-level neuronal signals, it is unclear how well it can be adapted to address single-cell level descriptions, such as spiking (<xref ref-type="bibr" rid="bib31">Kim et al., 2011</xref>; <xref ref-type="bibr" rid="bib22">Gerhard et al., 2013</xref>; <xref ref-type="bibr" rid="bib49">Sheikhattar et al., 2018</xref>) or population calcium imaging data (<xref ref-type="bibr" rid="bib15">De Vico Fallani et al., 2014</xref>; <xref ref-type="bibr" rid="bib48">Severi et al., 2018</xref>; <xref ref-type="bibr" rid="bib40">Oldfield et al., 2020</xref>). Without the law of large numbers, these single-cell time series are no longer approximately Gaussian, the dynamics of signal propagation is increasingly nonlinear, and the sampling rate is typically much slower than the rate of information propagation. All of these points cast doubt on whether GC can correctly identify information flow. Recently however, <xref ref-type="bibr" rid="bib15">De Vico Fallani et al., 2014</xref> demonstrated in zebrafish embryos that, despite a low sampling frequency of acquisition for calcium imaging (4 Hz), GC can detect information flow consistent with the known rostrocaudal propagation of activity among motoneurons in the spinal cord. <xref ref-type="bibr" rid="bib40">Oldfield et al., 2020</xref> subsequently applied GC to grouped averages of calcium signals over large brain regions without single cell resolution, and detected the information flow correctly based on anatomy from the pretectum to the tectum in the visual system leading to subsequent activity of brainstem and motor circuits during prey capture in larval zebrafish. New variations of GC accounting for sparsity in the connection have also been developed and applied on single-cell level to both spiking and calcium signals in the primary auditory cortex of mice (<xref ref-type="bibr" rid="bib49">Sheikhattar et al., 2018</xref>; <xref ref-type="bibr" rid="bib20">Francis et al., 2018</xref>; <xref ref-type="bibr" rid="bib21">Francis et al., 2022</xref>). Nonetheless, at the single-cell resolution, it is unclear to which extent the application of GC analysis in population calcium imaging is generalizable, and how GC analysis should be improved to accommodate intrinsic features of calcium signals.</p><p>In this manuscript, we identify a set of issues inherent to GC analysis when applied to population calcium imaging and propose solutions to address them. We first use synthetic neural signals and then exploit as examples population recordings of <italic>in vivo</italic> calcium signals in zebrafish with either correlated and non-correlated noise. We build an improved analysis pipeline customized for calcium signals to address critical issues intrinsic to <italic>in vivo</italic> calcium imaging, such as the slow exponential decays of calcium transients, correlated noise, and non-linear and non-Gaussian statistics. We develop our method both on a synthetic network of neurons for which we know the interaction structure, as well as on real data from motoneurons in the embryonic zebrafish spinal cord that are recruited along a chain organized from rostral to caudal on either side of the spinal cord (<xref ref-type="bibr" rid="bib15">De Vico Fallani et al., 2014</xref>). We first improve our analysis pipeline to optimally detect the information flowing between embryonic motoneurons in <xref ref-type="bibr" rid="bib15">De Vico Fallani et al., 2014</xref>. Second, we apply our improved GC analysis to infer information flow from large neuronal populations in the brainstem of larval zebrafish performing optomotor response (<xref ref-type="bibr" rid="bib48">Severi et al., 2018</xref>). In the context of large populations of neurons, we show that our method is able to reveal that motor-correlated neurons within the recently identified mesencephalic locomotor region in <xref ref-type="bibr" rid="bib10">Carbo-Tano et al., 2022</xref> drive the activity of downstream neurons in the reticular formation.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Granger causality</title><p>Granger causality quantifies the ability to predict the future values of the discrete time series of neuron X of length <inline-formula><mml:math id="inf1"><mml:mi>T</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf2"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, for <inline-formula><mml:math id="inf3"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, using prior values of the time series of neuron Y, <inline-formula><mml:math id="inf4"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, for <inline-formula><mml:math id="inf5"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, assuming that the two time-series are well described by Gaussian autoregressive processes (<xref ref-type="bibr" rid="bib27">Granger, 1969</xref>; <xref ref-type="bibr" rid="bib47">Seth et al., 2015</xref>). The method asks whether including information from Y to predict X has significant predictive power, by computing a <italic>p</italic>-value assuming as a null model the probability that the dynamics of X can be explained without Y. The prior values of neuron X and Y itself used in that prediction are taken for a finite number of past time points, which defines a characteristic timescale.</p><p>With only the information of X itself, the dynamics of X, <italic>x</italic><sub><italic>t</italic></sub>, may be modeled as an autoregressive process, denoted as the ‘<italic>reduced model’</italic>,<disp-formula id="equ1"> <label>(1)</label><mml:math id="m1"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>a</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mover><mml:mi>a</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>ε</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf6"><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>q</mml:mi></mml:msub></mml:math></inline-formula> are the regression coefficients, the maximum lag <inline-formula><mml:math id="inf7"><mml:mi>L</mml:mi></mml:math></inline-formula> is a hyper-parameter subject to tuning, and <inline-formula><mml:math id="inf8"><mml:msub><mml:mover accent="true"><mml:mi>ϵ</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is a residual term, assumed to be Gaussian.</p><p>Alternatively, one can also write down a linear regression model for <italic>x</italic><sub><italic>t</italic></sub> given the history of both neuron X and neuron Y. This <italic>“full model”</italic> is<disp-formula id="equ2"> <label>(2)</label><mml:math id="m2"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <italic>a</italic><sub><italic>q</italic></sub> and <italic>b</italic><sub><italic>q</italic></sub> are the regression coefficients for the contribution of neuron X and Y’s history to neuron X’s current state and <inline-formula><mml:math id="inf9"><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is a residual term, also assumed to be Gaussian.</p><p>The key idea of Granger causality is to compare the residuals between the reduced and the full models. Intuitively, if neuron Y can influence X, including the dynamics of Y will improve the prediction of <italic>x</italic><sub><italic>t</italic></sub>, and hence reduce the residual term. As the reduced model is nested within the full model, to test whether the distributions of the residuals, <inline-formula><mml:math id="inf10"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf11"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ε</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, are significantly different requires a one-way analysis of variance (ANOVA) test carried out by computing the <italic>F</italic>-test statistic:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>Y</mml:mtext><mml:mo>→</mml:mo><mml:mtext>X</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ε</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msup><mml:mi>ε</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mtext>f</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mtext>r</mml:mtext></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:mrow><mml:msup><mml:mi>ε</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mtext>regr</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mtext>f</mml:mtext></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf12"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mtext>regr</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> is the number of time points used in the regression, and <inline-formula><mml:math id="inf13"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mtext>f</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf14"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mtext>r</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> are respectively the number of parameters in the full and reduced models. Under the null hypothesis that including <italic>y</italic><sub><italic>t</italic></sub> does not improve the prediction of <italic>x</italic><sub><italic>t</italic></sub>, and that the noise can be described by Gaussian i.i.d., the F-statistics will follow an F-distribution with defined degrees of freedom, <inline-formula><mml:math id="inf15"><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>F</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mtext>f</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mtext>r</mml:mtext></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mtext>regr</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mtext>f</mml:mtext></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Hence, testing the computed F-statistic <inline-formula><mml:math id="inf16"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>Y</mml:mi><mml:mo>→</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> against the F-distribution will distinguish whether Y significantly Granger-causes X.</p><p>To measure the amount of reduction in the residual, the bivariate Granger causality value (BVGC) is defined as<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mi>G</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mtext>Y</mml:mtext><mml:mo stretchy="false">→</mml:mo><mml:mtext>X</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>≡</mml:mo><mml:mrow><mml:mrow><mml:mo movablelimits="true" form="prefix">max</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mfrac><mml:mrow><mml:mtext>var</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>ε</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>var</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>ε</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo movablelimits="true" form="prefix">max</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mover><mml:mi>ε</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mtext>regr</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mtext>r</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>ε</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mtext>regr</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mtext>f</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where the sample variance requires a correction using the number of samples in the regression (<inline-formula><mml:math id="inf17"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mtext>regr</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>) minus the number of regression parameters (<inline-formula><mml:math id="inf18"><mml:msub><mml:mi>M</mml:mi><mml:mtext>r</mml:mtext></mml:msub></mml:math></inline-formula> or <inline-formula><mml:math id="inf19"><mml:msub><mml:mi>M</mml:mi><mml:mtext>f</mml:mtext></mml:msub></mml:math></inline-formula>). Mathematically, the GC value is related to the <inline-formula><mml:math id="inf20"><mml:mi>F</mml:mi></mml:math></inline-formula>-test statistic through a monotonic transformation:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mtext>Y</mml:mtext><mml:mo>→</mml:mo><mml:mtext>X</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mtext>f</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mtext>r</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mtext>regr</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mtext>f</mml:mtext></mml:msub></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>Y</mml:mtext><mml:mo>→</mml:mo><mml:mtext>X</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mtext>regr</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mtext>f</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mtext>regr</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mtext>r</mml:mtext></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>A significant-only GC value, <inline-formula><mml:math id="inf21"><mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mtext>Y</mml:mtext><mml:mo>→</mml:mo><mml:mtext>X</mml:mtext></mml:mrow><mml:mtext>sig</mml:mtext></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mtext>Y</mml:mtext><mml:mo>→</mml:mo><mml:mtext>X</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is called if the null test of the F-statistics is rejected, and zero otherwise.</p><p>In multi-component systems with more than two variables, one needs to consider the influence of other neurons or of a common stimulus, which we collectively denote by <inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msub><mml:mtext>Z</mml:mtext><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mtext>Z</mml:mtext><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. For example, to analyze a time series of <inline-formula><mml:math id="inf23"><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> neurons <inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">z</mml:mtext></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, one needs to distinguish direct information flow from Y to X, from indirect information flow from Y to Z and from Z to X, or from a common but delayed drive from Z to Y and from Z to X. <xref ref-type="bibr" rid="bib24">Geweke, 1984</xref> extended Granger causality to a multivariate version (MVGC) to measure the conditional dependence between variables. In this case, we explicitly include the variables describing all possible other neurons and external stimuli, <inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">z</mml:mtext></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, as regressed variables in both the reduced model and the full model. The current state of neuron X, <italic>x</italic><sub><italic>t</italic></sub>, now also depends on the past of Z, such that the reduced and the full models become<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>a</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mover><mml:mi>a</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mover><mml:mi>c</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>ε</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>and<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf26"><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf27"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the regression coefficients from the conditioned signal <italic>z</italic><sub><italic>j</italic></sub>. The F-test statistics <inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>Y</mml:mtext><mml:mo stretchy="false">→</mml:mo><mml:mtext>X</mml:mtext><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and the GC values <inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mtext>Y</mml:mtext><mml:mo stretchy="false">→</mml:mo><mml:mtext>X</mml:mtext><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> have identical expression as in <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> and <xref ref-type="disp-formula" rid="equ4">Equation 4</xref>, with the number of parameters adjusted accordingly in the reduced and the full models. The significance test is adjusted using multiple comparisons by applying a Bonferroni correction to the <italic>p</italic>-value threshold.</p><p>It is important to point out that, although GC is based on linear regression of time series, its use is not limited to data generated by linear dynamics. In fact, as long as the data can be approximated by a vector autoregressive process, GC can be useful in revealing the information flow (<xref ref-type="bibr" rid="bib47">Seth et al., 2015</xref>). For analysis of calcium signals, the intrinsic nonlinearity of calcium decay means it is not obvious a priori whether GC can be useful in revealing the information structure. As we will show in the following, the success of information retrieval depends on the details of the biological network, such as the interaction strength between pairs of neurons and the connection density, which leads to a complicated interplay among different timescales, such as the firing rate, the calcium decay time constant, and the time scale of information transfer.</p></sec><sec id="s2-2"><title>GC analysis of a small synthetic neuronal net</title><p>To gain some intuition about how GC identifies links, we test it on synthetic data generated using small networks of 10 neurons, where we pre-define the true connectivity (<xref ref-type="fig" rid="fig1">Figure 1A, B</xref>). One of the simplest types of dynamics is given by the same model that underlies the GC analysis, the vector autoregressive model (VAR), where the neural activities <inline-formula><mml:math id="inf30"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> evolve according to<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>true</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Granger causality (GC) analysis on synthetic data generated from <italic>N</italic> = 10 interconnected neurons of specific connectivity.</title><p>(<bold>A</bold>) The network diagram and (<bold>B</bold>) the connectivity matrix of the model. The excitatory links are represented by arrows in (<bold>A</bold>) and red dots in (<bold>B</bold>). The inhibitory links are represented by short bars in (<bold>A</bold>) and blue dots in (<bold>B</bold>). Time series are generated and analyzed using correlation analysis and GC, using either a vector autoregressive (VAR) process with connection strength <inline-formula><mml:math id="inf31"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1265</mml:mn></mml:mrow></mml:math></inline-formula> (<bold>C–D</bold>), a generalized linear model (GLM) with connection strength <inline-formula><mml:math id="inf32"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula> (<bold>E–F</bold>), and a GLM with calcium filtering as in the experiments (<bold>G–H</bold>). (<bold>D,F,H</bold>) Comparison performance of correlation analysis using trajectory simulated with <italic>T</italic> = 5000 timepointes, bivariate (BVGC) and multivariate (MVGC) GC in predicting the connectivity matrix. True connectivity are indicated with red dots for excitatory links and blue dots for inhibitory links. The error rate of connectivity identification varies as a function of interaction strength <inline-formula><mml:math id="inf33"><mml:mi>c</mml:mi></mml:math></inline-formula> for both the VAR dynamics (<bold>I</bold>) and the GLM-calcium-regressed dynamics (<bold>J</bold>). The multivariate GC always does better at predicting true connectivities than the bivariate (pairwise) GC and than correlation analysis. Error bars in (<bold>I</bold>) and (<bold>J</bold>) are standard deviation across 10 random realizations of the dynamics, each lasting <italic>T</italic> = 5000 timepoints.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>The error rate of connectivity detection as a function of connection strength <inline-formula><mml:math id="inf34"><mml:mi>c</mml:mi></mml:math></inline-formula> and the probability of connection <inline-formula><mml:math id="inf35"><mml:msub><mml:mi>P</mml:mi><mml:mtext>connect</mml:mtext></mml:msub></mml:math></inline-formula>, for VAR dynamics on randomly connected networks of 10 neurons.</title><p>The error rate of connectivity detection as a function of connection strength <inline-formula><mml:math id="inf36"><mml:mi>c</mml:mi></mml:math></inline-formula> and the probability of connection <inline-formula><mml:math id="inf37"><mml:msub><mml:mi>P</mml:mi><mml:mtext>connect</mml:mtext></mml:msub></mml:math></inline-formula>, for VAR dynamics on randomly connected networks of <italic>N</italic> = 10 neurons. Error bars are standard deviation across 20 random realizations of random networks, each with a single simulated trajectory of <italic>T</italic> = 5000 time points.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig1-figsupp1-v2.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>The error rate of connectivity identification as a function of trial duration and connection strength.</title><p>The error rate of connectivity identification varies as a function of trial duration <inline-formula><mml:math id="inf38"><mml:mi>T</mml:mi></mml:math></inline-formula> and connection strength <inline-formula><mml:math id="inf39"><mml:mi>c</mml:mi></mml:math></inline-formula> for VAR and GLM-Calcium dynamics for random networks of <italic>N</italic> = 10 neurons. Error bars are standard deviation across 10 random realizations of the randomly connected network.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig1-figsupp2-v2.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 3.</label><caption><title>The consistency of GC values as a function of trial duration and connection strength.</title><p>The consistency of GC values as a function of trial duration <inline-formula><mml:math id="inf40"><mml:mi>T</mml:mi></mml:math></inline-formula> and connection strength <inline-formula><mml:math id="inf41"><mml:mi>c</mml:mi></mml:math></inline-formula> for VAR dynamics simulated on random networks of <italic>N</italic> = 10 neurons. We measure the consistency of GC values using the Pearson’s correlation coefficient between GC values computed from two realizations of synthetic data generated using the same underlying dynamics. The consistency always improves with longer trial duration and stronger connection strength and is in general better for time series generated using VAR dynamics compared to the ones generated using the non-linear non-gaussian GLM-Calcium dynamics. Error bars are standard deviation across 10 random realizations of the network.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig1-figsupp3-v2.tif"/></fig><fig id="fig1s4" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 4.</label><caption><title>Cross-correlation analysis for synthetic data generated with VAR dynamics reveals the correct interaction structure at the exact delay time difference.</title><p>Cross-correlation analysis for synthetic data generated with VAR dynamics reveals the correct interaction structure at the exact delay time difference. Here, <italic>N</italic> = 10 neurons are simulated for <italic>T</italic> = 5000 time points, the same simulated trajectory as the one used to plot <xref ref-type="fig" rid="fig1">Figure 1CD</xref>. (<bold>A</bold>) Cross-correlation matrix at <inline-formula><mml:math id="inf42"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> The true underlying dynamics has neuron-neuron interaction for <inline-formula><mml:math id="inf43"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> (<bold>B</bold>) Significant cross-correlations are marked by black squares, while the true underlying network is indicated by red dots. (<bold>C</bold>) Links with top absolute value of cross-correlations, with the number of total links matching that of the true underlying connectivity.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig1-figsupp4-v2.tif"/></fig><fig id="fig1s5" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 5.</label><caption><title>Cross-correlation analysis for synthetic data generated with GLM dynamics over-identifies connections.</title><p>Same as <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>, but for synthetic data generated using GLM dynamics with <italic>N</italic> = 10 neurons for <italic>T</italic> = 5000 time points, the exact same simulated dynamics as used to plot <xref ref-type="fig" rid="fig1">Figure 1EF</xref>. Even at the true time difference, <inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, the significant cross-correlation over-identifies true connectivity.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig1-figsupp5-v2.tif"/></fig><fig id="fig1s6" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 6.</label><caption><title>Cross-correlation analysis for synthetic data generated with the GLM-Calcium dynamics cannot identify the underlying structure of connectivity.</title><p>Same as <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>, but for synthetic data generated using GLM-calcium dynamics with <italic>N</italic> = 10 neurons for <italic>T</italic> = 5000 time points, the exact same simulated dynamics as used to plot <xref ref-type="fig" rid="fig1">Figure 1GH</xref>. Cross-correlation cannot identify the underlying structure of connectivity.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig1-figsupp6-v2.tif"/></fig><fig id="fig1s7" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 7.</label><caption><title>Presence of redundant signals harms the performance of MVGC.</title><p>Presence of redundant signals harms the performance of MVGC. GC analysis performed on synthetic data generated using VAR dynamics on the network structure in the main figure, for <italic>N</italic> = 10 neurons for  <inline-formula><mml:math id="inf45"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>5000</mml:mn></mml:mrow></mml:math></inline-formula> data points. GC reveals all links for networks with redundant structures, where an ‘artificial’ neuron 11 is created with identical input and output strength as neuron 1 (<italic>redundant structure, middle column</italic>). However, MVGC fails to identify causal links when the signal from neuron 1 is copied to create another ‘artificial’ neuron 11 (<italic>redundant signal, right most column</italic>). BVGC is able to identify the underlying true connectivity.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig1-figsupp7-v2.tif"/></fig></fig-group><p>where <inline-formula><mml:math id="inf46"><mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a memory kernel capturing the effect from neuron <inline-formula><mml:math id="inf47"><mml:mi>j</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf48"><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:math></inline-formula> on neuron <inline-formula><mml:math id="inf49"><mml:mi>i</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf50"><mml:mi>t</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf51"><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> a Gaussian noise with zero mean and variance <inline-formula><mml:math id="inf52"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>. For simplicity, we assume the memory kernel acts only within the preceding two time steps, <inline-formula><mml:math id="inf53"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mtext>true</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, and set <inline-formula><mml:math id="inf54"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf55"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>q</mml:mi><mml:mo>⩽</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>true</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, and zero, otherwise. <inline-formula><mml:math id="inf56"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the adjacency matrix: <inline-formula><mml:math id="inf57"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if neuron <inline-formula><mml:math id="inf58"><mml:mi>j</mml:mi></mml:math></inline-formula> is directly pre-synaptic to neuron <inline-formula><mml:math id="inf59"><mml:mi>i</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf60"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> otherwise. The sign of interaction <italic>s</italic><sub><italic>j</italic></sub> shows whether neuron <inline-formula><mml:math id="inf61"><mml:mi>j</mml:mi></mml:math></inline-formula> is excitatory (<inline-formula><mml:math id="inf62"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) or inhibitory (<inline-formula><mml:math id="inf63"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>). The parameter <inline-formula><mml:math id="inf64"><mml:mi>c</mml:mi></mml:math></inline-formula> is the connection strength, which we set to be positive. To ensure that the synthetic time series is stationary, we set the number of excitatory cells and inhibitory cells to be equal. The simulation time step is set as the unit time, <inline-formula><mml:math id="inf65"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mtext>sim</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>We apply the GC analysis to synthetic data generated using the VAR model (<xref ref-type="fig" rid="fig1">Figure 1C</xref>) to see if we can recover the true network connectivity. For each neuron pair <inline-formula><mml:math id="inf66"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we compute the BVGC values following <xref ref-type="disp-formula" rid="equ4">Equation 4</xref>, identifying <inline-formula><mml:math id="inf67"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf68"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and computing the regression coefficients <italic>a</italic><sub><italic>q</italic></sub> and <italic>b</italic><sub><italic>q</italic></sub> using the standard least squares method. Analogously, we also compute the MVGC values, using all the remaining neuron signals <inline-formula><mml:math id="inf69"><mml:msub><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo fence="true" stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> as the conditional variables <inline-formula><mml:math id="inf70"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>As shown in <xref ref-type="fig" rid="fig1">Figure 1D</xref>, MVGC successfully identifies all the links. However, the bivariate GC assigns spurious links, as it cannot distinguish direct links from indirect ones. In general, MVGC has a lower false positive rate (identified non-existing links) and false negative rate (missing true links) compared to BVGC when we vary the connection strength <inline-formula><mml:math id="inf71"><mml:mi>c</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1">Figure 1I</xref>). It is interesting to point out that, at small connection strengths, both MVGC and BVGC will fail to identify true links because the signal-to-noise ratio is too small to detect them. In comparison to both GC analyses, the equal-time correlation completely misses the structure (see <xref ref-type="fig" rid="fig1">Figure 1D</xref> and Materials and Methods). While cross-correlation with the lag fixed to the model maximum lag <inline-formula><mml:math id="inf72"><mml:msub><mml:mi>L</mml:mi><mml:mtext>true</mml:mtext></mml:msub></mml:math></inline-formula> performs better, it still fails to reproduce the true connectivity as faithfully as MVGC (see <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>).</p><p>To gain intuition if GC can work for more realistic single-neuron dynamics, which are typically very different from the linear VAR model, we perform the same analysis with dynamics generated with generalized linear models (GLM). We assume the spike count of neuron <inline-formula><mml:math id="inf73"><mml:mi>i</mml:mi></mml:math></inline-formula> at time t, <inline-formula><mml:math id="inf74"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mtext>Poiss</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is governed by a Poisson process with spiking rate <inline-formula><mml:math id="inf75"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>.<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mtext>true</mml:mtext></mml:msub></mml:munderover></mml:mstyle><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:munder></mml:mstyle><mml:mrow><mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf76"><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the base rate for spiking, and the memory kernel <inline-formula><mml:math id="inf77"><mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is identical to the VAR model. We can further convolve the spikes with an exponential decay function to simulate calcium signals (GLM-calcium; see Materials and Methods for details).</p><p>Although the GLM and GLM-calcium dynamics are highly non-linear and non-Gaussian (<xref ref-type="fig" rid="fig1">Figure 1E and G</xref>), MVGC successfully identifies true links (see <xref ref-type="fig" rid="fig1">Figure 1FGJ</xref>). In general, for large correlation strengths, the false negative rate (missing true links) is less than 0.1. Interestingly, for the GLM-calcium model, the false positive rate (identified non-existant links) at large connection strength is smaller than in the VAR model, as is the difference of errors between the MVGC and BVGC. A possible explanation is that for neurons with nonlinear interactions, the propagation of information in indirect links is less well described by linear models in direct links. In comparison, due to large auto-correlation caused by decay of the calcium signal, the correlation and cross-correlation performs much worse for the nonlinear dynamics than for the VAR model (see <xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5</xref> and <xref ref-type="fig" rid="fig1s6">Figure 1—figure supplement 6</xref>).</p><p>This analysis of synthetic data shows that GC can reveal underlying connectivity structures from calcium signals, and that the performance difference between BVGC and MVGC is smaller in nonlinear models.</p><p>In the brain, a population of neurons can encode redundant signals. If the redundancy is in the structure of the network, for example, when two neurons share the identical input and output, the stochasticity will lead to different neuronal dynamics, and MVGC is able to identify the true connection. However, if two neurons have exactly the same activity, MVGC will underestimate the causality, while BVGC still reveal these connections (see <xref ref-type="fig" rid="fig1s7">Figure 1—figure supplement 7</xref>).</p><p>In GC analysis, it is essential to choose the maximum time lag <inline-formula><mml:math id="inf78"><mml:mi>L</mml:mi></mml:math></inline-formula>. If the maximum time lag <inline-formula><mml:math id="inf79"><mml:mi>L</mml:mi></mml:math></inline-formula> is much less than the true interaction timescale <inline-formula><mml:math id="inf80"><mml:msub><mml:mi>L</mml:mi><mml:mtext>true</mml:mtext></mml:msub></mml:math></inline-formula>, then the reconstructed information flow will be incomplete. On the other hand, if <inline-formula><mml:math id="inf81"><mml:mi>L</mml:mi></mml:math></inline-formula> is too large, we will run into the risk of overfitting. Here, we briefly discuss the effect of the maximum lag <inline-formula><mml:math id="inf82"><mml:mi>L</mml:mi></mml:math></inline-formula> on the resulting GC network, using data generated by the synthetic network given by <xref ref-type="fig" rid="fig1">Figure 1A</xref>, simulated with VAR dynamics with true maximum lag <inline-formula><mml:math id="inf83"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mtext>true</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>As we vary <inline-formula><mml:math id="inf84"><mml:mi>L</mml:mi></mml:math></inline-formula>, the maximum time lag used in the GC regression models, we observe that increasing the maximum time lag does not always improve our ability to identify the network connectivity (<xref ref-type="fig" rid="fig2">Figure 2A, B</xref>). Going beyond the true maximum time lag leads to errors, increases both the false positive rate (<xref ref-type="fig" rid="fig2">Figure 2</xref>) and the false negative rate (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). Compared to MVGC, BVGC is more prone to detect spurious links, even at the correct maximum time lag.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Bivariate and multivariate GC analyses of motoneuron calcium imaging recordings in a zebrafish embryo do not match expected ipsilateral and rostral to caudal information flow.</title><p>(<bold>A</bold>) Effect of the maximum lag <inline-formula><mml:math id="inf85"><mml:mi>L</mml:mi></mml:math></inline-formula> on the false positive rate, that is the proportion of spurious positive links over all negative links, on synthetic data (VAR) with a true lag of 3, for BVGC (<italic>purple</italic>) and MVGC <italic>(green</italic>). BVGC is more prone to detect spurious links, even at the correct lag. (<bold>B</bold>) The false negative rate, that is the proportion of missed positive links over all positive links, is very sensitive to the choice of the lag. If the chosen lag is very different compared to the true lag, many links will not be detected. (<bold>C,D</bold>) Effect of the lag on the average GC values for synthetic (<bold>C</bold>) and real motoneuron (<bold>D</bold>) data (<italic>N</italic> = 11 neurons, <xref ref-type="bibr" rid="bib15">De Vico Fallani et al., 2014</xref>). Using the average GC value, we choose a lag of 3 for the motoneuron data analysis, corresponding to 750ms. Further supporting evidence for choosing <inline-formula><mml:math id="inf86"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> is given by the correlation analysis of GC values using different lags in <xref ref-type="fig" rid="fig1">Figure 1</xref>. Error bars in (A), (B) and (C) are standard deviation across 10 random realizations of the simulated dynamics with <italic>T</italic> = 4000 on the network (N = 10 neurons) specified by Figure1A. Error bars in (D) correspond to the standard deviation of the average GC value across the ten recordings of the motoneuron dataset. (<bold>E</bold>) Dorsal view of the embryonic zebrafish and positions of the left (<bold>L</bold>) and right (<bold>R</bold>) motoneurons targeted in calcium imaging (<italic>colored circles</italic>). The arrows represent the wave of activity, propagating ipsilaterally from the rostral (Ro) spinal cord to the caudal (<bold>C</bold>) spinal cord. (<bold>F</bold>) Mean image of a 30-somite stage embryonic zebrafish <italic>Tg(s1020t:Gal4; UAS:GCaMP3</italic>), dataset <italic>f3t2</italic> in <xref ref-type="bibr" rid="bib15">De Vico Fallani et al., 2014</xref>, with motoneurons selected for analysis shown in color. (<bold>G</bold>) Fluorescence signals (proxy for calcium activity) of selected neurons. We observe an oscillating pattern of activation of the left vs right motoneurons. (<bold>H</bold>) Representation of the motorneuron flow of information as a directed graph as would be ideally defined by bivariate (<italic>left</italic>) and multivariate (<italic>right</italic>) GC analyses. (<bold>I</bold>) Resulting directed networks for bivariate (<italic>left</italic>) and multivariate (<italic>right</italic>) GC analyses of fluorescence traces of (<bold>G</bold>) at maximum lag <inline-formula><mml:math id="inf87"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>: we observe different networks than expected, both for BVGC and MVGC. This is consistent with the effect observed in (<bold>A</bold>), that BVGC detects many spurious links.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Comparison of Granger causality analysis results at different maximum lags.</title><p>Comparison of Granger causality analysis results at different maximum lags. Correlation between the GC values obtained for each pair of neurons using max lag <inline-formula><mml:math id="inf88"><mml:mi>L</mml:mi></mml:math></inline-formula> and max lag <inline-formula><mml:math id="inf89"><mml:mrow><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. All fish (n=9) of the motoneuron data set are used and represented by color (same as in <xref ref-type="fig" rid="fig7">Figure 7</xref>). The similarity in Granger causality values, measured by the Pearson correlation coefficient <inline-formula><mml:math id="inf90"><mml:mi>r</mml:mi></mml:math></inline-formula>, increases as <inline-formula><mml:math id="inf91"><mml:mi>L</mml:mi></mml:math></inline-formula> increases and then stabilizes after maximum lag <inline-formula><mml:math id="inf92"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf93"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.97</mml:mn></mml:mrow></mml:math></inline-formula> both for BVGC and MVGC between <inline-formula><mml:math id="inf94"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf95"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>, as well as between <inline-formula><mml:math id="inf96"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf97"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>), justifying our decision to use <inline-formula><mml:math id="inf98"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>. Using a larger maximum lag does not bring more information but brings more complexity, and increases the computation time (especially for MVGC).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Validation of trial length sufficiency by high correlation of Granger causality values using the first and second halves of the motoneuron data.</title><p>Validation of trial length sufficiency by high correlation of Granger causality values using the first and second halves of the motoneuron data. Correlation between the GC values obtained for each pair of neurons using either the first or the second half of the calcium traces. Each color represents a different fish (n=9). The BVGC (<italic>left</italic>) and MVGC (<italic>right</italic>) results are similar (Pearson correlation coefficient) suggesting that the length of the whole time series (1000 time steps) is sufficient and appropriate to apply GC analysis (on smoothed <inline-formula><mml:math id="inf99"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, motion artifacts removed). The correlation is particularly for the number of time points and neurons high due to the cyclic pattern of neuronal activity leading to two very similar halves.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig2-figsupp2-v2.tif"/></fig></fig-group><p>Interestingly, we observe that the average GC value as a function of the number of maximum lags can be used to identify the true maximum time lag <inline-formula><mml:math id="inf100"><mml:msub><mml:mi>L</mml:mi><mml:mtext>true</mml:mtext></mml:msub></mml:math></inline-formula>. As shown by <xref ref-type="fig" rid="fig2">Figure 2</xref>, both the average BVGC and MVGC values increase steeply as <inline-formula><mml:math id="inf101"><mml:mi>L</mml:mi></mml:math></inline-formula> approaches the true maximum lag, and reach a plateau for a few maximum lag values before overfitting significantly increases the average GC values. Based on this observation, we select the maximum time lag to be the knee of the average GC value as a function of the maximum lag, as this maximum time lag captures enough information flow while the number of fitted parameters is kept as small as possible.</p></sec><sec id="s2-3"><title>GC analysis of motoneuron data</title><sec id="s2-3-1"><title>The data</title><p>In order to test the performance of Granger causality on population calcium imaging data, we focus our analyses on previously published calcium transients in motoneurons of embryonic zebrafish (<italic>Tg(s1020t:Gal4; UAS:GCaMP3</italic>), data published in <xref ref-type="bibr" rid="bib15">De Vico Fallani et al., 2014</xref>), where the underlying structure of information flow is known. The calcium transients were recorded using fluorescent tags <italic>in vivo</italic> for 250 s at 4 Hz and with single-cell resolution, in ventral spinal cord motoneurons while the zebrafish was showing spontaneous coiling activity of its tail (<xref ref-type="fig" rid="fig2">Figure 2E–G</xref>). During these fictive coiling events, the activity of motoneurons follows a wave from the rostral to the caudal side of the spinal cord (<xref ref-type="bibr" rid="bib8">Buss and Drapeau, 2001</xref>; <xref ref-type="bibr" rid="bib34">Masino and Fetcho, 2005</xref>; <xref ref-type="bibr" rid="bib59">Warp et al., 2012</xref>). Upon activation along the rostrocaudal axis, spinal motoneurons that project to the axial skeletal muscle fibers elicit a rostrocaudal wave of muscle contractions that alternates between the left and right side of the body and propels fish forward. Accordingly, the calcium signals show steady oscillations alternating between the left and right sides of the spinal cord, leading to left-right muscle activation (<xref ref-type="fig" rid="fig2">Figure 2G</xref>). We use this data set in order to see if we recover the expected sequential information flow, from the rostral spinal cord to the caudal spinal cord (arrows in <xref ref-type="fig" rid="fig2">Figure 2EF</xref>, networks in <xref ref-type="fig" rid="fig2">Figure 2H</xref>).</p><p>To encode the underlying information structure of the neuronal network, we label the recorded <inline-formula><mml:math id="inf102"><mml:mi>N</mml:mi></mml:math></inline-formula> neurons with index <inline-formula><mml:math id="inf103"><mml:mi>i</mml:mi></mml:math></inline-formula>, and the side of the neurons by <inline-formula><mml:math id="inf104"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mtext>L</mml:mtext><mml:mo>,</mml:mo><mml:mtext>R</mml:mtext><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Assume that there are <inline-formula><mml:math id="inf105"><mml:msub><mml:mi>N</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula> neurons in the left chain and <inline-formula><mml:math id="inf106"><mml:msub><mml:mi>N</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> neurons in the right chain, we order the indices such that the odd neurons are found on the left side, with <inline-formula><mml:math id="inf107"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>L</mml:mtext></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf108"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and the neurons with <inline-formula><mml:math id="inf109"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> are found in the right chain with <inline-formula><mml:math id="inf110"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>R</mml:mtext></mml:mrow></mml:math></inline-formula>. The indices are then ordered by the neurons position along each of the two chains, such that if <inline-formula><mml:math id="inf111"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, neuron <inline-formula><mml:math id="inf112"><mml:mi>i</mml:mi></mml:math></inline-formula> is more rostral than neuron <inline-formula><mml:math id="inf113"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> if <inline-formula><mml:math id="inf114"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. The fluorescence signal for the <inline-formula><mml:math id="inf115"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>-th cell at time <inline-formula><mml:math id="inf116"><mml:mi>t</mml:mi></mml:math></inline-formula> is denoted by <inline-formula><mml:math id="inf117"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, or equivalently by <inline-formula><mml:math id="inf118"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> to represent the normalized fluorescence activity.</p><p>We will compute the GC network for multiple trials of calcium transients recorded in five fishes. Following the nomenclature of the dataset published in <xref ref-type="bibr" rid="bib15">De Vico Fallani et al., 2014</xref>, we refer to the dataset recorded for fish <inline-formula><mml:math id="inf119"><mml:mi>A</mml:mi></mml:math></inline-formula> and trial <inline-formula><mml:math id="inf120"><mml:mi>B</mml:mi></mml:math></inline-formula> as <inline-formula><mml:math id="inf121"><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula>; for example, <inline-formula><mml:math id="inf122"><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> denotes trial number 2 recorded for fish number 3. From the dataset, we exclude recordings for fish number 2 because the recorded time is 2 min, much less than that of the other recordings of 4 min.</p></sec><sec id="s2-3-2"><title>Naive GC</title><p>We apply the GC algorithm as described in Granger Causality to the calcium transients observed in embryonic motoneurons, and reproduce the results obtained in <xref ref-type="bibr" rid="bib15">De Vico Fallani et al., 2014</xref> for the dataset <italic>f3t2</italic>. We choose the maximum time lag at the knee of average GC value, <inline-formula><mml:math id="inf123"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, corresponding to a duration of 750 ms, for both BVGC and MVGC analysis (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). This knee corresponds to the maximum lag with the best balance between accuracy and complexity: further increasing the maximum lag yields very similar results but the GC analysis becomes much more computationally expensive (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). In order to verify that the length of the motoneuron dataset is sufficient to estimate the functional connectivity using Granger causality (see <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref> and <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref> for illustrations using synthetic data), we compared the two networks obtained by applying GC analysis to each half of the calcium imaging time series. The Pearson correlation coefficient between the GC values from the two halves is 0.87 for BVGC, and 0.75 for MVGC (see <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>), indicating the trial length is long enough for a consistent estimation of the GC values.</p><p>The GC network is then represented by directed graphs (<xref ref-type="fig" rid="fig2">Figure 2I</xref>). The nodes of the graph represent the motoneurons and the circle size is proportional to the <italic>nodal delta centrality</italic> as defined by <xref ref-type="bibr" rid="bib15">De Vico Fallani et al., 2014</xref>: the larger the circle, the more central is the neuron in terms of its tendency to act as a transmitter hub (red color, positive value) or receiver hub (blue color, negative value) of information flow. Arrows display the functional connectivity links, that is the flow of information from one neuron to another. In the expected network assuming perfect information flow (<xref ref-type="fig" rid="fig2">Figure 2H</xref>), all the links are ipsilateral and represent rostrocaudal information flow.</p><p>Compared to <xref ref-type="bibr" rid="bib15">De Vico Fallani et al., 2014</xref>, we identify the same functional connectivity matrices yielding the same connectivity networks. While the previous study focuses on recovering ipsilateral links and ignores contralateral links (depicted in dim gray in the network figures, see <xref ref-type="bibr" rid="bib15">De Vico Fallani et al., 2014</xref>), we investigate all contralateral links and ipsilateral links (<xref ref-type="fig" rid="fig2">Figure 2I</xref>) as we aim to study why spurious contralateral connections occur. We represented the statistically significant direct GC links by arrows, proportional in size and color intensity to the GC value. The networks resulting from the GC analyses both for BVGC and MVGC show many other links than just rostrocaudal ones on either side.</p><p>In the MVGC analysis however, one would have expected only direct links to be significant, since conditioning on the other neuronal signals should prevent indirect links from being significant. This expectation is very different from the MVGC network in <xref ref-type="fig" rid="fig2">Figure 2I</xref>, where spurious contralateral links prevails.</p><p>Nonetheless, it is well known that MVGC is sensitive to additive noise, lack of data points, etc. To assess the impact of these artifacts on the resulting GC networks for motoneuron data, we define measures of information flows as following.</p></sec><sec id="s2-3-3"><title>Defining directional biases</title><p>The sequential and bi-axial information flow in the motoneuron network provides an excellent testing ground for GC. Specifically for the motoneuron datasets, to quantify the success of reconstructing the information flow in the motoneuron network, and to compare the information flow across different motoneuron datasets, we define the following measures of directional biases. First, we define the ratio of normalized total weights of ipsilateral links compared to all links<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mtext>IC</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>≠</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf124"><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the Granger causality values between neurons <inline-formula><mml:math id="inf125"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf126"><mml:mi>j</mml:mi></mml:math></inline-formula>. If all connections are equal, then <inline-formula><mml:math id="inf127"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mtext>IC</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>. We also define the ratio of ipsilateral rostral-to-caudal links compared to all ipsilateral links as<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mtext>RC</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This ratio gives a measure of the directionality of information flow. A bias in rostrocaudal links results in a departure from <inline-formula><mml:math id="inf128"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mtext>RC</mml:mtext></mml:msub><mml:mo>∼</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>. Notice that based on the anatomy, the ground truth of information flow can be smaller than <inline-formula><mml:math id="inf129"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mtext>IC</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, because motoneuron activity has been shown to rely on command neurons in the brainstem that activate motoneurons sequentially in the spinal cord, not on motor neurons synapsing onto each other. With the two measures of directional biases of information flow, now we proceed to develop an improved pipeline for GC analysis. Using different datasets of the embryonic motoneurons as examples, we will show how to improve GC to analyze calcium transients of neuronal populations. Our goal is to recover a more biologically reasonable information flow compared to the naive GC network.</p><p>These measures are only constructed for the motoneuron networks. For more general networks with known structures, one can use the distance between the true and the GC-learned connectivity matrix to test the efficacy of the GC method. For networks with unknown structure, one can compare the GC-learned information flow by using different partitions of the data.</p></sec><sec id="s2-3-4"><title>Correcting for motion artifacts</title><p>In calcium imaging experiments, small movements of the animal body or the experimental setup can result in artificial fluorescence changes in the recording. In the calcium transients of data <italic>f3t1</italic>, we observe a big drop in fluorescence at a single time point out of 1000 (<xref ref-type="fig" rid="fig3">Figure 3B</xref> top panel) in the calcium traces of all neurons in the recording. As seen in the top panels <xref ref-type="fig" rid="fig3">Figure 3C</xref>, this is sufficient to corrupt the results of the GC analyses: neuron 10 (<xref ref-type="fig" rid="fig3">Figure 3A</xref>) appears to drive almost all other neurons, including contralateral neurons. We correct the motion artifact by setting the outlying time point’s fluorescence value to the average of the previous and next values (<xref ref-type="fig" rid="fig3">Figure 3B</xref> bottom panel). The strongly dominant drive by neuron 10 disappears (<xref ref-type="fig" rid="fig3">Figure 3C</xref> bottom panels) and <inline-formula><mml:math id="inf130"><mml:msub><mml:mi>W</mml:mi><mml:mtext>IC</mml:mtext></mml:msub></mml:math></inline-formula> increases from 0.39 to 0.66 for BVGC and from 0.43 to 0.68 for MVGC (<xref ref-type="table" rid="table1">Table 1</xref>). This shows that GC analysis is sensitive to artifacts at single time points.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>One time-point artifact or one noisy neuron fluorescence trace is sufficient to corrupt the GC algorithm.</title><p>(<bold>A</bold>) Mean image of a 30-somite stage larval zebrafish <italic>Tg(s1020t:Gal4; UAS:GCaMP3</italic>), dataset <italic>f3t1</italic> in <xref ref-type="bibr" rid="bib15">De Vico Fallani et al., 2014</xref>, with neurons selected for analysis shown in color. (<bold>B</bold>) Fluorescences traces of neurons of (<bold>A</bold>). <italic>Top:</italic> A motion artifact consisting of a drop in fluorescence at a single time point is present (star). <italic>Bottom:</italic> the motion artifact is corrected as being the mean of the two surrounding time points. (<bold>C</bold>) Directed graph resulting from the bivariate (<italic>left</italic>) and multivariate (<italic>right</italic>) GC analysis, before (<italic>top</italic>) and after (<italic>bottom</italic>) motion artifact correction. Before the correction, the neuron with the smallest activity appears to drive many other neurons, perhaps due to its lower SNR. This spurious dominant drive disappears once the motion artifact is corrected, demonstrating that GC is not resilient to artifacts as small as one time point out of one thousand. (<bold>D</bold>) Mean image of a 30-somite stage larval zebrafish <italic>Tg(s1020t:Gal4; UAS:GCaMP3</italic>), dataset <italic>f5t2</italic> in <xref ref-type="bibr" rid="bib15">De Vico Fallani et al., 2014</xref>, with neurons selected for analysis shown in color. The fluorescence traces (<bold>E</bold>) of neurons displayed in red exhibit activity patterns different from the oscillatory pattern expected in motorneurons. GC analysis was run after removal of these neurons. (<bold>F</bold>) Directed graph resulting from the bivariate (<italic>left</italic>) and multivariate (<italic>right</italic>) GC analysis, before (<italic>top</italic>) and after (<italic>bottom</italic>) removing neuron 13 and neuron 21.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Re-scaled calcium transients exhibits a typical exponential decay with time constant <inline-formula><mml:math id="inf131"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>2.5</mml:mn><mml:mo>⁢</mml:mo><mml:mtext>s</mml:mtext></mml:mrow></mml:mrow></mml:math></inline-formula>, while atypical transients exhibit a slower decay.</title><p>Overlaid and re-scaled calcium signals from the motoneuron experiment (dataset <italic>f5t1</italic> from <xref ref-type="bibr" rid="bib15">De Vico Fallani et al., 2014</xref>) shows the typical decay of calcium transients (overlay of calcium transients from 4 neurons) can be well approximated by an exponential function with time constant <inline-formula><mml:math id="inf132"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>2.5</mml:mn><mml:mo>⁢</mml:mo><mml:mtext>s</mml:mtext></mml:mrow></mml:mrow></mml:math></inline-formula>, while atypical calcium transients exhibit a slower decay.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig3-figsupp1-v2.tif"/></fig></fig-group><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>The directional measures for the bivariate and multivariate GC network for the calcium transients <italic>f3t1</italic> before and after motion-artifact correction, a pre-processing step for calcium signals.</title><p>The GC network after motion artifact correction has clear ipsilateral structures.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top"/><th align="left" valign="top" colspan="2">BVGC</th><th align="left" valign="top" colspan="2">MVGC</th></tr></thead><tbody><tr><td align="left" valign="top"/><td align="left" valign="top"><inline-formula><mml:math id="inf133"><mml:msub><mml:mi>W</mml:mi><mml:mtext>IC</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="top"><inline-formula><mml:math id="inf134"><mml:msub><mml:mi>W</mml:mi><mml:mtext>RC</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="top"><inline-formula><mml:math id="inf135"><mml:msub><mml:mi>W</mml:mi><mml:mtext>IC</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="top"><inline-formula><mml:math id="inf136"><mml:msub><mml:mi>W</mml:mi><mml:mtext>RC</mml:mtext></mml:msub></mml:math></inline-formula></td></tr><tr><td align="left" valign="top">Before MA correction</td><td align="char" char="." valign="top">0.39</td><td align="char" char="." valign="top">0.53</td><td align="char" char="." valign="top">0.43</td><td align="char" char="." valign="top">0.52</td></tr><tr><td align="left" valign="top">After MA correction</td><td align="char" char="." valign="top">0.66</td><td align="char" char="." valign="top">0.56</td><td align="char" char="." valign="top">0.68</td><td align="char" char="." valign="top">0.44</td></tr></tbody></table></table-wrap><p>The motion artifact is a global noise on the observed neurons, a source that is well-known to create spurious GC links (<xref ref-type="bibr" rid="bib58">Vinck et al., 2015</xref>; <xref ref-type="bibr" rid="bib37">Nalatore et al., 2007</xref>). After careful examination of the calcium traces, we notice that the dominant neuron before motion-artifact correction, neuron 10, is characterized by its small dynamic range. Because the rest of the activity is low for neuron 10 and that a single time point seems to have a strong effect on other calcium traces, GC links driven by this neuron are high. We looked at other recordings containing a motion artifact and found that removing it did not always eliminate the spurious dominant neurons. The larger the artifact, the better we eliminate the spurious links: in <xref ref-type="fig" rid="fig3">Figure 3</xref>, the artifact represents a deviation of about 80% of the <inline-formula><mml:math id="inf137"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and its impact on GC links is large. When the deviation is lower, the strong spurious links are not necessarily due to the motion artifact, therefore removing the artifact does not improve the expected network results.</p></sec><sec id="s2-3-5"><title>Removing strange neurons</title><p>In order to improve the GC analysis results, we want to keep only clean calcium signals and remove the uncharacteristically behaving whose activities do not follow the stereotypical profiles of rise and falls. This is especially important for the MVGC analysis, in which traces of all other neurons are considered in the calculation of a GC value between two given neurons. Although BVGC values are not affected by neurons outside of the observed pair, having extra neurons might also influence the network structure through the GC values of the links.</p><p>In general, cells whose calcium transients showed time decay of tens of seconds were identified as non neuronal cells and excluded from GC analysis (see overlays of calcium transients in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). In the embryonic zebrafish traces <italic>f5t2</italic>, shown in <xref ref-type="fig" rid="fig3">Figure 3E</xref>, we remove neuron 13 (<xref ref-type="fig" rid="fig3">Figure 3D</xref>) that displays only one long calcium transient lasting for tens of seconds, and neuron 21, which does not exhibit an oscillating pattern.</p><p>GC networks are drawn for the neuronal populations before (<xref ref-type="fig" rid="fig3">Figure 3F</xref> top panels) and after removal of these outlier neurons (<xref ref-type="fig" rid="fig3">Figure 3F</xref> bottom panels). Before the removal, neuron 21 appears to drive many other neurons, likely due to its lower signal-to-noise ratio (SNR) and the correlated noise between calcium traces. Once removed, <inline-formula><mml:math id="inf138"><mml:msub><mml:mi>W</mml:mi><mml:mtext>RC</mml:mtext></mml:msub></mml:math></inline-formula> increases, meaning that a mostly rostrocaudal propagation is observed, as information in motoneurons flows from the rostral to the caudal spinal cord (<xref ref-type="table" rid="table2">Table 2</xref>). We also observe a small decrease in <inline-formula><mml:math id="inf139"><mml:msub><mml:mi>W</mml:mi><mml:mtext>IC</mml:mtext></mml:msub></mml:math></inline-formula> upon removal of neuron 21, due to the fact that the ipsilateral links going out from neuron 21 are not present anymore, but spurious contralateral links remain.</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>The directional measures for the bivariate and multivariate GC network for the calcium transients <italic>f5t2</italic> before and after removal of the atypical neurons.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top"/><th align="left" valign="top" colspan="2">BVGC</th><th align="left" valign="top" colspan="2">MVGC</th></tr></thead><tbody><tr><td align="left" valign="top"/><td align="left" valign="top"><inline-formula><mml:math id="inf140"><mml:msub><mml:mi>W</mml:mi><mml:mtext>IC</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="top"><inline-formula><mml:math id="inf141"><mml:msub><mml:mi>W</mml:mi><mml:mtext>RC</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="top"><inline-formula><mml:math id="inf142"><mml:msub><mml:mi>W</mml:mi><mml:mtext>IC</mml:mtext></mml:msub></mml:math></inline-formula></td><td align="left" valign="top"><inline-formula><mml:math id="inf143"><mml:msub><mml:mi>W</mml:mi><mml:mtext>RC</mml:mtext></mml:msub></mml:math></inline-formula></td></tr><tr><td align="left" valign="top">With strange neurons</td><td align="char" char="." valign="top">0.56</td><td align="char" char="." valign="top">0.51</td><td align="char" char="." valign="top">0.59</td><td align="char" char="." valign="top">0.38</td></tr><tr><td align="left" valign="top">Without strange neurons</td><td align="char" char="." valign="top">0.54</td><td align="char" char="." valign="top">0.67</td><td align="char" char="." valign="top">0.53</td><td align="char" char="." valign="top">0.53</td></tr></tbody></table></table-wrap></sec><sec id="s2-3-6"><title>Smoothing</title><p>One known limitation of traditional Granger causality analysis is its sensitivity to noise, especially correlated noise across variables (<xref ref-type="bibr" rid="bib58">Vinck et al., 2015</xref>; <xref ref-type="bibr" rid="bib37">Nalatore et al., 2007</xref>). In empirical calcium imaging data, correlated noise is common due to system-wise measurement noise and spurious correlations coming from the slow sampling rate.</p><p>To illustrate the problem of the noise, we return to the synthetic models in Granger Causality, a simulated system of 10-neurons with the VAR and the GLM-calcium dynamics, where the true underlying signal is <inline-formula><mml:math id="inf144"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, for each neuron <inline-formula><mml:math id="inf145"><mml:mi>i</mml:mi></mml:math></inline-formula>. We add a system-wide noise, such that the noise-corrupted signal is<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>ζ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>and <inline-formula><mml:math id="inf146"><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is Gaussian white noise, with <inline-formula><mml:math id="inf147"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf148"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>ζ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>ζ</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. As shown in <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref> and <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>, large correlated noise significantly decreases the ability of the Granger causality analysis to identify true connections.</p><p>We exploit the stereotypical shape of calcium signals – a fast onset and a slow decay – to parametrize the structure of the noise for empirical calcium signals. We assume that any correlation in the decay phase is the correlation of the noise. Additionally, we apply <italic>total variation differentiation regularization</italic> to denoise the fluorescence time series for each neuron (<xref ref-type="bibr" rid="bib12">Chen et al., 2019</xref>) (see Materials and Methods and <xref ref-type="bibr" rid="bib11">Chartrand, 2011</xref> for details). Briefly, for each neuronal signal <inline-formula><mml:math id="inf149"><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, total variation differentiation regularization assumes the noise is Gaussian and white, and that the temporal variations in the derivative are exponentially distributed and only weekly correlated in time, which is well-suited to describe calcium data with episodes of continuous firing and continuous silence. Compared to usual total variation denoising that regulates the temporal variations in the signal, regulating the variation of the derivative is better at detecting sudden change of the signal strength, and is better at keeping the causality when applied to multivariate signals. As an example, <xref ref-type="fig" rid="fig4">Figure 4</xref> shows the original and the smoothed fluorescence signal for two neurons in the same fish (dataset <italic>f3t2</italic> from <xref ref-type="bibr" rid="bib15">De Vico Fallani et al., 2014</xref>), as well as the residual noise. The noise in the motoneuron is correlated with correlation coefficients close to 1 for some pairs of neurons (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). The large correlated noise is likely the cause of our problematic results in the MVGC analysis (see <xref ref-type="fig" rid="fig2">Figure 2E</xref> and <xref ref-type="fig" rid="fig4">Figure 4C</xref>). Denoising the calcium time series before the GC analysis eliminates links, especially in the MVGC approach (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). The signal as quantified in terms of the relative weight of ipsilateral links <inline-formula><mml:math id="inf150"><mml:msub><mml:mi>W</mml:mi><mml:mtext>IC</mml:mtext></mml:msub></mml:math></inline-formula> is also closer to the biological expectation (<inline-formula><mml:math id="inf151"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mtext>IC</mml:mtext></mml:msub><mml:mo>∼</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) than before smoothing, with MVGC giving better results (<xref ref-type="fig" rid="fig4">Figure 4D</xref>).</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Smoothing the calcium imaging signal can improve the accuracy of GC.</title><p>(<bold>A</bold>) We smooth the noisy calcium imaging signal <inline-formula><mml:math id="inf152"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> using total-variational regularization (see Materials and Methods), and plot the example traces of the original and the smoothened neuronal signals, and the residual noise, using the dataset <italic>f3t2</italic> (<italic>N</italic> = 11 neurons) from <xref ref-type="bibr" rid="bib15">De Vico Fallani et al., 2014</xref>. (<bold>B</bold>) The Pearson correlation coefficient shows the residual noise is correlated. (<bold>C</bold>) GC networks constructed using the original noisy calcium signal compared to ones using the smoothed signal for motorneurons. (<bold>D</bold>) Weight of ipsilateral GC links, <inline-formula><mml:math id="inf153"><mml:msub><mml:mi>W</mml:mi><mml:mtext>IC</mml:mtext></mml:msub></mml:math></inline-formula>, and the weight of rostal-to-cordal links, <inline-formula><mml:math id="inf154"><mml:msub><mml:mi>W</mml:mi><mml:mtext>RC</mml:mtext></mml:msub></mml:math></inline-formula>, for the original calcium signals and smoothened signals. We expect <inline-formula><mml:math id="inf155"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mtext>IC</mml:mtext></mml:msub><mml:mo>∼</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and a null model with no bias for where the links are placed will have <inline-formula><mml:math id="inf156"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mtext>IC</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>. The <italic>x</italic>-axis is sorted using the <inline-formula><mml:math id="inf157"><mml:msub><mml:mi>W</mml:mi><mml:mtext>IC</mml:mtext></mml:msub></mml:math></inline-formula> value for bivariate GC analysis with the original calcium data. Data points are connected with lines to guide the eye. The bivariate GC results are plotted with purple circles, and the multivariate GC results with green diamonds. GC analysis results using the original noisy fluroscence signals are shown with empty markers, while the results from first smoothed data are shown with filled markers.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Cross-correlation of the residual noise after smoothing.</title><p>The Pearson correlation coefficient shows that the residual noise carries signals of information flow, after the original calcium signals are smoothen, using the dataset f3t2 from <xref ref-type="bibr" rid="bib15">De Vico Fallani et al., 2014</xref> as an example (<italic>N</italic> = 11 neurons). Top-left panel is identical as <xref ref-type="fig" rid="fig4">Figure 4B</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig4-figsupp1-v2.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>Correlated noise increases the error of Granger causality analysis for synthetic data generated by VAR dynamics.</title><p>Correlated noise increases the error of Granger causality analysis, exemplified by synthetic data generated by VAR dynamics and corrupted by a system-wide shared noise for <italic>N</italic> = 10 neurons and <italic>T</italic> = 4000 time points, with connection strength <italic>c</italic> = 0.1265. (<bold>A</bold>) Example traces for VAR dynamics added with shared noise with increasing strength. (<bold>B</bold>) The error of GC analysis increases as the amplitude of the shared noise increases. Error bars are standard deviation across 10 random simulated trajectories of the same network, each corrupted by adding a realization of randomly generated noise.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig4-figsupp2-v2.tif"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 3.</label><caption><title>Correlated noise increases the error of Granger causality analysis for synthetic data generated by GLM-calcium dynamics.</title><p>Same as <xref ref-type="fig" rid="fig2">Figure 2</xref>, but for data generated with GLM-calcium dynamics for N = 10 neurons, a connection strength of c = 1, and for duration T = 4000. Error bars are standard deviation across 10 realizations of simulation.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig4-figsupp3-v2.tif"/></fig><fig id="fig4s4" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 4.</label><caption><title>Spectral Granger-causality does not improve information flow detection for the original, not pre-smoothened data.</title><p>Spectral Granger-causality (computed using the <xref ref-type="bibr" rid="bib2">Barnett and Seth, 2014</xref>). Results for motoneurons (dataset <italic>f6t1</italic>, <italic>N</italic> = 12 neurons) reveals more structre when applied to smoothened fluorescence data compared to the raw fluorescence signal. The top row shows the ipsilatarel links in solid curves, and contralateral links in dashes. The top row shows the rostral-to-caudal links in solid curves, and caudal-to-rostral links in dashes. The last row shows the weighted ipsilateral ratio <inline-formula><mml:math id="inf158"><mml:msub><mml:mi>W</mml:mi><mml:mtext>IC</mml:mtext></mml:msub></mml:math></inline-formula> and the weighted rostral-to-caudal ratio <inline-formula><mml:math id="inf159"><mml:msub><mml:mi>W</mml:mi><mml:mtext>RC</mml:mtext></mml:msub></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig4-figsupp4-v2.tif"/></fig></fig-group><p>We note that total variation regularization is a global denoising method that acts on the entire time series. Different from a low-pass filter, total variation regularization is able to keep the fine structure of the fast rise in the calcium signal, while smoothing out the noise. Nonetheless, the assumption is that the noise is Gaussian, which should be verified before smoothing the data by examining the high-frequency end of the signal’s power spectrum. To address the problem of high-frequency correlated noise, one may propose to use spectral Granger causality (<xref ref-type="bibr" rid="bib23">Geweke, 1982</xref>; <xref ref-type="bibr" rid="bib24">Geweke, 1984</xref>), and only focus on the resulting GC values at low frequencies. However, we show that spectral GC applied to the unsmoothed calcium signal is unable to recover the information flow for any of the frequencies (<xref ref-type="fig" rid="fig4s4">Figure 4-figure supplement 4</xref>). Finally, in cases where correlated noise cannot be removed, there are alternative methods to reject false links, for example using Granger causality computed on the time-reversed data as the null hypothesis (<xref ref-type="bibr" rid="bib58">Vinck et al., 2015</xref>).</p></sec><sec id="s2-3-7"><title>Slow calcium timescale</title><p>One potential pitfall of performing Granger causality analysis on single-cell calcium signals is that the timescale of the calcium indicator and the sampling are typically much slower than that of the information transfer. The onset of calcium signals can occur in few milliseconds, comparable with the timescale of information transfer, that is the time difference between the firing of a presynaptic neuron and a postsynaptic neuron downstream. Nonetheless, based on the intrinsic buffer capability of neurons and the fluorescent properties of the calcium indicator, calcium signals typically decay on the timescale of hundreds of milliseconds to seconds (<xref ref-type="bibr" rid="bib55">Tian et al., 2012</xref>). In motoneurons, neurons can fire in bursts of spikes, which may further hinder the resolution of information propagation. In this section, we investigate how the interplay of these slow and fast timescales impacts the accuracy of Granger causality analysis to identify information flow.</p><p>In the embryonic spinal cord, motoneurons are recruited along the rostrocaudal axis sequentially. The muscle contractions alternate between the left and right side of the body, and propel fish forward. Correspondingly, the left and right sides of the motoneurons are active as a steady oscillation from the head to the tail, leading to an expected information flow from rostral to caudal (<xref ref-type="bibr" rid="bib59">Warp et al., 2012</xref>). The spikes are followed by a plateau that lasts on the order of seconds (<xref ref-type="bibr" rid="bib46">Saint-Amant and Drapeau, 2001</xref>). Using a combined statistical and dynamical approach, we simulate artificial “motoneuron” data (see example traces in <xref ref-type="fig" rid="fig5">Figure 5A</xref>), as two chains of five neurons, driven externally by two binary stimuli, <inline-formula><mml:math id="inf160"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mtext>L</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf161"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mtext>R</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, that randomly flip between an on (<inline-formula><mml:math id="inf162"><mml:mrow><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) and an off (<inline-formula><mml:math id="inf163"><mml:mrow><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) state, following the same statistics as recorded in the data. The stimulus of the left side, <inline-formula><mml:math id="inf164"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mtext>L</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is generated by randomly choosing time intervals when the stimulus state is on, <inline-formula><mml:math id="inf165"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>on</mml:mtext></mml:msub></mml:math></inline-formula>, and when it is off, <inline-formula><mml:math id="inf166"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>off</mml:mtext></mml:msub></mml:math></inline-formula>, uniformly from the sets <inline-formula><mml:math id="inf167"><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mtext>on</mml:mtext><mml:mtext>data</mml:mtext></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mtext>on</mml:mtext><mml:mtext>data</mml:mtext></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf168"><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mtext>off</mml:mtext><mml:mtext>data</mml:mtext></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mtext>off</mml:mtext><mml:mtext>data</mml:mtext></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math></inline-formula>, respectively. Here, <inline-formula><mml:math id="inf169"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mtext>on</mml:mtext><mml:mtext>data</mml:mtext></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> is the set of duration of all “on”-states in the experiment (<xref ref-type="bibr" rid="bib15">De Vico Fallani et al., 2014</xref>) that we find by the positive finite difference method in the fluorescent signal smoothed by total-variational regularization (<xref ref-type="bibr" rid="bib11">Chartrand, 2011</xref>; <xref ref-type="bibr" rid="bib12">Chen et al., 2019</xref>). These sets of long-lasting time blocks, where the neurons are always active, simulates the plateau activity of the embryonic motoneurons. After <inline-formula><mml:math id="inf170"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mtext>L</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is sampled, the stimulus for the right-side neurons, <inline-formula><mml:math id="inf171"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mtext>R</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, is generated such that the time delay between the “on”-state of <inline-formula><mml:math id="inf172"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mtext>L</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf173"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mtext>R</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is sampled from <inline-formula><mml:math id="inf174"><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mtext>delay</mml:mtext><mml:mtext>data</mml:mtext></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mtext>delay</mml:mtext><mml:mtext>data</mml:mtext></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math></inline-formula>, where the delay time <inline-formula><mml:math id="inf175"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>delay</mml:mtext></mml:msub></mml:math></inline-formula> matches the empirical stimulus distribution. We model the sequential activation of the motoneurons by imposing the spike rate as a function of <inline-formula><mml:math id="inf176"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mtext>L</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf177"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mtext>R</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (see Materials and Methods) and we use a standard Poisson process with these rates to generate the spike train for each neuron, <inline-formula><mml:math id="inf178"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>. The spikes are then convolved with an exponential decay with time scale <inline-formula><mml:math id="inf179"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>ca</mml:mtext></mml:msub></mml:math></inline-formula> to simulate the slow decay time of calcium signals.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Synthetic data mimicking bursting motoneurons shows the slow timescale of calcium signal decay decreases GC performance.</title><p>(<bold>A</bold>) Example traces of the synthetic data for two chains of five neurons (<italic>N</italic> = 10 neurons for the whole system). The common stimuli, <inline-formula><mml:math id="inf180"><mml:msub><mml:mi>I</mml:mi><mml:mtext>L</mml:mtext></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf181"><mml:msub><mml:mi>I</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:math></inline-formula>, are sampled using the empirically observed on- and off-durations for the neuron bursts (<inline-formula><mml:math id="inf182"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>on</mml:mtext></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf183"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>off</mml:mtext></mml:msub></mml:math></inline-formula>). The time delay of the onset of the right stimulus <inline-formula><mml:math id="inf184"><mml:msub><mml:mi>I</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:math></inline-formula> from the offset of the left stimulus <inline-formula><mml:math id="inf185"><mml:msub><mml:mi>I</mml:mi><mml:mtext>L</mml:mtext></mml:msub></mml:math></inline-formula> is also sampled using empirical distribution. Each synthetic data is generated for the duration of 1000s. (<bold>B</bold>) Success of information flow retrieval, measured by the weight of the ipsilateral GC links, <inline-formula><mml:math id="inf186"><mml:msub><mml:mi>W</mml:mi><mml:mtext>IC</mml:mtext></mml:msub></mml:math></inline-formula>, and the weight of rostral-to-caudal links, <inline-formula><mml:math id="inf187"><mml:msub><mml:mi>W</mml:mi><mml:mtext>RC</mml:mtext></mml:msub></mml:math></inline-formula>, as a function of the information propagation time scale <inline-formula><mml:math id="inf188"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>info</mml:mtext></mml:msub></mml:math></inline-formula>, evaluated at the empirical time scales <inline-formula><mml:math id="inf189"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>ca</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2.5</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf190"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>sampling</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, and biologically reasonable base spike rate <inline-formula><mml:math id="inf191"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>32</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mtext>s</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. Results from bivariate GC are plotted in <italic>purple</italic>, and results from multivariate GC are in <italic>green</italic>. (<bold>C</bold>) Success of information flow retrieval for <inline-formula><mml:math id="inf192"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>info</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.025</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf193"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>info</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> for synthetic data with different calcium decay time constants. Greater calcium decay constants lead to worse information retrivals. Errorbars represents standard deviations across 10 realizations of synthetic data. The empirical calcium time scale <inline-formula><mml:math id="inf194"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>ca</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2.5</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is indicated by the red vertical line. Error bars in panel (B) and (C) are standard deviation across 10 random realizations of the synthetic data.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig5-v2.tif"/></fig><p>The timescales in this model include the sampling time <inline-formula><mml:math id="inf195"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>sampling</mml:mtext></mml:msub></mml:math></inline-formula>, the calcium decay time constant <inline-formula><mml:math id="inf196"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>ca</mml:mtext></mml:msub></mml:math></inline-formula>, and the timescale of information propagation <inline-formula><mml:math id="inf197"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>info</mml:mtext></mml:msub></mml:math></inline-formula>. The sampling time is given by the experimental setup for the motoneuron data we analyze (<xref ref-type="bibr" rid="bib15">De Vico Fallani et al., 2014</xref>), with <inline-formula><mml:math id="inf198"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mtext>sampling</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.25</mml:mn><mml:mo>⁢</mml:mo><mml:mtext>s</mml:mtext></mml:mrow></mml:mrow></mml:math></inline-formula>. As shown in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>, the empirical calcium decay time constant can be found by overlaying all epochs of decays of the calcium signals from different bursts and different neurons: fitting the decay of calcium signals to exponential functions gives <inline-formula><mml:math id="inf199"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mtext>ca</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>2.5</mml:mn><mml:mo>⁢</mml:mo><mml:mtext>s</mml:mtext></mml:mrow></mml:mrow></mml:math></inline-formula>. Notice this decay timescale is limited by both the buffering capability of the sensor, here GCaMP3, and the intrinsic buffering capability of the cell (<xref ref-type="bibr" rid="bib55">Tian et al., 2012</xref>), that is having a faster sensor does not always decreases this decay time scale. The information propagation timescale is chosen such that <inline-formula><mml:math id="inf200"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>info</mml:mtext></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>sampling</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. The baseline spike rate is set to <inline-formula><mml:math id="inf201"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>32</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mtext>s</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. Finally, the time resolution for the simulation is chosen to be <inline-formula><mml:math id="inf202"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mtext>sim</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.0125</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, such that <inline-formula><mml:math id="inf203"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mtext>sim</mml:mtext></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> to add stochasticity in the simulation.</p><p>Applying bivariate and multivariate GC analysis to the simulated data with the above parameters, we see that when the information propagation time scale is similar to the sampling time scale, both GC methods retrieve the correct information flow (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). In general, multivariate GC performs better in identifying information flow compared to bivariate GC. Even when the information propagation time scale is much smaller than that of the sampling rate (<inline-formula><mml:math id="inf204"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mtext>info</mml:mtext></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mtext>sampling</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>), the information flow can still be correctly retrieved, and the multivariate GC gives the correct input <inline-formula><mml:math id="inf205"><mml:msub><mml:mi>W</mml:mi><mml:mtext>ipsi</mml:mtext></mml:msub></mml:math></inline-formula> value 1, and <inline-formula><mml:math id="inf206"><mml:msub><mml:mi>W</mml:mi><mml:mtext>RC</mml:mtext></mml:msub></mml:math></inline-formula> significantly larger than the null value of 0.5.</p><p>The success of retrieval of information flow also depends on the decay constant, although the effect is not strong. As shown in <xref ref-type="fig" rid="fig5">Figure 5C</xref>, the performance is almost perfect for short calcium decay times, with <inline-formula><mml:math id="inf207"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mtext>IC</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf208"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mtext>RC</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, and longer decay results in slightly worse performance. For the empirical calcium decay rate in the GCaMP3-expressing motoneuron data (indicated by the red line), <inline-formula><mml:math id="inf209"><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mtext>RC</mml:mtext><mml:mtext>MVGC</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.81</mml:mn></mml:mrow></mml:math></inline-formula>. Naturally, using fast calcium indicators in the experiments facilitates the analysis, but the improvement may not be significant.</p></sec><sec id="s2-3-8"><title>Adaptive threshold for F-statistics</title><p>We now compute the Granger causality strength (<xref ref-type="disp-formula" rid="equ4">Equation 4</xref>) on the smoothed calcium time series. Naively, the F-test is used to determine whether the Granger causality is significant (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref>). This test is exact if the residual, or the prediction error, is Gaussian-distributed and independent. For calcium signals, these assumptions do not hold: the noise is not necessarily Gaussian, and is not independent. While subsequent versions adapting GC to nonlinear and non-gaussian dynamics with assumptions of the underlying dynamics have been shown to have well-known asymptotic null distributions (<xref ref-type="bibr" rid="bib31">Kim et al., 2011</xref>; <xref ref-type="bibr" rid="bib49">Sheikhattar et al., 2018</xref>), it did not account for additional irregular stimuli. To develop a general method that can be applied to datasets with diverse stimuli, we use a data-driven method to construct the null distribution.</p><p>To test if we can still use the F-test as a test of significance, we generate data consistent with a null hypothesis by cyclically shuffling the time series of the driving neuron (see <xref ref-type="fig" rid="fig6">Figure 6A</xref>). Specifically, for the bivariate GC value from neuron <italic>j</italic> to another neuron <italic>i</italic>, <inline-formula><mml:math id="inf210"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, and the multivariate conditioned on the activity of the rest of neurons <inline-formula><mml:math id="inf211"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, we compute the F-statistics with the time series <inline-formula><mml:math id="inf212"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> replaced by signal shuffled by a random time constant <inline-formula><mml:math id="inf213"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mtext>CS</mml:mtext></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mml:mtr><mml:mtd><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>T</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Significance tests for Granger causality on real calcium data require new thresholds, generated using null models.</title><p>(<bold>A</bold>) Schematics for generating null models by randomly shuffling the data. The <italic>blue</italic> dots and curves correspond to the original data, the effect neuron <inline-formula><mml:math id="inf214"><mml:msub><mml:mi>f</mml:mi><mml:mtext>X</mml:mtext></mml:msub></mml:math></inline-formula> and the cause neuron <inline-formula><mml:math id="inf215"><mml:msub><mml:mi>f</mml:mi><mml:mtext>Y</mml:mtext></mml:msub></mml:math></inline-formula>; the <italic>green</italic> ones are generated by random cyclic shuffling of the original <inline-formula><mml:math id="inf216"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mtext>Y</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, with gray rectangles indicating matching time points before and after the cyclic shuffle. (<bold>B</bold>) The probability density of the <italic>F</italic>-statistics of the bivariate Granger causality for an example experiment (dataset <italic>f3t2</italic> from <xref ref-type="bibr" rid="bib15">De Vico Fallani et al., 2014</xref> with <italic>N</italic> = 10 neurons). Blue circles are computed using the smoothed Calcium signals, and the green crosses are computed using the null model generated with cyclic shuffles. The black curve is the F-distribution used in the naive discrimination of GC statistics, and the gray curve is the best fitted F-distribution, fitting an effective number of samples. The gray and the black dashed vertical lines indicate the significance threshold for Granger causality, using the original threshold and the fitted threshold, respectively. (<bold>C</bold>) Same as (<bold>B</bold>), for multivariate Granger causality analysis. (<bold>D</bold>) Comparison between the significant GC network for the experiment <italic>f3t2</italic> using the naive vs. fitted F-statistics threshold.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig6-v2.tif"/></fig><p>If the significance test remains valid for the calcium time series, we expect almost no significant links and the distribution of the F-statistics of the shuffled data should be the F-distribution. However, as <xref ref-type="fig" rid="fig6">Figure 6BC</xref> shows using the example dataset <italic>f3t2</italic> from <xref ref-type="bibr" rid="bib15">De Vico Fallani et al., 2014</xref>, for both bivariate and multivariate GC, the distribution of the F-statistics for the shuffled data, <inline-formula><mml:math id="inf217"><mml:msup><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi><mml:mtext>shuffle</mml:mtext></mml:msup></mml:math></inline-formula>, has a shifted support that is larger than that of the F-distribution. This means that if we use the original F-test based on the F-distribution as a null model, even if there are no G-causal links between two neurons, we will classify the link as significant.</p><p>To improve specificity, we instead define the null expectation as the distribution for the F-statistics of the cyclically shuffled data to test for the significance of GC links. A GC link from the data is significant, if it has an F-statistics that is above the <inline-formula><mml:math id="inf218"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> percentile of the null F-statistics distribution, generated from the cyclically shuffled data. The null F-statistics distribution can be approximated non-parameterically by Monte Carlo reshuffles. However, since the significance threshold depends on the tail of the F-statistics distribution, to get an accurate estimation requires a large number of reshuffles and is computationally undesirable.</p><p>Instead, to accelerate the computation, we notice that the bulk of the <inline-formula><mml:math id="inf219"><mml:msup><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi><mml:mtext>shuffle</mml:mtext></mml:msup></mml:math></inline-formula> distribution is well approximated by an F-distribution, with outliers explained by the pseudo-periodicity of the data. We parameterize the null empirical distribution by <inline-formula><mml:math id="inf220"><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>F</mml:mi><mml:mo>;</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and find the parameters by maximizing the likelihood (see Materials and methods for details). Repeating the significance test with the parametrized F-distribution, we find a resulting causality network with fewer links (<xref ref-type="fig" rid="fig6">Figure 6D</xref>).</p></sec></sec><sec id="s2-4"><title>Pipeline summary and GC analysis of motoneuron data</title><p>Putting together all the observations of the previous sections, we developed an improved Granger causality analysis pipeline (<xref ref-type="fig" rid="fig7">Figure 7A</xref>) to overcome the limitations of naive GC for the investigation of directional information flow in neuron calcium data. These improvements consist of both pre-processing the calcium traces (see GC analysis of motoneuron data) and determining a custom threshold for the significance testing of the presence of a GC link, to avoid the many false positive links that the naive GC analysis finds (see Adaptive threshold for F-statistics). Pre-processing the data aims to remove undesirable effects of noisy fluorescence signals and of motion artifacts on the GC results. The first step consists of selecting only neurons displaying calcium traces that match their expectation (Removing strange neurons): calcium traces with a low signal-to-noise ratio or inconsistent behavior should be disregarded. This step is particularly important for MVGC analysis, in which the traces of all neurons are used to determine the presence of a link between any pair of neurons. Second, we correct the instantaneous change in fluorescence caused by motion artifacts (Correcting for motion artifacts). In the final pre-processing step, the calcium signals are smoothed to remove remaining noise (Smoothing), especially noise that is correlated across neurons and that leads to spurious links in the BVGC approach, and missing links in the MVGC analysis. In the BVGC analysis, correlation in the noise might be perceived as a link between two neurons. In the MVGC case, the correlation in the noise of the receiving neuron and in the noise of neurons on which the GC is conditioned can hide the actual influence of the signal of the driving neuron on the signal of the receiving neuron.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Comparison of GC analysis results with and without processing the calcium transients and adapting the threshold.</title><p>(<bold>A</bold>) Description of the whole pipeline. Before running the GC analysis on the raw calcium transients (<inline-formula><mml:math id="inf221"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>), the lag parameter must be chosen. Then, before running the GC analysis again, motion artifacts are corrected, the fluorescence is smoothed and a new threshold is calculated. (<bold>B</bold>) Comparison of <inline-formula><mml:math id="inf222"><mml:msub><mml:mi>W</mml:mi><mml:mtext>IC</mml:mtext></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf223"><mml:msub><mml:mi>W</mml:mi><mml:mtext>RC</mml:mtext></mml:msub></mml:math></inline-formula> before and after applying the pipeline to the GC analyses. Points in the upper right triangle gray-shaded area represent the ratios that have increased in the final GC results. Each fish (n=9) is represented by a color, BVGC by circles and MVGC by triangles. Means are shown in black. We find that using our pipeline, <inline-formula><mml:math id="inf224"><mml:msub><mml:mi>W</mml:mi><mml:mtext>IC</mml:mtext></mml:msub></mml:math></inline-formula> strongly increases and we can clear out the spurious contra-lateral links present in the original GC. <inline-formula><mml:math id="inf225"><mml:msub><mml:mi>W</mml:mi><mml:mtext>RC</mml:mtext></mml:msub></mml:math></inline-formula> is not significantly improved: the recording frequency and GCaMP decay are likely too low and slow compared to the speed of rostro-caudal propagation of the information flow. (<bold>C</bold>) Network results before (<italic>top row</italic>) and after (<italic>bottom row</italic>) applying our pipeline for computing bivariate Granger causality (BVGC), for all fish. For consistency in the network representation and better ability to compare, we removed the uncharacteristically behaving neurons of the GC analysis before applying the pipeline. Note that more links are found on the side that was better in focus in the recording. (<bold>D</bold>) Same as (<bold>C</bold>) but for the multivariate Granger causality (MVGC).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig7-v2.tif"/></fig><p>After these pre-processing steps, one can apply the GC algorithm to these calcium traces. In order to avoid calculating GC for many maximum time lags, the choice of this parameter can be chosen to match biological delay of information flow – here 750ms. For each pair of neurons, we time-shift one of the calcium traces in the GC analysis of a pair of neurons to remove causality between the two signals and use this new null model to determine the significance threshold, as motivated in Adaptive threshold for F-statistics. Notice that for some datasets, the resulting MVGC network has more connections than the corresponding BVGC network. This is because the adaptive thresholds for the significance test are chosen separately for BVGC and MVGC analysis.</p><p>We take advantage of anatomical knowledge of the expected network for the motoneuron data set to compare the naive GC results to our customized GC results. The improved GC pipeline significantly increases the <inline-formula><mml:math id="inf226"><mml:msub><mml:mi>W</mml:mi><mml:mtext>IC</mml:mtext></mml:msub></mml:math></inline-formula> ratio from <inline-formula><mml:math id="inf227"><mml:mrow><mml:mn>0.62</mml:mn><mml:mo>±</mml:mo><mml:mn>0.15</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf228"><mml:mrow><mml:mn>1.00</mml:mn><mml:mo>±</mml:mo><mml:mn>0.00</mml:mn></mml:mrow></mml:math></inline-formula> for both BVGC and MVGC (<inline-formula><mml:math id="inf229"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). <inline-formula><mml:math id="inf230"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mtext>IC</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> indicates that there are no contralateral flow, corresponding to what is known from anatomy. On the other hand, the <inline-formula><mml:math id="inf231"><mml:msub><mml:mi>W</mml:mi><mml:mtext>RC</mml:mtext></mml:msub></mml:math></inline-formula> ratio does not significantly increase (<inline-formula><mml:math id="inf232"><mml:mrow><mml:mn>0.59</mml:mn><mml:mo>±</mml:mo><mml:mn>0.09</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf233"><mml:mrow><mml:mn>0.59</mml:mn><mml:mo>±</mml:mo><mml:mn>0.15</mml:mn></mml:mrow></mml:math></inline-formula> for BVGC and <inline-formula><mml:math id="inf234"><mml:mrow><mml:mn>0.52</mml:mn><mml:mo>±</mml:mo><mml:mn>0.08</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf235"><mml:mrow><mml:mn>0.53</mml:mn><mml:mo>±</mml:mo><mml:mn>0.10</mml:mn></mml:mrow></mml:math></inline-formula> for MVGC, <inline-formula><mml:math id="inf236"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) (<xref ref-type="fig" rid="fig7">Figure 7B</xref>). <inline-formula><mml:math id="inf237"><mml:msub><mml:mi>W</mml:mi><mml:mtext>RC</mml:mtext></mml:msub></mml:math></inline-formula> close to 0.5 shows that GC analysis is unable to capture the rostrocaudal information flow pattern.</p><p>The improvement of the ipsilateral ratio can be explained by the disappearance of most contralateral links that were spuriously detected by the naive GC analysis. The rostrocaudal ratio <inline-formula><mml:math id="inf238"><mml:msub><mml:mi>W</mml:mi><mml:mtext>RC</mml:mtext></mml:msub></mml:math></inline-formula> is however not significantly improved. The temporal resolution of the recording (4 Hz leading to one frame every 250ms) may not be sufficient to correctly determine the directionality of the information flow as is much slower than the actual propagation speed (a few milliseconds, see <xref ref-type="bibr" rid="bib34">Masino and Fetcho, 2005</xref>). In a similar manner, the decay time-constant of GCaMP3 is large compared to the refractory period between two spikes. Results could be further improved by recording at higher frequency and using novel fluorescent calcium sensors such as GCaMP6f, which has faster kinetics.</p></sec><sec id="s2-5"><title>GC analysis of hindbrain data</title><p>In order to investigate the information flow between neurons in a more complex dataset, we analyzed population recordings from neurons in the hindbrain of larval zebrafish performing optomotor response (OMR; data from <xref ref-type="bibr" rid="bib48">Severi et al., 2018</xref>, also see <xref ref-type="fig" rid="fig8">Figure 8A and B</xref>), in which the true information flow is unknown. On each horizontal plane along the dorsoventral axis across the whole hindbrain, neurons were recorded <italic>in vivo</italic> using two-photon laser scanning calcium imaging at 5.81 Hz while <italic>Tg(elavl3:GCaMP5G</italic>) transgenic larval zebrafish (previously known as <italic>Tg(HUC:GCaMP5G</italic>)) responded to a moving grading on their right side (<inline-formula><mml:math id="inf239"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>139</mml:mn></mml:mrow></mml:math></inline-formula> neurons in the reference plane, <xref ref-type="fig" rid="fig8">Figure 8A</xref>). Upon motion of the grading, zebrafish larvae responded by swimming forward, often with a left bias (<xref ref-type="fig" rid="fig8">Figure 8C</xref>, <italic>right</italic>). We classified hindbrain neurons in three categories: motor-correlated neurons in the medial V2a stripe (red in <xref ref-type="fig" rid="fig8">Figure 8A and B</xref>, <xref ref-type="bibr" rid="bib33">Kinkhabwala et al., 2011</xref>; <xref ref-type="bibr" rid="bib32">Kimura et al., 2013</xref>; <xref ref-type="bibr" rid="bib42">Pujala and Koyama, 2019</xref>), other motor-correlated neurons (blue in <xref ref-type="fig" rid="fig8">Figure 8A and B</xref>) and non motor-correlated neurons (gray in <xref ref-type="fig" rid="fig8">Figure 8A and B</xref>). Because V2a neurons localized in the medial hindbrain are well-known command neurons driving locomotion (<xref ref-type="bibr" rid="bib32">Kimura et al., 2013</xref>; <xref ref-type="bibr" rid="bib42">Pujala and Koyama, 2019</xref>), we first focused our analyses on medial neurons whose activity was correlated to swimming (red neurons in the rectangle, <inline-formula><mml:math id="inf240"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mtext>med</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula>, in <xref ref-type="fig" rid="fig8">Figure 8A and B</xref>). The corresponding calcium traces (<xref ref-type="fig" rid="fig8">Figure 8B</xref>) were exempt of motion artifacts and smoothing was not necessary as the scanning of the infrared laser leads to noise that is not correlated between neurons. When applying the naive bivariate Granger causality using the original threshold, we found almost all links to be significant (<xref ref-type="fig" rid="fig8">Figure 8D</xref>), suggesting numerous spurious links due to the high overall correlation in neuron activity. Motor-correlated neurons exhibited a higher drive (<xref ref-type="fig" rid="fig8">Figure 8E</xref>), defined as the sum of all its outgoing GC links:<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mi>G</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf241"><mml:mi>j</mml:mi></mml:math></inline-formula> spans all other neurons. Critically, the neuronal drive was not correlated to the neuron’s position along the scanning direction (correlation of <inline-formula><mml:math id="inf242"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.15</mml:mn></mml:mrow></mml:math></inline-formula> across all 139 neurons and <inline-formula><mml:math id="inf243"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.03</mml:mn></mml:mrow></mml:math></inline-formula> across medial swim-correlated neurons, <inline-formula><mml:math id="inf244"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1A</xref>), implying that a correction for the scanning delay of the laser scanning microscope was not necessary. In contrast, the drive for a given neuron was correlated to the signal-to-noise ratio (SNR) of its calcium trace, computed following details in Materials and Methods, with a Pearson’s correlation coefficient of <inline-formula><mml:math id="inf245"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.45</mml:mn></mml:mrow></mml:math></inline-formula> across all neurons and <inline-formula><mml:math id="inf246"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.69</mml:mn></mml:mrow></mml:math></inline-formula> across medial neurons (<inline-formula><mml:math id="inf247"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <xref ref-type="fig" rid="fig8">Figure 8E</xref>). This effect could be corrected using an adaptive threshold tailored to each neuron pair to normalize the GC values. Interestingly, we noticed that the drive was higher for motor-correlated neurons, especially the ones located in the medial stripe and assumed to likely correspond to V2a reticulospinal neurons (<xref ref-type="bibr" rid="bib33">Kinkhabwala et al., 2011</xref>; <xref ref-type="bibr" rid="bib32">Kimura et al., 2013</xref>; <xref ref-type="bibr" rid="bib42">Pujala and Koyama, 2019</xref>), further justifying focusing our attention on this subset of neurons.</p><fig-group><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Our Granger causality pipeline revealed revealed right-to-left information flow among motor-correlated hindbrain neurons in larval zebrafish performing optomotor (OMR) responses.</title><p>(<bold>A</bold>) Two-photon laser scanning calcium imaging <italic>in vivo</italic> was acquired at 5.81Hz in the hindbrain of <italic>Tg(elavl3:GCaMP5G</italic>) transgenic larvae performing OMR (data from <xref ref-type="bibr" rid="bib48">Severi et al., 2018</xref>). Forty-one (<italic>red and blue</italic>) out of 139 neurons from a reference plane of a larval zebrafish hindbrain were motor-correlated and selected for subsequent analysis. Neurons located in the medial area (<italic>red</italic>, <italic>N</italic> = 20 neurons) are in the location of the V2a reticulospinal stripe (<xref ref-type="bibr" rid="bib33">Kinkhabwala et al., 2011</xref>), distinct from other motor-correlated neurons (<italic>blue</italic>, <italic>N</italic> = 21). The activity of all other neurons (<italic>gray</italic>, <italic>N</italic> = 98 neurons) were not correlated to the motor output. (<bold>B</bold>) Sampled calcium traces of the three categories of neurons mentioned above were ordered by decreasing signal-to-noise ratio (SNR) from top to bottom. The moving grading (<italic>top trace</italic>) was presented to the right of the fish from tail to head to induce swimming, depicted as the tail angle (<italic>bottom trace</italic>, with a zoom over 4s showing two subsequent bouts, positive tail angles correspond to left bends). (<bold>C</bold>) The distribution of the tail angles for turns (tail angle <inline-formula><mml:math id="inf248"><mml:mi>α</mml:mi></mml:math></inline-formula> with <inline-formula><mml:math id="inf249"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mn>45</mml:mn><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>90</mml:mn><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>) was biased to the left. (<bold>D</bold>) GC matrix (<italic>left</italic>) and map of information flow (<italic>right</italic>, the arrows indicate the directionality of the GC links) for the naive BVGC on medial motor-correlated neurons. Of the 380 possible pairs, 351 were found to have a significant drive, suggesting that the naive BVGC algorithm is too permissive to false positive links, and justifying an adapted pipeline to remove spurious connections. (<bold>E</bold>) The neuronal drive, calculated as the sum of the strength of all outgoing GC links for each neuron, was correlated to the SNR of the calcium traces, especially high for medial neurons (<inline-formula><mml:math id="inf250"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.69</mml:mn></mml:mrow></mml:math></inline-formula>, compared to <inline-formula><mml:math id="inf251"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.45</mml:mn></mml:mrow></mml:math></inline-formula> across all 139 neurons). (<bold>F</bold>) Customization of the threshold and normalization of the GC values reduced the number of significant GC links and revealed numerous commissural links that were both rostrocaudal and caudorostral between medial motor-correlated neurons. (<bold>G</bold>) The new neuronal drive was less correlated with the SNR (from 0.69 to 0.49 for medial neurons). (<bold>H</bold>) Due to the high correlation in the selected neurons and the relatively high number of neurons (20), the new MVGC pipeline highlighted only the strongest GC links. (<bold>I</bold>) The density distribution of the significant GC link angles from the new MVGC analyses revealed a biased right-to-left information flow. The directionality of the information flow is consistent with the presence of the stimulus on the right side of the fish and the fish swimming forward with a bias towards the left (C, <italic>right</italic>). These results were conserved across planes of the same fish as well as across fish (<xref ref-type="fig" rid="fig4">Figure 4</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig8-v2.tif"/></fig><fig id="fig8s1" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 1.</label><caption><title>Correlation of the drive and receiving values with the cell position and signal-to-noise ratio, and comparison across neuron groups.</title><p>Correlation of the drive and receiving values with the cell position and signal-to-noise ratio, and comparison across neuron groups. (<bold>A</bold>) The neuronal drive, calculated as the sum of the strength of all outgoing Granger causality (GC) links for each neuron, is not correlated to the neuron position. In data recorded by a two-photon laser scanning microscope, different pixels are scanned across the sample with a very small delay. Panel A shows that the scanning direction and delay do not influence the GC results. (<bold>B</bold>) The neuronal drive is correlated to the signal-to-noise ratio (SNR) of the calcium traces. It is especially high for medial neurons (in red, <inline-formula><mml:math id="inf252"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.69</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> compared to <inline-formula><mml:math id="inf253"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.45</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> across all 139 neurons). After computing the new threshold for significance with a corrected null hypothesis and the normalized GC values, the correlation between the drive and SNR decreased. (<bold>C</bold>) The neuronal drive is significantly higher for motor-correlated neurons than for other neurons (Mann-Whitney U test; <inline-formula><mml:math id="inf254"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> for not significant when <inline-formula><mml:math id="inf255"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf256"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>∗</mml:mo><mml:mo>∗</mml:mo><mml:mo>∗</mml:mo><mml:mo>∗</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> when <inline-formula><mml:math id="inf257"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.0001</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). This observation suggests that motor-correlated neurons are important drivers of the network activity. (<bold>D</bold>) The receiving value of a given neuron is defined as the sum of all its incoming GC links. As for the drive, it is not correlated to the cell position. (<bold>E</bold>) The receiving value is correlated to the SNR. This correlation is reduced when computing the receiving value using the normalized GC values. (<bold>F</bold>) The receiving value is significantly higher for motor-correlated than for other neurons. This shows strong information flow between the motor-correlated neurons (Mann-Whitney U test; <inline-formula><mml:math id="inf258"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> when <inline-formula><mml:math id="inf259"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf260"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>∗</mml:mo><mml:mo>∗</mml:mo><mml:mo>∗</mml:mo><mml:mo>∗</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> when <inline-formula><mml:math id="inf261"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.0001</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig8-figsupp1-v2.tif"/></fig><fig id="fig8s2" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 2.</label><caption><title>Distribution of the F-statistics of the shuffled data before and after re-scaling.</title><p>Distribution of the F-statistics of the shuffled data before and after re-scaling. (<bold>A</bold>) Original distribution of the BVGC F-statistics of shuffled data, <inline-formula><mml:math id="inf262"><mml:msubsup><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mtext>shuffled</mml:mtext></mml:msubsup></mml:math></inline-formula>. It has a shifted support that is larger than that of the F-distribution (red curve), meaning that if we use the original F-test based on the F-distribution as a null model, even if there are no Granger-causal links between two neurons, we will classify the link as significant. (<bold>B</bold>) For each neuron pair, <inline-formula><mml:math id="inf263"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> the distribution <inline-formula><mml:math id="inf264"><mml:msubsup><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mtext>shuffled</mml:mtext></mml:msubsup></mml:math></inline-formula> is well-described by a constant-rescaled F-distribution. Applying an adaptive threshold on <inline-formula><mml:math id="inf265"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> can be simplified to applying the original threshold on the normalized, <inline-formula><mml:math id="inf266"><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> defined by dividing the naive F-statistics with the expectation value of the F-statistics generated by the shuffled data (<inline-formula><mml:math id="inf267"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mtext>shuffled</mml:mtext></mml:msubsup><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>). (<bold>C</bold>) Original distribution of the MVGC <inline-formula><mml:math id="inf268"><mml:msubsup><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mtext>shuffled</mml:mtext></mml:msubsup></mml:math></inline-formula>. (<bold>D</bold>) The normalized <inline-formula><mml:math id="inf269"><mml:msubsup><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mtext>shuffled</mml:mtext></mml:msubsup></mml:math></inline-formula> is almost perfectly described by a constant-rescaled F-distribution.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig8-figsupp2-v2.tif"/></fig><fig id="fig8s3" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 3.</label><caption><title>Test for overfitting and information flow from regularized GC on zebrafish hindbrain.</title><p>Test for overfitting and information flow from regularized GC on zebrafish hindbrain (<italic>N</italic> = 23 neurons). (<bold>A, B</bold>) Residues of the VAR model with different max lags for training (the first 2/3 of the data) and test (last 1/3 of the data) datasets, computed for and averaged across each possible neuron pair (<italic>i</italic>, <italic>j</italic>) for neuron <italic>j</italic> driving neuron <italic>i</italic>. The overlap between the training and test curves for max lag less than or equal to 3 shows the choice of max lag <inline-formula><mml:math id="inf270"><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> does not overfit. Error bars are standard error of the mean across all possible pairs of neurons. (<bold>C</bold>) The training and testing residue using ridge regularization for the full model shows a preferred ridge regularization parameter <inline-formula><mml:math id="inf271"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> (<bold>D</bold>) The percentage of connection after GC analysis shows a decrease at the preferred ridge regularization parameter, if we use the naive threshold. Using adaptive threshold increases the connection. (<bold>E</bold>) Shows examples of information flow at different ridge regularization parameters, using the adaptive threshold. (<bold>F–H</bold>) Same as (<bold>C–E</bold>), using LASSO regularization.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig8-figsupp3-v2.tif"/></fig><fig id="fig8s4" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 4.</label><caption><title>Distribution of GC link directions.</title><p>Distribution of GC link directions. Polar histogram of the proportion of angles of significant Granger causality links over all possible GC links between neurons. Using the naive bivariate GC (<italic>top row</italic>), we obtain a network that is almost fully connected, thus the proportion is close to 100% for all links and the polar histogram is close to a circle. The results of the adapted bivariate GC (<italic>2nd row</italic>), the naive multivariate GC (<italic>3rd row</italic>), and the adapted multivariate GC (<italic>bottom row</italic>), show a majority of links from right to left, suggesting an information flow from the right to the left hindbrain. This result is obtained in the medial swim-correlated neurons of the reference plane (<italic>N</italic> = 20 neurons, <italic>red, left column</italic>) and is conserved when GC is applied to all swim-correlated neurons of this plane (<italic>N</italic> = 41 neurons, <italic>blue, 2nd column</italic>), as well on swim-correlated neurons of all planes the reference fish (11 planes, 176 neurons in total, <italic>purple, third column</italic>), and across all swim-correlated neurons of all planes of all fish (<italic>n</italic> = 10 fish, 975 neurons in total, <italic>gray, right column</italic>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig8-figsupp4-v2.tif"/></fig><fig id="fig8s5" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 5.</label><caption><title>Correlation of Granger causality values using the first and second halves of the hindbrain data.</title><p>Correlation of Granger causality values using the first and second halves of the hindbrain data (<italic>N</italic> = 41 neurons). The correlation of <inline-formula><mml:math id="inf272"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.76</mml:mn></mml:mrow></mml:math></inline-formula> for the two halves assesses that BVGC (<italic>left</italic>) can be applied to the whole time series (1744 time steps). The correlation between the MVGC analyses of the halves of the hindbrain dataset (<italic>right</italic>) is low, and in this case, 872 time points are not sufficient to infer reliable MVGC results.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig8-figsupp5-v2.tif"/></fig></fig-group><p>To remove the spurious connections, we computed, as introduced before, the custom threshold for the significance testing of GC links. The difference from motoneuron dataset is that the activities of neurons in the hindbrain are driven by a periodic stimulus. Therefore, to generate the null statistics, we randomize the neural activities of the driver neurons by shuffling the neural signals, while keeping the stimulus fixed. More specifically, we divide the entire recording into 19 epochs of consecutive onset (10 s) and offset (5 s) of the stimulus (see <xref ref-type="fig" rid="fig8">Figure 8B</xref>), and generate shuffled calcium traces by randomizing the order of these 19 epochs. For each neuron pair <inline-formula><mml:math id="inf273"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we apply <inline-formula><mml:math id="inf274"><mml:mi>m</mml:mi></mml:math></inline-formula> such random shuffles to the calcium trace of the driver neuron <inline-formula><mml:math id="inf275"><mml:mi>i</mml:mi></mml:math></inline-formula>, and compute the F-statistics <inline-formula><mml:math id="inf276"><mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mtext>shuffled</mml:mtext></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. For BVGC, <inline-formula><mml:math id="inf277"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula>, and for MVGC, <inline-formula><mml:math id="inf278"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula>, we denote the empirical distribution of <inline-formula><mml:math id="inf279"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mtext>shuffled</mml:mtext></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> by <inline-formula><mml:math id="inf280"><mml:msup><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi><mml:mtext>shuffled</mml:mtext></mml:msup></mml:math></inline-formula>.</p><p>As in the previous examples, we need to parameterize <inline-formula><mml:math id="inf281"><mml:msubsup><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mtext>shuffled</mml:mtext></mml:msubsup></mml:math></inline-formula>. As before, for each neuron pair <inline-formula><mml:math id="inf282"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we noticed that the distribution <inline-formula><mml:math id="inf283"><mml:msubsup><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mtext>shuffled</mml:mtext></mml:msubsup></mml:math></inline-formula> was well-described by a constant-rescaled F-distribution (<xref ref-type="fig" rid="fig8s2">Figure 8—figure supplement 2</xref>). Applying an adaptive threshold on <inline-formula><mml:math id="inf284"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> reduces to applying the original threshold on the normalized <inline-formula><mml:math id="inf285"><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, defined by dividing the naive <inline-formula><mml:math id="inf286"><mml:mi>F</mml:mi></mml:math></inline-formula>-statistics with the expectation value of the <inline-formula><mml:math id="inf287"><mml:mi>F</mml:mi></mml:math></inline-formula>-statistics generated by the shuffled data. Mathematically,<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mtext>shuffled</mml:mtext></mml:msubsup><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Finally, by analogy, we use <xref ref-type="disp-formula" rid="equ5">Equation 5</xref> to compute the normalized version of the GC values, directly from the normalized F-statistics. The final BVGC matrix is shown in <xref ref-type="fig" rid="fig8">Figure 8F</xref>. Normalizing the BVGC values allowed the reduction of the correlation between the drive and the SNR, from 0.69 to now 0.49 for medial motor-correlated neurons (<xref ref-type="fig" rid="fig8">Figure 8G</xref>). With this new threshold for significance, most spurious links disappeared. The remaining significant BVGC links between medial motor-correlated neurons revealed strong information flow between these key command neurons. The MVGC resulted in a much smaller number of significant links (<xref ref-type="fig" rid="fig8">Figure 8H</xref>), suggesting a strong global correlation between the neurons, with only the strongest links remaining.</p><p>In order to quantify the direction of global information flow, we computed the distribution of the angles of the significant GC links. We normalized the raw distribution by the distribution of all possible GC links in the network, to suppress the influence of neuron positions on the shape of the histogram (see Materials and methods). The normalized distribution (<xref ref-type="fig" rid="fig8">Figure 8I</xref>) revealed a biased right-to-left information flow. Because the visual grading was presented on the right side of the fish, moving forward from tail to head, one expects the fish to turn more to the left. As expected, we observe in the plane of interest a biased distribution of the tail angles towards the left (<xref ref-type="fig" rid="fig8">Figure 8C</xref>, <italic>right</italic>). Such right-to-left flow of information was systematic across all motor-correlated neurons in the same plane (<xref ref-type="fig" rid="fig8">Figure 8</xref>, <italic>blue</italic>), as well as across the 11 planes in the same reference fish, and for all planes of the 10 fish (<xref ref-type="fig" rid="fig8s4">Figure 8—figure supplement 4</xref>, <italic>blue, purple, gray respectively</italic>).</p><p>The observed flow of information from right to left in the hindbrain could reflect the recruitment of excitatory command neurons in order to recruit spinal motor neurons on the left, and start swimming with a left bend. Upstream of command neurons lies a critical high motor center that has been identified by electrical stimulations across multiple vertebrate species and is referred to as the mesencephalic locomotor region, or MLR (<xref ref-type="bibr" rid="bib50">Shik et al., 1966</xref>). We recently identified, functionally and anatomically, the locus of the MLR in larval zebrafish (<xref ref-type="bibr" rid="bib10">Carbo-Tano et al., 2022</xref>). We therefore investigated the GC links across three ventral and horizontal planes where numerous command neurons are located in the caudal hindbrain (<xref ref-type="bibr" rid="bib32">Kimura et al., 2013</xref>; <xref ref-type="bibr" rid="bib42">Pujala and Koyama, 2019</xref>): the reference plane analyzed in <xref ref-type="fig" rid="fig8">Figure 8</xref>, and the adjacent planes respectively 10 <italic>µ</italic>m more dorsal and more ventral than the reference plane (<xref ref-type="fig" rid="fig9">Figure 9A–C</xref>, <italic>left</italic>). In the behavioral recordings acquired for all three planes, we observed a biased distribution of the tail angles towards the left (<xref ref-type="fig" rid="fig9">Figure 9A–C</xref>, <italic>top right</italic>). Accordingly, a right-to-left flow of information was found across motor-correlated neurons (<xref ref-type="fig" rid="fig9">Figure 9A–C</xref>, <italic>bottom right</italic>). Remarkably, we also detected strong driver neurons (<xref ref-type="fig" rid="fig9">Figure 9A–C</xref>, <italic>left</italic>) in the locus of the right MLR centered in rhombomere 1 (<xref ref-type="bibr" rid="bib10">Carbo-Tano et al., 2022</xref>, <xref ref-type="fig" rid="fig9">Figure 9B</xref>, <italic>left</italic>). As expected from anatomy (<xref ref-type="bibr" rid="bib10">Carbo-Tano et al., 2022</xref>) and physiology (<xref ref-type="bibr" rid="bib6">Brocard et al., 2010</xref>, <xref ref-type="bibr" rid="bib9">Cabelguen et al., 2003</xref>, <xref ref-type="bibr" rid="bib44">Ryczko and Dubuc, 2013</xref>, <xref ref-type="bibr" rid="bib45">Ryczko et al., 2016</xref>), neurons in the right MLR locus drove the activity of neurons in the left MLR locus as well as more caudally located neurons in the ipsilateral and contralateral hindbrain.</p><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>New multivariate Granger causality analysis of motor-correlated hindbrain neurons revealed neurons in the locus of Mesencephalic Locomotor Region (MLR) on the side of the visual grading driving activity of neurons in the contralateral MLR and on both sides in the medulla.</title><p>The distributions of the tail angles for turns (tail angle <inline-formula><mml:math id="inf288"><mml:mi>α</mml:mi></mml:math></inline-formula> with <inline-formula><mml:math id="inf289"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mn>45</mml:mn><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>90</mml:mn><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, <italic>gray, top left</italic> of <bold>A-C</bold>) and the distributions of the new MVGC link angles (<italic>blue, bottom left</italic> of <bold>A-C</bold>) indicate a bias when the visual grading stimulus was presented on the right towards the left across 3 hindbrain planes spaced by 10<italic>µ</italic>m (<bold>A</bold>: plane 5, dorsal to <bold>B</bold>: plane 7, analyzed in <xref ref-type="fig" rid="fig8">Figure 8</xref>; <bold>C</bold>: plane 9, ventral to plane 7). Across these three planes, a group of strong driver neurons (<italic>middle and right panels</italic> of <bold>A-C</bold>) was found located on the right, in the locus of the MLR. This is to our knowledge the first evidence of recruitment of cells in the MLR locus during locomotion. As expected from anatomy (<xref ref-type="bibr" rid="bib10">Carbo-Tano et al., 2022</xref>), right MLR neurons drive contralateral neurons in the left MLR and in the medulla where the reticular formation is located, both on the right and left sides.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-81279-fig9-v2.tif"/></fig></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Granger causality is a simple and effective method for information flow retrieval in large brain areas (<xref ref-type="bibr" rid="bib51">Shojaie and Fox, 2021</xref>; <xref ref-type="bibr" rid="bib4">Barnett et al., 2018</xref>; <xref ref-type="bibr" rid="bib39">Nicolaou et al., 2012</xref>). However, to apply GC analysis on calcium signals from population of neurons at single-cell level requires a careful re-examination of the method, because of the non-linearity, non-Gaussianity, and the possible predominance of correlated noise in the data depending on the imaging method used. We have developed an improved analysis pipeline and demonstrated its usefulness in retrieving information flow in zebrafish either within a dozen of motoneurons (<xref ref-type="bibr" rid="bib15">De Vico Fallani et al., 2014</xref>) and tens of hindbrain neurons (<xref ref-type="bibr" rid="bib40">Oldfield et al., 2020</xref>). Since the properties of calcium signals in neuronal populations are comparable across animal models, the tailored analysis pipeline we are proposing is not limited to zebrafish, and can be applied to calcium imaging data across animal species.</p><p>The first concern of applying GC analysis to calcium signals is how well GC, a measure of linear dependence among signals, can retrieve information flow in these non-linear and non-Gaussian imaging data. Using synthetic data on small networks with different types of dynamics mimicking calcium signals, from linear autoregressive models to spiking dynamics with exponential decay, we have demonstrated that GC can successfully reconstruct the underlying true dynamical interactions among neurons for a wide range of dynamical variables. In the case of motoneurons that fire repeatedly in bursts, we modeled network activity with two chains of neurons using empirically identified dynamical parameters. In this simulation, we showed that GC can retrieve the expected ipsilateral flow of information with rostral-to-caudal directionality, even when the information propagation occurs at a faster scale than the experimental sampling time and the time decay of the calcium transient. Altogether our results on simulations show that GC is a useful analysis method for population recordings of single-cell level calcium signals.</p><p>Throughout the examples used, we compared results from bivariate GC and multivariate GC analysis. While BVGC overestimates the true number of causal links, we find that MVGC is prone to a winner-take-all phenomenon that may represent just one of many plausible system-level models that can account for the observed data. This is especially problematic when the signals are strongly correlated, for example, in the presence of redundant signals. In addition, MVGC is more prone to the issue of overfitting. We therefore suggest using BVGC on datasets with large numbers (hundreds) of neurons, and MVGC on datasets with few tens of neurons. In general, starting with a small number of neurons of special interest seems wise.</p><p>After improving the confidence on the GC method, we applied it to real calcium signals. Because real data is noisy and noise can be correlated or not depending on the imaging method used, GC analysis requires careful examination of multiple pitfalls originating from these calcium signals that we addressed in our analysis pipeline. Our pipeline illustrates the pre-processing of the signals and the post-processing of the GC results. This effort is complementary to previous studies where new variations of GC were introduced to take into account the non-linear and non-gaussian dynamics in interacting neurons, for example by modifying the underlying VAR dynamics with GLM or VAR with sparsity constraints, and subsequently using adaptive thresholds for significance tests (<xref ref-type="bibr" rid="bib31">Kim et al., 2011</xref>; <xref ref-type="bibr" rid="bib49">Sheikhattar et al., 2018</xref>; <xref ref-type="bibr" rid="bib20">Francis et al., 2018</xref>; <xref ref-type="bibr" rid="bib21">Francis et al., 2022</xref>). Future work of interest should combine these variations of GC with the pipeline we built here.</p><list list-type="order"><list-item><p><italic>Preprocessing of calcium imaging data</italic>. As reported previously in <xref ref-type="bibr" rid="bib58">Vinck et al., 2015</xref>; <xref ref-type="bibr" rid="bib37">Nalatore et al., 2007</xref>, we find that GC analysis is sensitive to correlated noise, which can often occur in calcium signals, due to, for example, motion artifacts or fluctuations of the imaging laser for non-scanning imaging. We highlight that a motion artifact occurring at a single time point can create spurious GC links and should therefore be removed before proceeding to GC analysis. Similarly, correlated noise across neurons throughout the measurement will also results in spurious links, and will be especially problematic for multivariate GC analysis. The pitfalls associated with correlated noise can be resolved by identifying statistical features of the noise during the decay of calcium signals, and subsequently removing them using total variation differentiation regularization as we used here, or other nonlinear filtering methods. Future versions of the smoothing should be applied to all neurons simultaneously, assuming that the noise is correlated, to best preserve the time-ordering of the signal.</p></list-item><list-item><p><italic>Adaptive threshold for significance test in GC analysis</italic>. The naive GC analysis uses a significance test that compares the F-statistics with the null test, a F-distribution. While this null model is exact for Gaussian processes, for real data with nonlinear dynamics, non-Gaussian noise or data with periodic stimuli, the null distribution often deviates and needs to be learned through randomization of the data. In order to develop a more stringent test of significance for GC links, we generated null models of the F-statistics using random cyclic shuffles of the real data. By using a pair-specific threshold for the F-statistics, we were able to correct for the effect of the signal-to-noise ratio on the GC value.</p></list-item></list><p>When real calcium traces were acquired with a spinning disk microscope, that is using a camera chip for detection of all pixels at once illuminated by a laser, the noise was correlated because all pixels over the field of view were recorded simultaneously. In this case, smoothing the fluorescence traces was consequently necessary. In contrast, this step is not advised with two-photon laser scanning microscopy or high speed volumetric light-sheet imaging in which respectively different pixels and planes are simultaneously scanned across the sample. Furthermore, we found that the scanning delay in laser scanning microscopy acquired at 5.81 Hz did not influence the GC results: neurons recorded at the beginning of the scanning cycle did not appear as driver neurons of neurons recorded at the end of the cycle. We found however that the drive of a given neuron computed from the naive GC was correlated with the signal-to-noise ratio (SNR) of the calcium trace. Using an adaptive threshold for the significance test, the correlation between the drive and SNR decreased.</p><p>Applied to motoneuron data, the new pipeline led to an improvement in removing the spurious contralateral links, but did not significantly improve the directionality of the information flow from rostral to caudal — likely due to the small temporal resolution of the data (4 Hz) while activity propagates in few tens of milliseconds between segments.</p><p>In population recordings of brainstem neurons with unknown underlying connectivity, we first focused on neurons whose activity was correlated with the motor output and were located in the area of important command neurons, referred to as the V2a medial stripe (<xref ref-type="bibr" rid="bib33">Kinkhabwala et al., 2011</xref>) that was previously shown to be critical for generating motor output (<xref ref-type="bibr" rid="bib32">Kimura et al., 2013</xref>). We found that V2a neurons whose activity was correlated to the motor output were more likely to drive the activity of other neurons than neurons whose activity did not encode the motor output. In the condition where the stimulus is presented on one side of the fish, resulting in the fish often performing contralateral turns, the adapted multivariate Granger causality analysis revealed that the information flows mostly from the ipsilateral to the contralateral side in the brainstem. In order to further understand the origin of the drive underlying this effect, we extended the analysis to all neurons that had correlated activity with the motor output, including neurons outside the V2a medial stripe. Remarkably, we found a cluster of neurons that contained strong driver neurons on the side where the visual stimulus was presented and in the locus of the MLR, a motor center that recruits neurons in the V2a medial stripe to generate motor output (<xref ref-type="bibr" rid="bib10">Carbo-Tano et al., 2022</xref>). Our observations suggest that MLR cells on the ipsilateral side mainly drive the activity of contralateral MLR cells and motor-correlated neurons to elicit swimming. Throughout vertebrate species, the MLR has been defined functionally based on electrical stimulations effective at eliciting movement, but had not been yet identified from neuronal recordings during locomotion due to the difficulty to access this deep region in the brainstem during active locomotion. To our knowledge, our result is therefore the first evidence in vertebrates of recruitment of cells in the MLR locus during active locomotion.</p><p>We have focused in this manuscript on issues that are specific to calcium imaging. We only briefly discuss problems that are also common to other neural data types such as fMRI. Firstly, we emphasize that with current experimental techniques, only a small portion of the entire nervous system is recorded. While newer versions of GC have been adapted to take into consideration latent variables which contribute equally to all neurons (<xref ref-type="bibr" rid="bib28">Guo et al., 2008</xref>), or through subsequent removal of causal links (<xref ref-type="bibr" rid="bib57">Verny et al., 2017</xref>), GC does not in general allow identification of the true underlying connection in the presence of unobserved neurons. However, improved GC is able to identify information flow and an effective functional causal network for the observed neurons. Another issue specific to multivariate GC is the problem of overfitting (<xref ref-type="bibr" rid="bib47">Seth et al., 2015</xref>), especially when the number of neurons is large compare to the number of independent samples in the data. In this situation, one would need to consider group the activities of neurons (<xref ref-type="bibr" rid="bib36">Meshulam et al., 2019</xref>), either according to their correlation, or by adjacency, and apply GC to this coarse-grained network. One can also apply GC to subnetworks of observed neurons, and construct a distribution of information flows. Note that other approaches to identify causal links than GC have been developed and applied in genomic data (<xref ref-type="bibr" rid="bib57">Verny et al., 2017</xref>), gene regulatory networks (<xref ref-type="bibr" rid="bib35">Meinshausen et al., 2016</xref>) and large-scale neural networks (<xref ref-type="bibr" rid="bib30">Ke et al., 2019</xref>). Further work is now needed to explore whether and how these approaches could be adapted with our improved pipeline to calcium recordings.</p><p>Overall, comparing to common practices of using correlation to extract a functional network from calcium neural signals, our GC pipeline provides more information by informing on the direction of information flow. Additionally, compared to existing methods to overcome the pitfalls of calcium data, such as addressing the global additive noise using an inverse-time GC (<xref ref-type="bibr" rid="bib58">Vinck et al., 2015</xref>), our pipeline preprocesses calcium signals taking advantage of their slow decay, and keeps the GC approach as a simple method. By writing down GC value as a function of the F-statistics, normalized by null models directly constructed using shuffled data, we were able to correct the GC network by adjusting the values of individual links, and thereby to reduce the influence of signal-to-noise ratio in a simple yet effective way. The improved pipeline makes it possible to apply Granger causality analysis to data from experiments that simultaneously record from high numbers of neurons in larger networks.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Synthetic dynamics on small networks</title><p>We simulate artificial neural networks with three different dynamics, evolving at a time resolution of <inline-formula><mml:math id="inf290"><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mtext>sim</mml:mtext></mml:msub></mml:math></inline-formula>. For simplicity, we set the information flow to occur at the same time delay. The memory kernel, or the influence of neuron <inline-formula><mml:math id="inf291"><mml:mi>j</mml:mi></mml:math></inline-formula> on neuron <inline-formula><mml:math id="inf292"><mml:mi>i</mml:mi></mml:math></inline-formula> separated by time lag of <inline-formula><mml:math id="inf293"><mml:mi>q</mml:mi></mml:math></inline-formula> (in the unit of <inline-formula><mml:math id="inf294"><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mtext>sim</mml:mtext></mml:msub></mml:math></inline-formula>), is denoted as <inline-formula><mml:math id="inf295"><mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. The three dynamics are:</p><list list-type="order"><list-item><p><italic>Vector autoregression models</italic> (VAR)<disp-formula id="equ16"><mml:math id="m16"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>true</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf296"><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a white noise. The vector autoregression model is identical to the underlying model for Granger causality analysis, and allows GC to best reproduce the network structure.</p></list-item><list-item><p><italic>Spike dynamics for generalized linear model</italic> (GLM)</p><p>We simulate spiking neurons with non-linear interaction is through the generalized linear model (GLM), where the spiking rates of the neurons are given by<disp-formula id="equ17"><mml:math id="m17"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>true</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>and the spike counts<disp-formula id="equ18"><mml:math id="m18"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Poiss</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf297"><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> gives a base rate for spiking, <inline-formula><mml:math id="inf298"><mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is how the spike rates depend on the neurons’ past history. The spike counts <inline-formula><mml:math id="inf299"><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are what we consider as synthetic data, and what we will use for Granger causality analysis.</p></list-item><list-item><p><italic>Spike dynamics regressed by exponential decay</italic> (GLM-Calcium)</p><p>To simulate Calcium neuronal data, which has a fast onset and a slow decay, we add an exponential regression to the spike simulation with the GLM. The resulting trace is<disp-formula id="equ19"><mml:math id="m19"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>ca</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mtext>sim</mml:mtext></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></list-item></list><p>We simulate the above three dynamics with the interaction network, <inline-formula><mml:math id="inf300"><mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. The network has equal numbers of excitatory and inhibitory neurons to ensure that the dynamics is stationary. For convenience, the strength of the connection is set to be identical, <inline-formula><mml:math id="inf301"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>true</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf302"><mml:mi>c</mml:mi></mml:math></inline-formula> is the connection strength, and <inline-formula><mml:math id="inf303"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the signed adjacency matrix.</p></sec><sec id="s4-2"><title>Cross-correlation</title><p>The simplest approach of finding links in networks is through cross-correlation,<disp-formula id="equ20"><label>(16)</label><mml:math id="m20"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The (equal-time) correlation matrix given by <inline-formula><mml:math id="inf304"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is commonly used in calcium signal analysis as a functional network. Nonetheless, it is symmetric, and does not reveal directional information.</p></sec><sec id="s4-3"><title>Smooth calcium trace using total variation regularization</title><p>We follow the same procedure as in <xref ref-type="bibr" rid="bib12">Chen et al., 2019</xref> to smooth calcium traces using total variation regularization. Existing MATLAB packages and custom code are used to reconstruct the smooth trace <xref ref-type="bibr" rid="bib11">Chartrand, 2011</xref>. Here, we outline this smoothing method briefly.</p><p>Consider a raw calcium fluorescence signal <inline-formula><mml:math id="inf305"><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> from neurons that are known to generate episodic spikes and silences. These episodic activities can be characterized by the underlying derivative signal <inline-formula><mml:math id="inf306"><mml:mrow><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> which governs the onset and offset of the episodes, which we assume have an exponentially distributed temporal variations, and is only weakly correlated in time. If we further assume that the noise in <inline-formula><mml:math id="inf307"><mml:mi>f</mml:mi></mml:math></inline-formula> is Gaussian and white, the maximum likelihood reconstruction of the signal <inline-formula><mml:math id="inf308"><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is equivalent to minimizing.<disp-formula id="equ21"><label>(17)</label><mml:math id="m21"><mml:mrow><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mrow><mml:mover><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mi>A</mml:mi><mml:mi>u</mml:mi><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>,</mml:mtext></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf309"><mml:mi>A</mml:mi></mml:math></inline-formula> is the antiderivative operator, the combination <inline-formula><mml:math id="inf310"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the spectral density of noise floor that we can retrieve from the power spectrum of <inline-formula><mml:math id="inf311"><mml:mi>f</mml:mi></mml:math></inline-formula> at high frequencies, <inline-formula><mml:math id="inf312"><mml:msub><mml:mi>σ</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math></inline-formula> is the total standard deviation of the signal, and <inline-formula><mml:math id="inf313"><mml:msub><mml:mi>τ</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math></inline-formula> is the typical time scale of these variations. We determine the one unknown parameter <inline-formula><mml:math id="inf314"><mml:msub><mml:mi>τ</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math></inline-formula> by asking that, after smoothing, the cumulative power spectrum of the residue <inline-formula><mml:math id="inf315"><mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:math></inline-formula> has the least root mean square difference from the cumulative power spectrum of the extrapolated white noise.</p></sec><sec id="s4-4"><title>Compute signal-to-noise ratio</title><p>We compute the signal-to-noise ratio (SNR) for the fluorescence trace of a neuron, <inline-formula><mml:math id="inf316"><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, using the smoothing procedure above. Namely, for each trace <inline-formula><mml:math id="inf317"><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, we first apply the smoothing procedure. Then, the power of the noise, <inline-formula><mml:math id="inf318"><mml:msub><mml:mi>P</mml:mi><mml:mtext>noise</mml:mtext></mml:msub></mml:math></inline-formula>, is given by the extrapolated white noise, and equivalently by the sum of the power spectrum of the residue <inline-formula><mml:math id="inf319"><mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:math></inline-formula>. The sum of the power spectrum of <inline-formula><mml:math id="inf320"><mml:mi>f</mml:mi></mml:math></inline-formula> gives the sum of the power of the noise and the power of the signal, <inline-formula><mml:math id="inf321"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext>signal</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mtext>noise</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>. Finally, the SNR is computed as the ratio of <inline-formula><mml:math id="inf322"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext>signal</mml:mtext></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mtext>noise</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s4-5"><title>Synthetic statistical data generation</title><p>To study the effect of slow calcium decays on the accuracy of GC analysis, we generate synthetic data statistically. Specifically, we consider two chains of five neurons, driven externally by block stimuli with progressing time-delay across each chain, and alternates between the left and the right side. The stimulus of the left-side is generated by choosing intervals, <inline-formula><mml:math id="inf323"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>on</mml:mtext></mml:msub></mml:math></inline-formula>, for consecutive on-state (and <inline-formula><mml:math id="inf324"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>off</mml:mtext></mml:msub></mml:math></inline-formula> for consecutive off-states) uniformly from the set <inline-formula><mml:math id="inf325"><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mtext>on</mml:mtext><mml:mtext>data</mml:mtext></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mtext>on</mml:mtext><mml:mtext>data</mml:mtext></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math></inline-formula>, where the <inline-formula><mml:math id="inf326"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mtext>on</mml:mtext><mml:mtext>data</mml:mtext></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> is the set of duration of all ‘on’-states in a real zebrafish experiment, founded by positive finite difference in the fluorescent signal smoothened by total-variational regularization. The stimulus of the right-side follows with the delay time <inline-formula><mml:math id="inf327"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>delay</mml:mtext></mml:msub></mml:math></inline-formula> also matches the uniform distribution on the support of the empirical distribution.</p><p>We model the sequential activation of the motoneurons by imposing the spike rate as<disp-formula id="equ22"><mml:math id="m22"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:msub><mml:mtext>L</mml:mtext><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>L</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>info</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle><mml:mspace linebreak="newline"/><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:msub><mml:mtext>R</mml:mtext><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>R</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>info</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf328"><mml:mi>k</mml:mi></mml:math></inline-formula> is the ordered index of neurons on each side, <inline-formula><mml:math id="inf329"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>info</mml:mtext></mml:msub></mml:math></inline-formula> is the time scale of information propagation, and <inline-formula><mml:math id="inf330"><mml:msub><mml:mi>λ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> is a large basal spike rate to simulate the plateau in the neural activity. We use a standard Poisson process with these rates to generate the spike train for each neuron <inline-formula><mml:math id="inf331"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>. Finally, the observed calcium signal is computed by convoluting the spikes with exponential decays for each neuron <inline-formula><mml:math id="inf332"><mml:mi>i</mml:mi></mml:math></inline-formula>,<disp-formula id="equ23"><mml:math id="m23"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>ca</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mtext>sim</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>and downsampling at a sampling frequency <inline-formula><mml:math id="inf333"><mml:msubsup><mml:mi>τ</mml:mi><mml:mtext>sampling</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula>.</p></sec><sec id="s4-6"><title>Neuron identification in the hindbrain dataset</title><p>We analyzed the raw fluorescence movies from <xref ref-type="bibr" rid="bib48">Severi et al., 2018</xref> using the <italic>suite2p</italic> software (<xref ref-type="bibr" rid="bib41">Pachitariu et al., 2017</xref>), a pipeline for processing two-photon calcium imaging data. The pipeline first performs 2D registration of the plane recording to remove motion artifacts. Regions of interest (ROIs) are detected automatically, classified into <italic>cell</italic> and <italic>non-cell</italic>, and their calcium traces are extracted by the software. Following the automatic neuron classification, we performed a manual verification to remove spurious cells and add missing cells. These were selected based on the shape of the detected ROI and on the shape of the extracted fluorescence trace. The V2a neurons are identified by their positions and motor-correlated calcium activitites. The MLR neurons are identified based on their location within the MLR locus as determined in <xref ref-type="bibr" rid="bib10">Carbo-Tano et al., 2022</xref>, and specifically not using any information about their shape nor the fact that their activity is motor-correlated.</p></sec><sec id="s4-7"><title>Normalized polar histogram of Granger causality links</title><p>We computed the distribution of the angles of the significant GC links to quantify the direction of global information flow. To suppress the influence of neuron positions on the direction distribution, we normalized the distribution by dividing it over the distribution of the angles of all possible connections given the position of the neurons.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>Senior editor, eLife</p></fn><fn fn-type="COI-statement" id="conf3"><p>Reviewing editor, eLife</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Investigation, Visualization, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Data curation, Software, Investigation, Visualization, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Validation, Investigation</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Supervision, Investigation, Methodology, Writing – original draft, Project administration, Writing – review and editing</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Supervision, Funding acquisition, Investigation, Methodology, Writing – original draft, Project administration, Writing – review and editing</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Resources, Data curation, Supervision, Funding acquisition, Investigation, Visualization, Methodology, Writing – original draft, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-81279-mdarchecklist1-v2.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>The current manuscript is a computational study, so no data have been generated for this manuscript. All data used in our manuscript have been previously published. Modelling code is available on the github: <ext-link ext-link-type="uri" xlink:href="https://github.com/statbiophys/zebrafishGC">https://github.com/statbiophys/zebrafishGC</ext-link>, (copy archived at <xref ref-type="bibr" rid="bib52">Statistical Biophysics Consortium, 2023</xref>). Data files are available at: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.6774389">https://doi.org/10.5281/zenodo.6774389</ext-link>.</p><p>The following previously published dataset was used:</p><p><element-citation publication-type="data" specific-use="references" id="dataset1"><person-group person-group-type="author"><name><surname>De Vico Fallani</surname><given-names>F</given-names></name><name><surname>Corazzol</surname><given-names>M</given-names></name><name><surname>Sternberg</surname><given-names>JR</given-names></name><name><surname>Wyart</surname><given-names>C</given-names></name><name><surname>Chavez</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Data access for figures of Chen, Ginoux, Wyart, Mora &amp; Walczak</data-title><source>Zenodo</source><pub-id pub-id-type="doi">10.5281/zenodo.6774389</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank Urs Böhm and Kristen Severi for providing feedback on the hindbrain data, Jenna Sternberg for the data on motoneurons, and Fabrizio De Vico Fallani, Mario Chavez (Paris Brain Institute) and Moritz Grosse-Wentrup (University of Wien) for insightful feedback. This work was supported by the European Research Council Consolidator Grants n. 724208 (AMW) and n. 101002870 (CW), the New York Stem Cell Foundation (NYSCF) Robertson Award 2016 #NYSCF-R-NI39 (CW), the Human Frontier Science Program (HFSP) Research Grant #RGP0063/2018 (CW), the Fondation pour la Recherche Médicale Team grant (FRM- EQU202003010612) and the Fondation Bettencourt-Schueller #FBS-don-0031 (CW).</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahrens</surname><given-names>MB</given-names></name><name><surname>Orger</surname><given-names>MB</given-names></name><name><surname>Robson</surname><given-names>DN</given-names></name><name><surname>Li</surname><given-names>JM</given-names></name><name><surname>Keller</surname><given-names>PJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Whole-Brain functional imaging at cellular resolution using light-sheet microscopy</article-title><source>Nature Methods</source><volume>10</volume><fpage>413</fpage><lpage>420</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2434</pub-id><pub-id pub-id-type="pmid">23524393</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barnett</surname><given-names>L</given-names></name><name><surname>Seth</surname><given-names>AK</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The MVGC multivariate granger causality toolbox: a new approach to granger-causal inference</article-title><source>Journal of Neuroscience Methods</source><volume>223</volume><fpage>50</fpage><lpage>68</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2013.10.018</pub-id><pub-id pub-id-type="pmid">24200508</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barnett</surname><given-names>L</given-names></name><name><surname>Seth</surname><given-names>AK</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Detectability of granger causality for subsampled continuous-time neurophysiological processes</article-title><source>Journal of Neuroscience Methods</source><volume>275</volume><fpage>93</fpage><lpage>121</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2016.10.016</pub-id><pub-id pub-id-type="pmid">27826091</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barnett</surname><given-names>L</given-names></name><name><surname>Barrett</surname><given-names>AB</given-names></name><name><surname>Seth</surname><given-names>AK</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Solved problems for granger causality in neuroscience: a response to Stokes and purdon</article-title><source>NeuroImage</source><volume>178</volume><fpage>744</fpage><lpage>748</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2018.05.067</pub-id><pub-id pub-id-type="pmid">29883736</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bastos</surname><given-names>AM</given-names></name><name><surname>Schoffelen</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A tutorial review of functional connectivity analysis methods and their interpretational pitfalls</article-title><source>Frontiers in Systems Neuroscience</source><volume>9</volume><elocation-id>175</elocation-id><pub-id pub-id-type="doi">10.3389/fnsys.2015.00175</pub-id><pub-id pub-id-type="pmid">26778976</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brocard</surname><given-names>F</given-names></name><name><surname>Ryczko</surname><given-names>D</given-names></name><name><surname>Fénelon</surname><given-names>K</given-names></name><name><surname>Hatem</surname><given-names>R</given-names></name><name><surname>Gonzales</surname><given-names>D</given-names></name><name><surname>Auclair</surname><given-names>F</given-names></name><name><surname>Dubuc</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>The transformation of a unilateral locomotor command into a symmetrical bilateral activation in the brainstem</article-title><source>The Journal of Neuroscience</source><volume>30</volume><fpage>523</fpage><lpage>533</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3433-09.2010</pub-id><pub-id pub-id-type="pmid">20071515</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brovelli</surname><given-names>A</given-names></name><name><surname>Ding</surname><given-names>M</given-names></name><name><surname>Ledberg</surname><given-names>A</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Nakamura</surname><given-names>R</given-names></name><name><surname>Bressler</surname><given-names>SL</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Beta oscillations in a large-scale sensorimotor cortical network: directional influences revealed by granger causality</article-title><source>PNAS</source><volume>101</volume><fpage>9849</fpage><lpage>9854</lpage><pub-id pub-id-type="doi">10.1073/pnas.0308538101</pub-id><pub-id pub-id-type="pmid">15210971</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buss</surname><given-names>RR</given-names></name><name><surname>Drapeau</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Synaptic drive to motoneurons during fictive swimming in the developing zebrafish</article-title><source>Journal of Neurophysiology</source><volume>86</volume><fpage>197</fpage><lpage>210</lpage><pub-id pub-id-type="doi">10.1152/jn.2001.86.1.197</pub-id><pub-id pub-id-type="pmid">11431502</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cabelguen</surname><given-names>JM</given-names></name><name><surname>Bourcier-Lucas</surname><given-names>C</given-names></name><name><surname>Dubuc</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Bimodal locomotion elicited by electrical stimulation of the midbrain in the salamander Notophthalmus viridescens</article-title><source>The Journal of Neuroscience</source><volume>23</volume><fpage>2434</fpage><lpage>2439</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.23-06-02434.2003</pub-id><pub-id pub-id-type="pmid">12657703</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Carbo-Tano</surname><given-names>M</given-names></name><name><surname>Lapoix</surname><given-names>M</given-names></name><name><surname>Jia</surname><given-names>X</given-names></name><name><surname>Auclair</surname><given-names>F</given-names></name><name><surname>Dubuc</surname><given-names>R</given-names></name><name><surname>Wyart</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Functional Coupling of the Mesencephalic Locomotor Region and V2a Reticulospinal Neurons Driving Forward Locomotion</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2022.04.01.486703</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chartrand</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Numerical differentiation of noisy, nonsmooth data</article-title><source>ISRN Applied Mathematics</source><volume>2011</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.5402/2011/164564</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Randi</surname><given-names>F</given-names></name><name><surname>Leifer</surname><given-names>AM</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Searching for collective behavior in a small brain</article-title><source>Physical Review. E</source><volume>99</volume><elocation-id>052418</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.99.052418</pub-id><pub-id pub-id-type="pmid">31212571</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cohen</surname><given-names>MR</given-names></name><name><surname>Kohn</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Measuring and interpreting neuronal correlations</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>811</fpage><lpage>819</lpage><pub-id pub-id-type="doi">10.1038/nn.2842</pub-id><pub-id pub-id-type="pmid">21709677</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cong</surname><given-names>L</given-names></name><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Chai</surname><given-names>Y</given-names></name><name><surname>Hang</surname><given-names>W</given-names></name><name><surname>Shang</surname><given-names>C</given-names></name><name><surname>Yang</surname><given-names>W</given-names></name><name><surname>Bai</surname><given-names>L</given-names></name><name><surname>Du</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>K</given-names></name><name><surname>Wen</surname><given-names>Q</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Rapid whole brain imaging of neural activity in freely behaving larval zebrafish (<italic>Danio rerio</italic>)</article-title><source>eLife</source><volume>6</volume><elocation-id>e28158</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.28158</pub-id><pub-id pub-id-type="pmid">28930070</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Vico Fallani</surname><given-names>F</given-names></name><name><surname>Corazzol</surname><given-names>M</given-names></name><name><surname>Sternberg</surname><given-names>JR</given-names></name><name><surname>Wyart</surname><given-names>C</given-names></name><name><surname>Chavez</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Hierarchy of neural organization in the embryonic spinal cord: granger-causality graph analysis of <italic>in vivo</italic> calcium imaging data</article-title><source>IEEE Transactions on Neural Systems and Rehabilitation Engineering</source><volume>23</volume><fpage>333</fpage><lpage>341</lpage><pub-id pub-id-type="doi">10.1109/TNSRE.2014.2341632</pub-id><pub-id pub-id-type="pmid">25122836</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deisseroth</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Optogenetics</article-title><source>Nature Methods</source><volume>8</volume><fpage>26</fpage><lpage>29</lpage><pub-id pub-id-type="doi">10.1038/nmeth.f.324</pub-id><pub-id pub-id-type="pmid">21191368</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deshpande</surname><given-names>G</given-names></name><name><surname>LaConte</surname><given-names>S</given-names></name><name><surname>James</surname><given-names>GA</given-names></name><name><surname>Peltier</surname><given-names>S</given-names></name><name><surname>Hu</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Multivariate granger causality analysis of fMRI data</article-title><source>Human Brain Mapping</source><volume>30</volume><fpage>1361</fpage><lpage>1373</lpage><pub-id pub-id-type="doi">10.1002/hbm.20606</pub-id><pub-id pub-id-type="pmid">18537116</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fenno</surname><given-names>L</given-names></name><name><surname>Yizhar</surname><given-names>O</given-names></name><name><surname>Deisseroth</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The development and application of optogenetics</article-title><source>Annual Review of Neuroscience</source><volume>34</volume><fpage>389</fpage><lpage>412</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-061010-113817</pub-id><pub-id pub-id-type="pmid">21692661</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Florin</surname><given-names>E</given-names></name><name><surname>Gross</surname><given-names>J</given-names></name><name><surname>Pfeifer</surname><given-names>J</given-names></name><name><surname>Fink</surname><given-names>GR</given-names></name><name><surname>Timmermann</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>The effect of filtering on granger causality based multivariate causality measures</article-title><source>NeuroImage</source><volume>50</volume><fpage>577</fpage><lpage>588</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2009.12.050</pub-id><pub-id pub-id-type="pmid">20026279</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Francis</surname><given-names>NA</given-names></name><name><surname>Winkowski</surname><given-names>DE</given-names></name><name><surname>Sheikhattar</surname><given-names>A</given-names></name><name><surname>Armengol</surname><given-names>K</given-names></name><name><surname>Babadi</surname><given-names>B</given-names></name><name><surname>Kanold</surname><given-names>PO</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Small networks encode decision-making in primary auditory cortex</article-title><source>Neuron</source><volume>97</volume><fpage>885</fpage><lpage>897</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.01.019</pub-id><pub-id pub-id-type="pmid">29398362</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Francis</surname><given-names>NA</given-names></name><name><surname>Mukherjee</surname><given-names>S</given-names></name><name><surname>Koçillari</surname><given-names>L</given-names></name><name><surname>Panzeri</surname><given-names>S</given-names></name><name><surname>Babadi</surname><given-names>B</given-names></name><name><surname>Kanold</surname><given-names>PO</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Sequential transmission of task-relevant information in cortical neuronal networks</article-title><source>Cell Reports</source><volume>39</volume><elocation-id>110878</elocation-id><pub-id pub-id-type="doi">10.1016/j.celrep.2022.110878</pub-id><pub-id pub-id-type="pmid">35649366</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerhard</surname><given-names>F</given-names></name><name><surname>Kispersky</surname><given-names>T</given-names></name><name><surname>Gutierrez</surname><given-names>GJ</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name><name><surname>Kramer</surname><given-names>M</given-names></name><name><surname>Eden</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Successful reconstruction of a physiological circuit with known connectivity from spiking activity alone</article-title><source>PLOS Computational Biology</source><volume>9</volume><elocation-id>e1003138</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003138</pub-id><pub-id pub-id-type="pmid">23874181</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geweke</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>Measurement of linear dependence and feedback between multiple time series</article-title><source>Journal of the American Statistical Association</source><volume>77</volume><fpage>304</fpage><lpage>313</lpage><pub-id pub-id-type="doi">10.1080/01621459.1982.10477803</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geweke</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="1984">1984</year><article-title>Measures of conditional linear dependence and feedback between time series</article-title><source>Journal of the American Statistical Association</source><volume>79</volume><fpage>907</fpage><lpage>915</lpage><pub-id pub-id-type="doi">10.1080/01621459.1984.10477110</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goulding</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Circuits controlling vertebrate locomotion: moving in a new direction</article-title><source>Nature Reviews. Neuroscience</source><volume>10</volume><fpage>507</fpage><lpage>518</lpage><pub-id pub-id-type="doi">10.1038/nrn2608</pub-id><pub-id pub-id-type="pmid">19543221</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gow</surname><given-names>DW</given-names></name><name><surname>Segawa</surname><given-names>JA</given-names></name><name><surname>Ahlfors</surname><given-names>SP</given-names></name><name><surname>Lin</surname><given-names>FH</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Lexical influences on speech perception: a granger causality analysis of MEG and EEG source estimates</article-title><source>NeuroImage</source><volume>43</volume><fpage>614</fpage><lpage>623</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2008.07.027</pub-id><pub-id pub-id-type="pmid">18703146</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Granger</surname><given-names>CWJ</given-names></name></person-group><year iso-8601-date="1969">1969</year><article-title>Investigating causal relations by econometric models and cross-spectral methods</article-title><source>Econometrica</source><volume>37</volume><elocation-id>424</elocation-id><pub-id pub-id-type="doi">10.2307/1912791</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>S</given-names></name><name><surname>Seth</surname><given-names>AK</given-names></name><name><surname>Kendrick</surname><given-names>KM</given-names></name><name><surname>Zhou</surname><given-names>C</given-names></name><name><surname>Feng</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Partial granger causality -- eliminating exogenous inputs and latent variables</article-title><source>Journal of Neuroscience Methods</source><volume>172</volume><fpage>79</fpage><lpage>93</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2008.04.011</pub-id><pub-id pub-id-type="pmid">18508128</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haesemeyer</surname><given-names>M</given-names></name><name><surname>Robson</surname><given-names>DN</given-names></name><name><surname>Li</surname><given-names>JM</given-names></name><name><surname>Schier</surname><given-names>AF</given-names></name><name><surname>Engert</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A brain-wide circuit model of heat-evoked swimming behavior in larval zebrafish</article-title><source>Neuron</source><volume>98</volume><fpage>817</fpage><lpage>831</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.04.013</pub-id><pub-id pub-id-type="pmid">29731253</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Ke</surname><given-names>NR</given-names></name><name><surname>Bilaniuk</surname><given-names>O</given-names></name><name><surname>Goyal</surname><given-names>A</given-names></name><name><surname>Bauer</surname><given-names>S</given-names></name><name><surname>Larochelle</surname><given-names>H</given-names></name><name><surname>Schölkopf</surname><given-names>B</given-names></name><name><surname>Mozer</surname><given-names>MC</given-names></name><name><surname>Pal</surname><given-names>C</given-names></name><name><surname>Bengio</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Learning Neural Causal Models from Unknown Interventions</article-title><source>arXiv</source><pub-id pub-id-type="doi">10.48550/arXiv.1910.01075</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>S</given-names></name><name><surname>Putrino</surname><given-names>D</given-names></name><name><surname>Ghosh</surname><given-names>S</given-names></name><name><surname>Brown</surname><given-names>EN</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A granger causality measure for point process models of ensemble neural spiking activity</article-title><source>PLOS Computational Biology</source><volume>7</volume><elocation-id>e1001110</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1001110</pub-id><pub-id pub-id-type="pmid">21455283</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kimura</surname><given-names>Y</given-names></name><name><surname>Satou</surname><given-names>C</given-names></name><name><surname>Fujioka</surname><given-names>S</given-names></name><name><surname>Shoji</surname><given-names>W</given-names></name><name><surname>Umeda</surname><given-names>K</given-names></name><name><surname>Ishizuka</surname><given-names>T</given-names></name><name><surname>Yawo</surname><given-names>H</given-names></name><name><surname>Higashijima</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Hindbrain v2a neurons in the excitation of spinal locomotor circuits during zebrafish swimming</article-title><source>Current Biology</source><volume>23</volume><fpage>843</fpage><lpage>849</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2013.03.066</pub-id><pub-id pub-id-type="pmid">23623549</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kinkhabwala</surname><given-names>A</given-names></name><name><surname>Riley</surname><given-names>M</given-names></name><name><surname>Koyama</surname><given-names>M</given-names></name><name><surname>Monen</surname><given-names>J</given-names></name><name><surname>Satou</surname><given-names>C</given-names></name><name><surname>Kimura</surname><given-names>Y</given-names></name><name><surname>Higashijima</surname><given-names>SI</given-names></name><name><surname>Fetcho</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A structural and functional ground plan for neurons in the hindbrain of zebrafish</article-title><source>PNAS</source><volume>108</volume><fpage>1164</fpage><lpage>1169</lpage><pub-id pub-id-type="doi">10.1073/pnas.1012185108</pub-id><pub-id pub-id-type="pmid">21199947</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Masino</surname><given-names>MA</given-names></name><name><surname>Fetcho</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Fictive swimming motor patterns in wild type and mutant larval zebrafish</article-title><source>Journal of Neurophysiology</source><volume>93</volume><fpage>3177</fpage><lpage>3188</lpage><pub-id pub-id-type="doi">10.1152/jn.01248.2004</pub-id><pub-id pub-id-type="pmid">15673549</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meinshausen</surname><given-names>N</given-names></name><name><surname>Hauser</surname><given-names>A</given-names></name><name><surname>Mooij</surname><given-names>JM</given-names></name><name><surname>Peters</surname><given-names>J</given-names></name><name><surname>Versteeg</surname><given-names>P</given-names></name><name><surname>Bühlmann</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Methods for causal inference from gene perturbation experiments and validation</article-title><source>PNAS</source><volume>113</volume><fpage>7361</fpage><lpage>7368</lpage><pub-id pub-id-type="doi">10.1073/pnas.1510493113</pub-id><pub-id pub-id-type="pmid">27382150</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meshulam</surname><given-names>L</given-names></name><name><surname>Gauthier</surname><given-names>JL</given-names></name><name><surname>Brody</surname><given-names>CD</given-names></name><name><surname>Tank</surname><given-names>DW</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Coarse graining, fixed points, and scaling in a large population of neurons</article-title><source>Physical Review Letters</source><volume>123</volume><elocation-id>178103</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.123.178103</pub-id><pub-id pub-id-type="pmid">31702278</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nalatore</surname><given-names>H</given-names></name><name><surname>Ding</surname><given-names>M</given-names></name><name><surname>Rangarajan</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Mitigating the effects of measurement noise on granger causality</article-title><source>Physical Review. E, Statistical, Nonlinear, and Soft Matter Physics</source><volume>75</volume><elocation-id>031123</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.75.031123</pub-id><pub-id pub-id-type="pmid">17500684</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nguyen</surname><given-names>JP</given-names></name><name><surname>Shipley</surname><given-names>FB</given-names></name><name><surname>Linder</surname><given-names>AN</given-names></name><name><surname>Plummer</surname><given-names>GS</given-names></name><name><surname>Liu</surname><given-names>M</given-names></name><name><surname>Setru</surname><given-names>SU</given-names></name><name><surname>Shaevitz</surname><given-names>JW</given-names></name><name><surname>Leifer</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Whole-brain calcium imaging with cellular resolution in freely behaving <italic>Caenorhabditis elegans</italic></article-title><source>PNAS</source><volume>113</volume><fpage>E1074</fpage><lpage>E1081</lpage><pub-id pub-id-type="doi">10.1073/pnas.1507110112</pub-id><pub-id pub-id-type="pmid">26712014</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nicolaou</surname><given-names>N</given-names></name><name><surname>Hourris</surname><given-names>S</given-names></name><name><surname>Alexandrou</surname><given-names>P</given-names></name><name><surname>Georgiou</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Eeg-Based automatic classification of “ awake ” versus “ anesthetized ” state in general anesthesia using granger causality</article-title><source>PLOS ONE</source><volume>7</volume><elocation-id>e33869</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0033869</pub-id><pub-id pub-id-type="pmid">22457797</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oldfield</surname><given-names>CS</given-names></name><name><surname>Grossrubatscher</surname><given-names>I</given-names></name><name><surname>Chávez</surname><given-names>M</given-names></name><name><surname>Hoagland</surname><given-names>A</given-names></name><name><surname>Huth</surname><given-names>AR</given-names></name><name><surname>Carroll</surname><given-names>EC</given-names></name><name><surname>Prendergast</surname><given-names>A</given-names></name><name><surname>Qu</surname><given-names>T</given-names></name><name><surname>Gallant</surname><given-names>JL</given-names></name><name><surname>Wyart</surname><given-names>C</given-names></name><name><surname>Isacoff</surname><given-names>EY</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Experience, circuit dynamics, and forebrain recruitment in larval zebrafish prey capture</article-title><source>eLife</source><volume>9</volume><elocation-id>e56619</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.56619</pub-id><pub-id pub-id-type="pmid">32985972</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Pachitariu</surname><given-names>M</given-names></name><name><surname>Stringer</surname><given-names>C</given-names></name><name><surname>Dipoppa</surname><given-names>M</given-names></name><name><surname>Schröder</surname><given-names>S</given-names></name><name><surname>Rossi</surname><given-names>LF</given-names></name><name><surname>Dalgleish</surname><given-names>H</given-names></name><name><surname>Carandini</surname><given-names>M</given-names></name><name><surname>Harris</surname><given-names>KD</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Suite2p: Beyond 10,000 Neurons with Standard Two-Photon Microscopy</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/061507</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pujala</surname><given-names>A</given-names></name><name><surname>Koyama</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Chronology-based architecture of descending circuits that underlie the development of locomotor repertoire after birth</article-title><source>eLife</source><volume>8</volume><elocation-id>e42135</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.42135</pub-id><pub-id pub-id-type="pmid">30801247</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roebroeck</surname><given-names>A</given-names></name><name><surname>Formisano</surname><given-names>E</given-names></name><name><surname>Goebel</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Mapping directed influence over the brain using granger causality and fMRI</article-title><source>NeuroImage</source><volume>25</volume><fpage>230</fpage><lpage>242</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2004.11.017</pub-id><pub-id pub-id-type="pmid">15734358</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ryczko</surname><given-names>D</given-names></name><name><surname>Dubuc</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The multifunctional mesencephalic locomotor region</article-title><source>Current Pharmaceutical Design</source><volume>19</volume><fpage>4448</fpage><lpage>4470</lpage><pub-id pub-id-type="doi">10.2174/1381612811319240011</pub-id><pub-id pub-id-type="pmid">23360276</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ryczko</surname><given-names>D</given-names></name><name><surname>Auclair</surname><given-names>F</given-names></name><name><surname>Cabelguen</surname><given-names>JM</given-names></name><name><surname>Dubuc</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The mesencephalic locomotor region sends a bilateral glutamatergic drive to hindbrain reticulospinal neurons in a tetrapod</article-title><source>The Journal of Comparative Neurology</source><volume>524</volume><fpage>1361</fpage><lpage>1383</lpage><pub-id pub-id-type="doi">10.1002/cne.23911</pub-id><pub-id pub-id-type="pmid">26470600</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saint-Amant</surname><given-names>L</given-names></name><name><surname>Drapeau</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Synchronization of an embryonic network of identified spinal interneurons solely by electrical coupling</article-title><source>Neuron</source><volume>31</volume><fpage>1035</fpage><lpage>1046</lpage><pub-id pub-id-type="doi">10.1016/s0896-6273(01)00416-0</pub-id><pub-id pub-id-type="pmid">11580902</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seth</surname><given-names>AK</given-names></name><name><surname>Barrett</surname><given-names>AB</given-names></name><name><surname>Barnett</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Granger causality analysis in neuroscience and neuroimaging</article-title><source>The Journal of Neuroscience</source><volume>35</volume><fpage>3293</fpage><lpage>3297</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4399-14.2015</pub-id><pub-id pub-id-type="pmid">25716830</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Severi</surname><given-names>KE</given-names></name><name><surname>Böhm</surname><given-names>UL</given-names></name><name><surname>Wyart</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Investigation of hindbrain activity during active locomotion reveals inhibitory neurons involved in sensorimotor processing</article-title><source>Scientific Reports</source><volume>8</volume><elocation-id>13615</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-018-31968-4</pub-id><pub-id pub-id-type="pmid">30206288</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sheikhattar</surname><given-names>A</given-names></name><name><surname>Miran</surname><given-names>S</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Fritz</surname><given-names>JB</given-names></name><name><surname>Shamma</surname><given-names>SA</given-names></name><name><surname>Kanold</surname><given-names>PO</given-names></name><name><surname>Babadi</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Extracting neuronal functional network dynamics via adaptive granger causality analysis</article-title><source>PNAS</source><volume>115</volume><fpage>E3869</fpage><lpage>E3878</lpage><pub-id pub-id-type="doi">10.1073/pnas.1718154115</pub-id><pub-id pub-id-type="pmid">29632213</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shik</surname><given-names>M</given-names></name><name><surname>Severin</surname><given-names>F</given-names></name><name><surname>Orlovskiĭ</surname><given-names>G</given-names></name></person-group><year iso-8601-date="1966">1966</year><article-title>Upravlenie khod’boĭ i begom posredstvom elektricheskoĭ stimulatsii srednego mozga</article-title><source>Biofizika</source><volume>11</volume><fpage>659</fpage><lpage>666</lpage></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shojaie</surname><given-names>A</given-names></name><name><surname>Fox</surname><given-names>EB</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Granger causality: a review and recent advances</article-title><source>Annual Review of Statistics and Its Application</source><volume>9</volume><fpage>289</fpage><lpage>319</lpage><pub-id pub-id-type="doi">10.1146/annurev-statistics-040120-010930</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="software"><person-group person-group-type="author"><collab>Statistical Biophysics Consortium</collab></person-group><year iso-8601-date="2023">2023</year><data-title>ZebrafishGC</data-title><version designator="swh:1:rev:5d480ffadde77f224ffdb0c70d51a0d9a5b646bc">swh:1:rev:5d480ffadde77f224ffdb0c70d51a0d9a5b646bc</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:71327fe1d9d2117718f2e1498a6be399d519a3aa;origin=https://github.com/statbiophys/zebrafishGC;visit=swh:1:snp:4e84e444b7684c721710e1ce28e9379c38e7f2b5;anchor=swh:1:rev:5d480ffadde77f224ffdb0c70d51a0d9a5b646bc">https://archive.softwareheritage.org/swh:1:dir:71327fe1d9d2117718f2e1498a6be399d519a3aa;origin=https://github.com/statbiophys/zebrafishGC;visit=swh:1:snp:4e84e444b7684c721710e1ce28e9379c38e7f2b5;anchor=swh:1:rev:5d480ffadde77f224ffdb0c70d51a0d9a5b646bc</ext-link></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stokes</surname><given-names>PA</given-names></name><name><surname>Purdon</surname><given-names>PL</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A study of problems encountered in granger causality analysis from A neuroscience perspective</article-title><source>PNAS</source><volume>114</volume><fpage>E7063</fpage><lpage>E7072</lpage><pub-id pub-id-type="doi">10.1073/pnas.1704663114</pub-id><pub-id pub-id-type="pmid">28778996</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stringer</surname><given-names>C</given-names></name><name><surname>Pachitariu</surname><given-names>M</given-names></name><name><surname>Steinmetz</surname><given-names>N</given-names></name><name><surname>Reddy</surname><given-names>CB</given-names></name><name><surname>Carandini</surname><given-names>M</given-names></name><name><surname>Harris</surname><given-names>KD</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Spontaneous behaviors drive multidimensional, brainwide activity</article-title><source>Science</source><volume>364</volume><elocation-id>255</elocation-id><pub-id pub-id-type="doi">10.1126/science.aav7893</pub-id><pub-id pub-id-type="pmid">31000656</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tian</surname><given-names>L</given-names></name><name><surname>Hires</surname><given-names>SA</given-names></name><name><surname>Looger</surname><given-names>LL</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Imaging neuronal activity with genetically encoded calcium indicators</article-title><source>Cold Spring Harbor Protocols</source><volume>2012</volume><fpage>647</fpage><lpage>656</lpage><pub-id pub-id-type="doi">10.1101/pdb.top069609</pub-id><pub-id pub-id-type="pmid">22661439</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Venkatachalam</surname><given-names>V</given-names></name><name><surname>Ji</surname><given-names>N</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Clark</surname><given-names>C</given-names></name><name><surname>Mitchell</surname><given-names>JK</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Tabone</surname><given-names>CJ</given-names></name><name><surname>Florman</surname><given-names>J</given-names></name><name><surname>Ji</surname><given-names>H</given-names></name><name><surname>Greenwood</surname><given-names>J</given-names></name><name><surname>Chisholm</surname><given-names>AD</given-names></name><name><surname>Srinivasan</surname><given-names>J</given-names></name><name><surname>Alkema</surname><given-names>M</given-names></name><name><surname>Zhen</surname><given-names>M</given-names></name><name><surname>Samuel</surname><given-names>ADT</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Pan-neuronal imaging in roaming <italic>Caenorhabditis elegans</italic></article-title><source>PNAS</source><volume>113</volume><fpage>E1082</fpage><lpage>E1088</lpage><pub-id pub-id-type="doi">10.1073/pnas.1507109113</pub-id><pub-id pub-id-type="pmid">26711989</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Verny</surname><given-names>L</given-names></name><name><surname>Sella</surname><given-names>N</given-names></name><name><surname>Affeldt</surname><given-names>S</given-names></name><name><surname>Singh</surname><given-names>PP</given-names></name><name><surname>Isambert</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Learning causal networks with latent variables from multivariate information in genomic data</article-title><source>PLOS Computational Biology</source><volume>13</volume><elocation-id>e1005662</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005662</pub-id><pub-id pub-id-type="pmid">28968390</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vinck</surname><given-names>M</given-names></name><name><surname>Huurdeman</surname><given-names>L</given-names></name><name><surname>Bosman</surname><given-names>CA</given-names></name><name><surname>Fries</surname><given-names>P</given-names></name><name><surname>Battaglia</surname><given-names>FP</given-names></name><name><surname>Pennartz</surname><given-names>CMA</given-names></name><name><surname>Tiesinga</surname><given-names>PH</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>How to detect the granger-causal flow direction in the presence of additive noise?</article-title><source>NeuroImage</source><volume>108</volume><fpage>301</fpage><lpage>318</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2014.12.017</pub-id><pub-id pub-id-type="pmid">25514516</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Warp</surname><given-names>E</given-names></name><name><surname>Agarwal</surname><given-names>G</given-names></name><name><surname>Wyart</surname><given-names>C</given-names></name><name><surname>Friedmann</surname><given-names>D</given-names></name><name><surname>Oldfield</surname><given-names>CS</given-names></name><name><surname>Conner</surname><given-names>A</given-names></name><name><surname>Del Bene</surname><given-names>F</given-names></name><name><surname>Arrenberg</surname><given-names>AB</given-names></name><name><surname>Baier</surname><given-names>H</given-names></name><name><surname>Isacoff</surname><given-names>EY</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Emergence of patterned activity in the developing zebrafish spinal cord</article-title><source>Current Biology</source><volume>22</volume><fpage>93</fpage><lpage>102</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2011.12.002</pub-id><pub-id pub-id-type="pmid">22197243</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wen</surname><given-names>X</given-names></name><name><surname>Rangarajan</surname><given-names>G</given-names></name><name><surname>Ding</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Is granger causality a viable technique for analyzing fMRI data?</article-title><source>PLOS ONE</source><volume>8</volume><elocation-id>e67428</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0067428</pub-id><pub-id pub-id-type="pmid">23861763</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>D</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Xiao</surname><given-names>Y</given-names></name><name><surname>Cai</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Analysis of sampling artifacts on the granger causality analysis for topology extraction of neuronal dynamics</article-title><source>Frontiers in Computational Neuroscience</source><volume>8</volume><elocation-id>75</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2014.00075</pub-id><pub-id pub-id-type="pmid">25126067</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.81279.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Berman</surname><given-names>Gordon J</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03czfpz43</institution-id><institution>Emory University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><related-object id="sa0ro1" object-id-type="id" object-id="10.1101/2022.06.27.497721" link-type="continued-by" xlink:href="https://sciety.org/articles/activity/10.1101/2022.06.27.497721"/></front-stub><body><p>This important paper provides an in-depth analysis of the advantages and potential pitfalls of the application of Granger Causality (GC) to calcium imaging data, especially regarding various types of pre-processing. The authors' approach uses compelling rigor in arguing their points, and it is very clear how one would go about replicating their work. These results should be of interest to any researcher attempting to analyze calcium imaging data.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.81279.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Berman</surname><given-names>Gordon J</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03czfpz43</institution-id><institution>Emory University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2022.06.27.497721">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2022.06.27.497721v1">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Granger causality analysis for calcium transients in neuronal networks: challenges and improvements&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation has been overseen by Ronald Calabrese as the Senior Editor. The reviewers have opted to remain anonymous.</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>1) It was not clear to the reviewers what lessons are specific to the system they are studying and which ones are to be taken as more general lessons. Certainly, dealing with slow calcium dynamics, motion artifacts, and smoothing, are general problems in calcium imaging, but the reviewers were puzzled a bit about how to decide which neurons are &quot;strange&quot; without a lot of system-specific knowledge. This seems to be a rather important effect, and having a bit more guidance as to this point in the discussion would be useful.</p><p>2) It was not entirely sure what results one should take home from the hindbrain analysis. It is clear that there is a more-or-less global signal modulating all neural activity, but this is a common occurrence in population recordings (often, one subtracts this off via PCA or another means before proceeding). Is the general lack of causal links (via the MVGC at least) a generic phenomenon in recurrent networks, or is there something more system-specific here? Accordingly, it might be interesting to run a recurrent neural network simulation with similar properties to the hindbrain (and perhaps with correlated driving) to see what GC/MVGC would predict. Is there any hope of these methods finding information flow in recurrent networks, or should we restrict the method to networks where we expect the primary mode of information transmission to be feedforward? Either performing simulations or limiting the stated results to feedforward networks would be important.</p><p>3) The reviewers pointed out several studies that adapt the classical GC for both electrophysiology data and calcium imaging data (e.g., [1] A. Sheikhattar et al., &quot;Extracting Neuronal Functional Network Dynamics via Adaptive Granger Causality Analysis&quot;, PNAS, Vol. 115, No. 17, E3869-E3878, 2018. [2] N. A. Francis et al., &quot;Small Networks Encode Decision-Making in Primary Auditory Cortex&quot;, Neuron, Vol. 97, No. 4, 2018. [3] N. A. Francis et al., &quot;Sequential Transmission of Task-Relevant Information in Cortical Neuronal Networks&quot;, Cell Reports, Vol. 39, No. 9, 110878, 2022.). In reference [1], a variation of GC based on GLM log-likelihoods is proposed that addresses the issues of non-linearity, non-stationarity, and non-Gaussianity of electrophysiology data. In [2] and [3], a variation of GC using sparse multi-variate models is introduced with application to calcium imaging data. In particular, all three references use the sparse estimation of the MVAR parameters in order to mitigate overfitting and also use corrections for multiple comparisons that also reduce the number of spurious links. We suggest discussing these relevant references in the introduction (paragraphs 2 and 3) and discussion.</p><p>4) A major issue of GC applied to calcium imaging data is that the trials are typically limited in duration, which results in overfitting of the MVAR parameters when using least squares (See references [2] and [3] above, for example). The authors mention on page 4 that they use least squares to estimate the parameters. However, for the networks of ~10 neurons considered in this work, stationary trials of a long enough duration are required to estimate the parameters correctly. We suggest that the authors discuss this point and explicitly mention the trial durations and test whether the trial durations suffice for stable estimation of the MVAR parameters (this can be done by repeating some of the results on the synthetic data and using different trial lengths and then assessing the consistency of the detected GC links).</p><p>5) The definition of the &quot;knee&quot; of the average GC values as a function of the lag L needs to be a bit more formalized. In Figure 2H using the synthetic data, the &quot;knee&quot; effect is more clear, but in the real data shown in Figure 2I, the knee is not obvious, given that the confidence intervals are quite wide. Is there a way to quantify the &quot;knee&quot; by comparing the average GC values as well as their confidence bounds along the lag axis?</p><p>6) Another key element of existing GC methods applied to large-scale networks is dealing with the issue of multiple comparisons: for instance, in Figures 2, 3, 4, 6, 7, and 8, it seems like all arrows corresponding to all possible links are shown, where the colormap indicates the GC value. However, when performing multiple statistical tests, many of these links can be removed by a correction such as the Benjamini-Hochberg procedure. It seems that the authors did not consider any correction of multiple comparisons; we suggest doing so and adding this to your pipeline.</p><p>7) In Figure 5C, the values of W_IC for the MV cases seem to be more than 1, whereas by definition they should be less than or equal to 1. Please clarify.</p><p>8) Is there evidence that the lateralized and rostrocaudal connectivity of the motoneurons occurs at the time-scale of ~750 ms? Given that this time scale is long enough for multiple synapses, it could be the case that some contralateral and non-rostrocaudal connections could be &quot;real&quot;, as they reflect multi-hop synaptic connections. Please clarify.</p><p>9) Redundant signals: throughout the brain, it's expected that a population of neurons can encode the same information. It's unclear how GC (both the original and the modified versions) can handle this redundancy. Given how pervasive redundant signals are in the brain, this should be addressed in both simulation and experimental data. For example, in one of the manuscript's simulated networks, replace one neuron with 10 copies of it, each with identical inputs and outputs but with the weights scaled by 1/10. Such a network is functionally equivalent to the original but may pose some challenges for the various versions of GC. This issue may also account for the MVGC results in the hindbrain dataset. It might be more appropriate to apply GC to groups of neurons (as indeed the authors cited), instead of applying it at the single-cell level with redundant signals.</p><p>10) Both BVGC and MVGC appear to be extremely sensitive to any outlier signals. The most worrying aspect is that the authors developed their corrections and pipelines with the benefit of knowing the structure of the underlying system, whereas in the case where GC would be most useful, the user would be unable to rely on prior knowledge of the underlying structure. For instance, the motion artifact in Figure 3a-c was a helpful example of a vulnerability of naive GC, but one could easily imagine scenarios involving an unmeasured disturbance (e.g. the table is bumped) causing a similar artifact, but if the experimenter is unaware of such unmeasured disturbances then they will not be included in Z, and hence can result in the detection of widespread spurious links. There is a circularity here that's concerning. It seems that one already needs to have the answer (e.g. circuit connectivity) in order to clean up the data sufficiently for BVGC or MVGC to work effectively. Perhaps the authors would be interested in incorporating ideas from the systems identification literature, which can include the estimation of unmeasured disturbances, perhaps in conjunction with L1 regularization on the GC links. This is certainly out of scope for the present work, but it would be worth acknowledging the difficulties of unmeasured disturbances and deferring a general solution to future work. Similar considerations apply to a common unmeasured neuronal input (e.g. from a brain region not included in the field of view of the imaging).</p><p>11) Interpretation – would it be correct to state that BVGC identifies plausible causal links, while MVGC identifies a plausible system-level model? We think these interpretations, carefully stated, might provide a helpful way of thinking about the two GC approaches. Taking the results of the paper together, neither BVGC nor MVGC is definitive – BVGC may overestimate the true number of causal links but MVGC is prone to a winner-take-all phenomenon that may represent just one of many plausible system-level models that can account for the observed data. This should be more clearly stated in the manuscript.</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>There are numerous typos in the manuscript and some odd choices in the citations in the introduction. Given that there are still some major conceptual issues to address, I'll defer these to the future.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.81279.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) It was not clear to the reviewers what lessons are specific to the system they are studying and which ones are to be taken as more general lessons. Certainly, dealing with slow calcium dynamics, motion artifacts, and smoothing, are general problems in calcium imaging, but the reviewers were puzzled a bit about how to decide which neurons are &quot;strange&quot; without a lot of system-specific knowledge. This seems to be a rather important effect, and having a bit more guidance as to this point in the discussion would be useful.</p></disp-quote><p>We thank the reviewer for pointing out the lack of quantitative definition of the “strange” neurons. In this revision, we introduce a quantitative criteria to identify atypical calcium traces to exclude from the analysis, by recognizing that calcium transients of neurons decay typically with the same profile, i.e. similar decaying time constant when fitted to an exponential function.</p><p>If a calcium trace has a decay constant much longer (&gt; tens of s) than an average trace (~ 0.1-5 s), we infer that it’s not the trace of a neuron but likely a glial cell.</p><p>This method can be applied generally to systems with neurons expected to have the same characteristics in terms of excitability and calcium buffer. This is the method we already used to identify the time constant of calcium decay (<italic>τ = 2.5</italic>s) in Figure 3—figure supplement 1 (Figure S7 from first submission) and Results: GC analysis of motoneuron data: slow calcium timescale. In this figure, we now include the overlay of calcium transients from typical neurons as well as from atypical traces (the “strange” neurons). We have also changed the text in Results: GC analysis of motoneuron data: Removing strange neurons as follows:</p><p>“In general, cells whose calcium transients showed time decay of tens of seconds were identified as non neuronal cells and excluded from GC analysis (see overlays of calcium transients in Figure 3—Figure Supplement 1)”.</p><p>We also included in the discussion that this method can be generally applied to any other systems relying on calcium imaging to infer neuronal activity.</p><disp-quote content-type="editor-comment"><p>2) It was not entirely sure what results one should take home from the hindbrain analysis. It is clear that there is a more-or-less global signal modulating all neural activity, but this is a common occurrence in population recordings (often, one subtracts this off via PCA or another means before proceeding). Is the general lack of causal links (via the MVGC at least) a generic phenomenon in recurrent networks, or is there something more system-specific here? Accordingly, it might be interesting to run a recurrent neural network simulation with similar properties to the hindbrain (and perhaps with correlated driving) to see what GC/MVGC would predict. Is there any hope of these methods finding information flow in recurrent networks, or should we restrict the method to networks where we expect the primary mode of information transmission to be feedforward? Either performing simulations or limiting the stated results to feedforward networks would be important.</p></disp-quote><p>The reviewers are right. We have now replaced the network in Figure 1 with a more realistic network with feedback. We have also added a figure in the Supplementary Information (Figure 1—figure supplement 1), that tests the performance of GC on VAR dynamics run for randomly connected neurons (N = 10). Each underlying true interaction structure is sampled based on, <italic>P</italic><sub>connect</sub>, the probability that one neuron has a synaptic connection with the other, and also the connection strength <italic>c</italic>. As shown in Figure 1— figure supplement 1, MVGC performs well in identifying the true and only the true links when the interaction strength is large.</p><disp-quote content-type="editor-comment"><p>3) The reviewers pointed out several studies that adapt the classical GC for both electrophysiology data and calcium imaging data (e.g., [1] A. Sheikhattar et al., &quot;Extracting Neuronal Functional Network Dynamics via Adaptive Granger Causality Analysis&quot;, PNAS, Vol. 115, No. 17, E3869-E3878, 2018. [2] N. A. Francis et al., &quot;Small Networks Encode Decision-Making in Primary Auditory Cortex&quot;, Neuron, Vol. 97, No. 4, 2018. [3] N. A. Francis et al., &quot;Sequential Transmission of Task-Relevant Information in Cortical Neuronal Networks&quot;, Cell Reports, Vol. 39, No. 9, 110878, 2022.). In reference [1], a variation of GC based on GLM log-likelihoods is proposed that addresses the issues of non-linearity, non-stationarity, and non-Gaussianity of electrophysiology data. In [2] and [3], a variation of GC using sparse multi-variate models is introduced with application to calcium imaging data. In particular, all three references use the sparse estimation of the MVAR parameters in order to mitigate overfitting and also use corrections for multiple comparisons that also reduce the number of spurious links. We suggest discussing these relevant references in the introduction (paragraphs 2 and 3) and discussion.</p></disp-quote><p>We thank the reviewers for pointing out these references. While our GC pipeline focuses on preprocessing the calcium signal by denoising, and post-processing the resulting GC matrix by using an adaptive threshold, these previous studies mentioned by the reviewers emphasize more on modifying the underlying dynamics for GC in order to address the non-linear and non-gaussian dynamics in interacting neurons. In future work, it is of our interest to combine these two approaches. To bring this understanding to the readers, we have incorporated the following change of text. We have included in the introduction (paragraph 3) the following:</p><p>“New variations of GC accounting for sparsity in the connection have also been developed and applied on single-cell level to both spiking and calcium signals in the primary auditory cortex of mice (Sheikhattar et al. 2018; Francis et al., 2018, 2022).”</p><p>We also modified the Discussion section to include the above reference and added in the text, after we review the two important steps of our GC pipeline, the paragraph connecting our approach better to the body of literature:</p><p>“Our pipeline focuses on the pre-processing of the signals and the post-processing of the GC results. This effort is complementary to previous studies where new variations of GC were introduced to take into account the non-linear and non-gaussian dynamics in interacting neurons, for example by modifying the underlying VAR dynamics with GLM or VAR with sparsity constraints, and subsequently using adaptive thresholds for significance tests (Kim et al., 2011; Sheikhattar et al., 2018; Francis et al., 2018, 2022). Future work of interest includes combining these variations of GC with our pipeline.”</p><disp-quote content-type="editor-comment"><p>4) A major issue of GC applied to calcium imaging data is that the trials are typically limited in duration, which results in overfitting of the MVAR parameters when using least squares (See references [2] and [3] above, for example). The authors mention on page 4 that they use least squares to estimate the parameters. However, for the networks of ~10 neurons considered in this work, stationary trials of a long enough duration are required to estimate the parameters correctly. We suggest that the authors discuss this point and explicitly mention the trial durations and test whether the trial durations suffice for stable estimation of the MVAR parameters (this can be done by repeating some of the results on the synthetic data and using different trial lengths and then assessing the consistency of the detected GC links).</p></disp-quote><p>We thank the reviewers for pointing out the importance of the length of the time series in the GC calculation and the information missing to describe our dataset lengths. We address this comment with three additional pieces of supporting evidence.</p><p>First, we perform the simulation suggested by the reviewer. With the same underlying structure, we simulate two trials with length <italic>T</italic>, measure the GC values using each trial, and compute the Pearson’s correlation coefficient between the two sets of GC values as a measure of consistency of detecting GC links. The results are included in the Figure 1—figure supplement 3, showing that the stronger the coupling is, the smaller the sample size is required to reconstruct a consistent map of information flow.</p><p>Second, to compare with the ground truth, we use synthetic data to check the error rate of link detection as a function of trial lengths, the result of which is included in Figure 1—figure supplement 2. Specifically, we simulate GLM-Calcium dynamics on randomly connected networks, with a fixed probability of connection and a range of connection strength, for different trial durations, and we compute the accuracy of link detection. For MVGC, the accuracy depends on the connection strength. If the connection strength is large, then the true links are mostly detected. If the connection strength is small, then more true links are missed.</p><p>These numerical results prompt us to test how consistent the inferred GC matrix is for the zebrafish data, if we use only half of the data. If half of the existing time points are already sufficient to give consistent GC structures, then using all data (and more data) suffices for stable estimation. This is the case for the motoneuron data, which we show in the scatter plot of GC values inferred using the first halves vs. the second halves of each experimental trial. The GC values from the two halves have a Pearson’s correlation coefficient of 0.75 for MVGC, and 0.87 for BVGC. The results for motor neurons in the embryonic spinal cord are shown in an additional supplementary figure, Figure 2—figure Supplement 2.</p><p>For hindbrain data, the consistency is not as good. The Pearson’s correlation coefficient is 0.41 for MVGC and 0.76 for BVGC. We note that the similarity is higher for the motoneuron dataset due to the cyclic activity pattern leading to two similar halves.</p><p>We added in <italic>Results: GC analysis of motoneuron data: Naive GC</italic> the above results, specifically addressing the point of trial duration:</p><p>“… In order to verify that the length of the motoneuron dataset is sufficient to estimate the functional connectivity using Granger causality (see Figure 1—figure Supplement 2 and Figure 1--—figure supplement 3 for illustrations using synthetic data), we compared the two networks obtained by applying GC analysis to each half of the calcium imaging time series. The Pearson's correlation coefficient between the GC values from the two halves is 0.87 for BVGC, and 0.75 for MVGC (see Figure 2—figure Supplement 2), indicating the trial length is long enough for a consistent estimation of the GC values.”</p><p>We also added a supplementary figure to discuss the overfitting issue (Figure 8—figure Supplement 3). Specifically, we compare the resulting GC links for the hindbrain data, using VAR dynamics, and VAR plus regularization. We show that in MVGC, not observing many links is not purely a problem of overfitting. And that if including regularization, one still needs to use the adaptive threshold to increase the connection.</p><disp-quote content-type="editor-comment"><p>5) The definition of the &quot;knee&quot; of the average GC values as a function of the lag L needs to be a bit more formalized. In Figure 2H using the synthetic data, the &quot;knee&quot; effect is more clear, but in the real data shown in Figure 2I, the knee is not obvious, given that the confidence intervals are quite wide. Is there a way to quantify the &quot;knee&quot; by comparing the average GC values as well as their confidence bounds along the lag axis?</p></disp-quote><p>We thank the reviewers for asking for clarification. We can compare the average GC values as suggested, or the individual pairwise GC values when adding an extra lag. Using 3 lags or more yields very similar results, so we took the decision to keep the simplest model with fewest lags. To clarify, we added in Results: GC analysis of motoneuron data: Naive GC:</p><p>“This knee corresponds to the maximum lag with the best balance between accuracy and complexity: further increasing the maximum lag yields very similar results but the GC analysis becomes much more computationally expensive (Figure 2—figure supplement 1).”</p><p>The additional Figure 2—figure supplement 1 shows the “Comparison of Granger causality analysis results at different maximum lags. Correlation between the GC values obtained for each pair of neurons using max lag <italic>L</italic> and max lag <italic>L + 1</italic>. All fish (n=9) of the motoneuron data set are used and represented by color (same as Figure 7). The similarity in Granger causality values, measured by the Pearson correlation coefficient <italic>r</italic>, increases as <italic>L</italic> increases and then stabilizes after maximum lag <italic>L = 3</italic> (r = 0.97 both for BVGC and MVGC between <italic>L = 3</italic> and <italic>L = 4</italic>, as well as between L = 4 and <italic>L = 5</italic>), justifying our decision to use <italic>L = 3</italic>. Using a larger maximum lag does not bring more information but brings more complexity, and increases the computation time (especially for MVGC).”</p><disp-quote content-type="editor-comment"><p>6) Another key element of existing GC methods applied to large-scale networks is dealing with the issue of multiple comparisons: for instance, in Figures 2, 3, 4, 6, 7, and 8, it seems like all arrows corresponding to all possible links are shown, where the colormap indicates the GC value. However, when performing multiple statistical tests, many of these links can be removed by a correction such as the Benjamini-Hochberg procedure. It seems that the authors did not consider any correction of multiple comparisons; we suggest doing so and adding this to your pipeline.</p></disp-quote><p>In our original analysis, we had performed multiple comparisons by applying a Bonferroni correction to the p-value threshold. We now clarify this in the main text by adding in <italic>Results: Granger Causality</italic>, after Equation 7,</p><p>“…with the number of parameters adjusted accordingly in the reduced and the full model. The significant test is adjusted using multiple comparisons by applying a Bonferroni correction to the <italic>p</italic>-value threshold.”</p><disp-quote content-type="editor-comment"><p>7) In Figure 5C, the values of W_IC for the MV cases seem to be more than 1, whereas by definition they should be less than or equal to 1. Please clarify.</p></disp-quote><p>We thank the reviewers for carefully reading our submission. In our first submission, W<sub>IC</sub> can be more than 1 when the averaged GC value for contralateral links is negative (Equation 10)<italic>.</italic> This negative GC value can happen when the residuals of fitting from the full and from the reduced model are similar, and after dividing by the degrees of freedom, <italic>(T<sub>regr –</sub> M<sub>r</sub>)</italic> and <italic>(T<sub>regr –</sub> M<sub>f</sub>)</italic>, respectively, leads to <inline-formula><mml:math id="sa2m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>ε</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ε</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. We did not impose that GC value has to be nonnegative in our definition.</p><p>To improve clarity, we have introduced in the revisions the non-negativeness in the definition of GC in Equation 4 and 5 such that GC is defined as the maximum between 0 and the log of ratio of residuals. This way, the <italic>W<sub>IC</sub></italic> and <italic>W<sub>RC</sub></italic> will always be less than or equal to 1. We have changed Figure 5C accordingly. The problem of negative GC value does not occur in the results of GC applied to real motoneuron and hindbrain data.</p><disp-quote content-type="editor-comment"><p>8) Is there evidence that the lateralized and rostrocaudal connectivity of the motoneurons occurs at the time-scale of ~750 ms? Given that this time scale is long enough for multiple synapses, it could be the case that some contralateral and non-rostrocaudal connections could be &quot;real&quot;, as they reflect multi-hop synaptic connections. Please clarify.</p></disp-quote><p>In the spinal cord, motor neurons form synapses onto muscle fibers and are not synaptically connected among themselves. At the embryonic stage, motor neurons are part of an electronically-coupled network relying on GAP junctions. During twitches, motor neurons are recruited by excitatory neurons located in the hindbrain and enable their sequential activation from head to tail. We therefore use this dataset to infer flow of information, not synaptic connectivity. This important point is now added to the result section.</p><p>Physiologically, the two chains of motor neurons are not directly connected to each other. However, all motor neurons are controlled on each side by common driver neurons, in order to be sequentially activated (St Amant and Drapeau, Neuron 2001). Overall, each chain of neurons on one side can be recruited at a frequency up to 2hz, so with a typical 250ms time difference (Warp et al., Current Biology 2012; Wan et al., Cell 2019 https://pubmed.ncbi.nlm.nih.gov/31564455/). Depending on the position of a neuron in the focal plane of the spinning disk microscope, we have good reasons to think that the kinetics of the calcium transient could appear fast (in the plane) versus slow (out of the focal plane). This artifact may lead to variations in the apparent pattern of recruitment of motor neurons in the rostral caudal axis. This could explain why in the data, we sometimes observe differences in the recruitment pattern leading to a caudal motor neuron being activated a few hundreds milliseconds before a rostral one.</p><p>This physiological structure is explained in Results: GC analysis for motoneuron data: The data, when the motoneuron dataset is introduced. To further clarify that the ground truth is not strictly <italic>W<sub>RC</sub> = 1</italic>, we added in Results: GC analysis for motoneuron data: Defining directional biases, after the definition of</p><p><italic>W<sub>RC</sub></italic>:</p><p>“Notice that based on the anatomy, the ground truth of information flow can be smaller than <italic>W<sub>RC</sub> = 1</italic>, because motoneuron activity has been shown to rely on command neurons in the brainstem that activates motoneurons sequentially in the spinal cord, not that the motor neurons synapse onto each other.”</p><disp-quote content-type="editor-comment"><p>9) Redundant signals: throughout the brain, it's expected that a population of neurons can encode the same information. It's unclear how GC (both the original and the modified versions) can handle this redundancy. Given how pervasive redundant signals are in the brain, this should be addressed in both simulation and experimental data. For example, in one of the manuscript's simulated networks, replace one neuron with 10 copies of it, each with identical inputs and outputs but with the weights scaled by 1/10. Such a network is functionally equivalent to the original but may pose some challenges for the various versions of GC. This issue may also account for the MVGC results in the hindbrain dataset. It might be more appropriate to apply GC to groups of neurons (as indeed the authors cited), instead of applying it at the single-cell level with redundant signals.</p></disp-quote><p>We agree with the reviewer that the problem of redundant signals is subtle. Redundant signals are not equivalent to repeated signals. A repeated signal is an exact copy of another signal, which experimentally could come from a mis-partition of a single neuron. In this case, GC is unable to detect the correct links, especially the connection between the repeated neuron and the others. In contrast, redundant encoding is more in the structure of the network. Because of stochasticity, the dynamics of two neurons – with identical input and output weights to other neurons – can be different, as we test it on the network in Figure 1 with VAR and with GLM-Calcium dynamics. Such a difference in the dynamics allows MVGC to detect the true structure despite redundant encoding. We have added a paragraph in Results: GC analysis of a small synthetic neuronal net, and an additional supplementary figure (Figure 1 —figure supplement 7) to clarify this issue. The added text is:</p><p>“Redundant signals. In the brain, a population of neurons can encode redundant signals. If the redundancy is in the structure of the network, for example, when two neurons share the identical input and output, the stochasticity will lead to different neuronal dynamics, and MVGC is able to identify the true connection. However, if two neurons have exactly the same activity, MVGC will underestimate the causality, while BVGC can still reveal these connections (Figure 1— figure Supplement 7).”</p><p>The additional Figures 1 —figure supplement 7 shows:</p><p>Presence of redundant signals harms the performance of MVGC. GC analysis performed on synthetic data generated using VAR dynamics on the network structure in the main figure, for <italic>T = 5000</italic> data points. GC reveals all links for networks with redundant structures, where an “artificial” neuron 11 is created with identical input and output strength as neuron 1 (<italic>redundant structure, middle column</italic>). However, MVGC fails to identify causal links when the signal from neuron 1 is copied to create another “artificial” neuron 11 (<italic>redundant signal, right most column</italic>). BVGC is able to identify the underlying true connectivity.</p><p>For the hindbrain data in the last figure, we previously tried grouping the neurons. However, we find that the most correlated neurons are spatially located far from each other, as one would expect given that pairs of pre- and postsynaptic neurons may be connected through a very long axon. This makes grouping difficult: grouping neurons by correlation will disable us finding the spatial information flow, while grouping neurons by spatial proximity washes away meaningful signals.</p><disp-quote content-type="editor-comment"><p>10) Both BVGC and MVGC appear to be extremely sensitive to any outlier signals. The most worrying aspect is that the authors developed their corrections and pipelines with the benefit of knowing the structure of the underlying system, whereas in the case where GC would be most useful, the user would be unable to rely on prior knowledge of the underlying structure. For instance, the motion artifact in Figure 3a-c was a helpful example of a vulnerability of naive GC, but one could easily imagine scenarios involving an unmeasured disturbance (e.g. the table is bumped) causing a similar artifact, but if the experimenter is unaware of such unmeasured disturbances then they will not be included in Z, and hence can result in the detection of widespread spurious links. There is a circularity here that's concerning. It seems that one already needs to have the answer (e.g. circuit connectivity) in order to clean up the data sufficiently for BVGC or MVGC to work effectively. Perhaps the authors would be interested in incorporating ideas from the systems identification literature, which can include the estimation of unmeasured disturbances, perhaps in conjunction with L1 regularization on the GC links. This is certainly out of scope for the present work, but it would be worth acknowledging the difficulties of unmeasured disturbances and deferring a general solution to future work. Similar considerations apply to a common unmeasured neuronal input (e.g. from a brain region not included in the field of view of the imaging).</p></disp-quote><p>We corrected for unmeasured inputs by preprocessing the data using characteristic features for calcium transients, and not assuming any underlying network structures. As we expect, all calcium transients follow a fast rise and a slow decay that can be fitted by exponentials, disturbances such as the table being bumped can be identified and corrected. We also emphasize that knowing the underlying structure of the motoneuron network only prompts us to clean up the correlated noise, and that this method developed is applicable to general datasets without a priori known structures, such as the hindbrain dataset.</p><p>We thank the reviewers for pointing out literature in system identification theory. To provide more detailed context, we added in the Discussion section sentences on recent development of GC and other causality measures that considers hidden input, and discussed their advantages and disadvantages:</p><p>“Firstly, we emphasize that with current experimental techniques, only a small portion of the entire nervous system is recorded. While newer versions of GC have been adapted to take into consideration latent variables which contribute equally to all neurons [49], or through subsequent removal of causal links [50], GC does not in general allow identification of the true underlying connection in the presence of unobserved neurons. However, it is able to identify information flow and an effective functional causal network for the observed neurons.”</p><disp-quote content-type="editor-comment"><p>11) Interpretation – would it be correct to state that BVGC identifies plausible causal links, while MVGC identifies a plausible system-level model? We think these interpretations, carefully stated, might provide a helpful way of thinking about the two GC approaches. Taking the results of the paper together, neither BVGC nor MVGC is definitive – BVGC may overestimate the true number of causal links but MVGC is prone to a winner-take-all phenomenon that may represent just one of many plausible system-level models that can account for the observed data. This should be more clearly stated in the manuscript.</p></disp-quote><p>We agree with the referees, and have added the following sentences to <italic>Discussion</italic>:</p><p>“We also compared results from bivariate GC and multivariate GC analysis. While BVGC overestimate the true number of causal links, MVGC is prone to a winner-take-all phenomenon that may represent just one of many plausible system-level models that can account for the observed data. This is especially problematic when the signals are strongly correlated, for example, in the presence of redundant signals. In addition, MVGC is more prone to the issue of overfitting: we suggest using BVGC on datasets with large numbers (hundreds) of neurons, and MVGC on datasets with few tens of neurons. In general, starting with a small number of neurons of interest seems wise.”</p></body></sub-article></article>