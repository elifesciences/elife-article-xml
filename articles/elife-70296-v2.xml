<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">70296</article-id><article-id pub-id-type="doi">10.7554/eLife.70296</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Neuronal sequences during theta rely on behavior-dependent spatial maps</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-238264"><name><surname>Parra-Barrero</surname><given-names>Eloy</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5702-4466</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-16654"><name><surname>Diba</surname><given-names>Kamran</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5128-4478</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-109213"><name><surname>Cheng</surname><given-names>Sen</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6719-8029</contrib-id><email>sen.cheng@rub.de</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Institute for Neural Computation, Ruhr University Bochum</institution><addr-line><named-content content-type="city">Bochum</named-content></addr-line><country>Germany</country></aff><aff id="aff2"><label>2</label><institution>International Graduate School of Neuroscience, Ruhr University Bochum</institution><addr-line><named-content content-type="city">Bochum</named-content></addr-line><country>Germany</country></aff><aff id="aff3"><label>3</label><institution>Department of Anesthesiology, University of Michigan, Michigan Medicine</institution><addr-line><named-content content-type="city">Ann Arbor</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Colgin</surname><given-names>Laura L</given-names></name><role>Reviewing Editor</role><aff><institution>University of Texas at Austin</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Colgin</surname><given-names>Laura L</given-names></name><role>Senior Editor</role><aff><institution>University of Texas at Austin</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>18</day><month>10</month><year>2021</year></pub-date><pub-date pub-type="collection"><year>2021</year></pub-date><volume>10</volume><elocation-id>e70296</elocation-id><history><date date-type="received" iso-8601-date="2021-05-12"><day>12</day><month>05</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2021-10-15"><day>15</day><month>10</month><year>2021</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at biorxiv.</event-desc><date date-type="preprint" iso-8601-date="2021-04-14"><day>14</day><month>04</month><year>2021</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2021.04.14.439787"/></event></pub-history><permissions><copyright-statement>© 2021, Parra-Barrero et al</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>Parra-Barrero et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-70296-v2.pdf"/><abstract><p>Navigation through space involves learning and representing relationships between past, current, and future locations. In mammals, this might rely on the hippocampal theta phase code, where in each cycle of the theta oscillation, spatial representations provided by neuronal sequences start behind the animal’s true location and then sweep forward. However, the exact relationship between theta phase, represented position and true location remains unclear and even paradoxical. Here, we formalize previous notions of ‘spatial’ or ‘temporal’ theta sweeps that have appeared in the literature. We analyze single-cell and population variables in unit recordings from rat CA1 place cells and compare them to model simulations based on each of these schemes. We show that neither spatial nor temporal sweeps quantitatively accounts for how all relevant variables change with running speed. To reconcile these schemes with our observations, we introduce ‘behavior-dependent’ sweeps, in which theta sweep length and place field properties, such as size and phase precession, vary across the environment depending on the running speed characteristic of each location. These behavior-dependent spatial maps provide a structured heterogeneity that is essential for understanding the hippocampal code.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>hippocampus</kwd><kwd>place cell</kwd><kwd>theta oscillation</kwd><kwd>phase precession</kwd><kwd>theta sequence</kwd><kwd>neural coding</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Rat</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id><institution>German Research Foundation</institution></institution-wrap></funding-source><award-id>419037518 - FOR 2812,P2</award-id><principal-award-recipient><name><surname>Cheng</surname><given-names>Sen</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002347</institution-id><institution>Federal Ministry of Education and Research</institution></institution-wrap></funding-source><award-id>01GQ1506</award-id><principal-award-recipient><name><surname>Cheng</surname><given-names>Sen</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000025</institution-id><institution>National Institute of Mental Health</institution></institution-wrap></funding-source><award-id>NIMH R01MH109170</award-id><principal-award-recipient><name><surname>Diba</surname><given-names>Kamran</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A computational framework and analysis of rodent CA1 data reveals that theta oscillations sequentially sweep through the past, present, and future at a spatial scale that varies with the characteristic speed of the animal.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Hippocampal place cells elevate their firing rates within circumscribed regions in the environment (‘place fields’) (<xref ref-type="bibr" rid="bib55">O'Keefe and Dostrovsky, 1971</xref>). In addition to this firing rate code, place cells display phase coding relative to the ∼8 Hz theta oscillations of the hippocampal local field potential (LFP) (<xref ref-type="bibr" rid="bib75">Vanderwolf, 1969</xref>). As animals cross a cell’s place field, the cell fires at progressively earlier phases of the oscillation, a phenomenon known as theta phase precession (<xref ref-type="bibr" rid="bib56">O'Keefe and Recce, 1993</xref>). At the population level, phase precession yields distinct neuronal sequences that traverse multiple positions within each cycle of the theta oscillation. The first cells to fire typically have place fields centered behind the current position of the animal, followed by cells with place fields centered progressively ahead, generating so-called ‘theta sequences’ (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>; <xref ref-type="bibr" rid="bib65">Skaggs et al., 1996</xref>; <xref ref-type="bibr" rid="bib17">Dragoi and Buzsáki, 2006</xref>; <xref ref-type="bibr" rid="bib23">Foster and Wilson, 2007</xref>). Formally, the position <inline-formula><mml:math id="inf1"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> represented by the hippocampal population at time <inline-formula><mml:math id="inf2"><mml:mi>t</mml:mi></mml:math></inline-formula> appears to deviate from the physical location <inline-formula><mml:math id="inf3"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of the animal, sweeping from past to future positions during each theta cycle (<xref ref-type="bibr" rid="bib50">Maurer et al., 2012</xref>; <xref ref-type="bibr" rid="bib30">Gupta et al., 2012</xref>; <xref ref-type="bibr" rid="bib54">Muessig et al., 2019</xref>; <xref ref-type="bibr" rid="bib40">Kay et al., 2020</xref>; <xref ref-type="bibr" rid="bib79">Zheng et al., 2021</xref>). This phenomenon suggests that beyond the representation of the current spatial location of an animal, the hippocampal theta code more generally encompasses representations of past, present, and future events (<xref ref-type="bibr" rid="bib17">Dragoi and Buzsáki, 2006</xref>; <xref ref-type="bibr" rid="bib10">Cei et al., 2014</xref>; <xref ref-type="bibr" rid="bib71">Terada et al., 2017</xref>). In support of this, theta phase precession and theta sequences have been reported to respond to elapsed time (<xref ref-type="bibr" rid="bib57">Pastalkova et al., 2008</xref>; <xref ref-type="bibr" rid="bib64">Shimbo et al., 2021</xref>), particular events and behaviors including jumping (<xref ref-type="bibr" rid="bib45">Lenck-Santini et al., 2008</xref>), pulling a lever, and sampling an object (<xref ref-type="bibr" rid="bib71">Terada et al., 2017</xref>; <xref ref-type="bibr" rid="bib1">Aronov et al., 2017</xref>; <xref ref-type="bibr" rid="bib59">Robinson et al., 2017</xref>). Phase-precession and theta sequences have also been observed in brain regions other than the hippocampus (<xref ref-type="bibr" rid="bib42">Kim et al., 2012</xref>; <xref ref-type="bibr" rid="bib31">Hafting et al., 2008</xref>; <xref ref-type="bibr" rid="bib39">Jones and Wilson, 2005</xref>; <xref ref-type="bibr" rid="bib74">van der Meer and Redish, 2011</xref>; <xref ref-type="bibr" rid="bib72">Tingley et al., 2018</xref>; <xref ref-type="bibr" rid="bib69">Tang et al., 2021</xref>). These studies indicate that the theta phase code plays a supporting role in a wide array of cognitive functions, such as sequential learning (<xref ref-type="bibr" rid="bib48">Lisman and Idiart, 1995</xref>; <xref ref-type="bibr" rid="bib65">Skaggs et al., 1996</xref>; <xref ref-type="bibr" rid="bib58">Reifenstein et al., 2021</xref>), prediction (<xref ref-type="bibr" rid="bib49">Lisman and Redish, 2009</xref>; <xref ref-type="bibr" rid="bib40">Kay et al., 2020</xref>), and planning (<xref ref-type="bibr" rid="bib38">Johnson and Redish, 2007</xref>; <xref ref-type="bibr" rid="bib20">Erdem and Hasselmo, 2012</xref>; <xref ref-type="bibr" rid="bib7">Bolding et al., 2020</xref>; <xref ref-type="bibr" rid="bib9">Bush et al., 2015</xref>).</p><p>However, for the hippocampal theta phase code to be useful, there must be a consistent relationship between theta phase, represented position <inline-formula><mml:math id="inf4"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and the animal’s true location <inline-formula><mml:math id="inf5"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Surprisingly, this relationship has not previously been made explicit. It is often stated interchangeably that activity at certain phases of theta reflect positions ‘behind’ or ‘ahead’ of the animal, or, alternatively, in its ‘past’ or ‘future’, but these statements hint at two fundamentally different coding schemes. The first notion is that different theta phases encode positions at certain distances behind or ahead of the animal’s current location. For example, within each theta cycle, the represented position <inline-formula><mml:math id="inf6"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> could sweep from the position two meters behind the current location to the position two meters ahead. The hippocampus would thus represent positions shifted <italic>in space</italic>: we therefore refer to this coding scheme as the ‘spatial sweep’ model. The second notion is that the hippocampus represents positions that were or will be reached at some <italic>time</italic> intervals into the past or future, respectively. For example, <inline-formula><mml:math id="inf7"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> might start in the position that was reached 5 s ago and extend to the position projected 5 s into the future. We call this the ‘temporal sweep’ scheme. Notably, the temporal sweep predicts different distances depending on speed of movement. In such a sweep, walking down a hallway, the prospective position reached in 5 s might be a couple of meters ahead, whereas when driving on the highway that position could be more than a hundred meters away. Thus, in temporal sweeps, the look-behind and look-ahead distances adapt to the speed of travel, which could make for a more efficient code.</p><p>In the following, we set out to develop a quantitative description of the hippocampal theta phase code by formalizing the spatial and temporal sweep models and comparing them to experimental results. Intriguingly, different experimental results appear to support different models. One the one hand, the length of theta sweeps has been shown to increase proportionally with running speed (<xref ref-type="bibr" rid="bib50">Maurer et al., 2012</xref>; <xref ref-type="bibr" rid="bib30">Gupta et al., 2012</xref>), a result which is consistent with temporal sweeps. On the other hand, place field parameters, such as place field size or the slope of the spikes’ phase vs. position relationship (phase precession slope), do not change with speed (<xref ref-type="bibr" rid="bib33">Huxter et al., 2003</xref>; <xref ref-type="bibr" rid="bib50">Maurer et al., 2012</xref>; <xref ref-type="bibr" rid="bib61">Schmidt et al., 2009</xref>; <xref ref-type="bibr" rid="bib27">Geisler et al., 2007</xref>), which is consistent with spatial sweeps. To reconcile these apparently contradictory observations, we propose an additional coding scheme: the ‘behavior-dependent sweep' based on a behavior-dependent spatial map that varies according to the animal’s characteristic running speed at each location. We analyze recordings from rat CA1 place cells and in the same dataset reproduce the paradoxical results from different studies. Notably, we find that place fields are larger and have shallower phase precession slopes at locations where animals typically run faster, in support of the behavior-dependent sweep model. Finally, we compare simulated data generated from the three models based on experimentally measured trajectories and theta oscillations, and confirm that the behavior-dependent sweep uniquely accounts for the combination of experimental findings at the population and single-cell levels.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Formalizing the theta phase code</title><p>We first put forward a mathematical framework for quantitatively describing the relationship between the current location of the animal, <inline-formula><mml:math id="inf8"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and the position represented in the hippocampus at each moment in time, <inline-formula><mml:math id="inf9"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. While this framework considers the population representation, i.e. neuronal sequences during theta, the primary variable to be explained, it is linked to the activity of single place cells as follows. Each cell is considered to posses a ‘true place field’ (<xref ref-type="bibr" rid="bib60">Sanders et al., 2015</xref>; <xref ref-type="bibr" rid="bib47">Lisman and Grace, 2005</xref>), which corresponds to the positions represented by the cell, that is, a cell becomes active when the position represented by the population, <inline-formula><mml:math id="inf10"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, falls within the cell’s true place field. Note that due to the prospective and retrospective aspects of the theta phase code, <inline-formula><mml:math id="inf11"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> reaches behind and ahead of <inline-formula><mml:math id="inf12"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, so a place cell will also fire when the animal is located ahead or behind its true place field. This results in a measured place field that is larger than the underlying true place field. To stay consistent with the literature on place cells, in the following, when we refer to ‘place field’, we mean the measured place field.</p><p>First, we consider the spatial sweep scheme where the theta phase of a place cell’s spike reflects the distance traveled through the place field (<xref ref-type="bibr" rid="bib33">Huxter et al., 2003</xref>; <xref ref-type="bibr" rid="bib27">Geisler et al., 2007</xref>; <xref ref-type="bibr" rid="bib10">Cei et al., 2014</xref>) or equivalently, some measure of the distance to the field’s preferred position (<xref ref-type="bibr" rid="bib36">Jeewajee et al., 2014</xref>; <xref ref-type="bibr" rid="bib34">Huxter et al., 2008</xref>; <xref ref-type="bibr" rid="bib18">Drieu and Zugaro, 2019</xref>). In a uniform population of such phase coding neurons, the represented position, <inline-formula><mml:math id="inf13"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, sweeps forward within each theta cycle, starting at some distance behind the current location of the animal, <inline-formula><mml:math id="inf14"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and ending at some distance ahead. We formalize these spatial sweeps by the equation:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi>θ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mn>360</mml:mn></mml:mfrac></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf15"><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula>, which we call the theta distance, is a parameter that determines the extent of the spatial sweep, <inline-formula><mml:math id="inf16"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the instantaneous theta phase in degrees, and <inline-formula><mml:math id="inf17"><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> is the theta phase at which the population represents the actual position of the animal. The value of <inline-formula><mml:math id="inf18"><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> effectively determines the proportion of the theta cycle that lies behind vs ahead of the animal. We note that none of our results or analyses depends on the particular value of this variable.</p><p>At the single-cell level, the spatial sweep model predicts that the phases of a cell’s spikes will advance over a spatial range of <inline-formula><mml:math id="inf19"><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula>. Assuming that the phase advances over the whole theta cycle, the slope of spatial phase precession will be given by <inline-formula><mml:math id="inf20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mn>360</mml:mn><mml:mo>∘</mml:mo></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ13">Equation 13</xref> in Materials and methods). Place field sizes will be given by <inline-formula><mml:math id="inf21"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <italic>s</italic><sub>0</sub> is the size of the true place field (<xref ref-type="disp-formula" rid="equ14">Equation 14</xref> in Materials and methods). Both phase precession slopes and place field sizes are independent of running speed (<xref ref-type="fig" rid="fig1">Figure 1B</xref>), consistent with experimental observations (<xref ref-type="bibr" rid="bib33">Huxter et al., 2003</xref>; <xref ref-type="bibr" rid="bib61">Schmidt et al., 2009</xref>; <xref ref-type="bibr" rid="bib27">Geisler et al., 2007</xref>; Sup. Fig. 1 in <xref ref-type="bibr" rid="bib50">Maurer et al., 2012</xref>). At the population level, we can define the theta trajectory length as the difference between the maximum and minimum positions that <inline-formula><mml:math id="inf22"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> represents within a theta cycle. To a first-order approximation, that is, assuming that effects from acceleration and higher order derivatives are negligible, the theta trajectory length is given by <inline-formula><mml:math id="inf23"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf24"><mml:mi>v</mml:mi></mml:math></inline-formula> is the running speed, and <inline-formula><mml:math id="inf25"><mml:mi>T</mml:mi></mml:math></inline-formula> is the duration of a theta cycle (<xref ref-type="disp-formula" rid="equ11">Equation 11</xref> in Materials and methods). While the spatial sweep predicts that theta trajectory length increases with running speed, the increase is small since the term <inline-formula><mml:math id="inf26"><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>, which represents the change in <inline-formula><mml:math id="inf27"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> due to the animal’s motion during the theta cycle (<xref ref-type="fig" rid="fig1">Figure 1A</xref>, see also Figure 1 in <xref ref-type="bibr" rid="bib50">Maurer et al., 2012</xref>) is smaller than <inline-formula><mml:math id="inf28"><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> for usual running speeds. Contrary to this prediction, experimental results show that the theta trajectory length is roughly proportional to running speed (Figure 2 in <xref ref-type="bibr" rid="bib50">Maurer et al., 2012</xref>; Figure 1C in <xref ref-type="bibr" rid="bib30">Gupta et al., 2012</xref> for speeds above 5 cm/s).</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Simulated effect of running speed on population and single-cell properties in spatial sweep and temporal sweep models.</title><p>Certain findings in previous studies (green) paradoxically support the spatial sweep at the single-cell level, but the temporal sweep at the population level. (<bold>A</bold>) Left. At different phases of theta, the population represents positions shifted behind or ahead in space by <italic>fixed distances</italic>. Right. The black lines represents the rat’s actual location <inline-formula><mml:math id="inf29"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as it runs through a linear track; the color-coded lines indicate theta trajectories represented by the place cell population <inline-formula><mml:math id="inf30"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Since each theta trajectory starts and ends at fixed distances behind and ahead of the animal’s current location, the length of a theta trajectory increases slightly with running speed (37.5 vs. 31.9 cm) to account for the animal’s motion during the span of the theta cycle. (<bold>B</bold>) Left. At the single-cell level, the phases at which a cell spikes reflect the <italic>distances</italic> to the cell’s preferred location. Right. The cell’s preferred location is defined by its underlying 'true' place field (top). The cell fires proportionally to the activation of its true place field at <inline-formula><mml:math id="inf31"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, generating a phase precession cloud (middle) and corresponding measured place field (bottom). Phase precession slopes and place field sizes remain constant with running speed since, e.g., the cell always starts firing at 12 cm from the cell’s preferred location. (<bold>C</bold>) Left. At different phases of theta, the population represents the positions that were or will be reached at <italic>fixed time intervals</italic> into the past or future, respectively. Right. A higher running speed leads to a proportionally increased theta trajectory length since, e.g., the position that will be reached in 200 ms is further ahead in space at higher speeds. (<bold>D</bold>) Left. At the single-cell level, the phase of theta reflects the <italic>time</italic> to reach the cell’s preferred location. Right. At higher speed, the phase precession slope becomes shallower (−10.3 vs. −30.1 °/cm) and the size of the measured place field increases (50 vs. 40 cm) since, e.g., the cell will start signaling arrival at the cell’s preferred location in 200 ms from an earlier position in space.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70296-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Schematic illustration of the relationship between place fields, theta phase precession, and theta sequences.</title><p>Illustration of theta phase coding in spatial navigation. (<bold>A</bold>) A rat is running from left to right on a linear track. The firing rate of three place cells are indicated in different colors. (<bold>B</bold>) The idealized theta phase vs. position relationship for the spikes emitted by each of the cells shows a decrease in phase as the animal crosses the field (theta phase precession). (<bold>C</bold>) At the population level, phase precession manifests as spike sequences that represent, in a temporally compressed fashion, the sequence of place fields being traversed. The falling edge of the oscillation holds spikes from place cells with fields centered behind the current position of the rat, followed by spikes from cells with fields centered at the current position of the rat at the trough of the oscillation, and place cells with fields centered ahead in the rising edge.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70296-fig1-figsupp1-v2.tif"/></fig></fig-group><p>An alternative to the above is the temporal sweep model, where different phases of theta represent the positions that the animals have reached or will reach at some time interval in the past and future, respectively (see <xref ref-type="bibr" rid="bib35">Itskov et al., 2008</xref> for a similar model). More formally,<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi>θ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mn>360</mml:mn></mml:mfrac></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf32"><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> stands for the extent of the temporal sweep. To a first-order approximation, we derived for the theta trajectory length <inline-formula><mml:math id="inf33"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, which is proportional to running speed (<xref ref-type="disp-formula" rid="equ18">Equation 18</xref> in Materials and methods) (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). This is almost exactly the result reported by <xref ref-type="bibr" rid="bib50">Maurer et al., 2012</xref>; <xref ref-type="bibr" rid="bib30">Gupta et al., 2012</xref>. However, at the single-cell level, the temporal sweep model predicts that place field sizes increase and phase precession slopes become shallower with running speed (<xref ref-type="fig" rid="fig1">Figure 1D</xref>) – in clear conflict with the experimental results mentioned above. In particular, to a first-order approximation, theta phase precesses over the spatial range of <inline-formula><mml:math id="inf34"><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Thus, the slope of phase precession is given by <inline-formula><mml:math id="inf35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mn>360</mml:mn><mml:mo>∘</mml:mo></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, which increases hyperbolically with running speed (<xref ref-type="disp-formula" rid="equ19">Equation 19</xref> in Materials and methods). Place field sizes would in turn increase linearly with speed, determined by <inline-formula><mml:math id="inf36"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ20">Equation 20</xref> in Materials and methods).</p><p>These conflicting results could potentially arise from differences in analytical methods (e.g. definition of key parameters, comparisons within versus across cells) or experimental procedures (e.g. task difficulty due to the use of linear vs. circular or complex mazes). If this was the case, spatial or temporal sweeps could adequately describe the theta phase code, perhaps switching dynamically depending on the circumstances. Therefore, in the subsequent section, we attempt to reproduce and reexamine these different observations in the same dataset.</p><p>However, we also propose an additional scheme that, as it turns out, can potentially reconcile these findings. This third option combines the spatial sweep’s constant place field sizes and phase precession slopes with the temporal sweep’s increase in theta trajectory length with running speed. The former property requires that sweeps are independent of running speed whereas the latter requires that they depend on it. While at first this appears to be a plain contradiction, a resolution is offered if sweeps are made independent of the animal’s instantaneous running speed <inline-formula><mml:math id="inf37"><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, but dependent on their ‘characteristic running speed’ at each position <inline-formula><mml:math id="inf38"><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. This characteristic speed could be calculated as as a moving average (e.g. cumulative, exponentially weighted, etc.) as long as it evolves sufficiently slowly, so that it can filter out variation in <inline-formula><mml:math id="inf39"><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> from run to run. We refer to this model as the behavior-dependent sweep:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi>θ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mn>360</mml:mn></mml:mfrac></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>According to this model, at different phases of theta, the place cell population represents the positions that would have been or would be reached at certain time intervals in the past or future, like in the temporal sweep, but under the assumption that the animal runs at the characteristic speed through each location, rather than at the instantaneous running speed (<xref ref-type="fig" rid="fig2">Figure 2A,B</xref>). To avoid confusion in the following, when we use the terms ‘speed’ or ‘running speed’ without further qualifiers, we always refer to the instantaneous running speed. In the behavioral-dependent scheme, to a first-order approximation the length of a theta trajectory is given by <inline-formula><mml:math id="inf40"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ22">Equation 22</xref> in Materials and methods). Thus, the more stereotyped the behavior of the animal is (i.e. <inline-formula><mml:math id="inf41"><mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>), the more the behavior-dependent sweep model would share the temporal sweep model’s feature that theta trajectory length increases proportionally with running speed. At the same time, the behavior-dependent sweep model is formally equivalent to the spatial sweep model (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>) with a theta distance that depends on the characteristic running speed at each position: <disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>The behavior-dependent sweep integrates aspects of both spatial and temporal sweeps.</title><p>Simulated data plotted as in <xref ref-type="fig" rid="fig1">Figure 1A and C</xref>. (<bold>A</bold>) Different phases of theta represent positions reached at different time intervals into the past or future assuming the animal ran at the characteristic speed at that location. (<bold>B</bold>) Comparison of theta trajectory lengths in areas of low and fast characteristic running speed (rows) at low and fast instantaneous running speeds (columns). When both characteristic and instantaneous running speeds coincide, the behavior-dependent sweep model and the first-order approximation of the temporal sweep model agree (ochre arrow). On the other hand, when changing the instantaneous speed at a given location, the behavior-dependent and spatial sweeps agree (orange arrow). Theta trajectory length is primarily determined by characteristic running speed. Instantaneous running speed has a modest effect caused by the larger change in <inline-formula><mml:math id="inf42"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> during the theta cycle at higher speeds. Place fields (right) are larger in areas of higher characteristic running speed, but do not change size with instantaneous running speed.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70296-fig2-v2.tif"/></fig><p>Therefore, place fields, being fixed in space, remain unaltered by the instantaneous running speed, similar to in the spatial sweep model (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). However, in regions of higher characteristic running speed, place fields are characterized by larger sizes and shallower phase precession slopes. Specifically, the slope of phase precession is given by <inline-formula><mml:math id="inf43"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mn>360</mml:mn><mml:mo>∘</mml:mo></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover><mml:mi>v</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ23">Equation 23</xref> in Materials and methods); and the place field size would be <inline-formula><mml:math id="inf44"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ24">Equation 24</xref> in Materials and methods).</p></sec><sec id="s2-2"><title>Theta trajectory lengths increase proportionally with running speed</title><p>To better evaluate the conflicting observations across the afore-mentioned studies, we next sought to reproduce their separate observations on the effect of running speed on population-level theta trajectories and single-neuron place field parameters within the same dataset and compare these against predictions from the three theta phase coding models.</p><p>To this end, we re-analyzed publicly available simultaneous single unit recordings from CA1 of 6 rats running on linear tracks for water rewards at both ends. Three of the sessions (<xref ref-type="bibr" rid="bib53">Mizuseki et al., 2013</xref>) were from tracks that were familiar to the animal while the remaining three <xref ref-type="bibr" rid="bib28">Grosmark et al., 2016</xref> were from novel tracks. To ensure that spatial representations and theta phase precession were stable for the entirety of the periods under examination, we discarded the first 5 min of the recording on the novel track, allowing sufficient time for hippocampal place fields and phase precession to have stabilized (<xref ref-type="bibr" rid="bib24">Frank et al., 2004</xref>; <xref ref-type="bibr" rid="bib13">Cheng and Frank, 2008</xref>).</p><p>First, we examined the effect of running speed on theta trajectory length. We performed a Bayesian decoding of positions from the ensemble neuronal firing (<xref ref-type="bibr" rid="bib78">Zhang et al., 1998</xref>; <xref ref-type="bibr" rid="bib14">Davidson et al., 2009</xref>) within each theta cycle in overlapping 90° bins with a step size of 30°. <xref ref-type="fig" rid="fig3">Figure 3A</xref> shows examples of individual decoded theta trajectories belonging to periods of slow (below 20 cm/s) and fast (above 40 cm/s) running in a sample experimental session. The lengths of the trajectories were measured from best-fit lines. Despite the high level of variability, it was clear in the individual rats’ averages and in the grand average across animals that the trajectory lengths increased roughly proportionately to running speed (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). We saw the same effect when we averaged the decoded position probabilities over all cycles belonging to the same speed bin before fitting a line and calculating the theta trajectory length (<xref ref-type="fig" rid="fig3">Figure 3C,D</xref>). For this analysis, we defined seven 20 cm/s wide overlapping speed bins starting at 2 cm/s in increments of 10 cm/s. Thus, our results on the dependence of theta trajectory lengths on running speed were consistent with those of <xref ref-type="bibr" rid="bib50">Maurer et al., 2012</xref> and <xref ref-type="bibr" rid="bib30">Gupta et al., 2012</xref>, and appear to be supportive of the temporal sweep model. Alternatively, the results could be accounted for by the behavior-dependent sweep model, if running behavior was sufficiently stereotyped across the track, a question to which we return below.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Theta trajectory lengths increase proportionally with running speed.</title><p>(<bold>A</bold>) A random sample of theta sequences from a representative experimental session, with position probabilities decoded from the population spikes. Zero corresponds to the actual position of the rat at the middle of the theta cycle; negative positions are behind and positive ones, ahead. Orange lines indicate linear fits, from which theta trajectory lengths are computed. White pixels correspond to positions outside of the track or phase bins with no spikes. The red number at the lower right corner indicates the running speed in cm/s. (<bold>B</bold>) Moving averages for theta trajectory length for each animal using a 10 cm/s wide sliding window (colored lines). These averages are averaged again (thick black line) to obtain a grand average that weighs all animals equally. Shaded region indicates a standard deviation around the mean of all data points pooled across animals, which weigh each theta sequence equally. This mean does not necessarily match the grand average since different animals contribute different numbers of theta sequences. (<bold>C</bold>) Similar to A, but averaging the decoded probabilities across theta cycles belonging to the same speed bin indicated above the panel. (<bold>D</bold>) Similar to B for the averaged cycles, confirming the observation in B.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70296-fig3-v2.tif"/></fig></sec><sec id="s2-3"><title>Individual place field sizes are independent of running speed</title><p>We next analyzed the effect of running speed on place field size. First, we calculated firing rates separately for periods with different running speeds using the same speed bins as before. As the number of trials in each spatial bin at a given running speeds were limited, we calculated place field sizes only when a field was sufficiently well sampled at a given speed (see Materials and methods). Visual inspection revealed that individual fields tended to maintain similar sizes regardless of running speed (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). To quantify the relationship more systematically, we performed linear regression on place field size vs. speed for each field and examined the slopes of the best fitting lines (<xref ref-type="fig" rid="fig4">Figure 4A</xref>, bottom row). <xref ref-type="fig" rid="fig4">Figure 4B</xref> shows that for each rat, slopes variably took on both negative and positive values, with no clear bias towards either (<inline-formula><mml:math id="inf45"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula>, Wilcoxon signed-rank test). Thus, we found no evidence for a systematic increase in place field size with running speed.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Place field size increases with running speed when combining data across fields, but not for individual fields.</title><p>(<bold>A</bold>) The size of a given place field remains roughly constant regardless of running speed in examples from three individual place fields (one per column). Dashed gray lines represent the extent of the place fields calculated from the complete set of spikes at all running speeds. Black lines mark the extent of the place field calculated for each speed bin. Where only one end of the place field could be determined (e.g., field 3, third and fourth rows), place field size was set to twice the distance from the field’s peak (orange star) to the detected field end (see Materials and methods). Thin gray lines represent the occupancy (time spent) per spatial bin (axis on the right). At the bottom, linear regressions on place field size versus running speed for each place field. Fields 2 and 3 belong to the same cell. (<bold>B</bold>) The slopes from linear regression of place field size vs. running speed for all place fields, sorted for each animal. Across the population of place fields, slopes were not significantly different from zero (indicated p values). The size of the dot reflects the number of data points that contributed to the regression. The black vertical lines indicate the weighted averages of these slopes for each animal. The gray lines indicate the slope of the regression calculated by first pooling together data points from all place fields for each animal. (<bold>C</bold>) Remarkably, when combining data across fields, the average field size generally increases as a function of running speed. Colored lines represent individual animals, and the thick black line averages over them. Shading represents the standard deviation around the mean of all data points pooled across animals.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70296-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Restricting the theta trajectory length analysis to areas covered by the place fields analyzed does not change the results meaningfully.</title><p>Theta trajectory lengths remain unchanged when restricting the analysis to theta cycles occurring in areas covered by place field analyses. Same analysis as in <xref ref-type="fig" rid="fig3">Figure 3D</xref>, but pooling only theta cycles occurring in portions of the track that are covered by place fields included in the place field size or phase precession slope analyses.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70296-fig4-figsupp1-v2.tif"/></fig></fig-group><p>Intriguingly, however, when we combined all place field sizes corresponding to each speed bin, we uncovered a linear relationship between place-field size and speed (<xref ref-type="fig" rid="fig4">Figure 4C</xref>; <inline-formula><mml:math id="inf46"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.02</mml:mn></mml:mrow></mml:math></inline-formula> for the association between place field sizes combined across fields and speed bin for five of the six animals, Kendall’s <inline-formula><mml:math id="inf47"><mml:mi>τ</mml:mi></mml:math></inline-formula> test). This increase in place field sizes is consistent with the temporal sweep model, whereas the lack of within-field changes mentioned above supports spatial sweeps. Both findings, however, can be consistent with the behavior-dependent sweep model provided that place fields are larger in track areas characterized by faster running (<xref ref-type="fig" rid="fig2">Figure 2</xref>). We examine this question below.</p></sec><sec id="s2-4"><title>Phase precession slopes of individual place fields are independent of running speed</title><p>Similarly conflicting results were obtained when analyzing phase precession. We calculated phase precession slopes at each running speed bin for each field separately by pooling spikes across different field traversals according to the instantaneous running speed of the animal when the spikes were emitted. <xref ref-type="fig" rid="fig5">Figure 5A</xref> shows the results of this analysis for three example place fields. To ensure that we capture and adequately describe steep phase precession in small place fields (e.g. <xref ref-type="fig" rid="fig1">Figure 1D</xref>), we devised a method using orthogonal regression (see Materials and methods). An analysis of all place fields (<xref ref-type="fig" rid="fig5">Figure 5B</xref>) revealed that phase precession slopes of individual fields did not change systematically with running speed for any of the six animals (<inline-formula><mml:math id="inf48"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>, Wilcoxon signed-rank test). Remarkably, however, when we combined phase precession slopes across different fields for each speed bin, the combined slopes at slower speeds tended to be steeper than at faster speeds (<xref ref-type="fig" rid="fig5">Figure 5C</xref>; <inline-formula><mml:math id="inf49"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.006</mml:mn></mml:mrow></mml:math></inline-formula> for the association between phase precession slopes combined across fields and speed for five of the six animals, Kendall’s <inline-formula><mml:math id="inf50"><mml:mi>τ</mml:mi></mml:math></inline-formula> test).</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Phase precession slope increases with running speed when combining data across fields, but not for individual fields.</title><p>(<bold>A</bold>) Example phase precession slopes at different speeds for three fields. Instantaneous speeds when the spikes where emitted are color coded. Thin gray line displays the occupancy. At the bottom, linear regressions on phase precession slope versus running speed for each place field. (<bold>B</bold>) Similar to <xref ref-type="fig" rid="fig4">Figure 4B</xref> for the slopes of the linear regressions on phase precession slope vs. running speed for individual fields. (<bold>C</bold>) Similar to <xref ref-type="fig" rid="fig4">Figure 4C</xref> for phase precession slopes combined across fields for each speed bin. (<bold>D</bold>) Example phase precessions in single passes through two place fields (rows) sorted by running speed (upper right corner, in cm/s). Color code as in A. (<bold>E, F</bold>) Same as in B and C but for single-trial phase precession slopes. The means for each animal in F were calculated as a moving average on a 10 cm/s wide sliding window.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70296-fig5-v2.tif"/></fig><p>In this analysis, when rats accelerate or decelerate through a field, different parts of the field’s phase precession cloud are sampled at different running speeds. This can be seen in the first field (no. 4) in <xref ref-type="fig" rid="fig5">Figure 5A</xref>. Since the rat was accelerating through the field, spikes emitted at lower and higher speeds appeared more frequently at the beginning and end of the field, respectively. Phase precession clouds have some curvature (<xref ref-type="bibr" rid="bib66">Souza and Tort, 2017</xref>; <xref ref-type="bibr" rid="bib77">Yamaguchi et al., 2002</xref>), so sampling different parts of the field under acceleration or deceleration could lead to a spurious relationship between speed and phase precession slope. To avoid this confound, we further analyzed phase precession slopes in single passes through a field (<xref ref-type="bibr" rid="bib61">Schmidt et al., 2009</xref>). We only included passes that occurred at approximately constant speed, that is, passes with a coefficient of variation in speed lower than 0.3. <xref ref-type="fig" rid="fig5">Figure 5D</xref> shows examples of individual passes through two fields, sorted by running speed. Note how, notwithstanding variability in the slopes, there is no systematic change with running speed, even though the speeds nearly double. There was no significant relationship between phase precession slope and speed for individual fields in any of the three animals with sufficient data for this analysis, that is, more than 10 fields (<xref ref-type="fig" rid="fig5">Figure 5E</xref>). Yet again, when we combined phase precession slopes across place fields, we saw that they become shallower with speed (<inline-formula><mml:math id="inf51"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.04</mml:mn></mml:mrow></mml:math></inline-formula> for five of the six animals, Kendall’s <inline-formula><mml:math id="inf52"><mml:mi>τ</mml:mi></mml:math></inline-formula> test; <xref ref-type="fig" rid="fig5">Figure 5F</xref>). Hence, the results from single pass phase precession analysis confirm those obtained from the session-wide analysis.</p></sec><sec id="s2-5"><title>Theta trajectories and place field parameters vary according to characteristic running speed across the track</title><p>We have shown that theta trajectory lengths and place field sizes increase with running speed, and phase precession slopes become shallower, when combining data-points from different positions along the track or place fields (<xref ref-type="fig" rid="fig3">Figure 3B,D</xref>; <xref ref-type="fig" rid="fig4">Figure 4C</xref> and <xref ref-type="fig" rid="fig5">Figure 5C,F</xref>), but not when fields are analyzed individually (<xref ref-type="fig" rid="fig4">Figure 4B</xref> and <xref ref-type="fig" rid="fig5">Figure 5B,E</xref>). While these combined findings appear counter-intuitive, the behavior-dependent sweep model offers a simple explanation: short theta trajectories and small place field sizes could occur at locations where animals tend to run slowly, contributing to the low-speed averages, while long theta trajectories and large place field sizes could occur where animals tend to run fast, contributing to the fast-speed averages (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). For this explanation to be valid, the following prerequisites must hold: (1) running speeds should differ systematically along the track such that (2) place fields in different positions contribute differently to the low- and high-speed analyses; and (3) theta trajectory lengths, place field sizes and the inverse of phase precession slopes depend linearly on the characteristic speed across different locations (<xref ref-type="disp-formula" rid="equ22 equ23 equ24">Equation 22-24)</xref>.</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Structured place field and theta trajectory heterogeneity correlates with characteristic speed.</title><p>(<bold>A</bold>) Potential explanation for the increase in average theta trajectory length, place field size and phase precession slopes with speed despite the lack of systematic within-field changes. The histogram shows the distribution of running speeds by positions for rightward runs in one experimental session. The thick red line is the characteristic speed, defined as the mean speed after discarding trials with running speed &lt; 10 cm/s in the center of the track (exclusion criteria indicated by dotted red line). Running speeds tend to cluster around the characteristic speed. (<bold>B</bold>) Average characteristic speed as a function of the normalized distance from the start of the run for each animal (colored lines) and the grand average across animals (thick black line). Shaded region as in <xref ref-type="fig" rid="fig3">Figure 3B</xref>. (<bold>C</bold>) The proportion of fields sufficiently sampled for place field analysis at a certain speed bin falls steeply with the deviation between the speed bin and the mean characteristic speed through the field. Grey bars indicate averages across animals. (<bold>D</bold>) Histogram of individual theta trajectory lengths across the track for all animals combined and their mean (red line). Negative values correspond to theta trajectories going in the opposite directional as running. (<bold>E</bold>) Place field sizes and (<bold>F</bold>) the inverse of phase precession slopes across the track for each animal (colored dots), and their moving average with a window size of 0.1 (normalized units; black lines). (<bold>G</bold>) Histogram of theta trajectory lengths (with mean [red line] and linear fit [black line]) versus characteristic running speed for locations where each trajectory was observed. (<bold>H</bold>) Place fields are larger and with (<bold>I</bold>) shallower phase precession slopes for fields with higher mean characteristic speed. Solid black lines represent moving averages with a window size of 15 cm/s, and dashed lines indicate linear fits.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70296-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Like D, G, separated by animal.</title><p>Theta trajectory lengths vary across the track and correlate with characteristic running speed. Histograms of theta trajectory lengths as a function of normalized distance from the start of the run (first row) and characteristic running speed at the position where the theta trajectory occurred (second row). The red lines indicates mean values, and black lines, linear fits. p-Values are indicated for Kendall’s <inline-formula><mml:math id="inf53"><mml:mi>τ</mml:mi></mml:math></inline-formula> tests.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70296-fig6-figsupp1-v2.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 2.</label><caption><title>Like E, F, H, and I, separated by animal.</title><p>Place field sizes and phase precession slopes vary across the track and correlate with characteristic running speed. (<bold>A</bold>) Place field sizes as a function of distance from the start of the run (first row), and characteristic speed through the field (second row). Each column contains data for one animal. Different colors for each animal represent different experimental sessions. Each point is a place field. Thick black lines indicate moving averages with sliding windows of 15 cm and 15 cm/s for distance and speed, respectively (minimum three points per window). Dashed lines correspond to linear fits. p-Values are indicated for Kendall’s <inline-formula><mml:math id="inf54"><mml:mi>τ</mml:mi></mml:math></inline-formula> tests, null hypothesis: no association between place field size and characteristic speed. (<bold>B</bold>) Same as above but for the inverse of phase precession slopes.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70296-fig6-figsupp2-v2.tif"/></fig><fig id="fig6s3" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 3.</label><caption><title>Linear relationships between place field sizes, phase precession slopes, and theta trajectory lengths.</title><p>Place field sizes, phase precession slopes, and theta trajectory lengths correlate with one another. (<bold>A</bold>) The inverse of phase precession slope correlates strongly with place field size. Colored dots indicate individual place fields from different animals. The solid line represents a moving average with a window size of 15 cm, and the dashed line, a linear fit. (<bold>B</bold>) Histogram of theta trajectory lengths as a function of the mean place field size or (<bold>C</bold>) mean inverse phase precession slope in 15 cm wide windows centered at the positions where the theta trajectories occurred (black lines in <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>). Changing the size of the moving average window to 10 cm/s or lower, or 20 cm/s or higher decreased the value of the correlations. The red lines indicates mean values, and black lines, linear fits.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70296-fig6-figsupp3-v2.tif"/></fig></fig-group><p>To test the first prerequisite, we calculated the characteristic speed for each spatial bin along the track. This was defined as the mean speed after discarding trials where the animal stopped running on the track (speeds &lt; 10 cm/s), to prevent atypical pauses from distorting the mean values. The upper panel in <xref ref-type="fig" rid="fig6">Figure 6A</xref> shows the characteristic speed for rightward runs in one sample experimental session and <xref ref-type="fig" rid="fig6">Figure 6B</xref> shows averages across running directions and sessions. All animals showed similar asymmetric inverted U-shape relationships between characteristic speed and position along the track. Next, as required by the second prerequisite, we confirmed that running speeds at each position were clustered around the characteristic running speed (<xref ref-type="fig" rid="fig6">Figure 6C</xref>). We also observed inverted U-shape relationships between position along the track, and theta trajectory lengths and place field sizes (<xref ref-type="fig" rid="fig6">Figure 6D,E</xref>). Because theta trajectory lengths and place field sizes should be linearly related to the inverse of phase precession slopes (<xref ref-type="disp-formula" rid="equ22 equ23 equ24">Equation 22-24)</xref>, we plotted this variable along the track and found the corresponding U-shape distribution (<xref ref-type="fig" rid="fig6">Figure 6F</xref>). Finally, in support of the third prerequisite, we found that theta trajectory lengths and place field sizes increased, and inverse phase precession slopes decreased, roughly in proportion to characteristic speed for up to at least 60 cm/s, which encompassed most of the data (<xref ref-type="fig" rid="fig6">Figure 6G–I</xref>). Some flattening of the curves appeared after 60 cm/s, but this was less apparent when considering each animal individually (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref> and <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>), suggesting that the flattening is at least partly caused by combining points from clouds with different slopes and speed ranges.</p><p>Since theta trajectory lengths, place field sizes and inverse phase precession slopes all displayed matching distributions, we tested their mutual relationships. We found that the three of them displayed strikingly linear relationships to one another (<xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3</xref>), underscoring the intimate relationships that hold between these systematically interrelated measures of place cell activity. It is also worth noting that theta trajectory length correlates slightly better with characteristic running speed than with either mean place field size or mean inverse phase precession slope at the locations where the trajectories occurred (R = 0.35 vs 0.29 for the latter two; <xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3B,C</xref>).</p><p>Since speed and location on the track are correlated, we also tested whether place field parameters could be best explained by distance to the nearest end of the track, rather than by characteristic running speed. We performed a likelihood ratio test that indicated that both variables contributed significantly to the prediction of place field sizes and inverse phase precession slopes (<inline-formula><mml:math id="inf55"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>). However, the fraction of the total variance accounted for differed substantially between the two variables. A model combining both variables could account for 29% and 28% of the variance in place field sizes and inverse phase precession slopes, respectively. Out of this, characteristic running speed uniquely accounted for 13% and 11% of the variance, whereas distance to the border uniquely accounted for 3% and 7%, respectively. Therefore we conclude that although both variables are related and contribute to determining place field parameters, characteristic running speed plays a more prominent role.</p><p>Taken together, these findings account for and reconcile the speed-dependence of average theta trajectory lengths, place field sizes and phase precession slopes with the speed-independence of individual fields, and satisfy the prerequisites of the behavior-dependent sweep model.</p></sec><sec id="s2-6"><title>The behavior-dependent sweep model accounts best for all of these experimental results</title><p>Our analyses so far suggest that neither the spatial nor the temporal sweep models can account for all of the experimental observations, whereas the behavior-dependent sweep appears consistent with all of them. However, these analyses might involve too many simplifying assumptions about how running speeds, theta coupling and place field parameters are co-distributed. To address this issue, we developed generative models based on the experimental LFP and animal tracking data to generate spikes according to each of the different theta phase coding schemes. The parameters in each model were adjusted to account for as many features in the experimental data as possible. We analyzed the effect of instantaneous running speed on theta trajectory lengths, place field sizes and phase precession slopes in each of the simulated datasets alongside the experimental data (<xref ref-type="fig" rid="fig7">Figure 7</xref>). This approach further allowed us to examine whether any of the models could provide a simple unified account of the data, using a single set of parameters.</p><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Only the behavior-dependent sweep model accounts for all experimental observations.</title><p>(<bold>A</bold>) Summary of experimental results from <xref ref-type="fig" rid="fig3">Figures 3</xref>–<xref ref-type="fig" rid="fig5">5</xref>. Results from all animals are combined. Only one animal featured more than three sessions. For this animal, we sub-selected three sessions at random so that it would not dominate the results. Top three rows: theta trajectory lengths, place field sizes and phase precession slopes combined across positions and fields based on instantaneous running speed. Bottom two rows: the changes in individual place fields’ sizes and phase precession slopes as a function of the difference between instantaneous running speed and the characteristic running speed. For this analysis, fields were assigned to the speed bins closest to the characteristic running speeds at their locations. Black dots represent average values. (<bold>B</bold>) Similar to A for data generated by the temporal sweep model. The temporal sweep model provides a qualitative fit to the average theta trajectory lengths, place field sizes and phase precession slopes, but incorrectly predicts increases in individual place field sizes and phase precession slopes. In this and other columns, green and red axes indicate good and bad qualitative fits, respectively (i.e. whether the model predicts the same type of change in the variables with speed as the experimental data exhibits) and the numbers in the lower right corners indicate the mean squared differences between the average values produced by the model and the experimental data across speed bins. (<bold>C</bold>) The spatial sweep model accounts for the lack of within-field increases in place field sizes and phase precession slopes. However, the increase in theta trajectory length with running speed is not nearly large enough and place field sizes and phase precession slopes remain flat with running speed. (<bold>D</bold>) The behavior-dependent sweep model captures both the population average and within-field effects, providing a good agreement with all experimental results.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70296-fig7-v2.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>The behavior-dependent sweep model captures changes in place field skewness with acceleration.</title><p>The behavior-dependent sweep model captures changes in place field skewness with acceleration. Place field skewness is correlated with the mean acceleration through the field in the experimental data (left) and the model (right), although the experimental distribution is notably broader. Black lines represent linear fits. The correlations are significant (<inline-formula><mml:math id="inf56"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>3.8</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf57"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>7.7</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>23</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> for the experimental and simulated data, respectively [Kendall’s <inline-formula><mml:math id="inf58"><mml:mi>τ</mml:mi></mml:math></inline-formula> test]).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70296-fig7-figsupp1-v2.tif"/></fig><fig id="fig7s2" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 2.</label><caption><title>The behavior-dependent sweep model captures changes in peak firing rates with speed.</title><p>The behavior-dependent sweep model replicates the experimentally observed increase in firing rates with running speed. Analyses and plotting conventions as for <xref ref-type="fig" rid="fig4">Figure 4B &amp; C</xref>, for the peak firing rate of place fields.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70296-fig7-figsupp2-v2.tif"/></fig></fig-group><p>The temporal sweep model roughly captures the observed increase in theta trajectory lengths, place field sizes and phase precession slopes combined across different positions and fields based on instantaneous running speed. However, it did so for the wrong reasons, since it incorrectly predicts changes in individual fields with speed (<xref ref-type="fig" rid="fig7">Figure 7B</xref>). By contrast, the spatial sweep model accounts for the speed-independence of individual fields, but severely undershoots the increase in theta trajectory length with running speed and fails to capture the increases in place field sizes and phase precession slopes (<xref ref-type="fig" rid="fig7">Figure 7C</xref>). Only the behavior-dependent sweep model is able to replicate the correct combination of qualitative effects (<xref ref-type="fig" rid="fig7">Figure 7D</xref>). Furthermore, the behavior-dependent sweep produced values with the lowest mean squared deviation to the experimental data for four of the five variables considered (<xref ref-type="fig" rid="fig7">Figure 7</xref>; numbers in corners).</p><p>Further proof for the validity of the behavior-dependent sweep model comes from the fact that we fitted one of its crucial parameters based on a different subset of the data as the one used to evaluate the models. In particular, we estimated <inline-formula><mml:math id="inf59"><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> based on <xref ref-type="disp-formula" rid="equ23">Equation 23</xref> from the experimentally observed relationship between phase precession slopes and characteristic running speed (<xref ref-type="fig" rid="fig6">Figure 6I</xref>), yielding τ<sub>θ</sub> = 0.57 s. With this value, the model provided a good fit to the relationship between instantaneous running speed and theta trajectory lengths, place field sizes and phase precession slopes (<xref ref-type="fig" rid="fig7">Figure 7D</xref>). This highlights the ability of the model to account for the relationships and internal consistency of multiple measurements of place cell activity.</p><p>Finally, a subtle prediction of the behavior-dependent sweep model is that fields will skew differently depending on whether the animal is typically accelerating or decelerating through the field–that is when the characteristic running speed changes within the field. We therefore analyzed the relationship between mean acceleration and place field skew in the experimental data and found a good qualitative fit with the predictions from the model (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>). Negatively skewed fields <xref ref-type="bibr" rid="bib51">Mehta et al., 2000</xref> were observed at all acceleration values, but positively skewed fields occurred mainly at positive accelerations, resulting overall in a significant correlation between mean acceleration and skew (<inline-formula><mml:math id="inf60"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, Kendall’s <inline-formula><mml:math id="inf61"><mml:mi>τ</mml:mi></mml:math></inline-formula> test). A similar observation was made by <xref ref-type="bibr" rid="bib16">Diba and Buzsáki, 2008</xref>, who reported positive skews at the beginning of the track, where rats are usually accelerating, and negative skews towards the end, where rats decelerate.</p><p>In summary, we found that the behavior-dependent sweep model provided the best overall fit to the experimental data with a single set of model parameters.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>While research over the past four decades has shed light on numerous aspects of the hippocampal code, the exact relationship between represented position, theta phase, and the animal’s physical location has remained ambiguous. The expression of this relationship in theta sequence trajectories at the population level and in theta phase precession at the single-cell level are two sides of the same coin, but the two levels have seldom been explored side by side. Here, we illustrated that established findings in the field at these different levels are in apparent contradiction with one another. We reconciled these findings by demonstrating that even though individual place fields do not change with instantaneous running speed, their size and phase precession slopes vary according to the animal’s characteristic running speed through these place fields. In particular, regions of slow running are tiled with smaller place fields with steeper phase precession, corresponding to shorter theta trajectories at the population level, whereas regions of fast running are covered by larger place fields with shallower phase precession, corresponding to longer theta trajectories. Based on these observations, we proposed a novel theta phase coding scheme, the behavior-dependent sweep. In this model, the spatial extent of the theta oscillation sweep varies across the environment in proportion to the characteristic running speed at each location. As a result, the sweeps can be seen as going through the positions that were or will be reached at certain time intervals in the past or future, assuming the animal runs at the speed characteristic of each place, as opposed to at its actual instantaneous speed. This coding scheme thus integrates aspects of both the spatial and temporal sweeps.</p><sec id="s3-1"><title>Relationship to previous studies on the speed-dependence of the hippocampal code</title><p>Why were the relationships between characteristic speed, hippocampal sweeps and place field parameters not evident in previous studies? Two previous studies (<xref ref-type="bibr" rid="bib50">Maurer et al., 2012</xref>; <xref ref-type="bibr" rid="bib30">Gupta et al., 2012</xref>) pooled theta trajectories across different positions when showing the effect of speed on theta trajectory length, therefore masking the role of position in mediating the relationship between the two variables. In other studies, the dependence of place field parameters on the characteristic running speed through the field did not emerge because analyses focused on relative measures between pairs of cells (<xref ref-type="bibr" rid="bib27">Geisler et al., 2007</xref>; <xref ref-type="bibr" rid="bib16">Diba and Buzsáki, 2008</xref>) or individual fields (<xref ref-type="bibr" rid="bib61">Schmidt et al., 2009</xref>; <xref ref-type="bibr" rid="bib33">Huxter et al., 2003</xref>; <xref ref-type="bibr" rid="bib50">Maurer et al., 2012</xref>) that remain unaffected.</p><p>We note that one other study (<xref ref-type="bibr" rid="bib11">Chadwick et al., 2015</xref>) previously proposed a model to account for the increase in theta trajectory length with running speed despite stable place field sizes and phase-precession. The model achieved this by increasing the precision of the theta phase versus position relationships of cells with running speed. This feature, however, results in unusually noisy phase-precession at low speeds (see Neuronal sequences during theta rely on behavior-dependent spatial maps for results on a model that operates based on the same principle and comparisons to experimental data). Furthermore, this kind of model cannot account for the dependence of average place field size on characteristic running speed.</p><p>On the other hand, two models which are consistent with the increase in place field sizes with characteristic speed did not address theta phase coding. Slow feature analysis attempts to extract slowly varying signals from the sensory input, and has been found to account for different properties of place, head direction and view cells (<xref ref-type="bibr" rid="bib25">Franzius et al., 2007</xref>). Extracting place-specific features that vary on the order of several seconds, for instance, would lead to larger place fields at locations of higher speeds, as we have observed. This observation is also consistent with the successor representation model of place-fields (<xref ref-type="bibr" rid="bib67">Stachenfeld et al., 2017</xref>). In this model, the activity of a cell is determined by the expected discounted future occupancy of the cell’s preferred location, which proves useful for planning. Thus, a cell with a preferred location where average running speed is higher would begin firing relatively further away from that place. The behavior-dependent theta sweep model shares this prediction with these two models, and further accounts for theta-phase and trajectory relationships.</p></sec><sec id="s3-2"><title>Behavior-dependent sweeps are advantageous for prediction and planning</title><p>Given the purported role of theta phase coding in prediction and planning, we can compare our three coding schemes in terms of their benefit for these functions. Representing future positions based on the distance to them, as in the spatial sweep, could allow an animal to calculate the speed necessary to reach those positions in a given amount of time. This representation might also be convenient because our bodies and sensory organs limit the spatial range at which we can interact with the world. In contrast, looking forward based on an interval of time rather than space, as in the temporal sweep model, could increase the code’s efficiency by matching the extent of the look-ahead to the speed of progression through the environment. For instance, while driving a car on a highway, we might have to look ahead by several hundred meters, since those positions are just seconds away, while such a distance is not useful when strolling in a park. Plans made too far in advance are very likely to be discarded upon unexpected changes or as new information comes to light, which is conceivably related to the use of a discount factor in reinforcement learning models (<xref ref-type="bibr" rid="bib68">Sutton and Barto, 1998</xref>). Temporal sweeps also seem more plausible for phase-coding in non-spatial domains (<xref ref-type="bibr" rid="bib57">Pastalkova et al., 2008</xref>; <xref ref-type="bibr" rid="bib45">Lenck-Santini et al., 2008</xref>; <xref ref-type="bibr" rid="bib59">Robinson et al., 2017</xref>; <xref ref-type="bibr" rid="bib71">Terada et al., 2017</xref>; <xref ref-type="bibr" rid="bib1">Aronov et al., 2017</xref>). However, temporal sweeps require a fine control by the instantaneous running speed, and there are indications that the hippocampal network lacks the the flexibility required to modify the time lags between pairs of cells at the theta timescale (<xref ref-type="bibr" rid="bib16">Diba and Buzsáki, 2008</xref>; <xref ref-type="bibr" rid="bib64">Shimbo et al., 2021</xref>).</p><p>The behavior-dependent sweep might thus represent the best solution compatible with network constraints by taking advantage of the relative simplicity of spatial sweeps while still enjoying the benefits of temporal sweeps in situations in which behavior is stereotyped. Thus, the look ahead on a highway remains a few hundred meters even if on occasion we are stuck in a traffic jam. Finally, behavior-dependent sweeps could make predictions of future positions more robust through the averaging of past experience.</p><p>Despite the potential benefits of behavior-dependent sweeps mentioned here, these sweeps are probably best construed as a default or baseline mode of operation, which could be further modulated by ongoing cognitive demands and task contingencies (<xref ref-type="bibr" rid="bib76">Wikenheiser and Redish, 2015</xref>; <xref ref-type="bibr" rid="bib64">Shimbo et al., 2021</xref>; <xref ref-type="bibr" rid="bib79">Zheng et al., 2021</xref>).</p></sec><sec id="s3-3"><title>Look-ahead times can help explain place field sizes</title><p>All theta sweep models and concepts of prospective and retrospective coding, and extra-field spikes in general, imply that place cells also fire outside their true place fields. In other words, an experimentally measured place field encompasses the extent of the true place field, as well as look-ahead and look-behind activity. This link between place fields and prospective/restrospective representations at the theta timescale provides a lower bound on place field sizes for a given task based on its characteristic running speed. For sweeps that are centered around the current position, a <inline-formula><mml:math id="inf62"><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> of <inline-formula><mml:math id="inf63"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math></inline-formula> s means that theta sweeps on average end in positions arrived at in <inline-formula><mml:math id="inf64"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mn>300</mml:mn></mml:mrow></mml:math></inline-formula> ms. Representing those future positions would be of use only if there was enough time for the animal to modify its behavior in response to them. Reaction times for rats performing simple and choice tasks range between 150 ms and 500 ms (<xref ref-type="bibr" rid="bib4">Baunez et al., 2001</xref>; <xref ref-type="bibr" rid="bib8">Brown and Robbins, 1991</xref>), and stop signal reaction times stand at around 360 ms (<xref ref-type="bibr" rid="bib19">Eagle et al., 2009</xref>). Therefore, place field sizes associated with a look-ahead time of 300 ms probably stand towards the lower end of what can be used to control behavior through rapid decision-making. However, place fields (<xref ref-type="bibr" rid="bib43">Kjelstrup et al., 2008</xref>) increase in size along the dorsoventral axis of the hippocampus. The largest place fields recorded in rats stand at about 10 m, which would correspond to representing a time window of &gt; 10 s. Thus, we can conceive of a hierarchy of subregions corresponding to predictions at different temporal scales.</p></sec><sec id="s3-4"><title>Potential mechanisms of behavior-dependent sweeps</title><p>The dependence of place field parameters and theta trajectories on characteristic speed raises the question of how and when this speed might be computed in the brain, and how it is used to control hippocampal sweeps. One intriguing possibility is that the animal can estimate the speed at which it will typically traverse some region of an environment based on general knowledge of similar environments (e.g. knowing that speed will tend to be lower around boundaries). Another possibility is that the characteristic speed is taken to be the speed of the firsts traversals through the environment, in which theta sequences are reportedly lacking or reduced (<xref ref-type="bibr" rid="bib21">Feng et al., 2015</xref>; <xref ref-type="bibr" rid="bib69">Tang et al., 2021</xref>), and then updated incrementally.</p><p>The latter suggestion fits naturally with network connectivity models of phase precession (<xref ref-type="bibr" rid="bib37">Jensen and Lisman, 1996</xref>; <xref ref-type="bibr" rid="bib73">Tsodyks et al., 1996</xref>; <xref ref-type="bibr" rid="bib18">Drieu and Zugaro, 2019</xref>). In these models, theta sequences are produced by the propagation of activity through the population, perhaps owing to the recurrent connectivity in area CA3 (<xref ref-type="bibr" rid="bib12">Cheng, 2013</xref>; <xref ref-type="bibr" rid="bib2">Azizi et al., 2013</xref>). The network is cued with the current position and recalls upcoming positions. As the animal moves forward, positions will activate at earlier phases of the theta cycle, producing phase precession. In this family of models, it is easy to imagine sweeps varying based on average speed. Place cells could be connected with a higher synaptic strength the closer in time they become activated, leading to stronger and further reaching connectivity in areas through which the animals run faster on average. If the speed of propagation in the network is then made dependent on synaptic strength, activity would propagate further in the network within each theta cycle where speed had been higher, producing longer theta trajectories in those areas. Alternatively, based on the view that theta sequences arise from independently phase-precessing cells (<xref ref-type="bibr" rid="bib11">Chadwick et al., 2015</xref>), behavior-dependent sweeps could simply result from a behavior-dependent spatial map that yields larger place fields in areas of faster running.</p></sec><sec id="s3-5"><title>Predictions and outlook</title><p>In the dataset analyzed, changes in running speed arose naturally from animals running on a finite track, but were not controlled by the experimenter. Further confirmation for the behavior-dependent sweep model could come from experiments in more complex environments that can produce variable running speeds at different specific locations (<xref ref-type="bibr" rid="bib44">Kropff et al., 2021</xref>), such as slowing down in previously fast segments and speeding up in slow ones. This would allow for the comparison between behavior-dependent sweeps, and alternative models for which the look-behind and look-ahead distances vary depending on other variables. In particular, it would be interesting to dissociate the effect of characteristic running speed from that of distance to the environmental boundaries, since the boundary vector cell (<xref ref-type="bibr" rid="bib3">Barry et al., 2006</xref>) and Laplace transform (<xref ref-type="bibr" rid="bib63">Sheehan et al., 2021</xref>) models suggest that it could be some non-linear function of distance to the border or trial start, rather than characteristic running speed, that determines place field parameters. Other factors that could play a role are the distance to reward locations (<xref ref-type="bibr" rid="bib32">Hollup et al., 2001</xref>), the distance to the goal (<xref ref-type="bibr" rid="bib76">Wikenheiser and Redish, 2015</xref>), the density of sensory cues, the spatial rate of change of visual input (<xref ref-type="bibr" rid="bib70">Tanni et al., 2021</xref>), the complexity of the maze, or the amount of retrospection and prospection required for the task.</p><p>Although we have focused primarily on the effect of speed, it is reasonable to also expect acceleration to have an effect on theta phase coding. We discuss three specific mechanisms. First, acceleration could introduce a second-order term in the equation for <inline-formula><mml:math id="inf65"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> such that theta trajectories curve in areas through which the animal typically accelerates or decelerates. This might cause trajectories in areas of positive acceleration to reach further ahead than behind, and trajectories in areas of negative acceleration to reach further behind than ahead, consistent with the findings of <xref ref-type="bibr" rid="bib30">Gupta et al., 2012</xref> and <xref ref-type="bibr" rid="bib6">Bieri et al., 2014</xref>. This effect would also be modulated by the phase at which the current position is represented (<inline-formula><mml:math id="inf66"><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> in our equations), since this controls the ratio of look-ahead to look-behind. For instance, the more look-ahead there is, the longer the theta trajectories would become in areas of positive acceleration. Second, acceleration leads to different characteristic running speeds in different parts of a place field. Our model predicts that this would cause place fields to skew differently in areas of positive and negative acceleration, a prediction for which we have found some preliminary experimental support (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>). Additionally, the model indicates that changes in characteristic speeds through fields cause corresponding changes in theta phase precession. If characteristic speed increases across a field, the slope of phase precession would become increasingly shallow, resulting in concave phase precession clouds, whereas if characteristic speed decreases across the field, the slope of phase precession would be increasingly steep, producing convex ‘banana shaped’ phase precession clouds (<xref ref-type="bibr" rid="bib66">Souza and Tort, 2017</xref>; <xref ref-type="bibr" rid="bib77">Yamaguchi et al., 2002</xref>). Future studies are required to test these two predictions, since the range of accelerations in the current dataset was relatively small, especially for positive values, and strong acceleration and deceleration were concentrated over small regions at the start and end of the track, respectively. Third, theta frequency has recently been shown to increase with positive acceleration, but not deceleration or speed (<xref ref-type="bibr" rid="bib44">Kropff et al., 2021</xref>). One might wonder whether shorter theta cycles due to positive acceleration, rather than the lower running speed, could explain the shorter theta trajectories we observed at the beginning of the track. However, we also observe shorter theta trajectories at the end of the track, where running speeds are also lower, but acceleration is negative and theta cycles are longest (<xref ref-type="fig" rid="fig6">Figure 6B,C</xref>). Furthermore, as shown by <xref ref-type="bibr" rid="bib44">Kropff et al., 2021</xref>, the increase in theta frequency is accompanied by an increase in the intrinsic firing frequency of cells which would provide a compensatory effect on theta trajectories. Even without such compensation, the reduction in theta trajectory length due to shortened theta cycle is small and insufficient to account for the observed effect.</p><p>Lastly, our behavior-dependent sweep model could be applied to describing the activity of place cells in two-dimensional environments, and potentially also that of grid cells, since theta phase coding has been demonstrated in both of these cases (<xref ref-type="bibr" rid="bib34">Huxter et al., 2008</xref>; <xref ref-type="bibr" rid="bib36">Jeewajee et al., 2014</xref>; <xref ref-type="bibr" rid="bib31">Hafting et al., 2008</xref>). For grid cells, our model predicts that sizes of individual firing fields within the grid will vary according to running speeds characteristic of the corresponding maze regions. By contrast, the distance between firing field peaks would remain constant, since the locations of the underlying true fields remain fixed in the model.</p><p>In conclusion, our analyses have highlighted the heretofore unresolved tension lurking in the field between experimental results and interpretations explicitly or implicitly supporting spatial and temporal sweeps. Our novel interpretation reconciles apparently contradictory findings by making spatial sweeps dependent on the average behavior at each position, combining features and benefits of both kinds of sweep. In doing so, the model advances our understanding of how the mammalian brain represents past, present and future spatial positions for learning and planning, and provides a quantitative framework that can stimulate further research.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Data analysis</title><p>We re-analyze data from two publicly available data sets (<xref ref-type="bibr" rid="bib53">Mizuseki et al., 2013</xref>; <xref ref-type="bibr" rid="bib28">Grosmark et al., 2016</xref>) containing recordings of male Long-Evans rats running on linear tracks of various lengths for water rewards at both ends. From the first data set, we limited the analysis to the data from three animals, described in <xref ref-type="bibr" rid="bib52">Mizuseki et al., 2009</xref>, which contained sufficient parallel recordings for Bayesian decoding of position. The second data set, described in <xref ref-type="bibr" rid="bib29">Grosmark and Buzsáki, 2016</xref>, contains data from four animals running on a novel track. Data from one animal was excluded due to issues with local field potential recordings (see below), resulting in a total of six animals included in this study. The first 5 min of the recordings in a novel track were discarded since place fields of hippocampal place cells might be unstable in the first 5 min of novel experience (<xref ref-type="bibr" rid="bib24">Frank et al., 2004</xref>) and we wanted to only include periods with stable spatial representations. Five of the animals had one to three experimental sessions available. The remaining animal had a disproportionately large number of experimental sessions, so a random subset was chosen. The exact number and identity of the sessions analyzed for each animal are reported in <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2A</xref>. In these data, neural activity was recorded using multi-shank silicon probes targeting region CA1 of dorsal hippocampus. After spike sorting, cells were classified as principal neurons or interneurons based on monosynaptic interactions, wave-shapes and burstiness.</p><sec id="s4-1-1"><title>Local field potential</title><p>We filtered the local field potential (LFP) with a Butterworth filter of 3rd order between 4 and 12 Hz. We then estimated theta phase from the signal’s Hilbert transform and shifted it by 180° so that 0° and 360° correspond to the peaks of the filtered LFP. Individual theta cycles were then defined as spanning the range from 0° to 360°. Periods of significant theta oscillation were identified by an instantaneous amplitude above the 97th percentile of amplitudes from a shuffled surrogate signal. To create this surrogate, we high-pass filtered the LFP at 1 Hz with another Butterworth filter of 3rd order and randomly permuted the time stamps. All the analyses carried out throughout the paper deal exclusively with periods with significant theta oscillations. In the excluded rat, the LFP signals were particularly noisy, leading to an atypically low fraction of theta cycles categorized as periods of significant theta oscillation as defined below (<inline-formula><mml:math id="inf67"><mml:mrow><mml:mn>0.38</mml:mn><mml:mo>±</mml:mo><mml:mn>0.02</mml:mn></mml:mrow></mml:math></inline-formula>, compared to an average of <inline-formula><mml:math id="inf68"><mml:mrow><mml:mn>0.81</mml:mn><mml:mo>±</mml:mo><mml:mn>0.06</mml:mn></mml:mrow></mml:math></inline-formula> for the other animals).</p></sec><sec id="s4-1-2"><title>Tracking data</title><p>The position of the rat was determined as the midpoint of the two LEDs mounted on its head. The 2D positions where then projected onto the linear track. We calculated instantaneous speed as the central difference of the position along the track, smoothed with a Gaussian filter with a standard deviation of 100 ms. Periods where rats ran continuously in the same direction from corner to corner were identified as rightward or leftward runs. A characteristic speed was calculated for each running direction in 4 cm spatial bins by taking the mean of speeds after discarding instantaneous speed values below 10 cm/s that did not occur within 40 cm of either end of the track (e.g. see <xref ref-type="fig" rid="fig6">Figure 6B</xref>). This was done to avoid contamination of the calculation of the mean speed by infrequent cases where rats stopped in the middle of the track. Near the ends of the tracks, however, low speeds are the norm and therefore we did not set a minimum threshold there. A mean acceleration value was also calculated for each spatial bin by taking the difference of the smoothed speeds.</p></sec><sec id="s4-1-3"><title>Firing rates</title><p>After excluding spikes during pauses in track running (previous paragraph), firing rates were calculated in 4 cm spatial bins and smoothed with a Gaussian filter with a standard deviation of 6 cm. Virtually the same results were produced without this restriction (not shown). Firing rates were calculated independently for each running direction.</p></sec><sec id="s4-1-4"><title>Identification of place fields</title><p>Candidate place fields were required to have a peak firing rate above 2 Hz and at least 25 spikes. The spatial extent of the field was defined by the positions at which the firing rate fell below 15% of the peak firing rate. If a place field was cut on either side by the end of the track, but the firing rate had gone below 66% of the peak firing rate before then, the field was accepted but marked as incomplete. If there were more than three consecutive spatial bins with zero occupancy between the field’s peak and one of the points at which the firing rate fell below threshold, the field was also marked as incomplete. Incomplete fields were excluded from the phase precession and place field skew analyses, and were treated differently in the place field size analysis (see below). Candidate place fields were screened manually to remove instances with multiple overlapping phase precession clouds.</p></sec><sec id="s4-1-5"><title>Place field sizes</title><p>For incomplete fields, place field size was calculated as twice the distance between the field’s peak and the point on either side of the peak for which the firing rate fell below the 15% threshold. This ensured that a sufficient number of place fields at the ends of the track entered the analysis. Due to the pattern of place field skews along linear tracks (<xref ref-type="bibr" rid="bib16">Diba and Buzsáki, 2008</xref>), we expect this method to slightly overestimate actual sizes, and thus the smaller place field sizes that we observed at the ends of the track should not be an artifact of the procedure.</p><p>For calculating the effect of running speed on place field sizes, we recalculated the firing rates with the same spatial bin size and smoothing as described above, but using data corresponding to periods with running speeds belonging to overlapping 20 cm/s wide speed bins in 10 cm/s steps starting at 2 cm/s. Rats spent too little time at some positions and speeds, often leading to an apparent firing rate of 0 due to the lack of time to produce any spikes. Thus, we defined a sampling index that identified areas within the spatial extent of the place field (defined above) that had been sufficiently sampled; we only attempt to measure the place field size in such cases. To obtain this sampling index, we summed the distances between all pairs of spatial bins within the field with occupancy above 300 ms, and divided it by the sum of distances between all pairs of bins in the field. This gave a number that increases nonlinearly from 0 (no valid bins) to 1 (all bins are valid) taking into account both the number of valid bins and how spread out they are through the field. We excluded place fields with a sampling index below 0.4. Place fields where then identified and their sizes calculated as described above. For the summary analyses, we removed extreme outliers below <inline-formula><mml:math id="inf69"><mml:mrow><mml:mrow><mml:mi>Q</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>⋅</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>Q</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> or above <inline-formula><mml:math id="inf70"><mml:mrow><mml:mrow><mml:mi>Q</mml:mi><mml:mo>⁢</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>⋅</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>Q</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> where Q1 and Q3 are the 25% and 75% percentiles, <inline-formula><mml:math id="inf71"><mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Q</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>Q</mml:mi><mml:mo>⁢</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>Q</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf72"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s4-1-6"><title>Phase precession slopes</title><p>Phase precession slopes were measured from linear fits of phase precession clouds falling within the extent of place fields as defined above. The fitting of phase precession clouds is complicated by two matters: (i) phase is a circular variable, and (ii) the slope of the precession might be very steep. One possible way of dealing with the circularity of phase is to directly minimize angular distances between points and the best fitting line in the cylinder defined by position and phase. This can be done using circular-linear regression (<xref ref-type="bibr" rid="bib41">Kempter et al., 2012</xref>; <xref ref-type="bibr" rid="bib61">Schmidt et al., 2009</xref>) or by exhaustive search (<xref ref-type="bibr" rid="bib56">O'Keefe and Recce, 1993</xref>). However, in such cases, one must set the minimum and maximum slopes allowed, otherwise the optimal solution would be a line with a slope approaching <inline-formula><mml:math id="inf73"><mml:mrow><mml:mo>±</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula> that loops around the cylinder going through all points. This would preclude us from correctly fitting steep phase-precession clouds. Another possibility is to try to unwrap the phase precession cloud so that it lays uninterrupted in a plane and then perform a standard linear regression (<xref ref-type="bibr" rid="bib46">Lenck-Santini and Holmes, 2008</xref>). However, this does not work well either for very steep phase precession clouds, since linear regression minimizes only the sum of square errors in phase, leading to excessively shallow fits of steep clouds.</p><p>We therefore developed a new method to determine phase precession slopes robustly even when they are very steep. It is based on orthogonal distance regression, which minimizes the orthogonal distance of the data points to the best fitting line. This method introduces fewer a priori assumptions than standard linear regression, since it does not distinguish between independent and dependent variables. Phase and positions were normalized to a range of <inline-formula><mml:math id="inf74"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> to make their contribution equivalent in the calculation of orthogonal errors.</p><p>As commonly observed, spikes in the phase precession plot (theta phase vs. position) did not generally form a monotonic relationship. Instead, phase precession clouds slightly wrapped around 0° or 360°. This means that the theta phase, as extracted from the filtered LFP, does not accurately mark the transitions between actual theta cycles. Since we later analyze theta sequences, it is crucial to identify the proper beginning and end of the theta cycles. We did this by identifying the theta phase offset that optimized the phase precession relationship across all fields for each experimental session as follows. We considered potential offsets from −60° to 60° in 2° steps. For each value, we calculated orthogonal fits to the phase precession clouds for all fields within that session, and then selected the phase shift that led to the lowest mean orthogonal error across all fields. The optimal shift corresponded to the phase shift for which the most points fell along uninterrupted phase precession clouds.</p><p>In addition to ambiguity about boundaries of the theta cycle, for spikes near this boundary there is an ambiguity as to which cycle these spikes should be attributed to. This could lead to large errors in the orthogonal fit and therefore distortion in the estimate of the precession slope. Thus, we slightly modified the orthogonal fit procedure. We computed the slope and intercept of the line that minimized the sum of squared orthogonal distances with the following caveat. For points with normalized phases below 0.3 or above 0.7, we minimized the orthogonal distance to the line for either the original point or the point phase shifted in phase by 1 or −1, respectively, and chose whichever phase yielded the smallest distance. The minimization was done using the Nelder-Mead algorithm (<xref ref-type="bibr" rid="bib26">Gao and Han, 2012</xref>) implemented in the SciPy library (<xref ref-type="bibr" rid="bib62">SciPy 1.0 Contributors et al., 2020</xref>).</p><p>For calculating the effect of running speed on phase precession we proceeded as described for the place field sizes. We only attempted to calculate phase precession slopes when there were 12 or more spikes. Additionally, we analyzed phase precession slopes in single passes through a field. We calculated the average speed of the pass through the field from the tracking data. Note that this 'traversal speed' typically deviates from the 'characteristic speed' which is determined by the average over all the field traversals in a session. We focused on passes with a running speed above 2 cm/s, six or more spikes, a duration between the first and last emitted spikes above 400 ms and a coefficient of variation (standard deviation / mean) of instantaneous speed below 0.3. Passes with too many invalid positions in the tracking data where also excluded (sampling index &lt; 0.4). For the summary analyses, we removed extreme outliers as described for place field sizes with <inline-formula><mml:math id="inf75"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> for phase precession slopes in the pooled phase precession analysis and <inline-formula><mml:math id="inf76"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula> for single-pass phase precession slopes.</p></sec><sec id="s4-1-7"><title>Bayesian decoding and theta trajectory lengths</title><p>We performed a Bayesian decoding of position based on the ensemble spikes (<xref ref-type="bibr" rid="bib78">Zhang et al., 1998</xref>) assuming a prior distribution over positions (<xref ref-type="bibr" rid="bib14">Davidson et al., 2009</xref>). The probability of the rat being at position <inline-formula><mml:math id="inf77"><mml:mi>x</mml:mi></mml:math></inline-formula> given a vector of spike counts for each cell, <inline-formula><mml:math id="inf78"><mml:mi>n</mml:mi></mml:math></inline-formula>, during a temporal bin of width <inline-formula><mml:math id="inf79"><mml:mi>τ</mml:mi></mml:math></inline-formula> is given by:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>τ</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf80"><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a normalization factor which can be determined by the normalization condition <inline-formula><mml:math id="inf81"><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>x</mml:mi></mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, and <italic>f</italic><sub><italic>i</italic></sub> is the firing rate of cell <inline-formula><mml:math id="inf82"><mml:mi>i</mml:mi></mml:math></inline-formula> in the corresponding running direction. We shifted theta phases so as to minimize the wrapping of phase precession clouds (see above), therefore we expected theta trajectories to be centered within individual theta cycles. We decoded within each cycle in overlapping 90° windows with a step size of 30° (no windows crossed theta cycles). The relatively large window size was due to the need to gather a sufficient number of spikes for the decoding. These phase intervals were transformed into time intervals independently for each theta cycle based on the cycle’s duration. We attempted to decode position only in time bins where at least one spike was emitted, and for positions bins within a spatial extent of 70 cm centered at the current position. This value is below the average place field size at all running speeds (<xref ref-type="fig" rid="fig4">Figure 4C</xref>) and should therefore encompass the whole extent of the sweep.</p><p>When averaging across theta cycles with similar speeds, we calculated theta trajectory lengths only in samples with more than five cycles. When analyzing theta trajectories in individual cycles, we focused on cycles well covered by phase bins with peak decoded probabilities larger than 0.1. In particular, we required at least five such phase bins spanning a minimum of 210°. Theta trajectory lengths were derived from a best fit line. To calculate this best fit, we first found the line that maximized the sum of decoded probabilities for positions within ±5 cm of the line (<xref ref-type="bibr" rid="bib14">Davidson et al., 2009</xref>) and then performed linear regression with the points in this region weighted by their probabilities.</p></sec><sec id="s4-1-8"><title>Place field skew</title><p>Place field skew was calculated as the ratio of the third moment of the place field firing rate distribution divided by the cube of the standard deviation (<xref ref-type="bibr" rid="bib51">Mehta et al., 2000</xref>; <xref ref-type="bibr" rid="bib15">Davoudi and Foster, 2019</xref>):<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mover><mml:mi>μ</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mfrac></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:msqrt></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where, unlike above, <italic>f</italic><sub><italic>j</italic></sub> is the firing rate of a given cell in the spatial bin <italic>x</italic><sub><italic>j</italic></sub>, <inline-formula><mml:math id="inf83"><mml:mi>S</mml:mi></mml:math></inline-formula> is the number of spatial bins, and <inline-formula><mml:math id="inf84"><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> is the center of mass of the field:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p></sec></sec><sec id="s4-2"><title>Mathematical description of coding schemes</title><sec id="s4-2-1"><title>Spatial sweep</title><p>In the spatial sweep model, the represented position at time <inline-formula><mml:math id="inf85"><mml:mi>t</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf86"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is given by<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:mfrac></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf87"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> indicates the actual location of the animal, <inline-formula><mml:math id="inf88"><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> represents the extent of the spatial sweep, <inline-formula><mml:math id="inf89"><mml:mi>T</mml:mi></mml:math></inline-formula> is the period of the theta oscillation and <italic>t</italic><sub><italic>n</italic></sub> is the time for which <inline-formula><mml:math id="inf90"><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> within the current theta cycle.</p><p>In order to derive an expression for the length of theta trajectories, we can perform a Taylor series expansion around <italic>t</italic><sub><italic>n</italic></sub>:<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:mfrac></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf91"><mml:mi>v</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf92"><mml:mi>a</mml:mi></mml:math></inline-formula> are the speed and acceleration, respectively. Since <inline-formula><mml:math id="inf93"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is small, we can ignore the effects of the acceleration and higher order derivatives and approximate the represented position as: <disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:mfrac></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Here, the first two terms reflect the actual movement of the animal and the last one represents the sweep across positions starting behind the current position of the animal and extending ahead. Note that the model makes the simplifying assumption that sweeps, and hence also phase precession, are linear. There are indications that this could be the case when analyzing single trials (<xref ref-type="bibr" rid="bib61">Schmidt et al., 2009</xref>) or when calculating theta phase using a wave-form method (<xref ref-type="bibr" rid="bib5">Belluscio et al., 2012</xref>) (but see <xref ref-type="bibr" rid="bib66">Souza and Tort, 2017</xref>; <xref ref-type="bibr" rid="bib77">Yamaguchi et al., 2002</xref>).</p><p>From <xref ref-type="disp-formula" rid="equ10">Equation 10,</xref> we can calculate the length of theta trajectories, which encompasses both the sweep and the change in the actual position of the animal due to its movement during a theta cycle:<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p> where <inline-formula><mml:math id="inf94"><mml:mi>α</mml:mi></mml:math></inline-formula> is the relative position within the theta cycle for which <inline-formula><mml:math id="inf95"><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. The length of theta trajectories has an offset of <inline-formula><mml:math id="inf96"><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> and is only weakly dependent on speed since the speed term is multiplied by the relatively small theta period.</p><p>At the single-cell level, we postulate a cell’s activity is driven by the represented position <inline-formula><mml:math id="inf97"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> according to its true place field with preferred location <italic>r</italic><sub>0</sub> and width <inline-formula><mml:math id="inf98"><mml:mi>σ</mml:mi></mml:math></inline-formula>. Specifically,<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>All theta sweep models postulate that the position <inline-formula><mml:math id="inf99"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> represented by the place cell population differs from the actual location of the animal <inline-formula><mml:math id="inf100"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> depending on the phase of theta. <inline-formula><mml:math id="inf101"><mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> at the beginning of the theta cycle, and <inline-formula><mml:math id="inf102"><mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> at the end. Since a place cell’s place field is determined by <inline-formula><mml:math id="inf103"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at all times, its firing relative to <inline-formula><mml:math id="inf104"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> will shift with the theta phase and this gives rise to phase precession in this model. For instance, the peaks of firing occur at <inline-formula><mml:math id="inf105"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> at the beginning of the theta cycle and at <inline-formula><mml:math id="inf106"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> at the end of the cycle. Hence, the theta phase of maximal firing precesses over a range of <inline-formula><mml:math id="inf107"><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> and the slope of phase precession is:<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mn>360</mml:mn><mml:mo>∘</mml:mo></mml:msup><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Furthermore, the shift of the cell’s firing enlarges the measured place field beyond its true place field (size <italic>s</italic><sub>0</sub>) by the amount of the shift, that is the size of the measured place field is given by<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>However, in practice, this will be further modulated by other factors such as the presence of theta modulation or the smoothing used when calculating firing rates.</p></sec><sec id="s4-2-2"><title>Temporal sweep</title><p>For the temporal sweep model, the represented position is given by,<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:mfrac></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf108"><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> is the extent of the temporal sweep. Again, we can perform a Taylor series expansion around <italic>t</italic><sub><italic>n</italic></sub>:<disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">…</mml:mi></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>And discarding the effects of higher-order derivatives:<disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:mfrac></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where again the first two terms reflect the movement of the animal and the last one, the sweep. In this case, the length of the theta trajectories is directly proportional to running speed:<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∝</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>From the first-order approximation of <inline-formula><mml:math id="inf109"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ17">Equation 17,</xref> we see that the spatial extent of the sweep is <inline-formula><mml:math id="inf110"><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Therefore, we can substitute this for <inline-formula><mml:math id="inf111"><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ13">Equation 13</xref> and <xref ref-type="disp-formula" rid="equ14">Equation 14</xref> to obtain the equations for phase precession slopes and place field sizes:<disp-formula id="equ19"><label>(19)</label><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mn>360</mml:mn><mml:mo>∘</mml:mo></mml:msup><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>∝</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>and<disp-formula id="equ20"><label>(20)</label><mml:math id="m20"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>As speed goes to 0, phase precession slopes becomes increasingly steep and place field sizes converge to that of the underlying true place fields.</p></sec><sec id="s4-2-3"><title>Behavior-dependent sweep</title><p>To reconcile the presented analytical observations with aspects of spatial and temporal sweeps that they appear to be consistent with, we make the extent of spatial sweeps directly proportional to the characteristic running speed at each location. Thus, we set <inline-formula><mml:math id="inf112"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ8">Equation 8</xref>:<disp-formula id="equ21"><label>(21)</label><mml:math id="m21"><mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:mfrac></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Note that second term representing the sweep is equivalent to the sweep term in <xref ref-type="disp-formula" rid="equ17">Equation 17</xref>, but using the characteristic speed through the current location as opposed to the instantaneous speed at which the animal is running.</p><p>Proceeding as above, we can derive equations for the theta trajectory length:<disp-formula id="equ22"><label>(22)</label><mml:math id="m22"><mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p> which is roughly proportional to the characteristic running speed. Similarly, we can obtain the equations for the phase precession slopes, <inline-formula><mml:math id="inf113"><mml:mi>m</mml:mi></mml:math></inline-formula>:<disp-formula id="equ23"><label>(23)</label><mml:math id="m23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mn>360</mml:mn><mml:mo>∘</mml:mo></mml:msup><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>and place field sizes:<disp-formula id="equ24"><label>(24)</label><mml:math id="m24"><mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Place fields will therefore be larger and have shallower phase precession slopes for locations with higher characteristic running speed, but will not otherwise vary with instantaneous running speed.</p></sec></sec><sec id="s4-3"><title>Computational modeling</title><p>We generated surrogate data sets by taking the tracking and LFP data from experimental sessions and substituting the experimental spikes with those generated by our models under different coding assumptions. We discretized the session into 2 ms time bins and calculated for each bin the position that the cell population represents, <inline-formula><mml:math id="inf114"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, according to each coding scheme at that particular phase of theta, <inline-formula><mml:math id="inf115"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. For the temporal sweep model, <inline-formula><mml:math id="inf116"><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>θ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mn>180</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mn>360</mml:mn></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf117"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the position obtained from the tracking and <inline-formula><mml:math id="inf118"><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> is the time interval swept over in each theta cycle. We manually tuned <inline-formula><mml:math id="inf119"><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> iteratively to minimize the deviations in theta trajectory lengths, place field sizes and phase precession slopes between experimental and simulated data (<xref ref-type="fig" rid="fig7">Figure 7</xref>). A good compromise was obtained for a <inline-formula><mml:math id="inf120"><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> of 0.55 s. For the spatial sweep model, <inline-formula><mml:math id="inf121"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>180</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>360</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf122"><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> is the spatial distance swept over in each theta cycle. We tuned <inline-formula><mml:math id="inf123"><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> as described for <inline-formula><mml:math id="inf124"><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula>, obtaining a value of 30 cm. For the behavior-dependent sweep model, <inline-formula><mml:math id="inf125"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mover><mml:mi>v</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>180</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>360</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf126"><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> was taken to be the experimentally observed characteristic running speed at each position, calculated independently for each experimental session and running direction (e.g. <xref ref-type="fig" rid="fig6">Figure 6A</xref>). <inline-formula><mml:math id="inf127"><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> was obtained from fitting <xref ref-type="disp-formula" rid="equ23">Equation 23</xref> to the relationship between inverse phase precession slopes and characteristic running speed (<xref ref-type="fig" rid="fig6">Figure 6I</xref>), resulting in a value of 0.57 s.</p><p>Then, for each time bin, we generated spikes for each of 20 simulated place cells uniformly distributed along the track. Spikes were generated based on the activation level of each cell <inline-formula><mml:math id="inf128"><mml:mi>i</mml:mi></mml:math></inline-formula> at the represented position, as determined by the cell’s true place field. These true place fields were defined as Gaussian activation functions, <italic>f</italic><sub><italic>i</italic></sub>, with a peak value of 1, discretized in 1 cm steps. The standard deviation of the Gaussian, <inline-formula><mml:math id="inf129"><mml:mi>σ</mml:mi></mml:math></inline-formula>, determines the size of the true place fields, which controls how tight the relationship is between firing at a particular phase and the time or distance to the peak’s center. A small true place field size leads to very crisp phase precession clouds, whereas a bigger one results in wider clouds with a noisier relationship between phase and position. For the temporal and spatial sweep models, the standard deviation was set to 7 cm, which corresponds to true place field sizes of 27 cm. With this value, the model produced phase precession clouds approximately matching the experimental ones. For behavior-dependent sweeps, the standard deviation was heterogeneous across the population, set to <inline-formula><mml:math id="inf130"><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mn> 0.3</mml:mn><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <italic>c</italic><sub><italic>i</italic></sub> is the center of each place field.</p><p>Spikes were generated from a Poisson process with probability equal to an instantaneous firing rate times the width of the time bin:<disp-formula id="equ25"><label>(25)</label><mml:math id="m25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>15</mml:mn><mml:mo>+</mml:mo><mml:mn>0.2</mml:mn><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf131"><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the instantaneous running speed in cm/s. The first term sets the maximum firing rate and the values were chosen to approximate the increase in peak firing rate with running speed observed in the experimental data (<xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref>). The second term introduces an inhibitory modulation by the amplitude of the theta oscillation with <inline-formula><mml:math id="inf132"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.35</mml:mn></mml:mrow></mml:math></inline-formula> approximating the experimentally observed value in the experimental data set (not shown).</p><p>For the model predictions shown in the the schematics in <xref ref-type="fig" rid="fig1">Figure 1</xref> and <xref ref-type="fig" rid="fig2">Figure 2</xref>, we simulated runs at constant speed with a regular 8 Hz theta oscillation, and used the models as described above, except for <inline-formula><mml:math id="inf133"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> s and <inline-formula><mml:math id="inf134"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula> cm.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Loren Frank for helpful discussions and Laia Serratosa Capdevila for feedback on the draft. We thank the anonymous reviewers for their thoughtful and extensive feedback which led to a clearer and more comprehensive article.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Formal analysis, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Supervision, Funding acquisition, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Formal analysis, Supervision, Funding acquisition, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Summary of statistical tests.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-70296-supp1-v2.ods"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-70296-transrepform-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>No new data was generated for this study. All analysis code has been made available at <ext-link ext-link-type="uri" xlink:href="https://github.com/sencheng/models-and-analysis-of-theta-phase-coding">https://github.com/sencheng/models-and-analysis-of-theta-phase-coding</ext-link> (copy archive at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:rev:cadbae0ff9a9f1af82101229c15f4af213857773">https://archive.softwareheritage.org/swh:1:rev:cadbae0ff9a9f1af82101229c15f4af213857773</ext-link>).</p><p>The following previously published datasets were used:</p><p><element-citation id="dataset1" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Mizuseki</surname><given-names>K</given-names></name><name><surname>Sirota</surname><given-names>A</given-names></name><name><surname>Pastalkova</surname><given-names>E</given-names></name><name><surname>Diba</surname><given-names>K</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2013">2013</year><data-title>Multiple single unit recordings from different rat hippocampal and entorhinal regions while the animals were performing multiple behavioral tasks</data-title><source>Collaborative Research in Computational Neuroscience</source><pub-id assigning-authority="other" pub-id-type="doi">10.6080/K09G5JRZ</pub-id></element-citation></p><p><element-citation id="dataset2" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Grosmark</surname><given-names>AD</given-names></name><name><surname>Long</surname><given-names>J</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>Recordings from hippocampal area CA1, PRE, during and POST novel spatial learning</data-title><source>Collaborative Research in Computational Neuroscience</source><pub-id assigning-authority="other" pub-id-type="doi">10.6080/K0862DC5</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aronov</surname> <given-names>D</given-names></name><name><surname>Nevers</surname> <given-names>R</given-names></name><name><surname>Tank</surname> <given-names>DW</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Mapping of a non-spatial dimension by the hippocampal-entorhinal circuit</article-title><source>Nature</source><volume>543</volume><fpage>719</fpage><lpage>722</lpage><pub-id pub-id-type="doi">10.1038/nature21692</pub-id><pub-id pub-id-type="pmid">28358077</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Azizi</surname> <given-names>AH</given-names></name><name><surname>Wiskott</surname> <given-names>L</given-names></name><name><surname>Cheng</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A computational model for preplay in the hippocampus</article-title><source>Frontiers in Computational Neuroscience</source><volume>7</volume><elocation-id>00161</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2013.00161</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barry</surname> <given-names>C</given-names></name><name><surname>Lever</surname> <given-names>C</given-names></name><name><surname>Hayman</surname> <given-names>R</given-names></name><name><surname>Hartley</surname> <given-names>T</given-names></name><name><surname>Burton</surname> <given-names>S</given-names></name><name><surname>O'Keefe</surname> <given-names>J</given-names></name><name><surname>Jeffery</surname> <given-names>K</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The boundary vector cell model of place cell firing and spatial memory</article-title><source>Reviews in the Neurosciences</source><volume>17</volume><fpage>71</fpage><lpage>97</lpage><pub-id pub-id-type="doi">10.1515/revneuro.2006.17.1-2.71</pub-id><pub-id pub-id-type="pmid">16703944</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baunez</surname> <given-names>C</given-names></name><name><surname>Humby</surname> <given-names>T</given-names></name><name><surname>Eagle</surname> <given-names>DM</given-names></name><name><surname>Ryan</surname> <given-names>LJ</given-names></name><name><surname>Dunnett</surname> <given-names>SB</given-names></name><name><surname>Robbins</surname> <given-names>TW</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Effects of STN lesions on simple vs choice reaction time tasks in the rat: preserved motor readiness, but impaired response selection</article-title><source>European Journal of Neuroscience</source><volume>13</volume><fpage>1609</fpage><lpage>1616</lpage><pub-id pub-id-type="doi">10.1046/j.0953-816x.2001.01521.x</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Belluscio</surname> <given-names>MA</given-names></name><name><surname>Mizuseki</surname> <given-names>K</given-names></name><name><surname>Schmidt</surname> <given-names>R</given-names></name><name><surname>Kempter</surname> <given-names>R</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Cross-frequency phase-phase coupling between θ and γ oscillations in the hippocampus</article-title><source>Journal of Neuroscience</source><volume>32</volume><fpage>423</fpage><lpage>435</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4122-11.2012</pub-id><pub-id pub-id-type="pmid">22238079</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bieri</surname> <given-names>KW</given-names></name><name><surname>Bobbitt</surname> <given-names>KN</given-names></name><name><surname>Colgin</surname> <given-names>LL</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Slow and fast γ rhythms coordinate different spatial coding modes in hippocampal place cells</article-title><source>Neuron</source><volume>82</volume><fpage>670</fpage><lpage>681</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.03.013</pub-id><pub-id pub-id-type="pmid">24746420</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bolding</surname> <given-names>KA</given-names></name><name><surname>Ferbinteanu</surname> <given-names>J</given-names></name><name><surname>Fox</surname> <given-names>SE</given-names></name><name><surname>Muller</surname> <given-names>RU</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Place cell firing cannot support navigation without intact septal circuits</article-title><source>Hippocampus</source><volume>30</volume><fpage>175</fpage><lpage>191</lpage><pub-id pub-id-type="doi">10.1002/hipo.23136</pub-id><pub-id pub-id-type="pmid">31301167</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname> <given-names>VJ</given-names></name><name><surname>Robbins</surname> <given-names>TW</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Simple and choice reaction time performance following unilateral striatal dopamine depletion in the rat impaired motor readiness but preserved response preparation</article-title><source>Brain : A Journal of Neurology</source><volume>114</volume><fpage>513</fpage><lpage>525</lpage><pub-id pub-id-type="doi">10.1093/brain/114.1.513</pub-id><pub-id pub-id-type="pmid">2004254</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bush</surname> <given-names>D</given-names></name><name><surname>Barry</surname> <given-names>C</given-names></name><name><surname>Manson</surname> <given-names>D</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Using grid cells for navigation</article-title><source>Neuron</source><volume>87</volume><fpage>507</fpage><lpage>520</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.07.006</pub-id><pub-id pub-id-type="pmid">26247860</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cei</surname> <given-names>A</given-names></name><name><surname>Girardeau</surname> <given-names>G</given-names></name><name><surname>Drieu</surname> <given-names>C</given-names></name><name><surname>Kanbi</surname> <given-names>KE</given-names></name><name><surname>Zugaro</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Reversed theta sequences of hippocampal cell assemblies during backward travel</article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>719</fpage><lpage>724</lpage><pub-id pub-id-type="doi">10.1038/nn.3698</pub-id><pub-id pub-id-type="pmid">24667574</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chadwick</surname> <given-names>A</given-names></name><name><surname>van Rossum</surname> <given-names>MCW</given-names></name><name><surname>Nolan</surname> <given-names>MF</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Independent theta phase coding accounts for CA1 population sequences and enables flexible remapping</article-title><source>eLife</source><volume>4</volume><elocation-id>e03542</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.03542</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cheng</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The CRISP theory of hippocampal function in episodic memory</article-title><source>Frontiers in Neural Circuits</source><volume>7</volume><elocation-id>88</elocation-id><pub-id pub-id-type="doi">10.3389/fncir.2013.00088</pub-id><pub-id pub-id-type="pmid">23653597</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cheng</surname> <given-names>S</given-names></name><name><surname>Frank</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>New experiences enhance coordinated neural activity in the hippocampus</article-title><source>Neuron</source><volume>57</volume><fpage>303</fpage><lpage>313</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2007.11.035</pub-id><pub-id pub-id-type="pmid">18215626</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davidson</surname> <given-names>TJ</given-names></name><name><surname>Kloosterman</surname> <given-names>F</given-names></name><name><surname>Wilson</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Hippocampal replay of extended experience</article-title><source>Neuron</source><volume>63</volume><fpage>497</fpage><lpage>507</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.07.027</pub-id><pub-id pub-id-type="pmid">19709631</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davoudi</surname> <given-names>H</given-names></name><name><surname>Foster</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Acute silencing of hippocampal CA3 reveals a dominant role in place field responses</article-title><source>Nature Neuroscience</source><volume>22</volume><fpage>337</fpage><lpage>342</lpage><pub-id pub-id-type="doi">10.1038/s41593-018-0321-z</pub-id><pub-id pub-id-type="pmid">30664772</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diba</surname> <given-names>K</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Hippocampal network dynamics constrain the time lag between pyramidal cells across modified environments</article-title><source>The Journal of Neuroscience</source><volume>28</volume><fpage>13448</fpage><lpage>13456</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3824-08.2008</pub-id><pub-id pub-id-type="pmid">19074018</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dragoi</surname> <given-names>G</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Temporal encoding of place sequences by hippocampal cell assemblies</article-title><source>Neuron</source><volume>50</volume><fpage>145</fpage><lpage>157</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2006.02.023</pub-id><pub-id pub-id-type="pmid">16600862</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drieu</surname> <given-names>C</given-names></name><name><surname>Zugaro</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Hippocampal sequences during exploration: mechanisms and functions</article-title><source>Frontiers in Cellular Neuroscience</source><volume>13</volume><elocation-id>00232</elocation-id><pub-id pub-id-type="doi">10.3389/fncel.2019.00232</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eagle</surname> <given-names>DM</given-names></name><name><surname>Lehmann</surname> <given-names>O</given-names></name><name><surname>Theobald</surname> <given-names>DE</given-names></name><name><surname>Pena</surname> <given-names>Y</given-names></name><name><surname>Zakaria</surname> <given-names>R</given-names></name><name><surname>Ghosh</surname> <given-names>R</given-names></name><name><surname>Dalley</surname> <given-names>JW</given-names></name><name><surname>Robbins</surname> <given-names>TW</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Serotonin depletion impairs waiting but not stop-signal reaction time in rats: implications for theories of the role of 5-HT in behavioral inhibition</article-title><source>Neuropsychopharmacology</source><volume>34</volume><fpage>1311</fpage><lpage>1321</lpage><pub-id pub-id-type="doi">10.1038/npp.2008.202</pub-id><pub-id pub-id-type="pmid">19005464</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Erdem</surname> <given-names>UM</given-names></name><name><surname>Hasselmo</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>A goal-directed spatial navigation model using forward trajectory planning based on grid cells</article-title><source>European Journal of Neuroscience</source><volume>35</volume><fpage>916</fpage><lpage>931</lpage><pub-id pub-id-type="doi">10.1111/j.1460-9568.2012.08015.x</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname> <given-names>T</given-names></name><name><surname>Silva</surname> <given-names>D</given-names></name><name><surname>Foster</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Dissociation between the experience-dependent development of hippocampal theta sequences and single-trial phase precession</article-title><source>The Journal of Neuroscience</source><volume>35</volume><fpage>4890</fpage><lpage>4902</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2614-14.2015</pub-id><pub-id pub-id-type="pmid">25810520</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Fisher</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="1993">1993</year><source>Statistical Analysis of Circular Data</source><publisher-loc>Cambridge, United Kingdom</publisher-loc><publisher-name>Cambridge University Press</publisher-name></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foster</surname> <given-names>DJ</given-names></name><name><surname>Wilson</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Hippocampal theta sequences</article-title><source>Hippocampus</source><volume>17</volume><fpage>1093</fpage><lpage>1099</lpage><pub-id pub-id-type="doi">10.1002/hipo.20345</pub-id><pub-id pub-id-type="pmid">17663452</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frank</surname> <given-names>LM</given-names></name><name><surname>Stanley</surname> <given-names>GB</given-names></name><name><surname>Brown</surname> <given-names>EN</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Hippocampal plasticity across multiple days of exposure to novel environments</article-title><source>The Journal of Neuroscience</source><volume>24</volume><fpage>7681</fpage><lpage>7689</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1958-04.2004</pub-id><pub-id pub-id-type="pmid">15342735</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franzius</surname> <given-names>M</given-names></name><name><surname>Sprekeler</surname> <given-names>H</given-names></name><name><surname>Wiskott</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Slowness and sparseness lead to place, Head-Direction, and Spatial-View cells</article-title><source>PLOS Computational Biology</source><volume>3</volume><elocation-id>e166</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.0030166</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname> <given-names>F</given-names></name><name><surname>Han</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Implementing the Nelder-Mead simplex algorithm with adaptive parameters</article-title><source>Computational Optimization and Applications</source><volume>51</volume><fpage>259</fpage><lpage>277</lpage><pub-id pub-id-type="doi">10.1007/s10589-010-9329-3</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geisler</surname> <given-names>C</given-names></name><name><surname>Robbe</surname> <given-names>D</given-names></name><name><surname>Zugaro</surname> <given-names>M</given-names></name><name><surname>Sirota</surname> <given-names>A</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Hippocampal place cell assemblies are speed-controlled oscillators</article-title><source>PNAS</source><volume>104</volume><fpage>8149</fpage><lpage>8154</lpage><pub-id pub-id-type="doi">10.1073/pnas.0610121104</pub-id><pub-id pub-id-type="pmid">17470808</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="data"><person-group person-group-type="author"><name><surname>Grosmark</surname> <given-names>A</given-names></name><name><surname>Long</surname> <given-names>J</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>Recordings from hippocampal area CA1, PRE, during and POST novel spatial learning</data-title><source>Datamed</source><pub-id pub-id-type="doi">10.6080/K0862DC5</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grosmark</surname> <given-names>AD</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Diversity in neural firing dynamics supports both rigid and learned hippocampal sequences</article-title><source>Science</source><volume>351</volume><fpage>1440</fpage><lpage>1443</lpage><pub-id pub-id-type="doi">10.1126/science.aad1935</pub-id><pub-id pub-id-type="pmid">27013730</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gupta</surname> <given-names>AS</given-names></name><name><surname>van der Meer</surname> <given-names>MA</given-names></name><name><surname>Touretzky</surname> <given-names>DS</given-names></name><name><surname>Redish</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Segmentation of spatial experience by hippocampal θ sequences</article-title><source>Nature Neuroscience</source><volume>15</volume><fpage>1032</fpage><lpage>1039</lpage><pub-id pub-id-type="doi">10.1038/nn.3138</pub-id><pub-id pub-id-type="pmid">22706269</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hafting</surname> <given-names>T</given-names></name><name><surname>Fyhn</surname> <given-names>M</given-names></name><name><surname>Bonnevie</surname> <given-names>T</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Hippocampus-independent phase precession in entorhinal grid cells</article-title><source>Nature</source><volume>453</volume><fpage>1248</fpage><lpage>1252</lpage><pub-id pub-id-type="doi">10.1038/nature06957</pub-id><pub-id pub-id-type="pmid">18480753</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hollup</surname> <given-names>SA</given-names></name><name><surname>Molden</surname> <given-names>S</given-names></name><name><surname>Donnett</surname> <given-names>JG</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Accumulation of hippocampal place fields at the goal location in an annular watermaze task</article-title><source>The Journal of Neuroscience</source><volume>21</volume><fpage>1635</fpage><lpage>1644</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.21-05-01635.2001</pub-id><pub-id pub-id-type="pmid">11222654</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huxter</surname> <given-names>J</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name><name><surname>O'Keefe</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Independent rate and temporal coding in hippocampal pyramidal cells</article-title><source>Nature</source><volume>425</volume><fpage>828</fpage><lpage>832</lpage><pub-id pub-id-type="doi">10.1038/nature02058</pub-id><pub-id pub-id-type="pmid">14574410</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huxter</surname> <given-names>JR</given-names></name><name><surname>Senior</surname> <given-names>TJ</given-names></name><name><surname>Allen</surname> <given-names>K</given-names></name><name><surname>Csicsvari</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Theta phase-specific codes for two-dimensional position, trajectory and heading in the hippocampus</article-title><source>Nature Neuroscience</source><volume>11</volume><fpage>587</fpage><lpage>594</lpage><pub-id pub-id-type="doi">10.1038/nn.2106</pub-id><pub-id pub-id-type="pmid">18425124</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Itskov</surname> <given-names>V</given-names></name><name><surname>Pastalkova</surname> <given-names>E</given-names></name><name><surname>Mizuseki</surname> <given-names>K</given-names></name><name><surname>Buzsaki</surname> <given-names>G</given-names></name><name><surname>Harris</surname> <given-names>KD</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Theta-mediated dynamics of spatial information in hippocampus</article-title><source>The Journal of Neuroscience</source><volume>28</volume><fpage>5959</fpage><lpage>5964</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5262-07.2008</pub-id><pub-id pub-id-type="pmid">18524900</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jeewajee</surname> <given-names>A</given-names></name><name><surname>Barry</surname> <given-names>C</given-names></name><name><surname>Douchamps</surname> <given-names>V</given-names></name><name><surname>Manson</surname> <given-names>D</given-names></name><name><surname>Lever</surname> <given-names>C</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Theta phase precession of grid and place cell firing in open environments</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>369</volume><elocation-id>20120532</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2012.0532</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jensen</surname> <given-names>O</given-names></name><name><surname>Lisman</surname> <given-names>JE</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Hippocampal CA3 region predicts memory sequences: accounting for the phase precession of place cells</article-title><source>Learning &amp; Memory</source><volume>3</volume><fpage>279</fpage><lpage>287</lpage><pub-id pub-id-type="doi">10.1101/lm.3.2-3.279</pub-id><pub-id pub-id-type="pmid">10456097</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname> <given-names>A</given-names></name><name><surname>Redish</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Neural ensembles in CA3 transiently encode paths forward of the animal at a decision point</article-title><source>The Journal of Neuroscience</source><volume>27</volume><fpage>12176</fpage><lpage>12189</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3761-07.2007</pub-id><pub-id pub-id-type="pmid">17989284</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname> <given-names>MW</given-names></name><name><surname>Wilson</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Phase precession of medial prefrontal cortical activity relative to the hippocampal theta rhythm</article-title><source>Hippocampus</source><volume>15</volume><fpage>867</fpage><lpage>873</lpage><pub-id pub-id-type="doi">10.1002/hipo.20119</pub-id><pub-id pub-id-type="pmid">16149084</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kay</surname> <given-names>K</given-names></name><name><surname>Chung</surname> <given-names>JE</given-names></name><name><surname>Sosa</surname> <given-names>M</given-names></name><name><surname>Schor</surname> <given-names>JS</given-names></name><name><surname>Karlsson</surname> <given-names>MP</given-names></name><name><surname>Larkin</surname> <given-names>MC</given-names></name><name><surname>Liu</surname> <given-names>DF</given-names></name><name><surname>Frank</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Constant Sub-second cycling between representations of possible futures in the hippocampus</article-title><source>Cell</source><volume>180</volume><fpage>552</fpage><lpage>567</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2020.01.014</pub-id><pub-id pub-id-type="pmid">32004462</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kempter</surname> <given-names>R</given-names></name><name><surname>Leibold</surname> <given-names>C</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name><name><surname>Diba</surname> <given-names>K</given-names></name><name><surname>Schmidt</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Quantifying circular-linear associations: hippocampal phase precession</article-title><source>Journal of Neuroscience Methods</source><volume>207</volume><fpage>113</fpage><lpage>124</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2012.03.007</pub-id><pub-id pub-id-type="pmid">22487609</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname> <given-names>SM</given-names></name><name><surname>Ganguli</surname> <given-names>S</given-names></name><name><surname>Frank</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Spatial information outflow from the hippocampal circuit: distributed spatial coding and phase precession in the subiculum</article-title><source>The Journal of Neuroscience</source><volume>32</volume><fpage>11539</fpage><lpage>11558</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5942-11.2012</pub-id><pub-id pub-id-type="pmid">22915100</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kjelstrup</surname> <given-names>KB</given-names></name><name><surname>Solstad</surname> <given-names>T</given-names></name><name><surname>Brun</surname> <given-names>VH</given-names></name><name><surname>Hafting</surname> <given-names>T</given-names></name><name><surname>Leutgeb</surname> <given-names>S</given-names></name><name><surname>Witter</surname> <given-names>MP</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Finite scale of spatial representation in the hippocampus</article-title><source>Science</source><volume>321</volume><fpage>140</fpage><lpage>143</lpage><pub-id pub-id-type="doi">10.1126/science.1157086</pub-id><pub-id pub-id-type="pmid">18599792</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kropff</surname> <given-names>E</given-names></name><name><surname>Carmichael</surname> <given-names>JE</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Frequency of theta rhythm is controlled by acceleration, but not speed, in running rats</article-title><source>Neuron</source><volume>109</volume><fpage>1029</fpage><lpage>1039</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2021.01.017</pub-id><pub-id pub-id-type="pmid">33567253</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lenck-Santini</surname> <given-names>PP</given-names></name><name><surname>Fenton</surname> <given-names>AA</given-names></name><name><surname>Muller</surname> <given-names>RU</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Discharge properties of hippocampal neurons during performance of a jump avoidance task</article-title><source>The Journal of Neuroscience</source><volume>28</volume><fpage>6773</fpage><lpage>6786</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5329-07.2008</pub-id><pub-id pub-id-type="pmid">18596153</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lenck-Santini</surname> <given-names>PP</given-names></name><name><surname>Holmes</surname> <given-names>GL</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Altered phase precession and compression of temporal sequences by place cells in epileptic rats</article-title><source>The Journal of Neuroscience</source><volume>28</volume><fpage>5053</fpage><lpage>5062</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5024-07.2008</pub-id><pub-id pub-id-type="pmid">18463258</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lisman</surname> <given-names>JE</given-names></name><name><surname>Grace</surname> <given-names>AA</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>The hippocampal-VTA loop: controlling the entry of information into long-term memory</article-title><source>Neuron</source><volume>46</volume><fpage>703</fpage><lpage>713</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2005.05.002</pub-id><pub-id pub-id-type="pmid">15924857</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lisman</surname> <given-names>JE</given-names></name><name><surname>Idiart</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Storage of 7 +/- 2 short-term memories in oscillatory subcycles</article-title><source>Science</source><volume>267</volume><fpage>1512</fpage><lpage>1515</lpage><pub-id pub-id-type="doi">10.1126/science.7878473</pub-id><pub-id pub-id-type="pmid">7878473</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lisman</surname> <given-names>J</given-names></name><name><surname>Redish</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Prediction, sequences and the hippocampus</article-title><source>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</source><volume>364</volume><fpage>1193</fpage><lpage>1201</lpage><pub-id pub-id-type="doi">10.1098/rstb.2008.0316</pub-id><pub-id pub-id-type="pmid">19528000</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maurer</surname> <given-names>AP</given-names></name><name><surname>Burke</surname> <given-names>SN</given-names></name><name><surname>Lipa</surname> <given-names>P</given-names></name><name><surname>Skaggs</surname> <given-names>WE</given-names></name><name><surname>Barnes</surname> <given-names>CA</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Greater running speeds result in altered hippocampal phase sequence dynamics</article-title><source>Hippocampus</source><volume>22</volume><fpage>737</fpage><lpage>747</lpage><pub-id pub-id-type="doi">10.1002/hipo.20936</pub-id><pub-id pub-id-type="pmid">21538659</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mehta</surname> <given-names>MR</given-names></name><name><surname>Quirk</surname> <given-names>MC</given-names></name><name><surname>Wilson</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Experience-dependent asymmetric shape of hippocampal receptive fields</article-title><source>Neuron</source><volume>25</volume><fpage>707</fpage><lpage>715</lpage><pub-id pub-id-type="doi">10.1016/s0896-6273(00)81072-7</pub-id><pub-id pub-id-type="pmid">10774737</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mizuseki</surname> <given-names>K</given-names></name><name><surname>Sirota</surname> <given-names>A</given-names></name><name><surname>Pastalkova</surname> <given-names>E</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Theta oscillations provide temporal windows for local circuit computation in the entorhinal-hippocampal loop</article-title><source>Neuron</source><volume>64</volume><fpage>267</fpage><lpage>280</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.08.037</pub-id><pub-id pub-id-type="pmid">19874793</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="data"><person-group person-group-type="author"><name><surname>Mizuseki</surname> <given-names>K</given-names></name><name><surname>Sirota</surname> <given-names>A</given-names></name><name><surname>Pastalkova</surname> <given-names>E</given-names></name><name><surname>Diba</surname> <given-names>K</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2013">2013</year><data-title>Multiple single unit recordings from different rat hippocampal and entorhinal regions while the animals were performing multiple behavioral tasks</data-title><source>Datamed</source><pub-id pub-id-type="doi">10.6080/K09G5JRZ</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muessig</surname> <given-names>L</given-names></name><name><surname>Lasek</surname> <given-names>M</given-names></name><name><surname>Varsavsky</surname> <given-names>I</given-names></name><name><surname>Cacucci</surname> <given-names>F</given-names></name><name><surname>Wills</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Coordinated emergence of hippocampal replay and theta sequences during Post-natal development</article-title><source>Current Biology : CB</source><volume>29</volume><fpage>834</fpage><lpage>840</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2019.01.005</pub-id><pub-id pub-id-type="pmid">30773370</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Keefe</surname> <given-names>J</given-names></name><name><surname>Dostrovsky</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1971">1971</year><article-title>The hippocampus as a spatial map preliminary evidence from unit activity in the freely-moving rat</article-title><source>Brain Research</source><volume>34</volume><fpage>171</fpage><lpage>175</lpage><pub-id pub-id-type="doi">10.1016/0006-8993(71)90358-1</pub-id><pub-id pub-id-type="pmid">5124915</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Keefe</surname> <given-names>J</given-names></name><name><surname>Recce</surname> <given-names>ML</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Phase relationship between hippocampal place units and the EEG theta rhythm</article-title><source>Hippocampus</source><volume>3</volume><fpage>317</fpage><lpage>330</lpage><pub-id pub-id-type="doi">10.1002/hipo.450030307</pub-id><pub-id pub-id-type="pmid">8353611</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pastalkova</surname> <given-names>E</given-names></name><name><surname>Itskov</surname> <given-names>V</given-names></name><name><surname>Amarasingham</surname> <given-names>A</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Internally generated cell assembly sequences in the rat hippocampus</article-title><source>Science</source><volume>321</volume><fpage>1322</fpage><lpage>1327</lpage><pub-id pub-id-type="doi">10.1126/science.1159775</pub-id><pub-id pub-id-type="pmid">18772431</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reifenstein</surname> <given-names>ET</given-names></name><name><surname>Bin Khalid</surname> <given-names>I</given-names></name><name><surname>Kempter</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Synaptic learning rules for sequence learning</article-title><source>eLife</source><volume>10</volume><elocation-id>e67171</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.67171</pub-id><pub-id pub-id-type="pmid">33860763</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname> <given-names>NTM</given-names></name><name><surname>Priestley</surname> <given-names>JB</given-names></name><name><surname>Rueckemann</surname> <given-names>JW</given-names></name><name><surname>Garcia</surname> <given-names>AD</given-names></name><name><surname>Smeglin</surname> <given-names>VA</given-names></name><name><surname>Marino</surname> <given-names>FA</given-names></name><name><surname>Eichenbaum</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Medial entorhinal cortex selectively supports temporal coding by hippocampal neurons</article-title><source>Neuron</source><volume>94</volume><fpage>677</fpage><lpage>688</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.04.003</pub-id><pub-id pub-id-type="pmid">28434800</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanders</surname> <given-names>H</given-names></name><name><surname>Rennó-Costa</surname> <given-names>C</given-names></name><name><surname>Idiart</surname> <given-names>M</given-names></name><name><surname>Lisman</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Grid cells and place cells: an integrated view of their navigational and memory function</article-title><source>Trends in Neurosciences</source><volume>38</volume><fpage>763</fpage><lpage>775</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2015.10.004</pub-id><pub-id pub-id-type="pmid">26616686</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmidt</surname> <given-names>R</given-names></name><name><surname>Diba</surname> <given-names>K</given-names></name><name><surname>Leibold</surname> <given-names>C</given-names></name><name><surname>Schmitz</surname> <given-names>D</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name><name><surname>Kempter</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Single-trial phase precession in the hippocampus</article-title><source>The Journal of Neuroscience</source><volume>29</volume><fpage>13232</fpage><lpage>13241</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2270-09.2009</pub-id><pub-id pub-id-type="pmid">19846711</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><collab>SciPy 1.0 Contributors</collab><name><surname>Virtanen</surname> <given-names>P</given-names></name><name><surname>Gommers</surname> <given-names>R</given-names></name><name><surname>Oliphant</surname> <given-names>TE</given-names></name><name><surname>Haberland</surname> <given-names>M</given-names></name><name><surname>Reddy</surname> <given-names>T</given-names></name><name><surname>Cournapeau</surname> <given-names>D</given-names></name><name><surname>Burovski</surname> <given-names>E</given-names></name><name><surname>Peterson</surname> <given-names>P</given-names></name><name><surname>Weckesser</surname> <given-names>W</given-names></name><name><surname>Bright</surname> <given-names>J</given-names></name><name><surname>van der Walt</surname> <given-names>SJ</given-names></name><name><surname>Brett</surname> <given-names>M</given-names></name><name><surname>Wilson</surname> <given-names>J</given-names></name><name><surname>Millman</surname> <given-names>KJ</given-names></name><name><surname>Mayorov</surname> <given-names>N</given-names></name><name><surname>Nelson</surname> <given-names>ARJ</given-names></name><name><surname>Jones</surname> <given-names>E</given-names></name><name><surname>Kern</surname> <given-names>R</given-names></name><name><surname>Larson</surname> <given-names>E</given-names></name><name><surname>Carey</surname> <given-names>CJ</given-names></name><name><surname>Polat</surname> <given-names>İ</given-names></name><name><surname>Feng</surname> <given-names>Y</given-names></name><name><surname>Moore</surname> <given-names>EW</given-names></name><name><surname>VanderPlas</surname> <given-names>J</given-names></name><name><surname>Laxalde</surname> <given-names>D</given-names></name><name><surname>Perktold</surname> <given-names>J</given-names></name><name><surname>Cimrman</surname> <given-names>R</given-names></name><name><surname>Henriksen</surname> <given-names>I</given-names></name><name><surname>Quintero</surname> <given-names>EA</given-names></name><name><surname>Harris</surname> <given-names>CR</given-names></name><name><surname>Archibald</surname> <given-names>AM</given-names></name><name><surname>Ribeiro</surname> <given-names>AH</given-names></name><name><surname>Pedregosa</surname> <given-names>F</given-names></name><name><surname>van Mulbregt</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>SciPy 1.0: fundamental algorithms for scientific computing in python</article-title><source>Nature Methods</source><volume>17</volume><fpage>261</fpage><lpage>272</lpage><pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id><pub-id pub-id-type="pmid">32015543</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Sheehan</surname> <given-names>DJ</given-names></name><name><surname>Charczynski</surname> <given-names>S</given-names></name><name><surname>Fordyce</surname> <given-names>BA</given-names></name><name><surname>Hasselmo</surname> <given-names>ME</given-names></name><name><surname>Howard</surname> <given-names>MW</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A compressed representation of spatial distance in the rodent hippocampus</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.02.15.431306</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shimbo</surname> <given-names>A</given-names></name><name><surname>Izawa</surname> <given-names>E-I</given-names></name><name><surname>Fujisawa</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Scalable representation of time in the hippocampus</article-title><source>Science Advances</source><volume>7</volume><elocation-id>abd7013</elocation-id><pub-id pub-id-type="doi">10.1126/sciadv.abd7013</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skaggs</surname> <given-names>WE</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name><name><surname>Wilson</surname> <given-names>MA</given-names></name><name><surname>Barnes</surname> <given-names>CA</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Theta phase precession in hippocampal neuronal populations and the compression of temporal sequences</article-title><source>Hippocampus</source><volume>6</volume><fpage>149</fpage><lpage>172</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1098-1063(1996)6:2&lt;149::AID-HIPO6&gt;3.0.CO;2-K</pub-id><pub-id pub-id-type="pmid">8797016</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Souza</surname> <given-names>BC</given-names></name><name><surname>Tort</surname> <given-names>ABL</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Asymmetry of the temporal code for space by hippocampal place cells</article-title><source>Scientific Reports</source><volume>7</volume><elocation-id>8507</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-017-08609-3</pub-id><pub-id pub-id-type="pmid">28819301</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stachenfeld</surname> <given-names>KL</given-names></name><name><surname>Botvinick</surname> <given-names>MM</given-names></name><name><surname>Gershman</surname> <given-names>SJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The hippocampus as a predictive map</article-title><source>Nature Neuroscience</source><volume>20</volume><fpage>1643</fpage><lpage>1653</lpage><pub-id pub-id-type="doi">10.1038/nn.4650</pub-id><pub-id pub-id-type="pmid">28967910</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sutton</surname> <given-names>RS</given-names></name><name><surname>Barto</surname> <given-names>AG</given-names></name></person-group><year iso-8601-date="1998">1998</year><source>Reinforcement Learning: An Introduction</source><publisher-loc>Massachusetts, United States</publisher-loc><publisher-name>MIT Press</publisher-name></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname> <given-names>W</given-names></name><name><surname>Shin</surname> <given-names>JD</given-names></name><name><surname>Jadhav</surname> <given-names>SP</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Multiple time-scales of decision-making in the hippocampus and prefrontal cortex</article-title><source>eLife</source><volume>10</volume><elocation-id>e66227</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.66227</pub-id><pub-id pub-id-type="pmid">33683201</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Tanni</surname> <given-names>S</given-names></name><name><surname>de Cothi</surname> <given-names>W</given-names></name><name><surname>Barry</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>State transitions in the statistically stable place cell population are determined by visual change</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.06.16.448638</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Terada</surname> <given-names>S</given-names></name><name><surname>Sakurai</surname> <given-names>Y</given-names></name><name><surname>Nakahara</surname> <given-names>H</given-names></name><name><surname>Fujisawa</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Temporal and rate coding for discrete event sequences in the hippocampus</article-title><source>Neuron</source><volume>94</volume><fpage>1248</fpage><lpage>1262</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.05.024</pub-id><pub-id pub-id-type="pmid">28602691</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tingley</surname> <given-names>D</given-names></name><name><surname>Alexander</surname> <given-names>AS</given-names></name><name><surname>Quinn</surname> <given-names>LK</given-names></name><name><surname>Chiba</surname> <given-names>AA</given-names></name><name><surname>Nitz</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Multiplexed oscillations and phase rate coding in the basal forebrain</article-title><source>Science Advances</source><volume>4</volume><elocation-id>aar3230</elocation-id><pub-id pub-id-type="doi">10.1126/sciadv.aar3230</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsodyks</surname> <given-names>MV</given-names></name><name><surname>Skaggs</surname> <given-names>WE</given-names></name><name><surname>Sejnowski</surname> <given-names>TJ</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Population dynamics and theta rhythm phase precession of hippocampal place cell firing: a spiking neuron model</article-title><source>Hippocampus</source><volume>6</volume><fpage>271</fpage><lpage>280</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1098-1063(1996)6:3&lt;271::AID-HIPO5&gt;3.0.CO;2-Q</pub-id><pub-id pub-id-type="pmid">8841826</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Meer</surname> <given-names>MA</given-names></name><name><surname>Redish</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Theta phase precession in rat ventral striatum links place and reward information</article-title><source>The Journal of Neuroscience</source><volume>31</volume><fpage>2843</fpage><lpage>2854</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4869-10.2011</pub-id><pub-id pub-id-type="pmid">21414906</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vanderwolf</surname> <given-names>CH</given-names></name></person-group><year iso-8601-date="1969">1969</year><article-title>Hippocampal electrical activity and voluntary movement in the rat</article-title><source>Electroencephalography and Clinical Neurophysiology</source><volume>26</volume><fpage>407</fpage><lpage>418</lpage><pub-id pub-id-type="doi">10.1016/0013-4694(69)90092-3</pub-id><pub-id pub-id-type="pmid">4183562</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wikenheiser</surname> <given-names>AM</given-names></name><name><surname>Redish</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Hippocampal theta sequences reflect current goals</article-title><source>Nature Neuroscience</source><volume>18</volume><fpage>289</fpage><lpage>294</lpage><pub-id pub-id-type="doi">10.1038/nn.3909</pub-id><pub-id pub-id-type="pmid">25559082</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yamaguchi</surname> <given-names>Y</given-names></name><name><surname>Aota</surname> <given-names>Y</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name><name><surname>Lipa</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Bimodality of theta phase precession in hippocampal place cells in freely running rats</article-title><source>Journal of Neurophysiology</source><volume>87</volume><fpage>2629</fpage><lpage>2642</lpage><pub-id pub-id-type="doi">10.1152/jn.2002.87.6.2629</pub-id><pub-id pub-id-type="pmid">12037166</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname> <given-names>K</given-names></name><name><surname>Ginzburg</surname> <given-names>I</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name><name><surname>Sejnowski</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Interpreting neuronal population activity by reconstruction: unified framework with application to hippocampal place cells</article-title><source>Journal of Neurophysiology</source><volume>79</volume><fpage>1017</fpage><lpage>1044</lpage><pub-id pub-id-type="doi">10.1152/jn.1998.79.2.1017</pub-id><pub-id pub-id-type="pmid">9463459</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname> <given-names>C</given-names></name><name><surname>Hwaun</surname> <given-names>E</given-names></name><name><surname>Loza</surname> <given-names>CA</given-names></name><name><surname>Colgin</surname> <given-names>LL</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Hippocampal place cell sequences differ during correct and error trials in a spatial memory task</article-title><source>Nature Communications</source><volume>12</volume><elocation-id>3373</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-021-23765-x</pub-id><pub-id pub-id-type="pmid">34099727</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><sec id="s8" sec-type="appendix"><title>Variable theta phase locking fails to account for the combination of population and single-cell results</title><p>For completeness, we also considered whether the experimental results could be accounted for by a fourth model similar to the one proposed by <xref ref-type="bibr" rid="bib11">Chadwick et al., 2015</xref>. Cells participate in spatial sweeps, but the coordination between cells increases with running speed. At lower speeds, the lack of coordination between cells should bias the decoder toward the current position, leading to shorter decoded theta trajectories.</p><p>We modeled this by introducing the following modifications to the spatial sweep model. To increase the coordination between pairs of cells at the theta timescale with speed, we introduced into each cell a certain amount of independent theta phase noise that decreased with running speed:<disp-formula id="equ26"><label>(26)</label><mml:math id="m26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mn>360</mml:mn></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf135"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are samples obtained from a Gaussian distribution with standard deviation <inline-formula><mml:math id="inf136"><mml:msub><mml:mi>σ</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula>; with <inline-formula><mml:math id="inf137"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>120</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf138"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.025</mml:mn></mml:mrow></mml:math></inline-formula>. This is the crucial feature of the model. Additionally, to get a more realistic amount of variance in place field sizes and phase precession slopes, we used a slightly different theta distance for each cell:<disp-formula id="equ27"><label>(27)</label><mml:math id="m27"><mml:mrow><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo rspace="5.8pt">,</mml:mo><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>with <inline-formula><mml:math id="inf139"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>35</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf140"><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf141"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> derived from Gaussian distributions <inline-formula><mml:math id="inf142"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf143"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, respectively, and fixed for each cell for the entire simulation. The standard deviation setting the width of each true place fields was <inline-formula><mml:math id="inf144"><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mn> 0.25</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>As expected, the model provides a good fit for the increase in theta trajectory lengths with running speed. However, the model does not account for the increase in average place field sizes (<xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1A,B</xref>). Furthermore, unlike the experimental data, the model produces atypically noisy phase precession clouds at low running speeds (<xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1C</xref>) which become sharper with speed, as measured by decreasing residuals in the phase precession cloud fits (<xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2A,B</xref>).</p><fig id="app1fig1" position="float"><label>Appendix 1—figure 1.</label><caption><title>Variable theta phase locking fails to account for the combination of population and single-cell results.</title><p>(<bold>A</bold>, <bold>B</bold>) Comparison of experimental and simulated data produced by a model with constant <inline-formula><mml:math id="inf145"><mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> but variable theta phase noise. Plotting conventions as in <xref ref-type="fig" rid="fig7">Figure 7</xref>. The variable noise model does a good job at capturing the increase in theta trajectory lengths and phase precession slopes with running speed, but it does so at the cost of modest within-field changes in phase precession slopes and without capturing any of the increase in place field sizes. (<bold>C</bold>) Example phase precession clouds at low and high speeds for experimental and modeled place fields. Each column corresponds to a cell. The variable noise model introduces an atypically large amount of noise at low speeds as compared to the experimental data.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70296-app1-fig1-v2.tif"/></fig><fig id="app1fig2" position="float"><label>Appendix 1—figure 2.</label><caption><title>Theta phase locking and theta timescale coordination between cells vary with speed in the variable noise model but not in the experimental data.</title><p>(<bold>A</bold>, <bold>B</bold>) The effect of speed on the residuals of the phase precession cloud fits (i.e. mean squared orthogonal distances from the points to the fitting line). The fits are calculated after normalizing the place field size and the phase precession range (360°) to 1, so the residuals are dimensionless. In the variable noise model, the residuals decrease systematically with speed, as the phase vs. position relationship of spikes becomes sharper. This relationship, however, is not clear in the experimental data. Plotting conventions as for <xref ref-type="fig" rid="fig4">Figure 4B,C</xref>. (<bold>C</bold>, <bold>D</bold>) The effect of speed on the circular variance in phase differences between spikes emitted by pairs of cells with overlapping place fields. The variable noise model produces atypically high variance, and the variance tends to decrease with speed for individual cell pairs, which is not the case for the experimental data.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-70296-app1-fig2-v2.tif"/></fig><p>Even if phase precession clouds were noisier at lower speeds, cell coordination, and hence theta trajectory lengths could remain unaffected, if noise affected all cells in the same way. Therefore, we measured the effect of speed on cell coordination directly, by calculating the variance in phase differences between spikes of pairs of cells with overlapping place fields. First, we found cells whose place fields overlapped by more than 20 cm. Then, when rats were within 10 cm of the overlapping region of two cells, we collected, for each theta cycle individually, the phases at which spikes from each cell were emitted, and calculated all pairwise phase differences between them. Finally we calculated their circular variance (<xref ref-type="bibr" rid="bib22">Fisher, 1993</xref>) as:<disp-formula id="equ28"><label>(28)</label><mml:math id="m28"><mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf146"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is <inline-formula><mml:math id="inf147"><mml:mi>i</mml:mi></mml:math></inline-formula>-th pairwise phase difference between the two cells.</p><p>If the cells code for positions in a coordinated fashion, the variance in phase differences between their spikes should be low. We found that the level of variance present in the variable noise model at low speeds was unrealistically high as compared to the experimental data (<xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2C,D</xref>). Furthermore, in the experimental data, the variance in phase differences for spikes of a cell pair did not significantly change with running speed for any of the animals (<inline-formula><mml:math id="inf148"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.15</mml:mn></mml:mrow></mml:math></inline-formula>; Wilcoxon signed-rank test), whereas it did so for five of the six animals in the simulated data (<inline-formula><mml:math id="inf149"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>; Wilcoxon signed-rank test).</p><p>Overall, we conclude that these results rule out the possibility that changes in cell coordination at the theta time scale play a major role in explaining the changes observed in theta trajectory lengths.</p></sec></boxed-text></app><app id="appendix-2"><title>Appendix 2</title><boxed-text><sec id="s9" sec-type="appendix"><title>Summary of statistical tests</title><p><xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> contains a table with a summary of all statistical tests performed for the analyses of <xref ref-type="fig" rid="fig4">Figure 4</xref>, <xref ref-type="fig" rid="fig5">Figure 5</xref> and <xref ref-type="fig" rid="fig6">Figure 6</xref>. The table indicates animal names, number of samples (N), test types and p-values.</p></sec></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.70296.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Colgin</surname><given-names>Laura L</given-names></name><role>Reviewing Editor</role><aff><institution>University of Texas at Austin</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>This work develops a novel and rigorous mathematical framework to analyze spatial and temporal sequence coding in hippocampal place cells. The findings have potential to advance our understanding of hippocampal place cell functions by providing an explanation for seemingly conflicting results in previous studies of theta phase precession and theta sequences. The findings are likely to have an important impact on the hippocampal community.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Neuronal sequences during theta rely on behavior-dependent spatial maps&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Laura Colgin as the Senior Editor. The reviewers have opted to remain anonymous.</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission. A list of Essential Revisions, compiled from all reviews, is provided below. Please refer to the individual reviews, shown in their entirety below, for additional details about the comments in the essential revisions.</p><p>Essential revisions:</p><p>1. The authors conclude the experimental data best fit the behavior-dependent sweep model. However, the predicted effects on theta trajectory length and place cell properties are very similar between the temporal sweep model and the behavior-dependent sweep model (Figure 7). Therefore, it is unclear if they can conclusively determine experimental data best fit the behavior-dependent sweep model rather than the temporal sweep model, especially based on visual inspection. Their argument would be strengthened by analytically directly comparing the models and experimental data to determine which is a best fit. For example, is there are larger different between predicted and real data for the spatial and temporal sweep models than the behavior-dependent sweep model? A deeper analysis of what specifically differentiates the temporal sweep and behavior-dependent sweep is warranted. For example, the authors state &quot;The temporal sweep model could be fitted to roughly capture the observed increase in theta trajectory lengths, place field sizes and phase precession slopes pooled by running speed, but it incorrectly predicted changes in individual fields with speed.&quot; Visually these &quot;incorrect predictions&quot; do not seem that far off. Are they significantly different and if so what is the magnitude of the difference?</p><p>2. The behavior-dependent sweep model (equation 3) is essentially the spatial sweep model with dependence on the averaged speed which is a function of location. There is no instantaneous speed term in this model, even though they show the effects of instantaneous running speed in the model (Figure 2). The authors do not describe how exactly variation in instantaneous speed affect the model. Does the model only use average speed and if so, over what time scales? If the model uses average speed over long timescales like a whole trial or multiple trials, how does the model account for rapid changes in speed levels, like at the scale of a single theta cycle? Relatedly, the use of the speed term needs to be clarified in several places:</p><p>a. In Figure 7D, cell firing properties are separated for different speed levels. Over what time scales was speed measured? Are these speed levels the &quot;average speed&quot; term in equation (3)?</p><p>b. Based on equation (21), phase precession slope depends on the average speed in the behavior-dependent sweep model. How does this fit on single trial phase precession slope? For single phase precession, is the &quot;averaged speed&quot; calculated from the limited data within that trial?</p><p>3. Related to the above points, the two models that the authors contrast with their own with are oversimplified. Rather than highlighting the virtues of their own model, this creates the impression that any model in which place cells do not have unrealistic properties, such as place field width vanishing as the animal slows down, would work equally well. This impression is reinforced by the fact that crucial aspects of the model are not tested, and instead very general properties, some of which were already known, are tested as predictions of the model: running speed and properties of place cells vary along the track. To increase the impact of this work, the text should be revised to ensure that the authors' model is not compared with overly simplified models.</p><p>4. The authors should make sure that prior work from other labs is presented in its proper context and not specifically associated with one of the two overly simplified models presented in the text.</p><p>5. To address the issue whether field size or speed is better correlated with theta (spatial) length, the authors may consider producing a plot similar to Figure 7A, but using (mean) place field size rather than (mean) running speed, and adding a simulation condition using mean place field size as a controlling variable. The outcome could be one is better than the other, or they are similar or equivalent. Regardless of the outcome, the authors could discuss further the functional differences between these scenarios.</p><p>6. What is the evidence for the assumption of a &quot;true place field&quot;? What are the potential limitations of this assumption?</p><p>7. To increase impact, the overall organization and presentation of ideas should be revised to ensure clarity for a general audience.</p><p><italic>Reviewer #1:</italic></p><p>In this work, the authors develop precise mathematical models to determine if sequential hippocampal neural activity during behavior is best described as spatial or temporal sweeps. While prior work has shown evidence relating neural activity to both spatial and temporal sweeps, a cohesive and quantitative description of how neural activity sweeps relate to both time and space is needed. Whether theta sweeps better represent spatial or temporal coding of position (eg distance vs time to past and future locations) is readily distinguishable when animals run at different speeds. The authors make use of these models to make specific predictions about how population codes and single cell properties will vary with animal speed. The authors find that neither the spatial sweep model nor temporal sweep model fully describes observed place cells firing properties at the single cell or population levels. They propose a 'behavior-dependent' sweeps model to bridge both spatial temporal models and claim this model best described the experimental observations. Overall, this work develops a novel and rigorous mathematical framework to study spatial and temporal sequence coding in hippocampus and uses this framework to test whether theta sweeps in the hippocampus best represent spatial or temporal codes. Therefore, this work addresses important questions about how the hippocampus simultaneously encodes spatial and temporal information.</p><p>However, some clarifications are required. Specifically, it is unclear if they can conclusively determine experimental data best fit the behavior-dependent sweep model rather than the temporal sweep model, especially based on visual inspection. Their argument would be strengthened by analytically directly comparing the models and experimental data to determine which is a best fit. Furthermore, the temporal resolution of speed used in the models and analysis of experimental data requires clarification. In particular, it is unclear if the temporal resolution of speed is precise enough to account for rapid changes in speed.</p><p>1. The authors conclude the experimental data best fit the behavior-dependent sweep model. However, the predicted effects on theta trajectory length and place cell properties are very similar between the temporal sweep model and the behavior-dependent sweep model (Figure 7). Therefore, it is unclear if they can conclusively determine experimental data best fit the behavior-dependent sweep model rather than the temporal sweep model, especially based on visual inspection. Their argument would be strengthened by analytically directly comparing the models and experimental data to determine which is a best fit. For example, is there are larger different between predicted and real data for the spatial and temporal sweep models than the behavior-dependent sweep model? A deeper analysis of what specifically differentiates the temporal sweep and behavior-dependent sweep is warranted. For example, the authors state &quot;The temporal sweep model could be fitted to roughly capture the observed increase in theta trajectory lengths, place field sizes and phase precession slopes pooled by running speed, but it incorrectly predicted changes in individual fields with speed.&quot; Visually these &quot;incorrect predictions&quot; do not seem that far off. Are they significantly different and if so what is the magnitude of the difference?</p><p>2. The behavior-dependent sweep model (equation 3) is essentially the spatial sweep model with dependence on the averaged speed which is a function of location. There is no instantaneous speed term in this model, even though they show the effects of instantaneous running speed in the model (Figure 2). The authors do not describe how exactly variation in instantaneous speed affect the model. Does the model only use average speed and if so, over what time scales? If the model uses average speed over long timescales like a whole trial or multiple trials, how does the model account for rapid changes in speed levels, like at the scale of a single theta cycle? Relatedly, the use of the speed term needs to be clarified in several places:</p><p>a. In Figure 7D, cell firing properties are separated for different speed levels. Over what time scales was speed measured? Are these speed levels the &quot;average speed&quot; term in equation (3)?</p><p>b. Based on equation (21), phase precession slope depends on the average speed in the behavior-dependent sweep model. How does this fit on single trial phase precession slope? For single phase precession, is the &quot;averaged speed&quot; calculated from the limited data within that trial?</p><p>3. What is the evidence for the assumption of a &quot;true place field&quot;? What are the potential limitations of this assumption?</p><p><italic>Reviewer #2:</italic></p><p>After the finding of theta phase precession in rat place cells, it was soon discovered that place cells form sequential firing patterns within individual theta cycles that maintain the sequential order of their place fields along a spatial trajectory. The so-called theta sequences have important functional consequences, because they indicate that place cells at the population level encode not just the animal's current location, but also the past and future locations, all amazingly in the short time scale of a theta cycle (~120 ms). In this paper, the authors ask whether the &quot;past and future&quot; coding is spatial or temporal, i.e., whether the spatial contents represented in theta sequences go beyond a fixed time or distance from the animal's current time or location. The authors realize that results from previous studies cannot be explained by either, especially those regarding how the spatial distance within a theta sequence depends on the animal's running speed. The authors present a new explanation, called &quot;behavior-dependent sweep model&quot;, which relies on a key point that place fields of individual place cells vary in their sizes (lengths) at different locations along a trajectory and they tend to be larger when speed is high. By analyzing existing data and by computational modeling, the authors present evidence that supports their model.</p><p>Although most of the results from the data analysis confirm the findings in previous studies, these results, together with the key new finding on the relationship between place field size and speed (Figure 6), support the authors' conclusion. The data analysis and modeling are straightforward, the writing is mostly clear, and the conclusion is well balanced with sufficient discussions.</p><p>However, there is one major concern that may help clarify or strengthen the author's model that emphasizes the speed at each location of a trajectory, which the authors conceptualize as varies around a &quot;characteristic&quot; (mean) speed. The question here is whether it is necessary to introduce a behavioral variable, rather than a neurophysiological or functional one, to explain the spatial contents in theta sequences. A related and perhaps important issue is which one, place field size or speed, is more fundamental here. It is possible that simply stating that field sizes systematically vary at different locations along a trajectory and the animal tends to run faster at locations with larger fields, together with the well-known properties of of single-cell theta phase precession (termed &quot;spatial sweep&quot; by the authors), could be sufficient to explain all the data. The reason why emphasizing place field size is that place field is a functional concept that could be influenced by factors in spatial information encoding, such as task demand (e.g. turning points, reward sites), sensory cue density (e.g. rich in visual cues), or spatial layout (e.g. long straight arm). It is conceivable that these factors systematically vary from one location to another, leading to systematically larger or smaller place fields. On the other hand, running speed varies from one animal to another, from one session to another session in the same animal, and from one moment to another moment (and thus the definition of a &quot;characteristic&quot; mean speed is needed). From the data in Figures 3B, 6B, it seems that the same animal had more speed variation in one session (ec014, green), but the correlation between theta (spatial) length and speed was worse, than another (ec016, red). It is possible that the data like these can be better explained by directly targeting the relationship between theta length and place field size.</p><p>1) I only have one major suggestion. To address the issue whether field size or speed is better correlated with theta (spatial) length, the authors may consider producing a plot similar to Figure 7A, but using (mean) place field size rather than (mean) running speed, and adding a simulation condition using mean place field size as a controlling variable. The outcome could be one is better than the other, or they are similar or equivalent. Regardless of the outcome, the authors could discuss further the functional differences between these scenarios.</p><p><italic>Reviewer #3:</italic></p><p>Parra-Barrero and colleagues analyze and compare conceptually different modes in which neuronal sequences could be organized within a theta cycle in the hippocampus. They show that we cannot think of them as purely temporal or purely spatial predictions, and instead propose that we should think of them as temporal predictions at the animals' characteristic speed in a given position, hence 'behavior-dependent' sweeps. While this manuscript has many strengths and represents a significant step forward in organizing ideas around theta sweeps, my feeling is that it compares a reasonable model with two oversimplified models. More work should be directed to understanding which are the crucial ingredients for this model to work, and what are the degrees of freedom that could be used to build a family of models that would perform equally well.</p><p>Parra-Barrero and colleagues organize existing ideas about theta sweeps into a framework that allows contrasting different models with key experimental observations. In particular, they show that purely spatial theta sweeps (where the extent of the spatial sweep, and thus the place field size, is the same for all locations) do not produce a dependence of place field size or phase precession slope on running speed, as observed in experimental data. Similarly, they show that purely temporal sweeps (projecting the current instantaneous trajectory of the animal for a fixed time interval), produce sweeps with a length proportional to running speed. As running speed approaches zero, this generates the unrealistic situation in which theta sweep length and place field width go to zero, while phase precession slope goes to minus infinity. The authors contrast these two models with one based on behavior-dependent sweeps. In this model, sweeps are temporal but their spatial extension is proportional to the typical running speed in that position.</p><p>The major strengths of the manuscript are two. First, organizing previous ideas into a framework where different models can be contrasted. Second, proposing a model that does not have the caveats of the purely temporal or the purely spatial sweeps. I find that it also has some weaknesses. First, the two models that they contrast their own with are oversimplified. Rather than highlighting the virtues of their own model, this creates the impression that any model in which place cells do not have unrealistic properties, such as place field width vanishing as the animal slows down, would work equally well. This impression is reinforced by the fact that crucial aspects of the model are not tested, and instead very general properties, some of which were already known, are tested as predictions of the model: running speed and properties of place cells vary along the track. Second, I think that the authors have gone too far in associating the two oversimplified models with the previous work of colleagues that, in my view, not only would not accept these ideas as their own but in some cases would even claim that they have already published some results contradicting them. Carefully dissecting exactly which ideas were put forward by whom in the past would not only be fair to colleagues in the field but would also highlight the contrasting novelties presented in this manuscript. Third, the overall development of ideas is somewhat obscure and I think that the authors could find a way to present information so as to maximize the chances that interested readers will understand everything on the first attempt. The authors have chosen a way to present their ideas in which contradictions are left unresolved for a substantial part of the paper. In my view, this aesthetic choice has the risk of losing readers before they get to the point where everything becomes clear (the behavior-dependent sweep model and the idea that different cells provide information about different parts of the track, with different typical speed and place field properties). There is no need to do this, contradictions could be resolved as they appear, helping the reader to better navigate the manuscript.</p><p>The main result of the authors is a model that is compatible with experimental results. In my view, they should put some effort into clarifying whether this is a unique model or similar proposals would perform equally well. This means dissecting the crucial aspects that make this model better than any other (not just the two oversimplified models with unrealistic place field properties). Variations that I can think of are, for example, temporal sweeps with an overall mean speed rather than the mean speed for a given position, or spatial sweeps with a d_theta that depends on the width and density of place fields. If they find that there is a family of models sharing some crucial element that perform similarly, this would strengthen rather than weaken the manuscript. In addition, they should test specific predictions of the behavior-dependent sweep model. For example, characteristic speed and theta trajectory length along the track are not proportional (Figures 6B and C). Does the model require some improvement to account for this?</p><p>Overall I think that the authors have succeeded in bringing into the spotlight properties of theta sweeps that have been studied extensively from a qualitative perspective, but for which quantitative accounts are lacking. They have put forward a framework in which different models can be compared and proposed a model that is compatible with most of the experimental observations. In this sense, I think that a revised version of this manuscript would have an important impact on the hippocampal community.</p><p>30 – 'The current position of the animal'. There is an issue in how one defines this. What we typically have is an estimation of the position of LEDs that are placed somewhere above the animal's head. We ignore the distance between these LEDs and the position that CA1 considers to be the 'actual' position of the animal. Please comment on how this correction would affect the estimation of past and future positions at different speeds, especially when considering time sweeps.</p><p>69 – Geisler and colleagues (2007) claim in page 1:'Furthermore, the phase advance of the spikes relative to theta was steeper in fast than in slow trials'.</p><p>94 – Again, Geisler et al., 2007, seem to claim the opposite. On top of this, Maurer et al., 2012 do not seem to refer directly to the phase precession slope. They find a relationship between speed and look ahead distance and a speed dependent population CCG slope. Somehow this does not seem to comply with what is described here as the spatial sweep model not accounting for results at the population level. Perhaps what the authors present as 'the model' and the bits of it that can be related to previous descriptions could be described in greater depth.</p><p>98 – This length does not seem to be affected by a potential increase in field size as a result of place cells increasing their firing rate with speed. Why is this not taken into account?</p><p>625 – Equation 12. It should be clarified that this is an approximation, since phase precession has been shown to be highly non-linear already by O'Keefe and Recce. Thus, the exact value of the slope is highly dependent on the method, especially on the relative sampling of different phase ranges.</p><p>108 – L = v(t). As I understand it, dimensions do not match. The same happens to Equation 16 in the methods. Do parenthesis stand for multiplication or evaluation of the function v at a given time?</p><p>635 to 637 – There is a problem with the logic here. As v, goes to 0, v*tau going to 0 implies a slope going to minus infinity. However, v*tau is roughly speaking the width of the field of a cell at speed v. I do not think any of the authors cited in this manuscript would claim that the width of fields vanishes as v goes to 0. What is this temporal sweep model actually modeling? The fact that tau is independent of speed is more a choice of the manuscript authors than a claim coming from experimental results.</p><p>108 – 'This is almost exactly the result reported by Maurer et al., (2012); Gupta et al., (2012).'. Please specify how and in which figures. For example, Figure 8 from Gupta et al., seems to be at odds with this claim.</p><p>112 – Please specify or give an example of which procedures or methods can cause a contradiction. It is not clear from the text.</p><p>Figure 4a – The visualization of these examples is really poor. Since the purpose of this panel is visualization, I suggest to find a better way, perhaps with fewer examples or speed bins.</p><p>Figure 4b-c – Although the conclusion is plausible, and the examples seem to indicate this, the analysis is not convincing. The procedure based on regressing 7 datapoints has too much error, and this might mask an effect at the population level. (For example, are these individual regressions significant?) A high p-value does not necessarily mean that there is no effect. I suggest trying other methods. For example, the half-width decay in the spatial autocorrelation for the population of all cells could be studied and compared at different speeds. Fewer speed groups would also help getting better statistics. All of the analyses could also be applied to pools of cells with neighboring fields, to explain the contradiction right a way and thus help the reader navigate the manuscript.</p><p>178 – It is not clear at this point of the manuscript why both results are compatible with behavior dependent sweeps. This might need some more explanation.</p><p>191 – I suggest to try to make explicit and consistent the description of slopes. Unfortunately, describing a negative slope as 'lower' is ambiguous. Similarly, in 209 an 'increase in the slope' is mentioned, which is also ambiguous. Please revise this language throughout the manuscript. I believe people in the past have referred to slopes as shallower or steeper to avoid ambiguity.</p><p>181 – 194. What would the different models predict and why?</p><p>234 – Why are these results striking? Similar findings have been reported before. For example in Gupta et al., 2012. I disagree with lines 312 – 314. Figure S3 of Gupta et al., shows very similar results to the ones analyzed here.</p><p>Figure 6A – If this explains the apparent contradictions found in Figures 4 and 5, then pooling locations with similar average speed should make the pooled average effects disappear. This needs to be shown in those figures to help readers navigate the manuscript.</p><p>Figure 6,B-C – running speed at 0.25 is leeds then two thirds of the speed at 0.75. However theta length trajectories are similar. To my view this speaks directly against the simple explanation that is being tested 'Short theta trajectories and small place field sizes could occur where animals tend to run slow, contributing to the low speed averages, and long theta trajectories and large place field sizes could occur where animals tend to run fast, contributing to the fast speed averages'. There seems to be something else going on here.</p><p>Figure 7 – Comparisons are purely visual. Could some quantification be provided?</p><p>329 – Figure S5. In this paragraph an alternative model is discarded, but no quantification is provided. In the last two subpanels of panel F, Can the authors show how phase precession looks at these speeds in the experimental data and in their model, and compare it with the alternative model?</p><p>Please discuss how much of these behavioral-dependent sweeps could be thought of a side effect of a behavioral-dependent place field size and density resulting from the process of place cells learning their place fields.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.70296.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1. The authors conclude the experimental data best fit the behavior-dependent sweep model. However, the predicted effects on theta trajectory length and place cell properties are very similar between the temporal sweep model and the behavior-dependent sweep model (Figure 7). Therefore, it is unclear if they can conclusively determine experimental data best fit the behavior-dependent sweep model rather than the temporal sweep model, especially based on visual inspection. Their argument would be strengthened by analytically directly comparing the models and experimental data to determine which is a best fit. For example, is there are larger different between predicted and real data for the spatial and temporal sweep models than the behavior-dependent sweep model? A deeper analysis of what specifically differentiates the temporal sweep and behavior-dependent sweep is warranted. For example, the authors state &quot;The temporal sweep model could be fitted to roughly capture the observed increase in theta trajectory lengths, place field sizes and phase precession slopes pooled by running speed, but it incorrectly predicted changes in individual fields with speed.&quot; Visually these &quot;incorrect predictions&quot; do not seem that far off. Are they significantly different and if so what is the magnitude of the difference?</p></disp-quote><p>We agree with this point and we have tried to improve on it. First, we have made the visualization in Figure 7 clearer. Initially, the within-field increases in place field sizes and phase precession slopes corresponded to the increases between consecutive, partly overlapping, speed bins. This was suboptimal, since it did not highlight potential cumulative changes in place field sizes and phase precession slopes across speed bins. As a result, it under-represented the magnitude of the discrepancy between the data and temporal sweeps. Therefore, we have now plotted within-field increases in place field sizes and phase precession slopes as a function of the deviation from the field’s characteristic running speed. This visualization shows that individual cells get increasingly larger fields and shallower phase precession slopes with speed in the temporal sweep model, but not in the experimental data or in the behavior-dependent sweep model.</p><p>Second, we have simplified the color code in the figure to reflect only whether the model fits with the experimental data qualitatively or not (e.g., whether a variable that increases with speed in the experimental data also does so in the simulated data). The qualitative differences are now all pronounced and it is clear that only the behavior-dependent sweep qualitatively fits with all of the results. Third, we have provided quantitative measures for the fit of the models to the experimental data. In particular, we report the mean squared error (difference) between the average values produced by the model and the experimental data for each speed bin. The behavior-dependent sweep model presents the lowest errors for 4 of the 5 analyzed variables.</p><disp-quote content-type="editor-comment"><p>2. The behavior-dependent sweep model (equation 3) is essentially the spatial sweep model with dependence on the averaged speed which is a function of location. There is no instantaneous speed term in this model, even though they show the effects of instantaneous running speed in the model (Figure 2). The authors do not describe how exactly variation in instantaneous speed affect the model. Does the model only use average speed and if so, over what time scales? If the model uses average speed over long timescales like a whole trial or multiple trials, how does the model account for rapid changes in speed levels, like at the scale of a single theta cycle?</p></disp-quote><p>We hypothesize that in the behavior-dependent sweep model, the characteristic speed is computed over a sufficiently long time scale that filters out variation in running speeds from run to run. In fact, in our simulations, we used the average speed in a given session (excluding outliers). However, we do not commit to any particular view regarding how exactly this characteristic speed is calculated in the brain (e.g., it could be some kind of moving average (cumulative, exponential, etc.), or it could be set in the first few runs and then remain mostly stable). We have now clarified this issue where the term is first introduced, and we also discuss some possibilities in the section “Potential mechanisms of behavior-dependent sweeps”. Future experiments are needed to determine the exact nature and timescale of this average. Due to the hypothesized setting of the characteristic speed on a long timescale, it is not affected by rapid changes in running speed (within a trial or a single theta cycle). Therefore, in the behavior-dependent sweep model, single cell variables that depend on characteristic speed, such as place field size and phase precession slope do not change with instantaneous speed either (Figures 4 and 5).</p><p>However, in behavior-dependent sweeps, as well as in spatial sweeps, theta trajectory lengths are still somewhat affected by instantaneous running speed. This is because the sweep starts at some fixed distance behind the animal at the beginning of the theta cycle (t<sub>start</sub>), and ends at some fixed distance ahead of the animal at the end of the theta cycle (t<sub>end</sub>). However, the current position of the animal, x(t), changes slightly during that time (t<sub>end</sub>-t<sub>start</sub> = T) due to the animal’s motion. This change depends on the instantaneous running speed v and is given by x(t<sub>end</sub>)-x(t<sub>start</sub>) ≈ v*T to a first approximation. This distance v*T is added to the constant d<sub>theta</sub>, the sum of look-behind and look-ahead distances, to obtain the total theta trajectory length. We had described this effect for the spatial sweep model, but failed to alert the reader to the same effect arising in the behavior-dependent model (which is illustrated in Figure 2). We rectified this oversight.</p><disp-quote content-type="editor-comment"><p>Relatedly, the use of the speed term needs to be clarified in several places:</p><p>a. In Figure 7D, cell firing properties are separated for different speed levels. Over what time scales was speed measured? Are these speed levels the &quot;average speed&quot; term in equation (3)?</p></disp-quote><p>We used the label “running speed” (without further qualifiers) consistently to refer to the instantaneous speed because we felt that the former was more standard even though the latter is more precise. Thus, “running speed” in Figure 7D refers to instantaneous running speed as in the other panels of Figure 7 and in Figures 3-5. The characteristic speed term in Eqation 3 was used when generating spiking activity from the behavior-dependent model, but this activity is then analyzed and plotted as a function of instantaneous speed in Figure 7D. The only time we show the characteristic speed in a figure is Figure 6, where we explicitly use the label “characteristic speed“. We made our use of terms explicit.</p><disp-quote content-type="editor-comment"><p>b. Based on equation (21), phase precession slope depends on the average speed in the behavior-dependent sweep model. How does this fit on single trial phase precession slope? For single phase precession, is the &quot;averaged speed&quot; calculated from the limited data within that trial?</p></disp-quote><p>This point is probably already clarified by our replies above. The characteristic speed that controls phase precession slopes is calculated over multiple runs through the environment. The average speed of a single place field traversal is in fact what we take to be the traversal’s instantaneous running speed. This is because we select place field traversals during which rats ran at approximately constant speed. We show that this traversal speed does not affect phase precession slopes (Figure 5 D, E). In addition to clarifying what we mean by “characteristic running speed”, we have added a note in the Methods reminding the reader that the average speed of a single place field traversal is different from what we refer to as characteristic running speed.</p><disp-quote content-type="editor-comment"><p>3. Related to the above points, the two models that the authors contrast with their own with are oversimplified. Rather than highlighting the virtues of their own model, this creates the impression that any model in which place cells do not have unrealistic properties, such as place field width vanishing as the animal slows down, would work equally well. This impression is reinforced by the fact that crucial aspects of the model are not tested, and instead very general properties, some of which were already known, are tested as predictions of the model: running speed and properties of place cells vary along the track. To increase the impact of this work, the text should be revised to ensure that the authors' model is not compared with overly simplified models.</p></disp-quote><p>We would like to address this complex point in three parts. A: We argue that while the spatial and temporal sweep models are simple they are not unrealistic. B: Whether one considers them oversimplified or not, we believe there are important reasons to include them in our study since the ideas underlying spatial and temporal sweeps have played an important role in the literature and shaped our implicit assumptions about theta sequences. C: We agree that one could test for more aspects of the model and we have improved on this point.</p><p>A.1 The reviewers seem concerned that in the temporal sweep model, place field sizes vanish as the animal slows down. This is actually not the case. We have now tried to clarify this point in the manuscript. In the temporal sweep model, at zero speed, the position represented by the population, r(t), remains fixed at the animal’s current position. If a cell only fired when r(t) crossed the cell’s preferred position, defined as a single point in space, then the cell’s place field would become infinitely narrow as speed goes to zero. However, the cell’s preferred position is not defined as a point but as a ‘true’ place field with a finite non-negligible size (more on the assumption of true place field sizes in our reply to comment 6). In our simulations of the spatial and temporal sweep models, the true place field size is ~30cm. Therefore, cells fire everywhere within the cells’ true place fields, even at zero speeds, which acts as a lower bound on the measured place field size. Thanks to this feature, the temporal sweep model does not do a particularly bad job at reproducing experimentally observed place field sizes (Figure 7B). We also note that the reviewers themselves have pointed out above that the advantage of behavior-dependent sweeps over temporal sweeps was not evident enough.</p><p>A.2 We note that the simulations of the temporal sweep (Figure 7B) and spatial sweep (Figure 7C) models were performed using experimentally measured theta phases and position data in the same way as they were for the behavior-dependent model (Figure 7D). So, the three models are compared on an equal footing.</p><p>A.3 The behavior-dependent sweep model is only minimally more complex than the other two. As discussed in the manuscript and above in comment 2, the behavior-dependent sweep model is like the spatial sweep model where place field size depends on characteristic speed (Equation 5). Alternatively, it can also be seen as an approximation of temporal sweeps where characteristic speed is used instead of instantaneous speed. We feel that this additional assumption does not put the behavior-dependent sweep model in a different class of models from the other two.</p><p>B.1 The spatial and temporal sweep models are the most straightforward explanation for certain subsets of experimental findings, and as such deserve attention. The spatial sweep model is the simplest model that explains constant place field sizes and phase precession slopes, and temporal sweeps are the simplest explanation for the approximately proportional increase in theta trajectory length with speed observed by (Maurer et al., 2012) and (Gupta et al., 2012).</p><p>B.2 The models serve the function of articulating two ways of understanding the theta phase code that are more or less implicit in the literature. Spatial and temporal sweeps crystallize the ideas that different phases of theta encode positions “behind or ahead” or “in the past and future” respectively, which are pervasive in the field. Most researchers likely use these terms rather loosely, and do not endorse spatial nor temporal sweeps fully. However, we believe it is important to highlight what this language implies when taken literally, as this can help bring greater clarity and understanding.</p><p>B.3 Sometimes this language is, in fact, used literally or reflected explicitly in computational models. For instance, (Itskov et al., 2008) write that “place cell activity on different phases of theta reflects positions shifted into the future or past along the animal’s trajectory in a two-dimensional environment”. They conclude this after they find that among several models, the one that best fits experimental data is essentially what we describe as the temporal sweep (with the only difference that r(t) does not jump abruptly between theta cycles as in our model). (Chadwick et al., 2015)’s model of phase precession and theta trajectories, on the contrary, assumes that the phase-vs-position relationship of all cells is identical, consistent with what we describe as spatial sweeps. Most computational modeling work using place cells for path integration or goal directed navigation (e.g., (Brzosko et al., 2017; Foster et al., 2000; Samsonovich and McNaughton, 1997)) also make the simplifying assumption that all place fields are identical, which is again consistent with spatial sweeps.</p><p>B.4 Spatial and temporal sweeps set the context for understanding behavior-dependent sweeps, which can be construed as combining aspects of both.</p><p>C.1 When introducing the behavior-dependent sweep model, we have added equations showing how theta trajectory lengths and place field sizes depend linearly, and phase precession slopes hyperbolically, on characteristic running speed. This makes it easier to understand why the data shown on Figure 6 supports the behavior-dependent sweep model.</p><p>C.2 Since the model predicts a hyperbolic relationship between phase precession slopes and characteristic running speed, plotting the inverse of phase precession slopes should reveal a linear relationship. Therefore in Figure 6 we have plotted inverse phase precession slopes instead of phase precession slopes.</p><p>C.3 We have added moving averages to the plots showing place field size and inverse phase precession slope vs characteristic speed. The moving averages shows that the relationship between inverse phase precession slope and characteristic speed is indeed approximately linear for almost the complete range of speeds. The increases in theta trajectory lengths and place field sizes with characteristic speed also appear very linear for up to ~60 cm/s, which encompasses most of the data, and then flatten out. In the new supplementary figures S4 we show that the relationship between theta trajectory length and characteristic speed for each individual animal does not seem to flatten out, suggesting that the flattening in the pooled data is at least partly caused by combining points from clouds with different slopes and speed ranges.</p><p>C.4 We discuss whether we could additionally compare behavior-dependent sweeps to other models in our reply to comment 5.</p><disp-quote content-type="editor-comment"><p>4. The authors should make sure that prior work from other labs is presented in its proper context and not specifically associated with one of the two overly simplified models presented in the text.</p></disp-quote><p>We did not intend to imply that our colleagues have explicitly endorsed or would endorse either of these models. We simply meant to point out which individual previous findings were consistent with each of these conceptual models in the regimes that were examined. We have clarified this where possible.</p><p>There might have also been some specific misunderstandings regarding our citations of (Maurer et al., 2012) and (Geisler et al., 2007). Upon reflection we realized that we used the reference to Maurer et al., in a confusing way, since we cite them as evidence for both spatial and temporal sweeps without clarification. Their main findings (theta trajectory length increasing proportionally with speed) appear consistent with temporal sweeps, whereas their supplementary figure 1 (place field sizes do not change with speed) appears consistent with spatial sweeps. We clarified which result of Maurer et al., is consistent with which model. We also note that we have discussed our work with Andrew Maurer, who does not feel we have misrepresented his findings or interpretations.</p><p>We cited the work by Geisler et al., in support of spatial sweeps, while Reviewer 3 comments that Geisler et al., seem to claim the opposite, for example based on the following quote: 'Furthermore, the phase advance of the spikes relative to theta was steeper in fast than in slow trials'. The key to resolving this apparent contradiction is the underlined phrase. Geisler et al., describes phase precession relative to theta. We refer to phase precession with respect to position. There is actually no contradiction. In order to keep the phase vs. position relationship fixed (as described by spatial sweeps), the phase vs. theta/time relationship needs to become steeper with increasing speed. By contrast, if the phase vs. theta/time relationship remained constant, it would always take the same number of theta cycles to complete the phase precession, and that would result in place field sizes and (spatial) phase precession slopes increasing with speed. Hence, Geisler et al., conclude: “Here we directly show that the temporal-phase precession slope, and therefore the oscillation frequency of place cells, is positively correlated with the locomotion speed of the rat, such that the phase-distance relationship remains invariant”. We clarified in our manuscript that phase precession can be/was studied with respect to different variables.</p><disp-quote content-type="editor-comment"><p>5. To address the issue whether field size or speed is better correlated with theta (spatial) length, the authors may consider producing a plot similar to Figure 7A, but using (mean) place field size rather than (mean) running speed, and adding a simulation condition using mean place field size as a controlling variable. The outcome could be one is better than the other, or they are similar or equivalent. Regardless of the outcome, the authors could discuss further the functional differences between these scenarios.</p></disp-quote><p>Following the reviewers' request, we added a new supplementary figure S3 which shows the mutual relationships between theta trajectory lengths, place field sizes and also (inverse) phase precession slopes. Based on the equations we derive in the section “Mathematical description of coding schemes”, we expected these variables to display linear relationships to one another. This is indeed the case. The three variables display noisy but strikingly linear relationships to each other. The relationships between theta trajectory length and either mean place field size or mean (inverse) phase precession slope have correlation coefficients of 0.29, whereas the relationship between theta trajectory length and characteristic running speed has a slightly stronger correlation coefficient of 0.35. A couple of explanations for this small discrepancy quickly come to mind. First, some cells participating in the analysis of theta trajectory lengths were excluded from the analysis of place field size or phase precession slope because they displayed overlapping phase precession clouds. Second, place fields are skewed in systematic ways (Figure S6A). Theta trajectory lengths will be shorter or longer depending on whether they occur on the shorter or longer tails of the place fields. The place field size is calculated over the whole field and therefore misses this effect. Based on these results and considerations, we would expect a model that takes place field sizes as input to perform reasonably well, especially if it can also take into account other measures such as place field skews. However, note that theta trajectory lengths, place field sizes, skews or phase precession slopes are all partly redundant measurements of the same underlying neuronal activity. As such, it must be possible to reconstruct one measurement out of combinations of the others. But this would offer no direct insight as to why any of the variables changes in the first place. The three models we have put forward and contrasted to each other attempt to provide an account for the theta phase code. But what the cells are coding for must necessarily be described in terms of variables that are external to the place cells themselves. This is why we decided not to include results on a model where d_theta depends on the width and density of place fields or some other combination of place cell measurements.</p><disp-quote content-type="editor-comment"><p>6. What is the evidence for the assumption of a &quot;true place field&quot;? What are the potential limitations of this assumption?</p></disp-quote><p>The idea of a ‘true’ place field dates back at least to (Tsodyks et al., 1996)’s model of phase precession and virtually all experimental studies on theta sequences assume (even if implicitly) that the true place field of a place cell differs from its measured firing field. In the Tsodyks et al., model, at the beginning of each theta cycle, the place cells selective for the current position of the animal become activated, and then trigger the activation of cells that represent positions progressively further ahead. This results in the fact that only firing in the last part of the measured place field (where cells fire at the beginning of the theta cycle) is indicative of the animal being at the cells’s preferred location. John Lisman explicitly used the term “true place field” to refer to this preferred firing location when discussing a similar model (Lisman et al., 2005; Sanders et al., 2015). In experimental studies, it is generally agreed upon that the position represented by the hippocampal population sweeps forward during theta cycles, possibly starting behind the animal and reaching ahead (e.g. (Cei et al., 2014; Dragoi and Buzsáki, 2006; Drieu and Zugaro, 2019; Gupta et al., 2012; Itskov et al., 2008; Jensen and Lisman, 1996; Kay et al., 2020; Muessig et al., 2019; Terada et al., 2017)). This actually implies the existence of a ‘true’ place field. The true place field is, by definition, the portion of the field where the cell fires when representing the current position of the animal. When cells fire to represent positions behind or ahead of the animal, they would be firing outside of their true place fields. Another way of looking at it is that if the firing of place cells is indicative of a represented location r(t), which deviates from the current location x(t), then cells can fire when r(t) is located inside the cell’s preferred location while x(t) is not. That would result in firing outside of the cell’s preferred location or true place field. The opposite can also happen: that a place cell fails to spike when the animal is located within its true place field because the population is representing an r(t) that lies outside of it.</p><p>The alternative to the concept of true place fields would be to assume that cells always represent the current position of the animal (r(t) is always equal to x(t)). In this view, the change in theta phase across the field would just add more precision to the spatial code (e.g., cell A firing at 300º indicates that the animal is currently at position x, and the same cell firing at 60º indicates that the animal is currently at a different position y) (O’Keefe and Recce, 1993). However, in 2D open fields, the one-to-one mapping between positions and phases breaks down. A cell will fire at different phases in the same position depending on whether it is arriving at the field or exiting it (Huxter et al., 2008; Jeewajee et al., 2014). Hence, the spatial code would become less straightforward, having to take into account both theta phase and movement direction to decode the current spatial position. The interpretation that firing at different phases reflects arriving at or coming from the cell’s true place field then becomes more parsimonious. It also seems to fit better with accounts of phase precession reversal during backwards travel (Cei et al., 2014; Maurer et al., 2014), prospective shifts in the location of place fields (Battaglia et al., 2004), or constant sub-second cycling between representations of possible futures (Kay et al., 2020), as well as with the potential role of theta phase precession in memory and planning (Bolding et al., 2020; Robbe and Buzsáki, 2009; Zheng et al., 2021).</p><p>So the assumption of true place fields, although rarely made explicit, is actually deeply ingrained in the field. If it turned out to be wrong, a reinterpretation of most of the literature on theta phase coding would be required and some common methods would need to be re-evaluated (e.g., the ways in which position is decoded from ensemble place cell activity would turn out be misleading, since they produce theta trajectories that constantly deviate from the current position of the animal).</p><p>We changed the text to discuss the concept of true place fields explicitly in the manuscript.</p><disp-quote content-type="editor-comment"><p>7. To increase impact, the overall organization and presentation of ideas should be revised to ensure clarity for a general audience.</p></disp-quote><p>After making numerous clarifications and improvements throughout the text motivated by the reviewer’s comments, we feel that the manuscript has become much more accessible for a general audience.</p><p>We considered trying to resolve the contradictions earlier, in Figures 4 and 5, as opposed to waiting until Figure 6, like Reviewer 3 suggested. We decided not to do so because we think it is helpful to keep a two-parts structure, where in the first part we reproduce in the same dataset the combination of conflicting results, and in the second part we offer a solution to the conflict. The solution in Figure 6 now includes 9 panels. We believe it is beneficial to consider all of them together when trying to understand the proposed solution, so we prefer to dedicate a figure for this purpose. However, we have tried to add more early hints as to what the solution will be so that readers can better navigate the manuscript.</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>The main result of the authors is a model that is compatible with experimental results. In my view, they should put some effort into clarifying whether this is a unique model or similar proposals would perform equally well. This means dissecting the crucial aspects that make this model better than any other (not just the two oversimplified models with unrealistic place field properties). Variations that I can think of are, for example, temporal sweeps with an overall mean speed rather than the mean speed for a given position, or spatial sweeps with a d_theta that depends on the width and density of place fields. If they find that there is a family of models sharing some crucial element that perform similarly, this would strengthen rather than weaken the manuscript.</p></disp-quote><p>It is a fair point to ask whether other models might account for the data equally well or better. However, the options advanced by the reviewer are problematic. Temporal sweeps with an overall mean speed rather than the mean speed at each position would end up being equivalent to spatial sweeps, because the look-ahead and look-behind distances are independent of location or characteristic speed. Spatial sweeps with a d_theta that depends on place field sizes would work, but as we explain in our reply to the essential revision number 5, we believe that such a model would play a different kind explanatory role, and is therefore not directly comparable to the models we consider.</p><p>In trying to improve on this point, we have tested another explanatory variable: the distance to the nearest end of the track, which is also the distance to the nearest reward location. This variable also turns out to have a significant effect on place field parameters, but characteristic running speed uniquely accounts for a larger fraction of the variance (when using linear models). Of course, it is possible that the relationship between place field parameters and distance to borders or reward is non-linear. Further experiments are needed to fully dissociate the two variables. These results were added to the Results.</p><p>Finally, in the Discussion section we have tried to provide more alternatives to behavior-dependent sweeps. For instance, we note that (Tanni et al., 2021) propose that place field sizes, and hence, presumably, theta trajectory lengths, depend on the spatial rate of change of visual input. Other alternatives could involve the density of sensory cues, the complexity of the maze, the level of retrospection and prospection required for the task, etc. Characteristic running speed is likely to be correlated with many of these variables. Further dedicated experimentation would be needed to determine which is more fundamental in driving the theta phase code.</p><disp-quote content-type="editor-comment"><p>30 – 'The current position of the animal'. There is an issue in how one defines this. What we typically have is an estimation of the position of LEDs that are placed somewhere above the animal's head. We ignore the distance between these LEDs and the position that CA1 considers to be the 'actual' position of the animal. Please comment on how this correction would affect the estimation of past and future positions at different speeds, especially when considering time sweeps.</p></disp-quote><p>This comment might be getting at two related issues. One is whether there is a shift between the position represented by CA1 and the position of the LEDs. This seems very likely. However, in a linear track, this would just mean that the position of all place fields and theta trajectories should be shifted forwards or backwards by some fixed amount. Other than that, place field and theta trajectory parameters should remain constant, including look-behind and look-ahead distances.</p><p>The second issue is whether we can know at which phase of theta the CA1 population represents the ‘actual’ position of the animal. This seems difficult, especially in a linear track. In our equations, the phase at which the current position is represented is θ<sub>0</sub>. This parameter determines the ratio between look-ahead and look-behind. As the reviewer points out, changing this ratio would have an effect on temporal sweeps in the presence of positive or negative acceleration. For instance, given positive acceleration, the more (temporal) look-ahead there is as compared to look-behind, the bigger the place fields would become. We have added this point to the discussion.</p><disp-quote content-type="editor-comment"><p>98 – This length does not seem to be affected by a potential increase in field size as a result of place cells increasing their firing rate with speed. Why is this not taken into account?</p></disp-quote><p>We assume that firing rate is modulated by a multiplicative factor that scales up or down the activity of place cells. This multiplicative scaling would mean that the shapes of place cells’ firing fields remain unaffected. Since the size of place fields is calculated by considering when the firing rate falls below a certain fraction of the peak firing rate, scaling the place fields would not affect their sizes. We observe an increase in firing rate with speed (Figure S6 B), but no change in place field sizes within individual cells (Figure 4B). Therefore, the assumption of multiplicative scaling seems reasonable. The multiplicative scaling would also mean that firing rate changes have no effect on theta trajectories. This is because the ratios between spike counts of different cells at different phases of theta, which drive the Bayesian decoding of position, would remain unaffected.</p><disp-quote content-type="editor-comment"><p>625 – Equation 12. It should be clarified that this is an approximation, since phase precession has been shown to be highly non-linear already by O'Keefe and Recce. Thus, the exact value of the slope is highly dependent on the method, especially on the relative sampling of different phase ranges.</p></disp-quote><p>We agree. We have added the following clarification:</p><p>“Note that the model makes the simplifying assumption that sweeps, and hence also phase precession, are linear. There are indications that this could be the case when analyzing single trials (Schmidt et al., 2009) or when calculating theta phase using a wave-form method (Belluscio et al., 2012) (but see (Souza and Tort, 2017; Yamaguchi et al., 2002)).”</p><disp-quote content-type="editor-comment"><p>108 – L = v(t). As I understand it, dimensions do not match. The same happens to Equation 16 in the methods. Do parenthesis stand for multiplication or evaluation of the function v at a given time?</p></disp-quote><p>Unfortunately, standard mathematical notation uses parenthesis for both multiplication and function evaluation. Here, they were meant to indicate multiplication, and therefore the units on both sides of the equation match. To avoid the ambiguity, we swapped the terms in the product, i.e., L=(tau+T)v.</p><disp-quote content-type="editor-comment"><p>108 – 'This is almost exactly the result reported by Maurer et al., (2012); Gupta et al., (2012).'. Please specify how and in which figures. For example, Figure 8 from Gupta et al., seems to be at odds with this claim.</p></disp-quote><p>Unfortunately, standard mathematical notation uses parenthesis for both multiplication and function evaluation. Here, they were meant to indicate multiplication, and therefore the units on both sides of the equation match. To avoid the ambiguity, we swapped the terms in the product, i.e., L=(tau+T)v.</p><disp-quote content-type="editor-comment"><p>112 – Please specify or give an example of which procedures or methods can cause a contradiction. It is not clear from the text.</p></disp-quote><p>We have added some preliminary suggestions here and now refer the reader to the Discussion, where discuss specific hypotheses in the subsection “Relationship to previous studies on the speed-dependence of the hippocampal code”. We feel that the details given there would be too much in the beginning of the paper.</p><disp-quote content-type="editor-comment"><p>Figure 4a – The visualization of these examples is really poor. Since the purpose of this panel is visualization, I suggest to find a better way, perhaps with fewer examples or speed bins.</p></disp-quote><p>We have zoomed in around the fields, which seems to help.</p><disp-quote content-type="editor-comment"><p>Figure 4b-c – Although the conclusion is plausible, and the examples seem to indicate this, the analysis is not convincing. The procedure based on regressing 7 datapoints has too much error, and this might mask an effect at the population level. (For example, are these individual regressions significant?) A high p-value does not necessarily mean that there is no effect. I suggest trying other methods. For example, the half-width decay in the spatial autocorrelation for the population of all cells could be studied and compared at different speeds. Fewer speed groups would also help getting better statistics. All of the analyses could also be applied to pools of cells with neighboring fields, to explain the contradiction right a way and thus help the reader navigate the manuscript.</p></disp-quote><p>We agree that regressing 7 datapoints (at most; there can be as few as two, depending on the number of speed bins with valid measurements) is definitely noisy and we do not expect those individual regressions to be statistically significant. However, we do not see any reason to suspect that the noise could be systematically biased in any particular direction (e.g., that the regressions would tend to produce positive or negative slopes in the absence of an underlying positive or negative relationship, respectively). Therefore, it is appropriate to aggregate many of those noisy measurements and then apply a statistical test to assess whether the population of place fields as a whole increases or decreases place field size or phase precession slope with speed. The p-values in Figure 4B refer to the population level test. The same principle is applied in all statistical tests, noisy individual measurements are pooled and tested at the population level, e.g. whether a drug alleviates an illness in a specific person is a very noisy measurement, but nevertheless one can find evidence for an effect in a large population.</p><p>With regards to the alternative analysis suggested, one could in principle compare the spatial autocorrelation for the population of cells at different speeds. However, that is a population measure and not a single-cell measure, which is what we focus on in Figure 4B. Nevertheless, since individual place field sizes do not change with speed, the half-width decay of the spatial autocorrelation of the population should not change either (we imagine this could be the reviewer’s reasoning). There is one problem with this reasoning: Not all positions were traversed at all speeds, e.g., some positions near the borders were never traversed at high speed; some positions near the center were never traversed at low speeds. Hence firing rate maps are undefined at some positions and speeds and would not participate in the autocorrelation. The autocorrelation would then reflect data from different positions at different speeds. In other words, the population vector cannot be used in this way to study within-cell changes due to speed. In the end, we would see a similar effect of speed on autocorrelation width as we seen when we combine place field sizes across fields for each speed bin (Figure 4C). That relationship is statistically significant.</p><disp-quote content-type="editor-comment"><p>178 – It is not clear at this point of the manuscript why both results are compatible with behavior dependent sweeps. This might need some more explanation.</p></disp-quote><p>We now make that more explicit that this is the prediction depicted in Figure 2.</p><disp-quote content-type="editor-comment"><p>191 – I suggest to try to make explicit and consistent the description of slopes. Unfortunately, describing a negative slope as 'lower' is ambiguous. Similarly, in 209 an 'increase in the slope' is mentioned, which is also ambiguous. Please revise this language throughout the manuscript. I believe people in the past have referred to slopes as shallower or steeper to avoid ambiguity.</p></disp-quote><p>We agree with the reviewer and have made the suggested change.</p><disp-quote content-type="editor-comment"><p>181 – 194. What would the different models predict and why?</p></disp-quote><p>After the single pass phase precession analysis we briefly commented on which of the results fitted which of the models. This was meant to apply also to the pooled phase precession results discussed above, but that was not clear. We have improved on this and also added references to the relevant equations.</p><disp-quote content-type="editor-comment"><p>234 – Why are these results striking? Similar findings have been reported before. For example in Gupta et al., 2012. I disagree with lines 312 – 314. Figure S3 of Gupta et al. shows very similar results to the ones analyzed here.</p></disp-quote><p>That is a fair point. We removed the word “striking” and changed “Two previous studies (Maurer et al., 2012; Gupta et al., 2012) pooled theta trajectories based exclusively on speed, therefore masking the role of position in mediating the relationship between speed and theta trajectory length” to “[…] pooled theta trajectories across different positions when showing the effect of speed on theta trajectory length”.</p><disp-quote content-type="editor-comment"><p>Figure 6A – If this explains the apparent contradictions found in Figures 4 and 5, then pooling locations with similar average speed should make the pooled average effects disappear. This needs to be shown in those figures to help readers navigate the manuscript.</p></disp-quote><p>The reviewer is correct in principle, however, the suggested analysis is unlikely to add more clarity. If the range of characteristic speeds considered was too narrow, too few place fields would be pooled together, and the relationship between place field size and speed would be very noisy. If, on the other hand, a bigger range of characteristic speeds was used to pool place fields, we would start to see again the problem that different place fields contribute to the low and high speed averages. However, we have added some more early hints as to what is happening so that the readers are less confused in the build-up to Figure 6.</p><disp-quote content-type="editor-comment"><p>Figure 6,B-C – running speed at 0.25 is leeds then two thirds of the speed at 0.75. However theta length trajectories are similar. To my view this speaks directly against the simple explanation that is being tested 'Short theta trajectories and small place field sizes could occur where animals tend to run slow, contributing to the low speed averages, and long theta trajectories and large place field sizes could occur where animals tend to run fast, contributing to the fast speed averages'. There seems to be something else going on here.</p></disp-quote><p>The reviewer is right, this a curious effect that might arise due to interindividual differences between animals or differences in acceleration at different locations. Regarding the first point, the relationships between theta trajectory length and characteristic speed for each animal are mostly linear (new Figure S4), whereas the relationship flattens in the pooled data (new Figure 6G). We added a discussion of this point to the Results. Regarding the second point, there might be differences in acceleration between the first and second halves of the track. If there was more look-ahead than look-behind, then, given equal speed, theta trajectories could be longer in areas of positive acceleration. As we had commented in the Discussion, future work is needed to the study the potential effects of acceleration for future work where the data analyzed contains periods of more sustained acceleration and deceleration.</p><disp-quote content-type="editor-comment"><p>329 – Figure S5. In this paragraph an alternative model is discarded, but no quantification is provided. In the last two subpanels of panel F, Can the authors show how phase precession looks at these speeds in the experimental data and in their model, and compare it with the alternative model?</p></disp-quote><p>To facilitate a fairer evaluation of the Chadwick et al., model, we now quantify the differences between the experimental data and our “variable noise model”, which is based on the same principle as Chadwick et al.,’s, but was fitted to our experimental data. The conclusion remains that this type of model cannot account for some key aspects in our data.</p><disp-quote content-type="editor-comment"><p>Please discuss how much of these behavioral-dependent sweeps could be thought of a side effect of a behavioral-dependent place field size and density resulting from the process of place cells learning their place fields.</p></disp-quote><p>As we discussed in the reply to Essential Revisions no. 5, since place field size is correlated with characteristic speed, we cannot rule out that the effect of characteristic speed on theta coding is mediated via place field size. We have therefore added the following to the section titled “Potential mechanisms of behavior-dependent sweeps”:</p><p>“Alternatively, on the view that theta sequences arise from independent single cell coding (Chadwick et al., 2015), behavior-dependent sweeps could be seen as resulting from larger learned place fields in areas of faster running.”</p><p>References</p><p>Battaglia, F. P., Sutherland, G. R., and McNaughton, B. L. (2004). Local sensory cues and place cell directionality: Additional evidence of prospective coding in the hippocampus. <italic>The Journal of Neuroscience : The Official Journal of the Society for Neuroscience</italic>, <italic>24</italic>(19), 4541–4550. https://doi.org/10.1523/JNEUROSCI.4896-03.2004</p><p>Belluscio, M. A., Mizuseki, K., Schmidt, R., Kempter, R., and Buzsáki, G. (2012). Cross-Frequency Phase–Phase Coupling between Theta and Γ Oscillations in the Hippocampus. <italic>The Journal of Neuroscience</italic>, <italic>32</italic>(2), 423–435. https://doi.org/10.1523/jneurosci.4122-11.2012</p><p>Bolding, K. A., Ferbinteanu, J., Fox, S. E., and Muller, R. U. (2020). Place cell firing cannot support navigation without intact septal circuits. <italic>Hippocampus</italic>, <italic>30</italic>(3), 175–191. https://doi.org/10.1002/hipo.23136</p><p>Brzosko, Z., Zannone, S., Schultz, W., Clopath, C., and Paulsen, O. (2017). Sequential neuromodulation of Hebbian plasticity offers mechanism for effective reward-based navigation. <italic>eLife</italic>, <italic>6</italic>, e27756. https://doi.org/10.7554/<italic>eLife</italic>.27756</p><p>Cei, A., Girardeau, G., Drieu, C., Kanbi, K. E., and Zugaro, M. (2014). Reversed theta sequences of hippocampal cell assemblies during backward travel. <italic>Nat Neurosci</italic>, <italic>17</italic>(5), 719–724. https://doi.org/10.1038/nn.3698</p><p>Chadwick, A., van Rossum, M. C., and Nolan, M. F. (2015). Independent theta phase coding accounts for CA1 population sequences and enables flexible remapping. <italic>ELife</italic>, <italic>4</italic>, e03542. https://doi.org/10.7554/<italic>eLife</italic>.03542</p><p>Dragoi, G., and Buzsáki, G. (2006). Temporal Encoding of Place Sequences by Hippocampal Cell Assemblies. <italic>Neuron</italic>, <italic>50</italic>(1), 145–157. https://doi.org/10.1016/j.neuron.2006.02.023</p><p>Drieu, C., and Zugaro, M. (2019). Hippocampal Sequences During Exploration: Mechanisms and Functions. <italic>Frontiers in Cellular Neuroscience</italic>, <italic>13</italic>. https://doi.org/10.3389/fncel.2019.00232</p><p>Foster, D. J., Morris, R. G., and Dayan, P. (2000). A model of hippocampally dependent navigation, using the temporal difference learning rule. <italic>Hippocampus</italic>, <italic>10</italic>(1), 1–16. https://doi.org/10.1002/(SICI)1098-1063(2000)10:1&lt;1::AID-HIPO1&gt;3.0.CO;2-1</p><p>Geisler, C., Robbe, D., Zugaro, M., Sirota, A., and Buzsáki, G. (2007). Hippocampal place cell assemblies are speed-controlled oscillators. <italic>Proceedings of the National Academy of Sciences of the United States of America</italic>, <italic>104</italic>(19), 8149–8154. https://doi.org/10.1073/pnas.0610121104</p><p>Gupta, A. S., van der Meer, M. A., Touretzky, D. S., and Redish, A. D. (2012). Segmentation of spatial experience by hippocampal theta sequences. <italic>Nature Neuroscience</italic>, <italic>15</italic>(7), 1032–1039. https://doi.org/10.1038/nn.3138</p><p>Huxter, J. R., Senior, T. J., Allen, K., and Csicsvari, J. (2008). Theta phase-specific codes for two-dimensional position, trajectory and heading in the hippocampus. <italic>Nature Neuroscience</italic>, <italic>11</italic>(5), 587–594. https://doi.org/10.1038/nn.2106</p><p>Itskov, V., Pastalkova, E., Mizuseki, K., Buzsaki, G., and Harris, K. D. (2008). Theta-mediated dynamics of spatial information in hippocampus. <italic>The Journal of Neuroscience</italic>, <italic>28</italic>(23), 5959–5964. https://doi.org/10.1523/JNEUROSCI.5262-07.2008</p><p>Jeewajee, A., Barry, C., Douchamps, V., Manson, D., Lever, C., and Burgess, N. (2014). Theta phase precession of grid and place cell firing in open environments. <italic>Philosophical Transactions of the Royal Society B: Biological Sciences</italic>, <italic>369</italic>(1635), 20120532. https://doi.org/10.1098/rstb.2012.0532</p><p>Jensen, O., and Lisman, J. E. (1996). Hippocampal CA3 region predicts memory sequences: Accounting for the phase precession of place cells. <italic>Learning and Memory (Cold Spring Harbor, N.Y.)</italic>, <italic>3</italic>(2–3), 279–287.</p><p>Kay, K., Chung, J. E., Sosa, M., Schor, J. S., Karlsson, M. P., Larkin, M. C., Liu, D. F., and Frank, L. M. (2020). Constant Sub-second Cycling between Representations of Possible Futures in the Hippocampus. <italic>Cell</italic>, <italic>180</italic>(3), 552-567.e25. https://doi.org/10.1016/j.cell.2020.01.014</p><p>Lisman, J. E., Talamini, L. M., and Raffone, A. (2005). Recall of memory sequences by interaction of the dentate and CA3: A revised model of the phase precession. <italic>Neural Networks</italic>, <italic>18</italic>(9), 1191–1201. https://doi.org/10.1016/j.neunet.2005.08.008</p><p>Maurer, A. P., Burke, S. N., Lipa, P., Skaggs, W. E., and Barnes, C. A. (2012). Greater running speeds result in altered hippocampal phase sequence dynamics. <italic>Hippocampus</italic>, <italic>22</italic>(4), 737–747.</p><p>Maurer, A. P., Lester, A. W., Burke, S. N., Ferng, J. J., and Barnes, C. A. (2014). Back to the future: Preserved hippocampal network activity during reverse ambulation. <italic>The Journal of Neuroscience : The Official Journal of the Society for Neuroscience</italic>, <italic>34</italic>(45), 15022–15031. https://doi.org/10.1523/jneurosci.1129-14.2014</p><p>Muessig, L., Lasek, M., Varsavsky, I., Cacucci, F., and Wills, T. J. (2019). Coordinated Emergence of Hippocampal Replay and Theta Sequences during Post-natal Development. <italic>Current Biology</italic>, <italic>29</italic>(5), 834-840.e4. https://doi.org/10.1016/j.cub.2019.01.005</p><p>O’Keefe, J., and Recce, M. L. (1993). Phase relationship between hippocampal place units and the EEG theta rhythm. <italic>Hippocampus</italic>, <italic>3</italic>(3), 317–330. https://doi.org/10.1002/hipo.450030307</p><p>Robbe, D., and Buzsáki, G. (2009). Alteration of theta timescale dynamics of hippocampal place cells by a cannabinoid is associated with memory impairment. <italic>The Journal of Neuroscience : The Official Journal of the Society for Neuroscience</italic>, <italic>29</italic>(40), 12597–12605. https://doi.org/10.1523/JNEUROSCI.2407-09.2009</p><p>Samsonovich, A., and McNaughton, B. L. (1997). Path integration and cognitive mapping in a continuous attractor neural network model. <italic>The Journal of Neuroscience</italic>, <italic>17</italic>(15), 5900–5920.</p><p>Sanders, H., Rennó-Costa, C., Idiart, M., and Lisman, J. (2015). Grid Cells and Place Cells: An Integrated View of their Navigational and Memory Function. <italic>Trends in Neurosciences</italic>, <italic>38</italic>(12), 763–775. https://doi.org/10.1016/j.tins.2015.10.004</p><p>Schmidt, R., Diba, K., Leibold, C., Schmitz, D., Buzsáki, G., and Kempter, R. (2009). Single-trial phase precession in the hippocampus. <italic>The Journal of Neuroscience : The Official Journal of the Society for Neuroscience</italic>, <italic>29</italic>(42), 13232–13241. https://doi.org/10.1523/jneurosci.2270-09.2009</p><p>Souza, B. C., and Tort, A. B. L. (2017). Asymmetry of the temporal code for space by hippocampal place cells. <italic>Scientific Reports</italic>, <italic>7</italic>(1), 8507. https://doi.org/10.1038/s41598-017-08609-3</p><p>Tanni, S., Cothi, W. de, and Barry, C. (2021). State transitions in the statistically stable place cell population are determined by visual change. <italic>BioRxiv</italic>, 2021.06.16.448638. https://doi.org/10.1101/2021.06.16.448638</p><p>Terada, S., Sakurai, Y., Nakahara, H., and Fujisawa, S. (2017). Temporal and Rate Coding for Discrete Event Sequences in the Hippocampus. <italic>Neuron</italic>, <italic>94</italic>(6), 1248-1262.e4. https://doi.org/10.1016/j.neuron.2017.05.024</p><p>Tsodyks, M. V., Skaggs, W. E., Sejnowski, T. J., and McNaughton, B. L. (1996). Population dynamics and theta rhythm phase precession of hippocampal place cell firing: A spiking neuron model. <italic>Hippocampus</italic>, <italic>6</italic>(3), 271–280. https://doi.org/10.1002/(sici)1098-1063(1996)6:3\%3C271::aid-hipo5\%3E3.0.co;2-q</p><p>Yamaguchi, Y., Aota, Y., McNaughton, B. L., and Lipa, P. (2002). Bimodality of theta phase precession in hippocampal place cells in freely running rats. <italic>J Neurophysiol</italic>, <italic>87</italic>(6), 2629–2642.</p><p>Zheng, C., Hwaun, E., Loza, C. A., and Colgin, L. L. (2021). Hippocampal place cell sequences differ during correct and error trials in a spatial memory task. <italic>Nature Communications</italic>, <italic>12</italic>(1), 3373. https://doi.org/10.1038/s41467-021-23765-x</p></body></sub-article></article>