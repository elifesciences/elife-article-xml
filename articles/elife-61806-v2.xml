<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">61806</article-id><article-id pub-id-type="doi">10.7554/eLife.61806</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Physics of Living Systems</subject></subj-group></article-categories><title-group><article-title>A framework for studying behavioral evolution by reconstructing ancestral repertoires</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-229356"><name><surname>Hernández</surname><given-names>Damián G</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8995-7495</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-201537"><name><surname>Rivera</surname><given-names>Catalina</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-102849"><name><surname>Cande</surname><given-names>Jessica</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-201535"><name><surname>Zhou</surname><given-names>Baohua</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-232210"><name><surname>Stern</surname><given-names>David L</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1847-6483</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-30091"><name><surname>Berman</surname><given-names>Gordon J</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3588-7820</contrib-id><email>gordon.berman@emory.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><label>1</label><institution>Department of Physics, Emory University</institution><addr-line><named-content content-type="city">Atlanta</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution>Department of Medical Physics, Centro Atómico Bariloche and Instituto Balseiro</institution><addr-line><named-content content-type="city">Bariloche</named-content></addr-line><country>Argentina</country></aff><aff id="aff3"><label>3</label><institution>Janelia Research Campus, Howard Hughes Medical Institute</institution><addr-line><named-content content-type="city">Ashburn</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution>Department of Molecular, Cellular and Developmental Biology, Yale University</institution><addr-line><named-content content-type="city">New Haven</named-content></addr-line><country>United States</country></aff><aff id="aff5"><label>5</label><institution>Department of Biology, Emory University</institution><addr-line><named-content content-type="city">Atlanta</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Goldberg</surname><given-names>Jesse H</given-names></name><role>Reviewing Editor</role><aff><institution>Cornell University</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Rutz</surname><given-names>Christian</given-names></name><role>Senior Editor</role><aff><institution>University of St Andrews</institution><country>United Kingdom</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>02</day><month>09</month><year>2021</year></pub-date><pub-date pub-type="collection"><year>2021</year></pub-date><volume>10</volume><elocation-id>e61806</elocation-id><history><date date-type="received" iso-8601-date="2020-08-05"><day>05</day><month>08</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2021-09-01"><day>01</day><month>09</month><year>2021</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at bioRxiv.</event-desc><date date-type="preprint" iso-8601-date="2020-07-17"><day>17</day><month>07</month><year>2020</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2020.07.17.209361"/></event></pub-history><permissions><copyright-statement>© 2021, Hernández et al</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>Hernández et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-61806-v2.pdf"/><abstract><p>Although different animal species often exhibit extensive variation in many behaviors, typically scientists examine one or a small number of behaviors in any single study. Here, we propose a new framework to simultaneously study the evolution of many behaviors. We measured the behavioral repertoire of individuals from six species of fruit flies using unsupervised techniques and identified all stereotyped movements exhibited by each species. We then fit a Generalized Linear Mixed Model to estimate the intra- and inter-species behavioral covariances, and, by using the known phylogenetic relationships among species, we estimated the (unobserved) behaviors exhibited by ancestral species. We found that much of intra-specific behavioral variation has a similar covariance structure to previously described long-time scale variation in an individual’s behavior, suggesting that much of the measured variation between individuals of a single species in our assay reflects differences in the status of neural networks, rather than genetic or developmental differences between individuals. We then propose a method to identify groups of behaviors that appear to have evolved in a correlated manner, illustrating how sets of behaviors, rather than individual behaviors, likely evolved. Our approach provides a new framework for identifying co-evolving behaviors and may provide new opportunities to study the mechanistic basis of behavioral evolution.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>evolution</kwd><kwd>behavior</kwd><kwd>GLMM</kwd><kwd>unsupervised learning</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>D. melanogaster</italic></kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000025</institution-id><institution>National Institute of Mental Health</institution></institution-wrap></funding-source><award-id>MH115831-01</award-id><principal-award-recipient><name><surname>Berman</surname><given-names>Gordon J</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004412</institution-id><institution>Human Frontier Science Program</institution></institution-wrap></funding-source><award-id>RGY0076/2018</award-id><principal-award-recipient><name><surname>Berman</surname><given-names>Gordon J</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000011</institution-id><institution>Howard Hughes Medical Institute</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Cande</surname><given-names>Jessica</given-names></name><name><surname>Stern</surname><given-names>David L</given-names></name><name><surname>Berman</surname><given-names>Gordon J</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100001309</institution-id><institution>Research Corporation for Science Advancement</institution></institution-wrap></funding-source><award-id>25999</award-id><principal-award-recipient><name><surname>Berman</surname><given-names>Gordon J</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>1806833</award-id><principal-award-recipient><name><surname>Rivera</surname><given-names>Catalina</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution>Ministerio de Ciencia, Tecnología e Innovación de Argentina</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Hernández</surname><given-names>Damián G</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>The behavioral repertoires from six species of flies are measured, and a statistical approach is developed to predict co-evolving behaviors, providing a potential framework for exploring behavioral evolution.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Behavior is one of the most variable and rapidly evolving phenotypes, with notable differences even between closely related species (<xref ref-type="bibr" rid="bib36">Lorenz, 1958</xref>; <xref ref-type="bibr" rid="bib37">Martins, 1996</xref>). Variable behaviors and rapid behavioral evolution likely facilitates adaptation to new or varying environments and speciation (<xref ref-type="bibr" rid="bib4">Baier and Hoekstra, 1914</xref>; <xref ref-type="bibr" rid="bib61">West-Eberhard, 2003</xref>). Despite the importance of animal behavior, progress in revealing the genetic basis of behavioral evolution has been slow (<xref ref-type="bibr" rid="bib27">Gleason and Ritchie, 2004</xref>; <xref ref-type="bibr" rid="bib63">Yamamoto and Ishikawa, 2013</xref>; <xref ref-type="bibr" rid="bib23">Ellison et al., 2011</xref>; <xref ref-type="bibr" rid="bib49">Shaw and Lesnick, 2009</xref>). In contrast, recent decades have seen significant progress in understanding the genetic causes of morphological evolution (<xref ref-type="bibr" rid="bib62">Williams and Carroll, 2009</xref>; <xref ref-type="bibr" rid="bib50">Shubin et al., 2009</xref>; <xref ref-type="bibr" rid="bib34">Levine and Davidson, 2005</xref>; <xref ref-type="bibr" rid="bib54">Stern and Frankel, 2013</xref>).</p><p>While there are many potential reasons for the discrepancy between studies of behavioral and morphological evolution, including the lack of a fossil record for behavior, a key difficulty has been identifying which aspects of an animal’s development and physiology are the proximate causes of behavior evolution. Evolutionary changes in behavior could emerge from alterations in the developmental patterning of neural circuits (e.g., brain networks, descending commands, central pattern generators), changes in hormonal regulation that influence neural activity, or even from changes in non-neuronal morphology (<xref ref-type="bibr" rid="bib5">Baker et al., 2001</xref>; <xref ref-type="bibr" rid="bib39">Massey et al., 2019</xref>). Each of these possibilities could result in behavioral effects at different, yet overlapping, timescales – from muscle twitches to stereotyped suites of behaviors to longer-lived states like foraging or courtship or aging that may control the relative frequency of a given behavior. This complexity may make it difficult to identify the precise aspects of behavior that have evolved.</p><p>To address these difficulties, the standard approach in the genetic study of behavioral evolution has been to identify focal behaviors that exhibit robust differences between species, such as courtship behavior in fruit flies (<xref ref-type="bibr" rid="bib14">Cande et al., 2012</xref>; <xref ref-type="bibr" rid="bib15">Cande et al., 2014</xref>; <xref ref-type="bibr" rid="bib21">Ding et al., 2019</xref>) or burrow formation in deermice (<xref ref-type="bibr" rid="bib60">Weber et al., 2013</xref>; <xref ref-type="bibr" rid="bib33">Hu and Hoekstra, 2017</xref>). It has been possible to identify genomic regions that correlate with quantitative changes in focal behaviors. However, usually multiple genomic regions are identified, each containing many genes. Given the large number of putative genes involved, combined with the possibility of epistatic interactions between loci, identification of the contributions of individual genes to behavioral evolution has progressed slowly.</p><p>An alternative approach to focusing on single behaviors is to examine the full repertoire of movements that an animal performs. By identifying sets of behaviors that evolve together, as was recently performed for hand-tuned traits in a study of birds-of-paradise evolution (<xref ref-type="bibr" rid="bib35">Ligon et al., 2018</xref>), it may be possible to identify regulators of these suites of behaviors. This approach has been thwarted by the challenge of robustly measuring multiple behavioral phenotypes simultaneously. Recent progress in the unsupervised identification of animal behaviors across length and time scales, however, has made this approach possible (<xref ref-type="bibr" rid="bib9">Berman, 2018</xref>; <xref ref-type="bibr" rid="bib11">Brown and de Bivort, 2018</xref>). In this study, we introduce a quantitative framework for studying the evolutionary dynamics of large suites of behavior. We have focused initially on fruit flies, which provide a convenient model for this problem – both because they exhibit a wide range of complex behaviors and because unsupervised approaches can be used to map all of the animal movements captured in video recordings (<xref ref-type="bibr" rid="bib7">Berman et al., 2014</xref>; <xref ref-type="bibr" rid="bib16">Cande et al., 2018</xref>; <xref ref-type="bibr" rid="bib8">Berman et al., 2016</xref>).</p><p>We recorded movies of isolated male flies from six species in a nearly stimulus-deprived environment. Because we did not record flies experiencing social and other environmental cues, we did not observe many charismatic natural behaviors, such as courtship and aggression. Nevertheless, we found that the behaviors they performed, including walking and grooming, contain species-specific information. We thus hypothesized that our quantitative representations of behaviors could be studied in an evolutionary context. To infer the evolutionary trajectories of behavioral evolution, we estimated ancestral behavioral repertoires with a Generalized Linear Mixed Model (GLMM) approach (<xref ref-type="bibr" rid="bib29">Hadfield, 2010</xref>), which builds upon Felsenstein’s approach to reconstructing ancestral states (<xref ref-type="bibr" rid="bib24">Felsenstein, 1985</xref>; <xref ref-type="bibr" rid="bib25">Felsenstein, 2005</xref>; <xref ref-type="bibr" rid="bib30">Hadfield and Nakagawa, 2010</xref>; <xref ref-type="bibr" rid="bib43">O’Meara, 2012</xref>). Using these results, we develop a framework that allows us to model the behavioral traits that co-vary both within a species and along the phylogeny. We found that within-species variance has a similar structure to long-lasting internal states of the animal that we characterized previously, and that inter-species variance can capture how disparate behaviors may have evolved together. This latter finding points toward the presence of higher order behavioral traits that would not have been detected by studying individual behaviors in isolation and that may be amenable to further evolutionary and genetic analysis.</p><sec id="s1-1"><title>Experiments and behavioral quantification</title><p>We captured video recordings of all behaviors performed by single flies isolated in a largely featureless environment for multiple individuals from six species of the <italic>Drosophila melanogaster</italic> species subgroup: <italic>D. mauritiana</italic>, <italic>D. melanogaster</italic>, <italic>D. santomea</italic>, <italic>D. sechellia</italic>, <italic>D. simulans</italic>, and <italic>D. yakuba</italic> (<xref ref-type="bibr" rid="bib16">Cande et al., 2018</xref>). Although the animals could not jump or fly in these chambers and were not expected to exhibit social or feeding behaviors, the flies displayed a variety of complex behaviors, including locomotion and grooming. Each of these behaviors involves multiple body parts that move at varying time scales. The species studied here were chosen because their phylogenetic relationships are well understood (<xref ref-type="bibr" rid="bib18">Clark et al., 2007</xref>; <xref ref-type="bibr" rid="bib42">Obbard et al., 2012</xref>; <xref ref-type="bibr" rid="bib17">Chyb and Gompel, 2013</xref>; <xref ref-type="bibr" rid="bib48">Seetharam and Stuart, 2013</xref>) (summarized in the tree seen in Figure 3), and genetic tools are available for most of these species (<xref ref-type="bibr" rid="bib53">Stern et al., 2017</xref>). Since a single strain represents a genomic ‘snapshot’ of each species, we assayed multiple individuals from each of multiple strains of each species to attempt to capture species-specific differences, and not variation specific to particular strains (see Materials and methods). In total, we collected data from 561 flies, each measured for an hour at a sampling rate of 100 Hz.</p><p>While previous studies have identified differences in specific behaviors, such as courtship behavior, between these species (<xref ref-type="bibr" rid="bib14">Cande et al., 2012</xref>; <xref ref-type="bibr" rid="bib21">Ding et al., 2019</xref>; <xref ref-type="bibr" rid="bib63">Yamamoto and Ishikawa, 2013</xref>; <xref ref-type="bibr" rid="bib3">Auer and Benton, 2016</xref>), here we assayed the full repertoire of behaviors the flies performed in the arena, with the aim of identifying combinations of behaviors that may be evolving together. To measure this repertoire, we used a previously described behavior mapping method (<xref ref-type="bibr" rid="bib7">Berman et al., 2014</xref>; <xref ref-type="bibr" rid="bib16">Cande et al., 2018</xref>) that starts from raw video images and finds each animal’s stereotyped movements in an unsupervised manner. The output of this method is a two-dimensional probability density function (PDF) that contains many peaks and valleys (<xref ref-type="fig" rid="fig1">Figure 1A</xref>), where each peak corresponds to a different stereotyped behavior (e.g., right wing grooming, proboscis extension, running, etc).</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Behavioral repertoires of <italic>Drosophila</italic>.</title><p>(<bold>A</bold>) The behavioral space probability density function, obtained using the unsupervised approach described in <xref ref-type="bibr" rid="bib7">Berman et al., 2014</xref> on the entire data set of 561 individuals across all species. Coarse grained behaviors corresponding to the different types of movements exhibited in the map are shown as well. (<bold>B</bold>) The relative performance of each of the 134 stereotyped behaviors for each of the six species. Each region here represents a behavior, and the color scale indicates the logarithm of the fraction of time that each species performs the specified behavior divided by the average across all species.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61806-fig1-v2.tif"/></fig><p>Briefly, to create the density plots, raw video images were rotationally and translationally aligned to create an egocentric frame for the fly. The transformed images were decomposed using Principal Components Analysis into a low-dimensional set of time series. For each of these postural mode time series, a Morlet wavelet transform was applied, obtaining a local spectrogram between 1 Hz and 50 Hz (the Nyquist frequency). After normalization, each point in time was mapped using t-SNE (<xref ref-type="bibr" rid="bib59">van der Maaten and Hinton, 2008</xref>) into a two-dimensional plane. Finally, convolving these points with a two-dimensional gaussian and applying the watershed transform (<xref ref-type="bibr" rid="bib41">Meyer, 1994</xref>), produced 134 different regions, each of these containing a single local maximum of probability density that corresponds to a particular stereotypical behavior. We integrate over this local region of the probability density to calculate the probability that a fly is performing this behavior at a random point in time. Thus, we can associate each fly with a 134-dimensional real-valued vector that represents the probability of the fly performing a certain stereotyped behavior at a given time during the hour-long experimental session. We will refer to this quantity as the animal’s <italic>behavioral vector, </italic><inline-formula><mml:math id="inf1"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>.</p><p>The behavioral map averaged across all six species is shown in <xref ref-type="fig" rid="fig1">Figure 1A</xref> and displays a pattern of movements similar to those we found in previous work, where locomotion, idle/slow, anterior/posterior movements, etc. are segregated into different regions (<xref ref-type="bibr" rid="bib7">Berman et al., 2014</xref>; <xref ref-type="bibr" rid="bib16">Cande et al., 2018</xref>). Averaging across all individuals of each species, we found the mean behavioral vector for each species (<xref ref-type="fig" rid="fig1">Figure 1B</xref>) and observed that each species performs certain behaviors with different probabilities. For example, <italic>D. mauritiana</italic> individuals spend more time performing fast locomotion than all other species on average, and <italic>D. yakuba</italic> individuals spend much of their time performing an almost species-unique type of slow locomotion, but little time running quickly.</p><p>These average probability maps provide some insight into potential species differences, but to identify species-specific behaviors, we also need to account for variation in the probability that individuals of each species perform each behavior. One way to address this problem is to ask whether an individual’s species identity can be predicted solely from its multi-dimensional behavioral vector. To explore this question, we first used t-SNE to project all 561 individuals into a two-dimensional plane (<xref ref-type="fig" rid="fig2">Figure 2A</xref>), using the Jensen-Shannon divergence as the distance metric between individual behavioral vectors. In this plot, different colors represent different species, and different symbols with the same color represent different strains within the same species. Although species do not segment cleanly into separate regions of this plane, the distribution of species is far from random, with individuals from the same species tending to group near to one other. Given this structure, there is likely species-specific information in the behavioral vectors.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Classification of fly species based on behavioral repertoires.</title><p>(<bold>A</bold>) A t-SNE embedding of the behavioral repertoires shows that behavioral repertoires contain some species-specific information. Each dot represents one individual fly, with different colors representing different species and different symbols with the same color representing different strains within the same species. The distance matrix (561 by 561) used to create the embedding is the Jensen-Shannon divergence between the behavioral densities of individual flies. (<bold>B</bold>) Confusion matrix for the logistic regression with each row normalized. All the values are averaged from 100 different trials. The standard error is less than 0.01 for the diagonal elements and less than 0.005 for each of the off-diagonal elements.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61806-fig2-v2.tif"/></fig><p>To quantify this observation, we applied a multinomial logistic regression classifier to the data, performing a six-way classification based solely on the high-dimensional behavioral vectors. After training, the classifier correctly classified <inline-formula><mml:math id="inf2"><mml:mrow><mml:mn>89</mml:mn><mml:mo>±</mml:mo><mml:mrow><mml:mn>.2</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of vectors in our test set (a randomly selected 30% of the entire data set that was not used during training). Moreover, the confusion matrix (<xref ref-type="fig" rid="fig2">Figure 2B</xref>) revealed no systematic misclassification bias amongst the species. Note that we have used a relatively simple classifier compared to modern deep learning methods (<xref ref-type="bibr" rid="bib28">Goodfellow et al., 2016</xref>), so these results likely represent a lower bound on the distinguishability of the behavioral vectors. Thus, the behavioral vectors contain considerable species-specific information. We therefore proceeded to explore how these behavioral vectors may have evolved along the phylogeny.</p></sec><sec id="s1-2"><title>Reconstructing ancestral behavioral repertoires</title><p>Multiple methods have been proposed for reconstructing ancestral states from data collected from extant species (<xref ref-type="bibr" rid="bib24">Felsenstein, 1985</xref>; <xref ref-type="bibr" rid="bib25">Felsenstein, 2005</xref>; <xref ref-type="bibr" rid="bib64">Yang, 2006</xref>; <xref ref-type="bibr" rid="bib43">O’Meara, 2012</xref>; <xref ref-type="bibr" rid="bib46">Royer-Carenzi and Didier, 2016</xref>). These methods generally fall into two camps: parsimony reconstruction, which attempts to reconstruct evolutionary history with the fewest number of evolutionary changes (<xref ref-type="bibr" rid="bib19">Cunningham et al., 1998</xref>), and diffusion-processes, which model evolution as a random walk on a multi-dimensional landscape (<xref ref-type="bibr" rid="bib30">Hadfield and Nakagawa, 2010</xref>). Given the high-dimensional behavioral vectors that we are attempting to model, a diffusion process is more likely to capture the inter-trait correlations that we would like to understand. Thus, we focus on a diffusion-based model here.</p><p>Given a phylogeny for a collection of species, we modeled how species-specific complexes of behaviors might have emerged. We assumed that each animal’s behavior is a quantitative trait with an additive random effect, that is, each animal’s behavior is a trait that results from the additive effects of many genetic loci, each of small effect, that is combined with a non-genetic effect that represents inter-specific variation. We do not, however, assume that all behaviors evolve independently of each other. Thus, we are interested in predicting (1) whether intra- and inter-species variation can be separated to identify independently evolving sets or linear combinations of behaviors and (2) how behaviors co-vary along the phylogeny, potentially revealing co-evolving suites of behaviors.</p><p>We assumed that the observed flies’ behaviors evolved via a diffusion process with Gaussian noise from a common ancestor along the known phylogenetic tree. Note that this is a less restrictive assumption than neutrality, as multiple traits under selection may evolve in a correlated manner. Specifically, we fit a multi-response Generalized Linear Mixed Model (GLMM) to the data, using the approach described in <xref ref-type="bibr" rid="bib29">Hadfield, 2010</xref>, modeling the evolutionary process such that the logarithm of the <italic>behavioral vector, </italic><inline-formula><mml:math id="inf3"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>, for each individual (<inline-formula><mml:math id="inf4"><mml:mrow><mml:mover accent="true"><mml:mi>l</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>134</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>), is given by<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>l</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi>e</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf5"><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> is the mean behavior of the common ancestor (treated as the fixed effects of this model), and <inline-formula><mml:math id="inf6"><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf7"><mml:mover accent="true"><mml:mi>e</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> are the random effects corresponding to the phylogenetic and individual variability, respectively. We assume that these random effects are generated from the multi-dimensional normal distributions <inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒩</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mn>0</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>⊗</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (phylogenetic) and <inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒩</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mn>0</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mi>I</mml:mi><mml:mo>⊗</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (individual). Here, the matrix <inline-formula><mml:math id="inf10"><mml:mi>A</mml:mi></mml:math></inline-formula> represents the information contained in the phylogenetic tree, with <inline-formula><mml:math id="inf11"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> being proportional to the length of the path from the most recent common ancestor of species <inline-formula><mml:math id="inf12"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf13"><mml:mi>j</mml:mi></mml:math></inline-formula> to the common ancestor. <inline-formula><mml:math id="inf14"><mml:mi>A</mml:mi></mml:math></inline-formula> is normalized so that the diagonal elements are all equal to 1. Therefore, <inline-formula><mml:math id="inf15"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represents the phylogenetic similarity between a pair of species. <inline-formula><mml:math id="inf16"><mml:mi>I</mml:mi></mml:math></inline-formula> is the identity matrix, and <inline-formula><mml:math id="inf17"><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf18"><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> are the phylogenetic and within-species covariance matrices, respectively.</p><p>We fit μ, <inline-formula><mml:math id="inf19"><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>, and <inline-formula><mml:math id="inf20"><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> using Markov Chain Monte Carlo (MCMC) simulations, confirming that the MCMC converged using the Gelman-Rubin diagnostic (see Materials and methods, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). In addition, our model is able to infer the mean endpoint behavioral repertoires (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>), providing confidence that our model is consistent with our input data. In addition to the inferred behavioral states corresponding to the common ancestor, <inline-formula><mml:math id="inf21"><mml:msup><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, we also reconstructed the mean behavioral representations for the intermediate ancestors (<xref ref-type="fig" rid="fig3">Figure 3</xref>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Reconstructed behavioral repertoires using the GLMM.</title><p>Inferred probabilities of the behavioral traits for the ancestral states are plotted at the denoted locations along the phylogeny. Except for the common ancestor, ancestral states are plotted with respect to the closest ancestor. For each behavioral trait, <inline-formula><mml:math id="inf22"><mml:mi>i</mml:mi></mml:math></inline-formula>, in the intermediate ancestors, we show: <inline-formula><mml:math id="inf23"><mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf24"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf25"><mml:msubsup><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> correspond to the inferred mean behavioral trait for the given ancestor and its closest ancestor, respectively. Coarse grained behaviors corresponding to different types of movements are shown on the top right corner.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61806-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Gelman Rubin diagnostic for model parameters inferred using MCMC.</title><p>(<bold>A</bold>) Potential Scale Reduction Factor (PSRF, see Materials and methods) for the 134 ancestral behaviors inferred in the GLMM. 20 MCMC chains with different initial conditions were used. (<bold>B</bold>) PSRF for the phylogenetic covariance matrix elements corresponding to the 10% most common behaviors performed by the measured flies. (<bold>C</bold>) PSRF for the individual covariance matrix elements corresponding to the 10% most common behaviors performed by the measured flies. The PSRF values for all of these inferred parameters indicate that the MCMC chains have converged.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61806-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Comparison between measured and inferred behaviors (on a log scale) for each of the extant species.</title><p>Here, each measured behavioral mean plotted against the mean obtained from the components of the MCMC samples corresponding to that particular species and behavioral mode (i.e., the inferred behavioral repertories from the GLMM). The biggest differences occur mostly in the low probability behaviors, which we expect to be more sensitive to sampling errors.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61806-fig3-figsupp2-v2.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 3.</label><caption><title>Comparison of the independent focused trait approach vs the repertoire approach for a pair of behaviors.</title><p>(<bold>A</bold>) Schematic of the different predictions that each model provides for the probability contour lines for a pair of behaviors – uncorrelated single-trait model in orange vs. correlated full-repertoire approach in blue. By definition, the single-trait model cannot predict behavioral covariance either inter- or intra-species. (<bold>B</bold>) Behavioral traits averaged within-species (colored dots) for two specific behaviors show a positive correlation, which is explained by the full-repertoire model (in blue). Ellipses are centered at the coordinates representing the behavioral traits of the inferred ancestral state, with semi-major and semi-minor axes corresponding to the eigenvectors and values of the phylogenetic covariance matrix, restricted to the behaviors shown on the left. For comparison, the contour line inferred using the single-trait model is shown in orange (level curves at two standard deviations from the mean). (<bold>C</bold>) Behavioral traits for all individuals within a species show a negative correlation, for this particular pair of behaviors, in contrast to the positive correlation observed in the species means and predicted by the full model. Blue ellipses correspond to the contour probability levels coming from the individual covariance matrix of the full-repertoire model. Note that the predictions from the single-trait model must necessarily be uncorrelated.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61806-fig3-figsupp3-v2.tif"/></fig></fig-group><p>We also found that the model that allows behavioral co-evolution out-performs a model where each behavioral trait evolves independently. Specifically, we fit a model where behavioral correlations between individuals of different species were removed by enforcing that <inline-formula><mml:math id="inf26"><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf27"><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> must be diagonal matrices, a reduction of more than 17,500 parameters compared to the full model (see Materials and methods for details). The phylogenetic ancestral reconstruction was then made for each behavioral trait separately. To compare the relative performance of these models, we used the Deviance Information Criterion (DIC) (<xref ref-type="bibr" rid="bib52">Spiegelhalter et al., 2002</xref>), a commonly used assessment tool for MCMC-fit hierarchical models that lack a good estimate for the number of effective parameters. Like other information-theoretic model selection criteria (e.g., the Akaike Information Criterion or the Bayesian Information Criterion), smaller values of the DIC imply a larger posterior probability of the model given the available data. Despite the large reduction in the number of parameters for the independent-trait model, the DIC for the independent-trait model was substantially higher (<inline-formula><mml:math id="inf28"><mml:mrow><mml:mtext>DIC</mml:mtext><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>242</mml:mn><mml:mo>±</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>) than the DIC for the full model (<inline-formula><mml:math id="inf29"><mml:mrow><mml:mtext>DIC</mml:mtext><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>114</mml:mn><mml:mo>±</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>). Moreover, the full model was able to predict the inter- and intra-species covariances between dissimilar pairs of behaviors (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>). Hence, modeling the evolution of the full behavioral repertoire captures the structure of the observed data better than a single trait approach.</p></sec><sec id="s1-3"><title>Individual variability and long timescale correlations</title><p>While it is not possible to directly test the accuracy of our ancestral state reconstructions (<xref ref-type="fig" rid="fig3">Figure 3</xref>), the inferred covariance matrices generate predictions about behavioral and genetic correlations that are, in principle, testable. We therefore focus on the fitted covariance matrices, <inline-formula><mml:math id="inf30"><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf31"><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> (each in <inline-formula><mml:math id="inf32"><mml:mrow><mml:mpadded width="-1.7pt"><mml:mi mathvariant="normal">I</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathvariant="normal">R</mml:mi><mml:mrow><mml:mn>134</mml:mn><mml:mo>×</mml:mo><mml:mn>134</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>), which account for within-species and phylogenetic random effects, respectively.</p><p>We will focus first on the intra-species covariance matrix, <inline-formula><mml:math id="inf33"><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>. We note first that the matrix exhibits a modular structure (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). After rearranging the behavior order via an information-based clustering procedure (<xref ref-type="bibr" rid="bib51">Slonim et al., 2005</xref>), we see that a block diagonal pattern emerges, with positive correlations lying within the blocks and negative correlations lying off the diagonal. The details of this particular clustering approach are described in Materials and methods, but we find that the results are nearly identical for several different clustering methodologies (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). Quantifying the matrix’s modularity via the average within-cluster dissimilarity,<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msqrt></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>The structure of variability between flies of the same species relates to long timescale transitions in behavior.</title><p>(<bold>A</bold>) The intra-species behavioral covariance matrix (<inline-formula><mml:math id="inf34"><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>), with columns and rows ordered via an information-based clustering algorithm (<xref ref-type="bibr" rid="bib51">Slonim et al., 2005</xref>). The black squares represent behaviors that are grouped together in the three-cluster solution. (<bold>B</bold>) Behavioral map representation of the clustering solutions. The two-, three-, and six-cluster solutions are shown on top (colors on the three cluster solution match those above the plot in A). The clusters are all spatially contiguous and break down hierarchically (see <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> for more examples). (<bold>C</bold>) Clustering structure of the behavioral space obtained finding the optimally predictive groups of behaviors (see text for details). Note how these clusterings are very similar to the clusterings in B, despite having been derived from an entirely independent measure.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61806-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Behaviors clustered according to the individual covariance matrix using three different clustering methods.</title><p>(<bold>A</bold>) Results using k-medoids clustering method with distance matrix <inline-formula><mml:math id="inf35"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> for 2,3,.7 clusters. To the right, the WSI between the clusters obtained using k-medoids and those obtained using the Deterministic Information Bottleneck (DIB) method on behavioral transitions (see Materials and methods). There is a high degree of similarity between these independently derived measurements, as can be shown when compared to the WSI calculated by randomly shuffling the labels of the k-medoids clustering corresponding to each number of clusters. (<bold>B</bold>) Same as in A but using Spectral clustering instead of k-medoids. The similarity index between Spectral clustering and predictive information bottleneck is also statistically significant. (<bold>C</bold>) Same as in A but using an Information-based clustering approach (see Materials and methods) instead of k-medoids. The similarity index between Information-based clustering and the results from the DIB analysis is statistically significant as well.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61806-fig4-figsupp1-v2.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>Modularity of the intra-species behavioral covariance matrix using information based clustering.</title><p><inline-formula><mml:math id="inf36"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>d</mml:mi><mml:mo>&gt;</mml:mo></mml:mrow></mml:math></inline-formula> corresponds to the average distance among elements of the same clusters, (see Materials and methods). We show that for different numbers of clusters, the within-cluster distance is significantly smaller (in blue) than expected by random assignation of behaviors to clusters (in orange).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61806-fig4-figsupp2-v2.tif"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 3.</label><caption><title>Coarse-grained behavioral representations that are optimally predictive of the future behavior states via DIB.</title><p>(<bold>A</bold>) Behavioral representation with 2,3,…,7 clusters using <inline-formula><mml:math id="inf37"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ10">Equation 10</xref>. (<bold>B</bold>) Optimal trade-off curve (Pareto Front) between complexity of coarse grained description against predictive power. For each number of clusters, representations in A correspond to points (red points) on this curve with the highest predictive information.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61806-fig4-figsupp3-v2.tif"/></fig></fig-group><p>where <inline-formula><mml:math id="inf38"><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula> is the set of all behaviors belonging to the <inline-formula><mml:math id="inf39"><mml:mi>k</mml:mi></mml:math></inline-formula> th cluster, we find that <inline-formula><mml:math id="inf40"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mn>0.30</mml:mn></mml:mrow></mml:math></inline-formula> and 0.22 for the 3- and 6-cluster solutions, respectively. These values are significantly smaller than the average distances obtained using random cluster assignments (<inline-formula><mml:math id="inf41"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.46</mml:mn><mml:mo>±</mml:mo><mml:mn>0.03</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf42"><mml:mrow><mml:mn>0.45</mml:mn><mml:mo>±</mml:mo><mml:mn>0.04</mml:mn></mml:mrow></mml:math></inline-formula> for 3 and 6 clusters respectively, see <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref> for other numbers of clusters and clustering methods). Thus, we can conclude that the intra-specific covariance matrix has a far-from-random modular structure, implying that between individuals of the same species, groups of behaviors tend to vary together in a stereotyped manner.</p><p>Moreover, these groups of behaviors that co-vary together within a species are not random collections of behaviors. Instead, we found that co-varying clusters are spatially contiguous in the behavioral map, implying that covariances of groups of similar behaviors (behaviors involving moving similar parts of the animals’ bodies at similar speeds) compose much of the observed intra-species variance. The clustering method does not take the spatial structure of the behavioral map into account at all (just the values in <inline-formula><mml:math id="inf43"><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>), so the clusters of local behaviors in the behavior map reflect underlying similarity in the covariance of nearby behaviors, rather than an artifact of the algorithm. Moreover, co-varying clusters are hierarchically organized, where coarse-grained co-varying behaviors can be sub-divided into smaller co-varying clusters (<xref ref-type="fig" rid="fig4">Figure 4B</xref>), a feature that is not guaranteed by the information-based clustering algorithm.</p><p>This hierarchical structure of the behavioral map is reminiscent of the hierarchical temporal structure of behavior that was hypothesized originally by ethologists (<xref ref-type="bibr" rid="bib57">Tinbergen, 1951</xref>; <xref ref-type="bibr" rid="bib20">Deutsch et al., 2020</xref>) and was observed to optimally explain the history-dependent long timescale non-stationary structure of <italic>Drosophila melanogaster</italic> behavioral transitions (<xref ref-type="bibr" rid="bib8">Berman et al., 2016</xref>). Thus, we hypothesized that the structure of the intra-species covariance matrix might be linked to deviations from statistical stationarity in the behavioral data that were not explicitly measured in the unsupervised clustering or modeled in the GLMM.</p><p>To explore this connection further, we performed an analysis that is analogous to the single-species study in <xref ref-type="bibr" rid="bib8">Berman et al., 2016</xref>, finding coarse-grainings of the behavioral space (i.e., a description of the behavioral space using fewer behaviors) that are optimally predictive of the future behaviors that the flies perform. Specifically, if <inline-formula><mml:math id="inf44"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the behavior that a fly performs at time <inline-formula><mml:math id="inf45"><mml:mi>t</mml:mi></mml:math></inline-formula>, we would like to create a clustered version of our behavioral map, <inline-formula><mml:math id="inf46"><mml:mi>Z</mml:mi></mml:math></inline-formula>, such that we maximize the information that <inline-formula><mml:math id="inf47"><mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∈</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula>, the cluster that the fly is in at time <inline-formula><mml:math id="inf48"><mml:mi>t</mml:mi></mml:math></inline-formula> contains as much information about the future behavior of the fly, <inline-formula><mml:math id="inf49"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as possible. To keep <inline-formula><mml:math id="inf50"><mml:mi>Z</mml:mi></mml:math></inline-formula> from separating each behavior into its own cluster, we also need to make sure that <inline-formula><mml:math id="inf51"><mml:mi>Z</mml:mi></mml:math></inline-formula> is as simple a clustering as possible (i.e., a smaller number of clusters and a more even distribution of time spent within each clusters).</p><p>To be more precise, we calculated <inline-formula><mml:math id="inf52"><mml:mi>Z</mml:mi></mml:math></inline-formula> using the the Deterministic Information Bottleneck (DIB) method (<xref ref-type="bibr" rid="bib55">Strouse and Schwab, 2017</xref>). This approach minimizes the functional<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mrow><mml:msub><mml:mi class="ltx_font_mathcaligraphic">𝒥</mml:mi><mml:mi>τ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>Z</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>;</mml:mo><mml:mrow><mml:mi>Z</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:mi class="ltx_font_mathcaligraphic">ℋ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf53"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a fly’s behavior at time <inline-formula><mml:math id="inf54"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf55"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the coarse-grained behavior visited at time <inline-formula><mml:math id="inf56"><mml:mi>t</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf57"><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>;</mml:mo><mml:mrow><mml:mi>Z</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the mutual information between these quantities, <inline-formula><mml:math id="inf58"><mml:mi>γ</mml:mi></mml:math></inline-formula> is a positive constant, and <inline-formula><mml:math id="inf59"><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">ℋ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the entropy of the coarse-grained representation (see Materials and methods). As <inline-formula><mml:math id="inf60"><mml:mi>γ</mml:mi></mml:math></inline-formula> is increased, progressively simpler, but less predictive, representations are found.</p><p>Applying this method to the data, pooled across all six species and using <inline-formula><mml:math id="inf61"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4C</xref>, <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>), we found the same hierarchical division of the behavioral map that was observed for freely moving <italic>D. melanogaster</italic> (<xref ref-type="bibr" rid="bib8">Berman et al., 2016</xref>). Moreover, we found that the structure of the space using this approach closely mirrors the structure found via directly clustering the intra-species covariance matrix, <inline-formula><mml:math id="inf62"><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). Quantifying the similarity between both clustering partitions by calculating the Weighted Similarity Index (WSI), a modification of the Rand Index (<xref ref-type="bibr" rid="bib45">Rand, 1971</xref>) (Materials and methods), the WSI between the information-based clustering method and the predictive information bottleneck for three clusters is <inline-formula><mml:math id="inf63"><mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.73</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf64"><mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.87</mml:mn></mml:mrow></mml:math></inline-formula> for six clusters. For random clusterings, we would expect to observe <inline-formula><mml:math id="inf65"><mml:mrow><mml:mn>0.51</mml:mn><mml:mo>±</mml:mo><mml:mn>0.02</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf66"><mml:mrow><mml:mn>0.70</mml:mn><mml:mo>±</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> for 3 and 6 clusters, respectively, indicating a non-random overlap between these two partitions. <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>, shows that this result is independent of the clustering method and the number of clusters.</p><p>The overlap between these two coarse-grainings indicates that most individual variability in the behaviors we observe results from non-stationarity in behavioral measurements, rather than from individual-specific variation. That is, much of the intraspecific variation appears to reflect flies recorded when they were experiencing different hidden behavioral states (e.g., circadian state, hunger, etc.), rather than reflecting fixed (environmental or genetic) differences between flies. This variation may have arisen because, although we controlled many variables (e.g., fly age, circadian cycle, temperature, and humidity), it is not possible to control for all internal factors (e.g., hunger, arousal, etc.) that affect an animal’s behavioral patterns (<xref ref-type="bibr" rid="bib2">Anderson, 2016</xref>). The temporal coarse-graining of the behavioral space that we found via the DIB provides insight into these non-stationarities, as they are optimally predictive of the fly’s future behaviors. Given the contiguous nature of these regions, this result means that flies tended to stay within specific regions of the behavioral space much longer than one would assume from a Markov model, hinting that there is an important connection between variability across animals and variability between animals.</p><p>More precisely, these results imply that variation in behavior observed among individuals, especially in non-manipulated settings, may often reflect a large component of hidden behavioral states (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). Thus, it may be possible to improve upon behavioral measurements in many settings by controlling for the variability associated with these hidden states. For example, just because one fly performs less anterior grooming than another may reflect that the animal is in a different long timescale behavioral state, rather than that the animal has a genetically encoded preference for reduced grooming.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Variability within a species, long timescale transitions, and hidden states modulating behavior.</title><p>(<bold>A</bold>) A cartoon of the hypothesized relation between individual variability within a species and long timescale transitions through hidden states. (<bold>B</bold>) Accounting for the long timescale dynamics - by adjusting for the amount of time spent in each coarse-grained region (here, the six cluster solution at the top right of <xref ref-type="fig" rid="fig4">Figure 4C</xref>) - affects the measured behavioral distributions between <italic>D. santomea</italic> and <italic>D. yakuba</italic>. Shown is the comparison of the Mahalanobis distance (<inline-formula><mml:math id="inf67"><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) between behavioral distributions before (x-axis) and after (y-axis) adjusting. (<bold>C</bold>) Kernel density estimates of the distributions for the circled behaviors in (B) on the left before (left) and after (right) adjustments. Solid lines represent <italic>D. santomea</italic> and dashed lines represent <italic>D. yakuba</italic>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61806-fig5-v2.tif"/></fig><p>A potential method for accounting for these artifacts is to normalize each individual’s behavioral density such that the amount of time that the animal spends in each of the coarse-grained regions is equalized. In other words, the amount of time spent anterior grooming, locomoting, etc. are set to be the same for all animals, thus accounting for the variability associated with the inferred hidden states. Mathematically, if <inline-formula><mml:math id="inf68"><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the probability of observing behavior <inline-formula><mml:math id="inf69"><mml:mi>i</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf70"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the clustering assignment of this behavior, we can define a normalized probability, <inline-formula><mml:math id="inf71"><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, via<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:msup><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:msubsup><mml:mi>P</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>⁢</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf72"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the total density in cluster <inline-formula><mml:math id="inf73"><mml:mi>C</mml:mi></mml:math></inline-formula> for an individual fly and <inline-formula><mml:math id="inf74"><mml:msup><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> is the average across all animals.</p><p>We found that applying this normalization to our data often results in substantial changes in the inferred distributions of behavioral densities. For example, <xref ref-type="fig" rid="fig5">Figure 5B</xref> displays how the difference in behavioral density between <italic>D. santomea</italic> and <italic>D. yakuba</italic> (as measured by the Mahalanobis distance between the distributions) alters as a result of normalization. For some behaviors, the signal increases (red points), and in some cases, it decreases (blue points). Thus, it is important to take these non-stationary effects into account when estimating how often single behaviors are performed in studies of behavioral evolution. To measure these non-stationary effects, many behaviors must be measured, not just a focal behavior, thus partially explaining the relative success of our multi-trait model compared to a model where each trait is analyzed independently.</p></sec><sec id="s1-4"><title>Identifying phylogenetically linked behaviors</title><p>One of the advantages of our approach is that we separate variations in behavior corresponding to evolutionary patterns, the phylogenetic variability, from variations among individuals of the same species. By studying the properties of the phylogenetic covariance matrix (<inline-formula><mml:math id="inf75"><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>), we can identify multiple behaviors that may have evolved together.</p><p>We first characterized the coarse-grained structure within <inline-formula><mml:math id="inf76"><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> through the information-based clustering used in the previous section (<xref ref-type="bibr" rid="bib51">Slonim et al., 2005</xref>) (see Materials and methods). As seen in <xref ref-type="fig" rid="fig6">Figure 6A</xref>, the phylogenetically co-varying clusters are not spatially contiguous in the behavioral map. This finding is in contrast to the spatial contiguity we observed for the intra-species covariance matrix (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). For example, the two-cluster solution (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, left) groups the behavioral space into side legs movements (middle of the behavioral map) and certain locomotion gaits (far left of the behavioral map) versus the rest of behaviors. Similarly, when the matrix is clustered into a larger number of clusters, correlated groups are not contiguously arranged within the behavior map. Thus, our model predicts that many non-similar behaviors are evolving in a correlated manner.</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Phylogenetic variability and behavioral meta-traits.</title><p>(<bold>A</bold>) (top) Clustering the phylogenetic covariance matrix (using the same information-based clustering method from <xref ref-type="fig" rid="fig4">Figure 4</xref>), we observe that the clusters are no longer spatially contiguous. (bottom) The phylogenetic covariance matrix reordered according to four clusters (colors corresponding to the four-cluster map above). (<bold>B</bold>) Fraction of variance explained by the largest eigenvalues of the phylogenetic covariance matrix. (<bold>C</bold>) The eigenvectors corresponding to the largest six eigenvalues. (<bold>D</bold>) Distributions of the projections of individual density vectors from <italic>D. santomea</italic> and <italic>D. yakuba</italic> onto eigenvector 3. (<bold>E</bold>) Same as in D but using projections of individuals from <italic>D. sechellia</italic> and <italic>D. simulans</italic> onto eigenvector 4. (<bold>F</bold>) Same as in D but using projections of individuals from <italic>D. simulans</italic> and <italic>D. mauritiana</italic> onto eigenvector 5.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61806-fig6-v2.tif"/></fig><p>To quantify these patterns as traits, we decomposed <inline-formula><mml:math id="inf77"><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> via an eigendecomposition. As seen in <xref ref-type="fig" rid="fig6">Figure 6B</xref>, almost all of the variance within the matrix can be explained with only the first six eigenmodes. These eigenvectors (<xref ref-type="fig" rid="fig6">Figure 6C</xref>) share similar non-local structure to the clusterings described above. By projecting individual behavioral vectors onto these eigenvectors, the resulting dot products represent a meta-trait that is a linear combination of phylogenetically linked behaviors.</p><p>These evolving meta-traits may be suitable targets for further neurobiological or genetic studies. Three examples of these distributions are shown in <xref ref-type="fig" rid="fig6">Figure 6D–F</xref> for several pairs of closely related species. These three examples were not chosen at random, but instead because they showed significant differentiation between species. The aim of this analysis is not to show that all meta-traits would differ between all pairs of species, which is unlikely, but rather that it is possible to identify synthetic meta-traits that could be further interrogated with experimental methods.</p></sec></sec><sec id="s2" sec-type="discussion"><title>Discussion</title><p>We have developed a quantitative framework to study the evolution of behavioral repertoires, using fruit flies (<italic>Drosophila</italic>) as a model system. We started with observations of 561 individuals from six extant species behaving in an unremarkable environment. This assay did not include social behaviors, such as courtship and aggression, nor many foraging behaviors. Thus, at first glance, it might seem like we had excluded most species-specific behaviors from the analysis. Nonetheless, we found that other complex behaviors, like walking, running, and grooming, exhibit species-specific features that can be used to reliably assign individuals to the correct species. Thus, the motor patterns of behaviors that are not normally investigated for their species-specific features are likely evolving between even closely related species. It is not clear, however, if these differences reflect natural selection or genetic drift. All of these behaviors are critical to individual survival, however, so it is possible that these behaviors have evolved, at least in part, in response to natural selection. It is clear, however, that the underlying mechanisms, and perhaps the neural circuitry, controlling these behaviors must have evolved.</p><p>Inspired by these observations, we estimated patterns of behavioral evolution in the context of a well-understood phylogeny. We fit a Generalized Mixed Linear Model to our behavioral measurements and the given phylogeny to reconstruct ancestral behavioral repertoires and the intra- and inter-species covariance matrices. We found that the patterns of intra-species variability are similar to long timescale behavioral dynamics that violate statistical stationarity - a result we reported previously in a study of a single species (<xref ref-type="bibr" rid="bib8">Berman et al., 2016</xref>). This result suggests that much of the intra-specific variability that emerged by sampling flies under well-controlled conditions reflects variability in the hidden behavioral states of individual flies. While it may be challenging to conceptualize that seemingly simple behaviors, like the pace of walking and running, are reflective of an underlying long time scale behavior state, many short time scale behaviors, such as the individual movements involved in grooming (<xref ref-type="bibr" rid="bib47">Seeds et al., 2014</xref>), courtship (<xref ref-type="bibr" rid="bib13">Calhoun et al., 2019</xref>; <xref ref-type="bibr" rid="bib20">Deutsch et al., 2020</xref>) and aggression (<xref ref-type="bibr" rid="bib32">Hoopfer, 2016</xref>; <xref ref-type="bibr" rid="bib22">Duistermars et al., 2018</xref>) reflect behaviors performed only, or mainly, in the context of a longer lasting behavioral state. These types of long timescale variability may be a statistical confound for evolutionary and experimental studies of behavior. We therefore propose a method to control for these internal states by normalizing the frequency of behaviors relative to an estimate of an animal’s non-stationary states. This method improved the accuracy of behavioral phenotyping and dramatically altered estimates of some species-specific behaviors. For more focused studies, it may not be necessary to measure the full suite of behaviors to effectively normalize for behavioral state, since state can sometimes be estimated from a smaller number of behaviors. In fact, targeted studies of charismatic behaviors, including behaviors associated with aggression or courtship, often implicitly normalize by behavioral state.</p><p>Given our estimates for how suites of behaviors evolved, we examined whether the inter-species covariance matrix could be used to identify behavioral meta-traits that might be subjected to further evolutionary and experimental analysis. We identified multiple suites of behaviors that differed between closely related species, providing a starting point for further analysis of how the mechanisms underlying these suites of behaviors have evolved.</p><p>There are multiple possible interpretations of these phylogenetically correlated behaviors. For instance, at the neural level, each of these groups of movements may reflect a motor response to shared upstream commands (<xref ref-type="bibr" rid="bib16">Cande et al., 2018</xref>). Here, for example, different types of locomotion might be controlled through the same descending neural circuitry, but due to evolutionary changes, the same commands could lead to different behavioral outputs, as has been observed in fly courtship patterns (<xref ref-type="bibr" rid="bib21">Ding et al., 2019</xref>). Alternatively, at the genetic level, multiple behaviors may be linked by pleiotropic effects of individual genetic changes. Finally, groups of co-evolving traits may not be linked mechanistically, but co-evolution may instead reflect selection on suites of behaviors. For example, the male neurons that drive fly courtship song production in the ventral nerve cord are unlikely to be related to the female neurons in the central brain that perceive and interpret the courtship song. Nonetheless, these traits co-evolve such that females tend to prefer songs produced by males of their own species (<xref ref-type="bibr" rid="bib6">Bennet-Clark and Ewing, 1969</xref>; <xref ref-type="bibr" rid="bib21">Ding et al., 2019</xref>).</p><p>The analysis framework introduced here represents the first attempt to analyze full behavioral repertoires to gain insight into evolution. In principle, this approach could be applied to any data set where a large number of behaviors have been sampled in many species. However, there are several areas where one could add future improvements to this approach. First, we recorded behavior from only six species of flies. Adding additional species would place more constraints on the evolutionary dynamics, likely resulting in less variance in the ancestral state estimations and potentially adding more structure to the relatively low rank (i.e., highly modular) covariance matrices. Additionally, further work is required to determine the balance between sampling within and between strains and species that optimizes estimates of evolutionary dynamics.</p><p>Second, our framework assumes that all evolutionary changes in behavior resemble a diffusion process. Although this assumption is a reasonable initial hypothesis (<xref ref-type="bibr" rid="bib24">Felsenstein, 1985</xref>), it may be possible to test this assumption. For example, deeper sampling of additional species may allow identification of specific behaviors on particular lineages where neutrality can be rejected (<xref ref-type="bibr" rid="bib56">Tajima, 1993</xref>). If evidence emerges that the analyzed behaviors do not evolve under a diffusion process but under stabilizing selection, for example, the model for ancestral reconstruction can be changed from a Brownian motion to an Ornstein-Uhlenbeck process (<xref ref-type="bibr" rid="bib38">Martins and Hansen, 1997</xref>; <xref ref-type="bibr" rid="bib31">Hansen and Martins, 1996</xref>; <xref ref-type="bibr" rid="bib46">Royer-Carenzi and Didier, 2016</xref>). Such a change can be implemented by altering the structure of the phylogenetic matrix, <inline-formula><mml:math id="inf78"><mml:mi>A</mml:mi></mml:math></inline-formula>(<xref ref-type="bibr" rid="bib38">Martins and Hansen, 1997</xref>; <xref ref-type="bibr" rid="bib12">Caetano and Beaulieu, 2020</xref>), but without other alterations to the overall methodology presented here.</p><p>Another potential limitation of our analysis is that some of the observed inter-specific differences may reflect species-specific responses to environmental factors like room temperature or humidity, rather than underlying genetic or developmental factors. Two observations mitigate against this possibility, however. First, there were no significant differences in overall activity level of the different species, which would be a key indicator of environment-induced covariance. Second, the intra-species covariance matrix (derived from data from all species) agrees well with previous findings within a single species (<xref ref-type="bibr" rid="bib8">Berman et al., 2016</xref>), implying that many of the potential environmental co-varying factors are shared across all six species.</p><p>In addition, all of our current analyses ignored the temporal structure of behavior and sequences of movements. While we found that the intra-specific variance has a similar structure to temporal structure that we reported previously (<xref ref-type="bibr" rid="bib8">Berman et al., 2016</xref>), the order in which behaviors occur may also provide important biological information, especially during events like courtship or aggression. It should be possible to incorporate temporal structure directly into the regression (<xref ref-type="bibr" rid="bib12">Caetano and Beaulieu, 2020</xref>). Deciding exactly which quantities to measure and how they should be incorporated, however, are complex questions that are outside the scope of this initial study. In addition, the number of fit parameters, already over 18,000 here, would need to grow even larger to accommodate modeling transition rates between the behaviors as traits themselves. Thus, fitting such models would necessitate even larger data sets than the one collected here. Moreover, because the Perron-Frobenius Theorem mathematically couples the transition probabilities between behaviors and the probabilities of the fly performing a given behavior, additional care (and data) is required to ensure that observed differences in behavior are due to changes in temporal structure rather than changes in the frequencies of performing a given behavior.</p><p>Lastly, capturing the full range of animal behaviors for a large number of animals presents a number of technological challenges, which is why we focused on measuring behavior in a highly simplified environment. However, a more complete understanding of the structure of behavior will require more sophisticated ways to capture behavioral dynamics in more naturalistic settings and during complex social arrangements. While modern deep learning methods have made tracking animals in more realistic settings increasingly plausible (<xref ref-type="bibr" rid="bib44">Pereira et al., 2019</xref>; <xref ref-type="bibr" rid="bib40">Mathis and Mathis, 2020</xref>), there are still considerable hurdles to translating this information into a form that can be subjected to the kind of analysis we propose here.</p><p>Despite these limitations, this work represents a new way to quantitatively characterize the evolution of complex behaviors, which may provide new phenotypes that can be subjected to experimental analysis. In the absence of a behavioral fossil record, reconstructing ancestral behaviors requires an inferential approach like the one we present here. In addition, more complex models could be built to test assumptions of the diffusion-based model we employed. Finally, a strength of our approach is that it makes falsifiable predictions about how behaviors are linked mechanistically, providing predictions that can be tested experimentally to provide further insight into the genetic and neurobiological structure of behavior.</p></sec><sec id="s3" sec-type="materials|methods"><title>Materials and methods</title><sec id="s3-1"><title>Data collection</title><p>All fly handling and imaging of fly behavior followed the procedures described in <xref ref-type="bibr" rid="bib16">Cande et al., 2018</xref>, excepting that we did not provide retinol-free food to any of the animals, nor we did provide any red light cycling during the experiments. Individual male flies were collected upon eclosion and housed singly in 2 mL wells in a 96-well ’condo,’ with food deposited in the bottom of each well, which was sealed at the top with an airpore sheet. In total, we collected data from 561 individual from 18 strains and six species. Flies were imaged at age 7–12 days, within 4 hr of lights on. Individuals were sampled from multiple strains and species: three strains of <italic>D. mauritiana</italic> (<italic>mau29</italic>: 29 flies, <italic>mau317</italic>: 35 flies, <italic>mau318</italic>: 32 flies), four strains of <italic>D. melanogaster</italic> (<italic>Canton-S</italic>: 31 flies, <italic>Oregon-R</italic>: 33 flies, <italic>mel54</italic>: 34 flies, <italic>mel56</italic>: 31 flies), three strains of <italic>D. santomea</italic> (<italic>san00</italic>: 29 flies, <italic>san1482</italic>: 33 flies, <italic>STO OBAT</italic>: 22 flies), three strains of <italic>D. sechellia</italic> (<italic>sech28</italic>: 32 flies, <italic>sech340</italic>: 25 flies, <italic>sech349</italic>: 33 flies), three strains of <italic>D. simulans</italic> (<italic>sim5</italic>: 33 flies, <italic>sim199</italic>: 30 flies, <italic>Oxnard</italic>: 34 flies), and two strains of <italic>D. yakuba</italic> (<italic>yak01</italic>: 34 flies, <italic>CYO2</italic>: 31 flies).</p></sec><sec id="s3-2"><title>Generalized linear mixed model</title><p>We fit our GLMM (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>) using the software introduced in <xref ref-type="bibr" rid="bib29">Hadfield, 2010</xref>. The covariance matrices <inline-formula><mml:math id="inf79"><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf80"><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:mrow><mml:mpadded width="-1.7pt"><mml:mi mathvariant="normal">I</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathvariant="normal">R</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf81"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>134</mml:mn></mml:mrow></mml:math></inline-formula> and the mean vector <inline-formula><mml:math id="inf82"><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>∈</mml:mo><mml:mrow><mml:mpadded width="-1.7pt"><mml:mi mathvariant="normal">I</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathvariant="normal">R</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> were inferred from the posterior distribution via MCMC sampling. Prior distributions for the covariance matrices were given by Inverse Wishart Distributions (conjugate priors for the multi-Gaussian model) with <inline-formula><mml:math id="inf83"><mml:mi>K</mml:mi></mml:math></inline-formula> degrees of freedom and <inline-formula><mml:math id="inf84"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:mi>J</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula> as scale matrix, with <inline-formula><mml:math id="inf85"><mml:mi>J</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf86"><mml:mi>I</mml:mi></mml:math></inline-formula> the unit and identity matrices respectively. Tree branch length were estimated from <xref ref-type="bibr" rid="bib48">Seetharam and Stuart, 2013</xref>.</p></sec><sec id="s3-3"><title>Gelman-Rubin convergence diagnostic</title><p>This test evaluates MCMC convergence by analyzing the difference between several Markov chains. Specifically, we compare the estimated between-chains and within-chain variances for each parameter of the model. Large differences between these variances indicate non-convergence (<xref ref-type="bibr" rid="bib26">Gelman and Rubin, 1992</xref>). Let <inline-formula><mml:math id="inf87"><mml:mi>θ</mml:mi></mml:math></inline-formula> be a model parameter of interest and <inline-formula><mml:math id="inf88"><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup></mml:math></inline-formula> be the <inline-formula><mml:math id="inf89"><mml:mi>m</mml:mi></mml:math></inline-formula> th simulated chain, <inline-formula><mml:math id="inf90"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. Denote, <inline-formula><mml:math id="inf91"><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf92"><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> be the sample posterior mean and variance of the <inline-formula><mml:math id="inf93"><mml:mi>m</mml:mi></mml:math></inline-formula> th chain. If <inline-formula><mml:math id="inf94"><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>M</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is the overall posterior mean estimator, the between-chains (<inline-formula><mml:math id="inf95"><mml:mi>B</mml:mi></mml:math></inline-formula>) and within-chain (<inline-formula><mml:math id="inf96"><mml:mi>W</mml:mi></mml:math></inline-formula>) variances are given by:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>M</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mover><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>In <xref ref-type="bibr" rid="bib26">Gelman and Rubin, 1992</xref>, it is shown that the following weighted average of <inline-formula><mml:math id="inf97"><mml:mi>W</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf98"><mml:mi>B</mml:mi></mml:math></inline-formula> is an unbiased estimator of the marginal posterior variance of <inline-formula><mml:math id="inf99"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>:</mml:mo><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:mfrac><mml:mi>B</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> The ratio <inline-formula><mml:math id="inf100"><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:math></inline-formula> should get close to one as the M chains converge to the target distribution with <inline-formula><mml:math id="inf101"><mml:mrow><mml:mi>N</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula>. In reference (<xref ref-type="bibr" rid="bib10">Brooks and Gelman, 1998</xref>) this ratio known as the Potential Scale Reduction Factor (PSRF) was corrected to account for the the sampling variability using <inline-formula><mml:math id="inf102"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mfrac><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>W</mml:mi></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf103"><mml:mi>d</mml:mi></mml:math></inline-formula> is the degrees of freedom estimate of a t-distribution. Values of PSRF for all model parameters such that <inline-formula><mml:math id="inf104"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>1.1</mml:mn></mml:mrow></mml:math></inline-formula> are used in <xref ref-type="bibr" rid="bib10">Brooks and Gelman, 1998</xref> as a criteria for convergence of the MCMC chains. Here, we used 20 independent chains, each with a different initialization.</p></sec><sec id="s3-4"><title>Deviance information criterion (DIC)</title><p>The DIC is used as a Bayesian model selection criteria in problems where there is hierarchical structure to the underlying models and where the correct effective number of parameters is difficult to ascertain (<xref ref-type="bibr" rid="bib52">Spiegelhalter et al., 2002</xref>). These aspects are often found in models like ours where the posterior distributions have been sampled using Markov Chain Monte Carlo. The DIC is defined as follows:<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mover><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="5.690551pt"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mover><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>p</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mover><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mover><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo accent="false">¯</mml:mo></mml:mover></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf105"><mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt">∣</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is called the deviance (<inline-formula><mml:math id="inf106"><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> denotes a function of the data alone and <inline-formula><mml:math id="inf107"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt">∣</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> corresponds to the likelihood of the model under evaluation). Hence, the posterior mean, <inline-formula><mml:math id="inf108"><mml:mover accent="true"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>, can be considered as a Bayesian measure of fit. <inline-formula><mml:math id="inf109"><mml:msub><mml:mi>P</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math></inline-formula> represents the effective number of parameters, where <inline-formula><mml:math id="inf110"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the deviance evaluated at the posterior mean of the parameters <inline-formula><mml:math id="inf111"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula>. Note that (i) both quantities needed to calculate DIC, <inline-formula><mml:math id="inf112"><mml:mover accent="true"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>, and <inline-formula><mml:math id="inf113"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, can be readily estimated from the samples generated by MCMC, and (ii) alternatively, we can also re-write <inline-formula><mml:math id="inf114"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mtext>DIC</mml:mtext></mml:mrow><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. This is similar in form to the better-known Akaike Information criterion (AIC) (<xref ref-type="bibr" rid="bib1">Akaike, 1973</xref>), for models with negligible prior information or for large data sets where the likelihood dominates over the prior.</p></sec><sec id="s3-5"><title>Comparing the focused trait and full repertoire models</title><p>To build a model where behavioral traits evolve independently from each other, we fit each a single trait GLMM for each behavior j:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>ρ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>e</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <italic>l</italic><sub><italic>j</italic></sub> denotes the logarithm of the behavioral trait <inline-formula><mml:math id="inf115"><mml:msub><mml:mi>P</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf116"><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> is the logarithm of the mean behavior of the common ancestor (treated as the fixed effect of this model), and <inline-formula><mml:math id="inf117"><mml:msub><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf118"><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> are the random effects corresponding to the phylogenetic and individual variability, respectively. Similar to the multi-response model, these random effects are normally distributed from <inline-formula><mml:math id="inf119"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒩</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mn>0</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>⊗</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf120"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒩</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mn>0</mml:mn><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>⊗</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> with <inline-formula><mml:math id="inf121"><mml:msub><mml:mi>σ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf122"><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> (single numbers) corresponding to the phylogenetic and individual inferred variances and A the phylogenetic matrix defined in the main text. Prior distributions for the variances are given by inverse-Wishart distributions with 1.002 degrees of freedom and scale parameter equal to the variance of the logarithm of the corresponding behavioral trait.</p><p>We fit these models using 10 bootstrapped data sets and obtained an average DIC value of <inline-formula><mml:math id="inf123"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>230</mml:mn><mml:mo>±</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>. Note that in the single-trait model, since each behavior is treated independently, the likelihood gets factorized in terms of the individual likelihoods corresponding to each behavioral trait: <inline-formula><mml:math id="inf124"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msubsup><mml:mo largeop="true" symmetric="true">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Therefore, the DIC (estimated in terms of the log-likelihood) is given by <inline-formula><mml:math id="inf125"><mml:mrow><mml:mtext>DIC</mml:mtext><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mtext>DIC</mml:mtext><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf126"><mml:msub><mml:mtext>DIC</mml:mtext><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is calculated for each single trait GLMM.</p><p>In contrast, the complete GLMM model (described in the main text and in the section above) had a significantly lower average DIC value of <inline-formula><mml:math id="inf127"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>114</mml:mn><mml:mo>±</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> (calculated over 10 bootstrapped data sets as well).</p></sec><sec id="s3-6"><title>Information-based clustering</title><p>The information-based clustering approach used in this article (originally introduced in <xref ref-type="bibr" rid="bib51">Slonim et al., 2005</xref>) minimizes the distance between elements within clusters, while also compressing the original representation as much as possible. More precisely, the method minimizes the functional<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>;</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf128"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>;</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>;</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>∣</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is the mutual information between the original behavioral variable i and the clustering <inline-formula><mml:math id="inf129"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>C</mml:mi><mml:mo>.</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>d</mml:mi><mml:mo>&gt;=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf130"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is the average distance of elements chosen out of a single cluster:<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt">∣</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt">∣</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>with <inline-formula><mml:math id="inf131"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> being the distance measure between a pair of elements and <inline-formula><mml:math id="inf132"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt">∣</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> being the probability to find element <inline-formula><mml:math id="inf133"><mml:mi>i</mml:mi></mml:math></inline-formula> in cluster <inline-formula><mml:math id="inf134"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>C</mml:mi><mml:mo>.</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is a Lagrange multiplier that modulates the relative importance of minimizing the average within-cluster distance and simplifying the clustering.</p><p>Given <inline-formula><mml:math id="inf135"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf136"><mml:mi>T</mml:mi></mml:math></inline-formula> and a random initial condition for <inline-formula><mml:math id="inf137"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt">∣</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, a solution is obtained by iterating a set of self-consistent equations (<xref ref-type="bibr" rid="bib51">Slonim et al., 2005</xref>) until the convergence criteria <inline-formula><mml:math id="inf138"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mfrac><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is satisfied. We chose <inline-formula><mml:math id="inf139"><mml:mrow><mml:mn>40</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math></inline-formula> different initial conditions for <inline-formula><mml:math id="inf140"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, along with randomly chosen values of <inline-formula><mml:math id="inf141"><mml:mrow><mml:mi>T</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mn>1000</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf142"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. For each set of initial conditions and parameters, we performed the optimization until the convergence criterion was met. We defined the Pareto front as the set of solutions <inline-formula><mml:math id="inf143"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt">∣</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> such that no other solution presents a smaller <inline-formula><mml:math id="inf144"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula> and a smaller <inline-formula><mml:math id="inf145"><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>;</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and we only kept solutions that were along this front (eliminating duplicates). Finally, for each number of clusters we selected the solution with the lowest <inline-formula><mml:math id="inf146"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula>.</p><p>For each number of clusters, we assess the modularity of the found solution by comparing <inline-formula><mml:math id="inf147"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula> for the solution to the average distance corresponding to random cluster assignments. These assignments are made in such a way that the amount of elements per cluster is conserved by randomly shuffling the vector that assigns each behavior to a particular cluster. The values presented in the main text correspond to the mean and standard deviation of <inline-formula><mml:math id="inf148"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula> over 50 different random trials.</p></sec><sec id="s3-7"><title>Deterministic Information Bottleneck</title><p>We use the Deterministic Information Bottleneck (DIB) method (<xref ref-type="bibr" rid="bib55">Strouse and Schwab, 2017</xref>) to find coarse-grainings of the behavioral space that optimally predict future states. Inspired by the Information Bottleneck (IB) (<xref ref-type="bibr" rid="bib58">Tishby et al., 1999</xref>), given two measured variables, <inline-formula><mml:math id="inf149"><mml:mi>X</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf150"><mml:mi>Y</mml:mi></mml:math></inline-formula>, the DIB method finds a clustering, <inline-formula><mml:math id="inf151"><mml:mi>Z</mml:mi></mml:math></inline-formula>, of <inline-formula><mml:math id="inf152"><mml:mi>X</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf153"><mml:mi>Z</mml:mi></mml:math></inline-formula> is maximally informative of <inline-formula><mml:math id="inf154"><mml:mi>Y</mml:mi></mml:math></inline-formula>, but is as simple as possible. Specifically, we minimize the functional:<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">𝒥</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:mi class="ltx_font_mathcaligraphic">ℋ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>with respect to <inline-formula><mml:math id="inf155"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>∈</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Here, <inline-formula><mml:math id="inf156"><mml:mi>γ</mml:mi></mml:math></inline-formula> is a Lagrange multiplier that modulates the relative importance of the two terms, with larger values of <inline-formula><mml:math id="inf157"><mml:mi>γ</mml:mi></mml:math></inline-formula> resulting in simpler representations.</p><p>In practice, to compute this minimum for a given value of <inline-formula><mml:math id="inf158"><mml:mi>γ</mml:mi></mml:math></inline-formula> and an initial condition for <inline-formula><mml:math id="inf159"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, we minimize<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">𝒥</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>Z</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt">∣</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>with respect to <inline-formula><mml:math id="inf160"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>∈</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and take the limit as <inline-formula><mml:math id="inf161"><mml:mrow><mml:mi>α</mml:mi><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, following the self-consistent equation procedure described in <xref ref-type="bibr" rid="bib55">Strouse and Schwab, 2017</xref>.</p><p>To apply DIB to the behavioral dynamics, we count time in units of the transitions between states, providing a discrete time series of behaviors: <inline-formula><mml:math id="inf162"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> can thus be one of <inline-formula><mml:math id="inf163"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>134</mml:mn></mml:mrow></mml:math></inline-formula> different integer values at each discrete time <inline-formula><mml:math id="inf164"><mml:mi>n</mml:mi></mml:math></inline-formula>. Here, we relate the joint distributions of <inline-formula><mml:math id="inf165"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf166"><mml:mi>X</mml:mi></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ10">Equation 10</xref>) and <inline-formula><mml:math id="inf167"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf168"><mml:mi>Y</mml:mi></mml:math></inline-formula>) through a coarse-grained clustering of the behavioral states (<inline-formula><mml:math id="inf169"><mml:mi>Z</mml:mi></mml:math></inline-formula>). Similar to our approach with information-based clustering (see previous section), we chose 10,000 different pairs of random values for <inline-formula><mml:math id="inf170"><mml:mi>γ</mml:mi></mml:math></inline-formula> between 0.1 and 10<sup>4</sup> and <inline-formula><mml:math id="inf171"><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula> between 2 and 30 clusters. Given <inline-formula><mml:math id="inf172"><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf173"><mml:mi>γ</mml:mi></mml:math></inline-formula> and a random initial condition for <inline-formula><mml:math id="inf174"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt">∣</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, we find a solution by iterating through a set of self-consistent equations (<xref ref-type="bibr" rid="bib55">Strouse and Schwab, 2017</xref>) until the convergence criteria (an absolute change in the function of less than <inline-formula><mml:math id="inf175"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>) is satisfied. If any cluster has its probability become zero at any iteration, then that cluster is dropped for all future iterations. Thus, <inline-formula><mml:math id="inf176"><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula> is the maximum number of clusters that can be returned. Of these <inline-formula><mml:math id="inf177"><mml:mrow><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math></inline-formula> solutions, we keep all solutions that are on the Pareto front (i.e., no other solution has both a higher <inline-formula><mml:math id="inf178"><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and a smaller <inline-formula><mml:math id="inf179"><mml:mrow><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>). The displayed clusters are the solutions on the Pareto front with the largest <inline-formula><mml:math id="inf180"><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for a given number of clusters.</p></sec><sec id="s3-8"><title>Weighted similarity index</title><p>We quantify the similarity between clustering partitions using the Weighted Similarity Index (WSI), a modification of the Rand Index (<xref ref-type="bibr" rid="bib45">Rand, 1971</xref>) such that behaviors contribute the index according to their overall probability. Specifically,<disp-formula id="equ12"><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">W</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mtext>W</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mtext>W</mml:mtext></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>, </mml:mtext></mml:mstyle><mml:msub><mml:mrow><mml:mtext>W</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p> where <inline-formula><mml:math id="inf181"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the set of pairs of behaviors that belong to the same (different) cluster in the two partitions and <inline-formula><mml:math id="inf182"><mml:msub><mml:mi>P</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula> is the probability of observing behavior <inline-formula><mml:math id="inf183"><mml:mi>k</mml:mi></mml:math></inline-formula>.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Ilya Nemenman, Jennifer Rieser, and Daniel Weissman for their helpful comments on the manuscript. DGH was supported by Programa Raices from the MinCyT. CR was supported by the NSF Physics of Living Systems Student Research Network (1806833). GJB. was supported by NIMH R01 MH115831-01, the Human Frontier Science Program (RGY0076/2018), and a Cottrell Scholar Award, a program of the Research Corporation for Science Advancement (25999). JC, DLS, and GJB were supported by the Howard Hughes Medical Institute and the Janelia visiting researcher program.</p></ack><sec id="s4" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf2"><p>Reviewing editor, <italic>eLife</italic></p></fn><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Data curation, Investigation, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Software, Investigation, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Resources, Funding acquisition, Investigation, Visualization, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Supervision, Funding acquisition, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn></fn-group></sec><sec id="s5" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="sdata1"><label>Source data 1.</label><caption><title>Fly behavior source data.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-61806-data1-v2.zip"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-61806-transrepform-v2.docx"/></supplementary-material></sec><sec id="s6" sec-type="data-availability"><title>Data availability</title><p>All behavioral region information is submitted with the article and is posted on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/bermanlabemory/behavioral-evolution">https://github.com/bermanlabemory/behavioral-evolution</ext-link>, copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:rev:b01a6e3a2c7da193f38631dfe925c65229494d74">https://archive.softwareheritage.org/swh:1:rev:b01a6e3a2c7da193f38631dfe925c65229494d74</ext-link>). The original video data are too large to post (tens of TB), but will be made available upon request.</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Akaike</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1973">1973</year><article-title>Information theory and an extension of the maximum likelihood principle</article-title><conf-name>Proceedings of the 2nd International Symposium on Information Theory</conf-name><fpage>267</fpage><lpage>281</lpage></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anderson</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Circuit modules linking internal states and social behaviour in flies and mice</article-title><source>Nature Reviews Neuroscience</source><volume>17</volume><fpage>692</fpage><lpage>704</lpage><pub-id pub-id-type="doi">10.1038/nrn.2016.125</pub-id><pub-id pub-id-type="pmid">27752072</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Auer</surname> <given-names>TO</given-names></name><name><surname>Benton</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Sexual circuitry in <italic>Drosophila</italic></article-title><source>Current Opinion in Neurobiology</source><volume>38</volume><fpage>18</fpage><lpage>26</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2016.01.004</pub-id><pub-id pub-id-type="pmid">26851712</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baier</surname> <given-names>F</given-names></name><name><surname>Hoekstra</surname> <given-names>HE</given-names></name></person-group><year iso-8601-date="1914">1914</year><article-title>The genetics of morphological and behavioural island traits in deer mice</article-title><source>Proceedings of the Royal Society B</source><volume>286</volume><elocation-id>1697</elocation-id><pub-id pub-id-type="doi">10.1098/rspb.2019.1697</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baker</surname> <given-names>BS</given-names></name><name><surname>Taylor</surname> <given-names>BJ</given-names></name><name><surname>Hall</surname> <given-names>JC</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Are complex behaviors specified by dedicated regulatory genes? reasoning from <italic>Drosophila</italic></article-title><source>Cell</source><volume>105</volume><fpage>13</fpage><lpage>24</lpage><pub-id pub-id-type="doi">10.1016/S0092-8674(01)00293-8</pub-id><pub-id pub-id-type="pmid">11300999</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bennet-Clark</surname> <given-names>HC</given-names></name><name><surname>Ewing</surname> <given-names>AW</given-names></name></person-group><year iso-8601-date="1969">1969</year><article-title>Pulse interval as a critical parameter in the courtship song of <italic>Drosophila melanogaster</italic></article-title><source>Animal Behaviour</source><volume>17</volume><fpage>755</fpage><lpage>759</lpage><pub-id pub-id-type="doi">10.1016/S0003-3472(69)80023-0</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berman</surname> <given-names>GJ</given-names></name><name><surname>Choi</surname> <given-names>DM</given-names></name><name><surname>Bialek</surname> <given-names>W</given-names></name><name><surname>Shaevitz</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Mapping the stereotyped behaviour of freely moving fruit flies</article-title><source>Journal of the Royal Society Interface</source><volume>11</volume><elocation-id>20140672</elocation-id><pub-id pub-id-type="doi">10.1098/rsif.2014.0672</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berman</surname> <given-names>GJ</given-names></name><name><surname>Bialek</surname> <given-names>W</given-names></name><name><surname>Shaevitz</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Predictability and hierarchy in <italic>Drosophila</italic> behavior</article-title><source>PNAS</source><volume>113</volume><fpage>11943</fpage><lpage>11948</lpage><pub-id pub-id-type="doi">10.1073/pnas.1607601113</pub-id><pub-id pub-id-type="pmid">27702892</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berman</surname> <given-names>GJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Measuring behavior across scales</article-title><source>BMC Biology</source><volume>16</volume><elocation-id>23</elocation-id><pub-id pub-id-type="doi">10.1186/s12915-018-0494-7</pub-id><pub-id pub-id-type="pmid">29475451</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brooks</surname> <given-names>SP</given-names></name><name><surname>Gelman</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>General methods for monitoring convergence of iterative simulations</article-title><source>Journal of Computational and Graphical Statistics</source><volume>7</volume><fpage>434</fpage><lpage>455</lpage><pub-id pub-id-type="doi">10.1080/10618600.1998.10474787</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname> <given-names>AEX</given-names></name><name><surname>de Bivort</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Ethology as a physical science</article-title><source>Nature Physics</source><volume>14</volume><fpage>653</fpage><lpage>657</lpage><pub-id pub-id-type="doi">10.1038/s41567-018-0093-0</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caetano</surname> <given-names>DS</given-names></name><name><surname>Beaulieu</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Comparative analyses of phenotypic sequences using phylogenetic trees</article-title><source>The American Naturalist</source><volume>195</volume><fpage>E38</fpage><lpage>E50</lpage><pub-id pub-id-type="doi">10.1086/706912</pub-id><pub-id pub-id-type="pmid">32017626</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Calhoun</surname> <given-names>AJ</given-names></name><name><surname>Pillow</surname> <given-names>JW</given-names></name><name><surname>Murthy</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Unsupervised identification of the internal states that shape natural behavior</article-title><source>Nature Neuroscience</source><volume>22</volume><fpage>2040</fpage><lpage>2049</lpage><pub-id pub-id-type="doi">10.1038/s41593-019-0533-x</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cande</surname> <given-names>J</given-names></name><name><surname>Andolfatto</surname> <given-names>P</given-names></name><name><surname>Prud'homme</surname> <given-names>B</given-names></name><name><surname>Stern</surname> <given-names>DL</given-names></name><name><surname>Gompel</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Evolution of multiple additive loci caused divergence between <italic>Drosophila</italic> yakuba and D. santomea in wing rowing during male courtship</article-title><source>PLOS ONE</source><volume>7</volume><elocation-id>e43888</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0043888</pub-id><pub-id pub-id-type="pmid">22952802</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cande</surname> <given-names>J</given-names></name><name><surname>Stern</surname> <given-names>DL</given-names></name><name><surname>Morita</surname> <given-names>T</given-names></name><name><surname>Prud’homme</surname> <given-names>B</given-names></name><name><surname>Gompel</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Looking Under the Lamp Post: Neither fruitless nor doublesex Has Evolved to Generate Divergent Male Courtship in <italic>Drosophila</italic></article-title><source>Cell Reports</source><volume>8</volume><fpage>363</fpage><lpage>370</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2014.06.023</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cande</surname> <given-names>J</given-names></name><name><surname>Namiki</surname> <given-names>S</given-names></name><name><surname>Qiu</surname> <given-names>J</given-names></name><name><surname>Korff</surname> <given-names>W</given-names></name><name><surname>Card</surname> <given-names>GM</given-names></name><name><surname>Shaevitz</surname> <given-names>JW</given-names></name><name><surname>Stern</surname> <given-names>DL</given-names></name><name><surname>Berman</surname> <given-names>GJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Optogenetic dissection of descending behavioral control in <italic>Drosophila</italic></article-title><source>eLife</source><volume>7</volume><elocation-id>e34275</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.34275</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Chyb</surname> <given-names>S</given-names></name><name><surname>Gompel</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2013">2013</year><source>Atlas of Drosophila Morphology: Wild-Type and Classical Mutants</source><publisher-loc>London</publisher-loc><publisher-name>Academic Press</publisher-name></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clark</surname> <given-names>AG</given-names></name><name><surname>Eisen</surname> <given-names>MB</given-names></name><name><surname>Smith</surname> <given-names>DR</given-names></name><name><surname>Bergman</surname> <given-names>CM</given-names></name><name><surname>Oliver</surname> <given-names>B</given-names></name><name><surname>Markow</surname> <given-names>TA</given-names></name><name><surname>Kaufman</surname> <given-names>TC</given-names></name><name><surname>Kellis</surname> <given-names>M</given-names></name><name><surname>Gelbart</surname> <given-names>W</given-names></name><name><surname>Iyer</surname> <given-names>VN</given-names></name><name><surname>Pollard</surname> <given-names>DA</given-names></name><name><surname>Sackton</surname> <given-names>TB</given-names></name><name><surname>Larracuente</surname> <given-names>AM</given-names></name><name><surname>Singh</surname> <given-names>ND</given-names></name><name><surname>Abad</surname> <given-names>JP</given-names></name><name><surname>Abt</surname> <given-names>DN</given-names></name><name><surname>Adryan</surname> <given-names>B</given-names></name><name><surname>Aguade</surname> <given-names>M</given-names></name><name><surname>Akashi</surname> <given-names>H</given-names></name><name><surname>Anderson</surname> <given-names>WW</given-names></name><name><surname>Aquadro</surname> <given-names>CF</given-names></name><name><surname>Ardell</surname> <given-names>DH</given-names></name><name><surname>Arguello</surname> <given-names>R</given-names></name><name><surname>Artieri</surname> <given-names>CG</given-names></name><name><surname>Barbash</surname> <given-names>DA</given-names></name><name><surname>Barker</surname> <given-names>D</given-names></name><name><surname>Barsanti</surname> <given-names>P</given-names></name><name><surname>Batterham</surname> <given-names>P</given-names></name><name><surname>Batzoglou</surname> <given-names>S</given-names></name><name><surname>Begun</surname> <given-names>D</given-names></name><name><surname>Bhutkar</surname> <given-names>A</given-names></name><name><surname>Blanco</surname> <given-names>E</given-names></name><name><surname>Bosak</surname> <given-names>SA</given-names></name><name><surname>Bradley</surname> <given-names>RK</given-names></name><name><surname>Brand</surname> <given-names>AD</given-names></name><name><surname>Brent</surname> <given-names>MR</given-names></name><name><surname>Brooks</surname> <given-names>AN</given-names></name><name><surname>Brown</surname> <given-names>RH</given-names></name><name><surname>Butlin</surname> <given-names>RK</given-names></name><name><surname>Caggese</surname> <given-names>C</given-names></name><name><surname>Calvi</surname> <given-names>BR</given-names></name><name><surname>Bernardo de Carvalho</surname> <given-names>A</given-names></name><name><surname>Caspi</surname> <given-names>A</given-names></name><name><surname>Castrezana</surname> <given-names>S</given-names></name><name><surname>Celniker</surname> <given-names>SE</given-names></name><name><surname>Chang</surname> <given-names>JL</given-names></name><name><surname>Chapple</surname> <given-names>C</given-names></name><name><surname>Chatterji</surname> <given-names>S</given-names></name><name><surname>Chinwalla</surname> <given-names>A</given-names></name><name><surname>Civetta</surname> <given-names>A</given-names></name><name><surname>Clifton</surname> <given-names>SW</given-names></name><name><surname>Comeron</surname> <given-names>JM</given-names></name><name><surname>Costello</surname> <given-names>JC</given-names></name><name><surname>Coyne</surname> <given-names>JA</given-names></name><name><surname>Daub</surname> <given-names>J</given-names></name><name><surname>David</surname> <given-names>RG</given-names></name><name><surname>Delcher</surname> <given-names>AL</given-names></name><name><surname>Delehaunty</surname> <given-names>K</given-names></name><name><surname>Do</surname> <given-names>CB</given-names></name><name><surname>Ebling</surname> <given-names>H</given-names></name><name><surname>Edwards</surname> <given-names>K</given-names></name><name><surname>Eickbush</surname> <given-names>T</given-names></name><name><surname>Evans</surname> <given-names>JD</given-names></name><name><surname>Filipski</surname> <given-names>A</given-names></name><name><surname>Findeiss</surname> <given-names>S</given-names></name><name><surname>Freyhult</surname> <given-names>E</given-names></name><name><surname>Fulton</surname> <given-names>L</given-names></name><name><surname>Fulton</surname> <given-names>R</given-names></name><name><surname>Garcia</surname> <given-names>AC</given-names></name><name><surname>Gardiner</surname> <given-names>A</given-names></name><name><surname>Garfield</surname> <given-names>DA</given-names></name><name><surname>Garvin</surname> <given-names>BE</given-names></name><name><surname>Gibson</surname> <given-names>G</given-names></name><name><surname>Gilbert</surname> <given-names>D</given-names></name><name><surname>Gnerre</surname> <given-names>S</given-names></name><name><surname>Godfrey</surname> <given-names>J</given-names></name><name><surname>Good</surname> <given-names>R</given-names></name><name><surname>Gotea</surname> <given-names>V</given-names></name><name><surname>Gravely</surname> <given-names>B</given-names></name><name><surname>Greenberg</surname> <given-names>AJ</given-names></name><name><surname>Griffiths-Jones</surname> <given-names>S</given-names></name><name><surname>Gross</surname> <given-names>S</given-names></name><name><surname>Guigo</surname> <given-names>R</given-names></name><name><surname>Gustafson</surname> <given-names>EA</given-names></name><name><surname>Haerty</surname> <given-names>W</given-names></name><name><surname>Hahn</surname> <given-names>MW</given-names></name><name><surname>Halligan</surname> <given-names>DL</given-names></name><name><surname>Halpern</surname> <given-names>AL</given-names></name><name><surname>Halter</surname> <given-names>GM</given-names></name><name><surname>Han</surname> <given-names>MV</given-names></name><name><surname>Heger</surname> <given-names>A</given-names></name><name><surname>Hillier</surname> <given-names>L</given-names></name><name><surname>Hinrichs</surname> <given-names>AS</given-names></name><name><surname>Holmes</surname> <given-names>I</given-names></name><name><surname>Hoskins</surname> <given-names>RA</given-names></name><name><surname>Hubisz</surname> <given-names>MJ</given-names></name><name><surname>Hultmark</surname> <given-names>D</given-names></name><name><surname>Huntley</surname> <given-names>MA</given-names></name><name><surname>Jaffe</surname> <given-names>DB</given-names></name><name><surname>Jagadeeshan</surname> <given-names>S</given-names></name><name><surname>Jeck</surname> <given-names>WR</given-names></name><name><surname>Johnson</surname> <given-names>J</given-names></name><name><surname>Jones</surname> <given-names>CD</given-names></name><name><surname>Jordan</surname> <given-names>WC</given-names></name><name><surname>Karpen</surname> <given-names>GH</given-names></name><name><surname>Kataoka</surname> <given-names>E</given-names></name><name><surname>Keightley</surname> <given-names>PD</given-names></name><name><surname>Kheradpour</surname> <given-names>P</given-names></name><name><surname>Kirkness</surname> <given-names>EF</given-names></name><name><surname>Koerich</surname> <given-names>LB</given-names></name><name><surname>Kristiansen</surname> <given-names>K</given-names></name><name><surname>Kudrna</surname> <given-names>D</given-names></name><name><surname>Kulathinal</surname> <given-names>RJ</given-names></name><name><surname>Kumar</surname> <given-names>S</given-names></name><name><surname>Kwok</surname> <given-names>R</given-names></name><name><surname>Lander</surname> <given-names>E</given-names></name><name><surname>Langley</surname> <given-names>CH</given-names></name><name><surname>Lapoint</surname> <given-names>R</given-names></name><name><surname>Lazzaro</surname> <given-names>BP</given-names></name><name><surname>Lee</surname> <given-names>SJ</given-names></name><name><surname>Levesque</surname> <given-names>L</given-names></name><name><surname>Li</surname> <given-names>R</given-names></name><name><surname>Lin</surname> <given-names>CF</given-names></name><name><surname>Lin</surname> <given-names>MF</given-names></name><name><surname>Lindblad-Toh</surname> <given-names>K</given-names></name><name><surname>Llopart</surname> <given-names>A</given-names></name><name><surname>Long</surname> <given-names>M</given-names></name><name><surname>Low</surname> <given-names>L</given-names></name><name><surname>Lozovsky</surname> <given-names>E</given-names></name><name><surname>Lu</surname> <given-names>J</given-names></name><name><surname>Luo</surname> <given-names>M</given-names></name><name><surname>Machado</surname> <given-names>CA</given-names></name><name><surname>Makalowski</surname> <given-names>W</given-names></name><name><surname>Marzo</surname> <given-names>M</given-names></name><name><surname>Matsuda</surname> <given-names>M</given-names></name><name><surname>Matzkin</surname> <given-names>L</given-names></name><name><surname>McAllister</surname> <given-names>B</given-names></name><name><surname>McBride</surname> <given-names>CS</given-names></name><name><surname>McKernan</surname> <given-names>B</given-names></name><name><surname>McKernan</surname> <given-names>K</given-names></name><name><surname>Mendez-Lago</surname> <given-names>M</given-names></name><name><surname>Minx</surname> <given-names>P</given-names></name><name><surname>Mollenhauer</surname> <given-names>MU</given-names></name><name><surname>Montooth</surname> <given-names>K</given-names></name><name><surname>Mount</surname> <given-names>SM</given-names></name><name><surname>Mu</surname> <given-names>X</given-names></name><name><surname>Myers</surname> <given-names>E</given-names></name><name><surname>Negre</surname> <given-names>B</given-names></name><name><surname>Newfeld</surname> <given-names>S</given-names></name><name><surname>Nielsen</surname> <given-names>R</given-names></name><name><surname>Noor</surname> <given-names>MA</given-names></name><name><surname>O'Grady</surname> <given-names>P</given-names></name><name><surname>Pachter</surname> <given-names>L</given-names></name><name><surname>Papaceit</surname> <given-names>M</given-names></name><name><surname>Parisi</surname> <given-names>MJ</given-names></name><name><surname>Parisi</surname> <given-names>M</given-names></name><name><surname>Parts</surname> <given-names>L</given-names></name><name><surname>Pedersen</surname> <given-names>JS</given-names></name><name><surname>Pesole</surname> <given-names>G</given-names></name><name><surname>Phillippy</surname> <given-names>AM</given-names></name><name><surname>Ponting</surname> <given-names>CP</given-names></name><name><surname>Pop</surname> <given-names>M</given-names></name><name><surname>Porcelli</surname> <given-names>D</given-names></name><name><surname>Powell</surname> <given-names>JR</given-names></name><name><surname>Prohaska</surname> <given-names>S</given-names></name><name><surname>Pruitt</surname> <given-names>K</given-names></name><name><surname>Puig</surname> <given-names>M</given-names></name><name><surname>Quesneville</surname> <given-names>H</given-names></name><name><surname>Ram</surname> <given-names>KR</given-names></name><name><surname>Rand</surname> <given-names>D</given-names></name><name><surname>Rasmussen</surname> <given-names>MD</given-names></name><name><surname>Reed</surname> <given-names>LK</given-names></name><name><surname>Reenan</surname> <given-names>R</given-names></name><name><surname>Reily</surname> <given-names>A</given-names></name><name><surname>Remington</surname> <given-names>KA</given-names></name><name><surname>Rieger</surname> <given-names>TT</given-names></name><name><surname>Ritchie</surname> <given-names>MG</given-names></name><name><surname>Robin</surname> <given-names>C</given-names></name><name><surname>Rogers</surname> <given-names>YH</given-names></name><name><surname>Rohde</surname> <given-names>C</given-names></name><name><surname>Rozas</surname> <given-names>J</given-names></name><name><surname>Rubenfield</surname> <given-names>MJ</given-names></name><name><surname>Ruiz</surname> <given-names>A</given-names></name><name><surname>Russo</surname> <given-names>S</given-names></name><name><surname>Salzberg</surname> <given-names>SL</given-names></name><name><surname>Sanchez-Gracia</surname> <given-names>A</given-names></name><name><surname>Saranga</surname> <given-names>DJ</given-names></name><name><surname>Sato</surname> <given-names>H</given-names></name><name><surname>Schaeffer</surname> <given-names>SW</given-names></name><name><surname>Schatz</surname> <given-names>MC</given-names></name><name><surname>Schlenke</surname> <given-names>T</given-names></name><name><surname>Schwartz</surname> <given-names>R</given-names></name><name><surname>Segarra</surname> <given-names>C</given-names></name><name><surname>Singh</surname> <given-names>RS</given-names></name><name><surname>Sirot</surname> <given-names>L</given-names></name><name><surname>Sirota</surname> <given-names>M</given-names></name><name><surname>Sisneros</surname> <given-names>NB</given-names></name><name><surname>Smith</surname> <given-names>CD</given-names></name><name><surname>Smith</surname> <given-names>TF</given-names></name><name><surname>Spieth</surname> <given-names>J</given-names></name><name><surname>Stage</surname> <given-names>DE</given-names></name><name><surname>Stark</surname> <given-names>A</given-names></name><name><surname>Stephan</surname> <given-names>W</given-names></name><name><surname>Strausberg</surname> <given-names>RL</given-names></name><name><surname>Strempel</surname> <given-names>S</given-names></name><name><surname>Sturgill</surname> <given-names>D</given-names></name><name><surname>Sutton</surname> <given-names>G</given-names></name><name><surname>Sutton</surname> <given-names>GG</given-names></name><name><surname>Tao</surname> <given-names>W</given-names></name><name><surname>Teichmann</surname> <given-names>S</given-names></name><name><surname>Tobari</surname> <given-names>YN</given-names></name><name><surname>Tomimura</surname> <given-names>Y</given-names></name><name><surname>Tsolas</surname> <given-names>JM</given-names></name><name><surname>Valente</surname> <given-names>VL</given-names></name><name><surname>Venter</surname> <given-names>E</given-names></name><name><surname>Venter</surname> <given-names>JC</given-names></name><name><surname>Vicario</surname> <given-names>S</given-names></name><name><surname>Vieira</surname> <given-names>FG</given-names></name><name><surname>Vilella</surname> <given-names>AJ</given-names></name><name><surname>Villasante</surname> <given-names>A</given-names></name><name><surname>Walenz</surname> <given-names>B</given-names></name><name><surname>Wang</surname> <given-names>J</given-names></name><name><surname>Wasserman</surname> <given-names>M</given-names></name><name><surname>Watts</surname> <given-names>T</given-names></name><name><surname>Wilson</surname> <given-names>D</given-names></name><name><surname>Wilson</surname> <given-names>RK</given-names></name><name><surname>Wing</surname> <given-names>RA</given-names></name><name><surname>Wolfner</surname> <given-names>MF</given-names></name><name><surname>Wong</surname> <given-names>A</given-names></name><name><surname>Wong</surname> <given-names>GK</given-names></name><name><surname>Wu</surname> <given-names>CI</given-names></name><name><surname>Wu</surname> <given-names>G</given-names></name><name><surname>Yamamoto</surname> <given-names>D</given-names></name><name><surname>Yang</surname> <given-names>HP</given-names></name><name><surname>Yang</surname> <given-names>SP</given-names></name><name><surname>Yorke</surname> <given-names>JA</given-names></name><name><surname>Yoshida</surname> <given-names>K</given-names></name><name><surname>Zdobnov</surname> <given-names>E</given-names></name><name><surname>Zhang</surname> <given-names>P</given-names></name><name><surname>Zhang</surname> <given-names>Y</given-names></name><name><surname>Zimin</surname> <given-names>AV</given-names></name><name><surname>Baldwin</surname> <given-names>J</given-names></name><name><surname>Abdouelleil</surname> <given-names>A</given-names></name><name><surname>Abdulkadir</surname> <given-names>J</given-names></name><name><surname>Abebe</surname> <given-names>A</given-names></name><name><surname>Abera</surname> <given-names>B</given-names></name><name><surname>Abreu</surname> <given-names>J</given-names></name><name><surname>Acer</surname> <given-names>SC</given-names></name><name><surname>Aftuck</surname> <given-names>L</given-names></name><name><surname>Alexander</surname> <given-names>A</given-names></name><name><surname>An</surname> <given-names>P</given-names></name><name><surname>Anderson</surname> <given-names>E</given-names></name><name><surname>Anderson</surname> <given-names>S</given-names></name><name><surname>Arachi</surname> <given-names>H</given-names></name><name><surname>Azer</surname> <given-names>M</given-names></name><name><surname>Bachantsang</surname> <given-names>P</given-names></name><name><surname>Barry</surname> <given-names>A</given-names></name><name><surname>Bayul</surname> <given-names>T</given-names></name><name><surname>Berlin</surname> <given-names>A</given-names></name><name><surname>Bessette</surname> <given-names>D</given-names></name><name><surname>Bloom</surname> <given-names>T</given-names></name><name><surname>Blye</surname> <given-names>J</given-names></name><name><surname>Boguslavskiy</surname> <given-names>L</given-names></name><name><surname>Bonnet</surname> <given-names>C</given-names></name><name><surname>Boukhgalter</surname> <given-names>B</given-names></name><name><surname>Bourzgui</surname> <given-names>I</given-names></name><name><surname>Brown</surname> <given-names>A</given-names></name><name><surname>Cahill</surname> <given-names>P</given-names></name><name><surname>Channer</surname> <given-names>S</given-names></name><name><surname>Cheshatsang</surname> <given-names>Y</given-names></name><name><surname>Chuda</surname> <given-names>L</given-names></name><name><surname>Citroen</surname> <given-names>M</given-names></name><name><surname>Collymore</surname> <given-names>A</given-names></name><name><surname>Cooke</surname> <given-names>P</given-names></name><name><surname>Costello</surname> <given-names>M</given-names></name><name><surname>D'Aco</surname> <given-names>K</given-names></name><name><surname>Daza</surname> <given-names>R</given-names></name><name><surname>De Haan</surname> <given-names>G</given-names></name><name><surname>DeGray</surname> <given-names>S</given-names></name><name><surname>DeMaso</surname> <given-names>C</given-names></name><name><surname>Dhargay</surname> <given-names>N</given-names></name><name><surname>Dooley</surname> <given-names>K</given-names></name><name><surname>Dooley</surname> <given-names>E</given-names></name><name><surname>Doricent</surname> <given-names>M</given-names></name><name><surname>Dorje</surname> <given-names>P</given-names></name><name><surname>Dorjee</surname> <given-names>K</given-names></name><name><surname>Dupes</surname> <given-names>A</given-names></name><name><surname>Elong</surname> <given-names>R</given-names></name><name><surname>Falk</surname> <given-names>J</given-names></name><name><surname>Farina</surname> <given-names>A</given-names></name><name><surname>Faro</surname> <given-names>S</given-names></name><name><surname>Ferguson</surname> <given-names>D</given-names></name><name><surname>Fisher</surname> <given-names>S</given-names></name><name><surname>Foley</surname> <given-names>CD</given-names></name><name><surname>Franke</surname> <given-names>A</given-names></name><name><surname>Friedrich</surname> <given-names>D</given-names></name><name><surname>Gadbois</surname> <given-names>L</given-names></name><name><surname>Gearin</surname> <given-names>G</given-names></name><name><surname>Gearin</surname> <given-names>CR</given-names></name><name><surname>Giannoukos</surname> <given-names>G</given-names></name><name><surname>Goode</surname> <given-names>T</given-names></name><name><surname>Graham</surname> <given-names>J</given-names></name><name><surname>Grandbois</surname> <given-names>E</given-names></name><name><surname>Grewal</surname> <given-names>S</given-names></name><name><surname>Gyaltsen</surname> <given-names>K</given-names></name><name><surname>Hafez</surname> <given-names>N</given-names></name><name><surname>Hagos</surname> <given-names>B</given-names></name><name><surname>Hall</surname> <given-names>J</given-names></name><name><surname>Henson</surname> <given-names>C</given-names></name><name><surname>Hollinger</surname> <given-names>A</given-names></name><name><surname>Honan</surname> <given-names>T</given-names></name><name><surname>Huard</surname> <given-names>MD</given-names></name><name><surname>Hughes</surname> <given-names>L</given-names></name><name><surname>Hurhula</surname> <given-names>B</given-names></name><name><surname>Husby</surname> <given-names>ME</given-names></name><name><surname>Kamat</surname> <given-names>A</given-names></name><name><surname>Kanga</surname> <given-names>B</given-names></name><name><surname>Kashin</surname> <given-names>S</given-names></name><name><surname>Khazanovich</surname> <given-names>D</given-names></name><name><surname>Kisner</surname> <given-names>P</given-names></name><name><surname>Lance</surname> <given-names>K</given-names></name><name><surname>Lara</surname> <given-names>M</given-names></name><name><surname>Lee</surname> <given-names>W</given-names></name><name><surname>Lennon</surname> <given-names>N</given-names></name><name><surname>Letendre</surname> <given-names>F</given-names></name><name><surname>LeVine</surname> <given-names>R</given-names></name><name><surname>Lipovsky</surname> <given-names>A</given-names></name><name><surname>Liu</surname> <given-names>X</given-names></name><name><surname>Liu</surname> <given-names>J</given-names></name><name><surname>Liu</surname> <given-names>S</given-names></name><name><surname>Lokyitsang</surname> <given-names>T</given-names></name><name><surname>Lokyitsang</surname> <given-names>Y</given-names></name><name><surname>Lubonja</surname> <given-names>R</given-names></name><name><surname>Lui</surname> <given-names>A</given-names></name><name><surname>MacDonald</surname> <given-names>P</given-names></name><name><surname>Magnisalis</surname> <given-names>V</given-names></name><name><surname>Maru</surname> <given-names>K</given-names></name><name><surname>Matthews</surname> <given-names>C</given-names></name><name><surname>McCusker</surname> <given-names>W</given-names></name><name><surname>McDonough</surname> <given-names>S</given-names></name><name><surname>Mehta</surname> <given-names>T</given-names></name><name><surname>Meldrim</surname> <given-names>J</given-names></name><name><surname>Meneus</surname> <given-names>L</given-names></name><name><surname>Mihai</surname> <given-names>O</given-names></name><name><surname>Mihalev</surname> <given-names>A</given-names></name><name><surname>Mihova</surname> <given-names>T</given-names></name><name><surname>Mittelman</surname> <given-names>R</given-names></name><name><surname>Mlenga</surname> <given-names>V</given-names></name><name><surname>Montmayeur</surname> <given-names>A</given-names></name><name><surname>Mulrain</surname> <given-names>L</given-names></name><name><surname>Navidi</surname> <given-names>A</given-names></name><name><surname>Naylor</surname> <given-names>J</given-names></name><name><surname>Negash</surname> <given-names>T</given-names></name><name><surname>Nguyen</surname> <given-names>T</given-names></name><name><surname>Nguyen</surname> <given-names>N</given-names></name><name><surname>Nicol</surname> <given-names>R</given-names></name><name><surname>Norbu</surname> <given-names>C</given-names></name><name><surname>Norbu</surname> <given-names>N</given-names></name><name><surname>Novod</surname> <given-names>N</given-names></name><name><surname>O'Neill</surname> <given-names>B</given-names></name><name><surname>Osman</surname> <given-names>S</given-names></name><name><surname>Markiewicz</surname> <given-names>E</given-names></name><name><surname>Oyono</surname> <given-names>OL</given-names></name><name><surname>Patti</surname> <given-names>C</given-names></name><name><surname>Phunkhang</surname> <given-names>P</given-names></name><name><surname>Pierre</surname> <given-names>F</given-names></name><name><surname>Priest</surname> <given-names>M</given-names></name><name><surname>Raghuraman</surname> <given-names>S</given-names></name><name><surname>Rege</surname> <given-names>F</given-names></name><name><surname>Reyes</surname> <given-names>R</given-names></name><name><surname>Rise</surname> <given-names>C</given-names></name><name><surname>Rogov</surname> <given-names>P</given-names></name><name><surname>Ross</surname> <given-names>K</given-names></name><name><surname>Ryan</surname> <given-names>E</given-names></name><name><surname>Settipalli</surname> <given-names>S</given-names></name><name><surname>Shea</surname> <given-names>T</given-names></name><name><surname>Sherpa</surname> <given-names>N</given-names></name><name><surname>Shi</surname> <given-names>L</given-names></name><name><surname>Shih</surname> <given-names>D</given-names></name><name><surname>Sparrow</surname> <given-names>T</given-names></name><name><surname>Spaulding</surname> <given-names>J</given-names></name><name><surname>Stalker</surname> <given-names>J</given-names></name><name><surname>Stange-Thomann</surname> <given-names>N</given-names></name><name><surname>Stavropoulos</surname> <given-names>S</given-names></name><name><surname>Stone</surname> <given-names>C</given-names></name><name><surname>Strader</surname> <given-names>C</given-names></name><name><surname>Tesfaye</surname> <given-names>S</given-names></name><name><surname>Thomson</surname> <given-names>T</given-names></name><name><surname>Thoulutsang</surname> <given-names>Y</given-names></name><name><surname>Thoulutsang</surname> <given-names>D</given-names></name><name><surname>Topham</surname> <given-names>K</given-names></name><name><surname>Topping</surname> <given-names>I</given-names></name><name><surname>Tsamla</surname> <given-names>T</given-names></name><name><surname>Vassiliev</surname> <given-names>H</given-names></name><name><surname>Vo</surname> <given-names>A</given-names></name><name><surname>Wangchuk</surname> <given-names>T</given-names></name><name><surname>Wangdi</surname> <given-names>T</given-names></name><name><surname>Weiand</surname> <given-names>M</given-names></name><name><surname>Wilkinson</surname> <given-names>J</given-names></name><name><surname>Wilson</surname> <given-names>A</given-names></name><name><surname>Yadav</surname> <given-names>S</given-names></name><name><surname>Young</surname> <given-names>G</given-names></name><name><surname>Yu</surname> <given-names>Q</given-names></name><name><surname>Zembek</surname> <given-names>L</given-names></name><name><surname>Zhong</surname> <given-names>D</given-names></name><name><surname>Zimmer</surname> <given-names>A</given-names></name><name><surname>Zwirko</surname> <given-names>Z</given-names></name><name><surname>Jaffe</surname> <given-names>DB</given-names></name><name><surname>Alvarez</surname> <given-names>P</given-names></name><name><surname>Brockman</surname> <given-names>W</given-names></name><name><surname>Butler</surname> <given-names>J</given-names></name><name><surname>Chin</surname> <given-names>C</given-names></name><name><surname>Gnerre</surname> <given-names>S</given-names></name><name><surname>Grabherr</surname> <given-names>M</given-names></name><name><surname>Kleber</surname> <given-names>M</given-names></name><name><surname>Mauceli</surname> <given-names>E</given-names></name><name><surname>MacCallum</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Evolution of genes and genomes on the <italic>Drosophila</italic> phylogeny</article-title><source>Nature</source><volume>450</volume><fpage>203</fpage><lpage>218</lpage><pub-id pub-id-type="doi">10.1038/nature06341</pub-id><pub-id pub-id-type="pmid">17994087</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cunningham</surname> <given-names>CW</given-names></name><name><surname>Omland</surname> <given-names>KE</given-names></name><name><surname>Oakley</surname> <given-names>TH</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Reconstructing ancestral character states: a critical reappraisal</article-title><source>Trends in Ecology &amp; Evolution</source><volume>13</volume><fpage>361</fpage><lpage>366</lpage><pub-id pub-id-type="doi">10.1016/S0169-5347(98)01382-2</pub-id><pub-id pub-id-type="pmid">21238344</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deutsch</surname> <given-names>D</given-names></name><name><surname>Pacheco</surname> <given-names>D</given-names></name><name><surname>Encarnacion-Rivera</surname> <given-names>L</given-names></name><name><surname>Pereira</surname> <given-names>T</given-names></name><name><surname>Fathy</surname> <given-names>R</given-names></name><name><surname>Clemens</surname> <given-names>J</given-names></name><name><surname>Girardin</surname> <given-names>C</given-names></name><name><surname>Calhoun</surname> <given-names>A</given-names></name><name><surname>Ireland</surname> <given-names>E</given-names></name><name><surname>Burke</surname> <given-names>A</given-names></name><name><surname>Dorkenwald</surname> <given-names>S</given-names></name><name><surname>McKellar</surname> <given-names>C</given-names></name><name><surname>Macrina</surname> <given-names>T</given-names></name><name><surname>Lu</surname> <given-names>R</given-names></name><name><surname>Lee</surname> <given-names>K</given-names></name><name><surname>Kemnitz</surname> <given-names>N</given-names></name><name><surname>Ih</surname> <given-names>D</given-names></name><name><surname>Castro</surname> <given-names>M</given-names></name><name><surname>Halageri</surname> <given-names>A</given-names></name><name><surname>Jordan</surname> <given-names>C</given-names></name><name><surname>Silversmith</surname> <given-names>W</given-names></name><name><surname>Wu</surname> <given-names>J</given-names></name><name><surname>Seung</surname> <given-names>HS</given-names></name><name><surname>Murthy</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The neural basis for a persistent internal state in <italic>Drosophila</italic> females</article-title><source>eLife</source><volume>9</volume><elocation-id>e59502</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.59502</pub-id><pub-id pub-id-type="pmid">33225998</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ding</surname> <given-names>Y</given-names></name><name><surname>Lillvis</surname> <given-names>JL</given-names></name><name><surname>Cande</surname> <given-names>J</given-names></name><name><surname>Berman</surname> <given-names>GJ</given-names></name><name><surname>Arthur</surname> <given-names>BJ</given-names></name><name><surname>Long</surname> <given-names>X</given-names></name><name><surname>Xu</surname> <given-names>M</given-names></name><name><surname>Dickson</surname> <given-names>BJ</given-names></name><name><surname>Stern</surname> <given-names>DL</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Neural evolution of Context-Dependent fly song</article-title><source>Current Biology</source><volume>29</volume><fpage>1089</fpage><lpage>1099</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2019.02.019</pub-id><pub-id pub-id-type="pmid">30880014</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duistermars</surname> <given-names>BJ</given-names></name><name><surname>Pfeiffer</surname> <given-names>BD</given-names></name><name><surname>Hoopfer</surname> <given-names>ED</given-names></name><name><surname>Anderson</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A brain module for scalable control of complex, Multi-motor threat displays</article-title><source>Neuron</source><volume>100</volume><fpage>1474</fpage><lpage>1490</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.10.027</pub-id><pub-id pub-id-type="pmid">30415997</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ellison</surname> <given-names>CK</given-names></name><name><surname>Wiley</surname> <given-names>C</given-names></name><name><surname>Shaw</surname> <given-names>KL</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The genetics of speciation: genes of small effect underlie sexual isolation in the hawaiian cricket Laupala</article-title><source>Journal of Evolutionary Biology</source><volume>24</volume><fpage>1110</fpage><lpage>1119</lpage><pub-id pub-id-type="doi">10.1111/j.1420-9101.2011.02244.x</pub-id><pub-id pub-id-type="pmid">21375646</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Felsenstein</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>Phylogenies and the comparative method</article-title><source>The American Naturalist</source><volume>125</volume><fpage>1</fpage><lpage>15</lpage><pub-id pub-id-type="doi">10.1086/284325</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Felsenstein</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Using the quantitative genetic threshold model for inferences between and within species</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>360</volume><fpage>1427</fpage><lpage>1434</lpage><pub-id pub-id-type="doi">10.1098/rstb.2005.1669</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gelman</surname> <given-names>A</given-names></name><name><surname>Rubin</surname> <given-names>DB</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Inference from iterative simulation using multiple sequences</article-title><source>Statistical Science</source><volume>7</volume><fpage>457</fpage><lpage>472</lpage><pub-id pub-id-type="doi">10.1214/ss/1177011136</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gleason</surname> <given-names>JM</given-names></name><name><surname>Ritchie</surname> <given-names>MG</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Do quantitative trait loci (QTL) for a courtship song difference between <italic>Drosophila simulans</italic> and <italic>D. sechellia</italic> coincide with candidate genes and intraspecific QTL?</article-title><source>Genetics</source><volume>166</volume><fpage>1303</fpage><lpage>1311</lpage><pub-id pub-id-type="doi">10.1534/genetics.166.3.1303</pub-id><pub-id pub-id-type="pmid">15082549</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Goodfellow</surname> <given-names>I</given-names></name><name><surname>Bengio</surname> <given-names>Y</given-names></name><name><surname>Courville</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><source>Deep Learning</source><publisher-loc>Cambridge, USA</publisher-loc><publisher-name>MIT press</publisher-name></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hadfield</surname> <given-names>JD</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>MCMC Methods for Multi-Response Generalized Linear Mixed Models: The MCMCglmm R Package</article-title><source>Journal of Statistical Software</source><volume>33</volume><fpage>1</fpage><lpage>22</lpage><pub-id pub-id-type="doi">10.18637/jss.v033.i02</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hadfield</surname> <given-names>JD</given-names></name><name><surname>Nakagawa</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>General quantitative genetic methods for comparative biology: phylogenies, taxonomies and multi-trait models for continuous and categorical characters</article-title><source>Journal of Evolutionary Biology</source><volume>23</volume><fpage>494</fpage><lpage>508</lpage><pub-id pub-id-type="doi">10.1111/j.1420-9101.2009.01915.x</pub-id><pub-id pub-id-type="pmid">20070460</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hansen</surname> <given-names>TF</given-names></name><name><surname>Martins</surname> <given-names>EP</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Translating between microevolutionary process and macroevolutionary patterns: the correlation structure of interspecific data</article-title><source>Evolution</source><volume>50</volume><fpage>1404</fpage><lpage>1417</lpage><pub-id pub-id-type="doi">10.1111/j.1558-5646.1996.tb03914.x</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoopfer</surname> <given-names>ED</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Neural control of aggression in <italic>Drosophila</italic></article-title><source>Current Opinion in Neurobiology</source><volume>38</volume><fpage>109</fpage><lpage>118</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2016.04.007</pub-id><pub-id pub-id-type="pmid">27179788</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname> <given-names>CK</given-names></name><name><surname>Hoekstra</surname> <given-names>HE</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Peromyscus burrowing: a model system for behavioral evolution</article-title><source>Seminars in Cell &amp; Developmental Biology</source><volume>61</volume><fpage>107</fpage><lpage>114</lpage><pub-id pub-id-type="doi">10.1016/j.semcdb.2016.08.001</pub-id><pub-id pub-id-type="pmid">27496333</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levine</surname> <given-names>M</given-names></name><name><surname>Davidson</surname> <given-names>EH</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Gene regulatory networks for development</article-title><source>PNAS</source><volume>102</volume><fpage>4936</fpage><lpage>4942</lpage><pub-id pub-id-type="doi">10.1073/pnas.0408031102</pub-id><pub-id pub-id-type="pmid">15788537</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ligon</surname> <given-names>RA</given-names></name><name><surname>Diaz</surname> <given-names>CD</given-names></name><name><surname>Morano</surname> <given-names>JL</given-names></name><name><surname>Troscianko</surname> <given-names>J</given-names></name><name><surname>Stevens</surname> <given-names>M</given-names></name><name><surname>Moskeland</surname> <given-names>A</given-names></name><name><surname>Laman</surname> <given-names>TG</given-names></name><name><surname>Scholes</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Evolution of correlated complexity in the radically different courtship signals of birds-of-paradise</article-title><source>PLOS Biology</source><volume>16</volume><elocation-id>e2006962</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.2006962</pub-id><pub-id pub-id-type="pmid">30457985</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lorenz</surname> <given-names>KZ</given-names></name></person-group><year iso-8601-date="1958">1958</year><article-title>The evolution of behavior</article-title><source>Scientific American</source><volume>199</volume><fpage>67</fpage><lpage>78</lpage><pub-id pub-id-type="doi">10.1038/scientificamerican1258-67</pub-id><pub-id pub-id-type="pmid">13615332</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Martins</surname> <given-names>EP</given-names></name></person-group><year iso-8601-date="1996">1996</year><source>Phylogenies and the Comparative Method in Animal Behavior</source><publisher-loc>Oxford</publisher-loc><publisher-name>Oxford University Press</publisher-name></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martins</surname> <given-names>EP</given-names></name><name><surname>Hansen</surname> <given-names>TF</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Phylogenies and the comparative method: a general approach to incorporating phylogenetic information into the analysis of interspecific data</article-title><source>The American Naturalist</source><volume>149</volume><fpage>646</fpage><lpage>667</lpage><pub-id pub-id-type="doi">10.1086/286013</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Massey</surname> <given-names>JH</given-names></name><name><surname>Chung</surname> <given-names>D</given-names></name><name><surname>Siwanowicz</surname> <given-names>I</given-names></name><name><surname>Stern</surname> <given-names>DL</given-names></name><name><surname>Wittkopp</surname> <given-names>PJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The <italic>yellow</italic> gene influences <italic>Drosophila</italic> male mating success through sex comb melanization</article-title><source>eLife</source><volume>8</volume><elocation-id>e49388</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.49388</pub-id><pub-id pub-id-type="pmid">31612860</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mathis</surname> <given-names>MW</given-names></name><name><surname>Mathis</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Deep learning tools for the measurement of animal behavior in neuroscience</article-title><source>Current Opinion in Neurobiology</source><volume>60</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2019.10.008</pub-id><pub-id pub-id-type="pmid">31791006</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meyer</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Topographic distance and watershed lines</article-title><source>Signal Processing</source><volume>38</volume><fpage>113</fpage><lpage>125</lpage><pub-id pub-id-type="doi">10.1016/0165-1684(94)90060-4</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Obbard</surname> <given-names>DJ</given-names></name><name><surname>Maclennan</surname> <given-names>J</given-names></name><name><surname>Kim</surname> <given-names>KW</given-names></name><name><surname>Rambaut</surname> <given-names>A</given-names></name><name><surname>O'Grady</surname> <given-names>PM</given-names></name><name><surname>Jiggins</surname> <given-names>FM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Estimating divergence dates and substitution rates in the <italic>Drosophila</italic> phylogeny</article-title><source>Molecular Biology and Evolution</source><volume>29</volume><fpage>3459</fpage><lpage>3473</lpage><pub-id pub-id-type="doi">10.1093/molbev/mss150</pub-id><pub-id pub-id-type="pmid">22683811</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O’Meara</surname> <given-names>BC</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Evolutionary inferences from phylogenies: a review of methods annual review of ecology</article-title><source>Evolution</source><volume>43</volume><fpage>267</fpage><lpage>285</lpage><pub-id pub-id-type="doi">10.1146/annurev-ecolsys-110411-160331</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pereira</surname> <given-names>TD</given-names></name><name><surname>Aldarondo</surname> <given-names>DE</given-names></name><name><surname>Willmore</surname> <given-names>L</given-names></name><name><surname>Kislin</surname> <given-names>M</given-names></name><name><surname>Wang</surname> <given-names>SS</given-names></name><name><surname>Murthy</surname> <given-names>M</given-names></name><name><surname>Shaevitz</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Fast animal pose estimation using deep neural networks</article-title><source>Nature Methods</source><volume>16</volume><fpage>117</fpage><lpage>125</lpage><pub-id pub-id-type="doi">10.1038/s41592-018-0234-5</pub-id><pub-id pub-id-type="pmid">30573820</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rand</surname> <given-names>WM</given-names></name></person-group><year iso-8601-date="1971">1971</year><article-title>Objective criteria for the evaluation of clustering methods</article-title><source>Journal of the American Statistical Association</source><volume>66</volume><fpage>846</fpage><lpage>850</lpage><pub-id pub-id-type="doi">10.1080/01621459.1971.10482356</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Royer-Carenzi</surname> <given-names>M</given-names></name><name><surname>Didier</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A comparison of ancestral state reconstruction methods for quantitative characters</article-title><source>Journal of Theoretical Biology</source><volume>404</volume><fpage>126</fpage><lpage>142</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2016.05.029</pub-id><pub-id pub-id-type="pmid">27234644</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seeds</surname> <given-names>AM</given-names></name><name><surname>Ravbar</surname> <given-names>P</given-names></name><name><surname>Chung</surname> <given-names>P</given-names></name><name><surname>Hampel</surname> <given-names>S</given-names></name><name><surname>Midgley</surname> <given-names>FM</given-names></name><name><surname>Mensh</surname> <given-names>BD</given-names></name><name><surname>Simpson</surname> <given-names>JH</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A suppression hierarchy among competing motor programs drives sequential grooming in <italic>Drosophila</italic></article-title><source>eLife</source><volume>3</volume><elocation-id>e02951</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.02951</pub-id><pub-id pub-id-type="pmid">25139955</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seetharam</surname> <given-names>AS</given-names></name><name><surname>Stuart</surname> <given-names>GW</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Whole genome phylogeny for 21 <italic>Drosophila</italic> species using predicted 2b-RAD fragments</article-title><source>PeerJ</source><volume>1</volume><elocation-id>e226</elocation-id><pub-id pub-id-type="doi">10.7717/peerj.226</pub-id><pub-id pub-id-type="pmid">24432193</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shaw</surname> <given-names>KL</given-names></name><name><surname>Lesnick</surname> <given-names>SC</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Genomic linkage of male song and female acoustic preference QTL underlying a rapid species radiation</article-title><source>PNAS</source><volume>106</volume><fpage>9737</fpage><lpage>9742</lpage><pub-id pub-id-type="doi">10.1073/pnas.0900229106</pub-id><pub-id pub-id-type="pmid">19487670</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shubin</surname> <given-names>N</given-names></name><name><surname>Tabin</surname> <given-names>C</given-names></name><name><surname>Carroll</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Deep homology and the origins of evolutionary novelty</article-title><source>Nature</source><volume>457</volume><fpage>818</fpage><lpage>823</lpage><pub-id pub-id-type="doi">10.1038/nature07891</pub-id><pub-id pub-id-type="pmid">19212399</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Slonim</surname> <given-names>N</given-names></name><name><surname>Atwal</surname> <given-names>GS</given-names></name><name><surname>Tkacik</surname> <given-names>G</given-names></name><name><surname>Bialek</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Information-based clustering</article-title><source>PNAS</source><volume>102</volume><fpage>18297</fpage><lpage>18302</lpage><pub-id pub-id-type="doi">10.1073/pnas.0507432102</pub-id><pub-id pub-id-type="pmid">16352721</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spiegelhalter</surname> <given-names>DJ</given-names></name><name><surname>Best</surname> <given-names>NG</given-names></name><name><surname>Carlin</surname> <given-names>BP</given-names></name><name><surname>van der Linde</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Bayesian measures of model complexity and fit</article-title><source>Journal of the Royal Statistical Society: Series B</source><volume>64</volume><fpage>583</fpage><lpage>639</lpage><pub-id pub-id-type="doi">10.1111/1467-9868.00353</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stern</surname> <given-names>DL</given-names></name><name><surname>Crocker</surname> <given-names>J</given-names></name><name><surname>Ding</surname> <given-names>Y</given-names></name><name><surname>Frankel</surname> <given-names>N</given-names></name><name><surname>Kappes</surname> <given-names>G</given-names></name><name><surname>Kim</surname> <given-names>E</given-names></name><name><surname>Kuzmickas</surname> <given-names>R</given-names></name><name><surname>Lemire</surname> <given-names>A</given-names></name><name><surname>Mast</surname> <given-names>JD</given-names></name><name><surname>Picard</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Genetic and transgenic reagents for <italic>Drosophila simulans</italic>, <italic>D. mauritiana</italic>, <italic>D. yakuba</italic>, <italic>D. santomea</italic>, and <italic>D. virilis</italic></article-title><source>G3: Genes, Genomes, Genetics</source><volume>7</volume><fpage>1339</fpage><lpage>1347</lpage><pub-id pub-id-type="doi">10.1534/g3.116.038885</pub-id><pub-id pub-id-type="pmid">28280212</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stern</surname> <given-names>DL</given-names></name><name><surname>Frankel</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The structure and evolution of <italic>Cis</italic> -regulatory regions: the <italic>shavenbaby</italic> story</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>368</volume><elocation-id>0028</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2013.0028</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Strouse</surname> <given-names>DJ</given-names></name><name><surname>Schwab</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The deterministic information bottleneck</article-title><source>Neural Computation</source><volume>29</volume><fpage>1611</fpage><lpage>1630</lpage><pub-id pub-id-type="doi">10.1162/NECO_a_00961</pub-id><pub-id pub-id-type="pmid">28410050</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tajima</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Simple methods for testing the molecular evolutionary clock hypothesis</article-title><source>Genetics</source><volume>135</volume><fpage>599</fpage><lpage>607</lpage><pub-id pub-id-type="doi">10.1093/genetics/135.2.599</pub-id><pub-id pub-id-type="pmid">8244016</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Tinbergen</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="1951">1951</year><source>The Study of Instinct</source><publisher-loc>Oxford</publisher-loc><publisher-name>Oxford University Press</publisher-name></element-citation></ref><ref id="bib58"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Tishby</surname> <given-names>N</given-names></name><name><surname>Pereira</surname> <given-names>FC</given-names></name><name><surname>Bialek</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>The information bottleneck method</article-title><conf-name>Proceedings of the 37th Annual Allerton Conference on Communication, Control and Computing Urbana-Champaign</conf-name><fpage>368</fpage><lpage>377</lpage></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Maaten</surname> <given-names>L</given-names></name><name><surname>Hinton</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Visualizing data using t-SNE</article-title><source>Journal of Machine Learning Research</source><volume>9</volume><fpage>2579</fpage><lpage>2605</lpage></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weber</surname> <given-names>JN</given-names></name><name><surname>Peterson</surname> <given-names>BK</given-names></name><name><surname>Hoekstra</surname> <given-names>HE</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Discrete genetic modules are responsible for complex burrow evolution in Peromyscus mice</article-title><source>Nature</source><volume>493</volume><fpage>402</fpage><lpage>405</lpage><pub-id pub-id-type="doi">10.1038/nature11816</pub-id><pub-id pub-id-type="pmid">23325221</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>West-Eberhard</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2003">2003</year><source>Developmental Plasticity and Evolution</source><publisher-loc>Oxford</publisher-loc><publisher-name>Oxford University Press</publisher-name></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Williams</surname> <given-names>TM</given-names></name><name><surname>Carroll</surname> <given-names>SB</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Genetic and molecular insights into the development and evolution of sexual dimorphism</article-title><source>Nature Reviews Genetics</source><volume>10</volume><fpage>797</fpage><lpage>804</lpage><pub-id pub-id-type="doi">10.1038/nrg2687</pub-id><pub-id pub-id-type="pmid">19834484</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yamamoto</surname> <given-names>D</given-names></name><name><surname>Ishikawa</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Genetic and neural bases for species-specific behavior in <italic>Drosophila</italic> species</article-title><source>Journal of Neurogenetics</source><volume>27</volume><fpage>130</fpage><lpage>142</lpage><pub-id pub-id-type="doi">10.3109/01677063.2013.800060</pub-id><pub-id pub-id-type="pmid">23806054</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Yang</surname> <given-names>Z</given-names></name></person-group><year iso-8601-date="2006">2006</year><source>Computational Molecular Evolution</source><publisher-loc>Oxford</publisher-loc><publisher-name>Oxford University Press</publisher-name></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.61806.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Goldberg</surname><given-names>Jesse H</given-names></name><role>Reviewing Editor</role><aff><institution>Cornell University</institution><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Couzin</surname><given-names>Iain D</given-names></name><role>Reviewer</role><aff><institution>Max Planck Institute of Animal Behavior</institution><country>Germany</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>Different animal species exhibit distinct behavioral repertoires, even in cases where common ancestors are relatively recent. How do repertoires acquire species-specificity during evolution? This manuscript provides new methods to examine behavioral patterns of different <italic>Drosophila</italic> species, and even to reconstruct potentially ancestral behavioral modes. Consistent with past work, the authors find that behaviors are inherited in clusters. Overall, this stimulating paper presents an exciting method for the unbiased study of behavioral evolution based on large datasets that are increasingly common in animal behavior, which differs from previous work focusing on specific traits.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;A framework for studying behavioral evolution by reconstructing ancestral repertoires&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation has been overseen by Christian Rutz as the Senior Editor. The following individual involved in the review of your submission has agreed to reveal their identity: Iain D Couzin (Reviewer #2).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>As the editors have judged that your manuscript is of interest, but as described below that additional experiments are required before it is published, we would like to draw your attention to changes in our revision policy that we have made in response to COVID-19 (https://elifesciences.org/articles/57162). First, because many researchers have temporarily lost access to labs, we will give authors as much time as they need to submit revised manuscripts. We are also offering, if you choose, to post the manuscript to bioRxiv (if it is not already there) along with this decision letter and a formal designation that the manuscript is “in revision at eLife”. Please let us know if you would like to pursue this option. (If your work is more suitable for medRxiv, you will need to post the preprint yourself, as the mechanisms for us to do so are still in development.)</p><p>Summary:</p><p>In this paper, the authors build upon their previous (ground-breaking) work in which automated methodology was employed to quantify the structure of behaviour and its regulation in fruit flies. Specifically, here, they address whether such methodology can be insightful in the study of how behaviour evolves, again using fruit flies as convenient and powerful model species (their phylogenetic relationships are well-understood, they do well in the lab, and it has been previously shown how well the behaviour of these species can be decomposed using automated methodology). There are a host of reasons why such an analysis is of value, not least because revealing the hidden structure of behavioural regulation has the potential to be informative regarding ancestral behavioural repertoires, and thus how it evolves. Overall, there is consensus that this is a thought-provoking paper that provides a valuable starting point in the analysis of behavioural evolution via detailed quantitative ethology. With added consideration of the factors discussed below this work makes a very helpful and novel contribution.</p><p>Essential revisions:</p><p>1. Consider behavioural transitions</p><p>All three reviewers were confused as to why transitions between states were not considered. Given that the authors have previously shown their capacity to reconstruct the hierarchical nested structure of behavioural states, typically represented as a network with transition probabilities between states, which would seemingly be extremely informative about the evolution of behavioural modules, all reviewers were left wondering why they did not consider comparisons of these networks -- especially given the array of network analysis tools available. Organisms, as they are well aware, don't just jump randomly from one behaviour to another, but there is a hierarchical organisation by which one behaviour influences the probability that another is elicited, and so on. Why did the authors not do this? There may be very good reasons, but it will be important for the reader to be informed. This would seem to be the most direct way to address how behaviour is structured. It is not clear to the reviewers exactly how much extra work this would be -- or how the scope of the paper would be required to change if transitions were considered. Thus, while formal inclusion of transitions into the framework is strongly preferred for revision, it is not absolutely required. At the minimum, the authors need to clarify exactly why transitions were not considered as well as what may be gained from such an approach in future work.</p><p>2. Confirm utility of the approach, its discoveries, and how it compares to more focused inquiries into the evolution of behaviour</p><p>The work suffers from a lack of clarity over why/how the method is superior to the focused trait approach. The fact that behaviours co-evolve in suites is by itself not especially novel. The authors should bring to the forefront, if possible, exactly how and why this approach is superior to others. Ultimately, the paper is an argument for the utility of studying repertoires rather than specific behaviours. The main thrust the paper tries to make is that we learn something new by looking at the evolution of repertoires of behaviour rather than focused analyses of specific behaviours (really they are looking at time budgets and perhaps that's a bit of a disconnect from their message as well). But they put forth in Figure 3 a reconstruction that seems to generate a nonsense behavioural repertoire for the ancestral species. So the authors should address the validity of using the specific phylogenetic methods to reconstruct behaviours based on the repertoires. They can address this point in two ways:</p><p>2.1. Generate simulations of repertoire evolution on the known <italic>Drosophila</italic> phylogeny and then take the endpoint repertoires they have evolved and assess how well the reconstruction of the known ancestral state works. People do these sorts of studies regularly to assess phylogenetic reconstruction approaches and methods (e.g., Royer-Carenzi and Didier 2016, J. Theoretical Biol.). This might be done with a real or arbitrary repertoire as the starting point for the simulation. This is crucial since it appears the rest of their findings hinge on the ancestral reconstruction.</p><p>2.2. As a complement to 2.1, the authors might assess the reconstruction of the repertoires in comparison to ancestral trait reconstructions for specific behavioural traits that might be more conventionally measured, assuming this can be extracted from the existing data. Part of the argument the authors make is that by considering the repertoire we achieve a more complete understanding of behavioral evolution. The approach seems very promising, though it is difficult to assess how it compares to other approaches for measuring behaviour. However good or bad the reconstructions of ancestral behaviours are for the repertoires, how do they compare to a focused trait approach? Perhaps better? Perhaps worse? Unless a comparison is done it's hard to say. More broadly, the paper argues for the utility of this approach to studying behaviour but it is not clear how it compares to analyses that focus on specific elements of behaviour rather than time budget vectors.</p><p>3. Make the paper more accessible for a general audience</p><p>A major issue with this paper was its inaccessibility, which could, unfortunately, ultimately reduce its impact. Most readers are by now familiar with past work using clustering methods (e.g., Cande et al., 2018; Berman et al., 2014) -- but many of the analyses in this paper are novel, difficult to penetrate, and poorly introduced for a general audience. The authors should take a fine-grained comb to this paper to make each analysis as accessible as possible. Simple fixes could include more plain language around what each analysis is testing/achieving, as well as consistency in terminology. Specifically, the final sentence of each paragraph could state in plain terms what the preceding analysis has just demonstrated, ruled-in, or ruled out.</p><p>[Editors' note: further revisions were suggested prior to acceptance, as described below.]</p><p>Thank you for submitting your article &quot;A framework for studying behavioral evolution by reconstructing ancestral repertoires&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, including Jesse H Goldberg as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by Christian Rutz as the Senior Editor. The following individual involved in the review of your submission has agreed to reveal their identity: Iain D Couzin (Reviewer #2).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this decision letter to help you prepare a revised submission.</p><p>Please address continued concerns from Reviewer #3, and please attempt to clarify key sections of the text as recommended by Reviewer #1.</p><p>1) Reviewer #3: The paper has improved in many respects but the revision failed to deal with what I see as the most glaring issue (and which I had raised in my previous review).</p><p>All the extant species show biases in behaviors as shown by the hotter/browner colors in their behavioral maps. This suggests that we should expect that any species of <italic>Drosophila</italic>, extant or extinct, would be highly likely to have biases behaviors as well. However, the ancestrally reconstructed behavioral repertoire is totally washed out – there is no clear biases in behavior in the ancestral graph that is estimated in figure 3. This suggests to me that the method potentially has flaws.</p><p>I had suggested that the authors start with a PDF from one of their species and then simulate its evolution along the known <italic>Drosophila</italic> phylogeny and then try to reconstruct that repertoire using ancestral state reconstruction. If that process ends up showing a similarly 'flat' PDF where everything is similarly low probability (i.e. a totally blue PDF as shown in figure 3) then there is some cause for concern. If it were to retrieve a PDF similar in structure to the one that initiated the simulation, then that would be very reassuring.</p><p>The author responses seem to say that is what they have done in using the MCMC method but where the ancestral reconstruction analysis of a simulated evolutionary trajectory is to be found in the paper is unclear to me. I searched 'simulat' in the text of the manuscript and cannot see where trait evolution was simulated and then used as the starting values to try to evaluate how closely the ancestral reconstruction gets to the known ancestral starting point.</p><p>There is a lot in this paper, so though I feel this issue is important to address, does not necessarily preclude it from being published in my view. Though I would like to see the authors address the 'flatness' and thus seemingly unrealistic (it would seem to me at least) ancestral state that they present in figure 3.</p><p>2) Reviewer #1: The writing is slightly improved, though some sections could still be improved by concluding paragraphs not just with a mathematical result but also what it means in plain terms. E.g. Lines 264-7 conclude with the finding that the covariance matrix has a 'far from random modular structure;' this does not explain how this result relates to the title of the section (Individual Variability and long timescale correlations).</p><p>3) Please note that <italic>eLife</italic> has recently adopted the STRANGE guidelines for animal behaviour research:</p><p>https://doi.org/<ext-link ext-link-type="uri" xlink:href="http://discovere.emory.edu/openurl/01emory/01EMORY_services_page?url_ver=Z39.88-2004&amp;rft_val_fmt=info:ofi/fmt:kev:mtx:journal&amp;__char_set=utf8&amp;rft_id=info:doi/10.1038/d41586-020-01751-5&amp;rfr_id=info:sid/LibX&amp;rft.genre=article">10.1038/d41586-020-01751-5</ext-link></p><p>https://reviewer.elifesciences.org/author-guide/journal-policies</p><p>In your revisions, please consider scope for sampling biases in your study and how these may limit the generalisability of your findings, and make declarations as necessary. A few sentences in the section &quot;Data collection&quot; (lines 462-470) may suffice.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.61806.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1. Consider behavioural transitions</p><p>All three reviewers were confused as to why transitions between states were not considered. Given that the authors have previously shown their capacity to reconstruct the hierarchical nested structure of behavioural states, typically represented as a network with transition probabilities between states, which would seemingly be extremely informative about the evolution of behavioural modules, all reviewers were left wondering why they did not consider comparisons of these networks -- especially given the array of network analysis tools available. Organisms, as they are well aware, don't just jump randomly from one behaviour to another, but there is a hierarchical organisation by which one behaviour influences the probability that another is elicited, and so on. Why did the authors not do this? There may be very good reasons, but it will be important for the reader to be informed. This would seem to be the most direct way to address how behaviour is structured. It is not clear to the reviewers exactly how much extra work this would be -- or how the scope of the paper would be required to change if transitions were considered. Thus, while formal inclusion of transitions into the framework is strongly preferred for revision, it is not absolutely required. At the minimum, the authors need to clarify exactly why transitions were not considered as well as what may be gained from such an approach in future work.</p></disp-quote><p>We agree that studying the evolution of the transition structure between behaviors is an important subject, and we are currently developing methods to study it. The primary difficulty here is the number of parameters involved. Because we are fitting two covariance matrices and an ancestral mean, we need to fit at least (<italic>N</italic> + 1) ∗<italic>N</italic> + <italic>N</italic> parameters, where <italic>N</italic> is the number of traits being reconstructed. Currently, we study a system that has <italic>N</italic> = 134 traits, leading to 18,224 parameters that we must fit with the GLMM. If we were to add the transition probabilities (or transition rates), this would require another ≈<italic>N</italic><sup>2</sup> parameters. Thus, instead of fitting a system with ≈ 18,000 parameters, our model would now have 327,284,280 parameters. While we would likely be able to perform the computation, we would be unlikely to believe the results at this point because our data set size is insufficient (the amount of time needed to accurately sample a transition matrix is a power of two longer than the amount of time needed to accurately sample the behavioral frequencies).</p><p>In addition, these traits (the transition matrix values) have different units than the behaviors, and the transition probabilities mathematically depend on the behavioral frequencies, since the first eigenvalue of the transition matrix is (by definition) proportional to the average behavioral frequency usage. Thus, it becomes necessary to add additional regularizing or normalizing factors, further complicating the analysis in a manner that is beyond the scope of what we aimed to demonstrate here.</p><p>Despite these difficulties, although transitions are not included in our actual model, one of the main points that we have highlighted is the similarity between the hierarchical structure that explains long timescale transitions, which we demonstrated previously, and the variability we observe here between individuals of the same species.</p><p>Again, though, this is a problem that we find extremely interesting, and we are actively working on exploring how to solve these technical and representational questions. We had some text describing this as a future direction in our Discussion section, but we have now expanded this section to further point out the importance of this question and some of the current technical challenges surrounding the study of the evolution of behavioral transitions (lines 428-441).</p><disp-quote content-type="editor-comment"><p>2. Confirm utility of the approach, its discoveries, and how it compares to more focused inquiries into the evolution of behaviour</p><p>The work suffers from a lack of clarity over why/how the method is superior to the focused trait approach. The fact that behaviours co-evolve in suites is by itself not especially novel. The authors should bring to the forefront, if possible, exactly how and why this approach is superior to others. Ultimately, the paper is an argument for the utility of studying repertoires rather than specific behaviours. The main thrust the paper tries to make is that we learn something new by looking at the evolution of repertoires of behaviour rather than focused analyses of specific behaviours (really they are looking at time budgets and perhaps that's a bit of a disconnect from their message as well). But they put forth in Figure 3 a reconstruction that seems to generate a nonsense behavioural repertoire for the ancestral species. So the authors should address the validity of using the specific phylogenetic methods to reconstruct behaviours based on the repertoires. They can address this point in two ways:</p><p>2.1. Generate simulations of repertoire evolution on the known <italic>Drosophila</italic> phylogeny and then take the endpoint repertoires they have evolved and assess how well the reconstruction of the known ancestral state works. People do these sorts of studies regularly to assess phylogenetic reconstruction approaches and methods (e.g., Royer-Carenzi and Didier 2016, J. Theoretical Biol.). This might be done with a real or arbitrary repertoire as the starting point for the simulation. This is crucial since it appears the rest of their findings hinge on the ancestral reconstruction.</p></disp-quote><p>This process is precisely what we are doing with our MCMC method (which was originally developed by Hadfield, as cited in the text). Specifically, given a known tree structure, we select a common ancestral mean behavior and two behavioral covariance matrix such that the likelihood of observing the measured behavioral distribution (including the covariances between the behaviors) is maximized. In addition to showing that our model has converged (Figure 3, Supplement 1), we also show that the predicted behavioral means at the endpoint species match the data (Figure 3, Supplement 2).</p><disp-quote content-type="editor-comment"><p>2.2. As a complement to 2.1, the authors might assess the reconstruction of the repertoires in comparison to ancestral trait reconstructions for specific behavioural traits that might be more conventionally measured, assuming this can be extracted from the existing data. Part of the argument the authors make is that by considering the repertoire we achieve a more complete understanding of behavioral evolution. The approach seems very promising, though it is difficult to assess how it compares to other approaches for measuring behaviour. However good or bad the reconstructions of ancestral behaviours are for the repertoires, how do they compare to a focused trait approach? Perhaps better? Perhaps worse? Unless a comparison is done it's hard to say. More broadly, the paper argues for the utility of this approach to studying behaviour but it is not clear how it compares to analyses that focus on specific elements of behaviour rather than time budget vectors.</p></disp-quote><p>To address these points, we have added an extra section in the main text, as well as in Materials and methods, that shows a comparison between our model and a simpler model where behaviors evolve independently (lines 214-229 and 491-524, as well as Figure 3, Supplement 3). In order to compare the performance of models with different complexity, we need a measure that not only takes into account how well the data is fit (i.e., maximizes likelihood), but that also penalizes the addition of extra parameters in more complex models (in this case, the off-diagonal terms of the two behavioral covariance matrices). For hierarchical models fit using MCMC methods (such as ours), the deviance information criterion (DIC) is the standard approach for model selection (Spiegelhalter et al., 2002). The DIC is a generalization of the Akaike criterion (see Materials and methods for additional details), and it is proportional to the negative log-likelihood evaluated at the mean of the posterior parameters, plus a penalty term proportional to the effective number of parameters in the model. The values of DIC for our model are much smaller than the models with a focused analysis, indicating that modeling covariance between behaviors explains the observed data much better than treating all behaviors independently. The implications of this result have been further expanded and discussed in the text, and we thank the reviewers for suggesting this validations approach.</p><disp-quote content-type="editor-comment"><p>3. Make the paper more accessible for a general audience</p><p>A major issue with this paper was its inaccessibility, which could, unfortunately, ultimately reduce its impact. Most readers are by now familiar with past work using clustering methods (e.g., Cande et al., 2018; Berman et al., 2014) -- but many of the analyses in this paper are novel, difficult to penetrate, and poorly introduced for a general audience. The authors should take a fine-grained comb to this paper to make each analysis as accessible as possible. Simple fixes could include more plain language around what each analysis is testing/achieving, as well as consistency in terminology. Specifically, the final sentence of each paragraph could state in plain terms what the preceding analysis has just demonstrated, ruled-in, or ruled out.</p></disp-quote><p>We agree with the reviewers that many aspects of the original manuscript text could have benefited from additional prose explaining the rationale and conclusions of the analysis. Following these comments, we have now included many additional clarifying comments to make the text more accessible.</p><p>[Editors' note: further revisions were suggested prior to acceptance, as described below.]</p><disp-quote content-type="editor-comment"><p>Please address continued concerns from Reviewer #3, and please attempt to clarify key sections of the text as recommended by Reviewer #1.</p><p>(1) Reviewer #3: The paper has improved in many respects but the revision failed to deal with what I see as the most glaring issue (and which I had raised in my previous review).</p><p>All the extant species show biases in behaviors as shown by the hotter/browner colors in their behavioral maps. This suggests that we should expect that any species of <italic>Drosophila</italic>, extant or extinct, would be highly likely to have biases behaviors as well. However, the ancestrally reconstructed behavioral repertoire is totally washed out – there is no clear biases in behavior in the ancestral graph that is estimated in figure 3. This suggests to me that the method potentially has flaws.</p><p>I had suggested that the authors start with a PDF from one of their species and then simulate its evolution along the known <italic>Drosophila</italic> phylogeny and then try to reconstruct that repertoire using ancestral state reconstruction. If that process ends up showing a similarly 'flat' PDF where everything is similarly low probability (i.e. a totally blue PDF as shown in figure 3) then there is some cause for concern. If it were to retrieve a PDF similar in structure to the one that initiated the simulation, then that would be very reassuring.</p><p>The author responses seem to say that is what they have done in using the MCMC method but where the ancestral reconstruction analysis of a simulated evolutionary trajectory is to be found in the paper is unclear to me. I searched 'simulat' in the text of the manuscript and cannot see where trait evolution was simulated and then used as the starting values to try to evaluate how closely the ancestral reconstruction gets to the known ancestral starting point.</p><p>There is a lot in this paper, so though I feel this issue is important to address, does not necessarily preclude it from being published in my view. Though I would like to see the authors address the 'flatness' and thus seemingly unrealistic (it would seem to me at least) ancestral state that they present in figure 3.</p></disp-quote><p>We agree that the way in which we presented Figure 3 provides the impression that the ancestral repertoire is “washed out.” This is an effect of the way in which we plotted our data, and we thank the reviewer for pointing out this less-than-ideal visualization. The new version of the figure shows the ancestral distribution in non-logarithmic values, showing that there is indeed structure in this repertoire. We agree that it would be worrying if the distribution was indeed flat, but as can be seen, this isn’t the case here. All of the brown/hotter colors in the subsequent repertoires to the right are differences of the logs, which better shows the behavioral alterations along the phylogeny, as they are often subtle.</p><p>As to the proposed simulation, due to the reviewer’s excellent suggestion in the previous round of reviews, we added Figure 3—figure supplement 2, which shows that starting from the inferred ancestral state, the model’s mean predictions are in agreement with the data, providing a good double-check of our model’s self-consistency. In other words, when starting from the endpoints, we reconstruct the ancestral state (this is how the model is fit in the first place), and starting from the fit ancestral state, the model predicts, on average, the correct endpoint states. In addition, Figure 3 Figure supplement 3 (also emerging from the reviewers’ suggestions), shows that the model predicts the behavioral covariances well. We did not need to do simulations, per se, to show these results, since these values can be directly numerically calculated from the model (hence the lack of the word ’simulation’ connected to these efforts in the manuscript).</p><disp-quote content-type="editor-comment"><p>(2) Reviewer #1: The writing is slightly improved, though some sections could still be improved by concluding paragraphs not just with a mathematical result but also what it means in plain terms. E.g. Lines 264-7 conclude with the finding that the covariance matrix has a 'far from random modular structure;' this does not explain how this result relates to the title of the section (Individual Variability and long timescale correlations).</p></disp-quote><p>We thank the reviewer for their comments, and we have adapted several passages in the text to increase the clarity of our methodology and to make connections between the mathematical results and the according biological significance (see the latex-diff document for all changes).</p><disp-quote content-type="editor-comment"><p>(3) Please note that eLife has recently adopted the STRANGE guidelines for animal behaviour research:</p><p>https://doi.org/<ext-link ext-link-type="uri" xlink:href="http://discovere.emory.edu/openurl/01emory/01EMORY_services_page?url_ver=Z39.88-2004&amp;rft_val_fmt=info:ofi/fmt:kev:mtx:journal&amp;__char_set=utf8&amp;rft_id=info:doi/10.1038/d41586-020-01751-5&amp;rfr_id=info:sid/LibX&amp;rft.genre=article">10.1038/d41586-020-01751-5</ext-link></p><p>https://reviewer.elifesciences.org/author-guide/journal-policies</p><p>In your revisions, please consider scope for sampling biases in your study and how these may limit the generalisability of your findings, and make declarations as necessary. A few sentences in the section &quot;Data collection&quot; (lines 462-470) may suffice.</p></disp-quote><p>We thank the reviewers for pointing this out (even as an <italic>eLife</italic> reviewing editor, GJB was embarrassingly unaware of these guidelines). Although detailed information about how the flies were handled/housed was previously published in Cande et al., <italic>eLife</italic>, 2018 (and was pointed to accordingly via a citation), we added relevant details here to the Materials and methods section to make the manuscript more self-contained and to make our experimental details more clear.</p><p>As to sampling biases, we have provided a detailed list of the specific strains used in our experimental – all of which are readily available through the UCSD or Bloomington fly stocks. While we have no evidence that our precise choice of species/strains within the <italic>D. melanogaster</italic> species subgroup should generate bias, we do acknowledge in the Discussion section that our phylogentic reconstruction is likely under-constrained, and that adding more species/strains will “place more constraints on the evolutionary dynamics, likely resulting in less variance in the ancestral state estimations and potentially adding more structure to the relatively low rank (i.e., highly modular) covariance matrices. Additionally, further work is required to determine the balance between sampling within and between strains and species that optimizes estimates of evolutionary dynamics.”</p></body></sub-article></article>