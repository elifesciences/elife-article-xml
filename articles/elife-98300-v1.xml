<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">98300</article-id><article-id pub-id-type="doi">10.7554/eLife.98300</article-id><article-id pub-id-type="doi" specific-use="version">10.7554/eLife.98300.3</article-id><article-version article-version-type="publication-state">version of record</article-version><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Microbiology and Infectious Disease</subject></subj-group></article-categories><title-group><article-title>Benchmarking reveals superiority of deep learning variant callers on bacterial nanopore sequence data</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><name><surname>Hall</surname><given-names>Michael B</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3683-6208</contrib-id><email>michael.hall2@unimelb.edu.au</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Wick</surname><given-names>Ryan R</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8349-0778</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Judd</surname><given-names>Louise M</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3613-4839</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Nguyen</surname><given-names>An N</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4893-6636</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Steinig</surname><given-names>Eike J</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Xie</surname><given-names>Ouli</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5032-1932</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Davies</surname><given-names>Mark</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Seemann</surname><given-names>Torsten</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Stinear</surname><given-names>Timothy P</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0150-123X</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Coin</surname><given-names>Lachlan</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4300-455X</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con10"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01ej9dk98</institution-id><institution>Department of Microbiology and Immunology, The University of Melbourne, at the Peter Doherty Institute for Infection and Immunity</institution></institution-wrap><addr-line><named-content content-type="city">Melbourne</named-content></addr-line><country>Australia</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01ej9dk98</institution-id><institution>Centre for Pathogen Genomics, The University of Melbourne</institution></institution-wrap><addr-line><named-content content-type="city">Melbourne</named-content></addr-line><country>Australia</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01ej9dk98</institution-id><institution>Department of Infectious Diseases, The University of Melbourne, at the Peter Doherty Institute for Infection and Immunity</institution></institution-wrap><addr-line><named-content content-type="city">Melbourne</named-content></addr-line><country>Australia</country></aff><aff id="aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02t1bej08</institution-id><institution>Monash Infectious Diseases, Monash Health</institution></institution-wrap><addr-line><named-content content-type="city">Melbourne</named-content></addr-line><country>Australia</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Weigel</surname><given-names>Detlef</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0243gzr89</institution-id><institution>Max Planck Institute for Biology Tübingen</institution></institution-wrap><country>Germany</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Weigel</surname><given-names>Detlef</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0243gzr89</institution-id><institution>Max Planck Institute for Biology Tübingen</institution></institution-wrap><country>Germany</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date publication-format="electronic" date-type="publication"><day>10</day><month>10</month><year>2024</year></pub-date><volume>13</volume><elocation-id>RP98300</elocation-id><history><date date-type="sent-for-review" iso-8601-date="2024-03-29"><day>29</day><month>03</month><year>2024</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint.</event-desc><date date-type="preprint" iso-8601-date="2024-03-28"><day>28</day><month>03</month><year>2024</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2024.03.15.585313"/></event><event><event-desc>This manuscript was published as a reviewed preprint.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-05-20"><day>20</day><month>05</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.98300.1"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-09-05"><day>05</day><month>09</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.98300.2"/></event></pub-history><permissions><copyright-statement>© 2024, Hall et al</copyright-statement><copyright-year>2024</copyright-year><copyright-holder>Hall et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-98300-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-98300-figures-v1.pdf"/><abstract><p>Variant calling is fundamental in bacterial genomics, underpinning the identification of disease transmission clusters, the construction of phylogenetic trees, and antimicrobial resistance detection. This study presents a comprehensive benchmarking of variant calling accuracy in bacterial genomes using Oxford Nanopore Technologies (ONT) sequencing data. We evaluated three ONT basecalling models and both simplex (single-strand) and duplex (dual-strand) read types across 14 diverse bacterial species. Our findings reveal that deep learning-based variant callers, particularly Clair3 and DeepVariant, significantly outperform traditional methods and even exceed the accuracy of Illumina sequencing, especially when applied to ONT’s super-high accuracy model. ONT’s superior performance is attributed to its ability to overcome Illumina’s errors, which often arise from difficulties in aligning reads in repetitive and variant-dense genomic regions. Moreover, the use of high-performing variant callers with ONT’s super-high accuracy data mitigates ONT’s traditional errors in homopolymers. We also investigated the impact of read depth on variant calling, demonstrating that 10× depth of ONT super-accuracy data can achieve precision and recall comparable to, or better than, full-depth Illumina sequencing. These results underscore the potential of ONT sequencing, combined with advanced variant calling algorithms, to replace traditional short-read sequencing methods in bacterial genomics, particularly in resource-limited settings.</p></abstract><abstract abstract-type="plain-language-summary"><title>eLife digest</title><p>Imagine being part of a public health institution when, suddenly, cases of <italic>Salmonella</italic> surge across your country. You are facing an outbreak of this foodborne disease, and the clock is ticking. People are consuming a contaminated product that is making them sick; how do you identify related cases, track the source of the infection, and shut down its production?</p><p>In situations like these, scientists need to tell apart even closely related strains of the same bacterial species. This process, known as variant calling, relies on first analysing (or ‘sequencing’) the genetic information obtained from the bacteria of interest, then comparing it to a reference genome.</p><p>Currently, two main approaches are available for genome sequencing. Traditional ‘short-read’ technologies tend to be more accurate but less reliable when covering certain types of genomic regions. New ‘long-read’ approaches can bypass these limitations though they have historically been less accurate.</p><p>Comparison with a reference genome can be performed using a tool known as a variant caller. Many of the most effective ones are now based on artificial intelligence approaches such as deep learning. However, these have primarily been applied to human genomic data so far; it therefore remains unclear whether they are equally useful for bacterial genomes.</p><p>In response, Hall et al. set out to investigate the accuracy of four deep learning-based and three traditional variant callers on datasets from 14 bacterial species obtained via long-read approaches. Their respective performance was also benchmarked against a more conventional approach representing a standard of accuracy (that is, a popular, non-deep learning variant caller used on short-read datasets). These analyses were performed on a ‘truthset’ established by Hall et al., a collection of validated data that allowed them to assess the performance of the various tools tested.</p><p>The results show that, in this context, the deep learning variant callers more accurately detected genetic variations compared to the traditional approach. These tools, which could be run on standard laptops, were effective even with low amounts of sequencing data – making them useful even in settings where resources are limited.</p><p>Variant calling is an essential step in tracking the emergence and spread of disease, identifying new strains of bacteria, and examining their evolution. The findings by Hall et al. should therefore benefit various sectors, particularly clinical and public health laboratories.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>bioinformatics</kwd><kwd>variant calling</kwd><kwd>bacteria</kwd><kwd>benchmark</kwd><kwd>nanopore</kwd><kwd>deep learning</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>E. coli</italic></kwd><kwd><italic>S. pyogenes</italic></kwd><kwd><italic>M. tuberculosis</italic></kwd><kwd><italic>K. pneumoniae</italic></kwd><kwd><italic>S. enterica</italic></kwd><kwd><italic>S. aureus</italic></kwd><kwd><italic>L. monocytogenes</italic></kwd><kwd><italic>C. jejuni</italic></kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000925</institution-id><institution>National Health and Medical Research Council</institution></institution-wrap></funding-source><award-id>FSPGN000045</award-id><principal-award-recipient><name><surname>Hall</surname><given-names>Michael B</given-names></name><name><surname>Steinig</surname><given-names>Eike J</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Nanopore sequencing effectively resolves key challenges in bacterial small variant detection, providing a more accurate alternative to traditional sequencing methods.</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>publishing-route</meta-name><meta-value>prc</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Variant calling is a cornerstone of bacterial genomics as well as one of the major applications of next-generation sequencing. Its downstream applications include identification of disease transmission clusters, prediction of antimicrobial resistance, and phylogenetic tree construction and subsequent evolutionary analyses, to name a few (<xref ref-type="bibr" rid="bib48">Stimson et al., 2019</xref>; <xref ref-type="bibr" rid="bib45">Sheka et al., 2021</xref>; <xref ref-type="bibr" rid="bib54">Walker et al., 2022</xref>; <xref ref-type="bibr" rid="bib2">Bertels et al., 2014</xref>). Variant calling is used extensively in public health laboratories to inform decisions on managing bacterial outbreaks (<xref ref-type="bibr" rid="bib14">Gorrie et al., 2021</xref>) and in molecular diagnostic laboratories as the basis for clinical decisions on how to best treat patients with disease (<xref ref-type="bibr" rid="bib47">Sherry et al., 2023</xref>).</p><p>Over the last 15 years, short-read sequencing technologies, such as Illumina, have been the mainstay of variant calling in bacterial genomes, largely due to their relatively high level of basecalling accuracy. However, nanopore sequencing on devices from Oxford Nanopore Technologies (ONT) have emerged as an alternative technology. One of the major advantages of ONT sequencing from an infectious disease’s public health perspective is the ability to generate sequencing data in near real time, as well as the portability of the devices, which has enabled researchers to sequence in remote regions, closer to the source of the disease outbreak (<xref ref-type="bibr" rid="bib12">Faria et al., 2016</xref>; <xref ref-type="bibr" rid="bib19">Hoenen et al., 2016</xref>). Limitations in ONT basecalling accuracy have historically limited its widespread adoption for bacterial genome variant calling (<xref ref-type="bibr" rid="bib9">Delahaye and Nicolas, 2021</xref>). ONT have recently released a new R10.4.1 pore, along with a new basecaller (<xref ref-type="bibr" rid="bib30">Oxford Nanopore Technologies, 2023a</xref>) with three different accuracy modes (fast, high-accuracy [hac], and super-accuracy [sup]). The basecaller also has the ability to identify a subset of paired reads for which both strands have been sequenced (duplex), leading to impressive gains in basecalling accuracy (<xref ref-type="bibr" rid="bib40">Sanderson et al., 2023</xref>; <xref ref-type="bibr" rid="bib43">Sereika et al., 2022</xref>).</p><p>A number of variant callers have been developed for ONT sequencing (<xref ref-type="bibr" rid="bib11">Edge and Bansal, 2019</xref>; <xref ref-type="bibr" rid="bib59">Zheng et al., 2022</xref>; <xref ref-type="bibr" rid="bib1">Ahsan et al., 2021</xref>). However, to date, benchmarking studies have focused on human genome variant calling, and have mostly used the older pores, which do not have the ability to identify duplex reads (<xref ref-type="bibr" rid="bib29">Olson et al., 2023</xref>; <xref ref-type="bibr" rid="bib28">Olson et al., 2022</xref>; <xref ref-type="bibr" rid="bib34">Pei et al., 2021</xref>). In addition, modern deep learning-based variant callers use models trained on human DNA sequence only, leaving an open question of their generalisability to bacteria (<xref ref-type="bibr" rid="bib59">Zheng et al., 2022</xref>; <xref ref-type="bibr" rid="bib36">Poplin et al., 2018</xref>; <xref ref-type="bibr" rid="bib1">Ahsan et al., 2021</xref>). Human genomes have a very different distribution of <italic>k</italic>-mers (segments of DNA sequence of length <italic>k</italic>) and patterns of DNA modification, and as such, results from human studies may not directly carry over into bacterial genomics. Moreover, there is substantial <italic>k</italic>-mer and DNA modification variation within bacteria, mandating a broad multi-species approach for evaluation (<xref ref-type="bibr" rid="bib51">Tourancheau et al., 2021</xref>). Existing benchmarks for bacterial genomes, while immensely beneficial and thorough, only assess short-read Illumina data (<xref ref-type="bibr" rid="bib5">Bush, 2021</xref>; <xref ref-type="bibr" rid="bib4">Bush et al., 2020</xref>).</p><p>In this study, we conduct a benchmark of single nucleotide polymorphism (SNP) and insertion/deletion (indel) variant calling using ONT and Illumina sequencing across a comprehensive spectrum of 14 Gram-positive and Gram-negative bacterial species. We used the same DNA extractions for both Illumina and ONT sequencing to ensure our results are not biased by acquisition of new mutations during culture. We develop a novel strategy for generating benchmark variant truthsets in which we project variations from different strains onto our gold standard reference genomes in order to create biologically realistic distribution of SNPs and indels. We assess both deep learning-based and traditional variant calling methods and investigate the sources of errors and the impact of read depth on variant accuracy.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Genome and variant truthset</title><p>Ground truth reference assemblies were generated for each sample using ONT and Illumina reads (see Genome assembly).</p><p>Creating a variant truthset for benchmarking is challenging (<xref ref-type="bibr" rid="bib24">Majidian et al., 2023</xref>; <xref ref-type="bibr" rid="bib21">Li, 2014</xref>). Calling variants against a sample’s own reference yields no variants, so we generated a mutated reference. Instead of random mutations, we used a pseudo-real approach, applying real variants from a donor genome to the sample’s reference (<xref ref-type="bibr" rid="bib21">Li, 2014</xref>; <xref ref-type="bibr" rid="bib23">Li et al., 2018</xref>). This approach has the advantage of a simulation, in that we can be certain of the truthset of variants, but with the added benefit of the variants being real differences between two genomes.</p><p>For each sample, we selected a donor genome with average nucleotide identity (ANI; a measure of similarity between two genomes) closest to 99.5% (see Truthset and reference generation). We identified all variants between the sample and donor using minimap2 (<xref ref-type="bibr" rid="bib22">Li, 2018</xref>) and mummer (<xref ref-type="bibr" rid="bib25">Marçais et al., 2018</xref>), intersected the variant sets, and removed overlaps and indels longer than 50 bp. This variant truthset was then applied to the sample’s reference to create a mutated reference, ensuring no complications from large structural differences. While incorporating structural variation would be an interesting and useful addition to the current work, we chose to focus here on small (&lt;50 bp) variants.</p><p><xref ref-type="table" rid="table1">Table 1</xref> summarises the samples used, the number of variants, and the ANI between each sample and its donor. We analysed 14 samples from different species, spanning a wide range of GC content (30–66%). Despite the variation in SNP counts (2102-57887), the number of indels was consistent across samples (see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1b</xref> for details).</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Summary of the average nucleotide identity (ANI) and number of variants found between each sample and its donor genome.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Sample</th><th align="left" valign="bottom">Species</th><th align="left" valign="bottom">ANI (%)</th><th align="left" valign="bottom">GC (%)</th><th align="left" valign="bottom">SNPs</th><th align="left" valign="bottom">Insertions</th><th align="left" valign="bottom">Deletions</th><th align="left" valign="bottom">Total variants</th></tr></thead><tbody><tr><td align="left" valign="bottom">ATCC_33560__202309</td><td align="left" valign="bottom"><italic>Campylobacter jejuni</italic></td><td align="char" char="." valign="bottom">99.50</td><td align="char" char="." valign="bottom">30.22</td><td align="char" char="." valign="bottom">6369</td><td align="char" char="." valign="bottom">117</td><td align="char" char="." valign="bottom">106</td><td align="char" char="." valign="bottom">6592</td></tr><tr><td align="left" valign="bottom">ATCC_35221__202309</td><td align="left" valign="bottom"><italic>Campylobacter lari</italic></td><td align="char" char="." valign="bottom">98.64</td><td align="char" char="." valign="bottom">29.81</td><td align="char" char="." valign="bottom">16541</td><td align="char" char="." valign="bottom">57</td><td align="char" char="." valign="bottom">67</td><td align="char" char="." valign="bottom">16665</td></tr><tr><td align="left" valign="bottom">ATCC_25922__202309</td><td align="left" valign="bottom"><italic>Escherichia coli</italic></td><td align="char" char="." valign="bottom">99.50</td><td align="char" char="." valign="bottom">50.42</td><td align="char" char="." valign="bottom">4531</td><td align="char" char="." valign="bottom">119</td><td align="char" char="." valign="bottom">242</td><td align="char" char="." valign="bottom">4892</td></tr><tr><td align="left" valign="bottom">KPC2__202310</td><td align="left" valign="bottom"><italic>Klebsiella pneumoniae</italic></td><td align="char" char="." valign="bottom">99.50</td><td align="char" char="." valign="bottom">57.15</td><td align="char" char="." valign="bottom">15877</td><td align="char" char="." valign="bottom">90</td><td align="char" char="." valign="bottom">78</td><td align="char" char="." valign="bottom">16045</td></tr><tr><td align="left" valign="bottom">AJ292__202310</td><td align="left" valign="bottom"><italic>Klebsiella variicola</italic></td><td align="char" char="." valign="bottom">99.50</td><td align="char" char="." valign="bottom">57.62</td><td align="char" char="." valign="bottom">22850</td><td align="char" char="." valign="bottom">95</td><td align="char" char="." valign="bottom">98</td><td align="char" char="." valign="bottom">23043</td></tr><tr><td align="left" valign="bottom">ATCC_19119__202309</td><td align="left" valign="bottom"><italic>Listeria ivanovii</italic></td><td align="char" char="." valign="bottom">99.46</td><td align="char" char="." valign="bottom">37.13</td><td align="char" char="." valign="bottom">8451</td><td align="char" char="." valign="bottom">187</td><td align="char" char="." valign="bottom">259</td><td align="char" char="." valign="bottom">8897</td></tr><tr><td align="left" valign="bottom">ATCC_BAA-679__202309</td><td align="left" valign="bottom"><italic>Listeria monocytogenes</italic></td><td align="char" char="." valign="bottom">99.50</td><td align="char" char="." valign="bottom">37.98</td><td align="char" char="." valign="bottom">9090</td><td align="char" char="." valign="bottom">66</td><td align="char" char="." valign="bottom">78</td><td align="char" char="." valign="bottom">9234</td></tr><tr><td align="left" valign="bottom">ATCC_35897__202309</td><td align="left" valign="bottom"><italic>Listeria welshimeri</italic></td><td align="char" char="." valign="bottom">99.03</td><td align="char" char="." valign="bottom">36.35</td><td align="char" char="." valign="bottom">16953</td><td align="char" char="." valign="bottom">130</td><td align="char" char="." valign="bottom">133</td><td align="char" char="." valign="bottom">17216</td></tr><tr><td align="left" valign="bottom">AMtb_1__202402</td><td align="left" valign="bottom"><italic>Mycobacterium tuberculosis</italic></td><td align="char" char="." valign="bottom">99.73</td><td align="char" char="." valign="bottom">65.62</td><td align="char" char="." valign="bottom">2102</td><td align="char" char="." valign="bottom">95</td><td align="char" char="." valign="bottom">84</td><td align="char" char="." valign="bottom">2281</td></tr><tr><td align="left" valign="bottom">ATCC_10708__202309</td><td align="left" valign="bottom"><italic>Salmonella enterica</italic></td><td align="char" char="." valign="bottom">99.36</td><td align="char" char="." valign="bottom">52.20</td><td align="char" char="." valign="bottom">18784</td><td align="char" char="." valign="bottom">210</td><td align="char" char="." valign="bottom">189</td><td align="char" char="." valign="bottom">19183</td></tr><tr><td align="left" valign="bottom">BPH2947__202310</td><td align="left" valign="bottom"><italic>Staphylococcus aureus</italic></td><td align="char" char="." valign="bottom">99.48</td><td align="char" char="." valign="bottom">32.80</td><td align="char" char="." valign="bottom">7894</td><td align="char" char="." valign="bottom">95</td><td align="char" char="." valign="bottom">63</td><td align="char" char="." valign="bottom">8052</td></tr><tr><td align="left" valign="bottom">MMC234__202311</td><td align="left" valign="bottom"><italic>Streptococcus dysgalactiae</italic></td><td align="char" char="." valign="bottom">99.16</td><td align="char" char="." valign="bottom">39.49</td><td align="char" char="." valign="bottom">10474</td><td align="char" char="." valign="bottom">82</td><td align="char" char="." valign="bottom">100</td><td align="char" char="." valign="bottom">10656</td></tr><tr><td align="left" valign="bottom">RDH275__202311</td><td align="left" valign="bottom"><italic>Streptococcus pyogenes</italic></td><td align="char" char="." valign="bottom">99.50</td><td align="char" char="." valign="bottom">38.32</td><td align="char" char="." valign="bottom">5361</td><td align="char" char="." valign="bottom">60</td><td align="char" char="." valign="bottom">68</td><td align="char" char="." valign="bottom">5489</td></tr><tr><td align="left" valign="bottom">ATCC_17802__202309</td><td align="left" valign="bottom"><italic>Vibrio parahaemolyticus</italic></td><td align="char" char="." valign="bottom">98.75</td><td align="char" char="." valign="bottom">45.32</td><td align="char" char="." valign="bottom">57887</td><td align="char" char="." valign="bottom">280</td><td align="char" char="." valign="bottom">304</td><td align="char" char="." valign="bottom">58471</td></tr></tbody></table></table-wrap></sec><sec id="s2-2"><title>Data quality</title><p>We analysed ONT data basecalled with three different accuracy models – fast, high accuracy (hac), and super-accuracy (sup) – along with different read types – simplex and duplex (see Basecalling and quality control). Duplex reads are those in which both DNA strands from a single molecule are sequenced back-to-back and basecalled together, whereas simplex reads are basecalled only using a single DNA strand. The median, unfiltered read identities, calculated by aligning reads to their respective assembly, are shown in <xref ref-type="fig" rid="fig1">Figure 1</xref>. Duplex reads basecalled with the sup model had the highest median read identity of 99.93% (Q32). The Qscore is the logarithmic transformation of the read identity, <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>10</mml:mn><mml:msub><mml:mi>log</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>P</mml:mi></mml:mstyle></mml:math></inline-formula> is the read identity. This was followed by duplex hac (99.79% [Q27]), simplex sup (99.26% [Q21]), simplex hac (98.31% [Q18]), and simplex fast (94.09% [Q12]). Full summary statistics of the reads can be found in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1a</xref>.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Median alignment-based read identity (x-axis) for each sample (points) stratified by basecalling model (colours) and read type (y-axis).</title><p>The Qscore is the logarithmic transformation of the read identity, <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>10</mml:mn><mml:msub><mml:mi>log</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>P</mml:mi></mml:mstyle></mml:math></inline-formula> is the read identity.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig1-v1.tif"/></fig></sec><sec id="s2-3"><title>Which method is the best?</title><p>For this study, we benchmarked the performance of seven variant callers on ONT sequencing data: BCFtools (v1.19, <xref ref-type="bibr" rid="bib8">Danecek et al., 2021</xref>), Clair3 (v1.0.5, <xref ref-type="bibr" rid="bib59">Zheng et al., 2022</xref>), DeepVariant (v1.6.0, <xref ref-type="bibr" rid="bib36">Poplin et al., 2018</xref>), FreeBayes (v1.3.7, <xref ref-type="bibr" rid="bib13">Garrison, 2012</xref>), Longshot (v0.4.5, <xref ref-type="bibr" rid="bib11">Edge and Bansal, 2019</xref>), Medaka(v1.11.3, <xref ref-type="bibr" rid="bib30">Oxford Nanopore Technologies, 2023a</xref>; <xref ref-type="bibr" rid="bib32">Oxford Nanopore Technologies, 2023c</xref>), and NanoCaller (v3.4.1, <xref ref-type="bibr" rid="bib1">Ahsan et al., 2021</xref>). In addition, we called variants from each sample’s Illumina data using Snippy (v4.6.0, <xref ref-type="bibr" rid="bib42">Seemann, 2015</xref>) to act as a performance comparison.</p><p>Alignments of ONT reads to each sample’s mutated reference (see Genome and variant truthset) were generated with minimap2 and provided to each variant caller (except Medaka, which takes reads directly). Variant calls were assessed against the truthset using vcfdist (v2.3.3, <xref ref-type="bibr" rid="bib10">Dunn and Narayanasamy, 2023</xref>), classifying each variant as true positive (TP), false positive (FP), or false negative (FN). Precision, recall, and the F1 score were calculated for SNPs and indels at each VCF quality score increment. <xref ref-type="fig" rid="fig2">Figure 2</xref> displays the highest F1 scores for each variant caller across samples, basecalling models, read types, and variant types.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>The highest F1 score for each sample (points), stratified by basecalling model (colours), variant type (rows), and read type (columns).</title><p>Illumina results (green) are included as a reference and do not have different basecalling models or read types. Note, Longshot does not provide indel calls.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Precision at the highest F1 score for each sample (points), stratified by basecalling model (colours), variant type (rows), and read type (columns).</title><p>Illumina results (green) are included as a reference and do not have different basecalling models or read types. Note, Longshot does not provide indel calls.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig2-figsupp1-v1.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Recall at the highest F1 score for each sample (points), stratified by basecalling model (colours), variant type (rows), and read type (columns).</title><p>Illumina results (green) are included as a reference and do not have different basecalling models or read types. Note, Longshot does not provide indel calls.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig2-figsupp2-v1.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Clair3 sup model F1 score (y-axis) at the highest F1 score for each sample (x-axis), stratified by variant type (rows), and read type (shapes).</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig2-figsupp3-v1.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 4.</label><caption><title>Clair3 sup model precision (y-axis) at the highest F1 score for each sample (x-axis), stratified by variant type (rows), and read type (shapes).</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig2-figsupp4-v1.tif"/></fig><fig id="fig2s5" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 5.</label><caption><title>Clair3 sup model recall (y-axis) at the highest F1 score for each sample (x-axis), stratified by variant type (rows), and read type (shapes).</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig2-figsupp5-v1.tif"/></fig></fig-group><p>The F1 score is the harmonic mean of precision and recall and acts as a good metric for overall evaluation. From <xref ref-type="fig" rid="fig2">Figure 2</xref> we see that Clair3 and DeepVariant produce the highest F1 scores for both SNPs and indels with both read types. Unsurprisingly, the sup basecalling model leads to the highest F1 scores across all variant callers, though hac is not much lower. SNP F1 scores of 99.99% are obtained from Clair3 and DeepVariant on sup-basecalled data. For indel calls, Clair3 achieves F1 scores of 99.53% and 99.20% for sup simplex and duplex, respectively, while DeepVariant scores 99.61% and 99.22%. The higher depth of the simplex reads likely explains why the best duplex indel F1 scores are slightly lower than simplex (see How much read depth is enough?). The precision and recall values at the highest F1 score can be seen in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref> and <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref> (see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1c</xref> for a summary and <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1d</xref> for full details) as well as results broken down by species for Clair3 with the sup model in <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>, <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>, and <xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref>. Reads basecalled with the fast model are an order of magnitude worse than the hac and sup models.</p><p><xref ref-type="fig" rid="fig3">Figure 3</xref> shows the precision-recall curves for the sup basecalling model (see <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref> for the hac and fast model curves, respectively) for each variant and read type – aggregated across samples to produce a single curve for each variant caller. Due to the right-angle-like shape of the Clair3 and DeepVariant curves, filtering based on low-value variant quality improves precision considerably for variant calls, without losing much recall. A similar pattern holds true for BCFtools SNP calls. The best Clair3 and DeepVariant F1 scores are obtained with no quality filtering on sup data, except for indels from duplex data where a quality filter of 4 provides the best F1. See <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1e</xref> for the full details.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Precision and recall curves for each variant caller (colours and line styles) on sequencing data basecalled with the sup model, stratified by variant type (rows) and read type (columns) and aggregated across samples.</title><p>The curves are generated by using increasing variant quality score thresholds to filter variants and calculating precision and recall at each threshold. The lowest threshold is the lower right part of the curve, moving to the highest at the top left. Note, Longshot does not provide indel calls.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Precision and recall curves for each variant caller (colours and line styles) on sequencing data basecalled with the hac model, stratified by variant type (rows) and ready type (columns).</title><p>The curves are generated by using increasing variant quality score thresholds to filter variants and calculating precision and recall at each threshold. The lowest threshold is the lower right part of the curve, moving to the highest at the top left. Note, Longshot does not provide indel calls.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig3-figsupp1-v1.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Precision and recall curves for each variant caller (colours and line styles) on sequencing data basecalled with the fast model, stratified by variant type (rows).</title><p>The curves are generated by using increasing variant quality score thresholds to filter variants and calculating precision and recall at each threshold. The lowest threshold is the lower right part of the curve, moving to the highest at the top left. Note, Longshot does not provide indel calls.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig3-figsupp2-v1.tif"/></fig></fig-group><p>A striking feature of <xref ref-type="fig" rid="fig2">Figure 2</xref> and <xref ref-type="fig" rid="fig3">Figure 3</xref> is the comparison of deep learning-based variant callers (Clair3, DeepVariant, Medaka, and NanoCaller) to Illumina. For all variant and read types with hac or sup data, these deep learning methods match or surpass Illumina, with median best SNP and indel F1 scores of 99.45% and 95.76% for Illumina. Clair3 and DeepVariant, in particular, perform an order of magnitude better. Traditional variant callers (Longshot, BCFtools, and FreeBayes) match or slightly exceed Illumina for SNP calls with hac and sup data. FreeBayes matches Illumina for indel calls, but BCFtools shows reduced indel accuracy across all models and read types. Fast model ONT data has a lower F1 score than Illumina, only achieving parity in the best case for SNPs.</p></sec><sec id="s2-4"><title>Understanding missed and false calls</title><p>Conventional wisdom may leave readers surprised at finding that ONT data can provide better variant calls than Illumina. In order to convince ourselves (and others) of these results, we investigate the main causes for this difference.</p><p>Given the ONT read-level accuracy now exceeding Q20 (<xref ref-type="fig" rid="fig1">Figure 1</xref>; simplex sup), read length remains the primary difference between the two technologies. <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref> shows that Illumina’s lower F1 score is mainly due to recall rather than precision (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). We hypothesised that Illumina errors are related to alignment difficulties in repetitive or variant-dense regions due to its shorter reads.</p><p><xref ref-type="fig" rid="fig4">Figure 4</xref> shows that variant density and repetitive regions account for many false negatives, lowering recall. We define variant density as the number of variants (missed or called) in a 100 bp window around each call. <xref ref-type="fig" rid="fig4">Figure 4a</xref> reveals a bimodal distribution of variant density for Illumina FNs, with a second peak at 20 variants per 100 bp, unlike the distribution for TP and FP calls. In contrast, Clair3, a top-performing ONT variant caller, shows no bimodal distribution and few missed or false calls at this density (<xref ref-type="fig" rid="fig4">Figure 4b</xref>). Illumina reads struggle to align in variant-dense regions, whereas ONT reads can (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>), as 20 variants per 100 bp represents a larger portion of an Illumina read than an ONT read.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Impact of variant density and repetitive regions on Illumina variant calling.</title><p>Variant density is the number of (true or false) variants in a 100 bp window centred on a call. (<bold>a</bold> and <bold>b</bold>) The distribution of variant densities for true positive (TP), false positive (FP), and false negative (FN) calls. The y-axis, percent, indicates the percent of all calls of that decision that fall within the density bin on the x-axis. Illumina calls, aggregated across all samples, are shown in a, while b shows Clair3 calls from simplex sup-basecalled reads at 100× depth. (<bold>c</bold>) Impact of repetitive regions on the F1 score (y-axis) for Clair3 (100× simplex sup) and Illumina. The x-axis indicates whether variants that fall within repetitive regions are excluded from the calculation of the F1 score. Points indicate the F1 score for a single sample.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig4-v1.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Read pileup in a variant-dense region in the genome of sample ATCC_17802__202309.</title><p>The top track shows the alignment of the sample’s Illumina reads, while the lower track is the Oxford Nanopore Technologies (ONT) reads. Missed variant calls (false negatives) are shown by small blue notches at the bottom of the figure, but are also identifiable by vertical coloured lines in the ONT reads. Pileup is visualised in IGV (<xref ref-type="bibr" rid="bib38">Robinson et al., 2011</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig4-figsupp1-v1.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>Read pileup around two repetitive regions (horizontal blue bars) in the genome of sample AMtb_1__202401.</title><p>The top track shows the alignment of the sample’s Illumina reads, while the lower track is the Oxford Nanopore Technologies (ONT) reads. Missed variant calls (false negatives) are shown by small red notches in a purple box with a red border at the bottom of the figure, but are also identifiable by vertical coloured lines in the ONT reads. Pileup is visualised in IGV (<xref ref-type="bibr" rid="bib38">Robinson et al., 2011</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig4-figsupp2-v1.tif"/></fig></fig-group><p>We also assessed the change in F1 score when masking repetitive regions of the genome (see Identifying repetitive regions). Due to their shorter length, Illumina reads struggle more with alignment in these regions compared to ONT reads (<xref ref-type="bibr" rid="bib52">Treangen and Salzberg, 2011</xref>). <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref> highlights missed variants and alignment gaps in Illumina data. This is further quantified by the increase in Illumina’s F1 score when repetitive regions are masked (<xref ref-type="fig" rid="fig4">Figure 4c</xref>), rising from 99.3% to 99.7%. In contrast, Clair3 100× simplex sup data shows only a 0.003% increase.</p><p>In terms of ONT missed calls, a variant-dense repetitive region in the <italic>E. coli</italic> sample ATCC_25922 was the cause of the simplex sup SNP outlier from <xref ref-type="fig" rid="fig2">Figure 2</xref> (see Appendix 2). In addition, the duplex sup SNP outlier was caused by very low read depth for sample KPC2_202310 (<italic>K. pneumoniae</italic>; Appendix 2).</p><p>Indels have traditionally been a systematic weakness for ONT sequencing data, primarily driven by variability in the length of homopolymeric regions as determined by basecallers (<xref ref-type="bibr" rid="bib9">Delahaye and Nicolas, 2021</xref>). Having seen the drastic improvements in read accuracy in <xref ref-type="fig" rid="fig1">Figure 1</xref>, we sought to determine whether FP indel calls are still a byproduct of homopolymer-driven errors.</p><p>When analysing Clair3, the best-performing ONT caller, we found that reads basecalled with the fast model often miscalculate homopolymer lengths by 1 or 2 bp (<xref ref-type="fig" rid="fig5">Figure 5</xref>), though there is an equal number of non-homopolymeric false indel calls. In contrast, the sup model significantly reduced false indel calls, matching Illumina’s error profile. Of the eight false indel calls by Clair3 on sup data, five were homopolymers and three occurred within one or two bases of another insertion with a similar sequence. The hac model improved over the fast model but still produced notable false indel calls, mainly miscalculating homopolymers by 1 bp. DeepVariant showed a similar error profile to Clair3 (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>), with 8/11 false indels being homopolymers. FreeBayes (<xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3</xref>), Medaka (<xref ref-type="fig" rid="fig5s4">Figure 5—figure supplement 4</xref>), and NanoCaller (<xref ref-type="fig" rid="fig5s5">Figure 5—figure supplement 5</xref>) performed similarly, while BCFtools (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>) exhibited a persistent bias for homopolymeric indel errors, even with sup model reads. This indicates that while the sup basecaller reduces bias, deep learning methods like Clair3 and DeepVariant further mitigate it by training models to account for these systematic issues. An honourable mention goes to FreeBayes, a traditional variant caller that handles errors without inherent bias.</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Relationship between indel length (y-axis) and homopolymer length (x-axis) for false positive (FP) indel calls for Clair3 100× simplex fast (top left), hac (top right), and sup (lower left) calls.</title><p>Illumina is shown in the lower right for reference. The vertical red line indicates the threshold above which we deem a run of the same nucleotide to be a ‘true’ homopolymer. Indel length is the number of bases inserted/deleted for an indel, whereas the homopolymer length indicates how long the tract of the same nucleotide is after the indel. The colour of a cell indicates number of FP indels of that indel-homopolymer length combination.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig5-v1.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Relationship between indel length (x-axis) and homopolymer length (y-axis) for false positive (FP) indel calls for BCFtools 100× simplex fast (top left), hac (top right), and sup (lower left) calls.</title><p>Illumina is shown in the lower right for reference. The vertical red line indicates the threshold above which we deem a run of the same nucleotide to be a ‘true’ homopolymer. Indel length is the number of bases inserted/deleted for an indel, whereas the homopolymer length indicates how long the tract of the same nucleotide is after the indel. The colour of a cell indicates number of FP indels of that indel-homopolymer length combination.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig5-figsupp1-v1.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 2.</label><caption><title>Relationship between indel length (x-axis) and homopolymer length (y-axis) for false positive (FP) indel calls for DeepVariant 100× simplex fast (top left), hac (top right), and sup (lower left) calls.</title><p>Illumina is shown in the lower right for reference. The vertical red line indicates the threshold above which we deem a run of the same nucleotide to be a ‘true’ homopolymer. Indel length is the number of bases inserted/deleted for an indel, whereas the homopolymer length indicates how long the tract of the same nucleotide is after the indel. The colour of a cell indicates number of FP indels of that indel-homopolymer length combination.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig5-figsupp2-v1.tif"/></fig><fig id="fig5s3" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 3.</label><caption><title>Relationship between indel length (x-axis) and homopolymer length (y-axis) for false positive (FP) indel calls for FreeBayes 100× simplex fast (top left), hac (top right), and sup (lower left) calls.</title><p>Illumina is shown in the lower right for reference. The vertical red line indicates the threshold above which we deem a run of the same nucleotide to be a ‘true’ homopolymer. Indel length is the number of bases inserted/deleted for an indel, whereas the homopolymer length indicates how long the tract of the same nucleotide is after the indel. The colour of a cell indicates number of FP indels of that indel-homopolymer length combination.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig5-figsupp3-v1.tif"/></fig><fig id="fig5s4" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 4.</label><caption><title>Relationship between indel length (x-axis) and homopolymer length (y-axis) for false positive (FP) indel calls for Medaka 100× simplex fast (top left), hac (top right), and sup (lower left) calls.</title><p>Illumina is shown in the lower right for reference. The vertical red line indicates the threshold above which we deem a run of the same nucleotide to be a ‘true’ homopolymer. Indel length is the number of bases inserted/deleted for an indel, whereas the homopolymer length indicates how long the tract of the same nucleotide is after the indel. The colour of a cell indicates number of FP indels of that indel-homopolymer length combination.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig5-figsupp4-v1.tif"/></fig><fig id="fig5s5" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 5.</label><caption><title>Relationship between indel length (x-axis) and homopolymer length (y-axis) for false positive (FP) indel calls for NanoCaller 100× simplex fast (top left), hac (top right), and sup (lower left) calls.</title><p>Illumina is shown in the lower right for reference. The vertical red line indicates the threshold above which we deem a run of the same nucleotide to be a ‘true’ homopolymer. Indel length is the number of bases inserted/deleted for an indel, whereas the homopolymer length indicates how long the tract of the same nucleotide is after the indel. The colour of a cell indicates number of FP indels of that indel-homopolymer length combination.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig5-figsupp5-v1.tif"/></fig><fig id="fig5s6" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 6.</label><caption><title>Relationship between indel length (x-axis) and homopolymer length (y-axis) for false negative (FN) indel calls for Clair3 100× simplex fast (top left), hac (top right), and sup (lower left) calls.</title><p>Illumina is shown in the lower right for reference. The vertical red line indicates the threshold above which we deem a run of the same nucleotide to be a ‘true’ homopolymer. Indel length is the number of bases inserted/deleted for an indel, whereas the homopolymer length indicates how long the tract of the same nucleotide is after the indel. The colour of a cell indicates number of FN indels of that indel-homopolymer length combination.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig5-figsupp6-v1.tif"/></fig><fig id="fig5s7" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 7.</label><caption><title>Relationship between indel length (x-axis) and homopolymer length (y-axis) for false negative (FN) indel calls for BCFtools 100× simplex fast (top left), hac (top right), and sup (lower left) calls.</title><p>Illumina is shown in the lower right for reference. The vertical red line indicates the threshold above which we deem a run of the same nucleotide to be a ‘true’ homopolymer. Indel length is the number of bases inserted/deleted for an indel, whereas the homopolymer length indicates how long the tract of the same nucleotide is after the indel. The colour of a cell indicates number of FN indels of that indel-homopolymer length combination.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig5-figsupp7-v1.tif"/></fig><fig id="fig5s8" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 8.</label><caption><title>Relationship between indel length (x-axis) and homopolymer length (y-axis) for false negative (FN) indel calls for DeepVariant 100× simplex fast (top left), hac (top right), and sup (lower left) calls.</title><p>Illumina is shown in the lower right for reference. The vertical red line indicates the threshold above which we deem a run of the same nucleotide to be a ‘true’ homopolymer. Indel length is the number of bases inserted/deleted for an indel, whereas the homopolymer length indicates how long the tract of the same nucleotide is after the indel. The colour of a cell indicates number of FN indels of that indel-homopolymer length combination.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig5-figsupp8-v1.tif"/></fig><fig id="fig5s9" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 9.</label><caption><title>Relationship between indel length (x-axis) and homopolymer length (y-axis) for false negative (FN) indel calls for FreeBayes 100× simplex fast (top left), hac (top right), and sup (lower left) calls.</title><p>Illumina is shown in the lower right for reference. The vertical red line indicates the threshold above which we deem a run of the same nucleotide to be a ‘true’ homopolymer. Indel length is the number of bases inserted/deleted for an indel, whereas the homopolymer length indicates how long the tract of the same nucleotide is after the indel. The colour of a cell indicates number of FN indels of that indel-homopolymer length combination.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig5-figsupp9-v1.tif"/></fig><fig id="fig5s10" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 10.</label><caption><title>Relationship between indel length (x-axis) and homopolymer length (y-axis) for false negative (FN) indel calls for Medaka 100× simplex fast (top left), hac (top right), and sup (lower left) calls.</title><p>Illumina is shown in the lower right for reference. The vertical red line indicates the threshold above which we deem a run of the same nucleotide to be a ‘true’ homopolymer. Indel length is the number of bases inserted/deleted for an indel, whereas the homopolymer length indicates how long the tract of the same nucleotide is after the indel. The colour of a cell indicates number of FN indels of that indel-homopolymer length combination.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig5-figsupp10-v1.tif"/></fig><fig id="fig5s11" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 11.</label><caption><title>Relationship between indel length (x-axis) and homopolymer length (y-axis) for false negative (FN) indel calls for NanoCaller 100× simplex fast (top left), hac (top right), and sup (lower left) calls.</title><p>Illumina is shown in the lower right for reference. The vertical red line indicates the threshold above which we deem a run of the same nucleotide to be a ‘true’ homopolymer. Indel length is the number of bases inserted/deleted for an indel, whereas the homopolymer length indicates how long the tract of the same nucleotide is after the indel. The colour of a cell indicates number of FN indels of that indel-homopolymer length combination.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig5-figsupp11-v1.tif"/></fig></fig-group><p>Lastly, we did not see any systematic indel bias in the context of missed calls (<xref ref-type="fig" rid="fig5s6">Figure 5—figure supplements 6</xref>–<xref ref-type="fig" rid="fig5s11">11</xref>), especially when compared to Illumina indel error profiles.</p></sec><sec id="s2-5"><title>How much read depth is enough?</title><p>Having established the accuracy of variant calls from ‘full-depth’ ONT datasets (100×), we investigated the required ONT read depth to achieve desired precision or recall, which varies by use case and resource availability. This is particularly relevant for ONT, where sequencing can be stopped in real time once ‘sufficient’ data is obtained.</p><p>We subsampled each ONT read set with rasusa (v0.8.0, <xref ref-type="bibr" rid="bib15">Hall, 2022</xref>) to average depths of 5×, 10×, 25×, 50×, and 100× and called variants with these reduced sets. Due to limited duplex depth, 50× was the maximum used for duplex reads, while 100× was used for simplex reads.</p><p><xref ref-type="fig" rid="fig6">Figure 6</xref> and <xref ref-type="fig" rid="fig7">Figure 7</xref> show F1 score, precision, and recall as functions of read depth for SNPs and indels. Precision and recall decrease as read depth is reduced, notably below 25×. Remarkably, Clair3 or DeepVariant on 10× ONT sup simplex data provides F1 scores consistent with, or better than, full-depth Illumina for both SNPs and indels (see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1a</xref> for Illumina read depths). The same is true for duplex hac or sup reads.</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Effect of read depth (x-axis) on the highest SNP F1 score, and precision and recall at that F1 score (y-axis), for each variant caller (colours).</title><p>Each column is a basecall model and read type combination. The grey bars indicate the number of samples with at least that much read depth in the full read set. Samples with less than that depth were not used to calculate that depth’s metrics. Bars on each point at each depth depict the 95% confidence interval. The horizontal red dashed line is the full-depth Illumina value for that metric, with the red bands indicating the 95% confidence interval.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig6-v1.tif"/></fig><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Effect of read depth (x-axis) on the highest indel F1 score, and precision and recall at that F1 score (y-axis), for each variant caller (colours).</title><p>Each column is a basecall model and read type combination. The grey bars indicate the number of samples with at least that much read depth in the full read set. Samples with less than that depth were not used to calculate that depth’s metrics. Bars on each point at each depth depict the 95% confidence interval. The horizontal red dashed line is the full-depth Illumina value for that metric, with the red bands indicating the 95% confidence interval.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig7-v1.tif"/></fig><p>With 5× of ONT read depth the F1 score is lower than Illumina for almost all variant caller and basecalling models. However, BCFtools surprisingly produces SNP F1 scores on par with Illumina on duplex sup reads. Despite the inferior F1 scores across the board at 5×, SNP precision remains above Illumina with duplex reads for all methods except NanoCaller, and calls from Clair3 and DeepVariant simplex sup data.</p></sec><sec id="s2-6"><title>What computational resources do I need?</title><p>The final consideration for variant calling is the required computational resources. While this may be trivial for those with high-performance computing (HPC) access, many analyse bacterial genomes on personal computers due to their smaller size compared to eukaryotes. The main resource constraints are memory and runtime, especially for aligning reads to a reference and calling variants. Additionally, if working with raw (pod5) ONT data, basecalling is also a resource-intensive step.</p><p><xref ref-type="fig" rid="fig8">Figure 8</xref> shows the runtime (seconds per megabase of sequencing data) and maximum memory usage for read alignment and variant calling (see <xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref> and <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1g</xref> for basecalling GPU runtimes). DeepVariant was the slowest (median 5.7 s/Mbp) and most memory-intensive (median 8 GB), with a runtime of 38 min for a 4 Mbp genome at 100× depth. FreeBayes had the largest runtime variation, with a maximum of 597 s/Mbp, equating to 2.75 days for the same genome. In contrast, basecalling with a single GPU using the super-accuracy model required a median runtime of 0.77 s/Mbp, or just over 5 min for a 4 Mbp genome at 100× depth. Clair3 had a median memory usage of 1.6 GB and a runtime of 0.86 s/Mbp (&lt;6 min for a 4 Mbp 100× genome). Full details are given in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1f</xref>.</p><fig-group><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Computational resource usage of alignment and each variant caller (y-axis and colours).</title><p>The top panel shows the maximum memory usage (x-axis) and the lower panel shows the runtime as a function of the CPU time (seconds) divided by the number of basepairs in the readset (seconds per megabasepairs; x-axis). Each point represents a single run across read depths, basecalling models, read types, and samples for that variant caller (or alignment).</p><p>s=seconds; m=minutes; MB = megabytes; GB = gigabytes; Mbp = megabasepairs.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig8-v1.tif"/></fig><fig id="fig8s1" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 1.</label><caption><title>Runtime of basecalling Oxford Nanopore Technologies (ONT) data with different models on GPUs.</title><p>Runtime is presented as seconds per megabasepairs, keeping consistent with <xref ref-type="fig" rid="fig8">Figure 8</xref> from the main text. The y-axis represents basecalling with either 8 Nvidia A100 GPUs (cuda:all) or 1 A100 (cuda:single), with each stratified by basecalling model (colours). Points represent running a single sample-model combination, with each combination being run three times.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-fig8-figsupp1-v1.tif"/></fig></fig-group></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In this study, we evaluated the accuracy of bacterial variant calls derived from ONT using both conventional and deep learning-based tools. Our findings show that deep learning approaches, specifically Clair3 and DeepVariant, deliver high accuracy in SNP and indel calls from the latest high-accuracy basecalled ONT data, outperforming Illumina-based methods, with Clair3 achieving median F1 scores of 99.99% for SNPs and 99.53% for indels.</p><p>Our dataset comprised deep sequencing of 14 bacterial species using the latest ONT R10.4.1 flow cells, with a 5 kHz sampling rate and complementary deep Illumina sequencing. Consistent with previous studies (<xref ref-type="bibr" rid="bib41">Sanderson et al., 2024</xref>; <xref ref-type="bibr" rid="bib40">Sanderson et al., 2023</xref>; <xref ref-type="bibr" rid="bib43">Sereika et al., 2022</xref>), we observed read accuracies greater than 99.0% (Q20) and 99.9% (Q30) for simplex and duplex reads, respectively (<xref ref-type="fig" rid="fig1">Figure 1</xref>).</p><p>The high-quality sequencing data enabled the creation of near-perfect reference genomes, crucial for evaluating variant calling accuracy. While not claiming perfection for these genomes, we consider them to be as accurate as current technology allows (or as philosophically possible) (<xref ref-type="bibr" rid="bib58">Wick et al., 2023</xref>; <xref ref-type="bibr" rid="bib43">Sereika et al., 2022</xref>).</p><p>To benchmark variant calling, we utilised a variant truthset generated by applying known differences between closely related genomes to a reference. This pseudo-real method offers a realistic evaluation framework and a reliable truthset for assessing variant calling accuracy (<xref ref-type="bibr" rid="bib21">Li, 2014</xref>; <xref ref-type="bibr" rid="bib23">Li et al., 2018</xref>).</p><p>Our comparison of variant calling methods showed that deep learning techniques achieved the highest F1 scores for SNP and indel detection, indicating their potential in genomic analyses and suggesting a shift towards more advanced computational approaches. While the superior performance of these methods has been established for human variant calls (<xref ref-type="bibr" rid="bib28">Olson et al., 2022</xref>; <xref ref-type="bibr" rid="bib29">Olson et al., 2023</xref>), our results confirm their effectiveness for bacterial genomes as well.</p><p>Our investigation into missed and false variant calls highlights inherent challenges posed by sequencing technology limitations, particularly read length, alignment in complex regions, and indel length in homopolymers. We found that variant density and repetitive regions hinder Illumina variant calling due to short read alignment issues. However, we found recent improvements in ONT read accuracy and deep learning-based variant callers have mitigated homopolymer-induced FP indel calls, previously a major systematic issue with ONT data (<xref ref-type="bibr" rid="bib9">Delahaye and Nicolas, 2021</xref>; <xref ref-type="bibr" rid="bib43">Sereika et al., 2022</xref>).</p><p>Having established the accuracy and error sources of modern methods, we examined the impact of read depth on variant calling accuracy. Our results show that high accuracy is achievable at reduced read depths of 10×, especially with super-accuracy basecalling models and deep learning algorithms. This is significant for resource-limited projects, as 10× super-accuracy simplex data can match or exceed Illumina accuracy. For optimal clinical and public health applications, we recommend a minimum of 25× depth. Notably, 5× depth with duplex super-accuracy ONT data achieved SNP accuracy comparable to Illumina. Having such confidence in low-depth calls will no doubt be a boon for many clinical and public health applications where sequencing direct-from-sample is desired (<xref ref-type="bibr" rid="bib45">Sheka et al., 2021</xref>; <xref ref-type="bibr" rid="bib50">Street et al., 2020</xref>; <xref ref-type="bibr" rid="bib7">Chiu and Miller, 2019</xref>; <xref ref-type="bibr" rid="bib27">Nilgiriwala et al., 2023</xref>).</p><p>Lastly, considering computational resource requirements is crucial, especially for those without HPC facilities (<xref ref-type="bibr" rid="bib26">Musila, 2022</xref>; <xref ref-type="bibr" rid="bib19">Hoenen et al., 2016</xref>; <xref ref-type="bibr" rid="bib12">Faria et al., 2016</xref>). Our findings show a wide range of demands among variant calling methods, with the worst-case scenario (FreeBayes) taking over 2 days. Most methods, however, run in less than 40 min, with Clair3 having a median runtime of about 6 minutes. All methods use less than 8 GB of memory, making them compatible with most laptops. Basecalling is generally faster than variant calling, assuming GPU access, which is likely considered when acquiring ONT-related equipment.</p><p>There are three main limitations to this work. The first is that we only assess small variants and ignored structural variants. Zhou et al. benchmarked structural variant calling from ONT data (<xref ref-type="bibr" rid="bib60">Zhou et al., 2019</xref>), though this focused on human sequencing data. Generating a truthset of structural variants between two genomes is, in itself, a difficult task. However, we believe such an undertaking with a thorough investigation of structural variant calling methods for bacterial genomes would be highly beneficial.</p><p>The second limitation is not using a diverse range of ANI values for selecting the variant donor genomes when generating the truthset. Previous work from Bush et al. examined different diversity thresholds for selecting reference genomes when calling variants from Illumina data, and found it to be one of the main differentiating factors in accuracy (<xref ref-type="bibr" rid="bib4">Bush et al., 2020</xref>). Our results mirror this to an extent, showing the reduction in Illumina accuracy as the variant density increases, though it would be interesting to determine whether the divergence in reference genomes has an affect on ONT variant calling accuracy. Nevertheless, to maintain our focus on the nuances of variant calling methods, including basecalling models, read types, error types, and the influence of read depth, we decided that introducing another layer of complexity into our benchmark could potentially obscure some of the insights.</p><p>The third limitation is that Illumina sequencing was performed on different models: three samples on the NextSeq 500 and the rest on the NextSeq 2000. While differences in error rates exist between Illumina instruments, no specific assessment has been made between these NextSeq models (<xref ref-type="bibr" rid="bib49">Stoler and Nekrutenko, 2021</xref>). However, the absolute differences in error rates are minor and unlikely to impact our study significantly. This is particularly relevant since Illumina’s lower F1 score compared to ONT was due to missed calls rather than erroneous ones.</p><p>In conclusion, this study comprehensively evaluates bacterial variant calls using ONT, highlighting the superior performance of deep learning tools, particularly Clair3 and DeepVariant, in SNP and indel detection. Our extensive dataset and rigorous benchmarking demonstrate significant advancements in sequencing accuracy with the latest ONT technologies. Improvements in ONT read accuracy and deep learning variant callers have mitigated previous challenges like homopolymer-associated errors. We also found that high accuracy can be achieved at lower read depths, making these methods practical for resource-limited settings. This capability marks a significant step in making advanced genomic analysis more accessible and impactful.</p></sec><sec id="s4" sec-type="methods"><title>Methods</title><sec id="s4-1"><title>Sequencing</title><p>Bacterial isolates were streaked onto agar plates and grown overnight at 37°C. <italic>M. tuberculosis</italic>, <italic>S. pyogenes</italic>, and <italic>S. dysgalactiae</italic> subsp. <italic>equisimilis</italic> were grown in liquid media of 7H9 or TSB with shaking until reaching high cell density (OD ∼ 1; see Appendix 1 for <italic>Streptococcus</italic> sample selection). The cultures were centrifuged at 13,000 rpm for 10 min and cell pellets were collected. Bacteria were lysed with appropriate enzymatic treatment except for <italic>Mycobacterium</italic> and <italic>Streptococcus</italic>, which were lysed by bead beating (PowerBead, 0.5 mm glass beads [13116-50] or Lysing Matrix Y [116960050-CF] and Precellys or TissueLyser [QIAGEN]). DNA extraction was performed by sodium acetate precipitation and further Ampure XP bead purification (Beckman Coulter) or either Beckman Coulter GenFind V2 (A41497) or QIAGEN Blood and Tissue DNEasy kit (69506). Illumina library preparation was performed using Illumina DNA prep (20060059) using quarter reagents and Illumina DNA/RNA UD Indexes. Short-read whole-genome sequencing was performed on an Illumina NextSeq 500 for the <italic>M. tuberculosis</italic> (AMtb_1__202402), <italic>S. pyogenes</italic> (RDH275__202311), and <italic>S. dysgalactiae</italic> (MMC234__202311) samples and a NextSeq 2000 for all other samples, with a 150 bp PE kit. ONT library preparation was performed using either Rapid Barcoding Kit V14 (SQK-RBK114.96) or Native Barcoding Kit V14 (SQK-NBD114.96). Long-read whole-genome sequencing was performed on a MinION Mk1b or GridION using R10.4.1 MinION flow cells (FLO-MIN114). <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1i</xref> contains detailed information about the instrument models and multiplexing for each sample.</p></sec><sec id="s4-2"><title>Basecalling and quality control</title><p>Raw ONT data were basecalled with Dorado (v0.5.0, <xref ref-type="bibr" rid="bib30">Oxford Nanopore Technologies, 2023a</xref>) using the v4.3.0 models <italic>fast</italic> (dna_r10.4.1_e8.2_400bps_fast@v4.3.0), <italic>hac</italic> (dna_r10.4.1_e8.2_400bps_hac@v4.3.0), and <italic>sup</italic> (dna_r10.4.1_e8.2_400bps_sup@v4.3.0). Duplex reads were additionally generated using the <monospace>duplex</monospace> subcommand of Dorado with hac and sup models (fast is not compatible with duplex). All runs were basecalled on an Nvidia A100 GPU to ensure consistency. Reads shorter than 1000bp or with a quality score below 10 were removed with SeqKit (v2.6.1 <xref ref-type="bibr" rid="bib46">Shen et al., 2016</xref>) and each readset was randomly subsampled to a maximum mean read depth of 100x with Rasusa (v0.8.0 <xref ref-type="bibr" rid="bib15">Hall, 2022</xref>).</p><p>Illumina reads were preprocessed with fastp (v0.23.4, <xref ref-type="bibr" rid="bib6">Chen et al., 2018</xref>) to remove adapter sequences, trim low-quality bases from the ends of the reads, and remove duplicate reads and reads shorter than 30bp.</p></sec><sec id="s4-3"><title>Genome assembly</title><p>Ground truth assemblies were generated for each sample as per <xref ref-type="bibr" rid="bib58">Wick et al., 2023</xref>. Briefly, the unfiltered ONT simplex sup reads were filtered with Filtlong (v0.2.1, <xref ref-type="bibr" rid="bib55">Wick, 2021</xref>) to keep the best 90% <monospace>(-p 90)</monospace> and fastp (default settings) was used to process the raw Illumina reads. We performed 24 separate assemblies using the Extra-thorough assembly instructions in Trycycler’s (v0.5.4, <xref ref-type="bibr" rid="bib56">Wick et al., 2021</xref>) documentation. Assemblies were combined into a single consensus assembly with Trycycler and Illumina reads were used to polish that assembly using Polypolish (v0.6.0; default settings, <xref ref-type="bibr" rid="bib57">Wick and Holt, 2022</xref>) and Pypolca (v0.3.1, <xref ref-type="bibr" rid="bib3">Bouras et al., 2024</xref>; <xref ref-type="bibr" rid="bib61">Zimin and Salzberg, 2020</xref>) with <monospace>--careful</monospace>. Manual curation and investigation of all polishing changes was made as per <xref ref-type="bibr" rid="bib58">Wick et al., 2023</xref> (e.g. for very long homopolymers, the correct length was chosen as per Illumina reads support).</p></sec><sec id="s4-4"><title>Truthset and reference generation</title><p>To generate the variant truthset for each sample, we identified all variants between the sample and a <italic>donor</italic> genome. To select the variant-donor genome for a given sample, we downloaded all RefSeq assemblies for that species (up to a maximum of 10,000) using genome_updater (v0.6.3, <xref ref-type="bibr" rid="bib35">Piro, 2023</xref>). ANI was calculated between each downloaded genome and the sample reference using skani (v0.2.1, <xref ref-type="bibr" rid="bib44">Shaw and Yu, 2023</xref>). We only kept genomes with an ANI, <inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>a</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula>, such that <inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>98.40</mml:mn><mml:mi mathvariant="normal">%</mml:mi><mml:mo>≤</mml:mo><mml:mi>a</mml:mi><mml:mo>&lt;=</mml:mo><mml:mn>99.80</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:mstyle></mml:math></inline-formula>. In addition, we excluded any genomes with CheckM (<xref ref-type="bibr" rid="bib33">Parks et al., 2015</xref>) completeness less than 98% and contamination greater than 5%. We then selected the genome with the ANI closest to 99.50%. Our reasoning for this range exclusion is that genomes with <inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>a</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>99.80</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> are almost always members of the same sequence type (ST) (<xref ref-type="bibr" rid="bib39">Rodriguez-R et al., 2024</xref>; <xref ref-type="bibr" rid="bib53">Viver et al., 2024</xref>), and we found very little variation between them (data not shown).</p><p>We then identified variants between the reference and donor genomes using both minimap2 (v2.26, <xref ref-type="bibr" rid="bib22">Li, 2018</xref>) and mummer (v4.0.0rc1, <xref ref-type="bibr" rid="bib25">Marçais et al., 2018</xref>). We took the intersection of the variants identified by minimap2 and mummer into a single variant call file (VCF) and used BCFtools (v1.19, <xref ref-type="bibr" rid="bib8">Danecek et al., 2021</xref>) to decompose multi-nucleotide polymorphisms (MNPs) into SNPs, left-align and normalise indels, remove duplicate and overlapping variants, and exclude any indel longer than 50 bp. The resulting VCF file is our truthset.</p><p>Next, we generated a mutated reference genome, which we used as the reference against which variants were called by the different methods we assess. BCFtools’ <monospace>consensus</monospace> subcommand was used to apply the truthset of variants to the sample reference, thus producing a mutated reference.</p></sec><sec id="s4-5"><title>Alignment and variant calling</title><p>ONT reads were aligned to the mutated reference with minimap2 using options <monospace>--cs --MD -aLx map-ont</monospace> and output to a BAM alignment file.</p><p>Variant calling was performed from the alignment files with BCFtools (v1.19, <xref ref-type="bibr" rid="bib8">Danecek et al., 2021</xref>), Clair3 (v1.0.5, <xref ref-type="bibr" rid="bib59">Zheng et al., 2022</xref>), DeepVariant (v1.6.0, <xref ref-type="bibr" rid="bib36">Poplin et al., 2018</xref>), FreeBayes (v1.3.7, <xref ref-type="bibr" rid="bib13">Garrison, 2012</xref>), Longshot (v0.4.5, <xref ref-type="bibr" rid="bib11">Edge and Bansal, 2019</xref>), and NanoCaller (v3.4.1, <xref ref-type="bibr" rid="bib1">Ahsan et al., 2021</xref>). In addition, variant calling was performed directly from the reads for Medaka (v1.11.3, <xref ref-type="bibr" rid="bib31">Oxford Nanopore Technologies, 2023b</xref>) as Medaka does its own alignment with minimap2. Individual parameters used for each variant caller can be found in the accompanying GitHub repository (<xref ref-type="bibr" rid="bib17">Hall, 2024a</xref>; <xref ref-type="bibr" rid="bib16">Hall, 2023</xref>).</p><p>Where a variant caller provided an option to set the expected ploidy, haploid was given. In addition, where a minimum read depth or base quality option was available, a value of 2 and 10, respectively, was used in order to try and make downstream assessment and filtering consistent across callers.</p><p>For Clair3, the pretrained models for Dorado model v4.3.0 provided by ONT were used (<xref ref-type="bibr" rid="bib32">Oxford Nanopore Technologies, 2023c</xref>). However, as no fast model is available, we used the hac model with the fast-basecalled reads. The pretrained model option <monospace>--model_type ONT_R104</monospace> was used with DeepVariant, and the default model was used for NanoCaller. For Medaka, the provided v4.3.0 sup and hac models were used, with the hac model being used for fast data as no fast model is available.</p><p>For the Illumina variant calls that act as a benchmark to compare ONT against, we chose Snippy (<xref ref-type="bibr" rid="bib42">Seemann, 2015</xref>) due to it being tailored for haploid genomes and being one of the best performing variant callers on Illumina data (<xref ref-type="bibr" rid="bib4">Bush et al., 2020</xref>). Snippy performs alignment of reads with BWA-MEM (<xref ref-type="bibr" rid="bib20">Li, 2013</xref>) and calls variants with FreeBayes.</p><p>VCFs were then filtered to remove overlapping variants, make heterozygous calls homozygous for the allele with the most depth, normalise and left-align indels, break MNPs into SNPs, and remove indels longer than 50 bp, all with BCFtools.</p></sec><sec id="s4-6"><title>Variant call assessment</title><p>Filtered VCFs were assessed with vcfdist (v2.3.3, <xref ref-type="bibr" rid="bib10">Dunn and Narayanasamy, 2023</xref>) using the truth VCFs and mutated references from Truthset and reference generation. We disabled partial credit with <monospace>--credit-threshold 1.0</monospace> and set the maximum variant quality threshold (<monospace>-mx</monospace>) to the maximum in the VCF being assessed.</p></sec><sec id="s4-7"><title>Identifying repetitive regions</title><p>To identify repetitive regions in the mutated reference, we used the following mummer utilities. <monospace>nucmer --maxmatch --nosimplify</monospace> to align the reference against itself and retain non-unique alignments. We then passed the output into <monospace>show-coords -rTH -I 60</monospace> to obtain the coordinates for all alignments with an identity of 60% or greater. Alignments where the start and end coordinates of the alignment do not match are considered as repeats and these are output in the BED format, with intervals being merged with BEDtools (<xref ref-type="bibr" rid="bib37">Quinlan and Hall, 2010</xref>).</p></sec><sec id="s4-8"><title>Code availability</title><p>All code to perform the analyses in this work are available on GitHub and archived on Zenodo (<xref ref-type="bibr" rid="bib17">Hall, 2024a</xref>; <xref ref-type="bibr" rid="bib16">Hall, 2023</xref>).</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>Has received support from ONT to present his findings at scientific conferences; ONT played no role in study design, execution, analysis, or publication. Received research funding from ONT unrelated to this project</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Investigation, Visualization, Methodology, Writing – original draft, Project administration, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Data curation, Software, Formal analysis, Investigation, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Resources, Data curation, Investigation, Methodology, Writing – original draft, Project administration, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Resources, Investigation, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Data curation, Software, Formal analysis, Investigation, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con6"><p>Resources, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con7"><p>Resources, Supervision, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con8"><p>Conceptualization, Supervision, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con9"><p>Conceptualization, Resources, Supervision, Funding acquisition, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con10"><p>Conceptualization, Resources, Supervision, Funding acquisition, Methodology, Writing – original draft, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Supplementary tables.</title><p>(<bold>a</bold>) Sequencing read quality metrics. (<bold>b</bold>) Full details of the donor genomes summarised in <xref ref-type="table" rid="table1">Table 1</xref>. (<bold>c</bold>) Summary of the F1 score, precision, and recall at the best F1 score for each variant caller. (<bold>d</bold>) Variant calling results for each sample across all conditions. (<bold>e</bold>) Variant call file (VCF) quality scores that produce the optimal F1 score. (<bold>f</bold>) Summary statistics of CPU and memory usage presented in <xref ref-type="fig" rid="fig8">Figure 8</xref>. (<bold>g</bold>) GPU basecalling runtime statistics. (<bold>h</bold>) Accession numbers and DOIs for each sample’s sequencing data. (<bold>i</bold>) Information about the sequencing strategy for each sample on each platform.</p></caption><media xlink:href="elife-98300-supp1-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-98300-mdarchecklist1-v1.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>The unfiltered FASTQ, and assembly files generated in this study have been submitted to the NCBI BioProject database under accession numbers PRJNA1087001 and PRJNA1042815. See <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1h</xref> for a list of all Assembly, BioSample and Run accessions, as well as DOIs for raw ONT pod5 data. Variant truthsets and associated data are archived on Zenodo (<xref ref-type="bibr" rid="bib18">Hall, 2024b</xref>).</p><p>The following datasets were generated:</p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset1"><person-group person-group-type="author"><name><surname>Hall</surname><given-names>MB</given-names></name><name><surname>Wick</surname><given-names>RR</given-names></name><name><surname>Judd</surname><given-names>LM</given-names></name><name><surname>Nguyen</surname><given-names>ANT</given-names></name><name><surname>Steinig</surname><given-names>EJ</given-names></name><name><surname>Xie</surname><given-names>O</given-names></name><name><surname>Davies</surname><given-names>MR</given-names></name><name><surname>Seemann</surname><given-names>T</given-names></name><name><surname>Stinear</surname><given-names>TP</given-names></name><name><surname>Coin</surname><given-names>LJM</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>Sequencing data from: Benchmarking reveals superiority of deep learning variant callers on bacterial nanopore sequence data</data-title><source>NCBI BioProject</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA1087001/">PRJNA1087001</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset2"><person-group person-group-type="author"><name><surname>Wick</surname><given-names>RR</given-names></name><name><surname>Judd</surname><given-names>LM</given-names></name><name><surname>Stinear</surname><given-names>TP</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>ATCC genome sequencing</data-title><source>NCBI BioProject</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA1042815/">PRJNA1042815</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>This research was performed in part at Doherty Applied Microbial Genomics, Department of Microbiology and Immunology, The University of Melbourne at the Peter Doherty Institute for Infection and Immunity. This research was supported by the University of Melbourne’s Research Computing Services and the Petascale Campus Initiative. We are grateful to Bart Currie and Tony Korman for providing the <italic>S. dysgalactiae</italic> (MMC234__202311) and <italic>S. pyogenes</italic> (RDH275__202311) samples. We thank Zamin Iqbal and Martin Hunt for insightful discussions relating to truthset and reference generation. We would also like to thank Romain Guérillot and Miranda Pitt for invaluable feedback throughout the project. Funding: This work was supported by the Australian Government Medical Research Future Fund (MRFF) Genomics Health Futures Mission (GHFM) Flagships – Pathogen Genomics Grant (FSPGN000045) META-GP: DELIVERING A CLINICAL METAGENOMICS PLATFORM FOR AUSTRALIA. The funding body had no role in the design, analysis, interpretation, or writing of this work.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahsan</surname><given-names>MU</given-names></name><name><surname>Liu</surname><given-names>Q</given-names></name><name><surname>Fang</surname><given-names>L</given-names></name><name><surname>Wang</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>NanoCaller for accurate detection of SNPs and indels in difficult-to-map regions from long-read sequencing by haplotype-aware deep neural networks</article-title><source>Genome Biology</source><volume>22</volume><elocation-id>261</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-021-02472-2</pub-id><pub-id pub-id-type="pmid">34488830</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bertels</surname><given-names>F</given-names></name><name><surname>Silander</surname><given-names>OK</given-names></name><name><surname>Pachkov</surname><given-names>M</given-names></name><name><surname>Rainey</surname><given-names>PB</given-names></name><name><surname>van Nimwegen</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Automated reconstruction of whole-genome phylogenies from short-sequence reads</article-title><source>Molecular Biology and Evolution</source><volume>31</volume><fpage>1077</fpage><lpage>1088</lpage><pub-id pub-id-type="doi">10.1093/molbev/msu088</pub-id><pub-id pub-id-type="pmid">24600054</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bouras</surname><given-names>G</given-names></name><name><surname>Judd</surname><given-names>LM</given-names></name><name><surname>Edwards</surname><given-names>RA</given-names></name><name><surname>Vreugde</surname><given-names>S</given-names></name><name><surname>Stinear</surname><given-names>TP</given-names></name><name><surname>Wick</surname><given-names>RR</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>How low can you go? Short-read polishing of Oxford Nanopore bacterial genome assemblies</article-title><source>Microbial Genomics</source><volume>10</volume><elocation-id>001254</elocation-id><pub-id pub-id-type="doi">10.1099/mgen.0.001254</pub-id><pub-id pub-id-type="pmid">38833287</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bush</surname><given-names>SJ</given-names></name><name><surname>Foster</surname><given-names>D</given-names></name><name><surname>Eyre</surname><given-names>DW</given-names></name><name><surname>Clark</surname><given-names>EL</given-names></name><name><surname>De Maio</surname><given-names>N</given-names></name><name><surname>Shaw</surname><given-names>LP</given-names></name><name><surname>Stoesser</surname><given-names>N</given-names></name><name><surname>Peto</surname><given-names>TEA</given-names></name><name><surname>Crook</surname><given-names>DW</given-names></name><name><surname>Walker</surname><given-names>AS</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Genomic diversity affects the accuracy of bacterial single-nucleotide polymorphism-calling pipelines</article-title><source>GigaScience</source><volume>9</volume><elocation-id>giaa007</elocation-id><pub-id pub-id-type="doi">10.1093/gigascience/giaa007</pub-id><pub-id pub-id-type="pmid">32025702</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bush</surname><given-names>SJ</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Generalizable characteristics of false-positive bacterial variant calls</article-title><source>Microbial Genomics</source><volume>7</volume><elocation-id>000615</elocation-id><pub-id pub-id-type="doi">10.1099/mgen.0.000615</pub-id><pub-id pub-id-type="pmid">34346861</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>S</given-names></name><name><surname>Zhou</surname><given-names>Y</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Gu</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>fastp: an ultra-fast all-in-one FASTQ preprocessor</article-title><source>Bioinformatics</source><volume>34</volume><fpage>i884</fpage><lpage>i890</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bty560</pub-id><pub-id pub-id-type="pmid">30423086</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chiu</surname><given-names>CY</given-names></name><name><surname>Miller</surname><given-names>SA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Clinical metagenomics</article-title><source>Nature Reviews. Genetics</source><volume>20</volume><fpage>341</fpage><lpage>355</lpage><pub-id pub-id-type="doi">10.1038/s41576-019-0113-7</pub-id><pub-id pub-id-type="pmid">30918369</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Danecek</surname><given-names>P</given-names></name><name><surname>Bonfield</surname><given-names>JK</given-names></name><name><surname>Liddle</surname><given-names>J</given-names></name><name><surname>Marshall</surname><given-names>J</given-names></name><name><surname>Ohan</surname><given-names>V</given-names></name><name><surname>Pollard</surname><given-names>MO</given-names></name><name><surname>Whitwham</surname><given-names>A</given-names></name><name><surname>Keane</surname><given-names>T</given-names></name><name><surname>McCarthy</surname><given-names>SA</given-names></name><name><surname>Davies</surname><given-names>RM</given-names></name><name><surname>Li</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Twelve years of SAMtools and BCFtools</article-title><source>GigaScience</source><volume>10</volume><elocation-id>giab008</elocation-id><pub-id pub-id-type="doi">10.1093/gigascience/giab008</pub-id><pub-id pub-id-type="pmid">33590861</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Delahaye</surname><given-names>C</given-names></name><name><surname>Nicolas</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Sequencing DNA with nanopores: Troubles and biases</article-title><source>PLOS ONE</source><volume>16</volume><elocation-id>e0257521</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0257521</pub-id><pub-id pub-id-type="pmid">34597327</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dunn</surname><given-names>T</given-names></name><name><surname>Narayanasamy</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>vcfdist: accurately benchmarking phased small variant calls in human genomes</article-title><source>Nature Communications</source><volume>14</volume><elocation-id>8149</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-023-43876-x</pub-id><pub-id pub-id-type="pmid">38071244</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edge</surname><given-names>P</given-names></name><name><surname>Bansal</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Longshot enables accurate variant calling in diploid genomes from single-molecule long read sequencing</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>4660</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-12493-y</pub-id><pub-id pub-id-type="pmid">31604920</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faria</surname><given-names>NR</given-names></name><name><surname>Sabino</surname><given-names>EC</given-names></name><name><surname>Nunes</surname><given-names>MRT</given-names></name><name><surname>Alcantara</surname><given-names>LCJ</given-names></name><name><surname>Loman</surname><given-names>NJ</given-names></name><name><surname>Pybus</surname><given-names>OG</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Mobile real-time surveillance of Zika virus in Brazil</article-title><source>Genome Medicine</source><volume>8</volume><elocation-id>97</elocation-id><pub-id pub-id-type="doi">10.1186/s13073-016-0356-2</pub-id><pub-id pub-id-type="pmid">27683027</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Garrison</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Haplotype-based variant detection from short-read sequencing</article-title><source>arXiv</source><pub-id pub-id-type="doi">10.48550/arXiv.1207.3907</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gorrie</surname><given-names>CL</given-names></name><name><surname>Da Silva</surname><given-names>AG</given-names></name><name><surname>Ingle</surname><given-names>DJ</given-names></name><name><surname>Higgs</surname><given-names>C</given-names></name><name><surname>Seemann</surname><given-names>T</given-names></name><name><surname>Stinear</surname><given-names>TP</given-names></name><name><surname>Williamson</surname><given-names>DA</given-names></name><name><surname>Kwong</surname><given-names>JC</given-names></name><name><surname>Grayson</surname><given-names>ML</given-names></name><name><surname>Sherry</surname><given-names>NL</given-names></name><name><surname>Howden</surname><given-names>BP</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Key parameters for genomics-based real-time detection and tracking of multidrug-resistant bacteria: a systematic analysis</article-title><source>The Lancet Microbe</source><volume>2</volume><fpage>e575</fpage><lpage>e583</lpage><pub-id pub-id-type="doi">10.1016/S2666-5247(21)00149-X</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hall</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Rasusa: Randomly subsample sequencing reads to a specified coverage</article-title><source>Journal of Open Source Software</source><volume>7</volume><elocation-id>3941</elocation-id><pub-id pub-id-type="doi">10.21105/joss.03941</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Hall</surname><given-names>MB</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>NanoVarBench: evaluating nanopore-based bacterial variant calling</data-title><version designator="02c0a51">02c0a51</version><source>Github</source><ext-link ext-link-type="uri" xlink:href="https://github.com/mbhall88/NanoVarBench">https://github.com/mbhall88/NanoVarBench</ext-link></element-citation></ref><ref id="bib17"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Hall</surname><given-names>MB</given-names></name></person-group><year iso-8601-date="2024">2024a</year><data-title>Mbhall88/nanovarbench</data-title><version designator="preprint">preprint</version><source>Zenodo</source><ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.10820970">https://doi.org/10.5281/zenodo.10820970</ext-link></element-citation></ref><ref id="bib18"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Hall</surname><given-names>MB</given-names></name></person-group><year iso-8601-date="2024">2024b</year><data-title>NanoVarBench variant truthset files</data-title><version designator="v1">v1</version><source>Zenodo</source><ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.10867171">https://doi.org/10.5281/zenodo.10867171</ext-link></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoenen</surname><given-names>T</given-names></name><name><surname>Groseth</surname><given-names>A</given-names></name><name><surname>Rosenke</surname><given-names>K</given-names></name><name><surname>Fischer</surname><given-names>RJ</given-names></name><name><surname>Hoenen</surname><given-names>A</given-names></name><name><surname>Judson</surname><given-names>SD</given-names></name><name><surname>Martellaro</surname><given-names>C</given-names></name><name><surname>Falzarano</surname><given-names>D</given-names></name><name><surname>Marzi</surname><given-names>A</given-names></name><name><surname>Squires</surname><given-names>RB</given-names></name><name><surname>Wollenberg</surname><given-names>KR</given-names></name><name><surname>de Wit</surname><given-names>E</given-names></name><name><surname>Prescott</surname><given-names>J</given-names></name><name><surname>Safronetz</surname><given-names>D</given-names></name><name><surname>van Doremalen</surname><given-names>N</given-names></name><name><surname>Bushmaker</surname><given-names>T</given-names></name><name><surname>Feldmann</surname><given-names>F</given-names></name><name><surname>McNally</surname><given-names>K</given-names></name><name><surname>Bolay</surname><given-names>FK</given-names></name><name><surname>Fields</surname><given-names>B</given-names></name><name><surname>Sealy</surname><given-names>T</given-names></name><name><surname>Rayfield</surname><given-names>M</given-names></name><name><surname>Nichol</surname><given-names>ST</given-names></name><name><surname>Zoon</surname><given-names>KC</given-names></name><name><surname>Massaquoi</surname><given-names>M</given-names></name><name><surname>Munster</surname><given-names>VJ</given-names></name><name><surname>Feldmann</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Nanopore sequencing as a rapidly deployable ebola outbreak tool</article-title><source>Emerging Infectious Diseases</source><volume>22</volume><fpage>331</fpage><lpage>334</lpage><pub-id pub-id-type="doi">10.3201/eid2202.151796</pub-id><pub-id pub-id-type="pmid">26812583</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://doi.org/10.48550/arXiv.1303.3997">https://doi.org/10.48550/arXiv.1303.3997</ext-link></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Toward better understanding of artifacts in variant calling from high-coverage samples</article-title><source>Bioinformatics</source><volume>30</volume><fpage>2843</fpage><lpage>2851</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btu356</pub-id><pub-id pub-id-type="pmid">24974202</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title><source>Bioinformatics</source><volume>34</volume><fpage>3094</fpage><lpage>3100</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id><pub-id pub-id-type="pmid">29750242</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Bloom</surname><given-names>JM</given-names></name><name><surname>Farjoun</surname><given-names>Y</given-names></name><name><surname>Fleharty</surname><given-names>M</given-names></name><name><surname>Gauthier</surname><given-names>L</given-names></name><name><surname>Neale</surname><given-names>B</given-names></name><name><surname>MacArthur</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A synthetic-diploid benchmark for accurate variant-calling evaluation</article-title><source>Nature Methods</source><volume>15</volume><fpage>595</fpage><lpage>597</lpage><pub-id pub-id-type="doi">10.1038/s41592-018-0054-7</pub-id><pub-id pub-id-type="pmid">30013044</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Majidian</surname><given-names>S</given-names></name><name><surname>Agustinho</surname><given-names>DP</given-names></name><name><surname>Chin</surname><given-names>CS</given-names></name><name><surname>Sedlazeck</surname><given-names>FJ</given-names></name><name><surname>Mahmoud</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Genomic variant benchmark: if you cannot measure it, you cannot improve it</article-title><source>Genome Biology</source><volume>24</volume><elocation-id>221</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-023-03061-1</pub-id><pub-id pub-id-type="pmid">37798733</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marçais</surname><given-names>G</given-names></name><name><surname>Delcher</surname><given-names>AL</given-names></name><name><surname>Phillippy</surname><given-names>AM</given-names></name><name><surname>Coston</surname><given-names>R</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name><name><surname>Zimin</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>MUMmer4: A fast and versatile genome alignment system</article-title><source>PLOS Computational Biology</source><volume>14</volume><elocation-id>e1005944</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005944</pub-id><pub-id pub-id-type="pmid">29373581</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Musila</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Genomic outbreak surveillance in resource-poor settings</article-title><source>Nature Reviews. Genetics</source><volume>23</volume><fpage>522</fpage><lpage>523</lpage><pub-id pub-id-type="doi">10.1038/s41576-022-00500-w</pub-id><pub-id pub-id-type="pmid">35577990</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nilgiriwala</surname><given-names>K</given-names></name><name><surname>Rabodoarivelo</surname><given-names>MS</given-names></name><name><surname>Hall</surname><given-names>MB</given-names></name><name><surname>Patel</surname><given-names>G</given-names></name><name><surname>Mandal</surname><given-names>A</given-names></name><name><surname>Mishra</surname><given-names>S</given-names></name><name><surname>Andrianomanana</surname><given-names>FR</given-names></name><name><surname>Dingle</surname><given-names>K</given-names></name><name><surname>Rodger</surname><given-names>G</given-names></name><name><surname>George</surname><given-names>S</given-names></name><name><surname>Crook</surname><given-names>DW</given-names></name><name><surname>Hoosdally</surname><given-names>S</given-names></name><name><surname>Mistry</surname><given-names>N</given-names></name><name><surname>Rakotosamimanana</surname><given-names>N</given-names></name><name><surname>Iqbal</surname><given-names>Z</given-names></name><name><surname>Grandjean Lapierre</surname><given-names>S</given-names></name><name><surname>Walker</surname><given-names>TM</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Genomic sequencing from sputum for tuberculosis disease diagnosis, lineage determination, and drug susceptibility prediction</article-title><source>Journal of Clinical Microbiology</source><volume>61</volume><elocation-id>e0157822</elocation-id><pub-id pub-id-type="doi">10.1128/jcm.01578-22</pub-id><pub-id pub-id-type="pmid">36815861</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olson</surname><given-names>ND</given-names></name><name><surname>Wagner</surname><given-names>J</given-names></name><name><surname>McDaniel</surname><given-names>J</given-names></name><name><surname>Stephens</surname><given-names>SH</given-names></name><name><surname>Westreich</surname><given-names>ST</given-names></name><name><surname>Prasanna</surname><given-names>AG</given-names></name><name><surname>Johanson</surname><given-names>E</given-names></name><name><surname>Boja</surname><given-names>E</given-names></name><name><surname>Maier</surname><given-names>EJ</given-names></name><name><surname>Serang</surname><given-names>O</given-names></name><name><surname>Jáspez</surname><given-names>D</given-names></name><name><surname>Lorenzo-Salazar</surname><given-names>JM</given-names></name><name><surname>Muñoz-Barrera</surname><given-names>A</given-names></name><name><surname>Rubio-Rodríguez</surname><given-names>LA</given-names></name><name><surname>Flores</surname><given-names>C</given-names></name><name><surname>Kyriakidis</surname><given-names>K</given-names></name><name><surname>Malousi</surname><given-names>A</given-names></name><name><surname>Shafin</surname><given-names>K</given-names></name><name><surname>Pesout</surname><given-names>T</given-names></name><name><surname>Jain</surname><given-names>M</given-names></name><name><surname>Paten</surname><given-names>B</given-names></name><name><surname>Chang</surname><given-names>PC</given-names></name><name><surname>Kolesnikov</surname><given-names>A</given-names></name><name><surname>Nattestad</surname><given-names>M</given-names></name><name><surname>Baid</surname><given-names>G</given-names></name><name><surname>Goel</surname><given-names>S</given-names></name><name><surname>Yang</surname><given-names>H</given-names></name><name><surname>Carroll</surname><given-names>A</given-names></name><name><surname>Eveleigh</surname><given-names>R</given-names></name><name><surname>Bourgey</surname><given-names>M</given-names></name><name><surname>Bourque</surname><given-names>G</given-names></name><name><surname>Li</surname><given-names>G</given-names></name><name><surname>Ma</surname><given-names>C</given-names></name><name><surname>Tang</surname><given-names>L</given-names></name><name><surname>Du</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>S</given-names></name><name><surname>Morata</surname><given-names>J</given-names></name><name><surname>Tonda</surname><given-names>R</given-names></name><name><surname>Parra</surname><given-names>G</given-names></name><name><surname>Trotta</surname><given-names>JR</given-names></name><name><surname>Brueffer</surname><given-names>C</given-names></name><name><surname>Demirkaya-Budak</surname><given-names>S</given-names></name><name><surname>Kabakci-Zorlu</surname><given-names>D</given-names></name><name><surname>Turgut</surname><given-names>D</given-names></name><name><surname>Kalay</surname><given-names>Ö</given-names></name><name><surname>Budak</surname><given-names>G</given-names></name><name><surname>Narcı</surname><given-names>K</given-names></name><name><surname>Arslan</surname><given-names>E</given-names></name><name><surname>Brown</surname><given-names>R</given-names></name><name><surname>Johnson</surname><given-names>IJ</given-names></name><name><surname>Dolgoborodov</surname><given-names>A</given-names></name><name><surname>Semenyuk</surname><given-names>V</given-names></name><name><surname>Jain</surname><given-names>A</given-names></name><name><surname>Tetikol</surname><given-names>HS</given-names></name><name><surname>Jain</surname><given-names>V</given-names></name><name><surname>Ruehle</surname><given-names>M</given-names></name><name><surname>Lajoie</surname><given-names>B</given-names></name><name><surname>Roddey</surname><given-names>C</given-names></name><name><surname>Catreux</surname><given-names>S</given-names></name><name><surname>Mehio</surname><given-names>R</given-names></name><name><surname>Ahsan</surname><given-names>MU</given-names></name><name><surname>Liu</surname><given-names>Q</given-names></name><name><surname>Wang</surname><given-names>K</given-names></name><name><surname>Sahraeian</surname><given-names>SME</given-names></name><name><surname>Fang</surname><given-names>LT</given-names></name><name><surname>Mohiyuddin</surname><given-names>M</given-names></name><name><surname>Hung</surname><given-names>C</given-names></name><name><surname>Jain</surname><given-names>C</given-names></name><name><surname>Feng</surname><given-names>H</given-names></name><name><surname>Li</surname><given-names>Z</given-names></name><name><surname>Chen</surname><given-names>L</given-names></name><name><surname>Sedlazeck</surname><given-names>FJ</given-names></name><name><surname>Zook</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>PrecisionFDA Truth Challenge V2: calling variants from short and long reads in difficult-to-map regions</article-title><source>Cell Genomics</source><volume>2</volume><elocation-id>100129</elocation-id><pub-id pub-id-type="doi">10.1016/j.xgen.2022.100129</pub-id><pub-id pub-id-type="pmid">35720974</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olson</surname><given-names>ND</given-names></name><name><surname>Wagner</surname><given-names>J</given-names></name><name><surname>Dwarshuis</surname><given-names>N</given-names></name><name><surname>Miga</surname><given-names>KH</given-names></name><name><surname>Sedlazeck</surname><given-names>FJ</given-names></name><name><surname>Salit</surname><given-names>M</given-names></name><name><surname>Zook</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Variant calling and benchmarking in an era of complete human genome sequences</article-title><source>Nature Reviews. Genetics</source><volume>24</volume><fpage>464</fpage><lpage>483</lpage><pub-id pub-id-type="doi">10.1038/s41576-023-00590-0</pub-id><pub-id pub-id-type="pmid">37059810</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="software"><person-group person-group-type="author"><collab>Oxford Nanopore Technologies</collab></person-group><year iso-8601-date="2023">2023a</year><data-title>Rerio: research release basecalling models and configurations</data-title><version designator="c0c8ce6">c0c8ce6</version><source>Github</source><ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/rerio">https://github.com/nanoporetech/rerio</ext-link></element-citation></ref><ref id="bib31"><element-citation publication-type="software"><person-group person-group-type="author"><collab>Oxford Nanopore Technologies</collab></person-group><year iso-8601-date="2023">2023b</year><data-title>Dorado: oxford nanopore’s basecaller</data-title><version designator="acec121">acec121</version><source>Github</source><ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/dorado">https://github.com/nanoporetech/dorado</ext-link></element-citation></ref><ref id="bib32"><element-citation publication-type="software"><person-group person-group-type="author"><collab>Oxford Nanopore Technologies</collab></person-group><year iso-8601-date="2023">2023c</year><data-title>Medaka: sequence correction provided by ONT research</data-title><version designator="9df4dee">9df4dee</version><source>Github</source><ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/medaka">https://github.com/nanoporetech/medaka</ext-link></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parks</surname><given-names>DH</given-names></name><name><surname>Imelfort</surname><given-names>M</given-names></name><name><surname>Skennerton</surname><given-names>CT</given-names></name><name><surname>Hugenholtz</surname><given-names>P</given-names></name><name><surname>Tyson</surname><given-names>GW</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>CheckM: assessing the quality of microbial genomes recovered from isolates, single cells, and metagenomes</article-title><source>Genome Research</source><volume>25</volume><fpage>1043</fpage><lpage>1055</lpage><pub-id pub-id-type="doi">10.1101/gr.186072.114</pub-id><pub-id pub-id-type="pmid">25977477</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pei</surname><given-names>S</given-names></name><name><surname>Liu</surname><given-names>T</given-names></name><name><surname>Ren</surname><given-names>X</given-names></name><name><surname>Li</surname><given-names>W</given-names></name><name><surname>Chen</surname><given-names>C</given-names></name><name><surname>Xie</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Benchmarking variant callers in next-generation and third-generation sequencing analysis</article-title><source>Briefings in Bioinformatics</source><volume>22</volume><elocation-id>bbaa148</elocation-id><pub-id pub-id-type="doi">10.1093/bib/bbaa148</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Piro</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>Genome_updater</data-title><version designator="78c3fb5">78c3fb5</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/pirovc/genome_updater">https://github.com/pirovc/genome_updater</ext-link></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poplin</surname><given-names>R</given-names></name><name><surname>Chang</surname><given-names>P-C</given-names></name><name><surname>Alexander</surname><given-names>D</given-names></name><name><surname>Schwartz</surname><given-names>S</given-names></name><name><surname>Colthurst</surname><given-names>T</given-names></name><name><surname>Ku</surname><given-names>A</given-names></name><name><surname>Newburger</surname><given-names>D</given-names></name><name><surname>Dijamco</surname><given-names>J</given-names></name><name><surname>Nguyen</surname><given-names>N</given-names></name><name><surname>Afshar</surname><given-names>PT</given-names></name><name><surname>Gross</surname><given-names>SS</given-names></name><name><surname>Dorfman</surname><given-names>L</given-names></name><name><surname>McLean</surname><given-names>CY</given-names></name><name><surname>DePristo</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A universal SNP and small-indel variant caller using deep neural networks</article-title><source>Nature Biotechnology</source><volume>36</volume><fpage>983</fpage><lpage>987</lpage><pub-id pub-id-type="doi">10.1038/nbt.4235</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quinlan</surname><given-names>AR</given-names></name><name><surname>Hall</surname><given-names>IM</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>BEDTools: a flexible suite of utilities for comparing genomic features</article-title><source>Bioinformatics</source><volume>26</volume><fpage>841</fpage><lpage>842</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btq033</pub-id><pub-id pub-id-type="pmid">20110278</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>JT</given-names></name><name><surname>Thorvaldsdóttir</surname><given-names>H</given-names></name><name><surname>Winckler</surname><given-names>W</given-names></name><name><surname>Guttman</surname><given-names>M</given-names></name><name><surname>Lander</surname><given-names>ES</given-names></name><name><surname>Getz</surname><given-names>G</given-names></name><name><surname>Mesirov</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Integrative genomics viewer</article-title><source>Nature Biotechnology</source><volume>29</volume><fpage>24</fpage><lpage>26</lpage><pub-id pub-id-type="doi">10.1038/nbt.1754</pub-id><pub-id pub-id-type="pmid">21221095</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rodriguez-R</surname><given-names>LM</given-names></name><name><surname>Conrad</surname><given-names>RE</given-names></name><name><surname>Viver</surname><given-names>T</given-names></name><name><surname>Feistel</surname><given-names>DJ</given-names></name><name><surname>Lindner</surname><given-names>BG</given-names></name><name><surname>Venter</surname><given-names>SN</given-names></name><name><surname>Orellana</surname><given-names>LH</given-names></name><name><surname>Amann</surname><given-names>R</given-names></name><name><surname>Rossello-Mora</surname><given-names>R</given-names></name><name><surname>Konstantinidis</surname><given-names>KT</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>An ANI gap within bacterial species that advances the definitions of intra-species units</article-title><source>mBio</source><volume>15</volume><elocation-id>e0269623</elocation-id><pub-id pub-id-type="doi">10.1128/mbio.02696-23</pub-id><pub-id pub-id-type="pmid">38085031</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanderson</surname><given-names>ND</given-names></name><name><surname>Kapel</surname><given-names>N</given-names></name><name><surname>Rodger</surname><given-names>G</given-names></name><name><surname>Webster</surname><given-names>H</given-names></name><name><surname>Lipworth</surname><given-names>S</given-names></name><name><surname>Street</surname><given-names>TL</given-names></name><name><surname>Peto</surname><given-names>T</given-names></name><name><surname>Crook</surname><given-names>D</given-names></name><name><surname>Stoesser</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Comparison of R9.4.1/Kit10 and R10/Kit12 Oxford Nanopore flowcells and chemistries in bacterial genome reconstruction</article-title><source>Microbial Genomics</source><volume>9</volume><elocation-id>mgen000910</elocation-id><pub-id pub-id-type="doi">10.1099/mgen.0.000910</pub-id><pub-id pub-id-type="pmid">36748454</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Sanderson</surname><given-names>ND</given-names></name><name><surname>Hopkins</surname><given-names>K</given-names></name><name><surname>Colpus</surname><given-names>M</given-names></name><name><surname>Parker</surname><given-names>M</given-names></name><name><surname>Lipworth</surname><given-names>S</given-names></name><name><surname>Crook</surname><given-names>D</given-names></name><name><surname>Stoesser</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Evaluation of the accuracy of bacterial genome reconstruction with oxford nanopore R10.4.1 long-read-only sequencing</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2024.01.12.575342</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Seemann</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2015">2015</year><data-title>Snippy: fast bacterial variant calling from NGS reads</data-title><version designator="3362a59">3362a59</version><source>Github</source><ext-link ext-link-type="uri" xlink:href="https://github.com/tseemann/snippy">https://github.com/tseemann/snippy</ext-link></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sereika</surname><given-names>M</given-names></name><name><surname>Kirkegaard</surname><given-names>RH</given-names></name><name><surname>Karst</surname><given-names>SM</given-names></name><name><surname>Michaelsen</surname><given-names>TY</given-names></name><name><surname>Sørensen</surname><given-names>EA</given-names></name><name><surname>Wollenberg</surname><given-names>RD</given-names></name><name><surname>Albertsen</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Oxford Nanopore R10.4 long-read sequencing enables the generation of near-finished bacterial genomes from pure cultures and metagenomes without short-read or reference polishing</article-title><source>Nature Methods</source><volume>19</volume><fpage>823</fpage><lpage>826</lpage><pub-id pub-id-type="doi">10.1038/s41592-022-01539-7</pub-id><pub-id pub-id-type="pmid">35789207</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shaw</surname><given-names>J</given-names></name><name><surname>Yu</surname><given-names>YW</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Fast and robust metagenomic sequence comparison through sparse chaining with skani</article-title><source>Nature Methods</source><volume>20</volume><fpage>1661</fpage><lpage>1665</lpage><pub-id pub-id-type="doi">10.1038/s41592-023-02018-3</pub-id><pub-id pub-id-type="pmid">37735570</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sheka</surname><given-names>D</given-names></name><name><surname>Alabi</surname><given-names>N</given-names></name><name><surname>Gordon</surname><given-names>PMK</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Oxford nanopore sequencing in clinical microbiology and infection diagnostics</article-title><source>Briefings in Bioinformatics</source><volume>22</volume><elocation-id>bbaa403</elocation-id><pub-id pub-id-type="doi">10.1093/bib/bbaa403</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shen</surname><given-names>W</given-names></name><name><surname>Le</surname><given-names>S</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Hu</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>SeqKit: a cross-platform and ultrafast toolkit for FASTA/Q file manipulation</article-title><source>PLOS ONE</source><volume>11</volume><elocation-id>e0163962</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0163962</pub-id><pub-id pub-id-type="pmid">27706213</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sherry</surname><given-names>NL</given-names></name><name><surname>Horan</surname><given-names>KA</given-names></name><name><surname>Ballard</surname><given-names>SA</given-names></name><name><surname>Gonҫalves da Silva</surname><given-names>A</given-names></name><name><surname>Gorrie</surname><given-names>CL</given-names></name><name><surname>Schultz</surname><given-names>MB</given-names></name><name><surname>Stevens</surname><given-names>K</given-names></name><name><surname>Valcanis</surname><given-names>M</given-names></name><name><surname>Sait</surname><given-names>ML</given-names></name><name><surname>Stinear</surname><given-names>TP</given-names></name><name><surname>Howden</surname><given-names>BP</given-names></name><name><surname>Seemann</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>An ISO-certified genomics workflow for identification and surveillance of antimicrobial resistance</article-title><source>Nature Communications</source><volume>14</volume><elocation-id>60</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-022-35713-4</pub-id><pub-id pub-id-type="pmid">36599823</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stimson</surname><given-names>J</given-names></name><name><surname>Gardy</surname><given-names>J</given-names></name><name><surname>Mathema</surname><given-names>B</given-names></name><name><surname>Crudu</surname><given-names>V</given-names></name><name><surname>Cohen</surname><given-names>T</given-names></name><name><surname>Colijn</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Beyond the SNP Threshold: identifying outbreak clusters using inferred transmissions</article-title><source>Molecular Biology and Evolution</source><volume>36</volume><fpage>587</fpage><lpage>603</lpage><pub-id pub-id-type="doi">10.1093/molbev/msy242</pub-id><pub-id pub-id-type="pmid">30690464</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stoler</surname><given-names>N</given-names></name><name><surname>Nekrutenko</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Sequencing error profiles of Illumina sequencing instruments</article-title><source>NAR Genomics and Bioinformatics</source><volume>3</volume><elocation-id>lqab019</elocation-id><pub-id pub-id-type="doi">10.1093/nargab/lqab019</pub-id><pub-id pub-id-type="pmid">33817639</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Street</surname><given-names>TL</given-names></name><name><surname>Barker</surname><given-names>L</given-names></name><name><surname>Sanderson</surname><given-names>ND</given-names></name><name><surname>Kavanagh</surname><given-names>J</given-names></name><name><surname>Hoosdally</surname><given-names>S</given-names></name><name><surname>Cole</surname><given-names>K</given-names></name><name><surname>Newnham</surname><given-names>R</given-names></name><name><surname>Selvaratnam</surname><given-names>M</given-names></name><name><surname>Andersson</surname><given-names>M</given-names></name><name><surname>Llewelyn</surname><given-names>MJ</given-names></name><name><surname>O’Grady</surname><given-names>J</given-names></name><name><surname>Crook</surname><given-names>DW</given-names></name><name><surname>Eyre</surname><given-names>DW</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Optimizing DNA extraction methods for nanopore sequencing of neisseria gonorrhoeae directly from urine samples</article-title><source>Journal of Clinical Microbiology</source><volume>58</volume><elocation-id>e01822-19</elocation-id><pub-id pub-id-type="doi">10.1128/JCM.01822-19</pub-id><pub-id pub-id-type="pmid">31852766</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tourancheau</surname><given-names>A</given-names></name><name><surname>Mead</surname><given-names>EA</given-names></name><name><surname>Zhang</surname><given-names>X-S</given-names></name><name><surname>Fang</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Discovering multiple types of DNA methylation from bacteria and microbiome using nanopore sequencing</article-title><source>Nature Methods</source><volume>18</volume><fpage>491</fpage><lpage>498</lpage><pub-id pub-id-type="doi">10.1038/s41592-021-01109-3</pub-id><pub-id pub-id-type="pmid">33820988</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Treangen</surname><given-names>TJ</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Repetitive DNA and next-generation sequencing: computational challenges and solutions</article-title><source>Nature Reviews. Genetics</source><volume>13</volume><fpage>36</fpage><lpage>46</lpage><pub-id pub-id-type="doi">10.1038/nrg3117</pub-id><pub-id pub-id-type="pmid">22124482</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Viver</surname><given-names>T</given-names></name><name><surname>Conrad</surname><given-names>RE</given-names></name><name><surname>Rodriguez-R</surname><given-names>LM</given-names></name><name><surname>Ramírez</surname><given-names>AS</given-names></name><name><surname>Venter</surname><given-names>SN</given-names></name><name><surname>Rocha-Cárdenas</surname><given-names>J</given-names></name><name><surname>Llabrés</surname><given-names>M</given-names></name><name><surname>Amann</surname><given-names>R</given-names></name><name><surname>Konstantinidis</surname><given-names>KT</given-names></name><name><surname>Rossello-Mora</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Towards estimating the number of strains that make up a natural bacterial population</article-title><source>Nature Communications</source><volume>15</volume><elocation-id>544</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-023-44622-z</pub-id><pub-id pub-id-type="pmid">38228587</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Walker</surname><given-names>TM</given-names></name><name><surname>Miotto</surname><given-names>P</given-names></name><name><surname>Köser</surname><given-names>CU</given-names></name><name><surname>Fowler</surname><given-names>PW</given-names></name><name><surname>Knaggs</surname><given-names>J</given-names></name><name><surname>Iqbal</surname><given-names>Z</given-names></name><name><surname>Hunt</surname><given-names>M</given-names></name><name><surname>Chindelevitch</surname><given-names>L</given-names></name><name><surname>Farhat</surname><given-names>M</given-names></name><name><surname>Cirillo</surname><given-names>DM</given-names></name><name><surname>Comas</surname><given-names>I</given-names></name><name><surname>Posey</surname><given-names>J</given-names></name><name><surname>Omar</surname><given-names>SV</given-names></name><name><surname>Peto</surname><given-names>TE</given-names></name><name><surname>Suresh</surname><given-names>A</given-names></name><name><surname>Uplekar</surname><given-names>S</given-names></name><name><surname>Laurent</surname><given-names>S</given-names></name><name><surname>Colman</surname><given-names>RE</given-names></name><name><surname>Nathanson</surname><given-names>CM</given-names></name><name><surname>Zignol</surname><given-names>M</given-names></name><name><surname>Walker</surname><given-names>AS</given-names></name><collab>CRyPTIC Consortium</collab><collab>Seq&amp;Treat Consortium</collab><name><surname>Crook</surname><given-names>DW</given-names></name><name><surname>Ismail</surname><given-names>N</given-names></name><name><surname>Rodwell</surname><given-names>TC</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>The 2021 WHO catalogue of <italic>Mycobacterium tuberculosis</italic> complex mutations associated with drug resistance: A genotypic analysis</article-title><source>The Lancet. Microbe</source><volume>3</volume><fpage>e265</fpage><lpage>e273</lpage><pub-id pub-id-type="doi">10.1016/S2666-5247(21)00301-3</pub-id><pub-id pub-id-type="pmid">35373160</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Wick</surname><given-names>RR</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Filtlong: quality filtering tool for long reads</data-title><version designator="7c654f1">7c654f1</version><source>Github</source><ext-link ext-link-type="uri" xlink:href="https://github.com/rrwick/Filtlong">https://github.com/rrwick/Filtlong</ext-link></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wick</surname><given-names>RR</given-names></name><name><surname>Judd</surname><given-names>LM</given-names></name><name><surname>Cerdeira</surname><given-names>LT</given-names></name><name><surname>Hawkey</surname><given-names>J</given-names></name><name><surname>Méric</surname><given-names>G</given-names></name><name><surname>Vezina</surname><given-names>B</given-names></name><name><surname>Wyres</surname><given-names>KL</given-names></name><name><surname>Holt</surname><given-names>KE</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Trycycler: consensus long-read assemblies for bacterial genomes</article-title><source>Genome Biology</source><volume>22</volume><elocation-id>266</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-021-02483-z</pub-id><pub-id pub-id-type="pmid">34521459</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wick</surname><given-names>RR</given-names></name><name><surname>Holt</surname><given-names>KE</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Polypolish: Short-read polishing of long-read bacterial genome assemblies</article-title><source>PLOS Computational Biology</source><volume>18</volume><elocation-id>e1009802</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1009802</pub-id><pub-id pub-id-type="pmid">35073327</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wick</surname><given-names>RR</given-names></name><name><surname>Judd</surname><given-names>LM</given-names></name><name><surname>Holt</surname><given-names>KE</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Assembling the perfect bacterial genome using Oxford Nanopore and Illumina sequencing</article-title><source>PLOS Computational Biology</source><volume>19</volume><elocation-id>e1010905</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1010905</pub-id><pub-id pub-id-type="pmid">36862631</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>Z</given-names></name><name><surname>Li</surname><given-names>S</given-names></name><name><surname>Su</surname><given-names>J</given-names></name><name><surname>Leung</surname><given-names>AWS</given-names></name><name><surname>Lam</surname><given-names>TW</given-names></name><name><surname>Luo</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Symphonizing pileup and full-alignment for deep learning-based long-read variant calling</article-title><source>Nature Computational Science</source><volume>2</volume><fpage>797</fpage><lpage>803</lpage><pub-id pub-id-type="doi">10.1038/s43588-022-00387-x</pub-id><pub-id pub-id-type="pmid">38177392</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>A</given-names></name><name><surname>Lin</surname><given-names>T</given-names></name><name><surname>Xing</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Evaluating nanopore sequencing data processing pipelines for structural variation identification</article-title><source>Genome Biology</source><volume>20</volume><elocation-id>237</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-019-1858-1</pub-id><pub-id pub-id-type="pmid">31727126</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zimin</surname><given-names>AV</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The genome polishing tool POLCA makes fast and accurate corrections in genome assemblies</article-title><source>PLOS Computational Biology</source><volume>16</volume><elocation-id>e1007981</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1007981</pub-id><pub-id pub-id-type="pmid">32589667</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec sec-type="appendix" id="s8"><title><italic>Streptococcus</italic> sample selection</title><p>MMC234__202311 and RDH275__202311 were collected as part of an invasive streptococcal surveillance study in Australia (approved by the Royal Melbourne Hospital Human Research Ethics Committee [HREC/80105/MH-2021] and the Human Research Ethics Committee of the Northern Territory Depart of Health and Menzies School of Health Research [2021-4181]).</p></sec></app><app id="appendix-2"><title>Appendix 2</title><sec sec-type="appendix" id="s9"><title>Simplex F1 outlier</title><p>From <xref ref-type="fig" rid="fig2">Figure 2</xref> in the main text it is clear that in the simplex SNP panel (top left) there is a single outlier for the sup model for most variant callers. This sample is the same across the variant callers – ATCC_25922 (<italic>E. coli</italic>). We chose to investigate the reason for this outlier using the Clair3 (simplex sup) variant calls. The reason for the lower F1 score was reduced recall (as seen in <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). ATCC_25922 had 47 FN variants, with 45 of those coming from two repetitive regions (see Identifying repetitive regions in the main text). In addition, these two regions have a higher variant density compared to the rest of the genome and are the repeats of each other. The two regions are 7.5 Kbp long and have an identity of 96.5%. As can be seen from <xref ref-type="fig" rid="fig1">Figure 1</xref>, there is a lot of heterogeneity at the FN site. This is caused by reads from the reciprocal region multi-mapping to this region. <xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2</xref> shows a textual representation of the of the two sequences. Position 3 is the FN, where we expect a C&gt;T variant call. While 50% of the bases at position 3 are indeed T, and 34% are C, Clair3 and most other callers fail to call this site a variant site. This pattern of heterogeneity leading to missed calls was repeated for the other FNs within these repeats. Highlighting that even though deep learning callers using R10 ONT data deal much better with repetitive and variant-dense regions, they can still struggle when you have both of these difficulties combined to a high degree. However, it is interesting to note that Medaka did not have the same issues with missed variants for these sites. Assumably the model training for Medaka is sufficiently different to DeepVariant and Clair3 to allow it to deal with these difficult sites without issue.</p><p>The other notable outlier from <xref ref-type="fig" rid="fig2">Figure 2</xref> in the main text is in the duplex SNP panel (top right). This outlier is sample KPC2_202310 (<italic>K. pneumoniae</italic>). The reason for its reduced F1 score is again to do with recall. However, this reduced recall is simply due to the fact that the duplex depth for this sample is only 3×.</p><fig id="app2fig1" position="float"><label>Appendix 2—figure 1.</label><caption><title>Pileup surrounding a Clair3 false negative variant.</title><p>The top track (four blue rectangles) shows true variants – i.e., variants we expect to find. The second track shows a single false negative variant. The third track shows the alignment of Oxford Nanopore Technologies (ONT) reads to this region, with coloured letters indicating where the aligned sequence disagrees with the reference. The fourth track shows the alignment of Illumina reads. The fifth track is the reference sequence. The bottom track shows repetitive regions (the whole region is repetitive as the blue rectangle spans the whole region in view).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-app2-fig1-v1.tif"/></fig><fig id="app2fig2" position="float"><label>Appendix 2—figure 2.</label><caption><title>Textual example of two small repetitive regions in sample ATCC_25922 that lead to a false negative at position 3 in sequence S1.</title><p>Positions 1 and 2 are two other variant positions where a true positive was obtained for S1 (the expected variants at positions 1 and 2 match the sequence in S2).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-98300-app2-fig2-v1.tif"/></fig></sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.98300.3.sa0</article-id><title-group><article-title>eLife assessment</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Weigel</surname><given-names>Detlef</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>Max Planck Institute for Biology Tübingen</institution><country>Germany</country></aff></contrib></contrib-group><kwd-group kwd-group-type="evidence-strength"><kwd>Convincing</kwd></kwd-group><kwd-group kwd-group-type="claim-importance"><kwd>Important</kwd></kwd-group></front-stub><body><p>This <bold>important</bold> study shows how a combination of the latest generation of Oxford Nanopore Technology long reads with state-of-the art variant callers enables bacterial variant discovery at an accuracy that matches or exceeds the current &quot;gold standard&quot; with short reads. The work thus heralds a new era, in which Illumina short-read sequencing no longer rules supreme. While the inclusion of a larger number of reference genomes would have enabled an even more fine-grained analysis, the evidence as it is supports the claims of the authors <bold>convincingly</bold>. The work will be of interest to anyone performing sequencing for outbreak investigations, bacterial epidemiology, or similar studies.</p></body></sub-article><sub-article article-type="referee-report" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.98300.3.sa1</article-id><title-group><article-title>Reviewer #2 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>Hall et al describe the superiority of ONT sequencing and deep learning-based variant callers to deliver higher SNP and Indel accuracy compared to previous gold-standard Illumina short-read sequencing. Furthermore, they provide recommendations for read sequencing depth and computational requirements when performing variant calling.</p><p>Strengths:</p><p>The study describes compelling data showing ONT superiority when using deep learning-based variant callers, such as Clair3, compared to Illumina sequencing. This challenges the paradigm that Illumina sequencing is the gold standard for variant calling in bacterial genomes. The authors provide evidence that homopolymeric regions, a systematic and problematic issue with ONT data, are no longer a concern in ONT sequencing.</p><p>Weaknesses:</p><p>The study is limited in the number of samples included, even though it covers different species with divergent genome sequences, likely covering major evolutionary changes. The methods section could be more detailed. A structural variation analysis would be an interesting next step.</p></body></sub-article><sub-article article-type="referee-report" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.98300.3.sa2</article-id><title-group><article-title>Reviewer #3 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Hall et al. benchmarked different variant calling methods on Nanopore reads of bacterial samples and compared the performance of Nanopore to short reads produced with Illumina sequencing. To establish a common ground for comparison, the authors first generated a variant truthset for each sample and then projected this set to the reference sequence of the sample to obtain a mutated reference. Subsequently, Hall et al. called SNPs and small indels using commonly used deep learning and conventional variant callers and compared the precision and accuracy from reads produced with simplex and duplex Nanopore sequencing to Illumina data. The authors did not investigate large structural variation, which is a major limitation of the current manuscript. It will be very interesting to see a follow-up study covering this much more challenging type of variation.</p><p>In their comprehensive comparison of SNPs and small indels, the authors observed superior performance of deep learning over conventional variant callers when Nanopore reads were basecalled with the most accurate (but also computationally very expensive) model, even exceeding Illumina in some cases. Not surprisingly, Nanopore underperformed compared to Illumina when basecalled with the fastest (but computationally much less demanding) method with the lowest accuracy. The authors then investigated the surprisingly higher performance of Nanopore data in some cases and identified lower recall with Illumina short read data, particularly from repetitive regions and regions with high variant density, as the driver. Combining the most accurate Nanopore basecalling method with a deep learning variant caller resulted in low error rates in homopolymer regions, similar to Illumina data. This is remarkable, as homopolymer regions are (or, were) traditionally challenging for Nanopore sequencing.</p><p>Lastly, Hall et al. provided useful information on the required Nanopore read depth, which is surprisingly low, and the computational resources for variant calling with deep learning callers. With that, the authors established a new state-of-the-art for Nanopore-only variant calling on bacterial sequencing data. Most likely these findings will be transferred to other organisms as well or at least provide a proof-of-concept that can be built upon.</p><p>As the authors mention multiple times throughout the manuscript, Nanopore can provide sequencing data in nearly real-time and in remote regions, therefore opening up a ton of new possibilities, for example for infectious disease surveillance. In these scenarios, computational resources can be very limited. The highest-performing variant calling method, as established in this study, requires the computationally very expensive sup and/or duplex nanopore basecalling, while the least computationally demanding basecalling method underperforms. To comprehensively guide users through the computational resources required for basecalling and variant calling, the authors provide runtime benchmarks assuming GPU access.</p></body></sub-article><sub-article article-type="author-comment" id="sa3"><front-stub><article-id pub-id-type="doi">10.7554/eLife.98300.3.sa3</article-id><title-group><article-title>Author response</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Hall</surname><given-names>Michael B</given-names></name><role specific-use="author">Author</role><aff><institution>Peter Doherty Institute</institution><addr-line><named-content content-type="city">Melbourne</named-content></addr-line><country>Australia</country></aff></contrib><contrib contrib-type="author"><name><surname>Wick</surname><given-names>Ryan R</given-names></name><role specific-use="author">Author</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01ej9dk98</institution-id><institution>Department of Microbiology and Immunology, The University of Melbourne, at the Peter Doherty Institute for Infection and Immunity, Melbourne, Australia</institution></institution-wrap><addr-line><named-content content-type="city">Melbourne</named-content></addr-line><country>Australia</country></aff></contrib><contrib contrib-type="author"><name><surname>Judd</surname><given-names>Louise M</given-names></name><role specific-use="author">Author</role><aff><institution>Monash University</institution><addr-line><named-content content-type="city">Melbourne</named-content></addr-line><country>Australia</country></aff></contrib><contrib contrib-type="author"><name><surname>Nguyen</surname><given-names>An N</given-names></name><role specific-use="author">Author</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01ej9dk98</institution-id><institution>Department of Microbiology and Immunology, The University of Melbourne, at the Peter Doherty Institute for Infection and Immunity, Melbourne, Australia</institution></institution-wrap><addr-line><named-content content-type="city">Melbourne</named-content></addr-line><country>Australia</country></aff></contrib><contrib contrib-type="author"><name><surname>Steinig</surname><given-names>Eike J</given-names></name><role specific-use="author">Author</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01ej9dk98</institution-id><institution>Department of Microbiology and Immunology, The University of Melbourne, at the Peter Doherty Institute for Infection and Immunity, Melbourne, Australia</institution></institution-wrap><addr-line><named-content content-type="city">Melbourne</named-content></addr-line><country>Australia</country></aff></contrib><contrib contrib-type="author"><name><surname>Xie</surname><given-names>Ouli</given-names></name><role specific-use="author">Author</role><aff><institution>Department of Infectious Diseases, The University of Melbourne, at the Peter Doherty Institute for Infection and Immunity, Melbourne, Australia</institution><addr-line><named-content content-type="city">Melbourne</named-content></addr-line><country>Australia</country></aff></contrib><contrib contrib-type="author"><name><surname>Davies</surname><given-names>Mark</given-names></name><role specific-use="author">Author</role><aff><institution>The University of Melbourne</institution><addr-line><named-content content-type="city">Melbourne</named-content></addr-line><country>Australia</country></aff></contrib><contrib contrib-type="author"><name><surname>Seemann</surname><given-names>Torsten</given-names></name><role specific-use="author">Author</role><aff><institution>University of Melbourne</institution><addr-line><named-content content-type="city">Melbourne</named-content></addr-line><country>Australia</country></aff></contrib><contrib contrib-type="author"><name><surname>Stinear</surname><given-names>Timothy P</given-names></name><role specific-use="author">Author</role><aff><institution>University of Melbourne</institution><addr-line><named-content content-type="city">Melbourne</named-content></addr-line><country>Australia</country></aff></contrib><contrib contrib-type="author"><name><surname>Coin</surname><given-names>Lachlan</given-names></name><role specific-use="author">Author</role><aff><institution>University of Queensland</institution><addr-line><named-content content-type="city">Brisbane</named-content></addr-line><country>Australia</country></aff></contrib></contrib-group></front-stub><body><p>The following is the authors’ response to the original reviews.</p><disp-quote content-type="editor-comment"><p><bold>Public Reviews:</bold></p><p><bold>Reviewer #1 (Public Review):</bold></p><p>Summary:</p><p>The authors assess the accuracy of short variant calling (SNPs and indels) in bacterial genomes using Oxford Nanopore reads generated on R10.4 flow cells from a very similar genome (99.5% ANI), examining the impact of variant caller choice (three traditional variant callers: bcftools, freebayes, and longshot, and three deep learning based variant callers: clair3, deep variant, and nano caller), base calling model (fast, hac and sup) and read depth (using both simplex and duplex reads).</p><p>Strengths:</p><p>Given the stated goal (analysis of variant calling for reads drawn from genomes very similar to the reference), the analysis is largely complete and results are compelling. The authors make the code and data used in their analysis available for re-use using current best practices (a computational workflow and data archived in INSDC databases or Zenodo as appropriate).</p><p>Weaknesses:</p></disp-quote><p>While the medaka variant caller is now deprecated for diploid calling, it is still widely used for haploid variant calling and should at least be mentioned (even if the mention is only to explain its exclusion from the analysis).</p><p>We have now added Medaka haploid caller to the benchmark. It performs quite well overall (better than the traditional methods), but not as good as Clair3 or DeepVariant.</p><disp-quote content-type="editor-comment"><p>Appraisal:</p><p>The experiments the authors engaged in are well structured and the results are convincing. I expect that these results will be incorporated into &quot;best practice&quot; bacterial variant calling workflows in the future.</p></disp-quote><p>Thank you for the positive appraisal.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Public Review):</bold></p><p>Summary:</p><p>Hall et al describe the superiority of ONT sequencing and deep learning-based variant callers to deliver higher SNP and Indel accuracy compared to previous gold-standard Illumina short-read sequencing. Furthermore, they provide recommendations for read sequencing depth and computational requirements when performing variant calling.</p><p>Strengths:</p><p>The study describes compelling data showing ONT superiority when using deep learning-based variant callers, such as Clair3, compared to Illumina sequencing. This challenges the paradigm that Illumina sequencing is the gold standard for variant calling in bacterial genomes. The authors provide evidence that homopolymeric regions, a systematic and problematic issue with ONT data, are no longer a concern in ONT sequencing.</p><p>Weaknesses:</p><p>(1) The inclusion of a larger number of reference genomes would have strengthened the study to accommodate larger variability (a limitation mentioned by the authors).</p></disp-quote><p>Our strategic selection of 14 genomes—spanning a variety of bacterial genera and species, diverse GC content, and both gram-negative and gram-positive species (including M. tuberculosis, which is neither)—was designed to robustly address potential variability in our results. Moreover, all our genome assemblies underwent rigorous manual inspection as the quality of the true genome sequences is the foundation this research is built upon. Given this, the fundamental conclusions regarding the accuracy of variant calls would likely remain unchanged with the addition of more genomes. However, we do acknowledge that a substantially larger sample size, which is beyond the scope of this study, would enable more fine-grained analysis of species differences in error rates.</p><disp-quote content-type="editor-comment"><p>(2) In Figure 2, there are clearly one or two samples that perform worse than others in all combinations (are always below the box plots). No information about species-specific variant calls is provided by the authors but one would like to know if those are recurrently associated with one or two species. Species-specific recommendations could also help the scientific community to choose the best sequencing/variant calling approaches.</p></disp-quote><p>Thank you for highlighting this observation. The precision, recall, and F1 scores for each sample and condition can be found in Supplementary Table S4.</p><p>Upon investigation of the outliers in Figure 2 we discovered three things. First, there was a parameter in Longshot we were using that automatically capped coverage and lead to a number of false negatives, leading to its outlier. This has now been rectified and the figure is updated accordingly. Second, the outlier in the simplex sup SNP panel (top left) was the same <italic>E. coli</italic> sample for most variant callers (though Medaka had no issues). The reasoning for this was a variant-dense repetitive region. We have added an in-depth explanation of this, along with figures illustrating the issue in Supplementary Section S2, with a brief statement in the main text. Third, the outlier in the duplex sup SNP panel (top right) is due to a very low (duplex) depth sample. This has also been added briefly to the main text and fully in Section S2.</p><p>We have now included a species-segregated version of Figure 2 (Suppl. Figures S5-7) for Clair3 with the sup model (best performer) for a clearer interpretation of how each species performs.</p><disp-quote content-type="editor-comment"><p>(3) The authors support that a read depth of 10x is sufficient to achieve variant calls that match or exceed Illumina sequencing. However, the standard here should be the optimal discriminatory power for clinical and public health utility (namely outbreak analysis). In such scenarios, the highest discriminatory power is always desirable and as such an F1 score, Recall and Precision that is as close to 100% as possible should be maintained (which changes the minimum read sequencing depth to at least 25x, which is the inflection point).</p></disp-quote><p>We agree that the highest discriminatory power is always desirable for clinical or public health applications. In which case, 25x is probably a better minimum recommendation. However, we are also aware that there are resource-limited settings where parity with Illumina is sufficient. In these cases, 10x depth from ONT would provide enough data.</p><p>The manuscript previously emphasised the latter scenario, but we have revised the text (Discussion) to clearly recommend 25x depth as a conservative aim in settings where resources are not a constraint, ensuring the highest possible discriminatory power.</p><disp-quote content-type="editor-comment"><p>(4) The sequencing of the samples was not performed with the same Illumina and ONT method/equipment, which could have introduced specific equipment/preparation artefacts that were not considered in the study. See for example https://academic.oup.com/nargab/article/3/1/lqab019/6193612.</p></disp-quote><p>To our knowledge, there is no evidence that sequencing on different ONT machines or barcoding kits leads to a difference in read characteristics or accuracy. To ensure consistency and minimise potential variability, we used the same ONT flowcells for all samples and performed basecalling on the same Nvidia A100 GPU. We have updated the methods to emphasise this.</p><p>For Illumina and ONT, the exact machines and kits used for each sample have been added as supplementary table S9 We have also added a short paragraph about possible Illumina error rate differences in the ‘Limitations’ section of the Discussion.</p><p>The third limitation is that Illumina sequencing was performed on different models: three samples on the NextSeq 500 and the rest on the NextSeq 2000. While differences in error rates exist between Illumina instruments, no specific assessment has been made between these NextSeq models [42]. However, the absolute differences in error rates are minor and unlikely to impact our study significantly. This is particularly relevant since Illumina's lower F1 score compared to ONT was due to missed calls rather than erroneous ones.</p><p>In summary, while there may be specific equipment or preparation artifacts to consider, we took steps to minimise these effects and maintain consistency across our sequencing methods.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #3 (Public Review):</bold></p><p>Hall et al. benchmarked different variant calling methods on Nanopore reads of bacterial samples and compared the performance of Nanopore to short reads produced with Illumina sequencing. To establish a common ground for comparison, the authors first generated a variant truth set for each sample and then projected this set to the reference sequence of the sample to obtain a mutated reference. Subsequently, Hall et al. called SNPs and small indels using commonly used deep learning and conventional variant callers and compared the precision and accuracy from reads produced with simplex and duplex Nanopore sequencing to Illumina data. The authors did not investigate large structural variation, which is a major limitation of the current manuscript. It will be very interesting to see a follow-up study covering this much more challenging type of variation.</p></disp-quote><p>We fully agree that investigating structural variations (SVs) would be a very interesting and important follow-up. Identifying and generating ground truth SVs is a nontrivial task and we feel it deserves its own space and study. We hope to explore this in the future.</p><disp-quote content-type="editor-comment"><p>In their comprehensive comparison of SNPs and small indels, the authors observed superior performance of deep learning over conventional variant callers when Nanopore reads were basecalled with the most accurate (but also computationally very expensive) model, even exceeding Illumina in some cases. Not surprisingly, Nanopore underperformed compared to Illumina when basecalled with the fastest (but computationally much less demanding) method with the lowest accuracy. The authors then investigated the surprisingly higher performance of Nanopore data in some cases and identified lower recall with Illumina short read data, particularly from repetitive regions and regions with high variant density, as the driver. Combining the most accurate Nanopore basecalling method with a deep learning variant caller resulted in low error rates in homopolymer regions, similar to Illumina data. This is remarkable, as homopolymer regions are (or, were) traditionally challenging for Nanopore sequencing.</p><p>Lastly, Hall et al. provided useful information on the required Nanopore read depth, which is surprisingly low, and the computational resources for variant calling with deep learning callers. With that, the authors established a new state-of-the-art for Nanopore-only variant, calling on bacterial sequencing data. Most likely these findings will be transferred to other organisms as well or at least provide a proof-of-concept that can be built upon.</p><p>As the authors mention multiple times throughout the manuscript, Nanopore can provide sequencing data in nearly real-time and in remote regions, therefore opening up a ton of new possibilities, for example for infectious disease surveillance.</p><p>However, the high-performing variant calling method as established in this study requires the computationally very expensive sup and/or duplex Nanopore basecalling, whereas the least computationally demanding method underperforms. Here, the manuscript would greatly benefit from extending the last section on computational requirements, as the authors determine the resources for the variant calling but do not cover the entire picture. This could even be misleading for less experienced researchers who want to perform bacterial sequencing at high performance but with low resources. The authors mention it in the discussion but do not make clear enough that the described computational resources are probably largely insufficient to perform the high-accuracy basecalling required.</p></disp-quote><p>We have provided runtime benchmarks for basecalling in Supplementary Figure S23 and detailed these times in Supplementary Table S7. In addition, we state in the Results section (P9 L239-241) “Though we do note that if the person performing the variant calling has received the raw (pod5) ONT data, basecalling also needs to be accounted for, as depending on how much sequencing was done, this step can also be resource-intensive.”</p><p>Even with super-accuracy basecalling considered, our analysis shows that variant calling remains the most resource-intensive step for Clair3, DeepVariant, FreeBayes, Medaka, and NanoCaller. Therefore, the statement “the described computational resources are probably largely insufficient to perform the high-accuracy basecalling required”, is incorrect. However, we have made this more prominent in the Results and Discussion.</p><p>In the results section we added the underlined section:</p><p>“… FreeBayes had the largest runtime variation, with a maximum of 597s/Mbp, equating to 2.75 days for the same genome. In contrast, basecalling with a single GPU using the super-accuracy model required a median runtime of 0.77s/Mbp, or just over 5 minutes for a 4Mbp genome at 100x depth. …”</p><p>In the discussion we have added the following statement:</p><p>“Basecalling is generally faster than variant calling, assuming GPU access, which is likely considered when acquiring ONT-related equipment.”</p><disp-quote content-type="editor-comment"><p><bold>Recommendations for the authors:</bold></p><p><bold>Reviewer #1 (Recommendations For The Authors):</bold></p><p>The colour choices in Figure 3 and Figure 4 c made the illustrations somewhat difficult to read. More substantially, a deeper investigation of the causes of non-homopolymeric-related mistaken indel calls would be useful.</p></disp-quote><p>We have updated Figure 3 so that each line has a different style to aid in discriminating between colours. The colour scheme for Figure 4c has also been updated.</p><p>In terms of non-homopolymeric false positive (FP) indel calls, we did an investigation of these for Clair3 and DeepVariant on the simplex sup data as these are the two best performing variant callers and deal the best with homopolymers. For Clair3, there were eight FPs across all samples. Five of these were homopolymers. The remaining three occurred within one or two bases of another insertion which inserted a similar sequence to the FP. For DeepVariant, it was much the same story, with 8/11 FP indels being in homopolymers, and the remaining three being within one or two bases of another insertion with a similar sequence. We have added a couple of sentences to the results explaining this finding.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Recommendations For The Authors):</bold></p><p>The paper is well-written and provides evidence for the conclusions. Some issues should be addressed.</p><p>Include a section in the Results describing species-specific observations, namely if some samples had recurrently lower SNP and INDEL F1 scores (as observed in Figure 2).</p></disp-quote><p>Please see our response in your second point in the ‘Weaknesses’ section of the public review.</p><disp-quote content-type="editor-comment"><p>Please provide more details on how the samples were sequenced. Section &quot;Sequencing&quot; in the methods is confusing and not clear enough to be reproduced (provide a supplementary table/figure with the workflow for each sample). Add information about how many samples were multiplexed in each run and what was the output achieved in each.</p></disp-quote><p>We have now added a Supplementary Table S9 which outlines which instruments, kits, and multiplexing strategies were used for each sample. In addition, the raw pod5 data that we make available has been segregated by sample, so knowledge of the multiplexing strategy is not necessary for someone attempting to reproduce our results.</p><disp-quote content-type="editor-comment"><p>The authors acknowledge that structural variation was not evaluated in this manuscript. Since ONT sequencing is often used to reconstruct the sequence of plasmids for outbreak/epidemiology analysis, perhaps they could undertake this analysis on a plasmids dataset (which suffers from constant structural variation).</p></disp-quote><p>As noted in our response to Reviewer 3’s public review, we fully agree that investigating structural variations (SVs) would be a very interesting and important follow-up. Identifying and generating ground truth SVs is a nontrivial task and we feel it deserves its own space and study. We hope to explore this in the future.</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations For The Authors):</p><p>The manuscript is well organized. However, some sections are a bit long and would benefit from being more concise.</p></disp-quote><p>Thank you for your valuable feedback and for acknowledging the organisation of our manuscript. We appreciate your suggestion regarding the length of certain sections. We have gone back through and made the manuscript more concise.</p><disp-quote content-type="editor-comment"><p>Figure 1: Is the Qscore really the same as identity? Isn't the determination of identity only possible after alignment?</p></disp-quote><p>When we say Qscore we are referring to the Phred-scaled version of the read identity, which is alignment based, not the Qscores of the individual bases in the FASTQ file. We have updated the text and figure legend to make this clearer. “The Qscore is the logarithmic transformation of the read identity, , where 𝑃 is the read identity.”. We also now explicitly state that read identity is alignment-based.</p><disp-quote content-type="editor-comment"><p>Abbreviations/terms mentioned but not introduced:</p><p>- kmers, P2L57</p><p>- ANI, P3L93</p></disp-quote><p>We have updated the text to better introduce these terms.</p></body></sub-article></article>