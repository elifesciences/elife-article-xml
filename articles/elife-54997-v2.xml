<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">54997</article-id><article-id pub-id-type="doi">10.7554/eLife.54997</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Bayesian inference for biophysical neuron models enables stimulus optimization for retinal neuroprosthetics</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-172915"><name><surname>Oesterle</surname><given-names>Jonathan</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8919-1445</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-63268"><name><surname>Behrens</surname><given-names>Christian</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3623-352X</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-172916"><name><surname>Schröder</surname><given-names>Cornelius</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-172918"><name><surname>Hermann</surname><given-names>Thoralf</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-23830"><name><surname>Euler</surname><given-names>Thomas</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4567-6966</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-143851"><name><surname>Franke</surname><given-names>Katrin</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-205134"><name><surname>Smith</surname><given-names>Robert G</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5703-1324</contrib-id><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="fund6"/><xref ref-type="other" rid="fund7"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-82269"><name><surname>Zeck</surname><given-names>Günther</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3998-9883</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-50831"><name><surname>Berens</surname><given-names>Philipp</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0199-4727</contrib-id><email>philipp.berens@uni-tuebingen.de</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Institute for Ophthalmic Research, University of Tübingen</institution><addr-line><named-content content-type="city">Tübingen</named-content></addr-line><country>Germany</country></aff><aff id="aff2"><label>2</label><institution>Naturwissenschaftliches und Medizinisches Institut an der Universität Tübingen</institution><addr-line><named-content content-type="city">Reutlingen</named-content></addr-line><country>Germany</country></aff><aff id="aff3"><label>3</label><institution>Center for Integrative Neuroscience, University of Tübingen</institution><addr-line><named-content content-type="city">Tübingen</named-content></addr-line><country>Germany</country></aff><aff id="aff4"><label>4</label><institution>Bernstein Center for Computational Neuroscience, University of Tübingen</institution><addr-line><named-content content-type="city">Tübingen</named-content></addr-line><country>Germany</country></aff><aff id="aff5"><label>5</label><institution>Department of Neuroscience, University of Pennsylvania</institution><addr-line><named-content content-type="city">Philadelphia</named-content></addr-line><country>United States</country></aff><aff id="aff6"><label>6</label><institution>Institute for Bioinformatics and Medical Informatics, University of Tübingen</institution><addr-line><named-content content-type="city">Tübingen</named-content></addr-line><country>Germany</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Borst</surname><given-names>Alexander</given-names></name><role>Reviewing Editor</role><aff><institution>Max Planck Institute of Neurobiology</institution><country>Germany</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Huguenard</surname><given-names>John R</given-names></name><role>Senior Editor</role><aff><institution>Stanford University School of Medicine</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>27</day><month>10</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e54997</elocation-id><history><date date-type="received" iso-8601-date="2020-01-08"><day>08</day><month>01</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2020-10-26"><day>26</day><month>10</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, Oesterle et al</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Oesterle et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-54997-v2.pdf"/><related-article ext-link-type="doi" id="ra1" related-article-type="commentary" xlink:href="10.7554/eLife.56261"/><abstract><p>While multicompartment models have long been used to study the biophysics of neurons, it is still challenging to infer the parameters of such models from data including uncertainty estimates. Here, we performed Bayesian inference for the parameters of detailed neuron models of a photoreceptor and an OFF- and an ON-cone bipolar cell from the mouse retina based on two-photon imaging data. We obtained multivariate posterior distributions specifying plausible parameter ranges consistent with the data and allowing to identify parameters poorly constrained by the data. To demonstrate the potential of such mechanistic data-driven neuron models, we created a simulation environment for external electrical stimulation of the retina and optimized stimulus waveforms to target OFF- and ON-cone bipolar cells, a current major problem of retinal neuroprosthetics.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>biophysical model</kwd><kwd>retina</kwd><kwd>bipolar cell</kwd><kwd>neuroprosthetics</kwd><kwd>bayesian inference</kwd><kwd>two-photon imaging</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Mouse</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002347</institution-id><institution>Bundesministerium für Bildung und Forschung</institution></institution-wrap></funding-source><award-id>01GQ1601</award-id><principal-award-recipient><name><surname>Berens</surname><given-names>Philipp</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002347</institution-id><institution>Bundesministerium für Bildung und Forschung</institution></institution-wrap></funding-source><award-id>01IS18052</award-id><principal-award-recipient><name><surname>Berens</surname><given-names>Philipp</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id><institution>Deutsche Forschungsgemeinschaft</institution></institution-wrap></funding-source><award-id>EXC 2064 - 390727645</award-id><principal-award-recipient><name><surname>Berens</surname><given-names>Philipp</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id><institution>Deutsche Forschungsgemeinschaft</institution></institution-wrap></funding-source><award-id>BE5601/4-1</award-id><principal-award-recipient><name><surname>Berens</surname><given-names>Philipp</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008316</institution-id><institution>Baden-Württemberg Stiftung</institution></institution-wrap></funding-source><award-id>NEU013</award-id><principal-award-recipient><name><surname>Zeck</surname><given-names>Günther</given-names></name><name><surname>Berens</surname><given-names>Philipp</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>EY022070</award-id><principal-award-recipient><name><surname>Smith</surname><given-names>Robert G</given-names></name></principal-award-recipient></award-group><award-group id="fund7"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>EY023766</award-id><principal-award-recipient><name><surname>Smith</surname><given-names>Robert G</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Bayesian simulator-based inference is used to infer the parameters of complex multicompartment models of retinal neurons from two-photon imaging data.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Mechanistic models have been extensively used to study the biophysics underlying information processing in single neurons and small networks in great detail (<xref ref-type="bibr" rid="bib32">Gerstner and Kistler, 2002</xref>; <xref ref-type="bibr" rid="bib56">Koch, 2004</xref>). In contrast to phenomenological models used for neural system identification, such models try to preserve certain physical properties of the studied system to facilitate interpretation and a causal understanding. For example, biophysical models can incorporate the detailed anatomy of a neuron (<xref ref-type="bibr" rid="bib33">Golding et al., 2001</xref>; <xref ref-type="bibr" rid="bib82">Poirazi et al., 2003</xref>; <xref ref-type="bibr" rid="bib38">Hay et al., 2011</xref>), its ion channel types (<xref ref-type="bibr" rid="bib42">Hodgkin and Huxley, 1952</xref>; <xref ref-type="bibr" rid="bib27">Fohlmeister and Miller, 1997</xref>) and the distributions of these channels (<xref ref-type="bibr" rid="bib84">Rattay et al., 2017</xref>) as well as synaptic connections to other cells (<xref ref-type="bibr" rid="bib76">O'Leary et al., 2014</xref>). For all these properties, the degree of realism can be adjusted as needed. While increased realism may enable models to capture the highly non-linear dynamics of neural activity more effectively, it usually also increases the number of model parameters. While the classical Hodgkin-Huxley model with one compartment has already 10 free parameters (<xref ref-type="bibr" rid="bib42">Hodgkin and Huxley, 1952</xref>), detailed multicompartment models of neurons can have dozens or even hundreds of parameters (<xref ref-type="bibr" rid="bib96">Taylor et al., 2009</xref>; <xref ref-type="bibr" rid="bib38">Hay et al., 2011</xref>).</p><p>Constraining many of these model parameters such as channel densities requires highly specialized and technically challenging experiments, and hence it is usually not viable to measure every single parameter for a neuron model of a specific neuron type. Rather, parameters for mechanistic simulations are often aggregated over different neuron types and even across species. Even though this may be justified in specific cases, it likely limits our ability to identify mechanistic models of individual cell types. Alternatively, parameter search methods have been proposed to identify the parameters of mechanistic neuron models from standardized patch-clamp protocols based on exhaustive grid-searches (<xref ref-type="bibr" rid="bib34">Goldman et al., 2001</xref>; <xref ref-type="bibr" rid="bib83">Prinz et al., 2003</xref>; <xref ref-type="bibr" rid="bib94">Stringer et al., 2016</xref>) or evolutionary algorithms (<xref ref-type="bibr" rid="bib31">Gerken et al., 2006</xref>; <xref ref-type="bibr" rid="bib54">Keren et al., 2005</xref>; <xref ref-type="bibr" rid="bib1">Achard and De Schutter, 2006</xref>; <xref ref-type="bibr" rid="bib86">Rossant et al., 2011</xref>). Such methods are often inefficient and identify only a single point estimate consistent with the data (for discussion, see <xref ref-type="bibr" rid="bib35">Gonçalves et al., 2020</xref>).</p><p>Here, we built on recent advances in Bayesian simulation-based inference to fit multicompartment models of neurons with realistic anatomy in the mouse retina. We used a framework called Sequential Neural Posterior Estimation (SNPE) (<xref ref-type="bibr" rid="bib61">Lueckmann et al., 2017</xref>; <xref ref-type="bibr" rid="bib35">Gonçalves et al., 2020</xref>) to identify model parameters based on high-throughput two-photon measurements of these neurons’ responses to light stimuli. SNPE is a Bayesian simulation-based inference algorithm that allows parameter estimation for simulator models for which the likelihood cannot be evaluated easily. The algorithm estimates the distribution of model parameters consistent with specified target data by evaluating the model for different sets of parameters and comparing the model output to the target data. To this end, parameters are drawn from a prior distribution, which is an initial guess about which parameters are likely to produce the desired model output. For example, the choice of prior distribution can be informed by the literature, without constraining the model to specific values. The model output for the sampled parameter sets can then be used to refine the distribution over plausible parameters given the data. This updated distribution, containing information from both the prior and the observed simulations, is known as the posterior. For high-dimensional parameter spaces, many samples are necessary to obtain an informative posterior estimate. Therefore, to make efficient use of simulation time, SNPE iteratively updates its sampling distribution, such that only in the first round samples are drawn from the prior, while in subsequent rounds samples are drawn from intermediate posteriors. This procedure increases the fraction of samples leading to simulations close to the target data. Since this approach for parameter estimation not only returns a point-estimate but also a posterior distribution over parameters consistent with the data, it allows one to straightforwardly determine how well the parameters are constrained. While the method has been used previously to fit simple neuron models (<xref ref-type="bibr" rid="bib61">Lueckmann et al., 2017</xref>; <xref ref-type="bibr" rid="bib35">Gonçalves et al., 2020</xref>), it has so far not been applied to models as complex and realistic as the ones presented here.</p><p>We estimated the posterior parameter distribution of multicompartment models of three retinal neurons, a cone photoreceptor (cone), an OFF- and an ON-bipolar cell (BC). The structure of the BC models was based on high-resolution electron microscopy reconstructions (<xref ref-type="bibr" rid="bib40">Helmstaedter et al., 2013</xref>) and in six independently parameterized regions. We performed parameter inference based on the responses of these neurons to standard light stimuli measured with two-photon imaging of glutamate release using iGluSnFR as an indicator (<xref ref-type="bibr" rid="bib28">Franke et al., 2017</xref>). Our analysis shows that many of the model parameters can be constrained well, yielding simulation results consistent with the observed data. After validating our model, we show that the inferred models and the inference algorithm can be used to efficiently guide the design of electrical stimuli for retinal neuroprosthetics to selectively activate OFF- or ON-BCs. This is an important step toward solving a long-standing question in the quest to provide efficient neuroprosthetic devices for the blind.</p></sec><sec id="s2" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th valign="top">Reagent type (species) <break/>or resource</th><th valign="top">Designation</th><th valign="top">Source or reference</th><th valign="top">Identifiers</th><th valign="top">Additional information</th></tr></thead><tbody><tr><td valign="top">Genetic reagent (mouse)</td><td valign="top">B6;129S6-Chat<sup>tm2(cre)LowlJ</sup></td><td valign="top">Jackson laboratory <break/>JAX 006410</td><td valign="top">RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/IMSR_JAX:006410">IMSR_JAX:006410</ext-link></td><td valign="top"/></tr><tr><td valign="top">Genetic reagent (mouse)</td><td valign="top">Gt(ROSA)26Sor <sup>tm9(CAG-tdTomato)Hze</sup></td><td valign="top">Jackson laboratory <break/>JAX 007905</td><td valign="top">RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/IMSR_JAX:007905">IMSR_JAX:007905</ext-link></td><td valign="top"/></tr><tr><td valign="top">Strain (mouse, female)</td><td valign="top">B6.CXB1-Pde6b<sup>rd10</sup></td><td valign="top">Jackson laboratory <break/>JAX 004297</td><td valign="top">RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/IMSR_JAX:004297">IMSR_JAX:004297</ext-link></td><td valign="top"/></tr><tr><td valign="top">Strain <break/>(Adeno-associated virus)</td><td valign="top">AAV2.7m8.hSyn.iGluSnFR</td><td valign="top">Virus facility, <break/>Institute de la Vision, Paris</td><td valign="top"/><td valign="top"/></tr><tr><td valign="top">Software, algorithm</td><td valign="top">NeuronC</td><td valign="top"><ext-link ext-link-type="uri" xlink:href="https://retina.anatomy.upenn.edu/rob/neuronc.html">https://retina.anatomy.upenn.</ext-link> <break/><ext-link ext-link-type="uri" xlink:href="https://retina.anatomy.upenn.edu/rob/neuronc.html">edu/rob/neuronc.html</ext-link></td><td valign="top">RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_014148">SCR_014148</ext-link></td><td valign="top">Version 6.3.14</td></tr><tr><td valign="top">Software, algorithm</td><td valign="top">SNPE</td><td valign="top"><break/><ext-link ext-link-type="uri" xlink:href="https://github.com/mackelab/delfi">https://github.com/mackelab/delfi</ext-link> <break/></td><td valign="top"/><td valign="top">See Inference algorithm</td></tr><tr><td valign="top">Software, algorithm</td><td valign="top">COMSOL Multiphysics</td><td valign="top">COMSOL Multiphysics</td><td valign="top">RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_014767">SCR_014767</ext-link></td><td valign="top"/></tr></tbody></table></table-wrap><sec id="s2-1"><title>Biophysical neuron models</title><p>We created detailed models of three retinal cell types: a cone, an ON- (<xref ref-type="fig" rid="fig1">Figure 1A,Bi</xref>) and an OFF-BC (<xref ref-type="fig" rid="fig1">Figure 1Bii</xref>). From the different OFF- and ON-BC types, we chose to model the types 3a and 5o, respectively, because those were the retinal cone bipolar cell (CBC) types in mice for which we could gather most information. To model the light response, the OFF-BC model received input from five and the ON-BC from three cones (<xref ref-type="bibr" rid="bib8">Behrens et al., 2016</xref>). Every cone made two synaptic connection with each BC. The postsynaptic conductances were set to 0.25 nS per connection.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>From serial block-face electron microscopy (EM) data of retinal BCs to multicompartment models.</title><p>(<bold>A</bold>) Raw morphology extracted from EM data of an ON-BC of type 5o. (<bold>Bi</bold>) Processed morphology connected to three presynaptic cones (red) and several postsynaptic dummy compartments that are generated to create the synapses in the model (yellow). The cone and BC morphologies are divided into color-coded regions with a legend shown on the right. (<bold>Bii</bold>) Same as (Bi) but for an OFF-BC of type 3. (<bold>C</bold>) Three cylindrical compartments of a multicompartment model. Every compartment (blue) <italic>n</italic> consists of a membrane capacitance <inline-formula><mml:math id="inf1"><mml:msubsup><mml:mi>c</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:math></inline-formula>, a membrane resistance <inline-formula><mml:math id="inf2"><mml:msubsup><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:math></inline-formula>, a leak conductance voltage source <inline-formula><mml:math id="inf3"><mml:msubsup><mml:mi>V</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:math></inline-formula>, an extracellular voltage source <inline-formula><mml:math id="inf4"><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:math></inline-formula> and at least one axial resistor <inline-formula><mml:math id="inf5"><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:math></inline-formula> that is connected to a neighboring compartment. <inline-formula><mml:math id="inf6"><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:math></inline-formula> is only used to simulate electrical stimulation and is otherwise replaced by a shortcut. Compartments may have one or more further voltage- or ligand-dependent resistances <inline-formula><mml:math id="inf7"><mml:msubsup><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:math></inline-formula> with respective voltage sources <inline-formula><mml:math id="inf8"><mml:msubsup><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:math></inline-formula> to simulate ion channels (indicated in gray).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54997-fig1-v2.tif"/></fig><sec id="s2-1-1"><title>Multicompartment models</title><p>We used NeuronC (<xref ref-type="bibr" rid="bib93">Smith, 1992</xref>) to implement multicompartment models of these neurons. A multicompartment model subdivides a neuron into a finite number of compartments. Every compartment is modeled as an electrical circuit, has a position in space, a spatial shape and is connected to at least one neighboring compartment (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). The voltage in a compartment <italic>n</italic>, connected to the compartments <inline-formula><mml:math id="inf9"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf10"><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> is described by:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mi>δ</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mi>δ</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here, compartments are either modeled as cylinders or spheres. The membrane capacitance <inline-formula><mml:math id="inf11"><mml:msubsup><mml:mi>c</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:math></inline-formula>, membrane resistance <inline-formula><mml:math id="inf12"><mml:msubsup><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:math></inline-formula> and axial resistance <inline-formula><mml:math id="inf13"><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:math></inline-formula> of a compartment <italic>n</italic> are assumed to be dependent on the compartment surface area <inline-formula><mml:math id="inf14"><mml:msubsup><mml:mi>A</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:math></inline-formula> and/or the compartment length <inline-formula><mml:math id="inf15"><mml:msubsup><mml:mi>l</mml:mi><mml:mi>c</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:math></inline-formula>:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow><mml:mo rspace="22.5pt">,</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow><mml:mo rspace="22.5pt">,</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>l</mml:mi><mml:mi>c</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow><mml:mo>/</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We assumed the specific membrane resistance <inline-formula><mml:math id="inf16"><mml:msub><mml:mi>R</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula>, the specific membrane capacitance <inline-formula><mml:math id="inf17"><mml:msub><mml:mi>C</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula>, and the axial resistivity <inline-formula><mml:math id="inf18"><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> to be constant over all compartments within a cell model. We used <inline-formula><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>132</mml:mn><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">Ω</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for all cell types and informed our priors for <inline-formula><mml:math id="inf20"><mml:msub><mml:mi>C</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf21"><mml:msub><mml:mi>R</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula>, which we estimated for every cell type individually, based on estimates for rod bipolar cells of rats (<xref ref-type="bibr" rid="bib78">Oltedal et al., 2009</xref>). Parameters of NeuronC and the used values are summarized in <xref ref-type="table" rid="app1table3">Appendix 1—table 3</xref>.</p></sec><sec id="s2-1-2"><title>Anatomy</title><p>We used a simplified cone morphology consisting of four compartments: one cone-shaped compartment for the outer segment, one spherical compartment for the combination of inner segment and soma, one cylindrical compartment for the axon, and another spherical one for the axonal terminals (<xref ref-type="fig" rid="fig1">Figure 1</xref>). The light collecting area in the outer segment was set to 0.2 µm² (<xref ref-type="bibr" rid="bib75">Nikonov et al., 2006</xref>). The diameter of the soma <inline-formula><mml:math id="inf22"><mml:msubsup><mml:mi>d</mml:mi><mml:mi>S</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>, the axon <inline-formula><mml:math id="inf23"><mml:msubsup><mml:mi>d</mml:mi><mml:mi>A</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula> and axonal terminals <inline-formula><mml:math id="inf24"><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>, the length of the axon <inline-formula><mml:math id="inf25"><mml:msubsup><mml:mi>l</mml:mi><mml:mi>A</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula> and the length of the outer segment <inline-formula><mml:math id="inf26"><mml:msubsup><mml:mi>l</mml:mi><mml:mrow><mml:mi>O</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula> were based on electron microscopy data (<xref ref-type="bibr" rid="bib13">Carter-Dawson and LaVail, 1979</xref>):<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>5.13</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1.3</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>6</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msubsup><mml:mi>l</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>15</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msubsup><mml:mi>l</mml:mi><mml:mrow><mml:mi>O</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>14.4</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The BC morphologies in this study were based on serial block-face electron microscopy data of mouse bipolar cells (<xref ref-type="bibr" rid="bib40">Helmstaedter et al., 2013</xref>). We extracted the raw voxel-based morphologies from the segmentation of the EM dataset and transformed them into a skeleton plus diameter representation using Vaa3D-Neuron2 auto tracing (<xref ref-type="bibr" rid="bib108">Xiao and Peng, 2013</xref>). These where then manually refined using Neuromantic (<xref ref-type="bibr" rid="bib73">Myatt et al., 2012</xref>) to correct errors originating from small segmentation errors (<xref ref-type="fig" rid="fig1">Figure 1</xref>).</p><p>The ON-BC morphology we chose was classified as type 5o, equal to the functional type of the model. For the OFF-BC, we decided for a morphology classified as type 3b, although we functionally modeled a type 3a cell, because the chosen reconstructed morphology was of higher quality than all available type 3a reconstructions and because type 3a and 3b BCs have very similar morphologies. Additionally, type 3a and 3b mostly differ in the average axonal field size (<xref ref-type="bibr" rid="bib104">Wässle et al., 2009</xref>; <xref ref-type="bibr" rid="bib40">Helmstaedter et al., 2013</xref>), with that of type 3a being larger than that of type 3b. The selected morphology had the largest axonal field among all cells classified as 3b in the dataset, well within the range of type 3a cells.</p><p>Because the computational time scales approximately linear with the number of BC compartments, using the full number of compartments of the EM reconstructions (&gt;1000) during parameter inference was computationally infeasible. Therefore, we utilized the compartment condensation algorithm of NeuronC, which iteratively reduces the number of compartments while preserving biophysical properties (<xref ref-type="bibr" rid="bib93">Smith, 1992</xref>). To be able to draw a sufficient number of samples, we reduced the number of compartments during parameter inference to 22 and 19 for the OFF- and ON-BC respectively (requiring approximately 3 min per simulation for a 31 s light stimulus). To simulate the electrical stimulation, more compartments are necessary to capture the effect of the electrical field on the neurites of the BC models. Therefore, we increased the number of compartments to 139 and 152 for the OFF- and an ON-BC, respectively, which is sufficient to accurately represent all major neurites without becoming computationally too expensive (requiring approximately 20 min and 13 min per simulation for a 31 s light stimulus for the OFF- and ON-BC, respectively).</p></sec><sec id="s2-1-3"><title>Ion channels and synapses - literature review</title><p>The complement and distribution of voltage- or ligand-gated ion channels shapes the response of neurons. Here, ion channels are modeled as additional electrical elements in the compartments’ membrane with conductances dependent on time varying parameters, such as the membrane potential and the calcium concentration within the cell. In addition to the equations that govern a channel’s kinetics, their location in the cell has to be defined. After a literature review of retinal cone bipolar cell types in mice, we decided to model the OFF- and ON-type for which we could gather most information, namely BC3a and BC5. Currently, there are three accepted subtypes of BC5: 5o, 5i and 5t (<xref ref-type="bibr" rid="bib36">Greene et al., 2016</xref>). Here, we modeled the BC5 subtype that expresses voltage-gated sodium channels (<xref ref-type="bibr" rid="bib39">Hellmer et al., 2016</xref>) which probably also corresponds to the more transient BC5 subtype reported in <xref ref-type="bibr" rid="bib44">Ichinose et al., 2014</xref>. The TTX sensitivity observed in <xref ref-type="bibr" rid="bib68">Matsumoto et al., 2019</xref> suggests that both, 5o and 5i express voltage-gated sodium channels. To make our model consistent, we used data from the same BC5 subtype (5o) for the morphology, the target data and the number of cone contacts. A summary of all used channels, their location within the models and the respective references can be found in <xref ref-type="table" rid="table1">Table 1</xref>. The following paragraphs describe which channels were included in the models and why. Note, however, that for all channels (except the L-type calcium channel in the axon terminals, as calcium channels are necessary in the model for neurotransmitter release) channel densities of zero were included in the prior distributions, thereby allowing the parameter inference to effectively remove ion channels from the model.</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Ion channels of biophysical models.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Channel</th><th>Cone</th><th>OFF-BC (type 3a)</th><th>ON-BC (type 5)</th><th>Cone references</th><th>BC references</th></tr></thead><tbody><tr><td><inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>AT</td><td>S, AT</td><td>S, AT</td><td><xref ref-type="bibr" rid="bib71">Morgans et al., 2005</xref>; <xref ref-type="bibr" rid="bib65">Mansergh et al., 2005</xref></td><td><xref ref-type="bibr" rid="bib101">Van Hook et al., 2019</xref></td></tr><tr><td><inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td/><td>S, AT</td><td/><td/><td><xref ref-type="bibr" rid="bib101">Van Hook et al., 2019</xref></td></tr><tr><td><inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>AT</td><td>S, AT</td><td>S, AT</td><td><xref ref-type="bibr" rid="bib70">Morgans et al., 1998</xref></td><td><xref ref-type="bibr" rid="bib70">Morgans et al., 1998</xref></td></tr><tr><td><inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>All</td><td/><td>D, S, AT</td><td><xref ref-type="bibr" rid="bib55">Knop et al., 2008</xref>; <xref ref-type="bibr" rid="bib101">Van Hook et al., 2019</xref></td><td><xref ref-type="bibr" rid="bib55">Knop et al., 2008</xref>; <xref ref-type="bibr" rid="bib39">Hellmer et al., 2016</xref></td></tr><tr><td><inline-formula><mml:math id="inf31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td/><td>D, S, AT</td><td/><td/><td><xref ref-type="bibr" rid="bib39">Hellmer et al., 2016</xref>; <xref ref-type="bibr" rid="bib55">Knop et al., 2008</xref></td></tr><tr><td><inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">K</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>IS/S</td><td>DD, PA, DA</td><td>DD, PA, DA</td><td><xref ref-type="bibr" rid="bib55">Knop et al., 2008</xref>; <xref ref-type="bibr" rid="bib101">Van Hook et al., 2019</xref></td><td><xref ref-type="bibr" rid="bib63">Ma et al., 2005</xref></td></tr><tr><td><inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">K</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td/><td>S</td><td>S</td><td/><td><xref ref-type="bibr" rid="bib20">Cui and Pan, 2008</xref>; <xref ref-type="bibr" rid="bib55">Knop et al., 2008</xref></td></tr><tr><td><inline-formula><mml:math id="inf34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>AT</td><td/><td/><td><xref ref-type="bibr" rid="bib109">Yang et al., 2008</xref>; <xref ref-type="bibr" rid="bib12">Caputo et al., 2015</xref></td><td/></tr><tr><td><inline-formula><mml:math id="inf35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td/><td>DA</td><td>DA</td><td/><td><xref ref-type="bibr" rid="bib39">Hellmer et al., 2016</xref></td></tr></tbody></table><table-wrap-foot><fn><p>Regions of ion channels and the respective abbreviations as in <xref ref-type="fig" rid="fig1">Figure 1</xref>.</p><p>D refers to the combination of DD and PD. All refers to the combination of IS/S, A, and AT.</p></fn><fn><p>If multiple regions are stated for a neuron, the ion channel density differs between them.</p></fn></table-wrap-foot></table-wrap><p>In their axon terminals, cones express L-type calcium (<inline-formula><mml:math id="inf36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) channels that mediate release of the transmitter glutamate (<xref ref-type="bibr" rid="bib71">Morgans et al., 2005</xref>; <xref ref-type="bibr" rid="bib65">Mansergh et al., 2005</xref>; <xref ref-type="bibr" rid="bib46">Ingram et al., 2020</xref>). We modeled calcium extrusion purely with calcium pumps (<inline-formula><mml:math id="inf37"><mml:msub><mml:mtext>Ca</mml:mtext><mml:mtext>P</mml:mtext></mml:msub></mml:math></inline-formula>) since other mechanisms such as sodium-calcium-exchangers probably only play a minor functional role in cones (<xref ref-type="bibr" rid="bib70">Morgans et al., 1998</xref>). Additionally, there is evidence that cones express hyperpolarization-activated cyclic nucleotide-gated cation (HCN) channels of the type 1, mostly in the inner segment but also in the axon (<xref ref-type="bibr" rid="bib55">Knop et al., 2008</xref>; <xref ref-type="bibr" rid="bib101">Van Hook et al., 2019</xref>). The presence of <inline-formula><mml:math id="inf38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> channels in mouse cones is more controversial. These channels have been observed in rat cones (<xref ref-type="bibr" rid="bib72">Müller et al., 2003</xref>), and a more recent study also found evidence for <inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> channels at the synaptic terminals of mouse cones, but could not observe any functional differences between wild-type and <inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>-knockout mice. To restrict the number of model parameters, we did not include <inline-formula><mml:math id="inf41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> in our cone model. However, we added calcium-activated chloride (<inline-formula><mml:math id="inf42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) channels to the axon terminals (<xref ref-type="bibr" rid="bib109">Yang et al., 2008</xref>; <xref ref-type="bibr" rid="bib12">Caputo et al., 2015</xref>) and voltage-gated potassium channels <inline-formula><mml:math id="inf43"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> at the inner segment (<xref ref-type="bibr" rid="bib101">Van Hook et al., 2019</xref>).</p><p>Our BC5 type expresses voltage-gated sodium (<inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) channels at the axon shaft (<xref ref-type="bibr" rid="bib39">Hellmer et al., 2016</xref>). Another study found inward-rectifier potassium (<inline-formula><mml:math id="inf45"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) channels at the soma of BC5 (<xref ref-type="bibr" rid="bib55">Knop et al., 2008</xref>), which were also found in the homologous type in rat (<xref ref-type="bibr" rid="bib20">Cui and Pan, 2008</xref>). Additionally, BC5 express HCN channels at the axon terminal, the soma and the dendrites (<xref ref-type="bibr" rid="bib55">Knop et al., 2008</xref>; <xref ref-type="bibr" rid="bib39">Hellmer et al., 2016</xref>). From the four subtypes of HCN, BC5 seem to almost exclusively express <inline-formula><mml:math id="inf46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. In the rat, there is also evidence for the expression of <inline-formula><mml:math id="inf47"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> channels in BC5 (<xref ref-type="bibr" rid="bib72">Müller et al., 2003</xref>; <xref ref-type="bibr" rid="bib47">Ivanova and Müller, 2006</xref>), but this could not be verified for mice. Data from rat suggests that BCs with <inline-formula><mml:math id="inf48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> channels also express <inline-formula><mml:math id="inf49"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> channels (<xref ref-type="bibr" rid="bib63">Ma et al., 2005</xref>). We therefore added <inline-formula><mml:math id="inf50"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> channels at the dendrites and the axon.</p><p>Similar to BC5, BC3a express HCN channels at the axon terminals, the soma and the dendrites. However, instead of <inline-formula><mml:math id="inf51"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> they express <inline-formula><mml:math id="inf52"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib39">Hellmer et al., 2016</xref>; <xref ref-type="bibr" rid="bib55">Knop et al., 2008</xref>). There is also evidence that BC3a express <inline-formula><mml:math id="inf53"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> channels at the axon shaft (<xref ref-type="bibr" rid="bib39">Hellmer et al., 2016</xref>), which were also found in the homologous type in rat (<xref ref-type="bibr" rid="bib20">Cui and Pan, 2008</xref>). Just like for BC5, we added also <inline-formula><mml:math id="inf54"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> in BC3a were only reported for rat so far (<xref ref-type="bibr" rid="bib20">Cui and Pan, 2008</xref>). As we could not find any evidence for the lack of <inline-formula><mml:math id="inf55"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> channels in mouse BC3a and the channel repertoires of BC3a in mouse and rat are overall very consistent, we included them in our model.</p><p>The distribution of calcium channels in mouse CBCs is largely unknown (<xref ref-type="bibr" rid="bib101">Van Hook et al., 2019</xref>). In the rat retina, there is evidence for T-type calcium (<inline-formula><mml:math id="inf56"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) channels in BC3a (<xref ref-type="bibr" rid="bib47">Ivanova and Müller, 2006</xref>). Calcium currents of unspecified type were observed in BC5 (<xref ref-type="bibr" rid="bib20">Cui and Pan, 2008</xref>). Generally, L-type calcium (<inline-formula><mml:math id="inf57"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) channels are believed to mediate neurotransmitter release in almost all BCs across types and species (<xref ref-type="bibr" rid="bib101">Van Hook et al., 2019</xref>). Therefore, we included them in both BC models. The literature review in <xref ref-type="bibr" rid="bib101">Van Hook et al., 2019</xref> suggests that T-type calcium channels might be exclusively expressed in BC3. In mouse BC3b, the simultaneous expression of both <inline-formula><mml:math id="inf58"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf59"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> has been described (<xref ref-type="bibr" rid="bib19">Cui et al., 2012</xref>). Furthermore, the latter and other studies (<xref ref-type="bibr" rid="bib43">Hu et al., 2009</xref>; <xref ref-type="bibr" rid="bib88">Satoh et al., 1998</xref>) suggest that voltage-gated calcium channels might not be located in the axon terminals only, but also in the soma and might play a role in signal transmission within the cell. Based on the studies mentioned, we assumed that BC3a and BC5 express <inline-formula><mml:math id="inf60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> in the axon terminals and potentially also at the soma. The BC3a model may additionally use <inline-formula><mml:math id="inf61"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> channels, both at the soma and at the axon terminals. For calcium extrusion, we added calcium pumps (<xref ref-type="bibr" rid="bib70">Morgans et al., 1998</xref>).</p><p>BC5 receive input from cones via the metabotropic glutamate receptor 6 (mGluR6) (<xref ref-type="bibr" rid="bib101">Van Hook et al., 2019</xref>). BC3a receive input from cones via kainate receptors (<xref ref-type="bibr" rid="bib45">Ichinose and Hellmer, 2016</xref>). We modeled the kainate receptors by modifying the inactivation time constant <inline-formula><mml:math id="inf62"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> of the AMPA receptors included with NeuronC.</p></sec><sec id="s2-1-4"><title>Ion channels and synapses - implementation</title><p>All ion channels in this study were based on the models available in NeuronC. We used both Hodgkin-Huxley (HH) and Markov-Sequential-State (MS) channel implementations. Since we did not add channel noise to our model, every HH channel could have also been described as an equivalent MS channel. However, since HH channels are computationally less expensive, we used HH implementations wherever possible. Implementation details and references are listed in <xref ref-type="table" rid="table2">Table 2</xref>. The L-type calcium channel, for example, was based on the HH model defined by the following equations:<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>:=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mfrac><mml:mi>δ</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:mo>⋅</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mrow><mml:mtext>T</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mn>0.04</mml:mn><mml:mo>⋅</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>+</mml:mo><mml:mn>15</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mn>0.04</mml:mn><mml:mo>⋅</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>+</mml:mo><mml:mn>15</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mi>β</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mrow><mml:mtext>T</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mn>5</mml:mn><mml:mo>⋅</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>V</mml:mi><mml:mo>+</mml:mo><mml:mn>38</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>18</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>⋅</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf63"><mml:msub><mml:mi>η</mml:mi><mml:mtext>T</mml:mtext></mml:msub></mml:math></inline-formula> corrects for differences between the temperature of the simulated cell <inline-formula><mml:math id="inf64"><mml:msub><mml:mi>T</mml:mi><mml:mtext>sim</mml:mtext></mml:msub></mml:math></inline-formula> and the temperature for which the channel equations were defined <inline-formula><mml:math id="inf65"><mml:msub><mml:mi>T</mml:mi><mml:mtext>eq</mml:mtext></mml:msub></mml:math></inline-formula> based on a temperature sensitivity <inline-formula><mml:math id="inf66"><mml:msub><mml:mi>Q</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math></inline-formula> which can vary between ion channels and state transitions:<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mrow><mml:mtext>T</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mrow><mml:mtext>sim</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mrow><mml:mtext>eq</mml:mtext></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>10</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>There are several sources for model uncertainty about the exact channel kinetics. First, not all channel models used here were developed based on mouse data resulting in species-dependent differences. Second, we do not always know the exact subtypes of ion channels, for example in the case of the T-type calcium channel. Third, the exact temperature sensitivities <inline-formula><mml:math id="inf67"><mml:msub><mml:mi>Q</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math></inline-formula> are not known. Therefore, we estimated transition rates and thresholds for state transitions during the parameter inference. For this, we allowed for offsets <inline-formula><mml:math id="inf68"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula> relative to <inline-formula><mml:math id="inf69"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in the rate equations and additionally, we estimated relative time constants τ for the rates. For example <xref ref-type="disp-formula" rid="equ4">Equation 4</xref> was changed to:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mrow><mml:mrow><mml:mfrac><mml:mi>δ</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mfrac><mml:mo>⋅</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>⋅</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:mfrac><mml:mo>⋅</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Ion channel implementation details and optimized channel parameters.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Channel</th><th>NeuronC</th><th>Type</th><th>States</th><th>Parameters</th><th>Channel remarks and references</th></tr></thead><tbody><tr><td>Kainate rec.</td><td>AMPA1</td><td>MS</td><td>7</td><td><inline-formula><mml:math id="inf70"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf71"><mml:msub><mml:mi>τ</mml:mi><mml:mi>γ</mml:mi></mml:msub></mml:math></inline-formula></td><td>Based on <xref ref-type="bibr" rid="bib50">Jonas et al., 1993</xref>.</td></tr><tr><td>mGluR6</td><td>mGluR</td><td/><td/><td><inline-formula><mml:math id="inf72"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>See NeuronC documenation.</td></tr><tr><td><inline-formula><mml:math id="inf73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>CA0</td><td>HH</td><td>(4)</td><td><inline-formula><mml:math id="inf74"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf75"><mml:msub><mml:mi>τ</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math></inline-formula></td><td>Based on <xref ref-type="bibr" rid="bib51">Karschin and Lipton, 1989</xref>.</td></tr><tr><td><inline-formula><mml:math id="inf76"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>CA7</td><td>MS</td><td>12</td><td><inline-formula><mml:math id="inf77"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf78"><mml:msub><mml:mi>τ</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math></inline-formula></td><td>Modification of <xref ref-type="bibr" rid="bib58">Lee et al., 2003</xref>.</td></tr><tr><td><inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td/><td/><td/><td><inline-formula><mml:math id="inf80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>See NeuronC documenation.</td></tr><tr><td><inline-formula><mml:math id="inf81"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>K4</td><td>MS</td><td>10</td><td/><td>Based on <xref ref-type="bibr" rid="bib3">Altomare et al., 2001</xref>.</td></tr><tr><td><inline-formula><mml:math id="inf82"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:msub><mml:mi mathvariant="normal">K</mml:mi><mml:mi mathvariant="normal">V</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>K0</td><td>HH</td><td>(5)</td><td><inline-formula><mml:math id="inf83"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf84"><mml:msub><mml:mi>τ</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math></inline-formula></td><td>Based on <xref ref-type="bibr" rid="bib42">Hodgkin and Huxley, 1952</xref>.</td></tr><tr><td><inline-formula><mml:math id="inf85"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:msub><mml:mi mathvariant="normal">K</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>K5</td><td>MS</td><td>3</td><td><inline-formula><mml:math id="inf86"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula></td><td>Modification of <xref ref-type="bibr" rid="bib21">Dong and Werblin, 1995</xref>.</td></tr><tr><td><inline-formula><mml:math id="inf87"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>CLCA1</td><td>MS</td><td>12</td><td/><td>Modification of <xref ref-type="bibr" rid="bib41">Hirschberg et al., 1998</xref>.</td></tr><tr><td><inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>NA5</td><td>MS</td><td>9</td><td><inline-formula><mml:math id="inf89"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf90"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>γ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf91"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>all</mml:mtext></mml:msub></mml:math></inline-formula></td><td>Based on <xref ref-type="bibr" rid="bib16">Clancy and Kass, 2004</xref>.</td></tr></tbody></table></table-wrap><p>To keep the parameter space as small as possible, we only optimized the kinetics of ion channels with high uncertainty (e.g. <inline-formula><mml:math id="inf92"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) or with high relevance for the exact timing of the neurotransmitter release (e.g. <inline-formula><mml:math id="inf93"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>). Additionally, we constrained the channel parameters to physiologically plausible ranges. <xref ref-type="table" rid="table2">Table 2</xref> summarizes which channel parameters were estimated during parameter optimization. Time constants τ and voltage offsets <inline-formula><mml:math id="inf95"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula> not optimized were set to one and zero, respectively. For the <inline-formula><mml:math id="inf96"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, a single time constant <inline-formula><mml:math id="inf97"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>all</mml:mtext></mml:msub></mml:math></inline-formula> was used to modify all time constants proportionally. The calcium pump dynamics were modified by changing the calcium concentration <inline-formula><mml:math id="inf98"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> that causes half of the maximum calcium extrusion velocity. The BC glutamate receptors were optimized by allowing for a change in the synaptic transmitter concentration at the receptors by a factor of <inline-formula><mml:math id="inf99"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, which might be smaller for the OFF-BC than for the ON-BC given the greater distance between the release sites of the cones and the dendritic tips of the BCs (<xref ref-type="bibr" rid="bib8">Behrens et al., 2016</xref>). The simulated cell temperature <inline-formula><mml:math id="inf100"><mml:msub><mml:mi>T</mml:mi><mml:mtext>sim</mml:mtext></mml:msub></mml:math></inline-formula> was set to 37°C if not stated otherwise. For further information we refer to the NeuronC documentation (<xref ref-type="bibr" rid="bib93">Smith, 1992</xref>).</p></sec></sec><sec id="s2-2"><title>Neurotransmitter release</title><p>The glutamate release of cones and BCs release is mediated through ribbon synapses that release vesicles in response to calcium influx in a nonlinear way (<xref ref-type="bibr" rid="bib69">Matthews and Fuchs, 2010</xref>; <xref ref-type="bibr" rid="bib98">tom Dieck and Brandstätter, 2006</xref>; <xref ref-type="bibr" rid="bib4">Baden et al., 2013</xref>). We modeled the ribbon synapses with a standard model (<xref ref-type="bibr" rid="bib93">Smith, 1992</xref>) including a readily releasable pool (RRP) from which vesicles can be released (<xref ref-type="bibr" rid="bib57">Lagnado and Schmitz, 2015</xref>). The presence of multiple release pools shapes the dynamic of release at the ribbon synapse and make it state dependent, allowing for rapid adaptational processes at the synaptic site (<xref ref-type="bibr" rid="bib4">Baden et al., 2013</xref>). In the model, the current release rate is dependent on the number of vesicles currently available <inline-formula><mml:math id="inf101"><mml:msub><mml:mi>v</mml:mi><mml:mtext>RRP</mml:mtext></mml:msub></mml:math></inline-formula> in the RRP, the maximum number of vesicles <inline-formula><mml:math id="inf102"><mml:msubsup><mml:mi>v</mml:mi><mml:mtext>RRP</mml:mtext><mml:mtext>max</mml:mtext></mml:msubsup></mml:math></inline-formula> in the RRP and the intracellular calcium concentration <inline-formula><mml:math id="inf103"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. In NeuronC, calcium is modeled in radial shells through which calcium can diffuse deeper into the neuron. For the release of neurotransmitter, only the calcium concentration in the first shell <inline-formula><mml:math id="inf104"><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> (equivalent to the concentration at the membrane) is considered. The release rate <inline-formula><mml:math id="inf105"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is computed as:<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>C</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mi>e</mml:mi><mml:mn>6</mml:mn></mml:mrow><mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mrow><mml:mtext>RRP</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mrow><mml:mtext>RRP</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>⋅</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:mfrac><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf106"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is a linear gain factor. <inline-formula><mml:math id="inf107"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf108"><mml:msubsup><mml:mi>v</mml:mi><mml:mtext>RRP</mml:mtext><mml:mtext>max</mml:mtext></mml:msubsup></mml:math></inline-formula> were optimized for every cell type individually. The RRP is constantly replenished with a constant rate that is equivalent to the maximum sustainable release rate <inline-formula><mml:math id="inf109"><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. At a time <italic>t</italic>, for a simulation time step <inline-formula><mml:math id="inf110"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>, the vesicles in the pool are updated as follows:<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mtext>RRP</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mtext>RRP</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⋅</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mtext>RRP</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mtext>RRP</mml:mtext><mml:mtext>max</mml:mtext></mml:msubsup></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>For the cone model, <inline-formula><mml:math id="inf111"><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> was set to 100 vesicles per second based on <xref ref-type="bibr" rid="bib9">Berntson and Taylor, 2003</xref>. The prior for <inline-formula><mml:math id="inf112"><mml:msubsup><mml:mi>v</mml:mi><mml:mtext>RRP</mml:mtext><mml:mtext>max</mml:mtext></mml:msubsup></mml:math></inline-formula> was based on RRP sizes reported for salamander (<xref ref-type="bibr" rid="bib97">Thoreson et al., 2016</xref>; <xref ref-type="bibr" rid="bib7">Bartoletti et al., 2010</xref>). For the BCs, <inline-formula><mml:math id="inf113"><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> was set to eight vesicles per second based on the reported value for rat rod bipolar cells in <xref ref-type="bibr" rid="bib91">Singer and Diamond, 2006</xref>. The prior for <inline-formula><mml:math id="inf114"><mml:msubsup><mml:mi>v</mml:mi><mml:mtext>RRP</mml:mtext><mml:mtext>max</mml:mtext></mml:msubsup></mml:math></inline-formula> was based on <xref ref-type="bibr" rid="bib102">Wan and Heidelberger, 2011</xref>.</p></sec><sec id="s2-3"><title>Bayesian inference for model parameters</title><p>To estimate the free parameters of the multicompartment models, we used a Bayesian likelihood-free inference framework called Sequential Neural Posterior Estimation (SNPE) (<xref ref-type="bibr" rid="bib61">Lueckmann et al., 2017</xref>; <xref ref-type="bibr" rid="bib35">Gonçalves et al., 2020</xref>). The goal of the parameter estimation was to find parameter regions for which the model outputs match the experimentally observed glutamate release in response to a light stimulus. Details of the target data, the stimulus, the comparison between experimental and simulated data and the inference algorithm are described below. To be able to simulate the light response of the BC models, we inferred the parameters of the cone model first.</p><sec id="s2-3-1"><title>Target data of neuron models</title><p>As target data, we used two-photon imaging data recorded with an intensity-based glutamate-sensing fluorescent reporter (iGluSnFR) (<xref ref-type="bibr" rid="bib66">Marvin et al., 2013</xref>). All animal procedures were approved by the governmental review board (Regierungspräsidium Tübingen, Baden-Württemberg, Konrad-Adenauer-Str. 20, 72072 Tübingen, Germany) and performed according to the laws governing animal experimentation issued by the German Government.</p><p>To constrain the cone models, we used glutamate traces of two cone axon terminals (Figure 5—figure supplement 1A) in response to a full-field chirp light stimulus (Figure 5A). The traces were recorded in one transgenic mouse (B6;129S6-<italic>Chat<sup>tm2(cre)Lowl</sup></italic>J, JAX 006410, crossbred with <italic>Gt(ROSA)26Sor<sup>tm9(CAG-tdTomato)Hze</sup></italic>, JAX 007905) that expressed the glutamate biosensor iGluSnFR ubiquitously across all retinal layers after intravitreal injection of the viral vector AAV2.7m8.hSyn.iGluSnFR (provided by D. Dalkara, Institut de la Vision, Paris). The cone glutamate release in the outer plexiform layer was recorded in x-z scans (64 × 56 pixels at 11.16 Hz; <xref ref-type="bibr" rid="bib110">Zhao et al., 2019</xref>). Region-of-interest (ROIs) were drawn manually and traces of single ROIs were then normalized and upsampled to 500 Hz as described previously (<xref ref-type="bibr" rid="bib28">Franke et al., 2017</xref>; <xref ref-type="bibr" rid="bib95">Szatko et al., 2019</xref>). For each axon terminal, we computed the mean over five traces. Both means were then aligned by minimizing the mean squared error between them, and the mean of the two aligned means was used as target data for the cone model (Figure 5—figure supplement 1B).</p><p>For the BC models, we used mean glutamate traces of BC3a (n = 19 ROIs) and BC5o (n = 13 ROIs) (Figure 5—figure supplement 1C–F) in response to a chirp light stimulus (Figure 6A) from a recently published dataset (<xref ref-type="bibr" rid="bib28">Franke et al., 2017</xref>). In that study, glutamate responses were recorded from BC terminals at different depths of the inner plexiform layer (x-y scans, 64 × 16 pixels at 31.25 Hz). ROIs were drawn automatically based on local image correlation and traces of single ROIs were normalized and upsampled to 500 Hz (see above). Since we simulated isolated BCs (except for the cone input), we used the responses to a local ‘chirp’ light stimulus recorded with the glycine receptor blocker strychnine, which means that the target data is less affected by inhibition from small-field amacrine cells. We did not consider input from GABAergic, wide-field amacrine cells, because these are not strongly activated by the local chirp stimulus (<xref ref-type="bibr" rid="bib28">Franke et al., 2017</xref>). The shape of the BC stimulus differed from the cone stimulus as contrast was not linearized for the BC recordings and therefore intensity modulations below 20% brightness were weakly rectified.</p></sec><sec id="s2-3-2"><title>Light stimulus and cell response</title><p>We first matched the experimental with the simulated stimulus. For this, we used the digital stimuli and corrected both timing and amplitude (using a sigmoid function) to minimize the mean squared error with respect to the experimentally recorded stimuli, correcting for delays and non-linearities in the displaying process. Then we linearly transformed the light stimulus such that the simulated photon absorption rates were <inline-formula><mml:math id="inf115"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>10</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mo>⋅</mml:mo><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for the lowest and <inline-formula><mml:math id="inf116"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>31</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mo>⋅</mml:mo><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for the highest stimulus intensity including the background illumination, approximating the values reported in <xref ref-type="bibr" rid="bib28">Franke et al., 2017</xref>. In NeuronC, the photon absorption rate acts as input to a phototransduction model (<xref ref-type="bibr" rid="bib74">Nikonov et al., 1998</xref>), which provides the hyperpolarizing current entering the inner segment. The membrane potential in the axon terminal compartment regulates the calcium influx into the cell which in turn influences the glutamate release rate. This glutamate release from the simulated cones modifies the opening probability (the fraction of open channels in the deterministic case) of postsynaptic receptors, which drive the BC models.</p></sec><sec id="s2-3-3"><title>Discrepancy function</title><p>To compare model outputs to the experimentally observed target data, we defined a discrepancy function <inline-formula><mml:math id="inf117"><mml:mi mathvariant="bold-italic">𝜹</mml:mi></mml:math></inline-formula>. Since the target traces were relative fluorescence intensities, the absolute number of released glutamate vesicles could not be directly inferred from the target data, and the data only constrained relative variations in the release rate during simulation. Because we also wanted to constrain our models to plausible membrane potentials and release rates, we combined the following seven discrepancy measures:</p><list list-type="bullet"><list-item><p><inline-formula><mml:math id="inf118"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub></mml:math></inline-formula>: The mean squared error between the experimental and simulated iGluSnFR trace.</p></list-item><list-item><p><inline-formula><mml:math id="inf119"><mml:msubsup><mml:mi>δ</mml:mi><mml:mtext>Rate</mml:mtext><mml:mtext>Rest</mml:mtext></mml:msubsup></mml:math></inline-formula>: A penalty for implausibly high resting release rates.</p></list-item><list-item><p><inline-formula><mml:math id="inf120"><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mtext>Rest</mml:mtext></mml:msubsup></mml:math></inline-formula>: A penalty for implausibly low or implausible high resting membrane potentials.</p></list-item><list-item><p><inline-formula><mml:math id="inf121"><mml:msubsup><mml:mi>δ</mml:mi><mml:mtext>Rate</mml:mtext><mml:mi mathvariant="normal">Δ</mml:mi></mml:msubsup></mml:math></inline-formula>: A penalty for implausibly low release rate changes.</p></list-item><list-item><p><inline-formula><mml:math id="inf122"><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi></mml:msubsup></mml:math></inline-formula>: A penalty for implausibly low membrane potential changes.</p></list-item><list-item><p><inline-formula><mml:math id="inf123"><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>: A penalty for implausibly low membrane potentials.</p></list-item><list-item><p><inline-formula><mml:math id="inf124"><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>: A penalty for implausibly high membrane potentials.</p></list-item></list><p>The discrepancy between a model output <italic>m</italic> and the target data <inline-formula><mml:math id="inf125"><mml:msub><mml:mi mathvariant="bold-italic">𝝂</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> was computed as:<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">𝜹</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">𝝂</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">𝝂</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo rspace="4.2pt">,</mml:mo><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mtext>Rate</mml:mtext><mml:mtext>Rest</mml:mtext></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo rspace="4.2pt">,</mml:mo><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mtext>Rest</mml:mtext></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo rspace="4.2pt">,</mml:mo><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mtext>Rate</mml:mtext><mml:mi mathvariant="normal">Δ</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo rspace="4.2pt">,</mml:mo><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo rspace="4.2pt">,</mml:mo><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo rspace="4.2pt">,</mml:mo><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>⊤</mml:mo></mml:msup></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>To identify the overall ‘best’ samples, we computed the total discrepancy as the absolute-value norm of the discrepancy vector: <inline-formula><mml:math id="inf126"><mml:mrow><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mtext>tot</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">𝝂</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>∥</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">𝝂</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∥</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>The discrepancy function <inline-formula><mml:math id="inf127"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ10">Equation 10</xref>) computes the distance between a simulated iGluSnFR trace <inline-formula><mml:math id="inf128"><mml:msub><mml:mi mathvariant="bold-italic">𝝂</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> and an iGluSnFR target <inline-formula><mml:math id="inf129"><mml:msub><mml:mi mathvariant="bold-italic">𝝂</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>. To estimate the simulated iGluSnFR trace, we convolved the glutamate release rate <inline-formula><mml:math id="inf130"><mml:msub><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> with an iGluSnFR kernel <inline-formula><mml:math id="inf131"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>κ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Here, the time-dependent kernel function <inline-formula><mml:math id="inf132"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>κ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> was approximated with an exponential decay function, based on iGluSnFR intensity changes to spontaneous vesicle release reported in <xref ref-type="bibr" rid="bib66">Marvin et al., 2013</xref>:<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">ν</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:mi>κ</mml:mi><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mi>κ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>60</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The discrepancy was then computed as the euclidean distance between the simulated and the target iGluSnFR trace with respect to a distance minimizing linear transformation of the simulated trace. This linear transformation was necessary because the target traces only reflect relative fluorescence changes. The discrepancy was normalized to be between zero and one by dividing by the variance <inline-formula><mml:math id="inf133"><mml:msup><mml:mrow><mml:mo>∥</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">𝝂</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>, where <inline-formula><mml:math id="inf134"><mml:msub><mml:mi>μ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is the mean of the target data.<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">𝝂</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">𝝂</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mi>min</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:munder><mml:mo>⁡</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo>∥</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">𝝂</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">𝝂</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mrow><mml:mo>∥</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">𝝂</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mfrac></mml:mrow></mml:mrow><mml:mo rspace="22.5pt">,</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>For all other discrepancies, specific values of the glutamate release rate (in the case of the BCs, the mean release rate over all synapses) or the somatic membrane potential were compared to a lower and an upper bound of target values <inline-formula><mml:math id="inf135"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf136"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, such that values within these bounds were assigned a discrepancy of 0.0. Outside this range, the discrepancy was defined by additional bounds <inline-formula><mml:math id="inf137"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf138"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Given a specific value of the simulation <inline-formula><mml:math id="inf139"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, the respective discrepancy <inline-formula><mml:math id="inf140"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mo>∙</mml:mo></mml:mrow><mml:mrow><mml:mo>∙</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> was computed as:<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mo>∙</mml:mo></mml:mrow><mml:mrow><mml:mo>∙</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="normal">∞</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">∞</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>To compute <inline-formula><mml:math id="inf141"><mml:msubsup><mml:mi>δ</mml:mi><mml:mtext>Rate</mml:mtext><mml:mtext>Rest</mml:mtext></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf142"><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mtext>Rest</mml:mtext></mml:msubsup></mml:math></inline-formula>, the resting release rate <inline-formula><mml:math id="inf143"><mml:msubsup><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math></inline-formula> and resting membrane potential <inline-formula><mml:math id="inf144"><mml:msubsup><mml:mi>v</mml:mi><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math></inline-formula> for the background light adapted state were extracted. For the BC models, the resting membrane potential was not penalized for values between <inline-formula><mml:math id="inf145"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>65</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf146"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>45</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> based on reported values for mice (<xref ref-type="bibr" rid="bib44">Ichinose et al., 2014</xref>; <xref ref-type="bibr" rid="bib45">Ichinose and Hellmer, 2016</xref>) and rat retina (<xref ref-type="bibr" rid="bib63">Ma et al., 2005</xref>). For the cone model, the expected resting membrane potential was more depolarized between <inline-formula><mml:math id="inf147"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>55</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf148"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>40</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>(<xref ref-type="bibr" rid="bib11">Cangiano et al., 2012</xref>).</p><p>The discrepancy of the resting release rate <inline-formula><mml:math id="inf149"><mml:msubsup><mml:mi>δ</mml:mi><mml:mtext>Rate</mml:mtext><mml:mtext>Rest</mml:mtext></mml:msubsup></mml:math></inline-formula> was computed similarly. For the BC models, the lower bound <italic>t</italic><sub><italic>l</italic></sub> was set to zero. As mentioned earlier, we limited our BC models to have a maximum sustainable release rate of 8 vesicles per second based on <xref ref-type="bibr" rid="bib91">Singer and Diamond, 2006</xref>. We allowed non-zero resting release rates due to the background light and spontaneous vesicle fusion but constrained it to values lower than the maximum sustainable release rate (<xref ref-type="bibr" rid="bib53">Kavalali, 2015</xref>; <xref ref-type="bibr" rid="bib5">Baden et al., 2014</xref>). For the OFF-BC we chose an upper bound of 4 vesicles per second (half the maximum sustainable release rate). For the ON-BC, we chose a slightly smaller value of 3 vesicles per second. This difference was based on the observation that the ON-BC target never falls significantly below the value of the resting state, indicating that the resting release rate is probably close to zero and can therefore not become smaller. In contrast, the OFF-BC target falls below the resting value right after stimulus onset, indicating a small but non-zero resting release rate. For the cone model, we assumed a comparably high resting release rate between <inline-formula><mml:math id="inf150"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf151"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>80</mml:mn></mml:mrow></mml:math></inline-formula> vesicles per second based on the assumed higher maximum sustainable release rate and the fact that cones show steady release in darkness (<xref ref-type="bibr" rid="bib14">Choi et al., 2005</xref>; <xref ref-type="bibr" rid="bib90">Sheng et al., 2007</xref>).</p><p>For the penalty on implausible release changes <inline-formula><mml:math id="inf152"><mml:msubsup><mml:mi>δ</mml:mi><mml:mtext>Rate</mml:mtext><mml:mi mathvariant="normal">Δ</mml:mi></mml:msubsup></mml:math></inline-formula>, we computed the largest absolute difference <inline-formula><mml:math id="inf153"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula> between the resting release rate <inline-formula><mml:math id="inf154"><mml:msubsup><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math></inline-formula> and release rates <inline-formula><mml:math id="inf155"><mml:msub><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> after stimulus onset. <inline-formula><mml:math id="inf156"><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi></mml:msubsup></mml:math></inline-formula> was computed analogously but for the membrane potential <inline-formula><mml:math id="inf157"><mml:msub><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> and the resting membrane potential <inline-formula><mml:math id="inf158"><mml:msubsup><mml:mi>v</mml:mi><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math></inline-formula>:<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mo form="prefix" movablelimits="true">max</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="1em"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mspace width="1em"/><mml:mspace width="thinmathspace"/></mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mo form="prefix" movablelimits="true">max</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf159"><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mtext>Rate</mml:mtext><mml:mi mathvariant="normal">Δ</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf160"><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> were then computed by using the differences <inline-formula><mml:math id="inf161"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf162"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, respectively, in <xref ref-type="disp-formula" rid="equ13">Equation 13</xref>. For the BC release rate, we did not penalize differences larger than <inline-formula><mml:math id="inf163"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mspace width="thinmathspace"/></mml:mrow></mml:mstyle></mml:math></inline-formula> vesicles per second. For the cone, we expected much larger differences between <inline-formula><mml:math id="inf164"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn><mml:mspace width="thinmathspace"/></mml:mrow></mml:mstyle></mml:math></inline-formula> to <inline-formula><mml:math id="inf165"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>65</mml:mn><mml:mspace width="thinmathspace"/></mml:mrow></mml:mstyle></mml:math></inline-formula> vesicles per second due to their larger maximum sustainable release rate. For the membrane potential, we expected a difference of at least <inline-formula><mml:math id="inf166"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> based on light step responses recorded with patch clamp in mouse BCs (<xref ref-type="bibr" rid="bib44">Ichinose et al., 2014</xref>; <xref ref-type="bibr" rid="bib45">Ichinose and Hellmer, 2016</xref>). Since here, the stimulus contrast was higher, we only used the reported values as lower bounds but allowed the model to have larger variation, namely up to <inline-formula><mml:math id="inf167"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>25</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for the OFF- and <inline-formula><mml:math id="inf168"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>15</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for the ON-BC. We allowed greater membrane potential variation in the OFF-BC, because it receives input from more cones.</p><p>For the discrepancy measures <inline-formula><mml:math id="inf169"><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf170"><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>, we computed the minimum and maximum of the membrane potential <inline-formula><mml:math id="inf171"><mml:msub><mml:mi mathvariant="bold">𝐯</mml:mi><mml:mi mathvariant="bold">𝐦</mml:mi></mml:msub></mml:math></inline-formula> after stimulus onset and used again <xref ref-type="disp-formula" rid="equ13">Equation 13</xref>. For <inline-formula><mml:math id="inf172"><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>, we chose <inline-formula><mml:math id="inf173"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>80</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for the BCs and <inline-formula><mml:math id="inf174"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>60</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for the cone model, and in both cases <inline-formula><mml:math id="inf175"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula>. For <inline-formula><mml:math id="inf176"><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>, we chose <inline-formula><mml:math id="inf177"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>10</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for the BCs and <inline-formula><mml:math id="inf178"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>35</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for the cone, and in both cases we set <inline-formula><mml:math id="inf179"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. The BC values are based on data from rat (<xref ref-type="bibr" rid="bib63">Ma et al., 2005</xref>) and ground squirrel (<xref ref-type="bibr" rid="bib87">Saszik and DeVries, 2012</xref>); the cone values are based on <xref ref-type="bibr" rid="bib11">Cangiano et al., 2012</xref>.</p><p>All values for <inline-formula><mml:math id="inf180"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf181"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> were based on pilot simulations with the goal to distribute the penalties where they most mattered. All discrepancies (except for <inline-formula><mml:math id="inf182"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub></mml:math></inline-formula>) and their respective values <inline-formula><mml:math id="inf183"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf184"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf185"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf186"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> are illustrated in <xref ref-type="fig" rid="fig2">Figure 2</xref> for clarity and summarized in <xref ref-type="table" rid="table3">Table 3</xref>.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Discrepancy measures based on <xref ref-type="disp-formula" rid="equ13">Equation 13</xref> for the cone (red dashed line), the OFF- (blue solid line) and ON-BC (green dotted line).</title><p>The parameters defining the discrepancy measures are listed in <xref ref-type="table" rid="table3">Table 3</xref>. All discrepancy measures are between zero and one per definition.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54997-fig2-v2.tif"/></fig><table-wrap id="table3" position="float"><label>Table 3.</label><caption><title>Parameters of discrepancy measures.</title></caption><table frame="hsides" rules="groups"><thead><tr><th><inline-formula><mml:math id="inf187"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mo>∙</mml:mo></mml:mrow><mml:mrow><mml:mo>∙</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th align="center" colspan="4">Cone</th><th align="center" colspan="4">BC (3a | 5o)</th><th>References</th></tr><tr><th/><th align="center"><inline-formula><mml:math id="inf188"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th align="center"><inline-formula><mml:math id="inf189"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th align="center"><inline-formula><mml:math id="inf190"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th align="center"><inline-formula><mml:math id="inf191"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th align="center"><inline-formula><mml:math id="inf192"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th align="center"><inline-formula><mml:math id="inf193"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th align="center"><inline-formula><mml:math id="inf194"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th align="center"><inline-formula><mml:math id="inf195"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th/></tr></thead><tbody><tr><td><inline-formula><mml:math id="inf196"><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>Rate</mml:mi><mml:mi>Rest</mml:mi></mml:msubsup></mml:math></inline-formula></td><td align="center">0</td><td align="center">50</td><td align="center">80</td><td align="center">100</td><td align="center">0</td><td align="center">0</td><td align="center">3 | 4</td><td align="center">7</td><td><xref ref-type="bibr" rid="bib14">Choi et al., 2005</xref>; <xref ref-type="bibr" rid="bib90">Sheng et al., 2007</xref>; <xref ref-type="bibr" rid="bib9">Berntson and Taylor, 2003</xref>; <xref ref-type="bibr" rid="bib91">Singer and Diamond, 2006</xref></td></tr><tr><td><inline-formula><mml:math id="inf197"><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mi>Rest</mml:mi></mml:msubsup></mml:math></inline-formula></td><td align="center">−80</td><td align="center">−55</td><td align="center">−40</td><td align="center">−20</td><td align="center">−80</td><td align="center">−65</td><td align="center">−45</td><td align="center">−30</td><td><xref ref-type="bibr" rid="bib11">Cangiano et al., 2012</xref>; <xref ref-type="bibr" rid="bib44">Ichinose et al., 2014</xref>; <xref ref-type="bibr" rid="bib45">Ichinose and Hellmer, 2016</xref>; <xref ref-type="bibr" rid="bib63">Ma et al., 2005</xref></td></tr><tr><td><inline-formula><mml:math id="inf198"><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>Rate</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi></mml:msubsup></mml:math></inline-formula></td><td align="center">0</td><td align="center">50</td><td align="center">65</td><td align="center">100</td><td align="center">0</td><td align="center">5</td><td align="center">∞</td><td align="center">∞</td><td/></tr><tr><td><inline-formula><mml:math id="inf199"><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi></mml:msubsup></mml:math></inline-formula></td><td align="center">0</td><td align="center">5</td><td align="center">10</td><td align="center">20</td><td align="center">0</td><td align="center">5</td><td align="center">15 | 25</td><td align="center">40</td><td><xref ref-type="bibr" rid="bib44">Ichinose et al., 2014</xref>; <xref ref-type="bibr" rid="bib45">Ichinose and Hellmer, 2016</xref></td></tr><tr><td><inline-formula><mml:math id="inf200"><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula></td><td align="center">−75</td><td align="center">60</td><td align="center">∞</td><td align="center">∞</td><td align="center">−100</td><td align="center">−80</td><td align="center">∞</td><td align="center">∞</td><td><xref ref-type="bibr" rid="bib11">Cangiano et al., 2012</xref>; <xref ref-type="bibr" rid="bib63">Ma et al., 2005</xref>; <xref ref-type="bibr" rid="bib87">Saszik and DeVries, 2012</xref></td></tr><tr><td><inline-formula><mml:math id="inf201"><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula></td><td align="center"><inline-formula><mml:math id="inf202"><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula></td><td align="center"><inline-formula><mml:math id="inf203"><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula></td><td align="center">−35</td><td align="center">−20</td><td align="center"><inline-formula><mml:math id="inf204"><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula></td><td align="center"><inline-formula><mml:math id="inf205"><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula></td><td align="center">−10</td><td align="center">0</td><td><xref ref-type="bibr" rid="bib11">Cangiano et al., 2012</xref>; <xref ref-type="bibr" rid="bib63">Ma et al., 2005</xref>; <xref ref-type="bibr" rid="bib87">Saszik and DeVries, 2012</xref></td></tr></tbody></table></table-wrap></sec></sec><sec id="s2-4"><title>Priors</title><p>The inference method SNPE is a Bayesian method and therefore it needs a prior distribution <inline-formula><mml:math id="inf206"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">𝜽</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for the parameters <inline-formula><mml:math id="inf207"><mml:mi mathvariant="bold-italic">𝜽</mml:mi></mml:math></inline-formula> to estimate the posterior. We chose truncated normal distributions for all priors because they allow for weighting of more plausible parameters (in contrast to e.g. uniform distributions), while they enable restrictions to plausible ranges (in contrast to e.g. normal distributions). A <inline-formula><mml:math id="inf208"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>-dimensional truncated normal distribution <inline-formula><mml:math id="inf209"><mml:msub><mml:mi class="ltx_font_mathcaligraphic">𝒩</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></inline-formula> is defined by a mean <inline-formula><mml:math id="inf210"><mml:mrow><mml:mi mathvariant="bold-italic">𝝁</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, a <inline-formula><mml:math id="inf211"><mml:mrow><mml:mi>d</mml:mi><mml:mo>×</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula> covariance matrix <inline-formula><mml:math id="inf212"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula> and a <inline-formula><mml:math id="inf213"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>-dimensional space <inline-formula><mml:math id="inf214"><mml:mrow><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>×</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">𝒩</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>,</mml:mo><mml:mi>W</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" displaystyle="false" rowspacing=".2em"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi>W</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">ω</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">ω</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow/><mml:mi>d</mml:mi><mml:mi mathvariant="bold-italic">ω</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>if</mml:mtext></mml:mstyle><mml:mspace width="2em"/><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>∈</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>W</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>otherwise</mml:mtext></mml:mstyle><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The prior means <inline-formula><mml:math id="inf215"><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and truncation bounds <inline-formula><mml:math id="inf216"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> were based on experimental data wherever possible (see <xref ref-type="table" rid="app1table1">Appendix 1—table 1</xref> and <xref ref-type="table" rid="app1table2">2</xref>), including data from rat and different cell types such as rod bipolar cells, as well as pilot simulations. For parameter inference, we normalized the parameter space such that the truncation bounds were [0, 1] in all dimensions. The diagonal entries of the prior covariance matrix <inline-formula><mml:math id="inf217"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula> were set to 0.3<sup>2</sup>. Because it is difficult to find prior knowledge about the dependencies of parameters, we set all non-diagonal entries to zero. To sample from <inline-formula><mml:math id="inf218"><mml:msub><mml:mi class="ltx_font_mathcaligraphic">𝒩</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></inline-formula>, we implemented a rejection sampler, that samples from a normal distribution with the same mean <inline-formula><mml:math id="inf219"><mml:mi mathvariant="bold-italic">𝝁</mml:mi></mml:math></inline-formula> and covariance matrix <inline-formula><mml:math id="inf220"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math></inline-formula> and resamples all <inline-formula><mml:math id="inf221"><mml:mi mathvariant="bold-italic">𝜽</mml:mi></mml:math></inline-formula> not in <inline-formula><mml:math id="inf222"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>W</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><sec id="s2-4-1"><title>Inference algorithm</title><p>SNPE estimates a posterior parameter distribution represented by a mixture-density network, based on sampling, that is, model evaluations for randomly drawn parameters. Inference is performed in several rounds. In every round <inline-formula><mml:math id="inf223"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, the algorithm draws <inline-formula><mml:math id="inf224"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> parameters from a sampling distribution <inline-formula><mml:math id="inf225"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">𝜽</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to estimate the posterior distribution <inline-formula><mml:math id="inf226"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">𝜽</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mtext>target</mml:mtext></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf227"><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mtext>target</mml:mtext></mml:msub></mml:math></inline-formula> is a summary statistic of the target data.</p><p>In the first round, parameter samples <inline-formula><mml:math id="inf228"><mml:msub><mml:mi mathvariant="bold-italic">𝜽</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> are drawn from the prior, that is, <inline-formula><mml:math id="inf229"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">𝜽</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">𝜽</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and the multicompartment model is evaluated for all <inline-formula><mml:math id="inf230"><mml:msub><mml:mi mathvariant="bold-italic">𝜽</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula>. From each simulated response, a summary statistic <inline-formula><mml:math id="inf231"><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> is computed, resulting in <inline-formula><mml:math id="inf232"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> pairs of parameters and summary statistics <inline-formula><mml:math id="inf233"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">𝜽</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. At the end of the round, a mixture-density network is trained with summary statistics <inline-formula><mml:math id="inf234"><mml:mi mathvariant="bold">𝐱</mml:mi></mml:math></inline-formula> as input, and the parameters <inline-formula><mml:math id="inf235"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> of a mixture of Gaussian distribution <inline-formula><mml:math id="inf236"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">𝜽</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐱</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as output. The network is trained by minimizing the loss function <inline-formula><mml:math id="inf237"><mml:mi class="ltx_font_mathcaligraphic">ℒ</mml:mi></mml:math></inline-formula>:<disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">ℒ</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mi>K</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf238"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is a kernel function with values between zero and one that weights the influence of samples on the network training. <inline-formula><mml:math id="inf239"><mml:mrow><mml:mi>K</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is close to one for samples with summary statistics <inline-formula><mml:math id="inf240"><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> close to the the target summary statistic <inline-formula><mml:math id="inf241"><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mtext>target</mml:mtext></mml:msub></mml:math></inline-formula> and becomes smaller with increasing discrepancy between <inline-formula><mml:math id="inf242"><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf243"><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mtext>target</mml:mtext></mml:msub></mml:math></inline-formula>. This means, the network tries to find parameter distributions <inline-formula><mml:math id="inf244"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">𝜽</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐱</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> that describe the distribution of samples for any given summary statistic <inline-formula><mml:math id="inf245"><mml:mi mathvariant="bold">𝐱</mml:mi></mml:math></inline-formula>. Or, in other words, the network is trained to find a mapping from summary statistics to parameter distributions. <inline-formula><mml:math id="inf246"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> ensures that the network focuses its capacity on summary statistics close to the target summary statistic. After training the network, it can be evaluated at a summary statistic <inline-formula><mml:math id="inf247"><mml:msup><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> to obtain the posterior parameter distributions for the given summary statistic. Evaluating at <inline-formula><mml:math id="inf248"><mml:mrow><mml:msup><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mtext>target</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> yields an approximation of the true posterior distribution <inline-formula><mml:math id="inf249"><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">𝜽</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mtext>target</mml:mtext></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">𝜽</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mtext>target</mml:mtext></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. This posterior can either be used as the sampling distribution of the next round <inline-formula><mml:math id="inf250"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">𝜽</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, or—if the algorithm is stopped—as the final posterior distribution. The relative probability <inline-formula><mml:math id="inf251"><mml:mrow><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">𝜽</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">𝜽</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ16">Equation 16</xref> weights samples not drawn from the prior, which ensures that Bayes’s rule is not violated. A detailed proof that this actually yields an approximation of the true posterior in the Bayesian sense can be found in <xref ref-type="bibr" rid="bib61">Lueckmann et al., 2017</xref>.</p><p>We based our algorithm on the Python code available at <ext-link ext-link-type="uri" xlink:href="https://github.com/mackelab/delfi">https://github.com/mackelab/delfi</ext-link> version 0.5.1 (<xref ref-type="bibr" rid="bib64">Macke Lab, 2020</xref>) with the following settings and modifications. We modeled <inline-formula><mml:math id="inf252"><mml:msub><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:msub></mml:math></inline-formula> as a single Gaussian, because we noticed that mixture of Gaussians almost always collapsed to a single component after a few rounds. Both, intermediate and final posteriors were truncated using the truncation bounds of the prior. The truncation was performed after network training. For every neuron model, we drew <inline-formula><mml:math id="inf253"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> samples per round and stopped the algorithm after the fourth round. Two hundred additional samples were drawn from the posterior for further analysis. Since we wanted to use the posterior samples to simulate the effects of electrical stimulation on the BCs, the number of compartments was increased in this last step to 139 and 152 for the OFF- and ON-BC, respectively.</p><p>As summary statistics of model outputs <inline-formula><mml:math id="inf254"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, we used the discrepancy function <inline-formula><mml:math id="inf255"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">𝝂</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (see <xref ref-type="disp-formula" rid="equ10">Equation 10</xref>), which describes the discrepancy between model outputs and the target data. The target summary statistic was set to be a zero-vector <inline-formula><mml:math id="inf256"><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mtext>target</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>⊤</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, since the target should have a discrepancy of zero with respect to itself. The first dimension of <inline-formula><mml:math id="inf257"><mml:mi mathvariant="bold-italic">𝜹</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf258"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub></mml:math></inline-formula>, computes the distance between the simulated and experimentally observed iGluSnFR trace. Considering the noise in the target data, observing a discrepancy of zero is virtually impossible. Therefore, evaluating the network at <inline-formula><mml:math id="inf259"><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mtext>target</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>⊤</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> is based on extrapolation, that is, the mixture-density network is evaluated for an input where it was not trained on. This, as we observed during pilot experiments, often led to posterior estimates of poor quality or endless loops of resampling. So instead of evaluating the network at <inline-formula><mml:math id="inf260"><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mtext>target</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>⊤</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> to obtain the posterior estimate, the network was instead evaluated at <inline-formula><mml:math id="inf261"><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mtext>target</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mtext>min</mml:mtext><mml:mtext>iGluSnFR</mml:mtext></mml:msubsup><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>⊤</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf262"><mml:msubsup><mml:mi>x</mml:mi><mml:mtext>min</mml:mtext><mml:mtext>iGluSnFR</mml:mtext></mml:msubsup></mml:math></inline-formula> is the the smallest <inline-formula><mml:math id="inf263"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub></mml:math></inline-formula> sampled during this round. This is roughly equivalent to assuming that the best strategy for extrapolation is to simply use the estimate at the boundary. For the weighting function <inline-formula><mml:math id="inf264"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, we used zero-centered Gaussian kernels <inline-formula><mml:math id="inf265"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> with a bandwidth of <inline-formula><mml:math id="inf266"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math></inline-formula> in all dimensions but the first one. In the first dimension, that is the weighting kernel for <inline-formula><mml:math id="inf267"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub></mml:math></inline-formula>, we also used an adaptive strategy and both, the mean <inline-formula><mml:math id="inf268"><mml:msub><mml:mi>μ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub></mml:math></inline-formula> and the bandwidth <inline-formula><mml:math id="inf269"><mml:msub><mml:mi>σ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub></mml:math></inline-formula> of the kernel, were updated in every round:<disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mtext>min</mml:mtext><mml:mtext>iGluSnFR</mml:mtext></mml:msubsup></mml:mrow><mml:mo rspace="22.5pt">,</mml:mo><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>q</mml:mi><mml:mn>20</mml:mn><mml:mtext>iGluSnFR</mml:mtext></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mtext>min</mml:mtext><mml:mtext>iGluSnFR</mml:mtext></mml:msubsup></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf270"><mml:msubsup><mml:mi>q</mml:mi><mml:mn>20</mml:mn><mml:mtext>iGluSnFR</mml:mtext></mml:msubsup></mml:math></inline-formula> is the 20th percentile of all sampled iGluSnFR discrepancies of the same round. <inline-formula><mml:math id="inf271"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> was computed as the product of all scalar kernels <inline-formula><mml:math id="inf272"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>Some parameter combinations caused the neuron simulation to become numerically unstable. If a simulation could not successfully terminate for this reason, the sample was ignored during training of the mixture-density network by setting the kernel weight to zero. In other cases, the BC models had a second, strongly depolarized and therefore biologically implausible equilibrium state. To test for this, we simulated a somatic voltage clamp to 30 mV for 100 ms and checked whether the membrane potential would recover to a value of −30 mV or lower within additional 300 ms. Samples not recovering to ≤ -30 mV were also ignored during training.</p></sec></sec><sec id="s2-5"><title>Data analysis of simulated traces</title><p>The distance function <inline-formula><mml:math id="inf273"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">𝝂</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">𝝂</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (see <xref ref-type="disp-formula" rid="equ12">Equation 12</xref>) was used not only to compute the discrepancy between simulations and the respective targets but also more generally to compare different experimental and simulated iGluSnFR traces. The distance between two iGluSnFR traces <inline-formula><mml:math id="inf274"><mml:msub><mml:mi mathvariant="bold-italic">𝝂</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf275"><mml:msub><mml:mi mathvariant="bold-italic">𝝂</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> was computed as <inline-formula><mml:math id="inf276"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">𝝂</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">𝝂</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>To quantify the timing precision of our neuron models, we estimated peak times in simulated and target iGluSnFR traces to compute pairwise peak time differences. For every peak in the simulated trace, we computed the time difference to the closest peak of the same polarity (positive or negative) in the target. We did not consider peaks between 16 s and 23 s of the stimulation for the cone and between 16 s and 21 s for the BC models, because the targets were to noisy for precise peak detection in these time windows. This resulted in approximately 35 positive and negative peak time differences per trace.</p></sec><sec id="s2-6"><title>Simulation of electrical stimulation</title><p>To simulate external electrical stimulation of our BC models, we implemented a two-step procedure. In the first step, the electrical field is estimated as a function of space and time across the whole retina for a given stimulation current. By setting a position of the BC multicompartment models within the retina, the extracellular voltage for every compartment can be extracted. In the second step, the extracellular voltages are applied to the respective compartments (<xref ref-type="fig" rid="fig1">Figure 1C</xref>) to simulate the neural response in NeuronC. To be able to perform the first step, we estimated the electrical properties of retinal tissue first. For this, we utilized the same algorithm that was used for parameter inference of the neuron models. To validate the framework, we simulated the electrical stimulation in <xref ref-type="bibr" rid="bib18">Corna et al., 2018</xref> and compared experimental and simulated neural responses. Finally, we utilized the framework to find electrical stimuli for selective stimulation of OFF- and ON-bipolar cells. Details of the implementation and the experimental data are described in the following.</p><sec id="s2-6-1"><title>Computing the extracellular voltage</title><p>We estimated the electrical field in the retina for a given electrical stimulus with the finite-element method using the software COMSOL Multiphysics (<xref ref-type="bibr" rid="bib17">Comsol, 2019</xref>). We modeled the photoreceptor degenerated retina as a cylinder with a radius of 2 mm and a height of 105 µm (<xref ref-type="bibr" rid="bib81">Pennesi et al., 2012</xref>). The stimulation electrodes were modeled as flat disks on the bottom of the retina. Above the retina, an additional cylinder with the same radius and a height of 2 mm was placed to model the electrolyte. The top of this cylinder was assumed to be the return electrode. The implementation of such a model with the subdivision into finite elements is shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>. For a single circular stimulation electrode, the model was radially symmetric and could therefore be reduced to a half cross-section as shown in <xref ref-type="fig" rid="fig3">Figure 3</xref> to increase the simulation speed without altering the results. The following initial and boundary conditions were applied to the model. The initial voltage was set to zero at every point <inline-formula><mml:math id="inf277"><mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. The surface normal current density <inline-formula><mml:math id="inf278"><mml:msubsup><mml:mi>j</mml:mi><mml:mtext>stim</mml:mtext><mml:mo>⟂</mml:mo></mml:msubsup></mml:math></inline-formula> of stimulation electrodes was always spatially homogeneous and dependent on the total stimulation current <inline-formula><mml:math id="inf279"><mml:msub><mml:mi>i</mml:mi><mml:mtext>stim</mml:mtext></mml:msub></mml:math></inline-formula> and the total surface area of all electrodes <inline-formula><mml:math id="inf280"><mml:msub><mml:mi>A</mml:mi><mml:mtext>electrode</mml:mtext></mml:msub></mml:math></inline-formula>:<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>j</mml:mi><mml:mtext>stim</mml:mtext><mml:mo>⟂</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>i</mml:mi><mml:mtext>stim</mml:mtext></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mtext>electrode</mml:mtext></mml:msub></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Model for the external electrical stimulation of the retina.</title><p>(<bold>A</bold>) Schematic figure of the experimental setup for subretinal stimulation of ex vivo retina combined with epiretinal recording of retinal ganglion cells. Schematic modified from <xref ref-type="bibr" rid="bib18">Corna et al., 2018</xref>. (<bold>B,C</bold>) Model for simulating the electrical field potential in the retina in 3D and 2D, respectively. The retina (darker blue) and the electrolyte above (lighter blue) are modeled as cylinders. The shown 3D model is radially symmetric with respect to the central axis (red dashed line). Therefore, the 3D and 2D implementations are equivalent, except that the computational costs for the 2D model are much lower. The 2D implementation is annotated with parameters that were either taken from the literature or inferred from experimental data. (<bold>D</bold>) Electrical field potential in the retina for a constant stimulation current of 0.5 µA for a single stimulation electrode with a diameter of 30 µm. Additionally, the compartments (black circles with white filling) of the ON-BC model are shown. The stimulation is subretinal meaning that the dendrites are facing the electrode (horizontal black line on bottom).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54997-fig3-v2.tif"/></fig><p>The potential of the return electrode was kept constant <inline-formula><mml:math id="inf281"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mtext>return</mml:mtext></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. At all other boundaries, the model was assumed to be a perfect insulator <inline-formula><mml:math id="inf282"><mml:mrow><mml:msubsup><mml:mi>j</mml:mi><mml:mtext>other</mml:mtext><mml:mo>⟂</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. We assumed a spatially and temporally homogeneous conductivity and permittivity in both the retina and the electrolyte. The conductivity of the electrolyte was set to <inline-formula><mml:math id="inf283"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mtext>ames</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1.54</mml:mn><mml:mspace width="thinmathspace"/><mml:mtext>S/m</mml:mtext></mml:mrow></mml:mstyle></mml:math></inline-formula> based on <xref ref-type="bibr" rid="bib25">Eickenscheidt and Zeck, 2014</xref> and its relative permittivity was assumed to be <inline-formula><mml:math id="inf284"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mrow><mml:mtext>ames</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>78</mml:mn><mml:mspace width="thinmathspace"/></mml:mrow></mml:mstyle></mml:math></inline-formula>, based on the value for water. The conductivity <inline-formula><mml:math id="inf285"><mml:msub><mml:mi>σ</mml:mi><mml:mtext>retina</mml:mtext></mml:msub></mml:math></inline-formula> and relative permittivity <inline-formula><mml:math id="inf286"><mml:msub><mml:mi>ε</mml:mi><mml:mtext>retina</mml:mtext></mml:msub></mml:math></inline-formula> of the retina were optimized with respect to experimental target data as described below.</p></sec><sec id="s2-6-2"><title>Target data to infer the electrical parameters of the retina</title><p>To estimate the electrical properties of the retina, we first recorded target data. All procedures were approved by the governmental review board (Regierungspräsidium Tübingen, Baden-Württemberg, Konrad-Adenauer-Str. 20, 72072 Tübingen, Germany, AZ 35/9185.82–7) and performed according to the laws governing animal experimentation issued by the German Government. We applied different sinusoidal stimulation voltages <inline-formula><mml:math id="inf287"><mml:msub><mml:mi>v</mml:mi><mml:mtext>stim</mml:mtext></mml:msub></mml:math></inline-formula> and recorded the evoked currents. Currents were recorded with (<inline-formula><mml:math id="inf288"><mml:msubsup><mml:mi>i</mml:mi><mml:mtext>retina</mml:mtext><mml:mtext>rec</mml:mtext></mml:msubsup></mml:math></inline-formula>) and without (<inline-formula><mml:math id="inf289"><mml:msubsup><mml:mi>i</mml:mi><mml:mtext>ames</mml:mtext><mml:mtext>rec</mml:mtext></mml:msubsup></mml:math></inline-formula>) retinal tissue placed on the micro-electrode array. In both cases, the recording chamber was filled with an electrolyte (Ames’ medium, A 1420, Sigma, Germany). A single Ag/AgCl pellet (E201ML, Science Products) was used as a reference electrode and located approximately 1 cm above a customized micro-electrode array. The electrodes, made of sputtered iridium oxide had diameters of 30 µm and center-to-center distance of 70 µm. The stimulation current was calculated from the voltage drop across a serial 10 resistor in series with the Ag/AgCl electrode (<xref ref-type="bibr" rid="bib18">Corna et al., 2018</xref>). The voltage drop was amplified using a commercial voltage amplifier (DLPVA, Femto Messtechnik GmbH, Berlin, Germany) and recorded using the analog input (ME 2100, Multi Channel Systems MCS GmnH, Germany). Stimulation currents were measured across an ex vivo retina of a <italic>rd10</italic> mouse (female; post-natal day 114; strain: <italic>Pde6b<sup>rd10</sup></italic> JAX Stock No: 004297).</p><p>We applied sinusoidal voltages of 25 and 40 Hz. For 25 Hz, we applied amplitudes from 100 to 600 mV with steps of 100 mV. For 40 Hz all amplitudes were halved.</p></sec><sec id="s2-6-3"><title>Procedure to infer the electrical parameters of the retina</title><p>We estimated the conductivity <inline-formula><mml:math id="inf290"><mml:msub><mml:mi>σ</mml:mi><mml:mtext>retina</mml:mtext></mml:msub></mml:math></inline-formula> and relative permittivity <inline-formula><mml:math id="inf291"><mml:msub><mml:mi>ε</mml:mi><mml:mtext>retina</mml:mtext></mml:msub></mml:math></inline-formula> of the retina in three steps based on the experimental voltages <inline-formula><mml:math id="inf292"><mml:msub><mml:mi>v</mml:mi><mml:mtext>stim</mml:mtext></mml:msub></mml:math></inline-formula> and the respective recorded currents <inline-formula><mml:math id="inf293"><mml:msubsup><mml:mi>i</mml:mi><mml:mtext>retina</mml:mtext><mml:mtext>rec</mml:mtext></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf294"><mml:msubsup><mml:mi>i</mml:mi><mml:mtext>ames</mml:mtext><mml:mtext>rec</mml:mtext></mml:msubsup></mml:math></inline-formula>. To facilitate the following steps, we fitted sinusoids <inline-formula><mml:math id="inf295"><mml:msub><mml:mi>i</mml:mi><mml:mtext>retina</mml:mtext></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf296"><mml:msub><mml:mi>i</mml:mi><mml:mtext>ames</mml:mtext></mml:msub></mml:math></inline-formula> to the slightly skewed recorded currents and used them in the following (Figure 8C). To fit the sinusoids, we minimized the mean squared error between recorded currents and idealized sinusoidal currents of the same frequency <italic>f</italic>, resulting in estimates of the phase <inline-formula><mml:math id="inf297"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mtext>ames</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and the amplitude <inline-formula><mml:math id="inf298"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mtext>ames</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of the currents:<disp-formula id="equ19"><label>(19)</label><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mo>⋅</mml:mo><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>During parameter inference, we only used two voltage amplitudes per frequency, resulting in four voltage and eight current traces. The other amplitudes were used for model validation. First, we estimated the electrical properties of the electrode. Here, ‘electrode’ is meant to include the electrical double layer and all parasitic resistances and capacitances in the electrical circuit. We simulated the voltage <inline-formula><mml:math id="inf299"><mml:msub><mml:mi>v</mml:mi><mml:mtext>ames</mml:mtext></mml:msub></mml:math></inline-formula> across the electrolyte without retinal tissue by applying the currents <inline-formula><mml:math id="inf300"><mml:msub><mml:mi>i</mml:mi><mml:mtext>ames</mml:mtext></mml:msub></mml:math></inline-formula> as stimuli (Figure 8Ai). Since this setup does not contain anything besides the electrolyte and the electrode, the difference between the experimental stimulus <inline-formula><mml:math id="inf301"><mml:msub><mml:mi>v</mml:mi><mml:mtext>stim</mml:mtext></mml:msub></mml:math></inline-formula>, which was applied to record <inline-formula><mml:math id="inf302"><mml:msub><mml:mi>i</mml:mi><mml:mtext>ames</mml:mtext></mml:msub></mml:math></inline-formula>, and the simulated voltage <inline-formula><mml:math id="inf303"><mml:msub><mml:mi>v</mml:mi><mml:mtext>ames</mml:mtext></mml:msub></mml:math></inline-formula> was assumed to have dropped over the electrode:<disp-formula id="equ20"><mml:math id="m20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mrow><mml:mtext>electrode</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mrow><mml:mtext>stim</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mrow><mml:mtext>ames</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Based on that assumption, we could estimate the electrical properties of the electrode. We modeled the electrode as a <italic>RC</italic> parallel circuit (Figure 8Aii). Having both, sinusoidal voltages (<inline-formula><mml:math id="inf304"><mml:msub><mml:mi>v</mml:mi><mml:mtext>electrode</mml:mtext></mml:msub></mml:math></inline-formula>) over and the respective sinusoidal currents (<inline-formula><mml:math id="inf305"><mml:msub><mml:mi>i</mml:mi><mml:mtext>ames</mml:mtext></mml:msub></mml:math></inline-formula>) through the electrode, we analytically computed the values for <inline-formula><mml:math id="inf306"><mml:msub><mml:mi>R</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf307"><mml:msub><mml:mi>C</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula> as follows. We assumed <inline-formula><mml:math id="inf308"><mml:msub><mml:mi>R</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf309"><mml:msub><mml:mi>C</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula> to be dependent on <inline-formula><mml:math id="inf310"><mml:msub><mml:mi>v</mml:mi><mml:mtext>stim</mml:mtext></mml:msub></mml:math></inline-formula> and therefore to be dependent on the stimulus frequency and amplitude. From the data we derived the phase <inline-formula><mml:math id="inf311"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>Z</mml:mi></mml:msub></mml:math></inline-formula> and amplitude <inline-formula><mml:math id="inf312"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> of the impedance formed by the <italic>RC</italic> circuit. For every <inline-formula><mml:math id="inf313"><mml:msub><mml:mi>v</mml:mi><mml:mtext>electrode</mml:mtext></mml:msub></mml:math></inline-formula>, we estimated <inline-formula><mml:math id="inf314"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mtext>electrode</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf315"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mtext>electrode</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> using <xref ref-type="disp-formula" rid="equ19">Equation 19</xref>. <inline-formula><mml:math id="inf316"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>Z</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf317"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> were then computed as:<disp-formula id="equ21"><label>(20)</label><mml:math id="m21"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>Z</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mtext>electrode</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mtext>ames</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo rspace="22.5pt">,</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mtext>electrode</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mtext>ames</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Then, knowing the frequency <italic>f</italic>, <inline-formula><mml:math id="inf318"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>Z</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf319"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> are sufficient to compute <inline-formula><mml:math id="inf320"><mml:msub><mml:mi>R</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf321"><mml:msub><mml:mi>C</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula>:<disp-formula id="equ22"><label>(21)</label><mml:math id="m22"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>Z</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mrow><mml:mo rspace="22.5pt">,</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>Z</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>With the estimated values of the <italic>RC</italic> circuit, we created a model with only two unknowns, the conductivity <inline-formula><mml:math id="inf322"><mml:msub><mml:mi>σ</mml:mi><mml:mtext>retina</mml:mtext></mml:msub></mml:math></inline-formula> and the relative permittivity <inline-formula><mml:math id="inf323"><mml:msub><mml:mi>ε</mml:mi><mml:mtext>retina</mml:mtext></mml:msub></mml:math></inline-formula> of the retina (Figure 8Aiii). To estimate the unknown parameters of this model, we used the same inference algorithm as for the neuron models but with a different discrepancy function. Here, the discrepancy <inline-formula><mml:math id="inf324"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mtext>stim</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for a stimulus <inline-formula><mml:math id="inf325"><mml:msub><mml:mi>v</mml:mi><mml:mtext>stim</mml:mtext></mml:msub></mml:math></inline-formula> was computed as the mean squared error between the respective experimental current (now with retinal tissue) <inline-formula><mml:math id="inf326"><mml:msub><mml:mi>i</mml:mi><mml:mtext>retina</mml:mtext></mml:msub></mml:math></inline-formula> and the simulated current <inline-formula><mml:math id="inf327"><mml:msubsup><mml:mi>i</mml:mi><mml:mtext>retina</mml:mtext><mml:mtext>sim</mml:mtext></mml:msubsup></mml:math></inline-formula>:<disp-formula id="equ23"><label>(22)</label><mml:math id="m23"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mtext>stim</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mtext>stim</mml:mtext></mml:msub></mml:munder><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mtext>retina</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mtext>retina</mml:mtext><mml:mtext>sim</mml:mtext></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>𝑑</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The total discrepancy was computed as the sum of all discrepancies <inline-formula><mml:math id="inf328"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mtext>stim</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for the four different <inline-formula><mml:math id="inf329"><mml:msub><mml:mi>v</mml:mi><mml:mtext>stim</mml:mtext></mml:msub></mml:math></inline-formula> stimuli that were used. To cover a wider range of possible parameters, we first estimated the parameters in a logarithmic space by sampling the exponents <inline-formula><mml:math id="inf330"><mml:msub><mml:mi>p</mml:mi><mml:mi>σ</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf331"><mml:msub><mml:mi>p</mml:mi><mml:mi>ε</mml:mi></mml:msub></mml:math></inline-formula> of the parameters:<disp-formula id="equ24"><label>(23)</label><mml:math id="m24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mtext>retina</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:mn>0.1</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mrow><mml:mtext>retina</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We used normal distributions (without truncation) as priors for <inline-formula><mml:math id="inf332"><mml:msub><mml:mi>p</mml:mi><mml:mi>σ</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf333"><mml:msub><mml:mi>p</mml:mi><mml:mi>ε</mml:mi></mml:msub></mml:math></inline-formula> and set the means to 1.0 and the standard deviations to 2.0. After three rounds with 50 samples each, we computed the minimum (<inline-formula><mml:math id="inf334"><mml:msub><mml:mi>a</mml:mi><mml:mi>σ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf335"><mml:msub><mml:mi>a</mml:mi><mml:mi>ε</mml:mi></mml:msub></mml:math></inline-formula>), maximum (<inline-formula><mml:math id="inf336"><mml:msub><mml:mi>b</mml:mi><mml:mi>σ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf337"><mml:msub><mml:mi>b</mml:mi><mml:mi>ε</mml:mi></mml:msub></mml:math></inline-formula>) and mean (<inline-formula><mml:math id="inf338"><mml:msub><mml:mi>μ</mml:mi><mml:mi>σ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf339"><mml:msub><mml:mi>μ</mml:mi><mml:mi>ε</mml:mi></mml:msub></mml:math></inline-formula>) for both parameters <inline-formula><mml:math id="inf340"><mml:msub><mml:mi>σ</mml:mi><mml:mtext>retina</mml:mtext></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf341"><mml:msub><mml:mi>ε</mml:mi><mml:mtext>retina</mml:mtext></mml:msub></mml:math></inline-formula> from the 10% best samples. Then, we then ran the parameter inference algorithm again, but now in a linear parameter space around the best samples observed in the logarithmic space. For the priors of <inline-formula><mml:math id="inf342"><mml:msub><mml:mi>σ</mml:mi><mml:mtext>retina</mml:mtext></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf343"><mml:msub><mml:mi>ε</mml:mi><mml:mtext>retina</mml:mtext></mml:msub></mml:math></inline-formula>, we used truncated normal priors bound to <inline-formula><mml:math id="inf344"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>σ</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>σ</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf345"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>ε</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>ε</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> with means <inline-formula><mml:math id="inf346"><mml:msub><mml:mi>μ</mml:mi><mml:mi>σ</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf347"><mml:msub><mml:mi>μ</mml:mi><mml:mi>ε</mml:mi></mml:msub></mml:math></inline-formula>, respectively. As for the cell parameter inference, we normalized the parameter space to values between in [0, 1]. The diagonal entries of the prior covariance matrix were set to 0.3<sup>2</sup>, with non-diagonal entries of zero. The parameters resulting in the lowest sampled discrepancy during optimization are referred to as the optimized parameters and were used to simulate the neural responses to electrical stimulation.</p></sec><sec id="s2-6-4"><title>Simulation of the neural response to electrical stimulation</title><p>With the optimized parameters for the electrical properties of the retina, we were able to compute the BC responses for any given stimulation current. Note that for this, we used the model illustrated in <xref ref-type="fig" rid="fig3">Figure 3</xref> as described earlier but with the optimized parameters for <inline-formula><mml:math id="inf348"><mml:msub><mml:mi>σ</mml:mi><mml:mtext>retina</mml:mtext></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf349"><mml:msub><mml:mi>ε</mml:mi><mml:mtext>retina</mml:mtext></mml:msub></mml:math></inline-formula>. To simulate the neural response, we first used the stimulation current to simulate the extracellular voltage over time within the retina. After defining the relative position of the multicompartment model with respect to the retinal cylinder, we extracted the extracellular voltage for each compartment at its the central position (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). Finally, these extracellular voltages were applied to the compartment models in NeuronC to simulate their response (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). To estimate the uncertainty of the BC responses to electrical stimulation, we simulated different cell parametrizations in every stimulation setting. For this, we used the five best posterior samples, that is, the five (out of 200) samples with the smallest <inline-formula><mml:math id="inf350"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>tot</mml:mtext></mml:msub></mml:math></inline-formula>, for both BC models. In all simulations, we modeled subretinal stimulation of photoreceptor degenerated retina (<xref ref-type="bibr" rid="bib111">Zrenner, 2002</xref>). For this, we removed all cone input from the BCs and virtually placed the multicompartment models in the retinal cylinder such that the dendrites were facing towards the electrode. The z-position of BC somata, that is, the distance to the bottom of the retinal cylinder, was set to 30 µm.</p></sec><sec id="s2-6-5"><title>Model validation</title><p>To validate the model for electrical stimulation, we compared simulated BC responses to experimentally recorded retinal ganglion cell (RGC) thresholds to 4 ms biphasic current pulses reported in <xref ref-type="bibr" rid="bib18">Corna et al., 2018</xref>. In this study, the RGC thresholds were recorded epiretinally under subretinal stimulation of photoreceptor degenerated (<italic>rd10</italic>) mouse retina using a micro-electrode array (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). The stimulation threshold was defined as the charge delivered during the anodic stimulation phase evoking 50% of the firing rate of a specific RGC. On the micro-electrode array. The 30 µm diameter electrodes were arranged on a regular grid with a center-center spacing of 70 µm. The RGC thresholds were measured for different numbers <inline-formula><mml:math id="inf351"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> of <inline-formula><mml:math id="inf352"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>×<inline-formula><mml:math id="inf353"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> active electrodes.</p><p>We simulated the electrical field in the retina for the configurations with 1×1, 2×2, 4×4 and 10×10 active electrodes using the respective currents from the experimental data. The electrodes were centered with respect to the retina. For every stimulation current, we simulated the response of the OFF- and ON-BC at six xy-positions with distances from 0 to 500 µm relative to the center. Simulation temperature <inline-formula><mml:math id="inf354"><mml:msub><mml:mi>T</mml:mi><mml:mtext>sim</mml:mtext></mml:msub></mml:math></inline-formula> was set to 33.5°C to match experimental conditions. For every 40 ms simulation, we computed the mean number of vesicles released per synapse.</p></sec><sec id="s2-6-6"><title>Optimizing electrical stimulation to separately activate ON- and OFF-BCs</title><p>To find stimuli for selective stimulation of ON- and OFF-BCs, we simulated the response of the BC models to different electrical stimuli. For this, we used a single 30 µm diameter electrode and centered the dendrites of the simulated BCs above this electrode. To find stimuli that stimulate the OFF-BC without stimulating the ON-BC or vice versa, we utilized the same algorithm used for estimating the BC parameters. Here, the inference algorithm was used to estimate parameters of a 40 ms stimulation current <inline-formula><mml:math id="inf355"><mml:msub><mml:mi>i</mml:mi><mml:mtext>stim</mml:mtext></mml:msub></mml:math></inline-formula> parametrized by four free parameters <inline-formula><mml:math id="inf356"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. The current was defined as a cubic spline fit through the knot vector <inline-formula><mml:math id="inf357"><mml:mrow><mml:mi mathvariant="bold">𝐚</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> spaced equidistantly in time between zero and 40 ms, where <inline-formula><mml:math id="inf358"><mml:msup><mml:mi>p</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> is chosen such that the stimulus is charge neutral (i.e. the integral over the current is zero). For all stimuli, the maximum stimulus amplitude was normalized to 0.5 µA. An illustration is shown in Figure 10.</p><p>Here, the priors over <inline-formula><mml:math id="inf359"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> were Gaussian with zero means and standard deviations of 0.3. For every sampled stimulus <inline-formula><mml:math id="inf360"><mml:msubsup><mml:mi>i</mml:mi><mml:mtext>stim</mml:mtext><mml:mi>n</mml:mi></mml:msubsup></mml:math></inline-formula>, we simulated the response of the BCs for <inline-formula><mml:math id="inf361"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>60</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> starting with the stimulus onset. For parameter estimation, we defined the discrepancy measure <inline-formula><mml:math id="inf362"><mml:msubsup><mml:mi>δ</mml:mi><mml:mtext>stim</mml:mtext><mml:mtext>t</mml:mtext></mml:msubsup></mml:math></inline-formula> as the ratio between the relative release <inline-formula><mml:math id="inf363"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> of the OFF- and ON-BC which was defined as:<disp-formula id="equ25"><label>(24)</label><mml:math id="m25"><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mtext>base</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mtext>RRP</mml:mtext><mml:mtext>max</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mtext>base</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf364"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the evoked mean release and <inline-formula><mml:math id="inf365"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mtext>base</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the base release rate in the absence of electrical stimulation; that is, the numerator is equal to the number of released vesicles (as a mean over all synapses) caused by the stimulation. The denominator is equal to the theoretical maximum of releasable vesicles per synapse (see <xref ref-type="disp-formula" rid="equ9">Equation 9</xref>). <inline-formula><mml:math id="inf366"><mml:msubsup><mml:mi>δ</mml:mi><mml:mtext>stim</mml:mtext><mml:mtext>t</mml:mtext></mml:msubsup></mml:math></inline-formula> was computed as:<disp-formula id="equ26"><label>(25)</label><mml:math id="m26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mrow><mml:mtext>stim</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mtext>t</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mrow><mml:mtext>stim</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">B</mml:mi><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">B</mml:mi><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We ran the parameter inference twice (each with one round only), once with the ON- and once with the OFF-BC as target. We drew 400 samples from the prior that were reused for the second run of inference, and 100 more samples from the posterior. Here, the posteriors were two-component mixture of Gaussians without truncation.</p></sec></sec><sec id="s2-7"><title>Code and data availability</title><p>Models and simulation code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/berenslab/CBC_inference">https://github.com/berenslab/CBC_inference</ext-link> (<xref ref-type="bibr" rid="bib77">Oesterle, 2020</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:74cb51f26fd3961f853488aeb3b8ef959ce4e541;origin=https://github.com/berenslab/CBC_inference;visit=swh:1:snp:e584de7e33f4121abd7232331b53d84b5863674b;anchor=swh:1:rev:2b8ec4ac0ca916d42cba0404229298f8ff79c3a3/">swh:1:rev:2b8ec4ac0ca916d42cba0404229298f8ff79c3a3</ext-link>). Experimental and inference data is available at <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4185955">https://zenodo.org/record/4185955</ext-link>.</p></sec></sec><sec id="s3" sec-type="results"><title>Results</title><p>We used a high-resolution electronmicroscopy data set (<xref ref-type="bibr" rid="bib40">Helmstaedter et al., 2013</xref>) to create biophysically realistic multicompartment models of three neuron types from the mouse retina including cones, an OFF- and an ON-bipolar cell (BC) type. These neurons form the very beginning of the visual pathway, with cones converting light into electrochemical signals and providing input via sign-preserving and -reversing synapses to OFF- and ON-BCs, respectively. The parameters of these models include the basic electrical properties of the cells as well as the density of different ion channel types in different compartments. Given a set of parameters, simulations from the model can easily be generated; however, it is not possible to evaluate the likelihood for a given set of parameters, which would be required for standard Bayesian inference procedures for example through MCMC.</p><p>To overcome the challenge of choosing the resulting 20 to 32 parameters of these models, we adapted a recently developed technique called Sequential Neural Posterior Estimation (SNPE) (<xref ref-type="bibr" rid="bib61">Lueckmann et al., 2017</xref>) (for details, see Materials and methods). Starting from prior assumptions about the parameters, the algorithm compared the result of simulations from the model to data obtained by two-photon imaging of the glutamate release from the neurons (<xref ref-type="bibr" rid="bib28">Franke et al., 2017</xref>) and measured a discrepancy value between the simulation and the data. Based on this information, the algorithm used a neural network to iteratively find a distribution over parameters consistent with the measured data. This yielded optimized biophysically realistic models for the considered neuron types.</p><sec id="s3-1"><title>Inference of cone parameters</title><p>We first estimated the posterior distribution over the parameters of a cone based on the glutamate release of a cone stimulated with a full-field chirp light stimulus, consisting of changes in brightness, temporal frequency, and temporal contrast (<xref ref-type="fig" rid="fig4">Figure 4A</xref> and <xref ref-type="fig" rid="fig5">Figure 5</xref>). The cone model had a simplified morphology and consisted of four compartments (<xref ref-type="fig" rid="fig1">Figure 1</xref>, see Materials and methods). We included a number of ion channels in the model reported to exist in the cones of mice or closely related species (see <xref ref-type="table" rid="table1">Table 1</xref>). Prior distributions were chosen based on the literature. For inference, we drew 2000 samples of different parameter settings per round and stopped the algorithm after the fourth round. Then, 200 more parameter samples were drawn from the respective posteriors for further analysis. The chosen discrepancy functions penalized discrepancies between the target and simulated iGluSnFR trace <inline-formula><mml:math id="inf367"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub></mml:math></inline-formula>, implausible membrane potentials, and implausible release rates. To compare different model fits, the discrepancy measures were added to yield a total discrepancy <inline-formula><mml:math id="inf368"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>tot</mml:mtext></mml:msub></mml:math></inline-formula>. We found that the total discrepancy <inline-formula><mml:math id="inf369"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>tot</mml:mtext></mml:msub></mml:math></inline-formula> of the cone model was relatively high for most samples drawn from the prior but decreased over four rounds of sampling (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). The discrepancy measuring the fit quality to the glutamate recording <inline-formula><mml:math id="inf370"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub></mml:math></inline-formula> was already relatively small in the first round for most, but not all samples. In the following rounds, the number of samples with large <inline-formula><mml:math id="inf371"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub></mml:math></inline-formula> was strongly reduced (<xref ref-type="fig" rid="fig4">Figure 4A</xref>).</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Discrepancies of samples from the cone and the BC models during and after parameter estimation.</title><p>(<bold>A, B, C</bold>) Sampled discrepancies for the cone (A), the OFF- (B), and ON-BC (C) respectively. For every model, the total discrepancy <inline-formula><mml:math id="inf372"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>tot</mml:mtext></mml:msub></mml:math></inline-formula> (left) and the discrepancy between the simulated and target iGluSnFR trace <inline-formula><mml:math id="inf373"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub></mml:math></inline-formula> (right) are shown. For every model, four optimization rounds with 2000 samples each were drawn (indicated by gray vertical lines). After the last round (indicated by dashed vertical lines, ‘p.’), 200 more samples were drawn from the posteriors. For the BCs, the number of compartments was increased in this last step to 139 and 152 for the OFF- and ON-BC, respectively. Additionally, 200 samples were drawn from assuming independent posterior marginals for comparison (indicated by blue vertical lines, ‘m.’). For every round, the discrepancy distribution (horizontal histograms), the median discrepancies (red vertical lines), the 25th to 75th percentile (blue shaded area) and the 5th to 95th percentile (gray-shaded area) are shown. (<bold>D</bold>) Discrepancies between different iGluSnFR traces of BCs to demonstrate the high precision of the model fit. The pairwise discrepancy computed with equation <xref ref-type="disp-formula" rid="equ12">Equation 12</xref> between eight iGluSnFR traces is depicted in a heat map. The column and row labels indicate which <inline-formula><mml:math id="inf374"><mml:msub><mml:mi mathvariant="bold-italic">𝝂</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf375"><mml:msub><mml:mi mathvariant="bold-italic">𝝂</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> were used in equation <xref ref-type="disp-formula" rid="equ12">Equation 12</xref> respectively. The traces consists of the optimized BC models (‘Model’), the targets used during optimization (‘Target’), experimental data from the same cell type without the application of any drug (‘No drug’) and experimental data from another retinal CBC type with the application of strychnine (‘BC4’ and ‘BC7’). Note that strychnine was also applied to record the targets.</p><p><supplementary-material id="fig4sdata1"><label>Figure 4—source data 1.</label><caption><title>Sample discrepancies of all samples shown in (A-C).</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-54997-fig4-data1-v2.zip"/></supplementary-material></p><p><supplementary-material id="fig4sdata2"><label>Figure 4—source data 2.</label><caption><title>Discrepancies shown in (D), and the respective (mean) iGluSnFR traces.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-54997-fig4-data2-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54997-fig4-v2.tif"/></fig><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Optimized cone model.</title><p>(<bold>A</bold>) Normalized light stimulus. (<bold>B</bold>) Somatic membrane potential relative to the resting potential for the best parameters (blue line) and for 200 samples from the posterior shown as the median (gray dashed line) and 10th to 90th percentile (gray shaded area). A histogram over all resting potentials is shown on the right. (<bold>C</bold>) Release rate relative to the resting rate. Otherwise as in (B). (<bold>D</bold>) Simulated iGluSnFR trace (as in (B)) compared to target trace (orange). Three regions (indicated by gray dashed boxes) are shown in more detail below without samples from the posterior. Estimates of positive and negative peaks are highlighted (up- and downward facing triangles respectively) in the target (brown) and in the simulated trace (blue and cyan respectively). Pairwise time differences between target and simulated peaks (indicated by triangle pairs connected by a black line) are shown as histograms for positive (blue) and negative (cyan) peaks on the right. The median over all peak time differences is shown as a black vertical line.</p><p><supplementary-material id="fig5sdata1"><label>Figure 5—source data 1.</label><caption><title>iGluSnFR traces used for constraining the cone and BC models.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-54997-fig5-data1-v2.zip"/></supplementary-material></p><p><supplementary-material id="fig5sdata2"><label>Figure 5—source data 2.</label><caption><title>Stimulus, target, and cell responses, including responses with removed ion channels.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-54997-fig5-data2-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54997-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>iGluSnFR traces used for constraining the cone and BC models.</title><p>iGluSnFR traces used for constraining the cone and BC models. (<bold>A,C,E</bold>) All single ROI traces used for the cone, OFF- and ON-BC, respectively. For the cone, the traces are shown in different colors for the two recorded axon terminals. (<bold>B</bold>) Aligned mean traces of both cone axon terminals (same colors as in (A)), and the mean of both means (orange), which was used as the target during parameter inference. (<bold>D,F</bold>) Mean traces (orange) plus-minus one standard deviation (gray-shaded area) across all single ROI traces for the OFF- and ON-BC, respectively.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54997-fig5-figsupp1-v2.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 2.</label><caption><title>Effect of active ion conductances on the optimized cone model.</title><p>Voltage and iGluSnFR traces for the optimized cone model with different ion channels removed. In every row, a different (set of) ion channels has been removed from the model by setting the respective conductances to zero. The simulated somatic membrane voltages (first column) and iGluSnFR traces (third column) and the differences with respect to the simulation with all ion channels (second and fourth column, respectively) are shown. The fifth column shows how removing the ion channel changed the total discrepancy <inline-formula><mml:math id="inf376"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>tot</mml:mtext></mml:msub></mml:math></inline-formula> and distance to the experimental target <inline-formula><mml:math id="inf377"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub></mml:math></inline-formula>. The row titles refer to the channel that has been removed, for example in the first row, the HCN channel has been removed. In the last row (passive), all but the calcium channels in the axon terminals were removed.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54997-fig5-figsupp2-v2.tif"/></fig></fig-group><p>The parameter setting with lowest discrepancy (<inline-formula><mml:math id="inf378"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mtext>tot</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>0.10</mml:mn></mml:mrow></mml:math></inline-formula>) modeled accurately the response of the cone to full-field stimulation with the chirp light stimulus (<xref ref-type="fig" rid="fig5">Figure 5</xref>). The simulated iGluSnFR signal nicely matched the data both on a coarse timescale and in the millisecond regime (<xref ref-type="fig" rid="fig5">Figure 5D</xref>). Indeed, for this sample, all discrepancies besides <inline-formula><mml:math id="inf379"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub></mml:math></inline-formula> were zero or almost zero (<inline-formula><mml:math id="inf380"><mml:mrow><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mtext>tot</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.0001</mml:mn></mml:mrow></mml:math></inline-formula>) and most of the remaining discrepancy could be attributed to the noisy target data.</p><p>As our inference algorithm returned not only a single best set of parameters, but also a posterior distribution, we could obtain additional parameter samples from the model which should produce simulations consistent with the data. Almost all samples from the posterior yielded simulations that matched the target data well (median <inline-formula><mml:math id="inf381"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub></mml:math></inline-formula>: 0.12) and the overall total discrepancy was small (median <inline-formula><mml:math id="inf382"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>tot</mml:mtext></mml:msub></mml:math></inline-formula>: 0.21). Besides the discrepancy between the experimental and simulated glutamate trace <inline-formula><mml:math id="inf383"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub></mml:math></inline-formula>, most of the remaining discrepancy in the posterior samples was caused by rate variation (mean <inline-formula><mml:math id="inf384"><mml:mrow><mml:mo>∥</mml:mo><mml:msubsup><mml:mi>δ</mml:mi><mml:mtext>Rate</mml:mtext><mml:mi mathvariant="normal">Δ</mml:mi></mml:msubsup><mml:mo>∥</mml:mo></mml:mrow></mml:math></inline-formula>: 0.18) and resting rates (mean <inline-formula><mml:math id="inf385"><mml:mrow><mml:mo>∥</mml:mo><mml:msubsup><mml:mi>δ</mml:mi><mml:mtext>Rate</mml:mtext><mml:mtext>Rest</mml:mtext></mml:msubsup><mml:mo>∥</mml:mo></mml:mrow></mml:math></inline-formula>: 0.14) that were too low in some of the models. While in principle we could propagate the remaining uncertainty about the model parameters provided by the posterior to the inference about BC models, we used only the parameter set with the smallest total discrepancy <inline-formula><mml:math id="inf386"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>tot</mml:mtext></mml:msub></mml:math></inline-formula> for efficiency and refer to this as the optimized cone model. To analyze the role of active ion channels, we removed ion channels individually (except for the <inline-formula><mml:math id="inf387"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> channel with is necessary to simulate the vesicle release) from the optimized cone and simulated the light response (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>). We found that the HCN channel contributed most, while the contribution of <inline-formula><mml:math id="inf388"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> was negligible. Since <inline-formula><mml:math id="inf389"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> did not alter the light response for both, the cone and BC light stimulus, we removed it in the following steps for computational efficiency.</p></sec><sec id="s3-2"><title>Inference of bipolar cell parameters</title><p>We next turned to anatomically detailed multicompartment models of two BC types. We chose to model type 3a and type 5o because these were the OFF- and ON-CBC types for which we could gather most prior information from the literature. The anatomy of the cells was extracted from a 3D reconstruction of examples of these cell types based on electron microscopy data (<xref ref-type="bibr" rid="bib40">Helmstaedter et al., 2013</xref>) and divided into regions sharing ion channel parameters (<xref ref-type="fig" rid="fig1">Figure 1</xref>). As for the cone model, the channels included in the model and the prior distributions were chosen based on the literature (see <xref ref-type="table" rid="table1">Table 1</xref>). This yielded 32 and 27 free parameters for the OFF- and ON-BC, respectively.</p><p>We fitted the BC type models to published two-photon glutamate imaging data reflecting the glutamate release from the BC axon terminals (<xref ref-type="bibr" rid="bib28">Franke et al., 2017</xref>). In this case, we used responses to a local chirp light stimulus activating largely the excitatory center of the cells. In addition, the responses were measured in the presence of the drug strychnine to block locally acting inhibitory feedback through small-field amacrine cells (<xref ref-type="bibr" rid="bib28">Franke et al., 2017</xref>) (see Materials and methods for details). Similar to what we observed in cones, the total discrepancy <inline-formula><mml:math id="inf390"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>tot</mml:mtext></mml:msub></mml:math></inline-formula> for parameter sets sampled for the OFF- and ON-BC model decreased over the four rounds of optimization (<xref ref-type="fig" rid="fig4">Figure 4B and C</xref>). In contrast to the the cone model, the discrepancy measure penalizing deviations from the glutamate trace <inline-formula><mml:math id="inf391"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub></mml:math></inline-formula> was relatively large for prior samples and declined approximately equally fast as the total discrepancy <inline-formula><mml:math id="inf392"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>tot</mml:mtext></mml:msub></mml:math></inline-formula>.</p><p>We found that simulations generated with the parameter set with minimal total discrepancy or parameters sampled from the posterior matched the target traces very well for both OFF- and ON-BC models (<xref ref-type="fig" rid="fig6">Figure 6</xref>). For these parameters, the cells were relatively ispotential units throughout the light stimulus (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref> and <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>) with a larger voltage gradients from dendrites to the axon in the ON-BC. The optimized BC models, that is the BC samples with the lowest total discrepancies <inline-formula><mml:math id="inf393"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>tot</mml:mtext></mml:msub></mml:math></inline-formula>, had discrepancies of zero except for the iGluSnFR discrepancy <inline-formula><mml:math id="inf394"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub></mml:math></inline-formula>. To get a more quantitative impression of the quality of the model fits, we compared the pairwise iGluSnFR discrepancies <inline-formula><mml:math id="inf395"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub></mml:math></inline-formula> between the optimized BC models, the experimentally measured response traces as used during optimization, traces recorded from the same cell type without application of strychnine and responses of another OFF- and ON-BC. For both optimized cell model outputs, the discrepancy was smallest for the targets used during optimization. This shows that the optimized models were able to reproduce cell-type specific details in light response properties that go beyond the simple distinction of ON and OFF responses. While the discrepancies between traces of different ON-BC types were overall relatively small for local stimulation (<xref ref-type="bibr" rid="bib28">Franke et al., 2017</xref>), the discrepancies between traces from OFF cells were larger likely due to network modulation of the target cell type by amacrine cells (indicated by the difference between the target and the no-drug condition) and larger response differences between the two compared OFF-BC types. The posterior samples of both BC models had a low discrepancy, except for a few samples (median <inline-formula><mml:math id="inf396"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>tot</mml:mtext></mml:msub></mml:math></inline-formula>: 0.29 and 0.26 of the OFF- and ON-BC, respectively). The only discrepancy measure with a non-zero median of the absolute values was <inline-formula><mml:math id="inf397"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub></mml:math></inline-formula>, which also accounts for 88% and 82% of the mean total discrepancy for the OFF- and ON-BC respectively.</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Optimized BC models.</title><p>(<bold>A</bold>) Normalized light stimulus. Responses of the OFF- and ON-BC are shown in (<bold>B–D</bold>) and (<bold>E–G</bold>), respectively. (<bold>B, E</bold>) Somatic membrane potential relative to the resting potential for the best parameters (blue line) and for 200 samples from the posterior shown as the median (gray dashed line) and 10th to 90th percentile (gray-shaded area). A histogram over all resting potentials is shown on the right. (<bold>C, F</bold>) Mean release rate over all synapses relative to the mean resting rate. Otherwise as in (B). (<bold>D, G</bold>) Simulated iGluSnFR trace (as in (B)) compared to respective target trace (orange). Three regions (indicated by gray dashed boxes) are shown in more detail below without samples from the posterior. Estimates of positive and negative peaks are highlighted (up- and downward facing triangles, respectively) in the target (brown) and in the simulated trace (blue and cyan, respectively). Pairwise time differences between target and simulated peaks (indicated by triangle pairs connected by a black line) are shown as histograms for positive (blue) and negative (cyan) peaks on the right. The median over all peak time differences is shown as a black vertical line.</p><p><supplementary-material id="fig6sdata1"><label>Figure 6—source data 1.</label><caption><title>Stimulus, target, and cell responses, including responses with removed ion channels.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-54997-fig6-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54997-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Heatmaps of the OFF-BC.</title><p>Heatmaps of the OFF-BC in response to the OFF-step of the light stimulus. A video for the full stimulus is available in the supplementary material. (<bold>A</bold>) Membrane voltage (color-coded) of all compartments mapped on fully detailed morphology. (<bold>B</bold>) Calcium concentration (color-coded) in BC for all compartments for which calcium is simulated. Other compartments are shown in gray. (<bold>C</bold>) Release sites with color-coded release rates (green dots). Compartments are shown in gray. (<bold>D</bold>) Light stimulus. The time for which the heatmaps are shown is indicated by the black vertical line.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54997-fig6-figsupp1-v2.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 2.</label><caption><title>Heatmaps of the ON-BC.</title><p>Heatmaps of the ON-BC in response to the ON-step of the light stimulus; otherwise as in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54997-fig6-figsupp2-v2.tif"/></fig><fig id="fig6s3" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 3.</label><caption><title>Effect of active ion conductances on the optimized OFF-BC model.</title><p>Voltage and iGluSnFR traces for the OFF-BC with different ion channels removed. Models were simulated for the five posterior samples (out of 200) with the lowest total discrepancy <inline-formula><mml:math id="inf398"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>tot</mml:mtext></mml:msub></mml:math></inline-formula> under different conditions. The samples are color-coded across all panels. In every row, a different (set of) ion channels has been removed from the posterior samples by setting the respective conductances to zero. The simulated somatic membrane voltages (first column) and iGluSnFR traces (third column) and the differences with respect to the simulation with all ion channels (second and fourth column, respectively) are shown. The fifth column shows how removing the ion channel changed the total discrepancy <inline-formula><mml:math id="inf399"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>tot</mml:mtext></mml:msub></mml:math></inline-formula> and distance to the experimental target <inline-formula><mml:math id="inf400"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>iGluSnFR</mml:mtext></mml:msub></mml:math></inline-formula> for all samples individually (small vertical lines) and as a mean over all samples (red vertical line). The row titles refer to the channel that has been removed, for example in the first row, the HCN channel has been removed. Ca @ S means, that all somatic calcium channels were removed. In the last row (passive), all but the calcium channels in the axon terminals were removed.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54997-fig6-figsupp3-v2.tif"/></fig><fig id="fig6s4" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 4.</label><caption><title>Effect of active ion conductances on the optimized ON-BC model.</title><p>Voltage and iGluSnFR traces for the ON-BC with different ion channels removed; otherwise as in <xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54997-fig6-figsupp4-v2.tif"/></fig><media id="fig6video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-54997-fig6-video1.mp4"><label>Figure 6—video 1.</label><caption><title>Animated heatmaps of the OFF-BC.</title></caption></media><media id="fig6video2" mime-subtype="mp4" mimetype="video" xlink:href="elife-54997-fig6-video2.mp4"><label>Figure 6—video 2.</label><caption><title>Animated heatmaps of the ON-BC.</title></caption></media></fig-group><p>Despite the overall high resemblance between optimized model outputs and targets, there were some visible systematic differences. For the ON-BC, the target showed a skewed sinusoidal response with faster rise than fall times during the frequency and amplitude increasing sinusoidal light stimulation between 10 s and 18 s and between 20 s and 27 s respectively. In contrast, the optimized model output showed approximately equal rise and fall times, resulting in a systematic delay of positive and negative peaks (median delay of all peaks: 15.6 ms) in the simulated iGluSnFR trace relative to the target (<xref ref-type="fig" rid="fig6">Figure 6G</xref>). Additionally, some of the positive peaks of the optimized ON-BC model during sinusoidal light stimulation were too small (e.g. at 11.5 s). This effect might have been a side-effect of the peak timing difference between target and model: Amplitude increases were inefficient in reducing the discrepancy as long as the peaks were not precisely aligned. In contrast, the peak time precision of the OFF-BC model (<xref ref-type="fig" rid="fig6">Figure 6D</xref>) was much higher (median delay of all peaks: 0.0 ms). In this case, the main difficulty for the model appeared to be its inability to reproduce the non-linearity in the cell response to the increasing amplitude sinusoidal light stimulation between 20 s and 27 s.</p><p>After having verified that the posterior over parameters provided a good fit to the experimental data, we inspected the one-dimensional marginal distributions to learn more about the resulting cellular models (<xref ref-type="fig" rid="fig7">Figure 7</xref>). For most parameters, the marginal posteriors had smaller variances than the priors, indicating that the parameter bounds were not chosen too narrow. For some parameters, the posterior mean differed substantially from the prior mean (e.g. the <inline-formula><mml:math id="inf401"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> channel density at the axon terminal of OFF-BC) while it was largely unchanged for others (e.g. the <inline-formula><mml:math id="inf402"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> channel density at the soma for the OFF-BC). The algorithm also inferred the dependencies of some parameters, visible in the two-dimensional marginals (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref> and <xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref>). Because of these correlations, the full posterior in the high-dimensional parameter space led to simulations which were on average better (median: 0.29 vs. 0.31 and 0.26 vs. 0.33 for the OFF- and ON-BC, respectively) and less variable in their quality (95%-CIs: 0.53 vs. 1.01 and 0.64 vs. 1.42 for the OFF- and ON-BC, respectively) than parameters drawn from a posterior obtained by assuming independent marginal distributions. In most cases, the parameters resulting in the lowest total discrepancy were close to the means of the respective posteriors. For some parameters there was a strong difference between the marginal posteriors of the OFF- and ON-BC. For example, the two parameters controlling the leak conductance, <inline-formula><mml:math id="inf403"><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf404"><mml:msub><mml:mi>R</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula>, were much lower for the OFF-BC consistent with the strong variation of membrane resistances reported in <xref ref-type="bibr" rid="bib78">Oltedal et al., 2009</xref>. The membrane conductance was lower for the ON-BC, which could increase signal transduction speed in the longer axon. Even though the posteriors were narrower than the priors, they still covered a wide range of different parameters. To some extent, this may reflect the fact that we fit the model parameters solely on the cells output, and for example dendritic parameters may be underconstrained by such data; in addition, it may also reflect variability between cells of the same type seen in the experimental data that has also been reported in other studies (<xref ref-type="bibr" rid="bib28">Franke et al., 2017</xref>).</p><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Parameter distributions of the BC models.</title><p>1D-marginal prior (dashed gray line) and posterior distributions (solid lines) are shown for the OFF- (blue) and ON-BC (green). The parameters of the posterior samples with the lowest total discrepancy are shown as dashed vertical lines in the respective color. <inline-formula><mml:math id="inf405"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>Y</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">@</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula> refers to the channel density of channel <inline-formula><mml:math id="inf406"><mml:msub><mml:mi>X</mml:mi><mml:mi>Y</mml:mi></mml:msub></mml:math></inline-formula> at location <inline-formula><mml:math id="inf407"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Locations are abbreviated; S: soma, A: axon, D: dendrite and AT: axon terminals (see <xref ref-type="fig" rid="fig1">Figure 1</xref> and main text for details). Note that although these 1D-marginal distributions seem relatively wide in some cases, the full high-dimensional posterior has much more structure than a posterior distribution obtained from assuming independent marginals (see <xref ref-type="fig" rid="fig4">Figure 4</xref>). Not all parameter distributions are shown.</p><p><supplementary-material id="fig7sdata1"><label>Figure 7—source data 1.</label><caption><title>Prior and posterior parameters for the OFF- and ON-BC.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-54997-fig7-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54997-fig7-v2.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>2D-marginals for the OFF-BC.</title><p>Parameter distributions of the OFF-BC model. 2D-marginal prior (gray) and posterior distributions (red). Distributions are shown as contour lines at 30, 60 and 90% of the maximum of the respective probability density functions. Not all parameter distributions are shown.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54997-fig7-figsupp1-v2.tif"/></fig><fig id="fig7s2" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 2.</label><caption><title>2D-marginals for the ON-BC.</title><p>Parameter distributions of the ON-BC model. 2D-marginal prior (gray) and posterior distributions (red). Distributions are shown as contour lines at 30, 60, and 90% of the maximum of the respective probability density functions. Not all parameter distributions are shown.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54997-fig7-figsupp2-v2.tif"/></fig></fig-group><p>After the fourth optimization round, 200 samples were drawn from the posterior distribution with an increased number of compartments to find model parameters to simulate electrical stimulation (see Methods). For comparison, we also ran simulations with the same parameters but the original number of compartments (data not shown). Interestingly, more than 85% of the samples had a lower discrepancy if the models were simulated with more compartments for both BCs. For the best 20% (i.e. 40 samples) of the posterior samples (sorted with respect to samples with fewer compartments), the samples with more compartments had lower discrepancies with only one exception per cell. This indicates that, given enough computational power, the same parameter inference approach but with more compartments could further improve the model outputs. From these samples, we used the five samples with the smallest total discrepancies <inline-formula><mml:math id="inf408"><mml:msub><mml:mi>δ</mml:mi><mml:mtext>tot</mml:mtext></mml:msub></mml:math></inline-formula> for the simulation of electrical stimulation.</p><p>Additionally, we used these five samples to analyze the effect of active ion conductances on the light response by removing individual ion channels types from the BCs (<xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3</xref> and <xref ref-type="fig" rid="fig6s4">Figure 6—figure supplement 4</xref>). Similar to the optimized cone model, the HCN channels played the most important role in shaping the light response. For both cells, the <inline-formula><mml:math id="inf409"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and somatic calcium channels barely had any influence on the membrane voltage or the vesicle release rate.</p></sec><sec id="s3-3"><title>Simulating electrical stimulation of the retina</title><p>To provide an exemplary use-case for our data-driven biophysical models of retinal neurons, we asked whether we could use our simulation framework to optimize the stimulation strategy for retinal neuroprosthetic implants. These implants have been developed for patients who lose sight due to degeneration of their photoreceptors (<xref ref-type="bibr" rid="bib111">Zrenner, 2002</xref>). While existing implants have been reported to provide basic vision (<xref ref-type="bibr" rid="bib111">Zrenner, 2002</xref>; <xref ref-type="bibr" rid="bib23">Edwards et al., 2018</xref>; <xref ref-type="bibr" rid="bib62">Luo and da Cruz, 2016</xref>), they are far from perfect. For example, most current stimulation strategies likely activate OFF- and ON-pathways at the same time (<xref ref-type="bibr" rid="bib6">Barriga-Rivera et al., 2017</xref>). To this end, we created a simulation framework for subretinal electrical stimulation of retinal tissue with micro-electrode arrays. We estimated the conductivity and relative permittivity of the retina based on experimentally measured currents evoked by sinusoidal voltages and then validated simulations of the electrical stimulation of our fitted BC models with standard pulse like stimuli against responses measured in RGCs (<xref ref-type="bibr" rid="bib18">Corna et al., 2018</xref>). Finally, we used the simulation framework to find stimuli that can separately stimulate OFF- and ON-BCs.</p><p>Our framework for simulating the effect of external electrical stimulation using the inferred BC models consisted of two steps: we first estimated the electrical field resulting from a stimulation protocol as a function of space and time across the whole retina (<xref ref-type="fig" rid="fig3">Figure 3</xref>). The corresponding extracellular voltages were then applied to the respective compartments to simulate the neural response. To do so, we needed a model of the electrical properties of the electrode and the retinal tissue. We assumed disk electrodes and a simplified model assuming homogeneous electrical properties of the retina and the surrounding medium (see Materials and methods). This model contained two free parameters that needed to be estimated from data: the conductivity and relative permittivity of the retinal tissue.</p><p>To estimate these parameters we recorded electrical currents resulting from sinusoidal voltage stimulation with different frequencies in a dish with and without a retina (<xref ref-type="fig" rid="fig8">Figure 8B,C</xref>). We used the data without a retina to estimate the properties of the stimulation electrode (<xref ref-type="fig" rid="fig8">Figure 8A,D,E</xref> and Materials and methods). Based on the estimates of the electrode properties and the data recorded with a retina, we estimated the conductivity and relative permittivity of the retina with the same parameter inference method as for the neuron models.</p><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Estimation of the conductivity <inline-formula><mml:math id="inf410"><mml:msub><mml:mi>σ</mml:mi><mml:mtext>retina</mml:mtext></mml:msub></mml:math></inline-formula> and the relative permittivity <inline-formula><mml:math id="inf411"><mml:msub><mml:mi>ε</mml:mi><mml:mtext>retina</mml:mtext></mml:msub></mml:math></inline-formula> of the retina for simulating electrical stimulation.</title><p>(<bold>A</bold>) Electrical circuits used during parameter estimation. (<bold>B</bold>) Stimulation voltages <inline-formula><mml:math id="inf412"><mml:msub><mml:mi>v</mml:mi><mml:mtext>stim</mml:mtext></mml:msub></mml:math></inline-formula> at 25 (left) and 40 Hz (right). From the six experimentally applied amplitudes, only the amplitudes used for parameter inference are shown. (<bold>C</bold>) Experimentally measured currents <inline-formula><mml:math id="inf413"><mml:msub><mml:mi>i</mml:mi><mml:mtext>ames</mml:mtext></mml:msub></mml:math></inline-formula> through electrolyte (Ames’ solution) without retinal tissue for the stimulus voltages <inline-formula><mml:math id="inf414"><mml:msub><mml:mi>v</mml:mi><mml:mtext>stim</mml:mtext></mml:msub></mml:math></inline-formula> in (B). The mean traces over all (but the first two) repetitions are shown (black dashed lines). Sine waves were fitted to the mean traces (solid lines) with colors referring to the voltages in (B). (<bold>D</bold>) Simulated voltages over the electrolyte <inline-formula><mml:math id="inf415"><mml:msub><mml:mi>v</mml:mi><mml:mtext>ames</mml:mtext></mml:msub></mml:math></inline-formula> using the fitted currents in (C) as stimuli applied to the circuit in (Ai). (Aii) Electrical circuit used to model the electrode plus interface. (<bold>E</bold>) Stimulus frequency and amplitude dependent estimates of <inline-formula><mml:math id="inf416"><mml:msub><mml:mi>R</mml:mi><mml:mtext>e</mml:mtext></mml:msub></mml:math></inline-formula> (i) and <inline-formula><mml:math id="inf417"><mml:msub><mml:mi>C</mml:mi><mml:mtext>e</mml:mtext></mml:msub></mml:math></inline-formula> (ii) based on the electrical circuit shown in (Aii) for 25 (black) and 40 Hz (gray). Note that the values were derived analytically (see main text). The values corresponding to the stimulus voltages shown in (B) are highlighted with respective color. (Aiii) Electrical circuit used to estimate <inline-formula><mml:math id="inf418"><mml:msub><mml:mi>σ</mml:mi><mml:mtext>retina</mml:mtext></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf419"><mml:msub><mml:mi>ε</mml:mi><mml:mtext>retina</mml:mtext></mml:msub></mml:math></inline-formula>. The respective values for <inline-formula><mml:math id="inf420"><mml:msub><mml:mi>R</mml:mi><mml:mtext>e</mml:mtext></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf421"><mml:msub><mml:mi>C</mml:mi><mml:mtext>e</mml:mtext></mml:msub></mml:math></inline-formula> are shown in (E) and are dependent on <inline-formula><mml:math id="inf422"><mml:msub><mml:mi>v</mml:mi><mml:mtext>stim</mml:mtext></mml:msub></mml:math></inline-formula>. The current <inline-formula><mml:math id="inf423"><mml:msub><mml:mi>i</mml:mi><mml:mtext>retina</mml:mtext></mml:msub></mml:math></inline-formula> through the model is measured for a given stimulus voltage <inline-formula><mml:math id="inf424"><mml:msub><mml:mi>v</mml:mi><mml:mtext>stim</mml:mtext></mml:msub></mml:math></inline-formula>. (<bold>F</bold>) Sampled parameters of <inline-formula><mml:math id="inf425"><mml:msub><mml:mi>ε</mml:mi><mml:mtext>retina</mml:mtext></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf426"><mml:msub><mml:mi>σ</mml:mi><mml:mtext>retina</mml:mtext></mml:msub></mml:math></inline-formula> and the respective sample losses. First, samples were drawn in a wide logarithmic space (gray dots) and then in a narrower linear parameter space. The best sample (lowest discrepancy) is highlighted in red. (<bold>G</bold>) Simulated currents <inline-formula><mml:math id="inf427"><mml:msub><mml:mi>i</mml:mi><mml:mtext>retina</mml:mtext></mml:msub></mml:math></inline-formula> (solid lines) through the circuit in (Aiii) with optimized parameters (red dot in (F)) and respective experimentally measured currents (broken lines). Here, results for all six stimulus amplitudes are shown for both frequencies.</p><p><supplementary-material id="fig8sdata1"><label>Figure 8—source data 1.</label><caption><title>Currents, voltages, and samples from optimization.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-54997-fig8-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54997-fig8-v2.tif"/></fig><p>We found that both parameters are very well constrained by the measured data (<xref ref-type="fig" rid="fig8">Figure 8F</xref>). The parameters resulting in the lowest discrepancy were <inline-formula><mml:math id="inf428"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:mn>0.076</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf429"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1.1</mml:mn><mml:mo>×</mml:mo><mml:mpadded width="+1.7pt"><mml:msup><mml:mn>10</mml:mn><mml:mn>7</mml:mn></mml:msup></mml:mpadded></mml:mrow></mml:mrow></mml:math></inline-formula> in accordance with the conductivity of <inline-formula><mml:math id="inf430"><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:mn>0.077</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:math></inline-formula> reported for rabbit <xref ref-type="bibr" rid="bib24">Eickenscheidt et al., 2012</xref> and the relative permittivity of gray matter estimated in <xref ref-type="bibr" rid="bib29">Gabriel et al., 1996</xref>. With these parameters, we simulated currents for all stimulus amplitudes we recorded experimentally. The simulated and experimental currents matched for the amplitudes used during parameter inference but also for amplitudes reserved for model validation (<xref ref-type="fig" rid="fig8">Figure 8G</xref>). Therefore, we used them in all following experiments.</p><p>To validate our simulation framework, we compared simulated BC responses to experimentally measured RGC thresholds (<xref ref-type="bibr" rid="bib18">Corna et al., 2018</xref>). We simulated BCs at different positions for four different electrode configurations (<xref ref-type="fig" rid="fig9">Figure 9A</xref>) and nine stimulation current wave forms (<xref ref-type="fig" rid="fig9">Figure 9B</xref>). For small stimulus charge densities, the BCs barely responded, whereas for very high charge densities the cells released all glutamate vesicles available in the readily release pool (<xref ref-type="fig" rid="fig9">Figure 9C and D</xref>). In between, the response increased from no response to saturation, dependent on the distances of the simulated cell to the active electrodes. Across stimulation conditions, these threshold regions coincide with the measured RGC thresholds to the same stimulation, when assuming that the stimulated RGCs were not too far away from the stimulation electrode. Since the reported RGC thresholds likely result from indirect stimulation via BCs, the consistency between the RGC and simulated BC thresholds can be interpreted as evidence that our model was well calibrated to simulate electrical stimulation.</p><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>Threshold of electrical stimulation for experimentally measured RGCs and simulated BCs of photoreceptor degenerated mouse retina.</title><p>(<bold>A</bold>) Stimulation currents measured experimentally and used as stimuli in the simulations. (<bold>B</bold>) xy-positions of BCs (crosses) and electrodes (red dots) for 1×1, 2×2, 4×4, 10×10 stimulation electrodes, respectively. Every electrode is modeled as a disc with a 30 µm diameter. Except for the electrode configuration, the models were as in <xref ref-type="fig" rid="fig8">Figure 8</xref>. (<bold>C, D</bold>) Mean synaptic glutamate release relative to the size of the readily releasable pool <inline-formula><mml:math id="inf431"><mml:msubsup><mml:mi>v</mml:mi><mml:mtext>RRP</mml:mtext><mml:mtext>max</mml:mtext></mml:msubsup></mml:math></inline-formula> of simulated OFF- and ON-BCs, respectively. Values can be greater than 1, because the pool is replenished during simulation. Errorbars indicate the standard deviation between simulations of BCs with different parametrizations; for both BCs, the five best posterior samples were simulated. Glutamate release is shown for different charge densities (x-axis) and cell positions (colors correspond to xy-positions in (A); for example the darkest blue corresponds to the central BC). Experimentally measured RGC thresholds (gray dashed lines) plus-minus one standard deviation (gray-shaded ares) are shown in the same plots.</p><p><supplementary-material id="fig9sdata1"><label>Figure 9—source data 1.</label><caption><title>Current traces and vesicle release for all simulations.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-54997-fig9-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54997-fig9-v2.tif"/></fig></sec><sec id="s3-4"><title>Optimized electrical stimulation for selective OFF- and ON-BC stimulation</title><p>We finally used our framework for electrical stimulation to find stimuli that excite OFF- or ON-BCs selectively. To this end, we performed Bayesian inference over an electrical charge-neutral stimulus (<xref ref-type="fig" rid="fig10">Figure 10A</xref>) with the SNPE algorithm, using the response ratio between the two BC types (<xref ref-type="fig" rid="fig10">Figure 10B</xref>) as a discrepancy function to minimize. Using this procedure, we found that triphasic, anodic first stimuli with a cathodic middle phase of high amplitude (<xref ref-type="fig" rid="fig10">Figure 10C</xref>) evoked substantial neurotransmitter release in the OFF-BC (<xref ref-type="fig" rid="fig10">Figure 10Di</xref>) while evoking almost no response in the ON-BC (<xref ref-type="fig" rid="fig10">Figure 10Dii</xref>). The stimuli optimized to target the ON-BC were biphasic, with no clear preference for anodic or cathodic first currents (<xref ref-type="fig" rid="fig10">Figure 10E</xref>). In contrast to the stimuli optimized for the OFF-BC, these stimuli did not exclusively stimulate the targeted ON-BC (<xref ref-type="fig" rid="fig10">Figure 10Fii</xref>) but also the OFF-BC (<xref ref-type="fig" rid="fig10">Figure 10Fi</xref>). We did not find stimuli evoking stronger release (defined as in <xref ref-type="disp-formula" rid="equ25">Equation 24</xref>) in the ON-BC than the OFF-BC. This lower threshold of the OFF-BC, which we also observed for the biphasic current pulses (<xref ref-type="fig" rid="fig9">Figure 9</xref>), was partially caused by the shorter axon of the OFF-BC resulting in slightly larger changes of the extracellular voltage at the axon terminals during stimulation (<xref ref-type="fig" rid="fig10s1">Figure 10—figure supplement 1A,B</xref>). While the morphologies and ion channel distributions contributed to differences in the membrane voltage at the axon terminals (<xref ref-type="fig" rid="fig10s1">Figure 10—figure supplement 1C</xref>), the decisive factor for differences in the OFF and ON response presumably lies in the presence or absence of <inline-formula><mml:math id="inf432"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> channels at the axon terminals. Removing these channels from the OFF-BC had almost no effect on the membrane voltage, but resulted in qualitatively similar responses for both cell types (<xref ref-type="fig" rid="fig10s1">Figure 10—figure supplement 1D,E</xref>). Removing the <inline-formula><mml:math id="inf433"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> channels at the axon terminals on the other hand, left the OFF response for the triphasic and biphasic cathodic first stimuli largely unchanged (<xref ref-type="fig" rid="fig10s1">Figure 10—figure supplement 1F</xref>).</p><fig-group><fig id="fig10" position="float"><label>Figure 10.</label><caption><title>Electrical currents optimized for selective ON- and OFF-BC stimulation.</title><p>(<bold>A</bold>) Illustration of the stimulus parametrization. A stimulation current was computed by fitting a cubic spline through points defined by <inline-formula><mml:math id="inf434"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf435"><mml:msup><mml:mi>p</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> (black dots) that were placed equidistantly in time. <inline-formula><mml:math id="inf436"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> were free parameters and <inline-formula><mml:math id="inf437"><mml:msup><mml:mi>p</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> was chosen such that the stimulus was charge neutral, that is the integral over the current (gray-shaded area) was zero. Currents were normalized such that the maximum amplitude was always 0.5 µA. (<bold>B</bold>) Illustration of the electrical stimulation of an OFF- (i) and ON-BC (ii) multicompartment model. (<bold>C, E</bold>) Stimuli optimized for selective OFF- and ON-BC stimulation, respectively. The two best stimuli observed during optimization are shown. (<bold>D, F</bold>) Cumulative vesicle release (as a mean over all synapses) relative to the size of the readily releasable pool <inline-formula><mml:math id="inf438"><mml:msubsup><mml:mi>v</mml:mi><mml:mtext>RRP</mml:mtext><mml:mtext>max</mml:mtext></mml:msubsup></mml:math></inline-formula> in response to the electrical stimuli shown in (C) and (E), respectively. Stimuli and responses are shown in matching colors. Release is shown for the five best posterior cell parametrizations for the OFF- (i) and ON-BC (ii) as a mean (line) plus-minus one standard deviation (shaded area).</p><p><supplementary-material id="fig10sdata1"><label>Figure 10—source data 1.</label><caption><title>Optimized stimuli and BC responses, including responses with removed ion channels.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-54997-fig10-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54997-fig10-v2.tif"/></fig><fig id="fig10s1" position="float" specific-use="child-fig"><label>Figure 10—figure supplement 1.</label><caption><title>Electrical stimulation with optimized stimuli and removed ion channels.</title><p>Electrical stimulation with optimized stimuli and selectively removed ion channels. (<bold>A</bold>) Stimulation currents optimized to selectively stimulate the ON- (left and middle) and OFF-BC (right). (<bold>B</bold>) Evoked extracellular voltage at the presynaptic BC compartments (as a mean over all synapses) for the OFF- (blue) and ON-BC (green), respectively. (<bold>C</bold>) Change of the membrane voltage during stimulation at the presynaptic BC compartments for the five best posterior BC parametrizations. Otherwise as in (B). (<bold>D</bold>) Cumulative vesicle release (as a mean over all synapses) relative to the size of the readily releasable pool <inline-formula><mml:math id="inf439"><mml:msubsup><mml:mi>v</mml:mi><mml:mtext>RRP</mml:mtext><mml:mtext>max</mml:mtext></mml:msubsup></mml:math></inline-formula> for the same BC parametrizations. (<bold>E</bold>) As in (D), but the <inline-formula><mml:math id="inf440"><mml:msub><mml:mtext>Ca</mml:mtext><mml:mtext>T</mml:mtext></mml:msub></mml:math></inline-formula> channels at the axon terminals of the OFF-BC were removed. (<bold>F</bold>) As in (D), but the <inline-formula><mml:math id="inf441"><mml:msub><mml:mtext>Ca</mml:mtext><mml:mtext>L</mml:mtext></mml:msub></mml:math></inline-formula> channels at the axon terminals of the OFF-BC were removed.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54997-fig10-figsupp1-v2.tif"/></fig></fig-group></sec></sec><sec id="s4" sec-type="discussion"><title>Discussion</title><p>In this study, we showed how the recently developed Bayesian likelihood-free parameter inference method called Sequential Neural Posterior Estimation (SNPE) (<xref ref-type="bibr" rid="bib61">Lueckmann et al., 2017</xref>) can be used to estimate the parameters of multicompartment models of retinal neurons based on light-response measurements. In addition, we built a model for electrical stimulation of the retina, and optimized electrical stimulation protocols for retinal neuroprosthetic devices designed to support vision in the blind.</p><p>Performing Bayesian inference for mechanistic models is difficult, as they typically do not come with an analytical solution of the likelihood function. The SNPE algorithm — like many approximate Bayesian computation (ABC) methods (<xref ref-type="bibr" rid="bib92">Sisson et al., 2018</xref>) — does not require such an analytical formulation, as it builds on simulations of the model. In contrast to standard ABC methods, the SNPE algorithm makes efficient use of simulation time by using all simulated data to train a mixture density network to update the parameter distributions (<xref ref-type="bibr" rid="bib61">Lueckmann et al., 2017</xref>; <xref ref-type="bibr" rid="bib35">Gonçalves et al., 2020</xref>). Moreover, SNPE makes minimal assumptions about the simulator, giving full flexibility to use it with different simulation environments and software. As all Bayesian methods, SNPE allows the incorporation of literature knowledge in the form of priors which can be used to constrain parameters and to put more weight on more plausible parameters. Finally, it does not only yield a point-estimate of the best parameters — like exhaustive grid-search techniques (<xref ref-type="bibr" rid="bib34">Goldman et al., 2001</xref>; <xref ref-type="bibr" rid="bib83">Prinz et al., 2003</xref>; <xref ref-type="bibr" rid="bib94">Stringer et al., 2016</xref>) or evolutionary algorithms (<xref ref-type="bibr" rid="bib31">Gerken et al., 2006</xref>; <xref ref-type="bibr" rid="bib54">Keren et al., 2005</xref>; <xref ref-type="bibr" rid="bib1">Achard and De Schutter, 2006</xref>; <xref ref-type="bibr" rid="bib86">Rossant et al., 2011</xref>) — but also returns a posterior distribution that reflects remaining parameter uncertainties and allows one to detect dependencies between parameters.</p><p>Recently, there has been a surge of interest in Bayesian simulator-based inference with many recently published algorithms (<xref ref-type="bibr" rid="bib37">Gutmann and Corander, 2016</xref>; <xref ref-type="bibr" rid="bib80">Papamakarios and Murray, 2016</xref>; <xref ref-type="bibr" rid="bib61">Lueckmann et al., 2017</xref>; <xref ref-type="bibr" rid="bib60">Lintusaari et al., 2017</xref>; <xref ref-type="bibr" rid="bib79">Papamakarios et al., 2018</xref>; <xref ref-type="bibr" rid="bib107">Wood, 2010</xref>; <xref ref-type="bibr" rid="bib22">Durkan et al., 2018</xref>; <xref ref-type="bibr" rid="bib92">Sisson et al., 2018</xref>; <xref ref-type="bibr" rid="bib35">Gonçalves et al., 2020</xref>; <xref ref-type="bibr" rid="bib10">Bittner et al., 2019</xref>). While we initially evaluated different algorithms, we did not perform a systematic comparison or benchmarking effort, which is beyond the scope of this project. Much of the literature on simulator-based inference evaluates the proposed algorithms on fairly simple models. In contrast, we used SNPE here to perform parameter inference of comparatively complex multicompartment models of neurons. Importantly, we did not need targeted experiments to constrain these models, but based our framework on two-photon imaging data of glutamate release in response to simple light stimuli using a genetically encoded indicator called iGluSnFR (<xref ref-type="bibr" rid="bib66">Marvin et al., 2013</xref>; <xref ref-type="bibr" rid="bib28">Franke et al., 2017</xref>). This methods allows direct experimental access to the neurotransmitter release of all excitatory neurons of the retina (<xref ref-type="bibr" rid="bib26">Euler et al., 2019</xref>). Using this data, we inferred the distributions of model parameters relevant for all the intermediate steps between light stimulation of cones to the glutamate release from synaptic ribbons. While we optimized many parameters in the models using SNPE, we chose to keep some parameters on sensible default values to avoid issues with computational complexity. Of course, it is possible that optimization of the full parameter space would have yielded slightly better results or that some parameters would have been set to slightly different values, as a mechanism whose parameter was allowed to vary compensated for the one whose parameter was held fixed. As an alternative to our approach, one can combine classical systems identification approaches with inference for only some of the biophysical mechanisms such as the ribbon synapse (<xref ref-type="bibr" rid="bib89">Schröder et al., 2019</xref>). Our approach, however, allows the exploration of mechanisms within neurons which are not or only barely experimentally accessible. For example, in BCs, it is currently difficult to obtain direct voltage measurements from any part of the cell but the soma. If one is interested in how the electrical signal propagates through the axon or the axon terminal, our simulations may help to obtain mechanistic insights and develop causal hypotheses.</p><p>Because our inference framework works with experimental measurements which can be performed in a high-throughput manner, it allows for a comparably easy scaling to infer model parameters of a larger number of multicompartment models e.g. of different neuron types. In principle it could even be possible to infer the parameters of a neuron by imaging another neuron. For example, one could attempt to infer parameters of an amacrine cell by observing the neurotransmitter release of a connected BC — although such an indirect inference would likely result in larger uncertainties. Ideally, such a large-scale approach would also include realistic morphologies, for example from electron microscopy as shown here. In fact, BCs are anatomically relatively ‘simple’ neurons, and it will be interesting to test our inference methods on neurons with more complicated structure such as some amacrine cells (<xref ref-type="bibr" rid="bib67">Masland, 2012</xref>). While we did not aim at an exhaustive analysis of the effect of morphology on the neuron responses, one could easily explore how details of the morphology influence the distribution of optimal biophysical parameters. Further, we extended our model to simulate and optimize external electrical stimulation of the retina. For blind patients suffering from photoreceptor degeneration, for example caused by diseases like Retinitis Pigmentosa, neuroprosthetic devices electrically stimulating remaining retinal neurons can restore basic visual abilities (<xref ref-type="bibr" rid="bib23">Edwards et al., 2018</xref>; <xref ref-type="bibr" rid="bib62">Luo and da Cruz, 2016</xref>). The spatial and temporal resolution of such retinal implants is, however, still very limited (<xref ref-type="bibr" rid="bib105">Weitz et al., 2015</xref>) with the highest reported restored visual acuity of 20/546 (<xref ref-type="bibr" rid="bib15">Chuang et al., 2014</xref>). While many experimental studies have explored different strategies of stimulation (<xref ref-type="bibr" rid="bib48">Jensen et al., 2005</xref>; <xref ref-type="bibr" rid="bib49">Jensen and Rizzo, 2008</xref>; <xref ref-type="bibr" rid="bib99">Tsai et al., 2009</xref>; <xref ref-type="bibr" rid="bib24">Eickenscheidt et al., 2012</xref>), most of them are restricted to very specific stimulus types such as current or voltages pulses. As a consequence, retinal implants are not able to specifically target cell types such as the independent stimulation of the ON and OFF pathways of the retina (<xref ref-type="bibr" rid="bib59">Lee and Im, 2019</xref>; <xref ref-type="bibr" rid="bib6">Barriga-Rivera et al., 2017</xref>; <xref ref-type="bibr" rid="bib100">Twyford et al., 2014</xref>). To facilitate a systematic stimulus optimization in silico, we developed a simulation framework for electrical stimulation of the retina. While the idea to simulate responses of BCs to electrical stimuli is not new, previous studies restricted their models to point/ball source electrodes (<xref ref-type="bibr" rid="bib85">Resatz and Rattay, 2004</xref>; <xref ref-type="bibr" rid="bib84">Rattay et al., 2017</xref>), simplified BCs to passive cables (<xref ref-type="bibr" rid="bib30">Gerhardt et al., 2010</xref>) or used simplified BC models that only express L- or T-type channels (<xref ref-type="bibr" rid="bib106">Werginz et al., 2015</xref>). Our framework combines the simulation of micro-electrode arrays used in neuroprosthetic devices (<xref ref-type="bibr" rid="bib23">Edwards et al., 2018</xref>; <xref ref-type="bibr" rid="bib62">Luo and da Cruz, 2016</xref>) with detailed models of an OFF- and ON-BC. This allowed us to test a large number of stimulus waveforms, optimizing for stimuli selectively targeting either OFF- or ON-BCs, which could help to better encode visual scenes into electrical signals of retinal implants. We found stimuli selectively targeting the OFF-BC without stimulating the ON-BC, but not vice versa. Likely, the main reason for the differential response of the two BC types was that only the OFF-BC had T-type calcium channels at the axon terminals. These channels were more sensitive to transient changes in the membrane voltage which were evoked by the stimuli optimized to selectively target the OFF-BC. The ON-BC, having no T-type calcium channels and an overall higher threshold, did not respond to these stimuli. However, it could be stimulated with longer anodic stimulus phases activating the L-type calcium channels. Since we modeled the cells in isolation, network effects through synaptic activation of amacrine cells might further modulate the activity of the BCs. However, the neurites and somata of amacrine cells are substantially farther away from the stimulation electrode than those of the BCs, and these effects might be comparably small. That notwithstanding, simulations including network effects and also more diverse BC types will be required in the future. Ideally, in silico optimized stimulation strategies would be first verified in ex vivo experiments before implementing them in neuroprosthetic devices to improve the quality of visual impressions.</p><p>To be able to simulate the electrical stimulation of the retina, we first inferred the conductivity and relative permittivity of the <italic>rd10</italic> retina based on recorded currents evoked by sinusoidal stimulation voltages. While the estimated conductivity (<inline-formula><mml:math id="inf442"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.076</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>) is consistent with the value (<inline-formula><mml:math id="inf443"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.077</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>) reported in <xref ref-type="bibr" rid="bib24">Eickenscheidt et al., 2012</xref>, also smaller (<inline-formula><mml:math id="inf444"><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:mn>0.025</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:math></inline-formula>, <xref ref-type="bibr" rid="bib52">Karwoski and Xu, 1999</xref>) and larger (≈<inline-formula><mml:math id="inf445"><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:mn>0.75</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:math></inline-formula>, <xref ref-type="bibr" rid="bib103">Wang and Weiland, 2015</xref>) conductivities have been reported for the retina. These differences may be due to different ways in tissue handling and preparation. Comparing the estimated values of the relative permittivity (<inline-formula><mml:math id="inf446"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1.1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/></mml:mrow></mml:mstyle></mml:math></inline-formula>) to the literature is more difficult, and most simulation studies choose to ignore its effects. The relative permittivity of retinal tissue has been reported for very high frequencies (10 MHz to 10 GHz), but the strong frequency dependence makes a direct comparison to frequencies several orders of magnitude smaller (e.g. 40 Hz) not meaningful. Additionally, data from gray matter suggest a relative permittivity of 1.5 × 10<sup>7</sup> at 40 Hz very close to our estimate (<xref ref-type="bibr" rid="bib29">Gabriel et al., 1996</xref>). This opens the question weather the common assumption to ignore the effects of the relative permittivity in other simulations (<xref ref-type="bibr" rid="bib30">Gerhardt et al., 2010</xref>; <xref ref-type="bibr" rid="bib106">Werginz et al., 2015</xref>; <xref ref-type="bibr" rid="bib84">Rattay et al., 2017</xref>) is valid.</p><p>In summary, mechanistic models in neuroscience such as biophysically realistic multicompartment models have long been regarded as requiring many manual parameter choices or highly specific experiments to constrain them. We showed here how relatively standard, high-throughput imaging data in combination with likelihood-free inference techniques can be used to perform Bayesian inference on such models, allowing unprecedented possibilities for efficient optimization and analysis of such models. Importantly, this allow us to understand which parameters in such models are well constrained, and which are not, and determine which parameter combinations lead to similar simulation outcomes (<xref ref-type="bibr" rid="bib35">Gonçalves et al., 2020</xref>; <xref ref-type="bibr" rid="bib2">Alonso and Marder, 2019</xref>) — questions that have hindered progress in the field for years.</p></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Yves Bernaerts for preliminary work on electrical stimulation of biophysical models, Timm Schubert for support with animal protocols and Gordon Eske and Adam vor Daranyi for technical support. Additionally, we thank Jakob Macke, Philipp Hennig and Lara Hoefling for discussion. This work was funded by the Federal Ministry of Education and Research (BMBF, FKZ 01GQ1601 and 01IS18052 to PB), the German Science Foundation through the Excellence Cluster 2064 ‘Machine Learning - New Perspectives for Science’ (390727645), a Heisenberg Professorship (BE5601/4-1 to PB), the Baden-Württemberg Stiftung (NEU013 to PB and GZ), and the National Institutes of Health (NIH) (EY022070 and EY023766 to RGS).</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Software, Formal analysis, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Supervision, Investigation, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con4"><p>Data curation, Investigation</p></fn><fn fn-type="con" id="con5"><p>Supervision, Writing - review and editing</p></fn><fn fn-type="con" id="con6"><p>Data curation, Investigation</p></fn><fn fn-type="con" id="con7"><p>Conceptualization, Resources, Funding acquisition, Investigation, Writing - review and editing</p></fn><fn fn-type="con" id="con8"><p>Conceptualization, Supervision, Funding acquisition, Writing - review and editing</p></fn><fn fn-type="con" id="con9"><p>Conceptualization, Supervision, Funding acquisition, Writing - original draft, Writing - review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other" id="fn1"><p>Animal experimentation: All procedures were approved by the governmental review board (Regierungspräsidium Tübingen, Baden-Württemberg, Konrad-Adenauer-Str. 20, 72072 Tübingen, Germany, AZ 35/9185.82-7) and performed according to the laws governing animal experimentation issued by the German Government.</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-54997-transrepform-v2.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Models and simulation code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/berenslab/CBC_inference">https://github.com/berenslab/CBC_inference</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:rev:2b8ec4ac0ca916d42cba0404229298f8ff79c3a3/">https://archive.softwareheritage.org/swh:1:rev:2b8ec4ac0ca916d42cba0404229298f8ff79c3a3/</ext-link>). Experimental and inference data is available at <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4185955">https://zenodo.org/record/4185955</ext-link>.</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Oesterle</surname><given-names>J</given-names></name><name><surname>Behrens</surname><given-names>C</given-names></name><name><surname>Schröder</surname><given-names>C</given-names></name><name><surname>Herrmann</surname><given-names>T</given-names></name><name><surname>Euler</surname><given-names>T</given-names></name><name><surname>Franke</surname><given-names>K</given-names></name><name><surname>Smith</surname><given-names>RG</given-names></name><name><surname>Zeck</surname><given-names>G</given-names></name><name><surname>Berens</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Data for &quot;Bayesian inference for biophysical neuron models enables stimulus optimization for retinal neuroprosthetics&quot;</data-title><source>Zenodo</source><pub-id assigning-authority="Zenodo" pub-id-type="doi">10.5281/zenodo.4185955</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Achard</surname> <given-names>P</given-names></name><name><surname>De Schutter</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Complex parameter landscape for a complex neuron model</article-title><source>PLOS Computational Biology</source><volume>2</volume><elocation-id>e94</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.0020094</pub-id><pub-id pub-id-type="pmid">16848639</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alonso</surname> <given-names>LM</given-names></name><name><surname>Marder</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Visualization of currents in neural models with similar behavior and different conductance densities</article-title><source>eLife</source><volume>8</volume><elocation-id>e42722</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.42722</pub-id><pub-id pub-id-type="pmid">30702427</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altomare</surname> <given-names>C</given-names></name><name><surname>Bucchi</surname> <given-names>A</given-names></name><name><surname>Camatini</surname> <given-names>E</given-names></name><name><surname>Baruscotti</surname> <given-names>M</given-names></name><name><surname>Viscomi</surname> <given-names>C</given-names></name><name><surname>Moroni</surname> <given-names>A</given-names></name><name><surname>DiFrancesco</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Integrated allosteric model of voltage gating of HCN channels</article-title><source>Journal of General Physiology</source><volume>117</volume><fpage>519</fpage><lpage>532</lpage><pub-id pub-id-type="doi">10.1085/jgp.117.6.519</pub-id><pub-id pub-id-type="pmid">11382803</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baden</surname> <given-names>T</given-names></name><name><surname>Euler</surname> <given-names>T</given-names></name><name><surname>Weckström</surname> <given-names>M</given-names></name><name><surname>Lagnado</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Spikes and ribbon synapses in early vision</article-title><source>Trends in Neurosciences</source><volume>36</volume><fpage>480</fpage><lpage>488</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2013.04.006</pub-id><pub-id pub-id-type="pmid">23706152</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baden</surname> <given-names>T</given-names></name><name><surname>Nikolaev</surname> <given-names>A</given-names></name><name><surname>Esposti</surname> <given-names>F</given-names></name><name><surname>Dreosti</surname> <given-names>E</given-names></name><name><surname>Odermatt</surname> <given-names>B</given-names></name><name><surname>Lagnado</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A synaptic mechanism for temporal filtering of visual signals</article-title><source>PLOS Biology</source><volume>12</volume><elocation-id>e1001972</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1001972</pub-id><pub-id pub-id-type="pmid">25333637</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barriga-Rivera</surname> <given-names>A</given-names></name><name><surname>Bareket</surname> <given-names>L</given-names></name><name><surname>Goding</surname> <given-names>J</given-names></name><name><surname>Aregueta-Robles</surname> <given-names>UA</given-names></name><name><surname>Suaning</surname> <given-names>GJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Visual prosthesis: interfacing stimulating electrodes with retinal neurons to restore vision</article-title><source>Frontiers in Neuroscience</source><volume>11</volume><elocation-id>620</elocation-id><pub-id pub-id-type="doi">10.3389/fnins.2017.00620</pub-id><pub-id pub-id-type="pmid">29184478</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bartoletti</surname> <given-names>TM</given-names></name><name><surname>Babai</surname> <given-names>N</given-names></name><name><surname>Thoreson</surname> <given-names>WB</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Vesicle pool size at the salamander cone ribbon synapse</article-title><source>Journal of Neurophysiology</source><volume>103</volume><fpage>419</fpage><lpage>423</lpage><pub-id pub-id-type="doi">10.1152/jn.00718.2009</pub-id><pub-id pub-id-type="pmid">19923246</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Behrens</surname> <given-names>C</given-names></name><name><surname>Schubert</surname> <given-names>T</given-names></name><name><surname>Haverkamp</surname> <given-names>S</given-names></name><name><surname>Euler</surname> <given-names>T</given-names></name><name><surname>Berens</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Connectivity map of bipolar cells and photoreceptors in the mouse retina</article-title><source>eLife</source><volume>5</volume><elocation-id>e20041</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.20041</pub-id><pub-id pub-id-type="pmid">27885985</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berntson</surname> <given-names>A</given-names></name><name><surname>Taylor</surname> <given-names>WR</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>The unitary event amplitude of mouse retinal on-cone bipolar cells</article-title><source>Visual Neuroscience</source><volume>20</volume><fpage>621</fpage><lpage>626</lpage><pub-id pub-id-type="doi">10.1017/S0952523803206040</pub-id><pub-id pub-id-type="pmid">15088715</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Bittner</surname> <given-names>SR</given-names></name><name><surname>Palmigiano</surname> <given-names>A</given-names></name><name><surname>Piet</surname> <given-names>AT</given-names></name><name><surname>Duan</surname> <given-names>CA</given-names></name><name><surname>Brody</surname> <given-names>CD</given-names></name><name><surname>Miller</surname> <given-names>KD</given-names></name><name><surname>Cunningham</surname> <given-names>JP</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Interrogating theoretical models of neural computation with deep inference</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/837567</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cangiano</surname> <given-names>L</given-names></name><name><surname>Asteriti</surname> <given-names>S</given-names></name><name><surname>Cervetto</surname> <given-names>L</given-names></name><name><surname>Gargini</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The photovoltage of rods and cones in the dark-adapted mouse retina</article-title><source>The Journal of Physiology</source><volume>590</volume><fpage>3841</fpage><lpage>3855</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.2011.226878</pub-id><pub-id pub-id-type="pmid">22641773</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caputo</surname> <given-names>A</given-names></name><name><surname>Piano</surname> <given-names>I</given-names></name><name><surname>Demontis</surname> <given-names>GC</given-names></name><name><surname>Bacchi</surname> <given-names>N</given-names></name><name><surname>Casarosa</surname> <given-names>S</given-names></name><name><surname>Della Santina</surname> <given-names>L</given-names></name><name><surname>Gargini</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>TMEM16A is associated with voltage-gated calcium channels in mouse retina and its function is disrupted upon mutation of the auxiliary α2δ4 subunit</article-title><source>Frontiers in Cellular Neuroscience</source><volume>9</volume><elocation-id>422</elocation-id><pub-id pub-id-type="doi">10.3389/fncel.2015.00422</pub-id><pub-id pub-id-type="pmid">26557056</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carter-Dawson</surname> <given-names>LD</given-names></name><name><surname>LaVail</surname> <given-names>MM</given-names></name></person-group><year iso-8601-date="1979">1979</year><article-title>Rods and cones in the mouse retina. I. structural analysis using light and electron microscopy</article-title><source>The Journal of Comparative Neurology</source><volume>188</volume><fpage>245</fpage><lpage>262</lpage><pub-id pub-id-type="doi">10.1002/cne.901880204</pub-id><pub-id pub-id-type="pmid">500858</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Choi</surname> <given-names>SY</given-names></name><name><surname>Borghuis</surname> <given-names>BG</given-names></name><name><surname>Borghuis</surname> <given-names>B</given-names></name><name><surname>Rea</surname> <given-names>R</given-names></name><name><surname>Levitan</surname> <given-names>ES</given-names></name><name><surname>Sterling</surname> <given-names>P</given-names></name><name><surname>Kramer</surname> <given-names>RH</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Encoding light intensity by the cone photoreceptor synapse</article-title><source>Neuron</source><volume>48</volume><fpage>555</fpage><lpage>562</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2005.09.011</pub-id><pub-id pub-id-type="pmid">16301173</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chuang</surname> <given-names>AT</given-names></name><name><surname>Margo</surname> <given-names>CE</given-names></name><name><surname>Greenberg</surname> <given-names>PB</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Retinal implants: a systematic review</article-title><source>British Journal of Ophthalmology</source><volume>98</volume><fpage>852</fpage><lpage>856</lpage><pub-id pub-id-type="doi">10.1136/bjophthalmol-2013-303708</pub-id><pub-id pub-id-type="pmid">24403565</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clancy</surname> <given-names>CE</given-names></name><name><surname>Kass</surname> <given-names>RS</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Theoretical investigation of the neuronal na+ channel SCN1A: abnormal gating and epilepsy</article-title><source>Biophysical Journal</source><volume>86</volume><fpage>2606</fpage><lpage>2614</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(04)74315-5</pub-id><pub-id pub-id-type="pmid">15041696</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Comsol</surname> <given-names>AB</given-names></name></person-group><year iso-8601-date="2019">2019</year><source>Comsol Multiphysics</source><version designator="5.4">5.4</version><publisher-loc>Stockholm, Sweden</publisher-loc><ext-link ext-link-type="uri" xlink:href="http://www.comsol.com">http://www.comsol.com</ext-link></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Corna</surname> <given-names>A</given-names></name><name><surname>Herrmann</surname> <given-names>T</given-names></name><name><surname>Zeck</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Electrode-size dependent thresholds in subretinal neuroprosthetic stimulation</article-title><source>Journal of Neural Engineering</source><volume>15</volume><elocation-id>045003</elocation-id><pub-id pub-id-type="doi">10.1088/1741-2552/aac1c8</pub-id><pub-id pub-id-type="pmid">29717707</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cui</surname> <given-names>J</given-names></name><name><surname>Ivanova</surname> <given-names>E</given-names></name><name><surname>Qi</surname> <given-names>L</given-names></name><name><surname>Pan</surname> <given-names>ZH</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Expression of CaV3.2 T-type Ca²⁺ channels in a subpopulation of retinal type-3 cone bipolar cells</article-title><source>Neuroscience</source><volume>224</volume><fpage>63</fpage><lpage>69</lpage><pub-id pub-id-type="doi">10.1016/j.neuroscience.2012.08.017</pub-id><pub-id pub-id-type="pmid">22909426</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cui</surname> <given-names>J</given-names></name><name><surname>Pan</surname> <given-names>ZH</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Two types of cone bipolar cells express voltage-gated Na<sup>+</sup> channels in the rat retina</article-title><source>Visual Neuroscience</source><volume>25</volume><fpage>635</fpage><lpage>645</lpage><pub-id pub-id-type="doi">10.1017/S0952523808080851</pub-id><pub-id pub-id-type="pmid">19094370</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dong</surname> <given-names>CJ</given-names></name><name><surname>Werblin</surname> <given-names>FS</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Inwardly rectifying potassium conductance can accelerate the hyperpolarizing response in retinal horizontal cells</article-title><source>Journal of Neurophysiology</source><volume>74</volume><fpage>2258</fpage><lpage>2265</lpage><pub-id pub-id-type="doi">10.1152/jn.1995.74.6.2258</pub-id><pub-id pub-id-type="pmid">8747189</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Durkan</surname> <given-names>C</given-names></name><name><surname>Papamakarios</surname> <given-names>G</given-names></name><name><surname>Murray</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Sequential neural methods for likelihood-free inference</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1811.08723">https://arxiv.org/abs/1811.08723</ext-link></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edwards</surname> <given-names>TL</given-names></name><name><surname>Cottriall</surname> <given-names>CL</given-names></name><name><surname>Xue</surname> <given-names>K</given-names></name><name><surname>Simunovic</surname> <given-names>MP</given-names></name><name><surname>Ramsden</surname> <given-names>JD</given-names></name><name><surname>Zrenner</surname> <given-names>E</given-names></name><name><surname>MacLaren</surname> <given-names>RE</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Assessment of the electronic retinal implant alpha AMS in restoring vision to blind patients with End-Stage retinitis pigmentosa</article-title><source>Ophthalmology</source><volume>125</volume><fpage>432</fpage><lpage>443</lpage><pub-id pub-id-type="doi">10.1016/j.ophtha.2017.09.019</pub-id><pub-id pub-id-type="pmid">29110946</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eickenscheidt</surname> <given-names>M</given-names></name><name><surname>Jenkner</surname> <given-names>M</given-names></name><name><surname>Thewes</surname> <given-names>R</given-names></name><name><surname>Fromherz</surname> <given-names>P</given-names></name><name><surname>Zeck</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Electrical stimulation of retinal neurons in epiretinal and subretinal configuration using a multicapacitor array</article-title><source>Journal of Neurophysiology</source><volume>107</volume><fpage>2742</fpage><lpage>2755</lpage><pub-id pub-id-type="doi">10.1152/jn.00909.2011</pub-id><pub-id pub-id-type="pmid">22357789</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eickenscheidt</surname> <given-names>M</given-names></name><name><surname>Zeck</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Action potentials in retinal ganglion cells are initiated at the site of maximal curvature of the extracellular potential</article-title><source>Journal of Neural Engineering</source><volume>11</volume><elocation-id>036006</elocation-id><pub-id pub-id-type="doi">10.1088/1741-2560/11/3/036006</pub-id><pub-id pub-id-type="pmid">24762943</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Euler</surname> <given-names>T</given-names></name><name><surname>Franke</surname> <given-names>K</given-names></name><name><surname>Baden</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2019">2019</year><chapter-title>Studying a light sensor with light: multiphoton imaging in the retina</chapter-title><person-group person-group-type="editor"><name><surname>Hartveit</surname> <given-names>E</given-names></name></person-group><source>Multiphoton Microscopy</source><publisher-name>Springer</publisher-name><fpage>225</fpage><lpage>250</lpage><pub-id pub-id-type="doi">10.1007/978-1-4939-9702-2_10</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fohlmeister</surname> <given-names>JF</given-names></name><name><surname>Miller</surname> <given-names>RF</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Impulse encoding mechanisms of ganglion cells in the tiger salamander retina</article-title><source>Journal of Neurophysiology</source><volume>78</volume><fpage>1935</fpage><lpage>1947</lpage><pub-id pub-id-type="doi">10.1152/jn.1997.78.4.1935</pub-id><pub-id pub-id-type="pmid">9325362</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franke</surname> <given-names>K</given-names></name><name><surname>Berens</surname> <given-names>P</given-names></name><name><surname>Schubert</surname> <given-names>T</given-names></name><name><surname>Bethge</surname> <given-names>M</given-names></name><name><surname>Euler</surname> <given-names>T</given-names></name><name><surname>Baden</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Inhibition decorrelates visual feature representations in the inner retina</article-title><source>Nature</source><volume>542</volume><fpage>439</fpage><lpage>444</lpage><pub-id pub-id-type="doi">10.1038/nature21394</pub-id><pub-id pub-id-type="pmid">28178238</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gabriel</surname> <given-names>S</given-names></name><name><surname>Lau</surname> <given-names>RW</given-names></name><name><surname>Gabriel</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>The dielectric properties of biological tissues: iii. Parametric models for the dielectric spectrum of tissues</article-title><source>Physics in Medicine and Biology</source><volume>41</volume><fpage>2271</fpage><lpage>2293</lpage><pub-id pub-id-type="doi">10.1088/0031-9155/41/11/003</pub-id><pub-id pub-id-type="pmid">8938026</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Gerhardt</surname> <given-names>M</given-names></name><name><surname>Alderman</surname> <given-names>J</given-names></name><name><surname>Stett</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Electric field stimulation of bipolar cells in a degenerated retina--a theoretical study</article-title><conf-name>IEEE Transactions on Neural Systems and Rehabilitation Engineering</conf-name><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.1109/TNSRE.2009.2037323</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerken</surname> <given-names>WC</given-names></name><name><surname>Purvis</surname> <given-names>LK</given-names></name><name><surname>Butera</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Genetic algorithm for optimization and specification of a neuron model</article-title><source>Neurocomputing</source><volume>69</volume><fpage>1039</fpage><lpage>1042</lpage><pub-id pub-id-type="doi">10.1016/j.neucom.2005.12.041</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gerstner</surname> <given-names>W</given-names></name><name><surname>Kistler</surname> <given-names>WM</given-names></name></person-group><year iso-8601-date="2002">2002</year><source>Spiking Neuron Models: Single Neurons, Populations, Plasticity</source><publisher-name>Cambridge university press</publisher-name><pub-id pub-id-type="doi">10.1017/CBO9780511815706</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Golding</surname> <given-names>NL</given-names></name><name><surname>Kath</surname> <given-names>WL</given-names></name><name><surname>Spruston</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Dichotomy of action-potential backpropagation in CA1 pyramidal neuron dendrites</article-title><source>Journal of Neurophysiology</source><volume>86</volume><fpage>2998</fpage><lpage>3010</lpage><pub-id pub-id-type="doi">10.1152/jn.2001.86.6.2998</pub-id><pub-id pub-id-type="pmid">11731556</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldman</surname> <given-names>MS</given-names></name><name><surname>Golowasch</surname> <given-names>J</given-names></name><name><surname>Marder</surname> <given-names>E</given-names></name><name><surname>Abbott</surname> <given-names>LF</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Global structure, robustness, and modulation of neuronal models</article-title><source>The Journal of Neuroscience</source><volume>21</volume><fpage>5229</fpage><lpage>5238</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.21-14-05229.2001</pub-id><pub-id pub-id-type="pmid">11438598</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gonçalves</surname> <given-names>PJ</given-names></name><name><surname>Lueckmann</surname> <given-names>JM</given-names></name><name><surname>Deistler</surname> <given-names>M</given-names></name><name><surname>Nonnenmacher</surname> <given-names>M</given-names></name><name><surname>Öcal</surname> <given-names>K</given-names></name><name><surname>Bassetto</surname> <given-names>G</given-names></name><name><surname>Chintaluri</surname> <given-names>C</given-names></name><name><surname>Podlaski</surname> <given-names>WF</given-names></name><name><surname>Haddad</surname> <given-names>SA</given-names></name><name><surname>Vogels</surname> <given-names>TP</given-names></name><name><surname>Greenberg</surname> <given-names>DS</given-names></name><name><surname>Macke</surname> <given-names>JH</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Training deep neural density estimators to identify mechanistic models of neural dynamics</article-title><source>eLife</source><volume>9</volume><elocation-id>e56261</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.56261</pub-id><pub-id pub-id-type="pmid">32940606</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greene</surname> <given-names>MJ</given-names></name><name><surname>Kim</surname> <given-names>JS</given-names></name><name><surname>Seung</surname> <given-names>HS</given-names></name><collab>EyeWirers</collab></person-group><year iso-8601-date="2016">2016</year><article-title>Analogous convergence of sustained and transient inputs in parallel on and off pathways for retinal motion computation</article-title><source>Cell Reports</source><volume>14</volume><fpage>1892</fpage><lpage>1900</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2016.02.001</pub-id><pub-id pub-id-type="pmid">26904938</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gutmann</surname> <given-names>MU</given-names></name><name><surname>Corander</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Bayesian optimization for likelihood-free inference of simulator-based statistical models</article-title><source>The Journal of Machine Learning Research</source><volume>17</volume><fpage>4256</fpage><lpage>4302</lpage></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hay</surname> <given-names>E</given-names></name><name><surname>Hill</surname> <given-names>S</given-names></name><name><surname>Schürmann</surname> <given-names>F</given-names></name><name><surname>Markram</surname> <given-names>H</given-names></name><name><surname>Segev</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Models of neocortical layer 5b pyramidal cells capturing a wide range of dendritic and perisomatic active properties</article-title><source>PLOS Computational Biology</source><volume>7</volume><elocation-id>e1002107</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002107</pub-id><pub-id pub-id-type="pmid">21829333</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hellmer</surname> <given-names>CB</given-names></name><name><surname>Zhou</surname> <given-names>Y</given-names></name><name><surname>Fyk-Kolodziej</surname> <given-names>B</given-names></name><name><surname>Hu</surname> <given-names>Z</given-names></name><name><surname>Ichinose</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Morphological and physiological analysis of type-5 and other bipolar cells in the mouse retina</article-title><source>Neuroscience</source><volume>315</volume><fpage>246</fpage><lpage>258</lpage><pub-id pub-id-type="doi">10.1016/j.neuroscience.2015.12.016</pub-id><pub-id pub-id-type="pmid">26704635</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Helmstaedter</surname> <given-names>M</given-names></name><name><surname>Briggman</surname> <given-names>KL</given-names></name><name><surname>Turaga</surname> <given-names>SC</given-names></name><name><surname>Jain</surname> <given-names>V</given-names></name><name><surname>Seung</surname> <given-names>HS</given-names></name><name><surname>Denk</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Connectomic reconstruction of the inner plexiform layer in the mouse retina</article-title><source>Nature</source><volume>500</volume><fpage>168</fpage><lpage>174</lpage><pub-id pub-id-type="doi">10.1038/nature12346</pub-id><pub-id pub-id-type="pmid">23925239</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hirschberg</surname> <given-names>B</given-names></name><name><surname>Maylie</surname> <given-names>J</given-names></name><name><surname>Adelman</surname> <given-names>JP</given-names></name><name><surname>Marrion</surname> <given-names>NV</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Gating of recombinant small-conductance Ca-activated K+ channels by calcium</article-title><source>Journal of General Physiology</source><volume>111</volume><fpage>565</fpage><lpage>581</lpage><pub-id pub-id-type="doi">10.1085/jgp.111.4.565</pub-id><pub-id pub-id-type="pmid">9524139</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hodgkin</surname> <given-names>AL</given-names></name><name><surname>Huxley</surname> <given-names>AF</given-names></name></person-group><year iso-8601-date="1952">1952</year><article-title>A quantitative description of membrane current and its application to conduction and excitation in nerve</article-title><source>The Journal of Physiology</source><volume>117</volume><fpage>500</fpage><lpage>544</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1952.sp004764</pub-id><pub-id pub-id-type="pmid">12991237</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname> <given-names>C</given-names></name><name><surname>Bi</surname> <given-names>A</given-names></name><name><surname>Pan</surname> <given-names>ZH</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Differential expression of three T-type calcium channels in retinal bipolar cells in rats</article-title><source>Visual Neuroscience</source><volume>26</volume><fpage>177</fpage><lpage>187</lpage><pub-id pub-id-type="doi">10.1017/S0952523809090026</pub-id><pub-id pub-id-type="pmid">19275782</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ichinose</surname> <given-names>T</given-names></name><name><surname>Fyk-Kolodziej</surname> <given-names>B</given-names></name><name><surname>Cohn</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Roles of ON cone bipolar cell subtypes in temporal coding in the mouse retina</article-title><source>Journal of Neuroscience</source><volume>34</volume><fpage>8761</fpage><lpage>8771</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3965-13.2014</pub-id><pub-id pub-id-type="pmid">24966376</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ichinose</surname> <given-names>T</given-names></name><name><surname>Hellmer</surname> <given-names>CB</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Differential signalling and glutamate receptor compositions in the OFF bipolar cell types in the mouse retina</article-title><source>The Journal of Physiology</source><volume>594</volume><fpage>883</fpage><lpage>894</lpage><pub-id pub-id-type="doi">10.1113/JP271458</pub-id><pub-id pub-id-type="pmid">26553530</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ingram</surname> <given-names>NT</given-names></name><name><surname>Sampath</surname> <given-names>AP</given-names></name><name><surname>Fain</surname> <given-names>GL</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Membrane conductances of mouse cone photoreceptors</article-title><source>Journal of General Physiology</source><volume>152</volume><elocation-id>e201912520</elocation-id><pub-id pub-id-type="doi">10.1085/jgp.201912520</pub-id><pub-id pub-id-type="pmid">31986199</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ivanova</surname> <given-names>E</given-names></name><name><surname>Müller</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Retinal bipolar cell types differ in their inventory of ion channels</article-title><source>Visual Neuroscience</source><volume>23</volume><fpage>143</fpage><lpage>154</lpage><pub-id pub-id-type="doi">10.1017/S0952523806232048</pub-id><pub-id pub-id-type="pmid">16638168</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jensen</surname> <given-names>RJ</given-names></name><name><surname>Ziv</surname> <given-names>OR</given-names></name><name><surname>Rizzo</surname> <given-names>JF</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Thresholds for activation of rabbit retinal ganglion cells with relatively large, extracellular microelectrodes</article-title><source>Investigative Opthalmology &amp; Visual Science</source><volume>46</volume><fpage>1486</fpage><lpage>1496</lpage><pub-id pub-id-type="doi">10.1167/iovs.04-1018</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jensen</surname> <given-names>RJ</given-names></name><name><surname>Rizzo</surname> <given-names>JF</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Activation of retinal ganglion cells in wild-type and rd1 mice through electrical stimulation of the retinal neural network</article-title><source>Vision Research</source><volume>48</volume><fpage>1562</fpage><lpage>1568</lpage><pub-id pub-id-type="doi">10.1016/j.visres.2008.04.016</pub-id><pub-id pub-id-type="pmid">18555890</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jonas</surname> <given-names>P</given-names></name><name><surname>Major</surname> <given-names>G</given-names></name><name><surname>Sakmann</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Quantal components of unitary EPSCs at the mossy fibre synapse on CA3 pyramidal cells of rat Hippocampus</article-title><source>The Journal of Physiology</source><volume>472</volume><fpage>615</fpage><lpage>663</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1993.sp019965</pub-id><pub-id pub-id-type="pmid">7908327</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karschin</surname> <given-names>A</given-names></name><name><surname>Lipton</surname> <given-names>SA</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Calcium channels in solitary retinal ganglion cells from post-natal rat</article-title><source>The Journal of Physiology</source><volume>418</volume><fpage>379</fpage><lpage>396</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1989.sp017847</pub-id><pub-id pub-id-type="pmid">2559971</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karwoski</surname> <given-names>CJ</given-names></name><name><surname>Xu</surname> <given-names>X</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Current source-density analysis of light-evoked field potentials in rabbit retina</article-title><source>Visual Neuroscience</source><volume>16</volume><fpage>369</fpage><lpage>377</lpage><pub-id pub-id-type="doi">10.1017/S0952523899162163</pub-id><pub-id pub-id-type="pmid">10367970</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kavalali</surname> <given-names>ET</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The mechanisms and functions of spontaneous neurotransmitter release</article-title><source>Nature Reviews Neuroscience</source><volume>16</volume><fpage>5</fpage><lpage>16</lpage><pub-id pub-id-type="doi">10.1038/nrn3875</pub-id><pub-id pub-id-type="pmid">25524119</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keren</surname> <given-names>N</given-names></name><name><surname>Peled</surname> <given-names>N</given-names></name><name><surname>Korngreen</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Constraining compartmental models using multiple voltage recordings and genetic algorithms</article-title><source>Journal of Neurophysiology</source><volume>94</volume><fpage>3730</fpage><lpage>3742</lpage><pub-id pub-id-type="doi">10.1152/jn.00408.2005</pub-id><pub-id pub-id-type="pmid">16093338</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Knop</surname> <given-names>GC</given-names></name><name><surname>Seeliger</surname> <given-names>MW</given-names></name><name><surname>Thiel</surname> <given-names>F</given-names></name><name><surname>Mataruga</surname> <given-names>A</given-names></name><name><surname>Kaupp</surname> <given-names>UB</given-names></name><name><surname>Friedburg</surname> <given-names>C</given-names></name><name><surname>Tanimoto</surname> <given-names>N</given-names></name><name><surname>Müller</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Light responses in the mouse retina are prolonged upon targeted deletion of the HCN1 channel gene</article-title><source>European Journal of Neuroscience</source><volume>28</volume><fpage>2221</fpage><lpage>2230</lpage><pub-id pub-id-type="doi">10.1111/j.1460-9568.2008.06512.x</pub-id><pub-id pub-id-type="pmid">19019198</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Koch</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2004">2004</year><source>Biophysics of Computation: Information Processing in Single Neurons</source><publisher-name>Oxford University Press</publisher-name></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lagnado</surname> <given-names>L</given-names></name><name><surname>Schmitz</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Ribbon synapses and visual processing in the retina</article-title><source>Annual Review of Vision Science</source><volume>1</volume><fpage>235</fpage><lpage>262</lpage><pub-id pub-id-type="doi">10.1146/annurev-vision-082114-035709</pub-id><pub-id pub-id-type="pmid">28532378</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>SC</given-names></name><name><surname>Hayashida</surname> <given-names>Y</given-names></name><name><surname>Ishida</surname> <given-names>AT</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Availability of low-threshold Ca2+ current in retinal ganglion cells</article-title><source>Journal of Neurophysiology</source><volume>90</volume><fpage>3888</fpage><lpage>3901</lpage><pub-id pub-id-type="doi">10.1152/jn.00477.2003</pub-id><pub-id pub-id-type="pmid">14665686</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>JI</given-names></name><name><surname>Im</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Optimal electric stimulus amplitude improves the selectivity between responses of ON versus OFF types of retinal ganglion cells</article-title><source>IEEE Transactions on Neural Systems and Rehabilitation Engineering</source><volume>27</volume><fpage>2015</fpage><lpage>2024</lpage><pub-id pub-id-type="doi">10.1109/TNSRE.2019.2939012</pub-id><pub-id pub-id-type="pmid">31484127</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lintusaari</surname> <given-names>J</given-names></name><name><surname>Gutmann</surname> <given-names>MU</given-names></name><name><surname>Dutta</surname> <given-names>R</given-names></name><name><surname>Kaski</surname> <given-names>S</given-names></name><name><surname>Corander</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Fundamentals and recent developments in approximate bayesian computation</article-title><source>Systematic Biology</source><volume>66</volume><fpage>e66</fpage><lpage>e82</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syw077</pub-id><pub-id pub-id-type="pmid">28175922</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Lueckmann</surname> <given-names>J-M</given-names></name><name><surname>Goncalves</surname> <given-names>PJ</given-names></name><name><surname>Bassetto</surname> <given-names>G</given-names></name><name><surname>Öcal</surname> <given-names>K</given-names></name><name><surname>Nonnenmacher</surname> <given-names>M</given-names></name><name><surname>Macke</surname> <given-names>JH</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Flexible statistical inference for mechanistic models of neural dynamics</article-title><conf-name>Advances in Neural Information Processing Systems</conf-name><fpage>1289</fpage><lpage>1299</lpage></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname> <given-names>YH</given-names></name><name><surname>da Cruz</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The argus II retinal prosthesis system</article-title><source>Progress in Retinal and Eye Research</source><volume>50</volume><fpage>89</fpage><lpage>107</lpage><pub-id pub-id-type="doi">10.1016/j.preteyeres.2015.09.003</pub-id><pub-id pub-id-type="pmid">26404104</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ma</surname> <given-names>YP</given-names></name><name><surname>Cui</surname> <given-names>J</given-names></name><name><surname>Pan</surname> <given-names>ZH</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Heterogeneous expression of voltage-dependent Na<sup>+</sup> and K<sup>+</sup> channels in mammalian retinal bipolar cells</article-title><source>Visual Neuroscience</source><volume>22</volume><fpage>119</fpage><lpage>133</lpage><pub-id pub-id-type="doi">10.1017/S0952523805222010</pub-id><pub-id pub-id-type="pmid">15935105</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="software"><person-group person-group-type="author"><collab>Macke Lab</collab></person-group><year iso-8601-date="2020">2020</year><data-title>DELFI</data-title><source>GitHub</source><version designator="0.5.1">0.5.1</version><ext-link ext-link-type="uri" xlink:href="https://github.com/mackelab/delfi">https://github.com/mackelab/delfi</ext-link></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mansergh</surname> <given-names>F</given-names></name><name><surname>Orton</surname> <given-names>NC</given-names></name><name><surname>Vessey</surname> <given-names>JP</given-names></name><name><surname>Lalonde</surname> <given-names>MR</given-names></name><name><surname>Stell</surname> <given-names>WK</given-names></name><name><surname>Tremblay</surname> <given-names>F</given-names></name><name><surname>Barnes</surname> <given-names>S</given-names></name><name><surname>Rancourt</surname> <given-names>DE</given-names></name><name><surname>Bech-Hansen</surname> <given-names>NT</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Mutation of the calcium channel gene Cacna1f disrupts calcium signaling, synaptic transmission and cellular organization in mouse retina</article-title><source>Human Molecular Genetics</source><volume>14</volume><fpage>3035</fpage><lpage>3046</lpage><pub-id pub-id-type="doi">10.1093/hmg/ddi336</pub-id><pub-id pub-id-type="pmid">16155113</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marvin</surname> <given-names>JS</given-names></name><name><surname>Borghuis</surname> <given-names>BG</given-names></name><name><surname>Tian</surname> <given-names>L</given-names></name><name><surname>Cichon</surname> <given-names>J</given-names></name><name><surname>Harnett</surname> <given-names>MT</given-names></name><name><surname>Akerboom</surname> <given-names>J</given-names></name><name><surname>Gordus</surname> <given-names>A</given-names></name><name><surname>Renninger</surname> <given-names>SL</given-names></name><name><surname>Chen</surname> <given-names>TW</given-names></name><name><surname>Bargmann</surname> <given-names>CI</given-names></name><name><surname>Orger</surname> <given-names>MB</given-names></name><name><surname>Schreiter</surname> <given-names>ER</given-names></name><name><surname>Demb</surname> <given-names>JB</given-names></name><name><surname>Gan</surname> <given-names>WB</given-names></name><name><surname>Hires</surname> <given-names>SA</given-names></name><name><surname>Looger</surname> <given-names>LL</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>An optimized fluorescent probe for visualizing glutamate neurotransmission</article-title><source>Nature Methods</source><volume>10</volume><fpage>162</fpage><lpage>170</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2333</pub-id><pub-id pub-id-type="pmid">23314171</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Masland</surname> <given-names>RH</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The tasks of amacrine cells</article-title><source>Visual Neuroscience</source><volume>29</volume><fpage>3</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1017/S0952523811000344</pub-id><pub-id pub-id-type="pmid">22416289</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matsumoto</surname> <given-names>A</given-names></name><name><surname>Briggman</surname> <given-names>KL</given-names></name><name><surname>Yonehara</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Spatiotemporally asymmetric excitation supports mammalian retinal motion sensitivity</article-title><source>Current Biology</source><volume>29</volume><fpage>3277</fpage><lpage>3288</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2019.08.048</pub-id><pub-id pub-id-type="pmid">31564498</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matthews</surname> <given-names>G</given-names></name><name><surname>Fuchs</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>The diverse roles of ribbon synapses in sensory neurotransmission</article-title><source>Nature Reviews Neuroscience</source><volume>11</volume><fpage>812</fpage><lpage>822</lpage><pub-id pub-id-type="doi">10.1038/nrn2924</pub-id><pub-id pub-id-type="pmid">21045860</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morgans</surname> <given-names>CW</given-names></name><name><surname>El Far</surname> <given-names>O</given-names></name><name><surname>Berntson</surname> <given-names>A</given-names></name><name><surname>Wässle</surname> <given-names>H</given-names></name><name><surname>Taylor</surname> <given-names>WR</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Calcium extrusion from mammalian photoreceptor terminals</article-title><source>The Journal of Neuroscience</source><volume>18</volume><fpage>2467</fpage><lpage>2474</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.18-07-02467.1998</pub-id><pub-id pub-id-type="pmid">9502807</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morgans</surname> <given-names>CW</given-names></name><name><surname>Bayley</surname> <given-names>PR</given-names></name><name><surname>Oesch</surname> <given-names>NW</given-names></name><name><surname>Ren</surname> <given-names>G</given-names></name><name><surname>Akileswaran</surname> <given-names>L</given-names></name><name><surname>Taylor</surname> <given-names>WR</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Photoreceptor calcium channels: insight from night blindness</article-title><source>Visual Neuroscience</source><volume>22</volume><fpage>561</fpage><lpage>568</lpage><pub-id pub-id-type="doi">10.1017/S0952523805225038</pub-id><pub-id pub-id-type="pmid">16332266</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Müller</surname> <given-names>F</given-names></name><name><surname>Scholten</surname> <given-names>A</given-names></name><name><surname>Ivanova</surname> <given-names>E</given-names></name><name><surname>Haverkamp</surname> <given-names>S</given-names></name><name><surname>Kremmer</surname> <given-names>E</given-names></name><name><surname>Kaupp</surname> <given-names>UB</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>HCN channels are expressed differentially in retinal bipolar cells and concentrated at synaptic terminals</article-title><source>European Journal of Neuroscience</source><volume>17</volume><fpage>2084</fpage><lpage>2096</lpage><pub-id pub-id-type="doi">10.1046/j.1460-9568.2003.02634.x</pub-id><pub-id pub-id-type="pmid">12786975</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Myatt</surname> <given-names>DR</given-names></name><name><surname>Hadlington</surname> <given-names>T</given-names></name><name><surname>Ascoli</surname> <given-names>GA</given-names></name><name><surname>Nasuto</surname> <given-names>SJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Neuromantic - from semi-manual to semi-automatic reconstruction of neuron morphology</article-title><source>Frontiers in Neuroinformatics</source><volume>6</volume><elocation-id>4</elocation-id><pub-id pub-id-type="doi">10.3389/fninf.2012.00004</pub-id><pub-id pub-id-type="pmid">22438842</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nikonov</surname> <given-names>S</given-names></name><name><surname>Engheta</surname> <given-names>N</given-names></name><name><surname>Pugh</surname> <given-names>EN</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Kinetics of recovery of the dark-adapted salamander rod photoresponse</article-title><source>Journal of General Physiology</source><volume>111</volume><fpage>7</fpage><lpage>37</lpage><pub-id pub-id-type="doi">10.1085/jgp.111.1.7</pub-id><pub-id pub-id-type="pmid">9417132</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nikonov</surname> <given-names>SS</given-names></name><name><surname>Kholodenko</surname> <given-names>R</given-names></name><name><surname>Lem</surname> <given-names>J</given-names></name><name><surname>Pugh</surname> <given-names>EN</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Physiological features of the S- and M-cone photoreceptors of wild-type mice from single-cell recordings</article-title><source>Journal of General Physiology</source><volume>127</volume><fpage>359</fpage><lpage>374</lpage><pub-id pub-id-type="doi">10.1085/jgp.200609490</pub-id><pub-id pub-id-type="pmid">16567464</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Leary</surname> <given-names>T</given-names></name><name><surname>Williams</surname> <given-names>AH</given-names></name><name><surname>Franci</surname> <given-names>A</given-names></name><name><surname>Marder</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Cell types, network homeostasis, and pathological compensation from a biologically plausible ion channel expression model</article-title><source>Neuron</source><volume>82</volume><fpage>809</fpage><lpage>821</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.04.002</pub-id><pub-id pub-id-type="pmid">24853940</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Oesterle</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>CBC_inference</data-title><source>Software Heritage</source><version designator="swh:1:rev:2b8ec4ac0ca916d42cba0404229298f8ff79c3a3">swh:1:rev:2b8ec4ac0ca916d42cba0404229298f8ff79c3a3</version><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/browse/directory/74cb51f26fd3961f853488aeb3b8ef959ce4e541/?branch=refs/heads/master&amp;origin_url=https://github.com/berenslab/CBC_inference&amp;snapshot=e584de7e33f4121abd7232331b53d84b5863674b">https://archive.softwareheritage.org/browse/directory/74cb51f26fd3961f853488aeb3b8ef959ce4e541/?branch=refs/heads/master&amp;origin_url=https://github.com/berenslab/CBC_inference&amp;snapshot=e584de7e33f4121abd7232331b53d84b5863674b</ext-link></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oltedal</surname> <given-names>L</given-names></name><name><surname>Veruki</surname> <given-names>ML</given-names></name><name><surname>Hartveit</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Passive membrane properties and electrotonic signal processing in retinal rod bipolar cells</article-title><source>The Journal of Physiology</source><volume>587</volume><fpage>829</fpage><lpage>849</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.2008.165415</pub-id><pub-id pub-id-type="pmid">19124538</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Papamakarios</surname> <given-names>G</given-names></name><name><surname>Sterratt</surname> <given-names>DC</given-names></name><name><surname>Murray</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Sequential neural likelihood: fast likelihood-free inference with autoregressive flows</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1805.07226">https://arxiv.org/abs/1805.07226</ext-link></element-citation></ref><ref id="bib80"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Papamakarios</surname> <given-names>G</given-names></name><name><surname>Murray</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Fast ε-free inference of simulation models with bayesian conditional density estimation</article-title><conf-name>Advances in Neural Information Processing Systems</conf-name><fpage>1028</fpage><lpage>1036</lpage></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pennesi</surname> <given-names>ME</given-names></name><name><surname>Michaels</surname> <given-names>KV</given-names></name><name><surname>Magee</surname> <given-names>SS</given-names></name><name><surname>Maricle</surname> <given-names>A</given-names></name><name><surname>Davin</surname> <given-names>SP</given-names></name><name><surname>Garg</surname> <given-names>AK</given-names></name><name><surname>Gale</surname> <given-names>MJ</given-names></name><name><surname>Tu</surname> <given-names>DC</given-names></name><name><surname>Wen</surname> <given-names>Y</given-names></name><name><surname>Erker</surname> <given-names>LR</given-names></name><name><surname>Francis</surname> <given-names>PJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Long-term characterization of retinal degeneration in rd1 and rd10 mice using spectral domain optical coherence tomography</article-title><source>Investigative Ophthalmology &amp; Visual Science</source><volume>53</volume><fpage>4644</fpage><lpage>4656</lpage><pub-id pub-id-type="doi">10.1167/iovs.12-9611</pub-id><pub-id pub-id-type="pmid">22562504</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poirazi</surname> <given-names>P</given-names></name><name><surname>Brannon</surname> <given-names>T</given-names></name><name><surname>Mel</surname> <given-names>BW</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Pyramidal neuron as two-layer neural network</article-title><source>Neuron</source><volume>37</volume><fpage>989</fpage><lpage>999</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(03)00149-1</pub-id><pub-id pub-id-type="pmid">12670427</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prinz</surname> <given-names>AA</given-names></name><name><surname>Billimoria</surname> <given-names>CP</given-names></name><name><surname>Marder</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Alternative to hand-tuning conductance-based models: construction and analysis of databases of model neurons</article-title><source>Journal of Neurophysiology</source><volume>90</volume><fpage>3998</fpage><lpage>4015</lpage><pub-id pub-id-type="doi">10.1152/jn.00641.2003</pub-id><pub-id pub-id-type="pmid">12944532</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rattay</surname> <given-names>F</given-names></name><name><surname>Bassereh</surname> <given-names>H</given-names></name><name><surname>Fellner</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Impact of electrode position on the elicitation of sodium spikes in retinal bipolar cells</article-title><source>Scientific Reports</source><volume>7</volume><elocation-id>17590</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-017-17603-8</pub-id><pub-id pub-id-type="pmid">29242502</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Resatz</surname> <given-names>S</given-names></name><name><surname>Rattay</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>A model for the electrically stimulated retina</article-title><source>Mathematical and Computer Modelling of Dynamical Systems</source><volume>10</volume><fpage>93</fpage><lpage>106</lpage><pub-id pub-id-type="doi">10.1080/13873950412331318080</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rossant</surname> <given-names>C</given-names></name><name><surname>Goodman</surname> <given-names>DF</given-names></name><name><surname>Fontaine</surname> <given-names>B</given-names></name><name><surname>Platkiewicz</surname> <given-names>J</given-names></name><name><surname>Magnusson</surname> <given-names>AK</given-names></name><name><surname>Brette</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Fitting neuron models to spike trains</article-title><source>Frontiers in Neuroscience</source><volume>5</volume><elocation-id>9</elocation-id><pub-id pub-id-type="doi">10.3389/fnins.2011.00009</pub-id><pub-id pub-id-type="pmid">21415925</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saszik</surname> <given-names>S</given-names></name><name><surname>DeVries</surname> <given-names>SH</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>A mammalian retinal bipolar cell uses both graded changes in membrane voltage and all-or-nothing na+ spikes to encode light</article-title><source>Journal of Neuroscience</source><volume>32</volume><fpage>297</fpage><lpage>307</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2739-08.2012</pub-id><pub-id pub-id-type="pmid">22219291</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Satoh</surname> <given-names>H</given-names></name><name><surname>Aoki</surname> <given-names>K</given-names></name><name><surname>Watanabe</surname> <given-names>SI</given-names></name><name><surname>Kaneko</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>L-type calcium channels in the axon terminal of mouse bipolar cells</article-title><source>NeuroReport</source><volume>9</volume><fpage>2161</fpage><lpage>2165</lpage><pub-id pub-id-type="doi">10.1097/00001756-199807130-00002</pub-id><pub-id pub-id-type="pmid">9694192</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Schröder</surname> <given-names>C</given-names></name><name><surname>James</surname> <given-names>B</given-names></name><name><surname>Lagnado</surname> <given-names>L</given-names></name><name><surname>Berens</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Approximate bayesian inference for a mechanistic model of vesicle release at a ribbon synapse</article-title><conf-name>Advances in Neural Information Processing Systems</conf-name></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sheng</surname> <given-names>Z</given-names></name><name><surname>Choi</surname> <given-names>SY</given-names></name><name><surname>Dharia</surname> <given-names>A</given-names></name><name><surname>Li</surname> <given-names>J</given-names></name><name><surname>Sterling</surname> <given-names>P</given-names></name><name><surname>Kramer</surname> <given-names>RH</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Synaptic Ca2+ in darkness is lower in rods than cones, causing slower tonic release of vesicles</article-title><source>Journal of Neuroscience</source><volume>27</volume><fpage>5033</fpage><lpage>5042</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5386-06.2007</pub-id><pub-id pub-id-type="pmid">17494689</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singer</surname> <given-names>JH</given-names></name><name><surname>Diamond</surname> <given-names>JS</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Vesicle depletion and synaptic depression at a mammalian ribbon synapse</article-title><source>Journal of Neurophysiology</source><volume>95</volume><fpage>3191</fpage><lpage>3198</lpage><pub-id pub-id-type="doi">10.1152/jn.01309.2005</pub-id><pub-id pub-id-type="pmid">16452253</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sisson</surname> <given-names>SA</given-names></name><name><surname>Fan</surname> <given-names>Y</given-names></name><name><surname>Beaumont</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><source>Handbook of Approximate Bayesian Computation</source><publisher-name>Chapman and Hall/CRC</publisher-name></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname> <given-names>RG</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>NeuronC: a computational language for investigating functional architecture of neural circuits</article-title><source>Journal of Neuroscience Methods</source><volume>43</volume><fpage>83</fpage><lpage>108</lpage><pub-id pub-id-type="doi">10.1016/0165-0270(92)90019-A</pub-id><pub-id pub-id-type="pmid">1405746</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stringer</surname> <given-names>C</given-names></name><name><surname>Pachitariu</surname> <given-names>M</given-names></name><name><surname>Steinmetz</surname> <given-names>NA</given-names></name><name><surname>Okun</surname> <given-names>M</given-names></name><name><surname>Bartho</surname> <given-names>P</given-names></name><name><surname>Harris</surname> <given-names>KD</given-names></name><name><surname>Sahani</surname> <given-names>M</given-names></name><name><surname>Lesica</surname> <given-names>NA</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Inhibitory control of correlated intrinsic variability in cortical networks</article-title><source>eLife</source><volume>5</volume><elocation-id>e19695</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.19695</pub-id><pub-id pub-id-type="pmid">27926356</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Szatko</surname> <given-names>KP</given-names></name><name><surname>Korympidou</surname> <given-names>MM</given-names></name><name><surname>Ran</surname> <given-names>Y</given-names></name><name><surname>Berens</surname> <given-names>P</given-names></name><name><surname>Dalkara</surname> <given-names>D</given-names></name><name><surname>Schubert</surname> <given-names>T</given-names></name><name><surname>Euler</surname> <given-names>T</given-names></name><name><surname>Franke</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Neural circuits in the mouse retina support color vision in the upper visual field</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/745539</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taylor</surname> <given-names>AL</given-names></name><name><surname>Goaillard</surname> <given-names>JM</given-names></name><name><surname>Marder</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>How multiple conductances determine electrophysiological properties in a multicompartment model</article-title><source>Journal of Neuroscience</source><volume>29</volume><fpage>5573</fpage><lpage>5586</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4438-08.2009</pub-id><pub-id pub-id-type="pmid">19403824</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thoreson</surname> <given-names>WB</given-names></name><name><surname>Van Hook</surname> <given-names>MJ</given-names></name><name><surname>Parmelee</surname> <given-names>C</given-names></name><name><surname>Curto</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Modeling and measurement of vesicle pools at the cone ribbon synapse: changes in release probability are solely responsible for voltage-dependent changes in release</article-title><source>Synapse</source><volume>70</volume><fpage>1</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1002/syn.21871</pub-id><pub-id pub-id-type="pmid">26541100</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>tom Dieck</surname> <given-names>S</given-names></name><name><surname>Brandstätter</surname> <given-names>JH</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Ribbon synapses of the retina</article-title><source>Cell and Tissue Research</source><volume>326</volume><fpage>339</fpage><lpage>346</lpage><pub-id pub-id-type="doi">10.1007/s00441-006-0234-0</pub-id><pub-id pub-id-type="pmid">16775698</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsai</surname> <given-names>D</given-names></name><name><surname>Morley</surname> <given-names>JW</given-names></name><name><surname>Suaning</surname> <given-names>GJ</given-names></name><name><surname>Lovell</surname> <given-names>NH</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Direct activation and temporal response properties of rabbit retinal ganglion cells following subretinal stimulation</article-title><source>Journal of Neurophysiology</source><volume>102</volume><fpage>2982</fpage><lpage>2993</lpage><pub-id pub-id-type="doi">10.1152/jn.00545.2009</pub-id><pub-id pub-id-type="pmid">19741103</pub-id></element-citation></ref><ref id="bib100"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Twyford</surname> <given-names>P</given-names></name><name><surname>Cai</surname> <given-names>C</given-names></name><name><surname>Fried</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Differential responses to high-frequency electrical stimulation in ON and OFF retinal ganglion cells</article-title><source>Journal of Neural Engineering</source><volume>11</volume><elocation-id>025001</elocation-id><pub-id pub-id-type="doi">10.1088/1741-2560/11/2/025001</pub-id><pub-id pub-id-type="pmid">24556536</pub-id></element-citation></ref><ref id="bib101"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Hook</surname> <given-names>MJ</given-names></name><name><surname>Nawy</surname> <given-names>S</given-names></name><name><surname>Thoreson</surname> <given-names>WB</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Voltage- and calcium-gated ion channels of neurons in the vertebrate retina</article-title><source>Progress in Retinal and Eye Research</source><volume>72</volume><elocation-id>100760</elocation-id><pub-id pub-id-type="doi">10.1016/j.preteyeres.2019.05.001</pub-id><pub-id pub-id-type="pmid">31078724</pub-id></element-citation></ref><ref id="bib102"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wan</surname> <given-names>QF</given-names></name><name><surname>Heidelberger</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Synaptic release at mammalian bipolar cell terminals</article-title><source>Visual Neuroscience</source><volume>28</volume><fpage>109</fpage><lpage>119</lpage><pub-id pub-id-type="doi">10.1017/S0952523810000453</pub-id><pub-id pub-id-type="pmid">21272392</pub-id></element-citation></ref><ref id="bib103"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>B</given-names></name><name><surname>Weiland</surname> <given-names>JD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Resistivity profiles of wild-type, rd1, and rd10 mouse retina</article-title><conf-name>37th Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC) IEEE</conf-name><fpage>1650</fpage><lpage>1653</lpage><pub-id pub-id-type="doi">10.1109/EMBC.2015.7318692</pub-id></element-citation></ref><ref id="bib104"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wässle</surname> <given-names>H</given-names></name><name><surname>Puller</surname> <given-names>C</given-names></name><name><surname>Müller</surname> <given-names>F</given-names></name><name><surname>Haverkamp</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Cone contacts, mosaics, and territories of bipolar cells in the mouse retina</article-title><source>Journal of Neuroscience</source><volume>29</volume><fpage>106</fpage><lpage>117</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4442-08.2009</pub-id><pub-id pub-id-type="pmid">19129389</pub-id></element-citation></ref><ref id="bib105"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weitz</surname> <given-names>AC</given-names></name><name><surname>Nanduri</surname> <given-names>D</given-names></name><name><surname>Behrend</surname> <given-names>MR</given-names></name><name><surname>Gonzalez-Calle</surname> <given-names>A</given-names></name><name><surname>Greenberg</surname> <given-names>RJ</given-names></name><name><surname>Humayun</surname> <given-names>MS</given-names></name><name><surname>Chow</surname> <given-names>RH</given-names></name><name><surname>Weiland</surname> <given-names>JD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Improving the spatial resolution of epiretinal implants by increasing stimulus pulse duration</article-title><source>Science Translational Medicine</source><volume>7</volume><elocation-id>318ra203</elocation-id><pub-id pub-id-type="doi">10.1126/scitranslmed.aac4877</pub-id><pub-id pub-id-type="pmid">26676610</pub-id></element-citation></ref><ref id="bib106"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Werginz</surname> <given-names>P</given-names></name><name><surname>Benav</surname> <given-names>H</given-names></name><name><surname>Zrenner</surname> <given-names>E</given-names></name><name><surname>Rattay</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Modeling the response of ON and OFF retinal bipolar cells during electric stimulation</article-title><source>Vision Research</source><volume>111</volume><fpage>170</fpage><lpage>181</lpage><pub-id pub-id-type="doi">10.1016/j.visres.2014.12.002</pub-id><pub-id pub-id-type="pmid">25499837</pub-id></element-citation></ref><ref id="bib107"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wood</surname> <given-names>SN</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Statistical inference for noisy nonlinear ecological dynamic systems</article-title><source>Nature</source><volume>466</volume><fpage>1102</fpage><lpage>1104</lpage><pub-id pub-id-type="doi">10.1038/nature09319</pub-id><pub-id pub-id-type="pmid">20703226</pub-id></element-citation></ref><ref id="bib108"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xiao</surname> <given-names>H</given-names></name><name><surname>Peng</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>APP2: automatic tracing of 3D neuron morphology based on hierarchical pruning of a gray-weighted image distance-tree</article-title><source>Bioinformatics</source><volume>29</volume><fpage>1448</fpage><lpage>1454</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btt170</pub-id><pub-id pub-id-type="pmid">23603332</pub-id></element-citation></ref><ref id="bib109"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname> <given-names>YD</given-names></name><name><surname>Cho</surname> <given-names>H</given-names></name><name><surname>Koo</surname> <given-names>JY</given-names></name><name><surname>Tak</surname> <given-names>MH</given-names></name><name><surname>Cho</surname> <given-names>Y</given-names></name><name><surname>Shim</surname> <given-names>WS</given-names></name><name><surname>Park</surname> <given-names>SP</given-names></name><name><surname>Lee</surname> <given-names>J</given-names></name><name><surname>Lee</surname> <given-names>B</given-names></name><name><surname>Kim</surname> <given-names>BM</given-names></name><name><surname>Raouf</surname> <given-names>R</given-names></name><name><surname>Shin</surname> <given-names>YK</given-names></name><name><surname>Oh</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>TMEM16A confers receptor-activated calcium-dependent chloride conductance</article-title><source>Nature</source><volume>455</volume><fpage>1210</fpage><lpage>1215</lpage><pub-id pub-id-type="doi">10.1038/nature07313</pub-id><pub-id pub-id-type="pmid">18724360</pub-id></element-citation></ref><ref id="bib110"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Zhao</surname> <given-names>Z</given-names></name><name><surname>Klindt</surname> <given-names>D</given-names></name><name><surname>Chagas</surname> <given-names>AM</given-names></name><name><surname>Szatko</surname> <given-names>KP</given-names></name><name><surname>Rogerson</surname> <given-names>L</given-names></name><name><surname>Protti</surname> <given-names>D</given-names></name><name><surname>Behrens</surname> <given-names>C</given-names></name><name><surname>Dalkara</surname> <given-names>D</given-names></name><name><surname>Schubert</surname> <given-names>T</given-names></name><name><surname>Bethge</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The temporal structure of the inner retina at a single glance</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/743047</pub-id></element-citation></ref><ref id="bib111"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zrenner</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Will retinal implants restore vision?</article-title><source>Science</source><volume>295</volume><fpage>1022</fpage><lpage>1025</lpage><pub-id pub-id-type="doi">10.1126/science.1067996</pub-id><pub-id pub-id-type="pmid">11834821</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><sec id="s8" sec-type="appendix"><title>Cone prior parameters</title><table-wrap id="app1table1" position="float"><label>Appendix 1—table 1.</label><caption><title>Cone model parameter priors.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Parameter</th><th>Unit</th><th><italic>a</italic><sub><italic>i</italic></sub></th><th><italic>µ<sub>i</sub></italic></th><th><italic>b</italic><sub><italic>i</italic></sub></th><th>References: direct and additional</th></tr></thead><tbody><tr><td><inline-formula><mml:math id="inf447"><mml:msub><mml:mi>C</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf448"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">F</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0.9</td><td>1</td><td>1.3</td><td><xref ref-type="bibr" rid="bib78">Oltedal et al., 2009</xref></td></tr><tr><td><inline-formula><mml:math id="inf449"><mml:msub><mml:mi>R</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf450"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>1</td><td>5</td><td>100</td><td><xref ref-type="bibr" rid="bib78">Oltedal et al., 2009</xref></td></tr><tr><td><inline-formula><mml:math id="inf451"><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf452"><mml:mpadded lspace="1.7pt" width="+1.7pt"><mml:mi>mV</mml:mi></mml:mpadded></mml:math></inline-formula></td><td>-90</td><td>-70</td><td>-50</td><td/></tr><tr><td><inline-formula><mml:math id="inf453"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf454"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0.1</td><td>2</td><td>10</td><td><xref ref-type="bibr" rid="bib71">Morgans et al., 2005</xref>; <xref ref-type="bibr" rid="bib65">Mansergh et al., 2005</xref>; <xref ref-type="bibr" rid="bib19">Cui et al., 2012</xref></td></tr><tr><td><inline-formula><mml:math id="inf455"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf456"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0</td><td>0.1</td><td>3</td><td><xref ref-type="bibr" rid="bib101">Van Hook et al., 2019</xref></td></tr><tr><td><inline-formula><mml:math id="inf457"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>@</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>S</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf458"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0</td><td>3</td><td>10</td><td><xref ref-type="bibr" rid="bib55">Knop et al., 2008</xref>; <xref ref-type="bibr" rid="bib39">Hellmer et al., 2016</xref>; <xref ref-type="bibr" rid="bib101">Van Hook et al., 2019</xref></td></tr><tr><td><inline-formula><mml:math id="inf459"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>@</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>A</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf460"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0</td><td>1</td><td>10</td><td><xref ref-type="bibr" rid="bib55">Knop et al., 2008</xref>; <xref ref-type="bibr" rid="bib39">Hellmer et al., 2016</xref>; <xref ref-type="bibr" rid="bib101">Van Hook et al., 2019</xref></td></tr><tr><td><inline-formula><mml:math id="inf461"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>@</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf462"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0</td><td>0.1</td><td>10</td><td><xref ref-type="bibr" rid="bib55">Knop et al., 2008</xref>; <xref ref-type="bibr" rid="bib39">Hellmer et al., 2016</xref>; <xref ref-type="bibr" rid="bib101">Van Hook et al., 2019</xref></td></tr><tr><td><inline-formula><mml:math id="inf463"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf464"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0</td><td>0.1</td><td>10</td><td><xref ref-type="bibr" rid="bib109">Yang et al., 2008</xref>; <xref ref-type="bibr" rid="bib12">Caputo et al., 2015</xref></td></tr><tr><td><inline-formula><mml:math id="inf465"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf466"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0.1</td><td>10</td><td>100</td><td><xref ref-type="bibr" rid="bib70">Morgans et al., 1998</xref></td></tr><tr><td><inline-formula><mml:math id="inf467"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td/><td>0.75</td><td>1</td><td>1.5</td><td/></tr><tr><td><inline-formula><mml:math id="inf468"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td/><td>0.1</td><td>1</td><td>10</td><td/></tr><tr><td><inline-formula><mml:math id="inf469"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf470"><mml:mpadded lspace="1.7pt" width="+1.7pt"><mml:mi>mV</mml:mi></mml:mpadded></mml:math></inline-formula></td><td>−5</td><td>0</td><td>5</td><td/></tr><tr><td><inline-formula><mml:math id="inf471"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf472"><mml:mpadded lspace="1.7pt" width="+1.7pt"><mml:mi>mV</mml:mi></mml:mpadded></mml:math></inline-formula></td><td>−10</td><td>0</td><td>10</td><td/></tr><tr><td><inline-formula><mml:math id="inf473"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">K</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf474"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0.01</td><td>5</td><td>100</td><td/></tr><tr><td><inline-formula><mml:math id="inf475"><mml:msubsup><mml:mi>v</mml:mi><mml:mi>RRP</mml:mi><mml:mi>max</mml:mi></mml:msubsup></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf476"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>10</td><td>20</td><td>30</td><td><xref ref-type="bibr" rid="bib97">Thoreson et al., 2016</xref>; <xref ref-type="bibr" rid="bib7">Bartoletti et al., 2010</xref></td></tr><tr><td><inline-formula><mml:math id="inf477"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td/><td>0.3</td><td>1</td><td>3</td><td/></tr></tbody></table></table-wrap></sec><sec id="s9" sec-type="appendix"><title>BC prior parameters</title><table-wrap id="app1table2" position="float"><label>Appendix 1—table 2.</label><caption><title>BC model parameter priors.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Parameter</th><th>Unit</th><th><italic>a</italic><sub><italic>i</italic></sub> <break/>(3a|5)</th><th><italic>µ<sub>i</sub></italic> <break/>(3a|5)</th><th><italic>b</italic><sub><italic>i</italic></sub> <break/>(3a | 5)</th><th>References: direct and additional</th></tr></thead><tbody><tr><td><inline-formula><mml:math id="inf478"><mml:msub><mml:mi>C</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf479"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">F</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0.9</td><td>1.18</td><td>1.3</td><td><xref ref-type="bibr" rid="bib78">Oltedal et al., 2009</xref></td></tr><tr><td><inline-formula><mml:math id="inf480"><mml:msub><mml:mi>R</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf481"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>1</td><td>26</td><td>100</td><td><xref ref-type="bibr" rid="bib78">Oltedal et al., 2009</xref></td></tr><tr><td><inline-formula><mml:math id="inf482"><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf483"><mml:mpadded lspace="1.7pt" width="+1.7pt"><mml:mi>mV</mml:mi></mml:mpadded></mml:math></inline-formula></td><td>−90</td><td>−70</td><td>−50</td><td/></tr><tr><td><inline-formula><mml:math id="inf484"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>@</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>S</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf485"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0</td><td>0.5</td><td>3</td><td><xref ref-type="bibr" rid="bib19">Cui et al., 2012</xref>, <xref ref-type="bibr" rid="bib101">Van Hook et al., 2019</xref></td></tr><tr><td><inline-formula><mml:math id="inf486"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>@</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf487"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0.1</td><td>0.5</td><td>3</td><td><xref ref-type="bibr" rid="bib19">Cui et al., 2012</xref>, <xref ref-type="bibr" rid="bib101">Van Hook et al., 2019</xref></td></tr><tr><td><inline-formula><mml:math id="inf488"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>@</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>S</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf489"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0|n/a</td><td>0.5|n/a</td><td>3|n/a</td><td><xref ref-type="bibr" rid="bib19">Cui et al., 2012</xref>, <xref ref-type="bibr" rid="bib101">Van Hook et al., 2019</xref>; <xref ref-type="bibr" rid="bib43">Hu et al., 2009</xref>; <xref ref-type="bibr" rid="bib88">Satoh et al., 1998</xref></td></tr><tr><td><inline-formula><mml:math id="inf490"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>@</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf491"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0|n/a</td><td>0.5|n/a</td><td>3|n/a</td><td><xref ref-type="bibr" rid="bib19">Cui et al., 2012</xref>, <xref ref-type="bibr" rid="bib101">Van Hook et al., 2019</xref>; <xref ref-type="bibr" rid="bib43">Hu et al., 2009</xref>; <xref ref-type="bibr" rid="bib88">Satoh et al., 1998</xref></td></tr><tr><td><inline-formula><mml:math id="inf492"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>@</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf493"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0</td><td>0.4</td><td>2</td><td><xref ref-type="bibr" rid="bib63">Ma et al., 2005</xref></td></tr><tr><td><inline-formula><mml:math id="inf494"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>@</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>P</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf495"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0</td><td>0.4</td><td>2</td><td><xref ref-type="bibr" rid="bib63">Ma et al., 2005</xref></td></tr><tr><td><inline-formula><mml:math id="inf496"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>@</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>A</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf497"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0</td><td>0.4</td><td>2</td><td><xref ref-type="bibr" rid="bib63">Ma et al., 2005</xref></td></tr><tr><td><inline-formula><mml:math id="inf498"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>@</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>S</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf499"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0</td><td>1</td><td>2</td><td><xref ref-type="bibr" rid="bib20">Cui and Pan, 2008</xref>, <xref ref-type="bibr" rid="bib55">Knop et al., 2008</xref></td></tr><tr><td><inline-formula><mml:math id="inf500"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:mrow></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>@</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf501"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0</td><td>0.2</td><td>2</td><td><xref ref-type="bibr" rid="bib39">Hellmer et al., 2016</xref>, <xref ref-type="bibr" rid="bib55">Knop et al., 2008</xref></td></tr><tr><td><inline-formula><mml:math id="inf502"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:mrow></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>@</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>S</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf503"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0</td><td>0.2</td><td>2</td><td><xref ref-type="bibr" rid="bib39">Hellmer et al., 2016</xref>, <xref ref-type="bibr" rid="bib55">Knop et al., 2008</xref></td></tr><tr><td><inline-formula><mml:math id="inf504"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:mrow></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>@</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf505"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0</td><td>0.2</td><td>2</td><td><xref ref-type="bibr" rid="bib39">Hellmer et al., 2016</xref>, <xref ref-type="bibr" rid="bib55">Knop et al., 2008</xref></td></tr><tr><td><inline-formula><mml:math id="inf506"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>@</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf507"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0</td><td>20</td><td>100</td><td><xref ref-type="bibr" rid="bib39">Hellmer et al., 2016</xref></td></tr><tr><td><inline-formula><mml:math id="inf508"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>@</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>S</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf509"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0.1</td><td>10</td><td>100</td><td><xref ref-type="bibr" rid="bib70">Morgans et al., 1998</xref></td></tr><tr><td><inline-formula><mml:math id="inf510"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>@</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf511"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0.1</td><td>10</td><td>100</td><td><xref ref-type="bibr" rid="bib70">Morgans et al., 1998</xref></td></tr><tr><td><inline-formula><mml:math id="inf512"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">K</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td/><td>1|n/a</td><td>5|n/a</td><td>20|n/a</td><td/></tr><tr><td><inline-formula><mml:math id="inf513"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td/><td>0.5</td><td>1</td><td>2</td><td/></tr><tr><td><inline-formula><mml:math id="inf514"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td/><td>0.5|n/a</td><td>1|n/a</td><td>2|n/a</td><td/></tr><tr><td><inline-formula><mml:math id="inf515"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td/><td>0.1</td><td>1</td><td>10</td><td/></tr><tr><td><inline-formula><mml:math id="inf516"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td/><td>0.5</td><td>1</td><td>2</td><td/></tr><tr><td><inline-formula><mml:math id="inf517"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf518"><mml:mpadded lspace="1.7pt" width="+1.7pt"><mml:mi>mV</mml:mi></mml:mpadded></mml:math></inline-formula></td><td>−10</td><td>0</td><td>10</td><td/></tr><tr><td><inline-formula><mml:math id="inf519"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf520"><mml:mpadded lspace="1.7pt" width="+1.7pt"><mml:mi>mV</mml:mi></mml:mpadded></mml:math></inline-formula></td><td>−10|n/a</td><td>0|n/a</td><td>10|n/a</td><td/></tr><tr><td><inline-formula><mml:math id="inf521"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf522"><mml:mpadded lspace="1.7pt" width="+1.7pt"><mml:mi>mV</mml:mi></mml:mpadded></mml:math></inline-formula></td><td>−10</td><td>0</td><td>10</td><td/></tr><tr><td><inline-formula><mml:math id="inf523"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf524"><mml:mpadded lspace="1.7pt" width="+1.7pt"><mml:mi>mV</mml:mi></mml:mpadded></mml:math></inline-formula></td><td>−5</td><td>0</td><td>5</td><td/></tr><tr><td><inline-formula><mml:math id="inf525"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf526"><mml:mpadded lspace="1.7pt" width="+1.7pt"><mml:mi>mV</mml:mi></mml:mpadded></mml:math></inline-formula></td><td>−5</td><td>0</td><td>5</td><td/></tr><tr><td><inline-formula><mml:math id="inf527"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf528"><mml:mpadded lspace="1.7pt" width="+1.7pt"><mml:mi>mV</mml:mi></mml:mpadded></mml:math></inline-formula></td><td>−5</td><td>0</td><td>5</td><td/></tr><tr><td><inline-formula><mml:math id="inf529"><mml:msub><mml:mtext>Ca</mml:mtext><mml:mtext>PK</mml:mtext></mml:msub></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf530"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0.1|0.01</td><td>20</td><td>100</td><td/></tr><tr><td><inline-formula><mml:math id="inf531"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf532"><mml:mpadded lspace="1.7pt" width="+1.7pt"><mml:mi>mmol</mml:mi></mml:mpadded></mml:math></inline-formula></td><td>0.05|1</td><td>0.5|1.5</td><td>1|3</td><td/></tr><tr><td><inline-formula><mml:math id="inf533"><mml:msubsup><mml:mi>v</mml:mi><mml:mtext>RRP</mml:mtext><mml:mtext>max</mml:mtext></mml:msubsup></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf534"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>4</td><td>8</td><td>15</td><td><xref ref-type="bibr" rid="bib91">Singer and Diamond, 2006</xref></td></tr><tr><td><inline-formula><mml:math id="inf535"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td/><td>0.5</td><td>1</td><td>3</td><td/></tr></tbody></table></table-wrap></sec><sec id="s10" sec-type="appendix"><title>NeuronC parameters</title><table-wrap id="app1table3" position="float"><label>Appendix 1—table 3.</label><caption><title>Other NeuronC parameters.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Parameter</th><th>Unit</th><th>Value</th><th>Remarks</th></tr></thead><tbody><tr><td>vna</td><td><inline-formula><mml:math id="inf536"><mml:mpadded lspace="1.7pt" width="+1.7pt"><mml:mi>mV</mml:mi></mml:mpadded></mml:math></inline-formula></td><td>65</td><td>Reversal potential sodium</td></tr><tr><td>vk</td><td><inline-formula><mml:math id="inf537"><mml:mpadded lspace="1.7pt" width="+1.7pt"><mml:mi>mV</mml:mi></mml:mpadded></mml:math></inline-formula></td><td>−89</td><td>Reversal potential potassium</td></tr><tr><td>vcl</td><td><inline-formula><mml:math id="inf538"><mml:mpadded lspace="1.7pt" width="+1.7pt"><mml:mi>mV</mml:mi></mml:mpadded></mml:math></inline-formula></td><td>−70</td><td>Reversal potential chloride</td></tr><tr><td>dnao</td><td><inline-formula><mml:math id="inf539"><mml:mpadded lspace="1.7pt" width="+1.7pt"><mml:mi>mmol</mml:mi></mml:mpadded></mml:math></inline-formula></td><td>151.5</td><td>Extracellular sodium concentration</td></tr><tr><td>dko</td><td><inline-formula><mml:math id="inf540"><mml:mpadded lspace="1.7pt" width="+1.7pt"><mml:mi>mmol</mml:mi></mml:mpadded></mml:math></inline-formula></td><td>2.5</td><td>Extracellular potassium concentration</td></tr><tr><td>dclo</td><td><inline-formula><mml:math id="inf541"><mml:mpadded lspace="1.7pt" width="+1.7pt"><mml:mi>mmol</mml:mi></mml:mpadded></mml:math></inline-formula></td><td>133.5</td><td>Extracellular chloride concentration</td></tr><tr><td>dcao</td><td><inline-formula><mml:math id="inf542"><mml:mpadded lspace="1.7pt" width="+1.7pt"><mml:mi>mmol</mml:mi></mml:mpadded></mml:math></inline-formula></td><td>2</td><td>Extracellular calcium concentration</td></tr><tr><td>dicafrac</td><td/><td>1</td><td>Fraction of calcium pump current that is added to total current</td></tr><tr><td>use_ghki</td><td/><td>1</td><td>Use Goldman-Hodgkin-Katz equation</td></tr><tr><td>cone_timec</td><td/><td>0.2</td><td>Time constant of cone phototransduction</td></tr><tr><td>cone_loopg</td><td/><td>0.0</td><td>Gain of calcium feedback loop in cones</td></tr><tr><td>cone_maxcond</td><td><inline-formula><mml:math id="inf543"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0.2</td><td>Max. conductance of of outer segment</td></tr><tr><td>timinc</td><td><inline-formula><mml:math id="inf544"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0.001 | 0.01</td><td>Simulation time step (<xref ref-type="fig" rid="fig9">Figure 9</xref>)</td></tr><tr><td>ploti</td><td><inline-formula><mml:math id="inf545"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0.01 | 1</td><td>Recording time step (<xref ref-type="fig" rid="fig9">Figure 9</xref> and <xref ref-type="fig" rid="fig10">Figure 10</xref> | otherwise)</td></tr><tr><td>stiminc</td><td><inline-formula><mml:math id="inf546"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0.01 | 0.1</td><td>Synaptic time step (<xref ref-type="fig" rid="fig9">Figure 9</xref> and <xref ref-type="fig" rid="fig10">Figure 10</xref> | otherwise)</td></tr><tr><td>srtimestep</td><td><inline-formula><mml:math id="inf547"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0.001 | 0.01 | 0.1</td><td>Stimulus update time step (<xref ref-type="fig" rid="fig9">Figure 9</xref> | <xref ref-type="fig" rid="fig10">Figure 10</xref> | otherwise)</td></tr><tr><td>predur</td><td><inline-formula><mml:math id="inf548"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>5 | ≥10</td><td>Simulation time to reach equilibrium potential (Cone | BCs)</td></tr></tbody></table></table-wrap></sec></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.54997.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Borst</surname><given-names>Alexander</given-names></name><role>Reviewing Editor</role><aff><institution>Max Planck Institute of Neurobiology</institution><country>Germany</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Borst</surname><given-names>Alexander</given-names> </name><role>Reviewer</role><aff><institution>Max Planck Institute of Neurobiology</institution><country>Germany</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Fairhall</surname><given-names>Adrienne L</given-names></name><role>Reviewer</role><aff><institution>University of Washington</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>In your paper, you apply Bayesian inference to estimate parameters of multi-compartmental models of cone and cone bipolar cells from 2P-glutamate imaging data. You next use the resulting compartmental models to optimize electrical stimulation of the retina for neuroprosthetics.</p><p>As a major advantage of the parameter estimation procedure, the result is not just a singular point in parameter space resulting in an optimal fit, but instead a likelihood distribution showing how well each parameter is constrained by the data. I see this as a significant step forward compared to previous model parameter estimation procedures.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Bayesian inference for biophysical neuron models enables stimulus optimization for retinal neuroprosthetics&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, including Alexander Borst as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by John Huguenard as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Adrienne L Fairhall (Reviewer #3).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>We would like to draw your attention to changes in our revision policy that we have made in response to COVID-19 (https://elifesciences.org/articles/57162). Specifically, we are asking editors to accept without delay manuscripts, like yours, that they judge can stand as <italic>eLife</italic> papers without additional data, even if they feel that they would make the manuscript stronger. Thus the revisions requested below only address clarity and presentation.</p><p>Summary:</p><p>In this paper, Oesterle and colleagues apply Bayesian inference to estimate parameters of multi-compartmental models of cone and cone ON and OFF bipolar cells from light stimulation and 2P-glutamate imaging as well as EM reconstructions. The method employed (Sequential Neural Posterior Estimation) makes use of a mixture density network, which is an approach that sounds very promising for work in this domain. Importantly, the resulting model parameters are not only given as points to result in an optimal fit, but are given as a likelihood distribution showing how well a specific parameter is constrained by the data. I see this as a significant step forward compared to previous model parameter estimation procedures.</p><p>The authors then extended the work to model the effects of electrical stimulation in view of building a modeling test bed for electrical retinal prostheses. This required data constraints from electrical stimulation and current recording. Using the model, the authors were able to design stimuli that selectively targeted different bipolar cells. This work stands as a useful general contribution as a method and the authors have done a thorough and careful job in their modeling. The extension to predictions for retinal prostheses demonstrates the power of the approach.</p><p>Essential revisions:</p><p>1) This is a systematic study, primarily aimed to demonstrate the advantage of Bayesian simulation-based inference (BSI) for estimating the biophysical parameters of compartmental models. While BSI is convincingly demonstrated as a powerful tool for this purpose, it is not clear whether it is superior in any way over the present-day most-popular alternative, the Multiple Objective Optimization (MOO) approach (Drukmann et al., 2007) which is presently used for building data-constrained compartmental modelling for a large variety of neuron types, in hundreds of labs. worldwide, including at the Allen Inst. the Blue Brain projects etc. One key missing aspect in the present study is a systematic comparison (at least in the Discussion) between BSI and MOO methods.</p><p>2) Another key missing aspect in this work is the lack of biophysical intuitions emerging from the compartmental models built. Specifically, how does the synaptic input from the cones propagate along the ON and the OFF BP cells' model that we see in Figure 1? We actually do not see any signal (synaptic potential) in this work neither its propagation along the different compartments – from the distal dendrites to soma, to axon. Does voltage attenuate significantly along these BP – compartments or are the modeled cell close to isopotentiality? What is the role of active ion channels during signals propagation in these models? What is the synaptic conductances (between Cone and BP cells) in these models (and what is the justification to use such a complicated model for transmitter release with Ca-dependent pool-release, rather than transient (double exponential?) conductance change as synaptic inputs)? What are the key differences between the ON and OFF compt. models that make them respond differentially to extracellular stimulus? The authors write in the Discussion: &quot;Likely, the different density for some ion channels contributed to the differential response of the two BC types&quot;. This is clearly an unsounded claim which needs to be shown and discussed. After all – an important usage of compartmental modelling is to gain insights into the interaction between structure/membrane channels and synaptic/input-output properties of the modeled cells and for calibrating the model against experiments. This key aspect is missing in this work and, therefore, it is impossible for the reader to grasp the underlying mechanisms responsible for the emergent properties of the modeled cells in response to light stimulus.</p><p>3) Another query is whether the response of the modeled ON and OFF BP cells will not be very different when they are immersed in actual retina circuit, with electrical field generated also by other cell types (AC, GC) when the retina is electrically-stimulated. This point should be discussed.</p><p>4) It is essential to provide the readers with Neuron models of the 3-cell types as well as with the respective data that was used to constrain these models</p><p>5) While the paper is generally well written and clear, the model exposition (Section entitled &quot;Inference algorithm&quot;) leaves considerable room for improvement; ideally the paper should be self-contained. The presentation is a little confusing with respect to the status of <italic>p</italic>(<italic>θ</italic>), the &quot;proposal prior&quot; <italic>p</italic> ~, the posterior <italic>p</italic>(<italic>θ</italic>|x) and the &quot;auxiliary&quot; distribution q (which when equated to the posterior is no longer written as a conditional distribution as it appears in the cost function). It would be good to explain the form of the cost function that is minimized-it looks like it is based on a KL divergence but is a bit unclear of what. This exposition could do a much better job of walking pedagogically through the goal of the algorithm and how the goal is achieved by the variables defined and the cost function. Also, one should shorten this part of the paper and shift many of the figures to Appendices – as it is now standing with 10 figures.</p><p>6) It is difficult to find a quantitative reporting of the variation between data from the same cell type. I took the method to be applied to fit distributions over parameters for models accounting for each experimental trace separately; and for the (beautiful!) results in Figures 5 and 6 to be from one example cell, but maybe this is not true. Could this be clarified? Are the distributions of 7 over models that fit all the experimental data for that cell type? If not, it would be good to show the measured responses with an error bar, and show variations between models. Understanding the extent of intercellular variability seems important in the design of isolating stimuli.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.54997.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) This is a systematic study, primarily aimed to demonstrate the advantage of Bayesian simulation-based inference (BSI) for estimating the biophysical parameters of compartmental models. While BSI is convincingly demonstrated as a powerful tool for this purpose, it is not clear whether it is superior in any way over the present-day most-popular alternative, the Multiple Objective Optimization (MOO) approach (Drukmann et al., 2007) which is presently used for building data-constrained compartmental modelling for a large variety of neuron types, in hundreds of labs. worldwide, including at the Allen Inst. the Blue Brain projects etc. One key missing aspect in the present study is a systematic comparison (at least in the Discussion) between BSI and MOO methods.</p></disp-quote><p>We thank the reviewers for giving us the chance to clarify this point. Our contribution in this paper is to show that Bayesian inference for biophysical multicompartment models of neurons is feasible using fairly standard light stimuli and recordings and one can obtain meaningful posterior distributions even for such high-dimensional inference problems.</p><p>Indeed, many other labs use MOO algorithms for similar models. However, recent parallel work by Lueckmann et al. also under review at <italic>eLife</italic></p><p>(<ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/838383v3.full.pdf">https://www.biorxiv.org/content/10.1101/838383v3.full.pdf</ext-link>)​ has shown that already for single compartment Hodgkin-Huxley models MOO algorithms do not in general perform proper statistical inference – in particular, the best simulations obtained by such algorithms are often more concentrated in the parameter space and one cannot easily get a good sense of the uncertainty in the parameters from such algorithms. We expanded our discussion of alternative approaches, highlighting also the comparative analysis in the abovementioned paper. Also, we expanded our analysis (e.g. in Figures 9 and 10)​ to explicitly take the posterior into account.</p><disp-quote content-type="editor-comment"><p>2) Another key missing aspect in this work is the lack of biophysical intuitions emerging from the compartmental models built. Specifically, how does the synaptic input from the cones propagate along the ON and the OFF BP cells' model that we see in Figure 1? We actually do not see any signal (synaptic potential) in this work neither its propagation along the different compartments – from the distal dendrites to soma, to axon. Does voltage attenuate significantly along these BP – compartments or are the modeled cell close to isopotentiality? What is the role of active ion channels during signals propagation in these models?</p></disp-quote><p>To address this point, we created animated heatmaps overlaid on the BC’s morphology to show the voltage, calcium and glutamate signals as a function of space and time, available as video files, for the chirp stimulus. Snapshots from these videos at discrete time points are available as Figure 6—figure supplements 1 and 2. We discuss this analysis in the Results​ section. It shows that BCs are relatively isopotential units. We checked for the importance of active ion channels by removing them from the optimized model (calcium channels in the axon terminals were left in, as they are required for simulating release and do not contribute strongly to the voltage). We found that for the cone model, the calcium-activated chloride channels did almost not contribute to the light response in the optimized model, neither for the cone nor the BC stimulus. We therefore removed it in the following steps, to save computational resources. For the BCs, we extended this analysis to the five best posterior samples (and not only the best sample). We found that, in both cells, the sodium channel (Na<sub>V</sub>) and somatic calcium channels could be removed from the model without altering the light response. Separate from the calcium channels in the axon terminals, the HCN was most significant for shaping the light response. We discuss all these findings in the paper now.</p><disp-quote content-type="editor-comment"><p>What is the synaptic conductances (between Cone and BP cells) in these models?</p></disp-quote><p>This parameter was missing from the manuscript. We now provide it in the Materials and methods section.</p><disp-quote content-type="editor-comment"><p>What is the justification to use such a complicated model for transmitter release with Ca-dependent pool-release, rather than transient (double exponential?) conductance change as synaptic inputs?</p></disp-quote><p>Ribbon synapses are a hallmark of glutamate release in cones and bipolar cells (for review, see Baden et al., 2011, <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.tins.2013.04.006">https://doi.org/10.1016/j.tins.2013.04.00</ext-link>​<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.tins.2013.04.006">6</ext-link>)​. The dynamics of release at this type of synapse cannot be easily matched with a simple transient conductance change, as the state of the pools determines the kinetics of the release. For example, if all pools are filled, ribbon synapses can release a large amount of glutamate very rapidly, emphasizing transient signals. We added a sentence justifying this choice in the Materials and methods section.</p><disp-quote content-type="editor-comment"><p>What are the key differences between the ON and OFF compt. models that make them respond differentially to extracellular stimulus? The authors write in the Discussion: &quot;Likely, the different density for some ion channels contributed to the differential response of the two BC types&quot;. This is clearly an unsounded claim which needs to be shown and discussed.</p></disp-quote><p>We investigated this finding in more detail by varying additionally the cell position relative to the electrode and sampling cell parameters from the posterior. We found that the optimal stimulus waveform for the OFF cell was robust against changes in the cell position relative to the electrode and the precise choice model parameters, while the ON cell could less reliably be activated exclusively, with typical stimuli good for ON cells also evoking sizable OFF cell responses (similar to what could be seen in the original Figure 10). This different behavior was due to the T-type calcium channel in the OFF-BC, which strongly reacts to transient stimulation. The ON-BC can only be selectively activated if the threshold for the OFF-BC is larger, which depends on the cell position and the exact cell parametrization. These new results are now discussed in the paper.</p><disp-quote content-type="editor-comment"><p>After all – an important usage of compartmental modelling is to gain insights into the interaction between structure/membrane channels and synaptic/input-output properties of the modeled cells and for calibrating the model against experiments. This key aspect is missing in this work and, therefore, it is impossible for the reader to grasp the underlying mechanisms responsible for the emergent properties of the modeled cells in response to light stimulus.</p></disp-quote><p>As detailed above, we added several new figures and performed new analysis following the feedback of the reviewer. We feel that these have improved the paper significantly.</p><disp-quote content-type="editor-comment"><p>3) Another query is whether the response of the modeled ON and OFF BP cells will not be very different when they are immersed in actual retina circuit, with electrical field generated also by other cell types (AC, GC) when the retina is electrically-stimulated. This point should be discussed.</p></disp-quote><p>The reviewers are right that being able to selectively stimulate OFF/ON BCs in isolation is not the same as being able to stimulate them selectively when embedded in the retinal network. Of course, network effects through synaptic activation of ACs will further modulate the activity evoked by the stimulation. It is unlikely that ACs or RGCs get directly activated by the electrical stimulation protocol suggested here, as their neurites and somata are substantially farther away from the stimulation electrode than those of BCs, and Figures 3D​ and 10 illustrate that even for BCs mostly the dendrites are directly affected by the electric​ field. That notwithstanding, simulations including network effects and also more diverse BC types will be required in the future. We added this to the Discussion.</p><disp-quote content-type="editor-comment"><p>4) It is essential to provide the readers with Neuron models of the 3-cell types as well as with the respective data that was used to constrain these models</p></disp-quote><p>We will make the code and the data available upon publication at our github account <ext-link ext-link-type="uri" xlink:href="https://github.com/berenslab">https://github.com/berenslab</ext-link> and will provide the version used to create the figures for the​ paper as version 1.0 archived on zenodo.</p><disp-quote content-type="editor-comment"><p>5) While the paper is generally well written and clear, the model exposition (Section entitled &quot;Inference algorithm&quot;) leaves considerable room for improvement; ideally the paper should be self-contained. The presentation is a little confusing with respect to the status of p(θ), the &quot;proposal prior&quot; p ~, the posterior p(θ|x) and the &quot;auxiliary&quot; distribution q (which when equated to the posterior is no longer written as a conditional distribution as it appears in the cost function). It would be good to explain the form of the cost function that is minimized-it looks like it is based on a KL divergence but is a bit unclear of what. This exposition could do a much better job of walking pedagogically through the goal of the algorithm and how the goal is achieved by the variables defined and the cost function. Also, one should shorten this part of the paper and shift many of the figures to Appendices – as it is now standing with 10 figures.</p></disp-quote><p>We reordered this part of the Materials and methods section. Now the section starts with the target data and we explain the discrepancy measure between simulations and target data. We then explained the inference algorithm step-by-step and changed the wording to make it clearer. We feel that moving figures from the Materials and methods section to the Appendix would rather make the paper harder to read.</p><disp-quote content-type="editor-comment"><p>6) It is difficult to find a quantitative reporting of the variation between data from the same cell type. I took the method to be applied to fit distributions over parameters for models accounting for each experimental trace separately; and for the (beautiful!) results in Figures 5 and 6 to be from one example cell, but maybe this is not true. Could this be clarified? Are the distributions of 7 over models that fit all the experimental data for that cell type? If not, it would be good to show the measured responses with an error bar, and show variations between models. Understanding the extent of intercellular variability seems important in the design of isolating stimuli.</p></disp-quote><p>Indeed, the models were fit to the BC type means, as individual recordings can be quite noisy – we added Figure 5—figure supplement 1​ to illustrate the variability and mention this in the text.</p></body></sub-article></article>