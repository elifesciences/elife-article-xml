<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">69905</article-id><article-id pub-id-type="doi">10.7554/eLife.69905</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Phase response analyses support a relaxation oscillator model of locomotor rhythm generation in <italic>Caenorhabditis elegans</italic></article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-93712"><name><surname>Ji</surname><given-names>Hongfei</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9617-6411</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-237215"><name><surname>Fouad</surname><given-names>Anthony D</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4677-2968</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-237216"><name><surname>Teng</surname><given-names>Shelly</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-252268"><name><surname>Liu</surname><given-names>Alice</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-237217"><name><surname>Alvarez-Illera</surname><given-names>Pilar</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-237218"><name><surname>Yao</surname><given-names>Bowen</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-237219"><name><surname>Li</surname><given-names>Zihao</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4304-8322</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-100720"><name><surname>Fang-Yen</surname><given-names>Christopher</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4568-3218</contrib-id><email>fangyen@seas.upenn.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Department of Bioengineering, School of Engineering and Applied Science, University of Pennsylvania</institution><addr-line><named-content content-type="city">Philadelphia</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution>Department of Neuroscience, Perelman School of Medicine, University of Pennsylvania</institution><addr-line><named-content content-type="city">Philadelphia</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="senior_editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Senior Editor</role><aff><institution>Emory University</institution><country>United States</country></aff></contrib><contrib contrib-type="editor"><name><surname>Zimmer</surname><given-names>Manuel</given-names></name><role>Reviewing Editor</role><aff><institution>University of Vienna</institution><country>Austria</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>27</day><month>09</month><year>2021</year></pub-date><pub-date pub-type="collection"><year>2021</year></pub-date><volume>10</volume><elocation-id>e69905</elocation-id><history><date date-type="received" iso-8601-date="2021-04-29"><day>29</day><month>04</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2021-09-24"><day>24</day><month>09</month><year>2021</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at bioRxiv.</event-desc><date date-type="preprint" iso-8601-date="2020-06-23"><day>23</day><month>06</month><year>2020</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2020.06.22.164939"/></event></pub-history><permissions><copyright-statement>© 2021, Ji et al</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>Ji et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-69905-v2.pdf"/><abstract><p>Neural circuits coordinate with muscles and sensory feedback to generate motor behaviors appropriate to an animal’s environment. In <italic>C. elegans,</italic> the mechanisms by which the motor circuit generates undulations and modulates them based on the environment are largely unclear. We quantitatively analyzed <italic>C. elegans</italic> locomotion during free movement and during transient optogenetic muscle inhibition. Undulatory movements were highly asymmetrical with respect to the duration of bending and unbending during each cycle. Phase response curves induced by brief optogenetic inhibition of head muscles showed gradual increases and rapid decreases as a function of phase at which the perturbation was applied. A relaxation oscillator model based on proprioceptive thresholds that switch the active muscle moment was developed and is shown to quantitatively agree with data from free movement, phase responses, and previous results for gait adaptation to mechanical loadings. Our results suggest a neuromuscular mechanism underlying <italic>C. elegans</italic> motor pattern generation within a compact circuit.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>locomotion</kwd><kwd>rhythm generation</kwd><kwd>modeling</kwd><kwd>motor circuit</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>C. elegans</italic></kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>1R01NS084835</award-id><principal-award-recipient><name><surname>Ji</surname><given-names>Hongfei</given-names></name><name><surname>Fouad</surname><given-names>Anthony D</given-names></name><name><surname>Fang-Yen</surname><given-names>Christopher</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Behavioral, optogenetic, and computational modeling analyses show that the roundworm <italic>Caenorhabditis elegans</italic> uses a relaxation oscillation mechanism to generate rhythmic locomotor patterns.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Animal display locomotor behaviors such as crawling, walking, swimming, or flying via rhythmic patterns of muscle contractions and relaxations. In many animals, motor rhythms originate from networks of central pattern generators (CPGs), neuronal circuits capable of generating rhythmic outputs without rhythmic input (<xref ref-type="bibr" rid="bib21">Cohen and Wallen, 1980</xref>; <xref ref-type="bibr" rid="bib41">Grillner, 2003</xref>; <xref ref-type="bibr" rid="bib54">Kiehn, 2011</xref>; <xref ref-type="bibr" rid="bib55">Kristan and Calabrese, 1976</xref>; <xref ref-type="bibr" rid="bib60">Marder and Calabrese, 1996</xref>; <xref ref-type="bibr" rid="bib72">Pearce and Friesen, 1984</xref>; <xref ref-type="bibr" rid="bib94">Yu et al., 1999</xref>). CPGs typically generate rhythms through reciprocal inhibitory synaptic interactions between two populations. In vertebrates, motor rhythms arise from half-center oscillator modules in the spinal cord (<xref ref-type="bibr" rid="bib60">Marder and Calabrese, 1996</xref>).</p><p>Although isolated CPGs can produce outputs in the absence of sensory input, in the intact animal sensory feedback plays a critical role in coordinating motor rhythms across the body and modulating their characteristics (<xref ref-type="bibr" rid="bib35">Friesen, 2009</xref>; <xref ref-type="bibr" rid="bib42">Grillner and Wallén, 2002</xref>; <xref ref-type="bibr" rid="bib65">Mullins et al., 2011</xref>; <xref ref-type="bibr" rid="bib73">Pearson, 2004</xref>; <xref ref-type="bibr" rid="bib88">Wen et al., 2012</xref>). Sensory feedback allows animals to adapt locomotor patterns to their surroundings (<xref ref-type="bibr" rid="bib4">Andersson et al., 1981</xref>; <xref ref-type="bibr" rid="bib12">Brodfuehrer and Friesen, 1986</xref>) and adapt to unexpected perturbations (<xref ref-type="bibr" rid="bib30">Ekeberg and Grillner, 1999</xref>). In leeches (<xref ref-type="bibr" rid="bib15">Cang et al., 2001</xref>; <xref ref-type="bibr" rid="bib16">Cang and Friesen, 2000</xref>) and <italic>Drosophila</italic> (<xref ref-type="bibr" rid="bib3">Akitake et al., 2015</xref>; <xref ref-type="bibr" rid="bib62">Mendes et al., 2013</xref>), specialized proprioceptive neurons and sensory receptors in body muscles detect sensory inputs to regulate and coordinate the centrally generated motor patterns. In limbed vertebrates, proprioceptors located in muscles, joints, and/or skin detect body movements and interact with premotor interneurons to coordinate limb movements (<xref ref-type="bibr" rid="bib73">Pearson, 2004</xref>). Sensory inputs induced by electric stimulation of receptor cells (<xref ref-type="bibr" rid="bib95">Yu and Friesen, 2004</xref>) or by mechanical perturbation of body segments (<xref ref-type="bibr" rid="bib40">Grillner et al., 1981</xref>) can entrain an animal’s motor behavior to imposed patterns, demonstrating the flexibility of motor systems in responding to feedback.</p><p>Animal movements are driven not only by active muscle contractions but also by passive mechanical forces including elastic recoil of muscles and other body structures, internal damping forces, and forces from the interaction with the external environment. Efficient locomotion in vertebrates depends on storage of elastic energy in tendons and muscles (<xref ref-type="bibr" rid="bib77">Roberts and Azizi, 2011</xref>). In insects, elasticity in the leg joint plays an important role in generating forces for walking and jumping (<xref ref-type="bibr" rid="bib2">Ache and Matheson, 2013</xref>). A comprehensive understanding of animal locomotion should therefore encompass not only neural activity, muscle activity, and sensory feedback, but also biomechanical forces within the animal’s body and between the animal and its environment (<xref ref-type="fig" rid="fig1">Figure 1A</xref>; <xref ref-type="bibr" rid="bib9">Borgmann et al., 2009</xref>; <xref ref-type="bibr" rid="bib42">Grillner and Wallén, 2002</xref>; <xref ref-type="bibr" rid="bib53">Kiehn, 1998</xref>).</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Rhythm generation in <italic>C. elegans</italic>.</title><p>(<bold>A</bold>) Motor neurons generate neuronal signals to control the activation of body wall muscles (BWM), which generates movement subject to internal and external environmental constraints. Sensory input provides feedback about body position and the environment. (<bold>B,C</bold>) Two possible models for locomotory rhythm generation in <italic>C. elegans</italic>. (<bold>B</bold>) In a reflex loop model, sensory neurons (SN) detect body postures and excite motor neurons (MN) to activate body wall muscles. (<bold>C</bold>) In a central pattern generator (CPG) model, network of motor neurons generates basic rhythmic patterns that are transmitted to body wall muscles while sensory feedback modulates the CPG rhythm. Diagrams (<bold>B-C</bold>) are adapted from Figure 1 in <xref ref-type="bibr" rid="bib59">Marder and Bucher, 2001</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-69905-fig1-v2.tif"/></fig><p>Here, we study mechanisms of locomotor rhythm generation and its modulation by sensory feedback in the nematode <italic>Caenorhabditis elegans</italic>. With its easily quantifiable behavior (<xref ref-type="bibr" rid="bib23">Croll, 1971</xref>), well-mapped nervous system (<xref ref-type="bibr" rid="bib22">Cook et al., 2019</xref>; <xref ref-type="bibr" rid="bib90">White et al., 1986</xref>), genetic manipulability (<xref ref-type="bibr" rid="bib6">Bargmann, 1998</xref>; <xref ref-type="bibr" rid="bib11">Brenner, 1974</xref>; <xref ref-type="bibr" rid="bib45">Hobert, 2003</xref>), and optical transparency, this worm is a unique model for obtaining an integrative understanding of locomotion.</p><p><italic>C. elegans</italic> forward locomotion consists of anterior-to-posterior dorsoventral undulations (<xref ref-type="bibr" rid="bib23">Croll, 1971</xref>). These movements are mediated by a neuromuscular circuit consisting of interneurons, excitatory cholinergic motor neurons, inhibitory GABAergic motor neurons, and body wall muscles. Laser ablation studies have shown that the cholinergic B-type motor neurons are required for forward locomotion (<xref ref-type="bibr" rid="bib18">Chalfie et al., 1985</xref>). The GABAergic D-type motor neurons provide dorsoventral cross-inhibition to the body wall muscles and are essential for maintaining normal wave shape and frequency during forward locomotion (<xref ref-type="bibr" rid="bib25">Deng et al., 2021</xref>; <xref ref-type="bibr" rid="bib61">McIntire et al., 1993</xref>). A set of premotor interneurons (AVB, PVC, AVA, AVD, and AVE) regulate forward and reverse movements (<xref ref-type="bibr" rid="bib19">Chalfie et al., 1988</xref>; <xref ref-type="bibr" rid="bib28">Driscoll and Kaplan, 1997</xref>; <xref ref-type="bibr" rid="bib86">Von Stetina et al., 2006</xref>). Ablation of all premotor interneurons or the D-type motor neurons does not deprive <italic>C. elegans</italic> of the ability to move forward (<xref ref-type="bibr" rid="bib18">Chalfie et al., 1985</xref>; <xref ref-type="bibr" rid="bib36">Gao et al., 2018</xref>; <xref ref-type="bibr" rid="bib52">Kawano et al., 2011</xref>), suggesting that a network consisting of excitatory motor neurons and muscles may be sufficient to generate rhythmicity. Optogenetic and lesion experiments have shown that multiple oscillators exist in the ventral nerve cord (<xref ref-type="bibr" rid="bib34">Fouad et al., 2018</xref>). However, the mechanisms that give rise to these oscillators are still poorly understood.</p><p>Proprioceptive feedback is crucial for <italic>C. elegans</italic> motor behavior. Studies have identified several neuron classes that have proprioceptive roles. The B-type motor neurons mediate proprioceptive coupling between anterior to posterior bending during forward locomotion (<xref ref-type="bibr" rid="bib88">Wen et al., 2012</xref>). The SMDD motor neurons, localized at the head, have been identified as proprioceptive regulators of head steering during locomotion (<xref ref-type="bibr" rid="bib93">Yeon et al., 2018</xref>). Both the B-type motor neurons and the SMDD head motor neurons have long asynaptic processes hypothesized to have proprioceptive function (<xref ref-type="bibr" rid="bib90">White et al., 1986</xref>) and have been suggested as candidate locomotor CPG elements (<xref ref-type="bibr" rid="bib49">Kaplan et al., 2020</xref>). In addition, two types of neurons, the DVA and PVD interneurons, have also been described as having proprioceptive roles in the regulation of worm’s body bend movement. The cell DVA has been shown to exhibit proprioceptive properties with a dependence on a mechanosensitive channel, TRP-4, which acts as a stretch receptor to regulate the body bend amplitude during locomotion (<xref ref-type="bibr" rid="bib58">Li et al., 2006</xref>). In another study, body bending was shown to induce local dendritic calcium transients in PVD and dendritic release of a neuropeptide encoded by <italic>nlp-12</italic>, which appears to regulate the amplitude of body movements (<xref ref-type="bibr" rid="bib83">Tao et al., 2019</xref>).</p><p>To experimentally probe mechanisms of rhythmic motor generation, including the role of proprioceptive feedback, we measured the phase response curve (PRC) upon transient optogenetic inhibition of the head muscles. We found that the worms displayed a biphasic, sawtooth-shaped PRC with sharp transitions from phase delay to advance.</p><p>We used these findings to develop a computational model of rhythm generation in the <italic>C. elegans</italic> motor circuit in which a relaxation-oscillation process, with switching based on proprioceptive feedback, underlies the worm’s rhythmic dorsal-ventral alternation. Computational models for <italic>C. elegans</italic> motor behavior have long been an important complement to experimental approaches, since an integrative understanding of locomotion requires consideration of neural, muscular, and mechanical degrees of freedom, and are often tractable only by modeling (<xref ref-type="bibr" rid="bib10">Boyle et al., 2012</xref>; <xref ref-type="bibr" rid="bib13">Bryden and Cohen, 2008</xref>; <xref ref-type="bibr" rid="bib26">Denham et al., 2018</xref>; <xref ref-type="bibr" rid="bib47">Izquierdo and Beer, 2018</xref>; <xref ref-type="bibr" rid="bib48">Johnson et al., 2021</xref>; <xref ref-type="bibr" rid="bib50">Karbowski et al., 2008</xref>; <xref ref-type="bibr" rid="bib56">Kunert et al., 2017</xref>; <xref ref-type="bibr" rid="bib71">Olivares et al., 2021</xref>). We sought to develop a phenomenological model to describe an overall mechanism of rhythm generation but not the detailed dynamics of specific circuit elements. We aimed to incorporate biomechanical constraints of the worm’s body and its environment (<xref ref-type="bibr" rid="bib31">Fang-Yen et al., 2010</xref>; <xref ref-type="bibr" rid="bib39">Gray and Lissmann, 1964</xref>; <xref ref-type="bibr" rid="bib87">Wallace, 1968</xref>), as well as account for how sensory feedback is incorporated. To improve predictive power, we aimed to minimize the number of free parameters used in the model. Finally, we sought to optimize and test this model with new experiments as well as with published findings.</p><p>Our model reproduces the observed PRC and describes the locomotory dynamics around optogenetic inhibitions in a manner that closely fits our experimental observations. Our model also agrees with results on gait adaptation to external load and the asymmetry in time-dependent curvature patterns of undulating worms. Our experimental findings and computational model together yield insights into how <italic>C. elegans</italic> generates rhythmic locomotion and modulates them depending on the environment.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title><italic>C. elegans</italic> forward locomotion exhibits a stable and nonsinusoidal limit cycle</title><p>To gain insight into wave generation, we first sought to examine the quantitative behavioral characteristics of worms during forward locomotion. First, we measured the undulatory dynamics of body bending by computing the time-varying curvature along the centerline of the body (<xref ref-type="bibr" rid="bib31">Fang-Yen et al., 2010</xref>; <xref ref-type="bibr" rid="bib57">Leifer et al., 2011</xref>; <xref ref-type="bibr" rid="bib74">Pierce-Shimomura et al., 2008</xref>; <xref ref-type="bibr" rid="bib88">Wen et al., 2012</xref>) from analysis of dark field image sequences of worms exhibiting forward locomotion. In order to quantitatively treat the drag between the body and its environment, we examined locomotion of worms in dextran solutions of known viscosity (see <italic>Appendix;</italic> <xref ref-type="bibr" rid="bib31">Fang-Yen et al., 2010</xref>). The normalized body coordinate is defined by the distance along the body centerline divided by the body length (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). The curvature <inline-formula><mml:math id="inf1"><mml:mi>κ</mml:mi></mml:math></inline-formula> at each point along the centerline of the body is the reciprocal of local radius of curvature (<xref ref-type="fig" rid="fig2">Figure 2A</xref>), with a positive (negative) curvature representing ventral (dorsal) bending. We further define the dimensionless or scaled curvature <inline-formula><mml:math id="inf2"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mi>κ</mml:mi><mml:mo>·</mml:mo><mml:mi>L</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf3"><mml:mi>L</mml:mi></mml:math></inline-formula> is the length of the worm. Using this metric, we quantified the worm’s forward movement by calculating scaled curvature as a function of body coordinate and time (<xref ref-type="fig" rid="fig2">Figure 2B</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Undulatory dynamics of freely moving worms.</title><p>(<bold>A</bold>) Worm undulatory dynamics are quantified by the time-varying curvature along the body. The normalized body coordinate is defined by the fractional distance along the centerline (head = 0, tail = 1). The curvature <inline-formula><mml:math id="inf4"><mml:mi>κ</mml:mi></mml:math></inline-formula> is the reciprocal of the local radius of curvature with positive and negative values representing dorsal and ventral curvature, respectively. (<bold>B</bold>) Curvature as a function of time and body coordinate during forward movement in a viscous liquid. Body bending curvature <inline-formula><mml:math id="inf5"><mml:mi>K</mml:mi></mml:math></inline-formula> is represented using the nondimensional product of <inline-formula><mml:math id="inf6"><mml:mi>κ</mml:mi></mml:math></inline-formula> and body length <inline-formula><mml:math id="inf7"><mml:mi>L</mml:mi></mml:math></inline-formula>. (<bold>C</bold>) Curvature (black) in the anterior region (average over body coordinate 0.1-0.3) and the time derivative of curvature (dashed purple). Red circles mark four representative phases (0, <inline-formula><mml:math id="inf8"><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf9"><mml:mi>π</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf10"><mml:mn>3</mml:mn><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula>). The curve is an average of 5041 locomotory cycles from 116 worms. (<bold>D</bold>) Phase portrait representation of the oscillatory dynamics of the anterior region, showing the curvature and the time derivative of the curvature parameterized by time. Images of worm correspond to the phases marked in (<bold>C</bold>). Arrow indicates clockwise movement over time. Dash-boxed region of the worm body indicates the 0.1–0.3 body coordinates. h: head; t: tail; v: ventral side; d: dorsal side. Gray curves are individual locomotory cycles from freely moving worms (10 randomly selected cycles are shown). (<italic>Inset</italic>) waveform of the scaled active muscle moment, estimated by equation <inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. Both curves were computed from the data used in (<bold>C</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-69905-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Phase portrait representations of the oscillatory bending dynamics for various body coordinates.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-69905-fig2-figsupp1-v2.tif"/></fig></fig-group><p>We used this behavioral data to generate phase portraits, geometric representations of a dynamical system’s trajectories over time (<xref ref-type="bibr" rid="bib46">Izhikevich, 2007</xref>), in which the time derivative of the curvature is plotted against the curvature. If the curvature were sinusoidal over time, as it is often modeled in slender swimmers (<xref ref-type="bibr" rid="bib31">Fang-Yen et al., 2010</xref>; <xref ref-type="bibr" rid="bib38">Gray, 1933</xref>; <xref ref-type="bibr" rid="bib43">Guo and Mahadevan, 2008</xref>; <xref ref-type="bibr" rid="bib69">Niebur and Erdös, 1991</xref>), the time derivative of curvature would also be sinusoidal, with a phase shift of <inline-formula><mml:math id="inf12"><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:math></inline-formula> radians relative to the curvature, and the resulting phase portrait would be symmetric about both the <inline-formula><mml:math id="inf13"><mml:mi>K</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf14"><mml:mi>d</mml:mi><mml:mi>K</mml:mi><mml:mo>/</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula> axes. Instead, we found that the phase portrait of the bending movement in the worm’s head region (0.1–0.3 body coordinate) during forward locomotion is in fact non-ellipsoidal and strongly asymmetric with respect to reflection across the <inline-formula><mml:math id="inf15"><mml:mi>K</mml:mi></mml:math></inline-formula> or <inline-formula><mml:math id="inf16"><mml:mi>d</mml:mi><mml:mi>K</mml:mi><mml:mo>/</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula> axes (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). Plots of both the phase portrait (<xref ref-type="fig" rid="fig2">Figure 2D</xref>) and the time dependence (<xref ref-type="fig" rid="fig2">Figure 2C</xref>) show that <inline-formula><mml:math id="inf17"><mml:mi>K</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf18"><mml:mi>d</mml:mi><mml:mi>K</mml:mi><mml:mo>/</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula> are strongly non-sinusoidal.</p><p>In addition to the head, other parts of the worm’s body also display nonsinusoidal bending movements (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). In this paper, we focus on curvature dynamics of the worm’s head region (0.1–0.3 body coordinate) where the bending amplitude is largest and the nonsinusoidal features are most prominent (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>).</p><p>We asked whether the phase portrait represents a stable cycle, that is whether the system tends to return to the cycle after fluctuations or perturbations away from it. To this end, we analyzed the recovery after brief optogenetic muscle inhibition. We used a closed-loop system for optically targeting specific parts of the worm (<xref ref-type="bibr" rid="bib34">Fouad et al., 2018</xref>; <xref ref-type="bibr" rid="bib57">Leifer et al., 2011</xref>) to apply brief pulses of laser illumination (0.1 s duration, 532 nm wavelength) to the heads of worms expressing the inhibitory opsin <italic>NpHR</italic> in body wall muscles (via the transgene <italic>Pmyo-3::NpHR</italic>). Simultaneous muscle inhibition on both sides causes <italic>C. elegans</italic> to straighten due to internal elastic forces (<xref ref-type="bibr" rid="bib31">Fang-Yen et al., 2010</xref>). Brief inhibition of the head muscles during forward locomotion was followed by a maximum degree of paralysis approximately 0.3 s after the end of the pulse, then a resumption of undulation (<xref ref-type="fig" rid="fig3">Figure 3A,B</xref>; <xref ref-type="video" rid="video1">Video 1</xref>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Analysis of phase-dependent inhibitions for head oscillation using transient optogenetic muscle inhibition.</title><p>(<bold>A</bold>) Images of a transgenic worm (<italic>Pmyo-3::NpHR</italic>) perturbed by a transient optogenetic muscle inhibition in the head during forward locomotion. Green shaded region indicates the 0.1 s laser illumination interval. h: head; t: tail; v: ventral side; d: dorsal side. (<bold>B</bold>) Effect of muscle inhibition on mean absolute curvature of the head. Black curve represents control ATR+ (no light) group (3523 measurements using 337 worms). Brown curve represents control ATR- group (2072 measurements using 116 worms). Red curve represents ATR+ group (1910 measurements using 337 worms). Green bar indicates 0.1 s light illumination interval starting at <inline-formula><mml:math id="inf19"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>. (<bold>C-E</bold>) Perturbed dynamics around light pulses occurring in the phase range <inline-formula><mml:math id="inf20"><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi/><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>6</mml:mn><mml:mo>]</mml:mo></mml:math></inline-formula>. (<bold>C</bold>) Kymogram of time-varying curvature <inline-formula><mml:math id="inf21"><mml:mi>K</mml:mi></mml:math></inline-formula> around a 0.1 s inhibition (green dashed box). (<bold>D</bold>) Mean curvature dynamics around the inhibitions (green bar, aligned at <inline-formula><mml:math id="inf22"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>) from ATR+ group (red curve, 11 trials using 4 worms) and control ATR+ (no light) group (black curve, eight trials using three worms). Gray curves are individual trials from ATR+ group (10 randomly selected trials are shown). (<bold>E</bold>) Mean phase portrait graphs around the inhibitions (green line) from ATR+ group (same trials as in D) and control group (ATR+, no light, 3998 trials using 337 worms). Gray curves are individual trials from ATR+ group. (<bold>F-H</bold>) Similar to (<bold>C-E</bold>), for phase range <inline-formula><mml:math id="inf23"><mml:mo>[</mml:mo><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mi/><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>]</mml:mo></mml:math></inline-formula>. (<bold>I-K</bold>) Similar to (<bold>C-E</bold>), for phase range <inline-formula><mml:math id="inf24"><mml:mo>[</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mi/><mml:mn>5</mml:mn><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>6</mml:mn><mml:mo>]</mml:mo></mml:math></inline-formula>. (<bold>L</bold>) PRC from optogenetic inhibition experiments (ATR+ group, 991 trials using 337 worms, each point indicating a single illumination of one worm). The curve was obtained via a moving average along the <italic>x</italic>-axis with <inline-formula><mml:math id="inf25"><mml:mn>0.16</mml:mn><mml:mi>π</mml:mi></mml:math></inline-formula> in bin width and the filled area represents 95% confidence interval within the bin. (<bold>M</bold>) A 2-dimensional histogram representation of the PRC using the same data. The histogram uses 25 bins for both dimensions, and the color indicates the number of data points within each rectangular bin.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-69905-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Normalized deviation to the normal cycle (the unperturbed oscillation) for the head oscillation of the perturbed worms.</title><p>Individual dynamics were grouped into different bins by binning their initial amplitude at <inline-formula><mml:math id="inf26"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>. In the figure, each trace represents the collective amplitude dynamics of the corresponding group. Distance <inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is defined such that <inline-formula><mml:math id="inf28"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> at the origin and <inline-formula><mml:math id="inf29"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> on the limit cycle. The legend indicates initial amplitude range of each bin and the corresponding number of individual traces within the bin.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-69905-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>The isochron map overlaid with the vector field for the worm’s head oscillation.</title><p>On the isochron map, a point on the normal cycle (black trajectory) and all other points off the normal cycle that share the same color form a manifold representing states having an equal phase (indicated by the color bar). On the vector field, an arrow represents the phase state <inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mi>K</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ξ</mml:mi><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> which determines the time derivative of the state of a trajectory. Both maps were computed from the results of experiments with <italic>Pmyo-3::NpHR</italic> worms.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-69905-fig3-figsupp2-v2.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 3.</label><caption><title>Phase response curve of <italic>Pmyo-3::NpHR</italic> worms (ATR- control group).</title><p>Curve was obtained from 414 trials of transient illuminations on head using 116 worms. Each point represents a single illumination (0.1 s duration, 532 nm wavelength) of one worm. Filled area represents 95% confidence interval.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-69905-fig3-figsupp3-v2.tif"/></fig><fig id="fig3s4" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 4.</label><caption><title>Phase response curve of <italic>Pmyo-3::NpHR</italic> worms perturbed by a 0.055 s optogenetic muscle inhibition during normal locomotion.</title><p>Curve was obtained from 150 trials of transient inhibitions of head muscles using 115 worms. Each point represents a single illumination (0.055 s duration, 532 nm wavelength) of one worm. Filled area represents 95% confidence interval.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-69905-fig3-figsupp4-v2.tif"/></fig><fig id="fig3s5" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 5.</label><caption><title>Phase response curves of <italic>Pmyo-3::NpHR</italic> worms induced by a 0.1 s optogenetic muscle inhibition, perturbed and measured at various body regions.</title><p>Anterior = 0.1-0.3; middle = 0.4-0.6; posterior = 0.6-0.8 along the worm body. (<italic>Upper</italic>) Schematics illustrating the selected spatial regions for optogenetic inhibition (Green shaded area) and phase response analysis (dashed box). (<bold>A–C</bold>) PRCs induced by muscle inhibition of the anterior region (991 trials using 337 worms), measured from (<bold>A</bold>) anterior, (<bold>B</bold>) middle, and (<bold>C</bold>) posterior regions, respectively. (<bold>D–F</bold>) PRCs induced by muscle inhibition of the middle region (687 trials using 276 worms), measured from (<bold>D</bold>) anterior, (<bold>E</bold>) middle, and (<bold>F</bold>) posterior regions, respectively. (<bold>G–I</bold>) PRCs induced by muscle inhibition of the posterior region (235 trials using 76 worms), measured from (<bold>G</bold>) anterior, (<bold>H</bold>) middle, and (<bold>I</bold>) posterior regions, respectively. For all the above plots, each point indicates a single illumination (0.1 s duration, 532 nm wavelength) of one worm. Experimental curves were obtained using a moving average along the <italic>x-</italic>axis with 0.16π in bin width. Filled area of each curve represents 95% confidence interval with respect to each bin of data points.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-69905-fig3-figsupp5-v2.tif"/></fig><fig id="fig3s6" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 6.</label><caption><title>Phase response curve of transgenic worms that express <italic>NpHR</italic> in all cholinergic neurons (<italic>Punc-17::NpHR::ECFP</italic>).</title><p>Curve was obtained from 270 trials of transient inhibitions of cholinergic neurons in the head region using 135 worms. Each point represents a single illumination (0.055 s duration, 532 nm wavelength) of one worm. Filled area represents 95% confidence interval.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-69905-fig3-figsupp6-v2.tif"/></fig><fig id="fig3s7" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 7.</label><caption><title>Phase response curve of transgenic worms that express Arch in the B-type motor neurons (<italic>Pacr-5::Arch-mCherry</italic>).</title><p>Curve was obtained from 551 trials of transient inhibitions of the B-type motor neurons in the head region using 160 worms. Each point represents a single illumination (0.055 s duration, 532 nm wavelength) of one worm. Filled area represents 95% confidence interval.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-69905-fig3-figsupp7-v2.tif"/></fig><fig id="fig3s8" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 8.</label><caption><title>Phase response curve of transgenic worms that express <italic>NpHR</italic> in the body wall muscles but lack the GABA receptor for the D-type motor neurons (<italic>Pmyo-3::NpHR; unc-49(e407)</italic>).</title><p>Curve was obtained from 259 trials of transient inhibitions of head muscles using 192 worms. Each point represents a single illumination (0.1 s duration, 532 nm wavelength) of one worm. Filled area represents 95% confidence interval.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-69905-fig3-figsupp8-v2.tif"/></fig></fig-group><media id="video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-69905-video1.mp4"><label>Video 1.</label><caption><title>Transient illumination of the anterior region of a freely moving <italic>Pmyo-3::NpHR</italic> worm.</title><p>Green-shaded region indicates timing and location of illumination.</p></caption></media><p>To quantify the recovery dynamics, we defined a normalized deviation <inline-formula><mml:math id="inf31"><mml:mi>d</mml:mi></mml:math></inline-formula> describing the state of the system relative to the phase portrait of normal oscillation (see <italic>Appendix</italic>), such that <inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> at the origin, <inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> at the limit cycle, and <inline-formula><mml:math id="inf34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> outside the limit cycle. We found that the deviation following optogenetic perturbation (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>) decays toward zero regardless of the initial deviation from the normal cycle, indicating that the worm tends to return to its normal oscillation after a perturbation. These results show that <italic>C. elegans</italic> head oscillation during forward locomotion is stable under optogenetic perturbation. The dynamics of these perturbed worms also allow us to reconstruct the phase isochrons and vector flow fields (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>) of the worm’s head oscillation, two other important aspects of an oscillator (see <italic>Appendix</italic>).</p><p>Taken together, these results show that during forward locomotion, head oscillation of a worm constitutes a stable oscillator containing a nonsinusoidal limit cycle.</p></sec><sec id="s2-2"><title>Transient optogenetic inhibition of head muscles yields a slowly rising, rapidly falling phase response curve</title><p>The phase response curve (PRC) describes the change in phase of an oscillation induced by a perturbation as a function of the phase at which the perturbation is applied, and is often used to characterize biological and nonbiological oscillators (<xref ref-type="bibr" rid="bib46">Izhikevich, 2007</xref>; <xref ref-type="bibr" rid="bib75">Pietras and Daffertshofer, 2019</xref>; <xref ref-type="bibr" rid="bib79">Schultheiss et al., 2011</xref>). We performed a phase response analysis of the worm’s locomotion upon transient optogenetic inhibitions.</p><p>Using data from 991 illuminations (each 0.1 s in duration) in 337 worms, we analyzed the animals’ recovery from transient paralysis as a function of the phase at which the illumination occurred. We define the phase such that it equals to zero at the point of maximum ventral bending (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). When inhibition occurred with phase in the interval <inline-formula><mml:math id="inf35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>6</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, the head typically straightened briefly and then continued the previous bend, resulting in a phase delay for the oscillation (<xref ref-type="fig" rid="fig3">Figure 3C–E</xref>). When inhibition occurred with phase in the interval <inline-formula><mml:math id="inf36"><mml:mo>[</mml:mo><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mi/><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>]</mml:mo></mml:math></inline-formula>, the head usually appeared to discontinue the previous bend movement, which resulted in a small phase advance (<xref ref-type="fig" rid="fig3">Figure 3F–H</xref>). When inhibition occurred with phase in the interval <inline-formula><mml:math id="inf37"><mml:mo>[</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mi/><mml:mn>5</mml:mn><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>6</mml:mn><mml:mo>]</mml:mo></mml:math></inline-formula>, the head response was similar to that within the interval <inline-formula><mml:math id="inf38"><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi/><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>6</mml:mn><mml:mo>]</mml:mo></mml:math></inline-formula>, and also resulted in a phase delay (<xref ref-type="fig" rid="fig3">Figure 3I–K</xref>).</p><p>Combining the data from all phases of inhibition yielded a sawtooth-shaped PRC with two sharp transitions from phase delay to advance as well as two relatively slow ascending transitions from phase advance to delay (<xref ref-type="fig" rid="fig3">Figure 3L,M</xref>). In control worms, which do not express <italic>NpHR</italic> in the body wall muscles (see Materials and methods), the resulting PRC shows no significant phase shift over any phases of illumination (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>). In worms perturbed with shorter pulses (0.055 s duration), we observed a similar sawtooth-shaped PRC (<xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>).</p><p>In addition to phase response analyses with perturbations to the worm’s anterior region, we conducted similar analyses for the dynamics across the body by optogenetically inhibiting body wall muscles of other regions (<xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5</xref>). We found that the sawtooth feature of PRC tends to decrease monotonically as the perturbation occurs further away from the head (<xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5A,E,I</xref>).</p><p>Next, we asked whether the sharp downward transitions in the PRC represent a continuous decrease or instead result from averaging data from a bimodal distribution. When we plotted the distribution of the same data in a 2-D representation we found that the phase shifts display a piecewise, linear increasing dependence on the phase of inhibition with two abrupt jumps occurring at <inline-formula><mml:math id="inf39"><mml:mi>ϕ</mml:mi><mml:mo>≈</mml:mo><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf40"><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:math></inline-formula>, respectively (<xref ref-type="fig" rid="fig3">Figure 3M</xref>). This result shows that the sharp decreasing transitions in PRC reflect bimodality in the data rather than continuous transitions.</p><p>In addition to examining PRCs induced by muscle inhibition, we also calculated PRCs with respect to inhibitions of cholinergic motor neurons. We performed similar experiments on transgenic worms in which the inhibitory opsin NpHR is expressed in either all cholinergic neurons (<italic>Punc-17::NpHR::ECFP</italic>) or B-type motor neurons (<italic>Pacr-5::Arch-mCherry</italic>). In both strains, we again observed sawtooth-shaped PRCs (<xref ref-type="fig" rid="fig3s6">Figure 3—figure supplements 6</xref> and <xref ref-type="fig" rid="fig3s7">7</xref>), with variations only in the magnitudes of phase shifts. These experiments show that the sawtooth-shaped feature of PRC is maintained for motor neuron inhibition, suggesting that the transient muscle and neuron inhibition interrupt the motor circuit dynamics in a similar manner.</p><p>The GABAergic D-type motor neurons provide a dorsoventral reciprocal inhibition of opposing muscles during locomotion. We asked whether the D-type motor neurons are required for the observed sawtooth shape of the PRC. We examined transgenic worms that express <italic>NpHR</italic> in the body wall muscles but have mutations <italic>unc-49(e407)</italic>, a loss-of-function mutant of GABA<sub>A</sub> receptor that is required by the D-type motor neurons (<xref ref-type="bibr" rid="bib5">Bamber et al., 1999</xref>). After performing optogenetic inhibition experiments, we found that the PRC also displays a sawtooth feature (<xref ref-type="fig" rid="fig3s8">Figure 3—figure supplement 8</xref>). This result shows that D-type motor neurons are not necessary for the motor rhythm generator to show the sawtooth-shaped PRC.</p><p>Sawtooth-shaped PRCs are observed in a number of systems with oscillatory dynamics, including the van der Pol oscillator (<xref ref-type="bibr" rid="bib17">Cestnik and Rosenblum, 2018</xref>), and may reflect a phase resetting property of an oscillator with respect to a perturbation (<xref ref-type="bibr" rid="bib46">Izhikevich, 2007</xref>; <xref ref-type="bibr" rid="bib79">Schultheiss et al., 2011</xref>). Further interpretation of the PRC results is given below.</p></sec><sec id="s2-3"><title>Worm muscles display a rapid switch-like alternation during locomotion</title><p>As a first step in interpreting and modeling our findings, we estimated the patterns of muscle activity in freely moving worms, in part by drawing on previous biomechanical analyses of nematode movement (<xref ref-type="bibr" rid="bib31">Fang-Yen et al., 2010</xref>; <xref ref-type="bibr" rid="bib39">Gray and Lissmann, 1964</xref>; <xref ref-type="bibr" rid="bib87">Wallace, 1968</xref>).</p><p>In mechanics, a moment is a measure of the ability of forces to produce bending about an axis. Body wall muscles create local dorsal or ventral bending by generating active moments across the body. In addition to the active moments from muscles, there are also passive moments generated by the worm’s internal viscoelasticity and by the forces due to the interaction of the worm with its external environment.</p><p>We estimated the output patterns of the active muscle moment that drives the head oscillations of freely moving worms immersed in viscous solutions. Following previous analyses of <italic>C. elegans</italic> locomotor biomechanics under similar external conditions (<xref ref-type="bibr" rid="bib31">Fang-Yen et al., 2010</xref>), the scaled active muscle moment can be described as a linear combination of the curvature and the time derivative of the curvature (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>; also see <italic>Methods</italic> and <italic>Appendix</italic>). We observed that in the phase portrait graph (<xref ref-type="fig" rid="fig2">Figure 2D</xref>), there are two nearly linear portions of the curve. We hypothesized that these linear portions correspond to two bouts during which the active muscle moment is nearly constant.</p><p>Using fits to the phase plot trajectory (see Materials and methods and <italic>Appendix</italic>) we estimated the waveform of the active muscle moment as a function of time (<xref ref-type="fig" rid="fig2">Figure 2D</xref> <italic>Inset</italic>). We found that the net active muscle moment alternates between two plateau regions during forward locomotion. From the slope of the steep portions on this curve, we estimated the time constant for transitions between active moments to be <inline-formula><mml:math id="inf41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mn>100</mml:mn><mml:mspace width="thinmathspace"/><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. This time constant is much smaller than the duration of each muscle moment plateau period (<inline-formula><mml:math id="inf42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>0.5</mml:mn><mml:mspace width="thinmathspace"/><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>), suggesting that the system undergoes rapid switches of muscle contractions between two saturation states.</p></sec><sec id="s2-4"><title>A relaxation oscillator model explains nonsinusoidal dynamics</title><p>We reasoned that the rapid transitions of the active muscle moment might reflect a switching mechanism in the locomotory rhythm generation system. We hypothesized that the motor system generates locomotory rhythms by switching the active moment of the muscles based on proprioceptive thresholds.</p><p>To expand further upon these ideas, we developed a quantitative model of locomotory rhythm generation. We consider the worm as a viscoelastic rod where the scaled curvature <italic>K(t)</italic> varies according to:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf43"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> describes the time scale of bending relaxation and <inline-formula><mml:math id="inf44"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is the time-varying active muscle moment scaled by the bending modulus and the body length (see detailed derivations in <italic>Appendix</italic>). We note that in a stationary state (<inline-formula><mml:math id="inf45"><mml:mi>d</mml:mi><mml:mi>K</mml:mi><mml:mo>/</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>), the curvature would be equal to the scaled active muscle moment. That is, the scaled active moment represents the static curvature that would result from a constant muscle moment.</p><p>We define a proprioceptive feedback variable <inline-formula><mml:math id="inf46"><mml:mi>P</mml:mi></mml:math></inline-formula> as a linear combination of the current curvature value and the rate of change of curvature. In our model, once this variable reaches either of two thresholds <inline-formula><mml:math id="inf47"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf48"><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4D</xref>), the active muscle moment undergoes a change of sign (<xref ref-type="fig" rid="fig4">Figure 4E</xref>), causing the head to bend toward the opposite direction (<xref ref-type="fig" rid="fig4">Figure 4B</xref>).</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Free-running dynamics of a bidirectional relaxation oscillator model.</title><p>(<bold>A</bold>) Schematic diagram of the relaxation oscillator model. In this model, sensory neurons (SN) detect the total curvature of the body segment as well as the time derivative of the curvature. The linear combination of the two values, <inline-formula><mml:math id="inf49"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, is modeled as the proprioceptive signal which is transmitted to motor neurons (MN). The motor neurons alternatingly activate dorsal or ventral body wall muscles (BWM) based on a thresholding rule: (1) if <inline-formula><mml:math id="inf50"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo>&lt;</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, the ventral body wall muscles get activated and contract while the dorsal side of muscles relax; (2) if <inline-formula><mml:math id="inf51"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, vice versa. Hence, locomotion rhythms are generated from this threshold-switch process. (<bold>B</bold>) Time-varying curvature <inline-formula><mml:math id="inf52"><mml:mi>K</mml:mi></mml:math></inline-formula> of the model oscillator. The time axis is normalized with respect to oscillatory period (same for <bold>D</bold>, <bold>E</bold>, and <bold>F</bold>). (<bold>C</bold>) Phase portrait graph of the model oscillator. Proprioceptive threshold lines (gray dashed lines) intersect with the phase portrait graph at two switch points (red circles) at which the active moment of body wall muscles is switched. (<bold>D</bold>) Time-varying proprioceptive feedback <inline-formula><mml:math id="inf53"><mml:mi>P</mml:mi></mml:math></inline-formula> received by the motor neurons. Horizontal lines denote the proprioceptive thresholds (gray dashed lines) that switch the active muscle moment at switch points (red circles, intersections between the proprioceptive feedback curve and the threshold lines). (<bold>E</bold>) Time-varying active muscle moment. Blue-dashed square wave denotes target moment (<inline-formula><mml:math id="inf54"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) that instantly switches directions at switch points. Black curve denotes the active muscle moment (<inline-formula><mml:math id="inf55"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) which follows the target moment in a delayed manner. (<bold>F</bold>) Time varying curvature in the worm’s head region from experiments (red, 5047 cycles using 116 worms) and model (black). Model curvature matches experimental curvature with an MSE ≈ 0.18. (<italic>Inset</italic>) Bar graph of <inline-formula><mml:math id="inf56"><mml:mi>U</mml:mi></mml:math></inline-formula> (time period of bending toward the ventral or dorsal directions) and <inline-formula><mml:math id="inf57"><mml:mi>D</mml:mi></mml:math></inline-formula> (time period of straightening toward a straight posture). Vertical bars are averages of fractions with respect to undulatory period <inline-formula><mml:math id="inf58"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> of <inline-formula><mml:math id="inf59"><mml:mi>U</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf60"><mml:mi>T</mml:mi></mml:math></inline-formula> (*** indicates p&lt;0.0005 using Student’s <italic>t</italic> test).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-69905-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Bell-shaped function for modeling the optogenetic muscle inhibition (<xref ref-type="disp-formula" rid="equ15">Equation A14</xref>).</title><p>The curve models the degree of paralysis due to the optogenetic muscle inhibition as a function of time. Referring to <xref ref-type="disp-formula" rid="equ15">Equation A14</xref>, the fractional variable <inline-formula><mml:math id="inf61"><mml:mi>H</mml:mi></mml:math></inline-formula> describes the reduced proportion of muscle moment when a worm reaches maximal paralysis after illumination. <inline-formula><mml:math id="inf62"><mml:mi>r</mml:mi></mml:math></inline-formula> describes the time of maximal paralysis with respect to the occurrence of illumination. <inline-formula><mml:math id="inf63"><mml:mi>p</mml:mi></mml:math></inline-formula> determines the time interval during which the paralyzing degree exceeds <inline-formula><mml:math id="inf64"><mml:mi>H</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula>. <inline-formula><mml:math id="inf65"><mml:mi>q</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf66"><mml:mi>p</mml:mi></mml:math></inline-formula> together determine the paralyzing rate.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-69905-fig4-figsupp1-v2.tif"/></fig></fig-group><p>Our model has 5 parameters: (1) <inline-formula><mml:math id="inf67"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, the bending relaxation time scale, (2) <inline-formula><mml:math id="inf68"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, the muscle switching time scale, (3) <inline-formula><mml:math id="inf69"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, the amplitude of the scaled active muscle moment, (4-5) <inline-formula><mml:math id="inf70"><mml:mi>b</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf71"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, which determine the switch threshold. The first three parameters were directly estimated from our experimental results from freely moving worms (see <italic>Appendix</italic>). Parameters <inline-formula><mml:math id="inf72"><mml:mi>b</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf73"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> were obtained using a two-round fitting procedure by fitting the model first to the freely moving dynamics (first round) and then to the experimental phase response curve (second round) (see <italic>Appendix</italic>).</p><p>With this set of parameters, we calculated the model dynamics as represented by the phase portrait (<xref ref-type="fig" rid="fig4">Figure 4C</xref>) as well as curvature waveform in one cycle period (<xref ref-type="fig" rid="fig4">Figure 4F</xref>). We found that in both cases the model result agreed with our experimental observations. Our model captures the asymmetric phase portrait trajectory shape found from our experiments (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). It also describes the asymmetry of head bending during locomotion: bending toward the ventral or dorsal directions occurs slower than straightening toward a straight posture during the locomotory cycle (<xref ref-type="fig" rid="fig4">Figure 4F</xref> <italic>Inset</italic>).</p><p>Considering the hypothesized mechanism under the biomechanical background (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>), our model provides a simple explanation for the observed bending asymmetry during locomotion. According to the model, the active muscle moment is nearly constant during each period between transitions of the muscle moment. Biomechanical analysis under this condition predicts an approximately exponential decay in curvature, which gives rise to an asymmetric feature during each half period (<xref ref-type="fig" rid="fig4">Figure 4F</xref>).</p></sec><sec id="s2-5"><title>Relaxation oscillator model reproduces responses to transient optogenetic inhibition</title><p>We performed simulations of optogenetic inhibitions in our model. To model the transient muscle paralysis, the muscle moment is modulated by a bell-shaped function of time (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>; also see <italic>Appendix</italic>) such that, upon inhibition, it decays toward zero and then recovers to its normal value, consistent with our behavioral observations (<xref ref-type="fig" rid="fig3">Figure 3B</xref>).</p><p>From simulations with different sets of model parameters, we found that the model PRCs consistently exhibited the sawtooth shape found in experiments, although differing in height and timing of the downward transitions. In addition to the model parameters <inline-formula><mml:math id="inf74"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf75"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf76"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> that had been explicitly estimated from free-moving experiments, we performed a two-round fitting procedure (see <italic>Appendix</italic>) to determine the other parameters (including <inline-formula><mml:math id="inf77"><mml:mi>b</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf78"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and parameters for describing the optogenetically induced muscle inhibitions (see <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>)) to best fit the freely moving dynamics and the experimental PRC, respectively, with a minimum mean squared error (MSE) (<xref ref-type="fig" rid="fig4">Figures 4F</xref> and <xref ref-type="fig" rid="fig5">5A</xref>; also see <italic>Appendix</italic>). For the parameters <inline-formula><mml:math id="inf79"><mml:mi>b</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf80"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, the optimization estimated their values to be <inline-formula><mml:math id="inf81"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>0.046</mml:mn><mml:mspace width="thinmathspace"/><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf82"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2.33</mml:mn></mml:math></inline-formula>, as shown on the phase portraits (gray dashed lines in <xref ref-type="fig" rid="fig4">Figures 4C</xref>, <xref ref-type="fig" rid="fig5">5B and D</xref>).</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Simulations of optogenetic inhibitions in the relaxation oscillator model.</title><p>(<bold>A</bold>) Phase response curves measured from experiments (blue, same as in <xref ref-type="fig" rid="fig3">Figure 3L</xref>) and model (orange). Model PRC matches experimental PRC with an MSE ≈ 0.12. (<bold>B,C</bold>) Simulated dynamics of locomotion showing inhibition-induced phase delays in the model oscillator. (<bold>B</bold>) Simulated phase portrait graphs around inhibition occurring at <inline-formula><mml:math id="inf83"><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>6</mml:mn></mml:math></inline-formula> phase of cycle for perturbed (red) and unperturbed (black) dynamics. Green bar indicates the phase during which the inhibition occurs. (<bold>C</bold>) Same dynamics as in (<bold>B</bold>), represented by time-varying curvatures. The time axis is normalized with respect to oscillatory period (same for <bold>E</bold>). (<bold>D,E</bold>) Simulated dynamics of locomotion showing inhibition-induced phase advances in the model oscillator. (<bold>D</bold>) Simulated phase portrait graphs around inhibition occurring at <inline-formula><mml:math id="inf84"><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula> phase of cycle for perturbed (red) and unperturbed (black) dynamics. (<bold>E</bold>) Same dynamics as in (<bold>D</bold>), represented by time-varying curvatures.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-69905-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Performance of model oscillators: threshold-switch (column 1), van der Pol (column 2), Rayleigh (column 3), and Stuart-Landau (column 4).</title><p>(<bold>A-D</bold>) Time-varying curvatures of the worm’s head region, measured from experiments (red, 5047 cycles using 116 worms) or produced by models (black). The four models match the experimental curvature with MSEs ≈ 0.18, 0.44, 0.18, and 0.39, respectively. (Inset table) <inline-formula><mml:math id="inf85"><mml:mi>U</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> (fraction of period of bending toward the ventral or dorsal directions) and <inline-formula><mml:math id="inf86"><mml:mi>D</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> (fraction of period of straightening toward a straight posture), for experiments or models, respectively. (<bold>E-H</bold>) Phase portrait graphs of the free-running dynamics shown in (<bold>A-D</bold>), measured from experiments (red) or produced by models (black). Arrow indicates clockwise movement. (<bold>I-L</bold>) Phase plots showing each model perturbed (indicated by purple arrow) away from the stable limit cycle and then recovering toward the equilibrium. (<bold>M-P</bold>) Phase response curves with respect to both-side muscle inhibition, measured from experiments (blue, 991 trials using 337 worms) or produced by models (orange). Four models match the experimental PRC with MSE ≈ 0.12, 0.21, 0.37, and 0.72, respectively.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-69905-fig5-figsupp1-v2.tif"/></fig></fig-group><p>The threshold-switch mechanism model provides an explanation for the observed sawtooth-shaped PRC. By comparing model phase portrait graphs around inhibitions occurring at different phases (<xref ref-type="fig" rid="fig5">Figure 5B–E</xref>), we found that the phase shift depends on the relative position of the inhibition with respect to the switch points on the phase plane. (1) If the effect of the inhibition occurs before the system reaches its switch point (<xref ref-type="fig" rid="fig5">Figure 5B</xref>), the system will recover by continuing the previous bend and the next switch in the muscle moment will be postponed, thereby leading to a phase delay (<xref ref-type="fig" rid="fig5">Figure 5C</xref>). (2) As the inhibition progressively approaches the switch point, one would expect that the next switch in the muscle moment will also be progressively postponed; this explains the increasing portions of the PRC. (3) If the inhibition coincides with the switch point (<xref ref-type="fig" rid="fig5">Figure 5D</xref>), the muscle moment will be switched at this point and the system will recover by aborting the previous bend tendency, resulting in a small phase advance (<xref ref-type="fig" rid="fig5">Figure 5E</xref>). This switching behavior explains the two sharp downward transitions in the PRC.</p></sec><sec id="s2-6"><title>Relaxation oscillator model predicts phase response curves for single-side muscle inhibition</title><p>As a further test of the model, we asked what PRCs would be produced with only the ventral or dorsal head muscles being transiently inhibited. In the model, the muscle activity is represented using the scaled active moment of muscles. We conducted model simulations (see <italic>Appendix</italic>) to predict the PRCs for transient inhibitions of muscles on the dorsal side (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, <italic>Upper</italic>) and ventral side (<xref ref-type="fig" rid="fig6">Figure 6B</xref>, <italic>Upper</italic>), respectively.</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>The model predicts phase response curves with respect to single-side muscle inhibitions.</title><p>(<bold>A</bold>) (<italic>Upper</italic>) a schematic indicating a transient inhibition of body wall muscles of the head on the dorsal side. (<italic>Lower</italic>) the corresponding PRC measured from experiments (blue, 576 trials using 242 worms) and model (orange). (<bold>B</bold>) (<italic>Upper</italic>) a schematic indicating a transient inhibition of body wall muscles of the head on the ventral side. (<italic>Lower</italic>) the corresponding PRC measured from experiments (blue, 373 trials using 176 worms) and model (orange). For the two experiments, each point indicates a single illumination (0.1 s duration, 532 nm wavelength) of one worm. Experimental curves were obtained using a moving average along the <italic>x</italic>-axis with <inline-formula><mml:math id="inf87"><mml:mn>0.16</mml:mn><mml:mi>π</mml:mi></mml:math></inline-formula> in bin width. Filled area of each experimental curve represents 95% confidence interval with respect to each bin of data points.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-69905-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Paralyzing effect analysis of muscle inhibitions induced by illumination on different sides of the worm’s head segment.</title><p>(<bold>A</bold>) Spectra of paralyzing effects across all phases of illuminations, represented by absolute curvature <inline-formula><mml:math id="inf88"><mml:mo>|</mml:mo><mml:mi>K</mml:mi><mml:mo>|</mml:mo></mml:math></inline-formula> of the head region. <inline-formula><mml:math id="inf89"><mml:mo>|</mml:mo><mml:mi>K</mml:mi><mml:mo>|</mml:mo></mml:math></inline-formula> shown on <italic>y</italic>-axis is the value obtained <inline-formula><mml:math id="inf90"><mml:mn>0.53</mml:mn><mml:mi>π</mml:mi></mml:math></inline-formula> later in phase (or 0.3 s in time with respect to locomotion period 1.13 s) after the illumination phase <inline-formula><mml:math id="inf91"><mml:mi>ϕ</mml:mi></mml:math></inline-formula>. The specific phase difference <inline-formula><mml:math id="inf92"><mml:mn>0.53</mml:mn><mml:mi>π</mml:mi></mml:math></inline-formula> (or 0.3 s time difference) was chosen for computing the paralyzing effects because a max paralysis is achieved at ~0.3 s after illumination as shown in <xref ref-type="fig" rid="fig3">Figure 3B</xref>. Gray curve represents control ATR+ (no light) group (414 trials using 116 worms). Red curve represents ATR+ group with only ventral side being illuminated (373 trials using 176 worms). Blue curve represents ATR+ group with only dorsal side being illuminated (576 trials using 242 worms). Black curve represents ATR+ group with both sides being illuminated (991 trials using 337 worms). All curves were obtained using a moving average along the <italic>x</italic>-axis with <inline-formula><mml:math id="inf93"><mml:mn>0.4</mml:mn><mml:mi>π</mml:mi></mml:math></inline-formula> in bin width and filled areas represent 95% confidence interval. (<bold>B</bold>) Average paralyzing effects during dorsal bend and ventral bend, represented by mean absolute curvature <inline-formula><mml:math id="inf94"><mml:mfenced close="⟩" open="⟨" separators="|"><mml:mrow><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math></inline-formula> averaged across range <inline-formula><mml:math id="inf95"><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi/><mml:mi>π</mml:mi><mml:mo>]</mml:mo></mml:math></inline-formula> (dorsal bend) and <inline-formula><mml:math id="inf96"><mml:mo>[</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi/><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>]</mml:mo></mml:math></inline-formula> (ventral bend), respectively. Colors indicate different conditions of experiment in the same way as in (<bold>A</bold>). (***) indicates p&lt;0.0005 using paired <italic>t</italic> test.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-69905-fig6-figsupp1-v2.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 2.</label><caption><title>Phase response curves with respect to single-side muscle inhibition, simulated from model oscillators: threshold-switch (column 1), van der Pol (column 2), Rayleigh (column 3), and Stuart-Landau (column 4).</title><p>(<bold>A-D</bold>) PRCs with respect to dorsal-side muscle inhibition, measured from experiments (blue, 576 trials using 242 worms) or produced by models (orange). (<bold>E-H</bold>) PRCs with respect to ventral-side muscle inhibition, measured from experiments (blue, 373 trials using 176 worms) or produced by models (orange). Filled areas of all experimental PRCs represent 95% confidence interval with respect to each bin of data points.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-69905-fig6-figsupp2-v2.tif"/></fig></fig-group><p>To experimentally perform phase response analysis of single-side muscle inhibitions, we visually distinguished each worm’s dorsoventral orientation (via vulval location) and targeted light to either the ventral or dorsal side of the animal. Transiently illuminating (0.1 s duration) dorsal or ventral muscles in the head region of the transgenic worms (<italic>Pmyo-3::NpHR</italic>) induced a brief paralyzing effect when the segment was bending toward the illuminated side but did not induce a significant paralyzing effect when the segment was bending away from the illuminated side (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>).</p><p>Combining the experimental data from all phases of dorsal-side or ventral-side inhibition yielded the corresponding PRCs (<xref ref-type="fig" rid="fig6">Figure 6A,B</xref>, respectively), from which we found that both PRCs show a peak in the phase range during which the bending side is illuminated but shows no significant phase shift in the other phase range. The experimental observations are qualitatively consistent with model predictions.</p><p>We found that the PRC of dorsal-side illumination shows a smaller paralytic response than that of ventral-side illumination. This discrepancy may be due to different degrees of paralysis achieved during ventral vs. dorsal illumination (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>), possibly due to differences in levels of opsin expression and/or membrane localization. We therefore modulated the parameter for describing degree of paralysis when simulating the PRC of the dorsal-side illumination to qualitatively account for this discrepancy (see <italic>Appendix</italic>).</p></sec><sec id="s2-7"><title>Our model is consistent with the dependence of wave amplitude and frequency on external load</title><p><italic>C. elegans</italic> can swim in water and crawl on moist surfaces, exhibiting different undulatory gaits characterized by different frequency, amplitude, and wavelength (<xref ref-type="fig" rid="fig7">Figure 7A</xref>). Previous studies <xref ref-type="bibr" rid="bib8">Berri et al., 2009</xref>; <xref ref-type="bibr" rid="bib31">Fang-Yen et al., 2010</xref> have shown that increasing viscosity of the medium induces a continuous transition from a swimming gait to a crawling gait, characterized by a decreasing undulatory frequency (<xref ref-type="fig" rid="fig7">Figure 7C</xref>) and an increasing curvature amplitude (<xref ref-type="fig" rid="fig7">Figure 7D</xref>). We asked whether our model is consistent with this load-dependent gait adaptation.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Model reproduces <italic>C.elegans</italic> gait adaptation to external viscosity.</title><p>(<bold>A</bold>) Dark field images and the corresponding undulatory frequencies and amplitudes of adult worms (<italic>left</italic>) swimming in NGM buffer of viscosity 1 mPa·s, (<italic>right</italic>) crawling on agar gel surface. The worm head is to the right in both images. (<bold>B</bold>) Phase portrait graphs measured from worm forward movements in fluids of viscosity 10 mPa·s (blue, 3528 cycles using 50 worms), 120 mPa·s (red, 5050 cycles using 116 worms), and 5400 mPa·s (yellow, 1364 cycles using 70 worms). (<bold>C,D</bold>) The model predicts the dependence of undulatory frequency (<bold>C</bold>) and curvature amplitude (<bold>D</bold>) on external viscosity (black) that closely fit the corresponding experimental observations (red). (<bold>E</bold>) Phase portrait graphs predicted from the model in three different viscosities (same values as in <bold>B</bold>). Gray dashed lines indicate threshold lines for dorsoventral bending. The intersections (red circles 1, 2, 3) between the threshold line and phase portrait graphs are switch points for undulations in low, medium, high viscosity, respectively. (<bold>F</bold>) Theoretically predicted PRCs in fluids of the three different viscosities show that PRC will be shifted to the right as the viscosity of environment increases. (<bold>G</bold>) PRCs measured from optogenetic inhibition experiments in the three viscosities. Experimental PRCs were obtained using a moving average along the <italic>x</italic>-axis with <inline-formula><mml:math id="inf97"><mml:mn>0.16</mml:mn><mml:mi>π</mml:mi></mml:math></inline-formula> in bin width and filled areas are 95% confidence interval. The tendency of shift observed in experimental PRCs verified the model prediction.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-69905-fig7-v2.tif"/></fig><p>We incorporated the effect of external viscosity into our model through the bending relaxation time constant <inline-formula><mml:math id="inf98"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (see <italic>Appendix</italic>). We ran our model to determine the dependence of model output on viscosity with varying viscosity <inline-formula><mml:math id="inf99"><mml:mi>η</mml:mi></mml:math></inline-formula>. We found that model results for frequency and amplitude dependence on viscosity of the external medium are in quantitative agreement with previous experimental results (<xref ref-type="bibr" rid="bib31">Fang-Yen et al., 2010</xref>; <xref ref-type="fig" rid="fig7">Figure 7C,D</xref>).</p><p>We sought to develop an intuitive understanding of how the model output changes with increasing viscosity. We recall that the model generates a proprioceptive feedback variable in the form <inline-formula><mml:math id="inf100"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4A</xref>), and that the active muscle moment in our model undergoes a change of sign upon the proprioceptive feedback reaching either of two thresholds, <inline-formula><mml:math id="inf101"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf102"><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. As the viscosity increases, one expects that a worm will perform a slower undulation due to the increase in external load. That is, the term <inline-formula><mml:math id="inf103"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> becomes smaller. To compensate for this effect, the worm needs to undulate with a larger curvature amplitude to maintain the same level of proprioceptive feedback.</p><p>Next, we asked how the PRC depends on external viscosity. Model simulations with three different viscosities produced PRCs with similar sawtooth shape but with sharp transitions delayed in phase as the external viscosity increases (<xref ref-type="fig" rid="fig7">Figure 7F</xref>). We also measured PRCs from optogenetic inhibition experiments in solutions of three different viscosities (<xref ref-type="fig" rid="fig7">Figure 7G</xref>). Comparing the relative locations of the transitions in PRCs between the model and the data, our prediction also quantitatively agrees with the experimental results.</p><p>These results further support the model’s description of how undulatory dynamics are modulated by the external environment.</p></sec><sec id="s2-8"><title>Evaluation of alternative oscillator models</title><p>Although our computational model agrees well with our experimental results, we asked whether other models could also explain our findings. We examined three alternative models based on well-known mathematical descriptions of oscillators (van der Pol, Rayleigh, and Stuart-Landau oscillators) and compared them with our original threshold-switch model and with our experimental data.</p><p>First, we tested the van der Pol oscillator, the first relaxation oscillator model (<xref ref-type="bibr" rid="bib85">Van der Pol, 1926</xref>) which has long been applied in modeling neuronal dynamics (<xref ref-type="bibr" rid="bib33">Fitzhugh, 1961</xref>; <xref ref-type="bibr" rid="bib67">Nagumo et al., 1962</xref>). It is based on a second-order differential equation for a harmonic oscillator with a nonlinear, displacement-dependent damping term (see <italic>Appendix</italic>). By choosing a set of appropriate parameters, we found that the free-running waveform and phase plot of the van der Pol oscillator are highly asymmetric, but in an inverted manner (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1B,F</xref>), compared with the experimental observations (<xref ref-type="fig" rid="fig2">Figure 2C,D</xref>). Transiently perturbing the system with the bell-shaped modulatory function over all phases within a cycle produced a similar sawtooth-shaped PRC as that observed experimentally (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1N</xref>). However, the perturbed system was found to recover toward its limit cycle with a much slower rate than that of the experiments (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1J</xref>). Simulations of single-side muscle inhibitions to the system produced single-sawtooth-shaped PRCs similar to those found experimentally (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2B,F</xref>).</p><p>Next, we examined the Rayleigh oscillator, another relaxation oscillator model which was originally proposed to describe self-sustained acoustic vibrations such as vibrating clarinet reeds (<xref ref-type="bibr" rid="bib76">Rayleigh, 1896</xref>). It is based on a second-order differential equation with a nonlinear, velocity-dependent damping term and it can be obtained from the van der Pol oscillator via a variable differentiation and substitution (see <italic>Appendix</italic>). From its free-running dynamics, we observed that the system exhibits a highly asymmetric waveform and phase plot that are similar to the experimental observations (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1C,G</xref>). Additionally, the Rayleigh oscillator also produces similar sawtooth-shaped PRCs with respect to transient muscle inhibitions of both sides (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1O</xref>), dorsal side (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2C</xref>), and ventral side (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2G</xref>), respectively, and system’s recovery rate after the perturbation was shown to be similar to that of the experiments (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1K</xref>).</p><p>Finally, we considered the Stuart-Landau oscillator, a commonly used model for the analysis of neuronal synchrony (<xref ref-type="bibr" rid="bib1">Acebrón et al., 2005</xref>). Its nonlinearity is based on a negative damping term which depends on the magnitude of the state variable defined in a complex domain (see <italic>Appendix</italic>). The negative damping of the system constantly neutralize the positive damping on a limit cycle, making its free-running dynamics a harmonic oscillation which shows a sinusoidal waveform (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1D,H</xref>). Moreover, PRCs with respect to transient muscle inhibitions are constant with respect to phase (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1P</xref>), contrary to the experiments.</p><p>We compared the results of our models with the experimental results. In the van der Pol oscillator, the free-running waveform displays a different asymmetry (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1B,F</xref>) compared with the experimental observations and the perturbed system was shown to recover toward its limit cycle with a much slower rate than that of the experiments (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1J</xref>). The Rayleigh oscillator reproduces a free-running waveform similar to experimental ones (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1C,G</xref>) and its recovery rate toward limit cycle upon perturbation was close to that of the experiments (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1K</xref>). However, its PRC (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1O</xref>) showed weaker agreement with the experimental PRC compared with the threshold-switch model (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1M</xref>) or the van der Pol model (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1N</xref>). Of all the models tested, the threshold-switch model showed the least mean-square error with the PRC data (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1M–P</xref>). We conclude that of these models, our threshold-switch model produced the best overall agreement with experiments.</p><p>We also found that two important experimental findings, the nonsinusoidal free-moving dynamics and the sawtooth-shaped PRCs can be achieved in our original model, the van der Pol and Rayleigh oscillators, which are all relaxation oscillators, but not in the Stuart-Landau oscillator, which is not a relaxation oscillator. Taken together, these results are consistent with the idea that a relaxation oscillation mechanism may underlie <italic>C. elegans</italic> motor rhythm generation.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In this study, we used a combination of experimental and modeling approaches to probe the mechanisms underlying the <italic>C. elegans</italic> motor rhythm generation.</p><p>Our model can be compared to those previously described for <italic>C. elegans</italic> locomotion. An early model (<xref ref-type="bibr" rid="bib69">Niebur and Erdös, 1991</xref>) assumes that a CPG located in the head initiates dorsoventral bends and that a combination of neuronal and sensory feedback mechanisms propagates the waves in the posteriorward direction. In this model, sensory feedback plays a modulatory role in producing smoother curvature waves but is not explicitly required for rhythm generation itself. Other computational models have aimed to describe how the motor circuit generates rhythmicity. Several neural models for the forward-moving circuit (<xref ref-type="bibr" rid="bib50">Karbowski et al., 2008</xref>; <xref ref-type="bibr" rid="bib71">Olivares et al., 2021</xref>) incorporating of all major neural components and connectivity have been developed. These models included a CPG in the head based on effective cross-inhibition between ventral and dorsal groups of interneurons. In contrast, <xref ref-type="bibr" rid="bib13">Bryden and Cohen, 2008</xref> developed a neural model in which each segment along the body is capable of generating oscillations. In this model, a circuit of AVB interneurons and B-type motor neurons suffices to generate robust locomotory rhythms without cross-inhibition.</p><p>Other models have examined how <italic>C. elegans</italic> adapts its undulatory wavelength, frequency, and amplitude as a gait adaptation to external load (<xref ref-type="bibr" rid="bib10">Boyle et al., 2012</xref>; <xref ref-type="bibr" rid="bib26">Denham et al., 2018</xref>; <xref ref-type="bibr" rid="bib47">Izquierdo and Beer, 2018</xref>; <xref ref-type="bibr" rid="bib48">Johnson et al., 2021</xref>). To account for these changes, these models combined the motor circuit model with additional assumptions of stretch sensitivity in motor neurons, and worm body biomechanical constraints, to create a model that reproduced the changes in undulatory wave patterns under a range of external conditions.</p><p>Previous detailed models of <italic>C. elegans</italic> locomotion have employed a relatively large number of free parameters (up to 40; <xref ref-type="bibr" rid="bib10">Boyle et al., 2012</xref>; <xref ref-type="bibr" rid="bib50">Karbowski et al., 2008</xref>). In our work, we sought to develop a compact phenomenological model to describe an overall mechanism of rhythm generation but not the detailed dynamics of specific circuit elements. To improve predictive power, we aimed to minimize the number of free parameters used in the model. Our model has only five free parameters, yet accurately describes a wide range of experimental findings including the nonsinusoidal dynamics of free locomotion, phase response curves to transient paralysis, and dependence of frequency and amplitude on external viscosity.</p><p>Our phase portrait analysis of worm’s free locomotory dynamics has described a previously undescribed methods for measuring the bending relaxation time scale <inline-formula><mml:math id="inf104"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and the muscle moment transition time scale <inline-formula><mml:math id="inf105"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (see <italic>Appendix</italic> for details), which may be compared with previous studies of worm biomechanics (<xref ref-type="bibr" rid="bib31">Fang-Yen et al., 2010</xref>; <xref ref-type="bibr" rid="bib8">Berri et al., 2009</xref>) and neurophysiology (<xref ref-type="bibr" rid="bib63">Milligan et al., 1997</xref>). <xref ref-type="bibr" rid="bib31">Fang-Yen et al., 2010</xref> measured out a linear relationship between the bending relaxation time scale and the external viscosity by deforming the worm body in Newtonian fluids with varied viscosities in the range 1–25 mPa·s. Through an extrapolation based on that linear relationship, the relaxation time scale in 17% dextran NGM fluid (approximately 120 mPa·s in viscosity) is estimated to be <inline-formula><mml:math id="inf106"><mml:mo>≈</mml:mo><mml:mn>282</mml:mn><mml:mi/><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:math></inline-formula>, which is quite close to our measured result, <inline-formula><mml:math id="inf107"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mn>260</mml:mn><mml:mi/><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:math></inline-formula>. Furthermore, our measurement of the muscle moment transition time scale (<inline-formula><mml:math id="inf108"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mn>100</mml:mn><mml:mi/><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:math></inline-formula>) is consistent with a previously measured value for muscle time scale (<xref ref-type="bibr" rid="bib63">Milligan et al., 1997</xref>) that has been widely adopted for other detailed models of nematode locomotion (<xref ref-type="bibr" rid="bib10">Boyle et al., 2012</xref>; <xref ref-type="bibr" rid="bib13">Bryden and Cohen, 2008</xref>; <xref ref-type="bibr" rid="bib14">Butler et al., 2015</xref>; <xref ref-type="bibr" rid="bib20">Chen et al., 2011</xref>; <xref ref-type="bibr" rid="bib26">Denham et al., 2018</xref>; <xref ref-type="bibr" rid="bib47">Izquierdo and Beer, 2018</xref>; <xref ref-type="bibr" rid="bib48">Johnson et al., 2021</xref>; <xref ref-type="bibr" rid="bib50">Karbowski et al., 2008</xref>; <xref ref-type="bibr" rid="bib71">Olivares et al., 2021</xref>; <xref ref-type="bibr" rid="bib88">Wen et al., 2012</xref>).</p><p>In our model, the mechanism for generating rhythmic patterns can be characterized by a ‘relaxation oscillation’ process which contains two alternating sub-processes on different time scales: a long relaxation process during which the motor system varies toward an intended state due to its biomechanics under a constant active muscle moment, alternating with a rapid period during which the active muscle moment switches to an opposite state due to a proprioceptive thresholding mechanism.</p><p>The term ‘relaxation oscillation’, as first employed by van der Pol, describes a general form of self-sustained oscillatory system with intrinsic periodic relaxation/decay features (<xref ref-type="bibr" rid="bib85">Van der Pol, 1926</xref>). The Fitzhugh-Nagumo model (<xref ref-type="bibr" rid="bib33">Fitzhugh, 1961</xref>; <xref ref-type="bibr" rid="bib67">Nagumo et al., 1962</xref>), a prototypical model of excitable neural systems, was originally derived by modifying the van der Pol relaxation oscillator equations. These and similar relaxation oscillators have been characterized in various dynamical systems in biology and neuroscience (<xref ref-type="bibr" rid="bib46">Izhikevich, 2007</xref>). For example, the dynamics exhibited from the action potentials of barnacle muscles in their oscillatory modes were found to yield ‘push-pull’ relaxation oscillation characteristics (<xref ref-type="bibr" rid="bib64">Morris and Lecar, 1981</xref>). The beating human heart was found to behave as a relaxation oscillator (<xref ref-type="bibr" rid="bib27">Der pol b, 1940</xref>). Several studies of walking behavior in stick insects (<xref ref-type="bibr" rid="bib7">Bässler, 1977</xref>; <xref ref-type="bibr" rid="bib24">Cruse, 1976</xref>; <xref ref-type="bibr" rid="bib37">Graham, 1985</xref>; <xref ref-type="bibr" rid="bib89">Wendler, 1968</xref>) proposed that the control system for rhythmic step movements constitutes a relaxation oscillator in which the transitions between leg movements is determined by proprioceptive thresholds.</p><p>Key properties shared by these relaxation oscillators are that their oscillations greatly differ from sinusoidal oscillations and that they all consist of a certain feedback loop with a ‘discharging property’. They contain a switch component that charges an integrating component until it reaches a threshold, then discharges it again (<xref ref-type="bibr" rid="bib68">Nave, 2007</xref>), then repeats. Many relaxation oscillators, including the van der Pol and Rayleigh models, exhibit sawtooth-shaped phase response curves (<xref ref-type="bibr" rid="bib27">Der pol b, 1940</xref>; also see <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). As shown in our experimental and model results, all the above properties have been revealed in the dynamics of <italic>C. elegans</italic> locomotive behavior, consistent with the idea that the worm’s rhythmic locomotion also results from a type of relaxation oscillator.</p><p>In our computational model, a proprioceptive component sensing the organism’s changes in posture is required to generate adaptive locomotory rhythms. What elements in the motor system could be providing this feedback? Previous studies have suggested that head and body motor neurons, including the SMDD head motor neurons and the B-type motor neurons, have proprioceptive capabilities (<xref ref-type="bibr" rid="bib88">Wen et al., 2012</xref>; <xref ref-type="bibr" rid="bib93">Yeon et al., 2018</xref>) and may also be involved in locomotory rhythm generation (<xref ref-type="bibr" rid="bib34">Fouad et al., 2018</xref>; <xref ref-type="bibr" rid="bib36">Gao et al., 2018</xref>; <xref ref-type="bibr" rid="bib49">Kaplan et al., 2020</xref>; <xref ref-type="bibr" rid="bib92">Xu et al., 2018</xref>). This possibility is consistent with earlier hypothesis that the long undifferentiated processes of these cholinergic neurons may function as proprioceptive sensors (<xref ref-type="bibr" rid="bib90">White et al., 1986</xref>). In particular, recent findings (<xref ref-type="bibr" rid="bib93">Yeon et al., 2018</xref>) have revealed that SMDD neurons directly sense head muscle stretch and regulate muscle contractions during oscillatory head bending movements.</p><p>In our model, the proprioceptive feedback variable depends on both the curvature and the rate of change of curvature. Many mechanoreceptors are sensitive primarily to time derivatives of mechanical strain rather than strain itself; for example, the <italic>C. elegans</italic> touch receptor cells exhibit such a dependence (<xref ref-type="bibr" rid="bib29">Eastwood et al., 2015</xref>; <xref ref-type="bibr" rid="bib70">O'Hagan et al., 2005</xref>). The ability of mechanosensors to sense the rate of change in <italic>C. elegans</italic> curvature has been proposed in an earlier study (<xref ref-type="bibr" rid="bib14">Butler et al., 2015</xref>) in which it was hypothesized that the B-type motor neurons might function as a proprioceptive component in this manner. Mechanosensors encoding a simultaneous combination of deformation and velocity have been observed in mammalian systems including rapidly-adapting (RA) and intermediate-adapting (IA) sensors in the rat dorsal root ganglia (<xref ref-type="bibr" rid="bib78">Rugiero et al., 2010</xref>). Proprioceptive feedback that involves a linear combination of muscle length and velocity was also suggested by a study of <italic>C. elegans</italic> muscle dynamics during swimming, crawling, and intermediate forms of locomotion (<xref ref-type="bibr" rid="bib14">Butler et al., 2015</xref>). In our phenomenological model, the motor neuron constituent may represent a collection of neurons involved in motor rhythm generation. Therefore, the proprioceptive function posited by our model might also arise as a collective behavior of curvature-sensing and curvature-rate-sensing neurons.</p><p>Further identification of the neuronal substrates for proprioceptive feedback may be possible through physiological studies of neuron and muscle activity using calcium or voltage indicators. Studies of the effect of targeted lesions and genetic mutations on the phase response curves will also help elucidate roles of specific neuromuscular components within locomotor rhythm generation.</p><p>In summary, our work describes the dynamics of the <italic>C. elegans</italic> locomotor system as a relaxation oscillation mechanism. Our model of rhythm generation mechanism followed from a quantitative characterization of free behavior and response to external disturbance, information closely linked to the structure of the animal’s motor system (<xref ref-type="bibr" rid="bib44">Gutkin et al., 2005</xref>; <xref ref-type="bibr" rid="bib66">Nadim et al., 2012</xref>; <xref ref-type="bibr" rid="bib79">Schultheiss et al., 2011</xref>; <xref ref-type="bibr" rid="bib80">Smeal et al., 2010</xref>). Our findings represent an important step toward an integrative understanding of how neural and muscle activity, sensory feedback control, and biomechanical constraints generate locomotion.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th valign="top">Reagent type (species) <break/>or resource</th><th valign="top">Designation</th><th valign="top">Source or reference</th><th valign="top">Identifiers</th><th valign="top">Additional information</th></tr></thead><tbody><tr><td valign="top">Strain, strain background (<italic>E. coli</italic>)</td><td valign="top">OP50</td><td valign="top">CGC</td><td valign="top">Fang-Yen Lab Strain Collection: OP50 <break/>RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/WB-STRAIN:WBStrain00041971">WB-STRAIN:WBStrain00041971</ext-link></td><td valign="top">OP50</td></tr><tr><td valign="top">Strain, strain background (<italic>C. elegans</italic>)</td><td valign="top">YX148</td><td valign="top"><xref ref-type="bibr" rid="bib34">Fouad et al., 2018</xref></td><td valign="top">Fang-Yen Lab Strain Collection: YX148</td><td valign="top"><italic>qhIs1[Pmyo-3::NpHR::eCFP; lin-15(+)]; qhIs4[Pacr-2::wCherry]</italic></td></tr><tr><td valign="top">Strain, strain background (<italic>C. elegans</italic>)</td><td valign="top">YX119</td><td valign="top"><xref ref-type="bibr" rid="bib34">Fouad et al., 2018</xref></td><td valign="top">Fang-Yen Lab Strain Collection: YX119</td><td valign="top"><italic>qhIs1[Pmyo-3::NpHR::eCFP; lin-15(+)]; unc-49(e407)</italic></td></tr><tr><td valign="top">Strain, strain background (<italic>C. elegans</italic>)</td><td valign="top">YX205</td><td valign="top"><xref ref-type="bibr" rid="bib57">Leifer et al., 2011</xref></td><td valign="top">Fang-Yen Lab Strain Collection: YX205</td><td valign="top"><italic>hpIs178[Punc-17::NpHR::eCFP; lin-15(+)]</italic></td></tr><tr><td valign="top">Strain, strain background (<italic>C. elegans</italic>)</td><td valign="top">WEN001</td><td valign="top"><xref ref-type="bibr" rid="bib34">Fouad et al., 2018</xref></td><td valign="top">Fang-Yen Lab Strain Collection: WEN001</td><td valign="top"><italic>wenIs001[Pacr-5::Arch::mCherry; lin-15(+)]</italic></td></tr></tbody></table></table-wrap><sec id="s4-1"><title>Worm strains and cultivation</title><p> <italic>C. elegans</italic> were cultivated on NGM plates with <italic>Escherichia coli</italic> strain OP50 at 20°C using standard methods (<xref ref-type="bibr" rid="bib82">Sulston and Hodgkin, 1988</xref>). Strains used and the procedures for optogenetic experiments are described in the Key resources table and <italic>Appendix.</italic> Preparation of OP50 and OP50-ATR plates were as previously described (<xref ref-type="bibr" rid="bib34">Fouad et al., 2018</xref>). All experiments were performed with young adult (&lt; 1 day) hermaphrodites synchronized by hypochlorite bleaching.</p></sec><sec id="s4-2"><title>Locomotion and phase response analyses</title><p>To perform quantitative recordings of worm behavior, we used a custom-built optogenetic targeting system as previously described (<xref ref-type="bibr" rid="bib34">Fouad et al., 2018</xref>; <xref ref-type="bibr" rid="bib57">Leifer et al., 2011</xref>). Analysis of images for worm’s body posture was performed using a previously developed custom software (<xref ref-type="bibr" rid="bib34">Fouad et al., 2018</xref>). The anterior curvature is defined as the average of the curvature over body coordinate 0.1–0.3; excluding the range from 0 to 0.1 avoided measurement of high-frequency movements of the worm’s anterior tip. Descriptions of the apparatus and image analyses are available in <italic>Appendix</italic>.</p><p>For phase response experiments, opsin-expressing worms were illuminated using a brief laser pulse (532 nm wavelength, 0.1 or 0.055 s duration, irradiance 16 mW/mm<sup>2</sup>) in the head region (0–0.25 body coordinate). A total of 10 trials with 6 s interval between successive pulses were performed for each animal. Trials in which the worms did not maintain forward locomotion were censored. To generate the phase response curve (PRC), we calculated the phase of inhibition of each trial and the resulting phase shift. Details of calculations for the averaged PRC are given in <italic>Appendix</italic>.</p><p>All the data and image analysis codes used in the manuscript are available at Dryad (archived at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5061/dryad.wwpzgmsk2">https://doi.org/10.5061/dryad.wwpzgmsk2</ext-link>).</p></sec><sec id="s4-3"><title>Computational modeling</title><p>Our primary model is based on a novel neural control mechanism incorporated with a previously described biomechanical framework (<xref ref-type="bibr" rid="bib31">Fang-Yen et al., 2010</xref>; <xref ref-type="bibr" rid="bib39">Gray and Lissmann, 1964</xref>; <xref ref-type="bibr" rid="bib87">Wallace, 1968</xref>). A proprioceptive signal is defined by a linear combination of bending curvature and rate of change of curvature. When the signal reaches a threshold, a switching command is initiated to reverse the direction of muscle moment. The worm’s curvature relaxes toward the opposite direction, and the process repeats, creating a dorsoventral alternation. Detailed descriptions of implementation and fitting procedure of this model and alternative models are available in <italic>Appendix</italic>. All codes for modeling analyses are available at Dryad (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5061/dryad.wwpzgmsk2">https://doi.org/10.5061/dryad.wwpzgmsk2</ext-link>).</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Mei Zhen and Quan Wen for providing strains. Some strains were provided by the CGC, funded by NIH Office of Research Infrastructure Programs (P40 OD010440). We thank Gal Haspel, Michael Carchidi, and Patrick McClanahan for helpful discussions. HJ, ADF, and CF-Y. were supported by the National Institutes of Health (1R01NS084835). ST was supported by an Abraham Noordergraaf Research Fellowship and a Littlejohn Fellowship.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Data curation, Software, Formal analysis, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Software, Investigation, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Investigation</p></fn><fn fn-type="con" id="con4"><p>Investigation</p></fn><fn fn-type="con" id="con5"><p>Investigation</p></fn><fn fn-type="con" id="con6"><p>Software, Investigation</p></fn><fn fn-type="con" id="con7"><p>Investigation</p></fn><fn fn-type="con" id="con8"><p>Conceptualization, Resources, Software, Supervision, Funding acquisition, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-69905-transrepform-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All data and software have been deposited to a Dryad repository (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5061/dryad.wwpzgmsk2">https://doi.org/10.5061/dryad.wwpzgmsk2</ext-link>).</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Ji</surname><given-names>H</given-names></name><name><surname>Fouad</surname><given-names>AD</given-names></name><name><surname>Teng</surname><given-names>S</given-names></name><name><surname>Liu</surname><given-names>A</given-names></name><name><surname>Alvarez-Illera</surname><given-names>P</given-names></name><name><surname>Yao</surname><given-names>B</given-names></name><name><surname>Li</surname><given-names>Z</given-names></name><name><surname>Fang-Yen</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Data from: Phase response analyses support a relaxation oscillator model of locomotor rhythm generation in Caenorhabditis elegans</data-title><source>Dryad Digital Repository</source><pub-id assigning-authority="Dryad" pub-id-type="doi">10.5061/dryad.wwpzgmsk2</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Acebrón</surname> <given-names>JA</given-names></name><name><surname>Bonilla</surname> <given-names>LL</given-names></name><name><surname>Pérez Vicente</surname> <given-names>CJ</given-names></name><name><surname>Ritort</surname> <given-names>F</given-names></name><name><surname>Spigler</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>The Kuramoto model: a simple paradigm for synchronization phenomena</article-title><source>Reviews of Modern Physics</source><volume>77</volume><fpage>137</fpage><lpage>185</lpage><pub-id pub-id-type="doi">10.1103/RevModPhys.77.137</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ache</surname> <given-names>JM</given-names></name><name><surname>Matheson</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Passive joint forces are tuned to limb use in insects and drive movements without motor activity</article-title><source>Current Biology</source><volume>23</volume><fpage>1418</fpage><lpage>1426</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2013.06.024</pub-id><pub-id pub-id-type="pmid">23871240</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Akitake</surname> <given-names>B</given-names></name><name><surname>Ren</surname> <given-names>Q</given-names></name><name><surname>Boiko</surname> <given-names>N</given-names></name><name><surname>Ni</surname> <given-names>J</given-names></name><name><surname>Sokabe</surname> <given-names>T</given-names></name><name><surname>Stockand</surname> <given-names>JD</given-names></name><name><surname>Eaton</surname> <given-names>BA</given-names></name><name><surname>Montell</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Coordination and fine motor control depend on <italic>Drosophila</italic> TRPγ</article-title><source>Nature Communications</source><volume>6</volume><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="doi">10.1038/ncomms8288</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andersson</surname> <given-names>O</given-names></name><name><surname>Forssberg</surname> <given-names>H</given-names></name><name><surname>Grillner</surname> <given-names>S</given-names></name><name><surname>Wallén</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>Peripheral feedback mechanisms acting on the central pattern generators for locomotion in fish and cat</article-title><source>Canadian Journal of Physiology and Pharmacology</source><volume>59</volume><fpage>713</fpage><lpage>726</lpage><pub-id pub-id-type="doi">10.1139/y81-108</pub-id><pub-id pub-id-type="pmid">6459152</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bamber</surname> <given-names>BA</given-names></name><name><surname>Beg</surname> <given-names>AA</given-names></name><name><surname>Twyman</surname> <given-names>RE</given-names></name><name><surname>Jorgensen</surname> <given-names>EM</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>The <italic>Caenorhabditis elegans</italic> unc-49 locus encodes multiple subunits of a heteromultimeric GABA receptor</article-title><source>The Journal of Neuroscience</source><volume>19</volume><fpage>5348</fpage><lpage>5359</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.19-13-05348.1999</pub-id><pub-id pub-id-type="pmid">10377345</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bargmann</surname> <given-names>CI</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Neurobiology of the <italic>Caenorhabditis elegans</italic> genome</article-title><source>Science</source><volume>282</volume><fpage>2028</fpage><lpage>2033</lpage><pub-id pub-id-type="doi">10.1126/science.282.5396.2028</pub-id><pub-id pub-id-type="pmid">9851919</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bässler</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="1977">1977</year><article-title>Sensory control of leg movement in the stick insect Carausius morosus</article-title><source>Biological Cybernetics</source><volume>25</volume><fpage>61</fpage><lpage>72</lpage><pub-id pub-id-type="doi">10.1007/BF00337264</pub-id><pub-id pub-id-type="pmid">836915</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berri</surname> <given-names>S</given-names></name><name><surname>Boyle</surname> <given-names>JH</given-names></name><name><surname>Tassieri</surname> <given-names>M</given-names></name><name><surname>Hope</surname> <given-names>IA</given-names></name><name><surname>Cohen</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Forward locomotion of the nematode <italic>C. elegans</italic> is achieved through modulation of a single gait</article-title><source>HFSP Journal</source><volume>3</volume><fpage>186</fpage><lpage>193</lpage><pub-id pub-id-type="doi">10.2976/1.3082260</pub-id><pub-id pub-id-type="pmid">19639043</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Borgmann</surname> <given-names>A</given-names></name><name><surname>Hooper</surname> <given-names>SL</given-names></name><name><surname>Büschges</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Sensory feedback induced by front-leg stepping entrains the activity of central pattern generators in caudal segments of the stick insect walking system</article-title><source>Journal of Neuroscience</source><volume>29</volume><fpage>2972</fpage><lpage>2983</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3155-08.2009</pub-id><pub-id pub-id-type="pmid">19261892</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boyle</surname> <given-names>JH</given-names></name><name><surname>Berri</surname> <given-names>S</given-names></name><name><surname>Cohen</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Gait modulation in <italic>C. elegans</italic>: an integrated neuromechanical model</article-title><source>Frontiers in Computational Neuroscience</source><volume>6</volume><elocation-id>10</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2012.00010</pub-id><pub-id pub-id-type="pmid">22408616</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brenner</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1974">1974</year><article-title>The genetics of <italic>Caenorhabditis elegans</italic></article-title><source>Genetics</source><volume>77</volume><fpage>71</fpage><lpage>94</lpage><pub-id pub-id-type="doi">10.1093/genetics/77.1.71</pub-id><pub-id pub-id-type="pmid">4366476</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brodfuehrer</surname> <given-names>PD</given-names></name><name><surname>Friesen</surname> <given-names>WO</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>From stimulation to undulation: a neuronal pathway for the control of swimming in the leech</article-title><source>Science</source><volume>234</volume><fpage>1002</fpage><lpage>1004</lpage><pub-id pub-id-type="doi">10.1126/science.234.4779.1002</pub-id><pub-id pub-id-type="pmid">17771340</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bryden</surname> <given-names>J</given-names></name><name><surname>Cohen</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Neural control of <italic>Caenorhabditis elegans</italic> forward locomotion: the role of sensory feedback</article-title><source>Biological Cybernetics</source><volume>98</volume><fpage>339</fpage><lpage>351</lpage><pub-id pub-id-type="doi">10.1007/s00422-008-0212-6</pub-id><pub-id pub-id-type="pmid">18350313</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Butler</surname> <given-names>VJ</given-names></name><name><surname>Branicky</surname> <given-names>R</given-names></name><name><surname>Yemini</surname> <given-names>E</given-names></name><name><surname>Liewald</surname> <given-names>JF</given-names></name><name><surname>Gottschalk</surname> <given-names>A</given-names></name><name><surname>Kerr</surname> <given-names>RA</given-names></name><name><surname>Chklovskii</surname> <given-names>DB</given-names></name><name><surname>Schafer</surname> <given-names>WR</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A consistent muscle activation strategy underlies crawling and swimming in <italic>Caenorhabditis elegans</italic></article-title><source>Journal of the Royal Society Interface</source><volume>12</volume><elocation-id>20140963</elocation-id><pub-id pub-id-type="doi">10.1098/rsif.2014.0963</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cang</surname> <given-names>J</given-names></name><name><surname>Yu</surname> <given-names>X</given-names></name><name><surname>Friesen</surname> <given-names>OW</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Sensory modification of leech swimming: interactions between ventral stretch receptors and swim-related neurons</article-title><source>Journal of Comparative Physiology A</source><volume>187</volume><fpage>569</fpage><lpage>579</lpage><pub-id pub-id-type="doi">10.1007/s003590100229</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cang</surname> <given-names>J</given-names></name><name><surname>Friesen</surname> <given-names>WO</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Sensory modification of leech swimming: rhythmic activity of ventral stretch receptors can change intersegmental phase relationships</article-title><source>The Journal of Neuroscience</source><volume>20</volume><fpage>7822</fpage><lpage>7829</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.20-20-07822.2000</pub-id><pub-id pub-id-type="pmid">11027247</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cestnik</surname> <given-names>R</given-names></name><name><surname>Rosenblum</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Inferring the phase response curve from observation of a continuously perturbed oscillator</article-title><source>Scientific Reports</source><volume>8</volume><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.1038/s41598-018-32069-y</pub-id><pub-id pub-id-type="pmid">30206301</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chalfie</surname> <given-names>M</given-names></name><name><surname>Sulston</surname> <given-names>JE</given-names></name><name><surname>White</surname> <given-names>JG</given-names></name><name><surname>Southgate</surname> <given-names>E</given-names></name><name><surname>Thomson</surname> <given-names>JN</given-names></name><name><surname>Brenner</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>The neural circuit for touch sensitivity in <italic>Caenorhabditis elegans</italic></article-title><source>The Journal of Neuroscience</source><volume>5</volume><fpage>956</fpage><lpage>964</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.05-04-00956.1985</pub-id><pub-id pub-id-type="pmid">3981252</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Chalfie</surname> <given-names>M</given-names></name><name><surname>White</surname> <given-names>J</given-names></name><name><surname>Wood</surname> <given-names>WB</given-names></name></person-group><year iso-8601-date="1988">1988</year><source>The Nematode Caenorhabditis elegans</source><publisher-loc>New York</publisher-loc><publisher-name>Cold Spring Harbor Laboratory Press</publisher-name></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname> <given-names>J</given-names></name><name><surname>Friesen</surname> <given-names>WO</given-names></name><name><surname>Iwasaki</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Mechanisms underlying rhythmic locomotion: body–fluid interaction in undulatory swimming</article-title><source>Journal of Experimental Biology</source><volume>214</volume><fpage>561</fpage><lpage>574</lpage><pub-id pub-id-type="doi">10.1242/jeb.048751</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cohen</surname> <given-names>AH</given-names></name><name><surname>Wallen</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="1980">1980</year><article-title>The neuronal correlate of locomotion in fish</article-title><source>Experimental Brain Research</source><volume>41</volume><fpage>11</fpage><lpage>18</lpage><pub-id pub-id-type="doi">10.1007/BF00236674</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cook</surname> <given-names>SJ</given-names></name><name><surname>Jarrell</surname> <given-names>TA</given-names></name><name><surname>Brittin</surname> <given-names>CA</given-names></name><name><surname>Wang</surname> <given-names>Y</given-names></name><name><surname>Bloniarz</surname> <given-names>AE</given-names></name><name><surname>Yakovlev</surname> <given-names>MA</given-names></name><name><surname>Nguyen</surname> <given-names>KCQ</given-names></name><name><surname>Tang</surname> <given-names>LT</given-names></name><name><surname>Bayer</surname> <given-names>EA</given-names></name><name><surname>Duerr</surname> <given-names>JS</given-names></name><name><surname>Bülow</surname> <given-names>HE</given-names></name><name><surname>Hobert</surname> <given-names>O</given-names></name><name><surname>Hall</surname> <given-names>DH</given-names></name><name><surname>Emmons</surname> <given-names>SW</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Whole-animal connectomes of both <italic>Caenorhabditis elegans</italic> sexes</article-title><source>Nature</source><volume>571</volume><fpage>63</fpage><lpage>71</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-1352-7</pub-id><pub-id pub-id-type="pmid">31270481</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Croll</surname> <given-names>NA</given-names></name></person-group><year iso-8601-date="1971">1971</year><article-title>The behaviour of Nematodes, their activity, senses and responses</article-title><source>The Journal of Applied Ecolog</source><volume>8</volume><elocation-id>956</elocation-id><pub-id pub-id-type="doi">10.2307/2402696</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cruse</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1976">1976</year><article-title>The control of body position in the stick insect (Carausius morosus), when walking over uneven surfaces</article-title><source>Biological Cybernetics</source><volume>24</volume><fpage>25</fpage><lpage>33</lpage><pub-id pub-id-type="doi">10.1007/BF00365591</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deng</surname> <given-names>L</given-names></name><name><surname>Denham</surname> <given-names>JE</given-names></name><name><surname>Arya</surname> <given-names>C</given-names></name><name><surname>Yuval</surname> <given-names>O</given-names></name><name><surname>Cohen</surname> <given-names>N</given-names></name><name><surname>Haspel</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Inhibition underlies fast undulatory locomotion in <italic>Caenorhabditis elegans</italic></article-title><source>Eneuro</source><volume>8</volume><elocation-id>ENEURO.0241-20.2020</elocation-id><pub-id pub-id-type="doi">10.1523/ENEURO.0241-20.2020</pub-id><pub-id pub-id-type="pmid">33361147</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Denham</surname> <given-names>JE</given-names></name><name><surname>Ranner</surname> <given-names>T</given-names></name><name><surname>Cohen</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Signatures of proprioceptive control in <italic>Caenorhabditis elegans</italic> locomotion</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>373</volume><elocation-id>20180208</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2018.0208</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Der pol b</surname> <given-names>VAN</given-names></name></person-group><year iso-8601-date="1940">1940</year><article-title>Biological rhythms considered as relaxation oscillations</article-title><source>Acta Medica Scandinavica</source><volume>103</volume><fpage>76</fpage><lpage>88</lpage><pub-id pub-id-type="doi">10.1111/j.0954-6820.1940.tb11082.x</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Driscoll</surname> <given-names>M</given-names></name><name><surname>Kaplan</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1997">1997</year><chapter-title>Mechanotransduction</chapter-title><person-group person-group-type="editor"><name><surname>Kaplan</surname> <given-names>J</given-names></name></person-group><source>C. elegans II</source><publisher-loc>New York, United States</publisher-loc><publisher-name>Cold Spring Harbor Laboratory Press</publisher-name><fpage>10</fpage><lpage>22</lpage></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eastwood</surname> <given-names>AL</given-names></name><name><surname>Sanzeni</surname> <given-names>A</given-names></name><name><surname>Petzold</surname> <given-names>BC</given-names></name><name><surname>Park</surname> <given-names>SJ</given-names></name><name><surname>Vergassola</surname> <given-names>M</given-names></name><name><surname>Pruitt</surname> <given-names>BL</given-names></name><name><surname>Goodman</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Tissue mechanics govern the rapidly adapting and symmetrical response to touch</article-title><source>PNAS</source><volume>112</volume><fpage>E6955</fpage><lpage>E6963</lpage><pub-id pub-id-type="doi">10.1073/pnas.1514138112</pub-id><pub-id pub-id-type="pmid">26627717</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ekeberg</surname> <given-names>O</given-names></name><name><surname>Grillner</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Simulations of neuromuscular control in lamprey swimming</article-title><source>Philosophical Transactions of the Royal Society of London. Series B: Biological Sciences</source><volume>354</volume><fpage>895</fpage><lpage>902</lpage><pub-id pub-id-type="doi">10.1098/rstb.1999.0441</pub-id><pub-id pub-id-type="pmid">10382223</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fang-Yen</surname> <given-names>C</given-names></name><name><surname>Wyart</surname> <given-names>M</given-names></name><name><surname>Xie</surname> <given-names>J</given-names></name><name><surname>Kawai</surname> <given-names>R</given-names></name><name><surname>Kodger</surname> <given-names>T</given-names></name><name><surname>Chen</surname> <given-names>S</given-names></name><name><surname>Wen</surname> <given-names>Q</given-names></name><name><surname>Samuel</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Biomechanical analysis of gait adaptation in the nematode <italic>Caenorhabditis elegans</italic></article-title><source>PNAS</source><volume>107</volume><fpage>20323</fpage><lpage>20328</lpage><pub-id pub-id-type="doi">10.1073/pnas.1003016107</pub-id><pub-id pub-id-type="pmid">21048086</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Fisher</surname> <given-names>NI</given-names></name><name><surname>Lewis</surname> <given-names>T</given-names></name><name><surname>Embleton</surname> <given-names>BJ</given-names></name></person-group><year iso-8601-date="1993">1993</year><source>Statistical Analysis of Spherical Data</source><publisher-name>Cambridge University Press</publisher-name><pub-id pub-id-type="doi">10.1017/CBO9780511623059</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fitzhugh</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1961">1961</year><article-title>Impulses and physiological states in theoretical models of nerve membrane</article-title><source>Biophysical Journal</source><volume>1</volume><fpage>445</fpage><lpage>466</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(61)86902-6</pub-id><pub-id pub-id-type="pmid">19431309</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fouad</surname> <given-names>AD</given-names></name><name><surname>Teng</surname> <given-names>S</given-names></name><name><surname>Mark</surname> <given-names>JR</given-names></name><name><surname>Liu</surname> <given-names>A</given-names></name><name><surname>Alvarez-Illera</surname> <given-names>P</given-names></name><name><surname>Ji</surname> <given-names>H</given-names></name><name><surname>Du</surname> <given-names>A</given-names></name><name><surname>Bhirgoo</surname> <given-names>PD</given-names></name><name><surname>Cornblath</surname> <given-names>E</given-names></name><name><surname>Guan</surname> <given-names>SA</given-names></name><name><surname>Fang-Yen</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Distributed rhythm generators underlie <italic>Caenorhabditis elegans</italic> forward locomotion</article-title><source>eLife</source><volume>7</volume><elocation-id>e29913</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.29913</pub-id><pub-id pub-id-type="pmid">29360037</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Friesen</surname> <given-names>WO</given-names></name></person-group><year iso-8601-date="2009">2009</year><chapter-title>Central pattern generators: sensory feedback</chapter-title><person-group person-group-type="editor"><name><surname>Friesen</surname> <given-names>WO</given-names></name></person-group><source>Encyclopedia of Neuroscience</source><publisher-name>Elsevier</publisher-name><fpage>701</fpage><lpage>709</lpage></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname> <given-names>S</given-names></name><name><surname>Guan</surname> <given-names>SA</given-names></name><name><surname>Fouad</surname> <given-names>AD</given-names></name><name><surname>Meng</surname> <given-names>J</given-names></name><name><surname>Kawano</surname> <given-names>T</given-names></name><name><surname>Huang</surname> <given-names>YC</given-names></name><name><surname>Li</surname> <given-names>Y</given-names></name><name><surname>Alcaire</surname> <given-names>S</given-names></name><name><surname>Hung</surname> <given-names>W</given-names></name><name><surname>Lu</surname> <given-names>Y</given-names></name><name><surname>Qi</surname> <given-names>YB</given-names></name><name><surname>Jin</surname> <given-names>Y</given-names></name><name><surname>Alkema</surname> <given-names>M</given-names></name><name><surname>Fang-Yen</surname> <given-names>C</given-names></name><name><surname>Zhen</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Excitatory motor neurons are local oscillators for backward locomotion</article-title><source>eLife</source><volume>7</volume><elocation-id>e29915</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.29915</pub-id><pub-id pub-id-type="pmid">29360035</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Graham</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="1985">1985</year><chapter-title>Pattern and control of walking in insects</chapter-title><source>Advances in Insect Physiology</source><publisher-name>Elsevier</publisher-name><fpage>31</fpage><lpage>140</lpage><pub-id pub-id-type="doi">10.1016/S0065-2806(08)60039-9</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gray</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1933">1933</year><article-title>Studies in animal locomotion: I. the movement of fish with special reference to the eel</article-title><source>Journal of Experimental Biology</source><volume>10</volume><fpage>88</fpage><lpage>104</lpage><pub-id pub-id-type="doi">10.1242/jeb.10.1.88</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gray</surname> <given-names>J</given-names></name><name><surname>Lissmann</surname> <given-names>HW</given-names></name></person-group><year iso-8601-date="1964">1964</year><article-title>The locomotion of nematodes</article-title><source>Journal of Experimental Biology</source><volume>41</volume><fpage>135</fpage><lpage>154</lpage><pub-id pub-id-type="doi">10.1242/jeb.41.1.135</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grillner</surname> <given-names>S</given-names></name><name><surname>McClellan</surname> <given-names>A</given-names></name><name><surname>Perret</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>Entrainment of the spinal pattern generators for swimming by mechano-sensitive elements in the lamprey spinal cord in vitro</article-title><source>Brain Research</source><volume>217</volume><fpage>380</fpage><lpage>386</lpage><pub-id pub-id-type="doi">10.1016/0006-8993(81)90015-9</pub-id><pub-id pub-id-type="pmid">7248795</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grillner</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>The motor infrastructure: from ion channels to neuronal networks</article-title><source>Nature Reviews Neuroscience</source><volume>4</volume><fpage>573</fpage><lpage>586</lpage><pub-id pub-id-type="doi">10.1038/nrn1137</pub-id><pub-id pub-id-type="pmid">12838332</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grillner</surname> <given-names>S</given-names></name><name><surname>Wallén</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Cellular bases of a vertebrate locomotor system-steering, intersegmental and segmental co-ordination and sensory control</article-title><source>Brain Research Reviews</source><volume>40</volume><fpage>92</fpage><lpage>106</lpage><pub-id pub-id-type="doi">10.1016/S0165-0173(02)00193-5</pub-id><pub-id pub-id-type="pmid">12589909</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname> <given-names>ZV</given-names></name><name><surname>Mahadevan</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Limbless undulatory propulsion on land</article-title><source>PNAS</source><volume>105</volume><fpage>3179</fpage><lpage>3184</lpage><pub-id pub-id-type="doi">10.1073/pnas.0705442105</pub-id><pub-id pub-id-type="pmid">18308928</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gutkin</surname> <given-names>BS</given-names></name><name><surname>Ermentrout</surname> <given-names>GB</given-names></name><name><surname>Reyes</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Phase-response curves give the responses of neurons to transient inputs</article-title><source>Journal of Neurophysiology</source><volume>94</volume><fpage>1623</fpage><lpage>1635</lpage><pub-id pub-id-type="doi">10.1152/jn.00359.2004</pub-id><pub-id pub-id-type="pmid">15829595</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hobert</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Behavioral plasticity in <italic>C. elegans</italic>: paradigms, circuits, genes</article-title><source>Journal of Neurobiology</source><volume>54</volume><fpage>203</fpage><lpage>223</lpage><pub-id pub-id-type="doi">10.1002/neu.10168</pub-id><pub-id pub-id-type="pmid">12486705</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Izhikevich</surname> <given-names>EM</given-names></name></person-group><year iso-8601-date="2007">2007</year><source>Dynamical Systems in Neuroscience</source><publisher-loc>Massachusetts, United States</publisher-loc><publisher-name>MIT Press</publisher-name></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Izquierdo</surname> <given-names>EJ</given-names></name><name><surname>Beer</surname> <given-names>RD</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>From head to tail: a neuromechanical model of forward locomotion in <italic>Caenorhabditis elegans</italic></article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>373</volume><elocation-id>20170374</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2017.0374</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname> <given-names>CL</given-names></name><name><surname>Lewis</surname> <given-names>TJ</given-names></name><name><surname>Guy</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Neuromechanical Mechanisms of Gait Adaptation in <italic>C. elegans</italic> : Relative Roles of Neural and Mechanical Coupling</article-title><source>SIAM Journal on Applied Dynamical Systems</source><volume>20</volume><fpage>1022</fpage><lpage>1052</lpage><pub-id pub-id-type="doi">10.1137/20M1346122</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaplan</surname> <given-names>HS</given-names></name><name><surname>Salazar Thula</surname> <given-names>O</given-names></name><name><surname>Khoss</surname> <given-names>N</given-names></name><name><surname>Zimmer</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Nested neuronal dynamics orchestrate a behavioral hierarchy across timescales</article-title><source>Neuron</source><volume>105</volume><fpage>562</fpage><lpage>576</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2019.10.037</pub-id><pub-id pub-id-type="pmid">31786012</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karbowski</surname> <given-names>J</given-names></name><name><surname>Schindelman</surname> <given-names>G</given-names></name><name><surname>Cronin</surname> <given-names>CJ</given-names></name><name><surname>Seah</surname> <given-names>A</given-names></name><name><surname>Sternberg</surname> <given-names>PW</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Systems level circuit model of <italic>C. elegans</italic> undulatory locomotion: mathematical modeling and molecular genetics</article-title><source>Journal of Computational Neuroscience</source><volume>24</volume><fpage>253</fpage><lpage>276</lpage><pub-id pub-id-type="doi">10.1007/s10827-007-0054-6</pub-id><pub-id pub-id-type="pmid">17768672</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Katz</surname> <given-names>DF</given-names></name><name><surname>Blake</surname> <given-names>JR</given-names></name><name><surname>Paveri-Fontana</surname> <given-names>SL</given-names></name></person-group><year iso-8601-date="1975">1975</year><article-title>On the movement of slender bodies near plane boundaries at low Reynolds number</article-title><source>Journal of Fluid Mechanics</source><volume>72</volume><fpage>529</fpage><lpage>540</lpage><pub-id pub-id-type="doi">10.1017/S0022112075003126</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kawano</surname> <given-names>T</given-names></name><name><surname>Po</surname> <given-names>MD</given-names></name><name><surname>Gao</surname> <given-names>S</given-names></name><name><surname>Leung</surname> <given-names>G</given-names></name><name><surname>Ryu</surname> <given-names>WS</given-names></name><name><surname>Zhen</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>An imbalancing act: gap junctions reduce the backward motor circuit activity to Bias <italic>C. elegans</italic> for forward locomotion</article-title><source>Neuron</source><volume>72</volume><fpage>572</fpage><lpage>586</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.09.005</pub-id><pub-id pub-id-type="pmid">22099460</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Kiehn</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="1998">1998</year><source>Neuronal Mechanisms for Generating Locomotor Activity</source><publisher-loc>New York, United States</publisher-loc><publisher-name>New York Academy of Sciences</publisher-name></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kiehn</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Development and functional organization of spinal locomotor circuits</article-title><source>Current Opinion in Neurobiology</source><volume>21</volume><fpage>100</fpage><lpage>109</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2010.09.004</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kristan</surname> <given-names>WB</given-names></name><name><surname>Calabrese</surname> <given-names>RL</given-names></name></person-group><year iso-8601-date="1976">1976</year><article-title>Rhythmic swimming activity in neurones of the isolated nerve cord of the leech</article-title><source>Journal of Experimental Biology</source><volume>65</volume><fpage>643</fpage><lpage>668</lpage><pub-id pub-id-type="doi">10.1242/jeb.65.3.643</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kunert</surname> <given-names>JM</given-names></name><name><surname>Proctor</surname> <given-names>JL</given-names></name><name><surname>Brunton</surname> <given-names>SL</given-names></name><name><surname>Kutz</surname> <given-names>JN</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Spatiotemporal feedback and network structure drive and encode <italic>Caenorhabditis elegans</italic> locomotion</article-title><source>PLOS Computational Biology</source><volume>13</volume><elocation-id>e1005303</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005303</pub-id><pub-id pub-id-type="pmid">28076347</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leifer</surname> <given-names>AM</given-names></name><name><surname>Fang-Yen</surname> <given-names>C</given-names></name><name><surname>Gershow</surname> <given-names>M</given-names></name><name><surname>Alkema</surname> <given-names>MJ</given-names></name><name><surname>Samuel</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Optogenetic manipulation of neural activity in freely moving <italic>Caenorhabditis elegans</italic></article-title><source>Nature Methods</source><volume>8</volume><fpage>147</fpage><lpage>152</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1554</pub-id><pub-id pub-id-type="pmid">21240279</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname> <given-names>W</given-names></name><name><surname>Feng</surname> <given-names>Z</given-names></name><name><surname>Sternberg</surname> <given-names>PW</given-names></name><name><surname>Xu</surname> <given-names>XZ</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>A <italic>C. elegans</italic> stretch receptor neuron revealed by a mechanosensitive TRP channel homologue</article-title><source>Nature</source><volume>440</volume><fpage>684</fpage><lpage>687</lpage><pub-id pub-id-type="doi">10.1038/nature04538</pub-id><pub-id pub-id-type="pmid">16572173</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marder</surname> <given-names>E</given-names></name><name><surname>Bucher</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Central pattern generators and the control of rhythmic movements</article-title><source>Current Biology</source><volume>11</volume><fpage>R986</fpage><lpage>R996</lpage><pub-id pub-id-type="doi">10.1016/S0960-9822(01)00581-4</pub-id><pub-id pub-id-type="pmid">11728329</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marder</surname> <given-names>E</given-names></name><name><surname>Calabrese</surname> <given-names>RL</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Principles of rhythmic motor pattern generation</article-title><source>Physiological Reviews</source><volume>76</volume><fpage>687</fpage><lpage>717</lpage><pub-id pub-id-type="doi">10.1152/physrev.1996.76.3.687</pub-id><pub-id pub-id-type="pmid">8757786</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McIntire</surname> <given-names>SL</given-names></name><name><surname>Jorgensen</surname> <given-names>E</given-names></name><name><surname>Kaplan</surname> <given-names>J</given-names></name><name><surname>Horvitz</surname> <given-names>HR</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>The GABAergic nervous system of <italic>Caenorhabditis elegans</italic></article-title><source>Nature</source><volume>364</volume><fpage>337</fpage><lpage>341</lpage><pub-id pub-id-type="doi">10.1038/364337a0</pub-id><pub-id pub-id-type="pmid">8332191</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mendes</surname> <given-names>CS</given-names></name><name><surname>Bartos</surname> <given-names>I</given-names></name><name><surname>Akay</surname> <given-names>T</given-names></name><name><surname>Márka</surname> <given-names>S</given-names></name><name><surname>Mann</surname> <given-names>RS</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Quantification of gait parameters in freely walking wild type and sensory deprived <italic>Drosophila melanogaster</italic></article-title><source>eLife</source><volume>2</volume><elocation-id>e00231</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.00231</pub-id><pub-id pub-id-type="pmid">23326642</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Milligan</surname> <given-names>B</given-names></name><name><surname>Curtin</surname> <given-names>N</given-names></name><name><surname>Bone</surname> <given-names>Q</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Contractile properties of obliquely striated muscle from the mantle of squid (Alloteuthis subulata) and cuttlefish (Sepia officinalis)</article-title><source>Journal of Experimental Biology</source><volume>200</volume><fpage>2425</fpage><lpage>2436</lpage><pub-id pub-id-type="doi">10.1242/jeb.200.18.2425</pub-id><pub-id pub-id-type="pmid">9320349</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morris</surname> <given-names>C</given-names></name><name><surname>Lecar</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>Voltage oscillations in the barnacle giant muscle fiber</article-title><source>Biophysical Journal</source><volume>35</volume><fpage>193</fpage><lpage>213</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(81)84782-0</pub-id><pub-id pub-id-type="pmid">7260316</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mullins</surname> <given-names>OJ</given-names></name><name><surname>Hackett</surname> <given-names>JT</given-names></name><name><surname>Buchanan</surname> <given-names>JT</given-names></name><name><surname>Friesen</surname> <given-names>WO</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Neuronal control of swimming behavior: comparison of vertebrate and invertebrate model systems</article-title><source>Progress in Neurobiology</source><volume>93</volume><fpage>244</fpage><lpage>269</lpage><pub-id pub-id-type="doi">10.1016/j.pneurobio.2010.11.001</pub-id><pub-id pub-id-type="pmid">21093529</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Nadim</surname> <given-names>F</given-names></name><name><surname>Zhao</surname> <given-names>S</given-names></name><name><surname>Bose</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2012">2012</year><chapter-title>A PRC Description of How Inhibitory Feedback Promotes Oscillation stability</chapter-title><person-group person-group-type="editor"><name><surname>Bose</surname> <given-names>A</given-names></name></person-group><source>Phase Response Curves in Neuroscience</source><publisher-name>Springer</publisher-name><fpage>399</fpage><lpage>417</lpage><pub-id pub-id-type="doi">10.1007/978-1-4614-0739-3_16</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nagumo</surname> <given-names>J</given-names></name><name><surname>Arimoto</surname> <given-names>S</given-names></name><name><surname>Yoshizawa</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1962">1962</year><article-title>An active pulse transmission line simulating nerve axon</article-title><source>Proceedings of the IRE</source><volume>50</volume><fpage>2061</fpage><lpage>2070</lpage><pub-id pub-id-type="doi">10.1109/JRPROC.1962.288235</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="report"><person-group person-group-type="author"><name><surname>Nave</surname> <given-names>CR</given-names></name></person-group><year iso-8601-date="2007">2007</year><source>Hyperphysics</source><publisher-name>Georgia State University</publisher-name><ext-link ext-link-type="uri" xlink:href="http://hyperphysics.phy-astr.gsu.edu/hbase/hph.html">http://hyperphysics.phy-astr.gsu.edu/hbase/hph.html</ext-link></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Niebur</surname> <given-names>E</given-names></name><name><surname>Erdös</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Theory of the locomotion of Nematodes: dynamics of undulatory progression on a surface</article-title><source>Biophysical Journal</source><volume>60</volume><fpage>1132</fpage><lpage>1146</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(91)82149-X</pub-id><pub-id pub-id-type="pmid">19431807</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Hagan</surname> <given-names>R</given-names></name><name><surname>Chalfie</surname> <given-names>M</given-names></name><name><surname>Goodman</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>The MEC-4 DEG/ENaC channel of <italic>Caenorhabditis elegans</italic> touch receptor neurons transduces mechanical signals</article-title><source>Nature Neuroscience</source><volume>8</volume><fpage>43</fpage><lpage>50</lpage><pub-id pub-id-type="doi">10.1038/nn1362</pub-id><pub-id pub-id-type="pmid">15580270</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olivares</surname> <given-names>E</given-names></name><name><surname>Izquierdo</surname> <given-names>EJ</given-names></name><name><surname>Beer</surname> <given-names>RD</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A neuromechanical model of multiple network rhythmic pattern generators for forward locomotion in <italic>C. elegans</italic></article-title><source>Frontiers in Computational Neuroscience</source><volume>15</volume><elocation-id>10</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2021.572339</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pearce</surname> <given-names>RA</given-names></name><name><surname>Friesen</surname> <given-names>WO</given-names></name></person-group><year iso-8601-date="1984">1984</year><article-title>Intersegmental coordination of leech swimming: comparison of in situ and isolated nerve cord activity with body wall movement</article-title><source>Brain Research</source><volume>299</volume><fpage>363</fpage><lpage>366</lpage><pub-id pub-id-type="doi">10.1016/0006-8993(84)90720-0</pub-id><pub-id pub-id-type="pmid">6733455</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Pearson</surname> <given-names>KG</given-names></name></person-group><year iso-8601-date="2004">2004</year><source>Generating the Walking Gait: Role of Sensory feedbackProgress in Brain Research</source><publisher-loc>Amsterdam, Netherlands</publisher-loc><publisher-name>Elsevier</publisher-name><pub-id pub-id-type="doi">10.1016/S0079-6123(03)43012-4</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pierce-Shimomura</surname> <given-names>JT</given-names></name><name><surname>Chen</surname> <given-names>BL</given-names></name><name><surname>Mun</surname> <given-names>JJ</given-names></name><name><surname>Ho</surname> <given-names>R</given-names></name><name><surname>Sarkis</surname> <given-names>R</given-names></name><name><surname>McIntire</surname> <given-names>SL</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Genetic analysis of crawling and swimming locomotory patterns in <italic>C. elegans</italic></article-title><source>PNAS</source><volume>105</volume><fpage>20982</fpage><lpage>20987</lpage><pub-id pub-id-type="doi">10.1073/pnas.0810359105</pub-id><pub-id pub-id-type="pmid">19074276</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pietras</surname> <given-names>B</given-names></name><name><surname>Daffertshofer</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Network dynamics of coupled oscillators and phase reduction techniques</article-title><source>Physics Reports</source><volume>819</volume><fpage>1</fpage><lpage>105</lpage><pub-id pub-id-type="doi">10.1016/j.physrep.2019.06.001</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Rayleigh</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1896">1896</year><source>The Theory of Sound</source><publisher-loc>London</publisher-loc><publisher-name>Macmillan</publisher-name></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roberts</surname> <given-names>TJ</given-names></name><name><surname>Azizi</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Flexible mechanisms: the diverse roles of biological springs in vertebrate movement</article-title><source>Journal of Experimental Biology</source><volume>214</volume><fpage>353</fpage><lpage>361</lpage><pub-id pub-id-type="doi">10.1242/jeb.038588</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rugiero</surname> <given-names>F</given-names></name><name><surname>Drew</surname> <given-names>LJ</given-names></name><name><surname>Wood</surname> <given-names>JN</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Kinetic properties of mechanically activated currents in spinal sensory neurons</article-title><source>The Journal of Physiology</source><volume>588</volume><fpage>301</fpage><lpage>314</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.2009.182360</pub-id><pub-id pub-id-type="pmid">19948656</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Schultheiss</surname> <given-names>NW</given-names></name><name><surname>Prinz</surname> <given-names>AA</given-names></name><name><surname>Butera</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><source>Phase Response Curves in Neuroscience</source><publisher-loc>Berlin, Germany</publisher-loc><publisher-name>Springer</publisher-name><pub-id pub-id-type="doi">10.1007/978-1-4614-0739-3</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smeal</surname> <given-names>RM</given-names></name><name><surname>Ermentrout</surname> <given-names>GB</given-names></name><name><surname>White</surname> <given-names>JA</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Phase-response curves and synchronized neural networks</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>365</volume><fpage>2407</fpage><lpage>2422</lpage><pub-id pub-id-type="doi">10.1098/rstb.2009.0292</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stiernagle</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Maintenance of C. elegans</article-title><source>WormBook</source><volume>11</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1895/wormbook.1.101.1</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sulston</surname> <given-names>J</given-names></name><name><surname>Hodgkin</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1988">1988</year><source>The Nematode Caenorhabditis Elegans</source><publisher-name>CSHL Press</publisher-name></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tao</surname> <given-names>L</given-names></name><name><surname>Porto</surname> <given-names>D</given-names></name><name><surname>Li</surname> <given-names>Z</given-names></name><name><surname>Fechner</surname> <given-names>S</given-names></name><name><surname>Lee</surname> <given-names>SA</given-names></name><name><surname>Goodman</surname> <given-names>MB</given-names></name><name><surname>Xu</surname> <given-names>XZS</given-names></name><name><surname>Lu</surname> <given-names>H</given-names></name><name><surname>Shen</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Parallel processing of two mechanosensory modalities by a single neuron in <italic>C. elegans</italic></article-title><source>Developmental Cell</source><volume>51</volume><fpage>617</fpage><lpage>631</lpage><pub-id pub-id-type="doi">10.1016/j.devcel.2019.10.008</pub-id><pub-id pub-id-type="pmid">31735664</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ugray</surname> <given-names>Z</given-names></name><name><surname>Lasdon</surname> <given-names>L</given-names></name><name><surname>Plummer</surname> <given-names>J</given-names></name><name><surname>Glover</surname> <given-names>F</given-names></name><name><surname>Kelly</surname> <given-names>J</given-names></name><name><surname>Martí</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Scatter search and local NLP solvers: a multistart framework for global optimization</article-title><source>INFORMS Journal on Computing</source><volume>19</volume><fpage>328</fpage><lpage>340</lpage><pub-id pub-id-type="doi">10.1287/ijoc.1060.0175</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van der Pol</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="1926">1926</year><article-title>Lxxxviii.on “relaxation-oscillations”</article-title><source>The London, Edinburgh, and Dublin Philosophical Magazine and Journal of Science</source><volume>2</volume><fpage>978</fpage><lpage>992</lpage><pub-id pub-id-type="doi">10.1080/14786442608564127</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Von Stetina</surname> <given-names>SE</given-names></name><name><surname>Treinin</surname> <given-names>M</given-names></name><name><surname>Miller</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The motor circuit</article-title><source>International Review of Neurobiology</source><volume>69</volume><fpage>125</fpage><lpage>167</lpage><pub-id pub-id-type="doi">10.1016/S0074-7742(05)69005-8</pub-id><pub-id pub-id-type="pmid">16492464</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wallace</surname> <given-names>HR</given-names></name></person-group><year iso-8601-date="1968">1968</year><article-title>The dynamics of nematode movement</article-title><source>Annual Review of Phytopathology</source><volume>6</volume><fpage>91</fpage><lpage>114</lpage><pub-id pub-id-type="doi">10.1146/annurev.py.06.090168.000515</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wen</surname> <given-names>Q</given-names></name><name><surname>Po</surname> <given-names>MD</given-names></name><name><surname>Hulme</surname> <given-names>E</given-names></name><name><surname>Chen</surname> <given-names>S</given-names></name><name><surname>Liu</surname> <given-names>X</given-names></name><name><surname>Kwok</surname> <given-names>SW</given-names></name><name><surname>Gershow</surname> <given-names>M</given-names></name><name><surname>Leifer</surname> <given-names>AM</given-names></name><name><surname>Butler</surname> <given-names>V</given-names></name><name><surname>Fang-Yen</surname> <given-names>C</given-names></name><name><surname>Kawano</surname> <given-names>T</given-names></name><name><surname>Schafer</surname> <given-names>WR</given-names></name><name><surname>Whitesides</surname> <given-names>G</given-names></name><name><surname>Wyart</surname> <given-names>M</given-names></name><name><surname>Chklovskii</surname> <given-names>DB</given-names></name><name><surname>Zhen</surname> <given-names>M</given-names></name><name><surname>Samuel</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Proprioceptive coupling within motor neurons drives <italic>C. elegans</italic> forward locomotion</article-title><source>Neuron</source><volume>76</volume><fpage>750</fpage><lpage>761</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.08.039</pub-id><pub-id pub-id-type="pmid">23177960</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wendler</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="1968">1968</year><article-title>Ein Analogmodell Der Beinbewegungen Eines laufenden insekts</article-title><source>Kybernetik</source><volume>18</volume><fpage>68</fpage><lpage>74</lpage></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>White</surname> <given-names>JG</given-names></name><name><surname>Southgate</surname> <given-names>E</given-names></name><name><surname>Thomson</surname> <given-names>JN</given-names></name><name><surname>Brenner</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>The structure of the nervous system of the nematode <italic>Caenorhabditis elegans</italic></article-title><source>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</source><volume>314</volume><fpage>1</fpage><lpage>340</lpage><pub-id pub-id-type="doi">10.1098/rstb.1986.0056</pub-id><pub-id pub-id-type="pmid">22462104</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Winfree</surname> <given-names>AT</given-names></name></person-group><year iso-8601-date="2001">2001</year><source>The Geometry of Biological Time</source><publisher-name>Springer Science &amp; Business Media</publisher-name></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname> <given-names>T</given-names></name><name><surname>Huo</surname> <given-names>J</given-names></name><name><surname>Shao</surname> <given-names>S</given-names></name><name><surname>Po</surname> <given-names>M</given-names></name><name><surname>Kawano</surname> <given-names>T</given-names></name><name><surname>Lu</surname> <given-names>Y</given-names></name><name><surname>Wu</surname> <given-names>M</given-names></name><name><surname>Zhen</surname> <given-names>M</given-names></name><name><surname>Wen</surname> <given-names>Q</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Descending pathway facilitates undulatory wave propagation in <italic>Caenorhabditis elegans</italic> through gap junctions</article-title><source>PNAS</source><volume>115</volume><fpage>E4493</fpage><lpage>E4502</lpage><pub-id pub-id-type="doi">10.1073/pnas.1717022115</pub-id><pub-id pub-id-type="pmid">29686107</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yeon</surname> <given-names>J</given-names></name><name><surname>Kim</surname> <given-names>J</given-names></name><name><surname>Kim</surname> <given-names>DY</given-names></name><name><surname>Kim</surname> <given-names>H</given-names></name><name><surname>Kim</surname> <given-names>J</given-names></name><name><surname>Du</surname> <given-names>EJ</given-names></name><name><surname>Kang</surname> <given-names>K</given-names></name><name><surname>Lim</surname> <given-names>HH</given-names></name><name><surname>Moon</surname> <given-names>D</given-names></name><name><surname>Kim</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A sensory-motor neuron type mediates proprioceptive coordination of steering in <italic>C. elegans</italic> via two TRPC channels</article-title><source>PLOS Biology</source><volume>16</volume><elocation-id>e2004929</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.2004929</pub-id><pub-id pub-id-type="pmid">29883446</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname> <given-names>X</given-names></name><name><surname>Nguyen</surname> <given-names>B</given-names></name><name><surname>Friesen</surname> <given-names>WO</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Sensory feedback can coordinate the swimming activity of the leech</article-title><source>The Journal of Neuroscience</source><volume>19</volume><fpage>4634</fpage><lpage>4643</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.19-11-04634.1999</pub-id><pub-id pub-id-type="pmid">10341261</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname> <given-names>X</given-names></name><name><surname>Friesen</surname> <given-names>WO</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Entrainment of leech swimming activity by the ventral stretch receptor</article-title><source>Journal of Comparative Physiology A</source><volume>190</volume><fpage>939</fpage><lpage>949</lpage><pub-id pub-id-type="doi">10.1007/s00359-004-0549-9</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><sec id="s8" sec-type="appendix"><title>Strains and plates preparations</title><p>Transgenic strains used in this study are listed as follows: YX148 <italic>qhIs1[Pmyo-3::NpHR::eCFP;lin-15(+)];qhIs4[Pacr-2::wCherry],</italic> YX119 <italic>unc-49(e407);qhIs1[Pmyo-3::NpHR::eCFP;lin-15(+)],</italic> YX205 <italic>hpIs178[Punc-17::NpHR::eCFP;lin-15(+)],</italic> WEN001 <italic>wenIs001[Pacr-5::Arch::mCherry;lin-15(+)].</italic></p><p>For optogenetic experiments, worms were cultivated in darkness on plates with OP50 containing the cofactor all-<italic>trans</italic> retinal (ATR). For control experiments and free-moving experiments, worms were cultivated on regular OP50 NGM plates without ATR. To make OP50-ATR plates, we added 2 µL of a 100 mM solution of ATR in ethanol to an overnight culture of 250 µL OP50 in LB medium and used this mixture to seed 6 cm NGM plates.</p></sec><sec id="s9" sec-type="appendix"><title>Locomotion analysis</title><p>To analyze worm locomotion in viscous fluids, we placed worms in dextran solutions in chambers formed by a glass slide and a coverslip separated by 125-µm-thick polyester shims (McMaster-Carr 9513K42). For viscosity-dependence experiments, we used 5%, 17%, and 35% (by mass) solutions of dextran (Sigma-Aldrich D5376, average molecular weight 1,500,000–2,800,000) in NGMB. These solutions were measured to have viscosities of 10, 120, and 5400 mPa·s (<xref ref-type="bibr" rid="bib31">Fang-Yen et al., 2010</xref>), respectively. We used a 17% dextran solution for all other experiments. NGMB consists of the same components as NGM media (<xref ref-type="bibr" rid="bib81">Stiernagle, 2006</xref>), but without agar, peptone, or cholesterol.</p><p>We recorded image sequences using a custom-built optogenetic targeting system based on a Leica DMI4000B microscope under 10X magnification with dark field illumination provided by red LEDs. Worm images were recorded at 40 Hz with an sCMOS camera (Photometrics optiMOS). We used a custom-written C++ software (<xref ref-type="bibr" rid="bib34">Fouad et al., 2018</xref>) to perform real-time segmentation of the worm during image acquisition. The worm was identified in each image by its boundary and centerline calculated from a binary image. Anterior-posterior orientation was noted visually during the recording. Segmentation information, including coordinates of the worm boundary and centerline, was saved to disk along with the corresponding image sequences.</p><p>Post-acquisition image analysis was performed using a custom MATLAB (Mathworks) similar to previous reports (<xref ref-type="bibr" rid="bib34">Fouad et al., 2018</xref>). The worm centerline of each image was smoothed using a cubic spline fit. We calculated curvature <inline-formula><mml:math id="inf109"><mml:mi>κ</mml:mi></mml:math></inline-formula> as the dot product between the unit normal vector to the centerline and derivative of the unit tangent vector to the centerline with respect to the body coordinate. Dimensionless curvature <inline-formula><mml:math id="inf110"><mml:mi>K</mml:mi></mml:math></inline-formula> was calculated as the product of <inline-formula><mml:math id="inf111"><mml:mi>κ</mml:mi></mml:math></inline-formula> and the worm body length <inline-formula><mml:math id="inf112"><mml:mi>L</mml:mi></mml:math></inline-formula> represented by length of the centerline. Since the segmentation was relatively noisy at the tips of the worm, we excluded curvature in the anterior and posterior 5% of the body length. The worm’s direction of motion was identified by calculating the gradients in the curvature over time and body coordinate, and image sequences in which the worm performed consistent forward movement (lasting at least 4 s) were selected for analysis. The anterior curvature <inline-formula><mml:math id="inf113"><mml:mi>K</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> was defined as the average of the dimensionless curvature over body coordinate 0.1-0.3; this range avoided high-frequency movements of the anterior tip of the animal.</p><p>To quantify oscillatory dynamics during forward locomotion, we identified undulatory cycles from the time sequence of anterior curvature in each worm. Local extrema along each sequence were identified and portions between consecutive local maxima were defined as individual cycles. To minimize the effects of changes in the worm’s frequency, we excluded cycles whose period deviated by more than 20% from the average period of all worms’ undulations in each experimental session.</p><p>For the ease of computing average dynamics, we converted individual cycles from a time-dependent to a phase-dependent curvature by uniformly rescaling each cycle to a phase range of <inline-formula><mml:math id="inf114"><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:math></inline-formula>. The averaged curvature within one cycle was then computed by averaging all individual cycles in the phase domain: <inline-formula><mml:math id="inf115"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Similarly, the averaged phase derivative of curvature within one cycle was calculated as <inline-formula><mml:math id="inf116"><mml:mfenced close="⟩" open="⟨" separators="|"><mml:mrow><mml:mi>d</mml:mi><mml:mi>K</mml:mi><mml:mo>/</mml:mo><mml:mi>d</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>d</mml:mi><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mi>N</mml:mi></mml:math></inline-formula>.</p></sec><sec id="s10" sec-type="appendix"><title>Stability of the worm’s head oscillation</title><p>To examine the stability of the worm’s head oscillation during forward locomotion, we analyzed head oscillations of worms that were optogenetically perturbed with 0.1 s muscle inhibitions and estimated their recovery dynamics after being deviated from the normal oscillation due to the perturbation.</p><p>To illustrate the oscillation dynamics, we use a two-dimensional variable, <inline-formula><mml:math id="inf117"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>ξ</mml:mi><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> in the unit of curvature where <inline-formula><mml:math id="inf118"><mml:mi>ξ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.135</mml:mn><mml:mi/><mml:mi>s</mml:mi></mml:math></inline-formula> is a scaling factor. In <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>, we depicted the closed trajectory (black) in the plane spanned by the variables <inline-formula><mml:math id="inf119"><mml:mi>K</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf120"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ξ</mml:mi><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for the head oscillation of unperturbed moving worms (this coordinate plane is in fact a linearly scaled version of the phase plane spanned by the variables <inline-formula><mml:math id="inf121"><mml:mi>K</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf122"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>), which we call as the normal cycle of the worm’s head oscillation.</p><p>Next, we defined an amplitude variable <inline-formula><mml:math id="inf123"><mml:mi>d</mml:mi></mml:math></inline-formula> that represents the normalized deviation to the normal cycle. If the oscillator is stable, the closed orbit for the unperturbed dynamics is usually called the stable limit cycle. Here, we stick to the notion of normal cycle instead of using ‘limit cycle’ to avoid any confusion on the stability of the worm’s head oscillation. For any phase state of an individual oscillation, the normalized deviation to the normal cycle is defined as <inline-formula><mml:math id="inf124"><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>. Here, <inline-formula><mml:math id="inf125"><mml:mi>D</mml:mi><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is distance to the center of oscillation on the phase plane, which is set to the origin, such that <inline-formula><mml:math id="inf126"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mi>K</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ξ</mml:mi><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt></mml:mrow></mml:mstyle></mml:math></inline-formula> where <inline-formula><mml:math id="inf127"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> denotes the phase value of the current state estimated by the four-quadrant inverse tangent of the variable pair <inline-formula><mml:math id="inf128"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>ξ</mml:mi><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. In this expression, <inline-formula><mml:math id="inf129"><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> denotes the distance to the center of oscillation that is evaluated exactly on the normal cycle at phase <inline-formula><mml:math id="inf130"><mml:mi>ϕ</mml:mi></mml:math></inline-formula>.</p><p>Using the deviation to the normal cycle to describe the amplitude of the worm’s head oscillation, we collected the amplitude dynamics over time for all periods of the worm’s head oscillations during which no illumination pulse occurs, that is, all periods of locomotion between two consecutive illumination pulses. We grouped the amplitude dynamics into bins according to their initial amplitudes and then calculated the collective amplitude dynamics for each bin. As shown in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>, the collective amplitude variable <inline-formula><mml:math id="inf131"><mml:mi>d</mml:mi></mml:math></inline-formula> converges to zero after roughly 0.5 s regardless of the initial amplitude. This result indicates that the worm’s head oscillation returns to its normal oscillation after being perturbed and that the normal cycle may represent a stable limit cycle for the oscillation.</p></sec><sec id="s11" sec-type="appendix"><title>Phase isochron map and vector field for the worm’s head oscillation</title><p>On the normal cycle we define the phase of the oscillation as <inline-formula><mml:math id="inf132"><mml:msup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>, where <inline-formula><mml:math id="inf133"><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is the angular frequency of normal oscillation (the calculation of <inline-formula><mml:math id="inf134"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> will be described in the next subsection) and we determined the initial phase (<inline-formula><mml:math id="inf135"><mml:msup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>) to be when <inline-formula><mml:math id="inf136"><mml:mi>K</mml:mi></mml:math></inline-formula> reaches local maximum (or <inline-formula><mml:math id="inf137"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>) and hence <inline-formula><mml:math id="inf138"><mml:msup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>π</mml:mi></mml:math></inline-formula> to be when <inline-formula><mml:math id="inf139"><mml:mi>K</mml:mi></mml:math></inline-formula> reaches local minimum (or <inline-formula><mml:math id="inf140"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>). In this way, we parameterized the normal cycle by defining a bijective map between phases and state points <inline-formula><mml:math id="inf141"><mml:mi mathvariant="normal">Φ</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>.</p><p>The map <inline-formula><mml:math id="inf142"><mml:mi mathvariant="normal">Φ</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>ϕ</mml:mi></mml:math></inline-formula> has been well defined for all the state points on the normal cycle <inline-formula><mml:math id="inf143"><mml:mi>C</mml:mi></mml:math></inline-formula>. We next estimate the phases for points off the normal cycle. By definition (<xref ref-type="bibr" rid="bib46">Izhikevich, 2007</xref>), if <inline-formula><mml:math id="inf144"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is a point on the normal cycle and <inline-formula><mml:math id="inf145"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is a point off the normal cycle, then <inline-formula><mml:math id="inf146"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> will have the same phase as <inline-formula><mml:math id="inf147"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> if the trajectory starting at the initial point <inline-formula><mml:math id="inf148"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> off the normal cycle converges to the trajectory starting at the initial point <inline-formula><mml:math id="inf149"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> on the normal cycle as time goes to infinity. Here, we define the set of all state points off the normal cycle having the same phase as a point <inline-formula><mml:math id="inf150"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> on the normal cycle as the isochron (<xref ref-type="bibr" rid="bib91">Winfree, 2001</xref>) for phase <inline-formula><mml:math id="inf151"><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>.</p><p>In our analysis, it was not possible to define an isochron according to the theoretical definition since data were always recorded in a finite time period during experiments. We used an alternative way to estimate all isochrons on the phase plane for the worm’s head oscillation. For each individual trial of illumination, we observed that, due to the optogenetic inhibition, the variable <inline-formula><mml:math id="inf152"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> quickly decayed toward zero value immediately after the illumination and then recovered after approximately 0.3 s as the oscillation converged to a normal oscillation. Therefore, by finding the local minimal of <inline-formula><mml:math id="inf153"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> immediately after each illumination pulse, we located the point at which the paralyzing effect is just removed and after which the oscillation starts a free resumption to normal oscillation. We call this point the 'notch point' <inline-formula><mml:math id="inf154"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> as it can be clearly seen from the phase plot (as shown in <xref ref-type="fig" rid="fig3">Figure 3E, H and K</xref>). After the notch point <inline-formula><mml:math id="inf155"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, the oscillation will proceed to its next phase states <inline-formula><mml:math id="inf156"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf157"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (or vice-versa), both of which can be easily identified through peak finding from the curvature dynamics <inline-formula><mml:math id="inf158"><mml:mi>K</mml:mi></mml:math></inline-formula>. Hence, we obtained two sub-trajectories from the oscillation: one <inline-formula><mml:math id="inf159"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, and the other <inline-formula><mml:math id="inf160"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mi>π</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>. Next to determining the timing of the notch point <inline-formula><mml:math id="inf161"><mml:mi>t</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>, we determined the phase of the notch point in the following steps: (1) we computed the phase of the state on the normal cycle at time <inline-formula><mml:math id="inf162"><mml:mi>t</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> as if the perturbation had not occurred, which is <inline-formula><mml:math id="inf163"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, or <inline-formula><mml:math id="inf164"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Here, <inline-formula><mml:math id="inf165"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> was computed twice using phase states <inline-formula><mml:math id="inf166"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> [subscripted with <inline-formula><mml:math id="inf167"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>] and <inline-formula><mml:math id="inf168"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> [subscripted with <inline-formula><mml:math id="inf169"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>] as references, respectively; (2) we calculated the induced phase shift <inline-formula><mml:math id="inf170"><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> and the phase of the notch point is <inline-formula><mml:math id="inf171"><mml:mi>ϕ</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>ϕ</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>. After obtaining the sub-trajectories <inline-formula><mml:math id="inf172"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf173"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mi>π</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> and calculating the phase of <inline-formula><mml:math id="inf174"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, we then estimated the phase values for all the points within each of the two sub-trajectories through linear interpolation.</p><p>Following the above steps, we calculated the phase values for all the state points on the phase plane that have been recorded from the optogenetic experiments. We then applied a 2-D moving average (using the angular statistics method) for the obtained phase values over the phase plane to smooth out the isochron map. Finally, we used a linear 2-D interpolation to obtain a phase isochron map with a finer resolution as shown in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>.</p><p>To compute the vector field of the worm’s head oscillation, we collected all the sub-trajectories <inline-formula><mml:math id="inf175"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf176"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mi>π</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> that are defined above and took derivative of the trajectories with respect to time. Thus, by collecting all the phase states <inline-formula><mml:math id="inf177"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>ξ</mml:mi><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and their corresponding time derivatives <inline-formula><mml:math id="inf178"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mi>K</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ξ</mml:mi><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> that describe the tangent vectors of trajectories, we generated the raw form of vector field for the worm’s head oscillation. Again, we applied a 2-D moving average for the raw outcome over the phase plane to smooth out the vector field. We used a linear 2-D interpolation to obtain a vector field with an appropriate number of quivers to be displayed (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>).</p></sec><sec id="s12" sec-type="appendix"><title>Phase response analysis</title><p>To generate phase response curves (PRCs) from optogenetic inhibition experiments, each trial’s illumination phase <inline-formula><mml:math id="inf179"><mml:mi>ϕ</mml:mi></mml:math></inline-formula>, as well as the induced phase shift <inline-formula><mml:math id="inf180"><mml:mi>F</mml:mi></mml:math></inline-formula>, were calculated. To calculate the two variables, the animal’s phase of oscillation was estimated based on timings of local extrema identified from the time-varying curvature profiles via a peak finding method. Specifically, (i) the occurrence of illumination of the trial was set to <inline-formula><mml:math id="inf181"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>; <inline-formula><mml:math id="inf182"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> was set at the beginning of each experiment. (ii) Around the illumination, timings of the two local maxima of curvature immediately before and after were identified as the two zero-phase points of the oscillation before and after the illumination, respectively. Here, the timings are denoted as <inline-formula><mml:math id="inf183"><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf184"><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf185"><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf186"><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, in the ascending order of time. (iii) Similarly, timings of the two local minima of curvature immediately before and after the illumination were identified as the two half-cycle-phase points before and after the illumination, respectively. Here, the timings are denoted as <inline-formula><mml:math id="inf187"><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf188"><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf189"><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf190"><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, in the ascending order of time. (iv) With these measurements, cycle period <inline-formula><mml:math id="inf191"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> was computed as <inline-formula><mml:math id="inf192"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:math></inline-formula>, so the angular frequency of undulation <inline-formula><mml:math id="inf193"><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> (<inline-formula><mml:math id="inf194"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> was computed as the average of differences of adjacent local maxima/minima before and after illumination; multiple cycles were used here to reduce noise). In addition, the illumination phase <inline-formula><mml:math id="inf195"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> of each individual trial was computed as <inline-formula><mml:math id="inf196"><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi/><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf197"><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi/><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>, and the corresponding phase shift <inline-formula><mml:math id="inf198"><mml:mi>F</mml:mi></mml:math></inline-formula> was computed as <inline-formula><mml:math id="inf199"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi/><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>π</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf200"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi/><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>π</mml:mi></mml:math></inline-formula>. Here, phase of illumination and the corresponding phase shift were computed twice using zero [subscripted with <inline-formula><mml:math id="inf201"><mml:mi>u</mml:mi></mml:math></inline-formula>] and half-cycle [subscripted with <inline-formula><mml:math id="inf202"><mml:mi>l</mml:mi></mml:math></inline-formula>] phase points as references, respectively.</p><p>We generated 2-D scatter plots for all trials with illumination phase as <italic>x</italic> coordinate and the corresponding phase shift as <italic>y</italic> coordinate. To visualize the distribution of the scatter points we generated bivariate histogram plots by grouping the data points into 2-D bins with 25 bins on both dimensions covering the range <inline-formula><mml:math id="inf203"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for <italic>x</italic> and range <inline-formula><mml:math id="inf204"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> for <italic>y</italic>. To indicate average tendency of phase shift depending on phase of illumination, we calculated a mean-curve representation of PRCs via a moving average operation. In this process, each mean was calculated over a sliding window of width <inline-formula><mml:math id="inf205"><mml:mn>0.16</mml:mn><mml:mi>π</mml:mi></mml:math></inline-formula> along the direction of <inline-formula><mml:math id="inf206"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> from 0 to <inline-formula><mml:math id="inf207"><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:math></inline-formula>. The 95% confidence interval relative to each window of data points was also computed and an integral number of them were displayed as filled area around the PRC. Through the computation, all statistical calculations followed the rules of directional statistics (<xref ref-type="bibr" rid="bib32">Fisher et al., 1993</xref>) since <inline-formula><mml:math id="inf208"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf209"><mml:mi>F</mml:mi></mml:math></inline-formula> are circular variables defined in radians.</p></sec><sec id="s13" sec-type="appendix"><title>Phase response curves from perturbations of other body regions</title><p>We asked how phase responses for the other regions of the body would compare to that of the anterior region. We conducted optogenetic experiments that inhibited <italic>Pmyo-3::NpHR</italic> transgenic worms by transiently illuminating 0.1–0.3 (anterior), 0.4–0.6 (middle), and 0.6–0.8 (posterior) of the body length, respectively. We found that the amplitude of the sawtooth feature of PRC tends to decrease as the perturbation occurs further from the head (<xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5A,E,I</xref>). We also noticed that, for the same perturbed region, the PRC shape remains unaffected regardless of the region at which the dynamics were analyzed (see <xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5A–C,D–F,G–I</xref>, respectively), suggesting that posterior regions of a freely moving worm follow their anterior neighbors with a constant phase offset. Taken together, these results suggest that a main rhythm generator may operate near the head of the worm to produce primary oscillations during forward locomotion. The sawtooth-shape feature of the PRC becomes stronger if the perturbation hits closer to the rhythm generator (<xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5A</xref>) or becomes weaker if the perturbation indirectly affects it (<xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5E,I</xref>)</p></sec><sec id="s14" sec-type="appendix"><title>The relaxation oscillator model for locomotor wave generation</title><p>We first developed a relaxation oscillator model to simulate the rhythm generation during <italic>C. elegans</italic> forward locomotion. In this model, we incorporated a novel neuromuscular mechanism with a previously described biomechanical framework (<xref ref-type="bibr" rid="bib31">Fang-Yen et al., 2010</xref>). Here, we only simulated the bending rhythms generated from the head region; the wave propagation dynamic is out of the scope of our study. Our phenomenological model does not contain detailed activities of individual neurons but focus on describing key neuromuscular mechanisms and their contributions to the rhythm generation.</p><p>To produce model variables that can be directly compared with experimental observations of moving animals, a biomechanical framework was first developed to describe worm’s behavioral dynamics in its external environments. Following previous derivations for <italic>C. elegans</italic> biomechanics (<xref ref-type="bibr" rid="bib31">Fang-Yen et al., 2010</xref>), the relationship between animal behavioral outputs and the active muscle moments can be described as follows:<disp-formula id="equ2"><label>(A1)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>a</mml:mi><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>In <xref ref-type="disp-formula" rid="equ2">Equation A1</xref>, the first term indicates the external viscous force that is transverse to the body segment where <inline-formula><mml:math id="inf210"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the coefficient of viscous drag to the transverse movement and <inline-formula><mml:math id="inf211"><mml:mi>y</mml:mi></mml:math></inline-formula> denotes the lateral displacement of body segment; the second term indicates the internal elastic force where <inline-formula><mml:math id="inf212"><mml:mi>a</mml:mi></mml:math></inline-formula> is the bending modulus of the worm body; the third term indicates the internal viscous force where <inline-formula><mml:math id="inf213"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the coefficient of the body internal viscosity. On the right side of <xref ref-type="disp-formula" rid="equ2">Equation A1</xref> is the active muscle moment <inline-formula><mml:math id="inf214"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>.</p><p>Taking the second partial derivative with respect to body coordinate <inline-formula><mml:math id="inf215"><mml:mi>s</mml:mi></mml:math></inline-formula> on both sides of <xref ref-type="disp-formula" rid="equ2">Equation A1</xref> and, using the linear relation under the small-amplitude approximation, <inline-formula><mml:math id="inf216"><mml:mi>κ</mml:mi><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, we arrive at:<disp-formula id="equ3"><label>(A2)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>a</mml:mi><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Under the assumptions of small-amplitude undulations and a fixed wavelength <inline-formula><mml:math id="inf217"><mml:mi>λ</mml:mi></mml:math></inline-formula> down the worm body, <inline-formula><mml:math id="inf218"><mml:mi>κ</mml:mi></mml:math></inline-formula> can be considered as a travelling sinusoidal wave with a small deviation, <inline-formula><mml:math id="inf219"><mml:mi>κ</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="normal">sin</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>s</mml:mi><mml:mo>/</mml:mo><mml:mi>λ</mml:mi><mml:mo>-</mml:mo><mml:mi>ω</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:math></inline-formula>, which leads to an approximation, <inline-formula><mml:math id="inf220"><mml:msub><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mi>κ</mml:mi></mml:math></inline-formula>. Plugging this approximation into <xref ref-type="disp-formula" rid="equ3">Equation A2</xref> while keeping <inline-formula><mml:math id="inf221"><mml:mi>s</mml:mi></mml:math></inline-formula> fixed, after some rearrangement, one gets:<disp-formula id="equ4"><label>(A3)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>κ</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi>a</mml:mi></mml:mfrac><mml:mrow><mml:mover><mml:mi>κ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mi>a</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>In terms of the dimensionless curvature <inline-formula><mml:math id="inf222"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mi>κ</mml:mi><mml:mo>·</mml:mo><mml:mi>L</mml:mi><mml:mi/></mml:math></inline-formula> and dimensionless muscle moment<disp-formula id="equ5"><label>(A4)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mi>a</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>we can rewrite <xref ref-type="disp-formula" rid="equ4">Equation A3</xref> as:<disp-formula id="equ6"><label>(A5)</label><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where<disp-formula id="equ7"><label>(A6)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi>a</mml:mi></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>and we note that <xref ref-type="disp-formula" rid="equ6 equ7">Equations A5 and A6</xref> yield <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>. In <xref ref-type="disp-formula" rid="equ7">Equation A6</xref>, both the wavelength <inline-formula><mml:math id="inf223"><mml:mi>λ</mml:mi></mml:math></inline-formula> and the normal viscous drag coefficient <inline-formula><mml:math id="inf224"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> vary with the fluid viscosity <inline-formula><mml:math id="inf225"><mml:mi>η</mml:mi></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib8">Berri et al., 2009</xref> ; <xref ref-type="bibr" rid="bib31">Fang-Yen et al., 2010</xref>).</p><p>The above biomechanical framework in our model treats the worm’s body segment as a viscoelastic rod and describes how the body segment bends under the forces provided by the active muscle moment. However, the simulated oscillation in <inline-formula><mml:math id="inf226"><mml:mi>K</mml:mi></mml:math></inline-formula> comes from the rhythmicity of the active muscle moment which originates from the hypothesized neuromuscular mechanism described by the following relaxation-oscillation process:</p><list list-type="roman-lower"><list-item><p>Proprioceptive feedback is sensed as a linear combination of the current curvature value and the current rate of change of curvature, <inline-formula><mml:math id="inf227"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (black curve in <xref ref-type="fig" rid="fig4">Figure 4D</xref>).</p></list-item><list-item><p>During movement of bending, this proprioceptive feedback is constantly compared with two threshold values <inline-formula><mml:math id="inf228"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf229"><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (gray dashed bars in <xref ref-type="fig" rid="fig4">Figure 4D</xref>).</p></list-item><list-item><p>Once the feedback reaches either of the thresholds (the switch points as indicated by red circles in <xref ref-type="fig" rid="fig4">Figure 4D</xref>), a switch command is initiated (blue square wave in <xref ref-type="fig" rid="fig4">Figure 4E</xref>).</p></list-item><list-item><p>The switch command triggers the active muscle moment to change toward the opposite saturation value (black curve in <xref ref-type="fig" rid="fig4">Figure 4E</xref>).</p></list-item></list><p>To simulate the switch-triggered muscle transition we used a modified logistic function: <inline-formula><mml:math id="inf230"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>±</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>∙</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">tanh</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>. Here, the plus sign indicates the dorsal-to-ventral muscle moment transition while the minus sign indicates the opposite direction.</p><p>To initiate the oscillation in our model we set the system to bend toward the ventral side by setting <inline-formula><mml:math id="inf231"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf232"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. During forward locomotion, the active muscle moment oscillates by undergoing a relaxation oscillation process: a relaxation subperiod during which <inline-formula><mml:math id="inf233"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> stays at a saturated bending state (<inline-formula><mml:math id="inf234"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> for ventral bending, <inline-formula><mml:math id="inf235"><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> for dorsal bending), alternating between a shorter subperiod during which <inline-formula><mml:math id="inf236"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> quickly transits toward the opposite state due to effects described in iii and iv. The bending curvature <inline-formula><mml:math id="inf237"><mml:mi>K</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> which is driven by <inline-formula><mml:math id="inf238"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> in an exponential decaying manner (<xref ref-type="disp-formula" rid="equ6">Equation A5</xref>) follows the rhythmic activity of <inline-formula><mml:math id="inf239"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, thereby also exhibiting an oscillatory dynamic (<xref ref-type="fig" rid="fig4">Figure 4B</xref>).</p><p>This relaxation oscillator model reproduces two key features of free locomotion that we observed from experiments. First, freely moving worms exhibit nonsinusoidal curvature waveform with an intrinsic asymmetry: bending toward the ventral or dorsal directions occurs slower than straightening toward a straight posture during each locomotory cycle (<xref ref-type="fig" rid="fig4">Figure 4F</xref>). Second, dynamic of the active muscle moment shows a trapezoidal waveform during forward locomotion (<xref ref-type="fig" rid="fig2">Figure 2D</xref> <italic>Inset</italic> and <xref ref-type="fig" rid="fig4">Figure 4E</xref>). These results are independent of external conditions but reflect intrinsic properties of the neuromuscular mechanisms underlying locomotion rhythm generation.</p><p>Note that parameters <inline-formula><mml:math id="inf240"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf241"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf242"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> were estimated from data of free locomotion using phase portrait techniques described in the following subsection. Parameters <inline-formula><mml:math id="inf243"><mml:mi>b</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf244"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> were yet degenerate in this model of free locomotion. Here, we temporarily set <inline-formula><mml:math id="inf245"><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> and then set <inline-formula><mml:math id="inf246"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> such that the oscillatory period predicted by model matched the average period measured from experiments with a minimum squared error:<disp-formula id="equ8"><label>(A7)</label><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="italic">t</mml:mi><mml:mi mathvariant="italic">h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The nondegeneracy of <inline-formula><mml:math id="inf247"><mml:mi>b</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf248"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> was determined by fitting the model to the experimental PRC as described in the later subsection so that all the parameters for the model are provided as <inline-formula><mml:math id="inf249"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>8.45</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf250"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>260</mml:mn><mml:mspace width="thinmathspace"/><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf251"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mspace width="thinmathspace"/><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf252"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>46</mml:mn><mml:mspace width="thinmathspace"/><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf253"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2.33</mml:mn></mml:math></inline-formula>.</p></sec><sec id="s15" sec-type="appendix"><title>Measuring bending relaxation time scale and amplitude of active muscle moment</title><p>To estimate these two parameters, we applied a heuristic method that uses the shape properties of <italic>C. elegans</italic> free-running phase plot <xref ref-type="fig" rid="fig2">(Figure 2D</xref>). From the curve in the figure, we noticed two ‘flat’ portions symmetrically distributed at quadrant <italic>I</italic> and <italic>III</italic> on the phase plane. Recalling <xref ref-type="disp-formula" rid="equ1">Equation 1</xref> (or <xref ref-type="disp-formula" rid="equ6">Equation A5</xref>): <inline-formula><mml:math id="inf254"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, the two flat regions indicate that the scaled active muscle moment, <inline-formula><mml:math id="inf255"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, is nearly constant during the corresponding time bouts.</p><p>We then computed the linear correlation between variables <inline-formula><mml:math id="inf256"><mml:mi>K</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf257"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> to identify the two ‘flat’ regions and, through linear fits, obtained two linear relations respectively: <inline-formula><mml:math id="inf258"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>K</mml:mi><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (region 1) and <inline-formula><mml:math id="inf259"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>K</mml:mi><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (region 2). Thus, the bending relaxation time scale <inline-formula><mml:math id="inf260"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and the amplitude of the scaled active muscle moment are estimated as <inline-formula><mml:math id="inf261"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf262"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>M</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>0</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, respectively.</p><p>The above method used the phase plot measured from locomotion of worms swimming in a 17% dextran solution (120 mPa·s viscosity) as an example. However, it is also valid for estimating parameters of locomotion in other viscosities.</p></sec><sec id="s16" sec-type="appendix"><title>Measuring active moment transition time scale</title><p>With <inline-formula><mml:math id="inf263"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (estimated from the above method), <inline-formula><mml:math id="inf264"><mml:mfenced close="⟩" open="⟨" separators="|"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> and <inline-formula><mml:math id="inf265"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (measured from locomotion) plugged to the left side of <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, we were able to compute the waveform of the scaled active muscle moment <inline-formula><mml:math id="inf266"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> on the right side of <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>. As expected and shown in <xref ref-type="fig" rid="fig2">Figure 2D</xref> <italic>Inset</italic>, the curve of <inline-formula><mml:math id="inf267"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is roughly centrally symmetric around point <inline-formula><mml:math id="inf268"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi/><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula> on the plane, with two plateau portions indicating two saturated states for dorsal and ventral muscle contractions, respectively.</p><p>Between the two plateau portions represents a period during which the active muscle moment is undergoing a ventral-to-dorsal (or vice-versa) transition. We used a modified logistic function to model the ventral-to-dorsal muscle moment transition (substituting <inline-formula><mml:math id="inf269"><mml:mi>t</mml:mi></mml:math></inline-formula> with <inline-formula><mml:math id="inf270"><mml:mo>-</mml:mo><mml:mi>t</mml:mi></mml:math></inline-formula> for transition in the other direction):<disp-formula id="equ9"><label>(A8)</label><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>tanh</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mi>t</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>To estimate <inline-formula><mml:math id="inf271"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, the exponential time constant for the transition of active muscle moment, we took the time derivative of <xref ref-type="disp-formula" rid="equ9">Equation A8</xref> and took the absolute value of the resultant:<disp-formula id="equ10"><label>(A9)</label><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We notice that when <inline-formula><mml:math id="inf272"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, the maximum of <inline-formula><mml:math id="inf273"><mml:mo>|</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>|</mml:mo></mml:math></inline-formula> is achieved and the value is <inline-formula><mml:math id="inf274"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. On the other hand, the maximum of <inline-formula><mml:math id="inf275"><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> can be obtained from the experimental observation by simply finding the peak of |<inline-formula><mml:math id="inf276"><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula>| curve where <inline-formula><mml:math id="inf277"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="⟩" open="⟨" separators="|"><mml:mrow><mml:mi>K</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>⋅</mml:mo><mml:mfenced close="⟩" open="⟨" separators="|"><mml:mrow><mml:mi>d</mml:mi><mml:mi>K</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>. Thus, <inline-formula><mml:math id="inf278"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> can be estimated as:<disp-formula id="equ11"><label>(A10)</label><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mover><mml:mrow/><mml:msub><mml:mrow><mml:mover><mml:mi>M</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>0</mml:mtext></mml:mrow></mml:msub></mml:mover><mml:mo>⋅</mml:mo><mml:msubsup><mml:mrow><mml:mo>|</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec><sec id="s17" sec-type="appendix"><title>Parameter estimation</title><p>For our original threshold-switch model, parameters <inline-formula><mml:math id="inf279"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf280"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf281"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> were estimated from free locomotion experiments as described above. These three parameters nearly fully determine the biomechanical framework of <italic>C. elegans</italic> bending movements (governed by <xref ref-type="disp-formula" rid="equ6 equ9">Equation A5 and A8</xref>). On the other hand, parameters <inline-formula><mml:math id="inf282"><mml:mi>b</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf283"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> describe the proprioceptive feedback and the threshold-switch features in our model. Specifically, they characterize two threshold lines, <inline-formula><mml:math id="inf284"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo>±</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (as shown in <xref ref-type="fig" rid="fig4">Figure 4C</xref>). The two switch points—defined by the intersection between the phase trajectory and the threshold lines on the phase plane—determine the timing of switches for the active muscle moment (see <xref ref-type="fig" rid="fig4">Figure 4C–E</xref>). We noted that the model behavioral output of free locomotion is degenerate with respect to these two parameters; the same outcome would be produced if the threshold lines cross the same pair of switch points. To first determine the free-moving dynamic as well as the switch points, we temporarily set <inline-formula><mml:math id="inf285"><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> and then set <inline-formula><mml:math id="inf286"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> such that the oscillatory period defined by model matched the average period measured from the experiments.</p><p>To obtain the nondegeneracy of <inline-formula><mml:math id="inf287"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf288"><mml:mi>b</mml:mi></mml:math></inline-formula>, we fit our model to the experimental phase response curve using a global optimization procedure. Full procedure for the determination of <inline-formula><mml:math id="inf289"><mml:mi>b</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf290"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is given below.</p></sec><sec id="s18" sec-type="appendix"><title>Modeling worm oscillations in varied environments</title><p>Differences in various environments will change only those parameters that are related to contact with external forces whereas parameters related to oscillator’s internal properties will not be affected. In terms of the internal parameters of our model, we used values that were previously determined, which are <inline-formula><mml:math id="inf291"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mspace width="thinmathspace"/><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf292"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>8.45</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf293"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>46</mml:mn><mml:mspace width="thinmathspace"/><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf294"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2.33</mml:mn></mml:math></inline-formula>. For the exogenous parameters, only the time constant of undulation, <inline-formula><mml:math id="inf295"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, varies according to external conditions. According to <xref ref-type="disp-formula" rid="equ7">Equation A6</xref>, <inline-formula><mml:math id="inf296"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is explicitly determined in terms of other physical parameters, including biomechanical parameters measured in previous work (<xref ref-type="bibr" rid="bib31">Fang-Yen et al., 2010</xref>): the internal viscosity of worm body is measured as <inline-formula><mml:math id="inf297"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>⋅</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mi>N</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>; the bending modulus of worm body is measured as <inline-formula><mml:math id="inf298"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>9.5</mml:mn><mml:mo>⋅</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>14</mml:mn></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mi>N</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>; <inline-formula><mml:math id="inf299"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>31</mml:mn><mml:mi>η</mml:mi></mml:math></inline-formula> is the coefficient of viscous drag for movement normal to the body (<xref ref-type="bibr" rid="bib51">Katz et al., 1975</xref>), where <inline-formula><mml:math id="inf300"><mml:mi>η</mml:mi></mml:math></inline-formula> is the fluid viscosity. According to previous measurements of undulatory wavelengths in different viscous solutions (<xref ref-type="bibr" rid="bib31">Fang-Yen et al., 2010</xref>), we applied a logarithmic fit to the data points, yielding <inline-formula><mml:math id="inf301"><mml:mi>λ</mml:mi><mml:mo>/</mml:mo><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>0.158</mml:mn><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>η</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>+</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> for a continuous model realization in undulatory frequency and amplitude. Here, <inline-formula><mml:math id="inf302"><mml:mi>λ</mml:mi></mml:math></inline-formula> is the wavelength and <inline-formula><mml:math id="inf303"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="thinmathspace"/><mml:mi>m</mml:mi><mml:mi>P</mml:mi><mml:mi>a</mml:mi><mml:mo>⋅</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec id="s19" sec-type="appendix"><title>Alternative models for locomotor wave generation</title><p>To further evaluate the performance of our original model, we explored three alternative models for simulating locomotory rhythm generation to make comparisons across these models and the experimental observations. Alternative models are based on three previously studied self-oscillator models described by 2-D nonlinear systems: the van der Pol, Rayleigh, and Stuart-Landau oscillators.</p><p>First, we developed a model oscillator in the form taken from the van der Pol Oscillator:<disp-formula id="equ12"><label>(A11)</label><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>¨</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>ω</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf304"><mml:mi>K</mml:mi></mml:math></inline-formula> indicates the nondimensional bending curvature. This model has a nonlinear damping term with a coefficient depending on <inline-formula><mml:math id="inf305"><mml:mi>K</mml:mi></mml:math></inline-formula>. Simulated oscillation is a limit cycle of the model (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1B,F</xref>), given parameters <inline-formula><mml:math id="inf306"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>0.026</mml:mn><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>2.04</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>5.51</mml:mn><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>Second, we developed a model oscillator by modifying the Rayleigh Oscillator:<disp-formula id="equ13"><label>(A12)</label><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>¨</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>ω</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf307"><mml:mi>K</mml:mi></mml:math></inline-formula> again indicates the nondimensional bending curvature. This model has a nonlinear damping term with a coefficient depending on <inline-formula><mml:math id="inf308"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. Simulated oscillation is a limit cycle of the model (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1C,G</xref>), given parameters <inline-formula><mml:math id="inf309"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2.73</mml:mn><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.0023</mml:mn><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>5.6</mml:mn><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>Third, we developed a model oscillator by modifying the Stuart-Landau Oscillator:<disp-formula id="equ14"><label>(A13)</label><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mi>Z</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>0.</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here, the system is described in the complex domain where <inline-formula><mml:math id="inf310"><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf311"><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are complex variables, and <inline-formula><mml:math id="inf312"><mml:mi>σ</mml:mi></mml:math></inline-formula> is real. We let <inline-formula><mml:math id="inf313"><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, the real part of <inline-formula><mml:math id="inf314"><mml:mi>Z</mml:mi></mml:math></inline-formula>, denote the nondimensional curvature <inline-formula><mml:math id="inf315"><mml:mi>K</mml:mi></mml:math></inline-formula>. This model has a nonlinear damping term with coefficient depending on <inline-formula><mml:math id="inf316"><mml:mo>|</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo></mml:math></inline-formula>. Simulated oscillation is a limit cycle of the model (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1D,H</xref>), given parameters <inline-formula><mml:math id="inf317"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.54</mml:mn><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.52</mml:mn><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>5.54</mml:mn><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>The three alternative models produce free-running oscillatory dynamics with similar frequency and amplitude as measured from worms swimming in fluids with viscosity <inline-formula><mml:math id="inf318"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>120</mml:mn><mml:mspace width="thinmathspace"/><mml:mi>m</mml:mi><mml:mi>P</mml:mi><mml:mi>a</mml:mi><mml:mo>⋅</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec id="s20" sec-type="appendix"><title>Simulation of optogenetic inhibition</title><p>According to our experimental observations on the effect of the optogenetic muscle inhibition (<xref ref-type="fig" rid="fig3">Figure 3A,B</xref>), paralysis of muscles of the illuminated region initiated upon illumination (defined as <inline-formula><mml:math id="inf319"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> for <xref ref-type="fig" rid="fig3">Figure 3B</xref>) and reached maximal effect approximately at <inline-formula><mml:math id="inf320"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn><mml:mspace width="thinmathspace"/><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Here, we modeled the process of muscle inhibition by multiplying the scaled active muscle moment, <inline-formula><mml:math id="inf321"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, with a factor, <inline-formula><mml:math id="inf322"><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>Q</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, as a function of the time interval <inline-formula><mml:math id="inf323"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula> in a bell-shaped form (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>, <xref ref-type="disp-formula" rid="equ15">Equation A14</xref>).</p><p>As described in our model, the dorsoventrally alternating feature of the active muscle moment during locomotion are described by the dynamics of <inline-formula><mml:math id="inf324"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>. Specifically, <inline-formula><mml:math id="inf325"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is positive when ventral muscles contract and dorsal muscles relax, and negative for the other half of the cycle. Therefore, in our threshold-switch model, specifically inhibiting dorsal- or ventral- or both-side muscles was computationally equivalent to conditionally modulating <inline-formula><mml:math id="inf326"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> with the bell-shaped modulating function depending on the sign of <inline-formula><mml:math id="inf327"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>.</p><p>For simulating inhibition process in the three alternative models, we factored out a specific term from individual model equations as a generalized active muscle moment. We applied the bell-shaped modulating function to this term conditionally for each individual model. Detailed descriptions of implementing modeled inhibitions in alternative models are available from below.</p><p>To get a deeper understanding of how phase response curves are related to systems dynamics during wave generation, we systematically simulated transient muscle inhibitions on individual model oscillators at different times within a cycle period to generate model PRCs. To do that, we theoretically simulated the process of muscle inhibition by multiplying model active muscle moment with a modulatory factor, <inline-formula><mml:math id="inf328"><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>Q</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, which has a bell-shaped profile (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>):<disp-formula id="equ15"><label>(A14)</label><mml:math id="m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>Q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:mfrac><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>q</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf329"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn><mml:mspace width="thinmathspace"/><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the timing of the occurrence of maximal paralysis according to our experimental observations on the effect of muscle inhibition (<xref ref-type="fig" rid="fig3">Figure 3A,B</xref>), <inline-formula><mml:math id="inf330"><mml:mi>H</mml:mi></mml:math></inline-formula> indicated the maximal degree of paralysis, and <inline-formula><mml:math id="inf331"><mml:mi>p</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf332"><mml:mi>q</mml:mi></mml:math></inline-formula> measure the paralyzing rate and duration, respectively. To ensure sufficient smoothness during computation, we let <inline-formula><mml:math id="inf333"><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> so that <inline-formula><mml:math id="inf334"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Q</mml:mi><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0.99</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. Note that when modeling the dorsal-side-only muscle inhibition, the parameter <inline-formula><mml:math id="inf335"><mml:mi>H</mml:mi></mml:math></inline-formula> for describing max degree of optogenetic muscle inhibition was modulated to <inline-formula><mml:math id="inf336"><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:mi>*</mml:mi><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to qualitatively agree with experimental observations (<xref ref-type="fig" rid="fig6">Figure 6</xref>). This factor accounts for unequal degrees of paralysis during ventral vs. dorsal illumination (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>), causing the PRC of dorsal-side illumination to show a relatively moderate response compared to ventral-side illumination.</p><p>To simulate the muscle inhibition on our threshold-switch model, we multiplied <inline-formula><mml:math id="inf337"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> with <inline-formula><mml:math id="inf338"><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>Q</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> any time the model was to be inhibited during its oscillatory period. To apply this operation to the alternative models, we factored out a term as a generalized active muscle moment for each individual model and then multiplied it with the bell-shaped function described above. The generalized forms of active muscle moment for the alternative models are implemented by modifying their original forms as follows:</p><p>a. For the van der Pol Oscillator, it is modified as:<disp-formula id="equ16"><label>(A15)</label><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>¨</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>ω</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow><mml:mo>;</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>b. For the Rayleigh Oscillator, it is modified as:<disp-formula id="equ17"><label>(A16)</label><mml:math id="m17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>¨</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>ω</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow><mml:mo>;</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>c. For the Stuart-Landau Oscillator, it is modified as:<disp-formula id="equ18"><label>(A17)</label><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mi>Z</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>For each individual model listed above, <inline-formula><mml:math id="inf339"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (subscript <inline-formula><mml:math id="inf340"><mml:mi>i</mml:mi></mml:math></inline-formula> represents V, R, and S, respectively) is the generalized muscle moment which is to be multiplied by the bell-shaped factor <inline-formula><mml:math id="inf341"><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>Q</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> upon perturbation, and <inline-formula><mml:math id="inf342"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the additional damping coefficient. Note that the minus sign prior to <inline-formula><mml:math id="inf343"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> in the first equation of each set indicates that <inline-formula><mml:math id="inf344"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a negative damping term that provides power to the system, while <inline-formula><mml:math id="inf345"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is set positive for modeling the effect of bending toward the straight posture due to internal and external viscosity. Also note that <xref ref-type="disp-formula" rid="equ16 equ17 equ18">Equations A15-A17</xref> would be equivalent to their original form (<xref ref-type="disp-formula" rid="equ12 equ13 equ14">Equations A11–A13</xref>) when inhibition is absent (in this case, <inline-formula><mml:math id="inf346"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>).</p><p>By modeling the muscle inhibition process during locomotion, we were able to perform simulations of phase response experiments on individual models to produce perturbed systems dynamics (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1J–L</xref>) and the corresponding PRCs (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1N–P</xref> and <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>).</p></sec><sec id="s21" sec-type="appendix"><title>Optimization of models</title><p>For each individual model we developed, the parameters were determined via a two-round fitting process. First, a subset of parameters was determined by fitting the model to observations of free-moving dynamics; the model could generate free-moving dynamics close to observations at this point. Second, the rest of the parameters were settled by fitting it to experimental phase response curves; a model would be fully determined at this point. Detailed descriptions of the two-step optimization procedure for individual models are provided as follows:</p><p>For the original threshold-switch model, parameters <inline-formula><mml:math id="inf347"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf348"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf349"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> were explicitly estimated from the experiments of free locomotion using phase portrait techniques described above. To simulate free locomotion, we further determined the position of switch points in the model (as indicated in <xref ref-type="fig" rid="fig4">Figure 4C</xref> red circle), which we did using method described by <xref ref-type="disp-formula" rid="equ8">Equation A7</xref>. Next, we plugged the determined parameters into the model and conducted the second round of optimization by fitting the model with undetermined parameters <inline-formula><mml:math id="inf350"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf351"><mml:mi>b</mml:mi></mml:math></inline-formula>, as well as the parameters for simulating muscle inhibition — <inline-formula><mml:math id="inf352"><mml:mi>H</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf353"><mml:mi>q</mml:mi></mml:math></inline-formula>. We generated model PRC by perturbing the model oscillator at different times within a cycle period and settled the parameters such that the model PRC matched the experimental one with a minimum mean squared error (MSE) (During the computation of MSE, values of both model and experimental PRCs were sampled across the entire range of <inline-formula><mml:math id="inf354"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> with 100 evenly distributed samples. In this case, <inline-formula><mml:math id="inf355"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>100</mml:mn></mml:math></inline-formula>):<disp-formula id="equ19"><label>(A18)</label><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="italic">t</mml:mi><mml:mi mathvariant="italic">h</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="italic">b</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="italic">H</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="italic">q</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>;</mml:mo><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>To find the parameters that minimize the difference, a global minimum search was performed using the MATLAB function ‘GlobalSearch’ (<xref ref-type="bibr" rid="bib84">Ugray et al., 2007</xref>). When run, the function repeatedly uses a local minimum solver with different batches of parameter range and attempts to locate a solution that produces the lowest MSE value.</p><p>Similarly, the two-step optimization procedures for individual alternative models are summarized in <xref ref-type="table" rid="app1table1">Appendix 1—table 1</xref>.</p><table-wrap id="app1table1" position="float"><label>Appendix 1—table 1.</label><caption><title>Objective functions used in the optimization procedures for alternative models.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Type</th><th>Free locomotion model</th><th>Complete model</th></tr></thead><tbody><tr><td>van der Pol</td><td><inline-formula><mml:math id="inf356"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>d</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>d</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf357"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>d</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td>Rayleigh</td><td><inline-formula><mml:math id="inf358"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>a</mml:mi><mml:mi>y</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>a</mml:mi><mml:mi>y</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf359"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>a</mml:mi><mml:mi>y</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td>Stuart-Landau</td><td><inline-formula><mml:math id="inf360"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf361"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr></tbody></table><table-wrap-foot><fn><p>Two-step optimization procedure for van der Pol, Rayleigh, and Stuart-Landau oscillators. The first-step optimization determines part of parameters such that individual models generate free locomotion dynamics. The second-step optimization leads to complete models such that models’ perturbed dynamics and phase response curves are produced.</p></fn></table-wrap-foot></table-wrap></sec></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.69905.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Zimmer</surname><given-names>Manuel</given-names></name><role>Reviewing Editor</role><aff><institution>University of Vienna</institution><country>Austria</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Johnson</surname><given-names>Carter</given-names> </name><role>Reviewer</role><aff><institution>University of California, Berkeley</institution><addr-line><named-content content-type="city">Berkeley</named-content></addr-line><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>This paper combines behaviour quantification, optogenetic perturbation, and modelling to study <italic>C. elegans</italic> locomotion. It will be of interest to neuroscientists studying lcomotion and gait adaptation. The quantitative agreement between the model and experiments-importantly including the perturbation experiments-suggests forward locomotion in worms can be understood as being driven by a relaxation oscillator. This conclusion provides intuition for how worms move and should provide useful constraints on more detailed models that include neural anatomy and physiology.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Phase response analyses support a relaxation oscillator model of locomotor rhythm generation in <italic>Caenorhabditis elegans</italic>&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, and the evaluation has been overseen by Manuel Zimmer as a Reviewing Editor and Ronald Calabrese as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Carter Johnson (Reviewer #3).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission. As you can see below, the reviewers provide an extensive list of detailed comments, however the overall result of the reviews and subsequent discussions is that we are very excited about your work, and we would like to support publication in <italic>eLife</italic> of a revised manuscripts that addresses all comments. The comments below are partially concerned with similar issues but to retain each reviewers' details, we provide you here with the full list. Please submit with your revision a point-by-point response to the comments.</p><p>Essential revisions:<italic>Reviewer #1:</italic></p><p>(R1.1) The authors set out to better understand the dynamics of <italic>C. elegans</italic> locomotion characterizing the rhythmic pattern of the worm's head during locomotion and by generating the phase response curve in that region. The authors then illustrate how well the relaxation-oscillator phenomenological model, with only a handful of free parameters optimized to match the data, is consistent with the observations, including observations under different mechanical loads.</p><p>(R1.2) The authors provide a characterization of the curvature dynamics in the worm's head region (0.1-0.3 body coordinate). The reasoning for focusing on this area in particular is not discussed or justified in the manuscript. Also, no comment is made whether the characteristics observed for the limit cycle in that region is consistent across the rest of the regions. From the experimental description and data shown (i.e., Figure 2B), it would appear that the authors had access to a characterization of the limit cycle across any region of the body of the worm, from head to tail. To avoid the appearance of cherry-picking a region, authors are encouraged to include the full characterization of the limit cycle for all the data available to them. In addition to that, authors are encouraged to clarify explicitly whether the characteristics observed in one region (e.g., nonsinusoidal limit cycle) hold true across the rest of the worm's body. How sinusoidal or nonsinusoidal, non-ellipsoidal, asymmetric is the limit cycle as a function of the body region of the worm, from head to tail? Crucially, if the characterization observed in the selected region is not equally pronounced across the rest of body, it seems crucial to discuss it in the interpretation of the results. This is particularly important given that throughout the manuscript, the authors interpret the results as applicable to the rhythmic generation across the whole body, not just that limited region (see first sentence of the Discussion, for example; and it is also relevant given that they discuss equally proprioceptive feedback in the head as well as in the rest of the body). These points apply to the characterization of the limit cycle given that the data is there but not shown; this is not the case for the phase response analysis, because understanding it for the full body would require further experimentation. However, this should be a point of discussion: is the expectation that the phase response curve through transient ontogenetic inhibition will look similar throughout the body? Is the same sawtooth-shape with the sharp transitions in the same part of the phase expected? What is the implication of the expected results if they are consistent or not consistent with the ones shown for the region focused on here?</p><p>(R1.2) The model assumes proprioceptive feedback from the curvature of the same region that is bending. However, the undifferentiated processes that are used as inspiration for this assumption extend posteriorly in the case of SMD and anteriorly in the case of B-class motor neurons. So the assumption that the curvature in one region can affect the bending in that same region should be discussed.</p><p>(R1.3) The model also assumes that the stretch receptors sense both the curvature and the rate of curvature. However, the authors provide no evidence of other <italic>C. elegans</italic> neurons where both of those can be sensed simultaneously. It seems feasible that a neuron might be sensitive to either the curvature or the rate of curvature, but it seems less feasible that the neuron would be sensitive to a linear combination of both. This seems to be a central assumption of the model, with little or no justification.</p><p>(R1.4) I commend the authors for comparing their selected model with other similar ones. I would highly encourage that the authors include a comparison of the models into the main manuscript. In particular, given the similarities between the results, I would highly encourage the authors to place the results of their chosen model next to the alternatives (it can be a figure like S10 but including the preferred model). As it is, with the alternatives in S10 and the rest of the figures from the best model in the main text, the comparison is significantly harder.</p><p>(R1.5) Finally, the discussion of previous relevant computational models of <italic>C. elegans</italic> locomotion is rather limited. There are at least four particularly relevant contributions that the authors do not discuss in relation to their own contribution:</p><p>(a) Johnson, Lewis, and Guy (2020) Neuromechanical Mechanisms of Gait Adaptation in <italic>C. elegans</italic>: Relative Roles of Neural and Mechanical Coupling.</p><p>(b) Izquierdo and Beer (2018) From head to tail: a neuromechanical model of forward locomotion in <italic>Caenorhabditis elegans</italic>.</p><p>(c) Kunert, Proctor, Brunton, Kutz (2017) Spatiotemporal feedback and network structure drive and encode <italic>Caenorhabditis elegans</italic> locomotion</p><p>(d) Denham, Ranner, Cohen (2018) Signatures of proprioceptive control in <italic>Caenorhabditis elegans</italic> locomotion.</p><p><italic>Reviewer #2:</italic></p><p>(R2.1) The paper's conclusions are supported by the data and the experiments and model results are clearly presented. In some cases there could be more analysis of uncertainty. For example, how consistent is the phase portrait? This could be illustrated by including some individual traces and/or by estimating a confidence interval (using resampling if necessary). A different kind of uncertainty that should be explained is that arising from fitting the model. Was the optimisation sensitive to the choice of starting parameters? Are there several local minima that explain the data reasonably well or did the optimisation always converge to the same parameter values?</p><p>(R2.2) The authors have focused on forward locomotion bouts and have also eliminated cycles with a period that deviated more than 20% from the average across worms within a session. How many of the bouts were eliminated with this threshold? Are any of the conclusions of the paper sensitive to this threshold?</p><p>(R2.3) The authors have convincingly ruled out the van der Pol and Stuart-Landau oscillators but the Rayleigh oscillator fits the data quite well with three parameters. Some quantification of the relative fit quality of the threshold-switch model and the Rayleigh might help guide future work.</p><p>(R2.4) Finally, the discussion does a good job of putting the results of the phenomenological threshold-switch model in the context of previously published detailed models but it might be strengthened with more quantitative comparisons. For example, do the observed muscle switching time scales or the nature of the proprioceptive threshold rule out or usefully constrain any of the detailed models?</p><p>(R2.5) The schematic figures (1 and 4) would be improved by leaving out the abbreviations. At a minimum, include (BWM) after 'body wall muscles' in the caption of figure 1.</p><p>(R2.6) Would a different colour map make Figure S2 clearer? Jet makes some regions stand out more than is warranted. For example, the purple patch in the lower right corner and red patch in the upper left corder are visually very salient but are probably just normal fluctuations within the noise.</p><p>(R2.7) In Figure 3, grey is used to indicate the control data in B but is used for individual trials in subsequent panels. Use a different colour for controls in B? Also add the grey curves to the legend next to D rather than only describing them in the caption.</p><p>(R2.8) Line 299, state the gene name of the GABA receptor.</p><p>(R2.9) In the Appendix there are a few cases of missing articles (for example line 812, &quot;worm's head&quot; should be &quot;the worm's head&quot; and on line 886 &quot;animal's&quot; should be &quot;the animal's&quot;).</p><p>(R2.10) Starting on line 817, D^C is used to denote the distance from the origin over the normal cycle. To avoid confusion with the scaling constant c, perhaps choose a different symbol for the scaling constant or to indicate the normal cycle?<italic>Reviewer #3:</italic></p><p>(R3.1) The main suggestion I have is to change the framing of the section &quot;The Analysis of Alternative Models Supports a Relaxation Oscillation Mechanism'. In the first paragraph, the authors state that the purpose of this section is to &quot;[ask] whether other models could also explain our findings.&quot; However, the section title and final paragraph suggest that the purpose of the section is to support the idea that the underlying oscillatory mechanism is a relaxation-oscillation. If my understanding of the authors' purpose here is correct, then I don't think the analysis of these three specific phenomenological models provides evidence of this. Specifically, the last paragraph of this section (Lines 586-590), suggests that because the non-relaxation oscillator (Stuart-Landau) was not able to capture your results (non-sinusoidal limit cycle and sawtooth PRCs), the underlying mechanism is a relaxation-oscillation. I don't think these models support that claim, because a different non-relaxation oscillator tuned precisely may be able to capture these results. I think a much more thorough analysis of general oscillator dynamics would be needed to make such a claim. To be clear, I think the paper is strong enough without this analysis, I would just be more cautious about the claims here.</p><p>(R3.2) The strength of the author's original computational model is that it is based on specific mechanisms thought to underlie <italic>C. elegans</italic> neurolocomotion (specifically motor neurons, muscles, and proprioception). The authors discuss how this model functions as a relaxation-oscillator in the discussion, but I think it would be stronger in this section.</p><p>(R3.3) Intro or discussion – In addition to Cohen's group's models, two recent modeling papers from other modeling groups have investigated the <italic>C. elegans</italic> neurolocomotion system explicitly as a chain of coupled neuromechanical oscillators (Olivares et al., 2021 doi:10.3389/fncom.2021.572339 and Johnson et al., 2021 doi:10.1137/20M1346122). In particular, Johnson et al., 2021 show how phase-response properties influence coordination of the neuromechanical oscillators. Describing how your computational model compares with or supports these other recent models would help give context to the modeling contribution of this work.</p><p>(R3.14) Lines 311-313: The authors mention that sawtooth PRCS &quot;may reflect a phase-resetting property of an oscillator with respect to a perturbation&quot;. I think more detail would be helpful here. To my knowledge, this is referring to the idea that if an oscillator gets a really strong perturbation, the phase-response curve turns into a &quot;phase-resetting curve&quot;, where the large perturbation essentially resets the phase of the oscillator, and then it just marches forward linearly through time. Are you suggesting that this sawtooth shape is indicative of your perturbation being large? This would be an important detail to include.</p><p>(R3.5) Section &quot;Analysis of Alternative Models Supports a Relaxation Oscillation Mechanism&quot;:</p><p>The strength of the author's original computational model is that it is based on specific mechanisms thought to underlie <italic>C. elegans</italic> neurolocomotion (specifically motor neurons, muscles, and proprioception). To support the idea that the underlying mechanism is a relaxation-oscillation, I would suggest that the authors instead analyze their own computational model and show or point out how it functions structurally as a relaxation-oscillation. This is mentioned briefly in the discussion, but I think it would be stronger in this section. Furthermore, I think the authors could give the reader a clearer reason why exactly showing that the mechanism is a relaxation-oscillation is important. To my understanding, the open question in the <italic>C. elegans</italic> locomotion-modeling literature is whether the oscillations are fundamentally neurally-driven (like a CPG or HCO) or reflex-driven (like the proprioceptive mechanism here). Perhaps evidence for the relaxation-oscillation mechanism could be made by considering an alternative mechanistic model with neurally-driven oscillations and whether it can capture the new phase response data.</p><p>(R3.6) The authors have not given adequate description of the model fitting process in the main text. In line 548, you only mention that appropriate parameters were chosen, and reference the supplement. I don't think too much detail is needed here, but explaining that the models were fit to match both the limit cycles and PRCs would be helpful here. My first impression of this section was that the limit cycles were matched and the PRCs were emergent. After looking at the supplementary details I saw that you explicitly attempted to match both results. This would be helpful to put up front.</p><p>(R3.7) Lines 61-64: Sentence grammar/structure. The &quot;but also …&quot; is missing a &quot;not only&quot; earlier in the sentence (e.g. &quot;A comprehensive understanding of animal locomotion should therefore encompass not only neural activity, muscle activity, and sensory feedback, but also biomechanical forces within the animal's body and between the animal and its environment (Figure 1A; 1-3).&quot;).</p><p>(R3.8) Lines 152-153 and Figure 2D caption: I think it would help to clarify in either or both of these places that the boxed portion of the nematode bodies corresponds to the curvature region (0.1-0.3 body coordinates).</p><p>(R3.9) Lines 940-951: The mechanics here depend on the assumption of a traveling wave of fixed wavelength λ down the body. I would mention explicitly that both the wavelength λ and normal drag coefficient CN will be varied with fluid viscosity.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.69905.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>Reviewer #1:</p><p>(R1.1) The authors set out to better understand the dynamics of <italic>C. elegans</italic> locomotion characterizing the rhythmic pattern of the worm's head during locomotion and by generating the phase response curve in that region. The authors then illustrate how well the relaxation-oscillator phenomenological model, with only a handful of free parameters optimized to match the data, is consistent with the observations, including observations under different mechanical loads.</p><p>(R1.2) The authors provide a characterization of the curvature dynamics in the worm's head region (0.1-0.3 body coordinate). The reasoning for focusing on this area in particular is not discussed or justified in the manuscript. Also, no comment is made whether the characteristics observed for the limit cycle in that region is consistent across the rest of the regions. From the experimental description and data shown (i.e., Figure 2B), it would appear that the authors had access to a characterization of the limit cycle across any region of the body of the worm, from head to tail. To avoid the appearance of cherry-picking a region, authors are encouraged to include the full characterization of the limit cycle for all the data available to them. In addition to that, authors are encouraged to clarify explicitly whether the characteristics observed in one region (e.g., nonsinusoidal limit cycle) hold true across the rest of the worm's body. How sinusoidal or nonsinusoidal, non-ellipsoidal, asymmetric is the limit cycle as a function of the body region of the worm, from head to tail? Crucially, if the characterization observed in the selected region is not equally pronounced across the rest of body, it seems crucial to discuss it in the interpretation of the results. This is particularly important given that throughout the manuscript, the authors interpret the results as applicable to the rhythmic generation across the whole body, not just that limited region (see first sentence of the Discussion, for example; and it is also relevant given that they discuss equally proprioceptive feedback in the head as well as in the rest of the body).</p></disp-quote><p>As suggested, we have calculated the limit cycles of bending dynamics as a function of body coordinate from the head to the tail and included the results in the manuscript. We also provide a justification for focusing on the head region for most of our analyses (see Lines 159-162 and Figure 2—figure supplement 1).</p><disp-quote content-type="editor-comment"><p>These points apply to the characterization of the limit cycle given that the data is there but not shown; this is not the case for the phase response analysis, because understanding it for the full body would require further experimentation. However, this should be a point of discussion: is the expectation that the phase response curve through transient ontogenetic inhibition will look similar throughout the body? Is the same sawtooth-shape with the sharp transitions in the same part of the phase expected? What is the implication of the expected results if they are consistent or not consistent with the ones shown for the region focused on here?</p></disp-quote><p>We conducted further experiments to optogenetically inhibit body wall muscles in other regions of a worm besides the head region. The corresponding PRCs are now shown and discussed in the manuscript (see Lines 265-269, and Lines 952-978 and Figure 3—figure supplement 5 in Appendix).</p><disp-quote content-type="editor-comment"><p>(R1.2) The model assumes proprioceptive feedback from the curvature of the same region that is bending. However, the undifferentiated processes that are used as inspiration for this assumption extend posteriorly in the case of SMD and anteriorly in the case of B-class motor neurons. So the assumption that the curvature in one region can affect the bending in that same region should be discussed.</p></disp-quote><p>The threshold-switch model as well as the other models are developed based on experimental observations of the head region, defined as the body coordinate interval between 0.1 and 0.3, which is about 200 μm long. The asynaptic processes in the posterior portion of the SMD neurons are ~40 μm long (c.f. the graphical abstract for Reid et al., Neuroscience 2015, PMID: 26480814) and have been covered by the region of our analyses. The asynaptic processes in the anterior portion of the near-head Btype motor neurons are 100~200 μm long (see Figure 1 in Chen et al., PNAS 2006, PMID: 16537428) where most of the processes have also been covered by the region of our analyses. Therefore, the processes of the candidate proprioceptors (SMD and anterior B-type motor neurons) could affect the bending in the analyzed region.</p><disp-quote content-type="editor-comment"><p>(R1.3) The model also assumes that the stretch receptors sense both the curvature and the rate of curvature. However, the authors provide no evidence of other <italic>C. elegans</italic> neurons where both of those can be sensed simultaneously. It seems feasible that a neuron might be sensitive to either the curvature or the rate of curvature, but it seems less feasible that the neuron would be sensitive to a linear combination of both. This seems to be a central assumption of the model, with little or no justification.</p></disp-quote><p>First, it does not seem at all implausible to us that a <italic>C. elegans</italic> neuron might be sensitive to a combination of curvature and rate of change of curvature. For example, in rat dorsal root ganglia, rapidly-adapting (RA) and intermediate-adapting (IA) mechanosensors encode a combination of stimulus size and velocity. See for example Figure 1 in Rugiero et al., J Physiol 2010 (PMID: 19948656).</p><p>Second, even if we assume a single neuron is not sensitive to a combination of curvature and rate of change of curvature, a collection of neurons involved in motor rhythm generation may be. The stretch receptors in our model might be considered as a collective behavior of curvature-sensing neurons and curvature-change-sensing</p><p>neurons.</p><p>We have revised this discussion to clarify these points (see Lines 714-729).</p><disp-quote content-type="editor-comment"><p>(R1.4) I commend the authors for comparing their selected model with other similar ones. I would highly encourage that the authors include a comparison of the models into the main manuscript. In particular, given the similarities between the results, I would highly encourage the authors to place the results of their chosen model next to the alternatives (it can be a figure like S10 but including the preferred model). As it is, with the alternatives in S10 and the rest of the figures from the best model in the main text, the comparison is significantly harder.</p></disp-quote><p>As suggested, we have added our primary model to the comparison between all models (see Figure 5—figure supplement 1 and Figure 6—figure supplement 2).</p><disp-quote content-type="editor-comment"><p>(R1.5) Finally, the discussion of previous relevant computational models of <italic>C. elegans</italic> locomotion is rather limited. There are at least four particularly relevant contributions that the authors do not discuss in relation to their own contribution:</p><p>(a) Johnson, Lewis, and Guy (2020) Neuromechanical Mechanisms of Gait Adaptation in <italic>C. elegans</italic>: Relative Roles of Neural and Mechanical Coupling.</p><p>(b) Izquierdo and Beer (2018) From head to tail: a neuromechanical model of forward locomotion in <italic>Caenorhabditis elegans</italic>.</p><p>(c) Kunert, Proctor, Brunton, Kutz (2017) Spatiotemporal feedback and network structure drive and encode <italic>Caenorhabditis elegans</italic> locomotion</p><p>(d) Denham, Ranner, Cohen (2018) Signatures of proprioceptive control in <italic>Caenorhabditis elegans</italic> locomotion.</p></disp-quote><p>We thank the reviewer for these suggestions. These models have been cited and discussed in the revised manuscript (see Lines 117-119, 639-640, 646-648, and 672-674).</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>(R2.1) The paper's conclusions are supported by the data and the experiments and model results are clearly presented. In some cases there could be more analysis of uncertainty. For example, how consistent is the phase portrait? This could be illustrated by including some individual traces and/or by estimating a confidence interval (using resampling if necessary).</p></disp-quote><p>As suggested, we have added 10 randomly selected individual traces to the average</p><p>trace shown in Figure 2D.</p><disp-quote content-type="editor-comment"><p>A different kind of uncertainty that should be explained is that arising from fitting the model. Was the optimisation sensitive to the choice of starting parameters? Are there several local minima that explain the data reasonably well or did the optimisation always converge to the same parameter values?</p></disp-quote><p>Our fitting procedure for optimizing model parameters was not sensitive to the initial choices. For each individual model developed in this manuscript, the parameters were determined via a two-round fitting procedure as discussed in Results (Lines 367-373) and Appendix (Lines 1217-1248). In the first round, a model’s parameters were optimized to match the experimental free locomotion, using cost functions shown in Equation S7 (for threshold-switch model) and Table S1 (for alternative models). During this round, the parameters converged to a unique set of values since there is only one local minimum within the range of parameters (a large range of parameters that could generate oscillation). In the second round, the remaining undetermined parameters were optimized to match the experimental PRC curve using a global minimum search strategy within a range of parameters. Since it is a global search algorithm, the optimization is independent of the choice of initial parameters.</p><disp-quote content-type="editor-comment"><p>(R2.2) The authors have focused on forward locomotion bouts and have also eliminated cycles with a period that deviated more than 20% from the average across worms within a session. How many of the bouts were eliminated with this threshold?</p></disp-quote><p>Under the threshold 20%, 857 out of 1910 trials (~45%) that deviated from the average period were eliminated.</p><disp-quote content-type="editor-comment"><p>Are any of the conclusions of the paper sensitive to this threshold?</p></disp-quote><p>None of the conclusions of the paper are sensitive to the threshold. We measured the PRC and limit cycle under thresholds up to 50% (343 out of 1910 bouts (~18%) were dropped), and down to 10% (1270 out of 1910 bouts (67%) were dropped). We find that the resulting curves are largely independent of the choice of threshold (see <xref ref-type="fig" rid="respfig1">Author response image 1</xref>).</p><fig id="respfig1"><label>Author response image 1.</label><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-69905-resp-fig1-v2.tif"/></fig><disp-quote content-type="editor-comment"><p>(R2.3) The authors have convincingly ruled out the van der Pol and Stuart-Landau oscillators but the Rayleigh oscillator fits the data quite well with three parameters. Some quantification of the relative fit quality of the threshold-switch model and the Rayleigh might help guide future work.</p></disp-quote><p>As now shown in Figure 5—figure supplement 1, the threshold-switch model fits the experimental PRC better than Rayleigh model by a considerable margin in terms of mean square error (threshold-switch: 0.12; vdP: 0.21; Rayleigh: 0.37).</p><disp-quote content-type="editor-comment"><p>(R2.4) Finally, the discussion does a good job of putting the results of the phenomenological threshold-switch model in the context of previously published detailed models but it might be strengthened with more quantitative comparisons. For example, do the observed muscle switching time scales or the nature of the proprioceptive threshold rule out or usefully constrain any of the detailed models?</p></disp-quote><p>As suggested, we have added an extensive discussion to acknowledge the potential usefulness of parameters measurements for constraining detailed models (see Lines 660-674).</p><disp-quote content-type="editor-comment"><p>(R2.5) The schematic figures (1 and 4) would be improved by leaving out the abbreviations. At a minimum, include (BWM) after 'body wall muscles' in the caption of figure 1.</p></disp-quote><p>We have added the full names for all the abbreviations shown in the Figures (1 and 4) and the corresponding captions.</p><disp-quote content-type="editor-comment"><p>(R2.6) Would a different colour map make Figure S2 clearer? Jet makes some regions stand out more than is warranted. For example, the purple patch in the lower right corner and red patch in the upper left corder are visually very salient but are probably just normal fluctuations within the noise.</p></disp-quote><p>We have changed this figure to have a cyclic color map with a constant lightness which avoids visual emphasis on certain parts of the fluctuations (see Figure 3— figure supplement 2).</p><disp-quote content-type="editor-comment"><p>(R2.7) In Figure 3, grey is used to indicate the control data in B but is used for individual trials in subsequent panels. Use a different colour for controls in B? Also add the grey curves to the legend next to D rather than only describing them in the caption.</p></disp-quote><p>As suggested, we have revised Figure 3 and its caption.</p><disp-quote content-type="editor-comment"><p>(R2.8) Line 299, state the gene name of the GABA receptor.</p></disp-quote><p>We have added the gene information in the main text (Lines 307-309) and the figure captions (Figure 3—figure supplement 8). Also, strain names that previously appeared in figure captions have been moved to Methods.</p><disp-quote content-type="editor-comment"><p>(R2.9) In the Appendix there are a few cases of missing articles (for example line 812, &quot;worm's head&quot; should be &quot;the worm's head&quot; and on line 886 &quot;animal's&quot; should be &quot;the animal's&quot;)</p></disp-quote><p>We have corrected the multiple missing articles pointed out by the reviewer.</p><disp-quote content-type="editor-comment"><p>(R2.10) Starting on line 817, D^C is used to denote the distance from the origin over the normal cycle. To avoid confusion with the scaling constant c, perhaps choose a different symbol for the scaling constant or to indicate the normal cycle?</p></disp-quote><p>We have used a different symbol for the scaling constant (see Figure 3—figure supplement 2 and Lines 838-867).</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>(R3.1) The main suggestion I have is to change the framing of the section &quot;The Analysis of Alternative Models Supports a Relaxation Oscillation Mechanism'. In the first paragraph, the authors state that the purpose of this section is to &quot;[ask] whether other models could also explain our findings.&quot; However, the section title and final paragraph suggest that the purpose of the section is to support the idea that the underlying oscillatory mechanism is a relaxation-oscillation. If my understanding of the authors' purpose here is correct, then I don't think the analysis of these three specific phenomenological models provides evidence of this. Specifically, the last paragraph of this section (Lines 586-590), suggests that because the non-relaxation oscillator (Stuart-Landau) was not able to capture your results (non-sinusoidal limit cycle and sawtooth PRCs), the underlying mechanism is a relaxation-oscillation. I don't think these models support that claim, because a different non-relaxation oscillator tuned precisely may be able to capture these results. I think a much more thorough analysis of general oscillator dynamics would be needed to make such a claim. To be clear, I think the paper is strong enough without this analysis, I would just be more cautious about the claims here.</p></disp-quote><p>We agree that our investigation of a few alternative models may not lead to the conclusion claimed by the original section title. We have rephrased this section and changed its title appropriately (see Lines 551-608).</p><disp-quote content-type="editor-comment"><p>(R3.2) The strength of the author's original computational model is that it is based on specific mechanisms thought to underlie <italic>C. elegans</italic> neurolocomotion (specifically motor neurons, muscles, and proprioception). The authors discuss how this model functions as a relaxation-oscillator in the discussion, but I think it would be stronger in this section.</p></disp-quote><p>See response to R3.5.</p><disp-quote content-type="editor-comment"><p>(R3.3) Intro or discussion – In addition to Cohen's group's models, two recent modeling papers from other modeling groups have investigated the <italic>C. elegans</italic> neurolocomotion system explicitly as a chain of coupled neuromechanical oscillators (Olivares et al., 2021 doi:10.3389/fncom.2021.572339 and Johnson et al., 2021 doi:10.1137/20M1346122). In particular, Johnson et al., 2021 show how phase-response properties influence coordination of the neuromechanical oscillators. Describing how your computational model compares with or supports these other recent models would help give context to the modeling contribution of this work.</p></disp-quote><p>As suggested, we have discussed and cited these two papers in the Introduction (Lines 117-119) and Discussion (Lines 639-641, 646-648, and 672-674).</p><disp-quote content-type="editor-comment"><p>(R3.14) Lines 311-313: The authors mention that sawtooth PRCS &quot;may reflect a phase-resetting property of an oscillator with respect to a perturbation&quot;. I think more detail would be helpful here. To my knowledge, this is referring to the idea that if an oscillator gets a really strong perturbation, the phase-response curve turns into a &quot;phase-resetting curve&quot;, where the large perturbation essentially resets the phase of the oscillator, and then it just marches forward linearly through time. Are you suggesting that this sawtooth shape is indicative of your perturbation being large? This would be an important detail to include.</p></disp-quote><p>We did not intend the term phase resetting to be different from phase response in our manuscript. We apologize for any confusion and have revised this passage.</p><p>To the main point of the question, we did also perform the PRC experiments with weaker stimuli (0.055 s muscle inhibition, Figure 3—figure supplement 4), which resulted in a similar sawtooth-shaped PRC.</p><disp-quote content-type="editor-comment"><p>(R3.5) Section &quot;Analysis of Alternative Models Supports a Relaxation Oscillation Mechanism&quot;:</p><p>The strength of the author's original computational model is that it is based on specific mechanisms thought to underlie <italic>C. elegans</italic> neurolocomotion (specifically motor neurons, muscles, and proprioception). To support the idea that the underlying mechanism is a relaxation-oscillation, I would suggest that the authors instead analyze their own computational model and show or point out how it functions structurally as a relaxation-oscillation. This is mentioned briefly in the discussion, but I think it would be stronger in this section.</p></disp-quote><p>In Discussion (Lines 675-680 and 694-702), we have explained how our model satisfies the properties of a relaxation oscillator. In the caption of Figure 4A and Appendix (Lines 1018-1030), each site respectively contains a step-by-step explanation of how our model is constructed as a relaxation oscillator.</p><disp-quote content-type="editor-comment"><p>Furthermore, I think the authors could give the reader a clearer reason why exactly showing that the mechanism is a relaxation-oscillation is important. To my understanding, the open question in the <italic>C. elegans</italic> locomotion-modeling literature is whether the oscillations are fundamentally neurally-driven (like a CPG or HCO) or reflex-driven (like the proprioceptive mechanism here). Perhaps evidence for the relaxation-oscillation mechanism could be made by considering an alternative mechanistic model with neurally-driven oscillations and whether it can capture the new phase response data.</p></disp-quote><p>As highlighted in Introduction/Discussion (Lines 120-125, 655-659, and 725-729) and described in Results/Appendix (Figure 4A, Lines 349-373 and 985-1041), our model is designed to be a phenomenological model that does not specify the neural and synaptic details of the motor circuit but rather capture the essential mechanisms underlying motor rhythm generation. We have compared our model with several alternatives based on other types of oscillators. We feel that consideration of alternative models with neurally-driven oscillations would be interesting but beyond the scope of the work.</p><p>In our view, the importance of showing that <italic>C. elegans</italic> locomotion operates by a relaxation-oscillation mechanism is reflected by demonstrating how and why such a simple model with a few parameters could capture several different experimental observations (free-locomotion, phase responses, and gait adaptation to external load), and in the potential to obtain an integrative understanding of how an organism</p><p>generates behavior.</p><disp-quote content-type="editor-comment"><p>(R3.6) The authors have not given adequate description of the model fitting process in the main text. In line 548, you only mention that appropriate parameters were chosen, and reference the supplement. I don't think too much detail is needed here, but explaining that the models were fit to match both the limit cycles and PRCs would be helpful here. My first impression of this section was that the limit cycles were matched and the PRCs were emergent. After looking at the supplementary details I saw that you explicitly attempted to match both results. This would be helpful to put up front.</p></disp-quote><p>As suggested, we have moved the two-round fitting procedure to the beginning of the corresponding Result section to better clarify this process (see Lines 369-373). More details can also be found in the Appendix (Lines 1217-1248)</p><disp-quote content-type="editor-comment"><p>(R3.7) Lines 61-64: Sentence grammar/structure. The &quot;but also …&quot; is missing a &quot;not only&quot; earlier in the sentence (e.g. &quot;A comprehensive understanding of animal locomotion should therefore encompass not only neural activity, muscle activity, and sensory feedback, but also biomechanical forces within the animal's body and between the animal and its environment (Figure 1A; 1-3).&quot;).</p></disp-quote><p>Thanks for pointing out this grammatical error. We have corrected this.</p><disp-quote content-type="editor-comment"><p>(R3.8) Lines 152-153 and Figure 2D caption: I think it would help to clarify in either or both of these places that the boxed portion of the nematode bodies corresponds to the curvature region (0.1-0.3 body coordinates).</p></disp-quote><p>As suggested, we have clarified the contents in both places that the boxed region indicates the anterior region of the worm body (0.1-0.3 body coordinates).</p><disp-quote content-type="editor-comment"><p>(R3.9) Lines 940-951: The mechanics here depend on the assumption of a traveling wave of fixed wavelength λ down the body. I would mention explicitly that both the wavelength λ and normal drag coefficient CN will be varied with fluid viscosity.</p></disp-quote><p>As suggested, we have modified this subsection to acknowledge that the derivation of the mechanics depends on the assumption of a travelling wave with a fixed wavelength (see Lines 1004-1017). The dependence of the wavelength and drag coefficient on the viscosity has been noted after the derivation.</p></body></sub-article></article>