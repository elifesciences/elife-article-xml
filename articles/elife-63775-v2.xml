<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">63775</article-id><article-id pub-id-type="doi">10.7554/eLife.63775</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Biochemistry and Chemical Biology</subject></subj-group></article-categories><title-group><article-title>Mapping the functional landscape of the receptor binding domain of T7 bacteriophage by deep mutational scanning</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-213815"><name><surname>Huss</surname><given-names>Phil</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4064-9333</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-214285"><name><surname>Meger</surname><given-names>Anthony</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-214286"><name><surname>Leander</surname><given-names>Megan</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-214287"><name><surname>Nishikawa</surname><given-names>Kyle</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" corresp="yes" id="author-210158"><name><surname>Raman</surname><given-names>Srivatsan</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2461-1589</contrib-id><email>sraman4@wisc.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf3"/></contrib><aff id="aff1"><label>1</label><institution>Department of Biochemistry, University of Wisconsin-Madison</institution><addr-line><named-content content-type="city">Madison</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution>Department of Bacteriology, University of Wisconsin-Madison</institution><addr-line><named-content content-type="city">Madison</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution>Department of Chemical and Biological Engineering, University of Wisconsin-Madison</institution><addr-line><named-content content-type="city">Madison</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="senior_editor"><name><surname>Storz</surname><given-names>Gisela</given-names></name><role>Senior Editor</role><aff><institution>National Institute of Child Health and Human Development</institution><country>United States</country></aff></contrib><contrib contrib-type="editor"><name><surname>Turnbaugh</surname><given-names>Peter</given-names></name><role>Reviewing Editor</role><aff><institution>University of California, San Francisco</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>09</day><month>03</month><year>2021</year></pub-date><pub-date pub-type="collection"><year>2021</year></pub-date><volume>10</volume><elocation-id>e63775</elocation-id><history><date date-type="received" iso-8601-date="2020-10-07"><day>07</day><month>10</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2021-03-04"><day>04</day><month>03</month><year>2021</year></date></history><permissions><copyright-statement>© 2021, Huss et al</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>Huss et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-63775-v2.pdf"/><related-article ext-link-type="doi" id="ra1" related-article-type="commentary" xlink:href="10.7554/eLife.68277"/><abstract><p>The interaction between a bacteriophage and its host is mediated by the phage's receptor binding protein (RBP). Despite its fundamental role in governing phage activity and host range, molecular rules of RBP function remain a mystery. Here, we systematically dissect the functional role of every residue in the tip domain of T7 phage RBP (1660 variants) by developing a high-throughput, locus-specific, phage engineering method. This rich dataset allowed us to cross compare functional profiles across hosts to precisely identify regions of functional importance, many of which were previously unknown. Substitution patterns showed host-specific differences in position and physicochemical properties of mutations, revealing molecular adaptation to individual hosts. We discovered gain-of-function variants against resistant hosts and host-constricting variants that eliminated certain hosts. To demonstrate therapeutic utility, we engineered highly active T7 variants against a urinary tract pathogen. Our approach presents a generalized framework for characterizing sequence–function relationships in many phage–bacterial systems.</p></abstract><abstract abstract-type="executive-summary"><title>eLife digest</title><p>Bacteria can cause diseases, but they also battle their own microscopic enemies: a group of viruses known as bacteriophages. For instance, the T7 bacteriophage preys on various strains of <italic>Escherichia coli</italic>, a type of bacteria often found in the human gut. While many <italic>E. coli</italic> strains are inoffensive or even beneficial to human health, some can be deadly. Finding a way to kill harmful strains while sparing the helpful ones would be a helpful addition to the medicine toolkit.</p><p>Bacteriophages identify and interact with their specific target through a structure known as the receptor binding protein, or RBP. However, it is still unclear exactly how RBP helps the viruses recognize which type of bacteria to infect. Here, Huss et al. set to map out and modify this structure in T7 bacteriophage so the virus is more efficient and specific about which strain of <italic>E. coli</italic> it kills.</p><p>First, the role of each building block in the tip of RBP was meticulously dissected; this generated the knowledge required to genetically engineer a large number of different T7 bacteriophages, each with a slightly variation in their RBP. These viruses were then exposed to various strains of bacteria. Monitoring the bacteriophages that survived and multiplied the most after infecting different strains of <italic>E. coli</italic> revealed which RBP building blocks are important for efficiency and specificity. This was then confirmed by engineering highly active T7 bacteriophage variants against an <italic>E. coli</italic> strain that causes urinary tract infections.</p><p>These findings demonstrate that even small changes to the bacteriophages can make a big difference to their ability to infect their preys. The approaches developed by Huss et al. help to understand exactly how the RBP allows a virus to infect a specific type of bacteria; this could one day pave the way for new therapies that harness those viruses to fight increasingly resistant bacterial infections.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>Bacteriophage</kwd><kwd>phage</kwd><kwd>virus</kwd><kwd>deep mutational scanning</kwd><kwd>synthetic biology</kwd><kwd>tail fiber</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Virus</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000199</institution-id><institution>U.S. Department of Agriculture</institution></institution-wrap></funding-source><award-id>WIS02066</award-id><principal-award-recipient><name><surname>Raman</surname><given-names>Srivatsan</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000865</institution-id><institution>Bill and Melinda Gates Foundation</institution></institution-wrap></funding-source><award-id>OPP1150209</award-id><principal-award-recipient><name><surname>Raman</surname><given-names>Srivatsan</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000015</institution-id><institution>U.S. Department of Energy</institution></institution-wrap></funding-source><award-id>DE-SC0018409</award-id><principal-award-recipient><name><surname>Meger</surname><given-names>Anthony</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>NIH</institution></institution-wrap></funding-source><award-id>T32 GM08293</award-id><principal-award-recipient><name><surname>Leander</surname><given-names>Megan</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>NIH</institution></institution-wrap></funding-source><award-id>T32 GM07215</award-id><principal-award-recipient><name><surname>Nishikawa</surname><given-names>Kyle</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution>Robert and Katherine Burris</institution></institution-wrap></funding-source><award-id>BiochemistryFund</award-id><principal-award-recipient><name><surname>Nishikawa</surname><given-names>Kyle</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>An unbiased mutational screen decodes the molecular basis of phage receptor interactions, identifies key functional regions determining activity and host range, and demonstrates the potential for engineering therapeutic phages.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Bacteriophages (or ‘phages’) shape microbial ecosystems by infecting and killing targeted bacterial species. As a result, they are promising tools for treatment of antibiotic-resistant bacterial infections and microbiome manipulation (<xref ref-type="bibr" rid="bib7">Canfield and Duerkop, 2020</xref>; <xref ref-type="bibr" rid="bib8">Chen et al., 2014</xref>; <xref ref-type="bibr" rid="bib10">Clokie et al., 2011</xref>; <xref ref-type="bibr" rid="bib13">Dedrick et al., 2019</xref>; <xref ref-type="bibr" rid="bib38">Kilcher and Loessner, 2019</xref>; <xref ref-type="bibr" rid="bib41">Kutter et al., 2015</xref>; <xref ref-type="bibr" rid="bib50">Mizuno et al., 2020</xref>; <xref ref-type="bibr" rid="bib61">Sausset et al., 2020</xref>; <xref ref-type="bibr" rid="bib62">Schooley et al., 2017</xref>; <xref ref-type="bibr" rid="bib63">Shen et al., 2015</xref>; <xref ref-type="bibr" rid="bib64">Shkoporov and Hill, 2019</xref>; <xref ref-type="bibr" rid="bib12">De Sordi et al., 2019</xref>). Interaction of phages with their bacterial receptors is a key determinant of their host range and virulence (<xref ref-type="bibr" rid="bib6">Bertozzi Silva et al., 2016</xref>; <xref ref-type="bibr" rid="bib11">de Jonge et al., 2019</xref>; <xref ref-type="bibr" rid="bib60">Rousset et al., 2018</xref>). This interaction is primarily mediated by the receptor binding proteins (RBPs) of the phage (<xref ref-type="bibr" rid="bib52">Nobrega et al., 2018</xref>). RBPs enable phages to adsorb to diverse cell surface molecules, including proteins, polysaccharides, lipopolysaccharides (LPS), and carbohydrate-binding moieties. Phages exhibit high functional plasticity through genetic alterations to RBPs and by natural and laboratory-guided evolution, which can modulate activity and host range to different hosts and environments (<xref ref-type="bibr" rid="bib2">Ando et al., 2015</xref>; <xref ref-type="bibr" rid="bib9">Chen et al., 2017</xref>; <xref ref-type="bibr" rid="bib13">Dedrick et al., 2019</xref>; <xref ref-type="bibr" rid="bib14">Dunne et al., 2019</xref>; <xref ref-type="bibr" rid="bib22">Garcia et al., 2003</xref>; <xref ref-type="bibr" rid="bib24">Gebhart et al., 2017</xref>; <xref ref-type="bibr" rid="bib29">Holtzman et al., 2020</xref>; <xref ref-type="bibr" rid="bib45">Lin et al., 2012</xref>; <xref ref-type="bibr" rid="bib49">Meyer et al., 2012</xref>; <xref ref-type="bibr" rid="bib67">Yehl et al., 2019</xref>; <xref ref-type="bibr" rid="bib68">Yosef et al., 2017</xref>). In essence, survivability of a phage is intimately linked to the adaptability of its RBP. The challenge now is to understand the molecular code of RBPs in sufficient depth to enable predictable manipulation of host range and virulence. We sought to do so by combining deep mutational scanning (DMS) of the RBP with powerful selections on multiple hosts.</p><p>Although RBPs remain the focus of many mechanistic, structural, and evolutionary studies and are a prime target for engineering, we currently lack a systematic and comprehensive understanding of how RBP mutations influence phage activity and host range. Though insightful, directed evolution enriches only a small group of ‘winners’, which makes it difficult to glean a comprehensive mutational landscape of the RBP (<xref ref-type="bibr" rid="bib29">Holtzman et al., 2020</xref>). Random mutagenesis-based screens generate multi-mutant variants whose individual effects cannot be easily deconvolved (<xref ref-type="bibr" rid="bib14">Dunne et al., 2019</xref>; <xref ref-type="bibr" rid="bib67">Yehl et al., 2019</xref>). Other approaches including swapping homologous RBPs lead to gain of function; however, the underlying molecular determinants of function can be difficult to explain (<xref ref-type="bibr" rid="bib2">Ando et al., 2015</xref>; <xref ref-type="bibr" rid="bib9">Chen et al., 2017</xref>; <xref ref-type="bibr" rid="bib24">Gebhart et al., 2017</xref>; <xref ref-type="bibr" rid="bib68">Yosef et al., 2017</xref>). In summary, despite the extraordinary functional potential of phage RBPs, how systematic changes to their sequence shape the overall functional landscape of a phage remains unknown.</p><p>Here, we carried out DMS, a high-throughput experimental technique, of the tip domain of the T7 phage RBP (tail fiber) to uncover molecular determinants of activity and host range. The tip domain is the distal region of the tail fiber that makes primary contact with the host receptor (<xref ref-type="bibr" rid="bib26">González-García et al., 2015</xref>; <xref ref-type="bibr" rid="bib51">Molineux, 2001</xref>; <xref ref-type="bibr" rid="bib56">Qimron et al., 2006</xref>). We developed ORACLE (<bold>O</bold>ptimized <bold>R</bold>ecombination, <bold>Ac</bold>cumulation, and <bold>L</bold>ibrary <bold>E</bold>xpression), a high-throughput, locus-specific, phage genome engineering method to create a large, unbiased library of phage variants at a targeted gene locus. Using ORACLE, we systematically and comprehensively mutated the tip domain by making all single amino acid substitutions at every site (1660 variants) and quantified the functional role of all variants on multiple bacterial hosts. We generated high-resolution functional maps delineating regions concentrated with function-enhancing substitutions and host-specific substitutional patterns, many of which were previously unknown. We discovered T7 variants with far greater virulence than wildtype T7, demonstrating that even those natural phages that are well adapted to a host can be engineered for higher efficacy.</p><p>However, many variants highly adapted to one host performed poorly on others, underscoring a tradeoff between activity and host range. This functional screening highlights ideal regions of the tip domain for engineering host range. Furthermore, we demonstrated the functional potential of RBPs by discovering gain-of-function variants against resistant hosts and host-constriction variants that selectively eliminate specific hosts. To demonstrate the therapeutic value of ORACLE, we engineered T7 variants that avert emergence of spontaneous resistance in pathogenic <italic>Escherichia coli</italic> causing urinary tract infections (UTIs).</p><p>Our study explains the molecular drivers of adaptability of the tip domain and identifies key functional regions determining activity and host range. ORACLE provides a generalized framework to describe sequence–function relationships in phages to elucidate the molecular basis of phages, the most abundant life form on earth.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Creating an unbiased library of phage variants using ORACLE</title><p>ORACLE is a high-throughput precision phage genome engineering technology designed to create a large, unbiased library of phage variants to investigate sequence–function relationships in phages. ORACLE overcomes three major hurdles. First, phage variants are created during the natural infection cycle of the phage, which eliminates a common bottleneck from transforming DNA libraries. By recombining a donor cassette containing prespecified variants to a targeted site on the phage genome, ORACLE allows sequence programmability and generalizability to phages with transformable bacterial hosts capable of maintaining a plasmid library. Second, ORACLE minimizes library bias that can rapidly arise due to fitness advantage or deficiency of any variant on the propagating host that may then be amplified due to exponential phage growth. Minimizing bias is critical because variants that perform poorly on a propagating host but well on targeted hosts may disappear during propagation. Third, ORACLE prevents extreme abundance of wildtype over variants, which allows for resolving and scoring even small functional differences between variants. The development of this technology was necessary to overcome challenges with existing engineering approaches for creating a large, unbiased phage library. Direct transformation of phage libraries, while ideal for creating one or small groups of synthetic phages, will not work because phage genomes are typically too large for library transformation (<xref ref-type="bibr" rid="bib2">Ando et al., 2015</xref>; <xref ref-type="bibr" rid="bib37">Kilcher et al., 2018</xref>; <xref ref-type="bibr" rid="bib47">Marinelli et al., 2008</xref>; <xref ref-type="bibr" rid="bib48">Marinelli et al., 2019</xref>). Homologous recombination has low, variable recombination rates and high levels of wildtype phage are retained, which mask library members (<xref ref-type="bibr" rid="bib54">Pires et al., 2016</xref>; <xref ref-type="bibr" rid="bib67">Yehl et al., 2019</xref>). Libraries of lysogenic phages could potentially be made using conventional bacterial genome engineering tools as the phage integrates into the host genome. However, this approach is not applicable to obligate lytic phages. Our desire to develop ORACLE for obligate lytic phages is motivated by their mandated use for phage therapy. Any phage, including lysogenic phages, with a sequenced genome and a transformable host that can maintain a plasmid library should be amenable to ORACLE.</p><p>ORACLE is carried out in four steps: (a) making acceptor phage, (b) inserting gene variants through recombination, (c) accumulating recombined phages, and (d) expressing the library for selection (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). An ‘acceptor phage’ is a synthetic phage genome where the gene of interest (i.e., tail fiber) is replaced with a fixed sequence flanked by Cre recombinase sites to serve as a landing site for inserting variants (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). We created T7 acceptor phages by assembling PCR fragments of the phage genome in yeast (<xref ref-type="bibr" rid="bib2">Ando et al., 2015</xref>; <xref ref-type="bibr" rid="bib33">Jaschke et al., 2012</xref>) (see Materials and methods). T7 acceptor phages lacking a wildtype tail fiber gene cannot plaque on <italic>E. coli</italic> and do not spontaneously reacquire the tail fiber during propagation (<xref ref-type="fig" rid="fig1">Figure 1B,</xref> <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2A</xref>). Furthermore, the T7 acceptor phages have no plaquing deficiency relative to wildtype when the tail fiber gene is provided from a helper plasmid (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2A</xref>). Thus, the tail fiber gene is decoupled from the rest of the phage genome for interrogation of function. Next, phage variants are generated within the host during the infection cycle by <bold>O</bold>ptimized <bold>R</bold>ecombination by inserting tail fiber variants from a donor plasmid into the landing sites in the acceptor phage using site-specific recombination. To minimize biasing of variants during propagation, a helper plasmid constitutively provides the wildtype tail fiber in trans such that all progeny phages can amplify comparably regardless of the fitness benefit or deficient of any variant. At this stage, we typically have approximately 1 recombined phage among 1000 acceptor phages (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). To enrich recombined phages in this pool, we passage all progeny phages on <italic>E. coli</italic> expressing Cas9 and a gRNA targeting the fixed sequence flanked by recombinase sites we introduced into the acceptor phage. The helper plasmid is retained during this stage to continue minimizing bias by providing the wildtype tail fiber in trans. As a result, only unrecombined phages will be inhibited while recombined phages with tail fiber variants are <bold>Ac</bold>cumulated without bias. The Cas9-gRNA system successfully inhibits acceptor phages but has no effect on plaquing of untargeted phages (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2A–D</xref>). Recombined phages were highly enriched by over one thousandfold in the phage population when an optimized gRNA targeting the fixed sequence was used, whereas a randomized control gRNA yielded no enrichment of recombined phages (<xref ref-type="fig" rid="fig1">Figure 1D,</xref> <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2E, F</xref>). In the final step, phages are propagated on <italic>E. coli</italic> which lack the helper plasmid that previously provided the wildtype tail fiber in trans to prevent bias. In this <bold>L</bold>ibrary <bold>E</bold>xpression, propagation on this host allows for full expression of the library variant – this is the first time during library creation that the variant is fully expressed on the phage particle. We sequenced the distribution of the library of tail fiber variants integrated on the phage genome after ORACLE. We compared this distribution to the distribution of variants on the recombination plasmid library to evaluate how effective ORACLE was at integrating variants and preventing bias during library creation. The post-ORACLE phages were mildly skewed toward more abundant members but remained generally evenly distributed and comparable to the distribution of variants in the input donor plasmid library, retaining 99.8% coverage (<xref ref-type="fig" rid="fig1">Figure 1E</xref>). Comparison of variant libraries with and without DNAse treatment was well correlated (R = 0.994), indicating no unencapsidated phage genomes influenced library distribution (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>). In summary, ORACLE is a generalizable tool for creating large, unbiased variant libraries of obligate lytic phages. These phage variants, including those that have a fitness deficiency on the host used to create the library, can all be characterized in a single selection experiment by deep sequencing phage populations before and after selection in a host. Compared to traditional plaque assays, this represents increased throughput by nearly 3–4 orders of magnitude.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title><bold>O</bold>ptimized <bold>R</bold>ecombination, <bold>Ac</bold>cumulation, and <bold>L</bold>ibrary <bold>E</bold>xpression (ORACLE) workflow for creating phage variant libraries.</title><p>(<bold>A</bold>) Schematic illustration of the four steps of ORACLE: creation of acceptor phage, inserting gene variants (<bold><underline>O</underline></bold>ptimized <bold><underline>R</underline></bold>ecombination), enriching recombined phages (<bold><underline>A</underline></bold>ccumulation) and expressing library for selection (<bold><underline>L</underline></bold>ibrary <bold><underline>E</underline></bold>xpression). Color notations are as follows: yellow triangles – Cre recombinase sites, blue colored segments – gene variants, orange colored segment – Cas9, grey colored segments – wild type phage parts including the wildtype tail fiber from the helper plasmid (<bold>B</bold>) Ability of different versions of T7 to infect <italic>E. coli</italic> 10G in stationary (dark gray bar) and exponential (light gray bar) phases by Efficiency of Plating (EOP) using exponential 10G with <italic>gp17</italic> tail fiber helper plasmid as reference host. T7 without tail fiber (T7Δgp17) and T7 Acceptor phages (T7 Acc) cannot visibly plaque, but wildtype T7 (T7 WT), and T7 with <italic>gp17</italic> recombined into the acceptor locus (T7 Rec) plaque efficiently. (<bold>C</bold>) Concentration of total (Total T7) and recombined (T7 Rec) phages after a single passage on host containing Cre recombinase system. Recombination rate is estimated to be ~7.19x10<sup>-4</sup>. (<bold>D</bold>) Percentage of recombined phages in total phages when using gRNA targeting fixed sequence at acceptor site T7 Acc (Targeted) or randomized gRNA (Random). (<bold>E</bold>) Histogram of abundance of variants in the input plasmid library (left) and on the phage genome after ORACLE (right) binned using log proportion centered on equal representation. All data represented as mean ± SD of biological triplicate.</p><p> <supplementary-material id="fig1sdata1"><label>Figure 1—source data 1.</label><caption><title>Deep sequencing summary for phage variant expression library with and without DNAse treatment after <bold>O</bold>ptimized <bold>R</bold>ecombination, <bold>Ac</bold>cumulation, and <bold>L</bold>ibrary <bold>E</bold>xpression (ORACLE).</title><p>Related to <xref ref-type="fig" rid="fig1">Figure 1E</xref> and <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-63775-fig1-data1-v2.xlsx"/></supplementary-material> </p><p> <supplementary-material id="fig1sdata2"><label>Figure 1—source data 2.</label><caption><title>Percentage distribution of each variant in the expression library.</title><p>Related to <xref ref-type="fig" rid="fig1">Figure 1E</xref> and <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-63775-fig1-data2-v2.xlsx"/></supplementary-material> </p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63775-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Sequence rearrangements before and after recombinase-mediated cassette exchange.</title><p>Schematic illustration of sequence rearrangements in acceptor phage and donor plasmid (<bold>A</bold>) before and (<bold>B</bold>) after recombinase-mediated cassette exchange (RMCE). Specific lox recombinase sites required for exchanging sequence cassettes (variant and fixed sequence) are shown. Lox sites have wild type (WT) or mutated inverted repeats (IR) and one-way RMCE can only occur if one IR is wild type, while the m2 spacer forces recombination in the correct orientation and prevents adverse recombination events (<xref ref-type="bibr" rid="bib42">Langer et al., 2002</xref>). Deep sequencing targets the area boxed in red between the 5’ NGS region and 3’ pad on both acceptor phages and the variant library.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63775-fig1-figsupp1-v2.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>Effect of Cas9-gRNA system on acceptor and control phages.</title><p>(<bold>A</bold>) Efficiency of plating (EOP) measurements on <italic>E. coli</italic> 10G in stationary (dark grey bar) and exponential (light gray bar) phases for T7 acceptor phage (T7 Acc) with combinations of gp17 helper plasmid, Cas9-gRNA plasmid with a random guide (gRandom) or targeting guides 1 through 5 (gTarget, g1-g5). T7 acceptor phages cannot plaque without helper plasmid. Their plaquing is unaffected by Cas9-gRNA with a random guide (gRandom). Among five different gRNAs targeting fixed sequence, g3 shows highest targeting efficiency and was used for phage library construction with ORACLE. (<bold>B-D</bold>) The Cas9-gRNA system does not adversely affect the plaquing activity of untargeted phages. Efficiency of plating (EOP) measurements on <italic>E. coli</italic> 10G with combinations of gp17 helper plasmid, Cas9-gRNA plasmid with a random guide or targeting guide 3 (gTarget, g3) for (<bold>B</bold>) T7 phage without gp17 (T7Δgp17), (<bold>C</bold>) wildtype T7 (WT T7) and (<bold>D</bold>) acceptor T7 phage recombined with wildtype gp17 (T7 Rec). (<bold>E</bold> and <bold>F</bold>) Comparison of accumulation of recombined phages (T7 Rec) with respect to total phages using (<bold>E</bold>) 10G with gp17 helper plasmid and Cas9-gRNA (g3) and (<bold>F</bold>) 10G with gp17 helper plasmid and Cas9-gRNA (gRandom). All data shown is biological triplicates (mean + SD), all EOP data uses 10G with gp17 helper as a reference host.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63775-fig1-figsupp2-v2.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 3.</label><caption><title>Correlation between expression library with and without DNAse treatment.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63775-fig1-figsupp3-v2.tif"/></fig></fig-group></sec><sec id="s2-2"><title>DMS of the tip domain shows phage adaptation at molecular resolution</title><p>DMS is a high-throughput experimental technique to characterize sequence–function relationships through large-scale mutagenesis coupled to selection and deep sequencing. The scale and depth of DMS is used to reveal sites critical for activity, host specificity, and stability in a protein. DMS has been employed to study many proteins, including enzymes, transcription factors, signaling domains, and viral surface proteins (<xref ref-type="bibr" rid="bib19">Fowler and Fields, 2014</xref>; <xref ref-type="bibr" rid="bib43">Lee et al., 2018</xref>; <xref ref-type="bibr" rid="bib57">Raman et al., 2014</xref>; <xref ref-type="bibr" rid="bib59">Romero et al., 2015</xref>).</p><p>Bacteriophage T7 is a podovirus that infects <italic>E. coli</italic>. T7 has a short non-contractile tail made up of three proteins, including the tail fiber encoded by <italic>gp17</italic>. Each of the six tail fibers is a homotrimer composed of a relatively rigid shaft ending with a β-sandwich tip domain connected by a short loop (<xref ref-type="bibr" rid="bib23">Garcia-Doval and van Raaij, 2012</xref>). The tip domain is likely the very first region of the tail fiber to interact with host LPS and position the phage for successful, irreversible binding with the host (<xref ref-type="bibr" rid="bib26">González-García et al., 2015</xref>; <xref ref-type="bibr" rid="bib51">Molineux, 2001</xref>; <xref ref-type="bibr" rid="bib56">Qimron et al., 2006</xref>). The tip domain is a major determinant of host range and activity and is often naturally exchanged between phages to readily adapt to new hosts (<xref ref-type="bibr" rid="bib20">Fraser et al., 2006</xref>; <xref ref-type="bibr" rid="bib21">Fraser et al., 2007</xref>; <xref ref-type="bibr" rid="bib45">Lin et al., 2012</xref>). Even single amino acid substitutions to this domain are sufficient to alter host range between <italic>E. coli</italic> strains (<xref ref-type="bibr" rid="bib27">Heineman et al., 2008</xref>). Due to its critical functional role, we chose the tip domain to comprehensively characterize phage activity and host range by DMS.</p><p>We generated a library of 1660 single mutation variants of the tip domain, prespecified as chip-based oligonucleotides, where all 19 non-synonymous and 1 nonsense substitution were made at each codon spanning residue positions 472–554 (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, residue numbering based on PDB 4A0T). Using ORACLE, the library was inserted into T7 to generate variants to be selected and deep sequenced (<xref ref-type="fig" rid="fig2">Figure 2B</xref>) on three laboratory <italic>E. coli</italic> hosts: B strain derivative BL21, K-12 derivative BW25113, and DH10B derivative 10G. Each variant was given a functional score, F, based on the ratio of their relative abundance before and after selection consisting of an estimated four infection cycles, which was then normalized to wildtype to yield F<sub>N</sub>, where wildtype F<sub>N</sub> = 1 (<xref ref-type="fig" rid="fig2">Figure 2C–E</xref>, see Materials and methods). Selection on each host gave excellent correlation across biological triplicates (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). To validate the functional relevance of the screen, we hypothesized that the flexible C-terminal end (residue positions 552–554 and a three-residue extension if the stop codon is substituted) is unlikely to have any structural or host recognition role. As expected, these positions broadly tolerated nearly all substitutions across all three hosts, indicating that the functional scores likely reflect true biological effects (<xref ref-type="fig" rid="fig2">Figure 2C–E</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Deep mutational scanning of tip domain shows phage adaptation at molecular resolution.</title><p>(<bold>A</bold>) Crystal structure and secondary structure topology of the tip domain color coded as interior loops (red), β-sheets (beige) and exterior loops (blue) (<bold>B</bold>) Functional analysis of variants by comparing their abundances pre- and post-selection on a host. (<bold>C-E</bold>) Heat maps showing normalized functional scores (F<sub>N</sub>) of all substitutions (red gradient) and wildtype amino acid (F<sub>N</sub>=1 and black dot upper left) at every position for <italic>E. coli</italic> 10G (<bold>C</bold>), BL21 (D) and BW25113 (<bold>E</bold>). Residue numbering (based on PDB 4A0T), wildtype amino acid and secondary structure topology are shown above left to right, substitutions listed top to bottom. (<bold>F</bold>) Parallel plot showing F<sub>N</sub> for enriched (F<sub>N</sub>≥2) variants on 10G, BL21, and BW25113. Coloring indicates enrichment only on 10G (grey), only on BL21 (red), only on BW25113 (blue) enriched on 10G and BL21 (green). Connecting lines indicate F<sub>N</sub> of the same variant on other hosts. </p><p> <supplementary-material id="fig2sdata1"><label>Figure 2—source data 1.</label><caption><title>Deep sequencing summary for the phage variant library after selection on different hosts.</title><p>Related to <xref ref-type="fig" rid="fig2">Figure 2C–E</xref>.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-63775-fig2-data1-v2.xlsx"/></supplementary-material> </p><p> <supplementary-material id="fig2sdata2"><label>Figure 2—source data 2.</label><caption><title>Variant-specific F<sub>N</sub> for phage variants after selection on <italic>E. coli</italic> 10G, BL21 ,and BW25113 and physicochemical statistics.</title><p>Related to <xref ref-type="fig" rid="fig2">Figure 2C–F</xref>, <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>, and <xref ref-type="fig" rid="fig3">Figure 3</xref>.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-63775-fig2-data2-v2.xlsx"/></supplementary-material> </p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63775-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Correlation between biological replicates after selection of phage variant library on <italic>E. coli</italic> 10G, BL21, and BW25113.</title><p>Correlation of F<sub>N</sub> scores between biological replicates of phage variant library on multiple hosts including (<bold>A</bold>) <italic>E. coli</italic> 10G (<bold>B</bold>) BL21 and (<bold>C</bold>) BW25113. R values and trendlines are displayed for all variants (black line) and with outliers excluded (red line) for 10G with outlier points in red and all other points in grey.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63775-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Distribution, enrichment profile, and physicochemical properties of variants after selection on <italic>E. coli</italic> 10G, BL21, and BW25113.</title><p>Number of variants that were depleted (F<sub>N</sub> ≤ 0.1) tolerated (F<sub>N</sub> &gt;0.1 and &lt;2) or enriched (F<sub>N</sub> ≥ 2) after selection on (<bold>A</bold>) <italic>E. coli</italic> 10G, (<bold>B</bold>), BL21, and (<bold>C</bold>) BW25113, separated by topology of the tip domain color coded as interior loops (red), β-sheets (beige) and exterior loops (blue). (<bold>D</bold>) Average F<sub>N</sub> of enriched variants (F<sub>N</sub> ≥ 2) for 10G (orange squares), BL21 (blue circles), and BW25113 (teal triangles) ordered left to right from lowest to highest F<sub>N</sub>. (<bold>E</bold>) Alluvial distribution of enriched variants (F<sub>N</sub> ≥ 2) on 10G (upper), BL21 (middle) and BW25113 (bottom), showing wild type amino acids (left), their substitution (middle) and topological location on the structure (right). Each alluvial is colored based on the substituted amino acid and scaled by F<sub>N</sub> across hosts. Violin plots comparing (<bold>F</bold>) change in mass, (<bold>G</bold>) change in hydrophilicity, and (<bold>H</bold>) change in hydrophobicity for grouped depleted (F<sub>N</sub> ≤ 0.1) tolerated (F<sub>N</sub> &gt;0.1 and &lt;2) or enriched (F<sub>N</sub> ≥ 2) substitutions on <italic>E. coli</italic> 10G, BL21 and BW25113. p-values are shown if only if &lt;0.05, the upper p-value is the result of a Kruskal-Wallis test among all three groups while pairwise p-values from a Wilcoxon test are shown linking each group.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63775-fig2-figsupp2-v2.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Hierarchical clustering of phage variants based on F<sub>N</sub> score.</title><p>Hierarchical clustering of phage variants based on their F<sub>N</sub> score across <italic>E. coli</italic> 10G, BL21 and BW25113. Variants are shaded in white (F<sub>N</sub> = 0) to red (F<sub>N</sub> = 2+). Only variants with an F<sub>N</sub> above the limit of detection on at least one host are included.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63775-fig2-figsupp3-v2.tif"/></fig></fig-group><p>We compared the activities of phage variants across hosts to assess their fitness and evolutionary adaptation to each host. Between the three hosts, T7 variants appeared most and least adapted to BW25113 and 10G, respectively, as evidenced by the fraction of depleted variants (F<sub>N</sub> &lt; 0.1) after selection on each host (10G: 0.66 ± 0.03; BL21: 0.59 ± 0.01; and BW25113: 0.51 ± 0.01; all significantly different from each other with p&lt;0.05) (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2A–C</xref>). Furthermore, wildtype T7 fared relatively poorly on 10G (F = 0.77 ± 0.05), indicating a fitness impediment, but performed significantly better on BL21 (F = 2.92 ± 0.2, p &lt; 0.01) and BW25113 (F = 2.26 ± 0.1, p &lt; 0.01) (<xref ref-type="supplementary-material" rid="fig2sdata1">Figure 2—source data 1</xref>). The fitness impediment gave many more variants competitive advantage, resulting in greater enrichment (F<sub>N</sub> &gt; 2) over wildtype on 10G (48 variants) compared to BL21 (2 variants) and BW25113 (16 variants) (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2A–C</xref>). In fact, the best performing variants on 10G were 10 times more enriched than wildtype, suggesting substantially higher activity (<xref ref-type="fig" rid="fig2">Figure 2F,</xref> <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2D</xref>). Examining enriched variants on each host (F<sub>N</sub> &gt; 2) provides compelling evidence of the tradeoff between activity and host range (<xref ref-type="fig" rid="fig2">Figure 2F,</xref> <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2E</xref>). The top ranked variants on each host were remarkably distinct from those on other hosts (except G479Q shared between 10G and BL21). Hierarchical clustering of F<sub>N</sub> across all three hosts revealed grouping of similar variants that performed better selectively on some hosts but not others (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>). No variant performed exceptionally well on all hosts (F<sub>N</sub> &gt; 2, <xref ref-type="fig" rid="fig2">Figure 2F</xref>); however, 406 variants were tolerated on all three hosts (<xref ref-type="supplementary-material" rid="fig2sdata2">Figure 2—source data 2</xref>). Thus, specialization toward a host comes at the cost of sacrificing breadth, mirroring observations made of natural phage populations (<xref ref-type="bibr" rid="bib17">Elena et al., 2009</xref>).</p><p>We investigated the global physicochemical properties and topological preferences of substitutions after selection on each host (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2F–H</xref>). On 10G, there was enrichment of larger and more hydrophilic amino acids and depletion of hydrophobic amino acids (all p &lt; 0.001, r &gt; 0.12), which is visually striking on the heatmap (see R, K, and H substitutions in <xref ref-type="fig" rid="fig2">Figure 2C</xref>). In contrast, no significant enrichment or depletion was observed on BL21 (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2F–H</xref>). This is consistent with our earlier observation that wildtype T7 is generally well adapted to BL21 since it had the fewest variants outperforming wildtype. We reasoned that since BL21 has been used to propagate T7 it may have already adapted well to this host over time. On BW25113, hydrophobic residues were modestly enriched (all p &lt; 0.034, r &gt; 0.07) (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2H</xref>), a trend opposite to 10G. This provides a molecular explanation as to why high-scoring substitutions on one host fare poorly on others (<xref ref-type="fig" rid="fig2">Figure 2F</xref>). We mapped positions of enriched substitutions (F<sub>N</sub> ≥ 2) on each host onto the structure to determine topologically distinct patterns of substitution that may be masked in global comparisons of the entire tip domain (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2E</xref>). These fall predominantly on four exterior loops (BC, DE, FG, and HI), the adjoining region (β-strand H) close to exterior loop HI, and less frequently on the ‘side’ of the tip domain. This suggests directionality to phage–bacterial interactions and orientational bias of the tip domain with respect to the bacterial surface. Directionality and orientational bias is particularly valuable information since no high-resolution structure of this phage bound to receptor exists.</p><p>Several key lessons emerged from these host screens. First, single amino acid substitutions alone can generate broad functional diversity, highlighting the evolutionary adaptability of the RBP. Second, T7 can be optimized and activity can be increased, even on hosts that T7 is already considered to grow well on. Third, enrichment patterns on each host follow broad trends but have nuance at each position.</p></sec><sec id="s2-3"><title>Comparison across hosts reveals regions of functional importance</title><p>Next, we sought to elucidate features of each residue unique to each host or common across all hosts. There were over 30 residues with contrasting substitution patterns between different hosts, revealing fascinating features of receptor recognition for T7 (<xref ref-type="supplementary-material" rid="fig2sdata2">Figure 2—source data 2</xref>). Here, we focus on five of these residues, N501, R542, G479, D540, and D520, which showed starkly contrasting patterns of selection (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). N501 and R542 are located on exterior loops oriented away from the phage and toward the receptor (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). In fact, R542 forms a literal ‘hook’ to interact with the receptor (<xref ref-type="bibr" rid="bib23">Garcia-Doval and van Raaij, 2012</xref>). On 10G and BL21, only positively charged residues (R, K, and H) were tolerated at residues 501 and 542, while in contrast many more substitutions were tolerated at both residues on BW25113. One such substitution, R542Q, is the best performing variant on BW25113 (F<sub>N</sub> = 3.31) but is conspicuously depleted on 10G and BL21, suggesting that even subtle molecular disparities can lead to large biases in activity. The substitution profiles of G479 and D540 are loosely the inverse of N501 and R542 as many substitutions are tolerated on BL21 and 10G, but very few are tolerated on BW25113 (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). We hypothesize that D540 is critical for host recognition on BW25113. Since D540, a receptor-facing position on an exterior loop, is only 6 Å from G479, it is likely that any substitution at G479 may sterically hinder D540, resulting in the noted depletion of G479 substitutions on BW25113. This hypothesis is further supported by enrichment of adjacent S541D on BW25113 (F<sub>N</sub> = 2.82, the third highest scoring substitution), while this substitution is depleted on 10G and BL21 (<xref ref-type="supplementary-material" rid="fig2sdata2">Figure 2—source data 2</xref>). D520 displays a third variation in substitution patterns where substitutions are generally tolerated on 10G and BW25113, but not tolerated on BL21 (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). This loop is also oriented downward toward the receptor, and we hypothesize that D520 or the local region around this exterior loop is more important for receptor recognition in BL21 than it is for the other two hosts, mirroring the result for D540 for BW25113. Another stark contrast can be drawn at adjacent S519, where no substitutions are tolerated in BL21 or 10G but several substitutions are enriched on BW25113, indicating that substitutions can improve receptor binding on one host while reducing function on another host. Overall, these host-specific substitution patterns reveal a nuanced relationship between the tip domain composition and receptor preferences.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Comparison across hosts reveals regions of functional importance.</title><p>(<bold>A</bold>) Host-specific differences in substitution patterns at five positions in the tip domain recapitulated from <xref ref-type="fig" rid="fig2">Figure 2</xref>. (<bold>B</bold>) Role of each position determined by aggregating scores of all substitutions in all hosts at that position. Substitutions are classified as intolerant (F<sub>N</sub> &lt; 0.1 in all hosts), tolerant (F<sub>N</sub> ≥ 0.1 in all hosts), or functional (F<sub>N</sub> &lt; 0.1 in one host, F<sub>N</sub> ≥ 0.1 in another host) and bar plots are shown as proportion of classified variants at that position. (<bold>C</bold>) Crystal structure of the tip domain (center) with each residue colored as intolerant, tolerant, or functional based on the dominant effect at that position, β-sheets and residues listed in (<bold>A</bold>) are labeled. Key interactions defining function and orientation are highlighted in peripheral panels. </p><p> <supplementary-material id="fig3sdata1"><label>Figure 3—source data 1.</label><caption><title>Functional comparison for each variant on susceptible hosts.</title><p>Related to <xref ref-type="fig" rid="fig3">Figure 3B, C</xref>.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-63775-fig3-data1-v2.xlsx"/></supplementary-material> </p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63775-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Comparing F<sub>D</sub> to computationally predicted stability of variant ΔΔG.</title><p>Comparison of maximum F<sub>D</sub> values between <italic>E. coli</italic> 10G, BL21 and BW25113 to computationally predicted change in stability (ΔΔG, see methods) for each intolerant (red circles), tolerant (yellow squares) and functional (blue triangles) in the variant library.</p><p> <supplementary-material id="fig3s1sdata1"><label>Figure 3—figure supplement 1—source data 1.</label><caption><title>ΔΔG and F<sub>D </sub>conversion for all variants.</title><p>Related to <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-63775-fig3-figsupp1-data1-v2.xlsx"/></supplementary-material> </p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63775-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Classification of tolerant, intolerant, and functional regions based on different cutoff conditions.</title><p>Phenotypic classification of each position is determined by aggregating scores of all substitutions in all hosts at that position. (<bold>A</bold>) Substitutions are classified using an F<sub>N</sub> cutoff of 0.1 as intolerant (F<sub>N</sub> &lt; 0.1 in all hosts), tolerant (F<sub>N</sub> ≥ 0.1 in all hosts), or functional (F<sub>N</sub> &lt; 0.1 in one host, F<sub>N</sub> ≥ 0.1 in another host) as seen in <xref ref-type="fig" rid="fig3">Figure 3B</xref>. Variations of this cutoff (<bold>B</bold>) using an F<sub>N</sub> cutoff of 0.5 or (<bold>C</bold>) using an F<sub>N</sub> cutoff of 0.01. An alternative, more conservative approach to classifying a functional substitution requires an F<sub>N</sub> below the limit of detection (LOD) in one host and a higher F<sub>N</sub> of (<bold>D</bold>) 0.1, (<bold>E</bold>) 0.5, or (<bold>F</bold>) 1.0 in another host. All cutoff conditions broadly result in similar overall trends.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63775-fig3-figsupp2-v2.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 3.</label><caption><title>Truth table comparing functional results to predicted stability.</title><p>Comparison of functional results to computationally predicted change in stability (ΔΔG, see methods). Substitutions are binned as tolerated or enriched if maximum F<sub>D</sub> &gt; 0.1 and depleted if F<sub>D</sub> &lt; 0.1 across any strain. Substitutions are considered stabilizing if predicted ΔΔG was &lt;10 and destabilizing if &gt;10.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63775-fig3-figsupp3-v2.tif"/></fig></fig-group><p>We quantitatively characterized the role of every residue by integrating selection data across all hosts to reveal a functional map of the tip domain at granular resolution (<xref ref-type="fig" rid="fig3">Figure 3B, C</xref>, <xref ref-type="supplementary-material" rid="fig3sdata1">Figure 3—source data 1</xref>). We classified every residue as ‘intolerant’, ‘tolerant’, or ‘functional’ based on aggregated F<sub>N</sub> scores of all substitutions across all three hosts at every residue. Our method of classifying functional regions was robust to adjusting the F<sub>N</sub> threshold used to identify functional variants (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). Residues where the majority of substitutions were depleted were considered intolerant to substitution, while residues where at least a third of substitutions were depleted in one host and tolerated or enriched in another host were considered functional; the remaining positions were considered tolerant (see Materials and methods). The hydrophobic core comprising W474, I495, W496, I497, Y515, W523, L524, F526, I528, F535, and I548 is essential for stability and therefore is highly intolerant to substitutions (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). Other intolerant positions include an elaborate network of salt bridge interactions involving D489, R491, R493, R508, and D512 in the interior loops, which likely constrain the orientation of the tip domain relative to the shaft (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). Glycines generally provide conformational flexibility between secondary structure elements and normally tend to be mutable. Interestingly, several glycines (G476, G510, G522 ,and G532) are highly intolerant to substitutions. These glycines may be essential to minimize steric obstruction to adjacent larger residues, similar to G479 and D540 on BW25113 (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). For example, G510 and G532 may facilitate formation of salt bridges in the interior loop, while G476 and G522 may facilitate a required receptor interaction in exterior loops for all three hosts.</p><p>It has been previously assumed that exterior loops are the primary functional region of the tip domain (<xref ref-type="bibr" rid="bib23">Garcia-Doval and van Raaij, 2012</xref>; <xref ref-type="bibr" rid="bib67">Yehl et al., 2019</xref>). We found that functional positions did typically point outward and are densely concentrated along exterior loops BC, DE, FG, and HI, as well as adjacent β-sheet residues. This is consistent with two specificity-switching substitutions found in a previous study, D520Q and V544A, which are both located in exterior loops (<xref ref-type="bibr" rid="bib27">Heineman et al., 2008</xref>). However, several residues in exterior loops, such as G476 and S543, were notably intolerant, indicating that these residues may be poor targets for engineering or future combinatorial studies. Functional positions were also found in regions other than exterior loops, such as I514, Q527, and K536, which are β-sheet residues located along one side of the tip domain (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). This suggests the phage can use the ‘side’ of the tip domain to engage the receptor, increasing the apparent functional area of the tip domain and highlighting several new regions as valuable engineering targets.</p><p>We also determined if the functionally important regions could be predicted computationally as the ability to predict functionally important regions without DMS could rapidly accelerate engineering efforts. We used Rosetta, a state-of-the-art protein modeling software, to calculate the change in Gibbs free energy (ΔΔG) for each of the 1660 mutations and compared this distribution to our DMS results (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>, also see Materials and methods) and generated a truth table to summarize results compared to our functional data (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>). Predicted thermodynamic changes in stability mapped very well with over 93% of tolerated or functional positions having a substitution that was predicted to be stabilizing. The remaining 7% of tolerant or enriched substitutions were predicted to be destabilizing, and we hypothesize that this may indicate these substitutions result in improved dynamic or induced fit positioning of the tip domain for productive infection. Incorporating stability estimations could further improve the engineering power of the assay. For example, substitutions predicted to be stable but that are intolerant in the DMS assay may indicate that the substituted residue is necessary for all three hosts.</p><p>Overall, these results paint a complex enrichment profile for each host with some broad trends but subtle host-specific effects. These results suggest that exterior loops and some outward-facing positions in β-sheets act as a reservoir of function-switching and function-enhancing mutations, likely promoting host-specific and orientation-dependent interactions between phage and bacterial receptors. Functional positions identified by this comparison are ideal engineering targets to customize host range and activity.</p></sec><sec id="s2-4"><title>Discovery of gain-of-function variants against resistant hosts</title><p>The tail fiber is considered a reservoir of gain-of-function variants due to its principal role in determining fitness of a phage through host adsorption (<xref ref-type="bibr" rid="bib29">Holtzman et al., 2020</xref>; <xref ref-type="bibr" rid="bib67">Yehl et al., 2019</xref>). We hypothesized that novel gain-of-function variants against a resistant host could be discovered by subjecting our tail fiber variant library to selection on a resistant host. To identify a resistant host, we focused on host genes <italic>rfaG</italic> and <italic>rfaD</italic> involved in the biosynthesis of surface LPS, which is a known receptor for T7 in <italic>E. coli</italic> (<xref ref-type="bibr" rid="bib26">González-García et al., 2015</xref>; <xref ref-type="bibr" rid="bib51">Molineux, 2001</xref>; <xref ref-type="bibr" rid="bib56">Qimron et al., 2006</xref>). Gene <italic>rfaG</italic> (synonyms <italic>WaaG</italic> or <italic>pcsA</italic>) transfers glucose to the outer core of LPS and deletion strains lack the outer core of LPS (<xref ref-type="bibr" rid="bib53">Pagnout et al., 2019</xref>), while <italic>rfaD</italic> (synonyms <italic>gmhD</italic> or <italic>WaaD</italic>) encodes a critical epimerase required for building the inner core of LPS (<xref ref-type="bibr" rid="bib66">Valvano et al., 2002</xref>; <xref ref-type="fig" rid="fig4">Figure 4A</xref>). Deletion of either gene reduces the ability of T7 to infect <italic>E. coli</italic> by several orders of magnitude (<xref ref-type="fig" rid="fig4">Figure 4F</xref>). We challenged the library of T7 variants against <italic>E. coli</italic> deletion strains BW25113Δ<italic>rfaG</italic> and BW25113Δ<italic>rfaD</italic> through pooled selection and deep sequencing as before (<xref ref-type="fig" rid="fig2">Figure 2</xref>) and determined an F<sub>N</sub> score for each substitution on both strains (<xref ref-type="fig" rid="fig4">Figure 4B, C</xref>). Independent replicates showed good correlation for BW25113Δ<italic>rfaG</italic> (R = 0.99, 0.93, 0.93) but only adequate correlation for BW25113Δ<italic>rfaD</italic> (R = 0.51, 0.68, 0.39) (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). Although the scale of F<sub>N</sub> was inconsistent across replicates on BW25113Δ<italic>rfaD</italic>, the same substitutions were largely enriched in all three replicates, suggesting reproducibility of results (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>). Inconsistencies in F<sub>N</sub> scores may arise due to severe loss of diversity causing stochastic differences in enrichment to become magnified across independent experiments and the four infection cycles used for selection. Separately we examined correlation after selection using only a single infection cycle, which produced more highly correlated results for BW25113Δ<italic>rfaD</italic> (R = 0.89, 0.90, 0.89) (<xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>), indicating that fewer infection cycles may be ideal for future work with highly resistant hosts.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Discovery of gain-of-function variants against resistant hosts.</title><p>(<bold>A</bold>) Schematic view of the LPS on wildtype BW25113, BW25113Δ<italic>rfaG</italic> and BW25113Δ<italic>rfaD</italic>. (<bold>B-C</bold>) Heat maps showing normalized functional scores (F<sub>N</sub>) of all substitutions (red gradient) and wildtype amino acid (F<sub>N</sub>=1 and black dot upper left) at every position for BW25113Δ<italic>rfaG</italic> (<bold>B</bold>) and BW25113Δ<italic>rfaD</italic> (<bold>C</bold>). (<bold>D-E</bold>) Among highly enriched variants (F<sub>N</sub> ≥ 10), targeted amino acids (left), their substitutions (middle) and topological location on the structure (right) on BW25113Δ<italic>rfaG</italic> (<bold>D</bold>) and BW25113Δ<italic>rfaD</italic> (<bold>E</bold>), with each alluvial colored based on the substituted amino acid and scaled by F<sub>N</sub>. (<bold>F</bold>) EOP (mean ± SD, biological triplicates) for wildtype phage and select variants on BW25113 (Wild Type), BW25113Δ<italic>rfaG</italic> and BW25113Δ<italic>rfaD</italic> in exponential (dark gray) and stationary phases (light gray) using BW25113 as a reference host.</p><p> <supplementary-material id="fig4sdata1"><label>Figure 4—source data 1.</label><caption><title>Deep sequencing summary for phage variant library after selection on different hosts.</title><p>Related to <xref ref-type="fig" rid="fig4">Figure 4B, C</xref>.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-63775-fig4-data1-v2.xlsx"/></supplementary-material> </p><p> <supplementary-material id="fig4sdata2"><label>Figure 4—source data 2.</label><caption><title>Variant-specific F<sub>N</sub> for phage variants after selection on <italic>E. coli</italic> BW25113<italic>ΔrfaG</italic> and BW25113<italic>ΔrfaD</italic> and physicochemical statistics.</title><p>Related to <xref ref-type="fig" rid="fig4">Figure 4B, C</xref> and <xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-63775-fig4-data2-v2.xlsx"/></supplementary-material> </p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63775-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Correlation between biological replicates after selection of phage variant library on <italic>E. coli</italic> BW25113<italic>ΔrfaG</italic> and BW25113<italic>ΔrfaD</italic>.</title><p>Correlation of F<sub>N</sub> scores between biological replicates of the phage variant library on (<bold>A</bold>) <italic>E. coli</italic> BW25113Δ<italic>rfaG</italic> and (<bold>B</bold>) BW25113Δ<italic>rfaD</italic>. R values and trendlines are displayed for all variants (black line) and with outliers excluded (red line) for BW25113Δ<italic>rfaD</italic> with outlier points in red and all other points in grey.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63775-fig4-figsupp1-v2.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>Distribution, enrichment profile, and physicochemical properties of variants after selection on <italic>E. coli</italic> BW25113<italic>ΔrfaG</italic> and BW25113<italic>ΔrfaD</italic>.</title><p>Number of variants that were depleted (F<sub>N</sub> ≤ 0.1) tolerated (F<sub>N</sub> &gt;0.1 and &lt;2) or enriched (F<sub>N</sub> ≥ 2) after selection on (<bold>A</bold>) BW25113Δ<italic>rfaG</italic> or (<bold>B</bold>) BW25113Δ<italic>rfaD</italic>, separated by topology of the tip domain color coded as interior loops (red), β-sheets (beige) and exterior loops (blue). (<bold>C</bold>) Average F<sub>N</sub> of enriched variants (F<sub>N</sub> ≥ 2) for BW25113Δ<italic>rfaD</italic> (orange squares) and BW25113Δ<italic>rfaG</italic> (blue circles) ordered left to right from lowest to highest F<sub>N</sub>. Violin plots comparing (<bold>D</bold>) change in mass, (<bold>E</bold>) change in hydrophilicity, and (<bold>F</bold>) change in hydrophobicity for grouped depleted (F<sub>N</sub> ≤ 0.1) generally tolerated (F<sub>N</sub> &gt;0.1 and &lt;10) or well enriched (F<sub>N</sub> ≥ 10) substitutions on <italic>E. coli</italic> BW25113Δ<italic>rfaD</italic> and BW25113Δ<italic>rfaG</italic>. The upper p-value is the result of a Kruskal-Wallis test among all three groups while pairwise p-values from a Wilcoxon test are shown linking each group; p-values are shown if only if &lt;0.05.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63775-fig4-figsupp2-v2.tif"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 3.</label><caption><title>Ranking F<sub>N</sub> of the 10 most enriched variants in each biological replicate for (<bold>A</bold>) <italic>E. coli</italic> BW25113ΔrfaG and (<bold>B</bold>) BW25113ΔrfaD.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63775-fig4-figsupp3-v2.tif"/></fig><fig id="fig4s4" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 4.</label><caption><title>Correlation between biological replicates for selection of phage variant library after one infection cycle on (<bold>A</bold>) <italic>E. coli</italic> BW25113ΔrfaG and (<bold>B</bold>) BW25113ΔrfaD.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63775-fig4-figsupp4-v2.tif"/></fig><fig id="fig4s5" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 5.</label><caption><title>Location of truncations in the tip domain enriched after selection.</title><p>Location (black circles) of truncations in the tip domain with an F<sub>N</sub>&gt;10 on BW25113Δ<italic>rfaD</italic>. The tip domain is colored in a rainbow gradient from N (blue) to C (red) terminus.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63775-fig4-figsupp5-v2.tif"/></fig></fig-group><p>We engineered several gain-of-function T7 variants that could infect both deletion strains with activity comparable to wildtype T7 infecting susceptible BW25113 (<xref ref-type="fig" rid="fig4">Figure 4F</xref>). Low-sequence diversity and high enrichment scores of T7 variants indicate a strong selection bottleneck, which is consistent with diminished activity of wildtype T7 on the deletion strains. This is reflected in the significantly lower functional score of wildtype T7 on BW25113Δ<italic>rfaG</italic> and BW25113Δ<italic>rfaD</italic> (F = 0.09 ± 0.3 and F = 0.03 ± 0.2, respectively) in comparison to BW25113 (F = 2.26 ± 0.1, p &lt; 0.001) (<xref ref-type="supplementary-material" rid="fig2sdata1">Figure 2—source data 1</xref>). The number of enriched variants outperforming wildtype T7 (F<sub>N</sub> ≥ 2) on the deletion strains (BW25113Δ<italic>rfaG</italic>: 55 variants, 3.3% and BW25113Δ<italic>rfaD</italic>: 68 variants, 4.1%) was over three times higher than BW25113 (16 variants, 1%) but comparable to 10G (48 variants, 2.9%) (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2A, B</xref>). However, the enrichment scores of top performing variants such as G521H and G521R on BW25113Δ<italic>rfaG</italic> and S541K and N501H on BW25113Δ<italic>rfaD</italic> were over 100 times greater than wildtype T7, suggesting strong gain of function on the deletion strains (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2C</xref>). Of the 78 variants with F<sub>N</sub> ≥ 2 on either deletion strain, 45 variants had F<sub>N</sub> ≥ 2 on both strains, indicating that variants that performed well on one strain typically performed well on the other strain. This implies that the enriched variants may have broad affinity for truncated LPS but cannot discriminate based on the length of the LPS. Nonetheless, hydrophilic substitutions were more strongly enriched on <italic>BW25113ΔrfaG</italic> (p &lt; 0.001, r &gt; 0.11), but not as significantly on <italic>BW25113ΔrfaD</italic> (p &lt; 0.033, r &lt; 0.10), suggesting subtle differences in surface chemical properties of deletion strains leading to host-specific enrichments (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2D–F</xref>). Indeed, there were several variants with contrasting F scores on both strains such as S541T (<italic>BW25113ΔrfaD</italic> F<sub>N</sub> = 44.8, <italic>BW25113ΔrfaG</italic> F<sub>N</sub> = 0.6) and G521E (<italic>BW25113ΔrfaD</italic> F<sub>N</sub> = 0, <italic>BW25113ΔrfaG</italic> F<sub>N</sub> = 17.4), suggesting potential host preference. Most substitutions were concentrated in the exterior loops BG, FG, HI, and β-strand H, all pointing downward toward the bacterial surface, reinforcing the functional importance of these regions of the tip domain (<xref ref-type="fig" rid="fig4">Figure 4D, E</xref>). Notably, the most enriched variants had large positively charged substitutions (K, R, and H) akin to the enrichment pattern on 10G, suggesting that the bacterial surface of these truncated mutants likely resembles that of 10G. Our results are consistent with a recent continuous evolution study, which identified G480E and G521R as possible gain-of-function variants on a strain similar to <italic>BW25113ΔrfaD</italic> and G479R and G521S as possible gain-of-function variants on <italic>BW25113ΔrfaG</italic> (<xref ref-type="bibr" rid="bib29">Holtzman et al., 2020</xref>), although these variants only represent a small fraction of the gain-of-function variants discovered in our study.</p><p>We validated the results of the pooled selection experiment by clonally testing the ability of phage variants with high F<sub>N</sub> (A539R, G521H, and D540S) to plaque on the deletion strains based on a standard efficiency of plating (EOP) assay. Indeed, EOP results showed significant gain of function in these variants on the deletion strains (<xref ref-type="fig" rid="fig4">Figure 4F</xref>). D540S was particularly noteworthy as it performed better on the deletion strain <italic>BW25113ΔrfaG</italic> over wildtype BW25113 by 1–2 orders of magnitude. Based on these results, we conclude that D540 is critical for infecting wildtype BW25113 (<xref ref-type="fig" rid="fig3">Figure 3</xref>) likely by interacting with the outer core of LPS. When the outer core of the LPS is missing (<italic>BW25113ΔrfaG</italic>), a substitution at this position becomes necessary for adsorption either to a different LPS moiety or to an alternative receptor.</p><p>We introduced stop codon at every position to systematically evaluate the function of tip domains truncated to different lengths. Many truncated variants performed well, especially on BW25113Δ<italic>rfaG,</italic> which included some with F<sub>N</sub> ≥ 10 (<xref ref-type="supplementary-material" rid="fig4sdata2">Figure 4—source data 2</xref>). Truncated variants that performed well are distributed throughout the tip domain and are not localized to any one region (<xref ref-type="fig" rid="fig4s5">Figure 4—figure supplement 5</xref>). We clonally tested variant R525*, the best performing truncated library member (BW25113Δ<italic>rfaG</italic> F<sub>N</sub> = 9.55, BW25113Δ<italic>rfaD</italic> F<sub>N</sub> = 75.7), and found that this mutant showed no ability to plaque on any host unless provided the tail fiber in trans. These truncated phages, detectable here only using deep sequencing, may demonstrate how obligate lytic phages could become less active in a bacterial population, slowly replicating alongside their bacterial hosts, requiring only a single mutation to become fully active again. In fact, acceptor phages altogether lacking a tail fiber were present at extremely low abundance (<xref ref-type="supplementary-material" rid="fig4sdata1">Figure 4—source data 1</xref>). These phages are not artifacts from library creation as some ability to replicate is required to produce detectable concentrations of each phage. We concluded that these are viable phage variants albeit with a much slower infection cycle, resulting in their inability to form visible plaques.</p></sec><sec id="s2-5"><title>Targeting pathogenic <italic>E. coli</italic> causing UTIs using T7 variants</title><p>Phage therapy is emerging as a promising solution to the antibiotic resistance crisis. Recent clinical success stories against multidrug-resistant <italic>Acinetobacter</italic> and <italic>Mycobacterium</italic> showcase the enormous potential of phage therapy (<xref ref-type="bibr" rid="bib13">Dedrick et al., 2019</xref>; <xref ref-type="bibr" rid="bib62">Schooley et al., 2017</xref>). Despite notable exceptions, in general development of effective phage-based therapeutics is hindered by onset of bacterial resistance, resulting in low phage susceptibility. Although initial application of phages in a laboratory setting may reduce bacterial levels, the residual bacterial load remains high, causing bacteria to quickly recover after phage application (<xref ref-type="bibr" rid="bib18">Fister et al., 2016</xref>; <xref ref-type="bibr" rid="bib31">Huss and Raman, 2020</xref>; <xref ref-type="bibr" rid="bib65">Silva et al., 2014</xref>). A high ratio of phage to bacteria (multiplicity of infection [MOI]) may productively kill bacteria in a laboratory setting by overwhelming a host with many phages (<xref ref-type="bibr" rid="bib1">Abedon, 2011</xref>). However, ensuring an overwhelming amount of phages in a clinical setting is not always feasible (<xref ref-type="bibr" rid="bib55">Principi et al., 2019</xref>). Engineering highly active phages that overcome bacterial insensitivity and can therefore productively eliminate bacterial populations at low MOI in a laboratory setting would greatly enhance phage-based therapeutics. We hypothesized that engineered tip domain variants may abate bacterial insensitivity and be active even at low MOI by better adsorbing to the native receptor or recognizing a new bacterial receptor altogether.</p><p>To test this hypothesis, we chose pathogenic <italic>E. coli</italic> strain isolate 473 isolated from a patient with a UTI (<xref ref-type="bibr" rid="bib3">Arthur et al., 1990</xref>). Although T7 can infect this UTI strain, insensitivity arises rapidly, a phenomenon all too common with the use of natural phages. EOP assays for wildtype T7 showed insensitive plaque morphology consisting of small, slow-growing plaques. No visible lysis was detected after overnight incubation when wildtype T7 was applied in liquid culture (MOI = 1), indicating onset of insensitivity. However, the variant library applied on the UTI strain cleared the culture (MOI = 1) after overnight incubation, suggesting that T7 variants are capable of lysing and attenuating insensitivity existing in the pool. We clonally characterized three variants (N501H, D520A, and G521R) isolated from plaques. All three variants vastly outperformed wildtype T7 in terms of onset of insensitivity. Insensitivity emerged approximately 11–13 hr after initial lysis for the three variants, whereas it took merely 1–2 hr after initial lysis for wildtype (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). In particular, the N501H variant lysed cells faster and produced a lower bacterial load post lysis, suggesting far greater activity compared to wildtype T7. Next, we compared the effect of phage MOI (MOI = 10<sup>2</sup>-10<sup>−5</sup>) on the lysing activity of N501H and wildtype T7 (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). At all MOIs, wildtype phages lysed UTI473 significantly more slowly compared to N501H phages (all p &lt; 0.05). At lower MOI, time to lysis of N501H was half that of wildtype T7, though they were more comparable at higher MOI.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Targeting pathogenic <italic>E. coli</italic> causing UTIs using T7 variants.</title><p>(<bold>A</bold>) Growth time course of UTI473 strain subject to wildtype T7 and select variants. Phages were applied after an hour at an MOI of ~10<sup>-2</sup>. (<bold>B</bold>) Estimated time to lysis of UTI473 strain incubated with wildtype T7 and N501H variant over a range of MOIs, derived from time course experiments. (<bold>C</bold>) Cell density (OD<sub>600</sub>) of UTI473 strain when incubated with wildtype T7 and N501H variant at select timepoints after initial lysis. All data represented as mean ± SD of biological triplicate.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63775-fig5-v2.tif"/></fig><p>A striking contrast between N501H and wildtype T7 is evident in reduced bacterial insensitivity at progressively lower MOI (<xref ref-type="fig" rid="fig5">Figure 5C</xref>). Between an MOI of 100 to 1, application of both N501H and wildtype phage resulted in similar bacterial insensitivity. However, between an MOI of 10<sup>−1</sup> and 10<sup>−5</sup>, application of N501H phage reduced insensitivity over a 10 hr window, while application of wildtype phages resulted in rapid onset of insensitive bacteria. We postulate that at high MOI wildtype T7 simply overwhelms the host before insensitivity arises, while at lower MOI insensitivity can emerge and only variants adapted to the host can effectively kill the host. These results indicate that ORACLE can generate phage variants superior to wildtype phage that could then become starting points for further engineering therapeutic phages. Further experiments will be required to assess the in vivo efficacy of the T7 variants.</p></sec><sec id="s2-6"><title>Host range constriction emerges from global comparison across variants</title><p>Most phages are specialists that selectively target a narrow range of hosts but are unable to productively infect other closely related hosts (<xref ref-type="bibr" rid="bib32">Hyman and Abedon, 2010</xref>). We wanted to assess differences in the host range of individual variants on 10G, BL21, and BW25113 and identify variants with constricted host ranges. Ideally, host specificities can be determined by subjecting a co-culture of all three hosts to the phage library. However, deconvolving specificities of thousands of variants from a pooled co-culture experiment can be technically challenging. Instead, we sought to estimate specificities by comparing F<sub>N</sub> of a phage variant on all three hosts. Although F<sub>N</sub> compares activity of variants within a host, it could nonetheless be a useful proxy for estimating specificities across hosts. For instance, a phage variant with high F<sub>N</sub> on BL21 but completely depleted on BW25113 is more likely to specifically lyse BL21 than BW25113 in a co-culture experiment. Based on this rationale, we considered different metrics of comparison of F<sub>N</sub> and settled on difference in F<sub>N</sub> of a variant with reduced weight for enrichment (or F<sub>D</sub>, see Materials and methods) between any two hosts as an approximate measure of host preference. This metric is not an absolute measure of host specificity, but one devised to reveal broad trends in specificity to prioritize variants for downstream validation.</p><p>To assess if variants preferred one host over another, we computed F<sub>D</sub> for all three pairwise combinations and plotted functional substitutions as points on or above/below a ‘neutral’ line (<xref ref-type="fig" rid="fig6">Figure 6A–C</xref>). Variants above the line favor lysis of the noted host, and vice versa for variants below the line. To check if this F<sub>D</sub>-based approach is suitable for assessing host specificity, we compared our results with previously published data. Two substitutions, D520Q and V544A, that were reported to have a preference for BW25113 and BL21, respectively, in head-to-head comparisons (<xref ref-type="bibr" rid="bib27">Heineman et al., 2008</xref>) were placed correctly in our plots, confirming the validity of our F<sub>D</sub>-based classification scheme. We identified 118 out of 1660 variants as good candidates for constricting host range (|F<sub>D</sub>| ≥ 1, see <xref ref-type="supplementary-material" rid="fig6sdata1">Figure 6—source data 1</xref>). Of the 118 variants, 53 variants favor BW25113 over BL21 and 98 variants favor BW25113 over 10G in pairwise comparisons (<xref ref-type="fig" rid="fig6">Figure 6A, C</xref>). Between BL21 and 10G, there are 15 variants that favor BL21 but none that favor 10G (<xref ref-type="fig" rid="fig6">Figure 6B</xref>).</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Host range constriction emerges from global comparison across variants.</title><p>(<bold>A-C</bold>) Pairwise comparison of differences in functional scores of variants between hosts (see Methods). Variants above the line favor lysis of host noted above the line, and vice versa for variants below the line. (<bold>D</bold>) EOP (mean ± SD, biological triplicates) for wildtype T7 and select variants on BW25113, 10G and BL21 in exponential (dark gray) and stationary phases (light gray) using exponential 10G with gp17 tail fiber helper plasmid (10G_H) as a reference host. R542Q plaques are atypically small until EOP ~10-2.</p><p> <supplementary-material id="fig6sdata1"><label>Figure 6—source data 1.</label><caption><title>ΔΔG and F<sub>D </sub>conversion for all variants.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-63775-fig6-data1-v2.xlsx"/></supplementary-material> </p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-63775-fig6-v2.tif"/></fig><p>Certain key positions, including G479, D540, R542, and D520, which we previously identified as functionally important (<xref ref-type="fig" rid="fig3">Figure 3A</xref>), are the molecular drivers of specificity between hosts (<xref ref-type="fig" rid="fig6">Figure 6A–C</xref>). Taken together, our data suggests that it would be easier to find a variant capable of specifically lysing BW25113, less so for BL21, and most challenging for 10G.</p><p>To validate our analysis, we clonally tested variant R542Q, which had a greater preference for BW25113 than BL21 or 10G (BW25113 F<sub>D</sub> = 2.0, BL21 F<sub>D</sub> = 0, 10G F<sub>D</sub> = 0), and variant D540S, which had a greater preference for BL21 and 10G than BW25113 (10G F<sub>D</sub> = 1.03, BL21 F<sub>D</sub> = 0.62, BW25113 F<sub>D</sub> = 0.03). Indeed, R542Q showed a significant approximately hundredfold decrease in the ability to plaque on BL21 compared to BW25113 while 10G plaques were atypically small, indicating a severe growth defect (<xref ref-type="fig" rid="fig6">Figure 6D</xref>). In contrast, D540S showed a significant approximately hundredfold decrease in the ability to plaque on BW25113 compared to BL21 and 10G (<xref ref-type="fig" rid="fig6">Figure 6D</xref>), confirming the host constriction properties of these variants. In summary, pairwise comparison is a powerful tool to map substitutions that constrict host range and can be leveraged to tailor engineered phages for targeted hosts.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In this study, we used ORACLE to create a large, unbiased library of T7 phage variants to comprehensively characterize the mutational landscape of the tip domain of the tail fiber. Our study identified hundreds of novel function-enhancing substitutions that had not been previously characterized. We mapped regions of function-enhancing substitutions on to the crystal structure to rationalize how sequence and structure influence activity and host range. Several important insights emerged from these results. Cross-comparison between different hosts and selection on resistant hosts allowed us to map key substitutions, leading to host discrimination and gain of function. Single amino acid substitutions are sufficient to enhance activity and host range, including some that confer dramatic increases in activity or specificity. The functional landscape on each host is unique, reflecting both different molecular preferences of adsorption and the fitness of wildtype T7 on these hosts. For instance, hydrophilic substitutions were enriched in 10G while hydrophobic substitutions were enriched in BW25113. Notably, substitutions on 10G (an <italic>E. coli</italic> K-12 derivative lacking LPS components) mirrored substitutions that recovered function on BW25113 mutants with truncated LPS, which shows convergence of selection. Function-enhancing substitutions were densely concentrated in the exterior loops, indicating an orientational preference for receptor recognition. However, they were also found on other surface residues, albeit less frequently, suggesting alternative binding modes of the tip domain for host recognition, and several intolerant residues were located in exterior loops. Taken together, these results highlight the extraordinary functional potential of the tip domain and rationalize the pervasive use of this structural fold in nature for molecular recognition. Comparison of these functional profiles precisely reveals the regions that are ideal engineering targets for customizing host range and activity and identifies intolerant residues that should be avoided when engineering synthetic phages.</p><p>These results also highlight the power of deep sequencing to detect and resolve small functional effects over traditional low-throughput plaque assays. This is best illustrated in the case of truncated variants visible only to deep sequencing, but incapable of plaque formation without a helper plasmid. The truncated variants are likely not experimental artifacts as some ability to replicate is required to survive multiple rounds of selection on the host. Truncation of the tip domain may misorient the phage relative to the receptor, likely resulting in slower growth and deficiency in plaquing, while still capable of replicating. Since plaque formation is a complex process, inability to plaque may not imply a functionally incompetent phage.</p><p>ORACLE is designed as a foundational technology to elucidate sequence–function relationships in phage genes. On T7, ORACLE can be used to investigate the function of several important genes, including the remainder of the tail fiber and tail structure, capsid components, or lysins and holins. Together, these will provide a comprehensive view of the molecular determinants of the structure, function, and evolution of a phage. Once the phage variants are created, scaling up ORACLE to investigate potentially tens of hosts merely scales up sequencing volume, not experimental complexity. Such a large-scale study will lead to a detailed molecular understanding and adaptability of phage bacterial interactions. Any phage with a sequenced genome and a transformable host capable of maintaining a plasmid library should be amenable to ORACLE because the phage variants are created during the natural infection cycle. This approach can be leveraged to tune activity for known phages with high activity, such as T7, or to identify engineering targets that dramatically increase activity for newly isolated natural phages.</p><p>The confluence of genome engineering, high-throughput DNA synthesis, and sequencing enabled by ORACLE together with viral metagenomics could transform phage biology. Phages constitute unparalleled biological variation found in nature and are aptly called the ‘dark matter’ of the biosphere. Their sequence diversity and richness are coming to light in the growing volume of viral metagenome databases. However, what functions these sequences encode remains largely unknown. For instance, fecal viromes estimate 10<sup>8</sup>–10<sup>9</sup> virus-like particles per gram of feces, but less than a quarter of sequence reads align to existing databases (<xref ref-type="bibr" rid="bib58">Reyes et al., 2012</xref>). While this knowledge gap is daunting, it also presents an opportunity to mine metagenomic sequences to characterize their function and engineer programmable phages. By enabling sequence programmability, we envision ORACLE as a powerful tool to discover new phage ‘parts’ from metagenomic sequences.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th>Reagent type <break/>(species) or resource</th><th>Designation</th><th>Source or reference</th><th>Identifiers</th><th>Additional information</th></tr></thead><tbody><tr><td>Strain, strain background (<italic>Escherichia coli</italic>)</td><td valign="top"><italic>E. coli</italic> 10G</td><td valign="top">Lucigen</td><td valign="top">Lucigen:60107-1</td><td/></tr><tr><td>Strain, strain background (<italic>Escherichia coli</italic>)</td><td valign="top"><italic>E. coli</italic> BL21</td><td valign="top">ATCC</td><td valign="top">ATCC:BAA-1025</td><td/></tr><tr><td>Strain, strain background (<italic>Escherichia coli</italic>)</td><td valign="top"><italic>E. coli</italic> 10-beta</td><td valign="top">NEB</td><td valign="top">NEB:C3020</td><td/></tr><tr><td>Strain, strain background (<italic>Escherichia coli</italic>)</td><td valign="top"><italic>E. coli</italic> BW25113</td><td valign="top"><xref ref-type="bibr" rid="bib4">Baba et al., 2006</xref></td><td valign="top">BW25113</td><td/></tr><tr><td>Strain, strain background (<italic>Escherichia coli</italic>)</td><td valign="top"><italic>E. coli</italic> BW25113Δ<italic>rfaG</italic></td><td valign="top"><xref ref-type="bibr" rid="bib4">Baba et al., 2006</xref></td><td valign="top">BW25113Δ<italic>rfaG</italic></td><td/></tr><tr><td>Strain, strain background (<italic>Escherichia coli</italic>)</td><td valign="top"><italic>E. coli</italic> BW25113 Δ<italic>rfaD</italic></td><td valign="top"><xref ref-type="bibr" rid="bib4">Baba et al., 2006</xref></td><td valign="top">BW25113 Δ<italic>rfaD</italic></td><td/></tr><tr><td>Strain, strain background (<italic>Escherichia coli</italic>)</td><td valign="top"><italic>E. coli</italic> UTI473</td><td valign="top"><xref ref-type="bibr" rid="bib3">Arthur et al., 1990</xref></td><td valign="top">UTI473</td><td/></tr><tr><td>Strain, strain background (T7 bacteriophage)</td><td valign="top">T7 bacteriophage</td><td valign="top">ATCC</td><td valign="top">ATCC:BAA-1025-B2</td><td/></tr><tr><td>Strain, strain background (T7 bacteriophage)</td><td valign="top">T7 bacteriophage variants</td><td valign="top">This paper</td><td valign="top">Available on request</td><td>DMS variants, available from the Raman lab.</td></tr><tr><td>Commercial assay or kit</td><td valign="top">KAPA HiFi PCR Kit</td><td valign="top">Roche</td><td valign="top">Roche:KK2101</td><td/></tr><tr><td>Commercial assay or kit</td><td valign="top">KAPA2G Robust PCR Kit with dNTPS</td><td valign="top">Roche</td><td valign="top">Roche:KK5005</td><td/></tr><tr><td>Commercial assay or kit</td><td valign="top">Golden Gate Assembly Kit (BsaI-HFv2)</td><td valign="top">NEB</td><td valign="top">NEB:E1601L</td><td/></tr><tr><td>Recombinant DNA reagent</td><td valign="top">pHT7Helper1 (plasmid)</td><td valign="top">This paper</td><td valign="top"/><td valign="top">Helper with T7 gp17. See Materials and methods for full details.</td></tr><tr><td>Recombinant DNA reagent</td><td valign="top">pHRec1 and derivatives (plasmids)</td><td>This paper</td><td/><td>Recombination plasmid. See Materials and methods for details.</td></tr><tr><td>Recombinant DNA reagent</td><td valign="top">pHCas9 and derivatives (plasmids)</td><td>This paper</td><td/><td>Plasmid with Cas9 targeting acceptor phage. See Materials and methods for full details.</td></tr><tr><td>Software, algorithm</td><td valign="top">R scripts for DMS analysis</td><td valign="top">This paper</td><td valign="top">N/A</td><td>Available here <ext-link ext-link-type="uri" xlink:href="https://github.com/raman-lab/oracle">https://github.com/raman-lab/oracle</ext-link>; <xref ref-type="bibr" rid="bib30">Huss, 2021</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:11bbe74ab1c2e68ce6404dc13282f7e8056593f3;origin=https://github.com/raman-lab/oracle;visit=swh:1:snp:fd4bdb917d9e58e1f1849376b467bd01b80527d8;anchor=swh:1:rev:657e8eef12e4ee886f5d188b745ff0b38f94f479/">swh:1:rev:657e8eef12e4ee886f5d188b745ff0b38f94f479</ext-link></td></tr><tr><td>Software, algorithm</td><td valign="top">R scripts for physicochemical comparisons</td><td valign="top">This paper</td><td valign="top">N/A</td><td>Available here <ext-link ext-link-type="uri" xlink:href="https://github.com/raman-lab/oracle">https://github.com/raman-lab/oracle.</ext-link></td></tr><tr><td>Software, algorithm</td><td valign="top">R scripts for Rosetta ΔΔG calculations</td><td valign="top">This paper</td><td valign="top">N/A</td><td>Available here <ext-link ext-link-type="uri" xlink:href="https://github.com/raman-lab/oracle">https://github.com/raman-lab/oracle.</ext-link></td></tr></tbody></table></table-wrap><sec id="s4-1"><title>Microbes and culture conditions</title><p>T7 bacteriophage was obtained from ATCC (ATCC BAA-1025-B2). <italic>Saccharomyces cerevisiae</italic> BY4741, <italic>E. coli</italic> BL21 is a lab stock, <italic>E. coli</italic> 10G is a highly competent DH10B derivative (<xref ref-type="bibr" rid="bib15">Durfee et al., 2008</xref>) originally obtained from Lucigen (60107-1). <italic>E. coli</italic> 10-beta was purchased from NEB (C3020). <italic>E. coli</italic> BW25113, BW25113Δ<italic>rfaD,</italic> and BW25113Δ<italic>rfaG</italic> were obtained from Doug Weibel (University of Wisconsin, Madison) and are derived from the Keio collection (<xref ref-type="bibr" rid="bib4">Baba et al., 2006</xref>). UTI473 was obtained from Rod Welch (University of Wisconsin, Madison) and originates from a UTI collection (<xref ref-type="bibr" rid="bib3">Arthur et al., 1990</xref>).</p><p>All bacterial hosts are grown in and plated on Lb media (1% tryptone, 0.5% yeast extract, 1% NaCl in dH<sub>2</sub>O, plates additionally contain 1.5% agar, while top agar contains only 0.5% agar), and Lb media was used for all experimentation. Kanamycin (50 μg/ml final concentration, marker for pHT7Helper1) and spectinomycin (115 μg/ml final concentration, marker for pHRec1, pHRec1-Lib, and pHCas9 and derivatives) were added as needed. All incubations of bacterial cultures were performed at 37°C, with liquid cultures shaking at 200–250 rpm unless otherwise specified. Bacterial hosts were streaked on appropriate Lb plates and stored at 4°C.</p><p><italic>S. cerevisiae</italic> BY4741 was grown on YPD (2% peptone, 1% yeast extract, 2% glucose in dH<sub>2</sub>O, plates additionally contain 2.4% agar), after yeast artificial chromosomes (YAC) transformation. <italic>S. cerevisiae</italic> BY4741 was grown on SD-Leu (0.17% yeast nitrogen base, 0.5% ammonium sulfate, 0.162% amino acids – leucine [Sigma Y1376], 2% glucose in dH<sub>2</sub>O, plates additionally contain 2% agar). All incubations of <italic>S. cerevisiae</italic> were performed at 30°C, with liquid cultures shaking at 200–250 rpm. <italic>S. cerevisiae</italic> BY4741 was streaked on YPD or SD-Leu plates as appropriate and stored at 4°C.</p><p>T7 bacteriophage was propagated using <italic>E. coli</italic> BL21 after initial receipt from ATCC and then as described on various hosts in methods. All phage experiments were performed using Lb and culture conditions as described for bacterial hosts. Phages were stored in Lb at 4°C.</p><p>For long-term storage, all microbes were stored as liquid samples at −80°C in 10% glycerol, 90% relevant media.</p><p>SOC (2% tryptone, 0.5% yeast extract, 0.2% 5 M NaCl, 0.25% 1 M KCl, 1% 1 M MgCl<sub>2</sub>, 1% 1 M MgSO<sub>4</sub>, 2% 1 M glucose in dH<sub>2</sub>O) was used to recover host and phages after transformation.</p></sec><sec id="s4-2"><title>General cloning methods</title><p>PCR was performed using KAPA HiFi (Roche KK2101) for all experiments with the exception of multiplex PCR for screening YACs, which was performed using KAPA2G Robust PCR kits (Roche KK5005). Golden Gate Assembly was performed using New England Biosciences (NEB) Golden Gate Assembly Kit (BsaI-HFv2, E1601L). Restriction enzymes were purchased from NEB with the exception of DNAse I (Roche 4716728001). DNA purification was performed using EZNA Cycle Pure Kits (Omega Bio-tek D6492-01) using the centrifugation protocol. YAC extraction was performed using YeaStar Genomic DNA Extraction kits (Zymo Research D2002). Gibson assembly was performed according to the Gibson Assembly Protocol (NEB E5510), but Gibson Assembly Master Mix was made in lab (final concentration 100 mM Tris-HCl pH 7.5, 20 mM MgCl<sub>2</sub>, 0.2 mM dATP, 0.2 mM dCTP, 0.2 mM dGTP, 10 mM dTT, 5% PEG-8000, 1 mM NAD<sup>+</sup>, 4 U/ml T5 exonuclease, 4 U/μl Taq DNA ligase, 25 U/ml Phusion polymerase). All cloning was performed according to manufacturer's documentation except where noted in methods. If instructions were variable and/or specific conditions are relevant for reproducing results, those conditions are also noted in the relevant methods section.</p><p>PCR reactions use 1 μl of ~1 ng/μl plasmid or ~0.1 ng/μl DNA fragment as template for relevant reactions. PCR reactions using phage as template use 1 μl of undiluted or 1:10 diluted phage stock, genomic extraction was unnecessary. Phage template was initially treated at 65°C for 10 min (for YAC cloning), but we later simply extended the 95°C denaturation step to 5 min (for deep sequencing).</p><p>DpnI digest was performed on all PCR that used plasmid as template. Digestion was performed directly on PCR product immediately before purification by combining 1–2 μl DpnI (20–40 units), 5 μl 10× CutSmart Buffer, PCR product, and dH<sub>2</sub>O to 50 μl, incubating at 37°C for 2 hr then heat inactivating at 80°C for 20 min.</p><p>DNAse treatment of phages was performed by adding 5 μl undiluted phages, 2 μl 10× DNAse I buffer, 1 μl of 2 U/μl DNAse I, dH<sub>2</sub>O to 20 μl, then incubating for 20 min at 37°C, followed by heat inactivation at 75°C for 10 min. Then, 1 μl of this reaction was used as template for relevant PCR.</p><p>Electroporation of plasmids and YACs was performed using a Bio-rad MicroPulser (165-2100), Ec2 setting (2 mm cuvette, 2.5 kV, one pulse) using 25–50 μl competent cells and 1–2 μl DNA for transformation. Electroporated cells were immediately recovered with 950 μl SOC, then incubated at 37°C for 1–1.5 hr and plated or grown in relevant media.</p><p><italic>E. coli</italic> 10G competent cells were made by adding 8 ml overnight 10G cells to 192 ml SOC (with antibiotics as necessary) and incubating at 21°C and 200 rpm until ~OD<sub>600</sub> of 0.4 as determined using an Agilent Cary 60 UV-Vis Spectrometer using manufacturer's documentation (actual incubation time varies based on antibiotic, typically overnight). Cells are centrifuged at 4°C, 800–1000 <italic>g</italic> for 20 min, the supernatant is discarded, and cells are resuspended in 50 ml 10% glycerol. Centrifugation and washing are repeated three times, then cells are resuspended in a final volume of ~1 ml 10% glycerol and are aliquoted and stored at −80°C. Cells are competent for plasmid and YACs.</p><p>Site-directed mutagenesis (SDM) was performed, in brief, using complementary primers with the desired mutation in the middle of the primer, using 16× cycles of PCR, followed by DpnI digestion and electroporation into competent <italic>E. coli</italic> 10G. Splicing by overlap extension (SOE, also known as PCR overlap extension) was performed, in brief, using equimolar ratios of fragments, 16× cycles of PCR using extension based on the combined length of fragments, then a second PCR reaction using 1/100 or 1/1000 diluted product of the first reaction in a typical PCR reaction using 5′ and 3′ end primers for each fragment.</p><p>Detailed protocols for cloning are available on request. All primers used in experiments in this publication are listed in <xref ref-type="supplementary-material" rid="supp1">supplementary file 1</xref>.</p></sec><sec id="s4-3"><title>Plasmid cloning and descriptions</title><p>pHT7Helper1 contains a pBR backbone, kanamycin resistance cassette, mCherry, and the T7 tail fiber <italic>gp17</italic>. Both mCherry and <italic>gp17</italic> are under constitutive expression. <italic>Gp17</italic> was combined with promoter apFAB47 (<xref ref-type="bibr" rid="bib39">Kosuri et al., 2013</xref>) using SOE and the plasmid assembled by Gibson assembly. There is a single-nucleotide deletion in the promoter that has no effect on plaque recovery for phages that require <italic>gp17</italic> to plaque. This plasmid is used during optimized recombination and accumulation in ORACLE to prevent library bias and depletion of variants that grow poorly on <italic>E. coli</italic> 10G. pHRec1 contains an SC101 backbone, Cre recombinase, a spectinomycin resistance cassette, and the T7 tail fiber <italic>gp17</italic> flanked by Cre lox66 sites with an m2 spacer, a 3′ pad region, and lox71 sites with a wt spacer (<xref ref-type="bibr" rid="bib42">Langer et al., 2002</xref>; <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). Cre recombinase is under constitutive expression. This plasmid was assembled with sequential PCR and Gibson assembly. During assembly, we used PCR overhangs and SDM to create two synonymous substitutions in <italic>gp17</italic> to remove two BsaI restriction sites, facilitating downstream Golden Gate Assembly. This plasmid was used in recombination assays as it allows for recombination of wildtype <italic>gp17</italic> and is used as template to generate the DMS variant library. The DMS variant library is referred to as pHRec1-Lib and is used during optimized recombination in ORACLE. Note that this assembly was not tolerated in higher copy number plasmids.</p><p>pHCas9 contains an SC101 backbone, a spectinomycin resistance cassette, and cas9 cassette capable of ready BsaI cloning of gRNA (<xref ref-type="bibr" rid="bib34">Jiang et al., 2013</xref>). This plasmid is used directly as part of the negative control for the accumulation assay and has five derivatives, pHCas9-1 through -5, each with a different gRNA targeting the fixed region in the T7 acceptor phage. pHCas9 was created with Gibson assembly, while derivatives were assembled by phosphorylation and annealing gRNA oligos (100 μM forward and reverse oligo, 5 μl T4 Ligase Buffer, 1 μl T4 PNK, to 50 μl dH<sub>2</sub>O, incubate at 37°C for 1 hr, 96°C for 6 min, then 0.1 °C/s temperature reduction to 23°C), then Golden Gate cloning (1 μl annealed oligo, 75 ng pHCas9, 2 μl T4 DNA Ligase Buffer, 1 μl Golden Gate Enzyme Mix, dH<sub>2</sub>O to 20 μl), incubation at 37°C for 1 hr then 60°C for 5 min, followed by direct transformation of 1 μl, plated on Lb with spectinomycin. Note that pHCas9-3 was the most inhibitory (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2A</xref>) and was the only plasmid used in accumulation during ORACLE. This assembly was also not tolerated in higher copy number plasmids. All plasmid backbones and gene fragments are lab stocks.</p></sec><sec id="s4-4"><title>General bacteria and phage methods</title><p>Bacterial concentrations were determined by serial dilution of bacterial culture (1:10 or 1:100 dilutions made to 1 ml in 1.5 microcentrifuge tubes in Lb) and subsequent plating and bead spreading of 100 μl of a countable dilution (targeting 50 colony-forming units) on Lb plates. Plates were incubated overnight and counted the next morning. Typically, 2–3 dilution series were performed for each host to initially establish concentration at different OD<sub>600</sub> and subsequent concentrations were confirmed with a single dilution series for later experiments.</p><p>Stationary phase cultures are created by growing bacteria overnight (totaling ~20–30 hr of incubation) at 37°C. Cultures are briefly vortexed, then used directly. Exponential phase culture consists of stationary culture diluted 1:20 in Lb, then incubated at 37°C until an OD<sub>600</sub> of ~0.4–0.8 is reached (as determined using an Agilent Cary 60 UV-Vis Spectrometer using manufacturer's documentation), typically taking 40 min to 1 hr and 20 min depending on the strain and antibiotic, after which cultures are briefly vortexed and used directly.</p><p>Phage lysate was purified by centrifuging phage lysate at 16 <italic>g</italic>, then filtering supernatant through a 0.22 μM filter. Chloroform was not routinely used unless destruction of any remaining host was considered necessary and is mentioned in such cases.</p><p>To establish titer, phage samples were typically serially diluted (1:10 or 1:100 dilutions made to 1 ml in 1.5 microcentrifuge tubes) in Lb to a 10<sup>−8</sup> dilution for preliminary titering by spot assay. Spot assays were performed by mixing 250 μl of relevant bacterial host in stationary phase with 3.5 ml of 0.5% top agar, briefly vortexing, then plating on Lb plates warmed to 37°C. After plates solidified (typically ~5 min), 1.5 μl of each dilution of phage sample was spotted in series on the plate. Plates were incubated and checked at 2–4 hr and in some cases overnight (~20–30 hr) to establish a preliminary titer. After a preliminary titer was established, phage samples were serially diluted in triplicate for EOP assays. EOP assays were performed using whole plates instead of spot plates to avoid inaccurate interpretation of results due to spotting error (<xref ref-type="bibr" rid="bib36">Khan Mirzaei and Nilsson, 2015</xref>). To perform the whole plate EOP assay, 250 μl of bacterial host in stationary or exponential phase was mixed with between 5 and 50 μl of phages from a relevant dilution targeted to obtain 50 plaque-forming units (PFUs) after overnight incubation. The phage and host mixture was briefly vortexed, briefly centrifuged, then added to 3.5 ml of 0.5% top agar, which was again briefly vortexed and immediately plated on Lb plates warmed to 37°C. After plates solidified (typically ~5 min), plates were inverted and incubated overnight. PFUs were typically counted at 4–6 hr and after overnight incubation (~20–30 hr), and the total overnight PFU count used to establish titer of the phage sample. PFU totals between 10 and 300 PFU were typically considered acceptable, otherwise plating was repeated for the same dilution series. This was repeated in triplicate for each phage sample on each relevant host to establish phage titer.</p><p>EOP was determined using a reference host, typically <italic>E. coli</italic> 10G with pHT7Helper1 but stated if otherwise. EOP values were generated for each of the three dilutions by taking the phage titer on the test host divided by the phage titer on the reference host, and this value was subsequently log<sub>10</sub> transformed. Values are reported as mean ± SD.</p><p>MOI was calculated by dividing phage titer by bacterial concentration. MOI for the T7 variant library after the variant gene is expressed was estimated by titering on 10G with pHT7Helper1.</p><p>Limit of detection (LOD) for T7 acceptor phages (T7 Acc) and T7 lacking a tail fiber (T7Δ<italic>gp17</italic>) was established based on the ability of these phages to clear a bacterial lawn. These phages are unable to plaque on host lacking pHT7Helper1, but phages do express a tail fiber due to being propagated on host with pHT7Helper1. Functionally this allows these phages to complete one infection cycle and kill one host but does not allow the creation of plaque-viable progeny phages if that host does not also contain pHT7Helper1. At an MOI of greater than ~2, we noted plates no longer form lawns of bacteria but instead contain individual colonies or are clear, reflective of these singular assassinations. As expected, this effect occurs at different concentrations of phages for exponential or stationary host due to different host concentration at those stages of growth. As plaques cannot form under these conditions and these infections are not productive beyond a single infection, we simply used this cutoff as the LOD for this assay.</p><p>Growth time courses for UTI473 (<xref ref-type="fig" rid="fig5">Figure 5</xref>) and OD<sub>600</sub>were performed using a Synergy HTX Multi-Mode 96-well plate reader, using 140 μl of host and 10 μl of relevant phage titers. Phages were applied after an hour of incubation in the plate reader.</p></sec><sec id="s4-5"><title>Recombination rate and accumulation assays</title><p>To establish recombination rate (<xref ref-type="fig" rid="fig1">Figure 1C</xref>), we passaged T7 acceptor phages on 5 ml exponential phase <italic>E. coli</italic> 10G containing pHT7Helper1 and pHRec1. pHRec1 was used because the recombined <italic>gp17</italic> tail fiber is wildtype, ensuring every recombined phage is plaque-capable (derived from <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2B</xref> results). We sought to evaluate recombination rate after only one passage through the host to avoid misinterpretation of results in case recombined phages had different fitness than unrecombined phages. We used an MOI of 10 and allowed passage for 30 min, sufficient time for one wildtype phage passage, after which we halted any remaining reactions by adding 200 μl of chloroform and lysing the remaining bacterial host. Phages were then purified to acquire the final phage population. We established the phage population titer on 10G and 10G with pHT7Helper1. Both acceptor phages and recombined phages are capable of plaquing on 10G with pHT7Helper1, and this phage titer is used to count the total phage population. Only recombined phages are capable of plaquing on 10G, and this titer is used to count recombined phages. Recombination rate was established as the fraction titer of recombined phages divided by recombined phages. This was repeated in triplicate and reported as mean ± SD.</p><sec id="s4-5-1"><title>Method note</title><p>It should be noted that this assay does not delineate for when recombination occurs in the host or how frequently recombination occurs in any one host. For example, if recombination were to occur on the original phage genome, all subsequent progeny phages could contain the recombined gene. In contrast, if recombination were to occur on the phage genome while it is being replicated, anywhere from one individual progeny to all progeny could contain the recombined gene.</p><p>To validate accumulation of recombined phages over acceptor phages (<xref ref-type="fig" rid="fig1">Figure 1D,</xref> <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2E, F</xref>), we first generated a population of recombined phages using the same scheme as outlined for the recombination rate assay. After recombination, this phage population contained primarily T7 acceptor phages with a small percentage of recombined phage containing a wildtype <italic>gp17</italic> tail fiber. This phage population was passaged on 10G containing pHT7Helper1 and either pHCas9-3 (targeting the fixed region in the acceptor phage using g3, the most effective guide by EOP, <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2A</xref>) or pHCas9 (randomized control). Phages were incubated with host in 5 ml total at an initial MOI of 1 based on the titer of the whole phage population. Every 30 min until 180 min, and thereafter every 60 min until 300 min, ~250 μl of culture was removed, infection was stopped by adding 100 μl of chloroform, and phage samples were purified to establish the phage population at that timepoint. Titer at each timepoint was determined on both 10G and 10G with pHT7Helper1 with a single dilution series using whole-plate plaque assay. Percent accumulation was derived by dividing titer on 10G by titer on 10G with pHT7Helper1. Accumulation on both hosts was repeated in triplicate and reported as mean ± SD.</p></sec></sec><sec id="s4-6"><title>DMS plasmid library preparation</title><p>To create the DMS variant plasmid library, oligos were first designed and ordered from Agilent as a SurePrint Oligonucleotide Library (product G7220A, OLS 131-150mers). Every oligo contained a single substitution at a single position in the tip domain, overall including all non-synonymous substitutions, a single synonymous substitution, and a stop codon from position 472–554. Note that we did mutate the stop codon, which is position 554, that when substituted results in a three amino acid extension (-DAR) of <italic>gp17</italic>. We used the most frequently found codon for each amino acid in the <italic>gp17</italic> tail fiber to define the codon for each substitution. Oligos contained BsaI sites at each end to facilitate Golden Gate cloning. To accommodate a shorter oligo length, the library was split into three pools covering the whole tip domain. Oligo pools were amplified by PCR using 0.005 pmol total oligo pool as template and 15 total cycles to prevent PCR bias, then pools were purified. pHRec1 was used as template in a PCR reaction to create three backbones for each of the three pools. Backbones were treated with BsaI and Antarctic Phosphatase as follows. A 5 μl 10× CutSmart, 2 μl BsaI, ~1177 ng backbone, dH<sub>2</sub>O to 50 μl was mixed and incubated at 37°C for 2 hr, after which 1 μl additional BsaI, 2 μl Antarctic Phosphatase, 5.89 μl 10× Antarctic Phosphatase buffer was spiked into reaction. Reaction was incubated for one more hour at 37°C, then enzymes were heat inactivated at 65°C for 20 min (concentration ~20 ng/μl at this point) and used directly (no purification) in Golden Gate Assembly. Golden Gate Assembly was performed using ~100 ng of relevant pool backbone and a 2× molar ratio for oligos (~10 ng), combined with 2 μl 10× T4 DNA ligase buffer, 1 μl NEB Golden Gate Enzyme Mix, and dH<sub>2</sub>O to 20 µl. These reactions were cycled from 37°C to 16°C over 5 min, 30×, then held at 60°C for 5 min to complete Golden Gate Assembly. Membrane drop dialysis was then performed on each library pool for 75 min to enhance transformation efficiency. Then, 2 μl of each pool was transformed into 33 μl competent <italic>E. coli</italic> 10-beta (NEB C3020) cells. Drop plates were made at this point (spotting 2.5 μl of dilutions of each library on Lb plates with spectinomycin), and total actual transformed cells were estimated at ~2 × 10<sup>5</sup> CFU/ml. Each 1 ml pool was added to 4 ml Lb with spectinomycin and incubated overnight, then plasmids were purified. Plasmids concentration was determined by nanodrop and pools were then combined at an equimolar ratio to create the final phage variant pool, denoted as pHRec1-Lib. pHRec1-Lib was transformed into <italic>E. coli</italic> 10G with pHT7Helper1. Drop plates were made (spotting 2.5 μl of dilutions of each library onto Lb plates with spectinomycin and kanamycin) and total actual transformed cells were also estimated at ~2 × 10<sup>5</sup> CFU/ml. The 1 ml library was added to 4 ml Lb with spectinomycin and kanamycin and incubated overnight. This host, <italic>E. coli</italic> 10G with pHT7Helper1 and pHRec1-Lib, was the host used for Optimized Recombination during ORACLE.</p></sec><sec id="s4-7"><title>ORACLE: engineering T7 acceptor phages</title><p>Acceptor phages were assembled using YAC rebooting (<xref ref-type="bibr" rid="bib2">Ando et al., 2015</xref>; <xref ref-type="bibr" rid="bib33">Jaschke et al., 2012</xref>), which requires yeast transformation of relevant DNA segments, created as follows. A prs415 yeast centromere plasmid was split into three segments by PCR, separating the centromere and leucine selection marker, which partially limits recircularization and improved assembly efficiency (<xref ref-type="bibr" rid="bib40">Kuijpers et al., 2013</xref>). Wildtype T7 segments were made by PCR using wildtype T7 as template. At the site of recombination, the acceptor phage contains, in order, lox71 sites with an m2 spacer (<xref ref-type="bibr" rid="bib42">Langer et al., 2002</xref>) to facilitate one-way recombinase-mediated cassette exchange (RMCE), a fixed sequence that was derived from sfGFP with a nonsense mutation, a short region mimicking <italic>gp17</italic> to allow detection of acceptor phages by deep sequencing (5′ NGS in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>), a 3′ ‘pad’ to facilitate deep sequencing, and lox66 sites with a wt spacer (see <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). This entire region was turned into one DNA segment by serial SOE reactions.</p><p>Method note: Reversible or two-way RMCE using wildtype loxP sites could feasibly increase recombination efficiency as one-way RMCE is not necessarily required for ORACLE.</p><p>Method note: PCR, including PCR for deep sequencing, behaved inconsistently at lox sites. We theorize that this may be because these sites are inverted repeats. Our inclusion of the 3′ ‘pad’ region corrected this problem and facilitated acceptor phage detection by deep sequencing.</p><p>DNA parts were combined together (0.1 pmol/segment) and transformed into <italic>S. cerevisiae</italic> BY4741 using a high-efficiency yeast transformation protocol (<xref ref-type="bibr" rid="bib25">Gietz and Woods, 2002</xref>) using SD-Leu selection. After 2–3 days, colonies were picked and directly assayed by multiplex colony PCR to assay assembly. Multiplex PCR interrogated junctions in the YAC construct and was an effective way of distinguishing correctly assembled YACs. Correctly assembled YACs were purified and transformed into <italic>E. coli</italic> 10G cells containing pHT7Helper1, and after recovery 400 μl was used to inoculate 4.6 ml Lb. This culture was incubated until lysis, after which phages were purified to create the acceptor phage stock.</p></sec><sec id="s4-8"><title>ORACLE: Optimized <bold>R</bold>ecombination</title><p>Recombination was performed by adding T7 acceptor phages (MOI ~ 5) to 15 ml exponential phase 10G with pHT7Helper1 and pHRec1-Lib (shown as the donor plasmid in <xref ref-type="fig" rid="fig1">Figure 1</xref>), split across three 5 ml cultures. A high MOI is used to allow for one effective infection cycle. Cultures were incubated until lysis (~30 min). Lysed cultures were combined and purified. This phage population constitutes the initial recombined phage population and contained an estimated 2 × 10<sup>7</sup> variants/ml in a total phage population of ~2 × 10<sup>10</sup> PFU/ml. The remainder of the phages are acceptor phages. A schematic of the recombination is shown in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>. Note that pHT7Helper1 ensures progeny should remain viable by providing <italic>gp17 in trans</italic>.</p></sec><sec id="s4-9"><title>ORACLE: <bold>Ac</bold>cumulation</title><p>Accumulation was performed by adding ~MOI of 0.2 of recombined phages (50 μl or ~1 × 10<sup>9</sup> total phages) to 5 ml of stationary phase <italic>E. coli</italic> 10G with pHT7Helper1 and pHCas9-3 resuspended in fresh Lb with kanamycin and spectinomycin. Cultures are incubated until lysis (~3.5 hr), then phages are purified. This MOI was chosen to target 1% of acceptor phages remaining in the final population as an internal control – the remainder of the phage population is accumulated variant phages. Stationary phase was used because it was more inhibitory based on EOP (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2A</xref>). Note that pHT7Helper1 still ensures progeny should remain viable by providing <italic>gp17 in trans</italic> and progeny from accumulation do not fully express variant genes.</p><p>Method note: During ORACLE, the library gene is not actively repressed and some fraction of progeny phages are likely assembled with the variant gene or contain chimeric tail fibers with both proteins. This may account for some degree of the skew we see during accumulation, although skewed residues were not consistent with enrichment patterns on 10G. Here, this skew was not significant, but this could be an influencing factor in future studies. The bias can feasibly be further reduced by a number of methods of varying complexity, including repressing the genomic variant, increasing the amount of wildtype provided in trans, or simply reducing the number of replication events during ORACLE.</p><p>Method note: See <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2A</xref> for inhibition results for versions of pHCas9. When sequenced, individual plaques after selection had mutations in the region targeted by each gRNA, as expected for how resistance to Cas9 occurs. Note that acceptor phages are not actively destroyed but are rather inhibited and maintained at the same concentration. Selection may be improved by using multiple guide RNAs or using sgRNA platforms.</p></sec><sec id="s4-10"><title>ORACLE: Library Expression</title><p>Library expression was performed by adding the accumulated DMS library to 5 ml <italic>E. coli</italic> 10G (with no plasmid) at an MOI of ~1. Cultures are incubated for 30 min, then 200 μl chloroform is added to the culture to lyse any remaining cells and phages are purified. This constitutes the final phage variant library with full expression of the variant <italic>gp17</italic> tail fibers. This phage population is directly sequenced to establish the pre-selection library population.</p><p>Method note: This MOI and culture conditions are chosen to prevent phages from undergoing more than one replication cycle. Additional replication cycles would result in skew toward variants that grow better on the host used for expression. At an MOI of 1, progeny from the first replication cycle already comprise the majority of the possible concentration of phages for T7. Chloroform is added at 30 min to halt any rogue second infections in process.</p><p>Method note: Two points bear additional mention regarding ORACLE as a whole to create variant libraries. First, the importance of retaining variants that do not grow well on the host used to create the library cannot be overstated. These variants are critical for mapping functional regions. For example, we used 10G to grow our library, which happened to have the most significant selection of the susceptible hosts and had depletion of many functional regions. The resolution of this assay would have been deeply impacting if these variants had been lost. Second, due to possible depletion and skew, it is critical to assay library distribution after insertion and expression of the variants in the phage instead of, for example, assaying distribution in plasmid before phage insertion. While ORACLE is designed to avoid this problem, any selection that occurs during library construction needs to be identified prior to selection experiments.</p></sec><sec id="s4-11"><title>DMS selection</title><p>All DMS selection results, besides single-infection cycle experiments on resistant hosts noted later, were performed in the same way. The T7 variant library was added to 5 ml of exponential host at an MOI of ~10<sup>−2</sup>, and the culture was allowed to fully lyse (typically 40–80 min depending on the host). Phage lysate was purified and then the titer established for the host the phage was being selected on. This process was then repeated using the selected phage lysate. An MOI of 10<sup>−2</sup> was chosen to allow phages that grow slower a chance to replicate. For reference under these conditions, we expect wildtype to complete four infection cycles on a susceptible host. Phage lysate from the second selection was retained and used as template for deep sequencing to establish the post-selection phage population. The entire process was repeated in biological triplicate for each host. Single-infection cycle results cited in <xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref> and <xref ref-type="supplementary-material" rid="fig4sdata1">Figure 4—source data 1</xref> and <xref ref-type="supplementary-material" rid="fig4sdata2">2</xref> were performed on BW25113Δ<italic>rfaG</italic> and BW25113Δ<italic>rfaD</italic> using an MOI of ~1, then waiting for the culture to fully lyse, after which phage lysate was purified and sequenced directly.</p><p>Method note: The number of infection cycles should be carefully considered due to the effect of multiple exponential replication events on the phage population. As noted in the text, we expected less consistency as we increased infection cycles, especially on severely bottlenecked populations as seen on BW25113Δ<italic>rfaD</italic>, but additional infection cycles allow for increased competition between productive members.</p></sec><sec id="s4-12"><title>Deep sequencing preparation and analysis</title><p>We used deep sequencing to evaluate phage populations. We first amplified the tip domain by two-step PCR, or tailed amplicon sequencing, using KAPA HiFi. Primers for deep sequencing attach to constant regions adjacent to the tip domain (the target region is 304 bp total, between the 5′ NGS region and 3′ pad on <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). Constant regions are also installed in the fixed region of the acceptor phages for the same-size amplicon, so acceptor phages can also be detected. The first PCR reaction adds an internal barcode (used for technical replicates to assay PCR skew), a variable N region (to assist with nucleotide diversity during deep sequencing, this is essential for DMS libraries due to low nucleotide diversity at each position), and the universal Illumina adapter. Undiluted phages are used as template. Four forward and four reverse primers were used in each reaction, each with a variable N count (0, 2, 4, or 8). Primers were mixed at equimolar ratios, and total primers used was per recommended primer concentration. PCR was performed using 12 total cycles in the first PCR reaction, then the product of this reaction was purified. The second PCR reaction adds an index and the Illumina ‘stem’. Then, 1 μl of purified product from the first reaction was used as template using eight total PCR cycles. The product of this reaction was purified and used directly for deep sequencing. Each phage population was sampled at least twice using separate internal barcodes, and no PCR reactions were pooled. Total PCR cycles overall for each sample were kept at 20× to avoid PCR skew. All phage samples were deep sequenced using an Illumina MiSeq System, 2 × 250 read length using MiSeq Reagent Kit v2 or v2 Nano according to manufacturer's documentation.</p><p>Paired-end Illumina sequencing reads were merged with FLASH (Fast Length Adjustment of SHort reads) using the default software parameters (<xref ref-type="bibr" rid="bib16">Edgar and Flyvbjerg, 2015</xref>). Phred quality scores (Q scores) were used to compute the total number of expected errors (E) for each merged read, and reads exceeding an Emax of 1 were removed (<xref ref-type="bibr" rid="bib46">Magoč and Salzberg, 2011</xref>). Wildtype, acceptor phages, and each variant were then counted in the deep sequencing output. We correlated read counts for each technical replicate to determine if there was any notable skew from PCR or deep sequencing. Replicates correlated extremely well (R ≥ 0.98 for all samples), indicating no relevant PCR skew. Besides wildtype and acceptor counts, we included only sequences with single substitutions in our analysis. While this limited the scope of the analysis, it greatly reduced the possibility of deep sequencing error, resulting in an incorrect read count for a variant, as virtually every relevant error would result in at least a double substitution in our library. With this in mind and to avoid missing low abundance members after selection, we simply used a low read cutoff of 2 and did not utilize a pseudo-count of 1 for each position.</p><p>Of the 1660 variants, 3 (S487P, L524M, and R542N) fell below our LOD in the variant pool before selection. These positions were excluded from analysis as a pre-selection population could not be accurately determined, although both S487P and L542M subsequently emerged in several post-selection populations, indicating that they were present below the LOD. Technical replicates of each biological replicate were aggregated and each biological replicate was correlated to determine reproducibility, reported for each relevant figure as a figure supplement. Possible outliers were identified by data sorting, and lower correlation in 10G was noted to primarily be a result of differences in enrichment of several polar, uncharged substitutions and proline substitutions in the first biological replicate. These substitutions are proximally located near exterior loop HI and may indicate an unknown variable or growth condition in the first replicate that produces a slightly different enrichment pattern. Correlation was otherwise robust, and excluding only G479Q produces R = 0.94, 0.95, and 0.99 as displayed in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>. Positively charged, downward-facing substitutions were universally enriched in BW25113Δ<italic>rfaD</italic>, but correlation was reduced due to inconsistencies in which particular substitutions were the most enriched in a given replicate. While the same substitutions were enriched in all three replicates, suggesting reproducibility of results, the scale of enrichment varied considerably. Correlation was otherwise robust, and excluding the single most enriched substitution of each replicate (G521R, A500R, and G521H) produces R = 0.90, 0.93, and 0.86 as displayed.</p><p>Method note: BW25113Δ<italic>rfaD</italic> is the most resistant host by EOP, and we hypothesize that these inconsistencies in F<sub>N</sub> may arise due to severe loss of diversity, ‘bottlenecking’ the population, and causing stochastic differences in enrichment to become magnified with multiple rounds of selection across independent experiments. Future work with very resistant hosts may benefit from fewer rounds of selection to prevent significant stochastic divergence. Single-infection cycles are more consistent but provide fewer cycles for variants to directly compete with one another, as noted in methods for DMS selection.</p><p>To score enrichment for each variant, we used a basic functional score (F), averaging results of the three biological replicates, where <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>F</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>=</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mspace width="thinmathspace"/><mml:mfrac><mml:mrow><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mspace width="thinmathspace"/><mml:msub><mml:mi mathvariant="normal">%</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mspace width="thinmathspace"/><mml:msub><mml:mi mathvariant="normal">%</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula>. To compare variant performance across hosts, we normalized functional score (F<sub>N</sub>) to wildtype, where <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>=</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mspace width="thinmathspace"/><mml:mfrac><mml:mrow><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mspace width="thinmathspace"/><mml:msub><mml:mi mathvariant="normal">%</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mspace width="thinmathspace"/><mml:msub><mml:mi mathvariant="normal">%</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>W</mml:mi><mml:mi>T</mml:mi><mml:mspace width="thinmathspace"/><mml:msub><mml:mi mathvariant="normal">%</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mi>T</mml:mi><mml:mspace width="thinmathspace"/><mml:msub><mml:mi mathvariant="normal">%</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec id="s4-13"><title>Classifying variants and isolating variants</title><p>To define variant behavior on <italic>E. coli</italic> 10G, BL21, and BW25113, we considered variants depleted if F<sub>N</sub> was below 0.1 (i.e., performed 10 times worse than wildtype), tolerated if between 0.1 and 2, and enriched if above 2 (i.e., performed twice as good as wildtype) (<xref ref-type="fig" rid="fig2">Figure 2</xref>). As wildtype T7 effectively grows on all three hosts, we reasoned that it would be more challenging for an enriched mutant to surpass wildtype than it would be for a mutant to become depleted. These cutoffs were supported based on preliminary plaque assay results and the extent of standard deviation across biological replicates. For BW25113Δ<italic>rfaD</italic> and BW25113Δ<italic>rfaG,</italic> we further defined significantly enriched variants as performing at least 10 times better (F<sub>N</sub> ≥10) than wildtype because wildtype does not grow effectively on these strains (<xref ref-type="fig" rid="fig4">Figure 4</xref>).</p><p>We compared variant F<sub>N</sub> across 10G, BL21, and BW25113 to further characterize each variant and find functional variants (<xref ref-type="fig" rid="fig3">Figure 3</xref>). We sought to identify variants that had meaningfully different performance on different hosts, which would be strong evidence that either the wildtype residue or the variant substitution was important in a host-specific context. In addition to providing direct insight intro structure–function relationships, such substitutions or positions are ideal engineering targets for altering host range or increasing activity in engineered phages. We considered substitutions that were depleted (F<sub>N</sub> &lt; 0.1) on all three hosts to be intolerant, while substitutions that were tolerated or enriched (F<sub>N</sub> ≥ 0.1) in all three hosts to be generally tolerated. Substitutions that were depleted on one host but tolerated or enriched on another were considered functional. To broadly characterize each position, we counted the number of substitutions at that position that fell into each category, and colored positions (<xref ref-type="fig" rid="fig3">Figure 3C</xref>) as functional if over 33% of substitutions at that position were functional, intolerant if over 50% of substitutions were intolerant, and tolerant otherwise. We found these cutoffs to effectively group residues of interest, although we note that there remain substitutions that could be tolerant and relevant in different contexts or intolerant for these three hosts but not others.</p><p>For defining ideal host constriction mutants (<xref ref-type="fig" rid="fig6">Figure 6</xref>), we first constricted F<sub>N</sub> values that were greater than 1 to reduce the impact of higher scores on this comparison. Specifically we generated functional difference (F<sub>D</sub>), where if <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">F</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi mathvariant="normal">F</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>=</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi mathvariant="normal">F</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, and where <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">F</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">F</mml:mi><mml:mi mathvariant="normal">D</mml:mi></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>=</mml:mo><mml:mspace width="thinmathspace"/><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="normal">F</mml:mi><mml:mrow><mml:mi mathvariant="normal">N</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:msub><mml:mi mathvariant="normal">F</mml:mi><mml:mrow><mml:mi mathvariant="normal">N</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. F<sub>D</sub> thus ranged from 0 to 2 for each substitution, where scores above 1 are normalized to the maximum value for that host and fall between 1 and 2, minimizing but not eliminating weight for enrichment. We reasoned that for the purposes of finding host constriction mutants the extent of enrichment for a substitution is less relevant than if that substitution did poorly on another host. Put another way, it does not matter if a substitution is tolerated or enriched so long as it is depleted on a different host. For example, V544R has an F<sub>N</sub> of 9.09 in <italic>E. coli</italic> 10G but 0.07 in <italic>E. coli</italic> BW25113, while G479E has an F<sub>N</sub> of 1.73 in <italic>E. coli</italic> 10G and falls below the LOD for <italic>E. coli</italic> BW25113. For host constriction, both positions should be scored highly as the mutations can be tolerated or enriched in one host but are depleted in another. In contrast, A500H has an F<sub>N</sub> of 7.46 in <italic>E. coli</italic> 10G and 1.2 in <italic>E. coli</italic> BW25113. While F<sub>N</sub> differs significantly and the substitution is enriched on one host, it is still tolerated in the other host and thus makes a poor host constriction target. After generating F<sub>D</sub>, we simply subtracted the substitution’s F<sub>D</sub> on one host from the other in a pairwise comparison (<xref ref-type="fig" rid="fig6">Figure 6</xref>). Substitutions for host range constriction were considered ideal candidates if |F<sub>D</sub>| ≥ 1.</p><p>Variants with individual substitutions tested for EOP (<xref ref-type="fig" rid="fig4">Figures 4</xref>–<xref ref-type="fig" rid="fig6">6</xref>) were either picked from plaques or created using SDM on pHRec1, which was used to create the variant using ORACLE.</p></sec><sec id="s4-14"><title>Rosetta ΔΔG and physicochemical property comparison and calculations</title><p>The crystal structure of the <italic>gp17</italic> tip domain was obtained (PDB ID: 4A0T) and water molecules removed before calculations run. All modeling calculations were performed using the Rosetta molecular modeling suite v3.9. Substitutions were generated using the standard ddg_monomer application (<xref ref-type="bibr" rid="bib35">Kellogg et al., 2011</xref>) to enable local conformational to minimize energy. For comparison to F<sub>D</sub> (Figure S5), a ΔΔG of 10 or greater was considered destabilizing and ΔΔG values between 10 and 30 were transformed to values between 0 and 1, with any ΔΔG greater than 30 set to 1. ΔΔG values below 10 were transformed to values between 0 and −1 based on a range to −9.29, the most stabilizing ΔΔG value calculated. We calculated F<sub>D</sub> for this plot using the maximum F<sub>D</sub> value from <italic>E. coli</italic> 10G, BL21, or BW25113. The maximum was used because any substitution that has a high F<sub>D</sub> on any host was theorized to require a stable protein. Positions considered destabilizing (right side) are expected to have a very low maximum F<sub>D</sub>, whereas stabilizing positions (left side) may have a low or high F<sub>D</sub> based on tolerance of the substitution. Positions that were tolerated or functional that Rosetta predicted to be unstable on the right of the plot may be due to errors in stability calculations or actual structural distortions that are either smaller perturbations that do not affect fitness or are accommodated by quaternary arrangement. Alternatively, structural instability could be beneficial in some cases, allowing for enhanced receptor binding by, for example, exposing critical residues.</p><p>To compare physicochemical properties for <italic>E. coli</italic> 10G, BL21, and BW25113, we binned depleted (F<sub>N</sub> ≤ 0.1), tolerated (F<sub>N</sub> &gt; 0.1 and &lt;2), or enriched (F<sub>N</sub> ≥ 2) substitutions and derived the change in mass, hydrophilicity, and hydrophobicity for each substitution (<xref ref-type="bibr" rid="bib44">Li et al., 2016</xref>). For BW25113Δ<italic>rfaG</italic> and BW25113Δ<italic>rfaD,</italic> we binned using an F<sub>N</sub> of 10 for the cutoff for enrichment instead. Packages ggplot2 and ggpubr in R were then used to compare the means of the three groups using a Kruskal–Wallis test (<xref ref-type="bibr" rid="bib28">Hollander and Wolfe, 1973</xref>), while subsequent pairwise comparisons were made using a Wilcoxon test (<xref ref-type="bibr" rid="bib5">Bauer, 1972</xref>). Effect size (r) was calculated and can be summarized as r = abs(zscore)/sqrt(n), where n is the total number of observations among the two groups.</p></sec><sec id="s4-15"><title>Statistical analysis and source code</title><p>Alluvial plots (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>, <xref ref-type="fig" rid="fig4">Figure 4</xref>) and <xref ref-type="fig" rid="fig2">Figure 2F</xref> parallel plot were generated with RawGraphs. Violin plots for physicochemical properties are output from R. Significance for F<sub>N</sub> values in <xref ref-type="supplementary-material" rid="fig2sdata2">Figure 2—source data 2</xref> and <xref ref-type="supplementary-material" rid="fig4sdata2">Figure 4—source data 2</xref> was defined as an average F<sub>N</sub> two or more standard deviations from wildtype or below the LOD in all biological replicates. p-Values for EOP graphs compare plaque capability on the tested host to the reference host for the EOP graph. Hierarchical clustering in <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref> is performed in R using heatmap.2 without scaling. p-Values to compare functional data and EOP measurements were performed using two-tailed <italic>t</italic>-tests where values below the LOD were considered as the LOD. All other calculations and plots were made in Excel. Relevant statistical details of experiments can be found in the corresponding figure legends or relevant methods section. Source code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/raman-lab/oracle">https://github.com/raman-lab/oracle</ext-link>.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Dr. Rodney Welch for UTI473 strain and Dr. Douglas Weibel for BW25113 deletion mutant strains. We thank Dr. Karthik Anantharaman, Dr. John Yin, Laura Alexander, and Chutikarn Chitboonthavisuk for critical review of the manuscript. This work was partially supported by the US Department of Agriculture Hatch award (WIS02066) and the Gates Grand Challenges grant (OPP1150209). AM is supported by the Great Lakes Bioenergy Research Center (U.S. Department of Energy Award Number DE-SC0018409). ML is supported by NIH Molecular Biophysics Training Program T32 GM08293 and William H Peterson Fellowship in Biochemistry. KN is supported by NIH National Research Service Award T32 GM07215 and the Robert and Katherine Burris Biochemistry Fund.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>PH and SR have filed a provisional patent application on this technology (patent application number WIS0055US).</p></fn><fn fn-type="COI-statement" id="conf2"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf3"><p>PH and SR have filed a provisional patent application on this technology (patent application number WIS0055US). SR is on the scientific advisory board of MAP/PATH LLC.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Software</p></fn><fn fn-type="con" id="con3"><p>Methodology</p></fn><fn fn-type="con" id="con4"><p>Methodology</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Resources, Supervision, Funding acquisition, Project administration, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>List of primers used for experimentation.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-63775-supp1-v2.xlsx"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-63775-transrepform-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Source code has been deposited on github here: <ext-link ext-link-type="uri" xlink:href="https://github.com/raman-lab/oracle">https://github.com/raman-lab/oracle</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:rev:657e8eef12e4ee886f5d188b745ff0b38f94f479/">https://archive.softwareheritage.org/swh:1:rev:657e8eef12e4ee886f5d188b745ff0b38f94f479/</ext-link>). Raw NGS data is publicly available via Zenodo (doi:10.5281/zenodo.4583797). Other data generated or analyzed during this study are included in the manuscript and supporting files. Source data files have been provided for Figures 1, 2, 3, 4 and 6.</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Huss</surname><given-names>P</given-names></name><name><surname>Meger</surname><given-names>A</given-names></name><name><surname>Leander</surname><given-names>M</given-names></name><name><surname>Nishikawa</surname><given-names>K</given-names></name><name><surname>Raman</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Raw NGS Data for &quot;Mapping the functional landscape of the receptor binding domain of T7 bacteriophage by deep mutational scanning&quot;</data-title><source>Zenodo</source><pub-id assigning-authority="Zenodo" pub-id-type="doi">10.5281/zenodo.4583797</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abedon</surname> <given-names>ST</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Lysis from without</article-title><source>Bacteriophage</source><volume>1</volume><fpage>46</fpage><lpage>49</lpage><pub-id pub-id-type="doi">10.4161/bact.1.1.13980</pub-id><pub-id pub-id-type="pmid">21687534</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ando</surname> <given-names>H</given-names></name><name><surname>Lemire</surname> <given-names>S</given-names></name><name><surname>Pires</surname> <given-names>DP</given-names></name><name><surname>Lu</surname> <given-names>TK</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Engineering modular viral scaffolds for targeted bacterial population editing</article-title><source>Cell Systems</source><volume>1</volume><fpage>187</fpage><lpage>196</lpage><pub-id pub-id-type="doi">10.1016/j.cels.2015.08.013</pub-id><pub-id pub-id-type="pmid">26973885</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arthur</surname> <given-names>M</given-names></name><name><surname>Arbeit</surname> <given-names>RD</given-names></name><name><surname>Kim</surname> <given-names>C</given-names></name><name><surname>Beltran</surname> <given-names>P</given-names></name><name><surname>Crowe</surname> <given-names>H</given-names></name><name><surname>Steinbach</surname> <given-names>S</given-names></name><name><surname>Campanelli</surname> <given-names>C</given-names></name><name><surname>Wilson</surname> <given-names>RA</given-names></name><name><surname>Selander</surname> <given-names>RK</given-names></name><name><surname>Goldstein</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Restriction fragment length polymorphisms among uropathogenic <italic>Escherichia coli</italic> isolates: pap-related sequences compared with rrn operons</article-title><source>Infection and Immunity</source><volume>58</volume><fpage>471</fpage><lpage>479</lpage><pub-id pub-id-type="doi">10.1128/IAI.58.2.471-479.1990</pub-id><pub-id pub-id-type="pmid">1967594</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baba</surname> <given-names>T</given-names></name><name><surname>Ara</surname> <given-names>T</given-names></name><name><surname>Hasegawa</surname> <given-names>M</given-names></name><name><surname>Takai</surname> <given-names>Y</given-names></name><name><surname>Okumura</surname> <given-names>Y</given-names></name><name><surname>Baba</surname> <given-names>M</given-names></name><name><surname>Datsenko</surname> <given-names>KA</given-names></name><name><surname>Tomita</surname> <given-names>M</given-names></name><name><surname>Wanner</surname> <given-names>BL</given-names></name><name><surname>Mori</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Construction of <italic>Escherichia coli</italic> K-12 in-frame, single-gene knockout mutants: the keio collection</article-title><source>Molecular Systems Biology</source><volume>2</volume><elocation-id>2006.0008</elocation-id><pub-id pub-id-type="doi">10.1038/msb4100050</pub-id><pub-id pub-id-type="pmid">16738554</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bauer</surname> <given-names>DF</given-names></name></person-group><year iso-8601-date="1972">1972</year><article-title>Constructing confidence sets using rank statistics</article-title><source>Journal of the American Statistical Association</source><volume>67</volume><fpage>687</fpage><lpage>690</lpage><pub-id pub-id-type="doi">10.1080/01621459.1972.10481279</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bertozzi Silva</surname> <given-names>J</given-names></name><name><surname>Storms</surname> <given-names>Z</given-names></name><name><surname>Sauvageau</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Host receptors for bacteriophage adsorption</article-title><source>FEMS Microbiology Letters</source><volume>363</volume><elocation-id>fnw002</elocation-id><pub-id pub-id-type="doi">10.1093/femsle/fnw002</pub-id><pub-id pub-id-type="pmid">26755501</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Canfield</surname> <given-names>GS</given-names></name><name><surname>Duerkop</surname> <given-names>BA</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Molecular mechanisms of enterococcal-bacteriophage interactions and implications for human health</article-title><source>Current Opinion in Microbiology</source><volume>56</volume><fpage>38</fpage><lpage>44</lpage><pub-id pub-id-type="doi">10.1016/j.mib.2020.06.003</pub-id><pub-id pub-id-type="pmid">32652484</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname> <given-names>Z</given-names></name><name><surname>Guo</surname> <given-names>L</given-names></name><name><surname>Zhang</surname> <given-names>Y</given-names></name><name><surname>Walzem</surname> <given-names>RL</given-names></name><name><surname>Pendergast</surname> <given-names>JS</given-names></name><name><surname>Printz</surname> <given-names>RL</given-names></name><name><surname>Morris</surname> <given-names>LC</given-names></name><name><surname>Matafonova</surname> <given-names>E</given-names></name><name><surname>Stien</surname> <given-names>X</given-names></name><name><surname>Kang</surname> <given-names>L</given-names></name><name><surname>Coulon</surname> <given-names>D</given-names></name><name><surname>McGuinness</surname> <given-names>OP</given-names></name><name><surname>Niswender</surname> <given-names>KD</given-names></name><name><surname>Davies</surname> <given-names>SS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Incorporation of therapeutically modified Bacteria into gut Microbiota inhibits obesity</article-title><source>Journal of Clinical Investigation</source><volume>124</volume><fpage>3391</fpage><lpage>3406</lpage><pub-id pub-id-type="doi">10.1172/JCI72517</pub-id><pub-id pub-id-type="pmid">24960158</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname> <given-names>M</given-names></name><name><surname>Zhang</surname> <given-names>L</given-names></name><name><surname>Xin</surname> <given-names>S</given-names></name><name><surname>Yao</surname> <given-names>H</given-names></name><name><surname>Lu</surname> <given-names>C</given-names></name><name><surname>Zhang</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Inducible prophage mutant of <italic>Escherichia coli</italic> Can Lyse New Host and the Key Sites of Receptor Recognition Identification</article-title><source>Frontiers in Microbiology</source><volume>8</volume><elocation-id>147</elocation-id><pub-id pub-id-type="doi">10.3389/fmicb.2017.00147</pub-id><pub-id pub-id-type="pmid">28203234</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clokie</surname> <given-names>MR</given-names></name><name><surname>Millard</surname> <given-names>AD</given-names></name><name><surname>Letarov</surname> <given-names>AV</given-names></name><name><surname>Heaphy</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Phages in nature</article-title><source>Bacteriophage</source><volume>1</volume><fpage>31</fpage><lpage>45</lpage><pub-id pub-id-type="doi">10.4161/bact.1.1.14942</pub-id><pub-id pub-id-type="pmid">21687533</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Jonge</surname> <given-names>PA</given-names></name><name><surname>Nobrega</surname> <given-names>FL</given-names></name><name><surname>Brouns</surname> <given-names>SJJ</given-names></name><name><surname>Dutilh</surname> <given-names>BE</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Molecular and evolutionary determinants of bacteriophage host range</article-title><source>Trends in Microbiology</source><volume>27</volume><fpage>51</fpage><lpage>63</lpage><pub-id pub-id-type="doi">10.1016/j.tim.2018.08.006</pub-id><pub-id pub-id-type="pmid">30181062</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Sordi</surname> <given-names>L</given-names></name><name><surname>Lourenço</surname> <given-names>M</given-names></name><name><surname>Debarbieux</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The battle within: interactions of bacteriophages and Bacteria in the gastrointestinal tract</article-title><source>Cell Host &amp; Microbe</source><volume>25</volume><fpage>210</fpage><lpage>218</lpage><pub-id pub-id-type="doi">10.1016/j.chom.2019.01.018</pub-id><pub-id pub-id-type="pmid">30763535</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dedrick</surname> <given-names>RM</given-names></name><name><surname>Guerrero-Bustamante</surname> <given-names>CA</given-names></name><name><surname>Garlena</surname> <given-names>RA</given-names></name><name><surname>Russell</surname> <given-names>DA</given-names></name><name><surname>Ford</surname> <given-names>K</given-names></name><name><surname>Harris</surname> <given-names>K</given-names></name><name><surname>Gilmour</surname> <given-names>KC</given-names></name><name><surname>Soothill</surname> <given-names>J</given-names></name><name><surname>Jacobs-Sera</surname> <given-names>D</given-names></name><name><surname>Schooley</surname> <given-names>RT</given-names></name><name><surname>Hatfull</surname> <given-names>GF</given-names></name><name><surname>Spencer</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Engineered bacteriophages for treatment of a patient with a disseminated drug-resistant Mycobacterium abscessus</article-title><source>Nature Medicine</source><volume>25</volume><fpage>730</fpage><lpage>733</lpage><pub-id pub-id-type="doi">10.1038/s41591-019-0437-z</pub-id><pub-id pub-id-type="pmid">31068712</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dunne</surname> <given-names>M</given-names></name><name><surname>Rupf</surname> <given-names>B</given-names></name><name><surname>Tala</surname> <given-names>M</given-names></name><name><surname>Qabrati</surname> <given-names>X</given-names></name><name><surname>Ernst</surname> <given-names>P</given-names></name><name><surname>Shen</surname> <given-names>Y</given-names></name><name><surname>Sumrall</surname> <given-names>E</given-names></name><name><surname>Heeb</surname> <given-names>L</given-names></name><name><surname>Plückthun</surname> <given-names>A</given-names></name><name><surname>Loessner</surname> <given-names>MJ</given-names></name><name><surname>Kilcher</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Reprogramming bacteriophage host range through Structure-Guided design of chimeric receptor binding proteins</article-title><source>Cell Reports</source><volume>29</volume><fpage>1336</fpage><lpage>1350</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2019.09.062</pub-id><pub-id pub-id-type="pmid">31665644</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Durfee</surname> <given-names>T</given-names></name><name><surname>Nelson</surname> <given-names>R</given-names></name><name><surname>Baldwin</surname> <given-names>S</given-names></name><name><surname>Plunkett</surname> <given-names>G</given-names></name><name><surname>Burland</surname> <given-names>V</given-names></name><name><surname>Mau</surname> <given-names>B</given-names></name><name><surname>Petrosino</surname> <given-names>JF</given-names></name><name><surname>Qin</surname> <given-names>X</given-names></name><name><surname>Muzny</surname> <given-names>DM</given-names></name><name><surname>Ayele</surname> <given-names>M</given-names></name><name><surname>Gibbs</surname> <given-names>RA</given-names></name><name><surname>Csörgo</surname> <given-names>B</given-names></name><name><surname>Pósfai</surname> <given-names>G</given-names></name><name><surname>Weinstock</surname> <given-names>GM</given-names></name><name><surname>Blattner</surname> <given-names>FR</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>The complete genome sequence of <italic>Escherichia coli</italic> DH10B: insights into the biology of a laboratory workhorse</article-title><source>Journal of Bacteriology</source><volume>190</volume><fpage>2597</fpage><lpage>2606</lpage><pub-id pub-id-type="doi">10.1128/JB.01695-07</pub-id><pub-id pub-id-type="pmid">18245285</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edgar</surname> <given-names>RC</given-names></name><name><surname>Flyvbjerg</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Error filtering, pair assembly and error correction for next-generation sequencing reads</article-title><source>Bioinformatics</source><volume>31</volume><fpage>3476</fpage><lpage>3482</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btv401</pub-id><pub-id pub-id-type="pmid">26139637</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elena</surname> <given-names>SF</given-names></name><name><surname>Agudelo-Romero</surname> <given-names>P</given-names></name><name><surname>Lalić</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The evolution of viruses in multi-host fitness landscapes</article-title><source>The Open Virology Journal</source><volume>3</volume><fpage>1</fpage><lpage>6</lpage><pub-id pub-id-type="doi">10.2174/1874357900903010001</pub-id><pub-id pub-id-type="pmid">19572052</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fister</surname> <given-names>S</given-names></name><name><surname>Robben</surname> <given-names>C</given-names></name><name><surname>Witte</surname> <given-names>AK</given-names></name><name><surname>Schoder</surname> <given-names>D</given-names></name><name><surname>Wagner</surname> <given-names>M</given-names></name><name><surname>Rossmanith</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Influence of environmental factors on Phage-Bacteria interaction and on the efficacy and infectivity of phage P100</article-title><source>Frontiers in Microbiology</source><volume>7</volume><elocation-id>1152</elocation-id><pub-id pub-id-type="doi">10.3389/fmicb.2016.01152</pub-id><pub-id pub-id-type="pmid">27516757</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fowler</surname> <given-names>DM</given-names></name><name><surname>Fields</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Deep mutational scanning: a new style of protein science</article-title><source>Nature Methods</source><volume>11</volume><fpage>801</fpage><lpage>807</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3027</pub-id><pub-id pub-id-type="pmid">25075907</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fraser</surname> <given-names>JS</given-names></name><name><surname>Yu</surname> <given-names>Z</given-names></name><name><surname>Maxwell</surname> <given-names>KL</given-names></name><name><surname>Davidson</surname> <given-names>AR</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Ig-like domains on bacteriophages: a tale of promiscuity and deceit</article-title><source>Journal of Molecular Biology</source><volume>359</volume><fpage>496</fpage><lpage>507</lpage><pub-id pub-id-type="doi">10.1016/j.jmb.2006.03.043</pub-id><pub-id pub-id-type="pmid">16631788</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fraser</surname> <given-names>JS</given-names></name><name><surname>Maxwell</surname> <given-names>KL</given-names></name><name><surname>Davidson</surname> <given-names>AR</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Immunoglobulin-like domains on bacteriophage: weapons of modest damage?</article-title><source>Current Opinion in Microbiology</source><volume>10</volume><fpage>382</fpage><lpage>387</lpage><pub-id pub-id-type="doi">10.1016/j.mib.2007.05.018</pub-id><pub-id pub-id-type="pmid">17765600</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garcia</surname> <given-names>E</given-names></name><name><surname>Elliott</surname> <given-names>JM</given-names></name><name><surname>Ramanculov</surname> <given-names>E</given-names></name><name><surname>Chain</surname> <given-names>PS</given-names></name><name><surname>Chu</surname> <given-names>MC</given-names></name><name><surname>Molineux</surname> <given-names>IJ</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>The genome sequence of Yersinia pestis bacteriophage phiA1122 reveals an intimate history with the coliphage T3 and T7 genomes</article-title><source>Journal of Bacteriology</source><volume>185</volume><fpage>5248</fpage><lpage>5262</lpage><pub-id pub-id-type="doi">10.1128/JB.185.17.5248-5262.2003</pub-id><pub-id pub-id-type="pmid">12923098</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garcia-Doval</surname> <given-names>C</given-names></name><name><surname>van Raaij</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Structure of the receptor-binding carboxy-terminal domain of bacteriophage T7 tail fibers</article-title><source>PNAS</source><volume>109</volume><fpage>9390</fpage><lpage>9395</lpage><pub-id pub-id-type="doi">10.1073/pnas.1119719109</pub-id><pub-id pub-id-type="pmid">22645347</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gebhart</surname> <given-names>D</given-names></name><name><surname>Williams</surname> <given-names>SR</given-names></name><name><surname>Scholl</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Bacteriophage SP6 encodes a second tailspike protein that recognizes <italic>Salmonella enterica</italic> serogroups C<sub>2</sub> and C<sub>3</sub></article-title><source>Virology</source><volume>507</volume><fpage>263</fpage><lpage>266</lpage><pub-id pub-id-type="doi">10.1016/j.virol.2017.02.025</pub-id><pub-id pub-id-type="pmid">28285722</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gietz</surname> <given-names>RD</given-names></name><name><surname>Woods</surname> <given-names>RA</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Transformation of yeast by lithium acetate/single-stranded carrier DNA/polyethylene glycol method</article-title><source>Methods in Enzymology</source><volume>350</volume><fpage>87</fpage><lpage>96</lpage><pub-id pub-id-type="doi">10.1016/s0076-6879(02)50957-5</pub-id><pub-id pub-id-type="pmid">12073338</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>González-García</surname> <given-names>VA</given-names></name><name><surname>Bocanegra</surname> <given-names>R</given-names></name><name><surname>Pulido-Cid</surname> <given-names>M</given-names></name><name><surname>Martín-Benito</surname> <given-names>J</given-names></name><name><surname>Cuervo</surname> <given-names>A</given-names></name><name><surname>Carrascosa</surname> <given-names>JL</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Characterization of the initial steps in the T7 DNA ejection process</article-title><source>Bacteriophage</source><volume>5</volume><elocation-id>e1056904</elocation-id><pub-id pub-id-type="doi">10.1080/21597081.2015.1056904</pub-id><pub-id pub-id-type="pmid">26458390</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heineman</surname> <given-names>RH</given-names></name><name><surname>Springman</surname> <given-names>R</given-names></name><name><surname>Bull</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Optimal foraging by bacteriophages through host avoidance</article-title><source>The American Naturalist</source><volume>171</volume><fpage>E149</fpage><lpage>E157</lpage><pub-id pub-id-type="doi">10.1086/528962</pub-id><pub-id pub-id-type="pmid">18254683</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hollander</surname> <given-names>M</given-names></name><name><surname>Wolfe</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="1973">1973</year><source>Nonparametric Statistical Methods</source><publisher-loc>New York, United States</publisher-loc><publisher-name>Wiley</publisher-name></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holtzman</surname> <given-names>T</given-names></name><name><surname>Globus</surname> <given-names>R</given-names></name><name><surname>Molshanski-Mor</surname> <given-names>S</given-names></name><name><surname>Ben-Shem</surname> <given-names>A</given-names></name><name><surname>Yosef</surname> <given-names>I</given-names></name><name><surname>Qimron</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A continuous evolution system for contracting the host range of bacteriophage T7</article-title><source>Scientific Reports</source><volume>10</volume><fpage>1</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1038/s41598-019-57221-0</pub-id><pub-id pub-id-type="pmid">31941920</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Huss</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>oracle</data-title><source>Software Heritage</source><version designator="swh:1:rev:657e8eef12e4ee886f5d188b745ff0b38f94f479">swh:1:rev:657e8eef12e4ee886f5d188b745ff0b38f94f479</version><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:11bbe74ab1c2e68ce6404dc13282f7e8056593f3;origin=https://github.com/raman-lab/oracle;visit=swh:1:snp:fd4bdb917d9e58e1f1849376b467bd01b80527d8;anchor=swh:1:rev:657e8eef12e4ee886f5d188b745ff0b38f94f479/">https://archive.softwareheritage.org/swh:1:dir:11bbe74ab1c2e68ce6404dc13282f7e8056593f3;origin=https://github.com/raman-lab/oracle;visit=swh:1:snp:fd4bdb917d9e58e1f1849376b467bd01b80527d8;anchor=swh:1:rev:657e8eef12e4ee886f5d188b745ff0b38f94f479/</ext-link></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huss</surname> <given-names>P</given-names></name><name><surname>Raman</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Engineered bacteriophages as programmable biocontrol agents</article-title><source>Current Opinion in Biotechnology</source><volume>61</volume><fpage>116</fpage><lpage>121</lpage><pub-id pub-id-type="doi">10.1016/j.copbio.2019.11.013</pub-id><pub-id pub-id-type="pmid">31862543</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hyman</surname> <given-names>P</given-names></name><name><surname>Abedon</surname> <given-names>ST</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Bacteriophage host range and bacterial resistance</article-title><source>Advances in Applied Microbiology</source><volume>70</volume><fpage>217</fpage><lpage>248</lpage><pub-id pub-id-type="doi">10.1016/S0065-2164(10)70007-1</pub-id><pub-id pub-id-type="pmid">20359459</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jaschke</surname> <given-names>PR</given-names></name><name><surname>Lieberman</surname> <given-names>EK</given-names></name><name><surname>Rodriguez</surname> <given-names>J</given-names></name><name><surname>Sierra</surname> <given-names>A</given-names></name><name><surname>Endy</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>A fully decompressed synthetic bacteriophage øx174 genome assembled and archived in yeast</article-title><source>Virology</source><volume>434</volume><fpage>278</fpage><lpage>284</lpage><pub-id pub-id-type="doi">10.1016/j.virol.2012.09.020</pub-id><pub-id pub-id-type="pmid">23079106</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname> <given-names>W</given-names></name><name><surname>Bikard</surname> <given-names>D</given-names></name><name><surname>Cox</surname> <given-names>D</given-names></name><name><surname>Zhang</surname> <given-names>F</given-names></name><name><surname>Marraffini</surname> <given-names>LA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>RNA-guided editing of bacterial genomes using CRISPR-Cas systems</article-title><source>Nature Biotechnology</source><volume>31</volume><fpage>233</fpage><lpage>239</lpage><pub-id pub-id-type="doi">10.1038/nbt.2508</pub-id><pub-id pub-id-type="pmid">23360965</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kellogg</surname> <given-names>EH</given-names></name><name><surname>Leaver-Fay</surname> <given-names>A</given-names></name><name><surname>Baker</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Role of conformational sampling in computing mutation-induced changes in protein structure and stability</article-title><source>Proteins: Structure, Function, and Bioinformatics</source><volume>79</volume><fpage>830</fpage><lpage>838</lpage><pub-id pub-id-type="doi">10.1002/prot.22921</pub-id><pub-id pub-id-type="pmid">21287615</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khan Mirzaei</surname> <given-names>M</given-names></name><name><surname>Nilsson</surname> <given-names>AS</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Isolation of phages for phage therapy: a comparison of spot tests and efficiency of plating analyses for determination of host range and efficacy</article-title><source>PLOS ONE</source><volume>10</volume><elocation-id>e0118557</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0118557</pub-id><pub-id pub-id-type="pmid">25761060</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kilcher</surname> <given-names>S</given-names></name><name><surname>Studer</surname> <given-names>P</given-names></name><name><surname>Muessner</surname> <given-names>C</given-names></name><name><surname>Klumpp</surname> <given-names>J</given-names></name><name><surname>Loessner</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Cross-genus rebooting of custom-made, synthetic bacteriophage genomes in L-form Bacteria</article-title><source>PNAS</source><volume>115</volume><fpage>567</fpage><lpage>572</lpage><pub-id pub-id-type="doi">10.1073/pnas.1714658115</pub-id><pub-id pub-id-type="pmid">29298913</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kilcher</surname> <given-names>S</given-names></name><name><surname>Loessner</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Engineering bacteriophages as versatile biologics</article-title><source>Trends in Microbiology</source><volume>27</volume><fpage>355</fpage><lpage>367</lpage><pub-id pub-id-type="doi">10.1016/j.tim.2018.09.006</pub-id><pub-id pub-id-type="pmid">30322741</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kosuri</surname> <given-names>S</given-names></name><name><surname>Goodman</surname> <given-names>DB</given-names></name><name><surname>Cambray</surname> <given-names>G</given-names></name><name><surname>Mutalik</surname> <given-names>VK</given-names></name><name><surname>Gao</surname> <given-names>Y</given-names></name><name><surname>Arkin</surname> <given-names>AP</given-names></name><name><surname>Endy</surname> <given-names>D</given-names></name><name><surname>Church</surname> <given-names>GM</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Composability of regulatory sequences controlling transcription and translation in <italic>Escherichia coli</italic></article-title><source>PNAS</source><volume>110</volume><fpage>14024</fpage><lpage>14029</lpage><pub-id pub-id-type="doi">10.1073/pnas.1301301110</pub-id><pub-id pub-id-type="pmid">23924614</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuijpers</surname> <given-names>NG</given-names></name><name><surname>Solis-Escalante</surname> <given-names>D</given-names></name><name><surname>Bosman</surname> <given-names>L</given-names></name><name><surname>van den Broek</surname> <given-names>M</given-names></name><name><surname>Pronk</surname> <given-names>JT</given-names></name><name><surname>Daran</surname> <given-names>JM</given-names></name><name><surname>Daran-Lapujade</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A versatile, efficient strategy for assembly of multi-fragment expression vectors in <italic>Saccharomyces cerevisiae</italic> using 60 bp synthetic recombination sequences</article-title><source>Microbial Cell Factories</source><volume>12</volume><elocation-id>47</elocation-id><pub-id pub-id-type="doi">10.1186/1475-2859-12-47</pub-id><pub-id pub-id-type="pmid">23663359</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kutter</surname> <given-names>EM</given-names></name><name><surname>Kuhl</surname> <given-names>SJ</given-names></name><name><surname>Abedon</surname> <given-names>ST</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Re-establishing a place for phage therapy in western medicine</article-title><source>Future Microbiology</source><volume>10</volume><fpage>685</fpage><lpage>688</lpage><pub-id pub-id-type="doi">10.2217/fmb.15.28</pub-id><pub-id pub-id-type="pmid">26000644</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langer</surname> <given-names>SJ</given-names></name><name><surname>Ghafoori</surname> <given-names>AP</given-names></name><name><surname>Byrd</surname> <given-names>M</given-names></name><name><surname>Leinwand</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>A genetic screen identifies novel non-compatible loxP sites</article-title><source>Nucleic Acids Research</source><volume>30</volume><fpage>3067</fpage><lpage>3077</lpage><pub-id pub-id-type="doi">10.1093/nar/gkf421</pub-id><pub-id pub-id-type="pmid">12136089</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>JM</given-names></name><name><surname>Huddleston</surname> <given-names>J</given-names></name><name><surname>Doud</surname> <given-names>MB</given-names></name><name><surname>Hooper</surname> <given-names>KA</given-names></name><name><surname>Wu</surname> <given-names>NC</given-names></name><name><surname>Bedford</surname> <given-names>T</given-names></name><name><surname>Bloom</surname> <given-names>JD</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Deep mutational scanning of hemagglutinin helps predict evolutionary fates of human H3N2 influenza variants</article-title><source>PNAS</source><volume>115</volume><fpage>E8276</fpage><lpage>E8285</lpage><pub-id pub-id-type="doi">10.1073/pnas.1806133115</pub-id><pub-id pub-id-type="pmid">30104379</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname> <given-names>Z</given-names></name><name><surname>Tang</surname> <given-names>J</given-names></name><name><surname>Guo</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Identification of 14-3-3 proteins Phosphopeptide-Binding specificity using an Affinity-Based computational approach</article-title><source>PLOS ONE</source><volume>11</volume><elocation-id>e0147467</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0147467</pub-id><pub-id pub-id-type="pmid">26828594</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname> <given-names>TY</given-names></name><name><surname>Lo</surname> <given-names>YH</given-names></name><name><surname>Tseng</surname> <given-names>PW</given-names></name><name><surname>Chang</surname> <given-names>SF</given-names></name><name><surname>Lin</surname> <given-names>YT</given-names></name><name><surname>Chen</surname> <given-names>TS</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>A T3 and T7 recombinant phage acquires efficient adsorption and a broader host range</article-title><source>PLOS ONE</source><volume>7</volume><elocation-id>e30954</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0030954</pub-id><pub-id pub-id-type="pmid">22347414</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Magoč</surname> <given-names>T</given-names></name><name><surname>Salzberg</surname> <given-names>SL</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>FLASH: fast length adjustment of short reads to improve genome assemblies</article-title><source>Bioinformatics</source><volume>27</volume><fpage>2957</fpage><lpage>2963</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr507</pub-id><pub-id pub-id-type="pmid">21903629</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marinelli</surname> <given-names>LJ</given-names></name><name><surname>Piuri</surname> <given-names>M</given-names></name><name><surname>Swigonová</surname> <given-names>Z</given-names></name><name><surname>Balachandran</surname> <given-names>A</given-names></name><name><surname>Oldfield</surname> <given-names>LM</given-names></name><name><surname>van Kessel</surname> <given-names>JC</given-names></name><name><surname>Hatfull</surname> <given-names>GF</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>BRED: a simple and powerful tool for constructing mutant and recombinant bacteriophage genomes</article-title><source>PLOS ONE</source><volume>3</volume><elocation-id>e3957</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0003957</pub-id><pub-id pub-id-type="pmid">19088849</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marinelli</surname> <given-names>LJ</given-names></name><name><surname>Piuri</surname> <given-names>M</given-names></name><name><surname>Hatfull</surname> <given-names>GF</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Genetic manipulation of lytic bacteriophages with BRED: bacteriophage recombineering of electroporated DNA</article-title><source>Methods in Molecular Biology</source><volume>1898</volume><fpage>69</fpage><lpage>80</lpage><pub-id pub-id-type="doi">10.1007/978-1-4939-8940-9_6</pub-id><pub-id pub-id-type="pmid">30570724</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meyer</surname> <given-names>JR</given-names></name><name><surname>Dobias</surname> <given-names>DT</given-names></name><name><surname>Weitz</surname> <given-names>JS</given-names></name><name><surname>Barrick</surname> <given-names>JE</given-names></name><name><surname>Quick</surname> <given-names>RT</given-names></name><name><surname>Lenski</surname> <given-names>RE</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Repeatability and contingency in the evolution of a key innovation in phage lambda</article-title><source>Science</source><volume>335</volume><fpage>428</fpage><lpage>432</lpage><pub-id pub-id-type="doi">10.1126/science.1214449</pub-id><pub-id pub-id-type="pmid">22282803</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mizuno</surname> <given-names>CM</given-names></name><name><surname>Luong</surname> <given-names>T</given-names></name><name><surname>Cederstrom</surname> <given-names>R</given-names></name><name><surname>Krupovic</surname> <given-names>M</given-names></name><name><surname>Debarbieux</surname> <given-names>L</given-names></name><name><surname>Roach</surname> <given-names>DR</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Isolation and characterization of bacteriophages that infect <italic>Citrobacter rodentium</italic>, a Model Pathogen for Intestinal Diseases</article-title><source>Viruses</source><volume>12</volume><elocation-id>737</elocation-id><pub-id pub-id-type="doi">10.3390/v12070737</pub-id><pub-id pub-id-type="pmid">32650458</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Molineux</surname> <given-names>IJ</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>No syringes please, ejection of phage T7 DNA from the virion is enzyme driven</article-title><source>Molecular Microbiology</source><volume>40</volume><fpage>1</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1046/j.1365-2958.2001.02357.x</pub-id><pub-id pub-id-type="pmid">11298271</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nobrega</surname> <given-names>FL</given-names></name><name><surname>Vlot</surname> <given-names>M</given-names></name><name><surname>de Jonge</surname> <given-names>PA</given-names></name><name><surname>Dreesens</surname> <given-names>LL</given-names></name><name><surname>Beaumont</surname> <given-names>HJE</given-names></name><name><surname>Lavigne</surname> <given-names>R</given-names></name><name><surname>Dutilh</surname> <given-names>BE</given-names></name><name><surname>Brouns</surname> <given-names>SJJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Targeting mechanisms of tailed bacteriophages</article-title><source>Nature Reviews Microbiology</source><volume>16</volume><fpage>760</fpage><lpage>773</lpage><pub-id pub-id-type="doi">10.1038/s41579-018-0070-8</pub-id><pub-id pub-id-type="pmid">30104690</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pagnout</surname> <given-names>C</given-names></name><name><surname>Sohm</surname> <given-names>B</given-names></name><name><surname>Razafitianamaharavo</surname> <given-names>A</given-names></name><name><surname>Caillet</surname> <given-names>C</given-names></name><name><surname>Offroy</surname> <given-names>M</given-names></name><name><surname>Leduc</surname> <given-names>M</given-names></name><name><surname>Gendre</surname> <given-names>H</given-names></name><name><surname>Jomini</surname> <given-names>S</given-names></name><name><surname>Beaussart</surname> <given-names>A</given-names></name><name><surname>Bauda</surname> <given-names>P</given-names></name><name><surname>Duval</surname> <given-names>JFL</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Pleiotropic effects of rfa-gene mutations on <italic>Escherichia coli</italic> envelope properties</article-title><source>Scientific Reports</source><volume>9</volume><elocation-id>9696</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-019-46100-3</pub-id><pub-id pub-id-type="pmid">31273247</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pires</surname> <given-names>DP</given-names></name><name><surname>Cleto</surname> <given-names>S</given-names></name><name><surname>Sillankorva</surname> <given-names>S</given-names></name><name><surname>Azeredo</surname> <given-names>J</given-names></name><name><surname>Lu</surname> <given-names>TK</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Genetically engineered phages: a review of advances over the last decade</article-title><source>Microbiology and Molecular Biology Reviews</source><volume>80</volume><fpage>523</fpage><lpage>543</lpage><pub-id pub-id-type="doi">10.1128/MMBR.00069-15</pub-id><pub-id pub-id-type="pmid">27250768</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Principi</surname> <given-names>N</given-names></name><name><surname>Silvestri</surname> <given-names>E</given-names></name><name><surname>Esposito</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Advantages and limitations of bacteriophages for the treatment of bacterial infections</article-title><source>Frontiers in Pharmacology</source><volume>10</volume><elocation-id>00513</elocation-id><pub-id pub-id-type="doi">10.3389/fphar.2019.00513</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qimron</surname> <given-names>U</given-names></name><name><surname>Marintcheva</surname> <given-names>B</given-names></name><name><surname>Tabor</surname> <given-names>S</given-names></name><name><surname>Richardson</surname> <given-names>CC</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Genomewide screens for <italic>Escherichia coli</italic> genes affecting growth of T7 bacteriophage</article-title><source>PNAS</source><volume>103</volume><fpage>19039</fpage><lpage>19044</lpage><pub-id pub-id-type="doi">10.1073/pnas.0609428103</pub-id><pub-id pub-id-type="pmid">17135349</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raman</surname> <given-names>S</given-names></name><name><surname>Taylor</surname> <given-names>N</given-names></name><name><surname>Genuth</surname> <given-names>N</given-names></name><name><surname>Fields</surname> <given-names>S</given-names></name><name><surname>Church</surname> <given-names>GM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Engineering allostery</article-title><source>Trends in Genetics</source><volume>30</volume><fpage>521</fpage><lpage>528</lpage><pub-id pub-id-type="doi">10.1016/j.tig.2014.09.004</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reyes</surname> <given-names>A</given-names></name><name><surname>Semenkovich</surname> <given-names>NP</given-names></name><name><surname>Whiteson</surname> <given-names>K</given-names></name><name><surname>Rohwer</surname> <given-names>F</given-names></name><name><surname>Gordon</surname> <given-names>JI</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Going viral: next-generation sequencing applied to phage populations in the human gut</article-title><source>Nature Reviews Microbiology</source><volume>10</volume><fpage>607</fpage><lpage>617</lpage><pub-id pub-id-type="doi">10.1038/nrmicro2853</pub-id><pub-id pub-id-type="pmid">22864264</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Romero</surname> <given-names>PA</given-names></name><name><surname>Tran</surname> <given-names>TM</given-names></name><name><surname>Abate</surname> <given-names>AR</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Dissecting enzyme function with microfluidic-based deep mutational scanning</article-title><source>PNAS</source><volume>112</volume><fpage>7159</fpage><lpage>7164</lpage><pub-id pub-id-type="doi">10.1073/pnas.1422285112</pub-id><pub-id pub-id-type="pmid">26040002</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rousset</surname> <given-names>F</given-names></name><name><surname>Cui</surname> <given-names>L</given-names></name><name><surname>Siouve</surname> <given-names>E</given-names></name><name><surname>Becavin</surname> <given-names>C</given-names></name><name><surname>Depardieu</surname> <given-names>F</given-names></name><name><surname>Bikard</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Genome-wide CRISPR-dCas9 screens in <italic>E. coli</italic> identify essential genes and phage host factors</article-title><source>PLOS Genetics</source><volume>14</volume><elocation-id>e1007749</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1007749</pub-id><pub-id pub-id-type="pmid">30403660</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sausset</surname> <given-names>R</given-names></name><name><surname>Petit</surname> <given-names>MA</given-names></name><name><surname>Gaboriau-Routhiau</surname> <given-names>V</given-names></name><name><surname>De Paepe</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>New insights into intestinal phages</article-title><source>Mucosal Immunology</source><volume>13</volume><fpage>205</fpage><lpage>215</lpage><pub-id pub-id-type="doi">10.1038/s41385-019-0250-5</pub-id><pub-id pub-id-type="pmid">31907364</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schooley</surname> <given-names>RT</given-names></name><name><surname>Biswas</surname> <given-names>B</given-names></name><name><surname>Gill</surname> <given-names>JJ</given-names></name><name><surname>Hernandez-Morales</surname> <given-names>A</given-names></name><name><surname>Lancaster</surname> <given-names>J</given-names></name><name><surname>Lessor</surname> <given-names>L</given-names></name><name><surname>Barr</surname> <given-names>JJ</given-names></name><name><surname>Reed</surname> <given-names>SL</given-names></name><name><surname>Rohwer</surname> <given-names>F</given-names></name><name><surname>Benler</surname> <given-names>S</given-names></name><name><surname>Segall</surname> <given-names>AM</given-names></name><name><surname>Taplitz</surname> <given-names>R</given-names></name><name><surname>Smith</surname> <given-names>DM</given-names></name><name><surname>Kerr</surname> <given-names>K</given-names></name><name><surname>Kumaraswamy</surname> <given-names>M</given-names></name><name><surname>Nizet</surname> <given-names>V</given-names></name><name><surname>Lin</surname> <given-names>L</given-names></name><name><surname>McCauley</surname> <given-names>MD</given-names></name><name><surname>Strathdee</surname> <given-names>SA</given-names></name><name><surname>Benson</surname> <given-names>CA</given-names></name><name><surname>Pope</surname> <given-names>RK</given-names></name><name><surname>Leroux</surname> <given-names>BM</given-names></name><name><surname>Picel</surname> <given-names>AC</given-names></name><name><surname>Mateczun</surname> <given-names>AJ</given-names></name><name><surname>Cilwa</surname> <given-names>KE</given-names></name><name><surname>Regeimbal</surname> <given-names>JM</given-names></name><name><surname>Estrella</surname> <given-names>LA</given-names></name><name><surname>Wolfe</surname> <given-names>DM</given-names></name><name><surname>Henry</surname> <given-names>MS</given-names></name><name><surname>Quinones</surname> <given-names>J</given-names></name><name><surname>Salka</surname> <given-names>S</given-names></name><name><surname>Bishop-Lilly</surname> <given-names>KA</given-names></name><name><surname>Young</surname> <given-names>R</given-names></name><name><surname>Hamilton</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Development and use of personalized Bacteriophage-Based therapeutic cocktails to treat a patient with a disseminated resistant Acinetobacter baumannii infection</article-title><source>Antimicrobial Agents and Chemotherapy</source><volume>61</volume><elocation-id>e00954</elocation-id><pub-id pub-id-type="doi">10.1128/AAC.00954-17</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shen</surname> <given-names>TC</given-names></name><name><surname>Albenberg</surname> <given-names>L</given-names></name><name><surname>Bittinger</surname> <given-names>K</given-names></name><name><surname>Chehoud</surname> <given-names>C</given-names></name><name><surname>Chen</surname> <given-names>YY</given-names></name><name><surname>Judge</surname> <given-names>CA</given-names></name><name><surname>Chau</surname> <given-names>L</given-names></name><name><surname>Ni</surname> <given-names>J</given-names></name><name><surname>Sheng</surname> <given-names>M</given-names></name><name><surname>Lin</surname> <given-names>A</given-names></name><name><surname>Wilkins</surname> <given-names>BJ</given-names></name><name><surname>Buza</surname> <given-names>EL</given-names></name><name><surname>Lewis</surname> <given-names>JD</given-names></name><name><surname>Daikhin</surname> <given-names>Y</given-names></name><name><surname>Nissim</surname> <given-names>I</given-names></name><name><surname>Yudkoff</surname> <given-names>M</given-names></name><name><surname>Bushman</surname> <given-names>FD</given-names></name><name><surname>Wu</surname> <given-names>GD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Engineering the gut Microbiota to treat hyperammonemia</article-title><source>Journal of Clinical Investigation</source><volume>125</volume><fpage>2841</fpage><lpage>2850</lpage><pub-id pub-id-type="doi">10.1172/JCI79214</pub-id><pub-id pub-id-type="pmid">26098218</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shkoporov</surname> <given-names>AN</given-names></name><name><surname>Hill</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Bacteriophages of the human gut: the &quot;Known Unknown&quot; of the Microbiome</article-title><source>Cell Host &amp; Microbe</source><volume>25</volume><fpage>195</fpage><lpage>209</lpage><pub-id pub-id-type="doi">10.1016/j.chom.2019.01.017</pub-id><pub-id pub-id-type="pmid">30763534</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Silva</surname> <given-names>YJ</given-names></name><name><surname>Costa</surname> <given-names>L</given-names></name><name><surname>Pereira</surname> <given-names>C</given-names></name><name><surname>Mateus</surname> <given-names>C</given-names></name><name><surname>Cunha</surname> <given-names>A</given-names></name><name><surname>Calado</surname> <given-names>R</given-names></name><name><surname>Gomes</surname> <given-names>NC</given-names></name><name><surname>Pardo</surname> <given-names>MA</given-names></name><name><surname>Hernandez</surname> <given-names>I</given-names></name><name><surname>Almeida</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Phage therapy as an approach to prevent Vibrio anguillarum infections in fish larvae production</article-title><source>PLOS ONE</source><volume>9</volume><elocation-id>e114197</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0114197</pub-id><pub-id pub-id-type="pmid">25464504</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Valvano</surname> <given-names>MA</given-names></name><name><surname>Messner</surname> <given-names>P</given-names></name><name><surname>Kosma</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Novel pathways for biosynthesis of nucleotide-activated glycero-manno-heptose precursors of bacterial glycoproteins and cell surface polysaccharides</article-title><source>Microbiology</source><volume>148</volume><fpage>1979</fpage><lpage>1989</lpage><pub-id pub-id-type="doi">10.1099/00221287-148-7-1979</pub-id><pub-id pub-id-type="pmid">12101286</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yehl</surname> <given-names>K</given-names></name><name><surname>Lemire</surname> <given-names>S</given-names></name><name><surname>Yang</surname> <given-names>AC</given-names></name><name><surname>Ando</surname> <given-names>H</given-names></name><name><surname>Mimee</surname> <given-names>M</given-names></name><name><surname>Torres</surname> <given-names>MT</given-names></name><name><surname>de la Fuente-Nunez</surname> <given-names>C</given-names></name><name><surname>Lu</surname> <given-names>TK</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Engineering phage Host-Range and suppressing bacterial resistance through phage tail fiber mutagenesis</article-title><source>Cell</source><volume>179</volume><fpage>459</fpage><lpage>469</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2019.09.015</pub-id><pub-id pub-id-type="pmid">31585083</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yosef</surname> <given-names>I</given-names></name><name><surname>Goren</surname> <given-names>MG</given-names></name><name><surname>Globus</surname> <given-names>R</given-names></name><name><surname>Molshanski-Mor</surname> <given-names>S</given-names></name><name><surname>Qimron</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Extending the host range of bacteriophage particles for DNA transduction</article-title><source>Molecular Cell</source><volume>66</volume><fpage>721</fpage><lpage>728</lpage><pub-id pub-id-type="doi">10.1016/j.molcel.2017.04.025</pub-id><pub-id pub-id-type="pmid">28552617</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.63775.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Turnbaugh</surname><given-names>Peter</given-names></name><role>Reviewing Editor</role><aff><institution>University of California, San Francisco</institution><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Debarbieux</surname><given-names>Laurent</given-names> </name><role>Reviewer</role><aff><institution>Institut Pasteur</institution><country>France</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Duerkop</surname><given-names>Breck A</given-names></name><role>Reviewer</role><aff><institution>University of Colorado School of Medicine</institution><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Fraser</surname><given-names>James S</given-names></name><role>Reviewer</role><aff><institution>University of California, San Francisco</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>Huss et al. have developed a novel tool (ORACLE) for generating libraries of phage variants. They go on to apply this tool to study the residues important for T7 host specificity, providing a rich dataset for in-depth functional studies. They validate a subset of hits and use this information to engineer T7 variants that may be able to overcome bacterial resistance against a urinary tract infection associated strain, consistent with their in vitro results. Their approach provides both a valuable new tool and intriguing biological insights prompting future studies.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Mapping the Functional Landscape of the Receptor Binding Domain of T7 Bacteriophage by Deep Mutational Scanning&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by four peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation has been overseen by Gisela Storz as the Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Laurent Debarbieux (Reviewer #2); Breck A Duerkop (Reviewer #3); James S Fraser (Reviewer #4).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>We would like to draw your attention to changes in our revision policy that we have made in response to COVID-19 (https://elifesciences.org/articles/57162). Specifically, we are asking editors to accept without delay manuscripts, like yours, that they judge can stand as <italic>eLife</italic> papers without additional data, even if they feel that they would make the manuscript stronger. Thus the revisions requested below only address clarity and presentation.</p><p>Summary:</p><p>Huss et al. describe a phage genome engineering technology that they call ORACLE. This technique uses recombineering of a phage target gene with a variant library to identify both gain and loss of function mutations. The beauty of this method and what makes it superior to other techniques is that it dramatically limits loss of mutants that are less fit during the initial round of library generation. Thus, the pool of variants is vast and is reduced in bias toward more fit species based on the host used for initial library amplification. They use the model coliphage T7 as a proof of principal and show that several previously unidentified residues of in the T7 tail fiber play critical roles in both loss and gain of function for phage infectivity and they also identify residues that are major drivers of altered host tropism. Lastly, they apply this library to a pathogenic UTI associated strain of <italic>E. coli</italic> which is normally resistant to wild type T7 infection and identify tail variants of T7 that can now infect this strain, highlighting the applicability of this method toward the discovery of engineered phages that could be used therapeutically. Altogether this is an important advancement in phage engineering that shows potential promise for future phage therapies.</p><p>Essential revisions:</p><p>1) Claims about generalizability should either be removed, qualified with the various caveats, or supported by additional data. This study focused on a single phage gene and a single host bacterial species. As such, it is not clear if ORACLE will work well in other contexts. More concerningly, the lack of reproducibility across technical replicates in some of the experiments (e.g., subsection “Discovery of gain-of-function variants against resistant hosts”) may indicate that this method will not work for other T7 genes or phenotypes of interests.</p><p>The authors state that ORACLE overcomes three major hurdles that make it better than existing methods, one of which is &quot;generalizability for virtually any phage&quot;, while denouncing other systems for being applicable for highly transformable hosts only. This is highly exaggerated since ORACLE requires transformation of two plasmids (helper and donor) including one with tunable gene expression, which is clearly not possible in many bacteria. Furthermore, the enrichment step requires a strain with a functional CRISPR/Cas9 system, which again is not so obvious in the bacterial world.</p><p>T7 and its <italic>E. coli</italic> hosts are domesticated strains where phage engineering is considered easier than less well studied phages and their hosts. Considering the authors indicate that the ORACLE method could be applied to any phage-bacteria pair, I would like to see just how feasible it is to generate a highly diverse library on a phage-host pair that are not as well studied as T7-<italic>E. coli</italic>. This is the situation that would likely occur therapeutically.</p><p>2) The description and reasoning behind the use of the helper plasmid carrying the wild type tail fiber is not clear as described. This is really what reduces the bias in the first round of library generation and is critical to the technology. I had to re-read this section several times to fully understand the purpose of this. It would be nice to illustrate this in more detail in Figure 1A, showing that the first round of phage packaging of variants is in to particles that most likely have WT tail fibers, thus all phages generated regardless of the variant DNA packaged should in theory have an equal chance of infecting a host and being propagated in the accumulation stage.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.63775.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) Claims about generalizability should either be removed, qualified with the various caveats, or supported by additional data. This study focused on a single phage gene and a single host bacterial species. As such, it is not clear if ORACLE will work well in other contexts.</p></disp-quote><p>In the revision, we more clearly state that a caveat of ORACLE is that the propagating host be transformable and be capable of maintaining a plasmid library (see changes to manuscript below). While this requirement limits the broader applicability of ORACLE, many species of basic science and therapeutic relevance such as <italic>Acinetobacter baumannii, Neisseria gonorrhoeae, Campylobacter jejuni, Enterococcus faecalis, Pseudomonas aeruginosa, Salmonella typhimurium and Salmonella typhi</italic> are sufficiently transformable to be amenable to ORACLE. Additionally, techniques like conjugation could be leveraged to establish a plasmid library in more refractory strains such as <italic>Clostridium difficile</italic>.</p><p>The reviewer is correct that ORACLE may be difficult to implement for an arbitrary phage-bacterial system, and we have made modifications to our claims in the revision as follows.</p><p>Changes to manuscript:</p><p>“Our approach presents a generalized framework for characterizing sequence function relationships in many phage-bacterial systems.”</p><p>“ORACLE allows sequence programmability and generalizability to phages with transformable bacterial hosts capable of maintaining a plasmid library.”</p><p>“Any phage, including lysogenic phages, with a sequenced genome and a transformable host that can maintain a plasmid library should be amenable to ORACLE.”</p><p>“ORACLE is designed as a foundational technology to elucidate sequence-function relationships in phage genes.”</p><p>“Any phage with a sequenced genome and a transformable host capable of maintaining a plasmid library should be amenable to ORACLE because the phage variants are created during the natural infection cycle.”</p><disp-quote content-type="editor-comment"><p>More concerningly, the lack of reproducibility across technical replicates in some of the experiments (e.g., subsection “Discovery of gain-of-function variants against resistant hosts”) may indicate that this method will not work for other T7 genes or phenotypes of interests.</p></disp-quote><p>Our data shows high reproducibility across biological replicates in 4 out of 5 deep mutational scanning experiments carried out in this paper (Figure 2—figure supplement 1 and Figure 4—figure supplement 1). However, on one host, BW25113∆<italic>rfaD</italic>, correlation across biological replicates is lower for which our explanation is as follows. T7 variants likely experience the strongest selection pressure on BW25113∆<italic>rfaD</italic> among all hosts tested in this paper, because this strain encodes the largest truncation of the phage receptor (surface LPS) required for T7 infection. This results in a population with low sequence diversity after selection where stochastic differences in experimental conditions across replicates may give rise to greater variability in enrichment due to exponential phage amplification. This effect is increased during the estimated four infection cycles used for selection. On permissive hosts, this effect is buffered by the larger diversity of viable T7 variants leading to greater consistency between replicates.</p><p>To address the reviewer’s concern, we have included two additional data items:</p><p>1) Ranking of the top T7 variants on BW25113∆<italic>rfaD</italic>: Although the enrichment scores on BW25113∆<italic>rfaD</italic> were variable, the ranking of the top T7 variants across different replicates was consistent, underscoring the robustness of the assay. We have added a new supplementary figure (Figure 4—figure supplement 3) with the top ranked variants on this host and BW25113∆<italic>rfaG</italic>.</p><p>2) Correlation plot after one round of selection: We normally compute enrichment scores after four infection cycles on the host which may lead to greater divergence of enrichment scores in a low diversity population. Therefore, we have also added functional scoring data and correlation plots after one round of selection for both BW25113∆<italic>rfaD</italic> and BW25113∆<italic>rfaG</italic> (Figure 4—figure supplement 4 and Figure 4—source data 1 and 2). Data after a single passage is much more consistent (correlation~0.90 on BW25113∆<italic>rfaD</italic>), in line with our hypothesis that additional infection cycles decreases correlation between replicates.</p><p>Lower reproducibility on BW25113∆<italic>rfaD</italic> does not diminish the applicability of ORACLE to other T7 genes as suggested by the reviewer. But it does emphasize the importance of experimental design and subsequent interpretation of results.</p><p>Changes to manuscript:</p><p>We have added Figure 4—figure supplement 3 listing the top ranked variants after selection on BW25113∆<italic>rfaD</italic> and BW25113∆<italic>rfaG</italic> and Figure 4—figure supplement 4 with correlation plots using a single infection cycle for selection. We have updated Figure 4—source data 1 and Figure 4—source data 2 and the Materials and methods appropriately. Specific changes to the main text are as follows:</p><p>“Although the scale of F<sub>N</sub> was inconsistent across replicates on BW25113Δ<italic>rfaD</italic>, the same substitutions were largely enriched in all three replicates, suggesting reproducibility of results (Figure 4—figure supplement 3). […] Separately we examined correlation after selection using only a single infection cycle, which produced more highly correlated results for BW25113Δ<italic>rfaD</italic> (R=0.89, 0.90, 0.89) (Figure 4—figure supplement 4), indicating fewer infection cycles may be ideal for future work with highly resistant hosts.”</p><p>“Each variant was given a functional score, F, based on the ratio of their relative abundance before and after selection consisting of an estimated four infection cycles, which was then normalized to wildtype to yield F<sub>N</sub> where wildtype F<sub>N</sub> = 1 (Figure 2C-E, see Materials and methods).”</p><disp-quote content-type="editor-comment"><p>The authors state that ORACLE overcomes three major hurdles that make it better than existing methods, one of which is &quot;generalizability for virtually any phage&quot;, while denouncing other systems for being applicable for highly transformable hosts only. This is highly exaggerated since ORACLE requires transformation of two plasmids (helper and donor) including one with tunable gene expression, which is clearly not possible in many bacteria. Furthermore, the enrichment step requires a strain with a functional CRISPR/Cas9 system, which again is not so obvious in the bacterial world.</p></disp-quote><p>Our comment regarding highly transformable hosts is in relation to direct transformation of libraries of phage genomes which can be challenging, compared to smaller plasmid libraries in ORACLE. We have modified the sentence as shown below. The reviewer is correct that ORACLE requires maintenance of plasmids and in the revision, we qualify the generalizability of ORACLE with this caveat (also see response to comment 1). However, there is no need for a tunable promoter as the variant library and Cas9 are both expressed from constitutive promoters. It is also worth noting that the role of Cas9 to cleave unrecombined phages can be performed by other site-specific nucleases whose corresponding restriction sequence is inserted in the acceptor phage genome between the recombinase sites.</p><p>Changes to manuscript:</p><p>“Direct transformation of phage libraries, while ideal for creating one or small groups of synthetic phages, will not work because phage genomes are typically too large for library transformation or are reliant on highly transformable hosts (Ando et al., 2015; Kilcher et al., 2018; Marinelli et al., 2008, 2019).”</p><disp-quote content-type="editor-comment"><p>T7 and its <italic>E. coli</italic> hosts are domesticated strains where phage engineering is considered easier than less well studied phages and their hosts. Considering the authors indicate that the ORACLE method could be applied to any phage-bacteria pair, I would like to see just how feasible it is to generate a highly diverse library on a phage-host pair that are not as well studied as T7-<italic>E. coli</italic>. This is the situation that would likely occur therapeutically.</p></disp-quote><p>We agree with the reviewer that technical hurdles will have to be overcome to extend ORACLE to non-model phage-bacterial systems. However, in our opinion, there is much to learned by simply engineering T7 and other common coliphages against pathogenic <italic>E. coli</italic> strains and related enterobacterial species. Our approach makes this possible because once the phage library is generated on a permissive laboratory host, the variant library can be tested on a several pathogens to identify highly active phage variants. Preliminary results from other ongoing projects in my laboratory suggest efficacy against multiple therapeutically relevant hosts.</p><disp-quote content-type="editor-comment"><p>2) The description and reasoning behind the use of the helper plasmid carrying the wild type tail fiber is not clear as described. This is really what reduces the bias in the first round of library generation and is critical to the technology. I had to re-read this section several times to fully understand the purpose of this. It would be nice to illustrate this in more detail in Figure 1A, showing that the first round of phage packaging of variants is in to particles that most likely have WT tail fibers, thus all phages generated regardless of the variant DNA packaged should in theory have an equal chance of infecting a host and being propagated in the accumulation stage.</p></disp-quote><p>We have altered and simplified Figure 1A to make the role of the helper plasmid clearer in both recombination and accumulation stages and further emphasize the importance of the lack of helper plasmid during expression.</p><p>Changes to manuscript:</p><p>The graphic in Figure 1A has been simplified and improved to better illustrate the role of the helper plasmid, and the Figure 1 legend has been updated accordingly.</p><p>“To minimize biasing of variants during propagation, a helper plasmid constitutively provides the wildtype tail fiber <italic>in trans</italic> such that all progeny phages can amplify comparably regardless of the fitness benefit or deficient of any variant.”</p><p>“To enrich recombined phages in this pool, we passage all progeny phages on <italic>E. coli</italic> expressing Cas9 and a gRNA targeting the fixed sequence flanked by recombinase sites we introduced into the acceptor phage. […] As a result, only unrecombined phages will be inhibited while recombined phages with tail fiber variants are Accumulated without bias.”</p><p>“In the final step, phages are propagated on <italic>E. coli</italic> which lack the helper plasmid that previously provided the wild type tail fiber <italic>in trans</italic> to prevent bias. In this Library Expression, propagation on this host allows for full expression of the library variant – this is the first time during library creation that the variant is fully expressed on the phage particle.”</p></body></sub-article></article>