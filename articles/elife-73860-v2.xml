<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">73860</article-id><article-id pub-id-type="doi">10.7554/eLife.73860</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Biochemistry and Chemical Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Structural Biology and Molecular Biophysics</subject></subj-group></article-categories><title-group><article-title>Bayesian machine learning analysis of single-molecule fluorescence colocalization images</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-255110"><name><surname>Ordabayev</surname><given-names>Yerdos A</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1493-9364</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-11001"><name><surname>Friedman</surname><given-names>Larry J</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4946-8731</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-5568"><name><surname>Gelles</surname><given-names>Jeff</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7910-3421</contrib-id><email>gelles@brandeis.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-3158"><name><surname>Theobald</surname><given-names>Douglas L</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2695-8343</contrib-id><email>dtheobald@brandeis.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05abbep66</institution-id><institution>Department of Biochemistry, Brandeis University</institution></institution-wrap><addr-line><named-content content-type="city">Waltham</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Gonzalez</surname><given-names>Ruben L</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00hj8s172</institution-id><institution>Columbia University</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Faraldo-Gómez</surname><given-names>José D</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01cwqze88</institution-id><institution>National Heart, Lung and Blood Institute, National Institutes of Health</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>23</day><month>03</month><year>2022</year></pub-date><pub-date pub-type="collection"><year>2022</year></pub-date><volume>11</volume><elocation-id>e73860</elocation-id><history><date date-type="received" iso-8601-date="2021-09-14"><day>14</day><month>09</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2022-03-19"><day>19</day><month>03</month><year>2022</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2021-10-01"><day>01</day><month>10</month><year>2021</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2021.09.30.462536"/></event></pub-history><permissions><copyright-statement>© 2022, Ordabayev et al</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>Ordabayev et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-73860-v2.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-73860-figures-v2.pdf"/><abstract><p>Multi-wavelength single-molecule fluorescence colocalization (CoSMoS) methods allow elucidation of complex biochemical reaction mechanisms. However, analysis of CoSMoS data is intrinsically challenging because of low image signal-to-noise ratios, non-specific surface binding of the fluorescent molecules, and analysis methods that require subjective inputs to achieve accurate results. Here, we use Bayesian probabilistic programming to implement Tapqir, an unsupervised machine learning method that incorporates a holistic, physics-based causal model of CoSMoS data. This method accounts for uncertainties in image analysis due to photon and camera noise, optical non-uniformities, non-specific binding, and spot detection. Rather than merely producing a binary ‘spot/no spot’ classification of unspecified reliability, Tapqir objectively assigns spot classification probabilities that allow accurate downstream analysis of molecular dynamics, thermodynamics, and kinetics. We both quantitatively validate Tapqir performance against simulated CoSMoS image data with known properties and also demonstrate that it implements fully objective, automated analysis of experiment-derived data sets with a wide range of signal, noise, and non-specific binding characteristics.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>CoSMoS</kwd><kwd>Tapqir</kwd><kwd>probablistic programming</kwd><kwd>pyro</kwd><kwd>TIRF</kwd><kwd>fluorescence microscopy</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id><institution>National Institute of General Medical Sciences</institution></institution-wrap></funding-source><award-id>R01GM121384</award-id><principal-award-recipient><name><surname>Gelles</surname><given-names>Jeff</given-names></name><name><surname>Theobald</surname><given-names>Douglas L</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id><institution>National Institute of General Medical Sciences</institution></institution-wrap></funding-source><award-id>R01GM081648</award-id><principal-award-recipient><name><surname>Gelles</surname><given-names>Jeff</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A physics-based, statistically rigorous mathematical model enables automated, objective interpretation of images from single-molecule fluorescence colocalization microscopy experiments.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>A central concern of modern biology is understanding at the molecular level the chemical and physical mechanisms by which protein and nucleic acid macromolecules perform essential cellular functions. The operation of many such macromolecules requires that they work not as isolated molecules in solution but as components of dynamic molecular complexes that self-assemble and change structure and composition as they function. For more than two decades, scientists have successfully explored the molecular mechanisms of many such complex and dynamic systems using multi-wavelength single molecule fluorescence methods such as smFRET (single-molecule fluorescence resonance energy transfer) (<xref ref-type="bibr" rid="bib31">Roy et al., 2008</xref>) and multi-wavelength single-molecule colocalization methods (CoSMoS, colocalization single molecule spectroscopy) (<xref ref-type="bibr" rid="bib20">Larson et al., 2014</xref>; <xref ref-type="bibr" rid="bib42">van Oijen, 2011</xref>; <xref ref-type="bibr" rid="bib10">Friedman and Gelles, 2012</xref>).</p><p>CoSMoS is a technique to measure the kinetics of dynamic interactions between individual molecules. The CoSMoS method has been used for elucidating the mechanisms of complex biochemical processes in vitro. Examples include cell cycle regulation (<xref ref-type="bibr" rid="bib22">Lu et al., 2015b</xref>), ubiquitination and proteasome-mediated protein degradation (<xref ref-type="bibr" rid="bib21">Lu et al., 2015a</xref>), DNA replication (<xref ref-type="bibr" rid="bib13">Geertsema et al., 2014</xref>; <xref ref-type="bibr" rid="bib39">Ticau et al., 2015</xref>), transcription (<xref ref-type="bibr" rid="bib47">Zhang et al., 2012</xref>; <xref ref-type="bibr" rid="bib10">Friedman and Gelles, 2012</xref>; <xref ref-type="bibr" rid="bib11">Friedman et al., 2013</xref>), micro-RNA regulation (<xref ref-type="bibr" rid="bib32">Salomon et al., 2015</xref>), pre-mRNA splicing (<xref ref-type="bibr" rid="bib34">Shcherbakova et al., 2013</xref>; <xref ref-type="bibr" rid="bib19">Krishnan et al., 2013</xref>; <xref ref-type="bibr" rid="bib45">Warnasooriya and Rueda, 2014</xref>), ribosome assembly (<xref ref-type="bibr" rid="bib16">Kim et al., 2014</xref>), translation (<xref ref-type="bibr" rid="bib44">Wang et al., 2015</xref>; <xref ref-type="bibr" rid="bib40">Tsai et al., 2014</xref>; <xref ref-type="bibr" rid="bib28">O’Leary et al., 2013</xref>), signal recognition particle-nascent protein interaction (<xref ref-type="bibr" rid="bib24">Noriega et al., 2014</xref>), and cytoskeletal regulation (<xref ref-type="bibr" rid="bib35">Smith et al., 2013</xref>; <xref ref-type="bibr" rid="bib3">Breitsprecher et al., 2012</xref>).</p><p><xref ref-type="fig" rid="fig1">Figure 1A</xref> illustrates an example CoSMoS experiment to measure the interaction kinetics of RNA polymerase II molecules with DNA. In the experiment (<xref ref-type="bibr" rid="bib30">Rosen et al., 2020</xref>), we first measured the locations of individual DNA molecules (the ‘targets’) tethered to the surface of an observation chamber at low density. Next, a cell extract solution containing fluorescent RNA polymerase II molecules (the ‘binders’) was added to the solution over the surface and the chamber surface was imaged by total internal reflection fluorescence (TIRF) microscopy. When the binder molecules are freely diffusing in solution, they are not visible in TIRF. In contrast, when bound to a target, a single binder molecule is detected as a discrete fluorescent spot colocalized with the target position (<xref ref-type="bibr" rid="bib9">Friedman et al., 2006</xref>; <xref ref-type="bibr" rid="bib12">Friedman and Gelles, 2015</xref>).</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Example CoSMoS experiment.</title><p>(<bold>A</bold>) Experiment schematic. DNA target molecules labeled with a blue-excited fluorescent dye (blue star) are tethered to the microscope slide surface. RNA polymerase II (Pol II) binder molecules labeled with a green-excited dye (green star) are present in solution. (<bold>B</bold>) Data collection and preprocessing. After collecting a single image with blue excitation to identify the locations of the DNA molecules, a time sequence of Pol II images was collected with green excitation. Preprocessing of the images includes mapping of the corresponding points in target and binder channels, drift correction, and identification of two sets of areas of interest (AOIs). One set corresponds to locations of target molecules (e.g., purple square); the other corresponds to locations where no target is present (e.g., yellow square). (<bold>C</bold>) On-target data. Data are time sequences of 14 × 14 pixel AOI images centered at each target molecule. Frames show presence of on-target (e.g., frame 630) and off-target (e.g., frame 645) Pol II molecules. (<bold>D</bold>) Off-target control data. Control data consists of images collected from randomly selected sites at which no target molecule is present. Such sites can be AOIs in which no fluorescent target molecule is visible (e.g., the yellow square in the DNA channel shown in B). Alternatively, control data can be taken from a recording of a separate control sample to which no target molecules were added. Image data in B, C, and D is from Data set A in <xref ref-type="table" rid="table1">Table 1</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73860-fig1-v2.tif"/></fig><p>Effective data analysis is a major challenge in the use of the CoSMoS technique. The basic goal is to acquire information at each time point about whether a binder molecule fluorescence spot is observed at the image position of a target molecule (e.g., whether a colocalized green-dye-labeled RNA polymerase II is observed at the surface location of a blue-dye-labeled DNA spot in <xref ref-type="fig" rid="fig1">Figure 1B</xref>). Although CoSMoS images are conceptually simple – they consist only of diffraction-limited fluorescent spots collected in several wavelength channels – efficient analysis of the images is inherently challenging. The number of photons emitted by a single fluorophore is limited by fluorophore photobleaching. Consequently, it is desirable to work at the lowest feasible excitation power in order to maximize the duration of experimental recordings and to efficiently capture relevant reaction events. Achieving higher time resolution divides the number of emitted photons between a larger number of images, so that photon shot noise ordinarily dominates the data statistics. Furthermore, the required concentrations of binder molecules can sometimes create significant background noise (<xref ref-type="bibr" rid="bib29">Peng et al., 2018</xref>; <xref ref-type="bibr" rid="bib42">van Oijen, 2011</xref>), even with zero-mode waveguide instruments (<xref ref-type="bibr" rid="bib5">Chen et al., 2014</xref>). These technical difficulties frequently result in CoSMoS images that have low signal-to-noise ratios (SNR), making discrimination of colocalized fluorescence spots from noise a significant challenge. In addition, there are usually non-specific interactions of the binder molecule with the chamber surface, and these artefacts can give rise to both false positive and false negative spot detection (<xref ref-type="bibr" rid="bib12">Friedman and Gelles, 2015</xref>). Together, these defects in analyzing spot colocalization interfere with the interpretation of CoSMoS data to measure reaction thermodynamics and kinetics and to infer molecular mechanisms.</p><p>Most CoSMoS spot detection methods are based on integrating the binder fluorescence intensity by summing the pixel values in small regions of the image centered on the location of individual target molecules, and then using crossings of an intensity threshold to score binder molecule arrival and departure, e.g., (<xref ref-type="bibr" rid="bib10">Friedman and Gelles, 2012</xref>; <xref ref-type="bibr" rid="bib34">Shcherbakova et al., 2013</xref>). However, integration discards data about the spatial distribution of intensity that can (and should) be used to distinguish authentic on-target spots from artefacts caused by noise or off-target binding. More recently, improved methods (<xref ref-type="bibr" rid="bib12">Friedman and Gelles, 2015</xref>; <xref ref-type="bibr" rid="bib37">Smith et al., 2019</xref>) were developed that directly analyze TIRF images, using the spatial distribution of binder fluorescence intensity around the target molecule location. All these methods, whether image- or integrated intensity-based, make a binary decision about the presence or absence of a binder spot at the target location. Treating all such binary decisions as equal neglects differences in the confidence of each spot detection decision caused by variations in noise, signal intensity, and non-specific binding. Failure to account for spot confidence decreases the reliability of downstream thermodynamic and kinetic analysis.</p><p>In this paper, we describe a qualitatively different Bayesian machine learning method for analysis of CoSMoS data implemented in a computer program, Tapqir (Kazakh: clever, inventive; pronunciation: <italic>tap-keer</italic>). Tapqir analyzes two-dimensional image data, not integrated intensities. Unlike prior methods, our approach is based on an explicit, global causal model for CoSMoS image formation and uses variational Bayesian inference (<xref ref-type="bibr" rid="bib18">Kinz-Thompson et al., 2021</xref>; <xref ref-type="bibr" rid="bib14">Gelman et al., 2013</xref>) to determine the values of model parameters and their associated uncertainties. This model, which we call ‘<italic>cosmos’</italic>, implements time-independent analysis of single-channel (i.e., one-binder) data sets. The <italic>cosmos</italic> model is physics-informed and includes realistic shot noise in fluorescent spots and background, camera noise, the size and shape of spots, and the presence of both target-specific and nonspecific binder molecules in the images. Most importantly, instead of yielding a binary spot-/no-spot determination, the algorithm calculates the probability of a target-specific spot being present at each time point and target location. The calculated probability can then be used in subsequent analyses of the molecular thermodynamics and kinetics. Unlike alternative approaches, Tapqir and <italic>cosmos</italic> do not require subjective threshold settings so they can be used effectively and accurately by non-expert analysts. The program is implemented in the Python-based probabilistic programming language Pyro (<xref ref-type="bibr" rid="bib1">Bingham et al., 2019</xref>), which enables efficient use of graphics processing unit (GPU)-based hardware for rapid parallel processing of data and facilitates future modifications to the model.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Data analysis pipeline</title><p>The initial steps in CoSMoS data analysis involve preprocessing the data set (<xref ref-type="fig" rid="fig1">Figure 1B</xref>) to map the spatial relationship between target and binder images, correct for microscope drift (if any) and list the locations of target molecules. Software packages that perform these preprocessing steps are widely available (e.g., <xref ref-type="bibr" rid="bib12">Friedman and Gelles, 2015</xref>; <xref ref-type="bibr" rid="bib37">Smith et al., 2019</xref>).</p><p>The input into Tapqir consists of the time sequence of images (<xref ref-type="fig" rid="fig1">Figure 1B</xref>, right). For colocalization analysis, it is sufficient to consider the image area local to the target molecule. This analyzed area of interest (AOI) needs to be several times the diameter of a diffraction-limited spot to include both the spot and the surrounding background (<xref ref-type="fig" rid="fig1">Figure 1C</xref>).</p><p>In addition to AOIs centered at target molecules, it is useful to also select negative control AOIs from randomly selected sites at which no target molecule is present (<xref ref-type="fig" rid="fig1">Figure 1B and D</xref>). In Tapqir, such off-target control data is analyzed jointly with on-target data and serves to estimate the background level of target-nonspecific binding.</p><p>Once provided with the preprocessing data and image sequence, Tapqir computes for each frame of each AOI the probability, <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, that a target-specific fluorescence spot is present. The <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> values that are output can then be used to extract information about the kinetics and thermodynamics of the target-binder interaction.</p></sec><sec id="s2-2"><title>Bayesian image classification analysis</title><p>Tapqir calculates <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> values using an objective image classification method built on a rigorous Bayesian statistical approach to the CoSMoS image analysis problem. The Bayesian approach has three components. First, we define a probabilistic model of the CoSMoS images. The probabilistic model, <italic>cosmos</italic>, is a mathematical formalism that describes the AOI images in terms of a set of parameter values. The model is probabilistic in that each parameter is specified to have a probability distribution that defines the likelihood that it can take on particular values. Model parameters describe physically realistic image features such as the characteristic fluorescence spot width. Second, we specify prior distributions for the parameters of the model. These priors embed pre-existing knowledge about the CoSMoS experiment, such as the fact that target-specific spots will be close to the target molecule locations. Third, we infer the values of the model parameters, including <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, using Bayes’ rule (<xref ref-type="bibr" rid="bib2">Bishop, 2006</xref>; <xref ref-type="bibr" rid="bib18">Kinz-Thompson et al., 2021</xref>). The <italic>cosmos</italic> model is ‘time-independent’, meaning that we ignore the time dimension of the recording – the order of the images does not affect the results.</p></sec><sec id="s2-3"><title>Probabilistic image model and parameters</title><p>A single AOI image from a CoSMoS data set is a matrix of noisy pixel intensity values. In each image, multiple binder molecule fluorescence spots can be present. <xref ref-type="fig" rid="fig2">Figure 2A</xref> shows an example image where two spots are present; one spot is located near the target molecule at the center of the image and another is off-target.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Depiction of the <italic>cosmos</italic> probabilistic image model and model parameters.</title><p>(<bold>A</bold>) Example AOI image (from Data set A in <xref ref-type="table" rid="table1">Table 1</xref>). The AOI image is a matrix of 14 × 14 pixel intensities which is shown here as both a 2-D grayscale image and as a 3-D intensity plot. The image contains two spots; one is centered at target location (image center) and the other is located off-target. (<bold>B</bold>) Examples of four idealized noise-free image representations (<inline-formula><mml:math id="inf5"><mml:msup><mml:mi>μ</mml:mi><mml:mi>I</mml:mi></mml:msup></mml:math></inline-formula>). Image representations consist of zero, one, or two idealized spots (<inline-formula><mml:math id="inf6"><mml:msup><mml:mi>μ</mml:mi><mml:mi>S</mml:mi></mml:msup></mml:math></inline-formula>) superimposed on a constant background (<inline-formula><mml:math id="inf7"><mml:mi>b</mml:mi></mml:math></inline-formula>). Each fluorescent spot is represented as a 2-D Gaussian parameterized by integrated intensity (<inline-formula><mml:math id="inf8"><mml:mi>h</mml:mi></mml:math></inline-formula>), width (<inline-formula><mml:math id="inf9"><mml:mi>w</mml:mi></mml:math></inline-formula>), and position (<inline-formula><mml:math id="inf10"><mml:mi>x</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf11"><mml:mi>y</mml:mi></mml:math></inline-formula>). The presence of spots is encoded in the binary spot existence indicator <inline-formula><mml:math id="inf12"><mml:mi>m</mml:mi></mml:math></inline-formula>. (<bold>C</bold>) Simulated idealized images illustrating different values of the target-specific spot state parameter <inline-formula><mml:math id="inf13"><mml:mi>z</mml:mi></mml:math></inline-formula> and index parameter <inline-formula><mml:math id="inf14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. <inline-formula><mml:math id="inf15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0 corresponds to a case when no specifically bound molecule is present (<inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0); <inline-formula><mml:math id="inf17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1 or 2 corresponds to the cases in which specifically bound molecule is present (<inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1) and corresponds to spot 1 or 2, respectively. (<bold>D</bold>) Condensed graphical representation of the <italic>cosmos</italic> probabilistic model. Model parameters are depicted as circles and deterministic functions as diamonds. Observed image (<inline-formula><mml:math id="inf19"><mml:mi>D</mml:mi></mml:math></inline-formula>) is represented by a shaded circle. Related nodes are connected by edges, with an arrow pointing towards the dependent node (e.g., the shape of each 2-D Gaussian spot <inline-formula><mml:math id="inf20"><mml:msup><mml:mi>μ</mml:mi><mml:mi>S</mml:mi></mml:msup></mml:math></inline-formula> depends on spot parameters <inline-formula><mml:math id="inf21"><mml:mi>m</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf22"><mml:mi>h</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf23"><mml:mi>w</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf24"><mml:mi>x</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf25"><mml:mi>y</mml:mi></mml:math></inline-formula>). Plates (rounded rectangles) contain entities that are repeated for the number of instances displayed at the bottom-right corner: number of total AOIs (<inline-formula><mml:math id="inf26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>), frame count (<inline-formula><mml:math id="inf27"><mml:mi>F</mml:mi></mml:math></inline-formula>), and maximum number of spots in a single image (<inline-formula><mml:math id="inf28"><mml:mi>K</mml:mi></mml:math></inline-formula> = 2). Parameters outside of the plates are global quantities that apply to all frames of all AOIs. A more complete version of the graphical model specifying the relevant probability distributions is given in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73860-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Extended graphical representation of the generative probabilistic model.</title><p>Directed factor graph representation (<xref ref-type="bibr" rid="bib2">Bishop, 2006</xref>) of model parameters and parameter distributions. This diagram is a more complete version of the graphical model shown in <xref ref-type="fig" rid="fig2">Figure 2D</xref>; it includes additional parameters (<inline-formula><mml:math id="inf29"><mml:msup><mml:mi>μ</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>δ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) and explicitly specifies the relevant probability distributions. Model parameters are depicted as circles, parameter distributions as small filled squares, and deterministic functions as diamonds. Names of the probability distributions are written next to the squares. Input parameters and output parameters are connected by lines, with an arrow pointing towards the dependent parameter. Observed AOI image (<inline-formula><mml:math id="inf31"><mml:mi>D</mml:mi></mml:math></inline-formula>) is the sum of the noisy photon-dependent image (<inline-formula><mml:math id="inf32"><mml:mi>I</mml:mi></mml:math></inline-formula>) and the photon-independent camera offset (<inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>). Plates (rounded rectangles) contain nodes that are repeated for the number of instances displayed at the bottom-right corner: number of AOIs (<inline-formula><mml:math id="inf34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>), frame count (<inline-formula><mml:math id="inf35"><mml:mi>F</mml:mi></mml:math></inline-formula>), maximum number of spots in a single image (<inline-formula><mml:math id="inf36"><mml:mi>K</mml:mi></mml:math></inline-formula>), and number of image pixels (<inline-formula><mml:math id="inf37"><mml:mrow><mml:mi>P</mml:mi><mml:mo>×</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula>). The prior for <inline-formula><mml:math id="inf38"><mml:mi>x</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf39"><mml:mi>y</mml:mi></mml:math></inline-formula> is Uniform for target-nonspecific spots <inline-formula><mml:math id="inf40"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and AffineBeta for target-specific spots <inline-formula><mml:math id="inf41"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (see <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73860-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Prior distributions for the <inline-formula><mml:math id="inf42"><mml:mi>x</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf43"><mml:mi>y</mml:mi></mml:math></inline-formula> spot position parameters.</title><p>Prior distributions of <inline-formula><mml:math id="inf44"><mml:mi>x</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf45"><mml:mi>y</mml:mi></mml:math></inline-formula> for specific and non-specific binding. Probability densities for <inline-formula><mml:math id="inf46"><mml:mi>x</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf47"><mml:mi>y</mml:mi></mml:math></inline-formula> are defined in the range <inline-formula><mml:math id="inf48"><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math></inline-formula> relative to the target molecule and are conditional on the identity of the spot (specific or non-specific). The width of the peak in the specific distribution is given by <inline-formula><mml:math id="inf49"><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, the value of which is learned from the data. Probability densities for <inline-formula><mml:math id="inf50"><mml:mi>x</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf51"><mml:mi>y</mml:mi></mml:math></inline-formula> are identical.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73860-fig2-figsupp2-v2.tif"/></fig></fig-group><p>The probabilistic model mathematically generates images <inline-formula><mml:math id="inf52"><mml:mi>D</mml:mi></mml:math></inline-formula> as follows. We construct a noise-free AOI image <inline-formula><mml:math id="inf53"><mml:msup><mml:mi>μ</mml:mi><mml:mi>I</mml:mi></mml:msup></mml:math></inline-formula> as a constant average background intensity <inline-formula><mml:math id="inf54"><mml:mi>b</mml:mi></mml:math></inline-formula> summed with fluorescence spots modeled as 2-D Gaussians <inline-formula><mml:math id="inf55"><mml:msup><mml:mi>μ</mml:mi><mml:mi>S</mml:mi></mml:msup></mml:math></inline-formula>, which accurately approximate the microscope point spread function (<xref ref-type="bibr" rid="bib46">Zhang et al., 2007</xref>; <xref ref-type="fig" rid="fig2">Figure 2B</xref>). Each 2-D Gaussian is described by parameters integrated intensity <inline-formula><mml:math id="inf56"><mml:mi>h</mml:mi></mml:math></inline-formula>, width <inline-formula><mml:math id="inf57"><mml:mi>w</mml:mi></mml:math></inline-formula>, and position (<inline-formula><mml:math id="inf58"><mml:mi>x</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf59"><mml:mi>y</mml:mi></mml:math></inline-formula>). We define <inline-formula><mml:math id="inf60"><mml:mi>K</mml:mi></mml:math></inline-formula> as the maximum number of spots that can be present in a single AOI image. For the data we typically encounter, <inline-formula><mml:math id="inf61"><mml:mi>K</mml:mi></mml:math></inline-formula> = 2 is sufficient. Since the spots may be present or not in a particular image, we define the <inline-formula><mml:math id="inf62"><mml:mi>K</mml:mi></mml:math></inline-formula> = 2 binary indicators <inline-formula><mml:math id="inf63"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf64"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Each indicator can take a value of either 0 denoting spot absence or 1 denoting spot presence.</p><p>The resulting mixture model has four possible combinations for <inline-formula><mml:math id="inf65"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf66"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>: (1) a no-spot image that contains only background (<xref ref-type="fig" rid="fig2">Figure 2B</xref>, top left), (2) a single-spot image that contains the first binder molecule spot superimposed on background (<xref ref-type="fig" rid="fig2">Figure 2B</xref>, bottom left), (3) a single-spot image that contains the second binder molecule spot superimposed on background (<xref ref-type="fig" rid="fig2">Figure 2B</xref>, top right), and (4) a two-spot image that contains both binder molecule spots superimposed on background (<xref ref-type="fig" rid="fig2">Figure 2B</xref>, bottom right).</p><p>Among the spots that are present in an AOI image, by assumption at most only one can be target-specific. We use a <italic>state</italic> parameter <inline-formula><mml:math id="inf67"><mml:mi>z</mml:mi></mml:math></inline-formula> to indicate target-specific spot absence (<inline-formula><mml:math id="inf68"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0) or presence (<inline-formula><mml:math id="inf69"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1) in an AOI image. We also introduce an <italic>index</italic> parameter <inline-formula><mml:math id="inf70"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> that identifies which of the spots is the target-specific spot when it is present (<inline-formula><mml:math id="inf71"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1) (e.g., <xref ref-type="fig" rid="fig2">Figure 2C</xref>, middle and right have <inline-formula><mml:math id="inf72"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1 and <inline-formula><mml:math id="inf73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 2, respectively) and equals zero when it is absent (<inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0) (e.g., <xref ref-type="fig" rid="fig2">Figure 2C</xref>, left). Since the off-target control AOIs by definition contain only non-specific binding, <inline-formula><mml:math id="inf75"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0 and <inline-formula><mml:math id="inf76"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0 for all off-target AOIs.</p><p>Finally, to construct realistic noisy AOI images <inline-formula><mml:math id="inf77"><mml:mi>D</mml:mi></mml:math></inline-formula> from the noise-free images <inline-formula><mml:math id="inf78"><mml:msup><mml:mi>μ</mml:mi><mml:mi>I</mml:mi></mml:msup></mml:math></inline-formula>, the model adds intensity-dependent noise to each pixel. For cameras that use charge-coupled device (CCD) or electron-multiplier CCD (EMCCD) sensors, each measured pixel intensity in a single-molecule fluorescence image has a noise contribution from photon counting (shot noise) and can also contain additional noise arising from electronic amplification (<xref ref-type="bibr" rid="bib43">van Vliet et al., 1998</xref>). The result is a characteristic linear relationship between the noise variance and mean intensity with slope defining the gain <inline-formula><mml:math id="inf79"><mml:mi>g</mml:mi></mml:math></inline-formula>. This relationship is used to compute the random pixel noise values (see Materials and methods).</p><p>The resulting probabilistic image model can be interpreted as a generative process that produces the observed image data <inline-formula><mml:math id="inf80"><mml:mi>D</mml:mi></mml:math></inline-formula>. A graphical representation of the probabilistic relationships in the model is shown in <xref ref-type="fig" rid="fig2">Figure 2D</xref>. A complete description of the model is given in Materials and methods and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>.</p></sec><sec id="s2-4"><title>Parameter prior distributions</title><p>Specifying prior probability distributions for model parameters is essential for Bayesian analysis and allows us to incorporate pre-existing knowledge about the experimental design. For most model parameters, there is no strong prior information so we use uninformative prior distributions (see Materials and methods). However, we have strong expectations for the positions of specific and non-specific binder molecules that can be expressed as prior distributions and used effectively to discriminate between the two. Non-specific binding can occur anywhere on the surface with equal probability and thus has a uniform prior distribution across the AOI image. Target-specific binding, on the other hand, is colocalized with the target molecule and thus has a prior distribution peaked at the AOI center (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). The width of this peak, proximity parameter <inline-formula><mml:math id="inf81"><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, depends on multiple features of the experiment such as the spot localization accuracy and the mapping accuracy between target and binder imaging channels. Prior distributions for parameters <inline-formula><mml:math id="inf82"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf83"><mml:mi>m</mml:mi></mml:math></inline-formula> are defined in terms of the average number of target-specific and target non-specific spots per AOI image, <inline-formula><mml:math id="inf84"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf85"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, respectively. To facilitate convenient use of the algorithm, it is not necessary to pre-specify values of <inline-formula><mml:math id="inf86"><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="inf87"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Instead, values of these parameters appropriate to a given data set are calculated automatically using a hierarchical Bayesian analysis (see Materials and methods; for hierarchical modeling see Chapter 5 of <xref ref-type="bibr" rid="bib14">Gelman et al., 2013</xref>).</p></sec><sec id="s2-5"><title>Bayesian inference and implementation</title><p>Tapqir calculates posterior distributions of model parameters conditioned on the observed data by using Bayes’ theorem. In particular, Tapqir approximates posterior distributions using a variational inference approach implemented in Pyro (<xref ref-type="bibr" rid="bib1">Bingham et al., 2019</xref>). Complete details of the implementation are given in Materials and methods.</p></sec><sec id="s2-6"><title>Tapqir analysis</title><p>In initial tests, we used Tapqir to analyze simulated CoSMoS image data with a comparatively high SNR of 3.76 as well as data from the experiment shown in <xref ref-type="fig" rid="fig1">Figure 1B–D</xref>, which has a lower SNR of 1.61. The simulated data were generated using the same <italic>cosmos</italic> model (<xref ref-type="fig" rid="fig2">Figure 2D</xref>) that was used for analysis. Tapqir correctly detects fluorescent spots in both simulated and experimental images (compare ‘AOI images’ and ‘Spot-detection’ rows in <xref ref-type="fig" rid="fig3">Figure 3</xref>). The program precisely calculates the position (<inline-formula><mml:math id="inf89"><mml:mi>x</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf90"><mml:mi>y</mml:mi></mml:math></inline-formula>), intensity (<inline-formula><mml:math id="inf91"><mml:mi>h</mml:mi></mml:math></inline-formula>), and width (<inline-formula><mml:math id="inf92"><mml:mi>w</mml:mi></mml:math></inline-formula>) for each spot and also determines the background intensity (<inline-formula><mml:math id="inf93"><mml:mi>b</mml:mi></mml:math></inline-formula>) for each image without requiring a separate analysis. These parameters confirm the desired behavior of the model and could be used in further calculations. However, the most important output of the analysis is assessment of the presence of target-specific binding. For each AOI image, we calculate <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>≡</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3</xref>, green), the probability that any target-specific spot is present. Spots determined as likely target-specific (<inline-formula><mml:math id="inf95"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> &gt; 0.5) are represented as filled circles in the spot detection row of <xref ref-type="fig" rid="fig3">Figure 3</xref>. For a particular spot to have high <inline-formula><mml:math id="inf96"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, it must have a high spot probability and be colocalized with the target molecule at the center of the AOI (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Tapqir analysis and inferred model parameters.</title><p>(<bold>A,B</bold>) Tapqir was applied to simulated data (<monospace>lamda0.5</monospace> parameter set in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>) (<bold>A</bold>) and to experimental data (Data set A in <xref ref-type="table" rid="table1">Table 1</xref>) (<bold>B</bold>). (<bold>A</bold>) and (<bold>B</bold>) each show a short extract from a single target location in the data set. The first row shows AOI images for the subset of frames indicated by gray shaded stripes in the plots; image contrast and offset settings are consistent within each panel. The second row shows the locations of spots determined by Tapqir. Spot numbers 1 (blue) and 2 (orange) are assigned arbitrarily and may change from fame to frame. For clarity, only data for spots with a spot probability <inline-formula><mml:math id="inf97"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> &gt; 0.5 are shown. Spots predicted to be target-specific (<inline-formula><mml:math id="inf98"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> &gt; 0.5 for spot <inline-formula><mml:math id="inf99"><mml:mi>k</mml:mi></mml:math></inline-formula>) are shown as filled circles. The topmost graphs (green) show the calculated probability that a target-specific spot is present (<inline-formula><mml:math id="inf100"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>) in each frame. Below are the calculated spot intensities (<inline-formula><mml:math id="inf101"><mml:mi>h</mml:mi></mml:math></inline-formula>), spot widths (<inline-formula><mml:math id="inf102"><mml:mi>w</mml:mi></mml:math></inline-formula>), and locations (<inline-formula><mml:math id="inf103"><mml:mi>x</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf104"><mml:mi>y</mml:mi></mml:math></inline-formula>) for spot 1 (blue) and spot 2 (orange), and the AOI background intensities (<inline-formula><mml:math id="inf105"><mml:mi>b</mml:mi></mml:math></inline-formula>). Again, for clarity data are only shown for likely spots (<inline-formula><mml:math id="inf106"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> &gt; 0.5). Error bars: 95% CI (credible interval) estimated from a sample size of 500. Some error bars are smaller than the points and thus not visible.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73860-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Calculated spot probabilities.</title><p>The data sets used for panels A and B are identical to those in <xref ref-type="fig" rid="fig3">Figure 3A and B</xref>; the first two rows and the <inline-formula><mml:math id="inf107"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (green) graph are reproduced from that figure. Blue graphs show the probability of being present (<inline-formula><mml:math id="inf108"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) and of being target-specific (<inline-formula><mml:math id="inf109"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) for the arbitrarily designated spot 1 in each frame. Orange graphs show the analogous quantities <inline-formula><mml:math id="inf110"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf111"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for spot 2. For a given image, the probability <inline-formula><mml:math id="inf112"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>≡</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> that any target-specific spot is present is equal to <inline-formula><mml:math id="inf113"><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73860-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Reproduction of experimental data by posterior predictive sampling.</title><p>Example frames are shown from Data set A (A: SNR = 1.61), Data set B (B: SNR = 3.77), Data set C (C: SNR = 4.23), and Data set D (D: SNR = 3.06) in <xref ref-type="table" rid="table1">Table 1</xref>. In each panel the top row shows AOI images selected from the experimental data and middle row shows corresponding images obtained by sampling from the posterior distributions. Image contrast and offset are consistent within each panel. The bottom row shows pixel intensity distributions from the experimental and posterior prediction images.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73860-fig3-figsupp2-v2.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 3.</label><caption><title>Tapqir analysis of image data simulated using a broad range of global parameters.</title><p>Simulations (see Materials and methods) consist of 16 data sets where values of global parameters (<inline-formula><mml:math id="inf114"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf115"><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, and <inline-formula><mml:math id="inf116"><mml:mi>g</mml:mi></mml:math></inline-formula>) were randomly generated for each data set (<xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>). Simulated data were fit with Tapqir, and parameter values from the fit (with 95% credible interval estimated from a sample size of 10,000) are plotted against the true parameter values. To guide the eye, dashed lines indicate identical true and fit values. (<bold>A</bold>) Gain of the camera <inline-formula><mml:math id="inf117"><mml:mi>g</mml:mi></mml:math></inline-formula>. (<bold>B</bold>) Average target-specific binding probability <inline-formula><mml:math id="inf118"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. (<bold>C</bold>) Target non-specific binding density <inline-formula><mml:math id="inf119"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. (<bold>D</bold>) Proximity parameter <inline-formula><mml:math id="inf120"><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73860-fig3-figsupp3-v2.tif"/></fig><fig id="fig3s4" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 4.</label><caption><title>Effect of AOI size on analysis of experimental data.</title><p>(<bold>A</bold>) and (<bold>B</bold>) each show a short extract from a single target location (AOI 163 in (<bold>A</bold>) and AOI 0 in (<bold>B</bold>)) from Data set A (<xref ref-type="table" rid="table1">Table 1</xref>; SNR = 1.61). Tapqir was applied to the data set using AOI image sizes <inline-formula><mml:math id="inf121"><mml:mi>P</mml:mi></mml:math></inline-formula> of 14 × 14 (first row), 10 × 10 (second row), and 6 × 6 (third row) pixels. Corresponding output <inline-formula><mml:math id="inf122"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> probabilities are plotted in the graph. Image contrasts in (<bold>A</bold>) and (<bold>B</bold>) are different. Unattended calculation time on an AMD Ryzen Threadripper 2990 WX with an Nvidia GeForce RTX 2080Ti GPU using CUDA version 11.5 for the different AOI sizes were: 7 h 40 min (<inline-formula><mml:math id="inf123"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 14), 3 h 5 min (<inline-formula><mml:math id="inf124"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 10), and 2 h 40 min (<inline-formula><mml:math id="inf125"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 6).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73860-fig3-figsupp4-v2.tif"/></fig></fig-group></sec><sec id="s2-7"><title>Tapqir robustly fits experimental data sets with different characteristics</title><p>Next, we evaluated how well the model fits data sets encompassing a range of characteristics found in typical CoSMoS experiments. We analyzed four experimental data sets with varying SNR, frequency of target-specific spots, and frequencies of non-specific spots (<xref ref-type="table" rid="table1">Table 1</xref>). We then sampled AOI images from the posterior distributions of parameters (a method known as posterior predictive checking <xref ref-type="bibr" rid="bib14">Gelman et al., 2013</xref>). These posterior predictive simulations accurately reproduce the experimental AOI appearances, recapitulating the noise characteristics and the numbers, intensities, shapes, and locations of spots (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>, images). The distributions of pixel intensities across the AOI are also closely reproduced (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>, histograms) confirming that the noise model is accurate. Taken together, these results confirm that the model is rich enough to accurately capture the full range of image characteristics from CoSMoS data sets taken over different experimental conditions. Importantly, all the results on different experimental data sets were obtained using the same model (<xref ref-type="fig" rid="fig2">Figure 2D</xref>) and the same priors (Materials and methods). No tuning of the algorithm or prior measurement of data-set-specific properties was needed to achieve good fits for all data sets.</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Experimental data sets.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="middle">Data set size<sup>a</sup></th><th align="left" valign="middle">SNR</th><th align="left" valign="middle">π [95% CI]</th><th align="left" valign="middle">λ [95% CI]</th><th align="left" valign="middle">g [95% CI]</th><th align="left" valign="middle">σ<sup>xy</sup> [95% CI]</th><th align="left" valign="middle">Compute time</th></tr></thead><tbody><tr><td align="left" colspan="7" valign="middle">Data set A: Binder, SNAP<sub>f</sub>-tagged <italic>S. cerevisiae</italic> RNA polymerase II labeled with DY549; Target, transcription template DNA containing 5× Gal4 upstream activating sequences and <italic>CYC1</italic> core promoter; Conditions, yeast nuclear extract supplemented with Gal4-VP16 activator and NTPs. From <xref ref-type="bibr" rid="bib30">Rosen et al., 2020</xref>.</td></tr><tr><td align="left" valign="middle"><inline-formula><mml:math id="inf126"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>= 331, <inline-formula><mml:math id="inf127"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = 526, <inline-formula><mml:math id="inf128"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 790</td><td align="char" char="." valign="middle">1.61</td><td align="left" valign="middle">0.0951 [0.0936, 0.0966]</td><td align="left" valign="middle">0.2943 [0.2924, 0.2963]</td><td align="left" valign="middle">6.645 [6.643, 6.647]</td><td align="left" valign="middle">0.577 [0.573, 0.580]</td><td align="left" valign="middle">7 h 40 m<sup>b</sup><break/>3 h 50 m<sup>c</sup></td></tr><tr><td align="left" colspan="7" valign="middle">Data set B: Binder, 0.1 nM <italic>E. coli</italic> σ<sup>54</sup> RNA polymerase labeled with Cy3; Target, 852 bp DNA containing the <italic>glnALG</italic> promoter; Conditions, physiological buffer, no NTPs. From (Fig. 1E) of <xref ref-type="bibr" rid="bib11">Friedman et al., 2013</xref>.</td></tr><tr><td align="left" valign="middle"><inline-formula><mml:math id="inf129"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>= 102, <inline-formula><mml:math id="inf130"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = 127, <inline-formula><mml:math id="inf131"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 4407</td><td align="char" char="." valign="middle">3.77</td><td align="left" valign="middle">0.0846 [0.0835, 0.0857]</td><td align="left" valign="middle">0.1575 [0.1569, 0.1583]</td><td align="left" valign="middle">11.861 [11.856, 11.865]</td><td align="left" valign="middle">0.476 [0.474, 0.479]</td><td align="left" valign="middle">7 h 40 m<sup>b</sup></td></tr><tr><td align="left" colspan="7" valign="middle">Data set C: Binder, 0.4 nM <italic>E. coli</italic> σ<sup>54</sup> RNA polymerase labeled with Cy3; Target, 3,591 bp DNA containing the <italic>glnALG</italic> promoter; Conditions, physiological buffer, no NTPs. From (Fig. 3D) of <xref ref-type="bibr" rid="bib11">Friedman et al., 2013</xref>.</td></tr><tr><td align="left" valign="middle"><inline-formula><mml:math id="inf132"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>= 122, <inline-formula><mml:math id="inf133"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = 157, <inline-formula><mml:math id="inf134"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 3855</td><td align="char" char="." valign="middle">4.23</td><td align="left" valign="middle">0.0267 [0.0262, 0.0273]</td><td align="left" valign="middle">0.0876 [0.0869, 0.0883]</td><td align="left" valign="middle">16.777 [16.773, 16.782]</td><td align="left" valign="middle">0.404 [0.399, 0.408]</td><td align="left" valign="middle">9 h 15 m<sup>b</sup></td></tr><tr><td align="left" colspan="7" valign="middle">Data set D: Binder, 0.15 nM <italic>E. coli</italic> Cy3-GreB; Target, reconstituted backtracked EC-6 <italic>E. coli</italic> transcription elongation complex; Conditions, physiological buffer, no NTPs. Randomly selected subset of data set from <xref ref-type="bibr" rid="bib38">Tetone et al., 2017</xref>.</td></tr><tr><td align="left" valign="middle"><inline-formula><mml:math id="inf135"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>= 200, <inline-formula><mml:math id="inf136"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = 200, <inline-formula><mml:math id="inf137"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 5622</td><td align="char" char="." valign="middle">3.06</td><td align="left" valign="middle">0.0038 [0.0036, 0.0039]</td><td align="left" valign="middle">0.0437 [0.0434, 0.0440]</td><td align="left" valign="middle">18.727 [18.724, 18.731]</td><td align="left" valign="middle">0.451 [0.438, 0.463]</td><td align="char" char="." valign="middle">11 h<sup>b</sup></td></tr></tbody></table><table-wrap-foot><fn><p>*<italic>N</italic> - number of on-target AOIs, <italic>N</italic><sub><italic>c</italic></sub> - number of control off-target AOIs, <italic>F</italic> - number of frames.</p></fn><fn><p><sup>b</sup>Unattended calculation time on an AMD Ryzen Threadripper 2990WX with an Nvidia GeForce RTX 2080Ti GPU using CUDA version 11.5.</p></fn><fn><p><sup>c</sup>Unattended calculation time on an Intel Xeon CPU with an Nvidia Tesla V100-SXM2-16GB GPU using CUDA version 11.2 in a Google Colab Pro account.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s2-8"><title>Tapqir accuracy on simulated data with known global parameter values</title><p>Next, we evaluated Tapqir’s ability to reliably infer the values of global model parameters. To accomplish this, we generated simulated data sets using a wide range of randomized parameter values and then fit the simulated data to the model (<xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>). Fit results show that global model parameters (i.e., average specific spot probability <inline-formula><mml:math id="inf138"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, nonspecific binding density <inline-formula><mml:math id="inf139"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, proximity <inline-formula><mml:math id="inf140"><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, and gain <inline-formula><mml:math id="inf141"><mml:mi>g</mml:mi></mml:math></inline-formula>; see <xref ref-type="fig" rid="fig2">Figure 2D</xref>) are close to the simulated values (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref> and <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>). This suggests that CoSMoS data contains enough information to reliably infer global model parameters and that the model is not obviously overparameterized.</p></sec><sec id="s2-9"><title>Tapqir classification accuracy</title><p>Having tested the basic function of the algorithm, we next turned to the key question of how accurately Tapqir can detect target-specific spots in data sets of increasing difficulty.</p><p>We first examined the accuracy of target-specific spot detection in simulated data sets with decreasing SNR (<xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref>). By eye, spots can be readily discerned at SNR &gt;1 but cannot be clearly seen at SNR &lt;1 (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). Tapqir gives similar or better performance: if an image contains a target-specific spot, Tapqir correctly assigns it a target-specific spot probability <inline-formula><mml:math id="inf142"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> that is on average close to one as long as SNR is adequate (i.e., SNR &gt;1) (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). In contrast, mean <inline-formula><mml:math id="inf143"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> sharply decreases at SNR &lt;1, consistent with the subjective impression that no spot is recognized under those conditions. In particular, images that contain a target-specific spot are almost always assigned a high <inline-formula><mml:math id="inf144"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> for high SNR data and almost always assigned low <inline-formula><mml:math id="inf145"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> for low SNR data (<xref ref-type="fig" rid="fig4">Figure 4C</xref>, green). At marginal SNR ≈ 1, these images are assigned a broad distribution of <inline-formula><mml:math id="inf146"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> values, accurately reflecting the uncertainty in classifying such data. Just as importantly, images with no target-specific spot are almost always assigned <inline-formula><mml:math id="inf147"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> &lt; 0.5, correctly reflecting the absence of the spot (<xref ref-type="fig" rid="fig4">Figure 4C</xref>, gray).</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Tapqir performance on simulated data with different SNRs or different non-specific binding densities.</title><p>(<bold>A–D</bold>) Analysis of simulated data over a range of SNR. SNR was varied in the simulations by changing spot intensity <inline-formula><mml:math id="inf148"><mml:mi>h</mml:mi></mml:math></inline-formula> while keeping other parameters constant (<xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref>). (<bold>A</bold>) Example images showing the appearance of the same target-specific spot simulated with increasing SNR. (<bold>B</bold>) Mean of Tapqir-calculated target-specific spot probability <inline-formula><mml:math id="inf149"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (with 95% CI; see Materials and methods) for the subset of images where target-specific spots are known to be present. (<bold>C</bold>) Histograms of <inline-formula><mml:math id="inf150"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> for selected simulations with SNR indicated. Data are shown as stacked bars for images known to have (green, 15%) or not have (gray, 85%) target-specific spots. Count is zero for bins where bars are not shown. (<bold>D</bold>) Accuracy of Tapqir image classification with respect to presence/absence of a target-specific spot. Accuracy was assessed by MCC, recall, and precision (see Results and Materials and methods sections). (<bold>E–G</bold>) Same as in (<bold>B–D</bold>) but for the data simulated over a range of non-specific binding densities <inline-formula><mml:math id="inf151"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> at fixed SNR = 3.76 (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). (<bold>H</bold>) Spot recognition in AOI images containing closely spaced target-specific and non-specific spots. Images were selected from the <inline-formula><mml:math id="inf152"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1 data set in (<bold>E–G</bold>). AOI images and spot detection are plotted as in <xref ref-type="fig" rid="fig3">Figure 3</xref>, with spot numbers 1 (blue) and 2 (orange) assigned arbitrarily and spots predicted to be target-specific shown as filled circles. (<bold>I</bold>) Same as in (<bold>C</bold>) but for the data simulated over a range of non-specific binding densities <inline-formula><mml:math id="inf153"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> with no target-specific binding (<inline-formula><mml:math id="inf154"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0) (<xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73860-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>False negative spot misidentifications by Tapqir and spot-picker method.</title><p>The same <inline-formula><mml:math id="inf155"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1 simulated data set used in <xref ref-type="fig" rid="fig4">Figure 4E–H</xref> (<monospace>lamda1</monospace> in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>) was analyzed by Tapqir and spot-picker. The data set contained 418 AOI images containing target-specific spots, of which the 37 shown here were falsely predicted to contain no target-specific spot (3 by Tapqir and 34 by spot-picker). Correct (+) and incorrect (−) predictions by each program are indicated. In all AOI images except AOI 3 frame 109, there is a nearby target non-specific spot in addition to the target-specific one. False negative classifications by spot-picker method are presumably due to the presence of a closely located target non-specific spot that distorts the shape of a target-specific spot. Tapqir, on the other hand, is able to correctly infer the presence of two closely located spots even when they are not completely resolved (<xref ref-type="fig" rid="fig4">Figure 4H</xref>). The rare (3 out of 418) false negative classifications by Tapqir likely arise from target-specific spots with centers that deviate from the target location by much more (∼ 0.7 pixels) than the inferred proximity parameter (<inline-formula><mml:math id="inf156"><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> = 0.2 pixels).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73860-fig4-figsupp1-v2.tif"/></fig></fig-group><p>Ideally, we want to correctly identify target-specific binding when it occurs but also to avoid incorrectly identifying target-specific binding when it does not occur. To quantify Tapqir’s classification accuracy, we next examined binary image classification statistics. Binary classification predictions were obtained by thresholding <inline-formula><mml:math id="inf157"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> at 0.5. We then calculated two complementary statistics: <italic>recall</italic> and <italic>precision</italic> (<xref ref-type="bibr" rid="bib7">Fawcett, 2006</xref>; <xref ref-type="fig" rid="fig4">Figure 4D</xref>; see Materials and methods). Recall is defined as the fraction of true target-specific spots that are correctly predicted. Recall is high at high SNR and decreases at lower SNR. Recall is a binary analog of the mean <inline-formula><mml:math id="inf158"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> for the subset of images containing target-specific spots; as expected the two quantities have similar dependencies on SNR (compare <xref ref-type="fig" rid="fig4">Figure 4B and D</xref>, black). Precision is the fraction of predicted target-specific spots that are correctly predicted. Precision is near one at all SNR values tested (<xref ref-type="fig" rid="fig4">Figure 4D</xref>, red); this shows that the algorithm rarely misclassifies an image as containing a target-specific spot when none is present.</p><p>In order to quantify the effects of both correctly and incorrectly classified images in a single statistic, we used the binary classification predictions to calculate the Matthews Correlation Coefficient (MCC) (<xref ref-type="bibr" rid="bib23">Matthews, 1975</xref>; see Materials and methods). The MCC is equivalent to the Pearson correlation coefficient between the predicted and true classifications, giving 1 for a perfect match, 0 for a random match, and –1 for complete disagreement. The MCC results (<xref ref-type="fig" rid="fig4">Figure 4D</xref>, blue) suggest that the overall performance of Tapqir is excellent at SNR ≥ 1: the program rarely misses target-specific spots that are in reality present and rarely falsely reports a target-specific spot when none is present.</p><p>The analyses of <xref ref-type="fig" rid="fig4">Figure 4B–D</xref> examined Tapqir performance on data in which the rate of target-nonspecific binding is moderate (<inline-formula><mml:math id="inf159"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.15 non-specific spots per AOI image on average). We next examined the effects of increasing the non-specific rate. In particular, we used simulated data (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>) with high SNR = 3.76 to test the classification accuracy of Tapqir at different non-specific binding densities up to <inline-formula><mml:math id="inf160"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1, a value considerably higher than typical of usable experimental data (the experimental data sets in <xref ref-type="table" rid="table1">Table 1</xref> have <inline-formula><mml:math id="inf161"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> ranging from 0.04 to 0.30). In analysis of these data sets, a few images with target-specific spots are misclassified as not having a specific spot (<inline-formula><mml:math id="inf162"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> near zero) or as being ambiguous (<inline-formula><mml:math id="inf163"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> near 0.5) (<xref ref-type="fig" rid="fig4">Figure 4F</xref>, green bars), and a few images with target-nonspecific spots are misclassified as having specific spot (<inline-formula><mml:math id="inf164"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> near or above 0.5) (<xref ref-type="fig" rid="fig4">Figure 4F</xref>, gray bars), but these misclassifications only occurred at the unrealistically high <inline-formula><mml:math id="inf165"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> value. Even in the simulation with this highest <inline-formula><mml:math id="inf166"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> value, Tapqir accurately identified target-specific spots (<xref ref-type="fig" rid="fig4">Figure 4E and F</xref>) and returned excellent binary classification statistics (<xref ref-type="fig" rid="fig4">Figure 4G</xref>).</p><p>A weakness of some existing image-based CoSMoS spot discrimination methods is that target-nonspecific binding adjacent to a target-specific spot can interfere with correctly identifying the latter as target-specific. The very high recall values obtained at <inline-formula><mml:math id="inf167"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1 (<xref ref-type="fig" rid="fig4">Figure 4G</xref>) confirm that there are few such misidentifications by Tapqir even at high non-specific binding densities. This good performance is likely facilitated by the feature of the Tapqir model that explicitly includes the possibility that both a specifically and a non-specifically bound spot may occur simultaneously in the same AOI. Consistent with this interpretation, we see effective detection of the specific and non-specific spots even in example AOIs in which the two spots are so closely spaced that they are not completely resolved (<xref ref-type="fig" rid="fig4">Figure 4H</xref>). In contrast, tests of existing CoSMoS image classification methods show that images with target-nonspecific spots are prone to misclassification. As discussed previously (<xref ref-type="bibr" rid="bib12">Friedman and Gelles, 2015</xref>), methods based on thresholding of integrated AOI intensities are prone to incorrectly classify target-nonspecific spots as target-specific. Conversely, an existing ‘spot-picker’ method based on empirical binary classification of 2-D AOI images (<xref ref-type="bibr" rid="bib12">Friedman and Gelles, 2015</xref>) is much more likely than Tapqir to fail to detect target specific spots when there is a nearby non-specific spot (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). This contributes to the superior overall performance we see for Tapqir vs. spot-picker on the <inline-formula><mml:math id="inf168"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1 data set (recall 0.993 vs 0.919; precision 0.943 vs 0.873; MCC 0.961 vs 0.874).</p><p>To further evaluate whether Tapqir is prone to misidentifying target-nonspecific spots as specific, we simulated data sets with no target-specific binding at both low and high non-specific binding densities (<xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>). Analysis of such data (<xref ref-type="fig" rid="fig4">Figure 4I</xref>) shows that no target-specific binding (i.e., <inline-formula><mml:math id="inf169"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> &gt; 0.6) was detected even under the highest non-specific binding density, demonstrating that Tapqir is robust to false-positive target-specific spot detection even under these extreme conditions.</p><p>Since target-nonspecific spots are built into the <italic>cosmos</italic> model, there is no need to choose excessively small AOIs in an attempt to exclude non-specific spots from analysis. We found that reducing AOI size (from 14 × 14 to 6 x 6 pixels) did not appreciably affect analysis accuracy on simulated data, when the width (<inline-formula><mml:math id="inf170"><mml:mi>w</mml:mi></mml:math></inline-formula>) of the spots was equal to 1.4 pixels (<xref ref-type="table" rid="table2">Table 2</xref>). In analysis of experimental data, smaller AOI sizes caused occasional changes in calculated <inline-formula><mml:math id="inf171"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> values reflecting apparent missed detection of a few spots (<xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>). Out of caution, we therefore used 14 × 14 pixel AOIs routinely, even though the larger AOIs somewhat reduced computation speed (<xref ref-type="table" rid="table2">Table 2</xref> and <xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>).</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>The effect of AOI size on classification accuracy<xref ref-type="table-fn" rid="table2fn1">*</xref>.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">AOI dimension<xref ref-type="table-fn" rid="table2fn2"><sup>†</sup></xref>, P (pixels)</th><th align="left" valign="bottom">MCC</th><th align="left" valign="bottom">Compute time<xref ref-type="table-fn" rid="table2fn3"><sup>‡</sup></xref></th></tr></thead><tbody><tr><td align="char" char="." valign="bottom">14</td><td align="char" char="." valign="bottom">0.951</td><td align="left" valign="bottom">2 h 10 m</td></tr><tr><td align="char" char="." valign="bottom">10</td><td align="char" char="." valign="bottom">0.948</td><td align="left" valign="bottom">1 h 25 m</td></tr><tr><td align="char" char="." valign="bottom">6</td><td align="char" char="." valign="bottom">0.939</td><td align="left" valign="bottom">1 h 20 m</td></tr></tbody></table><table-wrap-foot><fn id="table2fn1"><label>*</label><p>Tapqir was applied to the same simulated data set (height1000 parameter set in <xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref>; SNR = 1.25) using different AOI sizes.</p></fn><fn id="table2fn2"><label>†</label><p>The width (<inline-formula><mml:math id="inf172"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) of the simulated spots (one standard deviation of the 2-D Gaussian) is equal to 1.4 pixels.</p></fn><fn id="table2fn3"><label>‡</label><p>Unattended calculation time on an AMD Ryzen Threadripper 2990WX with an Nvidia GeForce RTX 2080Ti GPU using CUDA version 11.5.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s2-10"><title>Kinetic and thermodynamic analysis of molecular interactions</title><p>The most widespread application of CoSMoS experiments is to measure rate and equilibrium constants for the binding interaction of the target and binder molecules being studied. We next tested whether these constants can be accurately determined using Tapqir-calculated posterior predictions.</p><p>We first simulated CoSMoS data sets (<xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref>) that reproduced the behavior of a one-step association/dissociation reaction mechanism (<xref ref-type="fig" rid="fig5">Figure 5A and B</xref>, blue). Simulated data were analyzed with Tapqir yielding <inline-formula><mml:math id="inf173"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> values for each frame (e.g., <xref ref-type="fig" rid="fig5">Figure 5B</xref>, green). We wanted to estimate rate constants using the full information contained in the <inline-formula><mml:math id="inf174"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> probabilities, so we did not threshold <inline-formula><mml:math id="inf175"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> for this analysis. Instead, from each single-AOI <inline-formula><mml:math id="inf176"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> time record we constructed a family of binary time records (<xref ref-type="fig" rid="fig5">Figure 5B</xref>, black) by Monte Carlo sampling according to the <inline-formula><mml:math id="inf177"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> time series. Each family member has well-defined target-specific binder-present and binder-absent intervals <inline-formula><mml:math id="inf178"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf179"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, respectively. Each of these time records was then analyzed with a two-state hidden Markov model (HMM) (see Materials and methods), producing a distribution of inferred rate constants from which we calculated mean values and their uncertainties (<xref ref-type="fig" rid="fig5">Figure 5C and D</xref>). Comparison of the simulated and inferred values shows that both <inline-formula><mml:math id="inf180"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf181"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> rate constants are accurate within 30% at nonspecific binding densities typical of experimental data (<inline-formula><mml:math id="inf182"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> ≤ 0.5). At higher nonspecific binding densities, rare interruptions caused by false-positive and false-negative spot detection shorten <inline-formula><mml:math id="inf183"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf184"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> distributions, leading to moderate systematic overestimation of the association and dissociation rate constants.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Tapqir analysis of association/dissociation kinetics and thermodynamics.</title><p>(<bold>A</bold>) Chemical scheme for a one-step association/dissociation reaction at equilibrium with pseudo-first-order binding and dissociation rate constants <inline-formula><mml:math id="inf185"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf186"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, respectively. (<bold>B</bold>) A simulation of the reaction in (<bold>A</bold>) and scheme for kinetic analysis of the simulated data with Tapqir. The simulation used SNR = 3.76, <inline-formula><mml:math id="inf187"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.02 s<sup>−1</sup>, <inline-formula><mml:math id="inf188"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.2 s<sup>−1</sup>, and a high target-nonspecific binding frequency <inline-formula><mml:math id="inf189"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1 (<xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref>, data set <monospace>kon0.02lamda1</monospace>). Full dataset consists of 100 AOI locations and 1,000 frames each for on-target data and off-target control data. Shown is a short extract of on-target data from a single AOI location in the simulation. Plots show simulated presence/absence of the target-specific spot (blue) and Tapqir-calculated estimate of corresponding target-specific spot probability <inline-formula><mml:math id="inf190"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (green). Two thousand binary traces (e.g., black records) were sampled from the <inline-formula><mml:math id="inf191"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> posterior distribution and used to infer <inline-formula><mml:math id="inf192"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf193"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> using a two-state hidden Markov model (HMM) (see Materials and methods). Each sample trace contains well-defined time intervals corresponding to target-specific spot presence and absence (e.g., <inline-formula><mml:math id="inf194"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf195"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>). (<bold>C,D,E</bold>) Kinetic and equilibrium constants from simulations (<xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref>) using a range of <inline-formula><mml:math id="inf196"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> values and target-nonspecific spot frequencies <inline-formula><mml:math id="inf197"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, with constant <inline-formula><mml:math id="inf198"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.2 s<sup>−1</sup>. (<bold>C</bold>) Values of <inline-formula><mml:math id="inf199"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> used in simulations (blue) and mean values (and 95% CIs, black) inferred by HMM analysis from the 2000 posterior samples. Some error bars are smaller than the points and thus not visible. (<bold>D</bold>) Same as (<bold>C</bold>) but for <inline-formula><mml:math id="inf200"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. (<bold>E</bold>) Binding equilibrium constants <inline-formula><mml:math id="inf201"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">q</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> used in simulation (blue) and inferred from Tapqir-calculated π as <inline-formula><mml:math id="inf202"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">q</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>π</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (black).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73860-fig5-v2.tif"/></fig><p>From the same simulated data, we calculated the equilibrium constant <inline-formula><mml:math id="inf203"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">q</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and its uncertainty. This calculation does not require a time-dependent model and can be obtained directly from the posterior distribution of the average specific-binding probability <inline-formula><mml:math id="inf204"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. The estimated equilibrium constants are highly accurate even at excessively high values of <inline-formula><mml:math id="inf205"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig5">Figure 5E</xref>). The high accuracy results from the fact that equilibrium constant measurements are in general much less affected than kinetic measurements by occasional false positives and false negatives in spot detection.</p><p>The forgoing analysis shows that Tapqir can accurately recover kinetic and thermodynamic constants from simulated CoSMoS data. However, experimental CoSMoS data sets can be more diverse. In addition to having different SNR and non-specific binding frequency values, they also may have non-idealities in spot shape (caused by optical aberrations) and in noise (caused by molecular diffusion in and out of the TIRF evanescent field). In order to see if Tapqir analysis is robust to these and other properties of real experimental data, we analyzed several CoSMoS data sets taken from different experimental projects. Analysis of each data set took a few hours of computation time on a GPU-equipped desktop computer or cloud computing service (<xref ref-type="table" rid="table1">Table 1</xref>). We first visualized the results as probabilistic rastergrams (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1A</xref>, <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2A</xref>, and <xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3A</xref>), in which each horizontal line represents the time record from a single AOI. Unlike the binary spot/no-spot rastergrams in previous studies (e.g., <xref ref-type="bibr" rid="bib11">Friedman et al., 2013</xref>; <xref ref-type="bibr" rid="bib30">Rosen et al., 2020</xref>) we plotted the Tapqir-calculated spot probability <inline-formula><mml:math id="inf206"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> using a color scale. This representation allows a more nuanced understanding of the data. For example, <xref ref-type="fig" rid="fig6">Figure 6A</xref> reveals that while the long-duration spot detection events typically are assigned a high probability (yellow), some of the shortest duration events have an intermediate <inline-formula><mml:math id="inf207"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (green) indicating that the assignment of these as target-specific is uncertain.</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Extraction of target-binder association kinetics from example experimental data.</title><p>Data are from Data set B (SNR = 3.77, <inline-formula><mml:math id="inf208"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.1575; see <xref ref-type="table" rid="table1">Table 1</xref>). (<bold>A</bold>) Probabilistic rastergram representation of Tapqir-calculated target-specific spot probabilities <inline-formula><mml:math id="inf209"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (color scale). AOIs were ordered by decreasing times-to-first-binding. For clarity, only every thirteenth frame is plotted. (<bold>B</bold>) Time-to-first-binding distribution using Tapqir. Plot shows the cumulative fraction of AOIs that exhibited one or more target-specific binding events by the indicated frame number (green) and fit curve (black). Shading indicates uncertainty. (<bold>C</bold>) Time-to-first-binding distribution using an empirical spot-picker method <xref ref-type="bibr" rid="bib11">Friedman et al., 2013</xref>. The spot-picker method jointly fits first spots observed in off-target control AOIs (yellow) and in on-target AOIs (purple) yielding fit curves (black). (<bold>D</bold>) Values of kinetic parameters <inline-formula><mml:math id="inf210"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">a</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf211"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">n</mml:mi><mml:mi mathvariant="sans-serif">s</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf212"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (see text) derived from fits in (<bold>B</bold>) and (<bold>C</bold>). Uncertainties reported in (<bold>B, C, D</bold>) represent 95% credible intervals for Tapqir and 95% confidence intervals for spot-picker (see Materials and methods).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73860-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Additional example showing extraction of target-binder association kinetics from experimental data.</title><p>Data are from Data set A (SNR = 1.61, <inline-formula><mml:math id="inf213"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.2943; see <xref ref-type="table" rid="table1">Table 1</xref>). Results are plotted as in <xref ref-type="fig" rid="fig6">Figure 6</xref>, except that for clarity only every second frame and every third AOI is shown in (<bold>A</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73860-fig6-figsupp1-v2.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 2.</label><caption><title>Additional example showing extraction of target-binder association kinetics from experimental data.</title><p>Data are from Data set C (SNR = 4.23, <inline-formula><mml:math id="inf214"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.0876; see <xref ref-type="table" rid="table1">Table 1</xref>). Results are plotted as in <xref ref-type="fig" rid="fig6">Figure 6</xref>, except that for clarity only every tenth frame is shown in (<bold>A</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73860-fig6-figsupp2-v2.tif"/></fig><fig id="fig6s3" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 3.</label><caption><title>Additional example showing extraction of target-binder association kinetics from experimental data.</title><p>Data are from Data set D (SNR = 3.06, <inline-formula><mml:math id="inf215"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.0437; see <xref ref-type="table" rid="table1">Table 1</xref>). Results are plotted as in <xref ref-type="fig" rid="fig6">Figure 6</xref>, except that for clarity only every thirteenth frame and every second AOI is shown in (<bold>A</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73860-fig6-figsupp3-v2.tif"/></fig></fig-group><p>To demonstrate the utility of Tapqir for kinetic analysis of real experimental data, we measured binder association rate constants in previously published experimental data sets (<xref ref-type="table" rid="table1">Table 1</xref>). We employed our previous strategy (<xref ref-type="bibr" rid="bib10">Friedman and Gelles, 2012</xref>; <xref ref-type="bibr" rid="bib12">Friedman and Gelles, 2015</xref>) of analyzing the duration of the binder-absent intervals that preceded the first binding event. Such time-to-first binding analysis improves the accuracy of association rate constant estimates relative to those obtained by analyzing all <inline-formula><mml:math id="inf216"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> values by minimizing the effects of target molecules occupied by photobleached binders, dye blinking and false negative dropouts that occur within a continuous binder dwell interval. To perform a time-to-first-binding analysis using Tapqir, we used the posterior sampling method (as in <xref ref-type="fig" rid="fig5">Figure 5B</xref>, black records) to determine the initial <inline-formula><mml:math id="inf217"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> in each AOI record. These data were fit to a kinetic model (<xref ref-type="bibr" rid="bib10">Friedman and Gelles, 2012</xref>; <xref ref-type="bibr" rid="bib12">Friedman and Gelles, 2015</xref>) in which only a fraction of target molecules <inline-formula><mml:math id="inf218"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> were binding competent and which includes both exponential target-specific association with rate constant <inline-formula><mml:math id="inf219"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">a</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, as well as exponential non-specific association with rate constant <inline-formula><mml:math id="inf220"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">n</mml:mi><mml:mi mathvariant="sans-serif">s</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig6">Figure 6B</xref>, <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1B</xref>, <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2B</xref>, and <xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3B</xref>). The Tapqir-derived fits showed excellent agreement with the kinetic model.</p><p>To further assess the utility of the Tapqir method, we used experimental data sets and compared the Tapqir association kinetics results with those from the previously published empirical binary ‘spot-picker’ method (<xref ref-type="bibr" rid="bib12">Friedman and Gelles, 2015</xref>; <xref ref-type="fig" rid="fig6">Figure 6C</xref>, <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1C</xref>, <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2C</xref>, and <xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3C</xref>). The values of the association rate constant <inline-formula><mml:math id="inf221"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">a</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> obtained using these two methods are in good agreement with each other (<xref ref-type="fig" rid="fig6">Figure 6D</xref>, <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1D</xref>, <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2D</xref>, and <xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3D</xref>). We emphasize that while Tapqir is fully objective, achieving these results with the spot-picker method required optimization by subjective adjustment of spot detection thresholds. We noted some differences between the two methods in the non-specific association rate constants <inline-formula><mml:math id="inf222"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">n</mml:mi><mml:mi mathvariant="sans-serif">s</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Differences are expected because these parameters are defined differently in the different non-specific binding models used in Tapqir and spot-picker (see Materials and methods).</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>A broad range of physical processes contribute to the formation of CoSMoS images. These include camera and photon noise, target-specific and non-specific binding, and time- and position-dependent variability in fluorophore imaging and image background. Unlike prior CoSMoS analysis methods, Tapqir considers these aspects of imaging in a single, holistic model. This <italic>cosmos</italic> model explicitly includes the uncertainties due to photon noise, camera gain, and spatial variability in intensity offset. The model also includes the possibility of multiple binder molecule fluorescence spots being present in the vicinity of the target, including both target-specific binding and target-nonspecific interactions of binder molecules with the coverslip surface. This explicit modeling of target-nonspecific spots makes it possible to include off-target control data as a part of the experimental data set. Similarly, all AOIs and frames in the data set are simultaneously fit to the global model in a way that allows for realistic frame-to-frame and AOI-to-AOI variability in image formation caused by variations in laser intensity, fluctuations in background, and other non-idealities. The global analysis based on a single, unified model enables the final results (e.g., kinetic and thermodynamic parameters) to be estimated in a way that is cognizant of the known sources of uncertainty in the data.</p><p>Previous approaches to CoSMoS data analysis, including our spot-picker method (<xref ref-type="bibr" rid="bib12">Friedman and Gelles, 2015</xref>), did not employ a holistic modeling approach and instead relied on a multi-step process that includes a separate binary classification step. These prior methods require subjective setting of classification thresholds. Because they are not fully objective, such methods cannot reliably account for uncertainties in spot classification, which compromises error estimates in the analysis pipeline downstream of spot classification. One recent approach (<xref ref-type="bibr" rid="bib37">Smith et al., 2019</xref>; <xref ref-type="bibr" rid="bib36">Smith et al., 2015</xref>), which like spot-picker and Tapqir analyzes 2-D images instead of integrated intensities, used a Bayesian kinetic analysis but a frequentist hypothesis test (a generalized likelihood ratio test) for spot detection. The frequentist method lacks a key advantage of Tapqir’s model-based Bayesian approach that here enables prediction of target-specific spot presence probabilities <inline-formula><mml:math id="inf223"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> for each image, rather than a binary ‘spot/no spot’ classification. In general, previous approaches in essence assume that spot classifications are correct, and thus the uncertainties in the derived molecular properties (e.g., equilibrium constants) are systematically underestimated because the errors in spot classification, which can be large, are not accounted for. By performing a probabilistic spot classification, Tapqir enables reliable inference of molecular properties, such as thermodynamic and kinetic parameters, and allows statistically well-justified estimation of parameter uncertainties. This more inclusive error estimation likely accounts for the generally larger kinetic parameter error bars obtained from Tapqir compared to those from the existing spot-picker analysis method (<xref ref-type="fig" rid="fig6">Figure 6</xref>, <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>, <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>, and <xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3</xref>). Even though existing analysis methods take advantage of subjective tuning by a human analyst, our comparisons show that Tapqir performs at least comparably to (<xref ref-type="fig" rid="fig6">Figure 6</xref>, <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>, <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>, and <xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3</xref>) and under some conditions much better than (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>) the existing spot-picker method.</p><p>The Tapqir <italic>cosmos</italic> model includes parameters of mechanistic interest, such as the average probability of target-specific binding, as well as ‘nuisance’ parameters that are not of primary interest but nevertheless essential for image modeling. In previous image-based methods for CoSMoS analysis (e.g., <xref ref-type="bibr" rid="bib12">Friedman and Gelles, 2015</xref>; <xref ref-type="bibr" rid="bib37">Smith et al., 2019</xref>), nuisance parameters were either measured in separate experiments (e.g., gain was determined from calibration data), set heuristically (e.g., a subjective choice of user-set thresholds for spot intensity and proximity in colocalization detection), or determined at a separate analysis step (e.g., rate of non-specific binding). In contrast, Tapqir directly learns parameters from the full set of experimental data, thus eliminating the need for additional experiments, subjective adjustment of tuning parameters, and post-processing steps.</p><p>Bayesian analysis has been used previously to analyze data from single-molecule microscopy experiments (e.g., <xref ref-type="bibr" rid="bib18">Kinz-Thompson et al., 2021</xref> and references cited therein). A key feature of Bayesian analysis is that the extent of prior knowledge of all model parameters is explicitly incorporated. Where appropriate, <italic>cosmos</italic> uses relatively uninformative priors that only weakly specify information about the value of the corresponding parameters. In these cases, <italic>cosmos</italic> mostly infers parameter values from the data. In contrast, some priors are more informative. For example, binder molecule spots near the target molecule are more likely to be target-specific rather than target-nonspecific, so we use this known feature of the experiment by encoding the likely position of target-specific binding as a data-based prior. This tactic effectively enables probabilistic classification of spots as either target-specific or target-nonspecific, which would be difficult using other inference methodologies, while still accommodating data sets with different accuracies of mapping between binder and target channels.</p><p>Tapqir is implemented in Pyro, a Python-based probabilistic programming language (PPL) (<xref ref-type="bibr" rid="bib1">Bingham et al., 2019</xref>). Probabilistic programming is a relatively new paradigm in which probabilistic models are expressed in a high-level language that allows easy formulation, modification, and automated inference (<xref ref-type="bibr" rid="bib41">van de Meent et al., 2018</xref>). In this work we focused on developing an image model for colocalization detection in a relatively simple binder-target single-molecule experiment. However, Tapqir can be used with more complex models. For example, the <italic>cosmos</italic> model could be naturally extended to multi-state and multi-color analysis. Furthermore, with the development of more efficient sequential hidden Markov modeling algorithms (<xref ref-type="bibr" rid="bib33">Särkkä and García-Fernández, 2019</xref>; <xref ref-type="bibr" rid="bib27">Obermeyer et al., 2019b</xref>) Tapqir can potentially be extended to directly incorporate kinetic processes, allowing direct inference of kinetic mechanisms and rate constants.</p><p>Tapqir is free, open-source software. Tapqir is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/gelles-brandeis/tapqir">https://github.com/gelles-brandeis/tapqir</ext-link>. The results presented here were obtained using release 1.0 of the program (<ext-link ext-link-type="uri" xlink:href="https://github.com/gelles-brandeis/tapqir/releases/tag/v1.0">https://github.com/gelles-brandeis/tapqir/releases/tag/v1.0</ext-link>). The Tapqir documentation, which contains tutorials on program use, is at <ext-link ext-link-type="uri" xlink:href="https://tapqir.readthedocs.io/en/stable/">https://tapqir.readthedocs.io/en/stable/</ext-link>. Source data including Figures, Figure supplements, Supplementary files, manuscript text, and the scripts and data used to generate them are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ordabayevy/tapqir-overleaf">https://github.com/ordabayevy/tapqir-overleaf</ext-link>.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Notation</title><p>In the Materials and methods section, we adopt a mathematical notation for multi-dimensional arrays from the field of machine learning (<xref ref-type="bibr" rid="bib6">Chiang et al., 2021</xref>). The notation uses <italic>named axes</italic> and incorporates implicit broadcasting of arrays when their shapes are different.</p></sec><sec id="s4-2"><title>Extracting image data</title><p>Raw input data into Tapqir consists of (1) binder channel images (<inline-formula><mml:math id="inf224"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">w</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>), each <inline-formula><mml:math id="inf225"><mml:mrow><mml:mi>W</mml:mi><mml:mo>×</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math></inline-formula> pixels in size, for each time point (<xref ref-type="fig" rid="fig1">Figure 1B</xref>, right) and (2) lists of locations, corrected for microscope drift if necessary (<xref ref-type="bibr" rid="bib12">Friedman and Gelles, 2015</xref>), of target molecules and of off-target control locations (<xref ref-type="bibr" rid="bib12">Friedman and Gelles, 2015</xref>) within the raw images. For simplicity, we use the same notation (<inline-formula><mml:math id="inf226"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">t</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">w</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf227"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">t</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">w</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>) both for target molecule locations and off-target control locations. Tapqir extracts a <inline-formula><mml:math id="inf228"><mml:mrow><mml:mi>P</mml:mi><mml:mo>×</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula> AOI around each target and off-target location and returns (1) the extracted data set <inline-formula><mml:math id="inf229"><mml:mi>D</mml:mi></mml:math></inline-formula> consisting of a set of <inline-formula><mml:math id="inf230"><mml:mrow><mml:mi>P</mml:mi><mml:mo>×</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula> grayscale images, collected at <inline-formula><mml:math id="inf231"><mml:mi>N</mml:mi></mml:math></inline-formula> on-target AOI sites and <inline-formula><mml:math id="inf232"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> off-target AOI sites for a range of <inline-formula><mml:math id="inf233"><mml:mi>F</mml:mi></mml:math></inline-formula> frames (<xref ref-type="fig" rid="fig1">Figure 1C and D</xref>; <xref ref-type="fig" rid="fig7">Figure 7</xref>), and (2) new target (and off-target) locations (<inline-formula><mml:math id="inf234"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">t</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf235"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">t</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>) adjusted relative to extracted images <inline-formula><mml:math id="inf236"><mml:mi>D</mml:mi></mml:math></inline-formula> where <inline-formula><mml:math id="inf237"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">t</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf238"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">t</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> both lie within the <inline-formula><mml:math id="inf239"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> central range of the image. For the data presented in this article, we used <inline-formula><mml:math id="inf240"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 14. Cartesian pixel indices (<italic>i</italic>, <inline-formula><mml:math id="inf241"><mml:mi>j</mml:mi></mml:math></inline-formula>) are integers but also represent the center point of a pixel on the image plane. While experimental intensity measurements are integers, we treat them as continuous values in our analysis.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Extraction of AOI images from raw images.</title><p><supplementary-material id="fig7sdata1"><label>Figure 7—source data 1.</label><caption><title>Original text for <xref ref-type="fig" rid="fig7">Figure 7</xref>.</title></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-73860-fig7-data1-v2.pdf"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73860-fig7-v2.tif"/></fig></sec><sec id="s4-3"><title>The <italic>cosmos</italic> model</title><p>Our intent is to model CoSMoS image data by accounting for the significant physical aspects of image formation, such as photon noise and binding of target-specific and target-nonspecific molecules to the microscope slide surface. A graphical representation of the Tapqir model for CoSMoS data similar to that in <xref ref-type="fig" rid="fig2">Figure 2D</xref> but including probability distributions and other additional detail is shown in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>. The corresponding generative model represented as pseudocode is shown in <xref ref-type="fig" rid="fig8">Figure 8</xref>. All variables with short descriptions and their domains are listed in <xref ref-type="table" rid="table3">Table 3</xref>. Below, we describe the model in detail starting with the observed data and the likelihood function and then proceed with model parameters and their prior distributions.</p><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Pseudocode representation of <italic>cosmos</italic> model.</title><p><supplementary-material id="fig8sdata1"><label>Figure 8—source data 1.</label><caption><title>Original text for <xref ref-type="fig" rid="fig8">Figure 8</xref>.</title></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-73860-fig8-data1-v2.pdf"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73860-fig8-v2.tif"/></fig><table-wrap id="table3" position="float"><label>Table 3.</label><caption><title>Variables used in the Tapqir model.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Symbol</th><th align="left" valign="bottom">Meaning</th><th align="left" valign="bottom">Domain</th></tr></thead><tbody><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf242"><mml:mi>K</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Maximum number of spots per image</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf243"><mml:mi>ℕ</mml:mi></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf244"><mml:mi>N</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Number of on-target AOIs</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf245"><mml:mi>ℕ</mml:mi></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf246"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Number of off-target control AOIs</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf247"><mml:mi>ℕ</mml:mi></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf248"><mml:mi>F</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Number of frames</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf249"><mml:mi>ℕ</mml:mi></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf250"><mml:mi>P</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Size of the AOI image in pixels</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf251"><mml:mi>ℕ</mml:mi></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf252"><mml:mi>g</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Camera gain</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf253"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf254"><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula></td><td align="left" valign="bottom">Proximity</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf255"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msqrt><mml:mn>12</mml:mn></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf256"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Average target-specific binding probability</td><td align="char" char="." valign="bottom"><inline-formula><mml:math id="inf257"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf258"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Target-nonspecific binding density</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf259"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf260"><mml:msup><mml:mi>μ</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula></td><td align="left" valign="bottom">Mean background intensity across AOI</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf261"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf262"><mml:msup><mml:mi>σ</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula></td><td align="left" valign="bottom">Standard deviation of background intensity across AOI</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf263"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf264"><mml:mi>b</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Background intensity</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf265"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf266"><mml:mi>z</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Target-specific spot presence</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf267"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf268"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Target-specific spot index</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf269"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf270"><mml:mi>m</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Spot presence indicator</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf271"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf272"><mml:mi>h</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Integrated spot intensity</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf273"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf274"><mml:mi>w</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Spot width</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf275"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0.75</mml:mn><mml:mo>,</mml:mo><mml:mn>2.25</mml:mn><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf276"><mml:mi>x</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Center of the spot on the <inline-formula><mml:math id="inf277"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>-axis</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf278"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf279"><mml:mi>y</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Center of the spot on the <inline-formula><mml:math id="inf280"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>-axis</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf281"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf282"><mml:msup><mml:mi>μ</mml:mi><mml:mi>S</mml:mi></mml:msup></mml:math></inline-formula></td><td align="left" valign="bottom">2-D Gaussian spot</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf283"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">X</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">Y</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf284"><mml:msup><mml:mi>μ</mml:mi><mml:mi>I</mml:mi></mml:msup></mml:math></inline-formula></td><td align="left" valign="bottom">Ideal image w/o offset</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf285"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">X</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">Y</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf286"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Offset signal</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf287"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">X</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">Y</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf288"><mml:mi>I</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Observed image w/o offset signal</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf289"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">X</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">Y</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf290"><mml:mi>D</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Observed image (<inline-formula><mml:math id="inf291"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>)</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf292"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">X</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">Y</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf293"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">t</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Target molecule position on the <inline-formula><mml:math id="inf294"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>-axis</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf295"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf296"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">t</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Target molecule position on the <inline-formula><mml:math id="inf297"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>-axis</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf298"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><italic>i</italic></td><td align="left" valign="bottom">Pixel index on the <inline-formula><mml:math id="inf299"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>-axis</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf300"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">X</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf301"><mml:mi>j</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Pixel index on the <inline-formula><mml:math id="inf302"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>-axis</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf303"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">X</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf304"><mml:mi>W</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Width of the raw microscope images in pixels</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf305"><mml:mi>ℕ</mml:mi></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf306"><mml:mi>H</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">Height of the raw microscope image in pixels</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf307"><mml:mi>ℕ</mml:mi></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf308"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">w</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Raw microscope images</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf309"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">X</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">Y</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>W</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf310"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">t</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">w</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Target molecule position in raw images on the <inline-formula><mml:math id="inf311"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>-axis</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf312"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo>−</mml:mo><mml:mn>0.5</mml:mn><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf313"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">t</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">w</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom">Target molecule position in raw images on the <inline-formula><mml:math id="inf314"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>-axis</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf315"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mi>W</mml:mi><mml:mo>−</mml:mo><mml:mn>0.5</mml:mn><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr></tbody></table></table-wrap><sec id="s4-3-1"><title>Image likelihood</title><p>We model the image data <inline-formula><mml:math id="inf316"><mml:mi>D</mml:mi></mml:math></inline-formula> as the sum of a photon-independent offset <inline-formula><mml:math id="inf317"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> introduced by the camera and the noisy photon-dependent pixel intensity values <inline-formula><mml:math id="inf318"><mml:mi>I</mml:mi></mml:math></inline-formula>:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>In our model, each pixel in the photon-dependent image <inline-formula><mml:math id="inf319"><mml:mi>I</mml:mi></mml:math></inline-formula> has a variance which is equal to the mean intensity <inline-formula><mml:math id="inf320"><mml:msup><mml:mi>μ</mml:mi><mml:mi>I</mml:mi></mml:msup></mml:math></inline-formula> of that pixel multiplied by the camera gain <inline-formula><mml:math id="inf321"><mml:mi>g</mml:mi></mml:math></inline-formula>, which is the number of camera intensity units per photon. This formulation is appropriate for cameras that use charge-coupled device (CCD) or electron-multiplier CCD (EMCCD) sensors. (The experimental CoSMoS datasets we analyzed (<xref ref-type="table" rid="table1">Table 1</xref>) were collected with EMCCD cameras.) It accounts for both photon shot noise and additional noise introduced by EMCCD camera amplification (<xref ref-type="bibr" rid="bib43">van Vliet et al., 1998</xref>) and is expressed using a continuous Gamma distribution:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mi>I</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="bold">G</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msqrt><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:mi>g</mml:mi></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The Gamma distribution was chosen because we found it to effectively model the image noise, which includes both Poissonian (shot noise) and non-Poissonian contributions. The Gamma distribution used here is parameterized by its mean and standard deviation. The functional forms of the Gamma distribution and all other distributions we use in this work are given in <xref ref-type="table" rid="table4">Table 4</xref>.</p><table-wrap id="table4" position="float"><label>Table 4.</label><caption><title>Probability distributions used in the model.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Distribution</th><th align="left" valign="bottom">PDF</th></tr></thead><tbody><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf322"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="bold">A</mml:mi><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">B</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>ν</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf323"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>y</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mtext>B</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>−</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>ν</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf324"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="bold">l</mml:mi><mml:mi mathvariant="bold">l</mml:mi><mml:mi mathvariant="bold">i</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf325"><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mi>x</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf326"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf327"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mtext>B</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf328"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">g</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">c</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">l</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf329"><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf330"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="bold">E</mml:mi><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold">p</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">c</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">l</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf331"><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf332"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="bold">E</mml:mi><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="bold">p</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">l</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf333"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf334"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="bold">G</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf335"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac></mml:mstyle><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mi>μ</mml:mi><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf336"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="bold">H</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">l</mml:mi><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">N</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">l</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf337"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mrow><mml:mi>σ</mml:mi><mml:msqrt><mml:mi>π</mml:mi></mml:msqrt></mml:mrow></mml:mfrac></mml:mstyle><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>x</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf338"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>k</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="bold">T</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">c</mml:mi><mml:mi mathvariant="bold">P</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">s</mml:mi><mml:mi mathvariant="bold">s</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">n</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf339"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" displaystyle="false" rowspacing=".2em"><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:msup><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mi>i</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>K</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf340"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="bold">U</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf341"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr></tbody></table></table-wrap><p>A competing camera technology based on scientific complementary metal-oxide semiconductor (sCMOS) sensors produces images that have also successfully been modeled as having a combination of Poissonian and non-Poissonian (Gaussian, in this case) noise sources. However, sCMOS images have noise characteristics that are considerably more complicated than CCD/EMCCD images, because every pixel has its own characteristic intensity offset, Gaussian noise variance, and amplification gain. Additional validation will be required to determine whether the existing <italic>cosmos</italic> model requires modification or inclusion of additional prior information (e.g., pixel-by-pixel calibration data as in <xref ref-type="bibr" rid="bib15">Huang et al., 2013</xref>) to optimize its performance with sCMOS CoSMoS data.</p></sec><sec id="s4-3-2"><title>Image model</title><p>The idealized noise-free image <inline-formula><mml:math id="inf342"><mml:msup><mml:mi>μ</mml:mi><mml:mi>I</mml:mi></mml:msup></mml:math></inline-formula> is represented as the sum of a background intensity <inline-formula><mml:math id="inf343"><mml:mi>b</mml:mi></mml:math></inline-formula> and the intensities from fluorescence spots modeled as 2-D Gaussians <inline-formula><mml:math id="inf344"><mml:msup><mml:mi>μ</mml:mi><mml:mi>S</mml:mi></mml:msup></mml:math></inline-formula>:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula></p><p>For simplicity, we allow at most <inline-formula><mml:math id="inf345"><mml:mi>K</mml:mi></mml:math></inline-formula> number of spots in each frame of each AOI. (In this article, we always use <inline-formula><mml:math id="inf346"><mml:mi>K</mml:mi></mml:math></inline-formula> equal to 2.) The presence of a given spot in the image is encoded in the binary spot existence parameter <inline-formula><mml:math id="inf347"><mml:mi>m</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf348"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1 when the corresponding spot is present and <inline-formula><mml:math id="inf349"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0 when it is absent.</p><p>The intensities for a 2-D Gaussian spot at each pixel coordinate (<italic>i</italic>, <inline-formula><mml:math id="inf350"><mml:mi>j</mml:mi></mml:math></inline-formula>) is given by:<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">X</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">Y</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>m</mml:mi><mml:mo>⋅</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mstyle><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">t</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">t</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>with spot parameters total integrated intensity <inline-formula><mml:math id="inf351"><mml:mi>h</mml:mi></mml:math></inline-formula>, width <inline-formula><mml:math id="inf352"><mml:mi>w</mml:mi></mml:math></inline-formula>, and center (<inline-formula><mml:math id="inf353"><mml:mi>x</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf354"><mml:mi>y</mml:mi></mml:math></inline-formula>) relative to the target (or off-target control) location (<inline-formula><mml:math id="inf355"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">t</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf356"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">t</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>).</p><p>Our primary interest is whether a target-specific spot is absent or present in a given AOI. We encode this information using a binary <italic>state</italic> parameter <inline-formula><mml:math id="inf357"><mml:mi>z</mml:mi></mml:math></inline-formula> with 0 and 1 denoting target-specific spot absence and presence, respectively. To indicate which of the <inline-formula><mml:math id="inf358"><mml:mi>K</mml:mi></mml:math></inline-formula> spots is target-specific, we use the <italic>index</italic> parameter <inline-formula><mml:math id="inf359"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> which ranges from 0 to <inline-formula><mml:math id="inf360"><mml:mi>K</mml:mi></mml:math></inline-formula>. When a target-specific spot is present (<inline-formula><mml:math id="inf361"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1), <inline-formula><mml:math id="inf362"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> specifies the index of the target-specific spot, while <inline-formula><mml:math id="inf363"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0 indicates that no target-specific spot is present (<inline-formula><mml:math id="inf364"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0). For example, <inline-formula><mml:math id="inf365"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> means that both spots are present and spot 2 is target-specific. A combination like <inline-formula><mml:math id="inf366"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is impossible (i.e., has zero probability) since spot 1 cannot be absent and target-specific at the same time. For off-target control data, in which no spots are target-specific by definition, <inline-formula><mml:math id="inf367"><mml:mi>z</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf368"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> are always set to zero.</p></sec><sec id="s4-3-3"><title>Prior distributions</title><p>The prior distributions for the model parameters are summarized in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref> and detailed below. Unless otherwise indicated we assume largely uninformative priors (such as the Half-Normal distribution with large mean).</p><p>Background intensity <inline-formula><mml:math id="inf369"><mml:mi>b</mml:mi></mml:math></inline-formula> follows a Gamma distribution:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mi>b</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="bold">G</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p><italic>where</italic> the mean <inline-formula><mml:math id="inf370"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> and standard deviation <inline-formula><mml:math id="inf371"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> of the background intensity describe the irregularity in the background intensity in time and across the field of view of the microscope. Priors for <inline-formula><mml:math id="inf372"><mml:msup><mml:mi>μ</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf373"><mml:msup><mml:mi>σ</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> are uninformative:<disp-formula id="equ6"><label>(6a)</label><mml:math id="m6"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="bold">H</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">l</mml:mi><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">N</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">l</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1000</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ7"><label>(6b)</label><mml:math id="m7"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="bold">H</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">l</mml:mi><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">N</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">l</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>100</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The target-specific presence parameter <inline-formula><mml:math id="inf374"><mml:mi>z</mml:mi></mml:math></inline-formula> has a Bernoulli prior parameterized by the average target-specific binding probability <inline-formula><mml:math id="inf375"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> for on-target AOIs and zero probability for control off-target AOIs:<disp-formula id="equ8"><label>(7)</label><mml:math id="m8"><mml:mrow><mml:mi>z</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>∼</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" displaystyle="false" rowspacing=".2em"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="bold">l</mml:mi><mml:mi mathvariant="bold">l</mml:mi><mml:mi mathvariant="bold">i</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mtext>on-target AOI</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mtext>control off-target AOI</mml:mtext></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The prior distribution for the index of the target-specific spot <inline-formula><mml:math id="inf376"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is conditional on <inline-formula><mml:math id="inf377"><mml:mi>z</mml:mi></mml:math></inline-formula>. When no specifically bound spot is present (i.e., <inline-formula><mml:math id="inf378"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0), <inline-formula><mml:math id="inf379"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> always equals 0. Since spot indices are arbitrarily assigned, when the target-specific spot is present (i.e., <inline-formula><mml:math id="inf380"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1) <inline-formula><mml:math id="inf381"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> can take any value between 1 and <inline-formula><mml:math id="inf382"><mml:mi>K</mml:mi></mml:math></inline-formula> with equal probability. We represent the prior for <inline-formula><mml:math id="inf383"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> as a Categorical distribution of the following form:<disp-formula id="equ9"><label>(8)</label><mml:math id="m9"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" displaystyle="false" rowspacing=".2em"><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">g</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">c</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">l</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The average target-specific binding probability <inline-formula><mml:math id="inf384"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> has an uninformative Jeffreys prior (<xref ref-type="bibr" rid="bib14">Gelman et al., 2013</xref>) given by a Beta distribution:<disp-formula id="equ10"><label>(9)</label><mml:math id="m10"><mml:mrow><mml:mi>π</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The prior distribution for the spot presence indicator <inline-formula><mml:math id="inf385"><mml:mi>m</mml:mi></mml:math></inline-formula> is conditional on <inline-formula><mml:math id="inf386"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. When <inline-formula><mml:math id="inf387"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> corresponds to spot index <inline-formula><mml:math id="inf388"><mml:mi>k</mml:mi></mml:math></inline-formula>, i.e., <inline-formula><mml:math id="inf389"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>, then <inline-formula><mml:math id="inf390"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1. When <inline-formula><mml:math id="inf391"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> does not correspond to a spot index <inline-formula><mml:math id="inf392"><mml:mi>k</mml:mi></mml:math></inline-formula>, that is, <inline-formula><mml:math id="inf393"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>, then either spot <inline-formula><mml:math id="inf394"><mml:mi>k</mml:mi></mml:math></inline-formula> is target-nonspecific or a spot corresponding to <inline-formula><mml:math id="inf395"><mml:mi>k</mml:mi></mml:math></inline-formula> does not exist. Consequently, for <inline-formula><mml:math id="inf396"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> we assign <inline-formula><mml:math id="inf397"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> to either 0 or 1 with a probability dependent on the non-specific binding density <inline-formula><mml:math id="inf398"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ11"><label>(10)</label><mml:math id="m11"><mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" displaystyle="false" rowspacing=".2em"><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="bold">l</mml:mi><mml:mi mathvariant="bold">l</mml:mi><mml:mi mathvariant="bold">i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>l</mml:mi><mml:mo>⋅</mml:mo><mml:mrow><mml:mi mathvariant="bold">T</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">c</mml:mi><mml:mi mathvariant="bold">P</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">s</mml:mi><mml:mi mathvariant="bold">s</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">n</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>;</mml:mo><mml:mi>λ</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>K</mml:mi></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="bold">l</mml:mi><mml:mi mathvariant="bold">l</mml:mi><mml:mi mathvariant="bold">i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>l</mml:mi><mml:mo>⋅</mml:mo><mml:mrow><mml:mi mathvariant="bold">T</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">c</mml:mi><mml:mi mathvariant="bold">P</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">s</mml:mi><mml:mi mathvariant="bold">s</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">n</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>;</mml:mo><mml:mi>λ</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mtext>otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The mean non-specific binding density <inline-formula><mml:math id="inf399"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is expected to be much less than two non-specifically bound spots per frame per AOI; therefore, we use an Exponential prior of the form<disp-formula id="equ12"><label>(11)</label><mml:math id="m12"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="bold">E</mml:mi><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="bold">p</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">l</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The prior distribution for the integrated spot intensity <inline-formula><mml:math id="inf400"><mml:mi>h</mml:mi></mml:math></inline-formula> is chosen to fall off at a value much greater than typical spot intensity values<disp-formula id="equ13"><label>(12)</label><mml:math id="m13"><mml:mrow><mml:mi>h</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="bold">H</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">l</mml:mi><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">N</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">l</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>10000</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In CoSMoS experiments, the microscope/camera hardware is typically designed to set the width <inline-formula><mml:math id="inf401"><mml:mi>w</mml:mi></mml:math></inline-formula> of fluorescence spots to a typical value in the range of 1–2 pixels (<xref ref-type="bibr" rid="bib25">Ober et al., 2015</xref>). We use a Uniform prior confined to the range between 0.75 and 2.25 pixels:<disp-formula id="equ14"><label>(13)</label><mml:math id="m14"><mml:mrow><mml:mi>w</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="bold">U</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.75</mml:mn><mml:mo>,</mml:mo><mml:mn>2.25</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Priors for spot position (<inline-formula><mml:math id="inf402"><mml:mi>x</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf403"><mml:mi>y</mml:mi></mml:math></inline-formula>) depend on whether the spot represents target-specific or non-specific binding. Non-specific binding to the microscope slide surface can occur anywhere within the image and therefore has a uniform distribution (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>, red). Spot centers may fall slightly outside the AOI image yet still affect pixel intensities within the AOI. Therefore the range for (<inline-formula><mml:math id="inf404"><mml:mi>x</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf405"><mml:mi>y</mml:mi></mml:math></inline-formula>) is extended one pixel wider than the size of the image, which allows a spot center to fall slightly beyond the AOI boundary.</p><p>In contrast to non-specifically bound molecules, specifically bound molecules are colocalized with the target molecule with a precision that can be better than one pixel and that depends on various factors including the microscope point-spread function and magnification, accuracy of registration between binder and target image channels, and accuracy of drift correction. For target-specific binding, we use an Affine-Beta prior with zero mean position relative to the target molecule location (<inline-formula><mml:math id="inf406"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">t</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf407"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">t</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>), and a ‘proximity’ parameter <inline-formula><mml:math id="inf408"><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> which is the standard deviation of the Affine-Beta distribution (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>, green). We chose the Affine-Beta distribution because it models a continuous parameter defined on a bounded interval.<disp-formula id="equ15"><label>(14)</label><mml:math id="m15"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" displaystyle="false" rowspacing=".2em"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="bold">A</mml:mi><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">B</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mtext>(target-specific)</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="bold">U</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mi>θ</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi><mml:mtext> </mml:mtext><mml:mrow/><mml:mtext>(target-nonspecific)</mml:mtext></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>We give the proximity parameter <inline-formula><mml:math id="inf409"><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> a diffuse prior, an Exponential with a characteristic width of one pixel:<disp-formula id="equ16"><label>(15)</label><mml:math id="m16"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msup><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="bold">E</mml:mi><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="bold">p</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">l</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Tests on data simulated with increasing proximity parameter values <inline-formula><mml:math id="inf410"><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> (true) (i.e., with decreasing precision of spatial mapping between the binder and target image channels) confirm that the <italic>cosmos</italic> model accurately learns <inline-formula><mml:math id="inf411"><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> (fit) from the data (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3D</xref>; <xref ref-type="table" rid="table5">Table 5</xref>). This was the case even if we substituted a less-informative <inline-formula><mml:math id="inf412"><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> prior (Uniform vs. Exponential; <xref ref-type="table" rid="table5">Table 5</xref>).</p><table-wrap id="table5" position="float"><label>Table 5.</label><caption><title>The effect of mapping precision on classification accuracy<xref ref-type="table-fn" rid="table5fn1">*</xref>.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"><inline-formula><mml:math id="inf413"><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>(true)</th><th align="left" valign="bottom"><inline-formula><mml:math id="inf414"><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>(fit) [95% CI]</th><th align="left" valign="bottom">MCC</th><th align="left" valign="bottom"><inline-formula><mml:math id="inf415"><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> Prior</th></tr></thead><tbody><tr><td align="char" char="." valign="bottom">0.2</td><td align="left" valign="bottom">0.21 [0.20, 0.22]</td><td align="char" char="." valign="bottom">0.989</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf416"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">E</mml:mi><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="bold">p</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">l</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="char" char="." valign="bottom">1</td><td align="left" valign="bottom">0.96 [0.90, 1.02]</td><td align="char" char="." valign="bottom">0.939</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf417"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">E</mml:mi><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="bold">p</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">l</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="char" char="." valign="bottom">1.5</td><td align="left" valign="bottom">1.49 [1.40, 1.59]</td><td align="char" char="." valign="bottom">0.890</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf418"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">E</mml:mi><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="bold">p</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">l</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="char" char="." valign="bottom">2</td><td align="left" valign="bottom">1.96 [1.84, 2.09]</td><td align="char" char="." valign="bottom">0.834</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf419"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">E</mml:mi><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="bold">p</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">l</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td align="char" char="." valign="bottom">2</td><td align="left" valign="bottom">1.97 [1.84, 2.09]</td><td align="char" char="." valign="bottom">0.834</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf420"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">U</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msqrt><mml:mn>12</mml:mn></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr></tbody></table><table-wrap-foot><fn id="table5fn1"><label>*</label><p>Data were simulated over a range of proximity parameter <inline-formula><mml:math id="inf421"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> values at fixed <inline-formula><mml:math id="inf422"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>π</mml:mi><mml:mo>=</mml:mo><mml:mn>0.15</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf423"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.15</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="supplementary-material" rid="supp6">Supplementary file 6</xref>).</p></fn></table-wrap-foot></table-wrap><p>The CoSMoS technique is premised on colocalization of the binder spots with the known location of the target molecule. Consequently, for any analysis method, classification accuracy declines when the images in the target and binder channels are less accurately mapped. For the Tapqir <italic>cosmos</italic> model, low mapping precision has little effect on classification accuracy at typical non-specific binding densities (<inline-formula><mml:math id="inf424"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.15; see MCC values in <xref ref-type="table" rid="table5">Table 5</xref>).</p><p>Gain <inline-formula><mml:math id="inf425"><mml:mi>g</mml:mi></mml:math></inline-formula> depends on the settings of the amplifier and electron multiplier (if present) in the camera. It has a positive value and is typically in the range between 5 and 50. We use a Half-Normal prior with a broad distribution encompassing this range:<disp-formula id="equ17"><label>(16)</label><mml:math id="m17"><mml:mrow><mml:mi>g</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="bold">H</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">l</mml:mi><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">N</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">l</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>50</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The prior distribution for the offset signal <inline-formula><mml:math id="inf426"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is empirically measured from the output of camera sensor regions that are masked from incoming photons. Collected data from these pixels are transformed into a density histogram with intensity step size of 1. The resulting histogram typically has a long right hand tail of low density. For computational efficiency, we shorten this tail by binning together pixel intensity values from the upper 0.5% percentile. Since <inline-formula><mml:math id="inf427"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>) and photon-dependent intensity <inline-formula><mml:math id="inf428"><mml:mi>I</mml:mi></mml:math></inline-formula> is positive, all <inline-formula><mml:math id="inf429"><mml:mi>D</mml:mi></mml:math></inline-formula> values have to be larger than the smallest offset intensity value. If that is not the case we add a single value <inline-formula><mml:math id="inf430"><mml:mrow><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> to the offset empirical distribution which has a negligible effect on the distribution. Bin values <inline-formula><mml:math id="inf431"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">s</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and their weights <inline-formula><mml:math id="inf432"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">w</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">h</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi><mml:mi mathvariant="sans-serif">s</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> are used to construct an Empirical prior:<disp-formula id="equ18"><label>(17)</label><mml:math id="m18"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="bold">E</mml:mi><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold">p</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">c</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">l</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">s</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">w</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">h</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi><mml:mi mathvariant="sans-serif">s</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>All simulated and experimental data sets in this work were analyzed using the prior distributions and hyperparameter values given above, which are compatible with a broad range of experimental conditions (<xref ref-type="table" rid="table1">Table 1</xref>). Many of the priors are uninformative and we anticipate that these will work well with images taken on variety of microscope hardware. However, it is possible that highly atypical microscope designs (e.g., those with effective magnifications that are sub-optimal for CoSMoS) might require adjustment of some fixed hyperparameters and distributions (those in <xref ref-type="disp-formula" rid="equ6 equ7 equ12 equ13 equ14 equ16 equ17">Eqs. 6a, 6b, 11, 12, 13, 15, and 16</xref>). For example, if the microscope point spread function is more than 2 pixels wide, it may be necessary to increase the range of the <inline-formula><mml:math id="inf433"><mml:mi>w</mml:mi></mml:math></inline-formula> prior in <xref ref-type="disp-formula" rid="equ14">Eq. 13</xref>. The Tapqir documentation (<ext-link ext-link-type="uri" xlink:href="https://tapqir.readthedocs.io/en/stable/">https://tapqir.readthedocs.io/en/stable/</ext-link>) gives instructions for changing the hyperparameters.</p></sec></sec><sec id="s4-4"><title>Joint distribution</title><p>The joint distribution of the data and all parameters is the fundamental distribution necessary to perform a Bayesian analysis. Let <inline-formula><mml:math id="inf434"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> be the set of all model parameters. The joint distribution can be expressed in a factorized form:<disp-formula id="equ19"><label>(18)</label><mml:math id="m19"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mtr><mml:mtd><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext> </mml:mtext></mml:mtd><mml:mtd><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:munder></mml:mphantom></mml:mpadded></mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>μ</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnspacing="0em" displaystyle="false" rowspacing="0.1em"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">X</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">Y</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:munder></mml:mphantom></mml:mpadded></mml:mrow><mml:mo>⋅</mml:mo></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi/><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:munder></mml:mphantom></mml:mpadded></mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/><mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnspacing="0em" displaystyle="false" rowspacing="0.1em"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">X</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">Y</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>μ</mml:mi><mml:mi>I</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>The Tapqir generative model is a stochastic function that describes a properly normalized joint distribution for the data and all parameters (<xref ref-type="fig" rid="fig8">Figure 8</xref>). In Pyro this is called ‘the model’.</p></sec><sec id="s4-5"><title>Inference</title><p>For a Bayesian analysis, we want to obtain the posterior distribution for parameters <inline-formula><mml:math id="inf435"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> given the observed data <inline-formula><mml:math id="inf436"><mml:mi>D</mml:mi></mml:math></inline-formula>. There are three discrete parameters <inline-formula><mml:math id="inf437"><mml:mi>z</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf438"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf439"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> that can be marginalized out exactly so that they do not appear expilictly in either the joint posterior distribution or the likelihood function. Computationally efficient marginalization is implemented using Pyro’s enumeration strategy (<xref ref-type="bibr" rid="bib26">Obermeyer et al., 2019a</xref>) and KeOps’ kernel operations on the GPU without memory overflows (<xref ref-type="bibr" rid="bib4">Charlier et al., 2021</xref>). Let <inline-formula><mml:math id="inf440"><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> be the rest of the parameters. We obtain posterior distributions of <inline-formula><mml:math id="inf441"><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> using Bayes’ rule:<disp-formula id="equ20"><label>(19)</label><mml:math id="m20"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Note that the integral in the denominator of this expression is necessary to calculate the posterior distribution, but it is usually analytically intractable. However, variational inference provides a robust method to approximate the posterior distribution <inline-formula><mml:math id="inf442"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> with a parameterized variational distribution <inline-formula><mml:math id="inf443"><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib2">Bishop, 2006</xref>).<disp-formula id="equ21"><label>(20)</label><mml:math id="m21"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≃</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf444"><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> has the following factorization:<disp-formula id="equ22"><label>(21)</label><mml:math id="m22"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mtr><mml:mtd><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext> </mml:mtext></mml:mtd><mml:mtd><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi/><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:munder></mml:mphantom></mml:mpadded></mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>h</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>w</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>The variational distribution <inline-formula><mml:math id="inf445"><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is provided as pseudocode for a generative stochastic function (<xref ref-type="fig" rid="fig9">Figure 9</xref>). In Pyro this is called ‘the guide’. Variational inference is sensitive to initial values of variational parameters. In <xref ref-type="fig" rid="fig9">Figure 9</xref>, step 1 we provide the initial values of variational parameters used in our analyses.</p><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>Pseudocode representation of <italic>cosmos</italic> guide.</title><p><supplementary-material id="fig9sdata1"><label>Figure 9—source data 1.</label><caption><title>Original text for <xref ref-type="fig" rid="fig9">Figure 9</xref>.</title></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-73860-fig9-data1-v2.pdf"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73860-fig9-v2.tif"/></fig></sec><sec id="s4-6"><title>Calculation of spot probabilities</title><p>Variational inference directly optimizes <inline-formula><mml:math id="inf446"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≡</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">b</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (see <xref ref-type="disp-formula" rid="equ22">Eq. 21</xref> and <xref ref-type="fig" rid="fig9">Figure 9</xref>), which approximates <inline-formula><mml:math id="inf447"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. To obtain the marginal posterior probabilities <inline-formula><mml:math id="inf448"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, we use a Monte Carlo sampling method:<disp-formula id="equ23"><label>(22)</label><mml:math id="m23"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>≃</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mi>S</mml:mi></mml:mfrac></mml:mstyle><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mspace width="1em"/><mml:mtext>where</mml:mtext><mml:mspace width="1em"/><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>In our calculations, we used <inline-formula><mml:math id="inf449"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 25 as the number of Monte Carlo samples. Marginal probabilities <inline-formula><mml:math id="inf450"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf451"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> are calculated as:<disp-formula id="equ24"><label>(23a)</label><mml:math id="m24"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ25"><label>(23b)</label><mml:math id="m25"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The probability, <inline-formula><mml:math id="inf452"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, that a target-specific fluorescence spot is present in a given image by definition is:<disp-formula id="equ26"><label>(24)</label><mml:math id="m26"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>≡</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>For simplicity in the main text and figures we suppress the conditional dependency on <inline-formula><mml:math id="inf453"><mml:mi>D</mml:mi></mml:math></inline-formula> in <inline-formula><mml:math id="inf454"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf455"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and instead write them as <inline-formula><mml:math id="inf456"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf457"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, respectively.</p></sec><sec id="s4-7"><title>Tapqir implementation</title><p>The model and variational inference method outlined above are implemented as a probabilistic program in the Python-based probabilistic programming language (PPL) Pyro (<xref ref-type="bibr" rid="bib8">Foerster et al., 2018</xref>; <xref ref-type="bibr" rid="bib1">Bingham et al., 2019</xref>; <xref ref-type="bibr" rid="bib26">Obermeyer et al., 2019a</xref>). We use a variational approximation because exact inference is not analytically tractable for a model as complex as <italic>cosmos</italic>. As currently implemented in Pyro, variational inference is significantly faster than Monte Carlo inference methods. In Tapqir, the objective that is being optimized is the evidence lower bound (ELBO) estimator that provides unbiased gradient estimates upon differentiation. At each iteration of inference procedure we choose a random subset of AOIs and frames (mini-batch), compute a differentiable ELBO estimate based on this mini-batch and update the variational parameters via automatic differentiation. We use PyTorch’s Adam optimizer (<xref ref-type="bibr" rid="bib17">Kingma and Ba, 2014</xref>) with the learning rate of <inline-formula><mml:math id="inf458"><mml:mrow><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and keep other parameters at their default values.</p></sec><sec id="s4-8"><title>Credible intervals and confidence intervals</title><p>Credible intervals were calculated from posterior distribution samples as the highest density region (HDR), the narrowest interval with probability mass 95% using the pyro.ops.stats.hpdi Pyro function. Confidence intervals were calculated from bootstrap samples as the 95% HDR.</p></sec><sec id="s4-9"><title>Data simulation</title><p>Simulated data were produced using the generative model (<xref ref-type="fig" rid="fig8">Figure 8</xref>). Each simulation has a subset of parameters (<inline-formula><mml:math id="inf459"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>λ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf460"><mml:mi>g</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf461"><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="inf462"><mml:mi>b</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf463"><mml:mi>h</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf464"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>δ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) set to desired values while the remaining parameters (<inline-formula><mml:math id="inf465"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf466"><mml:mi>m</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf467"><mml:mi>x</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf468"><mml:mi>y</mml:mi></mml:math></inline-formula>) and resulting noisy images (<inline-formula><mml:math id="inf469"><mml:mi>D</mml:mi></mml:math></inline-formula>) are sampled from distributions. The fixed parameter values and data set sizes for all simulations are provided in<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>; <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>; <xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref>; <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>; <xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref>; <xref ref-type="supplementary-material" rid="supp6">Supplementary file 6</xref>.</p><p>For kinetic simulations (<xref ref-type="fig" rid="fig5">Figure 5</xref>, <xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref>), <inline-formula><mml:math id="inf470"><mml:mi>z</mml:mi></mml:math></inline-formula> was modeled using a discrete Markov process with the initial probability and the transition probability matrices:<disp-formula id="equ27"><label>(25a)</label><mml:math id="m27"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">g</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">c</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">l</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mfrac><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mfrac><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ28"><label>(25b)</label><mml:math id="m28"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">g</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">c</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">l</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf471"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf472"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> are transition probabilities that numerically approximate the pseudo-first-order binding and first-order dissociation rate constants in units of <inline-formula><mml:math id="inf473"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, respectively, assuming 1 s/frame. We assumed that the Markov process is at equilibrium and initialized the chain with the equilibrium probabilities.</p></sec><sec id="s4-10"><title>Posterior predictive sampling</title><p>For posterior predictive checking, sampled images (<inline-formula><mml:math id="inf474"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula>) were produced using Tapqir’s generative model (<xref ref-type="fig" rid="fig8">Figure 8</xref>) where model parameters were sampled from the posterior distribution <inline-formula><mml:math id="inf475"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which was approximated by the variational distribution <inline-formula><mml:math id="inf476"><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ29"><label>(26)</label><mml:math id="m29"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mi>D</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mo>∼</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>D</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:msub><mml:mo>∫</mml:mo><mml:mi>ϕ</mml:mi></mml:msub><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>D</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>ϕ</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi/><mml:mo>≃</mml:mo><mml:msub><mml:mo>∫</mml:mo><mml:mi>ϕ</mml:mi></mml:msub><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>D</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>ϕ</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p></sec><sec id="s4-11"><title>Signal-to-noise ratio</title><p>We define SNR as:<disp-formula id="equ30"><label>(27)</label><mml:math id="m30"><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">S</mml:mi><mml:mi mathvariant="sans-serif">N</mml:mi><mml:mi mathvariant="sans-serif">R</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi></mml:mrow><mml:msqrt><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">b</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">k</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">u</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi><mml:mi mathvariant="sans-serif">d</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt></mml:mfrac></mml:mstyle><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf477"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">b</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">k</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">u</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi><mml:mi mathvariant="sans-serif">d</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>⋅</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> the variance of the background intensity, <inline-formula><mml:math id="inf478"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> the variance of the offset intensity, and the mean is taken over all target-specific spots. For experimental data, <inline-formula><mml:math id="inf479"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is calculated as<disp-formula id="equ31"><label>(28)</label><mml:math id="m31"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnspacing="0em" displaystyle="false" rowspacing="0.1em"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">X</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">Y</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">w</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">h</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf480"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">w</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">h</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is<disp-formula id="equ32"><label>(29)</label><mml:math id="m32"><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">w</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">h</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>⋅</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mstyle><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">t</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">t</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>For simulated data theoretical <inline-formula><mml:math id="inf481"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is directly calculated as:<disp-formula id="equ33"><label>(30)</label><mml:math id="m33"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnspacing="0em" displaystyle="false" rowspacing="0.1em"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">X</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">x</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">Y</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:munder><mml:mi>h</mml:mi><mml:mo>⋅</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">w</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">g</mml:mi><mml:mi mathvariant="sans-serif">h</mml:mi><mml:mi mathvariant="sans-serif">t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p></sec><sec id="s4-12"><title>Classification accuracy statistics</title><p>As a metric of classification accuracy we use three commonly used statistics – recall, precision, and Matthews Correlation Coefficient (<xref ref-type="bibr" rid="bib23">Matthews, 1975</xref>)<disp-formula id="equ34"><label>(31)</label><mml:math id="m34"><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">R</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi><mml:mi mathvariant="sans-serif">l</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="sans-serif">T</mml:mi><mml:mi mathvariant="sans-serif">P</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">T</mml:mi><mml:mi mathvariant="sans-serif">P</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">F</mml:mi><mml:mi mathvariant="sans-serif">N</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ35"><label>(32)</label><mml:math id="m35"><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">P</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="sans-serif">T</mml:mi><mml:mi mathvariant="sans-serif">P</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">T</mml:mi><mml:mi mathvariant="sans-serif">P</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">F</mml:mi><mml:mi mathvariant="sans-serif">P</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ36"><label>(33)</label><mml:math id="m36"><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">M</mml:mi><mml:mi mathvariant="sans-serif">C</mml:mi><mml:mi mathvariant="sans-serif">C</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">T</mml:mi><mml:mi mathvariant="sans-serif">P</mml:mi></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">T</mml:mi><mml:mi mathvariant="sans-serif">N</mml:mi></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">F</mml:mi><mml:mi mathvariant="sans-serif">P</mml:mi></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">F</mml:mi><mml:mi mathvariant="sans-serif">N</mml:mi></mml:mrow></mml:mrow><mml:msqrt><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">T</mml:mi><mml:mi mathvariant="sans-serif">P</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">F</mml:mi><mml:mi mathvariant="sans-serif">P</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">T</mml:mi><mml:mi mathvariant="sans-serif">P</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">F</mml:mi><mml:mi mathvariant="sans-serif">N</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">T</mml:mi><mml:mi mathvariant="sans-serif">N</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">F</mml:mi><mml:mi mathvariant="sans-serif">P</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">T</mml:mi><mml:mi mathvariant="sans-serif">N</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">F</mml:mi><mml:mi mathvariant="sans-serif">N</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:msqrt></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where TP is true positives, TN is true negatives, FP is false positives, and FN is false negatives.</p></sec><sec id="s4-13"><title>Kinetic and thermodynamic analysis</title><p>To estimate simple binding/dissociation kinetic parameters (<xref ref-type="fig" rid="fig5">Figure 5C and D</xref>), we sample binary time records <inline-formula><mml:math id="inf482"><mml:mi>z</mml:mi></mml:math></inline-formula> from the inferred <inline-formula><mml:math id="inf483"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> time records for all AOIs. For a two-state hidden Markov model, the maximum-likelihood estimates of <inline-formula><mml:math id="inf484"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf485"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> are given by:<disp-formula id="equ37"><label>(34)</label><mml:math id="m37"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>k</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>k</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mi>argmax</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mo>⁡</mml:mo><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi><mml:mi mathvariant="sans-serif">O</mml:mi><mml:mi mathvariant="sans-serif">I</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">r</mml:mi><mml:mi mathvariant="sans-serif">a</mml:mi><mml:mi mathvariant="sans-serif">m</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Repeating this procedure 2,000 times gave the distributions of <inline-formula><mml:math id="inf486"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf487"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">o</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> from which we compute mean and 95% credible interval.</p><p>Similarly, to estimate mean and 95% CI of <inline-formula><mml:math id="inf488"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">q</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig5">Figure 5E</xref>) we sampled π from <inline-formula><mml:math id="inf489"><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and for each sampled value of <inline-formula><mml:math id="inf490"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> calculated <inline-formula><mml:math id="inf491"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">q</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> as:<disp-formula id="equ38"><label>(35)</label><mml:math id="m38"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">q</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>To calculate time-to-first binding kinetics from the Tapqir-derived <inline-formula><mml:math id="inf492"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig6">Figure 6B</xref>, <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1B</xref>, <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2B</xref>, and <xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3B</xref>), 2,000 binary time records <inline-formula><mml:math id="inf493"><mml:mi>z</mml:mi></mml:math></inline-formula> were sampled from the <inline-formula><mml:math id="inf494"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">s</mml:mi><mml:mi mathvariant="sans-serif">p</mml:mi><mml:mi mathvariant="sans-serif">e</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">f</mml:mi><mml:mi mathvariant="sans-serif">i</mml:mi><mml:mi mathvariant="sans-serif">c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> time record for each AOI. For each sampled time record initial absent intervals were measured and analyzed using Equation 7 in <xref ref-type="bibr" rid="bib12">Friedman and Gelles, 2015</xref>, yielding distributions of <inline-formula><mml:math id="inf495"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">a</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf496"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">n</mml:mi><mml:mi mathvariant="sans-serif">s</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf497"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Mean value and 95% credible intervals were calculated from these distributions. Initial absent intervals from ‘spot-picker’ analysis (<xref ref-type="fig" rid="fig6">Figure 6C</xref>, <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1C</xref>, <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2C</xref>, and <xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3C</xref>) were analyzed as described in <xref ref-type="bibr" rid="bib12">Friedman and Gelles, 2015</xref>, except that on-target and off-target data were here analyzed jointly instead of being analyzed sequentially (<xref ref-type="bibr" rid="bib12">Friedman and Gelles, 2015</xref>). Note that the <inline-formula><mml:math id="inf498"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">n</mml:mi><mml:mi mathvariant="sans-serif">s</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> values determined using the two methods are not directly comparable for several reasons, including that the non-specific binding frequencies are effectively measured over different areas. For Tapqir, the target area is approximately <inline-formula><mml:math id="inf499"><mml:mrow><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> (which is between 0.3 and 0.8 pixels<sup>2</sup> in the different experimental data sets) and for spot-picker the area is subjectively chosen as <inline-formula><mml:math id="inf500"><mml:mrow><mml:mrow><mml:mi>π</mml:mi><mml:mo>⋅</mml:mo><mml:msup><mml:mn>1.5</mml:mn><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math></inline-formula> pixels<sup>2</sup>.</p></sec></sec></body><back><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Investigation, Methodology, Software, Supervision, Validation, Visualization, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Data curation, Investigation, Resources, Software, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Funding acquisition, Supervision, Writing - review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Funding acquisition, Methodology, Supervision, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Varying non-specific binding rate simulation parameters and corresponding fit values.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-73860-supp1-v2.xlsx"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>Randomized simulation parameters and corresponding fit values.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-73860-supp2-v2.xlsx"/></supplementary-material><supplementary-material id="supp3"><label>Supplementary file 3.</label><caption><title>Varying intensity (SNR) simulation parameters and corresponding fit values.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-73860-supp3-v2.xlsx"/></supplementary-material><supplementary-material id="supp4"><label>Supplementary file 4.</label><caption><title>No target-specific binding and varying non-specific binding rate simulation parameters and corresponding fit values.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-73860-supp4-v2.xlsx"/></supplementary-material><supplementary-material id="supp5"><label>Supplementary file 5.</label><caption><title>Kinetic simulation parameters and corresponding fit values.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-73860-supp5-v2.xlsx"/></supplementary-material><supplementary-material id="supp6"><label>Supplementary file 6.</label><caption><title>Varying proximity simulation parameters and corresponding fit values.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-73860-supp6-v2.xlsx"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-73860-transrepform1-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All data generated or analyzed for this study will be available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ordabayevy/tapqir-overleaf">https://github.com/ordabayevy/tapqir-overleaf</ext-link>. That repository also includes all figures, figure supplements, and the scripts and data used to generate them. It also contains the supplemental data files and preprint manuscript text.</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Ordabayev</surname><given-names>YA</given-names></name><name><surname>Friedman</surname><given-names>LJ</given-names></name><name><surname>Gelles</surname><given-names>J</given-names></name><name><surname>Theobald</surname><given-names>DL</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Simulated and experimental data used for &quot;Bayesian machine learning analysis of single-molecule fluorescence colocalization images&quot;</data-title><source>Github</source><pub-id pub-id-type="accession" xlink:href="https://github.com/ordabayevy/tapqir-overleaf">ordabayevy/tapqir-overleaf</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>This work was supported by grants R01GM121384 and R01GM081648 from the National Institute of General Medical Sciences, NIH. We thank Alex Okonechnikov for his work on an earlier version of this project. We thank Jane Kondev, Timothy M Lohman, and Timothy O Street for helpful comments on the manuscript.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bingham</surname><given-names>E</given-names></name><name><surname>Chen</surname><given-names>JP</given-names></name><name><surname>Jankowiak</surname><given-names>M</given-names></name><name><surname>Obermeyer</surname><given-names>F</given-names></name><name><surname>Pradhan</surname><given-names>N</given-names></name><name><surname>Karaletsos</surname><given-names>T</given-names></name><name><surname>Singh</surname><given-names>R</given-names></name><name><surname>Szerlip</surname><given-names>P</given-names></name><name><surname>Horsfall</surname><given-names>P</given-names></name><name><surname>Goodman</surname><given-names>ND</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Pyro: Deep universal probabilistic programming</article-title><source>Journal of Machine Learning Research: JMLR</source><volume>20</volume><fpage>1</fpage><lpage>6</lpage></element-citation></ref><ref id="bib2"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bishop</surname><given-names>CM</given-names></name></person-group><year iso-8601-date="2006">2006</year><source>Pattern Recognition and Machine Learning</source><publisher-loc>New York</publisher-loc><publisher-name>Springer</publisher-name></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breitsprecher</surname><given-names>D</given-names></name><name><surname>Jaiswal</surname><given-names>R</given-names></name><name><surname>Bombardier</surname><given-names>JP</given-names></name><name><surname>Gould</surname><given-names>CJ</given-names></name><name><surname>Gelles</surname><given-names>J</given-names></name><name><surname>Goode</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Rocket launcher mechanism of collaborative actin assembly defined by single-molecule imaging</article-title><source>Science (New York, N.Y.)</source><volume>336</volume><fpage>1164</fpage><lpage>1168</lpage><pub-id pub-id-type="doi">10.1126/science.1218062</pub-id><pub-id pub-id-type="pmid">22654058</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Charlier</surname><given-names>B</given-names></name><name><surname>Feydy</surname><given-names>J</given-names></name><name><surname>Glaunès</surname><given-names>JA</given-names></name><name><surname>Collin</surname><given-names>FD</given-names></name><name><surname>Durif</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Kernel operations on the GPU, with autodiff, without memory overflows</article-title><source>Journal of Machine Learning Research: JMLR</source><volume>22</volume><fpage>1</fpage><lpage>6</lpage></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Dalal</surname><given-names>RV</given-names></name><name><surname>Petrov</surname><given-names>AN</given-names></name><name><surname>Tsai</surname><given-names>A</given-names></name><name><surname>O’Leary</surname><given-names>SE</given-names></name><name><surname>Chapin</surname><given-names>K</given-names></name><name><surname>Cheng</surname><given-names>J</given-names></name><name><surname>Ewan</surname><given-names>M</given-names></name><name><surname>Hsiung</surname><given-names>PL</given-names></name><name><surname>Lundquist</surname><given-names>P</given-names></name><name><surname>Turner</surname><given-names>SW</given-names></name><name><surname>Hsu</surname><given-names>DR</given-names></name><name><surname>Puglisi</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>High-throughput platform for real-time monitoring of biological processes by multicolor single-molecule fluorescence</article-title><source>PNAS</source><volume>111</volume><fpage>664</fpage><lpage>669</lpage><pub-id pub-id-type="doi">10.1073/pnas.1315735111</pub-id><pub-id pub-id-type="pmid">24379388</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Chiang</surname><given-names>D</given-names></name><name><surname>Rush</surname><given-names>AM</given-names></name><name><surname>Barak</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Named Tensor Notation</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/2102.13196">https://arxiv.org/abs/2102.13196</ext-link></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fawcett</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>An introduction to ROC analysis</article-title><source>Pattern Recognition Letters</source><volume>27</volume><fpage>861</fpage><lpage>874</lpage><pub-id pub-id-type="doi">10.1016/j.patrec.2005.10.010</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Foerster</surname><given-names>J</given-names></name><name><surname>Farquhar</surname><given-names>G</given-names></name><name><surname>Al-Shedivat</surname><given-names>M</given-names></name><name><surname>Rocktäschel</surname><given-names>T</given-names></name><name><surname>Xing</surname><given-names>EP</given-names></name><name><surname>Whiteson</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>DiCE: The Infinitely Differentiable Monte-Carlo Estimator</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1802.05098">https://arxiv.org/abs/1802.05098</ext-link></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friedman</surname><given-names>LJ</given-names></name><name><surname>Chung</surname><given-names>J</given-names></name><name><surname>Gelles</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Viewing dynamic assembly of molecular complexes by multi-wavelength single-molecule fluorescence</article-title><source>Biophysical Journal</source><volume>91</volume><fpage>1023</fpage><lpage>1031</lpage><pub-id pub-id-type="doi">10.1529/biophysj.106.084004</pub-id><pub-id pub-id-type="pmid">16698779</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friedman</surname><given-names>LJ</given-names></name><name><surname>Gelles</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Mechanism of transcription initiation at an activator-dependent promoter defined by single-molecule observation</article-title><source>Cell</source><volume>148</volume><fpage>679</fpage><lpage>689</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2012.01.018</pub-id><pub-id pub-id-type="pmid">22341441</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friedman</surname><given-names>LJ</given-names></name><name><surname>Mumm</surname><given-names>JP</given-names></name><name><surname>Gelles</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>RNA polymerase approaches its promoter without long-range sliding along DNA</article-title><source>PNAS</source><volume>110</volume><fpage>9740</fpage><lpage>9745</lpage><pub-id pub-id-type="doi">10.1073/pnas.1300221110</pub-id><pub-id pub-id-type="pmid">23720315</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friedman</surname><given-names>LJ</given-names></name><name><surname>Gelles</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Multi-wavelength single-molecule fluorescence analysis of transcription mechanisms</article-title><source>Methods (San Diego, Calif.)</source><volume>86</volume><fpage>27</fpage><lpage>36</lpage><pub-id pub-id-type="doi">10.1016/j.ymeth.2015.05.026</pub-id><pub-id pub-id-type="pmid">26032816</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geertsema</surname><given-names>HJ</given-names></name><name><surname>Kulczyk</surname><given-names>AW</given-names></name><name><surname>Richardson</surname><given-names>CC</given-names></name><name><surname>van Oijen</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Single-molecule studies of polymerase dynamics and stoichiometry at the bacteriophage T7 replication machinery</article-title><source>PNAS</source><volume>111</volume><fpage>4073</fpage><lpage>4078</lpage><pub-id pub-id-type="doi">10.1073/pnas.1402010111</pub-id><pub-id pub-id-type="pmid">24591606</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gelman</surname><given-names>A</given-names></name><name><surname>Carlin</surname><given-names>JB</given-names></name><name><surname>Stern</surname><given-names>HS</given-names></name><name><surname>Dunson</surname><given-names>DB</given-names></name><name><surname>Vehtari</surname><given-names>A</given-names></name><name><surname>Rubin</surname><given-names>DB</given-names></name></person-group><year iso-8601-date="2013">2013</year><source>Chapman and Hall/CRC Texts in Statistical Science</source><publisher-loc>Philadelphia</publisher-loc><publisher-name>CRC Press</publisher-name><pub-id pub-id-type="doi">10.1201/b16018</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>F</given-names></name><name><surname>Hartwich</surname><given-names>TMP</given-names></name><name><surname>Rivera-Molina</surname><given-names>FE</given-names></name><name><surname>Lin</surname><given-names>Y</given-names></name><name><surname>Duim</surname><given-names>WC</given-names></name><name><surname>Long</surname><given-names>JJ</given-names></name><name><surname>Uchil</surname><given-names>PD</given-names></name><name><surname>Myers</surname><given-names>JR</given-names></name><name><surname>Baird</surname><given-names>MA</given-names></name><name><surname>Mothes</surname><given-names>W</given-names></name><name><surname>Davidson</surname><given-names>MW</given-names></name><name><surname>Toomre</surname><given-names>D</given-names></name><name><surname>Bewersdorf</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Video-rate nanoscopy using sCMOS camera-specific single-molecule localization algorithms</article-title><source>Nature Methods</source><volume>10</volume><fpage>653</fpage><lpage>658</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2488</pub-id><pub-id pub-id-type="pmid">23708387</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>H</given-names></name><name><surname>Abeysirigunawarden</surname><given-names>SC</given-names></name><name><surname>Chen</surname><given-names>K</given-names></name><name><surname>Mayerle</surname><given-names>M</given-names></name><name><surname>Ragunathan</surname><given-names>K</given-names></name><name><surname>Luthey-Schulten</surname><given-names>Z</given-names></name><name><surname>Ha</surname><given-names>T</given-names></name><name><surname>Woodson</surname><given-names>SA</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Protein-guided RNA dynamics during early ribosome assembly</article-title><source>Nature</source><volume>506</volume><fpage>334</fpage><lpage>338</lpage><pub-id pub-id-type="doi">10.1038/nature13039</pub-id><pub-id pub-id-type="pmid">24522531</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Kingma</surname><given-names>DP</given-names></name><name><surname>Ba</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Adam: A Method for Stochastic Optimization</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1412.6980">https://arxiv.org/abs/1412.6980</ext-link></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kinz-Thompson</surname><given-names>CD</given-names></name><name><surname>Ray</surname><given-names>KK</given-names></name><name><surname>Gonzalez</surname><given-names>RL</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Bayesian Inference: The Comprehensive Approach to Analyzing Single-Molecule Experiments</article-title><source>Annual Review of Biophysics</source><volume>50</volume><fpage>191</fpage><lpage>208</lpage><pub-id pub-id-type="doi">10.1146/annurev-biophys-082120-103921</pub-id><pub-id pub-id-type="pmid">33534607</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krishnan</surname><given-names>R</given-names></name><name><surname>Blanco</surname><given-names>MR</given-names></name><name><surname>Kahlscheuer</surname><given-names>ML</given-names></name><name><surname>Abelson</surname><given-names>J</given-names></name><name><surname>Guthrie</surname><given-names>C</given-names></name><name><surname>Walter</surname><given-names>NG</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Biased Brownian ratcheting leads to pre-mRNA remodeling and capture prior to first-step splicing</article-title><source>Nature Structural &amp; Molecular Biology</source><volume>20</volume><fpage>1450</fpage><lpage>1457</lpage><pub-id pub-id-type="doi">10.1038/nsmb.2704</pub-id><pub-id pub-id-type="pmid">24240612</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larson</surname><given-names>J</given-names></name><name><surname>Kirk</surname><given-names>M</given-names></name><name><surname>Drier</surname><given-names>EA</given-names></name><name><surname>O’Brien</surname><given-names>W</given-names></name><name><surname>MacKay</surname><given-names>JF</given-names></name><name><surname>Friedman</surname><given-names>LJ</given-names></name><name><surname>Hoskins</surname><given-names>AA</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Design and construction of a multiwavelength, micromirror total internal reflectance fluorescence microscope</article-title><source>Nature Protocols</source><volume>9</volume><fpage>2317</fpage><lpage>2328</lpage><pub-id pub-id-type="doi">10.1038/nprot.2014.155</pub-id><pub-id pub-id-type="pmid">25188633</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>Y</given-names></name><name><surname>Lee</surname><given-names>B</given-names></name><name><surname>King</surname><given-names>RW</given-names></name><name><surname>Finley</surname><given-names>D</given-names></name><name><surname>Kirschner</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2015">2015a</year><article-title>Substrate degradation by the proteasome: a single-molecule kinetic analysis</article-title><source>Science (New York, N.Y.)</source><volume>348</volume><elocation-id>1250834</elocation-id><pub-id pub-id-type="doi">10.1126/science.1250834</pub-id><pub-id pub-id-type="pmid">25859050</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>W</given-names></name><name><surname>Kirschner</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2015">2015b</year><article-title>Specificity of the anaphase-promoting complex: a single-molecule study</article-title><source>Science (New York, N.Y.)</source><volume>348</volume><elocation-id>1248737</elocation-id><pub-id pub-id-type="doi">10.1126/science.1248737</pub-id><pub-id pub-id-type="pmid">25859049</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matthews</surname><given-names>BW</given-names></name></person-group><year iso-8601-date="1975">1975</year><article-title>Comparison of the predicted and observed secondary structure of T4 phage lysozyme</article-title><source>Biochimica et Biophysica Acta</source><volume>405</volume><fpage>442</fpage><lpage>451</lpage><pub-id pub-id-type="doi">10.1016/0005-2795(75)90109-9</pub-id><pub-id pub-id-type="pmid">1180967</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Noriega</surname><given-names>TR</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Walter</surname><given-names>P</given-names></name><name><surname>Puglisi</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Real-time observation of signal recognition particle binding to actively translating ribosomes</article-title><source>eLife</source><volume>3</volume><elocation-id>e04418</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.04418</pub-id><pub-id pub-id-type="pmid">25358118</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ober</surname><given-names>RJ</given-names></name><name><surname>Tahmasbi</surname><given-names>A</given-names></name><name><surname>Ram</surname><given-names>S</given-names></name><name><surname>Lin</surname><given-names>Z</given-names></name><name><surname>Ward</surname><given-names>ES</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Quantitative Aspects of Single Molecule Microscopy</article-title><source>IEEE Signal Processing Magazine</source><volume>32</volume><fpage>58</fpage><lpage>69</lpage><pub-id pub-id-type="doi">10.1109/MSP.2014.2353664</pub-id><pub-id pub-id-type="pmid">26167102</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Obermeyer</surname><given-names>F</given-names></name><name><surname>Bingham</surname><given-names>E</given-names></name><name><surname>Jankowiak</surname><given-names>M</given-names></name><name><surname>Chiu</surname><given-names>J</given-names></name><name><surname>Pradhan</surname><given-names>N</given-names></name><name><surname>Rush</surname><given-names>A</given-names></name><name><surname>Goodman</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2019">2019a</year><article-title>Tensor Variable Elimination for Plated Factor Graphs</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1902.03210">https://arxiv.org/abs/1902.03210</ext-link></element-citation></ref><ref id="bib27"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Obermeyer</surname><given-names>F</given-names></name><name><surname>Bingham</surname><given-names>E</given-names></name><name><surname>Jankowiak</surname><given-names>M</given-names></name><name><surname>Phan</surname><given-names>D</given-names></name><name><surname>Chen</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="2019">2019b</year><article-title>Functional Tensors for Probabilistic Programming</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1910.10775">https://arxiv.org/abs/1910.10775</ext-link></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O’Leary</surname><given-names>SE</given-names></name><name><surname>Petrov</surname><given-names>A</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Puglisi</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Dynamic recognition of the mRNA cap by <italic>Saccharomyces cerevisiae</italic> eIF4E</article-title><source>Structure (London, England</source><volume>21</volume><fpage>2197</fpage><lpage>2207</lpage><pub-id pub-id-type="doi">10.1016/j.str.2013.09.016</pub-id><pub-id pub-id-type="pmid">24183571</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peng</surname><given-names>S</given-names></name><name><surname>Wang</surname><given-names>W</given-names></name><name><surname>Chen</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Breaking the Concentration Barrier for Single-Molecule Fluorescence Measurements</article-title><source>Chemistry (Weinheim an Der Bergstrasse, Germany)</source><volume>24</volume><fpage>1002</fpage><lpage>1009</lpage><pub-id pub-id-type="doi">10.1002/chem.201704065</pub-id><pub-id pub-id-type="pmid">29044746</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosen</surname><given-names>GA</given-names></name><name><surname>Baek</surname><given-names>I</given-names></name><name><surname>Friedman</surname><given-names>LJ</given-names></name><name><surname>Joo</surname><given-names>YJ</given-names></name><name><surname>Buratowski</surname><given-names>S</given-names></name><name><surname>Gelles</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Dynamics of RNA polymerase II and elongation factor Spt4/5 recruitment during activator-dependent transcription</article-title><source>PNAS</source><volume>117</volume><fpage>32348</fpage><lpage>32357</lpage><pub-id pub-id-type="doi">10.1073/pnas.2011224117</pub-id><pub-id pub-id-type="pmid">33293419</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roy</surname><given-names>R</given-names></name><name><surname>Hohng</surname><given-names>S</given-names></name><name><surname>Ha</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>A practical guide to single-molecule FRET</article-title><source>Nature Methods</source><volume>5</volume><fpage>507</fpage><lpage>516</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1208</pub-id><pub-id pub-id-type="pmid">18511918</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salomon</surname><given-names>WE</given-names></name><name><surname>Jolly</surname><given-names>SM</given-names></name><name><surname>Moore</surname><given-names>MJ</given-names></name><name><surname>Zamore</surname><given-names>PD</given-names></name><name><surname>Serebrov</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Single-Molecule Imaging Reveals that Argonaute Reshapes the Binding Properties of Its Nucleic Acid Guides</article-title><source>Cell</source><volume>162</volume><fpage>84</fpage><lpage>95</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.06.029</pub-id><pub-id pub-id-type="pmid">26140592</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Särkkä</surname><given-names>S</given-names></name><name><surname>García-Fernández</surname><given-names>ÁF</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Temporal Parallelization of Bayesian Smoothers</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1905.13002">https://arxiv.org/abs/1905.13002</ext-link></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shcherbakova</surname><given-names>I</given-names></name><name><surname>Hoskins</surname><given-names>AA</given-names></name><name><surname>Friedman</surname><given-names>LJ</given-names></name><name><surname>Serebrov</surname><given-names>V</given-names></name><name><surname>Corrêa</surname><given-names>IR</given-names><suffix>Jr</suffix></name><name><surname>Xu</surname><given-names>M-Q</given-names></name><name><surname>Gelles</surname><given-names>J</given-names></name><name><surname>Moore</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Alternative spliceosome assembly pathways revealed by single-molecule fluorescence microscopy</article-title><source>Cell Reports</source><volume>5</volume><fpage>151</fpage><lpage>165</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2013.08.026</pub-id><pub-id pub-id-type="pmid">24075986</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>BA</given-names></name><name><surname>Padrick</surname><given-names>SB</given-names></name><name><surname>Doolittle</surname><given-names>LK</given-names></name><name><surname>Daugherty-Clarke</surname><given-names>K</given-names></name><name><surname>Corrêa</surname><given-names>IR</given-names><suffix>Jr</suffix></name><name><surname>Xu</surname><given-names>M-Q</given-names></name><name><surname>Goode</surname><given-names>BL</given-names></name><name><surname>Rosen</surname><given-names>MK</given-names></name><name><surname>Gelles</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Three-color single molecule imaging shows WASP detachment from Arp2/3 complex triggers actin filament branch formation</article-title><source>eLife</source><volume>2</volume><elocation-id>e01008</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.01008</pub-id><pub-id pub-id-type="pmid">24015360</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>CS</given-names></name><name><surname>Stallinga</surname><given-names>S</given-names></name><name><surname>Lidke</surname><given-names>KA</given-names></name><name><surname>Rieger</surname><given-names>B</given-names></name><name><surname>Grunwald</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Probability-based particle detection that enables threshold-free and robust in vivo single-molecule tracking</article-title><source>Molecular Biology of the Cell</source><volume>26</volume><fpage>4057</fpage><lpage>4062</lpage><pub-id pub-id-type="doi">10.1091/mbc.E15-06-0448</pub-id><pub-id pub-id-type="pmid">26424801</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>CS</given-names></name><name><surname>Jouravleva</surname><given-names>K</given-names></name><name><surname>Huisman</surname><given-names>M</given-names></name><name><surname>Jolly</surname><given-names>SM</given-names></name><name><surname>Zamore</surname><given-names>PD</given-names></name><name><surname>Grunwald</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>An automated Bayesian pipeline for rapid analysis of single-molecule binding data</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>272</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-08045-5</pub-id><pub-id pub-id-type="pmid">30655518</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tetone</surname><given-names>LE</given-names></name><name><surname>Friedman</surname><given-names>LJ</given-names></name><name><surname>Osborne</surname><given-names>ML</given-names></name><name><surname>Ravi</surname><given-names>H</given-names></name><name><surname>Kyzer</surname><given-names>S</given-names></name><name><surname>Stumper</surname><given-names>SK</given-names></name><name><surname>Mooney</surname><given-names>RA</given-names></name><name><surname>Landick</surname><given-names>R</given-names></name><name><surname>Gelles</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Dynamics of GreB-RNA polymerase interaction allow a proofreading accessory protein to patrol for transcription complexes needing rescue</article-title><source>PNAS</source><volume>114</volume><fpage>E1081</fpage><lpage>E1090</lpage><pub-id pub-id-type="doi">10.1073/pnas.1616525114</pub-id><pub-id pub-id-type="pmid">28137878</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ticau</surname><given-names>S</given-names></name><name><surname>Friedman</surname><given-names>LJ</given-names></name><name><surname>Ivica</surname><given-names>NA</given-names></name><name><surname>Gelles</surname><given-names>J</given-names></name><name><surname>Bell</surname><given-names>SP</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Single-molecule studies of origin licensing reveal mechanisms ensuring bidirectional helicase loading</article-title><source>Cell</source><volume>161</volume><fpage>513</fpage><lpage>525</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.03.012</pub-id><pub-id pub-id-type="pmid">25892223</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsai</surname><given-names>A</given-names></name><name><surname>Kornberg</surname><given-names>G</given-names></name><name><surname>Johansson</surname><given-names>M</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Puglisi</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The dynamics of SecM-induced translational stalling</article-title><source>Cell Reports</source><volume>7</volume><fpage>1521</fpage><lpage>1533</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2014.04.033</pub-id><pub-id pub-id-type="pmid">24836001</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>van de Meent</surname><given-names>JW</given-names></name><name><surname>Paige</surname><given-names>B</given-names></name><name><surname>Yang</surname><given-names>H</given-names></name><name><surname>Wood</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>An Introduction to Probabilistic Programming</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1809.10756">https://arxiv.org/abs/1809.10756</ext-link></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Oijen</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Single-molecule approaches to characterizing kinetics of biomolecular interactions</article-title><source>Current Opinion in Biotechnology</source><volume>22</volume><fpage>75</fpage><lpage>80</lpage><pub-id pub-id-type="doi">10.1016/j.copbio.2010.10.002</pub-id><pub-id pub-id-type="pmid">21036593</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>van Vliet</surname><given-names>LJ</given-names></name><name><surname>Sudar</surname><given-names>D</given-names></name><name><surname>Young</surname><given-names>IT</given-names></name></person-group><year iso-8601-date="1998">1998</year><chapter-title>Digital fluorescence imaging using cooled CCD array cameras invisible</chapter-title><person-group person-group-type="editor"><name><surname>Celis</surname><given-names>JE</given-names></name></person-group><source>Cell Biology</source><publisher-loc>New York</publisher-loc><publisher-name>Academic Press</publisher-name><fpage>109</fpage><lpage>120</lpage></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Caban</surname><given-names>K</given-names></name><name><surname>Gonzalez</surname><given-names>RL</given-names><suffix>Jr</suffix></name></person-group><year iso-8601-date="2015">2015</year><article-title>Ribosomal initiation complex-driven changes in the stability and dynamics of initiation factor 2 regulate the fidelity of translation initiation</article-title><source>Journal of Molecular Biology</source><volume>427</volume><fpage>1819</fpage><lpage>1834</lpage><pub-id pub-id-type="doi">10.1016/j.jmb.2014.12.025</pub-id><pub-id pub-id-type="pmid">25596426</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Warnasooriya</surname><given-names>C</given-names></name><name><surname>Rueda</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Single-molecule fluorescence-based studies on the dynamics, assembly and catalytic mechanism of the spliceosome</article-title><source>Biochemical Society Transactions</source><volume>42</volume><fpage>1211</fpage><lpage>1218</lpage><pub-id pub-id-type="doi">10.1042/BST20140105</pub-id><pub-id pub-id-type="pmid">25110027</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>B</given-names></name><name><surname>Zerubia</surname><given-names>J</given-names></name><name><surname>Olivo-Marin</surname><given-names>JC</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Gaussian approximations of fluorescence microscope point-spread function models</article-title><source>Applied Optics</source><volume>46</volume><fpage>1819</fpage><lpage>1829</lpage><pub-id pub-id-type="doi">10.1364/ao.46.001819</pub-id><pub-id pub-id-type="pmid">17356626</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Feng</surname><given-names>Y</given-names></name><name><surname>Chatterjee</surname><given-names>S</given-names></name><name><surname>Tuske</surname><given-names>S</given-names></name><name><surname>Ho</surname><given-names>MX</given-names></name><name><surname>Arnold</surname><given-names>E</given-names></name><name><surname>Ebright</surname><given-names>RH</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Structural basis of transcription initiation</article-title><source>Science (New York, N.Y.)</source><volume>338</volume><fpage>1076</fpage><lpage>1080</lpage><pub-id pub-id-type="doi">10.1126/science.1227786</pub-id><pub-id pub-id-type="pmid">23086998</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.73860.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Gonzalez</surname><given-names>Ruben L</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00hj8s172</institution-id><institution>Columbia University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><related-object id="sa0ro1" link-type="continued-by" object-id="10.1101/2021.09.30.462536" object-id-type="id" xlink:href="https://sciety.org/articles/activity/10.1101/2021.09.30.462536"/></front-stub><body><p>Using a Bayesian machine learning approach, the authors of this paper have developed a tool for the analysis of single-molecule fluorescence colocalization microscopy images. The authors develop the algorithm, generate an associated software program, and then benchmark the algorithm and software using both simulated and experimental data. The results provide an important, validated tool for use by the single-molecule fluorescence microscopy community.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.73860.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Gonzalez</surname><given-names>Ruben L</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00hj8s172</institution-id><institution>Columbia University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Kinz-Thompson</surname><given-names>Colin</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05vt9qd57</institution-id><institution>Rutgers</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2021.09.30.462536">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2021.09.30.462536v2.full">the preprint</ext-link> for the benefit of readers; ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Bayesian machine learning analysis of single-molecule fluorescence colocalization images&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation has been overseen by José Faraldo-Gómez as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Colin Kinz-Thompson (Reviewer #2).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>1) The γ-distributed noise model used in Tapqir captures quite a lot of physics and, given the analyses in Figures 3-6, clearly works, but might be limited to certain types of cameras used in the fluorescence microscopy (e.g., EMCCDs). For instance, sCMOS cameras have pixel-dependent amplification and noise profiles, rather than a single gain parameter, and are sometimes approximately modeled as normal distributions with both mean and variance having intensity-dependent and intensity-independent contributions that are different for each pixel on the camera. The authors should therefore address the question of whether Tapqir can also be used with data collected from different cameras and, specifically, sCMOS cameras.</p><p>2) Little information is included about the role of AOI selection. The authors should address the question of how precisely do AOI positions need to be determined and how accurate must the mapping be. Moreover, it appears that the authors use a very large AOI (14x14 pixels, page 18). The authors should therefore address what the dependency is of the analysis on the AOI size and the relative sizes of the AOI and diffraction-limited spots. The authors should also address the question of whether Tapqir can only be used on well-separated, non-overlapping AOIs.</p><p>3) The authors should test how the strength of the prior on the location of a specific binder affects the performance of Tapqir. Specifically, it would be very informative to know how the performance of Tapqir degrades as this prior is weakened. In other words, the authors should determine how weak this prior be made before the performance of Tapquir is compromised.</p><p>4) The premise of Tapqir assumes that there is no significant &quot;dark&quot; population of tethered molecules on the slide. While this may hold true for the commercially synthesized DNA oligos used in the example data in Table 1, many single-molecule experiments involve a large population of dark, tethered molecules due to incomplete labeling (50% is not uncommon). In these cases, the appropriate control for non-specific binding is a separate experiment in which no molecules or control molecules are tethered to the slide surface. The authors should address the question of whether Tapqir be used in these instances.</p><p>5) The head-to-head comparison with &quot;spot-picker&quot; is a bit unconvincing--how commonly is spot-picker being used outside the Gelles lab? A head-to-head comparison with the previously published methods developed by Grunwald would be much more revealing--particularly concerning the utility of having event detection probabilities and the time each analysis method takes to run on the same GPU.</p><p>6) The authors offer a new approach to analyzing single-molecule fluorescence colocalization data, yet they don't leverage the full strength of priors in stringing together experiments. Specifically, in their analyses, they mostly end up in a place where their software is recapitulating old analyses and not really leveraging the probabilities they have. The authors, therefore, need to make a clearer case for using the calculated event probabilities. In addition, if they made a subjective decision about what probability cut off to use to identify events for inclusion in the kinetic modeling then that seems to go counter to the objective-based analysis of Tapqir. Can the kinetic modeling include all of the events, weighted by their probabilities?</p><p>7) The authors should also respond to the additional concerns raised by the individual reviewers, included below.</p><p><italic>Reviewer #1 (Public Review):</italic></p><p>&quot;Bayesian machine learning analysis of single-molecule fluorescence colocalization images&quot; by Ordabayev, et al. reports the development, benchmarking, and testing of a Bayesian machine learning-based method, which the authors name Tapqir, for analyzing single-molecule fluorescence colocalization data. Unlike currently available, more conventional analysis methods, Tapqir attempts to holistically model the microscopy images that are recorded during a colocalization experiment. Tapir uses a physics-based, global model with parameters describing all of the features of the experiment that are expected to contribute to the recorded microscopy images, including shot noise of the spots and background, camera noise, size and shape of the spots, and specific- and non-specific binders. Based on benchmarking on simulated data with widely varying properties (e.g., signal-to-noise; amounts, rates, and locations of specific and non-specific binders; etc.), Tapqir generally does as well and, in some cases, better than currently existing methods. The authors also test Tapqir on real microscopy images with similarly varying properties from studies that have been previously published by their research group and demonstrate that their Tapqir-based analysis is able to faithfully reproduce the previously published results, which were obtained using the more conventional analysis methods available at the time the data were originally published. This is a well-designed and executed study, Tapqir represents a conceptual and practical advance in the analysis of single-molecule fluorescence colocalization experiments, and its performance has been comprehensively and rigorously benchmarked on simulated data and tested on real data. The conclusions of this study are well supported by the data, but some of the limitations of the method need to be clarified and discussed in more depth, as outlined below.</p><p>1. Given that the AOI is centered at the target molecule and there is a strong prior for the binder also being located at the center of the AOI, the performance of Tapqir is dependent on several variables of the microscopy/optical system (e.g., the microscope point-spread function, magnification, accurate alignment of target and binder imaging channels, accurate drift correction, etc.). Although this caveat is mentioned and some of these factors are listed in the main text of the manuscript, the authors could have expanded this discussion in order to clarify the extent to which the performance of Tapqir depends on these factors.</p><p>2. The Tapqir model has many parameters, each with its own prior. The majority of these priors are designed to be uninformative and/or weak and the only very strong prior is the probability that a specific binder is located at or very near the center of the AOI. The authors could have tested and commented on how the strength of the prior on the location of a specific binder affects the performance of Tapqir.</p><p>3. Given the priors and variational parameters they report, the authors show that Tapqir performs robustly and seems to require no experiment-to-experiment optimization. This is expected to be the case for the simulated data, since they were simulated using the same model that Tapqir uses to perform the analysis. With regard to the real data, however, it is quite likely that this is due to the fact that the analyzed data all come from the same laboratory and, therefore, likely the same microscope(s). It would have therefore been very useful if the authors would have listed and discussed which microscope settings, experimental conditions, and/or other considerations, beyond those described in point 1 above, would result in a need for re-optimization of the priors and/or variational parameters.</p><p>4. Based on analysis of the simulated data shown in Figure 5, where the ground truth is known, the use of Tapqir to infer kinetics is less accurate that the use of Tapqir to infer equilibrium binding constants. The authors do a great job of discussing possible reasons for this. In the case of the real data analyzed in Figure 6 and in Figure 6 —figure supplements 1 and 2, the kinetic results obtained using Tapqir have different means and generally larger error bars than those obtained using Spot-Picker. To more comprehensively assess the performance of Tapqir versus Spot-Picker, the authors could have used the association and dissociation rates to calculate the corresponding equilibrium binding constants and then compared these kinetically calculated equilibrium binding constants to the population-calculated equilibrium binding constants that the authors calculate and report in the bottom plot in Panel D of Figure 6 and Figure 6 —figure supplements 1 and 2. This would provide some information on the accuracy of the kinetics in that the closer the kinetically and population-calculated equilibrium binding constants are to each other, the more accurately the kinetics have been estimated. Performing this type of analysis for the kinetics obtained using Tapqir and Spot-Picker would have allowed a more comprehensive comparison of the two methods.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>This is a well-designed and executed study, Tapqir represents a conceptual and practical advance in the analysis of single-molecule fluorescence colocalization experiments, and its performance has been comprehensively and rigorously benchmarked on simulated data and tested on real data. Moreover, the conclusions of this study are well supported by the data. Given all of this, I would recommend publication of this study as a Tools and Resources article in <italic>eLife</italic>, assuming that the authors address the weaknesses I identified in my Public Review as well as the following extensions of those weaknesses.</p><p>1. I think the authors should to expand the discussion of how the performance of Tapqir depends on the microscope point-spread function, magnification, accurate alignment of target and binder imaging channels, accurate drift correction, etc. Specifically, if possible, they should describe how a 1-2 pixel offset in the x- or y dimensions between the target and binder imaging channels arising from differences in any of these parameters would affect the performance of Tapqir. This is especially important given the strength of the prior the authors have assigned to the location of the specific binder at the center of the AOI.</p><p>2. The authors should list and discuss what microscope settings, experimental conditions, and/or other considerations, beyond the microscope/optical described in point 1 above, would result in a need for re-optimization of the priors and/or variational parameters. For example, in Lines 509-510, the authors state that most microscopes used for colocalization experiments are set up such that diffraction-limited spots occupy 1-2 pixels in the x- and y dimensions on the camera detector. If a microscope is instead set up to spread the spot over 3, 4, or more pixels in each dimension, are there any priors or variational parameters that should be re-optimized? Are there any other such considerations?</p><p>4. The authors should comment on whether the kinetic parameters obtained by Tapqir and reported in Figure 6 and in Figure 6 —figure supplements 1 and 2 are actually more accurate and/or precise than those obtained by Spot-Picker. For example, if the association and dissociation rates were used to calculate the equilibrium binding constants, how would these kinetically calculated equilibrium binding constants compare to the population-calculated equilibrium constant that the authors calculate and report in Figure 6 and in Figure 6 —figure supplements 1 and 2? Are the kinetically calculated and population-calculated equilibrium binding constants in closer agreement for the Tapqir-analyzed data versus the Spot-Picker-analyzed data? If one is better than the other, why do the authors think that is?</p><p><italic>Reviewer 2 (Public Review):</italic></p><p>The work by Ordabayev et al. details a Bayesian inference-based data analysis method for colocalization single molecule spectroscopy (CoSMoS) experiments used to investigate biochemical and biophysical mechanisms. By using this probabilistic framework, their method is able to quantify the colocalization probabilities for individual molecules while accounting for the uncertainty in individual binding events, and accounting for camera and optical noise and even non-specific binding. The software implementation of this method, called Tapqir, uses a Python-based probabilistic programming language (PPL) called pyro to automate and speed-up the optimization of a variational Bayes approximation to the posterior probability distribution. Overall, Tapqir is a powerful new way to analyze CoSMoS data.</p><p>Tapqir works by analyzing small regions (14x14 pixels) of fluorescence microscopy images surrounding previously identified areas of interest (AOI). The collection of images of these AOIs through time are then analyzed collectively using a probabilistic model that accounts for each time frame of each AOI and is able to determine whether up to K &quot;binders&quot; (K=2 here) are present and which of them is specifically bound. This approach of directly modeling the contents of the image data is relatively novel, and few other examples exist. The details of the probabilistic model used incorporate an impressive amount of physical insight (e.g., camera gain) without overparameterization.</p><p>The γ-distributed noise model used in Tapqir captures quite a lot of physics and, given the analyses in Figures 3-6, clearly works, but might be limited to certain types of cameras used in the fluorescence microscopy (e.g., EMCCDs). For instance, sCMOS cameras have pixel-dependent amplification and noise profiles, rather than a single gain parameter, and are sometimes approximately modeled as normal distributions with both mean and variance having an intensity-dependent and independent contribution that is different for each pixel on the camera. It is unclear how Tapqir performs on different cameras.</p><p>The variational Bayes solution used by Tapqir provides many computational benefits, such as numerical tractability using pyro and speed. It is possible that the exact posterior, e.g., as obtained using a Markov chain Monte Carlo method, would be insignificantly different with the amount of data typical for CoSMoS experiments; however, this difference is not explored in the current work.</p><p>The intrinsic use of prior probability distributions in any Bayesian inference algorithm is extremely powerful, and in Tapqir offers the opportunity to &quot;chain together&quot; subsequent analyses by using the marginalized posteriors from one experiment as the basis for the priors for subsequent experiments (e.g., in \σ^{xy}) for extremely high accuracy inference. While the manuscript discusses setting and leveraging the power of priors, it does not explore the power of such &quot;chaining&quot; and the positive effects upon accuracy.</p><p>A significant number of CoSMoS experiments use multiple, distinct color fluorophores to probe the colocalization of different species to the target. The current work focuses only upon analyzing data with a single color-channel. Extensions to multiple independent wavelengths are computationally trivial, given the automated variational inference ability of PPLs such as pyro, and would increase the impact of the work in the field.</p><p>Tapqir analysis provides time series of the probability of a specific binding event, p(specific), for each target analyzed (c.f., Figure 5B), and kinetic parameters are extracted from these time series using secondary analyses that are distinct from Tapqir itself.</p><p>The method reported here is well designed, sound, and its utility is well supported by the analyses of simulated and experimental data sets reported here. Tapqir is a cutting-edge image analysis approach, and its proper treatment of the uncertainty inherent to CoSMoS experiments will certainly make an impact upon the analysis of CoSMoS data. However, many of the (necessary) assumptions about the data (e.g., fluorescence microscopy) and desired information (e.g., off-target vs on-target binding) are quite specific to CoSMoS experiments and therefore limit the direct applicability of Tapqir for the analysis of other single-molecule microscopy techniques. With that in mind, the direct Bayesian inference-based analysis of image data, as opposed to integrated time series, as demonstrated here is very powerful, and may encourage and inspire related methods to be developed.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>– Some of the language in the introduction is a little imprecise (e.g., &quot;binders&quot;, &quot;green RNA&quot;, &quot;blue DNA spot&quot;, &quot;integrating binder fluorescence&quot;, &quot;real fluorescent spots&quot;), and could be more explicit to improve clarity.</p><p>– Line 63: The concentration barrier could be described more in depth for the <italic>eLife</italic> readership.</p><p>– Line 74-76: Additional description of these effects, perhaps mathematically or through other citations, would help the readers understand the fundamental differences between analyzing image data and intensity data.</p><p>– Line 82-83: Describing how and/or the magnitude of the failure that not accounting for spot confidence creates would be useful for the reader to understand the requirement for Tapqir</p><p>– Line 84-86: The method described doesn't get a name, but the software does get a name. I think giving the method a descriptive name (e.g., an acronym) would help clarify the discussion and distinction between the approach of probabilistic modeling of the data and using pyro and the chosen priors etc. to do so.</p><p>– More referencing of Bayesian image analysis methods for microscopy data, at least in the introduction, (e.g., Bayesian Analysis of Blinking and Bleaching (B3), maybe some super-resolution methods, etc.) would help create the appropriate context for Tapqir.</p><p>– A discussion of the benefits of variational as opposed to exact inference is missing and would be useful for the reader.</p><p>– Line ~139: It is unclear if the image models or PSFs are integrated over pixel boundaries (i.e., as in Smith et al., &quot;Fast, single-molecule localization that achieves theoretically minimum uncertainty&quot; DOI: 10.1038/nmeth.1449). If not, what effect does this have on the modeling?</p><p>– Line 155-161: A discussion of EMCCD versus sCMOS noise differences, or even which one is more applicable to Tapqir, would be helpful here.</p><p>– Line 181: It is unclear what the &quot;hierarchichal Bayesian analysis&quot; refers to. I could not find an explanation in the Methods.</p><p>– Figure 3: What is the criteria for not having {x,y,h} included on the plot (e.g., at t=101)? I could not find it. Maybe p(m=0)&gt;.5?</p><p>– Figure 3: This figure should also include w along with x,y, and h. Is it relatively constant? Does it vary quite a bit?</p><p>– Figure 3-supplement 1 A: It was unclear to me why at frame 103, the spot was detected as spot 2 and not spot 1 with equal probability. Isn't there a degeneracy between the two spots? Is this broken by \theta? Regardless of the answer, perhaps a more in-depth discussion of this point would be useful.</p><p>– Figure 3-supplement 3 D: How does this plot compare to the theoretical minimum uncertainty of localizing a single molecule (i.e., the Cramer-Rao lower bound) at these photon fluxes? Shouldn't it bottom out at some point?</p><p>– Line 214: &quot;… rich enough to accurately capture …&quot; is a very nice way to convey the utility of the model. I think you should use it more often.</p><p>– Figure 5C-E: the rate constants are systematically overestimated -- even at the slowest rates. Why? Might these rates constants actually transition probabilities? I did not see a k=-ln(1-P)/dt equation in the Methods section.</p><p>– Line 353: Generally, Tapqir is only quantitatively compared to spot-picker, when there is also the Carlas et al., method that could be used for comparison.</p><p>– Figure 6B and supplements: Why were no off target controls ever analyzed to be included in the plot B as the yellow curve in C. If nothing else, it would be very useful to show the Tapqir is very accurate.</p><p>– Table 1: The computation times are reasonable for a high quality analysis, but are done on a very fast desktop computer (Threadripper with a 2080). It would be useful to show the performance on a less powerful computer as well (e.g., a low-powered laptop) for a least one dataset or perhaps a partial dataset. That way, potential users can judge whether they need to seek out better computational resources before trying Tapqir.</p><p><italic>Reviewer #3 (Public Review):</italic></p><p>In this manuscript, the authors seek to improve the reproducibility and eliminate sources of bias in the analysis of single molecule colocalization fluorescence data. These types of data (i.e., CoSMoS data) have been obtained from a number of diverse biological systems and represent unique challenges for data analysis in comparison with smFRET. A key source of bias is what constitutes a binding event and if those events are colocalized or not with a surface-tethered molecule of interest. To solve these issues, the authors propose a Bayesian-based method in which each image is analyzed individually and locally around areas of interest (AOIs) identified from the surface tethered molecules. A strength of the research is that the approach eliminates many sources of bias (i.e., thresholding) in analysis, models realistic image features (noise), can be automated and carried out by novice users &quot;hands-free&quot;, and returns a probability score for each event. The performance of the method is superb under a number of conditions and with varying levels of signal-to-noise. The analysis on a GPU is fairly quick-overnight-in comparison with by-hand analysis of the traces which can take days or longer. Tapqir has the potential to be the go-to software package for analysis of single molecule colocalization data.</p><p>The weaknesses of this work involve concerns about the approach and its usefulness to the single-molecule community at large as wells as a lack of information about how users implement and use the Tapqir software. For the first item, there are a number of common scenarios encountered in colocalization analysis that may exclude use of Tapqir including use of CMOS rather than EM-CCD cameras, significant numbers of tethered molecules on the surface that are dark/non-fluorescent, a high density/overlapping of AOIs, and cases where event intensity information is critical (i.e., FRET detection or sequential binding and simultaneous occupancy of multiple fluorescent molecules at the same AOI). In its current form, the use of Tapqir may be limited to only certain scenarios with data acquired by certain types of instruments.</p><p>Second, for adoption by non-expert users information is missing in the main text about practical aspects of using the Tapqir software including a description of inputs/outputs, the GUI (I believe Taqpir runs at the command line but the output is in a GUI), and if Tapqir integrates the kinetic modeling or not. Given that a competing approach has already been published by the Grunwald lab, it would be useful to compare these methods directly in both their accuracy, usefulness of the outputs, and calculation times. Along these lines, the utility of calculating event probability statistics (Figure 6A) is not well fleshed-out. This is a key distinguishing feature between Tapqir and methods previously published by Grunwald et al. In the case of Tapqir, the probability outputs are not used to their fullest in the determination of kinetic parameters. Rather a subjective probability threshold is chosen for what events to include. This may introduce bias and degrade the objective Tapqir pipeline used to identify these same events.</p><p>Finally, the manuscript could be improved by clearly distinguishing between the fundamental approach of Bayesian image analysis from the Tapqir software that would be used to carry this out. A section devoted to describing the Tapqir interface and the inputs/outputs would be valuable. In the manuscript's current form, the lack of information on the interface along with the potential requirement for a GPU and need for the use of a relatively new programming language (Pyro) may hamper adoption and interest in colocalization methods by general audiences.</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>1. It is unclear if intensity information is used by Tapqir or if it can be used. This can be useful for including more priors about the experiment (i.e., &quot;real&quot; events would be above a certain threshold due to FRET or presence of multiple fluorophores) or for using Tapqir to analyze experiments in which multiple fluorophore-labeled molecules bind simultaneously and sequentially to the same AOI. As presented, it would seem that Tapqir is &quot;blind&quot; to these types of multiple binding events.</p><p>2. A concern for adoption of Tapqir and appreciation of this work by general audiences involves the presentation of the method and software. I think that these should be disentangled from one another and that Tapqir should only be used to refer to the software used to carry out this approach. The manuscript, and the colocalization field, may be better served if a section were included that explicitly describes how to use Tapqir to implement this analysis including the necessary inputs, hardware (how much time would this take if a GPU isn't used?), and outputs/GUI. Ultimately, Tapqir needs to be user-friendly to be adopted and the requirement for a GPU and the Pyro programming language may be significant barriers. A potential model for the authors to consider is the <italic>eLife</italic> paper describing cisTEM software (https://elifesciences.org/articles/35383) that efficiently describes both the process, benchmarking, and software/user experience.</p><p>3. With respect to inputs, the need for use of imscroll to identify AOIs, drift correct, and carry out mapping should be clarified. Is imscroll output essential for Tapqir input?</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.73860.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) The γ-distributed noise model used in Tapqir captures quite a lot of physics and, given the analyses in Figures 3-6, clearly works, but might be limited to certain types of cameras used in the fluorescence microscopy (e.g., EMCCDs). For instance, sCMOS cameras have pixel-dependent amplification and noise profiles, rather than a single gain parameter, and are sometimes approximately modeled as normal distributions with both mean and variance having intensity-dependent and intensity-independent contributions that are different for each pixel on the camera. The authors should therefore address the question of whether Tapqir can also be used with data collected from different cameras and, specifically, sCMOS cameras.</p></disp-quote><p>We agree that this point should be addressed. We have expanded the discussion of the Image likelihood component of our model (lines 481 – 502) to emphasize that (1) all data sets we analyze are experimental or simulated EMCCD images, (2) sCMOS images have the different noise characteristics alluded to by the reviewers, and (3) optimal sCMOS image analysis might require a modified model, possibly including the ability to use per-pixel calibration data as a prior as was done in super-resolution work (now cited) that uses sCMOS data.</p><p>sCMOS cameras have in recent years become very popular for some kinds of single-molecule imaging (e.g., PALM/STORM or live-cell single-particle tracking). However, for the low-background/low-signal in vitro single-molecule TIRF that is our target application for the approach described in the manuscript, EMCCD is still preferable over sCMOS for many, but not all, imaging conditions (see https://andor.oxinst.com/learning/view/article/what-is-the-best-detector-for-single-molecule-studies). Thus, we think there will be plenty of interest in the approach we describe in the manuscript even if the program functions better with EMCCD than with sCMOS images.</p><p>Going forward to develop and test an sCMOS-targeted version of the model, as we have done for EMCCD, will require revised model and code, but will also necessitate accurately simulating sCMOS CoSMoS images, obtaining experimental sCMOS CoSMoS images reflecting a broad range of realistic experimental conditions, and using the simulated and experimental images to test the new model. These may well be useful things to do in the future but would be a considerable step beyond the scope of the present manuscript.</p><disp-quote content-type="editor-comment"><p>2) Little information is included about the role of AOI selection. The authors should address the question of how precisely do AOI positions need to be determined and how accurate must the mapping be. Moreover, it appears that the authors use a very large AOI (14x14 pixels, page 18). The authors should therefore address what the dependency is of the analysis on the AOI size and the relative sizes of the AOI and diffraction-limited spots. The authors should also address the question of whether Tapqir can only be used on well-separated, non-overlapping AOIs.</p></disp-quote><p>To address these questions, we added new data to the manuscript in Table 2, Table 5, and Figure 3 —figure supplement 4. The question about mapping accuracy is now discussed in the Methods (lines 565 – 574):</p><p>“Tests on data simulated with increasing proximity parameter values σ<sup>xy</sup> (true) (i.e., with decreasing precision of spatial mapping between the binder and target image channels) confirm that the <italic>cosmos</italic> model accurately learns σ<sup>xy</sup> (fit) from the data (Figure3—figure supplement 3D; Table 5). This was the case even if we substituted a less-informative σ<sup>xy</sup> prior (Uniform vs. Exponential; Table 5).</p><p>The CoSMoS technique is premised on colocalization of the binder spots with the known location of the target molecule. Consequently, for any analysis method, classification accuracy declines when the images in the target and binder channels are less accurately mapped. For the Tapqir <italic>cosmos</italic> model, low mapping precision has little effect on classification accuracy at typical non-specific binding densities (λ = 0.15; see MCC values in Table 5).”</p><p>We also added to the Results section (lines 302 -308) the following discussion of the effect of AOI size:</p><p>“Since target-nonspecific spots are built into the <italic>cosmos</italic> model, there is no need to choose excessively small AOIs in an attempt to exclude non-specific spots from analysis. We found that reducing AOI size (from 14 x 14 to 6 x 6 pixels) did not appreciably affect analysis accuracy on simulated data (Table 2). In analysis of experimental data, smaller AOI sizes caused occasional changes in calculated p(specific) values reflecting apparent missed detection of a few spots (Figure 3—figure supplement 4). Out of caution, we therefore used 14 x 14 pixel AOIs routinely, even though the larger AOIs somewhat reduced computation speed (Table 2 and Figure 3—figure supplement 4).”</p><p>The method does not require non-overlapping AOIs – we used partially overlapping AOIs in the experimental data analyzed in the manuscript. Even though our analysis used larger AOI sizes (and hence, more overlap) than the spot-picker method, there was good agreement in the results, indicating that overlap does not cause any undue problems.</p><disp-quote content-type="editor-comment"><p>3) The authors should test how the strength of the prior on the location of a specific binder affects the performance of Tapqir. Specifically, it would be very informative to know how the performance of Tapqir degrades as this prior is weakened. In other words, the authors should determine how weak this prior be made before the performance of Tapquir is compromised.</p></disp-quote><p>In our model, the position of a target-specific spot relative to the target position has a prior distribution illustrated as the green curve in Figure 2—figure supplement 2. Importantly, the peak in this distribution does not have an a priori set width. Instead, the width of the peak is a model hyperparameter, σ<sup>xy</sup>, that is learned from the image data set without user intervention. To make sure that this point is understood, we expanded and clarified the relevant Methods section (the four paragraphs starting at line 549) and modified the legend of Figure 2—figure supplement 2.</p><p>To address the reviewers’ specific question, we constructed simulated data sets with different mapping precision values and analyzed them; the results are presented in the (new) Table 5 and discussed (lines 570 – 574):</p><p>“The CoSMoS technique is premised on colocalization of the binder spots with the known location of the target molecule. Consequently, for any analysis method, classification accuracy declines when the images in the target and binder channels are less accurately mapped. For the Tapqir <italic>cosmos</italic> model, low mapping precision has little effect on classification accuracy at typical non-specific binding densities (λ = 0.15; see MCC values in Table 5).”</p><disp-quote content-type="editor-comment"><p>4) The premise of Tapqir assumes that there is no significant &quot;dark&quot; population of tethered molecules on the slide. While this may hold true for the commercially synthesized DNA oligos used in the example data in Table 1, many single-molecule experiments involve a large population of dark, tethered molecules due to incomplete labeling (50% is not uncommon). In these cases, the appropriate control for non-specific binding is a separate experiment in which no molecules or control molecules are tethered to the slide surface. The authors should address the question of whether Tapqir be used in these instances.</p></disp-quote><p>The reviewers suggest a “no target molecules in sample” (NTIS) control instead of the “no fluorescent target molecules in control AOIs” (NFTICA) design that we illustrate in Figure 1. Both types can be used as a Tapqir control dataset without any modification of the program or model. We have edited the Figure 1 caption to explain that either type is acceptable. The reviewers are correct that, all else being equal, NTIS may be better if the target molecules are incompletely labeled. However, in practice experimenters usually know the fraction of molecules that are labeled and reduce the fluorescent target molecule surface density to hold the fraction of spots with two or more coincident target molecules (fluorescent or not) below a chosen threshold (typically 1 % or less), negating the possible advantage of NTIS (but at the expense of collecting less data per sample). On the other hand, NFTICA has the practical advantage that it is a control internal to the sample and is thus immune to problems caused by temporal or sample-to-sample variability (e.g., of surface properties).</p><disp-quote content-type="editor-comment"><p>5) The head-to-head comparison with &quot;spot-picker&quot; is a bit unconvincing--how commonly is spot-picker being used outside the Gelles lab? A head-to-head comparison with the previously published methods developed by Grunwald would be much more revealing--particularly concerning the utility of having event detection probabilities and the time each analysis method takes to run on the same GPU.</p></disp-quote><p>Both the spot-picker binary classification method and the Grunwald binary classification method have been used outside of the lab in which they originated. It’s difficult to gauge exact usage of freely available software, but PubMed says that the spot-picker paper [Friedman and Gelles <italic>Methods</italic> 2015] has been cited 38 times, 26 of which by papers that do not have Gelles as a co-author, while the Grunwald paper [Smith, … Zamore and Grunwald <italic>Nat. Commun.</italic> 2019] (which in fairness was published much more recently) has been cited 7 times, 6 of which do not have Zamore as co-author.</p><p>The reviewers do not explain why comparing with the Grunwald method would be preferable to comparing with spot-picker. To be sure there is no misunderstanding, the following are the same for the two methods and therefore are <bold>not</bold> reasons to prefer one or the other of these methods for the comparison in Figure 6 (see also Discussion lines 392-415):</p><p>1. Like Tapqir, both spot-picker and Grunwald methods analyze 2-D images, not integrated intensities.</p><p>2. Unlike Tapqir, neither spot-picker nor Grunwald is fully objective; both require subjective selection of classification thresholds by an expert analyst in order to tune the algorithm performance for analysis of a particular dataset.</p><p>3. Neither spot-picker nor Grunwald is a Bayesian method. “Bayesian” in the Grunwald paper title refers to a separate analytical method (described in the same paper) for evaluating the number of binder molecules colocalized with a target spot; this method is not relevant to a comparison with the model presented in the manuscript.</p><p>4. Unlike Tapqir, neither spot-picker nor Grunwald estimate classification probabilities. Instead, they simply assign binary spot/no-spot classifications that do not convey to downstream analyses the extent of uncertainty in each classification.</p><p>5. Neither spot-picker nor Grunwald has been validated previously using simulated image data. Consequently, the validity of image classification has not been established for either.</p><p>The comparison of Figure 6 and supplements (lines 365-375) does not claim to and is not intended to show that Tapqir is better than spot-picker for real experimental data; we cannot make such a claim for any method because we do not know the true kinetic process that generated our data. Instead, our comparison uses experimental data sets with a broad range of characteristics (Table 1) to show that Tapqir yields similar association rate constants to those produced by spot-picker even though the former is objective and automatic while the latter requires subjective tuning by an expert analyst. Our choice to use spot-picker over Grunwald for this comparison was dictated by the fact that among the co-authors we have such an expert in the use of spot-picker, whereas we lack comparable expertise with Grunwald. We have no doubt that Grunwald would also produce results similar to the other methods in the hands of an expert user who is able to subjectively adjust classification parameters.</p><disp-quote content-type="editor-comment"><p>6) The authors offer a new approach to analyzing single-molecule fluorescence colocalization data, yet they don't leverage the full strength of priors in stringing together experiments. Specifically, in their analyses, they mostly end up in a place where their software is recapitulating old analyses and not really leveraging the probabilities they have. The authors, therefore, need to make a clearer case for using the calculated event probabilities. In addition, if they made a subjective decision about what probability cut off to use to identify events for inclusion in the kinetic modeling then that seems to go counter to the objective-based analysis of Tapqir. Can the kinetic modeling include all of the events, weighted by their probabilities?</p></disp-quote><p>This comment seems to be premised on a misunderstanding of our manuscript. While we used a cut-off of <italic>p</italic>(specific) &gt; 0.5 for the binary classification statistics (e.g., Figure 4D and G), all of the kinetic analyses in the manuscript use the full time series of calculated probability values with no arbitrary cut-off. This was accomplished using the posterior sampling method that is illustrated in Figure 5B and described in lines 318-324. We have revised the latter to clarify this point.</p><p>We address the specific point about use of priors in stinging together experiments in a response to Reviewer #2 (Public Review) below.</p><disp-quote content-type="editor-comment"><p>7) The authors should also respond to the additional concerns raised by the individual reviewers, included below.</p></disp-quote><p>Please see responses below.</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Public Review):</p><p>&quot;Bayesian machine learning analysis of single-molecule fluorescence colocalization images&quot; by Ordabayev, et al. reports the development, benchmarking, and testing of a Bayesian machine learning-based method, which the authors name Tapqir, for analyzing single-molecule fluorescence colocalization data. Unlike currently available, more conventional analysis methods, Tapqir attempts to holistically model the microscopy images that are recorded during a colocalization experiment. Tapir uses a physics-based, global model with parameters describing all of the features of the experiment that are expected to contribute to the recorded microscopy images, including shot noise of the spots and background, camera noise, size and shape of the spots, and specific- and non-specific binders. Based on benchmarking on simulated data with widely varying properties (e.g., signal-to-noise; amounts, rates, and locations of specific and non-specific binders; etc.), Tapqir generally does as well and, in some cases, better than currently existing methods. The authors also test Tapqir on real microscopy images with similarly varying properties from studies that have been previously published by their research group and demonstrate that their Tapqir-based analysis is able to faithfully reproduce the previously published results, which were obtained using the more conventional analysis methods available at the time the data were originally published. This is a well-designed and executed study, Tapqir represents a conceptual and practical advance in the analysis of single-molecule fluorescence colocalization experiments, and its performance has been comprehensively and rigorously benchmarked on simulated data and tested on real data. The conclusions of this study are well supported by the data, but some of the limitations of the method need to be clarified and discussed in more depth, as outlined below.</p><p>1. Given that the AOI is centered at the target molecule and there is a strong prior for the binder also being located at the center of the AOI, the performance of Tapqir is dependent on several variables of the microscopy/optical system (e.g., the microscope point-spread function, magnification, accurate alignment of target and binder imaging channels, accurate drift correction, etc.). Although this caveat is mentioned and some of these factors are listed in the main text of the manuscript, the authors could have expanded this discussion in order to clarify the extent to which the performance of Tapqir depends on these factors.</p></disp-quote><p>The revised manuscript includes new data on and expanded discussion of this point. Please see our response to Essential Revision 2.</p><disp-quote content-type="editor-comment"><p>2. The Tapqir model has many parameters, each with its own prior. The majority of these priors are designed to be uninformative and/or weak and the only very strong prior is the probability that a specific binder is located at or very near the center of the AOI. The authors could have tested and commented on how the strength of the prior on the location of a specific binder affects the performance of Tapqir.</p></disp-quote><p>The revised manuscript includes new data on and expanded discussion of this point. Please see response to Essential Revision 3.</p><disp-quote content-type="editor-comment"><p>3. Given the priors and variational parameters they report, the authors show that Tapqir performs robustly and seems to require no experiment-to-experiment optimization. This is expected to be the case for the simulated data, since they were simulated using the same model that Tapqir uses to perform the analysis. With regard to the real data, however, it is quite likely that this is due to the fact that the analyzed data all come from the same laboratory and, therefore, likely the same microscope(s). It would have therefore been very useful if the authors would have listed and discussed which microscope settings, experimental conditions, and/or other considerations, beyond those described in point 1 above, would result in a need for re-optimization of the priors and/or variational parameters.</p></disp-quote><p>We now address this point in the Materials and methods as follows (lines 587-595):</p><p>“All simulated and experimental data sets in this work were analyzed using the prior distributions and hyperparameter values given above, which are compatible with a broad range of experimental conditions (Table 1). Many of the priors are uninformative and we anticipate that these will work well with images taken on variety of microscope hardware. However, it is possible that highly atypical microscope designs (e.g., those with effective magnifications that are sub-optimal for CoSMoS) might require adjustment of some fixed hyperparameters and distributions (those in Eqs. 6a, 6b, 11, 12, 13, 15, and 16). For example, if the microscope point spread function is more than 2 pixels wide, it may be necessary to increase the range of the <italic>w</italic> prior in Eq. 13. The Tapqir documentation</p><disp-quote content-type="editor-comment"><p>4. Based on analysis of the simulated data shown in Figure 5, where the ground truth is known, the use of Tapqir to infer kinetics is less accurate that the use of Tapqir to infer equilibrium binding constants. The authors do a great job of discussing possible reasons for this. In the case of the real data analyzed in Figure 6 and in Figure 6 —figure supplements 1 and 2, the kinetic results obtained using Tapqir have different means and generally larger error bars than those obtained using Spot-Picker. To more comprehensively assess the performance of Tapqir versus Spot-Picker, the authors could have used the association and dissociation rates to calculate the corresponding equilibrium binding constants and then compared these kinetically calculated equilibrium binding constants to the population-calculated equilibrium binding constants that the authors calculate and report in the bottom plot in Panel D of Figure 6 and Figure 6 —figure supplements 1 and 2. This would provide some information on the accuracy of the kinetics in that the closer the kinetically and population-calculated equilibrium binding constants are to each other, the more accurately the kinetics have been estimated. Performing this type of analysis for the kinetics obtained using Tapqir and Spot-Picker would have allowed a more comprehensive comparison of the two methods.</p></disp-quote><p>This comment seems to reflect a misunderstanding. Figure 6 and its figure supplements do not report any dissociation kinetics or binding equilibrium constants. Instead, they report <italic>k</italic><sub>a</sub> (pseudo first-order association rate constant), <italic>k</italic><sub>ns</sub> (non-specific binding association rate constant), and <italic>A</italic><sub>f</sub> (the active faction, i.e., the fraction of target molecules capable of association with binder). <italic>k</italic><sub>a</sub> and <italic>A</italic><sub>f</sub> values from the two methods agree within experimental uncertainty for all four data sets analyzed. <italic>k</italic><sub>ns</sub> values differ, but as we point out (lines 373-375):</p><p>“We noted some differences between the two methods in the non-specific association rate constants <italic>k</italic><sub>ns</sub>. Differences are expected because these parameters are defined differently in the different nonspecific binding models used in Tapqir and spot-picker (see Materials and methods).”</p><p>(There is additional discussion of this point in Materials and methods lines 686-690.) The reviewer is correct that the estimated uncertainties (i.e., error bars in panels D) in <italic>k</italic><sub>a</sub> and <italic>A</italic><sub>f</sub> are generally larger for Tapqir than for spot-picker. This is expected, for the reasons that we explain (lines 402-411):</p><p>“In general, previous approaches in essence assume that spot classifications are correct, and thus the uncertainties in the derived molecular properties (e.g., equilibrium constants) are systematically underestimated because the errors in spot classification, which can be large, are not accounted for. By performing a probabilistic spot classification, Tapqir enables reliable inference of molecular properties, such as thermodynamic and kinetic parameters, and allows statistically well-justified estimation of parameter uncertainties. This more inclusive error estimation likely accounts for the generally larger kinetic parameter error bars obtained from Tapqir compared to those from the existing spot-picker analysis method (Figure 6, Figure 6—figure supplement 1, Figure 6—figure supplement 2, and Figure 6—figure supplement 3). ”</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>This is a well-designed and executed study, Tapqir represents a conceptual and practical advance in the analysis of single-molecule fluorescence colocalization experiments, and its performance has been comprehensively and rigorously benchmarked on simulated data and tested on real data. Moreover, the conclusions of this study are well supported by the data. Given all of this, I would recommend publication of this study as a Tools and Resources article in eLife, assuming that the authors address the weaknesses I identified in my Public Review as well as the following extensions of those weaknesses.</p><p>This is a well-designed and executed study, Tapqir represents a conceptual and practical advance in the analysis of single-molecule fluorescence colocalization experiments, and its performance has been comprehensively and rigorously benchmarked on simulated data and tested on real data. Moreover, the conclusions of this study are well supported by the data. Given all of this, I would recommend publication of this study as a Tools and Resources article in eLife, assuming that the authors address the weaknesses I identified in my Public Review as well as the following extensions of those weaknesses.</p><p>1. I think the authors should to expand the discussion of how the performance of Tapqir depends on the microscope point-spread function, magnification, accurate alignment of target and binder imaging channels, accurate drift correction, etc. Specifically, if possible, they should describe how a 1-2 pixel offset in the x- or y dimensions between the target and binder imaging channels arising from differences in any of these parameters would affect the performance of Tapqir. This is especially important given the strength of the prior the authors have assigned to the location of the specific binder at the center of the AOI.</p></disp-quote><p>The revised manuscript includes new data on and expanded discussion of this point. Please see response to Essential Revision 3.</p><disp-quote content-type="editor-comment"><p>2. The authors should list and discuss what microscope settings, experimental conditions, and/or other considerations, beyond the microscope/optical described in point 1 above, would result in a need for re-optimization of the priors and/or variational parameters. For example, in Lines 509-510, the authors state that most microscopes used for colocalization experiments are set up such that diffraction-limited spots occupy 1-2 pixels in the x- and y dimensions on the camera detector. If a microscope is instead set up to spread the spot over 3, 4, or more pixels in each dimension, are there any priors or variational parameters that should be re-optimized? Are there any other such considerations?</p></disp-quote><p>This is now addressed. Please see response to Reviewer #1 (Public Review) point 3.</p><disp-quote content-type="editor-comment"><p>4. The authors should comment on whether the kinetic parameters obtained by Tapqir and reported in Figure 6 and in Figure 6 —figure supplements 1 and 2 are actually more accurate and/or precise than those obtained by Spot-Picker. For example, if the association and dissociation rates were used to calculate the equilibrium binding constants, how would these kinetically calculated equilibrium binding constants compare to the population-calculated equilibrium constant that the authors calculate and report in Figure 6 and in Figure 6 —figure supplements 1 and 2? Are the kinetically calculated and population-calculated equilibrium binding constants in closer agreement for the Tapqir-analyzed data versus the Spot-Picker-analyzed data? If one is better than the other, why do the authors think that is?</p></disp-quote><p>We do not calculate dissociation rate constants or equilibrium constants in Figure 6 and its figure supplements; please see the discussion of this in response to Reviewer #1 (Public Review) point 4. As the reviewer points out, we know the “ground truth” for the simulated data of Figure 5 but not for the experimental data of Figure 6. Consequently, it is not possible assess the accuracy of analysis of the latter. Precision is already estimated; please see the discussion of error bars in response to Reviewer #1 (Public Review) point 4.</p><disp-quote content-type="editor-comment"><p>Reviewer 2 (Public Review):</p><p>The work by Ordabayev et al. details a Bayesian inference-based data analysis method for colocalization single molecule spectroscopy (CoSMoS) experiments used to investigate biochemical and biophysical mechanisms. By using this probabilistic framework, their method is able to quantify the colocalization probabilities for individual molecules while accounting for the uncertainty in individual binding events, and accounting for camera and optical noise and even non-specific binding. The software implementation of this method, called Tapqir, uses a Python-based probabilistic programming language (PPL) called pyro to automate and speed-up the optimization of a variational Bayes approximation to the posterior probability distribution. Overall, Tapqir is a powerful new way to analyze CoSMoS data.</p><p>Tapqir works by analyzing small regions (14x14 pixels) of fluorescence microscopy images surrounding previously identified areas of interest (AOI). The collection of images of these AOIs through time are then analyzed collectively using a probabilistic model that accounts for each time frame of each AOI and is able to determine whether up to K &quot;binders&quot; (K=2 here) are present and which of them is specifically bound. This approach of directly modeling the contents of the image data is relatively novel, and few other examples exist. The details of the probabilistic model used incorporate an impressive amount of physical insight (e.g., camera gain) without overparameterization.</p></disp-quote><p>We thank the reviewer for these positive comments.</p><disp-quote content-type="editor-comment"><p>The γ-distributed noise model used in Tapqir captures quite a lot of physics and, given the analyses in Figures 3-6, clearly works, but might be limited to certain types of cameras used in the fluorescence microscopy (e.g., EMCCDs). For instance, sCMOS cameras have pixel-dependent amplification and noise profiles, rather than a single gain parameter, and are sometimes approximately modeled as normal distributions with both mean and variance having an intensity-dependent and independent contribution that is different for each pixel on the camera. It is unclear how Tapqir performs on different cameras.</p></disp-quote><p>Please see our response to Essential Revisions point 1.</p><disp-quote content-type="editor-comment"><p>The variational Bayes solution used by Tapqir provides many computational benefits, such as numerical tractability using pyro and speed. It is possible that the exact posterior, e.g., as obtained using a Markov chain Monte Carlo method, would be insignificantly different with the amount of data typical for CoSMoS experiments; however, this difference is not explored in the current work.</p></disp-quote><p>We agree. However, since we have not done any analyses using MCMC, there is nothing in particular that we can say about it in the context of CoSMoS data analysis. Implementation of an MCMC approach using our model will be easier in the future because the pyro developers are currently working to optimize the implementations of MCMC methods in their software.</p><disp-quote content-type="editor-comment"><p>The intrinsic use of prior probability distributions in any Bayesian inference algorithm is extremely powerful, and in Tapqir offers the opportunity to &quot;chain together&quot; subsequent analyses by using the marginalized posteriors from one experiment as the basis for the priors for subsequent experiments (e.g., in \σ^{xy}) for extremely high accuracy inference. While the manuscript discusses setting and leveraging the power of priors, it does not explore the power of such &quot;chaining&quot; and the positive effects upon accuracy.</p></disp-quote><p>Chaining is beneficial in principle. However, in practice it will help significantly only if the uncertainty in the posterior parameter values from the non-chained analysis is larger than the experiment-toexperiment variability in the “true” parameter values. For σ<sup>xy</sup> we obtain very narrow credence intervals without chaining (Table 1). In our judgement, these are unlikely to be made more accurate by using prior information from another experiment where such factors as microscope focus adjustment may be slightly different.</p><disp-quote content-type="editor-comment"><p>A significant number of CoSMoS experiments use multiple, distinct color fluorophores to probe the colocalization of different species to the target. The current work focuses only upon analyzing data with a single color-channel. Extensions to multiple independent wavelengths are computationally trivial, given the automated variational inference ability of PPLs such as pyro, and would increase the impact of the work in the field.</p></disp-quote><p>Our current approach can be used to analyze multi-channel data simply by analyzing each channel independently. However, we agree that there would be advantages to joint analysis of multiple wavelength channels (especially if there is crosstalk between channels) and that implementing multichannel analysis is a logical extension of our study. It is straightforward (though not trivial, in our experience) to implement such multi-wavelength models. However, testing the functioning of candidate models and validating them using simulation and experimental data would require extensive work that in our view goes beyond what is reasonable to include in the present manuscript.</p><disp-quote content-type="editor-comment"><p>Tapqir analysis provides time series of the probability of a specific binding event, p(specific), for each target analyzed (c.f., Figure 5B), and kinetic parameters are extracted from these time series using secondary analyses that are distinct from Tapqir itself.</p><p>The method reported here is well designed, sound, and its utility is well supported by the analyses of simulated and experimental data sets reported here. Tapqir is a cutting-edge image analysis approach, and its proper treatment of the uncertainty inherent to CoSMoS experiments will certainly make an impact upon the analysis of CoSMoS data. However, many of the (necessary) assumptions about the data (e.g., fluorescence microscopy) and desired information (e.g., off-target vs on-target binding) are quite specific to CoSMoS experiments and therefore limit the direct applicability of Tapqir for the analysis of other single-molecule microscopy techniques. With that in mind, the direct Bayesian inference-based analysis of image data, as opposed to integrated time series, as demonstrated here is very powerful, and may encourage and inspire related methods to be developed.</p></disp-quote><p>Our approach is a powerful way to analyze CoSMoS data in part <italic>because</italic> it is specific to CoSMoS – it is premised on a physics-based model that incorporates known features of CoSMoS experiments. We agree that the general approach could be adapted to other image analysis applications.</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>– Some of the language in the introduction is a little imprecise (e.g., &quot;binders&quot;, &quot;green RNA&quot;, &quot;blue DNA spot&quot;, &quot;integrating binder fluorescence&quot;, &quot;real fluorescent spots&quot;), and could be more explicit to improve clarity.</p></disp-quote><p>We have edited the Introduction to improve clarity.</p><disp-quote content-type="editor-comment"><p>– Line 63: The concentration barrier could be described more in depth for the eLife readership.</p></disp-quote><p>The background noise problem discussed at line 63 (we don’t call it a barrier) has multiple causes, not all of which are well understood, which are only peripherally relevant to our manuscript. We think more discussion of the subject would be distracting and we instead cite the Peng and van Oijen papers which discuss the subject in more detail.</p><disp-quote content-type="editor-comment"><p>– Line 74-76: Additional description of these effects, perhaps mathematically or through other citations, would help the readers understand the fundamental differences between analyzing image data and intensity data.</p></disp-quote><p>The advantages of analyzing 2-D images rather than integrated intensity time series have been already discussed in the published literature by Friedman and Gelles, 2015 and Smith et al., 2019, both of which are cited (line 78).</p><disp-quote content-type="editor-comment"><p>– Line 82-83: Describing how and/or the magnitude of the failure that not accounting for spot confidence creates would be useful for the reader to understand the requirement for Tapqir</p></disp-quote><p>We believe that the description in the cited lines explains why accounting for spot confidence is important in principle. No previous analysis method has measured spot confidence, so there is no existing data prior to this manuscript that measures the failure magnitude.</p><disp-quote content-type="editor-comment"><p>– Line 84-86: The method described doesn't get a name, but the software does get a name. I think giving the method a descriptive name (e.g., an acronym) would help clarify the discussion and distinction between the approach of probabilistic modeling of the data and using pyro and the chosen priors etc. to do so.</p></disp-quote><p>We have edited the manuscript to adopt this recommendation. We now call the mathematical model “the <italic>cosmos</italic> model” and use “Tapqir” to refer to the software.</p><disp-quote content-type="editor-comment"><p>– More referencing of Bayesian image analysis methods for microscopy data, at least in the introduction, (e.g., Bayesian Analysis of Blinking and Bleaching (B3), maybe some super-resolution methods, etc.) would help create the appropriate context for Tapqir.</p></disp-quote><p>We added information mentioning prior use of Bayesian methods in single-molecule microscopy to the Discussion (line 426).</p><disp-quote content-type="editor-comment"><p>– A discussion of the benefits of variational as opposed to exact inference is missing and would be useful for the reader.</p></disp-quote><p>We added a brief discussion of this point (line 632).</p><disp-quote content-type="editor-comment"><p>– Line ~139: It is unclear if the image models or PSFs are integrated over pixel boundaries (i.e., as in Smith et al., &quot;Fast, single-molecule localization that achieves theoretically minimum uncertainty&quot; DOI: 10.1038/nmeth.1449). If not, what effect does this have on the modeling?</p></disp-quote><p>No, to reduce the amount of computation required, we use an approximation based on the intensity value at the center of the pixel. Use of the approximation is justified by the performance of our algorithm measured against simulated data (Figure 4, Figure 5, Figure 3 —figure supplement 2, and Figure 3, figure supplement 3).</p><disp-quote content-type="editor-comment"><p>– Line 155-161: A discussion of EMCCD versus sCMOS noise differences, or even which one is more applicable to Tapqir, would be helpful here.</p></disp-quote><p>This point is now addressed in the manuscript; please see our response to Essential Revisions point 1.</p><disp-quote content-type="editor-comment"><p>– Line 181: It is unclear what the &quot;hierarchichal Bayesian analysis&quot; refers to. I could not find an explanation in the Methods.</p></disp-quote><p>To clarify this point, we added (line 188) citation to Chapter 5 in Gelman et al., (2013), specifically indicating that it covers the topic of hierarchical models.</p><disp-quote content-type="editor-comment"><p>– Figure 3: What is the criteria for not having {x,y,h} included on the plot (e.g., at t=101)? I could not find it. Maybe p(m=0)&gt;.5?</p></disp-quote><p>Yes, that is correct. We have edited the figure caption to make this clearer.</p><disp-quote content-type="editor-comment"><p>– Figure 3: This figure should also include w along with x,y, and h. Is it relatively constant? Does it vary quite a bit?</p></disp-quote><p>We have added <italic>w</italic> to Figure 3. It is relatively constant.</p><disp-quote content-type="editor-comment"><p>– Figure 3-supplement 1 A: It was unclear to me why at frame 103, the spot was detected as spot 2 and not spot 1 with equal probability. Isn't there a degeneracy between the two spots? Is this broken by \theta? Regardless of the answer, perhaps a more in-depth discussion of this point would be useful.</p></disp-quote><p>We explain in the Figure 3 caption: “Spot numbers 1 (blue) and 2 (orange) are assigned arbitrarily and may change from fame to frame.” We have added language to the Figure 3 —figure supplement 1 caption to re-emphasize that the spot 1 and 2 labels are arbitrary.</p><disp-quote content-type="editor-comment"><p>– Figure 3-supplement 3 D: How does this plot compare to the theoretical minimum uncertainty of localizing a single molecule (i.e., the Cramer-Rao lower bound) at these photon fluxes? Shouldn't it bottom out at some point?</p></disp-quote><p>σ<sup>xy</sup> is not the precision in the position of the binder spot, it instead reflects the width of the distribution of binder spot position with respect to the target position across all AOIs and all frames. Nevertheless, the reviewer is correct that it should be greater than or equal to the localization uncertainty for an individual spot. However, even for the point in Figure 3 —figure supplement 3D with the smallest number of photons, the lower bound on localization certainty is 0.11 pixels. This value is much smaller than the range of values shown in the figure, so the “bottoming out” is not seen in the plot.</p><disp-quote content-type="editor-comment"><p>– Line 214: &quot;… rich enough to accurately capture …&quot; is a very nice way to convey the utility of the model. I think you should use it more often.</p></disp-quote><p>Thank you.</p><disp-quote content-type="editor-comment"><p>– Figure 5C-E: the rate constants are systematically overestimated -- even at the slowest rates. Why?</p></disp-quote><p>We explain this at lines 326-328: “At higher nonspecific binding rates, rare interruptions caused by false-positive and false-negative spot detection shorten Δ<italic>t</italic><sub>on</sub> and Δ<italic>t</italic><sub>off</sub> distributions, leading to moderate systematic overestimation of the association and dissociation rate constants.”</p><disp-quote content-type="editor-comment"><p>Might these rates constants actually transition probabilities? I did not see a k=-ln(1-P)/dt equation in the Methods section.</p></disp-quote><p>We have edited the manuscript to clarify that (lines 650-651) “…<italic>k</italic><sub>on</sub> and <italic>k<sub>off</sub></italic> are transition probabilities that numerically approximate the pseudo-first-order binding and first-order dissociation rate constants in units of s<sup>-1</sup>, respectively, assuming 1 s/frame.”</p><disp-quote content-type="editor-comment"><p>– Line 353: Generally, Tapqir is only quantitatively compared to spot-picker, when there is also the Carlas et al., method that could be used for comparison.</p></disp-quote><p>Please see our response to Essential Revision 5.</p><disp-quote content-type="editor-comment"><p>– Figure 6B and supplements: Why were no off target controls ever analyzed to be included in the plot B as the yellow curve in C. If nothing else, it would be very useful to show the Tapqir is very accurate.</p></disp-quote><p>There is no equivalent to the yellow curve in the Tapqir analysis. Tapqir jointly analyzes the on- and off- target data sets, rather than analyzing them separately as in the approach used with spot-picker. The results in Figure 4I show that there are essentially no false positives seen in analyses of simulated datasets that are constructed to have no target-specific binding.</p><disp-quote content-type="editor-comment"><p>– Table 1: The computation times are reasonable for a high quality analysis, but are done on a very fast desktop computer (Threadripper with a 2080). It would be useful to show the performance on a less powerful computer as well (e.g., a low-powered laptop) for a least one dataset or perhaps a partial dataset. That way, potential users can judge whether they need to seek out better computational resources before trying Tapqir.</p></disp-quote><p>We have now added to Table 1 data showing that computation time on the Google Colab Pro cloud service is actually faster than that on our local GPU system. Colab Pro is readily accessible (available to anyone at $50/month) and user friendly. We have added to the user manual a tutorial that shows how to run a sample data set using Tapqir on Colab.</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Public Review):</p><p>In this manuscript, the authors seek to improve the reproducibility and eliminate sources of bias in the analysis of single molecule colocalization fluorescence data. These types of data (i.e., CoSMoS data) have been obtained from a number of diverse biological systems and represent unique challenges for data analysis in comparison with smFRET. A key source of bias is what constitutes a binding event and if those events are colocalized or not with a surface-tethered molecule of interest. To solve these issues, the authors propose a Bayesian-based method in which each image is analyzed individually and locally around areas of interest (AOIs) identified from the surface tethered molecules. A strength of the research is that the approach eliminates many sources of bias (i.e., thresholding) in analysis, models realistic image features (noise), can be automated and carried out by novice users &quot;hands-free&quot;, and returns a probability score for each event. The performance of the method is superb under a number of conditions and with varying levels of signal-to-noise. The analysis on a GPU is fairly quick-overnight-in comparison with by-hand analysis of the traces which can take days or longer. Tapqir has the potential to be the go-to software package for analysis of single molecule colocalization data.</p><p>The weaknesses of this work involve concerns about the approach and its usefulness to the single-molecule community at large as wells as a lack of information about how users implement and use the Tapqir software. For the first item, there are a number of common scenarios encountered in colocalization analysis that may exclude use of Tapqir including use of CMOS rather than EM-CCD cameras, significant numbers of tethered molecules on the surface that are dark/non-fluorescent, a high density/overlapping of AOIs, and cases where event intensity information is critical (i.e., FRET detection or sequential binding and simultaneous occupancy of multiple fluorescent molecules at the same AOI). In its current form, the use of Tapqir may be limited to only certain scenarios with data acquired by certain types of instruments.</p></disp-quote><p>Concerns about application to CMOS, dark target molecules, and overlapping AOIs are addressed in the revised manuscript and in the responses to Essential Revisions 1, 2, and 4. The question of applying the approach to methods (e.g., smFRET) that require extraction of both colocalization and intensity data is discussed below; please see our response to Reviewer #3 (Recommendations for the authors) point 1.</p><disp-quote content-type="editor-comment"><p>Second, for adoption by non-expert users information is missing in the main text about practical aspects of using the Tapqir software including a description of inputs/outputs, the GUI (I believe Taqpir runs at the command line but the output is in a GUI), and if Tapqir integrates the kinetic modeling or not.</p></disp-quote><p>This information is given in the online Tapqir documentation, which is now cited in the manuscript. The kinetic analysis (as in Figure 6) is a simple Python script that is run after Tapqir; the instructions for using it are included in the documentation. Tapqir runs can be initiated using either a CLI or GUI. Output can be viewed in Tensorboard, in a Tapqir GUI, and/or passed to a Jupyter notebook or Python script for further analysis, plotting, etc.</p><disp-quote content-type="editor-comment"><p>Given that a competing approach has already been published by the Grunwald lab, it would be useful to compare these methods directly in both their accuracy, usefulness of the outputs, and calculation times.</p></disp-quote><p>Please see our response to Essential Revision 5.</p><disp-quote content-type="editor-comment"><p>Along these lines, the utility of calculating event probability statistics (Figure 6A) is not well fleshed-out. This is a key distinguishing feature between Tapqir and methods previously published by Grunwald et al. In the case of Tapqir, the probability outputs are not used to their fullest in the determination of kinetic parameters. Rather a subjective probability threshold is chosen for what events to include. This may introduce bias and degrade the objective Tapqir pipeline used to identify these same events.</p></disp-quote><p>This comment reflects a misunderstanding. No probability threshold is used in the kinetic analyses (Figures 5 and 6). Instead, we make full use of the <italic>p</italic>(specific) probability output using the posterior sampling strategy that is illustrated in Figure 5B and is described in the Results and in Materials and methods. We have edited the Results section to further emphasize this point.</p><disp-quote content-type="editor-comment"><p>Finally, the manuscript could be improved by clearly distinguishing between the fundamental approach of Bayesian image analysis from the Tapqir software that would be used to carry this out.</p></disp-quote><p>We have edited the manuscript to adopt this recommendation. We now call the mathematical model “the <italic>cosmos</italic> model” and use “Tapqir” to refer to the software.</p><disp-quote content-type="editor-comment"><p>A section devoted to describing the Tapqir interface and the inputs/outputs would be valuable. In the manuscript's current form, the lack of information on the interface along with the potential requirement for a GPU and need for the use of a relatively new programming language (Pyro) may hamper adoption and interest in colocalization methods by general audiences.</p></disp-quote><p>As described above, description of the interface and inputs/outputs is given in the online Tapqir documentation, which is now cited in the manuscript. As described above, users do not need to own a GPU, they can run the program on a readily available cloud computing service. Users do not need any knowledge of Pyro to use Tapqir; Pyro is merely used internally in the coding of Tapqir.</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>1. It is unclear if intensity information is used by Tapqir or if it can be used. This can be useful for including more priors about the experiment (i.e., &quot;real&quot; events would be above a certain threshold due to FRET or presence of multiple fluorophores) or for using Tapqir to analyze experiments in which multiple fluorophore-labeled molecules bind simultaneously and sequentially to the same AOI. As presented, it would seem that Tapqir is &quot;blind&quot; to these types of multiple binding events.</p></disp-quote><p>That is correct, at least to the extent that the <italic>cosmos</italic> model we describe in the manuscript does not incorporate phenomena where the spot intensity at a single target changes, such as when there is FRET or multiple binders. As we point out in the final paragraph of the Discussion, more elaborate versions of the <italic>cosmos</italic> model that incorporate these phenomena could be developed. This would entail implementation, optimization, and validation with simulations and real data of the new model, which is beyond the scope of the present manuscript.</p><disp-quote content-type="editor-comment"><p>2. A concern for adoption of Tapqir and appreciation of this work by general audiences involves the presentation of the method and software. I think that these should be disentangled from one another and that Tapqir should only be used to refer to the software used to carry out this approach. The manuscript, and the colocalization field, may be better served if a section were included that explicitly describes how to use Tapqir to implement this analysis including the necessary inputs, hardware (how much time would this take if a GPU isn't used?), and outputs/GUI. Ultimately, Tapqir needs to be user-friendly to be adopted and the requirement for a GPU and the Pyro programming language may be significant barriers. A potential model for the authors to consider is the eLife paper describing cisTEM software (https://elifesciences.org/articles/35383) that efficiently describes both the process, benchmarking, and software/user experience.</p></disp-quote><p>We have addressed these points above in responses to multiple parts of the Reviewer #3 (Public Review). It is perhaps worth emphasizing that, as detailed in the first section of Results (“Data Analysis Pipeline”), we do not describe in our manuscript a full data analysis pipeline like that in the cisTEM paper but only one module in that pipeline.</p><disp-quote content-type="editor-comment"><p>3. With respect to inputs, the need for use of imscroll to identify AOIs, drift correct, and carry out mapping should be clarified. Is imscroll output essential for Tapqir input?</p></disp-quote><p>As discussed in the “Data Analysis Pipeline” section of Results, there are variety of tools in current use to do the pre-processing steps of CoSMoS data analysis. Unfortunately, there is no standard file format for the output of the preprocessing results, and Tapqir currently reads only the format produced by imscroll. We hope to work with users of other preprocessing tools to develop and test code that will read some of the other formats in use.</p></body></sub-article></article>