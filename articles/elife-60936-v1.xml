<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">60936</article-id><article-id pub-id-type="doi">10.7554/eLife.60936</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Data-driven reduction of dendritic morphologies with preserved dendro-somatic responses</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-197098"><name><surname>Wybo</surname><given-names>Willem AM</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1385-4980</contrib-id><email>willem.a.m.wybo@gmail.com</email><xref ref-type="aff" rid="aff1"/><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-201781"><name><surname>Jordan</surname><given-names>Jakob</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3438-5001</contrib-id><xref ref-type="aff" rid="aff1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-201782"><name><surname>Ellenberger</surname><given-names>Benjamin</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-160511"><name><surname>Marti Mengual</surname><given-names>Ulisses</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-187191"><name><surname>Nevian</surname><given-names>Thomas</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-9804-608X</contrib-id><xref ref-type="aff" rid="aff1"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-197714"><name><surname>Senn</surname><given-names>Walter</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3622-0497</contrib-id><xref ref-type="aff" rid="aff1"/><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><institution>Department of Physiology, University of Bern</institution><addr-line><named-content content-type="city">Bern</named-content></addr-line><country>Switzerland</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>O'Leary</surname><given-names>Timothy</given-names></name><role>Reviewing Editor</role><aff><institution>University of Cambridge</institution><country>United Kingdom</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Senior Editor</role><aff><institution>Emory University</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>26</day><month>01</month><year>2021</year></pub-date><pub-date pub-type="collection"><year>2021</year></pub-date><volume>10</volume><elocation-id>e60936</elocation-id><history><date date-type="received" iso-8601-date="2020-07-10"><day>10</day><month>07</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2021-01-04"><day>04</day><month>01</month><year>2021</year></date></history><permissions><copyright-statement>Â© 2021, Wybo et al</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>Wybo et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-60936-v1.pdf"/><abstract><p>Dendrites shape information flow in neurons. Yet, there is little consensus on the level of spatial complexity at which they operate. Through carefully chosen parameter fits, solvable in the least-squares sense, we obtain accurate reduced compartmental models at any level of complexity. We show that (back-propagating) action potentials, Ca<sup>2+</sup> spikes, and <italic>N</italic>-methyl-D-aspartate spikes can all be reproduced with few compartments. We also investigate whether afferent spatial connectivity motifs admit simplification by ablating targeted branches and grouping affected synapses onto the next proximal dendrite. We find that voltage in the remaining branches is reproduced if temporal conductance fluctuations stay below a limit that depends on the average difference in input resistance between the ablated branches and the next proximal dendrite. Furthermore, our methodology fits reduced models directly from experimental data, without requiring morphological reconstructions. We provide software that automatizes the simplification, eliminating a common hurdle toward including dendritic computations in network models.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>dendritic computation</kwd><kwd>neuron models</kwd><kwd>model reduction</kwd><kwd>software toolbox</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010663</institution-id><institution>H2020 European Research Council</institution></institution-wrap></funding-source><award-id>720270</award-id><principal-award-recipient><name><surname>Senn</surname><given-names>Walter</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution>Swiss National Science Foundation</institution></institution-wrap></funding-source><award-id>180316</award-id><principal-award-recipient><name><surname>Senn</surname><given-names>Walter</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution>Swiss National Science Foundation</institution></institution-wrap></funding-source><award-id>159872</award-id><principal-award-recipient><name><surname>Nevian</surname><given-names>Thomas</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010663</institution-id><institution>H2020 European Research Council</institution></institution-wrap></funding-source><award-id>785907</award-id><principal-award-recipient><name><surname>Senn</surname><given-names>Walter</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010663</institution-id><institution>H2020 European Research Council</institution></institution-wrap></funding-source><award-id>945539</award-id><principal-award-recipient><name><surname>Senn</surname><given-names>Walter</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010663</institution-id><institution>H2020 European Research Council</institution></institution-wrap></funding-source><award-id>682905</award-id><principal-award-recipient><name><surname>Nevian</surname><given-names>Thomas</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A flexible and accurate methodology to fit reduced compartmental models to dendritic morphologies shows that models with very few compartments can capture many dendritic computations.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Morphological neuron models have been instrumental in neuroscience (<xref ref-type="bibr" rid="bib54">Segev and London, 2000</xref>). Major experimental discoveries, for instance that <italic>N</italic>-methyl-D-aspartate (NMDA) channels (<xref ref-type="bibr" rid="bib32">MacDonald and Wojtowicz, 1982</xref>) produce local dendritic all or none responses (<xref ref-type="bibr" rid="bib53">Schiller et al., 2000</xref>; <xref ref-type="bibr" rid="bib34">Major et al., 2008</xref>), or that dendritic Ca<sup>2+</sup>Â spikes mediate coincidence detection between distal inputs and somatic action potentials (APs) (<xref ref-type="bibr" rid="bib30">Larkum et al., 1999</xref>), have been combined in morphological models to arrive at a consistent picture of dendritic integration: the dendrite is an intricate system of semi-independent subunits (<xref ref-type="bibr" rid="bib39">Mel, 1993</xref>; <xref ref-type="bibr" rid="bib46">Poirazi et al., 2003b</xref>; <xref ref-type="bibr" rid="bib45">Poirazi et al., 2003a</xref>), amenable to dynamic regulation (<xref ref-type="bibr" rid="bib47">Poleg-Polsky et al., 2018</xref>; <xref ref-type="bibr" rid="bib64">Wybo et al., 2019</xref>), and able to distinguish specific input patterns (<xref ref-type="bibr" rid="bib6">Branco and HÃ¤usser, 2010</xref>; <xref ref-type="bibr" rid="bib31">Laudanski et al., 2014</xref>).</p><p>Nevertheless, morphological models are not without shortcomings. They are highly complex and consist of thousands of coupled compartments, each receiving multiple non-linear currents. The parameters of the models, typically fitted with evolutionary algorithms to electro-physiological recordings (<xref ref-type="bibr" rid="bib19">Hay et al., 2011</xref>; <xref ref-type="bibr" rid="bib1">Almog and Korngreen, 2014</xref>; <xref ref-type="bibr" rid="bib61">Van Geit et al., 2016</xref>), number in the tens of thousands. Since recordings can only be obtained at a few dendritic sites, these fits are under-constrained, and thus susceptible to over-fitting. Accordingly, the single-neuron fitting challenge, where model performance was measured on unseen spike trains, was not won by a biophysical model, but by an abstract spiking model (<xref ref-type="bibr" rid="bib17">Gerstner and Naud, 2009</xref>; <xref ref-type="bibr" rid="bib14">DiLorenzo and Victor, 2013</xref>). Finally, many network-level observations can be explained without morphological models (<xref ref-type="bibr" rid="bib16">Gerstner et al., 2012</xref>).</p><p>These shortcomings underline the need to find the essential computational repertoire of a neuron: the set of computations needed to understand brain functions such as learning and memory. Model simplification is crucial in this endeavor, as it elucidates the lowest level of complexity at which computational features are preserved. Conceptually, the simplification thus extracts the essential elements required for the computation from the underlying biophysics. Simulation-wise, the reduced model requires few resources and can thus be integrated in large-scale networks. Experimentally, the reduced model likely leads to a well-constrained fit.</p><p>Past simplification efforts can be grouped in two categories: approaches that use traditional compartments, but with adapted parameters (<xref ref-type="bibr" rid="bib43">Pinsky and Rinzel, 1994</xref>; <xref ref-type="bibr" rid="bib12">Destexhe, 2001</xref>; <xref ref-type="bibr" rid="bib58">Tobin et al., 2006</xref>; <xref ref-type="bibr" rid="bib4">Bahl et al., 2012</xref>; <xref ref-type="bibr" rid="bib35">Marasco et al., 2013</xref>; <xref ref-type="bibr" rid="bib2">Amsalem et al., 2020</xref>), and approaches that rely on more advanced mathematical techniques (<xref ref-type="bibr" rid="bib26">Kellems et al., 2009</xref>; <xref ref-type="bibr" rid="bib27">Kellems et al., 2010</xref>; <xref ref-type="bibr" rid="bib62">Wybo et al., 2013</xref>; <xref ref-type="bibr" rid="bib63">Wybo et al., 2015</xref>). Many authors apply adÂ hoc morphological simplifications and then adjust model parameters to conserve geometrical quantities, such as surface area (<xref ref-type="bibr" rid="bib10">Davison et al., 2000</xref>; <xref ref-type="bibr" rid="bib20">Hendrickson et al., 2011</xref>; <xref ref-type="bibr" rid="bib35">Marasco et al., 2013</xref>), or electrical quantities, such as attenuation (<xref ref-type="bibr" rid="bib12">Destexhe, 2001</xref>) and transfer impedance (<xref ref-type="bibr" rid="bib2">Amsalem et al., 2020</xref>). Other authors propose two-compartment models whose parameters are adjusted to reproduce certain response properties (<xref ref-type="bibr" rid="bib43">Pinsky and Rinzel, 1994</xref>; <xref ref-type="bibr" rid="bib41">Naud et al., 2014</xref>). Nevertheless, these approaches often lack the flexibility to be adapted to a wide range of dendritic computations. Furthermore, particular afferent spatial connectivity motifs might be lost, so that essential computations are not captured by such a reduction. Hence, in a network model, the computational relevance of these motifs might unknowingly be ignored. Advanced mathematical techniques on the other hand are very flexible, as they can incorporate the response properties of the morphology implicitly.Â (<xref ref-type="bibr" rid="bib62">Wybo et al., 2013</xref>Â and <xref ref-type="bibr" rid="bib63">Wybo et al., 2015</xref> propose a system of convolutions whose kernels capture the passive properties of the compartmental model, whereas <xref ref-type="bibr" rid="bib26">Kellems et al., 2009</xref>Â and <xref ref-type="bibr" rid="bib27">Kellems et al., 2010</xref>Â linearly transform the compartmental model into a low-dimensional basis.) However, these techniques are not supported by standard simulation software, such as NEURON (<xref ref-type="bibr" rid="bib8">Carnevale and Hines, 2004</xref>), a considerable hurdle toward their integration in the canonical neuroscience toolset.</p><p>Here, we introduce a simplification method with the flexibility of advanced mathematical techniques, but using traditional compartments. The approach accommodates any morphological model in public repositories (<xref ref-type="bibr" rid="bib38">McDougal et al., 2017</xref>) and commonly used ion channels (<xref ref-type="bibr" rid="bib44">Podlaski et al., 2017</xref>). The reduced models represent the optimal approximation to the dendritic resistance matrix, evaluated at any spatial resolution of choice. We fit ion channels by approximating the quasi-active resistance matrices (<xref ref-type="bibr" rid="bib29">Koch and Poggio, 1985</xref>). All our fits are uniquely solvable linear least-squares problems. The obtained models extrapolate well to non-linear dynamics, and reproduce back-propagating APs (bAPs), Ca<sup>2+</sup>Â spikes (<xref ref-type="bibr" rid="bib30">Larkum et al., 1999</xref>), and NMDA spikes (<xref ref-type="bibr" rid="bib53">Schiller et al., 2000</xref>; <xref ref-type="bibr" rid="bib34">Major et al., 2008</xref>) with few compartments. Additionally, we investigate whether a dendritic tree with given afferent spatial connectivity motifs can be simplified by ablating subtrees or branches and grouping synapses in the next proximal compartment. We find that effective weight-rescale factors for synapses can be computed if temporal conductance fluctuations stay below a limit that depends on the difference in input resistance between the ablated branch and the next proximal dendrite. Under application of these factors, voltage responses in the simplified tree are preserved. Finally, we demonstrate that our approach can fit reduced models to experimental recordings, without the need to reconstruct full morphologies. We have created a Python toolbox (NEural Analysis Toolbox â NEAT â <ext-link ext-link-type="uri" xlink:href="https://github.com/unibe-cns/NEAT">https://github.com/unibe-cns/NEAT</ext-link>) (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:7941f171d5917484eeafa5e76f9657073666a66a;origin=https://github.com/unibe-cns/NEAT;visit=swh:1:snp:0afcc15cf2ef0084749e7f7677ebf0324695dec3;anchor=swh:1:rev:1cb15f36aa0a764105348541d046c85ef38e21ee/">swh:1:rev:1cb15f36aa0a764105348541d046c85ef38e21ee</ext-link>)Â that implements this method together with an extension to NEURON to simulate the obtained models.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>A systematic simplification of complex neuron morphologies</title><p>Our simplification strategy fits compartments with voltage-gated channels to a reduced set of dendritic locations of interest (<xref ref-type="fig" rid="fig1">Figure 1A</xref>, left-middle). The locations, together with the morphology, provide a tree structure for the reduced model (<xref ref-type="fig" rid="fig1">Figure 1A</xref>, middle-right) where each node corresponds to a traditional compartment and each edge to a coupling conductance. The fit requires that the reduced model responds similarly to perturbative current steps as the full neuron, at the set of chosen locations (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). We consider perturbations around any spatially uniform holding potentialÂ <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Experimentally, <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> may be reached by injecting a constant currentÂ <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, and thus <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the effective equilibrium potential under this current injection. In models, we do not need to know <inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>; we simply assume that <inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the equilibrium potential around which to linearize the model. Note that if <inline-formula><mml:math id="inf7"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the resting membrane potential.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Flexible and accurate reduction methodology.</title><p>(<bold>A</bold>) For any set of locations on a given morphology (left, here an L2/3 pyramidal cell [<xref ref-type="bibr" rid="bib6">Branco and HÃ¤usser, 2010</xref>]), a reduced compartmental model can be derived (middle), with an associated schematic representation (right). (<bold>B</bold>) Steps of our approach: (1) choice of locations at which the reduced model should reproduce the full modelâs voltage, (2) coupling, leak and channel conductances are fitted to resistance matrices derived from the full model at different holding potentials, and (3) capacitances are fitted to mimic the largest eigenmode of the full model. (<bold>C</bold>) The resistance matrix of the passive full model (top) restricted to the five locations inÂ <bold>A</bold> is approximated accurately by the inverse of the conductance matrix of the passive reduced model (bottom). Labels correspond to locations in <bold>A</bold>. (<bold>D</bold>) Example components of the quasi-active resistance matrix of the full model, equipped with a Na<sup>+</sup>-channel, as a function of the holding potential <inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Red lines show the four holding potentials at which our methodology evaluates the resistance matrix. Singularities correspond to holding potentials where the linearization is invalid and should be avoided in the fit. Labels correspond to locations in <bold>A</bold>. (<bold>E</bold>) Temporal shape of exemplar input impedance kernels of the full model (gray) and their reduced counterparts (blue, dashed). (<bold>F</bold>) Same as in <bold>E</bold>, but for transfer impedance kernels.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-60936-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1âfigure supplement 1.</label><caption><title>Resistance matrix fit details.</title><p>(<bold>A</bold>) Error of the reduced modelâs resistance matrix compared to the full modelâs resistance matrix, for reductions of the passive L2/3 pyramid with 2, 5, 10, 20, and 50 compartments. Five random sets of fit locations were chosen for each compartment number; mean (marker) and standard deviation (error bars) are shown. (<bold>B</bold>) Same as <bold>A</bold>, but for the impedance kernels. (<bold>C</bold>) The bifurcations between compartment sites need to be added, as shown in the red forked dendrite (left). Soma <inline-formula><mml:math id="inf10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and two compartment sites 1,Â 2 (top) were augmented with a site <inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> on the main trunk (but not at a bifurcation, middle) or a site <inline-formula><mml:math id="inf12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> at the bifurcation (bottom). Reductions were derived for all three configurations, but only the last configuration can accurately approximate all resistances (right). (<bold>D</bold>) Resistance matrices for the soma <italic>S</italic> and location five in <xref ref-type="fig" rid="fig1">Figure 1A</xref>, with Na<sup>+</sup>-channels at the soma. The resistance matrix <inline-formula><mml:math id="inf13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (first column) depends on <inline-formula><mml:math id="inf14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. The inverse of the matrix <inline-formula><mml:math id="inf15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (second column) is fitted by adjusting the maximal Na<sup>+</sup> conductance parameter so that <inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Z</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> at the four holding potentials. <inline-formula><mml:math id="inf17"><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> matches <inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> closely, as the difference between both matrices is close to zero (third column). (<bold>E</bold>) Behavior of the input and transfer resistances between a compartment site <inline-formula><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (green square) and a synapse site <inline-formula><mml:math id="inf20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> located more distally on the same subtree (only a single branch is shown for clarity, marked in green). Transfer resistance between <inline-formula><mml:math id="inf21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> remains close to the input resistance at <inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, while input resistance at <inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> increases markedly with distance. This principle holds in the apical (top) as well as basal (bottom) dendrites.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-60936-fig1-figsupp1-v1.tif"/></fig></fig-group><p>Suppose we have chosen <inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> locations. Let <inline-formula><mml:math id="inf26"><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold">ð¢</mml:mi></mml:mrow></mml:math></inline-formula> be a vector describing perturbative input currents to each of those <inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> locations. The linearized voltage response of the full neuron, at those locations, is given in the Fourier domain for an input of a particular frequency <inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> by<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi>ð¯</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Ï</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Ï</mml:mi><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi>ð¢</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Ï</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>with <inline-formula><mml:math id="inf29"><mml:msub><mml:mi>Z</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> the quasi-active (<xref ref-type="bibr" rid="bib29">Koch and Poggio, 1985</xref>) <inline-formula><mml:math id="inf30"><mml:mrow><mml:mi>N</mml:mi><mml:mo>Ã</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> impedance matrix. In experiments, <inline-formula><mml:math id="inf31"><mml:msub><mml:mi>Z</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> is extracted from <inline-formula><mml:math id="inf32"><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold">ð¯</mml:mi></mml:mrow></mml:math></inline-formula> measured in response to <inline-formula><mml:math id="inf33"><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold">ð¢</mml:mi></mml:mrow></mml:math></inline-formula>. In models, <inline-formula><mml:math id="inf34"><mml:msub><mml:mi>Z</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> is algorithmically computed based on the full morphology, the parameters of the passive currents, and the dynamics of the voltage-gated ion channels (<xref ref-type="bibr" rid="bib29">Koch and Poggio, 1985</xref>). For our reduction method, we consider perturbative current steps, so that after an equilibration period, we obtain a steady-state voltage response <inline-formula><mml:math id="inf35"><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold">ð¯</mml:mi></mml:mrow></mml:math></inline-formula>. Note that this corresponds to evaluating (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>) at zero frequency, and that the corresponding matrix <inline-formula><mml:math id="inf36"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Ï</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> contains the input and transfer resistances. Throughout the manuscript, we maintain the notation that <inline-formula><mml:math id="inf37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> without argument signifies <inline-formula><mml:math id="inf38"><mml:mrow><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Ï</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, representing an individual input or transfer resistance, and that <inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> signifies <inline-formula><mml:math id="inf40"><mml:mrow><mml:mi>Z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Ï</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, representing the resistance matrix.</p><p>Linearizing the reduced compartmental model around a holding potential (see Materials and methods â The conductance matrix) yields an <inline-formula><mml:math id="inf41"><mml:mrow><mml:mi>N</mml:mi><mml:mo>Ã</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> conductance matrix <inline-formula><mml:math id="inf42"><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:msub></mml:math></inline-formula>, with on its diagonal<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">â</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>â</mml:mo><mml:msub><mml:mi class="ltx_font_mathcaligraphic">ð©</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>â¢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">â</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>â</mml:mo><mml:msub><mml:mi class="ltx_font_mathcaligraphic">â</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>Â¯</mml:mo></mml:mover><mml:mrow><mml:mi>d</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf43"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the unknown leak conductance of the <inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>-th compartment, <inline-formula><mml:math id="inf45"><mml:msub><mml:mi class="ltx_font_mathcaligraphic">ð©</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> the set of nearest neighbor compartments, and <inline-formula><mml:math id="inf46"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>â¢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> the unknown coupling conductance between compartment <inline-formula><mml:math id="inf47"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and compartment <inline-formula><mml:math id="inf48"><mml:mrow><mml:mi>n</mml:mi><mml:mo>â</mml:mo><mml:msub><mml:mi class="ltx_font_mathcaligraphic">ð©</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. The second sum runs over the set <inline-formula><mml:math id="inf49"><mml:msub><mml:mi class="ltx_font_mathcaligraphic">â</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> of all linearized currents of ion channels present in compartment <inline-formula><mml:math id="inf50"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf51"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>Â¯</mml:mo></mml:mover><mml:mrow><mml:mi>d</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the unknown maximal conductance of ion channel <inline-formula><mml:math id="inf52"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf53"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a factor that follows from linearizing the dynamics of channel <inline-formula><mml:math id="inf54"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> around the holding potential <inline-formula><mml:math id="inf55"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (see MaterialsÂ andÂ methods â Quasi-active channels). Thus, the unknowns <inline-formula><mml:math id="inf56"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf57"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>â¢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> for <inline-formula><mml:math id="inf58"><mml:mrow><mml:mi>n</mml:mi><mml:mo>â</mml:mo><mml:msub><mml:mi class="ltx_font_mathcaligraphic">ð©</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf59"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>Â¯</mml:mo></mml:mover><mml:mrow><mml:mi>d</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for <inline-formula><mml:math id="inf60"><mml:mrow><mml:mi>d</mml:mi><mml:mo>â</mml:mo><mml:msub><mml:mi class="ltx_font_mathcaligraphic">â</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are to be fitted for each compartment, and the factors <inline-formula><mml:math id="inf61"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are known and determined by the ion-channel dynamics. The <inline-formula><mml:math id="inf62"><mml:mrow><mml:mi>i</mml:mi><mml:mo>â¢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>âth off-diagonal element of <inline-formula><mml:math id="inf63"><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> is <inline-formula><mml:math id="inf64"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>â¢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> â the negative of the coupling conductance between compartments <inline-formula><mml:math id="inf65"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf66"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> â if <inline-formula><mml:math id="inf67"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf68"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> are nearest neighbor compartments on the reduced tree structure, and zero otherwise. The conductance matrix relates the reduced modelâs voltage response to the perturbative input current steps<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi>ð¯</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi>ð¢</mml:mi></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The full neuron and reduced model will behave similarly for all possible perturbative input steps <inline-formula><mml:math id="inf69"><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold">ð¢</mml:mi></mml:mrow></mml:math></inline-formula> if their responses <inline-formula><mml:math id="inf70"><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold">ð¯</mml:mi></mml:mrow></mml:math></inline-formula> match. From (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>) and (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref>), it follows that <inline-formula><mml:math id="inf71"><mml:msub><mml:mi>Z</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> should be the inverse of <inline-formula><mml:math id="inf72"><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:msub></mml:math></inline-formula>. Consequently, we require that multiplying the known <inline-formula><mml:math id="inf73"><mml:msub><mml:mi>Z</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> (measured or calculated) by the parametric <inline-formula><mml:math id="inf74"><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> yields the identity<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>â</mml:mo><mml:mi>I</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>From (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref>), it can be seen that (<xref ref-type="disp-formula" rid="equ4">Equation 4</xref>) is linear in the parameters that have to be fitted (leak, coupling, and maximal ion-channel conductances of the reduced compartments). By consequence, (<xref ref-type="disp-formula" rid="equ4">Equation 4</xref>) can be cast into a least-squares problem and solved accurately (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1âfigure supplement 1A</xref>).</p><p>Since the linearized ion channel activation <inline-formula><mml:math id="inf75"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> depends on the holding potential, <inline-formula><mml:math id="inf76"><mml:msub><mml:mi>Z</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> changes with <inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). The fit must disentangle the changes in <inline-formula><mml:math id="inf78"><mml:msub><mml:mi>Z</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> induced by the various channels. In models, we first block all voltage-gated ion channels in the full and reduced models and fit <inline-formula><mml:math id="inf79"><mml:msub><mml:mi>G</mml:mi><mml:mtext>pas</mml:mtext></mml:msub></mml:math></inline-formula> to <inline-formula><mml:math id="inf80"><mml:msub><mml:mi>Z</mml:mi><mml:mtext>pas</mml:mtext></mml:msub></mml:math></inline-formula> according to (<xref ref-type="disp-formula" rid="equ4">Equation 4</xref>), and thus obtain leak and coupling conductances for each compartment. Then, we unblock one ion channel at a time and decompose the conductance matrix into <inline-formula><mml:math id="inf81"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mtext>pas</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext>chan</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="inf82"><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext>chan</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> a diagonal matrix containing the conductances of the unblocked channel, linearized around <inline-formula><mml:math id="inf83"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, at each compartment. Thus <inline-formula><mml:math id="inf84"><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext>chan</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> depends linearly on the unknown maximal ion channel conductance parameters. With <inline-formula><mml:math id="inf85"><mml:msub><mml:mi>Z</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf86"><mml:msub><mml:mi>G</mml:mi><mml:mtext>pas</mml:mtext></mml:msub></mml:math></inline-formula> known, we optimize these maximal conductances, so that the left-hand side of<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext>chan</mml:mtext></mml:mrow></mml:msub><mml:mo>â</mml:mo><mml:mi>I</mml:mi><mml:mo>â</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mtext>pas</mml:mtext></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>matches the right-hand side, and that it does so for multiple holding potentials (we chose <inline-formula><mml:math id="inf87"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>75</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>55</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>35</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>â</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>Â mV, <xref ref-type="fig" rid="fig1">Figure 1D</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1âfigure supplement 1D</xref>). Thus, we obtain an overdetermined system of equations in the unknown maximal channel conductances at each compartment and compute its solution in the least mean squares sense.</p><p>Having fixed the steady-state behavior of the reduced model, we are left with the capacitance of each compartment of the reduced model to match the temporal dynamics of the full model as closely as possible. In our reductions, the capacitance of each compartment is thus a parameter to be fitted. To do so, we found it sufficient to consider passive membrane dynamics. Blocking all voltage-gated ion channels in the reduced model (<inline-formula><mml:math id="inf89"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext>chan</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), temporal voltage responses follow<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mrow><mml:mtext>diag</mml:mtext><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ð</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mover accent="true"><mml:mi>ð¯</mml:mi><mml:mo>Ë</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mtext>pas</mml:mtext></mml:msub><mml:mo>â¢</mml:mo><mml:mi>ð¯</mml:mi></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mi>ð¢</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>with <inline-formula><mml:math id="inf90"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula> a vector containing the unknown capacitance of each compartment. We require that voltage-decay back to rest, as described by (<xref ref-type="disp-formula" rid="equ6">Equation 6</xref>), matches voltageÂ decay in the full neuron with all active channels blocked, at the <inline-formula><mml:math id="inf91"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> chosen locations. According to linear dynamical systems theory (<xref ref-type="bibr" rid="bib56">Strogatz, 2000</xref>), this decay can be decomposed as a sum of exponentially decaying eigenmodes, each with an associated eigenvalue <inline-formula><mml:math id="inf92"><mml:msub><mml:mi>Î±</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula> and eigenvector <inline-formula><mml:math id="inf93"><mml:msub><mml:mi mathvariant="bold-italic">Ï</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula>. The former gives the exponential timeÂ scale <inline-formula><mml:math id="inf94"><mml:mrow><mml:msub><mml:mi>Ï</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>Î±</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> of the decay and the latter the spatial profile of the mode. The most prominent of these modes has the largest timeÂ scale <inline-formula><mml:math id="inf95"><mml:mrow><mml:msub><mml:mi>Ï</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>Î±</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and primarily models the voltage decay back to rest through trans-membrane currents (<xref ref-type="bibr" rid="bib21">Holmes et al., 1992</xref>). In experiments, we extract this mode by fitting an exponential to the voltage decay. In full models, we compute the eigenvalue <inline-formula><mml:math id="inf96"><mml:msub><mml:mi>Î±</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> and eigenvector <inline-formula><mml:math id="inf97"><mml:msub><mml:mi mathvariant="bold-italic">Ï</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> â restricted to the <inline-formula><mml:math id="inf98"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> chosen locations â with the separation-of-variables method (<xref ref-type="bibr" rid="bib33">Major et al., 1993</xref>). In the reduced model, eigenmodes are found as the eigenvalues and eigenvectors of the matrix <inline-formula><mml:math id="inf99"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mtext>diag</mml:mtext><mml:mo>â¢</mml:mo><mml:mpadded width="+1.7pt"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mpadded><mml:mo>â¢</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mtext>pas</mml:mtext></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. To fit the capacitances, we require that <inline-formula><mml:math id="inf100"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> has <inline-formula><mml:math id="inf101"><mml:msub><mml:mi>Î±</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> as eigenvalue and <inline-formula><mml:math id="inf102"><mml:msub><mml:mi mathvariant="bold-italic">Ï</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> as corresponding eigenvector:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">Ï</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>Î±</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>â¢</mml:mo><mml:mpadded width="+1.7pt"><mml:msub><mml:mi mathvariant="bold-italic">Ï</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mpadded></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This system of equations is linear in the reciprocals of the capacitances entering in <inline-formula><mml:math id="inf103"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and can thus be solved efficiently.</p><p>To accurately reproduce the spatio-temporal voltage responses of the full model, the reduced model must approximate the âimpedance kernelsâ <inline-formula><mml:math id="inf104"><mml:mrow><mml:mi>z</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib63">Wybo et al., 2015</xref>), the inverse Fourier transforms of the frequency-dependent elements of the impedance matrix. Despite only fitting the largest timeÂ scale <inline-formula><mml:math id="inf105"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>Î±</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, we accurately reproduce kernels at all times (<xref ref-type="fig" rid="fig1">Figure 1E,F</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1âfigure supplement 1B</xref>).</p><p>Unless a large number of closely spaced compartment sites is retained on the morphology, our reductions replace the true axial currents flowing along the dendritic tree, which are shaped by the distribution of ion channels in the dendritic membrane, with a strong abstraction: a single coupling conductance between compartments that may be far apart. Hence, it is not guaranteed that the resting voltage of reduced model will be equal to the resting voltage of the full model, at the <inline-formula><mml:math id="inf106"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> chosen locations. We ensure that this will be the case by fitting the leak reversals for each compartment. The product of leak conductance and reversal represents a constant current for each compartment, and thus does not influence model dynamics beyond fixing itâs resting voltage. To fit the leak reversals, we evaluate all ion-channel currents in the reduced model at the full modelâs resting voltage and require that temporal voltage derivatives are zero. The obtained equations are linear in the reduced modelâs leak reversals, and hence can be solved efficiently. Note that our methodology does not guarantee that the obtained reversals are within physiological limits. Thus, they should purely be seen as fit parameters that determine the resting membrane potential.</p></sec><sec id="s2-2"><title>Reduced models match the voltage response of their full counterparts</title><p>We demonstrated the reduction on two computations that require accurate spatio-temporal interaction. We reproduced sequence discrimination in an L2/3 pyramidal cell model (<xref ref-type="bibr" rid="bib6">Branco and HÃ¤usser, 2010</xref>), where a neuron responds more strongly to a centripetal sequence of inputs than to a centrifugal one, by only retaining compartments on a single branch (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). We also reproduced input-order detection (<xref ref-type="bibr" rid="bib59">Torben-Nielsen and Stiefel, 2009</xref>), where a neuron responds more strongly when one input arrives before the other, by only retaining compartments at the soma and the two input sites (<xref ref-type="fig" rid="fig2">Figure 2B</xref>).</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Voltage-match between full and reduced models for spatio-temporal dendritic computations.</title><p>(<bold>A</bold>) Reduction of full model (right) to a single branch (middle) reproduces sequence discrimination (right), full model in gray, and reduced model colored for different time-steps between inputs, centripetal (dashed), and centrifugal (dash-dotted). (<bold>B</bold>) Full model (left) and three-compartment reduction (middle, bottom) discriminate temporal order of inputs, where the response to inputs (middle, top) ordered <inline-formula><mml:math id="inf107"><mml:mrow><mml:mn>1</mml:mn><mml:mo>â</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> is stronger than <inline-formula><mml:math id="inf108"><mml:mrow><mml:mn>2</mml:mn><mml:mo>â</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Voltage responses (right) in full model (gray) and reduced model (colored). (<bold>C, D</bold>) Reductions of resp. L5 pyramidal and Purkinje cells with active ion channels at the soma, and excitatory (AMPA+NMDA) and inhibitory (GABA) synapses at dendritic compartment sites. From left to right: full model with compartment sites (soma <italic>S</italic> and a selected dendrite site <italic>D</italic> are labeled), reduced model, somatic voltage with zoom on a single AP (full model in gray and reduced model in purple, input spikes at the bottom), dendritic voltage at <italic>D</italic> (full model in gray and reduced model in green, input spikes at the bottom), and the relative root mean square voltage errors at each compartment (root mean squared error normalized by the standard deviation <inline-formula><mml:math id="inf109"><mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>â¢</mml:mo><mml:mi>R</mml:mi><mml:mo>â¢</mml:mo><mml:mi>M</mml:mi><mml:mo>â¢</mml:mo><mml:mi>S</mml:mi><mml:mo>â¢</mml:mo><mml:mi>E</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msqrt><mml:mrow><mml:mtext>Avg</mml:mtext><mml:mo>â¢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mtext>full</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mtext>reduced</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>/</mml:mo><mml:msub><mml:mi>Ï</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mtext>full</mml:mtext></mml:msub></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>). Spike coincidence factor <inline-formula><mml:math id="inf110"><mml:mi mathvariant="normal">Î</mml:mi></mml:math></inline-formula> is also shown.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-60936-fig2-v1.tif"/></fig><p>We then tested our approach with non-linear currents concentrated at discrete points (hot-spots) along the morphology. In two biophysical models â an L5 neocortical pyramid (<xref ref-type="bibr" rid="bib19">Hay et al., 2011</xref>; <xref ref-type="fig" rid="fig2">Figure 2C</xref>) and a Purkinje cell (<xref ref-type="bibr" rid="bib9">Chen et al., 2013</xref>; <xref ref-type="bibr" rid="bib40">Miyasho et al., 2001</xref>; <xref ref-type="fig" rid="fig2">Figure 2D</xref>) â we removed active dendritic channels, but added their total conductance at rest to the passive leak (we term this the 'passifiedâ model), while retaining all active channels at the soma. The soma, with its AP-generating channels, naturally forms such a non-linear hot-spot. We implemented dendritic hot-spots by clustering sets of excitatory (Î±-amino-3-hydroxy-5-methyl-4-isoxazolepropionic acid [AMPA] + NMDA) and inhibitory (Î³-aminobutyric acid [GABA]) synapses at randomly selected points on the morphology. Both the reduced pyramidal cell model and the reduced Purkinje cell model accurately reproduced the somatic and dendritic membrane voltage traces of their full counterparts (<xref ref-type="fig" rid="fig2">Figure 2C,D</xref>, middle panels). Furthermore, 97% and 89% of APs coincided within a 6 ms window,Â respectively (<xref ref-type="bibr" rid="bib24">Jolivet et al., 2008</xref>; <xref ref-type="fig" rid="fig2">Figure 2C,D</xref>, right panels).</p><p>Models with passive dendritic membranes but non-linear synapse clusters can already reproduce much of the canonical computational repertoire of dendrites. Clusters of AMPA+NMDA synapses at the distal tips of basal dendrites can make neurons function as two-layer networks (<xref ref-type="bibr" rid="bib39">Mel, 1993</xref>; <xref ref-type="bibr" rid="bib46">Poirazi et al., 2003b</xref>; <xref ref-type="bibr" rid="bib45">Poirazi et al., 2003a</xref>). Such reduced models also exhibit the same robustness to input noise as the full models (<xref ref-type="bibr" rid="bib48">Poleg-Polsky, 2019</xref>), and can include modulation of the co-operativity between AMPA+NMDA clusters through compartments with shunting conductances (<xref ref-type="bibr" rid="bib64">Wybo et al., 2019</xref>). Furthermore, because our reduced models reproduce dendritic input impedance properties, long time-scale NMDA currents activate strongly in distal compartments as high distal input impedance helps to overcome their voltage-dependent Mg<sup>2+</sup>Â block (<xref ref-type="bibr" rid="bib22">Jahr and Stevens, 1990a</xref>; <xref ref-type="bibr" rid="bib23">Jahr and Stevens, 1990b</xref>), whereas short time-scale AMPA currents dominate in more proximal compartments. Thus passive models with non-linear synapse clusters also capture the shift in computational strategy from a proximal temporal code to a distal rate code (<xref ref-type="bibr" rid="bib7">Branco and HÃ¤usser, 2011</xref>).</p><p>What level of spatial complexity reproduces characteristic responses generated by somatic and dendritic ion channels? These responses arise through the interplay of integrative properties of the morphology â captured in the impedance kernels <inline-formula><mml:math id="inf111"><mml:mrow><mml:mi>z</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> â and channel dynamics. If a full model (here the L2/3 pyramid) is reduced to a single somatic compartment (<xref ref-type="fig" rid="fig3">Figure 3A</xref>), the impedance kernel has only one timeÂ scale â the membrane time-scale (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, top â purple). The kernel of the full model contains additional shorter timeÂ scales (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, topÂ âÂ gray), leading to a faster APÂ onset than in the reduced model (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, bottom). This effect is thus a fundamental limitation of the single-compartment reduction. Extending the compartmental model with four nearby dendritic sites (<xref ref-type="fig" rid="fig3">Figure 3A</xref>) adds fast components to the somatic impedance kernel (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, top â green) that model the spread of charge to the other compartments. These components increase AP amplitude and decrease AP delay (<xref ref-type="fig" rid="fig3">Figure 3C</xref>), leading to a better match with the full model.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Dendritic computations with active channels are captured by our reduced models.</title><p>(<bold>AâC</bold>) Effect of compartment distribution on AP dynamics in reduced models. (<bold>A</bold>) One- and five-compartment reductions of the L2/3 pyramid, equipped with somatic and dendritic ion channels. (<bold>B</bold>) Differences in shortÂ time-scale behavior in somatic input impedance kernels (top) between full model (gray) and one- (purple) and five-compartment (green) reductions result in different AP delays (bottom). (<bold>C</bold>) AP amplitude (top) and AP delay (bottom) for the three models (colors as in <bold>B</bold>). (<bold>DâF</bold>) Effect of compartment distribution on AP back-propagation in basal dendrites. (<bold>D</bold>) Four- and two-compartment reductions of a basal branch. (<bold>E</bold>) APs at soma (top) and most distal compartment site (bottom) for four models (full in gray, four compartments in blue, two compartments in orange, and full but with a passive dendrite in green). (<bold>F</bold>) Amplitude (top) and delay (bottom) for bAPs at different distances from soma (if compartment is present in model), averaged over all basal branches longer than 150 Î¼m (error bars indicate standard deviation). (<bold>GâI</bold>) AP back-propagation in the apical dendrite of the L5 pyramid. (<bold>G</bold>) Reductions of the apical dendrite with increasing inter-compartment spacing. (<bold>H</bold>) Voltage waveform at soma (top, full in gray, <inline-formula><mml:math id="inf112"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mo>â¢</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> Î¼m in blue, <inline-formula><mml:math id="inf113"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mo>â¢</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math></inline-formula> Î¼m in orange) and two dendritic sites (middle, bottom). (<bold>I</bold>) Waveform amplitude as a function of distance to soma for various inter-compartment spacings. (<bold>J, K</bold>) Ca<sup>2+</sup>-spike-mediated coincidence detection. (<bold>J</bold>) Reduction of the L5-pyramidâs apical dendrite to 11 compartments. (<bold>K</bold>) Response to a somatic current pulse (top, left), a dendritic synaptic current waveform (top, right), and the coincident arrival of both inputs (bottom).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-60936-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3âfigure supplement 1.</label><caption><title>Further reduction of the configuration in <xref ref-type="fig" rid="fig3">Figure 3J</xref> by omitting compartments in the apical trunk of the L5 pyramid.</title><p>(<bold>A</bold>) The compartment sites on the morphology. (<bold>B</bold>) Ca<sup>2+</sup> mediated coincidence detection between somatic and dendritic inputs does not result in an AP burst. Response to a somatic current pulse (top, left), a dendritic synaptic current waveform (top, right), and the coincident arrival of both inputs (bottom). Stimulus parameters where identical to <xref ref-type="fig" rid="fig3">Figure 3</xref>, except the amplitude of the dendritic input current, which was increased to 0.75 nA. (<bold>C</bold>) Somatic input impedance kernel (top), input impedance kernel at most proximal dendritic location (middle, marked with <italic>D</italic> in <bold>A</bold>) and transfer impedance kernel between soma and dendritic location. Full model (gray), reduction with trunk (blue, configuration as in <xref ref-type="fig" rid="fig3">Figure 3J</xref>), andÂ reduction without trunk (orange, configuration as in <bold>A</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-60936-fig3-figsupp1-v1.tif"/></fig></fig-group><p>Dendritic ion channels support the back-propagation of APs (<xref ref-type="bibr" rid="bib57">Stuart et al., 1997</xref>). For each basal branch of at least 150 Î¼m in the L2/3 pyramid, we derived reduced models with three compartments (at 50, 100, and 150 Î¼m from the soma) and with one compartment. We compared bAP amplitudes and delays relative to the somatic AP (<xref ref-type="fig" rid="fig3">Figure 3E</xref>) and found that even models with a single distal compartment support active back-propagation (<xref ref-type="fig" rid="fig3">Figure 3E,F</xref>). In the apical dendrite of the L5 pyramid (<xref ref-type="fig" rid="fig3">Figure 3G</xref>), we found that a distance step of 100 Î¼m between compartments was required to support bAPs to the same degree as in the full model (<xref ref-type="fig" rid="fig3">Figure 3H,I</xref>).</p><p>Finally, we considered the pairing of a somatic current pulse with a dendritic post-synaptic potential waveform. We found that an 11-compartment reduction (<xref ref-type="fig" rid="fig3">Figure 3J</xref>) â with compartments spaced at 100 Î¼m through the apical trunk to support bAPs until the Ca<sup>2+</sup> hot-zone â reproduced the Ca<sup>2+</sup>-mediated coincidence detection mechanism (<xref ref-type="bibr" rid="bib30">Larkum et al., 1999</xref>; <xref ref-type="bibr" rid="bib42">PÃ©rez-Garci et al., 2013</xref>).</p></sec><sec id="s2-3"><title>Conditions under which afferent spatial connectivity motifs can be simplified</title><p>Our method allows us to reduce morphological complexity by removing any branch or subtree without affecting the integrative properties of other branches or subtrees. Up until now, we have only considered reductions where the to-be removed branch or subtree does not receive direct synaptic input. However, if this branch or subtree does receive synaptic input, the morphological reduction also simplifies the afferent spatial connectivity motifs targeting it, as synapses have to be grouped at the nearest proximal intact compartment. We assess whether the computational repertoire of the neuron remains intact under such a simplification, or which elements of the repertoire might be lost. We study two proxies for this repertoire: the voltage difference between full and reduced models at the intact compartments â in order to assess whether the output of local computations in the ablated branch or subtree can be recovered, and the difference between full and reduced models in NMDA-spike threshold at the nearest proximal intact compartment (quantified as the smallest number of AMPA+NMDA synapses with a weight of 1 nS that need to be activated simultaneously to elicit an NMDA spike) â in order to assess whether local integrative properties at the intact compartments can also be retained under the shift of synapses. We allow ourselves the liberty of rescaling the weights of the shifted synapses by a temporally constant factor <inline-formula><mml:math id="inf114"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Î²</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). Which spatial synapse distributions admit simplification in this sense, and under which input conditions?</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Simplification of afferent spatial connectivity motifs.</title><p>(<bold>A</bold>) Removal of a branch with a synapse (red triangle) is considered possible if the correct voltages at the compartment sites (here, dendritic â green square and somatic â purple square) can be obtained by shifting the synapse to the compartment site and rescaling its weight with a fixed factor <inline-formula><mml:math id="inf115"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Î²</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> for the all input conditions under consideration. (<bold>B</bold>) Comparison between weight-rescale factors for current-based (left) and conductance-based (right) input. Voltage trace for dendritic compartment without rescaling (gray) and with the current-based scale factor <inline-formula><mml:math id="inf116"><mml:msub><mml:mi>Î²</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo mathvariant="normal">â¢</mml:mo><mml:mi>u</mml:mi><mml:mo mathvariant="normal">â¢</mml:mo><mml:mi>r</mml:mi><mml:mo mathvariant="normal">â¢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> compensating for attenuation (blue). Bottom right panel shows voltage trace with conductance-based scale factor <inline-formula><mml:math id="inf117"><mml:msub><mml:mi>Î²</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo mathvariant="normal">â¢</mml:mo><mml:mi>o</mml:mi><mml:mo mathvariant="normal">â¢</mml:mo><mml:mi>n</mml:mi><mml:mo mathvariant="normal">â¢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. (<bold>C</bold>) Current- and conductance-based scale factors in the green dendritic branch, for a shift of a synapse at a given distance from the soma to the dendritic compartment site (green square). (<bold>D</bold>) Spatial peak voltage without (left, blue) and with (right, orange) application of <inline-formula><mml:math id="inf118"><mml:msub><mml:mi>Î²</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo mathvariant="normal">â¢</mml:mo><mml:mi>o</mml:mi><mml:mo mathvariant="normal">â¢</mml:mo><mml:mi>n</mml:mi><mml:mo mathvariant="normal">â¢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. (<bold>E</bold>) For a cluster of AMPA+NMDA synapses in isolation, scale factors for physiological constants can be obtained (see Materials and methods â Synaptic weight-rescale factors) that reproduce the correct voltage waveform. Colors as in <bold>D</bold>. (<bold>F</bold>) Maximal amplitude of NMDA-spike waveform upon activation of increasing numbers of synapses â NMDA-spike thresholds indicated with vertical lines. Colors as in <bold>D</bold>. (<bold>GâH</bold>) Removing a whole subtree and shifting multiple synapses (red triangles) to the next proximal compartment site (green square). NMDA-spike generation (gray voltage trace) at the compartment site through burst inputs to local AMPA+NMDA synapses (green inputs), with AMPA (blue) and GABA (red) background inputs spread throughout the subtree. Reductions shown without rescaling (blue, dash-dotted), with the analytical single-site rescaling rule (red, full) and the numerical multi-site rule (orange, dashed). (<bold>I</bold>) Error in NMDA-spike threshold for the three cases in <bold>H</bold>. (<bold>J</bold>) Dependence of the error in NMDA-spike threshold on the factor <inline-formula><mml:math id="inf119"><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mo mathvariant="normal">â¢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>z</mml:mi></mml:mpadded><mml:mo mathvariant="normal">â¢</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="inf120"><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mo mathvariant="normal">â¢</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> the average input resistance difference between synapse sites and the compartment and <inline-formula><mml:math id="inf121"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> the average synaptic conductance.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-60936-fig4-v1.tif"/></fig><p>For a single, current-based synapse, shifted from its original location on the ablated branch to the next proximal compartment, we analytically compute the weight-rescale factor and find <inline-formula><mml:math id="inf122"><mml:mrow><mml:msub><mml:mi>Î²</mml:mi><mml:mtext>curr</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="inf123"><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> the transfer resistance from synapse site <inline-formula><mml:math id="inf124"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> to compartment site <inline-formula><mml:math id="inf125"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf126"><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> the input resistance at <inline-formula><mml:math id="inf127"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Since <inline-formula><mml:math id="inf128"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib28">Koch, 1998</xref>), the weight-rescale factor weakens the shifted synapse, so that it matches the attenuation of its distal counterpart. Nevertheless, when <inline-formula><mml:math id="inf129"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is located more distally on the same branch or subtree as <inline-formula><mml:math id="inf130"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, the transfer resistance <inline-formula><mml:math id="inf131"><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is often close to the input resistance <inline-formula><mml:math id="inf132"><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1s1">Figure 1âfigure supplement 1E</xref>). Thus, <inline-formula><mml:math id="inf133"><mml:msub><mml:mi>Î²</mml:mi><mml:mtext>curr</mml:mtext></mml:msub></mml:math></inline-formula> is often close to one, and hence negligible (<xref ref-type="fig" rid="fig4">Figure 4B,C</xref>). For a conductance-based synapse, rescaling weights by <inline-formula><mml:math id="inf134"><mml:msub><mml:mi>Î²</mml:mi><mml:mtext>curr</mml:mtext></mml:msub></mml:math></inline-formula> does not accurately fit the full model (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). We decompose the synaptic conductance <inline-formula><mml:math id="inf135"><mml:mrow><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as <inline-formula><mml:math id="inf136"><mml:mrow><mml:mi>g</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="inf137"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> the temporal average and <inline-formula><mml:math id="inf138"><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> the fluctuations around <inline-formula><mml:math id="inf139"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. We then analytically compute (see Materials and methods â Synaptic weight-rescale factors) that the weight-rescale factor for a conductance-based synapse<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:msub><mml:mi>Î²</mml:mi><mml:mtext>cond</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mo>â¢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>z</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mpadded></mml:mrow></mml:math></disp-formula>recovers the full modelâs voltage if<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mo>â¢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>z</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>âª</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mo>â¢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>z</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf140"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mo>â¢</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the difference between input resistance <inline-formula><mml:math id="inf141"><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> at the original synapse site <inline-formula><mml:math id="inf142"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and input resistance <inline-formula><mml:math id="inf143"><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> at the nearest proximal compartment site <inline-formula><mml:math id="inf144"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Multiplying the synaptic weights by <inline-formula><mml:math id="inf145"><mml:msub><mml:mi>Î²</mml:mi><mml:mtext>cond</mml:mtext></mml:msub></mml:math></inline-formula> weakens the synapse so that it matches the shunt effect of its distal counterpart, and so that the voltage at all compartments more proximal than <inline-formula><mml:math id="inf146"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and in their respective side branches is reproduced (<xref ref-type="fig" rid="fig4">Figure 4D</xref>).</p><p>If <inline-formula><mml:math id="inf147"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf148"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> are close, <inline-formula><mml:math id="inf149"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is small and (<xref ref-type="disp-formula" rid="equ9">Equation 9</xref>) is satisfied for plausible conductance fluctuations. Thus, shifting the synapse to the next proximal compartment keeps the voltage response intact. If the separation between <inline-formula><mml:math id="inf150"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf151"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> increases, <inline-formula><mml:math id="inf152"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> increases accordingly, and the magnitude of tolerated conductance fluctuations shrinks (<xref ref-type="disp-formula" rid="equ9">Equation 9</xref>). Thus, for a given magnitude of <inline-formula><mml:math id="inf153"><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, it is possible that a thick branch can be removed, but not a thin branch, as the input resistance increase in the former is much more gradual than in the latter. Nevertheless, (<xref ref-type="disp-formula" rid="equ9">Equation 9</xref>) suggests that even for large <inline-formula><mml:math id="inf154"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> the full modelâs voltage can be recovered by downscaling synaptic weight by <inline-formula><mml:math id="inf155"><mml:msub><mml:mi>Î²</mml:mi><mml:mtext>cond</mml:mtext></mml:msub></mml:math></inline-formula>, but only if <inline-formula><mml:math id="inf156"><mml:mrow><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>âª</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:math></inline-formula>. A tonic level of AMPA and/or GABA activation, as in the high-conductance state (<xref ref-type="bibr" rid="bib13">Destexhe et al., 2003</xref>), can implement this input condition. For NMDA synapses, this input condition does not hold, as NMDA spikes arise through a strong, transient conductance increase. However, when a cluster of such synapses â to be moved to a proximal site â is considered in isolation, a workaround can be found by applying constant rescale factors not just to synaptic weight, but also to threshold and width of the Mg<sup>2+</sup>Â block, as well as to the reversal (see Materials and methods â Synaptic weight-rescale factors). These factors recover NMDA-spike shape (<xref ref-type="fig" rid="fig4">Figure 4E</xref>) and threshold (<xref ref-type="fig" rid="fig4">Figure 4F</xref>) when the cluster is moved to from <inline-formula><mml:math id="inf157"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> to <inline-formula><mml:math id="inf158"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>Our analytical weight-rescale factor <inline-formula><mml:math id="inf159"><mml:msub><mml:mi>Î²</mml:mi><mml:mtext>cond</mml:mtext></mml:msub></mml:math></inline-formula> treated reductions where a single site <inline-formula><mml:math id="inf160"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> was moved to <inline-formula><mml:math id="inf161"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. We consider now the ablation of a whole subtree and the shift of all its synapses to <inline-formula><mml:math id="inf162"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4G</xref>). In our simulations, we distributed 100 AMPA and 100 GABA synapses on the to be ablated subtree, and activated them with a Poisson process with fixed rate. We studied how the reduction influenced the local integrative properties at the intact compartment <inline-formula><mml:math id="inf163"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. As a proxy for those integrative properties, we checked the shape of the waveform elicited by activating AMPA+NMDA synapses at <inline-formula><mml:math id="inf164"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in a short burst (<xref ref-type="fig" rid="fig4">Figure 4H</xref>), and we quantified the threshold for NMDA-spike generation. We found that neither shape nor threshold were preserved by the analytical weight-rescale factors <inline-formula><mml:math id="inf165"><mml:msub><mml:mi>Î²</mml:mi><mml:mtext>cond</mml:mtext></mml:msub></mml:math></inline-formula>, derived for the case where only a single input site is present on the subtree. We numerically extend the derivation of the weight-rescale factors to multi-site inputs (see Materials and methods â Synaptic weight-rescale factors). These extended weight-rescale factors <inline-formula><mml:math id="inf166"><mml:msubsup><mml:mi>Î²</mml:mi><mml:mtext>cond</mml:mtext><mml:mtext>ext</mml:mtext></mml:msubsup></mml:math></inline-formula> reproduced local voltage (<xref ref-type="fig" rid="fig4">Figure 4H</xref>) and NMDA-spike threshold (<xref ref-type="fig" rid="fig4">Figure 4I</xref>). We also investigate whether <inline-formula><mml:math id="inf167"><mml:msubsup><mml:mi>Î²</mml:mi><mml:mtext>cond</mml:mtext><mml:mtext>ext</mml:mtext></mml:msubsup></mml:math></inline-formula> can still be conceptualized as depending on <inline-formula><mml:math id="inf168"><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mo>â¢</mml:mo><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>z</mml:mi><mml:mtext>avg</mml:mtext></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>avg</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> â the product between (1) a difference in average input resistance between synapses on the to be ablated subtree and the compartment site and (2) the average conductance load exerted by those synapses. To do so, we activated the 100 AMPA and 100 GABA synapses on the to be ablated subtree at a wide range of input conditions (see MaterialsÂ andÂ methods â Simulation-specific parameters), and measured the error in threshold for NMDA-spike generation at <inline-formula><mml:math id="inf169"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. We found that this error depended strongly on <inline-formula><mml:math id="inf170"><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mo>â¢</mml:mo><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>z</mml:mi><mml:mtext>avg</mml:mtext></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>avg</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> and remained small for <inline-formula><mml:math id="inf171"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mo>â¢</mml:mo><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>z</mml:mi><mml:mtext>avg</mml:mtext></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>avg</mml:mtext></mml:msub></mml:mrow><mml:mo>âª</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4J</xref>).</p><p>In conclusion, we can now assess whether given spatial synapse motifs on branches or subtrees admit simplification by shifting the synapses to the nearest proximal compartment site and ablating the branch or subtree. We find that reduction in this sense is possible for any motif if fluctuations are small, so that <inline-formula><mml:math id="inf172"><mml:mrow><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>âª</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:math></inline-formula>, by applying temporally constant weight-rescale factors. Otherwise, the synapses must be located sufficiently closely to the compartment site, so that <inline-formula><mml:math id="inf173"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is small and that <inline-formula><mml:math id="inf174"><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mo>â¢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>z</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:math></inline-formula> remains below <inline-formula><mml:math id="inf175"><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mo>â¢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>z</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> for all relevant activation levels.</p></sec><sec id="s2-4"><title>Active and passive reduced dendrites under synaptic bombardment</title><p>We next investigated how many compartments are needed to reproduce somatic and dendritic responses under a synaptic bombardment and quantified the contribution of active dendritic Na<sup>+</sup>, Ca<sup>2+</sup>,Â and K<sup>+</sup> channels. We mimicked the inÂ vivo state in the basal dendrites of the L2/3 pyramid by distributing 200 AMPA and 200 GABA synapses receiving Poisson inputs and 20 clusters of AMPA+NMDA synapses receiving bursts of inputs (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). We sampled 10 different sets of meta-parameters governing synaptic activation (Poisson and burst rates and synaptic weights, see Materials and methods â Simulation-specific parameters), resulting in output spike rates between 0 and 8 Hz (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). We derived reduced models, once based on the full model with all active channels (âactive reduced dendriteâ in <xref ref-type="fig" rid="fig5">Figure 5C</xref>) and once based on the passified full model (âpassive reduced dendriteâ in <xref ref-type="fig" rid="fig5">Figure 5C</xref>). We distributed increasing numbers of compartment sites on the basal branches and measured somatic and dendritic voltage responses for the active full model and for the reduced models with active and passive dendrites (<xref ref-type="fig" rid="fig5">Figure 5C</xref>, <xref ref-type="fig" rid="fig5s1">Figure 5âfigure supplement 1</xref> for dendritic traces). Spike coincidence (<xref ref-type="fig" rid="fig5">Figure 5D</xref>), subthreshold somatic voltage error (<xref ref-type="fig" rid="fig5">Figure 5E</xref>), and dendritic voltage error (<xref ref-type="fig" rid="fig5">Figure 5F</xref>) showed a significant improvement when compartment numbers increased from 0 (point-neuron â top row in <xref ref-type="fig" rid="fig5">Figure 5C</xref>) to 2 per 100 Î¼m. In the presence of active channels, the error decreases until up to threeÂ compartments per 100 Î¼m (<xref ref-type="fig" rid="fig5">Figure 5E,F</xref>). Spike coincidence factors were consistently â¼10% higher than in the passive case (<xref ref-type="fig" rid="fig5">Figure 5D</xref>).</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Reductions with active and passive dendritic compartments under inÂ vivo like conditions.</title><p>(<bold>A</bold>) AMPA and GABA synapses, and AMPA+NMDA synapse clusters are spread randomly throughout the basal dendrites of the L2/3 pyramid (inset). AMPA and GABA synapses receive Poisson inputs and AMPA+NMDA synapses receive bursting input (right). (<bold>B</bold>) Output spike rates of the full model for 10 different input configurations. (<bold>C</bold>) Reductions with increasing numbers of compartment sites along the basal dendrites (left). Somatic voltage traces and spike times for the full model (gray), for a reduction with passive dendrites (middle, blue) and a reduction with active dendrites (right, orange). (<bold>DâF</bold>) Spike coincidence factors (<bold>D</bold>), relative somatic voltage errors (<bold>E</bold>) and relative dendritic voltage errors (<bold>F</bold>) for reductions with increasing numbers of compartments, and with passive (blue) and active dendrites (orange), averaged over all 10 input configurations. Relative voltage errors are computed as in <xref ref-type="fig" rid="fig2">Figure 2C,D</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-60936-fig5-v1.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5âfigure supplement 1.</label><caption><title>Dendritic voltage traces for reductions with passive and active dendrites.</title><p>Voltage in the full model (gray) at a dendritic site (red hexagon on the left), together with the voltage in the closest compartment of the reduced model with passive dendrite (middle, blue) and of the reduced model with active dendrites (left, orange) for the same simulations as in <xref ref-type="fig" rid="fig5">Figure 5</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-60936-fig5-figsupp1-v1.tif"/></fig></fig-group></sec><sec id="s2-5"><title>Fitting reduced models directly to experimental data</title><p>Traditionally, creating a morphological neuron model involves a reconstruction of the morphology and an evolutionary fit of the electrical parameters (<xref ref-type="bibr" rid="bib19">Hay et al., 2011</xref>; <xref ref-type="bibr" rid="bib1">Almog and Korngreen, 2014</xref>; <xref ref-type="bibr" rid="bib61">Van Geit et al., 2016</xref>). Our method allows skipping these resource-intensive steps (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). We adapt our method to a common experimental paradigm where hyper- and depolarizing current steps are injected under applications of various ion-channel blockers (<xref ref-type="bibr" rid="bib36">Marti Mengual et al., 2020</xref>). We extract resistance matrices and holding potentials from voltage step amplitudes (<xref ref-type="fig" rid="fig6">Figure 6B</xref>), and the timeÂ scale of the largest eigenmode from the average voltage decay back to rest (<xref ref-type="fig" rid="fig6">Figure 6C</xref>). If the modeling goal is a reduced model, the traditional reconstruction and subsequent reduction both introduce errors (<xref ref-type="fig" rid="fig6">Figure 6D</xref>). Thus, we find that while our reduction of the full model is faithful within an expected accuracy margin (<xref ref-type="fig" rid="fig6">Figure 6E</xref>), fitting a reduced model directly to the experimental traces is more accurate (<xref ref-type="fig" rid="fig6">Figure 6F</xref>).</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Fitting reduced models directly to experimental data.</title><p>(<bold>A</bold>)Â Comparison between the traditional neuron model creation paradigm (morphological reconstruction and evolutionary fit, possibly followed by a reduction), and the proposed direct experiment to reduced dendrite model paradigm. (<bold>B</bold>) Resistance matrices and holding potentials are extracted from the response amplitude to hyper- and depolarizing current step inputs, here measured once under application of an h-channel antagonist and once under control conditions. (<bold>C</bold>) Time scale of largest eigenmode is extracted from average decay back to the resting membrane potential. (<bold>D</bold>) Combined root mean square voltage error <inline-formula><mml:math id="inf176"><mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>â¢</mml:mo><mml:mi>M</mml:mi><mml:mo>â¢</mml:mo><mml:mi>S</mml:mi><mml:mo>â¢</mml:mo><mml:mi>E</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mtext>Avg</mml:mtext><mml:mo>â¢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mtext>full</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mtext>reduced</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> of full model (gray) â fitted to current step data through an evolutionary algorithm, of the reduction of the full model (red), and of the direct fit of the reduced model to the data (brown). (<bold>E</bold>) Experimentally recorded traces (gray), traces from the full reconstruction (black), and its reduction (green and purple, dashed). (<bold>F</bold>) Experimentally recorded traces (gray) and traces from the directly fitted reduced model (green and purple, dashed).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-60936-fig6-v1.tif"/></fig></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We have presented a flexible yet accurate method to construct reduced neuron models from experimental data and morphological reconstructions. The method consists of linear parameter fits at holding potentials that are informative for the full non-linear dynamics. First, we derive leak and coupling conductances from the passified version of the full model. Second, we fit the maximal conductances of the active ion-channels, so that the reduced model, at various holding potentials, responds similarly to input perturbations as the full model. Third, we fit the capacitances to reproduce spatio-temporal integrative properties. Finally, we ensure that resting membrane potentials in the full and reduced models match. The resulting method can be adapted to a wide variety of use cases.</p><p>A fundamental use case is deriving reduced models that retain specific elements of the dendritic computational repertoire, to explore how those dendritic computations may improve network function. To that purpose, one can apply our method to compartments placed at input sites needed for the computation of interest. For instance, if a computation requires independent computational subunits (<xref ref-type="bibr" rid="bib46">Poirazi et al., 2003b</xref>; <xref ref-type="bibr" rid="bib25">Kastellakis et al., 2016</xref>), one would place compartments at the dendritic tips. If one wants to modulate co-operativity of excitatory inputs at distal sites, one would place compartments with shunting conductances at the bifurcations between the distal sites (<xref ref-type="bibr" rid="bib64">Wybo et al., 2019</xref>). Detecting input sequences (<xref ref-type="bibr" rid="bib6">Branco and HÃ¤usser, 2010</xref>) or implementing a dendritic integration gradient (<xref ref-type="bibr" rid="bib7">Branco and HÃ¤usser, 2011</xref>) would require placing two or more compartments along the branches of interest. For many of these computations, a passive morphology with non-linear (NMDA) synapses suffices. Furthermore, our method can be combined with abstract models of APÂ generation (<xref ref-type="bibr" rid="bib49">Pozzorini et al., 2013</xref>; <xref ref-type="bibr" rid="bib50">Pozzorini et al., 2015</xref>).</p><p>A second use case is constructing models directly from electro-physiological recordings. Our method avoids the labor-intensive detour of reconstructing the morphology and optimizing model parameters with an evolutionary algorithm (<xref ref-type="bibr" rid="bib36">Marti Mengual et al., 2020</xref>). In combination with advances in voltage-sensitive dye imaging, our method may thus form the basis of a high-throughput experiment-to-model paradigm.</p><p>A third use case is elucidating the effective complexity of a given dendritic tree. We assessed whether afferent spatial input motifs could be simplified by removing a branch or subtree and grouping the affected synapses at the next proximal compartment. We found that such simplification is possible when the input resistance of the affected synapse sites is close to the input resistance of the compartment site. If this condition does not hold, the simplification can still proceed if conductance fluctuations are small compared to the average conductance magnitude, but not otherwise. What is the simplest model for a given dendritic tree that captures its full computational repertoire? We find that spike coincidence and subthreshold voltage metrics reach satisfying accuracy at, but do not improve much beyond â¼3 compartments per 100 Î¼m. Further research is required to tease apart mere numerical errors from potentially missed computational features.</p><p>The process of simplifying complex dynamical systems, such as morphological neuron models, is inherently approximate. Due to the vast variety of morphologies, voltage-gated ion-channel configurations and input patterns, it is beyond the scope of any single paper to give an exhaustive overview of possible inaccuracies. Rather, we propose three lines of inquiry if a reduction fails to reproduce a particular response pattern. First, we suggest checking the discrepancy between the impedance kernels <inline-formula><mml:math id="inf177"><mml:mrow><mml:mi>z</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of the full and reduced models. Often, response mismatches arise from slight inaccuracies in how ion-channel dynamics are integrated by the passive system (<xref ref-type="fig" rid="fig3">Figure 3AâC</xref>). Second, we suggest assessing to what degree afferent spatial input motifs, present in the full model, are simplified, and whether that simplification still admits a sufficient accuracy in reproducing local voltage-dependent responses, such as NMDA spikes (<xref ref-type="fig" rid="fig4">Figure 4</xref>). Finally, we suggest checking whether the distribution of compartments on the morphology admits ion channel dynamics that are sufficiently rich to reproduce the response characteristic in question. To illustrate these lines of inquiry, we have further simplified the L5 pyramid to five compartments, by omitting the compartments in the apical trunk (<xref ref-type="fig" rid="fig3s1">Figure 3âfigure supplement 1A</xref> vs <xref ref-type="fig" rid="fig3">Figure 3J</xref>). This reduction results a change in AP shape, and in a failure to elicit AP bursts through the pairing of a somatic and a dendritic input, even though a Ca<sup>2+</sup>Â spike can still be elicited (<xref ref-type="fig" rid="fig3s1">Figure 3âfigure supplement 1B</xref>). Likely, the change in AP shape can be traced back to the difference in the somatic input impedance kernels (<xref ref-type="fig" rid="fig3s1">Figure 3âfigure supplement 1C</xref>), while the failure to elicit an AP burst may be due to insufficient Na<sup>+</sup>-driven cross-talk between soma and apical tuft.</p><p>Computational tools have played a key role in neuroscience. Take NEURON (<xref ref-type="bibr" rid="bib8">Carnevale and Hines, 2004</xref>), whichÂ accelerated our understanding of morphological neurons, or NEST (<xref ref-type="bibr" rid="bib18">Gewaltig and Diesmann, 2007</xref>), whichÂ enabled simulation of large-scale spiking point-neuron networks. We have implemented a Python toolbox that automatizes the simplification process (NEural Analysis Toolkit â NEATÂ âÂ <ext-link ext-link-type="uri" xlink:href="https://github.com/unibe-cns/NEAT">https://github.com/unibe-cns/NEAT</ext-link>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:7941f171d5917484eeafa5e76f9657073666a66a;origin=https://github.com/unibe-cns/NEAT;visit=swh:1:snp:0afcc15cf2ef0084749e7f7677ebf0324695dec3;anchor=swh:1:rev:1cb15f36aa0a764105348541d046c85ef38e21ee/">swh:1:rev:1cb15f36aa0a764105348541d046c85ef38e21ee</ext-link>). The toolbox reads any morphology in the standard â.swcâ format (<xref ref-type="bibr" rid="bib3">Ascoli, 2006</xref>) and returns the parameters of the reduced models, while also providing tools to export the models to NEURON (<xref ref-type="bibr" rid="bib8">Carnevale and Hines, 2004</xref>).</p><p>Our method and toolbox fill a void in between the extremes of modeling large-scale networks with abstract models and modeling single cells in all their detail. By enabling the efficient systematic derivation of simplified neurons, amenable to simulation at the network level, our work bridges the gap between two branches of neuroscience that historically have remained separate.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Morpohologies</title><p>Three exemplar cell models were used for the analysis: a cortical L2/3 pyramidal cell (<xref ref-type="bibr" rid="bib6">Branco and HÃ¤usser, 2010</xref>; <xref ref-type="fig" rid="fig2">Figure 2D</xref>), a cortical L5 pyramidal cell (<xref ref-type="bibr" rid="bib19">Hay et al., 2011</xref>; <xref ref-type="fig" rid="fig2">Figure 2E</xref>), and a cerebellar Purkinje cell (<xref ref-type="fig" rid="fig2">Figure 2F</xref>). The latter morphology was retrieved from the <ext-link ext-link-type="uri" xlink:href="http://neuromorpho.org/">NeuroMorpho.org</ext-link> repository (<xref ref-type="bibr" rid="bib3">Ascoli, 2006</xref>)Â and the two others from the ModelDB repository (<xref ref-type="bibr" rid="bib38">McDougal et al., 2017</xref>).</p></sec><sec id="s4-2"><title>Physiological parameters</title><p>In our passive models, physiological parameters were set according to <xref ref-type="bibr" rid="bib34">Major et al., 2008</xref>: the equilibrium potential was <inline-formula><mml:math id="inf178"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mpadded width="+2.8pt"><mml:mn>75</mml:mn></mml:mpadded><mml:mo>â¢</mml:mo><mml:mtext>mV</mml:mtext></mml:mrow></mml:mrow></mml:math></inline-formula>, the membrane conductance <inline-formula><mml:math id="inf179"><mml:mrow><mml:mrow><mml:mpadded width="+2.8pt"><mml:mn>100</mml:mn></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi>Î¼</mml:mi><mml:mo>â¢</mml:mo><mml:mtext>S</mml:mtext></mml:mrow><mml:mo>/</mml:mo><mml:msup><mml:mtext>cm</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, the capacitance <inline-formula><mml:math id="inf180"><mml:mrow><mml:mrow><mml:mpadded width="+2.8pt"><mml:mn>0.8</mml:mn></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi>Î¼</mml:mi><mml:mo>â¢</mml:mo><mml:mtext>F</mml:mtext></mml:mrow><mml:mo>/</mml:mo><mml:msup><mml:mtext>cm</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, and the intracellular resistivity <inline-formula><mml:math id="inf181"><mml:mrow><mml:mrow><mml:mpadded width="+2.8pt"><mml:mn>100</mml:mn></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi mathvariant="normal">Î©</mml:mi></mml:mrow><mml:mo>â</mml:mo><mml:mtext>cm</mml:mtext></mml:mrow></mml:math></inline-formula>. For the active models, we took ion channels and parameters according to <xref ref-type="bibr" rid="bib6">Branco and HÃ¤usser, 2010</xref> for the L2/3 pyramid, <xref ref-type="bibr" rid="bib19">Hay et al., 2011</xref> for the L5 pyramid, and <xref ref-type="bibr" rid="bib40">Miyasho et al., 2001</xref> for the Purkinje cell.</p><p>AMPA and GABA synaptic input currents were implemented as the product of a conductance profile, here a double exponential (<xref ref-type="bibr" rid="bib52">Rotter and Diesmann, 1999</xref>), with a driving force:<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mtext>syn</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>g</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>AMPA rise resp. decay times were <inline-formula><mml:math id="inf182"><mml:mrow><mml:msub><mml:mi>Ï</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+2.8pt"><mml:mn>0.2</mml:mn></mml:mpadded><mml:mo>â¢</mml:mo><mml:mtext>ms</mml:mtext></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf183"><mml:mrow><mml:msub><mml:mi>Ï</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+2.8pt"><mml:mn>3</mml:mn></mml:mpadded><mml:mo>â¢</mml:mo><mml:mtext>ms</mml:mtext></mml:mrow></mml:mrow></mml:math></inline-formula> and AMPA reversal potential was <inline-formula><mml:math id="inf184"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+2.8pt"><mml:mn>0</mml:mn></mml:mpadded><mml:mo>â¢</mml:mo><mml:mtext>mV</mml:mtext></mml:mrow></mml:mrow></mml:math></inline-formula>. For GABA, we used <inline-formula><mml:math id="inf185"><mml:mrow><mml:msub><mml:mi>Ï</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+2.8pt"><mml:mn>0.2</mml:mn></mml:mpadded><mml:mo>â¢</mml:mo><mml:mtext>ms</mml:mtext></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf186"><mml:mrow><mml:msub><mml:mi>Ï</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+2.8pt"><mml:mn>10</mml:mn></mml:mpadded><mml:mo>â¢</mml:mo><mml:mtext>ms</mml:mtext></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf187"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mpadded width="+2.8pt"><mml:mn>80</mml:mn></mml:mpadded><mml:mo>â¢</mml:mo><mml:mtext>mV</mml:mtext></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. NMDA currents (<xref ref-type="bibr" rid="bib22">Jahr and Stevens, 1990a</xref>) had the form:<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mtext>syn</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>g</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi>Ï</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>-</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>with rise resp. decay time <inline-formula><mml:math id="inf188"><mml:mrow><mml:msub><mml:mi>Ï</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+2.8pt"><mml:mn>0.2</mml:mn></mml:mpadded><mml:mo>â¢</mml:mo><mml:mtext>ms</mml:mtext></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf189"><mml:mrow><mml:msub><mml:mi>Ï</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+2.8pt"><mml:mn>43</mml:mn></mml:mpadded><mml:mo>â¢</mml:mo><mml:mtext>ms</mml:mtext></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf190"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+2.8pt"><mml:mn>0</mml:mn></mml:mpadded><mml:mo>â¢</mml:mo><mml:mtext>mV</mml:mtext></mml:mrow></mml:mrow></mml:math></inline-formula>, while <inline-formula><mml:math id="inf191"><mml:mrow><mml:mi>Ï</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, modeling the channelâs magnesium block, had the form (<xref ref-type="bibr" rid="bib5">Behabadi and Mel, 2014</xref>):<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:mrow><mml:mrow><mml:mi>Ï</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mn>0.3</mml:mn></mml:mpadded><mml:mo>â¢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mn>0.1</mml:mn></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The âconductanceâ of an AMPA or GABA synapse signifies the maximum value of its conductance window. For an AMPA+NMDA synapse, the conductance is the maximal value of the AMPA conductance window, and the conductance of the NMDA component is determined by multiplying the AMPA conductance value with an NMDA ratio <inline-formula><mml:math id="inf192"><mml:msub><mml:mi>R</mml:mi><mml:mtext>NMDA</mml:mtext></mml:msub></mml:math></inline-formula>, set to be either 2 or 3.</p></sec><sec id="s4-3"><title>Biophysical models</title><p>We used the NEURON simulator (<xref ref-type="bibr" rid="bib8">Carnevale and Hines, 2004</xref>) to implement biophysical and reduced models. For theÂ biophysicalÂ models, the distance step was set according the lambda rule (<xref ref-type="bibr" rid="bib8">Carnevale and Hines, 2004</xref>) or smaller.</p></sec><sec id="s4-4"><title>Quasi-active channels</title><p>A voltage-dependent ion channel described by the HodgkinâHuxley formalism can in general be written asÂ follows:<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>Â¯</mml:mo></mml:mover></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi>f</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>-</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo rspace="13.9pt">,</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>Ë</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo rspace="5.3pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mpadded width="+2.8pt"> <mml:mtext>for </mml:mtext></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf193"><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>Â¯</mml:mo></mml:mover></mml:math></inline-formula> is the channelâs maximal conductance, <inline-formula><mml:math id="inf194"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> its reversal potential, <inline-formula><mml:math id="inf195"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> its state variables, <inline-formula><mml:math id="inf196"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>f</mml:mi><mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>â¼</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> a function that depends on the channel type (e.g. for a typical sodium channel <inline-formula><mml:math id="inf197"><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msup><mml:mi>m</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>), and <inline-formula><mml:math id="inf198"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf199"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>) the functions governing state-variable activation (<inline-formula><mml:math id="inf200"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> can usually be written as <inline-formula><mml:math id="inf201"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="normal">â</mml:mi><mml:mo>â¢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>Ï</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="inf202"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="normal">â</mml:mi><mml:mo>â¢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> the state-variableâs activation and <inline-formula><mml:math id="inf203"><mml:mrow><mml:msub><mml:mi>Ï</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> its timeÂ scale). To obtain the channelâs quasi-active approximation (<xref ref-type="bibr" rid="bib37">Mauro et al., 1970</xref>; <xref ref-type="bibr" rid="bib29">Koch and Poggio, 1985</xref>) around a holding potential <inline-formula><mml:math id="inf204"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and a state variable expansion point <inline-formula><mml:math id="inf205"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mn>1</mml:mn><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>K</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>, we linearize (<xref ref-type="disp-formula" rid="equ13">Equation 13</xref>):<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mtext>lin</mml:mtext></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mover><mml:mi>g</mml:mi><mml:mo accent="false">Â¯</mml:mo></mml:mover><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munderover><mml:mo>â</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">â</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">â</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mspace width="negativethinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>â¦</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>â</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>â</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mspace width="negativethinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>â¦</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo>â</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mover><mml:mi>y</mml:mi><mml:mo>Ë</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">â</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">â</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mspace width="negativethinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>â</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">â</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">â</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="negativethinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo>â</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="11.381102pt"/><mml:mtext>forÂ </mml:mtext><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>â¦</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>.</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>To obtain the zero-frequency contribution of (<xref ref-type="disp-formula" rid="equ14">Equation 14</xref>) to the resistance and conductance matrices, we set <inline-formula><mml:math id="inf206"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>Ë</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, solve the linearized state-variable equations for <inline-formula><mml:math id="inf207"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and substitute the result in <inline-formula><mml:math id="inf208"><mml:msub><mml:mi>i</mml:mi><mml:mtext>lin</mml:mtext></mml:msub></mml:math></inline-formula>:<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mrow><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mtext>lin</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>â¢</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">â</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mrow><mml:mpadded width="+1.7pt"><mml:mfrac><mml:mrow><mml:mpadded width="+1.7pt"><mml:mfrac><mml:mrow><mml:mo>â</mml:mo><mml:mo>â¡</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>â</mml:mo><mml:mo>â¡</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mpadded><mml:mo>â¢</mml:mo><mml:mfrac><mml:mrow><mml:mo>â</mml:mo><mml:mo>â¡</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>â</mml:mo><mml:mo>â¡</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mfrac><mml:mrow><mml:mo>â</mml:mo><mml:mo>â¡</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>â</mml:mo><mml:mo>â¡</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfrac></mml:mpadded><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mpadded width="-1.7pt"><mml:mi>f</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mn>1</mml:mn><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>K</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo rspace="4.2pt">]</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Introducing a shorthand for the factor in square brackets<disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">â</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mrow><mml:mpadded width="+1.7pt"><mml:mfrac><mml:mrow><mml:mpadded width="+1.7pt"><mml:mfrac><mml:mrow><mml:mo>â</mml:mo><mml:mo>â¡</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>â</mml:mo><mml:mo>â¡</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mpadded><mml:mo>â¢</mml:mo><mml:mfrac><mml:mrow><mml:mo>â</mml:mo><mml:mo>â¡</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>â</mml:mo><mml:mo>â¡</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mfrac><mml:mrow><mml:mo>â</mml:mo><mml:mo>â¡</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>â</mml:mo><mml:mo>â¡</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfrac></mml:mpadded><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mpadded width="-1.7pt"><mml:mi>f</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mn>1</mml:mn><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>K</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>results in the linearized ion-channel current as described in (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref>).</p></sec><sec id="s4-5"><title>The impedance matrix</title><p>The voltage response <inline-formula><mml:math id="inf209"><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at a location <inline-formula><mml:math id="inf210"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> along the neuron to an input current perturbation <inline-formula><mml:math id="inf211"><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mo>â²</mml:mo></mml:msup></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at location <inline-formula><mml:math id="inf212"><mml:msup><mml:mi>x</mml:mi><mml:mo>â²</mml:mo></mml:msup></mml:math></inline-formula> can be computed as the convolution of an impedance kernel with <inline-formula><mml:math id="inf213"><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mo>â²</mml:mo></mml:msup></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mrow><mml:mrow><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>â¢</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>â²</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>â</mml:mo><mml:mi>Î´</mml:mi></mml:mrow><mml:mo>â¢</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mo>â²</mml:mo></mml:msup></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The impedance kernel itself can be computed in the frequency domain from the quasi-active cable equation using Kochâs algorithm (<xref ref-type="bibr" rid="bib29">Koch and Poggio, 1985</xref>). We may assume any aÂ priori arbitrary set of holding potentials and ion-channel stateÂ variables to compute the quasi-active expansion (with Kochâs algorithm, the only constraint is that their distribution is uniform for each cylindrical segment). For our purpose, spatially uniform holding potentials and state-variable expansion points suffice. For a steady-state current <inline-formula><mml:math id="inf214"><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mo>â²</mml:mo></mml:msup></mml:msub></mml:mrow></mml:math></inline-formula>, (<xref ref-type="disp-formula" rid="equ17">Equation 17</xref>) simplifies to:<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mrow><mml:mrow><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>â¢</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>â²</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mo>â²</mml:mo></mml:msup></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where we term <inline-formula><mml:math id="inf215"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>â¢</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>â²</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">â«</mml:mo><mml:mn>0</mml:mn><mml:mi mathvariant="normal">â</mml:mi></mml:msubsup><mml:mrow><mml:mrow><mml:mo>d</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>t</mml:mi></mml:mpadded></mml:mrow><mml:mo>â¢</mml:mo><mml:mpadded width="-1.7pt"><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>â¢</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>â²</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> the âresistanceâ (<inline-formula><mml:math id="inf216"><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>â¢</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>â²</mml:mo></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> is also known as the input resistance if <inline-formula><mml:math id="inf217"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>â²</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> or the transfer resistance if <inline-formula><mml:math id="inf218"><mml:mrow><mml:mi>x</mml:mi><mml:mo>â </mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>â²</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>). For passive membranes, impedance kernels can also be computed as a sum of exponentials (<xref ref-type="bibr" rid="bib21">Holmes et al., 1992</xref>; <xref ref-type="bibr" rid="bib33">Major et al., 1993</xref>):<disp-formula id="equ19"><label>(19)</label><mml:math id="m19"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>â¢</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>â²</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">â</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi mathvariant="normal">â</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>Ï</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:msub><mml:mi>Ï</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>â²</mml:mo></mml:msup><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mi>t</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where we adopt the ordering <inline-formula><mml:math id="inf219"><mml:mrow><mml:msub><mml:mi>Ï</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>â¥</mml:mo><mml:msub><mml:mi>Ï</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>â¥</mml:mo><mml:msub><mml:mi>Ï</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>â¥</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi></mml:mrow></mml:math></inline-formula> Essentially, this infinite sum can be thought of as the generalization of the eigenmodes for linear dynamical systems (<xref ref-type="bibr" rid="bib56">Strogatz, 2000</xref>) to partial differential equations.</p><p>When a current perturbation is applied at multiple sites along the neuron (we write <inline-formula><mml:math id="inf220"><mml:mrow><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold">ð¢</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>), we obtain the voltage response <inline-formula><mml:math id="inf221"><mml:mrow><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold">ð¯</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at those sites from:<disp-formula id="equ20"><label>(20)</label><mml:math id="m20"><mml:mrow><mml:mrow><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi>ð¯</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>â</mml:mo><mml:mi>Î´</mml:mi></mml:mrow><mml:mo>â¢</mml:mo><mml:mi>ð¢</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>with <inline-formula><mml:math id="inf222"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> the matrix of impedance kernels (the <inline-formula><mml:math id="inf223"><mml:mrow><mml:mi>i</mml:mi><mml:mo>â¢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>âth elements of this matrix is the impedance kernel between sites <inline-formula><mml:math id="inf224"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf225"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>). In the steady-state case, we call <inline-formula><mml:math id="inf226"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> the resistance matrix.</p></sec><sec id="s4-6"><title>Compartmental models</title><p>The voltage <inline-formula><mml:math id="inf227"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> in a compartment <inline-formula><mml:math id="inf228"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, connected to a set <inline-formula><mml:math id="inf229"><mml:msub><mml:mi class="ltx_font_mathcaligraphic">ð©</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> of nearest neighbor compartments, and with a set of ion channels <inline-formula><mml:math id="inf230"><mml:msub><mml:mi class="ltx_font_mathcaligraphic">â</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, is given by<disp-formula id="equ21"><label>(21)</label><mml:math id="m21"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>Ë</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">â</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>â</mml:mo><mml:msub><mml:mi class="ltx_font_mathcaligraphic">ð©</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>â¢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">â</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>â</mml:mo><mml:msub><mml:mi class="ltx_font_mathcaligraphic">â</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf231"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the capacitance of compartment <inline-formula><mml:math id="inf232"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf233"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> resp. <inline-formula><mml:math id="inf234"><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> its leak conductance resp. reversal, <inline-formula><mml:math id="inf235"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi><mml:mo>â¢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> its coupling conductance to the neighboring compartment <inline-formula><mml:math id="inf236"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf237"><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> the ion channel current (<xref ref-type="disp-formula" rid="equ13">Equation 13</xref>) of channel <inline-formula><mml:math id="inf238"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in compartment <inline-formula><mml:math id="inf239"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf240"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>Â an arbitrary input current to compartment <inline-formula><mml:math id="inf241"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec id="s4-7"><title>The conductance matrix</title><p>To obtain the conductance matrix of the compartmental model for steady-state inputs, (<xref ref-type="disp-formula" rid="equ21">Equation 21</xref>) is linearized around a certain holding potential <inline-formula><mml:math id="inf242"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and we assume that <inline-formula><mml:math id="inf243"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>Ë</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. After absorbing all constant terms into <inline-formula><mml:math id="inf244"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, we obtain<disp-formula id="equ22"><label>(22)</label><mml:math id="m22"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">â</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>â</mml:mo><mml:msub><mml:mi class="ltx_font_mathcaligraphic">ð©</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>â¢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">â</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>â</mml:mo><mml:msub><mml:mi class="ltx_font_mathcaligraphic">â</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>Â¯</mml:mo></mml:mover><mml:mrow><mml:mi>d</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf245"><mml:mrow><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf246"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>Â¯</mml:mo></mml:mover><mml:mrow><mml:mi>d</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the linearized ion-channel current (<xref ref-type="disp-formula" rid="equ15">Equation 15</xref>), and where we used the notation (<xref ref-type="disp-formula" rid="equ16">Equation 16</xref>). Summarizing the voltage responses for each compartment in a vector <inline-formula><mml:math id="inf247"><mml:mrow><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold">ð¯</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, (<xref ref-type="disp-formula" rid="equ22">Equation 22</xref>) for each compartment <inline-formula><mml:math id="inf248"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> can be recast as a matrix equation, yielding (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref>).</p></sec><sec id="s4-8"><title>Simplification method details</title><p>For any given set of <inline-formula><mml:math id="inf249"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> sites on the morphology, we construct a simplified compartmental model whose connection structure follows a tree graph defined by the original morphology (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). We do not allow triplet connections (e.g. sites 1â2, sites 2â3, and sites 3â1 all mutually connected) in our reduced models. Hence, to obtain accurate results, it is necessary to extend the original set of <inline-formula><mml:math id="inf250"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> sites with the <inline-formula><mml:math id="inf251"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> bifurcation points that lie in between (<xref ref-type="fig" rid="fig1s1">Figure 1âfigure supplement 1C</xref>). With these <inline-formula><mml:math id="inf252"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> sites, we thus define a tree graph that provides the scaffold for our fit (and our reduced model).</p><p>The fitting process proceeds in four steps: (1) fit the passive leak and coupling conductances, (2) fit the capacitances, (3) fit the maximal conductances of the ion channels, and (4) fit the reversal potentials to obtain the same resting membrane potentials as in the biophysical model. The order of steps 2 and 3Â is interchangeable, but not of the other steps. We describe these steps in detail below:</p><list list-type="order"><list-item><p>If the biophysical model contains active conductances, we compute their opening probabilities at rest and add them to the leak. Otherwise, we simply take the leak as is. We then compute <inline-formula><mml:math id="inf253"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> for the <inline-formula><mml:math id="inf254"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> compartment sites. In the passive case, <inline-formula><mml:math id="inf255"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is independent of the holding potential. In (<xref ref-type="disp-formula" rid="equ21">Equation 21</xref>), we substitute <inline-formula><mml:math id="inf256"><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>Ë</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf257"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. The terms <inline-formula><mml:math id="inf258"><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are a constant contribution, and can thus be absorbed in <inline-formula><mml:math id="inf259"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. We obtain:Â <disp-formula id="equ23"><label>(23)</label><mml:math id="m23"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">â</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>â</mml:mo><mml:msub><mml:mi class="ltx_font_mathcaligraphic">ð©</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>â¢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo rspace="13.9pt">,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>which, when recast in matrix form, yields (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref>). (<xref ref-type="disp-formula" rid="equ4">Equation 4</xref>) then yields a system of <inline-formula><mml:math id="inf260"><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> equations, linear in <inline-formula><mml:math id="inf261"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf262"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>â¢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> (note that this system always has <inline-formula><mml:math id="inf263"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>â¢</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> unknowns). We recast this system of equations in a form <inline-formula><mml:math id="inf264"><mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>â¢</mml:mo><mml:mi mathvariant="bold">ð </mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="bold">ð</mml:mi></mml:mrow></mml:math></inline-formula> and solve it in the least-squares sense for <inline-formula><mml:math id="inf265"><mml:mi mathvariant="bold">ð </mml:mi></mml:math></inline-formula>.</p></list-item><list-item><p>To fit the capacitances, we set <inline-formula><mml:math id="inf266"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and again absorb <inline-formula><mml:math id="inf267"><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> in <inline-formula><mml:math id="inf268"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> in (<xref ref-type="disp-formula" rid="equ21">Equation 21</xref>) to obtain:<disp-formula id="equ24"><label>(24)</label><mml:math id="m24"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>Ë</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac></mml:mpadded><mml:mo>â¢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">â</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>â</mml:mo><mml:msub><mml:mi class="ltx_font_mathcaligraphic">ð©</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>â¢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mrow><mml:mo rspace="13.9pt">,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In matrix form, we obtain (<xref ref-type="disp-formula" rid="equ6">Equation 6</xref>) with <inline-formula><mml:math id="inf269"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mtext>diag</mml:mtext><mml:mo>â¢</mml:mo><mml:mpadded width="+1.7pt"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">ð</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. We require that this matrix has the same smallest eigenvalue (corresponding to the largest timeÂ scale <inline-formula><mml:math id="inf270"><mml:msub><mml:mi>Ï</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>) <inline-formula><mml:math id="inf271"><mml:mrow><mml:msub><mml:mi>Î±</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>Ï</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and eigenvector <inline-formula><mml:math id="inf272"><mml:mrow><mml:msub><mml:mi>Ï</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>Ï</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>Ï</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as the biophysical model, as defined by (<xref ref-type="disp-formula" rid="equ19">Equation 19</xref>). Hence, we obtain the system of (<xref ref-type="disp-formula" rid="equ7">Equation 7</xref>) that can be solved for <inline-formula><mml:math id="inf273"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula>.</p></list-item><list-item><p>We compute the maximal conductances of each ion-channel type separately. Thus, next to setting <inline-formula><mml:math id="inf274"><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>Ë</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, we set <inline-formula><mml:math id="inf275"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for all but one of the channels â call the non-zero channel <inline-formula><mml:math id="inf276"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> â and replace <inline-formula><mml:math id="inf277"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> with its quasi-active, zero-frequency approximation (<xref ref-type="disp-formula" rid="equ15">Equation 15</xref>). We choose a spatially uniform holding potential <inline-formula><mml:math id="inf278"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and expansion point <inline-formula><mml:math id="inf279"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mn>1</mml:mn><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>K</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for ion channel <inline-formula><mml:math id="inf280"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. We absorb constant terms in <inline-formula><mml:math id="inf281"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and obtain (<xref ref-type="disp-formula" rid="equ21">Equation 21</xref>) in terms of <inline-formula><mml:math id="inf282"><mml:mrow><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ25"><label>(25)</label><mml:math id="m25"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">â</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>â</mml:mo><mml:msub><mml:mi class="ltx_font_mathcaligraphic">ð©</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>â¢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>Â¯</mml:mo></mml:mover><mml:mrow><mml:mi>d</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We again recast this equation in matrix form, but distinguish the known passive component <inline-formula><mml:math id="inf283"><mml:msub><mml:mi>G</mml:mi><mml:mtext>pas</mml:mtext></mml:msub></mml:math></inline-formula> from the unknown diagonal matrix <inline-formula><mml:math id="inf284"><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext>chan d</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> containing as its <inline-formula><mml:math id="inf285"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>âth diagonal element the channel term <inline-formula><mml:math id="inf286"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>Â¯</mml:mo></mml:mover><mml:mrow><mml:mi>d</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ26"><label>(26)</label><mml:math id="m26"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mtext>pas</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext>chan d</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi>ð¯</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mi>ð¢</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>From the biophysical model, we compute <inline-formula><mml:math id="inf287"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> by setting all ion channel conductances except channel <inline-formula><mml:math id="inf288"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> to zero, to obtain the fit (<xref ref-type="disp-formula" rid="equ5">Equation 5</xref>).</p><p>By consequence, we have a system of <inline-formula><mml:math id="inf289"><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> equations, linear in the <inline-formula><mml:math id="inf290"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> unknown maximal conductances <inline-formula><mml:math id="inf291"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">ð </mml:mi><mml:mo>Â¯</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>Â¯</mml:mo></mml:mover><mml:mrow><mml:mi>d</mml:mi><mml:mo>â¢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>Â¯</mml:mo></mml:mover><mml:mrow><mml:mi>d</mml:mi><mml:mo>â¢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, that can be recast in a form <inline-formula><mml:math id="inf292"><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>A</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">ð </mml:mi><mml:mo>Â¯</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="bold">ð</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf293"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf294"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula> depend on the holding potential and expansion points. On the one hand, we aim to compute these linearizations for a sufficiently large range of holding potentials and expansion points. On the other hand, the fit should be restricted to domains of the ion-channel phase space where the channel resides during normal input integration, so as to avoid over-fitting on domains of the phase space that are never reached. We choose four holding potentials around which to linearize: <inline-formula><mml:math id="inf295"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>75</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>55</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>35</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf296"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>â</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> mV. For channels with a single state variable <inline-formula><mml:math id="inf297"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, we choose <inline-formula><mml:math id="inf298"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mn>0</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi mathvariant="normal">â</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> for these four holding potentials. For channels with two state variables, we computed <inline-formula><mml:math id="inf299"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mn>1</mml:mn><mml:mn>0</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="normal">â</mml:mi><mml:mo>â¢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf300"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mn>2</mml:mn><mml:mn>0</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="normal">â</mml:mi><mml:mo>â¢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> for the four holding potentials, and choose sixteen expansion points as all possible combinations of these two state variables. We then weigh the matrices <inline-formula><mml:math id="inf301"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>Â andÂ vectorsÂ <inline-formula><mml:math id="inf302"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> with the inverse of the open probability <inline-formula><mml:math id="inf303"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>f</mml:mi><mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>â¼</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> for their respective expansion point, concatenate the matrices <inline-formula><mml:math id="inf304"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and vectors <inline-formula><mml:math id="inf305"><mml:mi mathvariant="bold">ð</mml:mi></mml:math></inline-formula> for each of these expansion points, and obtain the system <inline-formula><mml:math id="inf306"><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>A</mml:mi><mml:mtext>ext</mml:mtext></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">ð </mml:mi><mml:mo>Â¯</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">ð</mml:mi><mml:mtext>ext</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> of <inline-formula><mml:math id="inf307"><mml:mrow><mml:mi>E</mml:mi><mml:mo>â¢</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> equations (with <inline-formula><mml:math id="inf308"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> the number of expansion points) and <inline-formula><mml:math id="inf309"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> unknowns. We solve this system in the least-squares sense for <inline-formula><mml:math id="inf310"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">ð </mml:mi><mml:mo>Â¯</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub></mml:math></inline-formula> and repeat this procedure for each voltage-dependent ion channel in the biophysical model.</p></list-item><list-item><p>Finally, we fit <inline-formula><mml:math id="inf311"><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (<inline-formula><mml:math id="inf312"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>) to reproduce the resting membrane potential <inline-formula><mml:math id="inf313"><mml:mrow><mml:msub><mml:mi mathvariant="bold">ð¯</mml:mi><mml:mtext>eq</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mtext>eq</mml:mtext><mml:mo>â¢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mtext>eq</mml:mtext><mml:mo>â¢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of the biophysical model evaluated at the compartment sites. We substitute this potential in (<xref ref-type="disp-formula" rid="equ21">Equation 21</xref>), set <inline-formula><mml:math id="inf314"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>Ë</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf315"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf316"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and obtain:Â <disp-formula id="equ27"><label>(27)</label><mml:math id="m27"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mtext>eq</mml:mtext><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">â</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>â</mml:mo><mml:msub><mml:mi class="ltx_font_mathcaligraphic">ð©</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>â¢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mtext>eq</mml:mtext><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mtext>eq</mml:mtext><mml:mo>â¢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">â</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>â</mml:mo><mml:msub><mml:mi class="ltx_font_mathcaligraphic">ð</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mtext>eq</mml:mtext><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo rspace="13.9pt">,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This is a system of <inline-formula><mml:math id="inf317"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> equations, linear in the <inline-formula><mml:math id="inf318"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> unknowns <inline-formula><mml:math id="inf319"><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>â¢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (<inline-formula><mml:math id="inf320"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>), and can thus be solved with standard algebraic techniques.</p></list-item></list></sec><sec id="s4-9"><title>Synaptic weight-rescale factors</title><p>To be able to analytically compute the weight-rescale factor when a synapse with temporal conductance <inline-formula><mml:math id="inf321"><mml:mrow><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is moved from its original site <inline-formula><mml:math id="inf322"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> to a compartment site <inline-formula><mml:math id="inf323"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> on a dendritic tree, we use the steady-state approximation (<xref ref-type="disp-formula" rid="equ18">Equation 18</xref>). Because we implicitly convolve the rescaled synaptic current with the temporal input impedance kernel <inline-formula><mml:math id="inf324"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at the compartment site when we simulate the reduced model, the weight-rescale factor still yields accurate temporal voltage responses (<xref ref-type="fig" rid="fig4">Figure 4B,E,H</xref>). In the original configuration, we have<disp-formula id="equ28"><label>(28)</label><mml:math id="m28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>â®</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>v</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>â¯</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>â®</mml:mo><mml:mtable columnalign="center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>â¯</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>â®</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo>â</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo>â¯</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>with <inline-formula><mml:math id="inf325"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> an arbitrary current at the compartment site and <inline-formula><mml:math id="inf326"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> resp. <inline-formula><mml:math id="inf327"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> the synaptic conductance resp. reversal. Eliminating <inline-formula><mml:math id="inf328"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> from this yields<disp-formula id="equ29"><label>(29)</label><mml:math id="m29"><mml:mrow><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In the reduced configuration we have:<disp-formula id="equ30"><label>(30)</label><mml:math id="m30"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>c</mml:mi><mml:mo>â²</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>Î²</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>c</mml:mi><mml:mo>â²</mml:mo></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>From requiring that <inline-formula><mml:math id="inf329"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>c</mml:mi><mml:mo>â²</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf330"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Î²</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is found asÂ follows:<disp-formula id="equ31"><label>(31)</label><mml:math id="m31"><mml:mrow><mml:mrow><mml:mi>Î²</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>â¢</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:msubsup><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>When <inline-formula><mml:math id="inf331"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>â</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, which is true in basal dendrites and a reasonable approximation in many apical dendrites if <inline-formula><mml:math id="inf332"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is on the direct path from <inline-formula><mml:math id="inf333"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> to the soma, (<xref ref-type="disp-formula" rid="equ31">Equation 31</xref>) reduces to<disp-formula id="equ32"><label>(32)</label><mml:math id="m32"><mml:mrow><mml:mrow><mml:mi>Î²</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The weight-rescale factor hence depends on time. Decomposing the time-varying <inline-formula><mml:math id="inf334"><mml:mrow><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> into <inline-formula><mml:math id="inf335"><mml:mrow><mml:mi>g</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="inf336"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> the temporal average and <inline-formula><mml:math id="inf337"><mml:mrow><mml:mi>Î´</mml:mi><mml:mo>â¢</mml:mo><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> the fluctuations around <inline-formula><mml:math id="inf338"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, we find (<xref ref-type="disp-formula" rid="equ8">Equation 8</xref>) and (<xref ref-type="disp-formula" rid="equ9">Equation 9</xref>) from requiring that the denominator of (<xref ref-type="disp-formula" rid="equ32">Equation 32</xref>) be constant in time:<disp-formula id="equ33"><label>(33)</label><mml:math id="m33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Î²</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Î</mml:mi><mml:mi>z</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>g</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Î</mml:mi><mml:mi>z</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>Î´</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Î</mml:mi><mml:mi>z</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>g</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mi>z</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>Î´</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Î</mml:mi><mml:mi>z</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>g</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>â</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Î</mml:mi><mml:mi>z</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>g</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="1em"/><mml:mtext>if</mml:mtext><mml:mspace width="1em"/><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mi>z</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>Î´</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Î</mml:mi><mml:mi>z</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>g</mml:mi></mml:mrow></mml:mfrac><mml:mo>âª</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf339"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mo>â¢</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>In the case of an NMDA synapse, the conductance depends sigmoidally on the local voltage. Using scale factor (<xref ref-type="disp-formula" rid="equ8">Equation 8</xref>), we obtain for the rescaled synaptic current at the compartment site:<disp-formula id="equ34"><label>(34)</label><mml:math id="m34"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mo>â²</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mfrac><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>g</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi>Ï</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">Î</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>g</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi>Ï</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">Î</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mpadded><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This current still depends on the voltage at the synaptic site <inline-formula><mml:math id="inf340"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> in the sigmoid. A current at the compartment site that causes a voltage <inline-formula><mml:math id="inf341"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> there would have caused a voltage<disp-formula id="equ35"><label>(35)</label><mml:math id="m35"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>â¢</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mfrac><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mpadded><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>â¢</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>if it was placed at the synapse site. Hence, to retain the same activation level of the NMDA synapse, we substitute (<xref ref-type="disp-formula" rid="equ35">Equation 35</xref>) in the sigmoid. This amounts to a change in threshold and width of the sigmoid:<disp-formula id="equ36"><label>(36)</label><mml:math id="m36"><mml:mrow><mml:mrow><mml:mrow><mml:mi>Ï</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">Î</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>â¶</mml:mo><mml:mrow><mml:mi>Ï</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>â¢</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mfrac><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mpadded><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>â¢</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">Î</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>Ï</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:mfrac><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mpadded><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>â¢</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>â¢</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mfrac><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mpadded><mml:mo>â¢</mml:mo><mml:msub><mml:mi mathvariant="normal">Î</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We will denote this modified sigmoid as <inline-formula><mml:math id="inf342"><mml:mrow><mml:msup><mml:mi>Ï</mml:mi><mml:mo>â²</mml:mo></mml:msup><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We have not yet succeeded in reformulating (<xref ref-type="disp-formula" rid="equ34">Equation 34</xref>) by only rescaling its parameters with constant rescale factors, since <inline-formula><mml:math id="inf343"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>g</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:msup><mml:mi>Ï</mml:mi><mml:mo>â²</mml:mo></mml:msup><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> still depends on time through its dependence on <inline-formula><mml:math id="inf344"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. To obtain constant rescale factors, we substitute the (<xref ref-type="disp-formula" rid="equ34">Equation 34</xref>) in (<xref ref-type="disp-formula" rid="equ17">Equation 17</xref>):<disp-formula id="equ37"><label>(37)</label><mml:math id="m37"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>â¢</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>â</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>g</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:msup><mml:mi>Ï</mml:mi><mml:mo>â²</mml:mo></mml:msup><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>g</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:msup><mml:mi>Ï</mml:mi><mml:mo>â²</mml:mo></mml:msup><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, the current in square brackets is the synaptic current. The convolution to obtain <inline-formula><mml:math id="inf345"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is implemented implicitly by the compartmental model. We then approximately eliminate the denominator:Â <disp-formula id="equ38"><label>(38)</label><mml:math id="m38"><mml:mrow><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>â¢</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>â</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>â</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>g</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:msup><mml:mi>Ï</mml:mi><mml:mo>â²</mml:mo></mml:msup><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>â¢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>g</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:msup><mml:mi>Ï</mml:mi><mml:mo>â²</mml:mo></mml:msup><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>â¢</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>to obtain for the synaptic current:Â <disp-formula id="equ39"><label>(39)</label><mml:math id="m39"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mo>â²</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mfrac><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mpadded><mml:mo>â¢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>g</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:msup><mml:mi>Ï</mml:mi><mml:mo>â²</mml:mo></mml:msup><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mfrac><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>â¢</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>â¢</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We thus find that the synaptic weight is rescaled by a constant factor <inline-formula><mml:math id="inf346"><mml:mfrac><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:math></inline-formula> and the reversal potential isÂ shifted to <inline-formula><mml:math id="inf347"><mml:mrow><mml:mrow><mml:mfrac><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>â¢</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>â¢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>â¢</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>â¢</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Note however that this reduction relies on two key assumptions: that there are no other inputs to the dendritic tree and that there are no fluctuations in <inline-formula><mml:math id="inf348"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> generated by input currents not at site <inline-formula><mml:math id="inf349"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, as this could lead to spurious activation or suppression of <inline-formula><mml:math id="inf350"><mml:mrow><mml:msup><mml:mi>Ï</mml:mi><mml:mo>â²</mml:mo></mml:msup><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>Suppose now we shift <inline-formula><mml:math id="inf351"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> conductance synapses to <inline-formula><mml:math id="inf352"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> compartments. Let <inline-formula><mml:math id="inf353"><mml:mrow><mml:mi mathvariant="bold">ð¯</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> be the vector with <inline-formula><mml:math id="inf354"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> components containing the voltages at the <inline-formula><mml:math id="inf355"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> compartment sites and at the <inline-formula><mml:math id="inf356"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> synapse sites. Similarly <inline-formula><mml:math id="inf357"><mml:mrow><mml:mi mathvariant="bold">ð </mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a vector of <inline-formula><mml:math id="inf358"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> components containing <inline-formula><mml:math id="inf359"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> zeros and the <inline-formula><mml:math id="inf360"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> synaptic conductances, while <inline-formula><mml:math id="inf361"><mml:mrow><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> contains the synaptic reversals. In matrix form, (<xref ref-type="disp-formula" rid="equ18">Equation 18</xref>) for this system becomes:<disp-formula id="equ40"><label>(40)</label><mml:math id="m40"><mml:mrow><mml:mrow><mml:mi>ð¯</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>Z</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:mtext>diag</mml:mtext><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ð </mml:mi><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>ð</mml:mi><mml:mo>-</mml:mo><mml:mi>ð¯</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>and its solution:<disp-formula id="equ41"><label>(41)</label><mml:math id="m41"><mml:mrow><mml:mrow><mml:mi>ð¯</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi mathvariant="normal">Î</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:mi>ð</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>with <inline-formula><mml:math id="inf362"><mml:mi mathvariant="normal">Î</mml:mi></mml:math></inline-formula> a matrix given by:<disp-formula id="equ42"><label>(42)</label><mml:math id="m42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:mi>Z</mml:mi><mml:mspace width="thinmathspace"/><mml:mtext>diag</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">g</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>â</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mi>Z</mml:mi><mml:mspace width="thinmathspace"/><mml:mtext>diag</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">g</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>In the reduced setting, we assign each synapse to one compartment site (a reasonable choice could be the closest site). We introduce an <inline-formula><mml:math id="inf363"><mml:mrow><mml:mi>N</mml:mi><mml:mo>Ã</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> compartment assignment matrix <inline-formula><mml:math id="inf364"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> where an element <inline-formula><mml:math id="inf365"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>â¢</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is 1 if synapse <inline-formula><mml:math id="inf366"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is assigned to compartment <inline-formula><mml:math id="inf367"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and zero otherwise. We further introduce a vector of reduced compartment voltages <inline-formula><mml:math id="inf368"><mml:mrow><mml:msup><mml:mi mathvariant="bold">ð¯</mml:mi><mml:mo>â²</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mn>1</mml:mn><mml:mo>â²</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>N</mml:mi><mml:mo>â²</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, a vector of rescaled synaptic conductances <inline-formula><mml:math id="inf369"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">ð </mml:mi><mml:mi>Î²</mml:mi><mml:mo>â²</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>Î²</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>Î²</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and a vector of synaptic reversals <inline-formula><mml:math id="inf370"><mml:mrow><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â²</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. In the reduced model, voltages are obtained from:<disp-formula id="equ43"><label>(43)</label><mml:math id="m43"><mml:mrow><mml:mrow><mml:msup><mml:mi>ð¯</mml:mi><mml:mo>â²</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>Z</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>C</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:mtext>diag</mml:mtext><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ð </mml:mi><mml:mi>Î²</mml:mi><mml:mo>â²</mml:mo></mml:msubsup><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>ð</mml:mi><mml:mo>â²</mml:mo></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msup><mml:mi>C</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mpadded><mml:mo>â¢</mml:mo><mml:msup><mml:mi>ð¯</mml:mi><mml:mo>â²</mml:mo></mml:msup></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We then require that <inline-formula><mml:math id="inf371"><mml:mrow><mml:msub><mml:mi mathvariant="bold">ð¯</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold">ð¯</mml:mi><mml:mo>â²</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="inf372"><mml:msub><mml:mi mathvariant="bold">ð¯</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math></inline-formula> a vector containing the first <inline-formula><mml:math id="inf373"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> components of <inline-formula><mml:math id="inf374"><mml:mi mathvariant="bold">ð¯</mml:mi></mml:math></inline-formula>. We denote by <inline-formula><mml:math id="inf375"><mml:msub><mml:mi mathvariant="normal">Î</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>â¢</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> the matrix containing the first <inline-formula><mml:math id="inf376"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> rows and last <inline-formula><mml:math id="inf377"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> columns of <inline-formula><mml:math id="inf378"><mml:mi mathvariant="normal">Î</mml:mi></mml:math></inline-formula>, and note that we can write (<xref ref-type="disp-formula" rid="equ41">Equation 41</xref>) as <inline-formula><mml:math id="inf379"><mml:mrow><mml:msub><mml:mi mathvariant="bold">ð¯</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi mathvariant="normal">Î</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>â¢</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:msup><mml:mi mathvariant="bold">ð</mml:mi><mml:mo>â²</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. Substituting this in (<xref ref-type="disp-formula" rid="equ43">Equation 43</xref>) yields:<disp-formula id="equ44"><label>(44)</label><mml:math id="m44"><mml:mrow><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi mathvariant="normal">Î</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>â¢</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:msup><mml:mi>ð</mml:mi><mml:mo>â²</mml:mo></mml:msup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>Z</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>C</mml:mi></mml:mpadded><mml:mo>â¢</mml:mo><mml:mtext>diag</mml:mtext><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ð </mml:mi><mml:mi>Î²</mml:mi><mml:mo>â²</mml:mo></mml:msubsup><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>â¢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>ð</mml:mi><mml:mo>â²</mml:mo></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msup><mml:mi>C</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mpadded><mml:mo>â¢</mml:mo><mml:mpadded width="+1.7pt"><mml:msub><mml:mi mathvariant="normal">Î</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>â¢</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mpadded><mml:mo>â¢</mml:mo><mml:msup><mml:mi>ð</mml:mi><mml:mo>â²</mml:mo></mml:msup></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We then fit the parameters <inline-formula><mml:math id="inf380"><mml:mrow><mml:msub><mml:mi>Î²</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">â¦</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>Î²</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (here absorbed in <inline-formula><mml:math id="inf381"><mml:msubsup><mml:mi mathvariant="bold">ð </mml:mi><mml:mi>Î²</mml:mi><mml:mo>â²</mml:mo></mml:msubsup></mml:math></inline-formula>) in the least-square sense from:<disp-formula id="equ45"><label>(45)</label><mml:math id="m45"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Î</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>C</mml:mi><mml:mspace width="thinmathspace"/><mml:mtext>diag</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">g</mml:mi></mml:mrow><mml:mrow><mml:mi>Î²</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">â²</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>â</mml:mo><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:msub><mml:mi mathvariant="normal">Î</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>which again is a linear fit.</p></sec><sec id="s4-10"><title>Experimental recordings</title><p>Coronal slices (300 Î¼m thick) containing the anterior cingulate cortex (ACC) were prepared from 10 to 12 weekÂ old C57BL/6 mice using a vibratome on a block angled at 15 degree to the horizontal in ice-cold oxygenated artificial cerebral spinal fluid (ACSF) and then maintained in the same solution at 37Â°C for 15â120 min. Normal ACSF contained (in mM) NaCl, 125; NaHCO<sub>3</sub>, 25; KCl, 2.5; NaH<sub>2</sub>PO<sub>4</sub>, 1.25; MgCl<sub>2</sub>, 1; glucose, 25; CaCl<sub>2</sub>, 2; pH 7.4. Individual neurons were visualized with a Nikon Eclipse E600FN fit with a combination of oblique infrared illumination optics and epifluorescence, the switch between optical configurations was software-triggered (<xref ref-type="bibr" rid="bib55">Sieber et al., 2013</xref>). Pyramidal neurons were selected on the clearly visible, proximal apical dendrite. This selection criterion resulted in a homogeneous population of pyramidal neurons based on their firing properties and shape of the AP (i.e. all cells possessed a prominent after-hyperpolarization and a significant sag ratio at the soma). Dual somatic and dendritic whole-cell patch-clamp recordings were performed from identified L5 pyramidal neurons in the rostroventral ACC (1.1â1.4 mm below the pial surface, 1.1â0.2 mm rostral to the Bregma) using two Dagan BVC-700. During the experiments, the external recording solution (normal ACSF) was supplemented with 0.5 mM CNQX and 0.5 mM AP-5 to block excitatory glutamatergic synaptic transmission. Experiments were performed at physiological temperatures between 34â37Â°C. Whole-cell recording pipettes (somatic, 4 to 8 MÎ©; dendritic, 12 to 32 MÎ©), were pulled from borosilicate glass. The internal pipette solution consisted of (in mM) potassium gluconate, 135; KCl, 7; Hepes, 10; Na<sub>2</sub>-phosphocreatine, 10; Mg-ATP, 4; GTP, 0.3; 0.2% biocytin; pH 7.2 (with KOH); 291â293 mosmol l<sup>â1</sup>. For somatic recordings, 10â20 Î¼m Alexa 594 was added to the intracellular solution: first, the soma was patched (whole-cell configuration by negative pressure); after 5 min of intracellular perfusion, the fluorescent signal allowed for the clear identification of the apical dendritic tree, then the dendritic region of interest was patched with a smaller pipette. Compensation was performed in current clamp mode by recovering the fast, initial square voltage response to a hyperpolarizing current injection (â100 pA, 50 ms). First the pipette capacitance was compensated to the level that the voltage response showed an immediate voltage drop due to the series resistance of the pipette that was adjusted subsequently. Compensation of dendritic series resistance yielded values between 30Â andÂ 60 MÎ© for pipettes with a resistance between 17Â andÂ 21 MÎ©. On average, series resistance was 2.3 times larger than the pipette resistance. Series resistance of both somatic and dendritic recording electrodes was monitored frequently, and experiments were terminated when proper compensation was not possible anymore (i.e. reached values of more than four times the pipette resistance). All cells were filled with biocytin, and PFA-fixed slices were developed with the avidinâbiotin-peroxidase method for Neurolucida reconstructions (<xref ref-type="bibr" rid="bib15">Egger et al., 2008</xref>). Data analysis was performed using Igor software (Wavemetrics) and Excel (Microsoft).</p></sec><sec id="s4-11"><title>Simulation-specific parameters</title><sec id="s4-11-1"><title>Parameters <xref ref-type="fig" rid="fig2">Figure 2</xref></title><p>For the sequence detection (<xref ref-type="fig" rid="fig1">Figure 1f</xref>), the synapse model is as in <xref ref-type="bibr" rid="bib6">Branco and HÃ¤usser, 2010</xref>. The maximal conductance of the AMPA component is <inline-formula><mml:math id="inf382"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>Â¯</mml:mo></mml:mover><mml:mtext>AMPA</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> nS and its conductance window shape given by an alpha function (<xref ref-type="bibr" rid="bib52">Rotter and Diesmann, 1999</xref>) with a timeÂ scale of 2 ms. The NMDA component is given by a kinetic model (<xref ref-type="bibr" rid="bib11">Destexhe et al., 1998</xref>) with <inline-formula><mml:math id="inf383"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>Â¯</mml:mo></mml:mover><mml:mtext>NMDA</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula> nS and external magnesium concentration of 1 mM, and receives an exponentially decaying (<inline-formula><mml:math id="inf384"><mml:mrow><mml:mi>Ï</mml:mi><mml:mo>=</mml:mo><mml:mn>.5</mml:mn></mml:mrow></mml:math></inline-formula> ms) neurotransmitter concentration with amplitude of 5 mM. For the input-order detection (<xref ref-type="fig" rid="fig1">Figure 1G</xref>), AMPA synapses 1 and 2 use the standard parameters and have respective maximal conductances of 10 and 5 nS. For the simulation with the L5 pyramidal cell, excitatory synapses have AMPA+NMDA components with <inline-formula><mml:math id="inf385"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mtext>NMDA</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf386"><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> nS. For inhibitory synapses, <inline-formula><mml:math id="inf387"><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> nS. In the Purkinje cell, excitatory synapses only have AMPA components with <inline-formula><mml:math id="inf388"><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> nS, while for inhibitory synapses, <inline-formula><mml:math id="inf389"><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> nS. For the L2/3 pyramid, L5 pyramid, resp. Purkinje cell, excitatory Poisson rates are 2, five resp. 6 Hz and inhibitory firing rates are 4, one resp. 2 Hz. Simulation were run for 10,000 ms.</p></sec><sec id="s4-11-2"><title>Parameters <xref ref-type="fig" rid="fig3">Figure 3</xref></title><p>APs are evoked with a DC current pulse. For panelsÂ AâC, pulse amplitude is <inline-formula><mml:math id="inf390"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mtext>amp</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> nA and pulse duration is <inline-formula><mml:math id="inf391"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mtext>dur</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> ms. For panels DâF, we have <inline-formula><mml:math id="inf392"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mtext>amp</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> nA and <inline-formula><mml:math id="inf393"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mtext>dur</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> ms. For panels GâI, <inline-formula><mml:math id="inf394"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mtext>amp</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math></inline-formula> nA and <inline-formula><mml:math id="inf395"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mtext>dur</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> ms. For panels JâK, the somatic current pulse had <inline-formula><mml:math id="inf396"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mtext>amp</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1.9</mml:mn></mml:mrow></mml:math></inline-formula> nA and <inline-formula><mml:math id="inf397"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mtext>dur</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> ms, while the dendritic current injection had a double exponential waveform, with <inline-formula><mml:math id="inf398"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>Ï</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> ms and <inline-formula><mml:math id="inf399"><mml:mrow><mml:msub><mml:mi>Ï</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> ms and amplitude <inline-formula><mml:math id="inf400"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mtext>amp</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> nA. Onset of the somatic current pulse precedes onset of the dendritic current injection by 5 ms.</p></sec><sec id="s4-11-3"><title>Parameters <xref ref-type="fig" rid="fig4">Figure 4</xref></title><p>In panel B, we inject OrnsteinâUhlenbeckÂ (OU) processes for current (mean <inline-formula><mml:math id="inf401"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Î¼</mml:mi><mml:mo>=</mml:mo><mml:mn>0.08</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> nA and standard deviation <inline-formula><mml:math id="inf402"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Ï</mml:mi><mml:mo>=</mml:mo><mml:mn>0.025</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> nA) and conductance (<inline-formula><mml:math id="inf403"><mml:mrow><mml:mi>Î¼</mml:mi><mml:mo>=</mml:mo><mml:mn>0.005</mml:mn></mml:mrow></mml:math></inline-formula> Î¼S, <inline-formula><mml:math id="inf404"><mml:mrow><mml:mi>Ï</mml:mi><mml:mo>=</mml:mo><mml:mn>0.0025</mml:mn></mml:mrow></mml:math></inline-formula> Î¼S). Reversal was 0 mV for the excitatory conductance and â80 mV for the inhibitory conductance. All OU processes had a timeÂ scale of 30 ms. In panels DâF, we use AMPA+NMDA synapses with <inline-formula><mml:math id="inf405"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>g</mml:mi><mml:mo accent="false">Â¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> nS and <inline-formula><mml:math id="inf406"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mtext>NMDA</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>. Burst firing is mimicked by drawing synapse activation times from a Gaussian distribution with as mean the burst time and a standardÂ deviation of 2 ms.</p><p>In panels GâJ, AMPA+NMDA synapses at the compartment site (green square) have <inline-formula><mml:math id="inf407"><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>Â¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> nS and <inline-formula><mml:math id="inf408"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mtext>NMDA</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. To determine the NMDA-spike threshold, we activate between 0 and 200 synapses in a burst. The burst is again modeled by drawing spikeÂ times from a Gaussian distribution with a 2 ms standard deviation. We then multiply the amplitude of the resulting waveform with its half-width, and average this quantity over five trials for each number of activated synapses. The number of synapses at which this quantity increases most is taken to be the NMDA-spike threshold.</p><p>We aim to test the synaptic weight-rescale factors for the AMPA and GABA synapses <inline-formula><mml:math id="inf409"><mml:msubsup><mml:mi>Î²</mml:mi><mml:mtext>cond</mml:mtext><mml:mtext>ext</mml:mtext></mml:msubsup></mml:math></inline-formula> under a wide range of input conditions. To do so, we conduct simulations with different total time-averaged conductance loads <inline-formula><mml:math id="inf410"><mml:msub><mml:mi>g</mml:mi><mml:mtext>avg</mml:mtext></mml:msub></mml:math></inline-formula>, exerted by the AMPA and a GABA synapse on the subtree that is to be reduced. These synapses are activated with spike times drawn from a homogeneous Poisson process. We also also change the size of the conductance fluctuations, by conducting simulations with different firing rates for the homogeneous Poisson processes (since the total conductance load for a simulation is fixed, a small firing rate means that individual synaptic weights have to be increased to reach the desired total conductance load, hence resulting in larger conductance fluctuations). We furthermore change the number of locations on the subtree <inline-formula><mml:math id="inf411"><mml:msub><mml:mi>n</mml:mi><mml:mtext>loc</mml:mtext></mml:msub></mml:math></inline-formula> over which the conductance load is distributed. Note that by consequence, the conductance load at each location is <inline-formula><mml:math id="inf412"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>avg</mml:mtext></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mtext>loc</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>. We also adapt these locations to a specified average difference in input resistance <inline-formula><mml:math id="inf413"><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mtext>avg</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> between the compartment site and the location. Finally, we change the average voltage level achieved by the combined AMPA and GABA input by changing the ânudging potentialâ <inline-formula><mml:math id="inf414"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib60">Urbanczik and Senn, 2014</xref>)<disp-formula id="equ46"><label>(46)</label><mml:math id="m46"><mml:mrow><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>AMPA</mml:mtext></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mtext>AMPA</mml:mtext></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>GABA</mml:mtext></mml:msub><mml:mo>â¢</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mtext>GABA</mml:mtext></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>AMPA</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>GABA</mml:mtext></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf415"><mml:msub><mml:mi>g</mml:mi><mml:mtext>AMPA</mml:mtext></mml:msub></mml:math></inline-formula> resp. <inline-formula><mml:math id="inf416"><mml:msub><mml:mi>g</mml:mi><mml:mtext>GABA</mml:mtext></mml:msub></mml:math></inline-formula> are the time-average conductances of individual AMPA resp. GABA synapses, and <inline-formula><mml:math id="inf417"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>AMPA</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> mV resp. <inline-formula><mml:math id="inf418"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>GABA</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>80</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> mV their respective reversal potentials.</p><p>We thus draw five meta-parameters for each simulation: <inline-formula><mml:math id="inf419"><mml:msub><mml:mi>g</mml:mi><mml:mtext>avg</mml:mtext></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf420"><mml:msub><mml:mi>r</mml:mi><mml:mtext>avg</mml:mtext></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf421"><mml:msub><mml:mi>n</mml:mi><mml:mtext>loc</mml:mtext></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf422"><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mtext>avg</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf423"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. The time-averaged conductance at each location is given byÂ <disp-formula id="equ47"><label>(47)</label><mml:math id="m47"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>avg</mml:mtext></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mtext>loc</mml:mtext></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>AMPA</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>GABA</mml:mtext></mml:msub></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Together with (<xref ref-type="disp-formula" rid="equ46">Equation 46</xref>), this fixes the time-averaged conductance of each individual AMPA synapse and GABA synapse. Since the temporal conductance profile of a synapse (e.g. the AMPA synapse) following the arrival of a single input AP is modeled as the product of a weight factor <inline-formula><mml:math id="inf424"><mml:msub><mml:mi>w</mml:mi><mml:mtext>AMPA</mml:mtext></mml:msub></mml:math></inline-formula> and a unitary conductance window <inline-formula><mml:math id="inf425"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mo>â¢</mml:mo><mml:mtext>AMPA</mml:mtext></mml:mrow></mml:msub><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the time-averaged conductance of that synapses activated by a homogeneous Poisson process input isÂ <disp-formula id="equ48"><label>(48)</label><mml:math id="m48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mtext>AMPA</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mtext>AMPA</mml:mtext></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mtext>avg</mml:mtext></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mo>â«</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">â</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mtext>AMPA</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Thus, given <inline-formula><mml:math id="inf426"><mml:msub><mml:mi>r</mml:mi><mml:mtext>avg</mml:mtext></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf427"><mml:msub><mml:mi>g</mml:mi><mml:mtext>AMPA</mml:mtext></mml:msub></mml:math></inline-formula>, the synaptic weight <inline-formula><mml:math id="inf428"><mml:msub><mml:mi>w</mml:mi><mml:mtext>AMPA</mml:mtext></mml:msub></mml:math></inline-formula> can be extracted (and similarly for the GABA synapse).</p><p>To perform simulations across a wide range of input conditions, we draw 200 samples of these five meta-parameters from the intervals: <inline-formula><mml:math id="inf429"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>â</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>80</mml:mn><mml:mo>â¢</mml:mo> <mml:mtext>mV</mml:mtext></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>50</mml:mn><mml:mo>â¢</mml:mo> <mml:mtext>mV</mml:mtext></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf430"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>avg</mml:mtext></mml:msub><mml:mo>â</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mn>0.01</mml:mn><mml:mo>â¢</mml:mo> <mml:mtext>nS</mml:mtext></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>300</mml:mn><mml:mo>â¢</mml:mo> <mml:mtext>nS</mml:mtext></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf431"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mtext>avg</mml:mtext></mml:msub><mml:mo>â</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>â¢</mml:mo> <mml:mtext>Hz</mml:mtext></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>100</mml:mn><mml:mo>â¢</mml:mo> <mml:mtext>Hz</mml:mtext></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf432"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mtext>loc</mml:mtext></mml:msub><mml:mo>â</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf433"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Î</mml:mi><mml:mo>â¢</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mtext>avg</mml:mtext></mml:msub></mml:mrow><mml:mo>â</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>â¢</mml:mo> <mml:mtext>M</mml:mtext><mml:mo>â¢</mml:mo><mml:mi mathvariant="normal">Î©</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>1023.2</mml:mn><mml:mo>â¢</mml:mo> <mml:mtext>M</mml:mtext><mml:mo>â¢</mml:mo><mml:mi mathvariant="normal">Î©</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> following the Latin hypercube (LH) method (<xref ref-type="bibr" rid="bib51">Press et al., 2007</xref>). <inline-formula><mml:math id="inf434"><mml:msub><mml:mi>g</mml:mi><mml:mtext>avg</mml:mtext></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf435"><mml:msub><mml:mi>r</mml:mi><mml:mtext>avg</mml:mtext></mml:msub></mml:math></inline-formula> are sampled on a log scale, whereas for all other parameters, we use a linear scale.</p></sec><sec id="s4-11-4"><title>Parameters <xref ref-type="fig" rid="fig5">Figure 5</xref></title><p>To obtain compartment sites, we divide the longest branch in each basal subtree in <inline-formula><mml:math id="inf436"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> parts of equal length, thus giving us <inline-formula><mml:math id="inf437"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> distances from the soma, where we increase <inline-formula><mml:math id="inf438"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> from 0 (point-neuron) to 10. In each subtree, we distribute compartments at all sites at these distances, and also add all bifurcation sites in between compartment sites. In this way, we obtain 11 reductions that we quantify according to âno. of compartments per 100 Î¼m of dendriteâ. We implement 400 âbackgroundâ synapses; 200 AMPA and 200 GABA synapses with an average conductance of <inline-formula><mml:math id="inf439"><mml:msub><mml:mi>g</mml:mi><mml:mtext>AMPA</mml:mtext></mml:msub></mml:math></inline-formula> resp. <inline-formula><mml:math id="inf440"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>GABA</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mn>4</mml:mn></mml:mpadded><mml:mo>â¢</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>AMPA</mml:mtext></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and firing rate <inline-formula><mml:math id="inf441"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mtext>AMPA</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mtext>avg</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> resp. <inline-formula><mml:math id="inf442"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mtext>GABA</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mtext>avg</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>. We implement 20 synapse clusters, consisting of AMPA+NMDA synapses with maximal conductance <inline-formula><mml:math id="inf443"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>Â¯</mml:mo></mml:mover><mml:mtext>A+N</mml:mtext></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf444"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mtext>NMDA</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. These clusters are activated with a Poissonian burst rate <inline-formula><mml:math id="inf445"><mml:msub><mml:mi>r</mml:mi><mml:mtext>burst</mml:mtext></mml:msub></mml:math></inline-formula>, the number of spikes per burst is drawn from a Poisson distribution with parameter <inline-formula><mml:math id="inf446"><mml:msub><mml:mi>n</mml:mi><mml:mtext>avg</mml:mtext></mml:msub></mml:math></inline-formula>, and spike times are drawn for each burst time according to a Gaussian distribution with standard deviation of 5 ms. For each of the parameters not given previously, 10 LH samples were drawn from <inline-formula><mml:math id="inf447"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mtext>AMPA</mml:mtext></mml:mrow></mml:msub><mml:mo>â</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0.4</mml:mn><mml:mspace width="thinmathspace"/><mml:mtext>nS</mml:mtext><mml:mo>,</mml:mo><mml:mn>0.8</mml:mn><mml:mspace width="thinmathspace"/><mml:mtext>nS</mml:mtext><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf448"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mtext>avg</mml:mtext></mml:mrow></mml:msub><mml:mo>â</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1.5</mml:mn><mml:mspace width="thinmathspace"/><mml:mtext>Hz</mml:mtext><mml:mo>,</mml:mo><mml:mn>3.0</mml:mn><mml:mspace width="thinmathspace"/><mml:mtext>Hz</mml:mtext><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf449"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mover><mml:mi>g</mml:mi><mml:mo accent="false">Â¯</mml:mo></mml:mover><mml:mrow><mml:mtext>A+N</mml:mtext></mml:mrow></mml:msub><mml:mo>â</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0.5</mml:mn><mml:mspace width="thinmathspace"/><mml:mtext>nS</mml:mtext><mml:mo>,</mml:mo><mml:mn>1.5</mml:mn><mml:mspace width="thinmathspace"/><mml:mtext>nS</mml:mtext><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf450"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mtext>avg</mml:mtext></mml:msub><mml:mo>â</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>30</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf451"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mtext>burst</mml:mtext></mml:mrow></mml:msub><mml:mo>â</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0.25</mml:mn><mml:mspace width="thinmathspace"/><mml:mtext>Hz</mml:mtext><mml:mo>,</mml:mo><mml:mn>0.6</mml:mn><mml:mspace width="thinmathspace"/><mml:mtext>Hz</mml:mtext><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, resulting in 10 different output spike rates shown in B. For each parameter set, a simulation was run for 10,000 ms.</p></sec><sec id="s4-11-5"><title>Parameters <xref ref-type="fig" rid="fig6">Figure 6</xref></title><p>Hyper- resp. depolarizing current steps have <inline-formula><mml:math id="inf452"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mtext>amp</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>.3</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> nA resp. <inline-formula><mml:math id="inf453"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mtext>amp</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>.1</mml:mn></mml:mrow></mml:math></inline-formula> nA and <inline-formula><mml:math id="inf454"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mtext>dur</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math></inline-formula> ms. The full model was optimized with an evolutionary algorithm using the BluePyOpt library (<xref ref-type="bibr" rid="bib61">Van Geit et al., 2016</xref>), where we ran 100 iterations with and offspring size of 100. Goodness of fit was evaluated in a multi-objective manner as the root mean square error of the resting voltage (average voltage 100 ms before each current step), the final step voltage amplitudes after sag (average voltage during the last 100 ms of the DC current injection), and the voltage root mean square error of the full trace. We optimized the specific membrane capacitance and the conductance densities for passive leak and <italic>h</italic>, <inline-formula><mml:math id="inf455"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>â¢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf456"><mml:msub><mml:mi>K</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> channels. The membrane currents followed an exponential distribution <inline-formula><mml:math id="inf457"><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>â¢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>â¢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="inf458"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> the distance from the soma, and as parameters <inline-formula><mml:math id="inf459"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> â the conductance at the soma â and <inline-formula><mml:math id="inf460"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> â the length constant of the distribution.</p></sec></sec><sec id="s4-12"><title>Data and software availability</title><p>NEAT (NEural Analysis Toolbox), our open-source Python toolbox to obtain reduced models, is available on <ext-link ext-link-type="uri" xlink:href="https://github.com/unibe-cns/NEAT">https://github.com/unibe-cns/NEATÂ </ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:7941f171d5917484eeafa5e76f9657073666a66a;origin=https://github.com/unibe-cns/NEAT;visit=swh:1:snp:0afcc15cf2ef0084749e7f7677ebf0324695dec3;anchor=swh:1:rev:1cb15f36aa0a764105348541d046c85ef38e21ee/">swh:1:rev:1cb15f36aa0a764105348541d046c85ef38e21ee</ext-link>).</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>This work was supported by the Swiss National Science Foundation (Grant 159872 to TN; Grant 180316 to WS â with F Helmchen), the European Unionâs Horizon 2020 Framework Programme (Grant 720270, 785907 and 945539 to WS â Human Brain Project SGA 1â3) and the European Research Council (Grant 682905 to TN). We thank all our lab colleagues for helpful discussions and critical comments on the figures.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Resources, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Resources, Software, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Resources, Software</p></fn><fn fn-type="con" id="con4"><p>Resources, Data curation</p></fn><fn fn-type="con" id="con5"><p>Supervision, Funding acquisition, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Supervision, Funding acquisition, Visualization, Writing - original draft, Project administration, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-60936-transrepform-v1.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All data generated or analysed during this study are included in the manuscript and supporting files.</p><p>The following previously published datasets were used:</p><p><element-citation id="dataset1" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Hay</surname><given-names>E</given-names></name><name><surname>Hill</surname><given-names>S</given-names></name><name><surname>SchÃ¼rmann</surname><given-names>F</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name><name><surname>Segev</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2011">2011</year><data-title>L5b PC model constrained for BAC firing and perisomatic current step firing</data-title><source>ModelDB</source><pub-id assigning-authority="other" pub-id-type="accession" xlink:href="https://senselab.med.yale.edu/ModelDB/showmodel.cshtml?model=139653#tabs-1">139653</pub-id></element-citation></p><p><element-citation id="dataset2" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Branco</surname><given-names>T</given-names></name><name><surname>Clark</surname><given-names>BA</given-names></name><name><surname>HÃ¤usser</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><data-title>Dendritic Discrimination of Temporal Input Sequences</data-title><source>ModelDB</source><pub-id assigning-authority="other" pub-id-type="accession" xlink:href="https://senselab.med.yale.edu/ModelDB/ShowModel?model=140828#tabs-1">140828</pub-id></element-citation></p><p><element-citation id="dataset3" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>XR</given-names></name><name><surname>Heck</surname><given-names>N</given-names></name><name><surname>Lohof</surname><given-names>AM</given-names></name><name><surname>Rochefort</surname><given-names>C</given-names></name><name><surname>Morel</surname><given-names>M</given-names></name><name><surname>Rosine</surname><given-names>W</given-names></name><name><surname>Doulazmi</surname><given-names>M</given-names></name><name><surname>Marty</surname><given-names>S</given-names></name><name><surname>Cannaya</surname><given-names>V</given-names></name><name><surname>Avci</surname><given-names>HX</given-names></name><name><surname>Mariani</surname><given-names>J</given-names></name><name><surname>Rondi-Reig</surname><given-names>L</given-names></name><name><surname>Vodjdani</surname><given-names>G</given-names></name><name><surname>Sherrard</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2013">2013</year><data-title>Mature Purkinje Cells Require the Retinoic Acid-Related Orphan Receptor-Î± (RORÎ±) to Maintain Climbing Fiber Mono-Innervation and Other Adult Characteristics</data-title><source>NeuroMorpho.org</source><pub-id assigning-authority="other" pub-id-type="accession" xlink:href="http://www.neuromorpho.org/neuron_info.jsp?neuron_name=Purkinje-slice-ageP35-2">NMO_100072</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Almog</surname> <given-names>M</given-names></name><name><surname>Korngreen</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A quantitative description of dendritic conductances and its application to dendritic excitation in layer 5 pyramidal neurons</article-title><source>Journal of Neuroscience</source><volume>34</volume><fpage>182</fpage><lpage>196</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2896-13.2014</pub-id><pub-id pub-id-type="pmid">24381280</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amsalem</surname> <given-names>O</given-names></name><name><surname>Eyal</surname> <given-names>G</given-names></name><name><surname>Rogozinski</surname> <given-names>N</given-names></name><name><surname>Gevaert</surname> <given-names>M</given-names></name><name><surname>Kumbhar</surname> <given-names>P</given-names></name><name><surname>SchÃ¼rmann</surname> <given-names>F</given-names></name><name><surname>Segev</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>An efficient analytical reduction of detailed nonlinear neuron models</article-title><source>Nature Communications</source><volume>11</volume><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="doi">10.1038/s41467-019-13932-6</pub-id><pub-id pub-id-type="pmid">31941884</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ascoli</surname> <given-names>GA</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Mobilizing the base of neuroscience data: the case of neuronal morphologies</article-title><source>Nature Reviews Neuroscience</source><volume>7</volume><fpage>318</fpage><lpage>324</lpage><pub-id pub-id-type="doi">10.1038/nrn1885</pub-id><pub-id pub-id-type="pmid">16552417</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bahl</surname> <given-names>A</given-names></name><name><surname>Stemmler</surname> <given-names>MB</given-names></name><name><surname>Herz</surname> <given-names>AV</given-names></name><name><surname>Roth</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Automated optimization of a reduced layer 5 pyramidal cell model based on experimental data</article-title><source>Journal of Neuroscience Methods</source><volume>210</volume><fpage>22</fpage><lpage>34</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2012.04.006</pub-id><pub-id pub-id-type="pmid">22524993</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Behabadi</surname> <given-names>BF</given-names></name><name><surname>Mel</surname> <given-names>BW</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Mechanisms underlying subunit independence in pyramidal neuron dendrites</article-title><source>PNAS</source><volume>111</volume><fpage>498</fpage><lpage>503</lpage><pub-id pub-id-type="doi">10.1073/pnas.1217645111</pub-id><pub-id pub-id-type="pmid">24357611</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Branco</surname> <given-names>T</given-names></name><name><surname>HÃ¤usser</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>The single dendritic branch as a fundamental functional unit in the nervous system</article-title><source>Current Opinion in Neurobiology</source><volume>20</volume><fpage>494</fpage><lpage>502</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2010.07.009</pub-id><pub-id pub-id-type="pmid">20800473</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Branco</surname> <given-names>T</given-names></name><name><surname>HÃ¤usser</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Synaptic integration gradients in single cortical pyramidal cell dendrites</article-title><source>Neuron</source><volume>69</volume><fpage>885</fpage><lpage>892</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.02.006</pub-id><pub-id pub-id-type="pmid">21382549</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Carnevale</surname> <given-names>NT</given-names></name><name><surname>Hines</surname> <given-names>ML</given-names></name></person-group><year iso-8601-date="2004">2004</year><source>The NEURON Book</source><publisher-name>Cambridge University Press</publisher-name><pub-id pub-id-type="doi">10.1017/CBO9780511541612</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname> <given-names>XR</given-names></name><name><surname>Heck</surname> <given-names>N</given-names></name><name><surname>Lohof</surname> <given-names>AM</given-names></name><name><surname>Rochefort</surname> <given-names>C</given-names></name><name><surname>Morel</surname> <given-names>MP</given-names></name><name><surname>WehrlÃ©</surname> <given-names>R</given-names></name><name><surname>Doulazmi</surname> <given-names>M</given-names></name><name><surname>Marty</surname> <given-names>S</given-names></name><name><surname>Cannaya</surname> <given-names>V</given-names></name><name><surname>Avci</surname> <given-names>HX</given-names></name><name><surname>Mariani</surname> <given-names>J</given-names></name><name><surname>Rondi-Reig</surname> <given-names>L</given-names></name><name><surname>Vodjdani</surname> <given-names>G</given-names></name><name><surname>Sherrard</surname> <given-names>RM</given-names></name><name><surname>Sotelo</surname> <given-names>C</given-names></name><name><surname>Dusart</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Mature purkinje cells require the retinoic acid-related orphan receptor-Î± (RORÎ±) to maintain climbing fiber mono-innervation and other adult characteristics</article-title><source>Journal of Neuroscience</source><volume>33</volume><fpage>9546</fpage><lpage>9562</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2977-12.2013</pub-id><pub-id pub-id-type="pmid">23719821</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davison</surname> <given-names>AP</given-names></name><name><surname>Feng</surname> <given-names>J</given-names></name><name><surname>Brown</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>A reduced compartmental model of the mitral cell for use in network models of the olfactory bulb</article-title><source>Brain Research Bulletin</source><volume>51</volume><fpage>393</fpage><lpage>399</lpage><pub-id pub-id-type="doi">10.1016/S0361-9230(99)00256-7</pub-id><pub-id pub-id-type="pmid">10715559</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Destexhe</surname> <given-names>A</given-names></name><name><surname>Mainen</surname> <given-names>ZF</given-names></name><name><surname>Sejnowski</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="1998">1998</year><chapter-title>Kinetic models of synaptic transmission</chapter-title><person-group person-group-type="editor"><name><surname>Koch</surname> <given-names>C</given-names></name><name><surname>Segev</surname> <given-names>I</given-names></name></person-group><source>Methods in Neuronal Modeling</source><publisher-name>MIT Press</publisher-name><fpage>1</fpage><lpage>26</lpage></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Destexhe</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Simplified models of neocortical pyramidal cells preserving somatodendritic voltage attenuation</article-title><source>Neurocomputing</source><volume>38-40</volume><fpage>167</fpage><lpage>173</lpage><pub-id pub-id-type="doi">10.1016/S0925-2312(01)00428-3</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Destexhe</surname> <given-names>A</given-names></name><name><surname>Rudolph</surname> <given-names>M</given-names></name><name><surname>ParÃ©</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>The high-conductance state of neocortical neurons in vivo</article-title><source>Nature Reviews Neuroscience</source><volume>4</volume><fpage>739</fpage><lpage>751</lpage><pub-id pub-id-type="doi">10.1038/nrn1198</pub-id><pub-id pub-id-type="pmid">12951566</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>DiLorenzo</surname> <given-names>PM</given-names></name><name><surname>Victor</surname> <given-names>JD</given-names></name></person-group><year iso-8601-date="2013">2013</year><chapter-title>Can we predict every spike?</chapter-title><person-group person-group-type="editor"><name><surname>DiLorenzo</surname> <given-names>P. M</given-names></name></person-group><source>Spike Timing</source><publisher-name>CRC Press</publisher-name><fpage>70</fpage><lpage>72</lpage></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Egger</surname> <given-names>V</given-names></name><name><surname>Nevian</surname> <given-names>T</given-names></name><name><surname>Bruno</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Subcolumnar dendritic and axonal organization of spiny stellate and star pyramid neurons within a barrel in rat somatosensory cortex</article-title><source>Cerebral Cortex</source><volume>18</volume><fpage>876</fpage><lpage>889</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhm126</pub-id><pub-id pub-id-type="pmid">17656622</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerstner</surname> <given-names>W</given-names></name><name><surname>Sprekeler</surname> <given-names>H</given-names></name><name><surname>Deco</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Theory and simulation in neuroscience</article-title><source>Science</source><volume>338</volume><fpage>60</fpage><lpage>65</lpage><pub-id pub-id-type="doi">10.1126/science.1227356</pub-id><pub-id pub-id-type="pmid">23042882</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerstner</surname> <given-names>W</given-names></name><name><surname>Naud</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Neuroscience. how good are neuron models?</article-title><source>Science</source><volume>326</volume><fpage>379</fpage><lpage>380</lpage><pub-id pub-id-type="doi">10.1126/science.1181936</pub-id><pub-id pub-id-type="pmid">19833951</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gewaltig</surname> <given-names>M-O</given-names></name><name><surname>Diesmann</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>NEST (NEural simulation tool)</article-title><source>Scholarpedia</source><volume>2</volume><elocation-id>1430</elocation-id><pub-id pub-id-type="doi">10.4249/scholarpedia.1430</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hay</surname> <given-names>E</given-names></name><name><surname>Hill</surname> <given-names>S</given-names></name><name><surname>SchÃ¼rmann</surname> <given-names>F</given-names></name><name><surname>Markram</surname> <given-names>H</given-names></name><name><surname>Segev</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Models of neocortical layer 5b pyramidal cells capturing a wide range of dendritic and perisomatic active properties</article-title><source>PLOSÂ Computational Biology</source><volume>7</volume><elocation-id>e1002107</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002107</pub-id><pub-id pub-id-type="pmid">21829333</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hendrickson</surname> <given-names>EB</given-names></name><name><surname>Edgerton</surname> <given-names>JR</given-names></name><name><surname>Jaeger</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The capabilities and limitations of conductance-based compartmental neuron models with reduced branched or unbranched morphologies and active dendrites</article-title><source>Journal of Computational Neuroscience</source><volume>30</volume><fpage>301</fpage><lpage>321</lpage><pub-id pub-id-type="doi">10.1007/s10827-010-0258-z</pub-id><pub-id pub-id-type="pmid">20623167</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holmes</surname> <given-names>WR</given-names></name><name><surname>Segev</surname> <given-names>I</given-names></name><name><surname>Rall</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Interpretation of time constant and electrotonic length estimates in multicylinder or branched neuronal structures</article-title><source>Journal of Neurophysiology</source><volume>68</volume><fpage>1401</fpage><lpage>1420</lpage><pub-id pub-id-type="doi">10.1152/jn.1992.68.4.1401</pub-id><pub-id pub-id-type="pmid">1432089</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jahr</surname> <given-names>CE</given-names></name><name><surname>Stevens</surname> <given-names>CF</given-names></name></person-group><year iso-8601-date="1990">1990a</year><article-title>A quantitative description of NMDA receptor-channel kinetic behavior</article-title><source>The Journal of Neuroscience</source><volume>10</volume><fpage>1830</fpage><lpage>1837</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.10-06-01830.1990</pub-id><pub-id pub-id-type="pmid">1693952</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jahr</surname> <given-names>CE</given-names></name><name><surname>Stevens</surname> <given-names>CF</given-names></name></person-group><year iso-8601-date="1990">1990b</year><article-title>Voltage dependence of NMDA-activated macroscopic conductances predicted by single-channel kinetics</article-title><source>The Journal of Neuroscience</source><volume>10</volume><fpage>3178</fpage><lpage>3182</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.10-09-03178.1990</pub-id><pub-id pub-id-type="pmid">1697902</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jolivet</surname> <given-names>R</given-names></name><name><surname>SchÃ¼rmann</surname> <given-names>F</given-names></name><name><surname>Berger</surname> <given-names>TK</given-names></name><name><surname>Naud</surname> <given-names>R</given-names></name><name><surname>Gerstner</surname> <given-names>W</given-names></name><name><surname>Roth</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>The quantitative single-neuron modeling competition</article-title><source>Biological Cybernetics</source><volume>99</volume><fpage>417</fpage><lpage>426</lpage><pub-id pub-id-type="doi">10.1007/s00422-008-0261-x</pub-id><pub-id pub-id-type="pmid">19011928</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kastellakis</surname> <given-names>G</given-names></name><name><surname>Silva</surname> <given-names>AJ</given-names></name><name><surname>Poirazi</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Linking memories across time via neuronal and dendritic overlaps in model neurons with active dendrites</article-title><source>Cell Reports</source><volume>17</volume><fpage>1491</fpage><lpage>1504</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2016.10.015</pub-id><pub-id pub-id-type="pmid">27806290</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kellems</surname> <given-names>AR</given-names></name><name><surname>Roos</surname> <given-names>D</given-names></name><name><surname>Xiao</surname> <given-names>N</given-names></name><name><surname>Cox</surname> <given-names>SJ</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Low-dimensional, morphologically accurate models of subthreshold membrane potential</article-title><source>Journal of Computational Neuroscience</source><volume>27</volume><fpage>161</fpage><lpage>176</lpage><pub-id pub-id-type="doi">10.1007/s10827-008-0134-2</pub-id><pub-id pub-id-type="pmid">19172386</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kellems</surname> <given-names>AR</given-names></name><name><surname>Chaturantabut</surname> <given-names>S</given-names></name><name><surname>Sorensen</surname> <given-names>DC</given-names></name><name><surname>Cox</surname> <given-names>SJ</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Morphologically accurate reduced order modeling of spiking neurons</article-title><source>Journal of Computational Neuroscience</source><volume>28</volume><fpage>477</fpage><lpage>494</lpage><pub-id pub-id-type="doi">10.1007/s10827-010-0229-4</pub-id><pub-id pub-id-type="pmid">20300957</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Koch</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="1998">1998</year><source>Biophysics of Computation: Information Processing in Single Neurons (Computational Neuroscience)</source><publisher-name>Oxford University Press</publisher-name><pub-id pub-id-type="doi">10.1093/oso/9780195104912.001.0001</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koch</surname> <given-names>C</given-names></name><name><surname>Poggio</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>A simple algorithm for solving the cable equation in dendritic trees of arbitrary geometry</article-title><source>Journal of Neuroscience Methods</source><volume>12</volume><fpage>303</fpage><lpage>315</lpage><pub-id pub-id-type="doi">10.1016/0165-0270(85)90015-9</pub-id><pub-id pub-id-type="pmid">3838780</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larkum</surname> <given-names>ME</given-names></name><name><surname>Zhu</surname> <given-names>JJ</given-names></name><name><surname>Sakmann</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>A new cellular mechanism for coupling inputs arriving at different cortical layers</article-title><source>Nature</source><volume>398</volume><fpage>338</fpage><lpage>341</lpage><pub-id pub-id-type="doi">10.1038/18686</pub-id><pub-id pub-id-type="pmid">10192334</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laudanski</surname> <given-names>J</given-names></name><name><surname>Torben-Nielsen</surname> <given-names>B</given-names></name><name><surname>Segev</surname> <given-names>I</given-names></name><name><surname>Shamma</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Spatially distributed dendritic resonance selectively filters synaptic input</article-title><source>PLOS Computational Biology</source><volume>10</volume><elocation-id>e1003775</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003775</pub-id><pub-id pub-id-type="pmid">25144440</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>MacDonald</surname> <given-names>JF</given-names></name><name><surname>Wojtowicz</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>The effects of L-glutamate and its analogues upon the membrane conductance of central murine neurones in culture</article-title><source>Canadian Journal of Physiology and Pharmacology</source><volume>60</volume><fpage>282</fpage><lpage>296</lpage><pub-id pub-id-type="doi">10.1139/y82-039</pub-id><pub-id pub-id-type="pmid">6122493</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Major</surname> <given-names>G</given-names></name><name><surname>Evans</surname> <given-names>JD</given-names></name><name><surname>Jack</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Solutions for transients in arbitrarily branching cables: I. voltage recording with a somatic shunt</article-title><source>Biophysical Journal</source><volume>65</volume><fpage>423</fpage><lpage>449</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(93)81037-3</pub-id><pub-id pub-id-type="pmid">8369447</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Major</surname> <given-names>G</given-names></name><name><surname>Polsky</surname> <given-names>A</given-names></name><name><surname>Denk</surname> <given-names>W</given-names></name><name><surname>Schiller</surname> <given-names>J</given-names></name><name><surname>Tank</surname> <given-names>DW</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Spatiotemporally graded NMDA spike/plateau potentials in basal dendrites of neocortical pyramidal neurons</article-title><source>Journal of Neurophysiology</source><volume>99</volume><fpage>2584</fpage><lpage>2601</lpage><pub-id pub-id-type="doi">10.1152/jn.00011.2008</pub-id><pub-id pub-id-type="pmid">18337370</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marasco</surname> <given-names>A</given-names></name><name><surname>Limongiello</surname> <given-names>A</given-names></name><name><surname>Migliore</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Using Strahler's analysis to reduce up to 200-fold the run time of realistic neuron models</article-title><source>Scientific Reports</source><volume>3</volume><elocation-id>2934</elocation-id><pub-id pub-id-type="doi">10.1038/srep02934</pub-id><pub-id pub-id-type="pmid">24121727</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marti Mengual</surname> <given-names>U</given-names></name><name><surname>Wybo</surname> <given-names>WAM</given-names></name><name><surname>Spierenburg</surname> <given-names>LJE</given-names></name><name><surname>Santello</surname> <given-names>M</given-names></name><name><surname>Senn</surname> <given-names>W</given-names></name><name><surname>Nevian</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Efficient low-pass dendro-somatic coupling in the apical dendrite of layer 5 pyramidal neurons in the anterior cingulate cortex</article-title><source>The Journal of Neuroscience</source><volume>40</volume><fpage>8799</fpage><lpage>8815</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3028-19.2020</pub-id><pub-id pub-id-type="pmid">33046549</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mauro</surname> <given-names>A</given-names></name><name><surname>Conti</surname> <given-names>F</given-names></name><name><surname>Dodge</surname> <given-names>F</given-names></name><name><surname>Schor</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1970">1970</year><article-title>Subthreshold behavior and phenomenological impedance of the squid giant axon</article-title><source>Journal of General Physiology</source><volume>55</volume><fpage>497</fpage><lpage>523</lpage><pub-id pub-id-type="doi">10.1085/jgp.55.4.497</pub-id><pub-id pub-id-type="pmid">5435782</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McDougal</surname> <given-names>RA</given-names></name><name><surname>Morse</surname> <given-names>TM</given-names></name><name><surname>Carnevale</surname> <given-names>T</given-names></name><name><surname>Marenco</surname> <given-names>L</given-names></name><name><surname>Wang</surname> <given-names>R</given-names></name><name><surname>Migliore</surname> <given-names>M</given-names></name><name><surname>Miller</surname> <given-names>PL</given-names></name><name><surname>Shepherd</surname> <given-names>GM</given-names></name><name><surname>Hines</surname> <given-names>ML</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Twenty years of ModelDB and beyond: building essential modeling tools for the future of neuroscience</article-title><source>Journal of Computational Neuroscience</source><volume>42</volume><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.1007/s10827-016-0623-7</pub-id><pub-id pub-id-type="pmid">27629590</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mel</surname> <given-names>BW</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Synaptic integration in an excitable dendritic tree</article-title><source>Journal of Neurophysiology</source><volume>70</volume><fpage>1086</fpage><lpage>1101</lpage><pub-id pub-id-type="doi">10.1152/jn.1993.70.3.1086</pub-id><pub-id pub-id-type="pmid">8229160</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miyasho</surname> <given-names>T</given-names></name><name><surname>Takagi</surname> <given-names>H</given-names></name><name><surname>Suzuki</surname> <given-names>H</given-names></name><name><surname>Watanabe</surname> <given-names>S</given-names></name><name><surname>Inoue</surname> <given-names>M</given-names></name><name><surname>Kudo</surname> <given-names>Y</given-names></name><name><surname>Miyakawa</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Low-threshold potassium channels and a low-threshold calcium channel regulate Ca2+ spike firing in the dendrites of cerebellar Purkinje neurons: a modeling study</article-title><source>Brain Research</source><volume>891</volume><fpage>106</fpage><lpage>115</lpage><pub-id pub-id-type="doi">10.1016/S0006-8993(00)03206-6</pub-id><pub-id pub-id-type="pmid">11164813</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Naud</surname> <given-names>R</given-names></name><name><surname>Bathellier</surname> <given-names>B</given-names></name><name><surname>Gerstner</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Spike-timing prediction in cortical neurons with active dendrites</article-title><source>Frontiers in Computational Neuroscience</source><volume>8</volume><elocation-id>90</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2014.00090</pub-id><pub-id pub-id-type="pmid">25165443</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>PÃ©rez-Garci</surname> <given-names>E</given-names></name><name><surname>Larkum</surname> <given-names>ME</given-names></name><name><surname>Nevian</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Inhibition of dendritic Ca<sup>2+</sup> spikes by GABAB receptors in cortical pyramidal neurons is mediated by a direct Gi/o-Î²-subunit interaction with Cav1 channels</article-title><source>The Journal of Physiology</source><volume>591</volume><fpage>1599</fpage><lpage>1612</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.2012.245464</pub-id><pub-id pub-id-type="pmid">23184512</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pinsky</surname> <given-names>PF</given-names></name><name><surname>Rinzel</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Intrinsic and network rhythmogenesis in a reduced traub model for CA3 neurons</article-title><source>Journal of Computational Neuroscience</source><volume>1</volume><fpage>39</fpage><lpage>60</lpage><pub-id pub-id-type="doi">10.1007/BF00962717</pub-id><pub-id pub-id-type="pmid">8792224</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Podlaski</surname> <given-names>WF</given-names></name><name><surname>Seeholzer</surname> <given-names>A</given-names></name><name><surname>Groschner</surname> <given-names>LN</given-names></name><name><surname>MiesenbÃ¶ck</surname> <given-names>G</given-names></name><name><surname>Ranjan</surname> <given-names>R</given-names></name><name><surname>Vogels</surname> <given-names>TP</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Mapping the function of neuronal ion channels in model and experiment</article-title><source>eLife</source><volume>6</volume><elocation-id>e22152</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.22152</pub-id><pub-id pub-id-type="pmid">28267430</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poirazi</surname> <given-names>P</given-names></name><name><surname>Brannon</surname> <given-names>T</given-names></name><name><surname>Mel</surname> <given-names>BW</given-names></name></person-group><year iso-8601-date="2003">2003a</year><article-title>Arithmetic of subthreshold synaptic summation in a model CA1 pyramidal cell</article-title><source>Neuron</source><volume>37</volume><fpage>977</fpage><lpage>987</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(03)00148-X</pub-id><pub-id pub-id-type="pmid">12670426</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poirazi</surname> <given-names>P</given-names></name><name><surname>Brannon</surname> <given-names>T</given-names></name><name><surname>Mel</surname> <given-names>BW</given-names></name></person-group><year iso-8601-date="2003">2003b</year><article-title>Pyramidal neuron as two-layer neural network</article-title><source>Neuron</source><volume>37</volume><fpage>989</fpage><lpage>999</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(03)00149-1</pub-id><pub-id pub-id-type="pmid">12670427</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poleg-Polsky</surname> <given-names>A</given-names></name><name><surname>Ding</surname> <given-names>H</given-names></name><name><surname>Diamond</surname> <given-names>JS</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Functional compartmentalization within starburst amacrine cell dendrites in the retina</article-title><source>Cell Reports</source><volume>22</volume><fpage>2898</fpage><lpage>2908</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2018.02.064</pub-id><pub-id pub-id-type="pmid">29539419</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poleg-Polsky</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Dendritic spikes expand the range of well tolerated population noise structures</article-title><source>The Journal of Neuroscience</source><volume>39</volume><fpage>9173</fpage><lpage>9184</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0638-19.2019</pub-id><pub-id pub-id-type="pmid">31558617</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pozzorini</surname> <given-names>C</given-names></name><name><surname>Naud</surname> <given-names>R</given-names></name><name><surname>Mensi</surname> <given-names>S</given-names></name><name><surname>Gerstner</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Temporal whitening by power-law adaptation in neocortical neurons</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>942</fpage><lpage>948</lpage><pub-id pub-id-type="doi">10.1038/nn.3431</pub-id><pub-id pub-id-type="pmid">23749146</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pozzorini</surname> <given-names>C</given-names></name><name><surname>Mensi</surname> <given-names>S</given-names></name><name><surname>Hagens</surname> <given-names>O</given-names></name><name><surname>Naud</surname> <given-names>R</given-names></name><name><surname>Koch</surname> <given-names>C</given-names></name><name><surname>Gerstner</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Automated High-Throughput characterization of single neurons by means of simplified spiking models</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004275</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004275</pub-id><pub-id pub-id-type="pmid">26083597</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Press</surname> <given-names>WH</given-names></name><name><surname>Teukolsky</surname> <given-names>SA</given-names></name><name><surname>Vetterling</surname> <given-names>WT</given-names></name><name><surname>Flannery</surname> <given-names>BP</given-names></name></person-group><year iso-8601-date="2007">2007</year><source>Numerical Recipes 3rd Edition: The Art of Scientific Computing</source><publisher-name>Cambridge University Press</publisher-name></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rotter</surname> <given-names>S</given-names></name><name><surname>Diesmann</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Exact digital simulation of time-invariant linear systems with applications to neuronal modeling</article-title><source>Biological Cybernetics</source><volume>81</volume><fpage>381</fpage><lpage>402</lpage><pub-id pub-id-type="doi">10.1007/s004220050570</pub-id><pub-id pub-id-type="pmid">10592015</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schiller</surname> <given-names>J</given-names></name><name><surname>Major</surname> <given-names>G</given-names></name><name><surname>Koester</surname> <given-names>HJ</given-names></name><name><surname>Schiller</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>NMDA spikes in basal dendrites of cortical pyramidal neurons</article-title><source>Nature</source><volume>404</volume><fpage>285</fpage><lpage>289</lpage><pub-id pub-id-type="doi">10.1038/35005094</pub-id><pub-id pub-id-type="pmid">10749211</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Segev</surname> <given-names>I</given-names></name><name><surname>London</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Untangling dendrites with quantitative models</article-title><source>Science</source><volume>290</volume><fpage>744</fpage><lpage>750</lpage><pub-id pub-id-type="doi">10.1126/science.290.5492.744</pub-id><pub-id pub-id-type="pmid">11052930</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sieber</surname> <given-names>AR</given-names></name><name><surname>Min</surname> <given-names>R</given-names></name><name><surname>Nevian</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Non-Hebbian long-term potentiation of inhibitory synapses in the thalamus</article-title><source>Journal of Neuroscience</source><volume>33</volume><fpage>15675</fpage><lpage>15685</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0247-13.2013</pub-id><pub-id pub-id-type="pmid">24089475</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Strogatz</surname> <given-names>SH</given-names></name></person-group><year iso-8601-date="2000">2000</year><source>Nonlinear Dynamics and Chaos: With Applications to Physics, Biology, Chemistry and Engineering</source><publisher-name>Westview Press</publisher-name></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stuart</surname> <given-names>G</given-names></name><name><surname>Spruston</surname> <given-names>N</given-names></name><name><surname>Sakmann</surname> <given-names>B</given-names></name><name><surname>HÃ¤usser</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Action potential initiation and backpropagation in neurons of the mammalian CNS</article-title><source>Trends in Neurosciences</source><volume>20</volume><fpage>125</fpage><lpage>131</lpage><pub-id pub-id-type="doi">10.1016/S0166-2236(96)10075-8</pub-id><pub-id pub-id-type="pmid">9061867</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tobin</surname> <given-names>AE</given-names></name><name><surname>Van Hooser</surname> <given-names>SD</given-names></name><name><surname>Calabrese</surname> <given-names>RL</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Creation and reduction of a morphologically detailed model of a leech heart interneuron</article-title><source>Journal of Neurophysiology</source><volume>96</volume><fpage>2107</fpage><lpage>2120</lpage><pub-id pub-id-type="doi">10.1152/jn.00026.2006</pub-id><pub-id pub-id-type="pmid">16760352</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Torben-Nielsen</surname> <given-names>B</given-names></name><name><surname>Stiefel</surname> <given-names>KM</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Systematic mapping between dendritic function and structure</article-title><source>Network: Computation in Neural Systems</source><volume>20</volume><fpage>69</fpage><lpage>105</lpage><pub-id pub-id-type="doi">10.1080/09548980902984833</pub-id><pub-id pub-id-type="pmid">19568982</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Urbanczik</surname> <given-names>R</given-names></name><name><surname>Senn</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Learning by the dendritic prediction of somatic spiking</article-title><source>Neuron</source><volume>81</volume><fpage>521</fpage><lpage>528</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.11.030</pub-id><pub-id pub-id-type="pmid">24507189</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Geit</surname> <given-names>W</given-names></name><name><surname>Gevaert</surname> <given-names>M</given-names></name><name><surname>Chindemi</surname> <given-names>G</given-names></name><name><surname>RÃ¶ssert</surname> <given-names>C</given-names></name><name><surname>Courcol</surname> <given-names>JD</given-names></name><name><surname>Muller</surname> <given-names>EB</given-names></name><name><surname>SchÃ¼rmann</surname> <given-names>F</given-names></name><name><surname>Segev</surname> <given-names>I</given-names></name><name><surname>Markram</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>BluePyOpt: leveraging open source software and cloud infrastructure to optimise model parameters in neuroscience</article-title><source>Frontiers in Neuroinformatics</source><volume>10</volume><fpage>1</fpage><lpage>18</lpage><pub-id pub-id-type="doi">10.3389/fninf.2016.00017</pub-id><pub-id pub-id-type="pmid">27375471</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wybo</surname> <given-names>WAM</given-names></name><name><surname>Stiefel</surname> <given-names>KM</given-names></name><name><surname>Torben-Nielsen</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The green's function formalism as a bridge between single- and multi-compartmental modeling</article-title><source>Biological Cybernetics</source><volume>107</volume><fpage>685</fpage><lpage>694</lpage><pub-id pub-id-type="doi">10.1007/s00422-013-0568-0</pub-id><pub-id pub-id-type="pmid">24037222</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wybo</surname> <given-names>WAM</given-names></name><name><surname>Boccalini</surname> <given-names>D</given-names></name><name><surname>Torben-Nielsen</surname> <given-names>B</given-names></name><name><surname>Gewaltig</surname> <given-names>MO</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A sparse reformulation of the green's Function Formalism Allows Efficient Simulations of Morphological Neuron Models</article-title><source>Neural Computation</source><volume>27</volume><fpage>2587</fpage><lpage>2622</lpage><pub-id pub-id-type="doi">10.1162/NECO_a_00788</pub-id><pub-id pub-id-type="pmid">26496043</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wybo</surname> <given-names>WAM</given-names></name><name><surname>Torben-Nielsen</surname> <given-names>B</given-names></name><name><surname>Nevian</surname> <given-names>T</given-names></name><name><surname>Gewaltig</surname> <given-names>MO</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Electrical compartmentalization in neurons</article-title><source>Cell Reports</source><volume>26</volume><fpage>1759</fpage><lpage>1773</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2019.01.074</pub-id><pub-id pub-id-type="pmid">30759388</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.60936.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>O'Leary</surname><given-names>Timothy</given-names></name><role>Reviewing Editor</role><aff><institution>University of Cambridge</institution><country>United Kingdom</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Robinson</surname><given-names>Hugh PC</given-names></name><role>Reviewer</role><aff><institution>University of Cambridge</institution><country>United Kingdom</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Nolan</surname><given-names>Matthew F</given-names></name><role>Reviewer</role><aff><institution>University of Edinburgh</institution><country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>A general principle in systems theory is that a complicated model often reduces to a much simpler one â a fact exploited by Rall in his classic work on reduction of passive dendritic trees. However, obtaining simplified models of nonlinear dendritic integration of distributed synaptic input has remained challenging. Wybo and colleagues develop methods to achieve such a reduction systematically, offering an approach that reduces the complexity of simulations while providing insight into the factors that allow lumping of dendritic compartments into a smaller equivalent system.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Data-driven reduction of dendritic morphologies with preserved dendro-somatic responses&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by two peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Ronald Calabrese as the Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Hugh PC Robinson (Reviewer #1); Matthew F Nolan (Reviewer #2).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>We would like to draw your attention to changes in our revision policy that we have made in response to COVID-19 (https://elifesciences.org/articles/57162). Specifically, we are asking editors to accept without delay manuscripts, like yours, that they judge can stand as <italic>eLife</italic> papers without additional data, even if they feel that they would make the manuscript stronger. Thus the revisions requested below only address clarity and presentation.</p><p>This manuscript proposes a plausible and promising tool for reducing model complexity of morphological conductance-based models, illustrated in a variety of situations including complex simulations and experimental data fitting. This methodology will likely be useful to a variety of neurophysiologists and theorists and can permit more efficient simulation while shedding light on the core parameters that matter in neural computation at the single cell level.</p><p>Reviewers agreed that the writing needs to be clearer throughout. Terms need to be defined. Implicit references to other work or to concepts need to be replaced with explicit, declarative sentences and explanations. On the technical side the paper also needs a fuller explanation of how fitting of voltage-gated conductances is performed. Finally, a fuller discussion and illustration of the limitations would be appropriate, e.g. explicitly showing cases where further reductions cannot be achieved without fundamentally changing the system. These necessarily exist in a nonlinear system so this is not a shortcoming of the method, rather an important point that some readers may not appreciate.</p><p>Full reviewer comments are included below for information.</p><p><italic>Reviewer #1:</italic></p><p>This study addresses an important issue in computational neuroscience: how to reduce highly-detailed biophysical models which reproduce the full morphological complexity of neurons to models which have a degree of complexity permitting them to be understood conceptually, and simulated much more efficiently, while preserving the accuracy of the original model as far as possible, and in a well-defined way. While there is a large literature on this problem for passive neurons, it is really necessary to address this problem for active/nonlinear membranes, given what we now know about voltage-dependent ion channels in dendrites. This is a problem of fitting the reduced model parameters to the output of the highly-detailed model, and the authors take a systematic and theoretically-satisfying approach to it, by matching the impedance matrices including the phenomenological impedance of voltage-gated channels which describes the reduced model to the output of the detailed model recorded at a small number of locations. This was demonstrated for neuronal models of several key active dendritic mechanisms: back-propagating sodium spikes, calcium and NMDA spikes. The authors also provide a toolbox to facilitate this process.</p><p>I have no major concerns: I found that the approach was described and illustrated very carefully and clearly, and the method's accuracy and utility were demonstrated convincingly. The motivation was well established and the writing accurate and transparent.</p><p><italic>Reviewer #2:</italic></p><p>The study introduces algorithms and software that aims to generate accurate reduced compartmental models of neurons. The approach appears elegant and is well validated by exemplar applications. I think it will be of interest to many neuroscientists. For the network modeler, the software provides a practical solution to the tradeoff involved in choosing neuronal models that are accurate and those that are computationally efficient. At a conceptual level the approach may be useful in addressing questions about which details of a neuron's morphology are critical for the computations that it contributes to. A caveat of my review is that I haven't had time to carefully check any of the math â it looks about right and the validation is generally good.</p><p>(1) The initial part of the Results section is important for understanding how the software works but is hard to follow. I think more care needs to be taken with defining terms clearly and explaining the logic of the approach in an accessible way.</p><p>(2) How the approach deals with voltage-gated ion channels could be made much clearer. E.g. in the subsection âA systematic simplification of complex neuron morphologiesâ, the text states that G<sub>Vh,chan</sub> depends on the unknown maximal ion channel conductance parameters. How? Why maximal? Voltage-gated channels cannot be maximally activated at all of the voltages tested. I don't understand how to get from here to channel conductances. It could be helpful to make a figure illustrating how fits are obtained for exemplar voltage-gated conductances.</p><p>(3) The section 'Conditions under which afferent spatial connectivity motifs can be simplified' could also be written more clearly. Concerns are similar to in point 1 above.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.60936.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>[â¦] Reviewers agreed that the writing needs to be clearer throughout. Terms need to be defined. Implicit references to other work or to concepts need to be replaced with explicit, declarative sentences and explanations. On the technical side the paper also needs a fuller explanation of how fitting of voltage-gated conductances is performed. Finally, a fuller discussion and illustration of the limitations would be appropriate, e.g. explicitly showing cases where further reductions cannot be achieved without fundamentally changing the system. These necessarily exist in a nonlinear system so this is not a shortcoming of the method, rather an important point that some readers may not appreciate.</p></disp-quote><p>We have rewritten the sections that were highlighted by the reviewers, in order to explain the unclarities. We have now clearly defined the quantities that we use. We have also explained more elaborately how the voltage-gated channels are fitted. To aid with this, we have added a further panel to Figure 1âfigure supplement 1. Finally, we have added a paragraph to the Discussion, where we explain possible lines of inquiry if a reduction does not reproduce dynamics of the full model that need to be retained. To illustrate these lines of inquiry, we have added a new supplementary figure (Figure 3âfigure supplement 1) where we perform a similar simulation as in Figure 3J, K, but where we left out compartments in the apical trunk. This reduction is too strong and the generation of a spike-burst cannot be mimicked by the reduced model.</p><disp-quote content-type="editor-comment"><p>Full reviewer comments are included below for information.</p><p>Reviewer #2:</p><p>[â¦] (1) The initial part of the Results section is important for understanding how the software works but is hard to follow. I think more care needs to be taken with defining terms clearly and explaining the logic of the approach in an accessible way.</p></disp-quote><p>We have added substantial clarifications to this section.</p><disp-quote content-type="editor-comment"><p>(2) How the approach deals with voltage-gated ion channels could be made much clearer. E.g. In the subsection âA systematic simplification of complex neuron morphologiesâ, the text states that G<sub>Vh,chan</sub> depends on the unknown maximal ion channel conductance parameters. How? Why maximal? Voltage-gated channels cannot be maximally activated at all of the voltages tested. I don't understand how to get from here to channel conductances. It could be helpful to make a figure illustrating how fits are obtained for exemplar voltage-gated conductances.</p></disp-quote><p>We have explicitly described the elements of the matrix G<sub>vh</sub> in the manuscript, so that the parameters that are fitted are now clear. In the Materials and methods â âQuasi-active channelsâ subsection, we show how the linearized channel currents that go in the matrix G<sub>vh</sub> are obtained. It can be seen that they are the product of a âmaximal conductance parameterâ with a factor that follows from the linearization, and that determines the fraction of that maximal conductance that is open at a given vh. This factor thus changes with vh. Fitting our model simultaneously at a representative set of vh values allows the fit to find a best estimate for the maximal conductance parameter. An additional panel to Figure 1âfigure supplement 1 now illustrates how the impedance matrix of the full model, and the inverse of the conductance matrix for the reduced model, changes under different vh. We have furthermore added a subsection to the Materials and methods, titled âThe conductance matrixâ, where we explicitly describe how Equation 3 in the main text is obtained. We believe that with our added explanations, it is now clear what the matrix G<sub>vh</sub> is and how the maximal conductance parameter is fitted.</p><disp-quote content-type="editor-comment"><p>(3) The section 'Conditions under which afferent spatial connectivity motifs can be simplified' could also be written more clearly. Concerns are similar to in point 1 above.</p></disp-quote><p>We have added additional explanations to this section, more accurately describing things that may have been unclear. We now more explicitly motivate this section, by stating that up until this section we only considered reductions where the synaptic inputs (or electrode current inputs) were located at the compartment sites. Here, we investigate what happens if this is not the case. We also changed the terminology from âimpedancesâ to âresistancesâ. We furthermore explicitly describe why Î²<sub>curr</sub> is close to one (because the transfer impedance z<sub>cs</sub> is close to the input impedance z<sub>cc</sub> if the compartment site c is located more proximal than the synaptic input site s), with help of an additional panel to Figure 1âfigure supplement 1. Finally, we have substantially extended the second-to-last paragraph of this section, and were able to describe the precise nature and motivation of our simulation experiments (Figure 4G-J) more clearly.</p></body></sub-article></article>