<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">76162</article-id><article-id pub-id-type="doi">10.7554/eLife.76162</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Ecology</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>Host-parasite coevolution promotes innovation through deformations in fitness landscapes</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-263210"><name><surname>Gupta</surname><given-names>Animesh</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4374-335X</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-209797"><name><surname>Zaman</surname><given-names>Luis</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-266408"><name><surname>Strobel</surname><given-names>Hannah M</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-266410"><name><surname>Gallie</surname><given-names>Jenna</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2918-0925</contrib-id><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-266407"><name><surname>Burmeister</surname><given-names>Alita R</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-6441"><name><surname>Kerr</surname><given-names>Benjamin</given-names></name><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-266409"><name><surname>Tamar</surname><given-names>Einat S</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8693-7176</contrib-id><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-262691"><name><surname>Kishony</surname><given-names>Roy</given-names></name><email>rkishony@tx.technion.ac.il</email><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-159503"><name><surname>Meyer</surname><given-names>Justin R</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5566-8452</contrib-id><email>jrmeyer@ucsd.edu</email><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03aw5sn18</institution-id><institution>Department of Physics, University of California San Diego</institution></institution-wrap><addr-line><named-content content-type="city">La Jolla</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05hs6h993</institution-id><institution>Department of Ecology and Evolutionary Biology, University of Michigan</institution></institution-wrap><addr-line><named-content content-type="city">Ann Arbor</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03aw5sn18</institution-id><institution>Department of Ecology, Behavior and Evolution, University of California San Diego</institution></institution-wrap><addr-line><named-content content-type="city">La Jolla</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0534re684</institution-id><institution>Department of Evolutionary Theory, Max Planck Institute for Evolutionary Biology</institution></institution-wrap><addr-line><named-content content-type="city">Plön</named-content></addr-line><country>Germany</country></aff><aff id="aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03v76x132</institution-id><institution>Department of Ecology and Evolutionary Biology, Yale University</institution></institution-wrap><addr-line><named-content content-type="city">New Haven</named-content></addr-line><country>United States</country></aff><aff id="aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00cvxb145</institution-id><institution>Department of Biology, University of Washington</institution></institution-wrap><addr-line><named-content content-type="city">Seattle</named-content></addr-line><country>United States</country></aff><aff id="aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03qryx823</institution-id><institution>Department of Biology, Technion – Israel Institute of Technology</institution></institution-wrap><addr-line><named-content content-type="city">Haifa</named-content></addr-line><country>Israel</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Ogbunugafor</surname><given-names>C Brandon</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03v76x132</institution-id><institution>Yale University</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02feahw73</institution-id><institution>CNRS LPENS</institution></institution-wrap><country>France</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>06</day><month>07</month><year>2022</year></pub-date><pub-date pub-type="collection"><year>2022</year></pub-date><volume>11</volume><elocation-id>e76162</elocation-id><history><date date-type="received" iso-8601-date="2021-12-06"><day>06</day><month>12</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2022-06-20"><day>20</day><month>06</month><year>2022</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at bioRxiv.</event-desc><date date-type="preprint" iso-8601-date="2021-06-27"><day>27</day><month>06</month><year>2021</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2021.06.25.449783"/></event></pub-history><permissions><copyright-statement>© 2022, Gupta et al</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>Gupta et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-76162-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-76162-figures-v1.pdf"/><abstract><p>During the struggle for survival, populations occasionally evolve new functions that give them access to untapped ecological opportunities. Theory suggests that coevolution between species can promote the evolution of such innovations by deforming fitness landscapes in ways that open new adaptive pathways. We directly tested this idea by using high-throughput gene editing-phenotyping technology (MAGE-Seq) to measure the fitness landscape of a virus, bacteriophage λ, as it coevolved with its host, the bacterium <italic>Escherichia coli</italic>. An analysis of the empirical fitness landscape revealed mutation-by-mutation-by-host-genotype interactions that demonstrate coevolution modified the contours of λ’s landscape. Computer simulations of λ’s evolution on a static versus shifting fitness landscape showed that the changes in contours increased λ’s chances of evolving the ability to use a new host receptor. By coupling sequencing and pairwise competition experiments, we demonstrated that the first mutation λ evolved en route to the innovation would only evolve in the presence of the ancestral host, whereas later steps in λ’s evolution required the shift to a resistant host. When time-shift replays of the coevolution experiment were run where host evolution was artificially accelerated, λ did not innovate to use the new receptor. This study provides direct evidence for the role of coevolution in driving evolutionary novelty and provides a quantitative framework for predicting evolution in coevolving ecological communities.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>fitness landscapes</kwd><kwd>coevolution</kwd><kwd>bacteriophage</kwd><kwd>lambda</kwd><kwd>arms race</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>E. coli</italic></kwd><kwd>Viruses</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>1934515</award-id><principal-award-recipient><name><surname>Meyer</surname><given-names>Justin R</given-names></name><name><surname>Gupta</surname><given-names>Animesh</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000913</institution-id><institution>McDonnell Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Meyer</surname><given-names>Justin R</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution>Max Planck Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Gallie</surname><given-names>Jenna</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>An interdisciplinary approach combining high throughput genotype-to-phenotype mapping, population genetic simulations, and experimental evolution provides an answer to the question of how populations evolve new functions by providing tests of the role antagonistic coevolution plays in pressuring populations to innovate.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>A starting point for understanding how populations evolve is to assume that they exist in an unchanging world where they can adapt toward optimality (<xref ref-type="bibr" rid="bib40">Orr, 2005</xref>; <xref ref-type="bibr" rid="bib44">Pigliucci and Müller, 2010</xref>). However, even in static environments, populations never reach optimality because their circumstances continuously change as neighboring species coevolve with them (<xref ref-type="bibr" rid="bib54">Valen, 1973</xref>). This more dynamic view of the evolutionary process opens the potential for unbounded evolution and creates new opportunities for evolutionary innovation (<xref ref-type="bibr" rid="bib15">Doebeli, 2011</xref>; <xref ref-type="bibr" rid="bib52">Thompson, 2005</xref>; <xref ref-type="bibr" rid="bib38">Nahum et al., 2017</xref>; <xref ref-type="bibr" rid="bib51">Thompson and Cunningham, 2002</xref>; <xref ref-type="bibr" rid="bib58">Zaman et al., 2014</xref>). Darwin recognized this potential in the final pages of On the Origin of Species, where he wrote that, ‘It is interesting to contemplate an entangled bank’ of organisms evolving with one another to produce such a variety of forms and functions (<xref ref-type="bibr" rid="bib11">Darwin, 1859</xref>). But he also realized the empirical challenges created by the richness of species interactions within ecological communities in his further description of ‘these elaborately constructed forms, … dependent on each other in so complex a manner…’ (<xref ref-type="bibr" rid="bib11">Darwin, 1859</xref>). The complexity arises because an organism’s fitness is a function of its interactions with other species, and the strength and form of these interactions can continuously change as they coevolve. Furthermore, the coevolving traits of organisms are encoded within genomes by mutations that might interact with one another, a pervasive phenomenon called epistasis (<xref ref-type="bibr" rid="bib56">Weinreich et al., 2006</xref>). This means that interactions at all levels must be considered; from mutation-by-mutation within a species (classical epistasis), to mutation-by-mutation between species (interspecific epistasis), and higher order phenomena such as the combination of classic and interspecific epistasis, where the within genome mutation-by-mutation interactions depend on the genotype of an interacting species.</p><p>Many advances have been made over recent decades that enable us to tackle this combinatorial problem. Efficient genetic engineering methods permit the construction of genetic libraries with combinatorial sets of mutations that can be used to measure epistasis (<xref ref-type="bibr" rid="bib28">Kosuri and Church, 2014</xref>; <xref ref-type="bibr" rid="bib19">Fowler and Fields, 2014</xref>). Also available are convenient approaches to measure Darwinian fitness of the mutant libraries (<xref ref-type="bibr" rid="bib56">Weinreich et al., 2006</xref>; <xref ref-type="bibr" rid="bib41">Palmer et al., 2015</xref>; <xref ref-type="bibr" rid="bib27">Khan et al., 2011</xref>; <xref ref-type="bibr" rid="bib10">Chou et al., 2011</xref>). Coupling these two technologies allows the creation of extensive genotype-to-fitness maps, or fitness landscapes (<xref ref-type="bibr" rid="bib57">Wright, 1932</xref>), that provide information important for predicting adaption (<xref ref-type="bibr" rid="bib13">de Visser and Krug, 2014</xref>; <xref ref-type="bibr" rid="bib14">de Visser et al., 2018</xref>; <xref ref-type="bibr" rid="bib30">Lee et al., 2018</xref>). However, these maps alone are often not sufficient to predict evolution because their topographies can depend on abiotic environmental conditions (<xref ref-type="bibr" rid="bib39">Ogbunugafor et al., 2016</xref>; <xref ref-type="bibr" rid="bib31">Lindsey et al., 2013</xref>; <xref ref-type="bibr" rid="bib50">Steinberg and Ostermeier, 2016</xref>; <xref ref-type="bibr" rid="bib18">Flynn et al., 2013</xref>) and biotic interactions (<xref ref-type="bibr" rid="bib8">Cervera et al., 2016</xref>; <xref ref-type="bibr" rid="bib20">Fragata et al., 2019</xref>). Here, we take two significant steps forward in fitness landscape research. First, we build on the observation that landscape structures depend on species interactions by studying the interdependence of two species’ landscapes and how they shift during coevolution. Second, we test whether these shifts facilitate the evolution of a key innovation, where the species evolves a new function that unlocks new ecological opportunities.</p><p>As a model system of coevolution, we studied the host-parasite interaction between bacteriophage λ and its host, <italic>Escherichia coli</italic>, because of the extensive background research completed on their coevolution and the availability of well-developed molecular tools (<xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>; <xref ref-type="bibr" rid="bib33">Maddamsetti et al., 2018</xref>). When λ and <italic>E. coli</italic> are cocultured in the laboratory, one quarter of the λ populations evolve to use a new receptor (<xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>). λ’s native receptor is <italic>E. coli’s</italic> outer-membrane protein LamB, but through mutations in its host-recognition gene <italic>J</italic>, λ evolves to use a second receptor protein, OmpF. While only four mutations are necessary for OmpF<sup>+</sup> function (<xref ref-type="bibr" rid="bib33">Maddamsetti et al., 2018</xref>), more <italic>J</italic> mutations typically evolve along the way (<xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>). λ gains this new function after <italic>E. coli</italic> evolves resistance through <italic>malT</italic> mutations (<xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>) that cause reduced LamB expression (<xref ref-type="bibr" rid="bib6">Boos and Böhm, 2000</xref>). Thus, it was hypothesized that the evolution of resistance in <italic>E. coli</italic> deformed λ’s fitness landscape in ways that promoted λ’s innovation (<xref ref-type="bibr" rid="bib53">Thompson, 2012</xref>). In line with this, it was previously shown that four out of six λ genotypes randomly chosen on the path to evolve OmpF<sup>+</sup> had higher relative fitness when cultured with resistant <italic>malT<sup>–</sup></italic> cells rather than ancestral cells (<xref ref-type="bibr" rid="bib7">Burmeister et al., 2016</xref>), suggesting that the host’s coevolution would promote key steps in λ’s evolution. However, one out of six genotypes had higher fitness in the presence of the ancestral host, and the last λ’s fitness was neutral to the host’s genotype. Given the conflicting pattern and small sample size, it could not be concluded whether coevolution was responsible for the innovation. Here, we build on this study with high-throughput technologies capable of measuring the fitness of hundreds of λ genotypes. The technology also produces combinatorial-mutation libraries of λ genotypes that can be used to quantify epistasis. This allows us to establish the contours of λ’s adaptive landscape rather than simply studying isolated genotypes within the space. Given the efficiency of this method, we can now measure λ’s landscape repeatedly in different host contexts in order to test whether host-induced deformations that naturally arise during coevolution promote OmpF<sup>+</sup> evolution. Although it has been shown that antagonistic coevolution can hasten molecular evolution of phages (<xref ref-type="bibr" rid="bib42">Paterson et al., 2010</xref>) and lead them to broader host ranges (<xref ref-type="bibr" rid="bib24">Hall et al., 2011</xref>), coevolution’s role in unlocking unexplored regions of the fitness landscape has not been directly tested.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>λ’s fitness landscape at different stages of coevolution</title><p>To construct λ’s fitness landscape, we focused on 10 <italic>J</italic> mutations that were a subset of mutations λ repeatedly evolved on its path to use OmpF (<xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>; <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1a</xref>). Together, they form a 10-dimensional genotype space with a total of 1024 (2<sup>10</sup>) unique variants of different combinations of the mutations including, the wild type (WT) allele configuration. Using Multiplexed Automated Genome Engineering (MAGE) (<xref ref-type="bibr" rid="bib55">Wang et al., 2009</xref>), a technique that uses repeated cycles of homologous recombination in the λ-red system to produce combinatorial genomic diversity, we were successful at engineering a library of 671 genotypes out of the possible 1024 (see Materials and methods). To measure the fitness of each genotype in this library, we competed the full library en masse and monitored their frequency changes using next-generation sequencing (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>; <xref ref-type="bibr" rid="bib26">Kelsic et al., 2016</xref>; <xref ref-type="bibr" rid="bib46">Russ et al., 2020</xref>). The fitness of each genotype was then calculated by comparing its change in frequency relative to the non-engineered ancestor. Fitness was measured in four replicate competitions for both the ancestral host and <italic>malT</italic><sup>–</sup> host (see Materials and methods). To reduce the effect of sequencing errors and to overcome other methodological pitfalls, we modified the MAGE protocol by introducing neutral <italic>watermark</italic> mutations in the library construction and developed a high-throughput competition assay that yielded reproducible results (see Materials and methods, <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>, Appendix 1). Overall, we were able to measure the fitness of 580 λ genotypes cocultured with ancestral <italic>E. coli</italic> and 131 genotypes with <italic>malT</italic><sup>–</sup> (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>). The reduced number of genotypes compared to the initial library was due to a combination of factors. The randomness of the MAGE editing process caused some genotypes to be rarely constructed and to have low frequencies in the initial library. If these genotypes did not possess disproportionately high fitness, then their frequency would fall below the limit of detection during the competition, removing them from the analysis. This effect was more pronounced in the <italic>malT</italic><sup>–</sup> landscape, where fitness differences were even more extreme.</p><p>Visual inspection of the two fitness landscapes reveals host-dependent structures; the landscape with the ancestral host has a standard diminishing-returns pattern (<xref ref-type="bibr" rid="bib27">Khan et al., 2011</xref>; <xref ref-type="bibr" rid="bib10">Chou et al., 2011</xref>; <xref ref-type="bibr" rid="bib29">Kryazhimskiy et al., 2014</xref>; <xref ref-type="bibr" rid="bib32">MacLean et al., 2010</xref>; <xref ref-type="bibr" rid="bib22">Guerrero et al., 2019</xref>), while the landscape with the <italic>malT<sup>—</sup></italic> host has an atypical sigmoidal shape that plateaus at a higher fitness than the first (<xref ref-type="fig" rid="fig1">Figure 1a and b</xref>). The non-linear relationship between mutation number and fitness suggests the presence of epistasis (mutation-by-mutation interactions), the differences in the magnitude of fitness effects between landscapes suggests mutation-by-host interactions, and different shapes suggest host-dependent epistasis (mutation-by-mutation-by-host interactions). To determine how much variation in fitness is explained by these interactions, we performed multiple linear regression analyses (see Materials and methods). We found pervasive epistasis in both landscapes (<xref ref-type="fig" rid="fig1">Figure 1c</xref>). For the ancestral landscape, 58.66% of the variation was explained by the direct effects of mutations and 24.69% by pairwise interactions (<inline-formula><mml:math id="inf1"><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.8172</mml:mn></mml:math></inline-formula>, <italic>F</italic><sub>55,439</sub> = 39.97, p&lt;0.0001). Similarly, 48.35% of the variance in the <italic>malT<sup>—</sup></italic> landscape was explained by the direct mutation effects and 27.61% by the interaction terms (<inline-formula><mml:math id="inf2"><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.7072</mml:mn><mml:mo>,</mml:mo></mml:math></inline-formula> <italic>F</italic><sub>55,252</sub> = 14.48, p&lt;0.0001). To test for mutation-by-mutation-by-host interactions, we regressed another linear model that includes host as a predictor variable. In this model, we found significant mutation-by-host interactions (<xref ref-type="fig" rid="fig1">Figure 1d</xref>), and sizeable effects of the host-dependent epistasis (21 mutation-by-mutation-by-host interaction terms were significant out of 45 and 12.62% of the total variance in the data were attributable to these terms, <xref ref-type="fig" rid="fig1">Figure 1d</xref>). This three-way interaction term measures the extent to which the landscape structure is transformed by host evolution and suggests that λ’s evolutionary trajectory could depend on its host’s genotype.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Empirical fitness landscapes of λ when infecting the (<bold>a</bold>) ancestral host and (<bold>b</bold>) <italic>malT</italic><sup>–</sup> host, and their statistical analyses in (<bold>c</bold>) and (<bold>d</bold>).</title><p>Each node in (<bold>a</bold>) and (<bold>b</bold>) represents a unique genotype and two nodes are connected by edges if the corresponding genotypes are separated by one mutation. The node at zero mutations is ancestral λ. Selection rate (per 4 hr competition experiment) is the difference of Malthusian growth rates of a given genotype <italic>i</italic> to ancestral λ over 4 hr, calculated as <inline-formula><mml:math id="inf3"><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mo>⁡</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>⁄</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>-</mml:mo><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mo>⁡</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>⁄</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>, where <inline-formula><mml:math id="inf4"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denotes the density of the given genotype at time <italic>t</italic>. (<bold>c</bold>) Statistical analysis of direct and interactive effects of mutations in both the landscapes. Colored cells represent statistically significant terms determined by multiple regression analysis after correction for multiple hypothesis testing (see Materials and methods). The diagonal elements of the matrix represent single mutation effects and all the off-diagonal terms represent pairwise epistatic interactions. See <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1i</xref> for identity of mutations corresponding to different <inline-formula><mml:math id="inf5"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> . (<bold>d</bold>) Statistical test of whether the two landscapes varied in topology. The additional variable, <italic>E</italic>, represents environment (host) to indicate mutation-by-host effects in the lower-left matrix and mutation-by-mutation-by-host (G×G×E) in the upper-right matrix. Light colored cells indicate terms present in the final AIC-optimized model out of the full-factorial model (<italic>F</italic><sub>76,726</sub> = 37.45, p&lt;0.0001), and dark colored cells indicate statistically significant terms after controlling for rate of false positives (see Materials and methods).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-76162-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Schematic illustration of MAGE-Seq used to construct λ’s fitness landscapes.</title><p>(<bold>a</bold>) 24 independently evolved <italic>J</italic> alleles reported in <xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>. The white blocks indicate a location of a mutation not studied here, whereas colored blocks indicate mutations used to construct the genetic library. (<bold>b</bold>) Oligos were synthesized with focal mutations positioned in the center of the sequence. (<bold>c</bold>) MAGE was used to construct a combinatorial library of lambda lysogens integrated into <italic>E. coli</italic>’s genome. (<bold>d</bold>) Lysogens were induced in order to generate a library of λ particles with different combinations of mutations. (<bold>e</bold>) The λ library was first mixed with the ancestor in 1:9 ratio, incubated with different types of hosts for 4 hr at 37°C, and then sequenced at both initial and final timepoints to calculate the selection rates of individual genotypes.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-76162-fig1-figsupp1-v1.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>Test to determine whether amplification distorts measurements of fitness.</title><p>For every replicate population in the competition (total eight, four for each host) we performed two separate amplifications and used a unique barcode for each. This allowed us to compare fitness calculations based on independent amplifications and to determine if the amplification step is repeatable and unbiased. Each point represents a unique λ genotype presented in the fitness landscapes reported in <xref ref-type="fig" rid="fig1">Figure 1</xref>. The red line is a linear least-square fit. The regression fitting parameter and coefficient of determination are provided in the inset. The black line represents the vector, where fitness estimates from each barcode are equal.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-76162-fig1-figsupp2-v1.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 3.</label><caption><title>Distribution of λ genotypes present with respect to the number of mutations they possess.</title><p>(<bold>a</bold>) An ideal fitness landscape where all combinations of 10 mutations are present. (<bold>b and c</bold>) Empirical fitness landscapes with ancestral host and <italic>malT<sup>—</sup></italic> host, respectively.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-76162-fig1-figsupp3-v1.tif"/></fig><fig id="fig1s4" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 4.</label><caption><title>Test of whether the error in our estimates of selection rates (per 4 hr) is influenced by the magnitude of the estimate.</title><p>SD does not correlate with mean fitness of a genotypes for both (<bold>a</bold>) ancestor host, and (<bold>b</bold>) <italic>malT<sup>—</sup></italic> host; p-values in the insets indicate that the slope is not significantly different than zero. Uniform variance in fitness values permit the performance of analysis of variance to detect genotype by genotype by host interactions. Points with zero SD indicate presence of only one replicate population with a fitness value for that genotype.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-76162-fig1-figsupp4-v1.tif"/></fig></fig-group></sec><sec id="s2-2"><title>The role of shifting landscapes in promoting λ’s innovation</title><p>To test whether changes in the structure of λ’s landscape opened trajectories to OmpF exploitation, we simulated λ’s evolution on the landscapes using a modified Wright-Fisher model (see Materials and methods, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). Before running the simulations, we imputed the missing λ genotypes’ fitness values to complete the landscapes. We did this by successively choosing missing genotypes at random and assigning them the average fitness of their nearest neighbors. The simulations were run based on conservative estimates of the number of generations and population sizes from previously published (<xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>) and this study’s coevolution experiments (960 generations; ~6.3×10<sup>9</sup> λ particles, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>; <xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>) and λ’s intrinsic mutation rate (7.7×10<sup>–8</sup> base<sup>–1</sup> replication<sup>–1</sup>) (<xref ref-type="bibr" rid="bib16">Drake, 1991</xref>). We predicted that λ would be more likely to evolve OmpF function (three specific mutations plus one additional <xref ref-type="bibr" rid="bib33">Maddamsetti et al., 2018</xref>) in simulations that accounted for coevolution by shifting the population from one landscape to the next. We ran trials where λ evolved on only one landscape at a time to establish a baseline for the frequency of OmpF<sup>+</sup> evolution without coevolution. Next, we ran nine shifting landscape scenarios where we varied how many generations λ evolved on the ancestral host landscape before switching to the <italic>malT</italic><sup>–</sup> landscape. As anticipated, the switching protocol increased the frequency of OmpF<sup>+</sup> evolution in all nine treatments above the single host simulations, but only seven out of nine treatments were found to be significantly higher (<xref ref-type="fig" rid="fig2">Figure 2</xref>; ANOVA: F-ratio=6.14, <italic>d.f.=</italic>99, p&lt;0.0001, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1b</xref>). This result was robust to changes in population size and total number of generations, and when controlling for both, different number of genotypes measured in the two landscapes, and noise created by imputing missing data points (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>, Appendix 2).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Simulation results of the frequency of OmpF-use evolution observed when fitness landscapes were shifted at different frequencies.</title><p>Each bar represents an average of 300 simulation runs. Error bars indicate 95% confidence intervals. OmpF evolution is favored when λ evolves on shifting landscapes. The only two shifting landscape treatments that are not significantly higher than simulations on the constant <italic>malT<sup>—</sup></italic> landscape are the 0.2 and 0.4 treatments (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1b</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-76162-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Schematic outline of the simulations used to evolve λ on the fitness landscapes.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-76162-fig2-figsupp1-v1.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Additional simulations to verify that shifting landscapes promote OmpF<sup>+</sup> evolution.</title><p>Frequency of OmpF<sup>+</sup> evolution when λ population is evolved on different landscapes with different controls as compared with <xref ref-type="fig" rid="fig2">Figure 2</xref> — (<bold>a</bold>) half the total number of generations, (<bold>b</bold>) twice the total number of generations, (<bold>c</bold>) with one-tenth of the population size, and (<bold>d</bold>) starting with only the genotypes whose fitness values were measured for both the landscapes. For all switching landscape treatments except two (switching fraction-time of 0.9 in (<bold>a</bold>), and 0.1 in (<bold>d</bold>)), the frequency of OmpF<sup>+</sup> evolution was significantly higher (adjusted p-value&lt;0.05) than the constant landscape treatments (ANOVA: F-ratio=6.62, <inline-formula><mml:math id="inf6"><mml:mi>d</mml:mi><mml:mo>.</mml:mo><mml:mi>f</mml:mi><mml:mo>.</mml:mo><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mn>99</mml:mn></mml:math></inline-formula>, p&lt;0.0001 for (<bold>a</bold>), F-ratio=8.22, <inline-formula><mml:math id="inf7"><mml:mi>d</mml:mi><mml:mo>.</mml:mo><mml:mi>f</mml:mi><mml:mo>.</mml:mo><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mn>99</mml:mn></mml:math></inline-formula>, p&lt;0.0001 for (<bold>b</bold>), and F-ratio=8.12, <inline-formula><mml:math id="inf8"><mml:mi>d</mml:mi><mml:mo>.</mml:mo><mml:mi>f</mml:mi><mml:mo>.</mml:mo><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mn>99</mml:mn></mml:math></inline-formula>, p&lt;0.0001 for (<bold>c</bold>), and F-ratio=36.04, <inline-formula><mml:math id="inf9"><mml:mi>d</mml:mi><mml:mo>.</mml:mo><mml:mi>f</mml:mi><mml:mo>.</mml:mo><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mn>109</mml:mn></mml:math></inline-formula>, p&lt;0.0001 for (<bold>d</bold>)). Each bar represents an average of 300 simulation runs and error bars indicate 95% confidence interval. The frequency of OmpF<sup>+</sup> evolution in our simulations depends mainly on whether λ spends any time on the ancestral landscape before shifting to <italic>malT</italic><sup>—</sup> and there is little evidence of a relationship between the amount of time spend on each landscape and the probability of evolving OmpF<sup>+</sup>. However, we can reason that as the time spent on the ancestral landscape approaches zero, the frequency of OmpF<sup>+</sup> will drop and approach the frequency caused by the constant <italic>malT</italic><sup>—</sup> landscape. This transition must happen sometime between 0 and 10%. (<bold>e and g</bold>) show the frequency of OmpF<sup>+</sup> evolution when shifting is done between the same hosts, and (<bold>f</bold>) and (<bold>h</bold>) show difference between this switching treatment, and the varying host treatment. The bars are the averages taken across all switching times. Statistics for two-sample <italic>t</italic>-tests: (<bold>f</bold>) <inline-formula><mml:math id="inf10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>9.10</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mo>.</mml:mo><mml:mi>f</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mn>169</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.0001</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>; (<bold>h</bold>) <inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>8.54</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mo>.</mml:mo><mml:mi>f</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mn>161</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.0001</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-76162-fig2-figsupp2-v1.tif"/></fig></fig-group></sec><sec id="s2-3"><title>Reconstructing coevolution in an experimental population</title><p>The simulation results suggest that the shifting landscape encourages λ’s evolution to gain the required mutations for OmpF function. In particular, the simulations show that the first steps along the path to the innovation are more likely if λ first adapts to the ancestral bacterium, meanwhile the final steps are more likely to occur if the host coevolves resistance. To verify this result with laboratory experiments, we analyzed the path λ took to OmpF<sup>+</sup> in a single population cryopreserved from the previous coevolution study (population ‘D7’ in <xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>; Table S1). Population ‘D7’ was chosen because λ evolved relatively few mutations in this population. We believed this choice was conservative and constitutes a strong test of our hypothesis since fewer λ mutations would provide fewer opportunities to detect host-induced contingency. We sampled λ strains from different timepoints of population ‘D7’ and sequenced their <italic>J</italic> gene (<xref ref-type="fig" rid="fig3">Figure 3a</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1c</xref> and <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1d</xref>). Next, we ran pairwise competition experiments between λ genotypes at different stages of evolution on the two hosts. We found that the first mutation on the line of descent to OmpF<sup>+</sup> required ancestral <italic>E. coli</italic> to evolve, while the second mutation required <italic>malT</italic><sup>–</sup> <italic>E. coli</italic> (<xref ref-type="fig" rid="fig3">Figure 3b and c</xref>). In addition, the eventual OmpF<sup>+</sup> genotype with five <italic>J</italic> mutations only outcompeted the genotype with two mutations when provided with <italic>malT</italic><sup>–</sup> hosts (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). These findings show that the path λ took in population D7 required it to sequentially adapt to both host types and that λ’s fitness landscape changed during coevolution in a way that ultimately facilitated evolutionary innovation.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title><italic>J</italic> evolution (<bold>a</bold>) and evidence of the interdependency between λ and <italic>E. coli</italic> fitness during their coevolution (<bold>b-d</bold>).</title><p>(<bold>a</bold>) Phylogenetic reconstruction and relative abundance of λ genotypes isolated through time from a previously coevolved community (<xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>). Each letter and star indicate a non-synonymous mutation in <italic>J</italic> (see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1c</xref> for labels’ corresponding mutations). A genotype’s relative abundance on a given day is denoted by the fraction of the total height of the y-axis that it occupies (e.g. on day 9, frequency of ABC is 0.2 and A**C is 0.8; see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1d</xref>). The lineage WT-A-ABC-ABCDE eventually evolves OmpF function and fixes in the population; resistance in <italic>E. coli</italic> through <italic>malT</italic><sup>—</sup> rises to high frequencies between days 5 and 8 (<xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>). (<bold>b &amp; c</bold>) Selection rates (per 24 hr) of phage genotypes on the two hosts. Each bar represents the mean of three experimental replicates. While mutation A is favored over wildtype (WT) λ in the presence of the ancestral host and not <italic>malT</italic><sup>—</sup>, AB only outcompetes A in the presence of <italic>malT</italic><sup>—</sup> and not the ancestral host. One tailed <italic>t</italic>-tests to test if the mean selection rate is significantly greater (or less) than zero: A vs WT with ancestor host- <inline-formula><mml:math id="inf12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>98.76</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mo>.</mml:mo><mml:mi>f</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.0001</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>; A vs WT with <italic>malT<sup>—</sup></italic> - <inline-formula><mml:math id="inf13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>4.99</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mo>.</mml:mo><mml:mi>f</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.0190</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>; AB vs A with ancestor- <inline-formula><mml:math id="inf14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>3.4</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mo>.</mml:mo><mml:mi>f</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.0383</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>; AB vs A with <italic>malT<sup>—</sup></italic> - <inline-formula><mml:math id="inf15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>8.88</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mo>.</mml:mo><mml:mi>f</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.0062</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. (<bold>d</bold>) Selection rate (per 4 hr) of <italic>malT</italic><sup>–</sup> <italic>E. coli</italic> relative to its ancestor in the presence of λ from different stages of coevolution. Each competition was replicated three times. Lowercase letters denote significance via Tukey’s honest significance test, see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1g</xref> for pairwise p-values (ANOVA: F-ratio=111.22, <italic>d.f.=</italic>11, p&lt;0.0001). One tailed <italic>t</italic>-tests were also used to test if the selection rate of <italic>malT</italic><sup>—</sup> was greater than zero WT: <inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>2.44</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mo>.</mml:mo><mml:mi>f</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.676</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>; A: <inline-formula><mml:math id="inf17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>5.12</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mo>.</mml:mo><mml:mi>f</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.0181</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>; ABC: <inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>26.59</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mo>.</mml:mo><mml:mi>f</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.0007</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>; A**C: <inline-formula><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>71.67</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mo>.</mml:mo><mml:mi>f</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.0001</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. This shows that <italic>malT</italic><sup>—</sup> is unlikely to evolve in the presence of WT λ but it becomes progressively more likely as λ gains mutations. Asterisks over all the competitions indicate significance level corresponding to the p-values. Error bars in all bar graphs represent one sample SD.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-76162-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Competition assay of λ isolates from population D7.</title><p>Relative fitness of λ with two mutations (AB) to an OmpF<sup>+</sup> λ with five mutations (ABCDE) on two host genotypes. This shows that AB outcompetes ABCDE in the presence of ancestral <italic>E. coli</italic> while ABCDE is favored over AB with <italic>malT</italic><sup>—</sup> <italic>E. coli.</italic> Selection rate (per 4 hr) is the difference in Malthusian growth rates of the competitors over 1 day with a value of 0 indicating no difference in fitness. Each bar represents mean of three replicate trials and error bars indicate one sample SD. (One-tailed <italic>t</italic>-test to test if the selection rate is greater (or less) than zero— ABCDE vs AB with ancestor host: <inline-formula><mml:math id="inf20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>58.53</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mo>.</mml:mo><mml:mi>f</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.0001</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, ABCDE vs AB with <italic>malT<sup>—</sup></italic>: <inline-formula><mml:math id="inf21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>13.09</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mo>.</mml:mo><mml:mi>f</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.0029</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. Asterisks over the bar graphs indicate significance level corresponding to the p-values).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-76162-fig3-figsupp1-v1.tif"/></fig></fig-group><p>At this point, we shifted the focus of our study to testing whether <italic>E. coli</italic>’s resistance evolution was also impacted by λ’s evolution. Before reconstructing <italic>J</italic> evolution, it was believed that <italic>E. coli</italic> evolved resistance first and then <italic>J</italic> mutations evolved in response (<xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>, Figure 5). However, <italic>J</italic> evolved within a day, while <italic>malT<sup>—</sup></italic> mutations were previously shown to fix between 5 and 8 days in the population (<xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>). The timing suggests that λ improved infectivity and then applied pressure on <italic>E. coli</italic> to evolve resistance. To test whether λ evolution promoted host resistance evolution, we ran competition experiments between ancestral and <italic>malT</italic><sup>–</sup> hosts in the presence of phages isolated from four different time points. We found that <italic>malT</italic><sup>–</sup> was not significantly more fit than the ancestral <italic>E. coli</italic> in the presence of the ancestral λ, but it was more fit in the presence of the evolved λs (<xref ref-type="fig" rid="fig3">Figure 3d</xref>). This provides another example of interspecific epistasis, but this time the parasite’s genotype alters the host’s landscape. This result combined with the others suggests that there is an intricate coevolutionary feedback at play between λ and <italic>E. coli</italic>: λ evolves <italic>J</italic> mutations that better exploit <italic>E. coli</italic>, which in turn applies pressure on <italic>E. coli</italic> to evolve resistance. Once resistance evolves, new adaptive pathways become available to λ that encourage the innovation. For the computer simulations, we arbitrarily chose timepoints to switch from one host to the other; however, in reality, the dynamics of the switch are dictated by the host-parasite coevolution.</p></sec><sec id="s2-4"><title>Evolutionary replay experiments</title><p>To further test the role of coevolutionary processes at driving λ’s innovation, we ran replays of the coevolution experiment (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). We initiated 12 populations with <italic>malT</italic><sup>–</sup> host that already possessed resistance, and 12 populations with ancestral host where λ and <italic>E. coli</italic> would coevolve normally. The former treatment should hinder the evolution of OmpF function because it denies λ the opportunity to evolve first with ancestral <italic>E. coli</italic>. In line with our expectations, 0 of 12 replicates evolved OmpF use in the <italic>malT</italic><sup>–</sup> treatment, meanwhile 3 out of 12 evolved the innovation in the ancestral treatment (<xref ref-type="fig" rid="fig4">Figure 4a and b</xref>). By sequencing <italic>J</italic> alleles of the resulting λ genotypes, we found that fewer mutations evolved with <italic>malT</italic><sup>–</sup> despite evolving for the same length of time. This suggests that λ’s evolution was stymied by starting with the resistant host (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1e</xref>), and by disrupting the coevolutionary process we interfered with λ’s ability to innovate.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Evolutionary replay experiments reveal that λ’s evolution to use OmpF depends on host coevolution.</title><p>(<bold>a</bold>) Wildtype (WT) λ with ancestral host, (<bold>b</bold>) WT λ with <italic>malT</italic><sup>–</sup>, (<bold>c</bold>) λ one mutation removed from evolving OmpF function with <italic>malT</italic><sup>—</sup>, and (<bold>d</bold>) identical setup as (<bold>c</bold>), but with λ two mutations removed (see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1f</xref> for identity of mutations). (<bold>e</bold>) The bar graph provides the frequency of OmpF<sup>+</sup> evolution compared to the frequency observed by <xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>. Given λ’s established one in four rates of OmpF<sup>+</sup> with ancestral host, the probability of observing no OmpF<sup>+</sup> evolution in 12 replicate populations is ~0.03. Thus, no positives for OmpF evolution in (<bold>b</bold>) shows that λ’s evolution to OmpF function is significantly hindered, when coevolution is initiated with <italic>malT</italic><sup>—</sup> host. However, <italic>malT</italic><sup>—</sup> does not impede OmpF<sup>+</sup> evolution, when the coevolution is initiated with already evolved λs (p-values for Fisher’s exact test: between (<bold>b</bold>) and (<bold>c</bold>) p=0.0261; between (<bold>b</bold>) and (<bold>d</bold>) p=0.0122). Notably, some λ populations went extinct which is common for these experiments and was previously shown to be caused by the evolution of resistance mutations in <italic>E. coli</italic>’s ManXYZ protein complex (<xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-76162-fig4-v1.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>A schematic overview of the coevolution experiments performed in this study and by <xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>.</title><p>Coevolution is initiated by coculturing λ and <italic>E. coli</italic> in glucose media for 24 hr at 37°C. At the end of each day, 1% of the total population is transferred to fresh media to continue the coevolution and the spent media is discarded. A fraction of the community is also sampled for long-term storage at −80°C, to determine population densities and to check the status of λ’s OmpF use.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-76162-fig4-figsupp1-v1.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>Phage densities during the coevolutionary replay experiment performed in <xref ref-type="fig" rid="fig4">Figure 4</xref>.</title><p>Timeseries of phage density of 12 replicates measured at the end of each day for cultures initiated with WT λ and ancestor host or <italic>malT<sup>—</sup></italic> host (corresponding to <xref ref-type="fig" rid="fig4">Figure 4a, b</xref>). The three λ populations that evolved OmpF function in the ancestor host treatment are marked by solid lines. For the simulations, we used a populations size of 6.3 × 10<sup>9</sup> which is lower than the peak population density observed (~10<sup>10</sup>), but above the average population density (~6.3 × 10<sup>8</sup>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-76162-fig4-figsupp2-v1.tif"/></fig></fig-group><p>Lastly, we tested whether <italic>malT</italic><sup>–</sup> would still promote the evolution of OmpF use if the replay experiments were initiated with λ genotypes positioned further along the path to gaining OmpF function. We initiated two more replays: one with a λ strain that was just a single mutation away from becoming OmpF<sup>+</sup>, and another that was two mutations away (see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1f</xref> for J alleles). 16 of 24 λ populations evolved OmpF<sup>+</sup> showing that whether <italic>malT</italic><sup>–</sup> promotes OmpF<sup>+</sup> evolution depends on where the λ genotypes are located in the fitness landscape (<xref ref-type="fig" rid="fig4">Figure 4c and d</xref>).</p><p>While the goal of these experiments was to test a specific hypothesis about λ’s innovation, the results have broader implications for coevolutionary dynamics and the repeatability of evolution. We showed that if the host outpaces the parasite (<xref ref-type="fig" rid="fig4">Figure 4b</xref>; λ<sup>WT</sup> and <italic>malT<sup>–</sup> E. coli</italic>), then the parasite is unable to innovate. This is in line with a previous study showing that if the host evolves even higher levels of resistance than provided by the <italic>malT</italic> mutation, λ loses the ability to innovate (<xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>). When specific pairs of host and parasite genotypes are combined that are at complementary steps in the coevolution, then the innovation becomes possible and even highly likely (<xref ref-type="fig" rid="fig4">Figure 4a, c and d</xref>; λ<sup>WT</sup> and ancestral <italic>E. coli</italic>, λ<sup>–1</sup> and <italic>malT<sup>–</sup> E. coli</italic>, and λ<sup>–2</sup> and <italic>malT<sup>–</sup> E. coli</italic>). This suggests that the genotype of host and parasite that first encounter each other in nature, as well as the timing of their coevolution, play an important role in determining the dynamics and endpoints of their evolution.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>This study provides multiple direct tests of coevolution’s role in driving innovation, as well as revealing a more complicated model of λ and <italic>E. coli</italic> coevolution than previously published (<xref ref-type="fig" rid="fig5">Figure 5</xref>). λ was thought to evolve OmpF use as a direct response to <italic>malT</italic><sup>–</sup> resistance (<xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>); however, here we learned that key steps were missing from that model. λ is initially poor at infecting its host, so it evolves mutations in <italic>J</italic> that enhance its infectivity. The new λ genotypes apply pressure on <italic>E. coli</italic> to evolve resistance. When host-resistance increases in the community, λ’s fitness landscape is deformed in a way that promotes J evolution toward OmpF use, but only if it had already acquired some <italic>J</italic> mutations. Remarkably, the timing and coordination of each of these interdependent steps is facilitated by the reciprocity ingrained in host-parasite coevolution. Altogether, we were able to provide direct experimental evidence that fluctuating landscapes, also known as fitness seascapes (<xref ref-type="bibr" rid="bib34">Merrell, 1994</xref>), can promote evolutionary innovations.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Previous and new version of λ<italic>-E. coli</italic> coevolutionary model.</title><p>In the original model, <italic>E. coli</italic> evolves resistance by repressing λ’s receptor and then λ evolves mutations that allow it to use a new receptor. The updated model describes a more involved dynamic where λ evolves mutations that improve its ability to infect <italic>E. coli</italic>; with increased pressure to avoid infection, E. <italic>coli</italic> responds by evolving resistance, and then λ evolves the remaining mutations that leads to the ability to infect using the new receptor.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-76162-fig5-v1.tif"/></fig><p>Our studies show that the fitness of a parasite depends on complex genetic interactions within its own genome and with the genomes of interacting hosts. These interdependencies result in highly contingent evolution, where λ is unlikely to evolve an innovation unless it participates in a particular sequence of coevolutionary steps with its host. Despite the stochasticity that is expected to arise in systems with substantial historical contingency (<xref ref-type="bibr" rid="bib21">Gould, 1989</xref>; <xref ref-type="bibr" rid="bib5">Blount et al., 2018</xref>), λ’s evolution to use a new receptor is repeatable because the sequence is coordinated by coevolutionary feedback. While coevolution may yield tangled banks of interactions, we demonstrate how high-throughput technologies can be used to untangle them and to predict evolution. The ability to successfully predict evolution in any system represents a significant step forward, but it is particularly notable in conditions that incorporate species interactions. Our approach was data-intensive and relied on technologies that are not currently available for more natural and complex ecological systems; however, many efforts are underway to develop these technologies (<xref ref-type="bibr" rid="bib4">Bergelson et al., 2021</xref>). This study shows that these efforts are worthwhile because even though the resulting data may appear to be an uninterpretable morass, computational analyses can be leveraged to penetrate the information to aid learning and prediction.</p><sec id="s3-1"><title>Ideas and speculation</title><p>This work was completed during the 2020–22 SARS-CoV-2 pandemic, raising the question of whether this research provides insight into strategies to prevent future pandemics. While it is difficult to extrapolate, there are general lessons that can be applied to understanding pandemics. First, natural coevolutionary processes can repeatedly drive the evolution of viruses to achieve difficult adaptations that underly host-range expansions. On one hand, this knowledge is alarming because it suggests that pandemics may be more likely than previously anticipated, but on the other hand, the repeatability provides an opportunity to study the process and develop intervention strategies. We also learned that shifting conditions can enhance the evolutionary potential of viruses, suggesting that there could be additional unexpected consequences of human-caused environmental changes.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Bacterial and phage strains</title><p>The ancestral phage λ strain in our study is cI26; it is a strictly lytic strain that was used in the previous coevolution study on which this paper builds (<xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>). λ has two life cycles: lytic and lysogenic. In the lytic life cycle, λ infects its host, creates multiple copies of its genome, and lyses the cell to produce new viral particles. This is unlike the lysogenic life cycle of λ, where it stably integrates its genome into the host genome and is replicated along with the host (<xref ref-type="bibr" rid="bib25">Hendrix, 1983</xref>). The λ strain cI26 has a frameshift mutation in the <italic>cI</italic> gene that disrupts the regulatory protein cI required by λ to switch to a lysogenic life cycle (<xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>). This renders cI26 obligatory lytic. The other λ strain we used was cI857 (provided by Ing-Nang Wang, State University of New York, Albany) to construct our λ genomic library using MAGE (discussed in ‘Fitness landscapes’ section). The advantage of using cI857 over cI26 is that it is able to form a lysogen and as a genomic complex with <italic>E. coli</italic>’s genome, its genome can be easily edited with <italic>E. coli</italic> engineering methods. cI857 has an advantage over typical lysogenic λ because it has a mutation in the <italic>cI</italic> gene that makes the repressor protein cI unfold at high temperatures (<xref ref-type="bibr" rid="bib37">Meyer et al., 2016</xref>). This enables us to induce the lytic life cycle of cI857 from lysogens using heat shock treatments, which has fewer side effects compared to using mutagens that the typical strain requires for induction.</p><p>We used <italic>E. coli</italic> B strain REL606 for the ancestral-sensitive host and its derivative EcC4 for the evolved-resistant (<italic>malT</italic><sup>–</sup>) host to construct fitness landscapes (in <xref ref-type="fig" rid="fig1">Figure 1</xref>) and run competition assays (in <xref ref-type="fig" rid="fig3">Figure 3</xref>). REL606 was the ancestral host in the coevolution experiments performed by <xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>, and EcC4 was isolated from one of the coevolving populations that has a single mutation, a nonsense mutation (C→T) at genome location 3,482,567 in <italic>malT</italic> gene (Table S5 in <xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>). MalT is a positive regulator of <italic>lamB</italic>, so a disruption in transcription of <italic>malT</italic> inhibits LamB expression (<xref ref-type="bibr" rid="bib6">Boos and Böhm, 2000</xref>). Resistance to λ in EcC4 due to this nonsense <italic>malT</italic> mutation has been shown to yield high levels of resistance, the equivalent of a nonsense mutation in <italic>lamB</italic> (Figure S5 in <xref ref-type="bibr" rid="bib9">Chaudhry et al., 2018</xref>). We used another <italic>malT</italic><sup>—</sup> mutant of REL606, named LR01, for our coevolutionary replay experiments (<xref ref-type="fig" rid="fig4">Figure 4</xref>). This strain has a 25 bp duplication at genome location 3,482,677 causing a frameshift in <italic>malT</italic>. LR01 was also isolated from a coevolving population of λ and <italic>E. coli</italic> (Figure S3 in <xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>); however, unlike EcC4, LR01 has a high reversion rate to <italic>malT</italic><sup>+</sup> that results in ‘leaky resistance’ to λ (<xref ref-type="bibr" rid="bib9">Chaudhry et al., 2018</xref>). This allows λ populations to sustain serial dilution transfers and thus was critical for the success of the coevolutionary replay experiments (<xref ref-type="fig" rid="fig4">Figure 4</xref>). We note that while we use the term ‘resistant’ to refer to <italic>malT</italic><sup>–</sup> genotypes, this ‘resistance’ is specific to the OmpF<sup>—</sup> λ in this study; these bacterial strains are susceptible to OmpF<sup>+</sup> λ phage.</p><p>Several <italic>E. coli</italic> strains were used for culturing λ. The most often used was DH5α, a <italic>lacZα</italic><sup>–</sup> derivative of <italic>E. coli</italic> K-12, because it is permissive to all λ genotypes and it lacks <italic>lacZ</italic> which is used as a genetic marker to distinguish phage genotypes in competition assays (additional information in the ‘Phage Competition Experiments’ section). Two <italic>lamB<sup>–</sup></italic> mutants of <italic>E. coli</italic> with non-functional LamB were used interchangeably to culture OmpF<sup>+</sup> λ on LB agar. One strain was a derivative of REL606 that has a 1 bp insertion of nucleotide T between base positions 610 and 611 in <italic>lamB</italic> (<xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>; <xref ref-type="bibr" rid="bib36">Meyer et al., 2015</xref>), and the other strain was an <italic>E. coli</italic> K-12 derivative from the Keio collection (<italic>lamB<sup>–</sup></italic> JW3996) (<xref ref-type="bibr" rid="bib2">Baba et al., 2006</xref>). We found no difference in the efficiency of plaquing on the two strains.</p><p>MAGE was performed in an <italic>E. coli</italic> K12 strain, HWEC106, provided by Harris Wang, Columbia University. The strain’s <italic>mutS</italic> gene is deleted and it possesses the pKD46 plasmid with an inducible λ-red recombineering system (<xref ref-type="bibr" rid="bib12">Datsenko and Wanner, 2000</xref>). cI857 successfully integrated into this strain’s canonical ATTB site located near the <italic>galK</italic> gene (<xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>; <xref ref-type="bibr" rid="bib33">Maddamsetti et al., 2018</xref>; <xref ref-type="bibr" rid="bib43">Petrie et al., 2018</xref>).</p></sec><sec id="s4-2"><title>Media</title><p>We performed most experiments in conditions identical to the initial coevolution experiment (<xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>). For competition assays (low and high-throughput) and two of the four coevolutionary replay experiments (<xref ref-type="fig" rid="fig4">Figure 4a and b</xref>), bacteria and phage were cocultured in modified M9 Glucose (47.7 mM disodium phosphate, 22.0 mM potassium phosphate monobasic, 18.7 mM ammonium chloride, 8.6 mM sodium chloride, 0.1 mM calcium chloride, 10 mM magnesium sulfate, 5.55 mM glucose, and 0.2 mM of LB) as used in <xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>. A new medium was used for the remaining two coevolution replays (<xref ref-type="fig" rid="fig4">Figure 4c and d</xref>) that we call Tris DM Glucose: 1.6 mM potassium phosphate monobasic, 0.59 mM potassium phosphate dibasic, 0.2 mM of calcium chloride, 50 mM Tris base (pH 7.4), 10 mM of magnesium sulphate, 7.5 μM thiamine, 3.2 mM ammonium sulphate, and 5.55 mM glucose. This medium is improved over M9 Glucose because it is less prone to magnesium precipitation, and fortunately has no noticeable effect on the coevolution.</p><p>For isolation, estimating densities and initial culturing of bacteria and phage, four more media were used according to the following specifications—(a) LB (Lennox Broth): 10 g tryptone, 5 g yeast extract, and 5 g sodium chloride per liter of water, (b) LBM9: 20 g tryptone, 10 g yeast extract, 12.8 g sodium phosphate heptahydrate, 3 g potassium phosphate monobasic, 0.5 g sodium chloride, 1 g ammonium chloride, 1.2 g magnesium sulfate, 22 mg calcium chloride per liter of water, (c) LB agar: 10 g tryptone, 5 g yeast extract, 5 g sodium chloride, and 16 g agar per liter of water, (d) soft agar: 10 g tryptone, 1 g yeast extract, 8 g sodium chloride, 7 g agar, 0.1 g glucose per liter of water, supplemented with a final concentration of 2 mM calcium chloride. The soft agar was also supplemented with 10 mM magnesium sulphate to improve plaquing of phage particles.</p></sec><sec id="s4-3"><title>Isolation and culturing techniques</title><p>Most strains were grown at 37°C, except for HWEC106, which was grown at 30°C because pKD46 has a temperature-sensitive origin of replication. To ensure uniform aeration and nutrient availability, 4 ml cultures were shaken at 220 rpm and 10 ml cultures at 120 rpm; different rpm was chosen to ensure comparable aeration in cultures (10 ml cultures were grown in 50 ml Erlenmeyer flasks and 4 ml in glass tubes). We used LBM9 to grow phage cultures and LB to grow bacteria cultures, unless otherwise indicated. All bacteria and phage stocks were stored by freezing 1 ml of culture with 15% glycerol at −80°C. We revived phage from freezer stocks by growing ~2 μl of frozen stocks on 100 μl of DH5α overnight culture in 4 ml of LBM9. To harvest phage, cells were killed and separated by adding 100 μl of chloroform and centrifuging the solution at 3900 rpm for 10 min. The supernatant containing phage lysate was then stored with ~2% chloroform at 4°C. Bacteria were revived from −80°C by growing ~2 μl of the frozen stocks over night in 4 ml of LB.</p><p>Phage strains were isolated from a population by infusing phage particles into bacterial lawns of DH5α cells. We made these infused plates by mixing a small volume (between 10μl and 100 μl) of diluted phage and ~5 × 10<sup>8</sup> host cells to a 4 ml of molten soft agar at 55°C, and pouring the mixture over an LB agar plate (<xref ref-type="bibr" rid="bib47">Sambrook and Russell, 2001</xref>). The soft agar was allowed to solidify and then incubated overnight at 37°C for phage particles to form plaques. A plaque is a near-circular clearing that forms on the bacterial lawn when nearby cells are killed by an infection that is initiated by a single phage particle. Phage dilutions were made in saline solution (8.5 g/L NaCl) and implemented to yield between 30 and 300 plaques. A single plaque was picked from the infused plates and clonal phage stocks were made by culturing the isolate overnight with DH5α and extracting phage lysate using techniques similar to frozen λ stocks.</p></sec><sec id="s4-4"><title>Estimation of phage densities</title><p>Infused plates with appropriate dilutions of phage in saline solution (8.5 g/L NaCl) were used to estimate phage densities for phage competition assays. We controlled the number of plaques on an infused plate so that individual plaques could be identified and counted. These counts were used to back-calculate the phage growth rate.</p><p>To estimate the phage densities in the coevolutionary replay experiments, serial dilutions of phage were spotted on a bacterial lawn of DH5α. We made the bacterial lawns by adding ~5 × 10<sup>9</sup> cells of DH5α to 10 ml of molten soft agar at 55°C, and pouring it over a 150 mm diameter petri dish of LB agar base (<xref ref-type="bibr" rid="bib47">Sambrook and Russell, 2001</xref>). After the soft agar solidified, 2 μl of eight different phage dilutions were added on top of the surface, let to dry, and incubated overnight at 37°C. The plaques were counted from the dilution where we could identify individual plaques. We then used these counts to calculate phage density in pfu per ml, where pfu is plaque forming units.</p></sec><sec id="s4-5"><title>Sequencing for analyses of mutations in <italic>J</italic></title><p>We routinely sequenced the <italic>J</italic> gene of λ to verify the identity of stocks and to determine whether <italic>J</italic> evolved in the replay experiments. DNA samples were PCR amplified using Q5 high-fidelity 2 × master mix (New England Biolabs) and primers described in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1h</xref>. Unpurified PCRs were submitted to Genewiz (La Jolla, CA) for Sanger sequencing.</p></sec><sec id="s4-6"><title>Calculation of selection rate using Malthusian parameter</title><p>Selection rate (<inline-formula><mml:math id="inf22"><mml:mi>s</mml:mi></mml:math></inline-formula>) was used to quantify the difference in fitness between pairs of strains (say X and Y) in a given environment. It is calculated as the difference of their Malthusian parameters:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="italic">ln</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="italic">ln</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf23"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf24"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the densities of strains X and Y, respectively, at time <inline-formula><mml:math id="inf25"><mml:mi>t</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf26"><mml:mi>T</mml:mi></mml:math></inline-formula> is the period of time over which strains are assessed (and the assay starts at <inline-formula><mml:math id="inf27"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>). Selection rate has units of inverse time; however, in all our figures, we report selection rate as per unit time period (<inline-formula><mml:math id="inf28"><mml:mi>T</mml:mi></mml:math></inline-formula>) of the assays. We reported the values this way because λ does not strictly grow exponentially and it can be misleading to report normalized rates after dividing by <inline-formula><mml:math id="inf29"><mml:mi>T</mml:mi></mml:math></inline-formula> because the rates cannot be extrapolated for different times in a straightforward way like for exponential growths. That being said, for readers who want the per hour rates, we have provided the value of <inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in hours within each figure caption.</p></sec><sec id="s4-7"><title>Construction of λ genomic library using MAGE</title><p>Our goal was to measure the fitness of a significant number of λ genotypes to establish the basic structure of the landscape. To accomplish this, we generated a combinatorial library of genotypes made with 10 <italic>J</italic> mutations previously observed to evolve en route to OmpF<sup>+</sup> (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1a</xref>). These mutations were chosen because they fell within two &lt;100 base frames where adaptive mutations tended to evolve. We used a genetic engineering technique called MAGE to construct the library (<xref ref-type="bibr" rid="bib55">Wang et al., 2009</xref>). This technique employs the λ-red recombineering system that can efficiently recombine single-stranded DNA into <italic>E. coli</italic>’s genomic DNA. To engineer λ, λ’s genome is integrated into <italic>E. coli</italic>’s genome, creating a lysogen. The λ genome in the lysogen (a prophage) becomes dormant and can be treated as any other <italic>E. coli</italic> gene. Gene edits in this λ lysogen are made by expressing λ-red from a plasmid (pKD46) within <italic>E. coli</italic> cells (<xref ref-type="bibr" rid="bib12">Datsenko and Wanner, 2000</xref>) and electroporating synthetic oligos with specific mutations written into the sequences. Multiple oligos can be combined into a single experiment in order to create a diverse library of different combinations of the mutations. The output of this procedure is a single sample with a library of genotypes mixed together.</p><p>We previously reported our MAGE protocol in <xref ref-type="bibr" rid="bib33">Maddamsetti et al., 2018</xref>. The oligos used are in Table S1 of the manuscript listed under the subheading ‘10-mutation library’. There are a few important aspects of the oligo and protocol design that we discuss here, but for more detailed information see the original paper.</p><p>Our goal was to construct a genetic library with each combination of mutations represented equally, this means a 50/50 split of mutant and WT states at each site. To achieve this, we modified the typical MAGE protocol. First, when mutations were clustered near each other such that a single 90-mer used for MAGE editing encompassed multiple mutations, we designed multiple oligos with different combinations of the mutations at these nearby sites. Without doing this, edits would be correlated, creating an imbalance in the network representation, and limiting our ability to determine the effects of individual mutations. Second, we designed oligos with the WT state at the 10 positions. Including these oligos slowed the efficiency of MAGE to introduce mutations because sometimes they would overwrite an edit; however, it safeguarded the procedure from saturating the library with the 10 mutations. A third strategy was employed to even out the variation at these 10 sites. This was to perform MAGE starting from two orthogonal points in the genetic network; λ that had none of the 10 mutations and one that we engineered in all 10 (<xref ref-type="bibr" rid="bib33">Maddamsetti et al., 2018</xref>). Additionally, we ran MAGE on three separate replicates from each starting point in order to enhance the potential to explore more genetic space. Lastly, we ran the MAGE protocol for 50 cycles, which is the number of cycles a computer simulation of MAGE with an efficiency of 10% recombination efficiency per cycle predicted we would need to construct all variants. In the end, we mixed all six MAGE libraries together in equal frequencies to maximize diversity in the library.</p><p>Our design also included measures to improve our ability to detect rare variants in the library. The next step of the fitness landscape protocol is amplicon sequencing with an Illumina MiSeq. This technology has relatively low rates of error (~10<sup>–3</sup> per base sequenced); however, we anticipated that some of the genotypes in our library would fall below this frequency, making it impossible to distinguish between false positives and true reads. To improve our resolution, we edited a synonymous mutation adjacent to each focal mutation. We called this a watermark mutation because it helped us distinguish between a true genome edit and an error in sequencing. By only recording the presence of a focal mutation if it occurred alongside the watermark, we decreased our detection limit from ~10<sup>–3</sup> to ~10<sup>–6</sup>.</p><p>The watermark strategy we employed was slightly more complicated than this. Most synonymous mutations at the C-terminal end of proteins, like our watermark mutations, have no fitness effects (<xref ref-type="bibr" rid="bib26">Kelsic et al., 2016</xref>). Despite this, we designed a way to test for neutrality. For each focal mutation, we edited one of two different watermark mutations (see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1i</xref> for list of mutations). This allowed us to compare equivalent genotypes with distinct watermarks in order to test whether one of the synonymous mutations impacted λ’s fitness when compared to the other. We found that there was no significant fitness effect of the neutral mutations on the phage genotype (see Appendix 1).</p></sec><sec id="s4-8"><title>Empirical fitness landscape resolved through one-pot competition experiment</title><p>After creating the λ genomic library, we measured the relative fitness of genotypes with respect to the WT λ. To do this, we cocultured the λ genomic library and ancestral λ in a 1:9 ratio. This ratio was used so that the most abundant competitor remains the ancestor throughout the competition experiment. This means that the competitive fitness we measured is with respect to a single genotype. If we had not done this, then as the community of engineered λ shifts during the competition, and more fit genotypes become enriched, they will change the mean fitness of the population and cause mildly fit genotypes to begin to decline, making them appear unfit. Flooding the flask with ancestral λ and running competitions for a short time period (4 hr) solves this problem.</p><p>Having a disproportionate number of ancestral λ has a pitfall. We measured λ fitness by comparing the frequency changes of each genotype using amplicon sequencing (more information in the next section). The problem is that most of our sequencing effort would be spent on sequencing a single genotype, the ancestor. To avoid this, we engineered an ancestral genome with 6 synonymous mutations, where the reverse primer binds. These edits interfered with primer binding and caused selective amplification of the library λs. We edited 6 ‘wobble’ positions: 3381 (g→t), 3384 (c→a), 3387 (c→a), 3390 (c→t) 3393 (g→a), and 3396 (c→a). The engineering was done using MAGE with the oligo provided in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1j</xref>. These edits were made at the end of the protein (3399 nucleotide) and so they likely did not affect λ fitness. We did not test this because this engineered strain acted as a standard competitor for all competition experiments and so it should have no effect on the relative fitness comparisons.</p><p>We ran eight competitions, four in the presence of ancestral <italic>E. coli</italic> and four with <italic>malT</italic><sup>–</sup> <italic>E. coli.</italic> Competitions were inoculated with ~10<sup>7</sup> total λ particles and ~2 × 10<sup>8</sup> cells into 10 ml of M9 glucose in 50 ml flasks. The cells were preconditioned in M9 glucose for 24 hr before the competition. Flasks were cultured for 4 hr at 37°C and shaking at 120 rpm. 1 ml samples were removed from the library before and after the competition for processing. Phage particles were concentrated using PEG precipitation (<xref ref-type="bibr" rid="bib47">Sambrook and Russell, 2001</xref>). The pellet was resuspended in 25 μl of molecular grade water and then a two-step PCR reaction was performed in order to amplify just the region of interest, to attach barcodes to the amplicons so that we could multiplex samples into a single Illumina run, and attach adapters required for Illumina sequencing. The protocol was published by <xref ref-type="bibr" rid="bib26">Kelsic et al., 2016</xref>. The primers we used are provided in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1k</xref>. As described in Kelsic et al., we ran two separate PCR reactions for each sample and used a unique barcode on each. This allowed us to test for amplification bias, which we did not detect (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>).</p></sec><sec id="s4-9"><title>Sequencing</title><p>Amplicon samples were pooled together and sequenced using an Illumina Mi-Seq maintained in the Systems Biology Department at Harvard Medical School. 100 base paired-end reads were run. We were able to extract on average 107,839 high quality reads per sample with standard deviation of 26,889. This provided considerable coverage to reliably estimate fitness for even rare genotypes.</p></sec><sec id="s4-10"><title>Post-sequencing analysis and construction of fitness landscape</title><p>Amplicon sequences were analyzed to calculate selection rates for each engineered genotype. These values were later used to construct the fitness landscapes. We used a combination of custom Python and MATLAB (version R2019b) scripts to read and concatenate the raw paired-end reads, identify the genotypes based on the focal mutations they possessed, and to count their abundances. All focal mutations were called only if either of the two corresponding watermark mutations were also present. We removed any reads that contained more than one mutation other than the focal and watermark mutations. This essentially acted as a quality filter and we did not have to filter based on the Illumina provided Q-score. For each competition, a mean of counts corresponding to the two barcodes used in PCR amplifications was taken for all the genotypes. If the counts for both, initial and final timepoints were available for a genotype, they were used to estimate the genotype’s Malthusian growth rate, given by the calculation <inline-formula><mml:math id="inf31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi/><mml:mi>λ</mml:mi></mml:msub><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi/><mml:mi>λ</mml:mi></mml:msub><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mi>T</mml:mi></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> where <inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> is the density of the given genotype at time <inline-formula><mml:math id="inf33"><mml:mi>t</mml:mi></mml:math></inline-formula> and T is the total time of the competition. Note that most genotypes performed poorly on <italic>malT<sup>—</sup></italic> host and fell below detection limit at the final timepoint. We quantified the differences in fitness of all genotypes by calculating their selection rate with respect to the WT λ (see ‘Calculation of selection rate using Malthusian parameter’ section). The final fitness landscapes (<xref ref-type="fig" rid="fig1">Figure 1a and b</xref>) were constructed by taking the mean of the selection rates obtained from the four replicate competition trials performed on the same host.</p></sec><sec id="s4-11"><title>Statistical analysis of fitness landscapes</title><p>We used multiple linear regression models to quantify the genetic interactions in the fitness landscapes. We regressed fitness values on each landscape against individual effects of the mutations and the pairwise epistatic interactions between them (genotype-by-genotype or G×G interactions). This allowed us to estimate the contribution of epistasis toward explaining the observed fitness data. The fitness of each genotype in the regression model was thus described by 55 predictor variables (10 main effect terms for the 10 mutations +45 interaction terms):<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mo>∗</mml:mo><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>∗</mml:mo><mml:mtext> </mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf34"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi><mml:mi>*</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the intercept, all other βs are regression coefficients, contribution of an individual mutation <italic>i</italic> is described by the term <inline-formula><mml:math id="inf35"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> , and the effect of pair of mutations <italic>i</italic> and <italic>j</italic> are captured by terms <inline-formula><mml:math id="inf36"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> , where <inline-formula><mml:math id="inf37"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is an indicator variable that is equal to zero when the mutation <italic>i</italic> is absent and one when present. After fitting the model, we used Benjamini-Hochberg procedure (<xref ref-type="bibr" rid="bib3">Benjamini and Hochberg, 1995</xref>) to control for false discovery rates and identify statistically significant terms in the model (see <xref ref-type="fig" rid="fig1">Figure 1c</xref>). All analyses were performed in R version 3.6.1 (<xref ref-type="bibr" rid="bib45">R Development Core Team, 2019</xref>). The error in fitness estimates of the genotypes did not depend on the mean fitness value of the genotypes (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>).</p><p>To understand how λ’s landscape differed between the two hosts, we incorporated the host genotype as a predictor variable in the linear model and regressed the combined fitness data of both landscapes together. This allowed us to test if a mutation significantly interacted with the host (genotype-by-environment or G×E interaction) and whether interaction between pairs of mutations changed with the host genotype (genotype-by-genotype-by-environment or G×G×E interaction). The combined full-factorial model consisted of a total of 111 terms (10 G for individual mutation +1 E for host +45 G×G+10 G×E+45 G×G×E terms),<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mo>∗</mml:mo><mml:mo>∗</mml:mo><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>∗</mml:mo><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mo>∗</mml:mo><mml:mo>∗</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mi>E</mml:mi><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>∗</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>E</mml:mi><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>E</mml:mi></mml:mrow></mml:math></disp-formula></p><p>where additional <inline-formula><mml:math id="inf38"><mml:mi>E</mml:mi></mml:math></inline-formula> is an indicator variable for host type and other notations follow same scheme as in <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>. Since the fit of a model generally improves as the number of predictor variables increases, we tested for overfitting using Akaike information criterion (AIC) (<xref ref-type="bibr" rid="bib1">Akaike, 1974</xref>). AIC is a penalized-likelihood criterion which penalizes a model for increasing number of parameters in it. The model with the greatest relative likelihood is considered to be the one with minimum AIC value. We minimized AIC value using the <italic>step</italic> function in <xref ref-type="bibr" rid="bib45">R Development Core Team, 2019</xref> to uncover subsets of predictor variables that have high predictive power. This resulted in a more parsimonious model (77 terms out of a total 111, see <xref ref-type="fig" rid="fig1">Figure 1d</xref>). A complimentary adjusted R-squared analysis came to the same conclusion, <inline-formula><mml:math id="inf39"><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.775</mml:mn></mml:math></inline-formula> for the reduced model and <inline-formula><mml:math id="inf40"><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.769</mml:mn></mml:math></inline-formula> for the full-factorial model (higher values indicate more predictive and parsimonious models). After model selection, we used Benjamini-Hochberg procedure to determine which variables were significantly predictive (<xref ref-type="fig" rid="fig1">Figure 1d</xref>). This procedure only controls for false positives and is susceptible to false negatives. In this way, it is conservative for our purposes.</p></sec><sec id="s4-12"><title>Simulation of λ’s evolution on fitness landscapes</title><p>To test if the changes in λ’s fitness landscape facilitated its evolution to infect via OmpF, we simulated λ’s evolution on the two landscapes we measured and recorded whether OmpF<sup>+</sup> genotypes arose to a high enough frequency that we would have detected them in the original laboratory evolution. We initiated λ populations with no mutations and allowed them to evolve and mutate at any of the 10 focal sites used to construct the landscapes (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1a</xref>). For each treatment (<xref ref-type="fig" rid="fig2">Figure 2</xref>), we simulated 300 separate trials using a modified Wright-Fisher model with discrete generations and a fixed population size.</p><p>For each simulation, a new fitness landscape was constructed by assigning fitness values to all the genotypes (2<sup>10</sup>=1024 genotypes). This was done in a way to account for error in estimating fitness and the error associated with imputing the values of missing data points. For the genotypes that had empirical fitness data available (<xref ref-type="fig" rid="fig1">Figure 1a and b</xref>), we did not simply average the values of the replicate fitness measurements but instead we performed a bootstrapping protocol in order to account for the error in the fitness estimate. We randomly resampled from the four replicate measurements (with replacement) and then computed the mean of the four. Some genotypes were not present in all four replicates, in these cases we resampled as many times as there were replicates. Genotypes with only one replicate data point were, thus, assigned the same corresponding fitness values in all the runs of the simulations. Next, we imputed fitness of the genotypes that were missing from the empirical landscape. A genotype with a missing fitness value was randomly chosen and assigned the mean of the fitness values of its nearest neighbors (one-mutation away genotypes) present in the landscape. This was iterated until the full genotypic space was complete. Note that the order in which genotypes are chosen can affect the value that is estimated for a given genotype. This is because as the landscape is filled in, each genotype will have more neighbors to draw values from. This means that if a genotype is randomly chosen early, its fitness will be based on fewer neighbors than if it were chosen later, and its value will be slightly different. Since missing genotypes are randomly chosen in each iteration, the order will vary from one simulation to the next. This method introduces an extra source of variation in the simulation runs and captures uncertainty associated with the imputation of fitness values.</p><p>After constructing a complete fitness landscape, we evolved a λ population through repeated cycles of reproduction, selection, and mutation. For each generation, reproduction in the population was simulated by a multinomial sampling where the number of trials was equal to the population size <inline-formula><mml:math id="inf41"><mml:mi>N</mml:mi></mml:math></inline-formula> (set to ~6.3 × 10<sup>9</sup> based on <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>) and the success probability associated with a genotype <italic>i</italic> was given by <inline-formula><mml:math id="inf42"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> , where <inline-formula><mml:math id="inf43"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the abundance of the genotype <italic>i</italic>, and <inline-formula><mml:math id="inf44"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is defined as the exponential of selection rate used in fitness landscape. Thus, the probability of <inline-formula><mml:math id="inf45"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> offsprings for genotypes <inline-formula><mml:math id="inf46"><mml:mn>1,2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi>m</mml:mi></mml:math></inline-formula> would be:<disp-formula id="equ4"><mml:math id="m4"><mml:mfenced separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>N</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>To incorporate mutations, all genotypes whose frequencies increased were mutated as per λ’s mutation rate (7.7 × 10<sup>–8</sup> per base per replication <xref ref-type="bibr" rid="bib16">Drake, 1991</xref>). Consider a genotype (say <italic>i</italic>) that increased in abundance and let the number of additional individuals produced by this genotype be denoted by <inline-formula><mml:math id="inf47"><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (with <inline-formula><mml:math id="inf48"><mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>). Each of these <inline-formula><mml:math id="inf49"><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> individuals retained its parent’s genotype with a probability <inline-formula><mml:math id="inf50"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> (assuming a Poisson distribution for mutations). Otherwise, the individual was assigned to a random neighboring (i.e. mutant) genotype. Given λ’s mutation rate, the probability of multiple mutations is very small and was ignored here. We simulated this modified Wright-Fisher cycle of reproduction and mutation for 960 generations. It is difficult to know how many generations phages undergo because the evolved phages have a high spontaneous death rate (<xref ref-type="bibr" rid="bib43">Petrie et al., 2018</xref>) and can also experience other sources of mortality. Given this, we decided to run the simulation for a somewhat arbitrary amount of time, 960 generations which corresponds to two doublings per hour for the 20-day experiment we are trying to replicate <xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>. This is likely an overestimate, which is unintuitively conservative for our purposes because more cycles will cause additional evolution and exploration of the fitness landscape, enhancing the possibility of OmpF<sup>+</sup> evolution in the negative controls, and reducing our ability to detect treatment differences.</p><p>We evaluated whether λ evolved OmpF<sup>+</sup> by examining the population for genotypes that had the necessary mutations to be OmpF<sup>+</sup>. Previous studies revealed that OmpF genotypes must have four mutations (<xref ref-type="bibr" rid="bib33">Maddamsetti et al., 2018</xref>). They all possess two specific changes (A3034G) and (G3319A) and a third change that can occur at positions 3320 or 3321. For the 10 mutations we studied, T3321A is the only third mutation that satisfies this requirement, meaning all OmpF genotypes must have three specific changes (A3034G, G3319A, and T3321A). Many <italic>J</italic> mutations satisfy the last requirement (<xref ref-type="bibr" rid="bib33">Maddamsetti et al., 2018</xref>), so we implemented what we call the ‘3+1’ rule where genotypes are designated as OmpF<sup>+</sup> if they have the three necessary <italic>J</italic> mutations plus any additional mutation (see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1i</xref>). If any such genotype crossed the threshold of 5000 λ particles during the course of a simulation, the λ population in that run was marked to have evolved OmpF-function. We based the threshold value on the detection limit of OmpF<sup>+</sup> genotypes in the original laboratory coevolution experiments (~500 pfu/ml, see ‘Coevolutionary Replay Experiments’ section).</p><p>We implemented host switching by first evolving λ on the landscape measured with ancestral <italic>E. coli,</italic> stopping the simulation early, and quantifying the frequency of each λ genotype. Next, we would initiate evolution on the <italic>malT</italic><sup>—</sup> for the remainder of the time but starting with genotypes at the frequencies recorded on the ancestral landscape. A total of 11 different coevolution treatments were run by varying how long λ evolved on the ancestral host landscape and <italic>malT<sup>—</sup></italic> landscape (<xref ref-type="fig" rid="fig2">Figure 2</xref>). 300 simulation trials were run for each treatment. We calculated error in the simulations in order to detect significant treatment differences by batching the runs into 30 and estimating the frequency of OmpF<sup>+</sup> for each subset. This allowed us to calculate a 95% confidence interval using a Student’s <italic>t</italic> distribution for the frequency of OmpF<sup>+</sup> evolution in each treatment, and then to use an ANOVA coupled with Tukey’s multiple comparison test to test for treatment differences.</p></sec><sec id="s4-13"><title>Phage competition assays</title><p>To test whether λ’s path to innovation requires sequential adaptation to host genotypes isolated from different stages of their coevolution, we studied the dynamics of λ evolution in much more depth than previously reported. We focused on a single experimental replicate reported on in <xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>; ‘D7’ that evolved to be OmpF<sup>+</sup> on the 12th day. Daily samples of the population were preserved, so we were able to revive phages from the full time series. We isolated 66 phages in total (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1c and d</xref>) and sequenced the full-length <italic>J</italic> gene from each in order to reconstruct the evolutionary dynamics (<xref ref-type="fig" rid="fig3">Figure 3a</xref>).</p><p>Next, we ran head-to-head competition experiments from key genotypes along the path to OmpF<sup>+</sup>, the WT and λ with a single <italic>J</italic> mutation (A), double (AB), and quintuple (ABCDE) (<xref ref-type="fig" rid="fig3">Figure 3b and c</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). Our first step was to mark key strains with a gene that caused the plaques to be visually distinguishable from unmarked phage. The gene is <italic>lacZ</italic>α, which in the presence of a 5-bromo-4-chloro-3-indolyl-b-D-galactopyranoside (X-gal), Isopropyl-β-D-thiogalactoside (IPTG), and a host cell like DH5α that lacks <italic>lacZ</italic>α, produces blue plaques. To incorporate <italic>lacZ</italic>α into λ’s genome, we used a gene fusion of <italic>lacZ</italic>α with λ’s <italic>R</italic> gene (<xref ref-type="bibr" rid="bib7">Burmeister et al., 2016</xref>; <xref ref-type="bibr" rid="bib48">Shao and Wang, 2008</xref>). The fusion readily recombines into λ’s genome by the phage’s endogenous recombination system, λ-red (<xref ref-type="bibr" rid="bib17">Ellis et al., 2001</xref>). The procedure is straightforward, infect an <italic>E. coli</italic> strain that has a plasmid with the lacZ fusion (strain: SYP042; plasmid: pSwtRlaczalphaZalpha +RZ xl1 Blue Amp Blue provided by Ing-Nang Wang, Albany, NY) and some fraction of the λ produced will have recombined with the plasmid. The recombinants are isolated by picking blue plaques. WT and AB were each marked. The marker has been shown to have a slight fitness effect; however, this would not significantly influence our measurements of fitness since we observed such large differences between strains (<xref ref-type="bibr" rid="bib7">Burmeister et al., 2016</xref>; <xref ref-type="bibr" rid="bib48">Shao and Wang, 2008</xref>).</p><p>We competed three pairs of phages, WT<sub>lacZ</sub> vs A, A vs AB<sub>lacZ</sub>, and AB<sub>lacZ</sub> vs ABCDE, under two conditions: with ancestral <italic>E. coli</italic> or <italic>malT</italic><sup>–</sup>. Competitions were run for a single 24 hr period under identical conditions in which the phage evolved (<xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>). Initial λ density was between 10<sup>4</sup> and 10<sup>5</sup> particles per ml and the relative frequency of the strains was sometimes skewed in order to start with more of the unfit genotype. Fitness differences were so large that the less fit genotype would be overwhelmed and its frequency undetectable if they did not start with a numerical advantage. ~5 × 10<sup>6</sup> exponentially growing cells were inoculated to each flask (5 × 10<sup>5</sup> per ml). The cells were preconditioned by growing them overnight in the competition medium. Three replicate competitions were run for each treatment. Phage densities of the unmarked and marked λ were determined by plating in typical soft agar plates, where we added 0.5 mg/ml of X-gal and 0.25 mg/ml IPTG to the molten soft agar. Densities were measured at t=0 and t=24 hr.</p></sec><sec id="s4-14"><title>Host competition assay</title><p>This competition experiment tested the role of λ’s evolution plays in promoting the evolution of host resistance. We competed the ancestral host (REL606) against the evolved-resistant host (EcC4) in the presence of different λ genotypes that had increasing numbers of <italic>J</italic> mutations (<xref ref-type="fig" rid="fig3">Figure 3</xref>; WT (cI26), A (1-mutation), ABC (3-mutation), and A**C (4-mutation)). We initiated three replicate populations for each phage treatment. The competition was performed with identical conditions as the original evolution experiment and run for 4 hr to prevent λ from evolving during the competition assay. Cells were preconditioned in modified M9 glucose for 24 hr before the competition. As with λ, fitness was measured by observing the change in frequency of the competitors over time. Frequencies were determined by plating a subsample of the populations onto tetrazolium maltose (TMal) agar plates (<xref ref-type="bibr" rid="bib49">Shuman and Silhavy, 2003</xref>). REL606 produces white colonies on the plates, while EcC4 produces smaller red colonies. Before plating, the phages were removed by centrifugation of the cells and then removing the supernatant that contained the phage. Cells were resuspended in saline solution and the centrifugation and resuspension were repeated once more.</p></sec><sec id="s4-15"><title>Coevolutionary replay experiments</title><p>Would λ’s evolution to OmpF innovation proceed without initially evolving on an ancestral host? We tested this by replaying λ-<italic>E. coli</italic> coevolution but starting out with a host that already evolved resistance via a <italic>malT<sup>—</sup></italic> mutation (strain LR01). We initiated 12 replicate populations with <italic>malT<sup>—</sup></italic>, and another 12 with REL606 as a positive control. The replay experiment was run nearly identically to the coevolution experiment performed by <xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref> with cI26 as the ancestor phage, and daily sampling was done to detect the presence of OmpF<sup>+</sup> phage by spotting the phage on the bacterial lawn of <italic>lamB<sup>—</sup></italic> cells (detection limit ~500 pfu per ml) (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). The two differences were that the study was run longer (31 days) and daily estimates of λ populations were made (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). Twelve replicates were chosen in order to have enough statistical power to determine whether or not a treatment reduces the chances of OmpF<sup>+</sup> evolution. In the previously reported study, only a quarter of populations (24 out of 96) evolved to use OmpF (<xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>); this result has also been replicated in our lab on two separate instances where 3 out of 12 populations gained OmpF-function. Assuming a binomial distribution and a true success rate of 0.25 for λ’s OmpF<sup>+</sup> evolution with the ancestral host, the probability of observing no replicate evolving to be OmpF<sup>+</sup> in 12 replicate populations is 0.03167. Thus, we can conclude that <italic>malT<sup>—</sup></italic> treatment reduced λ’s ability to evolve the innovation as compared to when coevolution is initiated with ancestral host. Two isolates from each population were sampled on day 26, and the reactive region of their <italic>J</italic> genes were sequenced using the Sanger sequencing method.</p><p>We ran two additional replay experiments as a positive control for any unintended side effects of initiating an experiment with <italic>malT<sup>—</sup></italic> host (LR01). A prediction from the fitness landscape simulation results was that if we started a replay with <italic>malT<sup>—</sup></italic> and a phage isolated from a later-stage of the coevolution, then the phage should evolve OmpF use. To test this, we genetically modified an OmpF<sup>+</sup> λ by removing one mutation required for OmpF use (λ<sup>–1</sup>), and then a second (λ<sup>–2</sup>). The OmpF<sup>+</sup> genotype was a lysogen (cI857) that we had previously edited in seven <italic>J</italic> mutations (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1f</xref>), which is reported about in <xref ref-type="bibr" rid="bib43">Petrie et al., 2018</xref>. The two new edits were made using MAGE and the oligos are reported in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1j</xref>.</p><p>The replay experiments were run identically, except because of an oversight, these replays were run in a slightly different minimal glucose medium called Tris DM (compared to the original coevolution experiment run by <xref ref-type="bibr" rid="bib35">Meyer et al., 2012</xref>). The key difference in the medium is the buffer, it is a Tris buffer, not a phosphate buffer. Both mediums impose carbon limitation and have the same concentration of the single carbon source, glucose, and so population and evolutionary dynamics should not have been affected. We confirmed in an additional replay experiment that the medium does not affect the timing or repeatability of OmpF<sup>+</sup> evolution.</p></sec><sec id="s4-16"><title>Data and code availability</title><p>Amplicon sequencing data used to generate fitness landscapes in this study have been deposited in the NCBI Sequence Read Archive under BioProject PRJNA646809. The code and data that support the findings of this study are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/anigupta12/fitness-landscape-paper">https://github.com/anigupta12/fitness-landscape-paper</ext-link>, copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:1afd8e949484953feb7fa2e768369d1a08d9f514;origin=https://github.com/anigupta12/fitness-landscape-paper;visit=swh:1:snp:85026e17eae281299a67f6622fd7f438a292b3ff;anchor=swh:1:rev:19292491a2768444bd009da8a3de6d25ce8ab18c">swh:1:rev:19292491a2768444bd009da8a3de6d25ce8ab18c</ext-link> (<xref ref-type="bibr" rid="bib23">Gupta, 2021</xref>).</p><p>Sharing of biological material requires a material transfer agreement, described at <ext-link ext-link-type="uri" xlink:href="http://blink.ucsd.edu/research/conducting-research/mta/index.html">http://blink.ucsd.edu/research/conducting-research/mta/index.html</ext-link>.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Formal analysis, Investigation, Methodology, Project administration, Resources, Software, Validation, Visualization, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Formal analysis, Methodology, Resources, Software, Validation, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Data curation, Investigation, Methodology, Resources, Writing - review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Data curation, Investigation, Methodology, Resources, Writing - review and editing</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Data curation, Investigation, Methodology, Resources, Writing - review and editing</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Formal analysis, Funding acquisition, Methodology, Resources, Supervision, Writing - review and editing</p></fn><fn fn-type="con" id="con7"><p>Methodology, Resources, Validation, Writing - review and editing</p></fn><fn fn-type="con" id="con8"><p>Conceptualization, Funding acquisition, Methodology, Resources, Supervision, Writing - review and editing</p></fn><fn fn-type="con" id="con9"><p>Conceptualization, Data curation, Formal analysis, Funding acquisition, Investigation, Methodology, Project administration, Resources, Supervision, Validation, Writing - original draft, Writing - review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>All the supplementary tables.</title></caption><media xlink:href="elife-76162-supp1-v1.docx" mimetype="application" mime-subtype="docx"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media xlink:href="elife-76162-transrepform1-v1.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>Amplicon sequencing data used to generate fitness landscapes in this study have been deposited in the NCBI Sequence Read Archive under BioProject PRJNA646809. Other data that support the findings of this study is deposited at Dryad at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5061/dryad.ht76hdrhq">https://doi.org/10.5061/dryad.ht76hdrhq</ext-link> and all code is made available at GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/anigupta12/fitness-landscape-paper">https://github.com/anigupta12/fitness-landscape-paper</ext-link>, (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:1afd8e949484953feb7fa2e768369d1a08d9f514;origin=https://github.com/anigupta12/fitness-landscape-paper;visit=swh:1:snp:85026e17eae281299a67f6622fd7f438a292b3ff;anchor=swh:1:rev:19292491a2768444bd009da8a3de6d25ce8ab18c">swh:1:rev:19292491a2768444bd009da8a3de6d25ce8ab18c</ext-link>).</p><p>The following datasets were generated:</p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset1"><person-group person-group-type="author"><name><surname>Gupta</surname><given-names>A</given-names></name><name><surname>Zaman</surname><given-names>L</given-names></name><name><surname>Strobel</surname><given-names>HM</given-names></name><name><surname>Gallie</surname><given-names>J</given-names></name><name><surname>Burmeister</surname><given-names>AR</given-names></name><name><surname>Kerr</surname><given-names>B</given-names></name><name><surname>Tamar</surname><given-names>ES</given-names></name><name><surname>Kishony</surname><given-names>R</given-names></name><name><surname>Meyer</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Host-parasite coevolution promotes innovation through deformations in fitness landscapes</data-title><source>Dryad Digital Repository</source><pub-id pub-id-type="doi">10.5061/dryad.ht76hdrhq</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset2"><person-group person-group-type="author"><name><surname>Gupta</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Fitness landscape of bacteriophage lambda with ancestral host and resitant host</data-title><source>NCBI BioProject</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA646809">PRJNA646809</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank the James McDonnel Foundation and the NSF-DEB (1934515) for financial support and The Max Planck Society for supporting JG. We thank A Agarwal for help with the statistical analyses of fitness landscapes.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Akaike</surname><given-names>H</given-names></name></person-group><year iso-8601-date="1974">1974</year><article-title>A new look at the statistical model identification</article-title><source>IEEE Transactions on Automatic Control</source><volume>19</volume><fpage>716</fpage><lpage>723</lpage><pub-id pub-id-type="doi">10.1109/TAC.1974.1100705</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baba</surname><given-names>T</given-names></name><name><surname>Ara</surname><given-names>T</given-names></name><name><surname>Hasegawa</surname><given-names>M</given-names></name><name><surname>Takai</surname><given-names>Y</given-names></name><name><surname>Okumura</surname><given-names>Y</given-names></name><name><surname>Baba</surname><given-names>M</given-names></name><name><surname>Datsenko</surname><given-names>KA</given-names></name><name><surname>Tomita</surname><given-names>M</given-names></name><name><surname>Wanner</surname><given-names>BL</given-names></name><name><surname>Mori</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Construction of <italic>Escherichia coli</italic> K-12 in-frame, single-gene knockout mutants: the Keio collection</article-title><source>Molecular Systems Biology</source><volume>2</volume><elocation-id>2006.0008</elocation-id><pub-id pub-id-type="doi">10.1038/msb4100050</pub-id><pub-id pub-id-type="pmid">16738554</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benjamini</surname><given-names>Y</given-names></name><name><surname>Hochberg</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Controlling the False Discovery Rate: A Practical and Powerful Approach to Multiple Testing</article-title><source>Journal of the Royal Statistical Society</source><volume>57</volume><fpage>289</fpage><lpage>300</lpage><pub-id pub-id-type="doi">10.1111/j.2517-6161.1995.tb02031.x</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bergelson</surname><given-names>J</given-names></name><name><surname>Kreitman</surname><given-names>M</given-names></name><name><surname>Petrov</surname><given-names>DA</given-names></name><name><surname>Sanchez</surname><given-names>A</given-names></name><name><surname>Tikhonov</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Functional biology in its natural context: A search for emergent simplicity</article-title><source>eLife</source><volume>10</volume><elocation-id>e67646</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.67646</pub-id><pub-id pub-id-type="pmid">34096867</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blount</surname><given-names>ZD</given-names></name><name><surname>Lenski</surname><given-names>RE</given-names></name><name><surname>Losos</surname><given-names>JB</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Contingency and determinism in evolution: Replaying life’s tape</article-title><source>Science</source><volume>362</volume><elocation-id>eaam5979</elocation-id><pub-id pub-id-type="doi">10.1126/science.aam5979</pub-id><pub-id pub-id-type="pmid">30409860</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boos</surname><given-names>W</given-names></name><name><surname>Böhm</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Learning new tricks from an old dog: MalT of the <italic>Escherichia coli</italic> maltose system is part of a complex regulatory network</article-title><source>Trends in Genetics</source><volume>16</volume><fpage>404</fpage><lpage>409</lpage><pub-id pub-id-type="doi">10.1016/s0168-9525(00)02086-2</pub-id><pub-id pub-id-type="pmid">10973069</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burmeister</surname><given-names>AR</given-names></name><name><surname>Lenski</surname><given-names>RE</given-names></name><name><surname>Meyer</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Host coevolution alters the adaptive landscape of a virus</article-title><source>Proceedings of the Royal Society B</source><volume>283</volume><elocation-id>20161528</elocation-id><pub-id pub-id-type="doi">10.1098/rspb.2016.1528</pub-id><pub-id pub-id-type="pmid">27683370</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cervera</surname><given-names>H</given-names></name><name><surname>Lalić</surname><given-names>J</given-names></name><name><surname>Elena</surname><given-names>SF</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Effect of Host Species on Topography of the Fitness Landscape for a Plant RNA Virus</article-title><source>Journal of Virology</source><volume>90</volume><fpage>10160</fpage><lpage>10169</lpage><pub-id pub-id-type="doi">10.1128/JVI.01243-16</pub-id><pub-id pub-id-type="pmid">27581976</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chaudhry</surname><given-names>WN</given-names></name><name><surname>Pleška</surname><given-names>M</given-names></name><name><surname>Shah</surname><given-names>NN</given-names></name><name><surname>Weiss</surname><given-names>H</given-names></name><name><surname>McCall</surname><given-names>IC</given-names></name><name><surname>Meyer</surname><given-names>JR</given-names></name><name><surname>Gupta</surname><given-names>A</given-names></name><name><surname>Guet</surname><given-names>CC</given-names></name><name><surname>Levin</surname><given-names>BR</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Leaky resistance and the conditions for the existence of lytic bacteriophage</article-title><source>PLOS Biology</source><volume>16</volume><elocation-id>e2005971</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.2005971</pub-id><pub-id pub-id-type="pmid">30114198</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chou</surname><given-names>HH</given-names></name><name><surname>Chiu</surname><given-names>HC</given-names></name><name><surname>Delaney</surname><given-names>NF</given-names></name><name><surname>Segrè</surname><given-names>D</given-names></name><name><surname>Marx</surname><given-names>CJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Diminishing returns epistasis among beneficial mutations decelerates adaptation</article-title><source>Science</source><volume>332</volume><fpage>1190</fpage><lpage>1192</lpage><pub-id pub-id-type="doi">10.1126/science.1203799</pub-id><pub-id pub-id-type="pmid">21636771</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Darwin</surname><given-names>C</given-names></name></person-group><year iso-8601-date="1859">1859</year><source>The Origin of Species</source><publisher-loc>London, UK</publisher-loc><publisher-name>John Murray</publisher-name></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Datsenko</surname><given-names>KA</given-names></name><name><surname>Wanner</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>One-step inactivation of chromosomal genes in <italic>Escherichia coli</italic> K-12 using PCR products</article-title><source>PNAS</source><volume>97</volume><fpage>6640</fpage><lpage>6645</lpage><pub-id pub-id-type="doi">10.1073/pnas.120163297</pub-id><pub-id pub-id-type="pmid">10829079</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Visser</surname><given-names>JAGM</given-names></name><name><surname>Krug</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Empirical fitness landscapes and the predictability of evolution</article-title><source>Nature Reviews. Genetics</source><volume>15</volume><fpage>480</fpage><lpage>490</lpage><pub-id pub-id-type="doi">10.1038/nrg3744</pub-id><pub-id pub-id-type="pmid">24913663</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Visser</surname><given-names>JAGM</given-names></name><name><surname>Elena</surname><given-names>SF</given-names></name><name><surname>Fragata</surname><given-names>I</given-names></name><name><surname>Matuszewski</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The utility of fitness landscapes and big data for predicting evolution</article-title><source>Heredity</source><volume>121</volume><fpage>401</fpage><lpage>405</lpage><pub-id pub-id-type="doi">10.1038/s41437-018-0128-4</pub-id><pub-id pub-id-type="pmid">30127530</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Doebeli</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><source>Adaptive Diversification, Monographs in Population Biology</source><publisher-loc>Princeton, New Jersey</publisher-loc><publisher-name>Princeton University Press</publisher-name></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drake</surname><given-names>JW</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>A constant rate of spontaneous mutation in DNA-based microbes</article-title><source>PNAS</source><volume>88</volume><fpage>7160</fpage><lpage>7164</lpage><pub-id pub-id-type="doi">10.1073/pnas.88.16.7160</pub-id><pub-id pub-id-type="pmid">1831267</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ellis</surname><given-names>HM</given-names></name><name><surname>Yu</surname><given-names>D</given-names></name><name><surname>DiTizio</surname><given-names>T</given-names></name><name><surname>Court</surname><given-names>DL</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>High efficiency mutagenesis, repair, and engineering of chromosomal DNA using single-stranded oligonucleotides</article-title><source>PNAS</source><volume>98</volume><fpage>6742</fpage><lpage>6746</lpage><pub-id pub-id-type="doi">10.1073/pnas.121164898</pub-id><pub-id pub-id-type="pmid">11381128</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flynn</surname><given-names>KM</given-names></name><name><surname>Cooper</surname><given-names>TF</given-names></name><name><surname>Moore</surname><given-names>FBG</given-names></name><name><surname>Cooper</surname><given-names>VS</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The environment affects epistatic interactions to alter the topology of an empirical fitness landscape</article-title><source>PLOS Genetics</source><volume>9</volume><elocation-id>e1003426</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1003426</pub-id><pub-id pub-id-type="pmid">23593024</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fowler</surname><given-names>DM</given-names></name><name><surname>Fields</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Deep mutational scanning: a new style of protein science</article-title><source>Nature Methods</source><volume>11</volume><fpage>801</fpage><lpage>807</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3027</pub-id><pub-id pub-id-type="pmid">25075907</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fragata</surname><given-names>I</given-names></name><name><surname>Blanckaert</surname><given-names>A</given-names></name><name><surname>Dias Louro</surname><given-names>MA</given-names></name><name><surname>Liberles</surname><given-names>DA</given-names></name><name><surname>Bank</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Evolution in the light of fitness landscape theory</article-title><source>Trends in Ecology &amp; Evolution</source><volume>34</volume><fpage>69</fpage><lpage>82</lpage><pub-id pub-id-type="doi">10.1016/j.tree.2018.10.009</pub-id><pub-id pub-id-type="pmid">30583805</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gould</surname><given-names>SJ</given-names></name></person-group><year iso-8601-date="1989">1989</year><source>Wonderful Life: The Burgess Shale and the Nature of History</source><publisher-name>‎ W. W. Norton &amp; Company</publisher-name></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guerrero</surname><given-names>RF</given-names></name><name><surname>Scarpino</surname><given-names>SV</given-names></name><name><surname>Rodrigues</surname><given-names>JV</given-names></name><name><surname>Hartl</surname><given-names>DL</given-names></name><name><surname>Ogbunugafor</surname><given-names>CB</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Proteostasis Environment Shapes Higher-Order Epistasis Operating on Antibiotic Resistance</article-title><source>Genetics</source><volume>212</volume><fpage>565</fpage><lpage>575</lpage><pub-id pub-id-type="doi">10.1534/genetics.119.302138</pub-id><pub-id pub-id-type="pmid">31015194</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Gupta</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>fitness-landscape-paper</data-title><version designator="swh:1:rev:19292491a2768444bd009da8a3de6d25ce8ab18c">swh:1:rev:19292491a2768444bd009da8a3de6d25ce8ab18c</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/anigupta12/fitness-landscape-paper">https://github.com/anigupta12/fitness-landscape-paper</ext-link></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hall</surname><given-names>AR</given-names></name><name><surname>Scanlan</surname><given-names>PD</given-names></name><name><surname>Buckling</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Bacteria‐Phage Coevolution and the Emergence of Generalist Pathogens</article-title><source>The American Naturalist</source><volume>177</volume><fpage>44</fpage><lpage>53</lpage><pub-id pub-id-type="doi">10.1086/657441</pub-id><pub-id pub-id-type="pmid">21117957</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hendrix</surname><given-names>RW</given-names></name></person-group><year iso-8601-date="1983">1983</year><source>Cold Spring Harbor Monograph Series</source><publisher-name>Cold Spring Harbor Laboratory Press</publisher-name></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kelsic</surname><given-names>ED</given-names></name><name><surname>Chung</surname><given-names>H</given-names></name><name><surname>Cohen</surname><given-names>N</given-names></name><name><surname>Park</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>HH</given-names></name><name><surname>Kishony</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>RNA Structural Determinants of Optimal Codons Revealed by MAGE-Seq</article-title><source>Cell Systems</source><volume>3</volume><fpage>563</fpage><lpage>571</lpage><pub-id pub-id-type="doi">10.1016/j.cels.2016.11.004</pub-id><pub-id pub-id-type="pmid">28009265</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khan</surname><given-names>AI</given-names></name><name><surname>Dinh</surname><given-names>DM</given-names></name><name><surname>Schneider</surname><given-names>D</given-names></name><name><surname>Lenski</surname><given-names>RE</given-names></name><name><surname>Cooper</surname><given-names>TF</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Negative epistasis between beneficial mutations in an evolving bacterial population</article-title><source>Science</source><volume>332</volume><fpage>1193</fpage><lpage>1196</lpage><pub-id pub-id-type="doi">10.1126/science.1203801</pub-id><pub-id pub-id-type="pmid">21636772</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kosuri</surname><given-names>S</given-names></name><name><surname>Church</surname><given-names>GM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Large-scale de novo DNA synthesis: technologies and applications</article-title><source>Nature Methods</source><volume>11</volume><fpage>499</fpage><lpage>507</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2918</pub-id><pub-id pub-id-type="pmid">24781323</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kryazhimskiy</surname><given-names>S</given-names></name><name><surname>Rice</surname><given-names>DP</given-names></name><name><surname>Jerison</surname><given-names>ER</given-names></name><name><surname>Desai</surname><given-names>MM</given-names></name><name><surname>evolution</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Microbial evolution. Global epistasis makes adaptation predictable despite sequence-level stochasticity</article-title><source>Science</source><volume>344</volume><fpage>1519</fpage><lpage>1522</lpage><pub-id pub-id-type="doi">10.1126/science.1250939</pub-id><pub-id pub-id-type="pmid">24970088</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>JM</given-names></name><name><surname>Huddleston</surname><given-names>J</given-names></name><name><surname>Doud</surname><given-names>MB</given-names></name><name><surname>Hooper</surname><given-names>KA</given-names></name><name><surname>Wu</surname><given-names>NC</given-names></name><name><surname>Bedford</surname><given-names>T</given-names></name><name><surname>Bloom</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Deep mutational scanning of hemagglutinin helps predict evolutionary fates of human H3N2 influenza variants</article-title><source>PNAS</source><volume>115</volume><fpage>E8276</fpage><lpage>E8285</lpage><pub-id pub-id-type="doi">10.1073/pnas.1806133115</pub-id><pub-id pub-id-type="pmid">30104379</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lindsey</surname><given-names>HA</given-names></name><name><surname>Gallie</surname><given-names>J</given-names></name><name><surname>Taylor</surname><given-names>S</given-names></name><name><surname>Kerr</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Evolutionary rescue from extinction is contingent on a lower rate of environmental change</article-title><source>Nature</source><volume>494</volume><fpage>463</fpage><lpage>467</lpage><pub-id pub-id-type="doi">10.1038/nature11879</pub-id><pub-id pub-id-type="pmid">23395960</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>MacLean</surname><given-names>RC</given-names></name><name><surname>Perron</surname><given-names>GG</given-names></name><name><surname>Gardner</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Diminishing returns from beneficial mutations and pervasive epistasis shape the fitness landscape for rifampicin resistance in <italic>Pseudomonas aeruginosa</italic></article-title><source>Genetics</source><volume>186</volume><fpage>1345</fpage><lpage>1354</lpage><pub-id pub-id-type="doi">10.1534/genetics.110.123083</pub-id><pub-id pub-id-type="pmid">20876562</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maddamsetti</surname><given-names>R</given-names></name><name><surname>Johnson</surname><given-names>DT</given-names></name><name><surname>Spielman</surname><given-names>SJ</given-names></name><name><surname>Petrie</surname><given-names>KL</given-names></name><name><surname>Marks</surname><given-names>DS</given-names></name><name><surname>Meyer</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Gain‐of‐function experiments with bacteriophage lambda uncover residues under diversifying selection in nature</article-title><source>Evolution</source><volume>72</volume><fpage>2234</fpage><lpage>2243</lpage><pub-id pub-id-type="doi">10.1111/evo.13586</pub-id><pub-id pub-id-type="pmid">30152871</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Merrell</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="1994">1994</year><source>The Adaptive Seascape: The Mechanism of Evolution</source><publisher-name>University of Minnesota Press</publisher-name></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meyer</surname><given-names>JR</given-names></name><name><surname>Dobias</surname><given-names>DT</given-names></name><name><surname>Weitz</surname><given-names>JS</given-names></name><name><surname>Barrick</surname><given-names>JE</given-names></name><name><surname>Quick</surname><given-names>RT</given-names></name><name><surname>Lenski</surname><given-names>RE</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Repeatability and Contingency in the Evolution of a Key Innovation in Phage Lambda</article-title><source>Science</source><volume>335</volume><fpage>428</fpage><lpage>432</lpage><pub-id pub-id-type="doi">10.1126/science.1214449</pub-id><pub-id pub-id-type="pmid">22282803</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meyer</surname><given-names>JR</given-names></name><name><surname>Gudelj</surname><given-names>I</given-names></name><name><surname>Beardmore</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Biophysical mechanisms that maintain biodiversity through trade-offs</article-title><source>Nature Communications</source><volume>6</volume><elocation-id>6278</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms7278</pub-id><pub-id pub-id-type="pmid">25695944</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meyer</surname><given-names>JR</given-names></name><name><surname>Dobias</surname><given-names>DT</given-names></name><name><surname>Medina</surname><given-names>SJ</given-names></name><name><surname>Servilio</surname><given-names>L</given-names></name><name><surname>Gupta</surname><given-names>A</given-names></name><name><surname>Lenski</surname><given-names>RE</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Ecological speciation of bacteriophage lambda in allopatry and sympatry</article-title><source>Science</source><volume>354</volume><fpage>1301</fpage><lpage>1304</lpage><pub-id pub-id-type="doi">10.1126/science.aai8446</pub-id><pub-id pub-id-type="pmid">27884940</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Nahum</surname><given-names>JR</given-names></name><name><surname>West</surname><given-names>J</given-names></name><name><surname>Althouse</surname><given-names>BM</given-names></name><name><surname>Zaman</surname><given-names>L</given-names></name><name><surname>Ofria</surname><given-names>C</given-names></name><name><surname>Kerr</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Improved adaptation in exogenously and endogenously changing environments</article-title><conf-name>Proceedings of the 14th European Conference on Artificial Life ECAL 2017</conf-name><fpage>306</fpage><lpage>313</lpage><pub-id pub-id-type="doi">10.7551/ecal_a_052</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ogbunugafor</surname><given-names>CB</given-names></name><name><surname>Wylie</surname><given-names>CS</given-names></name><name><surname>Diakite</surname><given-names>I</given-names></name><name><surname>Weinreich</surname><given-names>DM</given-names></name><name><surname>Hartl</surname><given-names>DL</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Adaptive Landscape by Environment Interactions Dictate Evolutionary Dynamics in Models of Drug Resistance</article-title><source>PLOS Computational Biology</source><volume>12</volume><elocation-id>e1004710</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004710</pub-id><pub-id pub-id-type="pmid">26808374</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orr</surname><given-names>HA</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>The genetic theory of adaptation: a brief history</article-title><source>Nature Reviews. Genetics</source><volume>6</volume><fpage>119</fpage><lpage>127</lpage><pub-id pub-id-type="doi">10.1038/nrg1523</pub-id><pub-id pub-id-type="pmid">15716908</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Palmer</surname><given-names>AC</given-names></name><name><surname>Toprak</surname><given-names>E</given-names></name><name><surname>Baym</surname><given-names>M</given-names></name><name><surname>Kim</surname><given-names>S</given-names></name><name><surname>Veres</surname><given-names>A</given-names></name><name><surname>Bershtein</surname><given-names>S</given-names></name><name><surname>Kishony</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Delayed commitment to evolutionary fate in antibiotic resistance fitness landscapes</article-title><source>Nature Communications</source><volume>6</volume><elocation-id>7385</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms8385</pub-id><pub-id pub-id-type="pmid">26060115</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paterson</surname><given-names>S</given-names></name><name><surname>Vogwill</surname><given-names>T</given-names></name><name><surname>Buckling</surname><given-names>A</given-names></name><name><surname>Benmayor</surname><given-names>R</given-names></name><name><surname>Spiers</surname><given-names>AJ</given-names></name><name><surname>Thomson</surname><given-names>NR</given-names></name><name><surname>Quail</surname><given-names>M</given-names></name><name><surname>Smith</surname><given-names>F</given-names></name><name><surname>Walker</surname><given-names>D</given-names></name><name><surname>Libberton</surname><given-names>B</given-names></name><name><surname>Fenton</surname><given-names>A</given-names></name><name><surname>Hall</surname><given-names>N</given-names></name><name><surname>Brockhurst</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Antagonistic coevolution accelerates molecular evolution</article-title><source>Nature</source><volume>464</volume><fpage>275</fpage><lpage>278</lpage><pub-id pub-id-type="doi">10.1038/nature08798</pub-id><pub-id pub-id-type="pmid">20182425</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Petrie</surname><given-names>KL</given-names></name><name><surname>Palmer</surname><given-names>ND</given-names></name><name><surname>Johnson</surname><given-names>DT</given-names></name><name><surname>Medina</surname><given-names>SJ</given-names></name><name><surname>Yan</surname><given-names>SJ</given-names></name><name><surname>Li</surname><given-names>V</given-names></name><name><surname>Burmeister</surname><given-names>AR</given-names></name><name><surname>Meyer</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Destabilizing mutations encode nongenetic variation that drives evolutionary innovation</article-title><source>Science</source><volume>359</volume><fpage>1542</fpage><lpage>1545</lpage><pub-id pub-id-type="doi">10.1126/science.aar1954</pub-id><pub-id pub-id-type="pmid">29599247</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Pigliucci</surname><given-names>M</given-names></name><name><surname>Müller</surname><given-names>GB</given-names></name></person-group><year iso-8601-date="2010">2010</year><source>Evolution—the Extended Synthesis High-Dimensional Fitness Landscapes and Speciation</source><publisher-name>MIT Press</publisher-name><pub-id pub-id-type="doi">10.7551/mitpress/9780262513678.001.0001</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="software"><person-group person-group-type="author"><collab>R Development Core Team</collab></person-group><year iso-8601-date="2019">2019</year><data-title>R: A Language and Environment for Statistical Computing</data-title><publisher-loc>Vienna, Austria</publisher-loc><publisher-name>R Foundation for Statistical Computing</publisher-name><ext-link ext-link-type="uri" xlink:href="http://www.r-project.org">http://www.r-project.org</ext-link></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Russ</surname><given-names>D</given-names></name><name><surname>Glaser</surname><given-names>F</given-names></name><name><surname>Shaer Tamar</surname><given-names>E</given-names></name><name><surname>Yelin</surname><given-names>I</given-names></name><name><surname>Baym</surname><given-names>M</given-names></name><name><surname>Kelsic</surname><given-names>ED</given-names></name><name><surname>Zampaloni</surname><given-names>C</given-names></name><name><surname>Haldimann</surname><given-names>A</given-names></name><name><surname>Kishony</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Escape mutations circumvent a tradeoff between resistance to a beta-lactam and resistance to a beta-lactamase inhibitor</article-title><source>Nature Communications</source><volume>11</volume><elocation-id>15666</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-020-15666-2</pub-id><pub-id pub-id-type="pmid">32332717</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sambrook</surname><given-names>J</given-names></name><name><surname>Russell</surname><given-names>DW</given-names></name></person-group><year iso-8601-date="2001">2001</year><source>Molecular Cloning: A Laboratory Manual</source><publisher-name>Cold Spring Harbor Laboratory Press</publisher-name></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shao</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>IN</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Bacteriophage adsorption rate and optimal lysis time</article-title><source>Genetics</source><volume>180</volume><fpage>471</fpage><lpage>482</lpage><pub-id pub-id-type="doi">10.1534/genetics.108.090100</pub-id><pub-id pub-id-type="pmid">18757924</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shuman</surname><given-names>HA</given-names></name><name><surname>Silhavy</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>The art and design of genetic screens: <italic>Escherichia coli</italic></article-title><source>Nature Reviews. Genetics</source><volume>4</volume><fpage>419</fpage><lpage>431</lpage><pub-id pub-id-type="doi">10.1038/nrg1087</pub-id><pub-id pub-id-type="pmid">12776212</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steinberg</surname><given-names>B</given-names></name><name><surname>Ostermeier</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Environmental changes bridge evolutionary valleys</article-title><source>Science Advances</source><volume>2</volume><elocation-id>e1500921</elocation-id><pub-id pub-id-type="doi">10.1126/sciadv.1500921</pub-id><pub-id pub-id-type="pmid">26844293</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thompson</surname><given-names>JN</given-names></name><name><surname>Cunningham</surname><given-names>BM</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Geographic structure and dynamics of coevolutionary selection</article-title><source>Nature</source><volume>417</volume><fpage>735</fpage><lpage>738</lpage><pub-id pub-id-type="doi">10.1038/nature00810</pub-id><pub-id pub-id-type="pmid">12066183</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Thompson</surname><given-names>JN</given-names></name></person-group><year iso-8601-date="2005">2005</year><source>The Geographic Mosaic of Coevolution, Interspecific Interactions</source><publisher-loc>Chicago, Illinois</publisher-loc><publisher-name>University of Chicago Press</publisher-name></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thompson</surname><given-names>JN</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The Role of Coevolution</article-title><source>Science</source><volume>335</volume><fpage>410</fpage><lpage>411</lpage><pub-id pub-id-type="doi">10.1126/science.1217807</pub-id><pub-id pub-id-type="pmid">22282796</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Valen</surname><given-names>LV</given-names></name></person-group><year iso-8601-date="1973">1973</year><article-title>A new evolutionary law</article-title><source>Evolutionary Theory</source><volume>1</volume><fpage>1</fpage><lpage>30</lpage></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>HH</given-names></name><name><surname>Isaacs</surname><given-names>FJ</given-names></name><name><surname>Carr</surname><given-names>PA</given-names></name><name><surname>Sun</surname><given-names>ZZ</given-names></name><name><surname>Xu</surname><given-names>G</given-names></name><name><surname>Forest</surname><given-names>CR</given-names></name><name><surname>Church</surname><given-names>GM</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Programming cells by multiplex genome engineering and accelerated evolution</article-title><source>Nature</source><volume>460</volume><fpage>894</fpage><lpage>898</lpage><pub-id pub-id-type="doi">10.1038/nature08187</pub-id><pub-id pub-id-type="pmid">19633652</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weinreich</surname><given-names>DM</given-names></name><name><surname>Delaney</surname><given-names>NF</given-names></name><name><surname>Depristo</surname><given-names>MA</given-names></name><name><surname>Hartl</surname><given-names>DL</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Darwinian evolution can follow only very few mutational paths to fitter proteins</article-title><source>Science</source><volume>312</volume><fpage>111</fpage><lpage>114</lpage><pub-id pub-id-type="doi">10.1126/science.1123539</pub-id><pub-id pub-id-type="pmid">16601193</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Wright</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1932">1932</year><source>The Roles of Mutation, Inbreeding, Crossbreeding, and Selection in Evolution</source><publisher-name>University of chicago</publisher-name></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zaman</surname><given-names>L</given-names></name><name><surname>Meyer</surname><given-names>JR</given-names></name><name><surname>Devangam</surname><given-names>S</given-names></name><name><surname>Bryson</surname><given-names>DM</given-names></name><name><surname>Lenski</surname><given-names>RE</given-names></name><name><surname>Ofria</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Coevolution drives the emergence of complex traits and promotes evolvability</article-title><source>PLOS Biology</source><volume>12</volume><elocation-id>e1002023</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1002023</pub-id><pub-id pub-id-type="pmid">25514332</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec sec-type="appendix" id="s8"><title>Fitness effect of synonymous mutations used as watermarks in MAGE</title><p>We designed two watermark mutations for each focal mutation. Watermark mutations are synonymous mutations that fall within a few nucleotides of the focal mutation. These edits improved our ability to detect the presence of focal mutations within the MAGE library (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1i</xref>). In principle, these watermark mutations should not affect the fitness of λ because the introduced mutations do not change the amino acids. However, we designed two different watermarks in order to test whether or not they influence λ fitness. To test for fitness effects of the synonymous mutations, we evaluated the fitness of genotypes with just a single focal mutation, and then we split the count data from the competition experiments into two, one for watermark ‘1’ and a second pool for ‘2’. We calculated the fitness of each group and compared their means using a <italic>t</italic>-test. The analysis was limited to just fitness measurements made for the treatment with the ancestral host because the single mutants did poorly on <italic>malT<sup>—</sup></italic> host and many dropped below our limit of detection during the competitions. We were also only able to run the analysis on 7 out of 10 mutations because in three cases only one watermark was represented in the final counts data. We found that the fitness did not depend on the neutral marker for all seven using a Bonferroni corrected alpha value of 0.0071 (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1l</xref>). However, one of the seven was significant based on the uncorrected alpha value of 0.05. The effect on the selection rate was estimated to be 0.9947 with 95% confidence interval of 0.4758–1.5136. This value falls well within the error associated with fitness estimates (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>). Because of our uncertainty of whether there was an effect of this synonymous mutation, and because the effect falls within normal levels of error, we did not take steps to correct for this possible effect.</p></sec></app><app id="appendix-2"><title>Appendix 2</title><sec sec-type="appendix" id="s9"><title>Simulation results when only using genotypes present in both the ancestral and <italic>malT</italic><sup>–</sup> fitness landscapes</title><p>One possible complication with the fitness landscape analyses is that the <italic>malT</italic><sup>–</sup> landscape is based on a subset of the ancestral landscape (131 vs 580 out of 1,024 possible genotypes). This could lead to potentially spurious comparisons of evolution on the two hosts. To control for this, we re-ran the simulations starting with only the genotypes that were present in both the landscapes. While the frequencies of OmpF<sup>+</sup> populations did shift with this new analysis, the main result that switching landscapes enhances the frequency of OmpF<sup>+</sup> evolution remained statistically significant (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2d</xref>). The increased frequency in ancestor-only treatment stems from the increased stochasticity in estimating the landscape since more genotypes are imputed in panel d than a-c. This stochasticity leads to more OmpF<sup>+</sup> evolution because the increased randomness in landscape formation increases the chances of producing viable pathways to OmpF use. Interestingly, the ancestral landscape OmpF<sup>+</sup> frequency is equivalent to <italic>malT</italic><sup>–</sup> in panel d. This similarity suggests that the frequency of OmpF evolution for <italic>malT</italic><sup>–</sup> may be artificially high, which would mean that in reality there may be greater differences between this treatment and the fluctuating treatments.</p></sec><sec sec-type="appendix" id="s10"><title>Simulation results when shifting is done between landscapes of the same host</title><p>Each time we impute fitness values of missing genotypes in a simulation run, a slightly different landscape is produced. This procedure raises the question of whether the increased frequency of OmpF<sup>+</sup> in the shifting landscape simulations is due to structural differences between the two landscapes, or the random differences created by the imputation technique. To test this, we repeated simulations as previously discussed; however, this time we shifted to a newly generated landscape created from the same host-landscape data. OmpF<sup>+</sup> did <italic>not</italic> evolve when the shift was made between two ancestral landscapes. λ did evolve OmpF function in some replicates when the switching was made between two <italic>malT<sup>—</sup></italic> landscapes; however, the frequency was significantly less than when the shift was made from ancestor to <italic>malT<sup>—</sup></italic> (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2e and f</xref>). Lastly, to control for the sparser landscape of <italic>malT<sup>—</sup></italic> compared with the ancestor, we shifted between two ancestral host landscapes that were generated using only fitness values of genotypes present in both landscapes. We found the same qualitative result as for the <italic>malT<sup>—</sup></italic> to <italic>malT<sup>—</sup></italic> landscape shift (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2g and h</xref>). These results show that the structural differences between the two host landscapes encourage OmpF<sup>+</sup> evolution above and beyond what results from the noise associated with the imputation procedure.</p></sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.76162.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Ogbunugafor</surname><given-names>C Brandon</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03v76x132</institution-id><institution>Yale University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><related-object id="sa0ro1" object-id-type="id" object-id="10.1101/2021.06.25.449783" link-type="continued-by" xlink:href="https://sciety.org/articles/activity/10.1101/2021.06.25.449783"/></front-stub><body><p>This study uses the parlance and framing of the fitness landscape to articulate a co-evolution story between host and parasite. It utilizes a tractable system, bacteriophage λ and <italic>E. coli</italic>, to ask questions that unite different pillars of evolutionary theory – evolutionary genetics (via the fitness landscape analogy), co-evolution, and host-parasite interactions. The findings will be relevant to a number of audiences, and will likely spawn downstream studies that further interrogate the molecular specifics that underlie host-parasite co-evolution.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.76162.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Ogbunugafor</surname><given-names>C Brandon</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03v76x132</institution-id><institution>Yale University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Barr</surname><given-names>Jeremy</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02bfwt286</institution-id><institution>Monash University</institution></institution-wrap><country>Australia</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2021.06.25.449783">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2021.06.25.449783v1">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Host-parasite coevolution promotes innovation through deformations in fitness landscapes&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 2 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Aleksandra Walczak as the Senior Editor. The following individuals involved in the review of your submission have agreed to reveal their identity: Nkrumah Grant (Reviewer #1), Jeremy Barr (Reviewer #2).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>1) Please pay close attention to comments from reviewers with respect to the choice of study sub-population (why did the authors choose population D7 from Meyer et al. 2012 )?</p><p>2) Other stylistic and communication-based considerations as described by the reviewers. Some involve figure clarity. Also, please consider comments made with respect to items that are in the supplemental material.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>1. Overall the manuscript is written well, but it could use some soft editing.</p><p>2. Consider making the color scheme of the simulations and biological data different. For example, figure 2 shows simulation data in blue and yellow, whereas biological data is shown in figures, 3 (panels B and C) and 4.</p><p>3. Please clarify why you chose population D7 from Meyer et al. 2012 to analyze further. Why only one population? How generalizable are your results?</p><p>4. It would be extremely beneficial to readers if the figures describing your methods were expanded upon (add figure showing MAGE-seq and input/outputs of simulations).</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>• I recommend including and potentially reworking supplemental figure 1 into the main text to provide a visual overview of the experimental system and also encourage the authors to visually recreate the λ co-evolutionary mechanisms explained in text in lines 41-47 on pg2. This would help with the readability of the manuscript, especially for readers not familiar with this model system.</p><p>• Similarly, the abstract appears intentionally vague and perhaps too broad at times. The authors could attempt to rework this to more clearly explain the co-evolutionary mechanisms that were seen in the study.</p><p>• I don't understand the rationale for numbering the supplemental figures in the way the authors have done so. Having sub-supplemental figures for each main figure is not logical and I recommend simply labeling supplemental figures in order of appearance in the main text.</p><p>• I really enjoyed the experimental design and approach to disentangling these co-evolutionary dynamics. This is more a comment rather than something to be addressed, but the phylogenetic reconstruction of λ genotypes in Figure 3A shows the emergence of A**C and ABC genotypes from a similar genetic background. How likely do the authors think that the C genotype emergence twice simultaneously and have they instead considered recombination playing a role?</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.76162.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) Please pay close attention to comments from reviewers with respect to the choice of study sub-population (why did the authors choose population D7 from Meyer et al. 2012 )?</p></disp-quote><p>We have added the sentences: ‘Population ‘D7’ was chosen because λ evolved relatively few mutations in this population. We believed this choice was conservative and constitutes a strong test of our hypothesis since fewer λ mutations would provide fewer opportunities to detect host-induced contingency.’</p><disp-quote content-type="editor-comment"><p>2) Other stylistic and communication-based considerations as described by the reviewers. Some involve figure clarity. Also, please consider comments made with respect to items that are in the supplemental material.</p></disp-quote><p>We have followed the advice of the reviewers and made many stylistic changes. These are described in our response to the reviewers.</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>1. Overall the manuscript is written well, but it could use some soft editing.</p></disp-quote><p>We thank the reviewer for their comment and suggestion. We have re-read the entire manuscript and made minor edits at 17 different places. None of these changes altered the content of the manuscript.</p><disp-quote content-type="editor-comment"><p>2. Consider making the color scheme of the simulations and biological data different. For example, figure 2 shows simulation data in blue and yellow, whereas biological data is shown in figures, 3 (panels B and C) and 4.</p></disp-quote><p>We carefully considered this suggestion; however, we chose to leave the color scheme as-is. The color scheme contrasts the two hosts and we wanted to keep it consistent throughout the manuscript. We have modified the y-axis label in figure 2 to make it clearer that the results are from computer simulations by adding ‘(<italic>in silico</italic>)’. We also change the figure caption’s first sentence to emphasize that the results stem from simulations. ‘Simulation results of the frequency of OmpF-use evolution observed when fitness landscapes were shifted at different frequencies.’</p><disp-quote content-type="editor-comment"><p>3. Please clarify why you chose population D7 from Meyer et al. 2012 to analyze further. Why only one population? How generalizable are your results?</p></disp-quote><p>We have added the sentences: ‘D7 was chosen because λ evolved relatively few mutations in this population. We believed this choice was conservative and constitutes a strong test of our hypothesis since fewer λ mutations would provide fewer opportunities to detect host-induced contingency.’</p><p>These results are generalizable given that they align with the fitness landscape simulations where we used J mutations evolved in tens of independent λ populations. They were also in line with results from the replay experiments where replicate λ populations were free to evolve any mutations – not just the ones evolved in D7 – and they showed no capacity to innovate when cocultured with <italic>malT</italic><sup>–</sup> hosts.</p><disp-quote content-type="editor-comment"><p>4. It would be extremely beneficial to readers if the figures describing your methods were expanded upon (add figure showing MAGE-seq and input/outputs of simulations).</p></disp-quote><p>Thank you for this recommendation. We have added a new figure (Figure 2—figure supplement 1) to describe the simulations and we have edited the figure supplement 1 of Figure 1 to provide a more detailed schematic illustration of MAGE-Seq to the reader.</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>• I recommend including and potentially reworking supplemental figure 1 into the main text to provide a visual overview of the experimental system and also encourage the authors to visually recreate the λ co-evolutionary mechanisms explained in text in lines 41-47 on pg2. This would help with the readability of the manuscript, especially for readers not familiar with this model system.</p></disp-quote><p>We have incorporated the suggestion by adding a new figure in the Discussion section (new Figure 5) that shows both the previous model of coevolution and our new understanding of it after this study. We believe this will greatly help the readers who are not familiar with this coevolutionary model system. We also considered moving supplemental figure 1 to the main text but decided not to out of our own stylistic preference. We would like to note that <italic>eLife</italic> online publication makes it very easy to see figures, as they and all the supplements are well-linked with pop-open views embedded within the main text.</p><disp-quote content-type="editor-comment"><p>• Similarly, the abstract appears intentionally vague and perhaps too broad at times. The authors could attempt to rework this to more clearly explain the co-evolutionary mechanisms that were seen in the study.</p></disp-quote><p>We rewrote the second half of the abstract to be more specific.</p><p>“During the struggle for survival, populations occasionally evolve new functions that give them access to untapped ecological opportunities. Theory suggests that coevolution between species can promote the evolution of such innovations by deforming fitness landscapes in ways that open new adaptive pathways. We directly tested this idea by using high throughput gene editing-phenotyping technology (MAGE-Seq) to measure the fitness landscape of a virus, bacteriophage λ, as it coevolved with its host, the bacterium <italic>Escherichia coli</italic>. Analyses of the empirical fitness landscape revealed mutation-by-mutation-by-host-genotype interactions that prove coevolution modified the contours of λ’s landscape. Computer simulations of λ’s evolution on a static versus shifting fitness landscape showed that the changes in contours increased λ’s chances of evolving the ability to use a new host receptor. By coupling sequencing and pairwise competition experiments, we demonstrated that the first mutation λ evolved enroute to the innovation would only evolve in the presence of the ancestral host, whereas later steps in λ’s evolution required the shift to a resistant host. When time-shift replays of the coevolution experiment were run where host evolution was artificially accelerated, λ did not innovate to use the new receptor. This study provides direct evidence for the role of coevolution in driving evolutionary novelty and provides a quantitative framework for predicting evolution in coevolving ecological communities.”</p><disp-quote content-type="editor-comment"><p>• I don't understand the rationale for numbering the supplemental figures in the way the authors have done so. Having sub-supplemental figures for each main figure is not logical and I recommend simply labeling supplemental figures in order of appearance in the main text.</p></disp-quote><p>This is an <italic>eLife</italic> formatting specification. The first version of the manuscript we submitted had supplemental figures in the more traditional format, but we were asked by the editorial office to re-submit the manuscript in the current form.</p><disp-quote content-type="editor-comment"><p>• I really enjoyed the experimental design and approach to disentangling these co-evolutionary dynamics. This is more a comment rather than something to be addressed, but the phylogenetic reconstruction of λ genotypes in Figure 3A shows the emergence of A**C and ABC genotypes from a similar genetic background. How likely do the authors think that the C genotype emergence twice simultaneously and have they instead considered recombination playing a role?</p></disp-quote><p>We have speculated about the source of C too and we do not have an answer. Some thoughts: We have observed a striking level of parallel evolution between populations separated in different flasks, so it’s possible that C arose multiple times within the same population. However, λ has an active homologous recombination system and we have observed recombination in these studies between the phage and host-encoded phage genes (Borin et al. PNAS 2021), so it could happen. The MOI of these studies is low – fewer phage than bacteria – so that would suggest there’s little opportunity for coinfection and recombination.</p></body></sub-article></article>