<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">79908</article-id><article-id pub-id-type="doi">10.7554/eLife.79908</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Evolution of neural activity in circuits bridging sensory and abstract knowledge</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-268859"><name><surname>Mastrogiuseppe</surname><given-names>Francesca</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7682-5178</contrib-id><email>fran.mastrogiuseppe@gmail.com</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="pa1">†</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-150958"><name><surname>Hiratani</surname><given-names>Naoki</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-8568-2033</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-6945"><name><surname>Latham</surname><given-names>Peter</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8713-9328</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf3"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02jx3x895</institution-id><institution>Gatsby Computational Neuroscience Unit, University College London</institution></institution-wrap><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03vek6s52</institution-id><institution>Center for Brain Science, Harvard University</institution></institution-wrap><addr-line><named-content content-type="city">Harvard</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Richards</surname><given-names>Blake A</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01pxwe438</institution-id><institution>McGill University</institution></institution-wrap><country>Canada</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Gold</surname><given-names>Joshua I</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00b30xv10</institution-id><institution>University of Pennsylvania</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="present-address" id="pa1"><label>†</label><p>Champalimaud Research, Lisbon, Portugal</p></fn></author-notes><pub-date publication-format="electronic" date-type="publication"><day>07</day><month>03</month><year>2023</year></pub-date><pub-date pub-type="collection"><year>2023</year></pub-date><volume>12</volume><elocation-id>e79908</elocation-id><history><date date-type="received" iso-8601-date="2022-05-02"><day>02</day><month>05</month><year>2022</year></date><date date-type="accepted" iso-8601-date="2023-01-06"><day>06</day><month>01</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at bioRxiv.</event-desc><date date-type="preprint" iso-8601-date="2022-01-30"><day>30</day><month>01</month><year>2022</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.01.29.478317"/></event></pub-history><permissions><copyright-statement>© 2023, Mastrogiuseppe et al</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Mastrogiuseppe et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-79908-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-79908-figures-v1.pdf"/><abstract><p>The ability to associate sensory stimuli with abstract classes is critical for survival. How are these associations implemented in brain circuits? And what governs how neural activity evolves during abstract knowledge acquisition? To investigate these questions, we consider a circuit model that learns to map sensory input to abstract classes via gradient-descent synaptic plasticity. We focus on typical neuroscience tasks (simple, and context-dependent, categorization), and study how both synaptic connectivity and neural activity evolve during learning. To make contact with the current generation of experiments, we analyze activity via standard measures such as selectivity, correlations, and tuning symmetry. We find that the model is able to recapitulate experimental observations, including seemingly disparate ones. We determine how, in the model, the behaviour of these measures depends on details of the circuit and the task. These dependencies make experimentally testable predictions about the circuitry supporting abstract knowledge acquisition in the brain.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>learning</kwd><kwd>neural networks</kwd><kwd>plasticity</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000324</institution-id><institution>Gatsby Charitable Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Mastrogiuseppe</surname><given-names>Francesca</given-names></name><name><surname>Hiratani</surname><given-names>Naoki</given-names></name><name><surname>Latham</surname><given-names>Peter</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004440</institution-id><institution>Wellcome Trust</institution></institution-wrap></funding-source><award-id>110114/Z/15/Z</award-id><principal-award-recipient><name><surname>Mastrogiuseppe</surname><given-names>Francesca</given-names></name><name><surname>Latham</surname><given-names>Peter</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection, and interpretation, or the decision to submit the work for publication. For the purpose of Open Access, the authors have applied a CC BY public copyright license to any Author Accepted Manuscript version arising from this submission.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Gradient-descent synaptic plasticity applied to neuroscience categorization tasks captures the behaviour of common neural activity measures (category and context selectivity, correlation, asymmetry) reported in experiments, and makes novel experimental predictions.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Everyday decisions do not depend on the state of the world alone; they also depend on internal, non-sensory variables that are acquired with experience. For instance, over time we learn that in most situations salads are good for us while burgers are not, while in other contexts (e.g., before a long hike in the mountains) the opposite is true. The ability to associate sensory stimuli with abstract variables is critical for survival; how these associations are learned is, however, poorly understood.</p><p>Although we do not know how associations are learned, we do have access to a large number of experimental studies addressing how neural activity evolves while animals learn to classify stimuli into abstract categories (<xref ref-type="bibr" rid="bib3">Asaad et al., 1998</xref>; <xref ref-type="bibr" rid="bib48">Messinger et al., 2001</xref>; <xref ref-type="bibr" rid="bib21">Freedman et al., 2001</xref>; <xref ref-type="bibr" rid="bib22">Freedman and Assad, 2006</xref>; <xref ref-type="bibr" rid="bib56">Reinert et al., 2021</xref>). Such experiments have probed two kinds of associations between stimuli and categories: fixed associations (<xref ref-type="bibr" rid="bib22">Freedman and Assad, 2006</xref>; <xref ref-type="bibr" rid="bib18">Fitzgerald et al., 2011</xref>; <xref ref-type="bibr" rid="bib13">Cromer et al., 2010</xref>) (in which, e.g., stimuli are either in category A or in category B), and flexible ones (<xref ref-type="bibr" rid="bib70">Wallis et al., 2001</xref>; <xref ref-type="bibr" rid="bib66">Stoet and Snyder, 2004</xref>; <xref ref-type="bibr" rid="bib60">Roy et al., 2010</xref>; <xref ref-type="bibr" rid="bib56">Reinert et al., 2021</xref>) (in which, e.g., stimuli are in category A in one context and category B in another).</p><p>A consistent finding in these experiments is that activity of single neurons in associative cortex develops selectivity to task-relevant abstract variables, such as category (<xref ref-type="bibr" rid="bib21">Freedman et al., 2001</xref>; <xref ref-type="bibr" rid="bib18">Fitzgerald et al., 2011</xref>; <xref ref-type="bibr" rid="bib56">Reinert et al., 2021</xref>) and context (<xref ref-type="bibr" rid="bib71">White and Wise, 1999</xref>; <xref ref-type="bibr" rid="bib70">Wallis et al., 2001</xref>; <xref ref-type="bibr" rid="bib66">Stoet and Snyder, 2004</xref>). Neurons, however, typically display selectivity to multiple abstract variables (<xref ref-type="bibr" rid="bib58">Rigotti et al., 2013</xref>), and those patterns of mixed selectivity are often hard to intepret (<xref ref-type="bibr" rid="bib13">Cromer et al., 2010</xref>; <xref ref-type="bibr" rid="bib60">Roy et al., 2010</xref>; <xref ref-type="bibr" rid="bib29">Hirokawa et al., 2019</xref>).</p><p>Instead of focussing on one neuron at the time, one can alternatively consider large populations of neurons and quantify how those, as a whole, encode abstract variables. This approach has led, so far, to apparently disparate observations. Classical work indicates that neurons in visual cortex encode simple sensory variables (e.g., two opposite orientations) via negatively correlated responses (<xref ref-type="bibr" rid="bib32">Hubel and Wiesel, 1962</xref>; <xref ref-type="bibr" rid="bib51">Olshausen and Field, 2004</xref>): neurons that respond strongly to a given variable respond weakly to the other one, and vice versa. Those responses, furthermore, are symmetric (<xref ref-type="bibr" rid="bib14">DeAngelis and Uka, 2003</xref>): about the same number of neurons respond strongly to one variable, or the other. In analogy with sensory cortex, one can thus hypothesize that neurons in associative cortex encode different abstract variables (e.g., categories A and B) via negatively correlated, and symmetric responses. Evidence in favour of this type of responses has been reported in monkeys (<xref ref-type="bibr" rid="bib71">White and Wise, 1999</xref>; <xref ref-type="bibr" rid="bib13">Cromer et al., 2010</xref>; <xref ref-type="bibr" rid="bib60">Roy et al., 2010</xref>; <xref ref-type="bibr" rid="bib23">Freedman and Miller, 2008</xref>) and mice (<xref ref-type="bibr" rid="bib56">Reinert et al., 2021</xref>) prefrontal cortex (PFC). However, evidence in favour of a different type of responses has been reported in a different set of experiments from monkeys lateral intraparietal (LIP) cortex (<xref ref-type="bibr" rid="bib19">Fitzgerald et al., 2013</xref>). In that case, responses to categories A and B were found to be positively correlated: neurons that learn to respond strongly to category A also respond strongly to category B, and neurons that learn to respond weakly to category A also respond weakly to category B. Furthermore, responses were strongly asymmetric: almost all neurons displayed the strongest response to the same category (despite monkeys did not display behavioural biases towards one category or the other).</p><p>In this work, we use neural circuit models to shed light on these experimental results. To this end, we hypothesize that synaptic connectivity in neural circuits evolves by implementing gradient descent on an error function (<xref ref-type="bibr" rid="bib57">Richards et al., 2019</xref>). A large body of work has demonstrated that, under gradient-descent plasticity, neural networks can achieve high performance on both simple and complex tasks (<xref ref-type="bibr" rid="bib37">LeCun et al., 2015</xref>). Recent studies have furthermore shown that gradient-descent learning can be implemented, at least approximately, in a biologically plausible way (<xref ref-type="bibr" rid="bib40">Lillicrap et al., 2016</xref>; <xref ref-type="bibr" rid="bib72">Whittington and Bogacz, 2017</xref>; <xref ref-type="bibr" rid="bib61">Sacramento et al., 2018</xref>; <xref ref-type="bibr" rid="bib1">Akrout et al., 2019</xref>; <xref ref-type="bibr" rid="bib54">Payeur et al., 2021</xref>; <xref ref-type="bibr" rid="bib55">Pogodin and Latham, 2020</xref>; <xref ref-type="bibr" rid="bib7">Boopathy and Fiete, 2022</xref>). Concomitantly, gradient-based learning has been used to construct network models for a variety of brain regions and functions (<xref ref-type="bibr" rid="bib74">Yamins and DiCarlo, 2016</xref>; <xref ref-type="bibr" rid="bib35">Kell et al., 2018</xref>; <xref ref-type="bibr" rid="bib43">Mante et al., 2013</xref>; <xref ref-type="bibr" rid="bib11">Chaisangmongkon et al., 2017</xref>). A precise understanding of how gradient-descent learning shapes representations in neural circuits is however still lacking.</p><p>Motivated by this hypothesis, we study a minimal circuit model that learns through gradient descent to associate sensory stimuli with abstract categories, with a focus on tasks inspired by those used in experimental studies. Via mathematical analysis and simulations, we show that the model can capture the experimental findings discussed above. In particular, after learning, neurons in the model become selective to category and, if present, context; this result is robust, and independent of the details of the circuit and the task. On the other hand, whether correlations after learning are positive or negative, and whether population tuning to different categories is asymmetric or not, is not uniquely determined, but depends on details. We determined how, in the model, activity measures are modulated by circuit details (activation function of single neurons, learning rates, initial connectivity) and task features (number of stimuli, and whether or not the associations are context dependent). These dependencies make experimentally testable predictions about the underlying circuitry. Overall, the model provides a framework for interpreting seemingly disparate experimental findings, and for making novel experimental predictions.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>We consider classification into mutually exclusive abstract classes which, as above, we refer to as categories <inline-formula><mml:math id="inf1"><mml:mi>A</mml:mi></mml:math></inline-formula> and  <inline-formula><mml:math id="inf2"><mml:mi>B</mml:mi></mml:math></inline-formula>. We consider two tasks: a simple, linearly separable one (<xref ref-type="bibr" rid="bib22">Freedman and Assad, 2006</xref>; <xref ref-type="bibr" rid="bib18">Fitzgerald et al., 2011</xref>; <xref ref-type="bibr" rid="bib13">Cromer et al., 2010</xref>) and a context-dependent, nonlinearly separable one (<xref ref-type="bibr" rid="bib70">Wallis et al., 2001</xref>; <xref ref-type="bibr" rid="bib60">Roy et al., 2010</xref>; <xref ref-type="bibr" rid="bib56">Reinert et al., 2021</xref>; <xref ref-type="fig" rid="fig1">Figure 1A</xref>). We assume that for both, categorization is implemented with a two-layer circuit, as shown in <xref ref-type="fig" rid="fig1">Figure 1B</xref>, and that the synaptic weights evolve via gradient descent. Our goal is to determine how the activity in the intermediate layer evolves with learning, and how this evolution depends on the task and the biophysical details of the circuit. We start by describing the model. We then consider circuits that learn the simple, linearly separable, categorization task, and analyze how learning drives changes in activity. Finally, we extend the analysis to the context-dependent, nonlinearly separable, task.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Schematics of tasks and circuit model used in the study.</title><p>(<bold>A</bold>) Illustration of the two categorization tasks. In the simple categorization task, half the stimuli are associated with category A and the other half with category B. In the context-dependent task, associations are reversed across contexts: stimuli associated with category A in context 1 are associated with category B in context 2, and vice versa. (<bold>B</bold>) The circuit consists of a sensory input layer (<inline-formula><mml:math id="inf3"><mml:mi mathvariant="bold-italic">x</mml:mi></mml:math></inline-formula>), an intermediate layer (<inline-formula><mml:math id="inf4"><mml:mi mathvariant="bold-italic">y</mml:mi></mml:math></inline-formula>), and a readout neuron (<inline-formula><mml:math id="inf5"><mml:mi>z</mml:mi></mml:math></inline-formula>). The intermediate (<inline-formula><mml:math id="inf6"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula>) and readout (<inline-formula><mml:math id="inf7"><mml:mi mathvariant="bold-italic">w</mml:mi></mml:math></inline-formula>) weights evolve under gradient descent plasticity (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>). (<bold>C</bold>) The activation functions, <inline-formula><mml:math id="inf8"><mml:mi mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf9"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula>, are taken to be sigmoids characterized by a threshold and a gain. The gain, which controls the sensitivity of activity to input, is the slope of the function at its steepest point; the threshold, which controls activity sparsity, is the distance from the steepest point to zero.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79908-fig1-v1.tif"/></fig><sec id="s2-1"><title>Circuit model</title><p>We consider a simple feedforward circuit as in <xref ref-type="fig" rid="fig1">Figure 1B</xref>. A vector <inline-formula><mml:math id="inf10"><mml:mi mathvariant="bold-italic">x</mml:mi></mml:math></inline-formula>, which models the input from sensory areas, is fed into an intermediate layer of neurons which represents a higher-level, associative area. The intermediate layer activity is given by <inline-formula><mml:math id="inf11"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf12"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula> is a all-to-all connectivity matrix. That activity projects to a readout neuron, which learns, over time, to predict the category associated with each sensory input. The activity of the readout neuron, <inline-formula><mml:math id="inf13"><mml:mi>z</mml:mi></mml:math></inline-formula>, is taken to be <inline-formula><mml:math id="inf14"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf15"><mml:mi mathvariant="bold-italic">w</mml:mi></mml:math></inline-formula> is a readout vector. The activation functions <inline-formula><mml:math id="inf16"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf17"><mml:mi mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula> are sigmoidals that encapsulate the response properties of single neurons; they are parametrized by a threshold and a gain (<xref ref-type="fig" rid="fig1">Figure 1C</xref>; Materials and methods Circuit).</p><p>The goal of the circuit is to adjust the synaptic weights, <inline-formula><mml:math id="inf18"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf19"><mml:mi mathvariant="bold-italic">w</mml:mi></mml:math></inline-formula>, so that the readout neuron fires at rate <inline-formula><mml:math id="inf20"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> when the sensory input is associated with category <inline-formula><mml:math id="inf21"><mml:mi>A</mml:mi></mml:math></inline-formula>, and at rate <inline-formula><mml:math id="inf22"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> when the sensory input is associated with <inline-formula><mml:math id="inf23"><mml:mi>B</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). In the simple categorization task, half the stimuli are associated with category <inline-formula><mml:math id="inf24"><mml:mi>A</mml:mi></mml:math></inline-formula> and the other half with <inline-formula><mml:math id="inf25"><mml:mi>B</mml:mi></mml:math></inline-formula>. In the context-dependent task, associations are reversed across contexts: stimuli associated with category <inline-formula><mml:math id="inf26"><mml:mi>A</mml:mi></mml:math></inline-formula> in context 1 are associated with category <inline-formula><mml:math id="inf27"><mml:mi>B</mml:mi></mml:math></inline-formula> in context 2, and vice versa (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). We use <inline-formula><mml:math id="inf28"><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">ℰ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to denote the average error between <inline-formula><mml:math id="inf29"><mml:mi>z</mml:mi></mml:math></inline-formula> and its target value, and assume that the synaptic weights evolve, via gradient descent, to minimize the error. If the learning rates are small, the weights evolve according to<disp-formula id="equ1"><label>(1a)</label><mml:math id="m1"><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi class="ltx_font_mathcaligraphic">ℰ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ2"><label>(1b)</label><mml:math id="m2"><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi class="ltx_font_mathcaligraphic">ℰ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mpadded></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf30"><mml:mi>t</mml:mi></mml:math></inline-formula> represents learning time and <inline-formula><mml:math id="inf31"><mml:msub><mml:mi>η</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf32"><mml:msub><mml:mi>η</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></inline-formula> are learning rates which, for generality, we allow to be different.</p><p>Before learning, the synaptic weights are random. Consequently, activity in the intermediate layer, <inline-formula><mml:math id="inf33"><mml:mi mathvariant="bold-italic">y</mml:mi></mml:math></inline-formula>, is unrelated to category, and depends only on sensory input. As the circuit learns to associate sensory inputs with abstract categories, task-relevant structure emerges in the connectivity matrix <inline-formula><mml:math id="inf34"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula>, and thus in the intermediate layer as well. Analyzing how activity in the intermediate layer evolves over learning is the focus of this work.</p></sec><sec id="s2-2"><title>Evolution of activity during the simple categorization task</title><p>We first analyze the simple task, for which we can derive results in a transparent and intuitive form. We then go on to show that similar (although richer) results hold for the context-dependent one.</p><p>In the simple categorization task, each sensory input vector <inline-formula><mml:math id="inf35"><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula> represents a stimulus (for example, an odor, or an image), which is associated with one of the two mutually exclusive categories <inline-formula><mml:math id="inf36"><mml:mi>A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf37"><mml:mi>B</mml:mi></mml:math></inline-formula>. In the example shown below, we used 20 stimuli, of which half are associated with category <inline-formula><mml:math id="inf38"><mml:mi>A</mml:mi></mml:math></inline-formula>, and the other half are associated with category <inline-formula><mml:math id="inf39"><mml:mi>B</mml:mi></mml:math></inline-formula>. Sensory input vectors corresponding to different stimuli are generated at random and assumed to be orthogonal to each other; orthogonality is motivated by the decorrelation performed by sensory areas (but this assumption can be dropped without qualitatively changing the main results, see Materials and methods Simple categorization task with structured inputs and heterogeneity and <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>).</p><p>We start our analysis by simulating the circuit numerically, and investigating the properties of neural activity, <inline-formula><mml:math id="inf40"><mml:mi mathvariant="bold-italic">y</mml:mi></mml:math></inline-formula>, in the intermediate layer. A common way to characterize the effects of learning on single-neuron activity is through the category selectivity index, a quantity that is positive when activity elicited by within-category stimuli is more similar than activity elicited by across-category stimuli, and negative otherwise. It is defined as (<xref ref-type="bibr" rid="bib21">Freedman et al., 2001</xref>; <xref ref-type="bibr" rid="bib22">Freedman and Assad, 2006</xref>; <xref ref-type="bibr" rid="bib56">Reinert et al., 2021</xref>) (Materials and methods Simple task: category selectivity)<disp-formula id="equ3"><label>(2)</label><mml:math id="m3"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff cat</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same cat</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff cat</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same cat</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf41"><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula> represents the activity of neuron <inline-formula><mml:math id="inf42"><mml:mi>i</mml:mi></mml:math></inline-formula> in response to sensory input <inline-formula><mml:math id="inf43"><mml:mi>s</mml:mi></mml:math></inline-formula>, and angle brackets, <inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mspace linebreak="newline"/><mml:mo>⋅</mml:mo><mml:mspace linebreak="newline"/><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, denote an average over sensory input pairs. The subscript ‘same cat’ refers to averages over the same category (A–A or B–B) and ‘diff cat’ to averages over different categories (A–B).</p><p>Before learning, the responses of single neurons to different stimuli are random and unstructured. Thus, responses to stimuli paired with category A are statistically indistinguishable from responses to stimuli paired with category B (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). This makes the category selectivity index zero on average (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). After learning, the responses of single neurons depend on category: within-category responses become more similar than across-category responses, resulting in two separate distributions (<xref ref-type="fig" rid="fig2">Figure 2E</xref>). As a consequence, the category selectivity index for most neuron increases; correspondingly, average selectivity increases from zero to positive values (<xref ref-type="fig" rid="fig2">Figure 2F</xref>), thus reproducing the behaviour observed in experimental studies (<xref ref-type="bibr" rid="bib21">Freedman et al., 2001</xref>; <xref ref-type="bibr" rid="bib22">Freedman and Assad, 2006</xref>; <xref ref-type="bibr" rid="bib56">Reinert et al., 2021</xref>). To determine whether this effect is robust, we varied the parameters that describe the task (number of stimuli) and the biophysical properties of the circuit (the threshold and gain of neurons, <xref ref-type="fig" rid="fig1">Figure 1C</xref>, and the learning rates of the two sets of synaptic weights, <inline-formula><mml:math id="inf45"><mml:msub><mml:mi>η</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf46"><mml:msub><mml:mi>η</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></inline-formula>). We found that the selectivity increase is a universal property – it is observed in all circuit models that successfully learned the task, independent of the parameters. Activity from a second example circuit is shown in <xref ref-type="fig" rid="fig2">Figure 2I, J</xref>; additional simulations are shown in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Characterization of activity evolution during the simple categorization task.</title><p>Results from simulations. The first column (<bold>A–D</bold>) shows a naive circuit (pre-learning); the second (<bold>E–H</bold>) and third (<bold>I–L</bold>) columns show two trained circuits (post-learning), characterized by different sets of parameters (see below). (<bold>A, E, I</bold>) Histograms of single-neuron activity in response to stimuli associated with category A (orange) and category B (blue). Left and right show two sample neurons from the intermediate layer. Grey dashed lines indicate the average activity across the population. (<bold>B, F, J</bold>) Histograms of category selectivity (<xref ref-type="disp-formula" rid="equ3">Equation 2</xref>) across the population of neurons in the intermediate layer. Grey dashed lines indicate the average selectivity across the population. In panels F and J, the black vertical lines indicate the initial value of average selectivity. (<bold>C, G, K</bold>) Signal correlation matrices. Each entry shows the Pearson correlation coefficient, averaged over neurons (<xref ref-type="disp-formula" rid="equ87">Equation 72</xref>), between activity elicited by different stimuli. In these examples, we used 20 stimuli. Diagonal entries (brown) are all equal to 1. Category correlation (namely, the average of the correlations within the off-diagonal blocks, which contain stimuli in different categories) is shown on the right of the matrices. In panels G and K, the black horizontal lines near zero indicate the initial values of category correlation. (<bold>D, H, L</bold>) Population responses to categories A and B. Each dot represents a neuron in the intermediate layer, with horizontal and vertical axes showing the responses to stimuli associated with categories A and B, respectively, averaged over stimuli. Grey line: linear fit, with Pearson correlation coefficient shown in the figure legend. Parameters are summarized in <xref ref-type="table" rid="table1">Table 1</xref> (Materials and methods Tables of parameters).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79908-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Characterization of activity evolution during the simple categorization task; additional results, part I.</title><p>(<bold>A</bold>) Extensive results from simulations. Each point represents a model. We simulated 5000 different models, with parameters drawn randomly and uniformly from the following ranges: the number of stimuli, <inline-formula><mml:math id="inf47"><mml:mi>Q</mml:mi></mml:math></inline-formula>, between 10 and 30; the learning rates ratio, <inline-formula><mml:math id="inf48"><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> between 0 and 1; the gain of <inline-formula><mml:math id="inf49"><mml:mi mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf50"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula> between 0.05 and 1; the threshold of <inline-formula><mml:math id="inf51"><mml:mi mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf52"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula> between −2 and 2. Light points refer to the synaptic drive, <inline-formula><mml:math id="inf53"><mml:mi mathvariant="bold-italic">k</mml:mi></mml:math></inline-formula>, and dark ones to the activity, <inline-formula><mml:math id="inf54"><mml:mi mathvariant="bold-italic">y</mml:mi></mml:math></inline-formula>. To quantify category selectivity, we used <xref ref-type="disp-formula" rid="equ71">Equation 56</xref>, and then averaged over neurons. To quantify category correlation, we used <xref ref-type="disp-formula" rid="equ86">Equation 71</xref>. The vertical bars in the category correlation plots indicate the range of results obtained when quantifying correlation with the alternative definition in <xref ref-type="disp-formula" rid="equ95">Equation 79</xref>. Note that selectivity changes are positive, while correlation changes take both positive and negative values. For a few parameter sets, learning convergence was pathological (i.e., the loss displayed strong oscillations over epochs, or did not converge); those cases have been excluded from the analysis. (<bold>B</bold>) Activity from circuits in <xref ref-type="fig" rid="fig2">Figure 2A–D</xref> (left), <xref ref-type="fig" rid="fig2">Figure 2E-H</xref> (center), and <xref ref-type="fig" rid="fig2">Figure 2I-L</xref> (right) projected on the first three principal components. Before computing the principal components, we subtracted from activity the mean across trials and neurons. Over learning, activity develops two clouds, one for each category, as schematically illustrated in <xref ref-type="fig" rid="fig3">Figure 3A–C</xref>. The clustering direction is approximately given by <inline-formula><mml:math id="inf55"><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> (dashed grey line). The center of the two clouds is indicated by magenta triangles; the center of initial activity is indicated by the black triangle.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79908-fig2-figsupp1-v1.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Characterization of activity evolution during the simple categorization task; additional results, part II.</title><p>(<bold>A–D</bold>) Population response to categories A and B averaged over stimuli. Each dot represents a neuron. Panels A, B and C, D display two sample circuits, different from those displayed in <xref ref-type="fig" rid="fig2">Figure 2</xref>. Panels A, C and B, D display, respectively, pre- and post-learning activity. All details and parameters are as in <xref ref-type="fig" rid="fig2">Figure 2I–L</xref>, except: in A and B, we set the threshold of <inline-formula><mml:math id="inf56"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula> to −2; in C and D, we set the threshold of <inline-formula><mml:math id="inf57"><mml:mi mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula> to −1.5. In panel B, in contrast to <xref ref-type="fig" rid="fig2">Figure 2L</xref>, the variance of activity in response to B is larger than the variance in response to A. In panel D, as in <xref ref-type="fig" rid="fig2">Figure 2L</xref>, the variance of activity in response to A is larger than the variance in response to B. In contrast to <xref ref-type="fig" rid="fig2">Figure 2L</xref>, however, the mean activity in response to B is larger than the mean activity in response to A (Materials and methods Asymmetry in category response). Note that, in all cases, category correlation remains positive. (<bold>E</bold>) Variability across circuits realizations (Materials and methods Characterizing variability): illustration from a sample circuit. Grey lines illustrate activity coordinates, <inline-formula><mml:math id="inf58"><mml:msup><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula>, as a function of learning time, for all sensory inputs. Those were estimated by taking the dot product, <inline-formula><mml:math id="inf59"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:mrow><mml:mo>⋅</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and then dividing by <inline-formula><mml:math id="inf60"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mmultiscripts><mml:mi mathvariant="normal">Ψ</mml:mi><mml:none/><mml:mo>′</mml:mo><mml:none/><mml:mn>2</mml:mn></mml:mmultiscripts><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ70">Equation 55</xref> and <xref ref-type="disp-formula" rid="equ68">Equation 53</xref>). Note that <inline-formula><mml:math id="inf61"><mml:msup><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula> values corresponding to sensory inputs in the same category do not saturate to identical values; their average is indicated by dashed lines. Pink continuous lines indicate the values of <inline-formula><mml:math id="inf62"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf63"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula> computed through the theory by neglecting variability (<xref ref-type="disp-formula" rid="equ63">Equation 49</xref>). As predicted by <xref ref-type="disp-formula" rid="equ115">Equation 99</xref>, the dashed and continuous pink lines do not coincide (Materials and methods Characterizing variability). (<bold>F</bold>) Activity coordinates <inline-formula><mml:math id="inf64"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf65"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula> depend on the values of <inline-formula><mml:math id="inf66"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf67"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (i.e., the input current needed by the readout neuron to to produce the target activity). For fixed targets <inline-formula><mml:math id="inf68"><mml:msup><mml:mi>z</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf69"><mml:msup><mml:mi>z</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula> , those depend on the activation function <inline-formula><mml:math id="inf70"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula>. Increasing the threshold of <inline-formula><mml:math id="inf71"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula> can cause <inline-formula><mml:math id="inf72"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf73"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to shift from having opposite sign to having the same sign. This in turn can cause a shift from negative to positive category correlation, see Materials and methods Simple task: category correlation.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79908-fig2-figsupp2-v1.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Learning curves.</title><p>Behaviour of the loss function (<xref ref-type="disp-formula" rid="equ13">Equation 9</xref>) over learning epochs in four sample networks. (<bold>A, B</bold>) refer to the simple categorization task; parameters are, respectively, as in <xref ref-type="fig" rid="fig2">Figure 2E–H</xref> and <xref ref-type="fig" rid="fig2">Figure 2I–L</xref>. (<bold>C, D</bold>) refer to the context-dependent categorization task; parameters are, respectively, as in <xref ref-type="fig" rid="fig6">Figure 6D-F and G</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79908-fig2-figsupp3-v1.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 4.</label><caption><title>Simple categorization task with structured inputs and heterogeneity.</title><p>Analysis of category correlation for a naive circuit (<bold>A</bold>), and two trained ones (<bold>B, C</bold>). Details are, respectively, as in <xref ref-type="fig" rid="fig2">Figure 2C–D, G–H and K–L</xref>. (<bold>D</bold>) Extensive analysis of average category selectivity across circuits and task parameters. Details are as in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> (except that no theory, only simulations, are shown). As in <xref ref-type="fig" rid="fig4">Figure 4C, D</xref>, dark and light grey indicate different values for the threshold of the activation function <inline-formula><mml:math id="inf74"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula>. Dashed lines show results obtained by subsampling pairs of sensory inputs in the category selectivity definition (<xref ref-type="disp-formula" rid="equ71">Equation 56</xref>) so that initial selectivity vanishes (see Materials and methods Simple categorization task with structured inputs and heterogeneity for details). (<bold>E</bold>) Extensive analysis of category correlation across circuit and task parameters. Details as in panel D.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79908-fig2-figsupp4-v1.tif"/></fig></fig-group><p>Category selectivity tells us about the behaviour of single neurons. But how does the population as a whole change its activity over learning? To quantify that, we compute signal correlations, defined to be the Pearson correlation coefficient between the activity elicited by two different stimuli (<xref ref-type="bibr" rid="bib13">Cromer et al., 2010</xref>). Results are summarized in the correlation matrices displayed in <xref ref-type="fig" rid="fig2">Figure 2C, G, K</xref>. As the task involves 20 stimuli, the correlation matrix is 20 × 20; stimuli are sorted according to category.</p><p>As discussed above, before learning the responses of neurons in the intermediate layer are random and unstructured. Thus, activity in response to different stimuli is uncorrelated; this is illustrated in <xref ref-type="fig" rid="fig2">Figure 2C</xref>, where all non-diagonal entries of the correlation matrix are close to zero. Of particular interest are the upper-right and lower-left blocks of the matrix, which correspond to pairs of activity vectors elicited by stimuli in different categories. The average of those correlations, which we refer to as category correlation, is shown to the right of each correlation matrix. Before learning, the category correlation is close to zero (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). Over learning, the correlation matrices develop structure. Correlations become different within the two diagonal, and the two off-diagonal blocks, indicating that learning induces category-dependent structure. In <xref ref-type="fig" rid="fig2">Figure 2G</xref>, the average correlation within the off-diagonal blocks is negative; the category correlation is thus negative (<xref ref-type="bibr" rid="bib13">Cromer et al., 2010</xref>; <xref ref-type="bibr" rid="bib60">Roy et al., 2010</xref>; <xref ref-type="bibr" rid="bib23">Freedman and Miller, 2008</xref>). The model does not, however, always produce negative correlation: varying model details – either the parameters of the circuit or the number of stimuli – can switch the category correlation from negative to positive (<xref ref-type="bibr" rid="bib19">Fitzgerald et al., 2013</xref>; one example is shown in <xref ref-type="fig" rid="fig2">Figure 2K</xref>).</p><p>To illustrate the difference in population response when category correlation is negative versus positive, for each neuron in the intermediate layer we plot the average response to stimuli associated with category <inline-formula><mml:math id="inf75"><mml:mi>B</mml:mi></mml:math></inline-formula> (vertical axis) versus <inline-formula><mml:math id="inf76"><mml:mi>A</mml:mi></mml:math></inline-formula> (horizontal axis). Before learning, activity is unstructured, and the dots form a random, uncorrelated cloud (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). After learning, the shape of this cloud depends on category correlation. In <xref ref-type="fig" rid="fig2">Figure 2H</xref>, where the category correlation is negative, the cloud has a negative slope. This is because changes in single-neuron responses to categories <inline-formula><mml:math id="inf77"><mml:mi>A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf78"><mml:mi>B</mml:mi></mml:math></inline-formula> have opposite sign: a neuron that increases its activity in response to category <inline-formula><mml:math id="inf79"><mml:mi>A</mml:mi></mml:math></inline-formula> decreases its activity in response to category <inline-formula><mml:math id="inf80"><mml:mi>B</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2E</xref> left), and vice versa (<xref ref-type="fig" rid="fig2">Figure 2E</xref> right). In <xref ref-type="fig" rid="fig2">Figure 2L</xref>, where the category correlation is positive, the cloud has, instead, a positive slope. Here, changes in single-neuron responses to categories <inline-formula><mml:math id="inf81"><mml:mi>A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf82"><mml:mi>B</mml:mi></mml:math></inline-formula> have the same sign: a neuron that increases its activity in response to category <inline-formula><mml:math id="inf83"><mml:mi>A</mml:mi></mml:math></inline-formula> also increases its activity in response to category <inline-formula><mml:math id="inf84"><mml:mi>B</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2I</xref>, left), and similarly for a decrease (<xref ref-type="fig" rid="fig2">Figure 2I</xref>, right).</p><p>Negative versus positive slope is not the only difference between <xref ref-type="fig" rid="fig2">Figure 2H and L</xref>: they also differ in symmetry with respect to the two categories. In <xref ref-type="fig" rid="fig2">Figure 2H</xref>, about the same number of neurons respond more strongly to category <inline-formula><mml:math id="inf85"><mml:mi>A</mml:mi></mml:math></inline-formula> than to category <inline-formula><mml:math id="inf86"><mml:mi>B</mml:mi></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib56">Reinert et al., 2021</xref>). In <xref ref-type="fig" rid="fig2">Figure 2L</xref>, however, the number of neurons that respond more strongly to category <inline-formula><mml:math id="inf87"><mml:mi>A</mml:mi></mml:math></inline-formula> is significantly larger than the number of neurons that respond more strongly to category <inline-formula><mml:math id="inf88"><mml:mi>B</mml:mi></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib19">Fitzgerald et al., 2013</xref>). Furthermore, as observed in experiments reporting positive correlations (<xref ref-type="bibr" rid="bib19">Fitzgerald et al., 2013</xref>), the mean population activity in response to category <inline-formula><mml:math id="inf89"><mml:mi>A</mml:mi></mml:math></inline-formula> is larger than to category <inline-formula><mml:math id="inf90"><mml:mi>B</mml:mi></mml:math></inline-formula>, and the range of activity in response to <inline-formula><mml:math id="inf91"><mml:mi>A</mml:mi></mml:math></inline-formula> is larger than to <inline-formula><mml:math id="inf92"><mml:mi>B</mml:mi></mml:math></inline-formula>. The fact that the population response to <inline-formula><mml:math id="inf93"><mml:mi>A</mml:mi></mml:math></inline-formula> is larger than to <inline-formula><mml:math id="inf94"><mml:mi>B</mml:mi></mml:math></inline-formula> is not a trivial consequence of having set a larger target for the readout neuron in response to <inline-formula><mml:math id="inf95"><mml:mi>A</mml:mi></mml:math></inline-formula> than to <inline-formula><mml:math id="inf96"><mml:mi>B</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf97"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>): as shown in <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2B, D</xref>, example circuits displaying larger responses to <inline-formula><mml:math id="inf98"><mml:mi>B</mml:mi></mml:math></inline-formula> can also be observed. Response asymmetry is discussed in detail in Materials and methods Asymmetry in category response.</p><p>In sum, we simulated activity in circuit models that learn to associate sensory stimuli to abstract categories via gradient-descent synaptic plasticity. We observed that single neurons consistently develop selectivity to abstract categories – a behaviour that is robust with respect to model details. How the population of neurons responds to category depended, however, on model details: we observed both negatively correlated, symmetric responses and positively correlated, asymmetric ones. These observations are in agreement with experimental findings (<xref ref-type="bibr" rid="bib22">Freedman and Assad, 2006</xref>; <xref ref-type="bibr" rid="bib19">Fitzgerald et al., 2013</xref>; <xref ref-type="bibr" rid="bib13">Cromer et al., 2010</xref>; <xref ref-type="bibr" rid="bib56">Reinert et al., 2021</xref>).</p></sec><sec id="s2-3"><title>Analysis of the simple categorization task</title><p>What are the mechanisms that drive activity changes over learning? And how do the circuit and task details determine how the population responds? To address these questions, we performed mathematical analysis of the model. Our analysis is based on the assumption that the number of neurons in each layer of the circuit is much larger than the number of sensory inputs to classify – a regime that is relevant to the systems and tasks we study here. In that regime, the number of synaptic weights that the circuit can tune is very large, and so a small change in each weight is sufficient to learn the task. This makes the circuit amenable to mathematical analysis (<xref ref-type="bibr" rid="bib34">Jacot et al., 2018</xref>; <xref ref-type="bibr" rid="bib38">Lee et al., 2019</xref>; <xref ref-type="bibr" rid="bib42">Liu et al., 2020</xref>; <xref ref-type="bibr" rid="bib30">Hu et al., 2020</xref>); full details are reported in Materials and methods Evolution of connectivity and activity in large circuits, here we illustrate the main results.</p><p>We start with the simple categorization task illustrated in the previous section, and use the mathematical framework to shed light on the simulations described above (<xref ref-type="fig" rid="fig2">Figure 2</xref>). <xref ref-type="fig" rid="fig3">Figure 3A</xref> shows, schematically, activity in the intermediate layer before learning (see <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B</xref> for simulated data). Axes on each plot correspond to activity of three sample neurons. Each dot represents activity in response to a different sensory input; orange and blue dots indicate activity in response to stimuli associated with categories <inline-formula><mml:math id="inf99"><mml:mi>A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf100"><mml:mi>B</mml:mi></mml:math></inline-formula>, respectively. Before learning, activity is determined solely by sensory inputs, which consist of random, orthogonal vectors. Consequently, the initial activity vectors form an unstructured cloud in activity space, with orange and blue circles intermingled (<xref ref-type="fig" rid="fig3">Figure 3A</xref>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Analysis of activity evolution during the simple categorization task.</title><p>Results from mathematical analysis. (<bold>A–C</bold>) Cartoons illustrating how activity evolves over learning. The three columns are as in <xref ref-type="fig" rid="fig2">Figure 2</xref>: pre-learning (first column) and post-learning for two different circuits (second and third columns). Circles show activity in the intermediate layer in response to different stimuli, displayed in a three-dimensional space where axes correspond to the activity of three sample neurons. Orange and blue circles are associated, respectively, with categories A and B. Before learning, activity is unstructured (panel A). After learning (panels B and C), the activity vectors develop a component along the common direction <inline-formula><mml:math id="inf101"><mml:mi mathvariant="bold-italic">d</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ4">Equation 3</xref>), shown as a magenta line, and form two clouds, one for each category. The centers of those clouds are indicated by magenta triangles; their positions along <inline-formula><mml:math id="inf102"><mml:mi mathvariant="bold-italic">d</mml:mi></mml:math></inline-formula> are given, approximately, by <inline-formula><mml:math id="inf103"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf104"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula>. The black triangle indicates the center of initial activity. In panel B, <inline-formula><mml:math id="inf105"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf106"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula> have opposite sign, so the clouds move in opposite directions with respect to initial activity; in panel C, <inline-formula><mml:math id="inf107"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf108"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula> have the same sign, so the clouds move in the same direction. For illustration purposes, we show a smaller number of stimuli (14, instead of 20) than in <xref ref-type="fig" rid="fig2">Figure 2</xref>. Simulated data from the circuits displayed in <xref ref-type="fig" rid="fig2">Figure 2</xref> are shown in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79908-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Comparison between finite-size networks and approximate mathematical description for the simple categorization task, part I.</title><p>Dashed lines show the theoretical predictions; dots show the average over 400 simulations where both the initial connectivity and the sensory inputs were drawn at random. Error bars show the standard deviation across simulations; they thus quantify variability across initializations (Materials and methods Characterizing variability). Yellow: pre-learning; gray: post-learning. (<bold>A</bold>) Activity coordinates <inline-formula><mml:math id="inf109"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf110"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula>. Theory was computed from <xref ref-type="disp-formula" rid="equ63">Equation 49</xref>. Simulations results were computed by taking the dot product <inline-formula><mml:math id="inf111"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:mrow><mml:mo>⋅</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> for two activity vectors associated with different categories, and then dividing by <inline-formula><mml:math id="inf112"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mmultiscripts><mml:mi mathvariant="normal">Ψ</mml:mi><mml:none/><mml:mo>′</mml:mo><mml:none/><mml:mn>2</mml:mn></mml:mmultiscripts><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ70">Equation 55</xref> and <xref ref-type="disp-formula" rid="equ68">Equation 53</xref>). (<bold>B</bold>) Average category selectivity. Theory was computed from <xref ref-type="disp-formula" rid="equ81">Equation 66</xref>. Simulations results were computed by using <xref ref-type="disp-formula" rid="equ71">Equation 56</xref>, and then averaging across neurons. We also plot results for category clustering. Theory (dotted lines) was computed from <xref ref-type="disp-formula" rid="equ84">Equation 69</xref>. Simulations results (triangles) were computed by using <xref ref-type="disp-formula" rid="equ82">Equation 67</xref>. Note that average selectivity and clustering are not identical for all parameters (although they become close in the limit <inline-formula><mml:math id="inf113"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≪</mml:mo><mml:mi>Q</mml:mi><mml:mo>≪</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, as discussed in Materials and methods Simple task: category selectivity). (<bold>C</bold>) Category correlation. Theory was computed from <xref ref-type="disp-formula" rid="equ89">Equation 74</xref>. Simulations results were obtained by applying <xref ref-type="disp-formula" rid="equ86">Equation 71</xref> to simulated data.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79908-fig3-figsupp1-v1.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Comparison between finite-size networks and approximate mathematical description for the simple categorization task, part II.</title><p>Details in (<bold>A-C</bold>) are as in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>. We used different parameters (see <xref ref-type="table" rid="table2">Table 2</xref>), which lead to positive category correlation.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79908-fig3-figsupp2-v1.tif"/></fig></fig-group><p>Over learning, activity vectors in <xref ref-type="fig" rid="fig3">Figure 3A</xref> move. Specifically, over learning all activity vectors acquire a component that is aligned with a common, stimulus-independent direction. Activity after learning can thus be approximated by<disp-formula id="equ4"><label>(3)</label><mml:math id="m4"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>≃</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf114"><mml:msubsup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula> indicates initial activity in response to sensory input <inline-formula><mml:math id="inf115"><mml:mi>s</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf116"><mml:mi mathvariant="bold-italic">d</mml:mi></mml:math></inline-formula> indicates the common direction along which activity acquires structure. The coefficients <inline-formula><mml:math id="inf117"><mml:msup><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula>, which measure the strength of the components along the common direction <inline-formula><mml:math id="inf118"><mml:mi mathvariant="bold-italic">d</mml:mi></mml:math></inline-formula>, are determined by category: they are approximately equal to <inline-formula><mml:math id="inf119"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> if the sensory input is associated with category <inline-formula><mml:math id="inf120"><mml:mi>A</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf121"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula> otherwise. Consequently, over learning, activity vectors associated with different categories are pushed apart along <inline-formula><mml:math id="inf122"><mml:mi mathvariant="bold-italic">d</mml:mi></mml:math></inline-formula>; this is illustrated in <xref ref-type="fig" rid="fig3">Figure 3B, C</xref>, which show activity for the two circuits analyzed in the second and third column of <xref ref-type="fig" rid="fig2">Figure 2</xref>, respectively. Activity thus forms two distinct clouds, one for each category; the centers of the two clouds along <inline-formula><mml:math id="inf123"><mml:mi mathvariant="bold-italic">d</mml:mi></mml:math></inline-formula> are given, approximately, by <inline-formula><mml:math id="inf124"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf125"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula>. The mathematical framework detailed in Materials and methods Simple categorization task allows us to derive closed-form expressions for the clustering direction <inline-formula><mml:math id="inf126"><mml:mi mathvariant="bold-italic">d</mml:mi></mml:math></inline-formula> and the coefficients <inline-formula><mml:math id="inf127"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf128"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula>. In the next two sections, we take advantage of those expressions to determine how the different activity patterns shown in <xref ref-type="fig" rid="fig2">Figure 2</xref> depend on task and circuit parameters.</p><p>The fact that activity clusters by category tells us immediately that the category selectivity index of single neurons increases over learning, as observed in simulations (<xref ref-type="fig" rid="fig2">Figure 2F, J</xref>). To see this quantitatively, note that from the point of view of a single neuron, <inline-formula><mml:math id="inf129"><mml:mi>i</mml:mi></mml:math></inline-formula>, <xref ref-type="disp-formula" rid="equ4">Equation 3</xref> reads<disp-formula id="equ5"><label>(4)</label><mml:math id="m5"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>≃</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Since <inline-formula><mml:math id="inf130"><mml:msup><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula> is category dependent, while <italic>d</italic><sub><italic>i</italic></sub> is fixed, the second term in the right-hand side of <xref ref-type="disp-formula" rid="equ5">Equation 4</xref> separates activity associated with different categories (<xref ref-type="fig" rid="fig2">Figure 2E, I</xref>), and implies an increase in the category selectivity index (<xref ref-type="disp-formula" rid="equ3">Equation 2</xref>; <xref ref-type="fig" rid="fig2">Figure 2F, J</xref>). The generality of <xref ref-type="disp-formula" rid="equ5">Equation 4</xref> indicates that the increase in selectivity is a robust byproduct of gradient-descent learning, and so can be observed in any circuit that learns the categorization task, regardless of model details. This explains the increase in selectivity consistently observed in simulations (<xref ref-type="fig" rid="fig2">Figure 2F, J</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>).</p></sec><sec id="s2-4"><title>Correlations reflect circuit and task properties</title><p>While the behaviour of category selectivity is consistent across all circuit models, the behaviour of population responses is not: as shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>, over learning responses can become negatively correlated and symmetric (<xref ref-type="fig" rid="fig2">Figure 2G, H</xref>), or positively correlated and asymmetric (<xref ref-type="fig" rid="fig2">Figure 2K, L</xref>). The reason is illustrated in <xref ref-type="fig" rid="fig3">Figure 3B, C</xref>. In <xref ref-type="fig" rid="fig3">Figure 3B</xref>, the centers of the category clouds along <inline-formula><mml:math id="inf131"><mml:mi mathvariant="bold-italic">d</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf132"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf133"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula>, have, respectively, a positive and a negative sign relative to the center of initial activity (denoted by a black triangle). As a consequence, the two clouds move in opposite directions. The population thus develops, over learning, negative category correlation (<xref ref-type="fig" rid="fig2">Figure 2G, H</xref>): if the activity of a given neuron increases for one category, it decreases for the other, and vice versa. Furthermore, if <inline-formula><mml:math id="inf134"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf135"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula> have similar magnitude (which is the case for <xref ref-type="fig" rid="fig2">Figure 2G, H</xref>), activity changes for the two categories have similar amplitude, making the response to categories <inline-formula><mml:math id="inf136"><mml:mi>A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf137"><mml:mi>B</mml:mi></mml:math></inline-formula> approximately symmetric. In <xref ref-type="fig" rid="fig3">Figure 3C</xref>, on the other hand, <inline-formula><mml:math id="inf138"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf139"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula> are both positive; clouds associated with the two categories move in the same direction relative to the initial cloud of activity. This causes the population to develop positive category correlation (<xref ref-type="fig" rid="fig2">Figure 2K, L</xref>): if the activity increases for one category, it also increases for the other, and similarly for a decrease. Because the magnitude of <inline-formula><mml:math id="inf140"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> is larger than <inline-formula><mml:math id="inf141"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula>, activity changes for category <inline-formula><mml:math id="inf142"><mml:mi>A</mml:mi></mml:math></inline-formula> are larger than for <inline-formula><mml:math id="inf143"><mml:mi>B</mml:mi></mml:math></inline-formula>, making the response to categories <inline-formula><mml:math id="inf144"><mml:mi>A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf145"><mml:mi>B</mml:mi></mml:math></inline-formula> asymmetric.</p><p>This analysis tells us that whether negative or positive category correlation emerges depends on the relative signs of <inline-formula><mml:math id="inf146"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf147"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula>. We can use mathematical analysis to compute the value and sign of <inline-formula><mml:math id="inf148"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf149"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula>, and thus predict how category correlation changes over learning (Materials and methods Simple task: category correlation). We find that the biophysical details of the circuit play a fundamental role in determining category correlation. In <xref ref-type="fig" rid="fig4">Figure 4A</xref>, we show category correlation as a function of the threshold and gain of the readout neuron (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). We find that varying those can change the magnitude and sign of correlations, with positive correlations favoured by large values of the threshold and gain and negative correlations favoured by small values. Category correlation is also affected by the threshold and gain of neurons in the intermediate layer. This can be seen in <xref ref-type="fig" rid="fig4">Figure 4B</xref>, which shows that larger values of the threshold and gain tend to favour positive correlation. An equally important role is played by the relative learning rates of the the readout, <inline-formula><mml:math id="inf150"><mml:mi mathvariant="bold-italic">w</mml:mi></mml:math></inline-formula>, and the intermediate weights, <inline-formula><mml:math id="inf151"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula>. As illustrated in <xref ref-type="fig" rid="fig4">Figure 4C</xref>, increasing the ratio of the learning rates, <inline-formula><mml:math id="inf152"><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, causes the correlation to decrease. Overall, these results indicate that category correlation depends on multiple biophysical aspects of the circuit, which in turn are likely to depend on brain areas. This suggests that correlation can vary across brain areas, which is in agreement with the observation that positive correlations reported in monkeys area LIP are robust across experiments (<xref ref-type="bibr" rid="bib19">Fitzgerald et al., 2013</xref>), but inconsistent with the correlations observed in monkeys PFC (<xref ref-type="bibr" rid="bib13">Cromer et al., 2010</xref>).</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Category correlation depends on circuit and task properties.</title><p>(<bold>A</bold>) Category correlation as a function of the threshold and gain of the readout neuron. Grey arrows indicate the threshold and gain that are used in panels C and D. The learning rate ratio, <inline-formula><mml:math id="inf153"><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, is set to 0.4 here and in panels B and D. (<bold>B</bold>) Category correlation as a function of the threshold and gain of neurons in the intermediate layer; details as in panel A. (<bold>C</bold>) Category correlation as a function of the learning rate ratio. The threshold and gain of the readout neuron are given by the triangles indicated in panel A, matched by colour. (<bold>D</bold>) Category correlation as a function of the number of stimuli; same colour code as in panel C. In all panels, correlations were computed from the approximate theoretical expression given in Materials and methods Simple task: category correlation (<xref ref-type="disp-formula" rid="equ89">Equation 74</xref>). Parameters are summarized in <xref ref-type="table" rid="table1">Table 1</xref> (Materials and methods Tables of parameters).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79908-fig4-v1.tif"/></fig><p>Category correlation also depends on the total number of stimuli, a property of the task rather than the circuit (Materials and methods Simple task: category correlation, <xref ref-type="disp-formula" rid="equ92">Equation 77</xref>). This is illustrated in <xref ref-type="fig" rid="fig4">Figure 4D</xref>, which shows that increasing the number of stimuli causes a systematic decrease in correlation. The model thus makes the experimentally testable prediction that increasing the number of stimuli should push category correlation from positive to negative values. This finding is in agreement with the fact that negative correlations are typically observed in sensory cortex, as well as machine-learning models trained on benchmark datasets (<xref ref-type="bibr" rid="bib53">Papyan et al., 2020</xref>) – that is, in cases where the number of stimuli is much larger than in the current task.</p></sec><sec id="s2-5"><title>Patterns of selectivity are shaped by initial connectivity</title><p>We conclude our analysis of the simple categorization task by taking a closer look at category selectivity. We have already observed, in <xref ref-type="fig" rid="fig2">Figure 2F, J</xref>, that the category selectivity of neurons in the intermediate layer increase over learning. However, as shown in those figures, the amount it increases can vary markedly across the population – a finding that reproduces the variability commonly seen in experiments (<xref ref-type="bibr" rid="bib22">Freedman and Assad, 2006</xref>; <xref ref-type="bibr" rid="bib18">Fitzgerald et al., 2011</xref>; <xref ref-type="bibr" rid="bib56">Reinert et al., 2021</xref>). The model naturally explains this variability: as can be seen in <xref ref-type="disp-formula" rid="equ5">Equation 4</xref>, the magnitude of category-related activity changes (and, consequently, the magnitude of category selectivity) depends, for a given neuron <inline-formula><mml:math id="inf154"><mml:mi>i</mml:mi></mml:math></inline-formula>, on the magnitude of <italic>d</italic><sub><italic>i</italic></sub>. Mathematical analysis (see Materials and methods Simple task: computing activity, especially <xref ref-type="disp-formula" rid="equ70">Equation 55</xref>) indicates that, for the current task, the category direction <inline-formula><mml:math id="inf155"><mml:mi mathvariant="bold-italic">d</mml:mi></mml:math></inline-formula> is approximately aligned with the vector that specifies connectivity between the intermediate and the readout neurons, <inline-formula><mml:math id="inf156"><mml:mi mathvariant="bold-italic">w</mml:mi></mml:math></inline-formula>, before learning starts; we denote this vector <inline-formula><mml:math id="inf157"><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3B, C</xref>). As a consequence, only neurons that are initially strongly connected to the readout neuron – that is, neurons for which <inline-formula><mml:math id="inf158"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is large – exhibit a large selectivity index (<xref ref-type="fig" rid="fig5">Figure 5B, C</xref>).</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Magnitude of category selectivity depends on connectivity with the readout neuron.</title><p>(<bold>A–C</bold>) Category selectivity as a function of the initial readout connectivity <inline-formula><mml:math id="inf159"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (in absolute value). The three columns are as in <xref ref-type="fig" rid="fig2">Figure 2</xref>: pre-learning (first column) and post-learning for two different circuits (second and third columns). Each dot represents a neuron in the intermediate layer. Cyan line: linear fit, with Pearson correlation coefficient shown in the figure legend.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79908-fig5-v1.tif"/></fig><p>Why does activity cluster along the initial readout <inline-formula><mml:math id="inf160"><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>? As described above, the output of the circuit, <inline-formula><mml:math id="inf161"><mml:mi>z</mml:mi></mml:math></inline-formula>, depends on the dot product <inline-formula><mml:math id="inf162"><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf163"><mml:mi mathvariant="bold-italic">w</mml:mi></mml:math></inline-formula> are the readout weights after learning. Consequently, the final activity in the intermediate layer, <inline-formula><mml:math id="inf164"><mml:mi mathvariant="bold-italic">y</mml:mi></mml:math></inline-formula>, must include a category-dependent component along <inline-formula><mml:math id="inf165"><mml:mi mathvariant="bold-italic">w</mml:mi></mml:math></inline-formula>. Such a component can be aligned either with the initial readout weights, <inline-formula><mml:math id="inf166"><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, or with the readout weights changes. The fact that activity changes are mostly aligned with <inline-formula><mml:math id="inf167"><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> indicates that the learning algorithm is characterized by a sort of inertia, which makes it rely on initial connectivity structure much more heavily than on the learned one. As showed in Materials and methods Evolution of connectivity and activity in large circuits, this is a property of networks with a large number of neurons relative to the number of stimuli, which are characterized by small weights changes (<xref ref-type="bibr" rid="bib34">Jacot et al., 2018</xref>).</p><p>In terms of biological circuits, <xref ref-type="fig" rid="fig5">Figure 5</xref> predicts that changes in selectivity are determined by the strength of synaptic connections a neuron makes, before learning, to downstream readout areas. Experiments consistent with this prediction have been recently reported: studies in rodents PFC (<xref ref-type="bibr" rid="bib77">Ye et al., 2016</xref>; <xref ref-type="bibr" rid="bib29">Hirokawa et al., 2019</xref>) found that all neurons which were highly selective to a given abstract variable were characterized by similar downstream projections (i.e., they projected to the same area). These experiments would provide evidence for our model if two conditions were met. First, neurons in the downstream area should behave as readout neurons: over learning, their activity should increasingly depend on the abstract variable. Second, the strength of the synaptic connections that neurons make to downstream neurons should correlate with selectivity (<xref ref-type="fig" rid="fig5">Figure 5B, C</xref>). Both predictions could be tested with current experimental technology.</p><p>In sum, we analyzed activity in the intermediate layer of circuits that learned the simple categorization task. We found that activity gets reshaped along a common, stimulus-independent direction (<xref ref-type="disp-formula" rid="equ4">Equation 3</xref>), which is approximately aligned with the initial readout vector <inline-formula><mml:math id="inf168"><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>. Activity vectors associated with different categories develop two distinct clouds along this direction – a fact that explains the increase in category selectivity observed in <xref ref-type="fig" rid="fig2">Figure 2F, J</xref>. We also found that the sign of the category correlation depends on the circuit (threshold and gain of neurons in the intermediate and readout layers, and relative learning rates) and on the task (number of stimuli). Modifying any of these can change the direction the clouds of activity move along <inline-formula><mml:math id="inf169"><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, which in turn changes the sign of category correlation, thus explaining the different behaviours observed in <xref ref-type="fig" rid="fig2">Figure 2G, H and K, L</xref>.</p></sec><sec id="s2-6"><title>Evolution of activity during the context-dependent categorization task</title><p>We now consider a more complex categorization task. Here, stimuli–category associations are not fixed, but context dependent: stimuli that are associated with category A in context 1 are associated with category B in context 2, and vice versa. Context-dependent associations are core to a number of experimental tasks (<xref ref-type="bibr" rid="bib70">Wallis et al., 2001</xref>; <xref ref-type="bibr" rid="bib66">Stoet and Snyder, 2004</xref>; <xref ref-type="bibr" rid="bib60">Roy et al., 2010</xref>; <xref ref-type="bibr" rid="bib46">McKenzie et al., 2014</xref>; <xref ref-type="bibr" rid="bib56">Reinert et al., 2021</xref>), and are ubiquitous in real-world experience.</p><p>In the model, the two contexts are signaled by distinct sets of context cues (e.g., two different sets of visual stimuli) (<xref ref-type="bibr" rid="bib70">Wallis et al., 2001</xref>; <xref ref-type="bibr" rid="bib66">Stoet and Snyder, 2004</xref>). As for the stimuli, context cues are represented by random and orthogonal sensory input vectors. On every trial, one stimulus and one context cue are presented; the corresponding sensory inputs are combined linearly to yield the total sensory input vector <inline-formula><mml:math id="inf170"><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula> (Materials and methods Context-dependent task: task definition). This task is computationally much more involved than the previous one, primarily because context induces nontrivial correlational structure: in the simple task, all sensory input vectors were uncorrelated; in the context-dependent task, that is no longer true. For instance, two sensory inputs with the same stimulus and different context cues are highly correlated. In spite of this high correlation, though, they can belong to different categories – for instance, when context cues are associated with different contexts. In contrast, two sensory inputs with different stimuli and different context cues are uncorrelated, but they can belong to the same category. From a mathematical point of view, this correlational structure makes sensory input vectors nonlinearly separable. This is in stark contrast to the simple task, for which sensory input vectors were linearly separable (<xref ref-type="bibr" rid="bib5">Barak et al., 2013</xref>). In fact, this task is a generalization of the classical XOR task where, rather than just two stimuli and two context cues, there are more than two of each (<xref ref-type="bibr" rid="bib46">McKenzie et al., 2014</xref>). In the example shown below, we used 8 stimuli and 8 context cues.</p><p>We are again interested in understanding how activity in the intermediate layer evolves over learning. We start by investigating this via simulations (<xref ref-type="fig" rid="fig6">Figure 6</xref>). As in <xref ref-type="fig" rid="fig2">Figure 2B, F, J</xref>, we first measure category selectivity (<xref ref-type="disp-formula" rid="equ3">Equation 2</xref>). Before learning, activity is characterized by small selectivity, which is weakly negative on average (<xref ref-type="fig" rid="fig6">Figure 6A</xref>; the fact that average category selectivity is initially weakly negative is due to the composite nature of inputs for this task, see Materials and methods Detailed analysis of category selectivity). Over learning, the average category selectivity increases (<xref ref-type="fig" rid="fig6">Figure 6D</xref>). We tested the robustness of this behaviour by varying the parameters that control both the circuit (threshold and gain of neurons, learning rates) and task (number of stimuli and context cues). As in the simple task, we found that the average category selectivity increases in all circuit models, regardless of the parameters (<xref ref-type="fig" rid="fig6">Figure 6G</xref> and <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1A</xref>).</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Characterization of activity evolution during the context-dependent categorization task.</title><p>Results from simulations. The first column (<bold>A–C</bold>) shows a naive circuit (pre-learning); the second (<bold>D–F</bold>) and third (<bold>G–I</bold>) columns show two trained circuits (post-learning), characterized by different sets of parameters. (<bold>A, D, G</bold>) Histogram of category selectivity (<xref ref-type="disp-formula" rid="equ3">Equation 2</xref>) across the population of neurons in the intermediate layer (note that the vertical axis has been expanded for visualization purposes). Grey dashed lines indicate the average selectivity across the population. In panels D and G, the black vertical lines indicate the initial value of the average selectivity. Note that the distribution of category selectivity is different from the distribution observed in the simple task (<xref ref-type="fig" rid="fig2">Figure 2F, J</xref>); the distribution is now heavy tailed, with only a fraction of the neurons acquiring strong category selectivity (see also <xref ref-type="fig" rid="fig8">Figure 8B</xref>). (<bold>B, E, H</bold>) Histogram of context selectivity (Materials and methods Context-dependent task: category and context selectivity, <xref ref-type="disp-formula" rid="equ140">Equation 122</xref>), details as in A, D, and G. (<bold>C, F, I</bold>) Correlation matrices. Each entry shows the Pearson correlation coefficient between activity from different trials. There are 8 stimuli and 8 context cues, for a total of 64 trials (i.e., 64 stimulus/context cue combinations). Diagonal entries (brown) are all equal to 1. The inset on the top of panel C shows, as an example, a magnified view of correlations among trials with context cues 1 and 8, across all stimuli (1–8). To the right of the matrices we show the context correlation, defined to be the average of the correlations within the off-diagonal blocks (trials in different contexts). In panels F and I, the black horizontal lines indicate the initial value of context correlation. Parameters are summarized in <xref ref-type="table" rid="table1">Table 1</xref> (Materials and methods Tables of parameters).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79908-fig6-v1.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Characterization of activity evolution during the context-dependent categorization task; additional results, part I.</title><p>(<bold>A</bold>) Extensive results from simulations. Each point represents a model. We simulated 5000 different models, with parameters drawn randomly. Details as in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>, except that the number of stimuli and context cues, <inline-formula><mml:math id="inf171"><mml:mi>Q</mml:mi></mml:math></inline-formula>, ranges between 4 and 20. To quantify context selectivity, we used <xref ref-type="disp-formula" rid="equ140">Equation 122</xref> and <xref ref-type="disp-formula" rid="equ141">Equation 123</xref>, and then averaged over neurons. To quantify category selectivity, we used <xref ref-type="disp-formula" rid="equ71">Equation 56</xref>, and then averaged over neurons. To quantify context and category correlation, we used, respectively, <xref ref-type="disp-formula" rid="equ145">Equation 127</xref> and <xref ref-type="disp-formula" rid="equ86">Equation 71</xref>. The vertical bars in correlation plots indicate the range of results obtained when quantifying correlation with the alternative definitions in <xref ref-type="disp-formula" rid="equ147">Equation 129</xref> and <xref ref-type="disp-formula" rid="equ95">Equation 79</xref>; for illustration purposes, the range was cut on the negative semi-axis. For a few parameter sets, learning convergence was pathological (i.e., the loss displayed strong oscillations over epochs, or did not converge); those cases have been excluded from the analysis. Note that, as in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>, selectivity changes are positive, while correlation changes take both positive and negative values. (<bold>B</bold>) Same as in A, except that changes were computed from theoretical expressions. For context selectivity, we used <xref ref-type="disp-formula" rid="equ140">Equation 122</xref> and <xref ref-type="disp-formula" rid="equ141">Equation 123</xref>. For category selectivity, we used <xref ref-type="disp-formula" rid="equ142">Equation 124</xref>. For context and category correlation, we used the same equations as in panel A, but evaluated them via the theoretical framework. (<bold>C, D</bold>) Activity from circuits in <xref ref-type="fig" rid="fig6">Figure 6A–C</xref> (left), <xref ref-type="fig" rid="fig6">Figure 6D-F</xref> (center) and <xref ref-type="fig" rid="fig6">Figure 6G-I</xref> (right) projected on the first three principal components. Details as in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B</xref>. Panels C and D display, respectively, results for the synaptic drive <inline-formula><mml:math id="inf172"><mml:mi mathvariant="bold-italic">k</mml:mi></mml:math></inline-formula> and the activity <inline-formula><mml:math id="inf173"><mml:mi mathvariant="bold-italic">y</mml:mi></mml:math></inline-formula>. The center of activity clouds for categories A and B (resp. contexts 1 and 2) is indicated by magenta (resp. pink) triangles; the center of initial activity is indicated by the black triangle.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79908-fig6-figsupp1-v1.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 2.</label><caption><title>Characterization of activity evolution during the context-dependent categorization task; additional results, part II.</title><p>(<bold>A, B</bold>) Population response to categories A and B, averaged over trials. Each dot represents a neuron. Panels A and B correspond to two sample circuits, characterized by different values of the threshold of the activation function <inline-formula><mml:math id="inf174"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula>. Note that responses in panel A are approximately symmetric, while those in panel B are strongly asymmetric. (<bold>C</bold>) Context dependence makes categorization more complex and causes a drop in signal correlations: extensive quantification. We computed changes in correlations for the simple and the context-dependent task across a broad range of models; details as in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1B</xref>. The top panel displays the mean of correlation changes across models. Note that correlation changes are more negative in the context-dependent task. For the context-dependent task, we computed both the category and context correlation; results are displayed, respectively, in magenta and pink. In the bottom panel, we computed the fraction of models where correlation changes were positive in the simple task, and became negative in the context-dependent one (left), and vice versa (right). Note that the former substantially outnumbered the latter, which confirms that context-dependency shrinks the parameter space where changes in correlations are positive. (<bold>D</bold>) Schematic representation of the initial synaptic drive, <inline-formula><mml:math id="inf175"><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula>, in the context-dependent task with <inline-formula><mml:math id="inf176"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> (XOR). The centers of activity vectors associated with categories A and B are indicated by magenta triangles; note that the two triangles coincide exactly (Materials and methods Analysis of patterns of context and category selectivity). (<bold>E</bold>) Accuracy of a linear classifier trained to decode category from initial and final synaptic drive, <inline-formula><mml:math id="inf177"><mml:msub><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf178"><mml:mi mathvariant="bold-italic">k</mml:mi></mml:math></inline-formula>, and initial and final activity, <inline-formula><mml:math id="inf179"><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf180"><mml:mi mathvariant="bold-italic">y</mml:mi></mml:math></inline-formula>. Data are from the model displayed in <xref ref-type="fig" rid="fig6">Figure 6D–F</xref>. To train the linear classifier, we used the function svm. SVC with a linear kernel from the package sklearn; the regularization parameter <inline-formula><mml:math id="inf181"><mml:mi>C</mml:mi></mml:math></inline-formula> was fixed through the GridSearchCV routine.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79908-fig6-figsupp2-v1.tif"/></fig><fig id="fig6s3" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 3.</label><caption><title>Characterization of activity evolution during the context-dependent categorization task; additional results, part III.</title><p>(<bold>A-B</bold>) Changes in category (panel A) and context (panel B) selectivity as a function of the components on the category and context directions, <inline-formula><mml:math id="inf182"><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mtext>cat</mml:mtext></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf183"><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mtext>ctx</mml:mtext></mml:msubsup></mml:math></inline-formula> (in absolute value). The latter are defined in <xref ref-type="disp-formula" rid="equ191">Equation 167</xref>, Materials and methods Analysis of patterns of context and category selectivity. Each dot represents a neuron. Data are from the same model displayed in <xref ref-type="fig" rid="fig8">Figure 8</xref>. Blue line: linear fit, with Pearson correlation coefficient shown in the figure legend. Note that correlations for both panels are high. (<bold>C, D</bold>) Same analysis as in <xref ref-type="fig" rid="fig8">Figure 8B-C</xref>, but for the sample circuit displayed in the third column of <xref ref-type="fig" rid="fig6">Figure 6</xref>. (<bold>E, F</bold>) Analysis of a circuit that includes a second readout neuron, trained to report context. Panel E: circuit architecture; this is identical to the standard model (<xref ref-type="fig" rid="fig1">Figure 1B</xref>), except for the presence of the extra readout. All details and parameters are as in <xref ref-type="fig" rid="fig8">Figure 8</xref>. To make sure that the learning process associated with the two readouts drives activity changes of similar magnitude in the intermediate layer, the target values for the context readout were taken to be <inline-formula><mml:math id="inf184"><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf185"><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>. Panel F: analysis as in <xref ref-type="fig" rid="fig8">Figure 8B</xref>. Note that here, in contrast to <xref ref-type="fig" rid="fig8">Figure 8B</xref>, some neurons display a strong increase in selectivity to context, but not category (brown sample neuron).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79908-fig6-figsupp3-v1.tif"/></fig></fig-group><p>While in the simple task we could only investigate the effect of category on activity, in this task we can also investigate the effect of context. For this we measure context selectivity which, analogously to category selectivity, quantifies the extent to which single-neuron activity is more similar within than across contexts (Materials and methods Context-dependent task: category and context selectivity, <xref ref-type="disp-formula" rid="equ140">Equation 122</xref>). Context selectivity is shown in <xref ref-type="fig" rid="fig6">Figure 6B, E</xref>. We find, as we did for category selectivity, that average context selectivity increases over learning – a behaviour that is in agreement with experimental findings (<xref ref-type="bibr" rid="bib70">Wallis et al., 2001</xref>; <xref ref-type="bibr" rid="bib66">Stoet and Snyder, 2004</xref>). The increase in context selectivity is, as for category, highly robust, and does not depend on model details (<xref ref-type="fig" rid="fig6">Figure 6H</xref> and <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1A</xref>).</p><p>Finally, we analyze signal correlations; these are summarized in the correlation matrices displayed in <xref ref-type="fig" rid="fig6">Figure 6C, F, I</xref>. As we used 8 stimuli and 8 context cues, and all stimuli–context cues combinations are permitted, each correlation matrix is 64 × 64. Trials are sorted according to context cue first and stimulus second; with this ordering, the first half of trials corresponds to context 1 and the second half to context 2, and the off-diagonal blocks are given by pairs of trials from different contexts.</p><p><xref ref-type="fig" rid="fig6">Figure 6C</xref> shows the correlation matrix before learning. Here, the entries in the correlation matrix are fully specified by sensory input, and can take only three values: large (brown), when both the stimuli and the context cues are identical across the two trials; intermediate (red), when the stimuli are identical but the context cues are not, or vice versa; and small (white), when both stimulus and context cues are different. <xref ref-type="fig" rid="fig6">Figure 6F, I</xref> show correlation matrices after learning for two circuits characterized by different parameters. As in the simple task, the matrices acquire additional structure during learning, and that structure can vary significantly across circuits (<xref ref-type="fig" rid="fig6">Figure 6F, I</xref>). To quantify this, we focus on the off-diagonal blocks (pairs of trials from different contexts) and measure the average of those correlations, which we refer to as context correlation. Context correlation behaves differently in the two circuits displayed in <xref ref-type="fig" rid="fig6">Figure 6F and I</xref>: it decreases over learning in <xref ref-type="fig" rid="fig6">Figure 6F</xref>, whereas it increases in <xref ref-type="fig" rid="fig6">Figure 6I</xref>. Thus, as in the simple task, the behaviour of correlations is variable across circuits. This variability is not restricted to context correlation: as in the simple task, category correlation is also variable (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1A</xref>), and the population response to categories <inline-formula><mml:math id="inf186"><mml:mi>A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf187"><mml:mi>B</mml:mi></mml:math></inline-formula> can be symmetric or asymmetric depending on model details (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2A, B</xref>).</p></sec><sec id="s2-7"><title>Analysis of the context-dependent categorization task</title><p>To uncover the mechanisms that drive learning-induced activity changes, we again analyse the circuit mathematically. The addition of context makes the analysis considerably more complicated than for the simple task; most of the details are thus relegated to Materials and methods Context-dependent categorization task; here we discuss the main results.</p><p><xref ref-type="fig" rid="fig7">Figure 7A</xref> shows, schematically, activity before learning (see <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1D</xref> for simulated data). Each point represents activity on a given trial, and is associated with a category (<inline-formula><mml:math id="inf188"><mml:mi>A</mml:mi></mml:math></inline-formula>, orange; <inline-formula><mml:math id="inf189"><mml:mi>B</mml:mi></mml:math></inline-formula>, blue) and a context (1, circles; 2, squares). Before learning, activity is mostly unstructured (<xref ref-type="fig" rid="fig7">Figure 7A</xref>, Materials and methods Detailed analysis of category selectivity); over learning, though, it acquires structure (<xref ref-type="fig" rid="fig7">Figure 7B, C</xref>). As in the simple task (<xref ref-type="fig" rid="fig3">Figure 3B, C</xref>), activity vectors get re-arranged into statistically distinguishable clouds. While in the simple task clouds were determined by category, here each cloud is associated with a combination of category and context. As a result, four clouds are formed: the cloud of orange circles corresponds to category <inline-formula><mml:math id="inf190"><mml:mi>A</mml:mi></mml:math></inline-formula> and context 1; orange squares to category <inline-formula><mml:math id="inf191"><mml:mi>A</mml:mi></mml:math></inline-formula> and context 2; blue circles to category <inline-formula><mml:math id="inf192"><mml:mi>B</mml:mi></mml:math></inline-formula> and context 1; and blue squares to category <inline-formula><mml:math id="inf193"><mml:mi>B</mml:mi></mml:math></inline-formula> and context 2.</p><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Analysis of activity evolution during the context-dependent categorization task.</title><p>Results from mathematical analysis. (<bold>A–C</bold>) Cartoons illustrating how activity evolves over learning. Orange and blue symbols are associated with categories A and B, respectively; circles and squares are associated with contexts 1 and 2. Before learning, activity is mostly unstructured (panel A). After learning, activity forms four clouds, one for each combination of category and context. The center of the activity vectors associated with categories A and B and contexts 1 and 2 are indicated, respectively, by magenta and pink triangles. The black triangle indicates the center of initial activity. The cartoons in panels A–B–C refer to the three circuits illustrated in the three columns of <xref ref-type="fig" rid="fig6">Figure 6</xref>; for illustration purposes, we show a reduced number of stimuli and context cues (4 instead of 8). Simulated data from the circuits displayed in <xref ref-type="fig" rid="fig6">Figure 6</xref> are shown in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1D</xref>. (<bold>D</bold>) Change in context correlation over learning as a function of the threshold and gain of the readout neuron. Grey arrows indicate the threshold and gain that are used in panels E and F. (<bold>E</bold>) Change in context correlation over learning as a function of the ratio of learning rates in the two layers. (<bold>F</bold>) Change in context correlation over learning as a function of the number of stimuli. Correlations in panels D–F were computed from the approximate theoretical expression given in Materials and methods Context-dependent task: category and context correlation. Parameters are given in <xref ref-type="table" rid="table1">Table 1</xref> (Materials and methods Tables of parameters).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79908-fig7-v1.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>Comparison between finite-size networks and approximate mathematical description for the context-dependent categorization task.</title><p>Details are as in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>. In all panels, the top and bottom plots show, respectively, results for the synaptic drive <inline-formula><mml:math id="inf194"><mml:mi mathvariant="bold-italic">k</mml:mi></mml:math></inline-formula> and the activity <inline-formula><mml:math id="inf195"><mml:mi mathvariant="bold-italic">y</mml:mi></mml:math></inline-formula>. (<bold>A</bold>) Average category selectivity. Theory was computed from <xref ref-type="disp-formula" rid="equ142">Equation 124</xref>. Simulations results were computed by using <xref ref-type="disp-formula" rid="equ71">Equation 56</xref>, and then averaging across neurons. We also plot results for category clustering (triangles); clustering was computed by applying <xref ref-type="disp-formula" rid="equ142">Equation 124</xref> to simulated data. (<bold>B</bold>) Average context selectivity. Theory was computed from <xref ref-type="disp-formula" rid="equ143">Equation 125</xref>. Simulations results were computed by using <xref ref-type="disp-formula" rid="equ140">Equation 122</xref>, and then averaging across neurons. Context clustering was computed from <xref ref-type="disp-formula" rid="equ143">Equation 125</xref>. (<bold>C</bold>) Context correlation. Theory was computed from <xref ref-type="disp-formula" rid="equ145">Equation 127</xref>. Simulations results were obtained applying <xref ref-type="disp-formula" rid="equ145">Equation 127</xref> to simulated data. (<bold>D–F</bold>) Details as in A–C. We used different parameters (see <xref ref-type="table" rid="table2">Table 2</xref>), which lead to positive changes in context correlation.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79908-fig7-figsupp1-v1.tif"/></fig></fig-group><p>The transition from unstructured activity (<xref ref-type="fig" rid="fig7">Figure 7A</xref>) to four clouds of activity (<xref ref-type="fig" rid="fig7">Figure 7B, C</xref>) occurs by learning-induced movement along two directions: <inline-formula><mml:math id="inf196"><mml:msup><mml:mi mathvariant="bold-italic">d</mml:mi><mml:mtext>cat</mml:mtext></mml:msup></mml:math></inline-formula>, which corresponds to category, and <inline-formula><mml:math id="inf197"><mml:msup><mml:mi mathvariant="bold-italic">d</mml:mi><mml:mtext>ctx</mml:mtext></mml:msup></mml:math></inline-formula>, which corresponds to context. Activity vectors in different categories move by different amounts along <inline-formula><mml:math id="inf198"><mml:msup><mml:mi mathvariant="bold-italic">d</mml:mi><mml:mtext>cat</mml:mtext></mml:msup></mml:math></inline-formula>; this causes the orange and blue symbols in <xref ref-type="fig" rid="fig7">Figure 7B, C</xref> to move apart, so that activity vectors associated with the same category become closer than vectors associated with opposite categories. As in the simple task, this in turn causes the category selectivity to increase, as shown in <xref ref-type="fig" rid="fig6">Figure 6D, G</xref> (Materials and methods Detailed analysis of category selectivity). Similar learning dynamics occurs for context: activity vectors from different contexts move by different amounts along <inline-formula><mml:math id="inf199"><mml:msup><mml:mi mathvariant="bold-italic">d</mml:mi><mml:mtext>ctx</mml:mtext></mml:msup></mml:math></inline-formula>. This causes the squares and circles in <xref ref-type="fig" rid="fig7">Figure 7B, C</xref> to move apart, so that activity vectors from the same context become closer than vectors from different contexts. Again, this in turn causes the context selectivity to increase, as shown in <xref ref-type="fig" rid="fig6">Figure 6E, H</xref> (Materials and methods Detailed analysis of context selectivity). Mathematical analysis indicates that the increase in clustering by category and context is independent of model parameters (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1B</xref>), which explains the robustness of the increase in selectivity observed in simulations.</p><p>The category- and the context-related structures that emerge in <xref ref-type="fig" rid="fig7">Figure 7B, C</xref> have different origins and different significance. The emergence of category-related structure is, perhaps, not surprising: over learning, the activity of the readout neuron becomes category dependent, as required by the task; such dependence is then directly inherited by the intermediate layer, where activity clusters by category. This structure was already observed in the simple categorization task (<xref ref-type="fig" rid="fig3">Figure 3B, C</xref>). The emergence of context-related structure is, on the other hand, more surprising, since the activity of the readout neuron does not depend on context. Nevertheless, context-dependent structure, in the form of clustering, emerges in the intermediate layer activity. Such novel structure is a signature of the gradient-descent learning rule used by the circuit (<xref ref-type="bibr" rid="bib10">Canatar et al., 2021</xref>). The mechanism through which context clustering emerges is described in detail in Materials and methods Detailed analysis of context selectivity. But, roughly speaking, context clustering emerges because, for a pair of sensory inputs, how similarly their intermediate-layer representations evolve during learning is determined both by their target category and their correlations (<xref ref-type="disp-formula" rid="equ37">Equation 27</xref>, Materials and methods Evolution of connectivity and activity in large circuits). In the simple task, initial correlations were virtually nonexistent (<xref ref-type="fig" rid="fig2">Figure 2C</xref>), and thus activity changes were specified only by category; in the context-dependent task, initial correlations have structure (<xref ref-type="fig" rid="fig6">Figure 6C</xref>), and that structure critically affects neural representations. In particular, inputs with the same context tend to be relatively correlated, and those are also likely to be associated with the same category; their representations are thus clustered by the learning algorithm, resulting in context clustering.</p><p>While the clustering by category and context described in <xref ref-type="fig" rid="fig7">Figure 7B, C</xref> is robust across circuits, the position of clouds in the activity space is not. As in the simple task, the variability in cloud position explains the variability in context correlation (although the relationship between clouds position and correlations is more complex in this case, see Materials and methods Context-dependent categorization task). In <xref ref-type="fig" rid="fig7">Figure 7D–F</xref>, we show how context correlation depends on model parameters. This dependence is qualitatively similar to that of category correlation in the simple task: context correlation depends on the threshold and gain of neurons (compare <xref ref-type="fig" rid="fig7">Figure 7D</xref> and <xref ref-type="fig" rid="fig4">Figure 4A</xref>), on the relative learning rate <inline-formula><mml:math id="inf200"><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (compare <xref ref-type="fig" rid="fig7">Figure 7E</xref> and <xref ref-type="fig" rid="fig4">Figure 4C</xref>), and on the number of stimuli (compare <xref ref-type="fig" rid="fig7">Figure 7F</xref> and <xref ref-type="fig" rid="fig4">Figure 4D</xref>). However, we find that the region of parameter space leading to an increase in correlation shrinks substantially compared to the simple task (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2C</xref>, see also Materials and methods Context-dependent task: computing activity); this is in line with the observation that correlations decrease to negative values when the complexity of the task increases, as shown in <xref ref-type="fig" rid="fig4">Figure 4D</xref>.</p></sec><sec id="s2-8"><title>Patterns of pure and mixed selectivity are shaped by initial activity</title><p>As a final step, we take a closer look at single-neuron selectivity. Analysis from the previous sections indicates that the average selectivity to both category and context increases over learning. And, as in the simple task, the increase is highly variable across neurons (<xref ref-type="fig" rid="fig6">Figure 6D, E and G, H</xref>). To determine which neurons become the most selective to category and context, we analyze the directions along which clustering to category and context occurs, <inline-formula><mml:math id="inf201"><mml:msup><mml:mi mathvariant="bold-italic">d</mml:mi><mml:mtext>cat</mml:mtext></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf202"><mml:msup><mml:mi mathvariant="bold-italic">d</mml:mi><mml:mtext>ctx</mml:mtext></mml:msup></mml:math></inline-formula> (<xref ref-type="fig" rid="fig7">Figure 7B, C</xref>). In analogy with the simple task, neurons that strongly increase selectivity to category are characterized by a large component along the category direction <inline-formula><mml:math id="inf203"><mml:msup><mml:mi mathvariant="bold-italic">d</mml:mi><mml:mtext>cat</mml:mtext></mml:msup></mml:math></inline-formula>; similarly, neurons that strongly increase selectivity to context are characterized by a large component along the context direction <inline-formula><mml:math id="inf204"><mml:msup><mml:mi mathvariant="bold-italic">d</mml:mi><mml:mtext>ctx</mml:mtext></mml:msup></mml:math></inline-formula> (<xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3A, B</xref>).</p><p>Analysis in Materials and methods Analysis of patterns of context and category selectivity shows that both the category and context directions, <inline-formula><mml:math id="inf205"><mml:msup><mml:mi mathvariant="bold-italic">d</mml:mi><mml:mtext>cat</mml:mtext></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf206"><mml:msup><mml:mi mathvariant="bold-italic">d</mml:mi><mml:mtext>ctx</mml:mtext></mml:msup></mml:math></inline-formula>, are strongly correlated with the initial readout vector <inline-formula><mml:math id="inf207"><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>. As in the simple task, this leads to the prediction that neurons that strongly increase selectivity to either category or context are, before learning, strongly connected to the downstream readout neuron (<xref ref-type="fig" rid="fig8">Figure 8A</xref>).</p><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Patterns of pure and mixed selectivity to category and context.</title><p>(<bold>A</bold>) Changes in category selectivity (left) and context selectivity (right) as a function of the initial readout connectivity, <inline-formula><mml:math id="inf208"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (in absolute value). Details as in <xref ref-type="fig" rid="fig5">Figure 5B, C</xref>. (<bold>B</bold>) Changes in context selectivity as a function of changes in category selectivity. Note the logarithmic scale on the <inline-formula><mml:math id="inf209"><mml:mi>x</mml:mi></mml:math></inline-formula>-axis; this is required by the heavy-tailed behaviour of category selectivity (<xref ref-type="fig" rid="fig6">Figure 6D, G</xref>). We highlighted two sample neurons: one with strong, pure selectivity to category (yellow) and one with strong, mixed selectivity to category and context (orange). (<bold>C</bold>) Neurons that develop pure and mixed selectivity are characterized by different patterns of initial activity. Here, we plot the gain-based measure of activity defined in <xref ref-type="disp-formula" rid="equ211">Equation 183</xref> for neurons that belong to the former (left), and the latter (right) group. The former group includes neurons for which the change in category selectivity, but not the change in context selectivity, is within the top 15% across the population. The latter group includes neurons for which the change in both category and context selectivity is within the top 15%. Dots show results for the circuit analyzed in panels A and B. Grey lines show results for 20 different circuit realizations; note that the slope is positive for all circuits. All panels in the figure show results for the circuit displayed in the second column of <xref ref-type="fig" rid="fig6">Figure 6</xref>; the circuit displayed in the third column yields qualitatively similar results (<xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3C, D</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-79908-fig8-v1.tif"/></fig><p>Although <inline-formula><mml:math id="inf210"><mml:msup><mml:mi mathvariant="bold-italic">d</mml:mi><mml:mtext>cat</mml:mtext></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf211"><mml:msup><mml:mi mathvariant="bold-italic">d</mml:mi><mml:mtext>ctx</mml:mtext></mml:msup></mml:math></inline-formula> are both correlated with <inline-formula><mml:math id="inf212"><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, they are not perfectly aligned (Materials and methods Analysis of patterns of context and category selectivity). In principle, then, for a given neuron (here, neuron <inline-formula><mml:math id="inf213"><mml:mi>i</mml:mi></mml:math></inline-formula>), both <inline-formula><mml:math id="inf214"><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mtext>cat</mml:mtext></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf215"><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mtext>ctx</mml:mtext></mml:msubsup></mml:math></inline-formula> could be large (implying mixed selectivity to both abstract variables, category and context), or only one could be large (implying pure selectivity to only one abstract variable, category or context), or both could be small (implying no selectivity at all). While all combinations are possible in principle, in the model they do not all occur. In <xref ref-type="fig" rid="fig8">Figure 8B</xref>, we plot changes in context selectivity as a function of changes in category selectivity. We observe that, among all the neurons that strongly increase their selectivity, some increase selectivity to both category and context (orange sample neuron), and others increase selectivity to category, but not context (yellow sample neuron). In contrast, none increases selectivity to context but not category. This makes the following experimental prediction: among all the neurons that are strongly connected to the readout, neurons with pure selectivity to category and neurons with mixed selectivity to category and context should be observed, but neurons with pure selectivity to context should not. The asymmetry between category and context arises because, in the model, the readout neuron learns to read out category, but not context. We show in <xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3E, F</xref> that if a second readout neuron, which learns to read out context, is included in the circuit, neurons with strong pure selectivity to context are also observed.</p><p>What determines whether a given neuron develops pure selectivity to category, or mixed selectivity to category and context? Analysis reported in Materials and methods Analysis of patterns of context and category selectivity indicates that these two populations are characterized by different properties of the initial activity. In particular, the two populations are characterized by different initial patterns of the response gain (defined as the slope of the activation function, <xref ref-type="fig" rid="fig1">Figure 1C</xref>, at the response), which measures the local sensitivity of neurons to their inputs. The exact patterns that the response gain takes across the two populations is described in detail in Materials and methods Analysis of patterns of context and category selectivity (<xref ref-type="disp-formula" rid="equ211">Equation 183</xref>); the fact that pure- and mixed-selective neurons can be distinguished based on these patterns is illustrated in <xref ref-type="fig" rid="fig8">Figure 8C</xref>. Overall, these results indicate that initial activity, which is mostly unstructured and task-agnostic, plays an important role in learning: it breaks the symmetry among neurons in the intermediate layer, and determines which functional specialization neurons will display over learning.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>How does the brain learn to link sensory stimuli to abstract variables? Despite decades of experimental (<xref ref-type="bibr" rid="bib3">Asaad et al., 1998</xref>; <xref ref-type="bibr" rid="bib48">Messinger et al., 2001</xref>; <xref ref-type="bibr" rid="bib22">Freedman and Assad, 2006</xref>; <xref ref-type="bibr" rid="bib56">Reinert et al., 2021</xref>) and theoretical (<xref ref-type="bibr" rid="bib59">Rosenblatt, 1958</xref>; <xref ref-type="bibr" rid="bib5">Barak et al., 2013</xref>; <xref ref-type="bibr" rid="bib16">Engel et al., 2015</xref>) work, the answer to this question remains elusive. Here, we hypothesized that learning occurs via gradient-descent synaptic plasticity. To explore the implications of this hypothesis, we considered a minimal model: a feedforward circuit with one intermediate layer, assumed to contain a large number of neurons compared to the number of stimuli. This assumption allowed us to thoroughly analyze the model, and thus gain insight into how activity evolves during learning, and how that evolution supports task acquisition.</p><p>We focused on two categorization tasks: a simple one (<xref ref-type="fig" rid="fig2">Figure 2</xref>), in which category was determined solely by the stimulus, and a complex one (<xref ref-type="fig" rid="fig6">Figure 6</xref>), in which category was determined by both the stimulus and the context. We showed that, over learning, single neurons become selective to abstract variables: category (which is explicitly reinforced) and context (which is not; instead, it embodies the task structure, and is only implicitly cued). From a geometrical perspective, the emergence of selectivity during learning is driven by clustering: activity associated with stimuli in different categories is pushed apart, forming distinct clusters (<xref ref-type="fig" rid="fig3">Figure 3</xref>). In the context-dependent task, additional clustering occurs along a second, context-related axis; this results in activity forming four different clouds, one for each combination of category and context (<xref ref-type="fig" rid="fig7">Figure 7</xref>). While the behaviour of selectivity is highly stereotyped, the behaviour of signal correlations and tuning symmetry is not, but depends on details (<xref ref-type="fig" rid="fig4">Figure 4</xref>). From a geometrical perspective, the variability in correlations and symmetry is due to the variability in the position of category and context clusters with respect to initial activity.</p><p>Our work was motivated partly by the observation that responses to different categories in monkeys area LIP were positively correlated and asymmetric (<xref ref-type="bibr" rid="bib19">Fitzgerald et al., 2013</xref>) – a finding that seems at odds with experimental observations in sensory, and other associative, brain areas (<xref ref-type="bibr" rid="bib13">Cromer et al., 2010</xref>; <xref ref-type="bibr" rid="bib56">Reinert et al., 2021</xref>). It has been suggested that those responses arise as a result of learning that drives activity in area LIP onto an approximately one-dimensional manifold (<xref ref-type="bibr" rid="bib24">Ganguli et al., 2008</xref>; <xref ref-type="bibr" rid="bib19">Fitzgerald et al., 2013</xref>; <xref ref-type="bibr" rid="bib67">Summerfield et al., 2020</xref>). Our results are broadly in line with this hypothesis: for the simple categorization task, which is similar to <xref ref-type="bibr" rid="bib19">Fitzgerald et al., 2013</xref>, we showed that activity stretches along a single direction (<xref ref-type="disp-formula" rid="equ4">Equation 3</xref>, <xref ref-type="fig" rid="fig3">Figure 3C</xref>). Analysis in Materials and methods Evolution of activity further shows that not only at the end of learning, but at every learning epoch, activity is aligned along a single direction; the whole learning dynamics is thus approximately one-dimensional. However, in the context-dependent categorization task, activity stretches along two dimensions (<xref ref-type="fig" rid="fig7">Figure 7B, C</xref>), indicating that one dimension does not always capture activity.</p><p>Our analysis makes several experimental predictions. First, it makes specific predictions about how category and context correlations should vary with properties of the circuit (threshold and gain of neurons, relative learning rates) and with the task (number of stimuli, context dependence) (<xref ref-type="fig" rid="fig4">Figure 4</xref>). These could be tested with current technology; in particular, testing the dependence on task variables only requires recording neural activity. Second, it predicts that selectivity is shaped by connectivity with downstream areas, a result that is in line with recent experimental observations (<xref ref-type="bibr" rid="bib26">Glickfeld et al., 2013</xref>; <xref ref-type="bibr" rid="bib77">Ye et al., 2016</xref>; <xref ref-type="bibr" rid="bib29">Hirokawa et al., 2019</xref>; <xref ref-type="bibr" rid="bib28">Gschwend et al., 2021</xref>). More specifically, it predicts that, for a given neuron, selectivity correlates with the strength of the synaptic connection that the neuron makes to the downstream neurons that read out category (<xref ref-type="fig" rid="fig5">Figure 5B, C</xref> and <xref ref-type="fig" rid="fig8">Figure 8A</xref>). Across all neurons that are strongly connected to downstream readout neurons, selectivity to category and context is distributed in a highly stereotyped way: during learning, some neurons develop mixed selective to category and context, others develop pure selectivity to category, but none develop pure selectivity to context (<xref ref-type="fig" rid="fig8">Figure 8B</xref>). Moreover, whether a neuron develops mixed or pure selectivity depends on initial activity (<xref ref-type="fig" rid="fig8">Figure 8C</xref>).</p><sec id="s3-1"><title>Previous models for categorization</title><p>Previous theoretical studies have investigated how categorization can be implemented in multi-layer neural circuits (<xref ref-type="bibr" rid="bib5">Barak et al., 2013</xref>; <xref ref-type="bibr" rid="bib4">Babadi and Sompolinsky, 2014</xref>; <xref ref-type="bibr" rid="bib41">Litwin-Kumar et al., 2017</xref>; <xref ref-type="bibr" rid="bib52">Pannunzi et al., 2012</xref>; <xref ref-type="bibr" rid="bib16">Engel et al., 2015</xref>; <xref ref-type="bibr" rid="bib69">Villagrasa et al., 2018</xref>; <xref ref-type="bibr" rid="bib49">Min et al., 2020</xref>). Several of those studies considered a circuit model in which the intermediate connectivity matrix, <inline-formula><mml:math id="inf216"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula>, is fixed, and only the readout vector, <inline-formula><mml:math id="inf217"><mml:mi mathvariant="bold-italic">w</mml:mi></mml:math></inline-formula>, evolves (via Hebbian plasticity) over learning (<xref ref-type="bibr" rid="bib5">Barak et al., 2013</xref>; <xref ref-type="bibr" rid="bib4">Babadi and Sompolinsky, 2014</xref>; <xref ref-type="bibr" rid="bib41">Litwin-Kumar et al., 2017</xref>). This model can learn both the simple (linearly separable) and complex (nonlinearly separable) tasks (<xref ref-type="bibr" rid="bib5">Barak et al., 2013</xref>). Because there is no learning in the intermediate connectivity, activity in the intermediate layer remains unstructured, and high dimensional, throughout learning. This stands in sharp contrast to our model, where learning leads to structure in the form of clustering – and, thus, a reduction in activity dimensionality.</p><p>One study did consider a model in which both the intermediate and the readout connectivity evolve over learning, according to reward-modulated Hebbian plasticity (<xref ref-type="bibr" rid="bib16">Engel et al., 2015</xref>). This circuit could learn a simple categorization task but, in contrast to our study, learning did not lead to significant changes in the activity of the intermediate layer. When feedback connectivity was introduced, learning did lead to activity changes in the intermediate layer, and those activity changes led to an increase in category selectivity – a finding that is in line with ours. There were, however, several notable differences relative to our model. First, learning of the intermediate and readout weights occurred on separate timescales: the intermediate connectivity only started to significantly change when the readout connectivity was completely rewired; in our model, in contrast, the two set of weights evolve on similar timescales. Second, population responses were negatively correlated and symmetric; whether positively correlated and asymmetric responses (as seen in experiments, <xref ref-type="bibr" rid="bib19">Fitzgerald et al., 2013</xref>, and in our model) can also be achieved remains to be established. Third, context-dependent associations, that are core to a variety of experimental tasks (<xref ref-type="bibr" rid="bib70">Wallis et al., 2001</xref>; <xref ref-type="bibr" rid="bib60">Roy et al., 2010</xref>; <xref ref-type="bibr" rid="bib46">McKenzie et al., 2014</xref>; <xref ref-type="bibr" rid="bib9">Brincat et al., 2018</xref>; <xref ref-type="bibr" rid="bib56">Reinert et al., 2021</xref>; <xref ref-type="bibr" rid="bib43">Mante et al., 2013</xref>), were not considered. Whether reward-modulated Hebbian plasticity can be used to learn context-dependent tasks is unclear, and represents an important avenue for future work.</p></sec><sec id="s3-2"><title>Gradient-descent learning in the brain</title><p>A common feature of the studies described above is that learning is implemented via Hebbian synaptic plasticity – a form of plasticity that is known to occur in the brain. Our model, on the other hand, uses gradient-descent learning in a multi-layer network, which requires back-propagation of an error signal; whether and how such learning is implemented in the brain is an open question (<xref ref-type="bibr" rid="bib73">Whittington and Bogacz, 2019</xref>). A number of recent theoretical studies have proposed biologically plausible architectures and plasticity rules that can approximate back-propagation on simple and complex tasks (<xref ref-type="bibr" rid="bib40">Lillicrap et al., 2016</xref>; <xref ref-type="bibr" rid="bib61">Sacramento et al., 2018</xref>; <xref ref-type="bibr" rid="bib1">Akrout et al., 2019</xref>; <xref ref-type="bibr" rid="bib72">Whittington and Bogacz, 2017</xref>; <xref ref-type="bibr" rid="bib54">Payeur et al., 2021</xref>; <xref ref-type="bibr" rid="bib55">Pogodin and Latham, 2020</xref>; <xref ref-type="bibr" rid="bib7">Boopathy and Fiete, 2022</xref>). Understanding whether these different implementations lead to differences in activity represents a very important direction for future research. Interestingly, recent work has showed that it is possible to design circuit models where the learning dynamics is identical to the one studied in this work, but the architecture is biologically plausible (<xref ref-type="bibr" rid="bib7">Boopathy and Fiete, 2022</xref>). We expect our results to directly translate to those models. Other biologically plausible setups might be characterized, instead, by different activity evolution. Recent work (<xref ref-type="bibr" rid="bib64">Song et al., 2021</xref>; <xref ref-type="bibr" rid="bib8">Bordelon and Pehlevan, 2022</xref>) made use of a formalism similar to ours to describe learning dynamics induced by a number of different biologically plausible algorithms and uncovered non-trivial, qualitatively different dynamics. Whether any of these dynamics leads to different neural representations in neuroscience-inspired categorization tasks like the ones we studied here is an open, and compelling, question.</p><p>In this work, we used mathematical analysis to characterize the activity changes that emerge during gradient-descent learning. Our analysis relied on two assumptions. First, the number of neurons in the circuit is large compared to the number of stimuli to classify. Second, the synaptic weights are chosen so that the initial activity in all layers of the network lies within an intermediate range (i.e., it neither vanishes nor saturates) before learning starts (<xref ref-type="bibr" rid="bib34">Jacot et al., 2018</xref>; <xref ref-type="bibr" rid="bib12">Chizat et al., 2019</xref>; <xref ref-type="bibr" rid="bib38">Lee et al., 2019</xref>; <xref ref-type="bibr" rid="bib42">Liu et al., 2020</xref>). These two assumptions are reasonable for brain circuits, across time scales ranging from development to animals’ lifetimes; a discussion on the limitations of our approach is given in Materials and methods Evolution of activity in finite-size networks.</p><p>A prominent feature of learning under these assumptions is that changes in both the synaptic weights and activity are small in amplitude (Materials and methods Evolution of connectivity and activity in large circuits). This has an important implication: the final configuration of the circuit depends strongly on the initial one. We have showed, for example, that the selectivity properties that single neurons display at the end of learning are determined by their initial activity and connectivity (<xref ref-type="fig" rid="fig5">Figure 5B, C</xref> and <xref ref-type="fig" rid="fig8">Figure 8A, C</xref>). Moreover, the final distribution of selectivity indices, and the final patterns of correlations, bear some resemblance to the initial ones (see, e.g., <xref ref-type="fig" rid="fig6">Figure 6</xref>); for this reason, we characterized activity evolution via changes in activity measures, rather than their asymptotic, post-learning values. Overall, these findings stress the importance of recording activity throughout the learning process to correctly interpret neural data (<xref ref-type="bibr" rid="bib65">Steinmetz et al., 2021</xref>; <xref ref-type="bibr" rid="bib36">Latimer and Freedman, 2021</xref>).</p><p>Circuits that violate either of the two assumptions discussed above may exhibit different gradient-descent learning dynamics than we saw in our model (<xref ref-type="bibr" rid="bib12">Chizat et al., 2019</xref>), and could result in different activity patterns over learning. Previous studies have analyzed circuits with linear activation functions and weak connectivity (weak enough that activity is greatly attenuated as it passes through the network). However, linear activation functions can only implement a restricted set of tasks (<xref ref-type="bibr" rid="bib62">Saxe et al., 2019</xref>; <xref ref-type="bibr" rid="bib39">Li and Sompolinsky, 2021</xref>; <xref ref-type="bibr" rid="bib50">Moroshko et al., 2020</xref>; in particular, they cannot implement the context-dependent task we considered). Developing tools to analyze arbitrary circuits will prove critical to achieving a general understanding of how learning unfolds in the brain (<xref ref-type="bibr" rid="bib47">Mei et al., 2018</xref>; <xref ref-type="bibr" rid="bib75">Yang and Hu, 2021</xref>; <xref ref-type="bibr" rid="bib20">Flesch et al., 2022</xref>).</p></sec><sec id="s3-3"><title>Beyond simplified models</title><p>Throughout this work, we focussed on two simplified categorization tasks, aimed at capturing the fundamental features of the categorization tasks commonly used in systems neuroscience (<xref ref-type="bibr" rid="bib22">Freedman and Assad, 2006</xref>; <xref ref-type="bibr" rid="bib18">Fitzgerald et al., 2011</xref>; <xref ref-type="bibr" rid="bib70">Wallis et al., 2001</xref>). The mathematical framework we developed to analyze those tasks could, however, easily be extended in several directions, including tasks with more than two categories (<xref ref-type="bibr" rid="bib18">Fitzgerald et al., 2011</xref>; <xref ref-type="bibr" rid="bib56">Reinert et al., 2021</xref>; <xref ref-type="bibr" rid="bib43">Mante et al., 2013</xref>) and tasks involving generalization to unseen stimuli (<xref ref-type="bibr" rid="bib5">Barak et al., 2013</xref>; <xref ref-type="bibr" rid="bib10">Canatar et al., 2021</xref>). An important feature missing in our tasks, though, is memory: neuroscience tasks usually involve a delay period during which the representation of the output category must be sustained in the absence of sensory inputs (<xref ref-type="bibr" rid="bib22">Freedman and Assad, 2006</xref>; <xref ref-type="bibr" rid="bib18">Fitzgerald et al., 2011</xref>; <xref ref-type="bibr" rid="bib70">Wallis et al., 2001</xref>). Experiments indicate that category representations are different in the stimulus presentation and the delay periods (<xref ref-type="bibr" rid="bib22">Freedman and Assad, 2006</xref>). Investigating these effects in our tasks would require the addition of recurrent connectivity to the model. Mathematical tools for analyzing learning dynamics in recurrent networks is starting to become available (<xref ref-type="bibr" rid="bib44">Mastrogiuseppe and Ostojic, 2019</xref>; <xref ref-type="bibr" rid="bib63">Schuessler et al., 2020</xref>; <xref ref-type="bibr" rid="bib15">Dubreuil et al., 2022</xref>; <xref ref-type="bibr" rid="bib68">Susman et al., 2021</xref>), which could allow our analysis to be extended in that direction.</p><p>To model categorization, we assumed a quadratic function for the error <inline-formula><mml:math id="inf218"><mml:mi class="ltx_font_mathcaligraphic">ℰ</mml:mi></mml:math></inline-formula> (Materials and methods Circuit) – an assumption that effectively casts our categorization tasks into a regression problem. This made the model amenable to mathematical analysis, and allowed us to derive transparent equations to characterize activity evolution. Recent machine-learning work has showed that, at least in some categorization setups (<xref ref-type="bibr" rid="bib33">Hui and Belkin, 2021</xref>), a cross-entropy function might result in better learning performance. The mathematical framework used here is, however, not well suited to studying networks with such an error function (<xref ref-type="bibr" rid="bib38">Lee et al., 2019</xref>). Investigating whether and how our findings extend to networks trained with a cross-entropy error function represents an interesting direction for future work.</p><p>Finally, in this study we focussed on a circuit model with a single intermediate layer. In the brain, in contrast, sensory inputs are processed across a number of stages within the cortical hierarchy. Our analysis could easily be extended to include multiple intermediate layers. That would allow our predictions to be extended to experiments involving multi-area recordings, which are increasingly common in the field (<xref ref-type="bibr" rid="bib27">Goltstein et al., 2021</xref>). Current recording techniques, furthermore, allow monitoring neural activity throughout the learning process (<xref ref-type="bibr" rid="bib56">Reinert et al., 2021</xref>; <xref ref-type="bibr" rid="bib27">Goltstein et al., 2021</xref>); those data could be used in future studies to further test the applicability of our model.</p></sec><sec id="s3-4"><title>Bridging connectivity and selectivity</title><p>In this work, we considered a circuit with a single readout neuron, trained to discriminate between two categories. One readout neuron is sufficient because, in the tasks we considered, categories are mutually exclusive (<xref ref-type="bibr" rid="bib19">Fitzgerald et al., 2013</xref>). We have found that the initial readout weights play a key role in determining the directions of activity evolution, suggesting that circuits with different or additional readout neurons might lead to different activity configurations. For example, one might consider a circuit with two readout neurons, each highly active in response to a different category. And indeed, recent work in mouse PFC suggests that two readout circuits are used for valence – one strongly active for positive valence, and one strongly active for negative one (<xref ref-type="bibr" rid="bib77">Ye et al., 2016</xref>). Also, in context-dependent tasks, one might consider a circuit with an additional readout for context. We have showed in <xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3E, F</xref> that this model leads to different experimental predictions for selectivity than the model with only one readout for category (<xref ref-type="fig" rid="fig8">Figure 8B</xref>). Altogether, these observations indicate that functional properties of neurons are tighly linked to their long-range projections – a pattern that strongly resonates with recent experimental findings (<xref ref-type="bibr" rid="bib29">Hirokawa et al., 2019</xref>; <xref ref-type="bibr" rid="bib76">Yang et al., 2022</xref>). Constraining model architectures with connectomics, and then using models to interpret neural recordings, represents a promising line of future research.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Overview</title><p>In the main text, we made qualitative arguments about the evolution of activity over learning. Here, we make those arguments quantitative. We start with a detailed description of the circuit model (Section Model). We then derive approximate analytical expressions that describe how activity in the circuit evolves over learning (Section Evolution of connectivity and activity in large circuits). To this end, we use an approach that is valid for large circuits. We apply this approach first to the simple task (Section Simple categorization task), then to the context-dependent one (Section Context-dependent categorization task). Finally, we provide details on the numerical implementation of circuit models and analytical expressions (Section Software).</p></sec><sec id="s4-2"><title>Model</title><sec id="s4-2-1"><title>Circuit</title><p>We consider a feedforward circuit with a single intermediate layer (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). For simplicity, we assume that the input and the intermediate layer have identical size <inline-formula><mml:math id="inf219"><mml:mi>N</mml:mi></mml:math></inline-formula>, and we consider <inline-formula><mml:math id="inf220"><mml:mi>N</mml:mi></mml:math></inline-formula> to be large. The sensory input vector is indicated with <inline-formula><mml:math id="inf221"><mml:mi mathvariant="bold-italic">x</mml:mi></mml:math></inline-formula>. Activity in the intermediate layer reads<disp-formula id="equ6"><label>(5a)</label><mml:math id="m6"><mml:mi>y</mml:mi><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ7"><label>(5b)</label><mml:math id="m7"><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi/><mml:mo>≡</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>⋅</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>x</mml:mi></mml:mpadded></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf222"><mml:mi mathvariant="bold-italic">k</mml:mi></mml:math></inline-formula> represents the synaptic drive and <inline-formula><mml:math id="inf223"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula> is an <inline-formula><mml:math id="inf224"><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> connectivity matrix. Activity in the readout layer is given by<disp-formula id="equ8"><label>(6a)</label><mml:math id="m8"><mml:mi>z</mml:mi><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ9"><label>(6b)</label><mml:math id="m9"><mml:mi>h</mml:mi><mml:mrow><mml:mi/><mml:mo>≡</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>⋅</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf225"><mml:mi>h</mml:mi></mml:math></inline-formula> is the synaptic drive and <inline-formula><mml:math id="inf226"><mml:mi mathvariant="bold-italic">w</mml:mi></mml:math></inline-formula> is an <inline-formula><mml:math id="inf227"><mml:mi>N</mml:mi></mml:math></inline-formula>-dimensional readout vector.</p><p>The activation functions <inline-formula><mml:math id="inf228"><mml:mi mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf229"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula> are non-negative, monotonically increasing functions that model the input-to-output properties of units in the intermediate and readout layer, respectively. In simulations, we use sigmoidal functions,<disp-formula id="equ10"><label>(7)</label><mml:math id="m10"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>and similarly for <inline-formula><mml:math id="inf230"><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). The parameters of the activation functions, <inline-formula><mml:math id="inf231"><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf232"><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>, determine the gain and threshold, respectively, with the gain (defined to be the slope at <inline-formula><mml:math id="inf233"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>) given by <inline-formula><mml:math id="inf234"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>. Their values, which vary across simulations, are given in Section Tables of parameters.</p><p>The synaptic weights, <inline-formula><mml:math id="inf235"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf236"><mml:mi mathvariant="bold-italic">w</mml:mi></mml:math></inline-formula>, are initialized at random from a zero-mean Gaussian distribution with variance <inline-formula><mml:math id="inf237"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>. The sensory input vectors <inline-formula><mml:math id="inf238"><mml:mi mathvariant="bold-italic">x</mml:mi></mml:math></inline-formula> are also drawn from a zero-mean Gaussian distribution (see Sections Simple task: task definition and Context-dependent task: task definition), but with variance equal to 1,<disp-formula id="equ11"><label>(8a)</label><mml:math id="m11"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ12"><label>(8b)</label><mml:math id="m12"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the subscript ‘0’ on the weights indicates that those are evaluated before learning starts. This choice of initialization ensures that, before learning, the amplitude of both the synaptic drive (<inline-formula><mml:math id="inf239"><mml:mi>h</mml:mi></mml:math></inline-formula>, and the components of <inline-formula><mml:math id="inf240"><mml:mi mathvariant="bold-italic">k</mml:mi></mml:math></inline-formula>) and the activity (<inline-formula><mml:math id="inf241"><mml:mi>z</mml:mi></mml:math></inline-formula>, and the components of <inline-formula><mml:math id="inf242"><mml:mi mathvariant="bold-italic">y</mml:mi></mml:math></inline-formula>) are independent of the circuit size (i.e., <inline-formula><mml:math id="inf243"><mml:mrow><mml:mi>O</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in <inline-formula><mml:math id="inf244"><mml:mi>N</mml:mi></mml:math></inline-formula>).</p></sec><sec id="s4-2-2"><title>Gradient-descent plasticity</title><p>The circuit learns to categorize <inline-formula><mml:math id="inf245"><mml:mi>P</mml:mi></mml:math></inline-formula> sensory input vectors <inline-formula><mml:math id="inf246"><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula> (<inline-formula><mml:math id="inf247"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>), with <inline-formula><mml:math id="inf248"><mml:mrow><mml:mi>P</mml:mi><mml:mo>≪</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>. For each input vector, the target activity of the readout neuron, <inline-formula><mml:math id="inf249"><mml:msup><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula>, is equal to either <inline-formula><mml:math id="inf250"><mml:msup><mml:mi>z</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> or <inline-formula><mml:math id="inf251"><mml:msup><mml:mi>z</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula> (Sections Simple task: task definition and Context-dependent task: task definition), which correspond to high and low activity, respectively. The weights are adjusted to minimize the loss, <inline-formula><mml:math id="inf252"><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">ℰ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which is defined to be<disp-formula id="equ13"><label>(9)</label><mml:math id="m13"><mml:mrow><mml:mrow><mml:mi mathvariant="script">E</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≡</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>P</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>z</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf253"><mml:msup><mml:mi>z</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula> is the activity of the readout neuron (<xref ref-type="disp-formula" rid="equ8">Equation 6a</xref>) in response to the sensory input <inline-formula><mml:math id="inf254"><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula>. The weights are updated according to full-batch vanilla gradient descent. If the learning rates, <inline-formula><mml:math id="inf255"><mml:msub><mml:mi>η</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf256"><mml:msub><mml:mi>η</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></inline-formula>, are sufficiently small, the evolution of the connectivity weights can be described by the continuous-time equations (<xref ref-type="disp-formula" rid="equ1">Equation 1a</xref>, <xref ref-type="disp-formula" rid="equ2">Equation 1b</xref>)<disp-formula id="equ14"><label>(10a)</label><mml:math id="m14"><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mpadded lspace="-1.7pt" width="-1.7pt"><mml:mi mathvariant="normal">d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mpadded lspace="-1.7pt" width="-1.7pt"><mml:mi mathvariant="normal">d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>η</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi class="ltx_font_mathcaligraphic">ℰ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ15"><label>(10b)</label><mml:math id="m15"><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mpadded lspace="-1.7pt" width="-1.7pt"><mml:mi mathvariant="normal">d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mpadded lspace="-1.7pt" width="-1.7pt"><mml:mi mathvariant="normal">d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>η</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi class="ltx_font_mathcaligraphic">ℰ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf257"><mml:mi>t</mml:mi></mml:math></inline-formula> indicates learning time.</p></sec></sec><sec id="s4-3"><title>Evolution of connectivity and activity in large circuits</title><p>Our goal is to understand how learning affects activity in the intermediate layer, <inline-formula><mml:math id="inf258"><mml:mi mathvariant="bold-italic">y</mml:mi></mml:math></inline-formula>. We do that in two steps. In the first step, we analyze the evolution of the synaptic weights. In particular, we determine the weights after learning is complete – meaning after the loss (<xref ref-type="disp-formula" rid="equ13">Equation 9</xref>) has been minimized (Section Evolution of connectivity). In the second step, we use the learned weights to determine activity (Section Evolution of activity). We work in the large-<inline-formula><mml:math id="inf259"><mml:mi>N</mml:mi></mml:math></inline-formula> regime, which allows us to make analytic headway (<xref ref-type="bibr" rid="bib34">Jacot et al., 2018</xref>; <xref ref-type="bibr" rid="bib38">Lee et al., 2019</xref>; <xref ref-type="bibr" rid="bib42">Liu et al., 2020</xref>). We then validate our large-<inline-formula><mml:math id="inf260"><mml:mi>N</mml:mi></mml:math></inline-formula> analysis with finite-<inline-formula><mml:math id="inf261"><mml:mi>N</mml:mi></mml:math></inline-formula> simulations (Section Evolution of activity in finite-size networks, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>, <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>, <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>, <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>).</p><sec id="s4-3-1"><title>Evolution of connectivity</title><p>It is convenient to make the definitions<disp-formula id="equ16"><label>(11a)</label><mml:math id="m16"><mml:mi>u</mml:mi><mml:mrow><mml:mi/><mml:mo>≡</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ17"><label>(11b)</label><mml:math id="m17"><mml:mi>w</mml:mi><mml:mrow><mml:mi/><mml:mo>≡</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf262"><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf263"><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> are the initial weights (<xref ref-type="disp-formula" rid="equ11">Equation 8a</xref>), and <inline-formula><mml:math id="inf264"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf265"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow></mml:math></inline-formula> are changes in the weights induced by learning (<xref ref-type="disp-formula" rid="equ14">Equation 10</xref>). Using <xref ref-type="disp-formula" rid="equ14">Equation 10</xref>, with the loss given by <xref ref-type="disp-formula" rid="equ13">Equation 9</xref>, we see that <inline-formula><mml:math id="inf266"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf267"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow></mml:math></inline-formula> evolve according to<disp-formula id="equ18"><label>(12a)</label><mml:math id="m18"><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mpadded lspace="-1.7pt" width="-1.7pt"><mml:mi mathvariant="normal">d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mpadded lspace="-1.7pt" width="-1.7pt"><mml:mi mathvariant="normal">d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>η</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi class="ltx_font_mathcaligraphic">ℰ</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mi>P</mml:mi></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>P</mml:mi></mml:munderover></mml:mstyle><mml:mrow><mml:msup><mml:mi>ϵ</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ19"><label>(12b)</label><mml:math id="m19"><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mpadded lspace="-1.7pt" width="-1.7pt"><mml:mi mathvariant="normal">d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mpadded lspace="-1.7pt" width="-1.7pt"><mml:mi mathvariant="normal">d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>η</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi class="ltx_font_mathcaligraphic">ℰ</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mi>P</mml:mi></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>P</mml:mi></mml:munderover></mml:mstyle><mml:mrow><mml:msup><mml:mi>ϵ</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf268"><mml:msup><mml:mi>ϵ</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula> is proportional to the error associated with sensory input <inline-formula><mml:math id="inf269"><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula>,<disp-formula id="equ20"><label>(13)</label><mml:math id="m20"><mml:mrow><mml:mrow><mml:msup><mml:mi>ϵ</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>≡</mml:mo><mml:mrow><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>To evaluate the partial derivatives on the right-hand side of <xref ref-type="disp-formula" rid="equ18">Equation 12</xref>, we need to express <inline-formula><mml:math id="inf270"><mml:msup><mml:mi>h</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula> in terms of <inline-formula><mml:math id="inf271"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf272"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow></mml:math></inline-formula>. Combining <xref ref-type="disp-formula" rid="equ9">Equation 6b</xref> with <xref ref-type="disp-formula" rid="equ6">Equation 5</xref> and <xref ref-type="disp-formula" rid="equ16">Equation 11</xref>, we have<disp-formula id="equ21"><label>(14)</label><mml:math id="m21"><mml:mrow><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⋅</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mo>⋅</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:mrow></mml:mrow><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>To proceed, we assume that changes in the connectivity, <inline-formula><mml:math id="inf273"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf274"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow></mml:math></inline-formula>, are small. That holds in the large-<inline-formula><mml:math id="inf275"><mml:mi>N</mml:mi></mml:math></inline-formula> limit (the limit we consider here) because when each neuron receives a large number of inputs, none of them has to change very much to cause a large change in the output (we make this reasoning more quantitative in Section A low-order Taylor expansion is self-consistent in large circuits). Then, Taylor-expanding the nonlinear activation function <inline-formula><mml:math id="inf276"><mml:mi mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ21">Equation 14</xref>, and keeping only terms that are zeroth and first order in the weight changes <inline-formula><mml:math id="inf277"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf278"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow></mml:math></inline-formula>, we have<disp-formula id="equ22"><label>(15)</label><mml:math id="m22"><mml:mrow><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>≃</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⋅</mml:mo><mml:mrow><mml:mo maxsize="120%" minsize="120%">[</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⊙</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mo>⋅</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo maxsize="120%" minsize="120%">]</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mo>⋅</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf279"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>⊙</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> indicates element-wise multiplication, and we have defined<disp-formula id="equ23"><label>(16a)</label><mml:math id="m23"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo>≡</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⋅</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ24"><label>(16b)</label><mml:math id="m24"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo>≡</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⋅</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>For now, we assume that the three terms in the right-hand side of <xref ref-type="disp-formula" rid="equ22">Equation 15</xref> are of similar magnitude, and that higher-order terms in <inline-formula><mml:math id="inf280"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf281"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow></mml:math></inline-formula> are smaller, and so can be neglected. We will verify these assumptions post hoc (Section A low-order Taylor expansion is self-consistent in large circuits). Inserting <xref ref-type="disp-formula" rid="equ22">Equation 15</xref> into <xref ref-type="disp-formula" rid="equ18">Equation 12</xref>, we arrive at<disp-formula id="equ25"><label>(17a)</label><mml:math id="m25"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mrow/><mml:mspace width="negativethinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow/><mml:mspace width="negativethinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mi>P</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">[</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⊙</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">]</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ26"><label>(17b)</label><mml:math id="m26"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mrow/><mml:mspace width="negativethinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow/><mml:mspace width="negativethinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mi>P</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>(we used the notation where two adjacent vectors correspond to an outer product; i.e., <inline-formula><mml:math id="inf282"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>).</p><p>The only quantity on the right-hand side of <xref ref-type="disp-formula" rid="equ25">Equation 17</xref> that depends on time is <inline-formula><mml:math id="inf283"><mml:msup><mml:mi>ϵ</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula>. Consequently, we can immediately write down the solution,<disp-formula id="equ27"><label>(18a)</label><mml:math id="m27"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">[</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⊙</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">]</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ28"><label>(18b)</label><mml:math id="m28"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the coefficients <inline-formula><mml:math id="inf284"><mml:msup><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula> are found by solving the differential equation<disp-formula id="equ29"><label>(19)</label><mml:math id="m29"><mml:mrow><mml:mrow><mml:mfrac><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mpadded lspace="-1.7pt" width="-1.7pt"><mml:mi mathvariant="normal">d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mpadded lspace="-1.7pt" width="-1.7pt"><mml:mi mathvariant="normal">d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>ϵ</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>with initial conditions <inline-formula><mml:math id="inf285"><mml:mrow><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. The right-hand side of <xref ref-type="disp-formula" rid="equ29">Equation 19</xref> depends on time through the synaptic drive, <inline-formula><mml:math id="inf286"><mml:msup><mml:mi>h</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ20">Equation 13</xref>), which in turn depends on <inline-formula><mml:math id="inf287"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf288"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow></mml:math></inline-formula> through <xref ref-type="disp-formula" rid="equ22">Equation 15</xref>, and thus, via <xref ref-type="disp-formula" rid="equ27">Equation 18</xref>, on the coefficients <inline-formula><mml:math id="inf289"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Consequently, <xref ref-type="disp-formula" rid="equ29">Equation 19</xref> is a closed differential equation for the coefficients <inline-formula><mml:math id="inf290"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>In the general case, <xref ref-type="disp-formula" rid="equ29">Equation 19</xref> must be solved numerically. If, however, we are not interested in the full learning dynamics, but care only about connectivity and activity once learning has converged (<inline-formula><mml:math id="inf291"><mml:mrow><mml:mi>t</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula>), we can use the fact that dynamics in <xref ref-type="disp-formula" rid="equ25">Equation 17</xref> are guaranteed to converge to a global minimum of the error function <inline-formula><mml:math id="inf292"><mml:mi class="ltx_font_mathcaligraphic">ℰ</mml:mi></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib42">Liu et al., 2020</xref>). For our loss function and tasks, the minimum occurs at <inline-formula><mml:math id="inf293"><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">ℰ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. At that point, <inline-formula><mml:math id="inf294"><mml:mrow><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>; equivalently,<disp-formula id="equ30"><label>(20)</label><mml:math id="m30"><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf295"><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> is the inverse of the activation function of the readout neurons (which exists because <inline-formula><mml:math id="inf296"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula> is a monotonically increasing function).</p><p>To find <inline-formula><mml:math id="inf297"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, we simply express <inline-formula><mml:math id="inf298"><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in terms of <inline-formula><mml:math id="inf299"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and insert that into <xref ref-type="disp-formula" rid="equ30">Equation 20</xref>. To reduce clutter, we define (in a slight abuse of notation) <inline-formula><mml:math id="inf300"><mml:msup><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula> without an argument to be its asymptotic value,<disp-formula id="equ31"><label>(21)</label><mml:math id="m31"><mml:mrow><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>≡</mml:mo><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Combining <xref ref-type="disp-formula" rid="equ22">Equation 15</xref> for <inline-formula><mml:math id="inf301"><mml:msup><mml:mi>h</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula> with <xref ref-type="disp-formula" rid="equ27">Equation 18</xref> for <inline-formula><mml:math id="inf302"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf303"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:math></inline-formula>, we have<disp-formula id="equ32"><label>(22)</label><mml:math id="m32"><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">[</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⊙</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>⊙</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We can simplify the second term in the right-hand side by explicitly evaluating the dot product,<disp-formula id="equ33"> <label>(23)</label><mml:math id="m33"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">[</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⊙</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>⊙</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">]</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>≡</mml:mo><mml:mi>N</mml:mi><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where the notation <inline-formula><mml:math id="inf304"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> indicates an average over the index <inline-formula><mml:math id="inf305"><mml:mi>i</mml:mi></mml:math></inline-formula>.</p><p>Since <inline-formula><mml:math id="inf306"><mml:mi>N</mml:mi></mml:math></inline-formula> is large, we can interpret population averages such as <xref ref-type="disp-formula" rid="equ33">Equation 23</xref> as expectations over the probability distribution of <inline-formula><mml:math id="inf307"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf308"><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula>. An immediate implication is that <xref ref-type="disp-formula" rid="equ33">Equation 23</xref> simplifies,<disp-formula id="equ34"><label>(24)</label><mml:math id="m34"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mi>N</mml:mi><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>For the first equality we used the independence of <inline-formula><mml:math id="inf309"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf310"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>; for the second we used the fact that the elements of <inline-formula><mml:math id="inf311"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> are drawn from a zero-mean Gaussian with variance <inline-formula><mml:math id="inf312"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ11">Equation 8a</xref>). We can thus rewrite <xref ref-type="disp-formula" rid="equ32">Equation 22</xref> as<disp-formula id="equ35"><label>(25)</label><mml:math id="m35"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mi>c</mml:mi><mml:mi>q</mml:mi></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mi>c</mml:mi><mml:mi>q</mml:mi></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>Combining this with <xref ref-type="disp-formula" rid="equ30">Equation 20</xref>, we conclude that<disp-formula id="equ36"><label>(26)</label><mml:math id="m36"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>z</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">[</mml:mo></mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">]</mml:mo></mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ36">Equation 26</xref> is a <inline-formula><mml:math id="inf313"><mml:mi>P</mml:mi></mml:math></inline-formula>-dimensional linear system of equations for the coefficients <inline-formula><mml:math id="inf314"><mml:msup><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="inf315"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (the term in brackets is a <inline-formula><mml:math id="inf316"><mml:mrow><mml:mi>P</mml:mi><mml:mo>×</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula> matrix with indices <inline-formula><mml:math id="inf317"><mml:mi>s</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf318"><mml:mi>q</mml:mi></mml:math></inline-formula>). For the tasks we consider (Sections Simple categorization task and Context-dependent categorization task), this system can be solved analytically, yielding a closed-form expression for the coefficients <inline-formula><mml:math id="inf319"><mml:msup><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula>.</p></sec><sec id="s4-3-2"><title>Evolution of activity</title><p>It is now straightforward to determine how activity in the intermediate layer, <inline-formula><mml:math id="inf320"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, evolves. Inserting <xref ref-type="disp-formula" rid="equ27">Equation 18</xref> into <xref ref-type="disp-formula" rid="equ6">Equation 5</xref>, and Taylor expanding the nonlinear activation function <inline-formula><mml:math id="inf321"><mml:mi mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula> to first order in <inline-formula><mml:math id="inf322"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:math></inline-formula>, we arrive at<disp-formula id="equ37"> <label>(27)</label><mml:math id="m37"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≡</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≃</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where<disp-formula id="equ38"><label>(28)</label><mml:math id="m38"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>≡</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⊙</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>⊙</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>To reduce clutter, we define (following the notation in the previous section) <inline-formula><mml:math id="inf323"><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula> without an argument to be its asymptotic value: <inline-formula><mml:math id="inf324"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>≡</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Thus, <xref ref-type="disp-formula" rid="equ37">Equation 27</xref> becomes<disp-formula id="equ39"><label>(29)</label><mml:math id="m39"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>≃</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Because of the term <inline-formula><mml:math id="inf325"><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> on the right-hand side of <xref ref-type="disp-formula" rid="equ38">Equation 28</xref>, the elements of <inline-formula><mml:math id="inf326"><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> scale as <inline-formula><mml:math id="inf327"><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula>. Thus, changes in activity are small compared to the initial activity, which is <inline-formula><mml:math id="inf328"><mml:mrow><mml:mi>O</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>In what follows, we refer to <inline-formula><mml:math id="inf329"><mml:msub><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> as spanning vectors, and to the coefficients <inline-formula><mml:math id="inf330"><mml:msup><mml:mi>c</mml:mi><mml:mi>q</mml:mi></mml:msup></mml:math></inline-formula> as the activity coordinates. We observe that all spanning vectors have a non-zero overlap with the initial readout vector <inline-formula><mml:math id="inf331"><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, as<disp-formula id="equ40"><label>(30)</label><mml:math id="m40"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≡</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This implies that, for every spanning vector, we can write<disp-formula id="equ41"><label>(31)</label><mml:math id="m41"><mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf332"><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is given by <xref ref-type="disp-formula" rid="equ40">Equation 30</xref> (since <inline-formula><mml:math id="inf333"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) and <inline-formula><mml:math id="inf334"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is a residual component due to the nonlinearity of the activation function <inline-formula><mml:math id="inf335"><mml:mi mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula>:<disp-formula id="equ42"><label>(32)</label><mml:math id="m42"><mml:mrow><mml:mi>δ</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⊙</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>⊙</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mn mathvariant="bold">1</mml:mn><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The notation <inline-formula><mml:math id="inf336"><mml:mn>1</mml:mn></mml:math></inline-formula> indicates a vector whose components are all equal to 1: <inline-formula><mml:math id="inf337"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s4-3-3"><title>A low-order Taylor expansion is self-consistent in large circuits</title><p>To conclude our theoretical derivation, we verify that the approximations we made in Section Evolution of connectivity are valid in large circuits. Specifically, we show that the approximate expression for <inline-formula><mml:math id="inf338"><mml:msup><mml:mi>h</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula>, <xref ref-type="disp-formula" rid="equ22">Equation 15</xref> (which was derived by Taylor expanding the nonlinear activation function <inline-formula><mml:math id="inf339"><mml:mi mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula>), is self-consistent when <inline-formula><mml:math id="inf340"><mml:mi>N</mml:mi></mml:math></inline-formula> is large. As a first step, we compute the size of <inline-formula><mml:math id="inf341"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf342"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow></mml:math></inline-formula>, and show that in the large-<inline-formula><mml:math id="inf343"><mml:mi>N</mml:mi></mml:math></inline-formula> limit they are small compared to <inline-formula><mml:math id="inf344"><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf345"><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, respectively. We then Taylor-expand <inline-formula><mml:math id="inf346"><mml:mi mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ21">Equation 14</xref> to all orders, and show that the terms that were included in <xref ref-type="disp-formula" rid="equ22">Equation 15</xref> (zeroth- and first-order terms in connectivity changes) are indeed the dominant ones.</p><p>Assuming that the term in brackets in <xref ref-type="disp-formula" rid="equ36">Equation 26</xref>, when viewed as a <inline-formula><mml:math id="inf347"><mml:mrow><mml:mi>P</mml:mi><mml:mo>×</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula> matrix, is invertible (which is generically the case when <inline-formula><mml:math id="inf348"><mml:mrow><mml:mi>P</mml:mi><mml:mo>≪</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>), it follows that, with respect to <inline-formula><mml:math id="inf349"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula><disp-formula id="equ43"><label>(33)</label><mml:math id="m43"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>∼</mml:mo><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This result applies to the asymptotic (<inline-formula><mml:math id="inf350"><mml:mrow><mml:mi>t</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula>) value of <inline-formula><mml:math id="inf351"><mml:msup><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ31">Equation 21</xref>). We assume, though, that the learning process is smooth enough that <inline-formula><mml:math id="inf352"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> remains at most <inline-formula><mml:math id="inf353"><mml:mrow><mml:mi>O</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for all <inline-formula><mml:math id="inf354"><mml:mi>t</mml:mi></mml:math></inline-formula>. Under this assumption, the results we derive in this section are valid at any point during learning.</p><p>Using <xref ref-type="disp-formula" rid="equ43">Equation 33</xref>, along with the fact that <inline-formula><mml:math id="inf355"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mi>O</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> while all other variables are <inline-formula><mml:math id="inf356"><mml:mrow><mml:mi>O</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, we see from <xref ref-type="disp-formula" rid="equ27">Equation 18</xref> that<disp-formula id="equ44"><label>(34a)</label><mml:math id="m44"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:mi>O</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ45"><label>(34b)</label><mml:math id="m45"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:mi>O</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>When <inline-formula><mml:math id="inf357"><mml:mi>N</mml:mi></mml:math></inline-formula> is large, both are small compared to the initial weights <inline-formula><mml:math id="inf358"><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf359"><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, whose elements are <inline-formula><mml:math id="inf360"><mml:mrow><mml:mi>O</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ11">Equation 8</xref>).</p><p><xref ref-type="disp-formula" rid="equ44">Equation 34</xref> suggests that a low-order Taylor expansion is self-consistent, but it is not proof. We thus turn directly to <xref ref-type="disp-formula" rid="equ21">Equation 14</xref>. The three terms in the right-hand side of <xref ref-type="disp-formula" rid="equ22">Equation 15</xref> are re-written in <xref ref-type="disp-formula" rid="equ35">Equation 25</xref>, and it is clear from that expression that they are all <inline-formula><mml:math id="inf361"><mml:mrow><mml:mi>O</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. To determine the size of the higher-order terms, we need the complete Taylor expansion of <xref ref-type="disp-formula" rid="equ21">Equation 14</xref>. That is given by<disp-formula id="equ46"><label>(35)</label><mml:math id="m46"><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>⊙</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>⋅</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf362"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is the <inline-formula><mml:math id="inf363"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> derivative of <inline-formula><mml:math id="inf364"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, and the exponentiation in <inline-formula><mml:math id="inf365"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>⋅</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is taken element-wise. The higher-order terms (i.e., the terms not included in <xref ref-type="disp-formula" rid="equ22">Equation 15</xref>) are<disp-formula id="equ47"><label>(36)</label><mml:math id="m47"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mrow><mml:mtext>higher order</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mi>N</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>⋅</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mi>N</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>⋅</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>where we have replaced dot products with averages over indices. Using <xref ref-type="disp-formula" rid="equ27">Equation 18a</xref>, and taking into account the fact that <inline-formula><mml:math id="inf366"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf367"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are independent, we observe that<disp-formula id="equ48"><label>(37)</label><mml:math id="m48"><mml:mrow><mml:mfrac><mml:mi>N</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>⋅</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Similarly, this time using both <xref ref-type="disp-formula" rid="equ27">Equation 18a</xref> and <xref ref-type="disp-formula" rid="equ28">Equation 18b</xref>, we have<disp-formula id="equ49"><label>(38)</label><mml:math id="m49"><mml:mrow><mml:mfrac><mml:mi>N</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>⋅</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Inserting these into <xref ref-type="disp-formula" rid="equ47">Equation 36</xref> then gives us<disp-formula id="equ50"><label>(39)</label><mml:math id="m50"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mrow><mml:mtext>higher order</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mspace width="thinmathspace"/><mml:mi>N</mml:mi><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mspace width="thinmathspace"/><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Finally, using the fact that the <inline-formula><mml:math id="inf368"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are drawn independently from a zero-mean Gaussian with variance <inline-formula><mml:math id="inf369"><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ11">Equation 8a</xref>), we see that <inline-formula><mml:math id="inf370"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is proportional to <inline-formula><mml:math id="inf371"><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> when <inline-formula><mml:math id="inf372"><mml:mi>n</mml:mi></mml:math></inline-formula> is even and <inline-formula><mml:math id="inf373"><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> when <inline-formula><mml:math id="inf374"><mml:mi>n</mml:mi></mml:math></inline-formula> is odd. Consequently, the largest term in the expression for <inline-formula><mml:math id="inf375"><mml:msubsup><mml:mi>h</mml:mi><mml:mtext>higher order</mml:mtext><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula> is proportional to <inline-formula><mml:math id="inf376"><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>. The higher-order terms can, therefore, be neglected in the large <inline-formula><mml:math id="inf377"><mml:mi>N</mml:mi></mml:math></inline-formula> limit.</p></sec><sec id="s4-3-4"><title>Evolution of activity in finite-size networks</title><p>The equations that describe the evolution of connectivity and activity that were derived in Sections Evolution of connectivity and Evolution of activity are accurate if two assumptions are satisfied: (1) the circuit is very large (<inline-formula><mml:math id="inf378"><mml:mrow><mml:mi>N</mml:mi><mml:mo>≫</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>), and (2) the synaptic weights are initialized to be <inline-formula><mml:math id="inf379"><mml:mrow><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>) (<xref ref-type="disp-formula" rid="equ11">Equation 8a</xref>), which guarantees that synaptic drives and activity neither vanish nor explode at initialization. Both assumptions are reasonable for brain circuits, and correspond to rather standard modelling choices in theoretical neuroscience.</p><p>In this work, we use the analytical expressions derived for large <inline-formula><mml:math id="inf380"><mml:mi>N</mml:mi></mml:math></inline-formula> to describe activity evolution in finite-size networks. This is a crude approximation, as dealing with finite <inline-formula><mml:math id="inf381"><mml:mi>N</mml:mi></mml:math></inline-formula> would require, in principle, integrating corrective terms into our equations (<xref ref-type="bibr" rid="bib31">Huang and Yau, 2020</xref>). How accurate is this approximation? Several machine-learning studies have investigated this question across tasks, architectures, and loss functions (<xref ref-type="bibr" rid="bib34">Jacot et al., 2018</xref>; <xref ref-type="bibr" rid="bib12">Chizat et al., 2019</xref>; <xref ref-type="bibr" rid="bib30">Hu et al., 2020</xref>; <xref ref-type="bibr" rid="bib25">Geiger et al., 2020</xref>; <xref ref-type="bibr" rid="bib75">Yang and Hu, 2021</xref>). Because of the Taylor expansions used in Sections Evolution of connectivity and Evolution of activity, for fixed <inline-formula><mml:math id="inf382"><mml:mi>N</mml:mi></mml:math></inline-formula>, good accuracy is expected when the amplitude of activity changes is small. Via <xref ref-type="disp-formula" rid="equ39">Equation 29</xref>, we see that the latter increases with the number of sensory input vectors <inline-formula><mml:math id="inf383"><mml:mi>P</mml:mi></mml:math></inline-formula>, implying that good accuracy is expected when <inline-formula><mml:math id="inf384"><mml:mi>P</mml:mi></mml:math></inline-formula> is small. For fixed <inline-formula><mml:math id="inf385"><mml:mi>P</mml:mi></mml:math></inline-formula>, furthermore, the amplitude of activity changes increases with correlations among sensory inputs (<xref ref-type="disp-formula" rid="equ38">Equation 28</xref>), implying that good accuracy is expected when sensory input correlations are small. As detailed in Sections Simple task: task definition and Context-dependent task: task definition, sensory input correlations are smaller in the simple than in the context-dependent task, which implies that accuracy in the former task is expected to be higher than in the latter. The amplitude of activity changes also depends on the amplitude of activity coordinates <inline-formula><mml:math id="inf386"><mml:msup><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ39">Equation 29</xref>). We show in Sections Simple task: computing activity and Context-dependent task: computing activity that activity coordinates are usually smaller in the simple than in the context-dependent task, which again implies that accuracy in the former task is expected to be higher than in the latter. Overall, those arguments suggest that good accuracy is expected when the task is easy, and thus the training loss converges to zero very quickly (<xref ref-type="bibr" rid="bib30">Hu et al., 2020</xref>). Finally, we expect accuracy to depend on properties of the activation function <inline-formula><mml:math id="inf387"><mml:mi mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula>, with accuracy increasing as <inline-formula><mml:math id="inf388"><mml:mi mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula> becomes more linear in its effective activation range.</p><p>In <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>, <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>, <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>, and <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>, we evaluate accuracy by performing a systematic comparison between approximate analytical expressions (large <inline-formula><mml:math id="inf389"><mml:mi>N</mml:mi></mml:math></inline-formula>) and circuit simulations (finite <inline-formula><mml:math id="inf390"><mml:mi>N</mml:mi></mml:math></inline-formula>). We find good agreement for the full range of parameters considered in the study. Specifically, the theory correctly predicts qualitatively, and in some cases also quantitatively, the behaviour of all activity measures discussed in the main text. As expected, the agreement is stronger in the simple (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>) than in the context-dependent task (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref> and <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>).</p></sec></sec><sec id="s4-4"><title>Simple categorization task</title><sec id="s4-4-1"><title>Simple task: task definition</title><p>We first consider a simple categorization task. Each stimulus is represented by an input pattern <inline-formula><mml:math id="inf391"><mml:msup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mi>S</mml:mi></mml:msup></mml:math></inline-formula>, with <inline-formula><mml:math id="inf392"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf393"><mml:mi>Q</mml:mi></mml:math></inline-formula> is the total number of stimuli. The <inline-formula><mml:math id="inf394"><mml:msup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mi>S</mml:mi></mml:msup></mml:math></inline-formula> are random vectors whose entries are drawn independently from a zero-mean, unit-variance Gaussian distribution. Every sensory input vector <inline-formula><mml:math id="inf395"><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula> corresponds to a stimulus,<disp-formula id="equ51"><label>(40)</label><mml:math id="m51"><mml:mrow><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mi>S</mml:mi></mml:msup></mml:mrow><mml:mo>;</mml:mo></mml:mrow></mml:math></disp-formula></p><p>consequently, the number of sensory input vectors, <inline-formula><mml:math id="inf396"><mml:mi>P</mml:mi></mml:math></inline-formula>, is equal to <inline-formula><mml:math id="inf397"><mml:mi>Q</mml:mi></mml:math></inline-formula> (the upper-case notation <inline-formula><mml:math id="inf398"><mml:mi>S</mml:mi></mml:math></inline-formula> is used for consistency with the context-dependent task; see Section Context-dependent task: task definition). To leading order in <inline-formula><mml:math id="inf399"><mml:mi>N</mml:mi></mml:math></inline-formula>, sensory input vectors are thus orthonormal,<disp-formula id="equ52"><label>(41)</label><mml:math id="m52"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≃</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf400"><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> is the Kronecker delta.</p><p>Each stimulus is associated with one among the two mutually exclusive categories <inline-formula><mml:math id="inf401"><mml:mi>A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf402"><mml:mi>B</mml:mi></mml:math></inline-formula>: the first half of stimuli is associated with <inline-formula><mml:math id="inf403"><mml:mi>A</mml:mi></mml:math></inline-formula>, the second half with <inline-formula><mml:math id="inf404"><mml:mi>B</mml:mi></mml:math></inline-formula>. The target value <inline-formula><mml:math id="inf405"><mml:msup><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula> for the readout neuron is thus equal to <inline-formula><mml:math id="inf406"><mml:msup><mml:mi>z</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> for the first half of sensory inputs and <inline-formula><mml:math id="inf407"><mml:msup><mml:mi>z</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula> for the second half. Since sensory input vectors are approximately orthogonal to each other, they are also linearly separable.</p><p>Our goal is to derive explicit expressions for the quantities analyzed in the main text: category selectivity (defined in <xref ref-type="disp-formula" rid="equ71">Equation 56</xref>), and category correlation (defined in <xref ref-type="disp-formula" rid="equ86">Equation 71</xref>). Both quantities depend on activity in the intermediate layer, <inline-formula><mml:math id="inf408"><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula>, after learning, which is given in <xref ref-type="disp-formula" rid="equ39">Equation 29</xref>. In the next section, we then write down an explicit expression for <inline-formula><mml:math id="inf409"><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula>; after that, we compute category selectivity (Section Simple task: category selectivity) and category correlation (Section Simple task: category correlation). Further mathematical details are discussed in Sections Simple task: computing normalized dot products, Asymmetry in category response and Characterizing variability; a generalization of the current task is discussed and analyzed in Section Simple categorization task with structured inputs and heterogeneity.</p></sec><sec id="s4-4-2"><title>Simple task: computing activity</title><p>Examining <xref ref-type="disp-formula" rid="equ39">Equation 29</xref>, we see that to compute the activity in the intermediate layer, <inline-formula><mml:math id="inf410"><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula>, we need the asymptotic activity coordinates, <inline-formula><mml:math id="inf411"><mml:msup><mml:mi>c</mml:mi><mml:mi>q</mml:mi></mml:msup></mml:math></inline-formula>, and the spanning vectors, <inline-formula><mml:math id="inf412"><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>. We start with the coordinates. To compute them, we solve the linear system of equations given in <xref ref-type="disp-formula" rid="equ36">Equation 26</xref>. Using <xref ref-type="disp-formula" rid="equ52">Equation 41</xref>, that system of equations becomes<disp-formula id="equ53"><label>(42)</label><mml:math id="m53"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>z</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>As a first step, we simplify the averages in the right-hand side. The law of large number guarantees that, when <inline-formula><mml:math id="inf413"><mml:mi>N</mml:mi></mml:math></inline-formula> is large, the elements of the synaptic drive, <inline-formula><mml:math id="inf414"><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula>, are independently drawn from a Gaussian distribution. The statistics of this distribution are given by<disp-formula id="equ54"><label>(43a)</label><mml:math id="m54"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ55"><label>(43b)</label><mml:math id="m55"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>where we have used the fact that, because of <xref ref-type="disp-formula" rid="equ11">Equation 8a</xref>, <inline-formula><mml:math id="inf415"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. <xref ref-type="disp-formula" rid="equ54">Equation 43</xref>, combined with <xref ref-type="disp-formula" rid="equ52">Equation 41</xref>, implies that the <inline-formula><mml:math id="inf416"><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula> have zero mean and unit variance, and are uncorrelated across stimuli. In addition, because the statistics of <inline-formula><mml:math id="inf417"><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula> are independent of <inline-formula><mml:math id="inf418"><mml:mi>s</mml:mi></mml:math></inline-formula>, averages over <inline-formula><mml:math id="inf419"><mml:mi>i</mml:mi></mml:math></inline-formula> of any function of <inline-formula><mml:math id="inf420"><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula> are independent of <inline-formula><mml:math id="inf421"><mml:mi>s</mml:mi></mml:math></inline-formula>.</p><p>Using these observations, <xref ref-type="disp-formula" rid="equ53">Equation 42</xref> can be written as<disp-formula id="equ56"><label>(44)</label><mml:math id="m56"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>z</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula></p><p>where we used the short-hand notation <inline-formula><mml:math id="inf422"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula> to indicate the average of a function <inline-formula><mml:math id="inf423"><mml:mi>F</mml:mi></mml:math></inline-formula> whose argument is drawn from a zero-mean, unit-variance Gaussian distribution. That is,<disp-formula id="equ57"><label>(45)</label><mml:math id="m57"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi>F</mml:mi><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>≡</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf424"><mml:mi>a</mml:mi></mml:math></inline-formula> is a zero-mean, unit-variance Gaussian variable. This average can be computed via numerical integration, as detailed in Section Evaluation of averages (<xref ref-type="disp-formula" rid="equ212">Equation 184</xref>).</p><p>The left-hand side of <xref ref-type="disp-formula" rid="equ56">Equation 44</xref> consists of two terms: the target <inline-formula><mml:math id="inf425"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which is fixed by the task, and <inline-formula><mml:math id="inf426"><mml:msubsup><mml:mi>h</mml:mi><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula> (representing the synaptic drive of the readout neuron at initialization), which fluctuates across model realizations. The presence of the latter term indicates that connectivity and activity changes are not fully self-averaging; they are rather tuned to compensate for the initial state of the readout neuron. Here, we seek to analyze the <italic>average</italic> behaviour of the model, and so we drop the second, variable term. This approximation is discussed in detail in Section Characterizing variability.</p><p>With the variable terms neglected, the left-hand side of <xref ref-type="disp-formula" rid="equ56">Equation 44</xref> can take only two values: <inline-formula><mml:math id="inf427"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf428"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Combined with the symmetry of the right-hand side, this implies that the coordinates <inline-formula><mml:math id="inf429"><mml:msup><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula> themselves can take only two values. Specifically, we have<disp-formula id="equ58"><label>(46)</label><mml:math id="m58"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mpadded lspace="10pt" width="+10pt"><mml:mi>s</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mtext> in category </mml:mtext><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mpadded lspace="10pt" width="+10pt"><mml:mi>s</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mtext> in category </mml:mtext><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>B</mml:mi></mml:mpadded></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mi/></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The category-dependent coordinates, <inline-formula><mml:math id="inf430"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf431"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula>, are determined by the two-dimensional linear system of equations<disp-formula id="equ59"><label>(47a)</label><mml:math id="m59"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ60"><label>(47b)</label><mml:math id="m60"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the scalars <inline-formula><mml:math id="inf432"><mml:mi>α</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf433"><mml:mi>β</mml:mi></mml:math></inline-formula> are defined as<disp-formula id="equ61"><label>(48a)</label><mml:math id="m61"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ62"><label>(48b)</label><mml:math id="m62"><mml:mi>β</mml:mi><mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This system is easily solved, yielding<disp-formula id="equ63"><label>(49a)</label><mml:math id="m63"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mi>γ</mml:mi></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ64"><label>(49b)</label><mml:math id="m64"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mi>γ</mml:mi></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where we have defined the shift<disp-formula id="equ65"><label>(50)</label><mml:math id="m65"><mml:mrow><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mi>β</mml:mi><mml:mi>α</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Note that <inline-formula><mml:math id="inf434"><mml:mi>γ</mml:mi></mml:math></inline-formula> is positive, as <inline-formula><mml:math id="inf435"><mml:mi>α</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf436"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>β</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf437"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, which in turn indicates that <inline-formula><mml:math id="inf438"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>To conclude the derivation of activity, we evaluate the spanning vectors, <inline-formula><mml:math id="inf439"><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ38">Equation 28</xref>). Because the sensory inputs <inline-formula><mml:math id="inf440"><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula> are orthogonal (<xref ref-type="disp-formula" rid="equ52">Equation 41</xref>), spanning vectors with <inline-formula><mml:math id="inf441"><mml:mrow><mml:mi>q</mml:mi><mml:mo>≠</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula> vanish. Consequently, the activity, <inline-formula><mml:math id="inf442"><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ39">Equation 29</xref>), reads<disp-formula id="equ66"><label>(51)</label><mml:math id="m66"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mpadded lspace="10pt" width="+10pt"><mml:mi>s</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mtext> in category </mml:mtext><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mpadded lspace="10pt" width="+10pt"><mml:mi>s</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mtext> in category </mml:mtext><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>B</mml:mi></mml:mpadded></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mi/></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Using <xref ref-type="disp-formula" rid="equ41">Equation 31</xref>, we can rewrite this as<disp-formula id="equ67"><label>(52)</label><mml:math id="m67"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mpadded lspace="10pt" width="+10pt"><mml:mi>s</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mtext> in category </mml:mtext><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mpadded lspace="10pt" width="+10pt"><mml:mi>s</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mtext> in category </mml:mtext><mml:mo>⁢</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mi/></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where we used <xref ref-type="disp-formula" rid="equ40">Equation 30</xref> to define<disp-formula id="equ68"><label>(53)</label><mml:math id="m68"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>≡</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mmultiscripts><mml:mi mathvariant="normal">Ψ</mml:mi><mml:none/><mml:mo>′</mml:mo><mml:none/><mml:mn>2</mml:mn></mml:mmultiscripts><mml:mo rspace="4.2pt" stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ67">Equation 52</xref> indicates that activity consists of three components. The first one coincide with initial activity, <inline-formula><mml:math id="inf443"><mml:msubsup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula>, which for this task is fully unstructured. The second one is a shared component along <inline-formula><mml:math id="inf444"><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> (whose strength is category dependent, as it is given by <inline-formula><mml:math id="inf445"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> or <inline-formula><mml:math id="inf446"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula>). The third one is a non-shared component along the residuals <inline-formula><mml:math id="inf447"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, which represent the components of the spanning vectors that are perpendicular to the initial readout <inline-formula><mml:math id="inf448"><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>. For the current task, the latter component is orthogonal across activity vectors, implying that activity vectors only overlap along <inline-formula><mml:math id="inf449"><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>. To leading order in <inline-formula><mml:math id="inf450"><mml:mi>N</mml:mi></mml:math></inline-formula>, in fact<disp-formula id="equ69"> <label>(54)</label><mml:math id="m69"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mi>δ</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>≃</mml:mo><mml:mn>0</mml:mn><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>which follows because <inline-formula><mml:math id="inf451"><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf452"><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msubsup></mml:math></inline-formula> are uncorrelated.</p><p>We observe that <xref ref-type="disp-formula" rid="equ67">Equation 52</xref> is similar, but not identical to the expression that we used in the main text to describe activity evolution (<xref ref-type="disp-formula" rid="equ4">Equation 3</xref>). By setting <inline-formula><mml:math id="inf453"><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, that reads<disp-formula id="equ70"><label>(55)</label><mml:math id="m70"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mpadded lspace="10pt" width="+10pt"><mml:mi>s</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mtext> in category </mml:mtext><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mpadded lspace="10pt" width="+10pt"><mml:mi>s</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mtext> in category </mml:mtext><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>B</mml:mi></mml:mpadded></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mi/></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Comparing <xref ref-type="disp-formula" rid="equ67">Equation 52</xref> with <xref ref-type="disp-formula" rid="equ70">Equation 55</xref>, we see that the residuals <inline-formula><mml:math id="inf454"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> were neglected in the main text. This could be done because, for the current task (but not for the context-dependent one, see Section Context-dependent task: computing activity), residuals are all orthogonal to each other (<xref ref-type="disp-formula" rid="equ69">Equation 54</xref>). As such, they do not add novel structure to activity, and do not significantly contribute to activity measures. This is showed and justified, in detail, in the next sections.</p></sec><sec id="s4-4-3"><title>Simple task: category selectivity</title><p>In this section, we evaluate the category selectivity of neurons in the intermediate layer (<xref ref-type="fig" rid="fig2">Figure 2B, F, J</xref>). For each neuron <inline-formula><mml:math id="inf455"><mml:mi>i</mml:mi></mml:math></inline-formula>, we evaluate the standard selectivity index (<xref ref-type="bibr" rid="bib22">Freedman and Assad, 2006</xref>), defined in <xref ref-type="disp-formula" rid="equ3">Equation 2</xref>. We repeat that definition here for convenience,<disp-formula id="equ71"><label>(56)</label><mml:math id="m71"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff cat</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same cat</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff cat</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same cat</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>where the notation <inline-formula><mml:math id="inf456"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> denotes an average over sensory input pairs associated either with different, or the same, category. To evaluate this expression, we assume that the number of stimuli, <inline-formula><mml:math id="inf457"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula>, is moderately large (<inline-formula><mml:math id="inf458"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≪</mml:mo><mml:mi>Q</mml:mi><mml:mo>≪</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>). We show that, under this assumption, the category selectivity index for each neuron, which is approximately zero at <inline-formula><mml:math id="inf459"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, becomes positive over learning.</p><p>We start with<disp-formula id="equ72"><label>(57)</label><mml:math id="m72"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>which follows from <xref ref-type="disp-formula" rid="equ67">Equation 52</xref>. The first term of the right-hand side is <inline-formula><mml:math id="inf460"><mml:mrow><mml:mi>O</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, while both terms in parentheses are <inline-formula><mml:math id="inf461"><mml:mrow><mml:mi>O</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Thus, when evaluating the denominator in <xref ref-type="disp-formula" rid="equ71">Equation 56</xref>, to lowest non-vanishing order in <inline-formula><mml:math id="inf462"><mml:mi>N</mml:mi></mml:math></inline-formula> we can replace <italic>y</italic><sub><italic>i</italic></sub> with <inline-formula><mml:math id="inf463"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Doing that, and expanding the square, we have<disp-formula id="equ73"><label>(58)</label><mml:math id="m73"><mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff cat</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same cat</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>≃</mml:mo><mml:mn>4</mml:mn><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff cat</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same cat</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Noting that <inline-formula><mml:math id="inf464"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, and using <xref ref-type="disp-formula" rid="equ54">Equation 43</xref>, we see that the second two averages in the above equation are both equal to <inline-formula><mml:math id="inf465"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>. Consequently,<disp-formula id="equ74"><label>(59)</label><mml:math id="m74"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff cat</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same cat</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>≃</mml:mo><mml:mn>4</mml:mn><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>Strictly speaking, this step is accurate only in the large-<inline-formula><mml:math id="inf466"><mml:mi>Q</mml:mi></mml:math></inline-formula> limit, but is a good approximation even for moderate <inline-formula><mml:math id="inf467"><mml:mi>Q</mml:mi></mml:math></inline-formula>. Since <inline-formula><mml:math id="inf468"><mml:mi>Q</mml:mi></mml:math></inline-formula> is moderately large, we can further approximate this as<disp-formula id="equ75"><label>(60)</label><mml:math id="m75"><mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff cat</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same cat</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>≃</mml:mo><mml:mn>4</mml:mn><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where averages can be computed as described in Section Evaluation of averages.</p><p>For the numerator of <xref ref-type="disp-formula" rid="equ71">Equation 56</xref>, the minus sign causes the <inline-formula><mml:math id="inf469"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> terms to cancel, so we have<disp-formula id="equ76"><label>(61)</label><mml:math id="m76"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff cat</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same cat</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same cat</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff cat</mml:mtext></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Using <xref ref-type="disp-formula" rid="equ72">Equation 57</xref>, we have (for <inline-formula><mml:math id="inf470"><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>)<disp-formula id="equ77"><label>(62)</label><mml:math id="m77"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Apart from the first term, and the term proportional to <inline-formula><mml:math id="inf471"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>, all terms in the right-hand side have essentially random signs. Neglecting those for a moment, we obtain<disp-formula id="equ78"><label>(63)</label><mml:math id="m78"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>≃</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Inserting this into <xref ref-type="disp-formula" rid="equ76">Equation 61</xref>, using the fact that <inline-formula><mml:math id="inf472"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is independent of <inline-formula><mml:math id="inf473"><mml:mi>s</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf474"><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula>, and performing a small amount of algebra, we arrive at<disp-formula id="equ79"><label>(64)</label><mml:math id="m79"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff cat</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same cat</mml:mtext></mml:mrow></mml:msub><mml:mo>≃</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Combining this with <xref ref-type="disp-formula" rid="equ75">Equation 60</xref>, and using <xref ref-type="disp-formula" rid="equ68">Equation 53</xref> for <inline-formula><mml:math id="inf475"><mml:mi>ρ</mml:mi></mml:math></inline-formula>, we arrive at<disp-formula id="equ80"><label>(65)</label><mml:math id="m80"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≃</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We conclude that single-neuron selectivity vanishes at <inline-formula><mml:math id="inf476"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (when <inline-formula><mml:math id="inf477"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), and is positive at the end of learning. Furthermore, for each neuron, the magnitude of selectivity is determined by the magnitude of <inline-formula><mml:math id="inf478"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, which measures initial connectivity with the readout neuron. As a result, neurons with large initial connectivity develop large selectivity values (<xref ref-type="fig" rid="fig5">Figure 5B, C</xref>).</p><p>Because of the factor <inline-formula><mml:math id="inf479"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>, the right-hand side of <xref ref-type="disp-formula" rid="equ80">Equation 65</xref> is <inline-formula><mml:math id="inf480"><mml:mrow><mml:mi>O</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. To derive <xref ref-type="disp-formula" rid="equ80">Equation 65</xref>, we neglected terms in the numerator that have random sign and thus contribute as noise. The dominant random terms are <inline-formula><mml:math id="inf481"><mml:mrow><mml:mi>O</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in <inline-formula><mml:math id="inf482"><mml:mi>N</mml:mi></mml:math></inline-formula>, but <inline-formula><mml:math id="inf483"><mml:mrow><mml:mi>O</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in <inline-formula><mml:math id="inf484"><mml:mi>Q</mml:mi></mml:math></inline-formula>. This implies that, in simulated circuits with finite <inline-formula><mml:math id="inf485"><mml:mi>Q</mml:mi></mml:math></inline-formula>, random deviations from <xref ref-type="disp-formula" rid="equ80">Equation 65</xref> occur. For example, <xref ref-type="fig" rid="fig2">Figure 2B</xref> shows that selectivity values at <inline-formula><mml:math id="inf486"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> are small but non-zero; <xref ref-type="fig" rid="fig5">Figure 5B, C</xref>, instead, shows that the values of <inline-formula><mml:math id="inf487"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf488"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> are not perfectly correlated across the population.</p><p>We can, finally, average <xref ref-type="disp-formula" rid="equ80">Equation 65</xref> over neurons, yielding<disp-formula id="equ81"><label>(66)</label><mml:math id="m81"><mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≃</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>where neglected random terms are now <inline-formula><mml:math id="inf489"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. In <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>, we compare this approximate analytical expression for average category selectivity with values measured in finite-size circuits, and find good agreement between the two.</p><sec id="s4-4-3-1"><title>Category clustering</title><p>Our derivation of the average category selectivity, <xref ref-type="disp-formula" rid="equ81">Equation 66</xref>, was based on several assumptions: we assumed that the number of stimuli, <inline-formula><mml:math id="inf490"><mml:mi>Q</mml:mi></mml:math></inline-formula>, was large, and that terms with random signs could be neglected. A different, but related, activity measure is given by category clustering (<xref ref-type="bibr" rid="bib6">Bernardi et al., 2020</xref>; <xref ref-type="bibr" rid="bib16">Engel et al., 2015</xref>). That is defined as<disp-formula id="equ82"><label>(67)</label><mml:math id="m82"><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff cat</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same cat</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff cat</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same cat</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This measure is positive if activity vectors elicited by within-category stimuli are more similar, in norm, than activity vectors elicited by across-category stimuli – and negative otherwise. In contrast to average category selectivity, category clustering can be evaluated straightforwardly, and for any value of <inline-formula><mml:math id="inf491"><mml:mi>Q</mml:mi></mml:math></inline-formula>. We show this in the following.</p><p>By using the statistical homogeneity of activity vectors, we can rewrite<disp-formula id="equ83"><label>(68)</label><mml:math id="m83"><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff cat</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same cat</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff cat</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same cat</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Expressions in the form of <inline-formula><mml:math id="inf492"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> are evaluated in Section Simple task: computing normalized dot products; the derivation involves lengthy, but straightforward algebra. Using those results (<xref ref-type="disp-formula" rid="equ106">Equation 90</xref> and <xref ref-type="disp-formula" rid="equ111">Equation 95</xref>), we have:<disp-formula id="equ84"><label>(69)</label><mml:math id="m84"><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>To the leading order in <inline-formula><mml:math id="inf493"><mml:mi>N</mml:mi></mml:math></inline-formula>, we obtain<disp-formula id="equ85"><label>(70)</label><mml:math id="m85"><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>which is identical to the expression obtained for average category selectivity evaluated with <inline-formula><mml:math id="inf494"><mml:mi>Q</mml:mi></mml:math></inline-formula> large (<xref ref-type="disp-formula" rid="equ81">Equation 66</xref>).</p><p>To better understand the relationship between selectivity and clustering, we observe that clustering coincide with the average selectivity, <inline-formula><mml:math id="inf495"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, if the average over the numerator and the denominator of <inline-formula><mml:math id="inf496"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ71">Equation 56</xref>) is factorized. In general, the numerator and the denominator of <inline-formula><mml:math id="inf497"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> are correlated, and the average cannot be factorized. We have however shown that, in the limit where both <inline-formula><mml:math id="inf498"><mml:mi>Q</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf499"><mml:mi>N</mml:mi></mml:math></inline-formula> are large, <inline-formula><mml:math id="inf500"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> can be approximated by an expression where the denominator is independent of <inline-formula><mml:math id="inf501"><mml:mi>i</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ80">Equation 65</xref>). In that regime, the average can be factorized; average category selectivity <inline-formula><mml:math id="inf502"><mml:mi>S</mml:mi></mml:math></inline-formula> and category clustering <inline-formula><mml:math id="inf503"><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math></inline-formula> thus take very similar values, as quantified by <xref ref-type="disp-formula" rid="equ81">Equation 66</xref> and <xref ref-type="disp-formula" rid="equ85">Equation 70</xref>. We conclude that, for our activity expressions, average category selectivity and category clustering are expected to behave similarly when both <inline-formula><mml:math id="inf504"><mml:mi>Q</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf505"><mml:mi>N</mml:mi></mml:math></inline-formula> are large. A detailed comparison between average selectivity and clustering within data from simulated circuits is provided in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>.</p></sec></sec></sec><sec id="s4-5"><title>Simple task: category correlation</title><p>To quantify how the population as a whole responds to the two categories, we evaluate category correlation. This quantity, denoted <inline-formula><mml:math id="inf506"><mml:mi>C</mml:mi></mml:math></inline-formula>, is given by the average Pearson correlation coefficient of activity in response to stimuli associated with different categories. We have:<disp-formula id="equ86"><label>(71)</label><mml:math id="m86"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf507"><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf508"><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula> are indices that denote sensory inputs associated, respectively, with categories <inline-formula><mml:math id="inf509"><mml:mi>A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf510"><mml:mi>B</mml:mi></mml:math></inline-formula>. The Pearson correlation <inline-formula><mml:math id="inf511"><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:msup></mml:math></inline-formula> is given by<disp-formula id="equ87"><label>(72)</label><mml:math id="m87"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msqrt><mml:msqrt><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msqrt><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msqrt><mml:msqrt><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>To go from the first to the second line, we used the fact that, for each sensory input,<disp-formula id="equ88"><label>(73)</label><mml:math id="m88"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where the second equality follows from <inline-formula><mml:math id="inf512"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ11">Equation 8a</xref>), which in turns implies that <inline-formula><mml:math id="inf513"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ38">Equation 28</xref>). Pearson correlation coefficients are displayed in the correlation matrices of <xref ref-type="fig" rid="fig2">Figure 2C, G, K</xref>.</p><p>As we show in Section Simple task: computing normalized dot products, in the large-<inline-formula><mml:math id="inf514"><mml:mi>N</mml:mi></mml:math></inline-formula> limit, <inline-formula><mml:math id="inf515"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> only depends on the category <inline-formula><mml:math id="inf516"><mml:mi>s</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf517"><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> are in. This makes the average over <inline-formula><mml:math id="inf518"><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf519"><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ86">Equation 71</xref> trivial. Using <xref ref-type="disp-formula" rid="equ106">Equation 90</xref> and <xref ref-type="disp-formula" rid="equ111">Equation 95</xref>, we arrive at<disp-formula id="equ89"><label>(74)</label><mml:math id="m89"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msqrt><mml:mi>N</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:msqrt><mml:msqrt><mml:mi>N</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>, we compare this approximate analytical expression with values measured in finite-size circuits, and find good agreement between the two. We can further simplify <xref ref-type="disp-formula" rid="equ89">Equation 74</xref> by Taylor expanding in <inline-formula><mml:math id="inf520"><mml:mi>N</mml:mi></mml:math></inline-formula>. To leading order, we obtain<disp-formula id="equ90"><label>(75)</label><mml:math id="m90"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Before learning, <inline-formula><mml:math id="inf521"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, and so correlation vanishes. After learning, <inline-formula><mml:math id="inf522"><mml:mi>C</mml:mi></mml:math></inline-formula> is non-zero, and its sign is given by the sign of the product <inline-formula><mml:math id="inf523"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>. This has a simple geometric explanation: after mean subtraction, activity vectors associated with opposite categories only overlap along the direction spanned by the initial readout vector <inline-formula><mml:math id="inf524"><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>. The coordinates of vectors associated with categories <inline-formula><mml:math id="inf525"><mml:mi>A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf526"><mml:mi>B</mml:mi></mml:math></inline-formula> along this direction are proportional, respectively, to <inline-formula><mml:math id="inf527"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf528"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ70">Equation 55</xref>). When <inline-formula><mml:math id="inf529"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf530"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula> have opposite sign, activity vectors acquire opposite components along <inline-formula><mml:math id="inf531"><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, which generates negative category correlation. When <inline-formula><mml:math id="inf532"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf533"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula> have identical sign, instead, activity vectors acquire aligned components, which generates positive category correlation.</p><p>To determine how the product <inline-formula><mml:math id="inf534"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> depends on parameters, we use <xref ref-type="disp-formula" rid="equ63">Equation 49</xref> for <inline-formula><mml:math id="inf535"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf536"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula> to write<disp-formula id="equ91"><label>(76)</label><mml:math id="m91"><mml:mrow><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mi>γ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mi>γ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where the (positive) scalars <inline-formula><mml:math id="inf537"><mml:mi>α</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf538"><mml:mi>β</mml:mi></mml:math></inline-formula> are defined in <xref ref-type="disp-formula" rid="equ61">Equation 48</xref>, and <inline-formula><mml:math id="inf539"><mml:mi>γ</mml:mi></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ65">Equation 50</xref>. Consequently, the sign of <inline-formula><mml:math id="inf540"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, and thus, the sign of the category correlation <inline-formula><mml:math id="inf541"><mml:mi>C</mml:mi></mml:math></inline-formula>, depends on the value of the target synaptic drives <inline-formula><mml:math id="inf542"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf543"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2F</xref>), as well as on <inline-formula><mml:math id="inf544"><mml:mi>γ</mml:mi></mml:math></inline-formula>.</p><p>In particular, when <inline-formula><mml:math id="inf545"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf546"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> have opposite sign, <xref ref-type="disp-formula" rid="equ91">Equation 76</xref> can only be negative, and thus category correlation can only be negative. When <inline-formula><mml:math id="inf547"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf548"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> have identical sign, <xref ref-type="disp-formula" rid="equ91">Equation 76</xref> can be either negative or positive, depending on the value of the shift <inline-formula><mml:math id="inf549"><mml:mi>γ</mml:mi></mml:math></inline-formula>, and thus category correlation can be either negative or positive. For fixed target values <inline-formula><mml:math id="inf550"><mml:msup><mml:mi>z</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf551"><mml:msup><mml:mi>z</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula>, the relative sign of <inline-formula><mml:math id="inf552"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf553"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> depends on the shape of the activation function of the readout neuron <inline-formula><mml:math id="inf554"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula>. In the example given in <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2F</xref>, we show that the relative sign of <inline-formula><mml:math id="inf555"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf556"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> can be modified by changing the threshold of <inline-formula><mml:math id="inf557"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula>. More in general, changing both the gain and threshold of <inline-formula><mml:math id="inf558"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula> can change the sign and magnitude of category correlation (<xref ref-type="fig" rid="fig4">Figure 4A</xref>).</p><p>What controls the value of the shift <inline-formula><mml:math id="inf559"><mml:mi>γ</mml:mi></mml:math></inline-formula> (and, thus, the sign of correlation when <inline-formula><mml:math id="inf560"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf561"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> have identical sign)? Combining <xref ref-type="disp-formula" rid="equ65">Equation 50</xref> for <inline-formula><mml:math id="inf562"><mml:mi>γ</mml:mi></mml:math></inline-formula> with <xref ref-type="disp-formula" rid="equ61">Equation 48</xref> for <inline-formula><mml:math id="inf563"><mml:mi>α</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf564"><mml:mi>β</mml:mi></mml:math></inline-formula>, we have<disp-formula id="equ92"><label>(77)</label><mml:math id="m92"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>Q</mml:mi><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">[</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">]</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Recall that <inline-formula><mml:math id="inf565"><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is always positive. We observe that <inline-formula><mml:math id="inf566"><mml:mi>γ</mml:mi></mml:math></inline-formula> depends on the learning rate ratio <inline-formula><mml:math id="inf567"><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>: increasing this ratio increases the value of <inline-formula><mml:math id="inf568"><mml:mi>γ</mml:mi></mml:math></inline-formula> and thus, via <xref ref-type="disp-formula" rid="equ91">Equation 76</xref>, favours negative correlation (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). It also depends on the number of stimuli, <inline-formula><mml:math id="inf569"><mml:mi>Q</mml:mi></mml:math></inline-formula>: increasing <inline-formula><mml:math id="inf570"><mml:mi>Q</mml:mi></mml:math></inline-formula> increases the value of <inline-formula><mml:math id="inf571"><mml:mi>γ</mml:mi></mml:math></inline-formula>, and thus also favours negative correlation (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). Finally, <inline-formula><mml:math id="inf572"><mml:mi>γ</mml:mi></mml:math></inline-formula> depends on the activation function of neurons in the intermediate layer, <inline-formula><mml:math id="inf573"><mml:mi mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula>, through nonlinear population averages; by computing those averages, we find that decreasing the gain and threshold of <inline-formula><mml:math id="inf574"><mml:mi mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula> favours negative correlation (<xref ref-type="fig" rid="fig4">Figure 4B</xref>).</p><sec id="s4-5-1"><title>Alternative definition</title><p>For completeness, we observe that an alternative way of quantifying category correlation consists of averaging activity over stimuli first (<xref ref-type="fig" rid="fig2">Figure 2D, H and L</xref>), and then computing the Person correlation coefficient between averaged responses. The correlation values obtained via this procedure are displayed in the legend of <xref ref-type="fig" rid="fig2">Figure 2D, H, L</xref>. This alternative definition yields qualitatively identical results to <xref ref-type="disp-formula" rid="equ86">Equation 71</xref>; we show this below.</p><p>We start by defining the category-averaged activity<disp-formula id="equ93"><label>(78a)</label><mml:math id="m93"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ94"><label>(78b)</label><mml:math id="m94"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We then define category correlation as<disp-formula id="equ95"><label>(79)</label><mml:math id="m95"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt><mml:msqrt><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msqrt><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:msqrt><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>Then, using <xref ref-type="disp-formula" rid="equ106">Equation 90</xref> and <xref ref-type="disp-formula" rid="equ111">Equation 95</xref> from Section Simple task: computing normalized dot products, we have<disp-formula id="equ96"><label>(80)</label><mml:math id="m96"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mi>Q</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>while<disp-formula id="equ97"><label>(81)</label><mml:math id="m97"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mi>Q</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">[</mml:mo></mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mo>≠</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mi>Q</mml:mi></mml:mfrac><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">[</mml:mo></mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mi>Q</mml:mi></mml:mfrac><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>and similarly for <inline-formula><mml:math id="inf575"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, by replacing <inline-formula><mml:math id="inf576"><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:math></inline-formula> with <inline-formula><mml:math id="inf577"><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:math></inline-formula>. Inserting this into <xref ref-type="disp-formula" rid="equ95">Equation 79</xref>, we arrive at<disp-formula id="equ98"><label>(82)</label><mml:math id="m98"><mml:mrow><mml:mrow><mml:mi mathsize="90%">C</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo maxsize="90%" minsize="90%">⟨</mml:mo><mml:mmultiscripts><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi><mml:none/><mml:mo mathsize="90%" stretchy="false">′</mml:mo><mml:none/><mml:mn mathsize="90%">2</mml:mn></mml:mmultiscripts><mml:mo maxsize="90%" minsize="90%">⟩</mml:mo></mml:mrow><mml:mn mathsize="90%">2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mrow><mml:mfrac><mml:mn mathsize="90%">2</mml:mn><mml:mi mathsize="90%">Q</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:mrow><mml:mo maxsize="90%" minsize="90%">⟨</mml:mo><mml:msup><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi><mml:mn mathsize="90%">2</mml:mn></mml:msup><mml:mo maxsize="90%" minsize="90%">⟩</mml:mo></mml:mrow><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:msup><mml:mrow><mml:mo maxsize="90%" minsize="90%">⟨</mml:mo><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi><mml:mo maxsize="90%" minsize="90%">⟩</mml:mo></mml:mrow><mml:mn mathsize="90%">2</mml:mn></mml:msup></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow></mml:mrow><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow><mml:mn mathsize="90%">2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo maxsize="90%" minsize="90%">⟨</mml:mo><mml:mmultiscripts><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi><mml:none/><mml:mo mathsize="90%" stretchy="false">′</mml:mo><mml:none/><mml:mn mathsize="90%">2</mml:mn></mml:mmultiscripts><mml:mo maxsize="90%" minsize="90%">⟩</mml:mo></mml:mrow><mml:mn mathsize="90%">2</mml:mn></mml:msup><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:mrow><mml:mfrac><mml:mn mathsize="90%">2</mml:mn><mml:mi mathsize="90%">Q</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:mrow><mml:mo maxsize="90%" minsize="90%">⟨</mml:mo><mml:mmultiscripts><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi><mml:none/><mml:mo mathsize="90%" stretchy="false">′</mml:mo><mml:none/><mml:mn mathsize="90%">4</mml:mn></mml:mmultiscripts><mml:mo maxsize="90%" minsize="90%">⟩</mml:mo></mml:mrow><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:msup><mml:mrow><mml:mo maxsize="90%" minsize="90%">⟨</mml:mo><mml:mmultiscripts><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi><mml:none/><mml:mo mathsize="90%" stretchy="false">′</mml:mo><mml:none/><mml:mn mathsize="90%">2</mml:mn></mml:mmultiscripts><mml:mo maxsize="90%" minsize="90%">⟩</mml:mo></mml:mrow><mml:mn mathsize="90%">2</mml:mn></mml:msup></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msqrt><mml:mo>⁢</mml:mo><mml:msqrt><mml:mrow><mml:mrow><mml:mfrac><mml:mn mathsize="90%">2</mml:mn><mml:mi mathsize="90%">Q</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:mrow><mml:mo maxsize="90%" minsize="90%">⟨</mml:mo><mml:msup><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi><mml:mn mathsize="90%">2</mml:mn></mml:msup><mml:mo maxsize="90%" minsize="90%">⟩</mml:mo></mml:mrow><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:msup><mml:mrow><mml:mo maxsize="90%" minsize="90%">⟨</mml:mo><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi><mml:mo maxsize="90%" minsize="90%">⟩</mml:mo></mml:mrow><mml:mn mathsize="90%">2</mml:mn></mml:msup></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow></mml:mrow><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow><mml:mn mathsize="90%">2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo maxsize="90%" minsize="90%">⟨</mml:mo><mml:mmultiscripts><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi><mml:none/><mml:mo mathsize="90%" stretchy="false">′</mml:mo><mml:none/><mml:mn mathsize="90%">2</mml:mn></mml:mmultiscripts><mml:mo maxsize="90%" minsize="90%">⟩</mml:mo></mml:mrow><mml:mn mathsize="90%">2</mml:mn></mml:msup><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:mrow><mml:mfrac><mml:mn mathsize="90%">2</mml:mn><mml:mi mathsize="90%">Q</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:mrow><mml:mo maxsize="90%" minsize="90%">⟨</mml:mo><mml:mmultiscripts><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi><mml:none/><mml:mo mathsize="90%" stretchy="false">′</mml:mo><mml:none/><mml:mn mathsize="90%">4</mml:mn></mml:mmultiscripts><mml:mo maxsize="90%" minsize="90%">⟩</mml:mo></mml:mrow><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:msup><mml:mrow><mml:mo maxsize="90%" minsize="90%">⟨</mml:mo><mml:mmultiscripts><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi><mml:none/><mml:mo mathsize="90%" stretchy="false">′</mml:mo><mml:none/><mml:mn mathsize="90%">2</mml:mn></mml:mmultiscripts><mml:mo maxsize="90%" minsize="90%">⟩</mml:mo></mml:mrow><mml:mn mathsize="90%">2</mml:mn></mml:msup></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow><mml:mo mathsize="90%" stretchy="false">.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Although the denominator of this expression is different from <xref ref-type="disp-formula" rid="equ89">Equation 74</xref>, the numerator is identical. As the denominators in both expressions are positive, the qualitative behaviour of <xref ref-type="disp-formula" rid="equ98">Equation 82</xref> is identical to <xref ref-type="disp-formula" rid="equ89">Equation 74</xref>. Furthermore, to leading order in <inline-formula><mml:math id="inf578"><mml:mi>N</mml:mi></mml:math></inline-formula>, we obtain<disp-formula id="equ99"><label>(83)</label><mml:math id="m99"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>Q</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>which is proportional to <xref ref-type="disp-formula" rid="equ90">Equation 75</xref>, with constant of proportionality equal to <inline-formula><mml:math id="inf579"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>.</p></sec></sec><sec id="s4-6"><title>Simple task: computing normalized dot products</title><p>We now compute the normalized dot products among pairs of activity vectors; namely<disp-formula id="equ100"><label>(84)</label><mml:math id="m100"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Those were used above to derive the behaviour of category clustering (Section Simple task: category selectivity) and correlations (Section Simple task: category correlation).</p><p>The dot product takes different values depending on whether or not sensory inputs <inline-formula><mml:math id="inf580"><mml:mi mathsize="90%">s</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf581"><mml:msup><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">′</mml:mo></mml:msup></mml:math></inline-formula> coincide. We start with the former,<disp-formula id="equ101"><label>(85)</label><mml:math id="m101"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We used the fact that the cross-term <inline-formula><mml:math id="inf582"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> vanishes on average,<disp-formula id="equ102"><label>(86)</label><mml:math id="m102"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></disp-formula></p><p>where we used <xref ref-type="disp-formula" rid="equ66">Equation 51</xref> for the first equality, <xref ref-type="disp-formula" rid="equ38">Equation 28</xref> for the second, and <xref ref-type="disp-formula" rid="equ11">Equation 8a</xref> for the third. By definition,<disp-formula id="equ103"> <label>(87)</label><mml:math id="m103"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:mrow></mml:math></disp-formula></p><p>while<disp-formula id="equ104"><label>(88)</label><mml:math id="m104"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where we have used the fact that, from <xref ref-type="disp-formula" rid="equ38">Equation 28</xref><disp-formula id="equ105"><label>(89)</label><mml:math id="m105"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Putting these results together, we have<disp-formula id="equ106"><label>(90)</label><mml:math id="m106"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:mtd><mml:mtd><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mi>s</mml:mi><mml:mrow><mml:mtext> in category </mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:mtd><mml:mtd><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mi>s</mml:mi><mml:mrow><mml:mtext> in category </mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Note that activity vectors associated with different categories are characterized by different norms (unless coordinates are fine-tuned to be symmetric: <inline-formula><mml:math id="inf583"><mml:mrow><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, which occurs when <inline-formula><mml:math id="inf584"><mml:mrow><mml:mrow><mml:msup><mml:mi mathsize="90%" mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:mn mathsize="90%">1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:msup><mml:mi mathsize="90%">z</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:mrow><mml:msup><mml:mi mathsize="90%" mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:mn mathsize="90%">1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:msup><mml:mi mathsize="90%">z</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, as in <xref ref-type="fig" rid="fig2">Figure 2E–H</xref>). Asymmetry of activity in response to different categories is discussed in detail in Section Asymmetry in category response.</p><p>For dot products among different activity vectors, we have<disp-formula id="equ107"><label>(91)</label><mml:math id="m107"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>with <inline-formula><mml:math id="inf585"><mml:mrow><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">≠</mml:mo><mml:msup><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>. In this case,<disp-formula id="equ108"><label>(92)</label><mml:math id="m108"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula></p><p>while<disp-formula id="equ109"><label>(93)</label><mml:math id="m109"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>which comes from<disp-formula id="equ110"><label>(94)</label><mml:math id="m110"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Putting this together, we arrive at<disp-formula id="equ111"><label>(95)</label><mml:math id="m111"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mi>s</mml:mi><mml:mrow><mml:mtext>, </mml:mtext></mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mtext> in category </mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mi>s</mml:mi><mml:mrow><mml:mtext>, </mml:mtext></mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mtext> in category </mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mi>s</mml:mi><mml:mrow><mml:mtext>, </mml:mtext></mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mtext> in diff. categories</mml:mtext></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ111">Equation 95</xref> has a simple geometric interpretation. The first term in the right-hand side, <inline-formula><mml:math id="inf586"><mml:msup><mml:mrow><mml:mo maxsize="90%" minsize="90%">⟨</mml:mo><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi><mml:mo maxsize="90%" minsize="90%">⟩</mml:mo></mml:mrow><mml:mn mathsize="90%">2</mml:mn></mml:msup></mml:math></inline-formula>, is generated by the overlap between the activity vectors along the direction spanned by the unit vector <inline-formula><mml:math id="inf587"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. This component is due to the activation function <inline-formula><mml:math id="inf588"><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula> being positive, and is approximately constant over learning. The second term on the right-hand side emerges over learning. This arises because activity vectors become aligned, via the spanning vectors (<xref ref-type="disp-formula" rid="equ40">Equation 30</xref>), along the direction spanned by the initial readout vector <inline-formula><mml:math id="inf589"><mml:msub><mml:mi mathsize="90%" mathvariant="bold-italic">w</mml:mi><mml:mn mathsize="90%">0</mml:mn></mml:msub></mml:math></inline-formula>. Note that the components of activity that are aligned with the residual directions <inline-formula><mml:math id="inf590"><mml:mrow><mml:mi mathsize="90%">δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi mathsize="90%">s</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ67">Equation 52</xref>) do not contribute to the dot product. This can be verified by computing the dot product directly from <xref ref-type="disp-formula" rid="equ70">Equation 55</xref>, where residuals are neglected, and observing that the same result is obtained. This was expected, as we have showed in <xref ref-type="disp-formula" rid="equ69">Equation 54</xref> that, for the current task task, residuals are orthogonal to each other.</p></sec><sec id="s4-7"><title>Asymmetry in category response</title><p>In <xref ref-type="fig" rid="fig2">Figure 2L</xref> in the main text, activity in response to categories <inline-formula><mml:math id="inf591"><mml:mi mathsize="90%">A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf592"><mml:mi mathsize="90%">B</mml:mi></mml:math></inline-formula> is asymmetric: the number of neurons that respond more strongly to category <inline-formula><mml:math id="inf593"><mml:mi mathsize="90%">A</mml:mi></mml:math></inline-formula> is significantly larger than the number that respond more strongly to category <inline-formula><mml:math id="inf594"><mml:mi mathsize="90%">B</mml:mi></mml:math></inline-formula>. Furthermore, the mean and variance of activity across the population are larger in response to <inline-formula><mml:math id="inf595"><mml:mi mathsize="90%">A</mml:mi></mml:math></inline-formula> than to <inline-formula><mml:math id="inf596"><mml:mi mathsize="90%">B</mml:mi></mml:math></inline-formula>. Such asymmetry is not present at <inline-formula><mml:math id="inf597"><mml:mrow><mml:mi mathsize="90%">t</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mn mathsize="90%">0</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2D</xref>), and is thus a consequence of learning. Asymmetry has been reported in experimental data as well (<xref ref-type="bibr" rid="bib19">Fitzgerald et al., 2013</xref>), where it was referred to as <italic>biased category representations</italic>. Here, we discuss in detail why and how response asymmetry arises in the model. We show that asymmetry is controlled by the value of the target readout activity, <inline-formula><mml:math id="inf598"><mml:msup><mml:mi mathsize="90%">z</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf599"><mml:msup><mml:mi mathsize="90%">z</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:math></inline-formula>, and also by the shape of the activation functions of the intermediate and readout layer, <inline-formula><mml:math id="inf600"><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf601"><mml:mi mathsize="90%" mathvariant="normal">Φ</mml:mi></mml:math></inline-formula>.</p><p><xref ref-type="fig" rid="fig2">Figure 2L</xref> displays activity in response to categories <inline-formula><mml:math id="inf602"><mml:mi mathsize="90%">A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf603"><mml:mi mathsize="90%">B</mml:mi></mml:math></inline-formula> averaged over stimuli; those are denoted, respectively, by <inline-formula><mml:math id="inf604"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">y</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf605"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">y</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ93">Equation 78</xref>). We start deriving an explicit expression for <inline-formula><mml:math id="inf606"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">y</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup></mml:math></inline-formula>, from which the mean and variance across the population can be computed. Since initial activity is symmetric, we focus on the part of activity that is induced by learning. Combining <xref ref-type="disp-formula" rid="equ66">Equation 51</xref> with <xref ref-type="disp-formula" rid="equ38">Equation 28</xref>, we have<disp-formula id="equ112"><label>(96)</label><mml:math id="m112"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>≡</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>≃</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>where the last approximate equality follows if <inline-formula><mml:math id="inf607"><mml:mi mathsize="90%">Q</mml:mi></mml:math></inline-formula> is sufficiently large. The variance across the population is, therefore, given by<disp-formula id="equ113"><label>(97)</label><mml:math id="m113"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>For the variance across the population in response to category <inline-formula><mml:math id="inf608"><mml:mi mathsize="90%">B</mml:mi></mml:math></inline-formula>, we simply replace <inline-formula><mml:math id="inf609"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup></mml:math></inline-formula> with <inline-formula><mml:math id="inf610"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:math></inline-formula>.</p><p>Consequently, the variances in response to categories <inline-formula><mml:math id="inf611"><mml:mi mathsize="90%">A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf612"><mml:mi mathsize="90%">B</mml:mi></mml:math></inline-formula> are identical only if <inline-formula><mml:math id="inf613"><mml:mrow><mml:msup><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow><mml:mn mathsize="90%">2</mml:mn></mml:msup><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:msup><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow><mml:mn mathsize="90%">2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>. From <xref ref-type="disp-formula" rid="equ63">Equation 49</xref>, we see that this happens only if <inline-formula><mml:math id="inf614"><mml:mrow><mml:mrow><mml:msup><mml:mi mathsize="90%" mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:mn mathsize="90%">1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:msup><mml:mi mathsize="90%">z</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:mrow><mml:msup><mml:mi mathsize="90%" mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:mn mathsize="90%">1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:msup><mml:mi mathsize="90%">z</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, which yields <inline-formula><mml:math id="inf615"><mml:mrow><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. <xref ref-type="fig" rid="fig2">Figure 2H</xref> shows a circuit where the activation function of the readout neuron, <inline-formula><mml:math id="inf616"><mml:mi mathsize="90%" mathvariant="normal">Φ</mml:mi></mml:math></inline-formula>, was chosen to satisfy this relationship. In general, however, the two variances differ, and can have either <inline-formula><mml:math id="inf617"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> (the variance in response to <inline-formula><mml:math id="inf618"><mml:mi mathsize="90%">A</mml:mi></mml:math></inline-formula> is lather than to <inline-formula><mml:math id="inf619"><mml:mi mathsize="90%">B</mml:mi></mml:math></inline-formula>), or <inline-formula><mml:math id="inf620"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> (the opposite). <xref ref-type="fig" rid="fig2">Figure 2L</xref> corresponds to the first scenario, <inline-formula><mml:math id="inf621"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>; this was achieved by setting <inline-formula><mml:math id="inf622"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, which yielded <inline-formula><mml:math id="inf623"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2A, B</xref> correspond to the second scenario, <inline-formula><mml:math id="inf624"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>; this was achieved by setting <inline-formula><mml:math id="inf625"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, which yielded <inline-formula><mml:math id="inf626"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. Note that in both cases, <inline-formula><mml:math id="inf627"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, as it must be (<xref ref-type="disp-formula" rid="equ63">Equation 49</xref>).</p><p>In <xref ref-type="fig" rid="fig2">Figure 2L</xref>, activity in response to category <inline-formula><mml:math id="inf628"><mml:mi mathsize="90%">A</mml:mi></mml:math></inline-formula> is not only characterized by larger variance, but also larger mean. This observation does not emerge immediately from our analysis, since our equations predict that the mean of activity changes vanishes both in response to <inline-formula><mml:math id="inf629"><mml:mi mathsize="90%">A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf630"><mml:mi mathsize="90%">B</mml:mi></mml:math></inline-formula>: from <xref ref-type="disp-formula" rid="equ11">Equation 8a</xref>, we see that in response to category <inline-formula><mml:math id="inf631"><mml:mi mathsize="90%">A</mml:mi></mml:math></inline-formula>,<disp-formula id="equ114"><label>(98)</label><mml:math id="m114"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></disp-formula></p><p>and similarly for category <inline-formula><mml:math id="inf632"><mml:mi mathsize="90%">B</mml:mi></mml:math></inline-formula>. To understand how <xref ref-type="disp-formula" rid="equ114">Equation 98</xref> can be reconciled with <xref ref-type="fig" rid="fig2">Figure 2L</xref>, recall that the equations we use for activity changes (<xref ref-type="disp-formula" rid="equ39">Equation 29</xref>) provide a linearized estimate of activity changes, which is strictly valid only in infinitely wide networks. In finite width networks, a non-zero mean response can emerge from higher-order terms in the expansion of <xref ref-type="disp-formula" rid="equ37">Equation 27</xref>. The leading higher-order terms of this expansion are quadratic, implying that the behaviour of the mean is controlled by the second-order derivative of the activation function of neurons in the intermediate layer, <inline-formula><mml:math id="inf633"><mml:msup><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi><mml:mo mathsize="90%" stretchy="false">′′</mml:mo></mml:msup></mml:math></inline-formula>. When the threshold of <inline-formula><mml:math id="inf634"><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula> is positive (so that activity is initialized close to the lower bound of <inline-formula><mml:math id="inf635"><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula>), the second-order derivative <inline-formula><mml:math id="inf636"><mml:msup><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi><mml:mo mathsize="90%" stretchy="false">′′</mml:mo></mml:msup></mml:math></inline-formula> is positive on average. Combined with <inline-formula><mml:math id="inf637"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, this implies that the mean of activity in response to category <inline-formula><mml:math id="inf638"><mml:mi mathsize="90%">A</mml:mi></mml:math></inline-formula> is larger than to <inline-formula><mml:math id="inf639"><mml:mi mathsize="90%">B</mml:mi></mml:math></inline-formula>; this case is illustrated in <xref ref-type="fig" rid="fig2">Figure 2L</xref>. When the threshold of <inline-formula><mml:math id="inf640"><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula> is negative (so that activity is initialized close to the upper bound of <inline-formula><mml:math id="inf641"><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula>), the second-order derivative <inline-formula><mml:math id="inf642"><mml:msup><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi><mml:mo mathsize="90%" stretchy="false">′′</mml:mo></mml:msup></mml:math></inline-formula> is negative on average. Combined with <inline-formula><mml:math id="inf643"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, this implies that the mean of activity in response to category <inline-formula><mml:math id="inf644"><mml:mi mathsize="90%">A</mml:mi></mml:math></inline-formula> is smaller than to <inline-formula><mml:math id="inf645"><mml:mi mathsize="90%">B</mml:mi></mml:math></inline-formula>; this case is illustrated in <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2C, D</xref>.</p><p>Finally, <xref ref-type="disp-formula" rid="equ114">Equation 98</xref> suggests that non-vanishing mean activity could also be obtained if the initial readout weights <inline-formula><mml:math id="inf646"><mml:msub><mml:mi mathsize="90%">w</mml:mi><mml:mrow><mml:mn mathsize="90%">0</mml:mn><mml:mo mathsize="90%" stretchy="false">,</mml:mo><mml:mi mathsize="90%">i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> have a non-zero mean. This is likely to be verified in the brain, where intra-area connectivity is mainly excitatory. We leave the incorporation of non-zero mean connectivity, along with Dale’s law, to future investigations.</p></sec><sec id="s4-8"><title>Characterizing variability</title><p>In Section Simple task: computing activity, when computing the value of activity coordinates <inline-formula><mml:math id="inf647"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula>, we neglected the second terms within the left-hand side of <xref ref-type="disp-formula" rid="equ53">Equation 42</xref>; because of this, the coordinates took on only two values, namely <inline-formula><mml:math id="inf648"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf649"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ58">Equation 46</xref>). The neglected terms do not self-average, and thus fluctuate at random across model realizations. Had we included these variable terms, <xref ref-type="disp-formula" rid="equ58">Equation 46</xref> would have read<disp-formula id="equ115"><label>(99)</label><mml:math id="m115"><mml:mrow><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:msup><mml:mi mathsize="90%">δ</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mpadded lspace="10pt" width="+10pt"><mml:mi mathsize="90%">s</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mtext mathsize="90%"> in category </mml:mtext><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">A</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:msup><mml:mi mathsize="90%">δ</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mpadded lspace="10pt" width="+10pt"><mml:mi mathsize="90%">s</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mtext mathsize="90%"> in category </mml:mtext><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">B</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mi/></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where the <inline-formula><mml:math id="inf650"><mml:msup><mml:mi mathsize="90%">δ</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula> obey the linear system of equations<disp-formula id="equ116"><label>(100)</label><mml:math id="m116"><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msup><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, we further characterize the behaviour of the neglected terms <inline-formula><mml:math id="inf651"><mml:msup><mml:mi mathsize="90%">δ</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula>. For simplicity, we consider the case in which plasticity in the readout weights is much slower than plasticity in the input connectivity (<inline-formula><mml:math id="inf652"><mml:mrow><mml:msub><mml:mi mathsize="90%">η</mml:mi><mml:mi mathsize="90%">w</mml:mi></mml:msub><mml:mo mathsize="90%" stretchy="false">≪</mml:mo><mml:msub><mml:mi mathsize="90%">η</mml:mi><mml:mi mathsize="90%">u</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>). In that regime, <xref ref-type="disp-formula" rid="equ116">Equation 100</xref> greatly simplifies, and we obtain<disp-formula id="equ117"><label>(101)</label><mml:math id="m117"><mml:mrow><mml:msup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>There are two sources of random fluctuations in <inline-formula><mml:math id="inf653"><mml:msubsup><mml:mi mathsize="90%">h</mml:mi><mml:mn mathsize="90%">0</mml:mn><mml:mi mathsize="90%">s</mml:mi></mml:msubsup></mml:math></inline-formula>: different realizations of the circuit (via different initializations of the intermediate and readout connectivity, <inline-formula><mml:math id="inf654"><mml:mi mathsize="90%" mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf655"><mml:mi mathsize="90%" mathvariant="bold-italic">w</mml:mi></mml:math></inline-formula>), and different sensory inputs. In the following, we show that these two sources of variability can be decomposed, and one can write<disp-formula id="equ118"><label>(102)</label><mml:math id="m118"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:mrow><mml:mi>κ</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:msqrt><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt></mml:mrow><mml:msup><mml:mi>ε</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf656"><mml:mi mathsize="90%">κ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf657"><mml:msup><mml:mi mathsize="90%">ε</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula> are zero-mean, unit-variance Gaussian variables. For a given circuit realization, the value of <inline-formula><mml:math id="inf658"><mml:mi mathsize="90%">κ</mml:mi></mml:math></inline-formula> is fixed, while the value of <inline-formula><mml:math id="inf659"><mml:msup><mml:mi mathsize="90%">ε</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula> fluctuates across different sensory inputs. Combining <xref ref-type="disp-formula" rid="equ118">Equation 102</xref> with <xref ref-type="disp-formula" rid="equ115">Equation 99</xref>, we conclude that two different forms of variability (one that is frozen for a given circuit realization, represented by <inline-formula><mml:math id="inf660"><mml:mi mathsize="90%">κ</mml:mi></mml:math></inline-formula>, and one that is not, represented by <inline-formula><mml:math id="inf661"><mml:msup><mml:mi mathsize="90%">ε</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula>) impact activity coordinates <inline-formula><mml:math id="inf662"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf663"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:math></inline-formula>; the absolute and relative amplitude of the two contributions is controlled by the shape of the activation function <inline-formula><mml:math id="inf664"><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula>. Such factorization of variability is illustrated, for an example simulated circuit, in <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2E</xref>.</p><p>To derive <xref ref-type="disp-formula" rid="equ118">Equation 102</xref>, we consider a given circuit realization, and assume that the number of stimuli <inline-formula><mml:math id="inf665"><mml:mi mathsize="90%">Q</mml:mi></mml:math></inline-formula> is sufficiently large, so that averages over stimuli approximately self-average. We start from <xref ref-type="disp-formula" rid="equ9">Equation 6b</xref>, and compute the mean of of <inline-formula><mml:math id="inf666"><mml:msubsup><mml:mi mathsize="90%">h</mml:mi><mml:mn mathsize="90%">0</mml:mn><mml:mi mathsize="90%">s</mml:mi></mml:msubsup></mml:math></inline-formula> over sensory inputs, which yields<disp-formula id="equ119"><label>(103)</label><mml:math id="m119"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>By defining <inline-formula><mml:math id="inf667"><mml:mrow><mml:mi mathsize="90%">κ</mml:mi><mml:mo mathsize="90%" stretchy="false">≡</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" mathsize="90%" stretchy="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi mathsize="90%">i</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mn mathsize="90%">1</mml:mn></mml:mrow><mml:mi mathsize="90%">N</mml:mi></mml:msubsup><mml:msub><mml:mi mathsize="90%">w</mml:mi><mml:mrow><mml:mn mathsize="90%">0</mml:mn><mml:mo mathsize="90%" stretchy="false">,</mml:mo><mml:mi mathsize="90%">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, the first term in the right-hand side of <xref ref-type="disp-formula" rid="equ118">Equation 102</xref> follows. We then compute the variance of of <inline-formula><mml:math id="inf668"><mml:msubsup><mml:mi mathsize="90%">h</mml:mi><mml:mn mathsize="90%">0</mml:mn><mml:mi mathsize="90%">s</mml:mi></mml:msubsup></mml:math></inline-formula> over sensory inputs. By using:<disp-formula id="equ120"><label>(104)</label><mml:math id="m120"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>and, from <xref ref-type="disp-formula" rid="equ119">Equation 103</xref><disp-formula id="equ121"> <label>(105)</label><mml:math id="m121"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>we conclude that:<disp-formula id="equ122"><label>(106)</label><mml:math id="m122"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>from which the second term in the right-hand side of <xref ref-type="disp-formula" rid="equ118">Equation 102</xref> follows.</p><p><xref ref-type="disp-formula" rid="equ81">Equation 66</xref> and <xref ref-type="disp-formula" rid="equ89">Equation 74</xref> indicate that activity measures such as category selectivity and correlation depend on the value of activity coordinates <inline-formula><mml:math id="inf669"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf670"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:math></inline-formula>. As coordinates are variable (<xref ref-type="disp-formula" rid="equ115">Equation 99</xref>), activity measures are variable as well. Importantly, activity measures involve averages over sensory inputs (see <xref ref-type="disp-formula" rid="equ71">Equation 56</xref> and <xref ref-type="disp-formula" rid="equ86">Equation 71</xref>). This implies that the two forms of variability described by <xref ref-type="disp-formula" rid="equ118">Equation 102</xref> are expected to contribute in different ways: variability originating from the second term (which fluctuates across stimuli, and thus can be averaged out) is expected to be small, while variability originating from the first term (which is fixed for each circuit realization) is expected to be large.</p><p>Variability in simulated circuits is quantified in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplements 1</xref> and <xref ref-type="fig" rid="fig3s2">2</xref>, where it is represented as error bars. <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1A</xref> and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2A</xref> show that variability in <inline-formula><mml:math id="inf671"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf672"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:math></inline-formula> is modulated by properties of the activation function <inline-formula><mml:math id="inf673"><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula> (third column); this is in agreement with <xref ref-type="disp-formula" rid="equ118">Equation 102</xref>, which indicates that the magnitude of variability is <inline-formula><mml:math id="inf674"><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula>-dependent. <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1B, C</xref> and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2B, C</xref> show, furthermore, that variability in correlation is typically much larger than in average selectivity. This can be explained by observing that average selectivity (<xref ref-type="disp-formula" rid="equ81">Equation 66</xref>) only depends on the difference between <inline-formula><mml:math id="inf675"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf676"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:math></inline-formula>, so variability originating from the first, frozen term of <xref ref-type="disp-formula" rid="equ118">Equation 102</xref> is expected to cancel; this is not the case for correlation (<xref ref-type="disp-formula" rid="equ89">Equation 74</xref>), for which the cancellation does not occur.</p></sec><sec id="s4-9"><title>Simple categorization task with structured inputs and heterogeneity</title><p>The circuit and task we considered so far are characterized by several simplifying modelling assumptions, which allowed us to analyze activity evolution in great detail and develop useful analytical intuition. One important assumption is that sensory input vectors corresponding to different stimuli are orthogonal to each other. This choice was motivated by two observations: first, in many tasks from the experimental literature, sensory stimuli are taken to be very different from each other, and thus sensory inputs are expected to be uncorrelated (<xref ref-type="bibr" rid="bib48">Messinger et al., 2001</xref>; <xref ref-type="bibr" rid="bib18">Fitzgerald et al., 2011</xref>; <xref ref-type="bibr" rid="bib70">Wallis et al., 2001</xref>); second, in tasks where sensory stimuli obey a continuous statistical structure (<xref ref-type="bibr" rid="bib22">Freedman and Assad, 2006</xref>), pre-processing from sensory brain regions (<xref ref-type="bibr" rid="bib2">Albright, 1984</xref>) is expected to decorrelate, at least partially, inputs to higher-level associative areas. A second important assumption is that neurons in the intermediate layer are statistically homogeneous, as they receive statistically identical inputs and are characterized by the same nonlinearity <inline-formula><mml:math id="inf677"><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula>.</p><p>For some tasks and brain regions, those two assumptions might be inaccurate. For example, data collected during passive conditions (<xref ref-type="bibr" rid="bib17">Fanini and Assad, 2009</xref>) indicate that some LIP neurons (<xref ref-type="bibr" rid="bib22">Freedman and Assad, 2006</xref>; <xref ref-type="bibr" rid="bib18">Fitzgerald et al., 2011</xref>; <xref ref-type="bibr" rid="bib19">Fitzgerald et al., 2013</xref>) display weak, but significant direction tuning, which might be due to structured sensory inputs. Furthermore, activity profiles are heterogeneous, with different neurons characterized by different baseline activity levels. To investigate whether our findings extrapolate beyond our two simplifying hypotheses, here we construct a more biologically grounded model, and use simulations to systematically investigate activity evolution in the resulting circuit.</p><p>To begin with, we use sensory input vectors characterized by a continuous statistical structure, which implies continuous tuning in the intermediate layer activity prior to learning. We set<disp-formula id="equ123"><label>(107)</label><mml:math id="m123"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msqrt><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:msup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">ξ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">ξ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf678"><mml:mi mathsize="90%" mathvariant="normal">Σ</mml:mi></mml:math></inline-formula> is a scalar that measures the fraction of inputs variance that is continuous. We fixed <inline-formula><mml:math id="inf679"><mml:mrow><mml:mi mathsize="90%" mathvariant="normal">Σ</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mn mathsize="90%">1</mml:mn><mml:mo mathsize="90%" stretchy="false">/</mml:mo><mml:mn mathsize="90%">3</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. Like <inline-formula><mml:math id="inf680"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">μ</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula>, entries of the vectors <inline-formula><mml:math id="inf681"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">ξ</mml:mi><mml:mn mathsize="90%">1</mml:mn></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf682"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">ξ</mml:mi><mml:mn mathsize="90%">2</mml:mn></mml:msup></mml:math></inline-formula> are generated at random from a zero-mean, unit-variance Gaussian distribution. We furthermore set<disp-formula id="equ124"><label>(108)</label><mml:math id="m124"><mml:mrow><mml:mrow><mml:msup><mml:mi mathsize="90%">θ</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mi mathsize="90%">s</mml:mi><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mfrac><mml:mrow><mml:mn mathsize="90%">2</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">π</mml:mi></mml:mrow><mml:mi mathsize="90%">Q</mml:mi></mml:mfrac></mml:mpadded></mml:mrow></mml:mrow><mml:mo mathsize="90%" stretchy="false">.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>With this choice, when <inline-formula><mml:math id="inf683"><mml:mrow><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">≠</mml:mo><mml:msup><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, we have <inline-formula><mml:math id="inf684"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, so stimuli with similar values of <inline-formula><mml:math id="inf685"><mml:mi mathsize="90%">s</mml:mi></mml:math></inline-formula> are more strongly correlated than stimuli with very different values of <inline-formula><mml:math id="inf686"><mml:mi mathsize="90%">s</mml:mi></mml:math></inline-formula>. As in <xref ref-type="bibr" rid="bib22">Freedman and Assad, 2006</xref>, we take <inline-formula><mml:math id="inf687"><mml:mrow><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mn mathsize="90%">12</mml:mn></mml:mrow></mml:math></inline-formula>. Similar to the standard task we analyzed so far, sensory inputs with <inline-formula><mml:math id="inf688"><mml:mrow><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mn mathsize="90%">1</mml:mn><mml:mo mathsize="90%" stretchy="false">,</mml:mo><mml:mi mathsize="90%" mathvariant="normal">…</mml:mi><mml:mo mathsize="90%" stretchy="false">,</mml:mo><mml:mrow><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">/</mml:mo><mml:mn mathsize="90%">2</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> are associated with category <inline-formula><mml:math id="inf689"><mml:mi mathsize="90%">A</mml:mi></mml:math></inline-formula>, while <inline-formula><mml:math id="inf690"><mml:mrow><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mrow><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">/</mml:mo><mml:mn mathsize="90%">2</mml:mn></mml:mrow><mml:mo mathsize="90%" stretchy="false">,</mml:mo><mml:mi mathsize="90%" mathvariant="normal">…</mml:mi><mml:mo mathsize="90%" stretchy="false">,</mml:mo><mml:mi mathsize="90%">Q</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> are associated with category <inline-formula><mml:math id="inf691"><mml:mi mathsize="90%">B</mml:mi></mml:math></inline-formula>. Note that, as in the simple categorization task we analyzed so far, sensory input vectors are linearly separable for every value of <inline-formula><mml:math id="inf692"><mml:mi mathsize="90%" mathvariant="normal">Σ</mml:mi></mml:math></inline-formula>.</p><p>To introduce heterogeneity in the intermediate layer, we add an offset, so <xref ref-type="disp-formula" rid="equ6">Equation 5</xref> becomes<disp-formula id="equ125"><label>(109a)</label><mml:math id="m125"><mml:mi mathsize="90%">y</mml:mi><mml:mrow><mml:mi/><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mi mathsize="90%">k</mml:mi><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ126"><label>(109b)</label><mml:math id="m126"><mml:mi mathsize="90%">k</mml:mi><mml:mrow><mml:mrow><mml:mi/><mml:mo mathsize="90%" stretchy="false">≡</mml:mo><mml:mrow><mml:mrow><mml:mi mathsize="90%">u</mml:mi><mml:mo mathsize="90%" stretchy="false">⋅</mml:mo><mml:mi mathsize="90%">x</mml:mi></mml:mrow><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:mpadded width="+1.7pt"><mml:mi mathsize="90%">b</mml:mi></mml:mpadded></mml:mrow></mml:mrow><mml:mo mathsize="90%" stretchy="false">.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The entries of <inline-formula><mml:math id="inf693"><mml:mi mathsize="90%" mathvariant="bold-italic">b</mml:mi></mml:math></inline-formula> are fixed bias terms that control the value of baseline activity for each neuron. We generate those entries from a zero-mean Gaussian distribution with standard deviation 0.2.</p><p>In contrast to the model we analyzed so far, initial activity is characterized by non-trivial activity measures. Specifically, initial population tuning is characterized by non-vanishing category correlation; the latter is modulated both by heterogeneity (which tends to increase signal correlations) and the continuous inputs structure (which tends to decrease them). For our choice of parameters, these two effects roughly balance each other, so that initial activity is characterized by initial correlation that is small in magnitude (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4A</xref>).</p><p>We investigated numerically the evolution of activity with learning for this model. Two sample circuits are shown in <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4B, C</xref>; extensive analysis is presented in <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4D, E</xref>. We find that the behaviour of both category selectivity and correlation is qualitatively consistent with the behaviour of the simpler model analyzed so far. Specifically, we find that average category selectivity increases over learning <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4D</xref>; this behaviour is robust, and does not depend on circuit details. For completeness, we tested two definitions of category selectivity. The first one is identical to <xref ref-type="disp-formula" rid="equ71">Equation 56</xref>; as initial activity is structured, this gives slightly positive initial values; the second one (which is used in related experimental work, <xref ref-type="bibr" rid="bib21">Freedman et al., 2001</xref>; <xref ref-type="bibr" rid="bib22">Freedman and Assad, 2006</xref>) is again identical to <xref ref-type="disp-formula" rid="equ71">Equation 56</xref> – but pairs of stimuli <inline-formula><mml:math id="inf694"><mml:mrow><mml:mi mathsize="90%">s</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> are subsampled in a way that is tailored to inputs structure to yield vanishing initial selectivity. We show in <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4D</xref> that both selectivity definitions give qualitatively similar results. Whether category correlation increases or decreases over learning depends, on the other hand, on parameters (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4B, C, E</xref>). Correlation depends on parameters in a way that is consistent with the simple task: it is strongly modulated by properties of the readout activation function <inline-formula><mml:math id="inf695"><mml:mi mathsize="90%" mathvariant="normal">Φ</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4E</xref>, different shades of gray). It also depends on the activation function of neurons in the intermediate layer <inline-formula><mml:math id="inf696"><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4E</xref>, left). Finally, it decreases with the learning ratio <inline-formula><mml:math id="inf697"><mml:mrow><mml:msub><mml:mi mathsize="90%">η</mml:mi><mml:mi mathsize="90%">w</mml:mi></mml:msub><mml:mo mathsize="90%" stretchy="false">/</mml:mo><mml:msub><mml:mi mathsize="90%">η</mml:mi><mml:mi mathsize="90%">u</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4E</xref>, center) and with the number of stimuli <inline-formula><mml:math id="inf698"><mml:mi mathsize="90%">Q</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4E</xref>, right).</p></sec><sec id="s4-10"><title>Context-dependent categorization task</title><sec id="s4-10-1"><title>Context-dependent task: task definition</title><p>The second task we consider is a context-dependent categorization task. On each trial, both a stimulus, and a context cue, are presented to the network. For simplicity, we assume that the number of stimuli and context cues is identical, and is equal to <inline-formula><mml:math id="inf699"><mml:mi mathsize="90%">Q</mml:mi></mml:math></inline-formula>. As in the simple task, each stimulus is represented by an input vector <inline-formula><mml:math id="inf700"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">μ</mml:mi><mml:mi mathsize="90%">S</mml:mi></mml:msup></mml:math></inline-formula>, with <inline-formula><mml:math id="inf701"><mml:mrow><mml:mi mathsize="90%">S</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mn mathsize="90%">1</mml:mn><mml:mo mathsize="90%" stretchy="false">,</mml:mo><mml:mi mathsize="90%" mathvariant="normal">…</mml:mi><mml:mo mathsize="90%" stretchy="false">,</mml:mo><mml:mi mathsize="90%">Q</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>; each context cue is also represented by an input vector, denoted <inline-formula><mml:math id="inf702"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">ν</mml:mi><mml:mi mathsize="90%">C</mml:mi></mml:msup></mml:math></inline-formula>, with <inline-formula><mml:math id="inf703"><mml:mrow><mml:mi mathsize="90%">C</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mn mathsize="90%">1</mml:mn><mml:mo mathsize="90%" stretchy="false">,</mml:mo><mml:mi mathsize="90%" mathvariant="normal">…</mml:mi><mml:mo mathsize="90%" stretchy="false">,</mml:mo><mml:mi mathsize="90%">Q</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. The entries of both vectors, <inline-formula><mml:math id="inf704"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">μ</mml:mi><mml:mi mathsize="90%">S</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf705"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">ν</mml:mi><mml:mi mathsize="90%">C</mml:mi></mml:msup></mml:math></inline-formula>, are generated independently from a zero-mean, unit-variance Gaussian distribution. The total sensory input on each trial, <inline-formula><mml:math id="inf706"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">x</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula>, is given by the linear combination of the stimulus and context cue inputs,<disp-formula id="equ127"><label>(110)</label><mml:math id="m127"><mml:mrow><mml:mrow><mml:msup><mml:mi mathsize="90%">x</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mfrac><mml:mn mathsize="90%">1</mml:mn><mml:msqrt><mml:mn mathsize="90%">2</mml:mn></mml:msqrt></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi mathsize="90%">μ</mml:mi><mml:msub><mml:mi mathsize="90%">S</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msub></mml:msup><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:msup><mml:mi mathsize="90%">ν</mml:mi><mml:msub><mml:mi mathsize="90%">C</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msub></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo mathsize="90%" stretchy="false">.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>All combinations of stimuli and context cues are permitted; the total number of trials and sensory inputs is thus <inline-formula><mml:math id="inf707"><mml:mrow><mml:mi mathsize="90%">P</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:msup><mml:mi mathsize="90%">Q</mml:mi><mml:mn mathsize="90%">2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>. Each trial <inline-formula><mml:math id="inf708"><mml:mi mathsize="90%">s</mml:mi></mml:math></inline-formula> is thus specified by a stimulus and context index: <inline-formula><mml:math id="inf709"><mml:mrow><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mrow><mml:msub><mml:mi mathsize="90%">S</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathsize="90%">C</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msub></mml:mrow><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. In contrast to the simple task, sensory input vectors are not orthogonal among each other; using <xref ref-type="disp-formula" rid="equ127">Equation 110</xref>, we see that to the leading order in <inline-formula><mml:math id="inf710"><mml:mi mathsize="90%">N</mml:mi></mml:math></inline-formula>,<disp-formula id="equ128"><label>(111)</label><mml:math id="m128"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≃</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mtext> and </mml:mtext></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mtd><mml:mtd><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mtext> or </mml:mtext></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mrow><mml:mtext>otherwise</mml:mtext></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The task is defined as follows. When the context cue <inline-formula><mml:math id="inf711"><mml:mi mathsize="90%">C</mml:mi></mml:math></inline-formula> ranges between 1 and <inline-formula><mml:math id="inf712"><mml:mrow><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">/</mml:mo><mml:mn mathsize="90%">2</mml:mn></mml:mrow></mml:math></inline-formula>, context takes value 1. In context 1, the first half of the <inline-formula><mml:math id="inf713"><mml:mi mathsize="90%">Q</mml:mi></mml:math></inline-formula> stimuli is associated with category <inline-formula><mml:math id="inf714"><mml:mi mathsize="90%">A</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf715"><mml:mrow><mml:mover accent="true"><mml:mi mathsize="90%">z</mml:mi><mml:mo mathsize="90%" stretchy="false">~</mml:mo></mml:mover><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:msup><mml:mi mathsize="90%">z</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>), and the second half with <inline-formula><mml:math id="inf716"><mml:mi mathsize="90%">B</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf717"><mml:mrow><mml:mover accent="true"><mml:mi mathsize="90%">z</mml:mi><mml:mo mathsize="90%" stretchy="false">~</mml:mo></mml:mover><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:msup><mml:mi mathsize="90%">z</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>). When the context cue <inline-formula><mml:math id="inf718"><mml:mi mathsize="90%">C</mml:mi></mml:math></inline-formula> ranges between <inline-formula><mml:math id="inf719"><mml:mrow><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">/</mml:mo><mml:mn mathsize="90%">2</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf720"><mml:mi mathsize="90%">Q</mml:mi></mml:math></inline-formula>, context takes value 2. In context 2, stimuli-category associations are reversed: the first half of the <inline-formula><mml:math id="inf721"><mml:mi mathsize="90%">Q</mml:mi></mml:math></inline-formula> stimuli is associated with category <inline-formula><mml:math id="inf722"><mml:mi mathsize="90%">B</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf723"><mml:mrow><mml:mover accent="true"><mml:mi mathsize="90%">z</mml:mi><mml:mo mathsize="90%" stretchy="false">~</mml:mo></mml:mover><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:msup><mml:mi mathsize="90%">z</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>), and the second half with <inline-formula><mml:math id="inf724"><mml:mi mathsize="90%">A</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf725"><mml:mrow><mml:mover accent="true"><mml:mi mathsize="90%">z</mml:mi><mml:mo mathsize="90%" stretchy="false">~</mml:mo></mml:mover><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:msup><mml:mi mathsize="90%">z</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>).</p><p>Correlations in the sensory inputs (<xref ref-type="disp-formula" rid="equ128">Equation 111</xref>) are such that, for every value of <inline-formula><mml:math id="inf726"><mml:mi mathsize="90%">Q</mml:mi></mml:math></inline-formula>, inputs are not linearly separable (<xref ref-type="bibr" rid="bib5">Barak et al., 2013</xref>). For <inline-formula><mml:math id="inf727"><mml:mrow><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mn mathsize="90%">2</mml:mn></mml:mrow></mml:math></inline-formula>, the task is equivalent to a classical XOR computation. We focus however on <inline-formula><mml:math id="inf728"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, for which each context is signaled by more than one context cue. As in experimental work (<xref ref-type="bibr" rid="bib70">Wallis et al., 2001</xref>; <xref ref-type="bibr" rid="bib66">Stoet and Snyder, 2004</xref>; <xref ref-type="bibr" rid="bib9">Brincat et al., 2018</xref>), this allows to dissociate the activity dependence on the abstract variable context from the sensory variable context cue (see <xref ref-type="disp-formula" rid="equ140">Equation 122</xref> and <xref ref-type="disp-formula" rid="equ141">Equation 123</xref> in Section Context-dependent task: category and context selectivity).</p><p>We start by writing down explicit expressions for the activity (<xref ref-type="disp-formula" rid="equ39">Equation 29</xref>) in the current task (Section Context-dependent task: computing activity). We then derive the expressions that quantify how activity measures, such as selectivity and correlations, evolve over learning (Sections Context-dependent task: category and context selectivity, Context-dependent task: category and context correlation and Context-dependent task: computing normalized dot products). These expressions are rather complex, and require numerical evaluation. To gain further mathematical insight, in Sections Detailed analysis of context selectivity, Detailed analysis of category selectivity and Analysis of patterns of context and category selectivity we consider specific cases and quantities, and derive their behaviour analytically.</p></sec><sec id="s4-10-2"><title>Context-dependent task: computing activity</title><p>We start by computing the value of coordinates <inline-formula><mml:math id="inf729"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula>, which are solution to the linear system in <xref ref-type="disp-formula" rid="equ36">Equation 26</xref>. As in Section Simple task: computing activity (see also Section Characterizing variability), we neglect the variable term <inline-formula><mml:math id="inf730"><mml:msubsup><mml:mi mathsize="90%">h</mml:mi><mml:mn mathsize="90%">0</mml:mn><mml:mi mathsize="90%">s</mml:mi></mml:msubsup></mml:math></inline-formula> in the left-hand side of that equation and, after a small amount of algebra, we find that it can be rewritten as<disp-formula id="equ129"><label>(112)</label><mml:math id="m129"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>z</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msup><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where we used the short-hand notation <inline-formula><mml:math id="inf731"><mml:mrow><mml:mi mathsize="90%">N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mi mathsize="90%">s</mml:mi><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to indicate the set of trials that are <italic>neighbours</italic> to <inline-formula><mml:math id="inf732"><mml:mi mathsize="90%">s</mml:mi></mml:math></inline-formula> (i.e., trials that have either the same stimulus or the same context cue of <inline-formula><mml:math id="inf733"><mml:mi mathsize="90%">s</mml:mi></mml:math></inline-formula>). We have used the notation <inline-formula><mml:math id="inf734"><mml:mrow><mml:mo maxsize="90%" minsize="90%">⟨</mml:mo><mml:mrow><mml:mi mathsize="90%">F</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">F</mml:mi></mml:mrow><mml:mo maxsize="90%" minsize="90%">⟩</mml:mo></mml:mrow></mml:math></inline-formula> to indicate the average over the product of two nonlinear functions, <inline-formula><mml:math id="inf735"><mml:mi mathsize="90%">F</mml:mi></mml:math></inline-formula>, whose arguments are given by two zero-mean and unit-variance Gaussian variables with covariance <inline-formula><mml:math id="inf736"><mml:mrow><mml:mn mathsize="90%">1</mml:mn><mml:mo mathsize="90%" stretchy="false">/</mml:mo><mml:mn mathsize="90%">2</mml:mn></mml:mrow></mml:math></inline-formula>. That is,<disp-formula id="equ130"><label>(113)</label><mml:math id="m130"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi>F</mml:mi><mml:mi>F</mml:mi><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>≡</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>where both <inline-formula><mml:math id="inf737"><mml:mi mathsize="90%">a</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf738"><mml:mi mathsize="90%">b</mml:mi></mml:math></inline-formula> are zero-mean, unit-variance Gaussian random variables with covariance <inline-formula><mml:math id="inf739"><mml:mrow><mml:mn mathsize="90%">1</mml:mn><mml:mo mathsize="90%" stretchy="false">/</mml:mo><mml:mn mathsize="90%">2</mml:mn></mml:mrow></mml:math></inline-formula>. Detail on how these averages are computed numerically is given in Section Evaluation of averages (<xref ref-type="disp-formula" rid="equ214">Equation 186</xref>).</p><p>As in the simple task (<xref ref-type="disp-formula" rid="equ58">Equation 46</xref>), because the left-hand side can take on only two values, the coordinates <inline-formula><mml:math id="inf740"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula> can take on only two values,<disp-formula id="equ131"><label>(114)</label><mml:math id="m131"><mml:mrow><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mpadded lspace="10pt" width="+10pt"><mml:mi mathsize="90%">s</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mtext mathsize="90%"> in category </mml:mtext><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">A</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mpadded lspace="10pt" width="+10pt"><mml:mi mathsize="90%">s</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mtext mathsize="90%"> in category </mml:mtext><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi mathsize="90%">B</mml:mi></mml:mpadded></mml:mrow><mml:mo mathsize="90%" stretchy="false">.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mi/></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The values of <inline-formula><mml:math id="inf741"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf742"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:math></inline-formula> are determined by the same linear system as in <xref ref-type="disp-formula" rid="equ59">Equation 47</xref>, except now <inline-formula><mml:math id="inf743"><mml:mi mathsize="90%">α</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf744"><mml:mi mathsize="90%">β</mml:mi></mml:math></inline-formula> are given by<disp-formula id="equ132"><label>(115a)</label><mml:math id="m132"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ133"><label>(115b)</label><mml:math id="m133"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mi>Q</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mfrac><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mn>2</mml:mn></mml:mfrac><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>To derive the expression above, we used the fact that every sensory input has <inline-formula><mml:math id="inf745"><mml:mrow><mml:mrow><mml:mn mathsize="90%">2</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">Q</mml:mi></mml:mrow><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:mn mathsize="90%">2</mml:mn></mml:mrow></mml:math></inline-formula> neighbours, of which <inline-formula><mml:math id="inf746"><mml:mrow><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:mn mathsize="90%">2</mml:mn></mml:mrow></mml:math></inline-formula> are associated with the same category, and <inline-formula><mml:math id="inf747"><mml:mi mathsize="90%">Q</mml:mi></mml:math></inline-formula> with the opposite one. The final expression for <inline-formula><mml:math id="inf748"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf749"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:math></inline-formula> is thus given by <xref ref-type="disp-formula" rid="equ63">Equation 49a</xref>; that expression depends on <inline-formula><mml:math id="inf750"><mml:mi mathsize="90%">γ</mml:mi></mml:math></inline-formula>, which is given in <xref ref-type="disp-formula" rid="equ65">Equation 50</xref>.</p><p>By comparing <xref ref-type="disp-formula" rid="equ132">Equation 115</xref> with <xref ref-type="disp-formula" rid="equ61">Equation 48</xref> we see that, with respect to the simple task, the expressions for <inline-formula><mml:math id="inf751"><mml:mi mathsize="90%">α</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf752"><mml:mi mathsize="90%">β</mml:mi></mml:math></inline-formula> include extra terms (shown in square brackets in the right-hand side of <xref ref-type="disp-formula" rid="equ132">Equation 115</xref>). These arise because, unlike in the simple task, different inputs can be correlated (<xref ref-type="disp-formula" rid="equ128">Equation 111</xref>). The extra term in the expression for <inline-formula><mml:math id="inf753"><mml:mi mathsize="90%">β</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ133">Equation 115b</xref>) scales with <inline-formula><mml:math id="inf754"><mml:mi mathsize="90%">Q</mml:mi></mml:math></inline-formula>, while the extra term for <inline-formula><mml:math id="inf755"><mml:mi mathsize="90%">α</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ132">Equation 115a</xref>) does not; this indicates the typical value of <inline-formula><mml:math id="inf756"><mml:mi mathsize="90%">γ</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ65">Equation 50</xref>), which is proportional to <inline-formula><mml:math id="inf757"><mml:mrow><mml:mi mathsize="90%">β</mml:mi><mml:mo mathsize="90%" stretchy="false">/</mml:mo><mml:mi mathsize="90%">α</mml:mi></mml:mrow></mml:math></inline-formula>, is larger in this task than in the simple one. This in turn implies that the parameter region where one has approximately <inline-formula><mml:math id="inf758"><mml:mrow><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup><mml:mo mathsize="90%" stretchy="false">≃</mml:mo><mml:mrow><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> is larger in the current task than in the simple one; this approximation will later be used in Section Analysis of patterns of context and category selectivity. In the simple task, the parameter region where <inline-formula><mml:math id="inf759"><mml:mrow><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup><mml:mo mathsize="90%" stretchy="false">≃</mml:mo><mml:mrow><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> coincided with the region where category correlation were negative (<xref ref-type="disp-formula" rid="equ89">Equation 74</xref>, Section Simple task: category correlation). This suggests that the parameter region where correlations are negative, also, is larger in this task than in the simple one. As it will be shown in Section Context-dependent task: category and context correlation, however, the expressions for correlations are much more complex in the current task than <xref ref-type="disp-formula" rid="equ89">Equation 74</xref>; this hypothesis thus needs to be carefully verified – which is done, using numerical integration, in <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2C</xref>.</p><p>Since this task is an extension of the XOR task, sensory inputs are not linearly separable. This shows up as a singularity when the intermediate layer is linear (e.g., <inline-formula><mml:math id="inf760"><mml:mrow><mml:mrow><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mi mathsize="90%" mathvariant="bold-italic">x</mml:mi><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mi mathsize="90%" mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:math></inline-formula>). Indeed, in that case, the value of <inline-formula><mml:math id="inf761"><mml:mi mathsize="90%">γ</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ65">Equation 50</xref>) diverges, which in turn means both <inline-formula><mml:math id="inf762"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf763"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:math></inline-formula> diverge (<xref ref-type="disp-formula" rid="equ63">Equation 49</xref>). That’s because <inline-formula><mml:math id="inf764"><mml:mi mathsize="90%">γ</mml:mi></mml:math></inline-formula> is proportional to the ratio <inline-formula><mml:math id="inf765"><mml:mrow><mml:mi mathsize="90%">β</mml:mi><mml:mo mathsize="90%" stretchy="false">/</mml:mo><mml:mi mathsize="90%">α</mml:mi></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf766"><mml:mi mathsize="90%">α</mml:mi></mml:math></inline-formula> vanishes, while <inline-formula><mml:math id="inf767"><mml:mi mathsize="90%">β</mml:mi></mml:math></inline-formula> does not. To see that <inline-formula><mml:math id="inf768"><mml:mi mathsize="90%">α</mml:mi></mml:math></inline-formula> vanishes, we use <xref ref-type="disp-formula" rid="equ132">Equation 115a</xref> to write<disp-formula id="equ134"><label>(116)</label><mml:math id="m134"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mi>α</mml:mi></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>When the activation function <inline-formula><mml:math id="inf769"><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula> is nonlinear, instead, the values of <inline-formula><mml:math id="inf770"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf771"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:math></inline-formula> are finite; their magnitude depends on how close to linear <inline-formula><mml:math id="inf772"><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula> is in its effective activation range.</p><p>To conclude our characterization of activity, we evaluate spanning vectors, <inline-formula><mml:math id="inf773"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi mathsize="90%">q</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">s</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, by combining <xref ref-type="disp-formula" rid="equ38">Equation 28</xref> and <xref ref-type="disp-formula" rid="equ128">Equation 111</xref>. Unlike in the simple task, for each activity vector, <inline-formula><mml:math id="inf774"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">y</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula>, there exists more than one spanning vector; those are given by <inline-formula><mml:math id="inf775"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi mathsize="90%">s</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">s</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, and all vectors <inline-formula><mml:math id="inf776"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi mathsize="90%">q</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">s</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> for which <inline-formula><mml:math id="inf777"><mml:mrow><mml:mi mathsize="90%">q</mml:mi><mml:mo mathsize="90%" stretchy="false">∈</mml:mo><mml:mrow><mml:mi mathsize="90%">N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mi mathsize="90%">s</mml:mi><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. <xref ref-type="disp-formula" rid="equ39">Equation 29</xref> thus reads<disp-formula id="equ135"><label>(117)</label><mml:math id="m135"><mml:mrow><mml:mtable columnalign="right left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⊙</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>⊙</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⊙</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>⊙</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where the second line follows from <xref ref-type="disp-formula" rid="equ38">Equation 28</xref> and the coordinates <inline-formula><mml:math id="inf778"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">q</mml:mi></mml:msup></mml:math></inline-formula> take values <inline-formula><mml:math id="inf779"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup></mml:math></inline-formula> or <inline-formula><mml:math id="inf780"><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:math></inline-formula> depending on the category <inline-formula><mml:math id="inf781"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">x</mml:mi><mml:mi mathsize="90%">q</mml:mi></mml:msup></mml:math></inline-formula> is associated with (<xref ref-type="disp-formula" rid="equ131">Equation 114</xref>). Using the notation <inline-formula><mml:math id="inf782"><mml:mrow><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mrow><mml:msub><mml:mi mathsize="90%">S</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathsize="90%">C</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msub></mml:mrow><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <xref ref-type="disp-formula" rid="equ135">Equation 117</xref> can also be written in the compact form<disp-formula id="equ136"> <label>(118)</label><mml:math id="m136"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⊙</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>⊙</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⊙</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:mo>⊙</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula></p><p>where we used the short-hand notation <inline-formula><mml:math id="inf783"><mml:mrow><mml:mmultiscripts><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi><mml:none/><mml:mo mathsize="90%" stretchy="false">′</mml:mo><mml:none/><mml:mrow><mml:mi mathsize="90%">S</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">C</mml:mi></mml:mrow></mml:mmultiscripts><mml:mo mathsize="90%" stretchy="false">≡</mml:mo><mml:mrow><mml:msup><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi><mml:mo mathsize="90%" stretchy="false">′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:msubsup><mml:mi mathsize="90%" mathvariant="bold-italic">k</mml:mi><mml:mn mathsize="90%">0</mml:mn><mml:mrow><mml:mi mathsize="90%">S</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">C</mml:mi></mml:mrow></mml:msubsup><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>To isolate the effect of the nonlinearity <inline-formula><mml:math id="inf784"><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula>, it will be instructive (see Sections Detailed analysis of context selectivity and Detailed analysis of category selectivity) to also compute the synaptic drive, <inline-formula><mml:math id="inf785"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">k</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula>, after learning. Using <xref ref-type="disp-formula" rid="equ7">Equation 5b</xref> and <xref ref-type="disp-formula" rid="equ27">Equation 18a</xref>, it is easy to see that<disp-formula id="equ137"><label>(119)</label><mml:math id="m137"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>≡</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⊙</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⊙</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>or, equivalently,<disp-formula id="equ138"><label>(120)</label><mml:math id="m138"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⊙</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⊙</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We conclude with a remark on the geometry of the spanning vectors, <inline-formula><mml:math id="inf786"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi mathsize="90%">q</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">s</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>. As in the simple task, those include a component that is aligned with the initial readout vector, <inline-formula><mml:math id="inf787"><mml:msub><mml:mi mathsize="90%" mathvariant="bold-italic">w</mml:mi><mml:mn mathsize="90%">0</mml:mn></mml:msub></mml:math></inline-formula>, and a residual component that is perpendicular to it, <inline-formula><mml:math id="inf788"><mml:mrow><mml:mi mathsize="90%">δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi mathsize="90%">q</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ41">Equation 31</xref>). In the simple task, residual components could be neglected (<xref ref-type="disp-formula" rid="equ70">Equation 55</xref>) because they were orthogonal to each other, and did not contribute to novel activity structure. In this task, residual components are not, in general, orthogonal to each other, and thus cannot be neglected. In fact, we have<disp-formula id="equ139"><label>(121)</label><mml:math id="m139"><mml:mrow><mml:mi>δ</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The term in the right-hand side can be non-zero even when <inline-formula><mml:math id="inf789"><mml:mrow><mml:mi mathsize="90%">s</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">q</mml:mi></mml:mrow></mml:math></inline-formula> are different from <inline-formula><mml:math id="inf790"><mml:mrow><mml:msup><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathsize="90%">q</mml:mi><mml:mo mathsize="90%" stretchy="false">′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>; this is due to <xref ref-type="disp-formula" rid="equ55">Equation 43b</xref> and <xref ref-type="disp-formula" rid="equ128">Equation 111</xref>, which imply that <inline-formula><mml:math id="inf791"><mml:msub><mml:mi mathsize="90%">k</mml:mi><mml:mrow><mml:mn mathsize="90%">0</mml:mn><mml:mo mathsize="90%" stretchy="false">,</mml:mo><mml:mi mathsize="90%">i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> variables can be correlated among each other. The fact that residuals <inline-formula><mml:math id="inf792"><mml:mrow><mml:mi mathsize="90%">δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi mathsize="90%">q</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> cannot be neglected implies that activity evolution is not effectively one-dimensional, as it was the simple task, but higher-dimensional (this is evident in the PC plots in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1C, D</xref>). All the directions along which activity evolve are, however, correlated with the initial readout vector <inline-formula><mml:math id="inf793"><mml:msub><mml:mi mathsize="90%" mathvariant="bold-italic">w</mml:mi><mml:mn mathsize="90%">0</mml:mn></mml:msub></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ40">Equation 30</xref>).</p></sec><sec id="s4-10-3"><title>Context-dependent task: category and context selectivity</title><p>In the present task, we can compute category, as well as context selectivity. In analogy with category selectivity, <xref ref-type="disp-formula" rid="equ71">Equation 56</xref>, context selectivity is defined as<disp-formula id="equ140"><label>(122)</label><mml:math id="m140"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>ctx</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff ctx</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same ctx, diff ctx cue</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff ctx</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same ctx, diff ctx cue</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Note that, in the average over pairs of trials from the same context, we excluded pairs of trials with the same context cue. This was done to exclude the possibility that context selectivity increases simply because activity in response to the same context cue become more similar over learning. For completeness, we also compute<disp-formula id="equ141"><label>(123)</label><mml:math id="m141"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>ctx,2</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff ctx</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same ctx</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff ctx</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same ctx</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>which we plot in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1A, B</xref>. Those plots show that the behaviour under this definition is similar to that of <xref ref-type="disp-formula" rid="equ140">Equation 122</xref>.</p><p>We are interested in deriving theoretical expressions for average category and context selectivity, obtained by averaging <xref ref-type="disp-formula" rid="equ71">Equation 56</xref> and <xref ref-type="disp-formula" rid="equ140">Equation 122</xref> (or <xref ref-type="disp-formula" rid="equ141">Equation 123</xref>) over <inline-formula><mml:math id="inf794"><mml:mi mathsize="90%">i</mml:mi></mml:math></inline-formula>. For the present task, that is hard. Consequently, we use results from the simple task (Section Simple task: category selectivity) which indicated that, in the limit <inline-formula><mml:math id="inf795"><mml:mrow><mml:mi mathsize="90%">N</mml:mi><mml:mo mathsize="90%" stretchy="false">≫</mml:mo><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">≫</mml:mo><mml:mn mathsize="90%">1</mml:mn></mml:mrow></mml:math></inline-formula>, average category selectivity can be approximated with the category clustering measure, <xref ref-type="disp-formula" rid="equ82">Equation 67</xref>; the latter is equivalent to separately averaging the numerator and denominator of selectivity over neurons.</p><p>For category, clustering is the same as in the simple task, <xref ref-type="disp-formula" rid="equ82">Equation 67</xref> and <xref ref-type="disp-formula" rid="equ83">Equation 68</xref>, which we repeat here for convenience,<disp-formula id="equ142"><label>(124)</label><mml:math id="m142"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>cat</mml:mtext></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff cat</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same cat</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff cat</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same cat</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff cat</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same cat</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff cat</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same cat</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where we used the statistical homogeneity of activity vectors. Similarly, for context selectivity, we may write<disp-formula id="equ143"><label>(125)</label><mml:math id="m143"><mml:mrow><mml:mtable columnalign="right left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>ctx</mml:mtext></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff ctx</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same ctx, diff ctx cue</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff ctx</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same ctx, diff ctx cue</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff ctx</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same ctx, diff ctx cue</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff ctx</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same ctx, diff ctx cue</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>and<disp-formula id="equ144"><label>(126)</label><mml:math id="m144"><mml:mrow><mml:mtable columnalign="right left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>ctx,2</mml:mtext></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff ctx</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same ctx</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff ctx</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same ctx</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff ctx</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same ctx</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff ctx</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same ctx</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>To evaluate those expressions, we need the normalized dot products over activity, <inline-formula><mml:math id="inf796"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. These are computed in Section Context-dependent task: computing normalized dot products. Finally, averages over trials are performed numerically. The resulting theoretical estimates for <inline-formula><mml:math id="inf797"><mml:msup><mml:mover accent="true"><mml:mi mathsize="90%">S</mml:mi><mml:mo mathsize="90%" stretchy="false">~</mml:mo></mml:mover><mml:mtext mathsize="90%">cat</mml:mtext></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf798"><mml:msup><mml:mover accent="true"><mml:mi mathsize="90%">S</mml:mi><mml:mo mathsize="90%" stretchy="false">~</mml:mo></mml:mover><mml:mtext mathsize="90%">ctx</mml:mtext></mml:msup></mml:math></inline-formula> are shown in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1B</xref> and <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>.</p><p>In <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1A–C</xref>, we compare theoretical estimates with simulations. Agreement is relatively good, although it is worse than for the simple task; as argued in Section Evolution of activity in finite-size networks, that is expected. Note that the values of average selectivity and clustering are not close (this is only verified in the <inline-formula><mml:math id="inf799"><mml:mrow><mml:mi mathsize="90%">N</mml:mi><mml:mo mathsize="90%" stretchy="false">≫</mml:mo><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">≫</mml:mo><mml:mn mathsize="90%">1</mml:mn></mml:mrow></mml:math></inline-formula> limit, and would require values of <inline-formula><mml:math id="inf800"><mml:mi mathsize="90%">N</mml:mi></mml:math></inline-formula> larger than those used in simulations); the qualitative behaviour of the two quantities is, however, identical. In <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1B</xref>, we plot the theoretical estimates across a broad range of task and circuit parameters. These theoretical estimates indicate that, in all cases, category (<xref ref-type="disp-formula" rid="equ142">Equation 124</xref>) and context (<xref ref-type="disp-formula" rid="equ143">Equation 125</xref>, <xref ref-type="disp-formula" rid="equ144">Equation 126</xref>) selectivity increase. This is in agreement with simulations, which are reported in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1A</xref>.</p></sec><sec id="s4-10-4"><title>Context-dependent task: category and context correlation</title><p>To quantify how the population as a whole encodes category and context, we evaluate category and context correlations. Those quantities, denoted <inline-formula><mml:math id="inf801"><mml:msup><mml:mi mathsize="90%">C</mml:mi><mml:mtext mathsize="90%">cat</mml:mtext></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf802"><mml:msup><mml:mi mathsize="90%">C</mml:mi><mml:mtext mathsize="90%">ctx</mml:mtext></mml:msup></mml:math></inline-formula>, are given by the average Pearson correlation coefficient for trials in different categories and contexts. <inline-formula><mml:math id="inf803"><mml:msup><mml:mi mathsize="90%">C</mml:mi><mml:mtext mathsize="90%">cat</mml:mtext></mml:msup></mml:math></inline-formula> is defined as in <xref ref-type="disp-formula" rid="equ86">Equation 71</xref>. Similarly, <inline-formula><mml:math id="inf804"><mml:msup><mml:mi mathsize="90%">C</mml:mi><mml:mtext mathsize="90%">ctx</mml:mtext></mml:msup></mml:math></inline-formula> is defined as<disp-formula id="equ145"><label>(127)</label><mml:math id="m145"><mml:mrow><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mtext>ctx</mml:mtext></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">2</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">2</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf805"><mml:msub><mml:mi mathsize="90%">s</mml:mi><mml:mn mathsize="90%">1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf806"><mml:msub><mml:mi mathsize="90%">s</mml:mi><mml:mn mathsize="90%">2</mml:mn></mml:msub></mml:math></inline-formula> are indices that denote, respectively, trials from contexts 1 and 2. Similar to <xref ref-type="disp-formula" rid="equ87">Equation 72</xref>, the Pearson correlation coefficient <inline-formula><mml:math id="inf807"><mml:msup><mml:mi mathsize="90%">C</mml:mi><mml:mrow><mml:msub><mml:mi mathsize="90%">s</mml:mi><mml:mn mathsize="90%">1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathsize="90%">s</mml:mi><mml:mn mathsize="90%">2</mml:mn></mml:msub></mml:mrow></mml:msup></mml:math></inline-formula> is given by<disp-formula id="equ146"><label>(128)</label><mml:math id="m146"><mml:mrow><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">2</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">2</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msqrt><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msqrt><mml:msqrt><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">2</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">2</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>To evaluate these expressions, we use the normalized dot products <inline-formula><mml:math id="inf808"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> that are computed in Section Context-dependent task: computing normalized dot products. Averaging over trials is, finally, done numerically.</p><p>For completeness, we also consider the alternative definition of correlations, where activity is averaged over trials first, and then the Pearson correlation is computed. The alternative definition for category correlation is identical to <xref ref-type="disp-formula" rid="equ95">Equation 79</xref>. The alternative definition for context correlation is given by<disp-formula id="equ147"><label>(129)</label><mml:math id="m147"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mtext>ctx</mml:mtext></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">2</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">2</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt><mml:msqrt><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">2</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">2</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">2</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">2</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msqrt><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:msqrt><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">2</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">2</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where we have defined<disp-formula id="equ148"><label>(130)</label><mml:math id="m148"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">2</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">2</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">2</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>For the current task, there exists no simple mathematical relationship between correlations obtained from the standard, and the alternative definition. We thus checked numerically the behaviour of both quantities; results are reported in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1B</xref>. As in the simple task, we found that the qualitative behaviour of both quantities is not fixed, but depends on task and circuit parameters. This is in agreement with simulations, which are illustrated in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1A</xref>.</p></sec><sec id="s4-10-5"><title>Context-dependent task: computing normalized dot products</title><p>To conclude, we illustrate how normalized dot products, <xref ref-type="disp-formula" rid="equ100">Equation 84</xref>, are computed for the current task. We start from <xref ref-type="disp-formula" rid="equ107">Equation 91</xref>, which we repeat here for completeness,<disp-formula id="equ149"><label>(131)</label><mml:math id="m149"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The first term of the right-hand side reads<disp-formula id="equ150"><label>(132)</label><mml:math id="m150"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:mtd><mml:mtd><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mtext> and </mml:mtext></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:mtd><mml:mtd><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mtext> or </mml:mtext></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mrow><mml:mtext>otherwise</mml:mtext></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where we used <xref ref-type="disp-formula" rid="equ6">Equation 5</xref> together with <xref ref-type="disp-formula" rid="equ55">Equation 43b</xref> and <xref ref-type="disp-formula" rid="equ128">Equation 111</xref>. Using <xref ref-type="disp-formula" rid="equ39">Equation 29</xref> together with <xref ref-type="disp-formula" rid="equ38">Equation 28</xref>, the second term of the right-hand side of <xref ref-type="disp-formula" rid="equ149">Equation 131</xref> reads<disp-formula id="equ151"><label>(133)</label><mml:math id="m151"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>where sensory input correlations, <inline-formula><mml:math id="inf809"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, are given in <xref ref-type="disp-formula" rid="equ128">Equation 111</xref>.</p><p>Because <inline-formula><mml:math id="inf810"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> can be non-zero even when <inline-formula><mml:math id="inf811"><mml:mrow><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">≠</mml:mo><mml:mi mathsize="90%">q</mml:mi></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ128">Equation 111</xref>), the number of non-zero terms in the sum in <xref ref-type="disp-formula" rid="equ151">Equation 133</xref> is, in general, large. Each term contains an average, <inline-formula><mml:math id="inf812"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, that includes four nonlinear functions. The value of those averages is specified by the correlations among the arguments, <inline-formula><mml:math id="inf813"><mml:msub><mml:mi mathsize="90%">k</mml:mi><mml:mrow><mml:mn mathsize="90%">0</mml:mn><mml:mo mathsize="90%" stretchy="false">,</mml:mo><mml:mi mathsize="90%">i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, which in turn depend on the values of <inline-formula><mml:math id="inf814"><mml:mi mathsize="90%">s</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf815"><mml:mi mathsize="90%">q</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf816"><mml:msup><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">′</mml:mo></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf817"><mml:msup><mml:mi mathsize="90%">q</mml:mi><mml:mo mathsize="90%" stretchy="false">′</mml:mo></mml:msup></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ128">Equation 111</xref>, via <xref ref-type="disp-formula" rid="equ55">Equation 43b</xref>). Averages are evaluated numerically; detail on how this is done is given in Section Evaluation of averages.</p><p>This procedure yields a set of normalized dot products that can be used to evaluate, numerically, the expressions for activity selectivity and correlation derived in Sections Context-dependent task: category and context selectivity and Context-dependent task: category and context correlation. As we rely on numerics, the results we obtain in this way are hard to interpret. For this reason, in the next sections we focus on specific cases were results can be obtained analytically; this allows us to extract a more intuitive understanding of how activity measures evolve over learning.</p></sec><sec id="s4-10-6"><title>Detailed analysis of context selectivity</title><p>We start clarifying how context selectivity increases over learning. Results from simulations, and numerical integration of <xref ref-type="disp-formula" rid="equ143">Equation 125</xref>, indicate that context selectivity increases for the synaptic drive, <inline-formula><mml:math id="inf818"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">k</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula>; this increase is then reflected in the activity, <inline-formula><mml:math id="inf819"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">y</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula> (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1A, B</xref> and <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1B</xref>). In this section, we analyze the behaviour of context selectivity for the synaptic drive. Focussing on the synaptic drive, instead of activity, allows us to derive results analytically. In the following, we start from <xref ref-type="disp-formula" rid="equ143">Equation 125</xref> and show that, for the synaptic drive <inline-formula><mml:math id="inf820"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">k</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula>, the value of <inline-formula><mml:math id="inf821"><mml:msup><mml:mover accent="true"><mml:mi mathsize="90%">S</mml:mi><mml:mo mathsize="90%" stretchy="false">~</mml:mo></mml:mover><mml:mtext mathsize="90%">ctx</mml:mtext></mml:msup></mml:math></inline-formula> increases over learning. At the end of this section, we comment on the insights provided by such derivation.</p><p>We start by simplifying the sums over trials contained in <xref ref-type="disp-formula" rid="equ143">Equation 125</xref>, which involve pairs of trials <inline-formula><mml:math id="inf822"><mml:mrow><mml:mi mathsize="90%">s</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> from the same, or different context. To this end we observe that, because of task symmetries, these sums involve a large number of identical terms; for example, the term with <inline-formula><mml:math id="inf823"><mml:mrow><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mn mathsize="90%">11</mml:mn><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf824"><mml:mrow><mml:msup><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">′</mml:mo></mml:msup><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mn mathsize="90%">12</mml:mn><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is identical to <inline-formula><mml:math id="inf825"><mml:mrow><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mn mathsize="90%">21</mml:mn><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf826"><mml:mrow><mml:msup><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">′</mml:mo></mml:msup><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mn mathsize="90%">22</mml:mn><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (both pairs of trials are neighbours, and are associated with the same category). We thus perform averages over a reduced, and less redundant subset of pairs of trials. First, we consider only two values of <inline-formula><mml:math id="inf827"><mml:mi mathsize="90%">s</mml:mi></mml:math></inline-formula>: for concreteness, we take <inline-formula><mml:math id="inf828"><mml:mrow><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mn mathsize="90%">11</mml:mn><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf829"><mml:mrow><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mrow><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">^</mml:mo></mml:mover><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:mn mathsize="90%">1</mml:mn></mml:mrow><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mn mathsize="90%">1</mml:mn></mml:mrow><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where we defined<disp-formula id="equ152"><label>(134)</label><mml:math id="m152"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">^</mml:mo></mml:mover><mml:mo mathsize="90%" stretchy="false">≡</mml:mo><mml:mfrac><mml:mi mathsize="90%">Q</mml:mi><mml:mn mathsize="90%">2</mml:mn></mml:mfrac></mml:mrow><mml:mo mathsize="90%" stretchy="false">.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>These <inline-formula><mml:math id="inf830"><mml:mi mathsize="90%">s</mml:mi></mml:math></inline-formula> trials are associated, respectively, with categories <inline-formula><mml:math id="inf831"><mml:mi mathsize="90%">A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf832"><mml:mi mathsize="90%">B</mml:mi></mml:math></inline-formula>. Second, for each value of <inline-formula><mml:math id="inf833"><mml:mi mathsize="90%">s</mml:mi></mml:math></inline-formula>, we consider <inline-formula><mml:math id="inf834"><mml:msup><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">′</mml:mo></mml:msup></mml:math></inline-formula> trials with context cue equal to <inline-formula><mml:math id="inf835"><mml:mrow><mml:mi mathsize="90%">C</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mn mathsize="90%">2</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf836"><mml:mrow><mml:mi mathsize="90%">C</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">^</mml:mo></mml:mover><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:mn mathsize="90%">1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>; these are associated, respectively, with context 1 and 2 (note that <inline-formula><mml:math id="inf837"><mml:mrow><mml:mi mathsize="90%">C</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mn mathsize="90%">1</mml:mn></mml:mrow></mml:math></inline-formula> must be avoided, as trials with the same context cue must be excluded, see <xref ref-type="disp-formula" rid="equ143">Equation 125</xref>). This allows us to rewrite the averages contained in <xref ref-type="disp-formula" rid="equ143">Equation 125</xref> as<disp-formula id="equ153"><label>(135a)</label><mml:math id="m153"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same ctx, diff ctx cue</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>Q</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ154"><label>(135b)</label><mml:math id="m154"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff ctx</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>Q</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The sums over <inline-formula><mml:math id="inf838"><mml:mover accent="true"><mml:mi mathsize="90%">S</mml:mi><mml:mo mathsize="90%" stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> can further be simplified. By using again symmetries, we have:<disp-formula id="equ155"><label>(136)</label><mml:math id="m155"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>We can do the same for the other sums, yielding:<disp-formula id="equ156"><label>(137a)</label><mml:math id="m156"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula><disp-formula id="equ157"><label>(137b)</label><mml:math id="m157"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula><disp-formula id="equ158"><label>(137c)</label><mml:math id="m158"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>It is easy to verify that, before learning starts, the right-hand sides of <xref ref-type="disp-formula" rid="equ153">Equation 135a</xref> and <xref ref-type="disp-formula" rid="equ154">Equation 135b</xref> are identical. This implies that the initial value of context selectivity, <xref ref-type="disp-formula" rid="equ143">Equation 125</xref>, vanishes (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1B</xref>). To show that context selectivity increases over learning, we thus need to show that the numerator of <xref ref-type="disp-formula" rid="equ143">Equation 125</xref> becomes positive over learning. This is equivalent to show that <xref ref-type="disp-formula" rid="equ153">Equation 135a</xref> is smaller than <xref ref-type="disp-formula" rid="equ154">Equation 135b</xref>. Using <xref ref-type="disp-formula" rid="equ155">Equation 136</xref> and <xref ref-type="disp-formula" rid="equ156">Equation 137</xref>, this condition can be rewritten as<disp-formula id="equ159"><label>(138)</label><mml:math id="m159"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>We now use <xref ref-type="disp-formula" rid="equ137">Equation 119</xref> to write<disp-formula id="equ160"><label>(139)</label><mml:math id="m160"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>where the terms containing the cross-products between <inline-formula><mml:math id="inf839"><mml:msubsup><mml:mi mathsize="90%">k</mml:mi><mml:mi mathsize="90%">i</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf840"><mml:mrow><mml:mi mathsize="90%" mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathsize="90%">k</mml:mi><mml:mi mathsize="90%">i</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> vanish on average because of <xref ref-type="disp-formula" rid="equ11">Equation 8a</xref>. By using the statistical homogeneity of activity across contexts, we can rewrite <xref ref-type="disp-formula" rid="equ159">Equation 138</xref> as<disp-formula id="equ161"> <label>(140)</label><mml:math id="m161"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>or, re-arranging terms,<disp-formula id="equ162"><label>(141)</label><mml:math id="m162"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow><mml:mo>−</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0.</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>To show that context selectivity increases over learning, we need to verify that the equation above holds. To this end, we evaluate analytically the normalized dot products <inline-formula><mml:math id="inf841"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> for each pair of trials involved. This is done in the next paragraph; here we simply use those results (<xref ref-type="disp-formula" rid="equ177">Equation 156</xref>, <xref ref-type="disp-formula" rid="equ178">Equation 157</xref>, <xref ref-type="disp-formula" rid="equ179">Equation 158</xref>, and <xref ref-type="disp-formula" rid="equ183">Equation 159</xref>).</p><p>We start evaluating the difference within the first set of curly parenthesis of <xref ref-type="disp-formula" rid="equ162">Equation 141</xref>, which correspond to the dominant contribution in <inline-formula><mml:math id="inf842"><mml:mi mathsize="90%">Q</mml:mi></mml:math></inline-formula>. By using <xref ref-type="disp-formula" rid="equ183">Equation 159</xref>, we see that this can be rewritten as<disp-formula id="equ163"><label>(142)</label><mml:math id="m163"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Using <xref ref-type="disp-formula" rid="equ179">Equation 158</xref>, this becomes<disp-formula id="equ164"><label>(143)</label><mml:math id="m164"><mml:mrow><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We then evaluate the difference within the second set of curly parenthesis. Using <xref ref-type="disp-formula" rid="equ177">Equation 156</xref>, <xref ref-type="disp-formula" rid="equ178">Equation 157</xref>, <xref ref-type="disp-formula" rid="equ179">Equation 158</xref> and <xref ref-type="disp-formula" rid="equ183">Equation 159</xref>, it is straightforward to see that that difference vanishes. Putting results together, our condition to verify (<xref ref-type="disp-formula" rid="equ162">Equation 141</xref>) becomes simply:<disp-formula id="equ165"><label>(144)</label><mml:math id="m165"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>which is satisfied whenever <inline-formula><mml:math id="inf843"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. This is always verified, as from <xref ref-type="disp-formula" rid="equ171">Equation 150</xref> and <xref ref-type="disp-formula" rid="equ172">Equation 151</xref> we have<disp-formula id="equ166"> <label>(145)</label><mml:math id="m166"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>+</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mn>2</mml:mn><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula></p><p>while<disp-formula id="equ167"> <label>(146)</label><mml:math id="m167"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>+</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mn>2</mml:mn><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula></p><p>so that<disp-formula id="equ168"><label>(147)</label><mml:math id="m168"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></disp-formula></p><p>which concludes our derivation. We remark that <xref ref-type="disp-formula" rid="equ168">Equation 147</xref> vanishes when <inline-formula><mml:math id="inf844"><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula> is linear. This indicates that, even if context selectivity also increases for synaptic drives (which are a linear transformation of the sensory inputs), this phenomenon is due to the nonlinearity of activation functions.</p><sec id="s4-10-6-1"><title>Computing normalized dot products</title><p>We now compute the normalized dot product expressions, <inline-formula><mml:math id="inf845"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, for each pair of trials involved in <xref ref-type="disp-formula" rid="equ162">Equation 141</xref>. We illustrate in detail how one example dot product, <inline-formula><mml:math id="inf846"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, is computed. Other expressions are computed in a similar way; results are given below (<xref ref-type="disp-formula" rid="equ178">Equation 157</xref>, <xref ref-type="disp-formula" rid="equ179">Equation 158</xref> and <xref ref-type="disp-formula" rid="equ183">Equation 159</xref>).</p><p>We start from:<disp-formula id="equ169"><label>(148)</label><mml:math id="m169"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/><mml:mrow><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>which was derived from <xref ref-type="disp-formula" rid="equ138">Equation 120</xref> together with <xref ref-type="disp-formula" rid="equ11">Equation 8a</xref>. We then rewrite the sums in the right-hand side by expanding each index in two set of indices: one running from 1 to <inline-formula><mml:math id="inf847"><mml:mrow><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">/</mml:mo><mml:mn mathsize="90%">2</mml:mn></mml:mrow></mml:math></inline-formula> (denoted by the subscript +), and one running from <inline-formula><mml:math id="inf848"><mml:mrow><mml:mrow><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">/</mml:mo><mml:mn mathsize="90%">2</mml:mn></mml:mrow><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:mn mathsize="90%">1</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf849"><mml:mi mathsize="90%">Q</mml:mi></mml:math></inline-formula> (denoted by the subscript −). The first sum in <xref ref-type="disp-formula" rid="equ169">Equation 148</xref> becomes:<disp-formula id="equ170"><label>(149)</label><mml:math id="m170"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mn>2</mml:mn></mml:mrow><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mn>2</mml:mn></mml:mrow><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mn>2</mml:mn></mml:mrow><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mn>2</mml:mn></mml:mrow><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where we have used the short-hand notation <inline-formula><mml:math id="inf850"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>≡</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. We now observe that<disp-formula id="equ171"><label>(150)</label><mml:math id="m171"><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mn>2</mml:mn></mml:mrow><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mn>2</mml:mn></mml:mrow><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>≡</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>while<disp-formula id="equ172"><label>(151)</label><mml:math id="m172"><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mn>2</mml:mn></mml:mrow><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mn>2</mml:mn></mml:mrow><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>≡</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>so that<disp-formula id="equ173"><label>(152)</label><mml:math id="m173"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>The second sum in <xref ref-type="disp-formula" rid="equ169">Equation 148</xref> gives:<disp-formula id="equ174"><label>(153)</label><mml:math id="m174"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="mediummathspace"/><mml:mspace width="mediummathspace"/><mml:mspace width="mediummathspace"/><mml:mspace width="mediummathspace"/><mml:mspace width="mediummathspace"/><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>≡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>by appropriately defining <inline-formula><mml:math id="inf851"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf852"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. The third sum gives:<disp-formula id="equ175"><label>(154)</label><mml:math id="m175"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="mediummathspace"/><mml:mspace width="mediummathspace"/><mml:mspace width="mediummathspace"/><mml:mspace width="mediummathspace"/><mml:mspace width="mediummathspace"/><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>≡</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>and, similarly, the fourth one:<disp-formula id="equ176"><label>(155)</label><mml:math id="m176"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>By putting those results together, we conclude that<disp-formula id="equ177"><label>(156)</label><mml:math id="m177"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We can use the same procedure to evaluate dot products for all the remaining pairs of trials. This gives:<disp-formula id="equ178"><label>(157)</label><mml:math id="m178"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mn>5</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mn>6</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mn>7</mml:mn></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mn>5</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mn>6</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mn>7</mml:mn></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mn>5</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mn>6</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mn>7</mml:mn></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>while<disp-formula id="equ179"><label>(158a)</label><mml:math id="m179"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula><disp-formula id="equ180"><label>(158b)</label><mml:math id="m180"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula><disp-formula id="equ181"><label>(158c)</label><mml:math id="m181"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ182"><label>(158d)</label><mml:math id="m182"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>and<disp-formula id="equ183"><label>(159)</label><mml:math id="m183"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>All the <inline-formula><mml:math id="inf853"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> coefficients can easily be evaluated analytically. However, we have shown in the previous paragraph that the only coefficients that do not cancel in <xref ref-type="disp-formula" rid="equ162">Equation 141</xref> are <inline-formula><mml:math id="inf854"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf855"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>; these two are evaluated analytically in <xref ref-type="disp-formula" rid="equ166">Equation 145</xref> and <xref ref-type="disp-formula" rid="equ167">Equation 146</xref>.</p></sec><sec id="s4-10-6-2"><title>Extracting intuition</title><p>Can we derive a more intuitive picture of why and how context selectivity increases over learning? We have seen in the previous paragraphs that context selectivity increases because the difference within the first set of curly parenthesis of <xref ref-type="disp-formula" rid="equ162">Equation 141</xref> is positive (while the difference within the second set of curly parenthesis vanishes). To simplify the math, we assume that <inline-formula><mml:math id="inf856"><mml:mrow><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>; this condition thus reads:<disp-formula id="equ184"><label>(160)</label><mml:math id="m184"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0.</mml:mn></mml:mrow></mml:math></disp-formula></p><p>(With respect to <xref ref-type="disp-formula" rid="equ163">Equation 142</xref>, we could get rid of pairs of trials with <inline-formula><mml:math id="inf857"><mml:mrow><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mrow><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">^</mml:mo></mml:mover><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:mn mathsize="90%">1</mml:mn></mml:mrow><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mn mathsize="90%">1</mml:mn></mml:mrow><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> because, when <inline-formula><mml:math id="inf858"><mml:mrow><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, they give identical results to <inline-formula><mml:math id="inf859"><mml:mrow><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mn mathsize="90%">11</mml:mn><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.)</p><p><xref ref-type="disp-formula" rid="equ184">Equation 160</xref> indicates that, over learning, activity from trial <inline-formula><mml:math id="inf860"><mml:mrow><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mn mathsize="90%">11</mml:mn><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> becomes closer (i.e., more correlated) to activity from trials with the same category and context, such as <inline-formula><mml:math id="inf861"><mml:mrow><mml:msup><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">′</mml:mo></mml:msup><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mn mathsize="90%">22</mml:mn><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, than trials with the same category but different context, such as <inline-formula><mml:math id="inf862"><mml:mrow><mml:msup><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">′</mml:mo></mml:msup><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mrow><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">^</mml:mo></mml:mover><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:mn mathsize="90%">1</mml:mn></mml:mrow><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">^</mml:mo></mml:mover><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:mn mathsize="90%">1</mml:mn></mml:mrow><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. On the contrary, activity from trial <inline-formula><mml:math id="inf863"><mml:mrow><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mn mathsize="90%">11</mml:mn><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> becomes equally close to activity from trials with different category and same context, such as <inline-formula><mml:math id="inf864"><mml:mrow><mml:msup><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">′</mml:mo></mml:msup><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mrow><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">^</mml:mo></mml:mover><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:mn mathsize="90%">1</mml:mn></mml:mrow><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mn mathsize="90%">2</mml:mn></mml:mrow><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and trials with different category and different context, such as <inline-formula><mml:math id="inf865"><mml:mrow><mml:msup><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">′</mml:mo></mml:msup><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mrow><mml:mn mathsize="90%">2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="90%" minsize="90%">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">^</mml:mo></mml:mover><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:mn mathsize="90%">1</mml:mn></mml:mrow><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow><mml:mo maxsize="90%" minsize="90%">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. This can be seen from <xref ref-type="disp-formula" rid="equ183">Equation 159</xref>, from which<disp-formula id="equ185"> <label>(161)</label><mml:math id="m185"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></disp-formula></p><p>follows.</p><p>The geometrical relationships implied by both <xref ref-type="disp-formula" rid="equ184">Equation 160</xref> and <xref ref-type="disp-formula" rid="equ185">Equation 161</xref> can be easily verified in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1C</xref>, which shows the synaptic drive from simulated circuits; the middle panel shows a circuit for which we have exactly <inline-formula><mml:math id="inf866"><mml:mrow><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. Taken together, <xref ref-type="disp-formula" rid="equ184">Equation 160</xref> and <xref ref-type="disp-formula" rid="equ185">Equation 161</xref> indicate that the increase in context selectivity comes from activity clustering by context over learning; such clustering is, however, category dependent. This leads to the emergence of four statistically distinguishable clouds, one for each combination of category and context. This is visible in simulated activity from <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1C</xref>, and is illustrated in <xref ref-type="fig" rid="fig7">Figure 7A–C</xref>.</p></sec></sec></sec><sec id="s4-11"><title>Detailed analysis of category selectivity</title><p>We now provide extra detail on the behaviour of category selectivity. We start explaining why, as observed in <xref ref-type="fig" rid="fig6">Figure 6A</xref> and <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1A</xref>, initial selectivity does not vanish, but is weakly negative. This phenomenon is observed both for the synaptic drive <inline-formula><mml:math id="inf867"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">k</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula> and the activity <inline-formula><mml:math id="inf868"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">y</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula>; for the sake of simplicity, we focus on the former.</p><p>Consider for a moment the case <inline-formula><mml:math id="inf869"><mml:mrow><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mn mathsize="90%">2</mml:mn></mml:mrow></mml:math></inline-formula> (XOR computation). The geometry of the initial synaptic drive is in that case particularly simple, and is illustrated in <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2D</xref>. As can be easily verified by using <xref ref-type="disp-formula" rid="equ7">Equation 5b</xref> and <xref ref-type="disp-formula" rid="equ127">Equation 110</xref>, each synaptic drive is given by the linear superposition of two vectors: a vector among <inline-formula><mml:math id="inf870"><mml:msup><mml:mover accent="true"><mml:mi mathsize="90%" mathvariant="bold-italic">μ</mml:mi><mml:mo mathsize="90%" mathvariant="bold" stretchy="false">~</mml:mo></mml:mover><mml:mn mathsize="90%">1</mml:mn></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf871"><mml:msup><mml:mover accent="true"><mml:mi mathsize="90%" mathvariant="bold-italic">μ</mml:mi><mml:mo mathsize="90%" mathvariant="bold" stretchy="false">~</mml:mo></mml:mover><mml:mn mathsize="90%">2</mml:mn></mml:msup></mml:math></inline-formula>, and a vector among <inline-formula><mml:math id="inf872"><mml:msup><mml:mover accent="true"><mml:mi mathsize="90%" mathvariant="bold-italic">ν</mml:mi><mml:mo mathsize="90%" mathvariant="bold" stretchy="false">~</mml:mo></mml:mover><mml:mn mathsize="90%">1</mml:mn></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf873"><mml:msup><mml:mover accent="true"><mml:mi mathsize="90%" mathvariant="bold-italic">ν</mml:mi><mml:mo mathsize="90%" mathvariant="bold" stretchy="false">~</mml:mo></mml:mover><mml:mn mathsize="90%">2</mml:mn></mml:msup></mml:math></inline-formula>. Vectors <inline-formula><mml:math id="inf874"><mml:mover accent="true"><mml:mi mathsize="90%" mathvariant="bold-italic">μ</mml:mi><mml:mo mathsize="90%" mathvariant="bold" stretchy="false">~</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf875"><mml:mover accent="true"><mml:mi mathsize="90%" mathvariant="bold-italic">ν</mml:mi><mml:mo mathsize="90%" mathvariant="bold" stretchy="false">~</mml:mo></mml:mover></mml:math></inline-formula> are obtained by applying the initial connectivity <inline-formula><mml:math id="inf876"><mml:msub><mml:mi mathsize="90%" mathvariant="bold-italic">u</mml:mi><mml:mn mathsize="90%">0</mml:mn></mml:msub></mml:math></inline-formula> to vectors <inline-formula><mml:math id="inf877"><mml:mi mathsize="90%" mathvariant="bold-italic">μ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf878"><mml:mi mathsize="90%" mathvariant="bold-italic">ν</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ127">Equation 110</xref>); for example, <inline-formula><mml:math id="inf879"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi mathsize="90%" mathvariant="bold-italic">μ</mml:mi><mml:mo mathsize="90%" mathvariant="bold" stretchy="false">~</mml:mo></mml:mover><mml:mn mathsize="90%">1</mml:mn></mml:msup><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:msub><mml:mi mathsize="90%" mathvariant="bold-italic">u</mml:mi><mml:mn mathsize="90%">0</mml:mn></mml:msub><mml:mo mathsize="90%" stretchy="false">⋅</mml:mo><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">μ</mml:mi><mml:mn mathsize="90%">1</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. In the plane spanned by vectors <inline-formula><mml:math id="inf880"><mml:mover accent="true"><mml:mi mathsize="90%" mathvariant="bold-italic">μ</mml:mi><mml:mo mathsize="90%" mathvariant="bold" stretchy="false">~</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf881"><mml:mover accent="true"><mml:mi mathsize="90%" mathvariant="bold-italic">ν</mml:mi><mml:mo mathsize="90%" mathvariant="bold" stretchy="false">~</mml:mo></mml:mover></mml:math></inline-formula>, the geometry of synaptic drives is square like (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2D</xref>). To verify that, observe that the squared distance between consecutive vertices is identical – for example,<disp-formula id="equ186"><label>(162)</label><mml:math id="m186"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></disp-formula></p><p>where we used <xref ref-type="disp-formula" rid="equ54">Equation 43</xref> together with <xref ref-type="disp-formula" rid="equ128">Equation 111</xref>. Opposite vertices have instead double squared distance – for example,<disp-formula id="equ187"><label>(163)</label><mml:math id="m187"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></disp-formula></p><p>as expected for a square. Importantly, consecutive vertices are associated with different categories, while opposite vertices are associated with the same category; this implies that initial category selectivity is negative. In fact, using <xref ref-type="disp-formula" rid="equ186">Equation 162</xref> and <xref ref-type="disp-formula" rid="equ187">Equation 163</xref> into <xref ref-type="disp-formula" rid="equ142">Equation 124</xref> yields:<disp-formula id="equ188"><label>(164)</label><mml:math id="m188"><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>cat</mml:mtext></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mn>0.</mml:mn></mml:mrow></mml:math></disp-formula></p><p>It is easy to see that initial category selectivity is negative also when <inline-formula><mml:math id="inf882"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. However, its magnitude converges to zero as the number of stimuli and context cues, <inline-formula><mml:math id="inf883"><mml:mi mathsize="90%">Q</mml:mi></mml:math></inline-formula>, increases (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1A</xref>). This is due to the fact that, as <inline-formula><mml:math id="inf884"><mml:mi mathsize="90%">Q</mml:mi></mml:math></inline-formula> becomes large, both the within-category and the across-category averages in <xref ref-type="disp-formula" rid="equ142">Equation 124</xref> become dominated by pairs of trials with different stimulus and context cue; activity from those pairs of trials are characterized by identical initial distances (=2, as in <xref ref-type="disp-formula" rid="equ187">Equation 163</xref>), and thus the two averages become similar.</p><p>We now shed light on a second phenomenon: the fact that category selectivity increases over learning for the activity <inline-formula><mml:math id="inf885"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">y</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula>, but remains identical for the synaptic drive <inline-formula><mml:math id="inf886"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">k</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula>. This is observed both in simulations (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1B</xref> and <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1A</xref>), and in numerical integration of theoretical expressions (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1A</xref> and <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1A</xref>). To see why this happens, we assume that the number of stimuli and context cues, <inline-formula><mml:math id="inf887"><mml:mi mathsize="90%">Q</mml:mi></mml:math></inline-formula>, is fairly large (<inline-formula><mml:math id="inf888"><mml:mrow><mml:mn mathsize="90%">1</mml:mn><mml:mo mathsize="90%" stretchy="false">≪</mml:mo><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">≪</mml:mo><mml:mi mathsize="90%">N</mml:mi></mml:mrow></mml:math></inline-formula>). As discussed above, in this limit, initial category selectivity is approximately close to zero. To compute selectivity after learning, we use <xref ref-type="disp-formula" rid="equ142">Equation 124</xref>, and evaluate the within-category and the across-category averages. We compute averages to the dominant terms in <inline-formula><mml:math id="inf889"><mml:mi mathsize="90%">Q</mml:mi></mml:math></inline-formula>, which correspond to pairs of trials with different stimulus and context cue. Using the same <inline-formula><mml:math id="inf890"><mml:mi mathsize="90%">s</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf891"><mml:msup><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">′</mml:mo></mml:msup></mml:math></inline-formula> trials as in Section Detailed analysis of context selectivity, we obtain<disp-formula id="equ189"><label>(165)</label><mml:math id="m189"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> same cat</mml:mtext></mml:mrow></mml:msub><mml:mo>≃</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mtext> diff cat</mml:mtext></mml:mrow></mml:msub><mml:mo>≃</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>To show that category selectivity does not change over learning, we need to show that the two lines above are identical. Using <xref ref-type="disp-formula" rid="equ160">Equation 139</xref>, this condition can be written as:<disp-formula id="equ190"><label>(166)</label><mml:math id="m190"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>which can now be easily verified by using <xref ref-type="disp-formula" rid="equ179">Equation 158</xref> and <xref ref-type="disp-formula" rid="equ183">Equation 159</xref>.</p><p><xref ref-type="disp-formula" rid="equ190">Equation 166</xref> indicates that, on average across contexts, synaptic drives from trials with the same category are as close as trials with different category. This geometrical relationship can be easily verified in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1C</xref>, which shows the synaptic drive from simulated circuits. We focus on the middle panel, where we have <inline-formula><mml:math id="inf892"><mml:mrow><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. The four activity clouds corresponding to different combinations of category and context values are approximately arranged on the vertices of a square; consecutive vertices are associated with different categories, while opposite vertices are associated with the same category. To see why <xref ref-type="disp-formula" rid="equ190">Equation 166</xref> holds, note that squared distances among synaptic drives associated with different category are approximately identical, while squared distances among synaptic drives associated within the same category are either 0 (approximately, half of the times), or twice the across-category distance (the other half). It is interesting to observe that this square-like configuration, which emerges over learning from an almost unstructured one (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1C</xref>, left), strongly resembles the initial configuration of the XOR task (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2D</xref>).</p><p>A fundamental feature of this configuration is that synaptic drives are not linearly separable by category. The activity vectors <inline-formula><mml:math id="inf893"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">y</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula>, on the other hand, are linearly separable. Before learning, linear separability is guaranteed by the nonlinearity <inline-formula><mml:math id="inf894"><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi></mml:math></inline-formula>, which makes activity vectors linearly separable along random directions (<xref ref-type="bibr" rid="bib5">Barak et al., 2013</xref>). After learning, activity vectors become linearly separable also along task-relevant directions. In the simplified scenario where <inline-formula><mml:math id="inf895"><mml:mrow><mml:msub><mml:mi mathsize="90%">η</mml:mi><mml:mi mathsize="90%">w</mml:mi></mml:msub><mml:mo mathsize="90%" stretchy="false">≪</mml:mo><mml:msub><mml:mi mathsize="90%">η</mml:mi><mml:mi mathsize="90%">u</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, the activity vectors become linearly separable along <inline-formula><mml:math id="inf896"><mml:msub><mml:mi mathsize="90%" mathvariant="bold-italic">w</mml:mi><mml:mn mathsize="90%">0</mml:mn></mml:msub></mml:math></inline-formula>; in the general case, they become linearly separable along a direction that is correlated with <inline-formula><mml:math id="inf897"><mml:msub><mml:mi mathsize="90%" mathvariant="bold-italic">w</mml:mi><mml:mn mathsize="90%">0</mml:mn></mml:msub></mml:math></inline-formula>. This is shown in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1D</xref> the configuration of activity is very similar to synaptic drives, but activity vectors associated with different categories clusters, and thus become linearly separable, along an emerging, orthogonal direction. This drives the increase in category selectivity that was observed both in equations and simulations (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1A, B</xref> and <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1A</xref>). A further insight on the relationship between selectivity and activity geometry is given in the next section.</p><p>We conclude with a remark. Although for activity variables category selectivity robustly increases, the fact that selectivity is weakly negative before learning implies that asymptotic values can be small, or even negative. This is compatible with findings in <xref ref-type="bibr" rid="bib6">Bernardi et al., 2020</xref>, where very small values of category clustering (<xref ref-type="disp-formula" rid="equ142">Equation 124</xref>) were observed. This observation stresses the importance of measuring, in experimental preparations, neural activity across multiple stages of learning.</p></sec><sec id="s4-12"><title>Analysis of patterns of context and category selectivity</title><p>In this section, we investigate how changes in context and category selectivity are distributed across neurons.</p><p>In the simple task, we found that the magnitude of selectivity changes for a given neuron, <inline-formula><mml:math id="inf898"><mml:mi mathsize="90%">i</mml:mi></mml:math></inline-formula>, was correlated with the magnitude of the <inline-formula><mml:math id="inf899"><mml:mi mathsize="90%">i</mml:mi></mml:math></inline-formula>th entry of the initial readout vector <inline-formula><mml:math id="inf900"><mml:msub><mml:mi mathsize="90%" mathvariant="bold-italic">w</mml:mi><mml:mn mathsize="90%">0</mml:mn></mml:msub></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ80">Equation 65</xref>, <xref ref-type="fig" rid="fig5">Figure 5B, C</xref>). This vector defines the direction along which clustering by category takes place. In fact, if one draws the vector joining the centers of the activity clouds associated with different categories, <inline-formula><mml:math id="inf901"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">y</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf902"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">y</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ93">Equation 78</xref>), the resulting direction is correlated with <inline-formula><mml:math id="inf903"><mml:msub><mml:mi mathsize="90%" mathvariant="bold-italic">w</mml:mi><mml:mn mathsize="90%">0</mml:mn></mml:msub></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ112">Equation 96</xref>). This direction is indicated with <inline-formula><mml:math id="inf904"><mml:mi mathsize="90%" mathvariant="bold-italic">d</mml:mi></mml:math></inline-formula> in the main text; cloud centers <inline-formula><mml:math id="inf905"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">y</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf906"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">y</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:math></inline-formula> are plotted, in <xref ref-type="fig" rid="fig3">Figure 3B, C</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B</xref>, as magenta triangles.</p><p>In analogy with the simple task, we now hypothesize that the magnitude of changes in context and category selectivity for a given neuron, <inline-formula><mml:math id="inf907"><mml:mi mathsize="90%">i</mml:mi></mml:math></inline-formula>, is related to the magnitude of the <inline-formula><mml:math id="inf908"><mml:mi mathsize="90%">i</mml:mi></mml:math></inline-formula>th entry of the context and category directions, <inline-formula><mml:math id="inf909"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">d</mml:mi><mml:mtext mathsize="90%">ctx</mml:mtext></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf910"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">d</mml:mi><mml:mtext mathsize="90%">cat</mml:mtext></mml:msup></mml:math></inline-formula>. Those coincide with the directions along which clustering to context and category emerges (<xref ref-type="fig" rid="fig7">Figure 7B, C</xref>), and are given by the vectors joining the centers of the activity clouds associated with different contexts (<xref ref-type="disp-formula" rid="equ148">Equation 130</xref>) and categories (<xref ref-type="disp-formula" rid="equ93">Equation 78</xref>). The cloud centers for category and context are plotted, in <xref ref-type="fig" rid="fig7">Figure 7B, C</xref> and <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1C, D</xref>, as magenta and pink triangles. This assumption is verified in <xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3A, B</xref>, which shows that selectivity changes and context and category directions are highly correlated. Our reasoning implies that, in order to understand how selectivity changes are distributed across neurons, we need to evaluate the entries of the context and category directions; this is done, analytically, in the rest of this section.</p><p>As we are interested in selectivity changes, we focus on activity changes, and approximate<disp-formula id="equ191"><label>(167a)</label><mml:math id="m191"><mml:mrow><mml:msup><mml:mi mathsize="90%">d</mml:mi><mml:mtext mathsize="90%">ctx</mml:mtext></mml:msup><mml:mo mathsize="90%" stretchy="false">≃</mml:mo><mml:mrow><mml:mrow><mml:mi mathsize="90%" mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathsize="90%">y</mml:mi><mml:mn mathsize="90%">1</mml:mn></mml:msup></mml:mrow><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:mrow><mml:mi mathsize="90%" mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathsize="90%">y</mml:mi><mml:mn mathsize="90%">2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ192"><label>(167b)</label><mml:math id="m192"><mml:mrow><mml:msup><mml:mi mathsize="90%">d</mml:mi><mml:mtext mathsize="90%">cat</mml:mtext></mml:msup><mml:mo mathsize="90%" stretchy="false">≃</mml:mo><mml:mrow><mml:mrow><mml:mi mathsize="90%" mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathsize="90%">y</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup></mml:mrow><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:mrow><mml:mi mathsize="90%" mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathsize="90%">y</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where, similar to <xref ref-type="disp-formula" rid="equ93">Equation 78</xref> and <xref ref-type="disp-formula" rid="equ148">Equation 130</xref>, we have taken<disp-formula id="equ193"><label>(168a)</label><mml:math id="m193"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ194"><label>(168b)</label><mml:math id="m194"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">2</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">2</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">2</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>and<disp-formula id="equ195"><label>(169a)</label><mml:math id="m195"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ196"><label>(169b)</label><mml:math id="m196"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We start with context. We have seen in Section Detailed analysis of context selectivity that context selectivity can also be studied at the level of the synaptic drive <inline-formula><mml:math id="inf911"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">k</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula>, which greatly simplifies the analysis. Starting from <xref ref-type="disp-formula" rid="equ138">Equation 120</xref>, we thus compute<disp-formula id="equ197"><label>(170)</label><mml:math id="m197"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>Q</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>As in Section Detailed analysis of context selectivity, indices <inline-formula><mml:math id="inf912"><mml:msub><mml:mi mathsize="90%">S</mml:mi><mml:mo mathsize="90%" stretchy="false">+</mml:mo></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf913"><mml:msub><mml:mi mathsize="90%">S</mml:mi><mml:mo mathsize="90%" stretchy="false">-</mml:mo></mml:msub></mml:math></inline-formula> (and, similarly, <inline-formula><mml:math id="inf914"><mml:msub><mml:mi mathsize="90%">C</mml:mi><mml:mo mathsize="90%" stretchy="false">+</mml:mo></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf915"><mml:msub><mml:mi mathsize="90%">C</mml:mi><mml:mo mathsize="90%" stretchy="false">-</mml:mo></mml:msub></mml:math></inline-formula>) run, respectively, from 1 to <inline-formula><mml:math id="inf916"><mml:mrow><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">/</mml:mo><mml:mn mathsize="90%">2</mml:mn></mml:mrow></mml:math></inline-formula> and from <inline-formula><mml:math id="inf917"><mml:mrow><mml:mrow><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">/</mml:mo><mml:mn mathsize="90%">2</mml:mn></mml:mrow><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:mn mathsize="90%">1</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf918"><mml:mi mathsize="90%">Q</mml:mi></mml:math></inline-formula>. Similarly,<disp-formula id="equ198"><label>(171)</label><mml:math id="m198"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">2</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>Q</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>Note that, because of the first two terms in the right-hand sides, <xref ref-type="disp-formula" rid="equ197">Equation 170</xref> and <xref ref-type="disp-formula" rid="equ198">Equation 171</xref> are not identical.</p><p>To further simplify the analysis, we assume that <inline-formula><mml:math id="inf919"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>≃</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. As discussed in Section Context-dependent task: computing activity, in the current task, this represents a good approximation for a large space of parameters; we verified with simulations that our main results also hold, qualitatively, in circuits where this approximation fails (notably, in the circuit illustrated in the third column of <xref ref-type="fig" rid="fig6">Figure 6</xref>, see <xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3C, D</xref>). Combining <xref ref-type="disp-formula" rid="equ191">Equation 167a</xref> with <xref ref-type="disp-formula" rid="equ197">Equation 170</xref> and <xref ref-type="disp-formula" rid="equ198">Equation 171</xref>, we then obtain<disp-formula id="equ199"><label>(172)</label><mml:math id="m199"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>ctx</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">1</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn mathvariant="sans-serif">2</mml:mn></mml:mrow></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mi>Q</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:mfrac><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>≡</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mi>Q</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:mfrac><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where we have defined<disp-formula id="equ200"><label>(173)</label><mml:math id="m200"><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>≡</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ199">Equation 172</xref> indicates that neurons exhibiting a strong increase in context selectivity are characterized by: (1) strong readout connectivity, before learning, as quantified by <inline-formula><mml:math id="inf920"><mml:msub><mml:mi mathsize="90%">w</mml:mi><mml:mrow><mml:mn mathsize="90%">0</mml:mn><mml:mo mathsize="90%" stretchy="false">,</mml:mo><mml:mi mathsize="90%">i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and (2) a large value of <inline-formula><mml:math id="inf921"><mml:msubsup><mml:mi mathsize="90%">D</mml:mi><mml:mi mathsize="90%">i</mml:mi><mml:mi mathsize="90%">C</mml:mi></mml:msubsup></mml:math></inline-formula>, averaged over context cues. <inline-formula><mml:math id="inf922"><mml:msubsup><mml:mi mathsize="90%">D</mml:mi><mml:mi mathsize="90%">i</mml:mi><mml:mi mathsize="90%">C</mml:mi></mml:msubsup></mml:math></inline-formula> is a function of the response gain function, <inline-formula><mml:math id="inf923"><mml:msup><mml:mi mathsize="90%" mathvariant="normal">Ψ</mml:mi><mml:mo mathsize="90%" stretchy="false">′</mml:mo></mml:msup></mml:math></inline-formula>, evaluated before learning; specifically, <inline-formula><mml:math id="inf924"><mml:msubsup><mml:mi mathsize="90%">D</mml:mi><mml:mi mathsize="90%">i</mml:mi><mml:mi mathsize="90%">C</mml:mi></mml:msubsup></mml:math></inline-formula> measures the difference in the initial gain in response to the two classes of stimuli (the first half, <inline-formula><mml:math id="inf925"><mml:mrow><mml:msub><mml:mi mathsize="90%">S</mml:mi><mml:mo mathsize="90%" stretchy="false">+</mml:mo></mml:msub><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mn mathsize="90%">1</mml:mn><mml:mo mathsize="90%" stretchy="false">,</mml:mo><mml:mi mathsize="90%" mathvariant="normal">…</mml:mi><mml:mo mathsize="90%" stretchy="false">,</mml:mo><mml:mrow><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">/</mml:mo><mml:mn mathsize="90%">2</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and the second half, <inline-formula><mml:math id="inf926"><mml:mrow><mml:msub><mml:mi mathsize="90%">S</mml:mi><mml:mo mathsize="90%" stretchy="false">-</mml:mo></mml:msub><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:mrow><mml:mi mathsize="90%">Q</mml:mi><mml:mo mathsize="90%" stretchy="false">/</mml:mo><mml:mn mathsize="90%">2</mml:mn></mml:mrow><mml:mo mathsize="90%" stretchy="false">,</mml:mo><mml:mi mathsize="90%" mathvariant="normal">…</mml:mi><mml:mo mathsize="90%" stretchy="false">,</mml:mo><mml:mi mathsize="90%">Q</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>). These predictions, which were derived for the synaptic drive <inline-formula><mml:math id="inf927"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">k</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula>, also hold, qualitatively, for the activity <inline-formula><mml:math id="inf928"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">y</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula> (<xref ref-type="fig" rid="fig7">Figure 7</xref>).</p><p>We next compute the category direction <inline-formula><mml:math id="inf929"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">d</mml:mi><mml:mrow><mml:mi mathsize="90%">c</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">a</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">t</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>; we focus again on the synaptic drive <inline-formula><mml:math id="inf930"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">k</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula> rather than activity <inline-formula><mml:math id="inf931"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">y</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msup></mml:math></inline-formula>. We observe that, before learning, the centers of synaptic drive vectors associated with categories <inline-formula><mml:math id="inf932"><mml:mi mathsize="90%">A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf933"><mml:mi mathsize="90%">B</mml:mi></mml:math></inline-formula> are perfectly identical. In fact,<disp-formula id="equ201"><label>(174)</label><mml:math id="m201"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>μ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>μ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>ν</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>and an identical expression is obtained for <inline-formula><mml:math id="inf934"><mml:msubsup><mml:mi mathsize="90%">k</mml:mi><mml:mrow><mml:mn mathsize="90%">0</mml:mn><mml:mo mathsize="90%" stretchy="false">,</mml:mo><mml:mi mathsize="90%">i</mml:mi></mml:mrow><mml:mi mathsize="90%">B</mml:mi></mml:msubsup></mml:math></inline-formula>. The fact that the centers are identical is due to the fact that sensory inputs for the two categories are collinear, and perfectly intermingled (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2D</xref>). We now consider the synaptic drive changes over learning. Starting from <xref ref-type="disp-formula" rid="equ138">Equation 120</xref>, we have<disp-formula id="equ202"><label>(175)</label><mml:math id="m202"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>Q</mml:mi><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>It is easy to show that <inline-formula><mml:math id="inf935"><mml:mrow><mml:mi mathsize="90%" mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathsize="90%">k</mml:mi><mml:mi mathsize="90%">i</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> yields the same result, implying that the centers for synaptic drive vectors associated with categories <inline-formula><mml:math id="inf936"><mml:mi mathsize="90%">A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf937"><mml:mi mathsize="90%">B</mml:mi></mml:math></inline-formula> remain identical over learning (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1C</xref>, magenta triangles). This happens because the synaptic drive vectors associated with categories <inline-formula><mml:math id="inf938"><mml:mi mathsize="90%">A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf939"><mml:mi mathsize="90%">B</mml:mi></mml:math></inline-formula> remain intermingled, and nonlinearly separable, over learning. We conclude that the category axis <inline-formula><mml:math id="inf940"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">d</mml:mi><mml:mtext mathsize="90%">cat</mml:mtext></mml:msup></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ192">Equation 167b</xref>) vanishes, which is in agreement with the observation that category selectivity does not change for synaptic drives (Section Detailed analysis of category selectivity).</p><p>To compute <inline-formula><mml:math id="inf941"><mml:msup><mml:mi mathsize="90%" mathvariant="bold-italic">d</mml:mi><mml:mtext mathsize="90%">cat</mml:mtext></mml:msup></mml:math></inline-formula>, we thus turn to activity <inline-formula><mml:math id="inf942"><mml:mi mathsize="90%" mathvariant="bold-italic">y</mml:mi></mml:math></inline-formula>. We start from <xref ref-type="disp-formula" rid="equ136">Equation 118</xref>, and write<disp-formula id="equ203"><label>(176a)</label><mml:math id="m203"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ204"><label>(176b)</label><mml:math id="m204"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We then expand indices over stimuli and context cues, which yields<disp-formula id="equ205"><label>(177)</label><mml:math id="m205"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mi>Q</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">[</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>and<disp-formula id="equ206"><label>(178)</label><mml:math id="m206"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>Q</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">[</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>To reduce the clutter, we have removed subscripts after brackets <inline-formula><mml:math id="inf943"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo>.</mml:mo><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>; those indicate an average taken over all the <inline-formula><mml:math id="inf944"><mml:mi mathsize="90%">S</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf945"><mml:mi mathsize="90%">C</mml:mi></mml:math></inline-formula> indices contained within.</p><p>As will become clear shortly, the two centers now differ (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1D</xref>, magenta triangles). To simplify those expressions, we again assume that <inline-formula><mml:math id="inf946"><mml:mrow><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup><mml:mo mathsize="90%" stretchy="false">≃</mml:mo><mml:mrow><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:msup><mml:mi mathsize="90%">c</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>; this allows us to write<disp-formula id="equ207"> <label>(179)</label><mml:math id="m207"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>cat</mml:mtext></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">B</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>×</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em">[</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>−</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>−</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>With a little algebra, we can see that<disp-formula id="equ208"><label>(180)</label><mml:math id="m208"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>cat</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em">[</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>C</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em">]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>or, equivalently<disp-formula id="equ209"><label>(181)</label><mml:math id="m209"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>cat</mml:mtext></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mi>Q</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">A</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mi>Q</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where we have defined<disp-formula id="equ210"><label>(182)</label><mml:math id="m210"><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mo>≡</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ209">Equation 181</xref> indicates that neurons characterized by a strong increase in category selectivity are characterized by: (1) strong readout connectivity, before learning, as quantified by <inline-formula><mml:math id="inf947"><mml:msub><mml:mi mathsize="90%">w</mml:mi><mml:mrow><mml:mn mathsize="90%">0</mml:mn><mml:mo mathsize="90%" stretchy="false">,</mml:mo><mml:mi mathsize="90%">i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and (2) large values of <inline-formula><mml:math id="inf948"><mml:msubsup><mml:mi mathsize="90%">D</mml:mi><mml:mi mathsize="90%">i</mml:mi><mml:mi mathsize="90%">C</mml:mi></mml:msubsup></mml:math></inline-formula> and/or <inline-formula><mml:math id="inf949"><mml:msubsup><mml:mi mathsize="90%">D</mml:mi><mml:mi mathsize="90%">i</mml:mi><mml:mi mathsize="90%">S</mml:mi></mml:msubsup></mml:math></inline-formula>, averaged, respectively, over context cues and stimuli.</p><p>Note that neurons that are characterized by a strong increase in context selectivity (<xref ref-type="disp-formula" rid="equ199">Equation 172</xref>), which have large <inline-formula><mml:math id="inf950"><mml:msub><mml:mi mathsize="90%">w</mml:mi><mml:mrow><mml:mn mathsize="90%">0</mml:mn><mml:mo mathsize="90%" stretchy="false">,</mml:mo><mml:mi mathsize="90%">i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf951"><mml:msubsup><mml:mi mathsize="90%">D</mml:mi><mml:mi mathsize="90%">i</mml:mi><mml:mi mathsize="90%">C</mml:mi></mml:msubsup></mml:math></inline-formula> values, are also characterized by a strong increase in category selectivity (<xref ref-type="disp-formula" rid="equ209">Equation 181</xref>). On the other hand, neurons with large <inline-formula><mml:math id="inf952"><mml:msub><mml:mi mathsize="90%">w</mml:mi><mml:mrow><mml:mn mathsize="90%">0</mml:mn><mml:mo mathsize="90%" stretchy="false">,</mml:mo><mml:mi mathsize="90%">i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf953"><mml:msubsup><mml:mi mathsize="90%">D</mml:mi><mml:mi mathsize="90%">i</mml:mi><mml:mi mathsize="90%">S</mml:mi></mml:msubsup></mml:math></inline-formula> values are characterized by a strong increase in category selectivity (<xref ref-type="disp-formula" rid="equ209">Equation 181</xref>), but not context (<xref ref-type="disp-formula" rid="equ199">Equation 172</xref>). Overall, strongly selective neurons can thus be classified in two groups: one displaying mixed selectivity to category and context, and one displaying pure selectivity to category. By defining the quantity:<disp-formula id="equ211"><label>(183)</label><mml:math id="m211"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>we see that the former group is characterized by larger values of <inline-formula><mml:math id="inf954"><mml:msub><mml:mi mathsize="90%">G</mml:mi><mml:mi mathsize="90%">i</mml:mi></mml:msub></mml:math></inline-formula> with respect to the latter. This is verified and illustrated in <xref ref-type="fig" rid="fig8">Figure 8B, C</xref>.</p></sec><sec id="s4-13"><title>Software</title><sec id="s4-13-1"><title>Circuit simulations</title><p>Simulations were implemented with the Python programming language. Gradient-descent learning was implemented with the PyTorch package. We used the <italic>SGD</italic> optimization function, with loss <italic>MSELoss</italic>. On every learning epoch, the batch included all sensory input vectors. Training stopped when the loss function dropped below <inline-formula><mml:math id="inf955"><mml:msup><mml:mn mathsize="90%">10</mml:mn><mml:mrow><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:mn mathsize="90%">5</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>. Learning rates were taken to be <inline-formula><mml:math id="inf956"><mml:mrow><mml:mi mathsize="90%">η</mml:mi><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mn mathsize="90%">0.1</mml:mn></mml:mrow></mml:math></inline-formula> for input connectivity <inline-formula><mml:math id="inf957"><mml:mi mathsize="90%" mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf958"><mml:mrow><mml:mrow><mml:mi mathsize="90%">η</mml:mi><mml:mo mathsize="90%" stretchy="false">⋅</mml:mo><mml:msub><mml:mi mathsize="90%">η</mml:mi><mml:mi mathsize="90%">w</mml:mi></mml:msub></mml:mrow><mml:mo mathsize="90%" stretchy="false">/</mml:mo><mml:msub><mml:mi mathsize="90%">η</mml:mi><mml:mi mathsize="90%">u</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (with values of <inline-formula><mml:math id="inf959"><mml:msub><mml:mi mathsize="90%">η</mml:mi><mml:mi mathsize="90%">u</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf960"><mml:msub><mml:mi mathsize="90%">η</mml:mi><mml:mi mathsize="90%">w</mml:mi></mml:msub></mml:math></inline-formula> as indicated in Section Tables of parameters) for readout connectivity <inline-formula><mml:math id="inf961"><mml:mi mathsize="90%" mathvariant="bold-italic">w</mml:mi></mml:math></inline-formula>.</p></sec><sec id="s4-13-2"><title>Tables of parameters</title><p>We summarize below the parameters chosen for the simulations reported in figures and figure supplements. For figures not included in the tables below (<xref ref-type="table" rid="table1">Table 1</xref>, <xref ref-type="table" rid="table2">Table 2</xref>) parameters have been detailed in figures captions. We have taken everywhere <inline-formula><mml:math id="inf962"><mml:mrow><mml:msup><mml:mi mathsize="90%">z</mml:mi><mml:mi mathsize="90%">A</mml:mi></mml:msup><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mn mathsize="90%">0.75</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf963"><mml:mrow><mml:msup><mml:mi mathsize="90%">z</mml:mi><mml:mi mathsize="90%">B</mml:mi></mml:msup><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mn mathsize="90%">0.25</mml:mn></mml:mrow></mml:math></inline-formula> (note that activity variables range between 0 and 1).</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Table of parameters for figures in the main text.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Figure</th><th align="left" valign="bottom"><inline-formula><mml:math id="inf964"><mml:mi mathsize="90%">N</mml:mi></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf965"><mml:mi mathsize="90%">Q</mml:mi></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf966"><mml:mrow><mml:msub><mml:mi mathsize="90%">η</mml:mi><mml:mi mathsize="90%">w</mml:mi></mml:msub><mml:mo mathsize="90%" stretchy="false">/</mml:mo><mml:msub><mml:mi mathsize="90%">η</mml:mi><mml:mi mathsize="90%">u</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf967"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="mediummathspace"/><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf968"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="mediummathspace"/><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf969"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf970"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></th></tr></thead><tbody><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig2">Figures 2</xref>, <xref ref-type="fig" rid="fig3">3</xref> and <xref ref-type="fig" rid="fig5">5</xref>, first and second columns</td><td align="char" char="." valign="bottom">200</td><td align="char" char="." valign="bottom">20</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">2.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">0.0</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig2">Figures 2</xref>, <xref ref-type="fig" rid="fig3">3</xref> and <xref ref-type="fig" rid="fig5">5</xref>, third column</td><td align="char" char="." valign="bottom">200</td><td align="char" char="." valign="bottom">20</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">2.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">2.0</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig4">Figure 4A</xref></td><td align="char" char="." valign="bottom">200</td><td align="char" char="." valign="bottom">20</td><td align="char" char="." valign="bottom">0.4</td><td align="char" char="." valign="bottom">2.0</td><td align="char" char="." valign="bottom">2.0</td><td align="left" valign="bottom">varies</td><td align="left" valign="bottom">varies</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig4">Figure 4B</xref></td><td align="char" char="." valign="bottom">200</td><td align="char" char="." valign="bottom">20</td><td align="char" char="." valign="bottom">0.4</td><td align="left" valign="bottom">varies</td><td align="left" valign="bottom">varies</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">2.0</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig4">Figure 4C</xref></td><td align="char" char="." valign="bottom">200</td><td align="char" char="." valign="bottom">20</td><td align="left" valign="bottom">varies</td><td align="char" char="." valign="bottom">2.0</td><td align="char" char="." valign="bottom">2.0</td><td align="char" char="." valign="bottom">1.0</td><td align="left" valign="bottom">varies</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig4">Figure 4D</xref></td><td align="char" char="." valign="bottom">200</td><td align="left" valign="bottom">varies</td><td align="char" char="." valign="bottom">0.4</td><td align="char" char="." valign="bottom">2.0</td><td align="char" char="." valign="bottom">2.0</td><td align="char" char="." valign="bottom">1.0</td><td align="left" valign="bottom">varies</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig6">Figure 6A–C</xref>, first and second columns</td><td align="char" char="." valign="bottom">600</td><td align="char" char="." valign="bottom">8 (<italic>P</italic> = 64)</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">0.0</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig6">Figure 6A–C</xref>, third column</td><td align="char" char="." valign="bottom">600</td><td align="char" char="." valign="bottom">8 (<italic>P</italic>=64)</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">4.0</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig7">Figure 7D</xref></td><td align="char" char="." valign="bottom">600</td><td align="char" char="." valign="bottom">8 (<italic>P</italic> = 64)</td><td align="char" char="." valign="bottom">0.2</td><td align="char" char="." valign="bottom">2.5</td><td align="char" char="." valign="bottom">2.0</td><td align="left" valign="bottom">varies</td><td align="left" valign="bottom">varies</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig7">Figure 7E</xref></td><td align="char" char="." valign="bottom">600</td><td align="char" char="." valign="bottom">8 (<italic>P</italic> = 64)</td><td align="left" valign="bottom">varies</td><td align="char" char="." valign="bottom">2.5</td><td align="char" char="." valign="bottom">2.0</td><td align="char" char="." valign="bottom">1.0</td><td align="left" valign="bottom">varies</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig7">Figure 7F</xref></td><td align="char" char="." valign="bottom">600</td><td align="left" valign="bottom">varies</td><td align="char" char="." valign="bottom">0.2</td><td align="char" char="." valign="bottom">2.5</td><td align="char" char="." valign="bottom">2.0</td><td align="char" char="." valign="bottom">1.0</td><td align="left" valign="bottom">varies</td></tr></tbody></table></table-wrap><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Table of parameters for figure supplements.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Figure supplement</th><th align="left" valign="bottom"><inline-formula><mml:math id="inf971"><mml:mi mathsize="90%">N</mml:mi></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf972"><mml:mi mathsize="90%">Q</mml:mi></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf973"><mml:mrow><mml:msub><mml:mi mathsize="90%">η</mml:mi><mml:mi mathsize="90%">w</mml:mi></mml:msub><mml:mo mathsize="90%" stretchy="false">/</mml:mo><mml:msub><mml:mi mathsize="90%">η</mml:mi><mml:mi mathsize="90%">u</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf974"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="mediummathspace"/><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf975"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf976"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="mediummathspace"/><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf977"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Θ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></th></tr></thead><tbody><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref></td><td align="char" char="." valign="bottom">200</td><td align="left" valign="bottom">varies</td><td align="left" valign="bottom">varies</td><td align="left" valign="bottom">varies</td><td align="left" valign="bottom">varies</td><td align="left" valign="bottom">varies</td><td align="left" valign="bottom">varies</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2E</xref></td><td align="char" char="." valign="bottom">200</td><td align="char" char="." valign="bottom">20</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">2.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">0.0</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>, first column</td><td align="left" valign="bottom">varies</td><td align="char" char="." valign="bottom">20</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">0.0</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>, second column</td><td align="char" char="." valign="bottom">200</td><td align="char" char="." valign="bottom">20</td><td align="left" valign="bottom">varies</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">0.0</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>, third column</td><td align="char" char="." valign="bottom">200</td><td align="char" char="." valign="bottom">20</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">1.0</td><td align="left" valign="bottom">varies</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">0.0</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>, first column</td><td align="left" valign="bottom">varies</td><td align="char" char="." valign="bottom">20</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">2.0</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>, second column</td><td align="char" char="." valign="bottom">200</td><td align="char" char="." valign="bottom">20</td><td align="left" valign="bottom">varies</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">2.0</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>, third column</td><td align="char" char="." valign="bottom">200</td><td align="char" char="." valign="bottom">20</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">1.0</td><td align="left" valign="bottom">varies</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">2.0</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4A, B</xref></td><td align="char" char="." valign="bottom">200</td><td align="char" char="." valign="bottom">12</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">2.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">0.0</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4C</xref></td><td align="char" char="." valign="bottom">200</td><td align="char" char="." valign="bottom">12</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">2.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">2.0</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4D, E</xref>, first column</td><td align="char" char="." valign="bottom">200</td><td align="char" char="." valign="bottom">12</td><td align="char" char="." valign="bottom">0.1</td><td align="char" char="." valign="bottom">2.0</td><td align="left" valign="bottom">varies</td><td align="char" char="." valign="bottom">1.0</td><td align="left" valign="bottom">varies</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4D, E</xref>, second column</td><td align="char" char="." valign="bottom">200</td><td align="char" char="." valign="bottom">12</td><td align="left" valign="bottom">varies</td><td align="char" char="." valign="bottom">2.0</td><td align="char" char="." valign="bottom">2.0</td><td align="char" char="." valign="bottom">1.0</td><td align="left" valign="bottom">varies</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4D, E</xref>, third column</td><td align="char" char="." valign="bottom">200</td><td align="left" valign="bottom">varies</td><td align="char" char="." valign="bottom">0.1</td><td align="char" char="." valign="bottom">2.0</td><td align="char" char="." valign="bottom">2.0</td><td align="char" char="." valign="bottom">1.0</td><td align="left" valign="bottom">varies</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1A, B</xref></td><td align="char" char="." valign="bottom">600</td><td align="left" valign="bottom">varies</td><td align="left" valign="bottom">varies</td><td align="left" valign="bottom">varies</td><td align="left" valign="bottom">varies</td><td align="left" valign="bottom">varies</td><td align="left" valign="bottom">varies</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2A</xref></td><td align="char" char="." valign="bottom">600</td><td align="char" char="." valign="bottom">8 (<italic>P</italic> = 64)</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">3.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">0.0</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2B</xref></td><td align="char" char="." valign="bottom">600</td><td align="char" char="." valign="bottom"><italic>8 (P</italic> = 64)</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">3.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">4.0</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2C</xref></td><td align="char" char="." valign="bottom">600</td><td align="left" valign="bottom">varies</td><td align="left" valign="bottom">varies</td><td align="left" valign="bottom">varies</td><td align="left" valign="bottom">varies</td><td align="left" valign="bottom">varies</td><td align="left" valign="bottom">varies</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1A–C</xref></td><td align="char" char="." valign="bottom">600</td><td align="left" valign="bottom">varies</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">0.0</td></tr><tr><td align="left" valign="bottom"><xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1D–F</xref></td><td align="char" char="." valign="bottom">600</td><td align="left" valign="bottom">varies</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">0.0</td><td align="char" char="." valign="bottom">1.0</td><td align="char" char="." valign="bottom">4.0</td></tr></tbody></table></table-wrap></sec><sec id="s4-13-3"><title>Evaluation of averages</title><p>Evaluating the approximate theoretical expressions for activity measures given in Sections Simple categorization task and Context-dependent categorization task requires computing a number of Gaussian integrals over nonlinear functions. We compute those averages numerically; details are provided below.</p><p>The simplest average, which only involves one nonlinear function, was denoted by <inline-formula><mml:math id="inf978"><mml:mrow><mml:mo maxsize="90%" minsize="90%">⟨</mml:mo><mml:mi mathsize="90%">F</mml:mi><mml:mo maxsize="90%" minsize="90%">⟩</mml:mo></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ57">Equation 45</xref>). We rewrite <xref ref-type="disp-formula" rid="equ57">Equation 45</xref> in an integral form, yielding<disp-formula id="equ212"><label>(184)</label><mml:math id="m212"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi>F</mml:mi><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>≡</mml:mo><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mi>a</mml:mi><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where we have used the short-hand notation<disp-formula id="equ213"><label>(185)</label><mml:math id="m213"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mi>a</mml:mi><mml:mo>≡</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msubsup><mml:mrow/><mml:mspace width="negativethinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>a</mml:mi><mml:mspace width="thinmathspace"/><mml:mfrac><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msqrt><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:msqrt></mml:mfrac><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This integral was computed numerically via Hermite–Gaussian quadrature.</p><p>Averages involving two nonlinear functions were denoted by <inline-formula><mml:math id="inf979"><mml:mrow><mml:mo maxsize="90%" minsize="90%">⟨</mml:mo><mml:mrow><mml:mi mathsize="90%">F</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathsize="90%">F</mml:mi></mml:mrow><mml:mo maxsize="90%" minsize="90%">⟩</mml:mo></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ130">Equation 113</xref>). We rewrite <xref ref-type="disp-formula" rid="equ130">Equation 113</xref> in an integral form, yielding<disp-formula id="equ214"><label>(186)</label><mml:math id="m214"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi>F</mml:mi><mml:mi>F</mml:mi><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>≡</mml:mo><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mi>a</mml:mi><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mi>a</mml:mi><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mi>b</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This integral was computed again via Hermite–Gaussian quadrature.</p><p>Averages involving four nonlinear functions, such as <inline-formula><mml:math id="inf980"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> from <xref ref-type="disp-formula" rid="equ151">Equation 133</xref> (Section Context-dependent task: computing normalized dot products) were computed instead via the function <italic>nquad</italic> from the Python <italic>scipy.integrate</italic> package. We start by rewriting the argument of the average as:<disp-formula id="equ215"><label>(187)</label><mml:math id="m215"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>For each value of the stimulus index <inline-formula><mml:math id="inf981"><mml:mi mathsize="90%">S</mml:mi></mml:math></inline-formula> and the context cue index <inline-formula><mml:math id="inf982"><mml:mi mathsize="90%">C</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf983"><mml:msub><mml:mi mathsize="90%">a</mml:mi><mml:mi mathsize="90%">S</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf984"><mml:msub><mml:mi mathsize="90%">b</mml:mi><mml:mi mathsize="90%">C</mml:mi></mml:msub></mml:math></inline-formula> are two independent, zero-mean and unit-variance Gaussian variables. If the values of <inline-formula><mml:math id="inf985"><mml:mi mathsize="90%">S</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf986"><mml:mi mathsize="90%">C</mml:mi></mml:math></inline-formula> are different across the four trials <inline-formula><mml:math id="inf987"><mml:mi mathsize="90%">q</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf988"><mml:mi mathsize="90%">s</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf989"><mml:msup><mml:mi mathsize="90%">q</mml:mi><mml:mo mathsize="90%" stretchy="false">′</mml:mo></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf990"><mml:msup><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">′</mml:mo></mml:msup></mml:math></inline-formula>, then all <inline-formula><mml:math id="inf991"><mml:mi mathsize="90%">a</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf992"><mml:mi mathsize="90%">b</mml:mi></mml:math></inline-formula> variables involved in <xref ref-type="disp-formula" rid="equ215">Equation 187</xref> are different, and the average reads<disp-formula id="equ216"><label>(188)</label><mml:math id="m216"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>×</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>which simplifies into<disp-formula id="equ217"><label>(189)</label><mml:math id="m217"><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>If the stimulus <inline-formula><mml:math id="inf993"><mml:mi mathsize="90%">S</mml:mi></mml:math></inline-formula> or the context cue <inline-formula><mml:math id="inf994"><mml:mi mathsize="90%">C</mml:mi></mml:math></inline-formula> are, instead, identical across two o more trials (<inline-formula><mml:math id="inf995"><mml:mi mathsize="90%">q</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf996"><mml:mi mathsize="90%">s</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf997"><mml:msup><mml:mi mathsize="90%">q</mml:mi><mml:mo mathsize="90%" stretchy="false">′</mml:mo></mml:msup></mml:math></inline-formula>, and <inline-formula><mml:math id="inf998"><mml:msup><mml:mi mathsize="90%">s</mml:mi><mml:mo mathsize="90%" stretchy="false">′</mml:mo></mml:msup></mml:math></inline-formula>), then some of the <inline-formula><mml:math id="inf999"><mml:mi mathsize="90%">a</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf1000"><mml:mi mathsize="90%">b</mml:mi></mml:math></inline-formula> variables in <xref ref-type="disp-formula" rid="equ215">Equation 187</xref> are shared across nonlinear functions. This generates correlations, which determine the final value of the average. For example, assume <inline-formula><mml:math id="inf1001"><mml:mrow><mml:msub><mml:mi mathsize="90%">S</mml:mi><mml:mi mathsize="90%">q</mml:mi></mml:msub><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:msub><mml:mi mathsize="90%">S</mml:mi><mml:mi mathsize="90%">s</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, while all other <inline-formula><mml:math id="inf1002"><mml:mi mathsize="90%">S</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf1003"><mml:mi mathsize="90%">C</mml:mi></mml:math></inline-formula> values are different among each other. Then the average reads<disp-formula id="equ218"><label>(190)</label><mml:math id="m218"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>×</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>which simplifies into<disp-formula id="equ219"><label>(191)</label><mml:math id="m219"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mtext> </mml:mtext><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>We considered all the possible configurations of <inline-formula><mml:math id="inf1004"><mml:mi mathsize="90%">S</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf1005"><mml:mi mathsize="90%">C</mml:mi></mml:math></inline-formula> indices that can occur in the context-dependent task, and all the resulting correlation patterns. Then, we used analytics to simplify integrals when possible (as in the cases described above). We finally used numerics to evaluate the remaining integral expressions.</p></sec></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf3"><p>Reviewing editor, <italic>eLife</italic></p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Formal analysis, Investigation, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Investigation, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Formal analysis, Supervision, Investigation, Writing – original draft, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-79908-mdarchecklist1-v1.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>The current manuscript is a computational study, so no data have been generated for this manuscript. Code is available online at <ext-link ext-link-type="uri" xlink:href="https://github.com/fmastrogiuseppe/EvolutionActivity">https://github.com/fmastrogiuseppe/EvolutionActivity</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:bfb0d590c10a14465a5007746fa1d2fa78698e43;origin=https://github.com/fmastrogiuseppe/EvolutionActivity;visit=swh:1:snp:6ce7a15b74d24a2090715d2b9213091e3dc7e434;anchor=swh:1:rev:a6b7e083ac6d306599b5c29005dc6aa499e2209a">swh:1:rev:a6b7e083ac6d306599b5c29005dc6aa499e2209a</ext-link>, <xref ref-type="bibr" rid="bib45">Mastrogiuseppe, 2022</xref>).</p></sec><ack id="ack"><title>Acknowledgements</title><p>FM would like to thank Friedrich Schuessler for useful discussions.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Akrout</surname><given-names>M</given-names></name><name><surname>Wilson</surname><given-names>C</given-names></name><name><surname>Humphreys</surname><given-names>P</given-names></name><name><surname>Lillicrap</surname><given-names>T</given-names></name><name><surname>Tweed</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Deep learning without weight transport</article-title><conf-name>Advances in Neural Information Processing Systems</conf-name><ext-link ext-link-type="uri" xlink:href="https://proceedings.neurips.cc/paper/2019/file/f387624df552cea2f369918c5e1e12bc-Paper.pdf">https://proceedings.neurips.cc/paper/2019/file/f387624df552cea2f369918c5e1e12bc-Paper.pdf</ext-link></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Albright</surname><given-names>TD</given-names></name></person-group><year iso-8601-date="1984">1984</year><article-title>Direction and orientation selectivity of neurons in visual area MT of the macaque</article-title><source>Journal of Neurophysiology</source><volume>52</volume><fpage>1106</fpage><lpage>1130</lpage><pub-id pub-id-type="doi">10.1152/jn.1984.52.6.1106</pub-id><pub-id pub-id-type="pmid">6520628</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Asaad</surname><given-names>WF</given-names></name><name><surname>Rainer</surname><given-names>G</given-names></name><name><surname>Miller</surname><given-names>EK</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Neural activity in the primate prefrontal cortex during associative learning</article-title><source>Neuron</source><volume>21</volume><fpage>1399</fpage><lpage>1407</lpage><pub-id pub-id-type="doi">10.1016/s0896-6273(00)80658-3</pub-id><pub-id pub-id-type="pmid">9883732</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Babadi</surname><given-names>B</given-names></name><name><surname>Sompolinsky</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Sparseness and expansion in sensory representations</article-title><source>Neuron</source><volume>83</volume><fpage>1213</fpage><lpage>1226</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.07.035</pub-id><pub-id pub-id-type="pmid">25155954</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barak</surname><given-names>O</given-names></name><name><surname>Rigotti</surname><given-names>M</given-names></name><name><surname>Fusi</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The sparseness of mixed selectivity neurons controls the generalization-discrimination trade-off</article-title><source>The Journal of Neuroscience</source><volume>33</volume><fpage>3844</fpage><lpage>3856</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2753-12.2013</pub-id><pub-id pub-id-type="pmid">23447596</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bernardi</surname><given-names>S</given-names></name><name><surname>Benna</surname><given-names>MK</given-names></name><name><surname>Rigotti</surname><given-names>M</given-names></name><name><surname>Munuera</surname><given-names>J</given-names></name><name><surname>Fusi</surname><given-names>S</given-names></name><name><surname>Salzman</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The geometry of abstraction in the hippocampus and prefrontal cortex</article-title><source>Cell</source><volume>183</volume><fpage>954</fpage><lpage>967</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2020.09.031</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Boopathy</surname><given-names>A</given-names></name><name><surname>Fiete</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>How to train your wide neural network without backprop: an input-weight alignment perspective</article-title><conf-name>ICML</conf-name><fpage>2178</fpage><lpage>2205</lpage></element-citation></ref><ref id="bib8"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Bordelon</surname><given-names>B</given-names></name><name><surname>Pehlevan</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>The Influence of Learning Rule on Representation Dynamics in Wide Neural Networks</article-title><source>arXiv</source><pub-id pub-id-type="doi">10.48550/arXiv.2210.02157</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brincat</surname><given-names>SL</given-names></name><name><surname>Siegel</surname><given-names>M</given-names></name><name><surname>von Nicolai</surname><given-names>C</given-names></name><name><surname>Miller</surname><given-names>EK</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Gradual progression from sensory to task-related processing in cerebral cortex</article-title><source>PNAS</source><volume>115</volume><fpage>E7202</fpage><lpage>E7211</lpage><pub-id pub-id-type="doi">10.1073/pnas.1717075115</pub-id><pub-id pub-id-type="pmid">29991597</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Canatar</surname><given-names>A</given-names></name><name><surname>Bordelon</surname><given-names>B</given-names></name><name><surname>Pehlevan</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Spectral bias and task-model alignment explain generalization in kernel regression and infinitely wide neural networks</article-title><source>Nature Communications</source><volume>12</volume><elocation-id>2914</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-021-23103-1</pub-id><pub-id pub-id-type="pmid">34006842</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chaisangmongkon</surname><given-names>W</given-names></name><name><surname>Swaminathan</surname><given-names>SK</given-names></name><name><surname>Freedman</surname><given-names>DJ</given-names></name><name><surname>Wang</surname><given-names>X-J</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Computing by robust transience: how the fronto-parietal network performs sequential, category-based decisions</article-title><source>Neuron</source><volume>93</volume><fpage>1504</fpage><lpage>1517</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.03.002</pub-id><pub-id pub-id-type="pmid">28334612</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Chizat</surname><given-names>L</given-names></name><name><surname>Oyallon</surname><given-names>E</given-names></name><name><surname>Bach</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>On lazy training in differentiable programming</article-title><conf-name>Advances in Neural Information Processing Systems</conf-name></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cromer</surname><given-names>JA</given-names></name><name><surname>Roy</surname><given-names>JE</given-names></name><name><surname>Miller</surname><given-names>EK</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Representation of multiple, independent categories in the primate prefrontal cortex</article-title><source>Neuron</source><volume>66</volume><fpage>796</fpage><lpage>807</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2010.05.005</pub-id><pub-id pub-id-type="pmid">20547135</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DeAngelis</surname><given-names>GC</given-names></name><name><surname>Uka</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Coding of horizontal disparity and velocity by MT neurons in the alert macaque</article-title><source>Journal of Neurophysiology</source><volume>89</volume><fpage>1094</fpage><lpage>1111</lpage><pub-id pub-id-type="doi">10.1152/jn.00717.2002</pub-id><pub-id pub-id-type="pmid">12574483</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dubreuil</surname><given-names>A</given-names></name><name><surname>Valente</surname><given-names>A</given-names></name><name><surname>Beiran</surname><given-names>M</given-names></name><name><surname>Mastrogiuseppe</surname><given-names>F</given-names></name><name><surname>Ostojic</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>The role of population structure in computations through neural dynamics</article-title><source>Nature Neuroscience</source><volume>25</volume><fpage>783</fpage><lpage>794</lpage><pub-id pub-id-type="doi">10.1038/s41593-022-01088-4</pub-id><pub-id pub-id-type="pmid">35668174</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Engel</surname><given-names>TA</given-names></name><name><surname>Chaisangmongkon</surname><given-names>W</given-names></name><name><surname>Freedman</surname><given-names>DJ</given-names></name><name><surname>Wang</surname><given-names>X-J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Choice-correlated activity fluctuations underlie learning of neuronal category representation</article-title><source>Nature Communications</source><volume>6</volume><elocation-id>6454</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms7454</pub-id><pub-id pub-id-type="pmid">25759251</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fanini</surname><given-names>A</given-names></name><name><surname>Assad</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Direction selectivity of neurons in the macaque lateral intraparietal area</article-title><source>Journal of Neurophysiology</source><volume>101</volume><fpage>289</fpage><lpage>305</lpage><pub-id pub-id-type="doi">10.1152/jn.00400.2007</pub-id><pub-id pub-id-type="pmid">18987126</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fitzgerald</surname><given-names>JK</given-names></name><name><surname>Freedman</surname><given-names>DJ</given-names></name><name><surname>Assad</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Generalized associative representations in parietal cortex</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>1075</fpage><lpage>1079</lpage><pub-id pub-id-type="doi">10.1038/nn.2878</pub-id><pub-id pub-id-type="pmid">21765425</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fitzgerald</surname><given-names>JK</given-names></name><name><surname>Freedman</surname><given-names>DJ</given-names></name><name><surname>Fanini</surname><given-names>A</given-names></name><name><surname>Bennur</surname><given-names>S</given-names></name><name><surname>Gold</surname><given-names>JI</given-names></name><name><surname>Assad</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Biased associative representations in parietal cortex</article-title><source>Neuron</source><volume>77</volume><fpage>180</fpage><lpage>191</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.11.014</pub-id><pub-id pub-id-type="pmid">23312525</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flesch</surname><given-names>T</given-names></name><name><surname>Juechems</surname><given-names>K</given-names></name><name><surname>Dumbalska</surname><given-names>T</given-names></name><name><surname>Saxe</surname><given-names>A</given-names></name><name><surname>Summerfield</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Orthogonal representations for robust context-dependent task performance in brains and neural networks</article-title><source>Neuron</source><volume>110</volume><fpage>1258</fpage><lpage>1270</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2022.01.005</pub-id><pub-id pub-id-type="pmid">35085492</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Freedman</surname><given-names>D J</given-names></name><name><surname>Riesenhuber</surname><given-names>M</given-names></name><name><surname>Poggio</surname><given-names>T</given-names></name><name><surname>Miller</surname><given-names>EK</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Categorical representation of visual stimuli in the primate prefrontal cortex</article-title><source>Science</source><volume>291</volume><fpage>312</fpage><lpage>316</lpage><pub-id pub-id-type="doi">10.1126/science.291.5502.312</pub-id><pub-id pub-id-type="pmid">11209083</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Freedman</surname><given-names>DJ</given-names></name><name><surname>Assad</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Experience-dependent representation of visual categories in parietal cortex</article-title><source>Nature</source><volume>443</volume><fpage>85</fpage><lpage>88</lpage><pub-id pub-id-type="doi">10.1038/nature05078</pub-id><pub-id pub-id-type="pmid">16936716</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Freedman</surname><given-names>DJ</given-names></name><name><surname>Miller</surname><given-names>EK</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Neural mechanisms of visual categorization: insights from neurophysiology</article-title><source>Neuroscience and Biobehavioral Reviews</source><volume>32</volume><fpage>311</fpage><lpage>329</lpage><pub-id pub-id-type="doi">10.1016/j.neubiorev.2007.07.011</pub-id><pub-id pub-id-type="pmid">17950874</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ganguli</surname><given-names>S</given-names></name><name><surname>Bisley</surname><given-names>JW</given-names></name><name><surname>Roitman</surname><given-names>JD</given-names></name><name><surname>Shadlen</surname><given-names>MN</given-names></name><name><surname>Goldberg</surname><given-names>ME</given-names></name><name><surname>Miller</surname><given-names>KD</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>One-Dimensional dynamics of attention and decision making in lip</article-title><source>Neuron</source><volume>58</volume><fpage>15</fpage><lpage>25</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2008.01.038</pub-id><pub-id pub-id-type="pmid">18400159</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geiger</surname><given-names>M</given-names></name><name><surname>Spigler</surname><given-names>S</given-names></name><name><surname>Jacot</surname><given-names>A</given-names></name><name><surname>Wyart</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Disentangling feature and lazy training in deep neural networks</article-title><source>Journal of Statistical Mechanics</source><volume>2020</volume><elocation-id>113301</elocation-id><pub-id pub-id-type="doi">10.1088/1742-5468/abc4de</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glickfeld</surname><given-names>LL</given-names></name><name><surname>Andermann</surname><given-names>ML</given-names></name><name><surname>Bonin</surname><given-names>V</given-names></name><name><surname>Reid</surname><given-names>RC</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Cortico-cortical projections in mouse visual cortex are functionally target specific</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>219</fpage><lpage>226</lpage><pub-id pub-id-type="doi">10.1038/nn.3300</pub-id><pub-id pub-id-type="pmid">23292681</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goltstein</surname><given-names>PM</given-names></name><name><surname>Reinert</surname><given-names>S</given-names></name><name><surname>Bonhoeffer</surname><given-names>T</given-names></name><name><surname>Hübener</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Mouse visual cortex areas represent perceptual and semantic features of learned visual categories</article-title><source>Nature Neuroscience</source><volume>24</volume><fpage>1441</fpage><lpage>1451</lpage><pub-id pub-id-type="doi">10.1038/s41593-021-00914-5</pub-id><pub-id pub-id-type="pmid">34545249</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Gschwend</surname><given-names>O</given-names></name><name><surname>Yang</surname><given-names>T</given-names></name><name><surname>van de Lisdonk</surname><given-names>D</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Sharma</surname><given-names>R</given-names></name><name><surname>Li</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Prefrontal Top-down Projections Control Context-Dependent Strategy Selection</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.12.14.472559</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hirokawa</surname><given-names>J</given-names></name><name><surname>Vaughan</surname><given-names>A</given-names></name><name><surname>Masset</surname><given-names>P</given-names></name><name><surname>Ott</surname><given-names>T</given-names></name><name><surname>Kepecs</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Frontal cortex neuron types categorically encode single decision variables</article-title><source>Nature</source><volume>576</volume><fpage>446</fpage><lpage>451</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-1816-9</pub-id><pub-id pub-id-type="pmid">31801999</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>W</given-names></name><name><surname>Xiao</surname><given-names>L</given-names></name><name><surname>Adlam</surname><given-names>B</given-names></name><name><surname>Pennington</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The surprising simplicity of the early-time learning dynamics of neural networks</article-title><conf-name>Advances in Neural Information Processing Systems</conf-name><fpage>17116</fpage><lpage>17128</lpage></element-citation></ref><ref id="bib31"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>J</given-names></name><name><surname>Yau</surname><given-names>HT</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Dynamics of deep neural networks and neural tangent hierarchy</article-title><conf-name>ICML</conf-name><fpage>4542</fpage><lpage>4551</lpage></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hubel</surname><given-names>DH</given-names></name><name><surname>Wiesel</surname><given-names>TN</given-names></name></person-group><year iso-8601-date="1962">1962</year><article-title>Receptive fields, binocular interaction and functional architecture in the cat’s visual cortex</article-title><source>The Journal of Physiology</source><volume>160</volume><fpage>106</fpage><lpage>154</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1962.sp006837</pub-id><pub-id pub-id-type="pmid">14449617</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hui</surname><given-names>L</given-names></name><name><surname>Belkin</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2021">2021</year><source>Evaluation of Neural Architectures Trained with Square Loss vs Cross-Entropy in Classification Tasks</source><publisher-name>ICLR</publisher-name></element-citation></ref><ref id="bib34"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Jacot</surname><given-names>A</given-names></name><name><surname>Gabriel</surname><given-names>F</given-names></name><name><surname>Hongler</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Neural tangent kernel: convergence and generalization in neural networks</article-title><conf-name>Advances in Neural Information Processing Systems</conf-name><fpage>8571</fpage><lpage>8580</lpage></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kell</surname><given-names>AJE</given-names></name><name><surname>Yamins</surname><given-names>DLK</given-names></name><name><surname>Shook</surname><given-names>EN</given-names></name><name><surname>Norman-Haignere</surname><given-names>SV</given-names></name><name><surname>McDermott</surname><given-names>JH</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A task-optimized neural network replicates human auditory behavior, predicts brain responses, and reveals a cortical processing hierarchy</article-title><source>Neuron</source><volume>98</volume><fpage>630</fpage><lpage>644</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.03.044</pub-id><pub-id pub-id-type="pmid">29681533</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Latimer</surname><given-names>KW</given-names></name><name><surname>Freedman</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Low-Dimensional Encoding of Decisions in Parietal Cortex Reflects Long-Term Training History</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.10.07.463576</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>LeCun</surname><given-names>Y</given-names></name><name><surname>Bengio</surname><given-names>Y</given-names></name><name><surname>Hinton</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Deep learning</article-title><source>Nature</source><volume>521</volume><fpage>436</fpage><lpage>444</lpage><pub-id pub-id-type="doi">10.1038/nature14539</pub-id><pub-id pub-id-type="pmid">26017442</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>J</given-names></name><name><surname>Xiao</surname><given-names>L</given-names></name><name><surname>Schoenholz</surname><given-names>S</given-names></name><name><surname>Bahri</surname><given-names>Y</given-names></name><name><surname>Novak</surname><given-names>R</given-names></name><name><surname>Sohl-Dickstein</surname><given-names>J</given-names></name><name><surname>Pennington</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Wide neural networks of any depth evolve as linear models under gradient descent</article-title><conf-name>Advances in Neural Information Processing Systems</conf-name><fpage>8572</fpage><lpage>8583</lpage></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Q</given-names></name><name><surname>Sompolinsky</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Statistical mechanics of deep linear neural networks: the backpropagating kernel renormalization</article-title><source>Physical Review X</source><volume>11</volume><elocation-id>031059</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevX.11.031059</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lillicrap</surname><given-names>TP</given-names></name><name><surname>Cownden</surname><given-names>D</given-names></name><name><surname>Tweed</surname><given-names>DB</given-names></name><name><surname>Akerman</surname><given-names>CJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Random synaptic feedback weights support error backpropagation for deep learning</article-title><source>Nature Communications</source><volume>7</volume><elocation-id>13276</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms13276</pub-id><pub-id pub-id-type="pmid">27824044</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Litwin-Kumar</surname><given-names>A</given-names></name><name><surname>Harris</surname><given-names>KD</given-names></name><name><surname>Axel</surname><given-names>R</given-names></name><name><surname>Sompolinsky</surname><given-names>H</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Optimal degrees of synaptic connectivity</article-title><source>Neuron</source><volume>93</volume><fpage>1153</fpage><lpage>1164</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.01.030</pub-id><pub-id pub-id-type="pmid">28215558</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>C</given-names></name><name><surname>Zhu</surname><given-names>L</given-names></name><name><surname>Belkin</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>On the linearity of large non-linear models: when and why the tangent kernel is constant</article-title><conf-name>Advances in Neural Information Processing Systems</conf-name><fpage>15954</fpage><lpage>15964</lpage></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mante</surname><given-names>V</given-names></name><name><surname>Sussillo</surname><given-names>D</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name><name><surname>Newsome</surname><given-names>WT</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Context-Dependent computation by recurrent dynamics in prefrontal cortex</article-title><source>Nature</source><volume>503</volume><fpage>78</fpage><lpage>84</lpage><pub-id pub-id-type="doi">10.1038/nature12742</pub-id><pub-id pub-id-type="pmid">24201281</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mastrogiuseppe</surname><given-names>F</given-names></name><name><surname>Ostojic</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A geometrical analysis of global stability in trained feedback networks</article-title><source>Neural Computation</source><volume>31</volume><fpage>1139</fpage><lpage>1182</lpage><pub-id pub-id-type="doi">10.1162/neco_a_01187</pub-id><pub-id pub-id-type="pmid">30979353</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Mastrogiuseppe</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>EvolutionActivity</data-title><version designator="swh:1:rev:a6b7e083ac6d306599b5c29005dc6aa499e2209a">swh:1:rev:a6b7e083ac6d306599b5c29005dc6aa499e2209a</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:bfb0d590c10a14465a5007746fa1d2fa78698e43;origin=https://github.com/fmastrogiuseppe/EvolutionActivity;visit=swh:1:snp:6ce7a15b74d24a2090715d2b9213091e3dc7e434;anchor=swh:1:rev:a6b7e083ac6d306599b5c29005dc6aa499e2209a">https://archive.softwareheritage.org/swh:1:dir:bfb0d590c10a14465a5007746fa1d2fa78698e43;origin=https://github.com/fmastrogiuseppe/EvolutionActivity;visit=swh:1:snp:6ce7a15b74d24a2090715d2b9213091e3dc7e434;anchor=swh:1:rev:a6b7e083ac6d306599b5c29005dc6aa499e2209a</ext-link></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKenzie</surname><given-names>S</given-names></name><name><surname>Frank</surname><given-names>AJ</given-names></name><name><surname>Kinsky</surname><given-names>NR</given-names></name><name><surname>Porter</surname><given-names>B</given-names></name><name><surname>Rivière</surname><given-names>PD</given-names></name><name><surname>Eichenbaum</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Hippocampal representation of related and opposing memories develop within distinct, hierarchically organized neural schemas</article-title><source>Neuron</source><volume>83</volume><fpage>202</fpage><lpage>215</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.05.019</pub-id><pub-id pub-id-type="pmid">24910078</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mei</surname><given-names>S</given-names></name><name><surname>Montanari</surname><given-names>A</given-names></name><name><surname>Nguyen</surname><given-names>PM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A mean field view of the landscape of two-layer neural networks</article-title><source>PNAS</source><volume>115</volume><fpage>E7665</fpage><lpage>E7671</lpage><pub-id pub-id-type="doi">10.1073/pnas.1806579115</pub-id><pub-id pub-id-type="pmid">30054315</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Messinger</surname><given-names>A</given-names></name><name><surname>Squire</surname><given-names>LR</given-names></name><name><surname>Zola</surname><given-names>SM</given-names></name><name><surname>Albright</surname><given-names>TD</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Neuronal representations of stimulus associations develop in the temporal lobe during learning</article-title><source>PNAS</source><volume>98</volume><fpage>12239</fpage><lpage>12244</lpage><pub-id pub-id-type="doi">10.1073/pnas.211431098</pub-id><pub-id pub-id-type="pmid">11572946</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Min</surname><given-names>B</given-names></name><name><surname>Bliss</surname><given-names>DP</given-names></name><name><surname>Sarma</surname><given-names>A</given-names></name><name><surname>Freedman</surname><given-names>DJ</given-names></name><name><surname>Wang</surname><given-names>XJ</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A Neural Circuit Mechanism of Categorical Perception: Top-down Signaling in the Primate Cortex</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.06.15.151506</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Moroshko</surname><given-names>E</given-names></name><name><surname>Woodworth</surname><given-names>B</given-names></name><name><surname>Gunasekar</surname><given-names>S</given-names></name><name><surname>Lee</surname><given-names>J</given-names></name><name><surname>Srebro</surname><given-names>N</given-names></name><name><surname>Soudry</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Implicit bias in deep linear classification: initialization scale vs training accuracy</article-title><conf-name>Advances in Neural Information Processing Systems</conf-name><fpage>22182</fpage><lpage>22193</lpage></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olshausen</surname><given-names>BA</given-names></name><name><surname>Field</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Sparse coding of sensory inputs</article-title><source>Current Opinion in Neurobiology</source><volume>14</volume><fpage>481</fpage><lpage>487</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2004.07.007</pub-id><pub-id pub-id-type="pmid">15321069</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pannunzi</surname><given-names>M</given-names></name><name><surname>Gigante</surname><given-names>G</given-names></name><name><surname>Mattia</surname><given-names>M</given-names></name><name><surname>Deco</surname><given-names>G</given-names></name><name><surname>Fusi</surname><given-names>S</given-names></name><name><surname>Del Giudice</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Learning selective top-down control enhances performance in a visual categorization task</article-title><source>Journal of Neurophysiology</source><volume>108</volume><fpage>3124</fpage><lpage>3137</lpage><pub-id pub-id-type="doi">10.1152/jn.00208.2012</pub-id><pub-id pub-id-type="pmid">22972954</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Papyan</surname><given-names>V</given-names></name><name><surname>Han</surname><given-names>XY</given-names></name><name><surname>Donoho</surname><given-names>DL</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Prevalence of neural collapse during the terminal phase of deep learning training</article-title><source>PNAS</source><volume>117</volume><fpage>24652</fpage><lpage>24663</lpage><pub-id pub-id-type="doi">10.1073/pnas.2015509117</pub-id><pub-id pub-id-type="pmid">32958680</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Payeur</surname><given-names>A</given-names></name><name><surname>Guerguiev</surname><given-names>J</given-names></name><name><surname>Zenke</surname><given-names>F</given-names></name><name><surname>Richards</surname><given-names>BA</given-names></name><name><surname>Naud</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Burst-Dependent synaptic plasticity can coordinate learning in hierarchical circuits</article-title><source>Nature Neuroscience</source><volume>24</volume><fpage>1010</fpage><lpage>1019</lpage><pub-id pub-id-type="doi">10.1038/s41593-021-00857-x</pub-id><pub-id pub-id-type="pmid">33986551</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Pogodin</surname><given-names>R</given-names></name><name><surname>Latham</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Kernelized information bottleneck leads to biologically plausible 3-factor hebbian learning in deep networks</article-title><conf-name>Advances in Neural Information Processing Systems</conf-name><fpage>7296</fpage><lpage>7307</lpage></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reinert</surname><given-names>S</given-names></name><name><surname>Hübener</surname><given-names>M</given-names></name><name><surname>Bonhoeffer</surname><given-names>T</given-names></name><name><surname>Goltstein</surname><given-names>PM</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Mouse prefrontal cortex represents learned rules for categorization</article-title><source>Nature</source><volume>593</volume><fpage>411</fpage><lpage>417</lpage><pub-id pub-id-type="doi">10.1038/s41586-021-03452-z</pub-id><pub-id pub-id-type="pmid">33883745</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Richards</surname><given-names>BA</given-names></name><name><surname>Lillicrap</surname><given-names>TP</given-names></name><name><surname>Beaudoin</surname><given-names>P</given-names></name><name><surname>Bengio</surname><given-names>Y</given-names></name><name><surname>Bogacz</surname><given-names>R</given-names></name><name><surname>Christensen</surname><given-names>A</given-names></name><name><surname>Clopath</surname><given-names>C</given-names></name><name><surname>Costa</surname><given-names>RP</given-names></name><name><surname>de Berker</surname><given-names>A</given-names></name><name><surname>Ganguli</surname><given-names>S</given-names></name><name><surname>Gillon</surname><given-names>CJ</given-names></name><name><surname>Hafner</surname><given-names>D</given-names></name><name><surname>Kepecs</surname><given-names>A</given-names></name><name><surname>Kriegeskorte</surname><given-names>N</given-names></name><name><surname>Latham</surname><given-names>P</given-names></name><name><surname>Lindsay</surname><given-names>GW</given-names></name><name><surname>Miller</surname><given-names>KD</given-names></name><name><surname>Naud</surname><given-names>R</given-names></name><name><surname>Pack</surname><given-names>CC</given-names></name><name><surname>Poirazi</surname><given-names>P</given-names></name><name><surname>Roelfsema</surname><given-names>P</given-names></name><name><surname>Sacramento</surname><given-names>J</given-names></name><name><surname>Saxe</surname><given-names>A</given-names></name><name><surname>Scellier</surname><given-names>B</given-names></name><name><surname>Schapiro</surname><given-names>AC</given-names></name><name><surname>Senn</surname><given-names>W</given-names></name><name><surname>Wayne</surname><given-names>G</given-names></name><name><surname>Yamins</surname><given-names>D</given-names></name><name><surname>Zenke</surname><given-names>F</given-names></name><name><surname>Zylberberg</surname><given-names>J</given-names></name><name><surname>Therien</surname><given-names>D</given-names></name><name><surname>Kording</surname><given-names>KP</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A deep learning framework for neuroscience</article-title><source>Nature Neuroscience</source><volume>22</volume><fpage>1761</fpage><lpage>1770</lpage><pub-id pub-id-type="doi">10.1038/s41593-019-0520-2</pub-id><pub-id pub-id-type="pmid">31659335</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rigotti</surname><given-names>M</given-names></name><name><surname>Barak</surname><given-names>O</given-names></name><name><surname>Warden</surname><given-names>MR</given-names></name><name><surname>Wang</surname><given-names>XJ</given-names></name><name><surname>Daw</surname><given-names>ND</given-names></name><name><surname>Miller</surname><given-names>EK</given-names></name><name><surname>Fusi</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The importance of mixed selectivity in complex cognitive tasks</article-title><source>Nature</source><volume>497</volume><fpage>585</fpage><lpage>590</lpage><pub-id pub-id-type="doi">10.1038/nature12160</pub-id><pub-id pub-id-type="pmid">23685452</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosenblatt</surname><given-names>F</given-names></name></person-group><year iso-8601-date="1958">1958</year><article-title>The perceptron: a probabilistic model for information storage and organization in the brain</article-title><source>Psychological Review</source><volume>65</volume><fpage>386</fpage><lpage>408</lpage><pub-id pub-id-type="doi">10.1037/h0042519</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roy</surname><given-names>JE</given-names></name><name><surname>Riesenhuber</surname><given-names>M</given-names></name><name><surname>Poggio</surname><given-names>T</given-names></name><name><surname>Miller</surname><given-names>EK</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Prefrontal cortex activity during flexible categorization</article-title><source>The Journal of Neuroscience</source><volume>30</volume><fpage>8519</fpage><lpage>8528</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4837-09.2010</pub-id><pub-id pub-id-type="pmid">20573899</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Sacramento</surname><given-names>J</given-names></name><name><surname>Ponte Costa</surname><given-names>R</given-names></name><name><surname>Bengio</surname><given-names>Y</given-names></name><name><surname>Senn</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Dendritic cortical microcircuits approximate the backpropagation algorithm</article-title><conf-name>Advances in Neural Information Processing Systems</conf-name><fpage>8721</fpage><lpage>8732</lpage></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saxe</surname><given-names>AM</given-names></name><name><surname>McClelland</surname><given-names>JL</given-names></name><name><surname>Ganguli</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A mathematical theory of semantic development in deep neural networks</article-title><source>PNAS</source><volume>116</volume><fpage>11537</fpage><lpage>11546</lpage><pub-id pub-id-type="doi">10.1073/pnas.1820226116</pub-id><pub-id pub-id-type="pmid">31101713</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Schuessler</surname><given-names>F</given-names></name><name><surname>Mastrogiuseppe</surname><given-names>F</given-names></name><name><surname>Dubreuil</surname><given-names>A</given-names></name><name><surname>Ostojic</surname><given-names>S</given-names></name><name><surname>Barak</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The interplay between randomness and structure during learning in rnns</article-title><conf-name>Advances in Neural Information Processing Systems</conf-name><fpage>13352</fpage><lpage>13362</lpage></element-citation></ref><ref id="bib64"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Song</surname><given-names>G</given-names></name><name><surname>Xu</surname><given-names>R</given-names></name><name><surname>Lafferty.</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Convergence and alignment of gradient descent with random backpropagation weights</article-title><conf-name>Advances in Neural Information Processing Systems</conf-name><fpage>13352</fpage><lpage>13362</lpage></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steinmetz</surname><given-names>NA</given-names></name><name><surname>Aydin</surname><given-names>C</given-names></name><name><surname>Lebedeva</surname><given-names>A</given-names></name><name><surname>Okun</surname><given-names>M</given-names></name><name><surname>Pachitariu</surname><given-names>M</given-names></name><name><surname>Bauza</surname><given-names>M</given-names></name><name><surname>Beau</surname><given-names>M</given-names></name><name><surname>Bhagat</surname><given-names>J</given-names></name><name><surname>Böhm</surname><given-names>C</given-names></name><name><surname>Broux</surname><given-names>M</given-names></name><name><surname>Chen</surname><given-names>S</given-names></name><name><surname>Colonell</surname><given-names>J</given-names></name><name><surname>Gardner</surname><given-names>RJ</given-names></name><name><surname>Karsh</surname><given-names>B</given-names></name><name><surname>Kloosterman</surname><given-names>F</given-names></name><name><surname>Kostadinov</surname><given-names>D</given-names></name><name><surname>Mora-Lopez</surname><given-names>C</given-names></name><name><surname>O’Callaghan</surname><given-names>J</given-names></name><name><surname>Park</surname><given-names>J</given-names></name><name><surname>Putzeys</surname><given-names>J</given-names></name><name><surname>Sauerbrei</surname><given-names>B</given-names></name><name><surname>van Daal</surname><given-names>RJJ</given-names></name><name><surname>Vollan</surname><given-names>AZ</given-names></name><name><surname>Wang</surname><given-names>S</given-names></name><name><surname>Welkenhuysen</surname><given-names>M</given-names></name><name><surname>Ye</surname><given-names>Z</given-names></name><name><surname>Dudman</surname><given-names>JT</given-names></name><name><surname>Dutta</surname><given-names>B</given-names></name><name><surname>Hantman</surname><given-names>AW</given-names></name><name><surname>Harris</surname><given-names>KD</given-names></name><name><surname>Lee</surname><given-names>AK</given-names></name><name><surname>Moser</surname><given-names>EI</given-names></name><name><surname>O’Keefe</surname><given-names>J</given-names></name><name><surname>Renart</surname><given-names>A</given-names></name><name><surname>Svoboda</surname><given-names>K</given-names></name><name><surname>Häusser</surname><given-names>M</given-names></name><name><surname>Haesler</surname><given-names>S</given-names></name><name><surname>Carandini</surname><given-names>M</given-names></name><name><surname>Harris</surname><given-names>TD</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Neuropixels 2.0: a miniaturized high-density probe for stable, long-term brain recordings</article-title><source>Science</source><volume>372</volume><elocation-id>eabf4588</elocation-id><pub-id pub-id-type="doi">10.1126/science.abf4588</pub-id><pub-id pub-id-type="pmid">33859006</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stoet</surname><given-names>G</given-names></name><name><surname>Snyder</surname><given-names>LH</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Single neurons in posterior parietal cortex of monkeys encode cognitive set</article-title><source>Neuron</source><volume>42</volume><fpage>1003</fpage><lpage>1012</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2004.06.003</pub-id><pub-id pub-id-type="pmid">15207244</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Summerfield</surname><given-names>C</given-names></name><name><surname>Luyckx</surname><given-names>F</given-names></name><name><surname>Sheahan</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Structure learning and the posterior parietal cortex</article-title><source>Progress in Neurobiology</source><volume>184</volume><elocation-id>101717</elocation-id><pub-id pub-id-type="doi">10.1016/j.pneurobio.2019.101717</pub-id><pub-id pub-id-type="pmid">31669186</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Susman</surname><given-names>L</given-names></name><name><surname>Mastrogiuseppe</surname><given-names>F</given-names></name><name><surname>Brenner</surname><given-names>N</given-names></name><name><surname>Barak</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Quality of internal representation shapes learning performance in feedback neural networks</article-title><source>Physical Review Research</source><volume>3</volume><elocation-id>013176</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevResearch.3.013176</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Villagrasa</surname><given-names>F</given-names></name><name><surname>Baladron</surname><given-names>J</given-names></name><name><surname>Vitay</surname><given-names>J</given-names></name><name><surname>Schroll</surname><given-names>H</given-names></name><name><surname>Antzoulatos</surname><given-names>EG</given-names></name><name><surname>Miller</surname><given-names>EK</given-names></name><name><surname>Hamker</surname><given-names>FH</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>On the role of cortex-basal ganglia interactions for category learning: a neurocomputational approach</article-title><source>The Journal of Neuroscience</source><volume>38</volume><fpage>9551</fpage><lpage>9562</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0874-18.2018</pub-id><pub-id pub-id-type="pmid">30228231</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wallis</surname><given-names>JD</given-names></name><name><surname>Anderson</surname><given-names>KC</given-names></name><name><surname>Miller</surname><given-names>EK</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Single neurons in prefrontal cortex encode Abstract rules</article-title><source>Nature</source><volume>411</volume><fpage>953</fpage><lpage>956</lpage><pub-id pub-id-type="doi">10.1038/35082081</pub-id><pub-id pub-id-type="pmid">11418860</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>White</surname><given-names>IM</given-names></name><name><surname>Wise</surname><given-names>SP</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Rule-dependent neuronal activity in the prefrontal cortex</article-title><source>Experimental Brain Research</source><volume>126</volume><fpage>315</fpage><lpage>335</lpage><pub-id pub-id-type="doi">10.1007/s002210050740</pub-id><pub-id pub-id-type="pmid">10382618</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Whittington</surname><given-names>JCR</given-names></name><name><surname>Bogacz</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>An approximation of the error backpropagation algorithm in a predictive coding network with local Hebbian synaptic plasticity</article-title><source>Neural Computation</source><volume>29</volume><fpage>1229</fpage><lpage>1262</lpage><pub-id pub-id-type="doi">10.1162/NECO_a_00949</pub-id><pub-id pub-id-type="pmid">28333583</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Whittington</surname><given-names>JCR</given-names></name><name><surname>Bogacz</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Theories of error back-propagation in the brain</article-title><source>Trends in Cognitive Sciences</source><volume>23</volume><fpage>235</fpage><lpage>250</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2018.12.005</pub-id><pub-id pub-id-type="pmid">30704969</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yamins</surname><given-names>DLK</given-names></name><name><surname>DiCarlo</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Using goal-driven deep learning models to understand sensory cortex</article-title><source>Nature Neuroscience</source><volume>19</volume><fpage>356</fpage><lpage>365</lpage><pub-id pub-id-type="doi">10.1038/nn.4244</pub-id><pub-id pub-id-type="pmid">26906502</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>G</given-names></name><name><surname>Hu</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Feature Learning in Infinite-Width Neural Networks</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/2011.14522">https://arxiv.org/abs/2011.14522</ext-link></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>W</given-names></name><name><surname>Tipparaju</surname><given-names>SL</given-names></name><name><surname>Chen</surname><given-names>G</given-names></name><name><surname>Li</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Thalamus-driven functional populations in frontal cortex support decision-making</article-title><source>Nature Neuroscience</source><volume>25</volume><fpage>1339</fpage><lpage>1352</lpage><pub-id pub-id-type="doi">10.1038/s41593-022-01171-w</pub-id><pub-id pub-id-type="pmid">36171427</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ye</surname><given-names>L</given-names></name><name><surname>Allen</surname><given-names>WE</given-names></name><name><surname>Thompson</surname><given-names>KR</given-names></name><name><surname>Tian</surname><given-names>Q</given-names></name><name><surname>Hsueh</surname><given-names>B</given-names></name><name><surname>Ramakrishnan</surname><given-names>C</given-names></name><name><surname>Wang</surname><given-names>A-C</given-names></name><name><surname>Jennings</surname><given-names>JH</given-names></name><name><surname>Adhikari</surname><given-names>A</given-names></name><name><surname>Halpern</surname><given-names>CH</given-names></name><name><surname>Witten</surname><given-names>IB</given-names></name><name><surname>Barth</surname><given-names>AL</given-names></name><name><surname>Luo</surname><given-names>L</given-names></name><name><surname>McNab</surname><given-names>JA</given-names></name><name><surname>Deisseroth</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Wiring and molecular features of prefrontal ensembles representing distinct experiences</article-title><source>Cell</source><volume>165</volume><fpage>1776</fpage><lpage>1788</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2016.05.010</pub-id><pub-id pub-id-type="pmid">27238022</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.79908.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Richards</surname><given-names>Blake A</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01pxwe438</institution-id><institution>McGill University</institution></institution-wrap><country>Canada</country></aff></contrib></contrib-group><related-object id="sa0ro1" object-id-type="id" object-id="10.1101/2022.01.29.478317" link-type="continued-by" xlink:href="https://sciety.org/articles/activity/10.1101/2022.01.29.478317"/></front-stub><body><p>The findings of the paper are very valuable for neuroscientists studying the learning of abstract representations. It provides compelling evidence that neural networks trained on two-way classification tasks will develop responses whose category and context selectivity profiles depend on key network details, such as neural activation functions and initial connectivity. These results can explain apparently contradictory results in the experimental literature, and make new experimental predictions for testing in the future.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.79908.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Richards</surname><given-names>Blake A</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01pxwe438</institution-id><institution>McGill University</institution></institution-wrap><country>Canada</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Hennequin</surname><given-names>Guillaume</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/013meh722</institution-id><institution>University of Cambridge</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2022.01.29.478317">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2022.01.29.478317v1">the preprint</ext-link> for the benefit of readers; ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Evolution of neural activity in circuits bridging sensory and abstract knowledge&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 2 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Joshua Gold as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Guillaume Hennequin (Reviewer #1).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>1) Justification of some of the model choices that the reviewers asked about and discussion of how much the results depend on them (especially the use of gradient descent).</p><p>2) More intuitive explanations for some of the mathematical statements to help make the paper more accessible for the majority of <italic>eLife</italic> readers.</p><p>3) A longer discussion about how this paper fits into the current literature, and how it can be generalised.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>We do have a couple of concerns which we would recommend adding some discussion about:</p><p>1. We found it strange that authors operationalised what are essentially (binary) classification tasks as regression problems; although the network output is pushed through a sigmoidal nonlinearity with a [0--1] range, here this output is never interpreted as a class probability; indeed, instead of maximizing the cross-entropy loss (i.e. maximising the data likelihood) as is normally done in such a context, the authors chose to minimise a squared error loss; this forced them to introduce somewhat arbitrary &quot;target&quot; outputs (0.25 and 0.75) for the two categories. Several questions arise from this odd choice:</p><p>a) why did the authors do that? (e.g. is this standard in the NTK literature?)</p><p>b) do the results depend on this choice? robustness to this choice is not a priori obvious to us, because the network is not regularised here (see point 2 below), and learning operates in the vastly overparameterised regime where the cross-entropy loss may (does?) not even have a minimum, so weights could diverge. We suspect this may be the answer to (a), but it would be great to discuss this briefly.</p><p>2. The paper does not consider generalisation at all, and indeed the tasks studied here are set up in a way that does not even allow thinking about generalisation; the inputs are chosen completely randomly, as opposed to randomly on some category-specific manifold that could be re-sampled, so it is not even clear how a test set would be constructed. Is this an issue? Does that limit the relevance of this study to only a subset of previously studied relevant neuroscience tasks? Again it would be great to discuss.</p><p>3. It was not clear to us how much of the results presented here depend on doing gradient descent, as opposed to more generally minimising the loss? This question was apparently already asked as &quot;Comment 2&quot; in the first round of reviews but we found that the rebuttal did not really answer it, beyond saying that solutions are degenerate.</p><p>4. After l311, would it be possible to give the intuition for the emergence of context selectivity, in a couple of sentences? The text currently says that it is a &quot;signature of gradient descent&quot; and that the &quot;mechanism is described in detail in Methods 5.6&quot;, but we wonder if the authors could be a bit more specific without getting too technical. It is important because the emergence of context selectivity is the most unexpected of the results presented here.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>– The methods section seems very long to me, maybe too long for a general audience. I would strongly suggest focusing on the details and derivations that are necessary to reproduce the results and to understand the main findings. The rest (as beautiful as it is), I would put in the supplementary material (if <italic>eLife</italic> allows for it).</p><p>– Do you need both u and w to be plastic? Have you tried to keep one set fixed? Is the system underdetermined? You show how the cat or ctx selectivity depends on the ratio of learning rates but I am not completely sure which set of weights is the crucial one or let's say the dominant one that is strictly necessary to get the results.</p><p>– I am a bit confused how you implemented the context. The stimulus and the context are linearly combined to yield the total sensory input x. But from the perspective of the network that is not different from the simple task. The network sees an input vector x. Whether x is a vector representing the stimulus alone or the stimulus and a context is indistinguishable to the network. Is the difference here that the stimuli were random and orthogonal and if they are linearly combined with another set that is random and orthogonal, the resulting vectors do not necessarily share the same properties? Maybe I misunderstand something here. Would be great if you could clarify that and maybe highlight the differences in the text.</p><p>– Maybe worth discussing in the Discussion (these are merely suggestions, I don't expect the authors to run simulations on that):</p><p>– comment on limitations and – if possible – how you envision your results to change (or hold) in E/I networks (that abide by Dale's principle) and/or recurrent connections are included.</p><p>– How strongly depend the results (or which results) on the gradient descent you used?</p><p>– How would the results generalise to more than 2 categories? And what is with the option „unclassified&quot; (no mapping possible).</p><p>– I assume each neuron in x is projecting to all neurons in y. Is this clearly stated somewhere? Maybe I missed it – sorry it is hot today!</p><p>– After learning, cat selectivity, and later ctx selectivity, cover a broad range with many neurons being close to zero and some showing positive selectivity. However, most of them are still unselective it seems. Is this range in line with experimental results? Could you comment on this heterogeneity? In line 95/96 you say that the cat selectivity increases for EACH neuron but to me it seems some neurons remain at zero selectivity, do I read the figure wrong?</p><p>– The distribution of the cat selectivity between the two tasks is different. The cat selectivity for the context-dependent task has many cells with a selectivity close to zero or even negative. Could you comment on that. I apologise if I overlooked it.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.79908.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>Reviewer #1 (Recommendations for the authors):</p><p>We do have a couple of concerns which we would recommend adding some discussion about:</p><p>1. We found it strange that authors operationalised what are essentially (binary) classification tasks as regression problems; although the network output is pushed through a sigmoidal nonlinearity with a [0--1] range, here this output is never interpreted as a class probability; indeed, instead of maximizing the cross-entropy loss (i.e. maximising the data likelihood) as is normally done in such a context, the authors chose to minimise a squared error loss; this forced them to introduce somewhat arbitrary &quot;target&quot; outputs (0.25 and 0.75) for the two categories. Several questions arise from this odd choice:</p><p>a) why did the authors do that? (e.g. is this standard in the NTK literature?)</p><p>b) do the results depend on this choice? robustness to this choice is not a priori obvious to us, because the network is not regularised here (see point 2 below), and learning operates in the vastly overparameterised regime where the cross-entropy loss may (does?) not even have a minimum, so weights could diverge. We suspect this may be the answer to (a), but it would be great to discuss this briefly.</p></disp-quote><p>The reviewer is correct. We focused on the mean squared error loss because, in our setup, it simplifies the analysis. With such a loss, we can assume that the learning process converges to a zero-loss minimum; this allows us to derive closed-form expressions for activity at convergence. Using the cross-entropy loss would result instead in diverging weights. Classical NTK work (Lee et al., 2019) has showed that, during such divergence process, the accuracy of the NTK approximation gradually deteriorates (which is expected, because weights changes are no longer small). We now write in the Discussion:</p><p>(line 647) “To model categorization, we assumed a quadratic function for the error E (Methods Circuit) – an assumption that effectively casts our categorization tasks into a regression problem. This made9 the model amenable to mathematical analysis, and allowed us to derive transparent equations to characterize activity evolution. Recent machine learning work has showed that, at least in some categorization setups (Hui and Belkin, 2021), a cross-entropy function might result in better learning performance. The mathematical framework used here is, however, not well suited to studying networks with such an error function (Lee et al., 2019). Investigating whether and how our findings extend to networks trained with a cross-entropy error function represents an interesting direction for future work.”</p><disp-quote content-type="editor-comment"><p>2. The paper does not consider generalisation at all, and indeed the tasks studied here are set up in a way that does not even allow thinking about generalisation; the inputs are chosen completely randomly, as opposed to randomly on some category-specific manifold that could be re-sampled, so it is not even clear how a test set would be constructed. Is this an issue? Does that limit the relevance of this study to only a subset of previously studied relevant neuroscience tasks? Again it would be great to discuss.</p></disp-quote><p>As the reviewer says, the goal of this work was to model neuroscience tasks that do not focus on generalization. Nevertheless, there is a large body of machine learning work (e.g. Canatar et al., 2021) addressing generalization in the learning regime we investigate here (NTK). We thus expect to be able to extend our work to include generalization. We now write in the Discussion:</p><p>(line 632) “Throughout this work, we focused on two simplified categorization tasks, aimed at capturing the fundamental features of the categorization tasks commonly used in systems neuroscience (Freedman and Assad, 2006; Fitzgerald et al., 2011; Wallis et al., 2001). The mathematical framework we developed to analyze those tasks could, however, easily be extended in several directions, including tasks with more than two categories (Fitzgerald et al., 2011; Reinert et al., 2021; Mante et al., 2013) and tasks involving generalization to unseen stimuli (Barak et al., 2013; Canatar et al., 2021).”</p><disp-quote content-type="editor-comment"><p>3. It was not clear to us how much of the results presented here depend on doing gradient descent, as opposed to more generally minimising the loss? This question was apparently already asked as &quot;Comment 2&quot; in the first round of reviews but we found that the rebuttal did not really answer it, beyond saying that solutions are degenerate.</p></disp-quote><p>The requirement of bringing the loss to zero does not imply any of the results discussed in this paper. This is clearly exemplified by models with fixed intermediate connectivity <italic>u</italic> (see, e.g. Barak et al. 2013, Babadi and Sompolinsky, 2014), which can bring the loss to zero in both our tasks without displaying any change in activity at all. It is also easy to imagine other scenarios where the loss is minimized, but our results do not apply (for example: a circuit model implementing the simple task by aligning activity with changes in the readout vector ∆<italic>w</italic>, rather than its initial value <italic>w</italic><sub>0</sub>; this would invalidate subsequent findings, Figures 4 and 5).</p><p>As neural representations are not heavily constrained by loss minimization, they provide a tool to investigate the underlying learning algorithm. We believe it is specifically important to study representations induced by gradient descent because there is now large evidence that this algorithm performs well, within multi-layer brain-like architectures, on both simple and complex tasks. The experimental predictions we obtained here for gradient descent should be contrasted with predictions from other algorithms. In the Discussion, we highlight differences with models with fixed intermediate connectivity (Barak et al. 2013, Babadi and Sompolinsky, 2014), and reward-modulated Hebbian plasticity (Engel et al., 2015). It will be also important to consider, in future research, other forms of gradient-descent, and learning algorithms that provide biologically-plausible approximations to it. A first step in this direction was taken very recently by Bordelan and Pehlevan, 2022.</p><p>We have added more comments on this theme to the Discussion. We now write:</p><p>(line 588) “A number of recent theoretical studies have proposed biologically-plausible architectures and plasticity rules that can approximate back-propagation on simple and complex tasks (Lillicrap et al., 2016; Sacramento et al., 2018; Akrout et al., 2019; Whittington and Bogacz, 2017; Payeur et al., 2021; Pogodin and Latham, 2020; Boopathy and Fiete, 2022). Understanding whether these different implementations lead to differences in activity represents a very important direction for future research. Interestingly, recent work has showed that it is possible to design circuit models where the learning dynamics is identical to the one studied in this work, but the architecture is biologically plausible (Boopathy and Fiete, 2022). We expect our results to directly translate to those models. Other biologically-plausible setups might be characterized, instead, by different activity evolution. Recent work (Song et al., 2021; Bordelon and Pehlevan, 2022) made use of a formalism similar to ours to describe learning dynamics induced by a number of different biologically-plausible algorithms and uncovered non-trivial, qualitatively different dynamics. Whether any of these dynamics leads to different neural representations in neuroscience inspired categorization tasks like the ones we studied here is an open, and compelling, question.”</p><disp-quote content-type="editor-comment"><p>4. After l311, would it be possible to give the intuition for the emergence of context selectivity, in a couple of sentences? The text currently says that it is a &quot;signature of gradient descent&quot; and that the &quot;mechanism is described in detail in Methods 5.6&quot;, but we wonder if the authors could be a bit more specific without getting too technical. It is important because the emergence of context selectivity is the most unexpected of the results presented here.</p></disp-quote><p>A technically-sound explaination would require, at least, knowledge of Equation 120 from Methods, which we believe is too involved for the main text. We have added a quite simplified version of that explaination.</p><p>We now write:</p><p>(line 437) “Such novel structure is a signature of the gradient-descent learning rule used by the circuit (Canatar et al., 2021). The mechanism through which context clustering emerges is described in detail in Methods Detailed analysis of context selectivity. But, roughly speaking, context clustering emerges because, for a pair of sensory inputs, how similarly their intermediate-layer representations evolve during learning is determined both by their target category and their correlations (Equation 27, Methods Evolution of connectivity and activity in large circuits). In the simple task, initial correlations were virtually nonexistent (Figure 2C), and thus activity changes were specified only by category; in the context-depend task, initial correlations have structure (Figure 6C), and that structure critically affects neural representations. In particular, inputs with the same context tend to be relatively correlated, and those are also likely to be associated with the same category; their representations are thus clustered by the learning algorithm, resulting in context clustering.”</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>– The methods section seems very long to me, maybe too long for a general audience. I would strongly suggest focusing on the details and derivations that are necessary to reproduce the results and to understand the main findings. The rest (as beautiful as it is), I would put in the supplementary material (if eLife allows for it).</p></disp-quote><p>Unfortunately, <italic>eLife</italic> does not allow for supplementary material. We will ask the Editors to maintain the table of contents in place. Hopefully, that will help – so readers can pick and choose what they want to look at. We agree that the current Methods section is very long (and we really wish we could have made it shorter!). But it’s not just the length that makes it unsuitable for a general audience, it’s also the math. And we believe that shortening the latter would make the paper even less readable.</p><disp-quote content-type="editor-comment"><p>– Do you need both u and w to be plastic? Have you tried to keep one set fixed? Is the system underdetermined? You show how the cat or ctx selectivity depends on the ratio of learning rates but I am not completely sure which set of weights is the crucial one or let's say the dominant one that is strictly necessary to get the results.</p></disp-quote><p>When either <italic>u</italic> or <italic>w</italic> are fixed, the network can learn our tasks. When <italic>u</italic> is fixed (<italic>η<sub>u</sub></italic> = 0), the intermediate layer representations do not change. This model has been studied before (e.g. Barak et al. 2013 or Babadi and Sompolinsky 2014, and random features models in machine learning). Its main limitations are that (i) it cannot be used to model learning-induced activity changes in the brain; (ii) it performs poorly on complex machine-learning tasks. In this work, we consider circuit models where <italic>u</italic> does change (all values of <italic>η<sub>w</sub></italic> and <italic>η<sub>u</sub></italic> with <italic>η<sub>u</sub></italic> 6 = 0); in all those cases, intermediate layer representations do change. Our results indicate that category and context selectivity emerge for all values of <italic>η<sub>w</sub></italic> and <italic>η<sub>u</sub></italic>, including <italic>η<sub>w</sub></italic> = 0 (which corresponds to the case when <italic>w</italic> is fixed).</p><disp-quote content-type="editor-comment"><p>– I am a bit confused how you implemented the context. The stimulus and the context are linearly combined to yield the total sensory input x. But from the perspective of the network that is not different from the simple task. The network sees an input vector x. Whether x is a vector representing the stimulus alone or the stimulus and a context is indistinguishable to the network. Is the difference here that the stimuli were random and orthogonal and if they are linearly combined with another set that is random and orthogonal, the resulting vectors do not necessarily share the same properties? Maybe I misunderstand something here. Would be great if you could clarify that and maybe highlight the differences in the text.</p></disp-quote><p>The reviewer is correct. The crucial difference between the two tasks is that now input vectors across different trials are no longer random and orthogonal (and thus uncorrelated). Consider, for example, two trials in which the stimulus part of the input is the same but the context cues are different. The network has to learn that, even though the stimulus vectors are identical (and so the input vectors look very similar overall!), the output can be different (different output category for the same stimulus in two different contexts). This computation (which reduces to the classic XOR task in the case of two stimuli and context cues) is notoriously hard for neural networks. To implement it, a hidden layer with non-linear activation functions is strictly required (in contrast to the simple task, which could be implemented even without hidden layer).</p><p>We have expanded the description of the context-dependent task in the main text by adding:</p><p>(line 348) “This task is computationally much more involved than the previous one, primarily because context induces nontrivial correlational structure: in the simple task, all sensory input vectors were uncorrelated; in the context-dependent task, that is no longer true. For instance, two sensory inputs with the same stimulus and different context cues are highly correlated. In spite of this high correlation, though, they can belong to different categories (when context cues are associated with different contexts). In contrast, two sensory inputs with different stimuli and different context cues are uncorrelated, but they can belong to the same category. From a mathematical point of view, this correlational structure makes sensory input vectors non linearly-separable. This is in stark contrast to the simple task, for which sensory input vectors were linearly-separable (Barak et al., 2013).”</p><disp-quote content-type="editor-comment"><p>– Maybe worth discussing in the Discussion (these are merely suggestions, I don't expect the authors to run simulations on that):</p><p>– comment on limitations and – if possible – how you envision your results to change (or hold) in E/I networks (that abide by Dale's principle) and/or recurrent connections are included.</p><p>– How strongly depend the results (or which results) on the gradient descent you used?</p><p>– How would the results generalise to more than 2 categories? And what is with the option „unclassified&quot; (no mapping possible).</p></disp-quote><p>We have expanded the Discussion to comment on those aspects. We now write:</p><p>(line 632) “Throughout this work, we focused on two simplified categorization tasks, aimed at capturing the fundamental features of the categorization tasks commonly used in systems neuroscience (Freedman and Assad, 2006; Fitzgerald et al., 2011; Wallis et al., 2001). The mathematical framework we developed to analyze those tasks could, however, easily be extended in several directions, including tasks with more than two categories (Fitzgerald et al., 2011; Reinert et al., 2021; Mante et al., 2013) and tasks involving generalization to unseen stimuli (Barak et al., 2013; Canatar et al., 2021). An important feature missing in our tasks, though, is memory: neuroscience tasks usually involve a delay period during which the representation of the output category must be sustained in the absence of sensory inputs (Freedman and Assad, 2006; Fitzgerald et al., 2011; Wallis et al., 2001). Experiments indicate that category representations are different in the stimulus presentation and the delay periods (Freedman and Assad, 2006). Investigating these effects in our tasks would require the addition of recurrent connectivity to the model. Mathematical tools for analyzing learning dynamics in recurrent networks is starting to become available (Mastrogiuseppe and Ostojic, 2019; Schuessler et al., 2020; Dubreuil et al., 2022; Susman et al., 2021), which could allow our analysis to be extended in that direction.”</p><p>And</p><p>(line 656) “Finally, in this study we focused on a circuit model with a single intermediate layer. In the brain,in contrast, sensory inputs are processed across a number of stages within the cortical hierarchy. Our analysis could easily be extended to include multiple intermediate layers. That would allow our predictions to be extended to experiments involving multi-area recordings, which are increasingly common in the field (Goltstein et al., 2021). Current recording techniques, furthermore, allow monitoring neural activity throughout the learning process (Reinert et al., 2021; Goltstein et al., 2021); those data could be used in future studies to further test the applicability of our model.”</p><p>And</p><p>(line 588) “A number of recent theoretical studies have proposed biologically-plausible architectures and plasticity rules that can approximate back-propagation on simple and complex tasks (Lillicrap et al., 2016; Sacramento et al., 2018; Akrout et al., 2019; Whittington and Bogacz, 2017; Payeur et al., 2021; Pogodin and Latham, 2020; Boopathy and Fiete, 2022). Understanding whether these different implementations lead to differences in activity represents a very important direction for future research. Interestingly, recent work has showed that it is possible to design circuit models where the learning dynamics is identical to the one studied in this work, but the architecture is biologically plausible (Boopathy and Fiete, 2022). We expect our results to directly translate to those models. Other biologically-plausible setups might be characterized, instead, by different activity evolution. Recent work (Song et al., 2021; Bordelon and Pehlevan, 2022) made use of a formalism similar to ours to describe learning dynamics induced by a number of different biologically-plausible algorithms and uncovered non-trivial, qualitatively different dynamics. Whether any of these dynamics leads to different neural representations in neuroscienceinspired categorization tasks like the ones we studied here is an open, and compelling, question.”</p><disp-quote content-type="editor-comment"><p>– I assume each neuron in x is projecting to all neurons in y. Is this clearly stated somewhere? Maybe I missed it – sorry it is hot today!</p></disp-quote><p>The reviewer is correct. We now specify it (“all-to-all”) in the model description.</p><disp-quote content-type="editor-comment"><p>– After learning, cat selectivity, and later ctx selectivity, cover a broad range with many neurons being close to zero and some showing positive selectivity. However, most of them are still unselective it seems. Is this range in line with experimental results? Could you comment on this heterogeneity? In line 95/96 you say that the cat selectivity increases for EACH neuron but to me it seems some neurons remain at zero selectivity, do I read the figure wrong?</p></disp-quote><p>The theory predicts that, in the simple task, category selectivity increases for all neurons (as long as the number of neurons and stimuli is sufficiently large). This increase, however, can be very small – depending on the magnitude of the initial readout, <italic>w</italic><sub>0<italic>,i</italic></sub> (Equation 65). Since, in our model, <italic>w</italic><sub>0<italic>,i</italic></sub> is drawn from a centered Gaussian distribution, the selectivity increase is small for many neurons.</p><p>It is also true, however, that in finite-size simulations selectivity does not increase strictly for all the neurons (one can think of finite size as a small “noise” term on top of the theory prediction). We thus modified “each” in the main text into “most”.</p><p>Concerning heterogeneity: as mentioned in the text (line 218), experimental data display strong heterogeneity as well (see, e.g. Figure 3c of Freedman and Assad, 2006 and Figure 2f of Reinart et al., 2021). Linking the strength of selectivity increase to the strength of projections to the readout neuron, our model proposes a possible mechanism for the presence of such heterogeneity.</p><disp-quote content-type="editor-comment"><p>– The distribution of the cat selectivity between the two tasks is different. The cat selectivity for the context-dependent task has many cells with a selectivity close to zero or even negative. Could you comment on that. I apologise if I overlooked it.</p></disp-quote><p>We have added</p><p>“Note that the distribution of category selectivity values is different from the distribution observed in the simple task; the distribution is now heavy-tailed, with only a fraction of the neurons acquiring strong category selectivity (see also Figure 8B).”</p></body></sub-article></article>