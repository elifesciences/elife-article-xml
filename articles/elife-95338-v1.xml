<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">95338</article-id><article-id pub-id-type="doi">10.7554/eLife.95338</article-id><article-id pub-id-type="doi" specific-use="version">10.7554/eLife.95338.3</article-id><article-version article-version-type="publication-state">version of record</article-version><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Cancer Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>High-density sampling reveals volume growth in human tumours</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Angaji</surname><given-names>Arman</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Owusu</surname><given-names>Michel</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Velling</surname><given-names>Christoph</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="pa1">†</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Dick</surname><given-names>Nicola</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Weghorn</surname><given-names>Donate</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7722-8618</contrib-id><email>dweghorn@crg.eu</email><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund6"/><xref ref-type="other" rid="fund7"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Berg</surname><given-names>Johannes</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6569-3061</contrib-id><email>bergj@uni-koeln.de</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00rcxh774</institution-id><institution>Institute for Biological Physics, University of Cologne</institution></institution-wrap><addr-line><named-content content-type="city">Cologne</named-content></addr-line><country>Germany</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03wyzt892</institution-id><institution>Centre for Genomic Regulation</institution></institution-wrap><addr-line><named-content content-type="city">Barcelona</named-content></addr-line><country>Spain</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04n0g0b29</institution-id><institution>Universitat Pompeu Fabra</institution></institution-wrap><addr-line><named-content content-type="city">Barcelona</named-content></addr-line><country>Spain</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Flegg</surname><given-names>Jennifer</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01ej9dk98</institution-id><institution>The University of Melbourne</institution></institution-wrap><country>Australia</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>El-Deiry</surname><given-names>Wafik S</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05gq02987</institution-id><institution>Brown University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="present-address" id="pa1"><label>†</label><p>Kishony lab, Faculty of Biology, Technion, Haifa, Israel</p></fn></author-notes><pub-date publication-format="electronic" date-type="publication"><day>26</day><month>11</month><year>2024</year></pub-date><volume>13</volume><elocation-id>RP95338</elocation-id><history><date date-type="sent-for-review" iso-8601-date="2024-02-08"><day>08</day><month>02</month><year>2024</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint.</event-desc><date date-type="preprint" iso-8601-date="2023-12-10"><day>10</day><month>12</month><year>2023</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.12.10.570995"/></event><event><event-desc>This manuscript was published as a reviewed preprint.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-05-09"><day>09</day><month>05</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.95338.1"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-10-03"><day>03</day><month>10</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.95338.2"/></event></pub-history><permissions><copyright-statement>© 2024, Angaji et al</copyright-statement><copyright-year>2024</copyright-year><copyright-holder>Angaji et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-95338-v1.pdf"/><abstract><p>In growing cell populations such as tumours, mutations can serve as markers that allow tracking the past evolution from current samples. The genomic analyses of bulk samples and samples from multiple regions have shed light on the evolutionary forces acting on tumours. However, little is known empirically on the spatio-temporal dynamics of tumour evolution. Here, we leverage published data from resected hepatocellular carcinomas, each with several hundred samples taken in two and three dimensions. Using spatial metrics of evolution, we find that tumour cells grow predominantly uniformly within the tumour volume instead of at the surface. We determine how mutations and cells are dispersed throughout the tumour and how cell death contributes to the overall tumour growth. Our methods shed light on the early evolution of tumours in vivo and can be applied to high-resolution data in the emerging field of spatial biology.</p></abstract><abstract abstract-type="plain-language-summary"><title>eLife digest</title><p>Our bodies are made up of organs and tissues, which, in turn, are made up of individual cells. Normally, different types of cells in a tissue perform distinct roles, working together to keep the tissue healthy and functioning properly.</p><p>However, a genetic mutation that makes them divide and grow uncontrollably can cause tumors to from. As the tumor grows, its cells can undergo further mutations. Each new mutation can serve as a ‘marker’, allowing scientists to track how a tumor has grown, by looking at which cells have specific mutations.</p><p>Angaji et al. wanted to know if tumors grow through cells on the surface dividing more quickly and invading surrounding tissue; or if all cells in and across the tumor divide at the same rate.</p><p>To answer this question, the researchers used high-resolution data looking at where in a tumor mutations accumulate. The experiments examined the early evolution of a tumor because only early mutations resulted in enough detectable cells through sequencing. The researchers then compared these 'tumor maps' to simulations of tumors growing in different ways, to see which growth mode fit the maps better.</p><p>Angaji et al. found that the tumors they looked at grew uniformly across the tumor volume. They also established that the overall growth of the tumor was slow compared to the rate of growth predicted by the speed of the cells dividing. This means that the development of a tumor is finely balanced between net growth and shrinkage, and a small change in the external conditions could potentially kill a tumor.</p><p>Angaji et al. have developed methods that will allow us to better track tumor growth, and provide further insights into cancer biology. These high-resolution tumor maps may provide clues about how to treat different types of tumors depending on how they grow.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>tumour samples</kwd><kwd>multi-region tumour samples</kwd><kwd>spatial genomics</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id><institution>Deutsche Forschungsgemeinschaft</institution></institution-wrap></funding-source><award-id>SFB1310/2 - 325931972</award-id><principal-award-recipient><name><surname>Berg</surname><given-names>Johannes</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004837</institution-id><institution>Spanish Ministry of Science and Innovation</institution></institution-wrap></funding-source><award-id>CEX2020-001049-S</award-id><principal-award-recipient><name><surname>Weghorn</surname><given-names>Donate</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002428</institution-id><institution>FWF Austrian Science Fund</institution></institution-wrap></funding-source><award-id award-id-type="doi">10.55776/J4366</award-id><principal-award-recipient><name><surname>Owusu</surname><given-names>Michel</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002809</institution-id><institution>Generalitat de Catalunya</institution></institution-wrap></funding-source><award-id>CERCA programme</award-id><principal-award-recipient><name><surname>Weghorn</surname><given-names>Donate</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004837</institution-id><institution>Spanish Ministry of Science and Innovation</institution></institution-wrap></funding-source><award-id>MCIN/AEI /10.13039/50110001</award-id><principal-award-recipient><name><surname>Weghorn</surname><given-names>Donate</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004837</institution-id><institution>Spanish Ministry of Science and Innovation</institution></institution-wrap></funding-source><award-id>PGC2018-100941-A-I00</award-id><principal-award-recipient><name><surname>Weghorn</surname><given-names>Donate</given-names></name></principal-award-recipient></award-group><award-group id="fund7"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004837</institution-id><institution>Spanish Ministry of Science and Innovation</institution></institution-wrap></funding-source><award-id>PID2021-128976NB-I001033</award-id><principal-award-recipient><name><surname>Weghorn</surname><given-names>Donate</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Spatial genomics reveals the mode of evolution of a tumour based on the positions of mutations in high-resolution samples.</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>publishing-route</meta-name><meta-value>prc</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The evolution of a solid tumour is governed by the division, motion, and death of cancer cells. Genetic mutations arising during cell divisions can serve as cell markers to track this dynamics. From the observed spatial distribution of mutations, it should in principle be possible to infer the spatio-temporal principles of tumour evolution: Is the growth rate uniform across the tumour, or does growth predominantly take place near the edge of the tumour? What is the interplay between the tissue dynamics of the tumour and its genetic evolution? These broad modes of tumour evolution affect for instance the signature of neutral evolution, the response to selection, or the number of low-frequency mutants which can confer therapy resistance (<xref ref-type="bibr" rid="bib66">Waclaw et al., 2015</xref>; <xref ref-type="bibr" rid="bib13">Chkhaidze et al., 2019</xref>).</p><p>However, to answer such questions on the basis of genetic tumour data is challenging because only partial information is available: (i) The sequencing depth (average number of reads covering a nucleotide in NGS sequencing) is finite. This means that only high-frequency mutations are observed. (ii) Usually only a small number of samples are taken from different parts of a solid tumour, which limits the information on mutations present in the full tumour (<xref ref-type="bibr" rid="bib20">Gerlinger et al., 2012</xref>; <xref ref-type="bibr" rid="bib40">McGranahan and Swanton, 2015</xref>). (iii) Longitudinal data from ctDNA measurements are highly limited in the observable range of mutations and provide noisy frequency estimates.</p><p>Over the next years, some of these restrictions will be lifted by the advent of spatial genomics (<xref ref-type="bibr" rid="bib61">Takei et al., 2021</xref>; <xref ref-type="bibr" rid="bib73">Zhao et al., 2022</xref>; <xref ref-type="bibr" rid="bib35">Lomakin et al., 2021</xref>). These techniques allow assaying the genomic information almost at single-cell level in intact tissue sections. Currently, the attainable sequencing depth is too low to identify point mutations across different parts of the tumour. However, it is clear that the coming-of-age of spatial genomics will bring new opportunities to understand the past evolution of a population of tumour cells from a late-stage snapshot. This implies a need for new tools to analyse spatio-temporal evolution, since standard tools of population genetics, like the site-frequency spectrum, are designed for spatially mixed populations and disregard spatial information.</p><p>One particular question concerns two different modes in which a tumour can grow; surface growth and volume growth. Under surface growth, the cancer cells divide predominantly at the border with healthy tissue. The potential reasons for this spatial dependence include higher nutrient levels near normal tissue, higher levels of metabolic waste products in the tumour bulk, or mechanical stress in the tumour centre (<xref ref-type="bibr" rid="bib50">Shraiman, 2005</xref>; <xref ref-type="bibr" rid="bib44">Montel et al., 2011</xref>). A faster growth rate at the edge of the tumour leads to a radially outward growth of the cell population. The surface growth mode is well-known from bacterial growth (<xref ref-type="bibr" rid="bib23">Hallatschek et al., 2007</xref>). In tumours, some evidence for surface growth comes from histological stainings, which show an enhanced level of the Ki-67 protein (a cellular marker for proliferation) near a tumour surface (<xref ref-type="bibr" rid="bib9">Brú et al., 2003</xref>; <xref ref-type="bibr" rid="bib66">Waclaw et al., 2015</xref>; <xref ref-type="bibr" rid="bib26">Hoefflin et al., 2016</xref>). However, the reverse situation has been found as well (<xref ref-type="bibr" rid="bib73">Zhao et al., 2022</xref>), with elevated Ki-67 levels near the centre of a renal carcinoma. The surface growth mode also has a long history in the modelling of tumour evolution (<xref ref-type="bibr" rid="bib22">Greenspan, 1972</xref>; <xref ref-type="bibr" rid="bib67">Ward and King, 1997</xref>; <xref ref-type="bibr" rid="bib6">Baish and Jain, 2000</xref>; <xref ref-type="bibr" rid="bib21">González-García et al., 2002</xref>; <xref ref-type="bibr" rid="bib30">Komarova, 2006</xref>; <xref ref-type="bibr" rid="bib53">Sottoriva et al., 2010</xref>; <xref ref-type="bibr" rid="bib66">Waclaw et al., 2015</xref>; <xref ref-type="bibr" rid="bib54">Sottoriva et al., 2015</xref>; <xref ref-type="bibr" rid="bib28">Iwasaki and Innan, 2017</xref>; <xref ref-type="bibr" rid="bib59">Sun et al., 2017</xref>; <xref ref-type="bibr" rid="bib63">van der Heijden et al., 2019</xref>) and has been used to analyze multi-region tumour sequencing data (<xref ref-type="bibr" rid="bib54">Sottoriva et al., 2015</xref>; <xref ref-type="bibr" rid="bib59">Sun et al., 2017</xref>; <xref ref-type="bibr" rid="bib13">Chkhaidze et al., 2019</xref>; <xref ref-type="bibr" rid="bib51">Sinha et al., 2022</xref>; <xref ref-type="bibr" rid="bib33">Li et al., 2022</xref>; <xref ref-type="bibr" rid="bib46">Noble et al., 2022</xref>; <xref ref-type="bibr" rid="bib19">Fu et al., 2022</xref>).</p><p>In volume growth, on the other hand, cancer cells grow irrespective of their location in the tumour: although each cell has a physical location, and upon division its offspring is in a similar location, location does not affect cell division or death. Under volume growth, subclones can originate from any location in the tumour (<xref ref-type="bibr" rid="bib73">Zhao et al., 2022</xref>). As a result, under volume growth mutation frequencies evolve exactly in the same way they would do in a well-mixed population, even though the resulting tumour will generally be spatially heterogeneous (see below). Mixed population models have been used extensively to model all aspects of tumor evolution, from tumorigenesis to the formation of metastases and the response to therapy (<xref ref-type="bibr" rid="bib37">Luebeck and Moolgavkar, 2002</xref>; <xref ref-type="bibr" rid="bib42">Michor et al., 2004</xref>; <xref ref-type="bibr" rid="bib16">Durrett, 2013</xref>; <xref ref-type="bibr" rid="bib7">Bozic et al., 2013</xref>; <xref ref-type="bibr" rid="bib18">Foo and Michor, 2014</xref>; <xref ref-type="bibr" rid="bib24">Heyde et al., 2019</xref>). They also form the basis of almost all population-genetic approaches to analyzing tumour data (<xref ref-type="bibr" rid="bib5">Attolini et al., 2010</xref>; <xref ref-type="bibr" rid="bib70">Williams et al., 2016</xref>; <xref ref-type="bibr" rid="bib71">Williams et al., 2018</xref>).</p><p>To tell between these two different evolutionary dynamics, we use high-resolution data on the spatial distribution of mutations found in solid tumours. We use whole-exome mutation data obtained from hepatocellular carcinomas and published previously (<xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>; <xref ref-type="bibr" rid="bib33">Li et al., 2022</xref>). From these snapshots of late-stage tumours we infer how the tumours grew in earlier stages. To this end, we develop metrics of intra-tumour heterogeneity which leverage the information from the spatial position of all samples.</p></sec><sec id="s2" sec-type="methods"><title>Methods</title><sec id="s2-1"><title>Spatially resolved data</title><p>We analyze two datasets where large numbers of samples (&gt; 100) were taken from different hepatocellular tumours, once from a two-dimensional section (<xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>), and once from a three-dimensional microsampling (<xref ref-type="bibr" rid="bib33">Li et al., 2022</xref>).</p><p>In <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>, 285 samples of a planar section of a hepatocellular carcinoma of diameter 35mm were taken and analyzed. Each sample consisted of about 20,000 cells (<xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>) determined by cell counting. 23 of these samples were subjected to whole-exome sequencing (average read depth of 74 reads per nucleotide), and loci with mutations found in these 23 samples were probed by genotyping (by Sequenom and Sanger sequencing) in all 285 samples (<xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>). <xref ref-type="fig" rid="fig1">Figure 1A</xref> shows the positions of the samples and the mutations found at each position. The data thus effectively consist of a set of 285 samples at high spatial resolution, but with limited genomic information (genotyping), and a subset of 23 samples at high genomic resolution from whole-exome genomic sequencing, but limited spatial resolution. We reanalyzed the whole-exome data as described in Appendix 4.2. The genotyped data consists of 35 mutated loci. Calling variants jointly on all 23 whole-exome samples and filtering as described in Appendix 4.2 returned 217 mutated loci.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Multi-region sampling of a hepatocellular tumour and cell-based simulations.</title><p><bold>A</bold> shows the spatially resolved sequencing data of 285 samples of a hepatocellular carcinoma analyzed by <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>. Each sample is indicated by a small pie chart in which colors indicate specific mutations, and slice sizes indicate the mutation frequencies within each sample. The 23 samples highlighted by a black outline were also subjected to whole-exome sequencing. The samples form a honey-comb structure, because the tumour slice had been cut into four quadrants, see Fig S1 in <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>. (<bold>B and C</bold>) Results of a cell-based simulation in the surface growth mode (<bold>B</bold>) and the volume growth mode (<bold>C</bold>). In each case, 280 evenly spaced samples were taken from the population of 10000 cells of a 2D simulation, see text. The most frequent mutations are shown as in (<bold>A</bold>), superimposed on the structure of the simulated tumour.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-fig1-v1.tif"/></fig><p>In the second data set, <xref ref-type="bibr" rid="bib33">Li et al., 2022</xref>, samples were taken from multiple planar sections of two different hepatocellular tumours from the same patient. This gives a three-dimensional picture of the genetic heterogeneity of these tumours. 169 samples were taken from 11 sections of tumour T1, which was approximately of 20mm diameter, and 160 samples from 6 sections of tumour T2, which was of approximately of 15mm diameter. Each sample consisted of ca. 3200 cells. 16 (9) samples from T1 (T2) were whole-genome sequenced and the remainder genotyped using the Ampliseq method. Li et al. report 906 (564) mutations used for genotyping of T1 (T2), of which 563 (259) pass our filters.</p></sec><sec id="s2-2"><title>Computational model of volume and surface growth</title><p>We use an off-lattice cell-based model, well-known from simulations of tissue mechanics (<xref ref-type="bibr" rid="bib15">Drasdo and Höhme, 2005</xref>; <xref ref-type="bibr" rid="bib64">Van Liedekerke et al., 2019</xref>; <xref ref-type="bibr" rid="bib39">Malmi-Kakkada et al., 2018</xref>; <xref ref-type="bibr" rid="bib41">Metzcar et al., 2019</xref>), which we endow with mutations entering the population at a constant rate per cell division.</p><p>In this model, each tumour cell is described by a sphere centered on a particular point in 3D space or 2D space, as well as a genome. Each cell division introduces a new point adjacent to its parent in a random (uniformly distributed) direction, and each cell death removes a point. At division both mother and daughter cell can acquire mutations, the number of mutations is Poisson distributed with mean <inline-formula><mml:math id="inf1"><mml:mi>μ</mml:mi></mml:math></inline-formula>. The spheres are not allowed to overlap and can push one another out of the way to achieve this. This off-lattice approach differs from cellular automaton models of tumour growth, where cells occupy discrete lattice sites (<xref ref-type="bibr" rid="bib66">Waclaw et al., 2015</xref>; <xref ref-type="bibr" rid="bib13">Chkhaidze et al., 2019</xref>). Specifically, in off-lattice models like the one we use, cells can gradually push one another out of the way during growth, see below. Cells cannot move by themselves but as they divide overlaps are introduced and resolved by pushing the neighboring cells.</p><p>We implement the resolution of overlaps introduced by a cell division using a ‘width-first’ pushing-algorithm, where the immediate neighborhood of the newly placed cell is resolved first before proceeding to the new overlaps this step introduces. A fast search first identifies overlaps with the current cell in its close neighborhood. The cell then pushes its neighbor along their connecting axis only by the overlap plus a small margin which acts as a buffer and avoids many tiny recurring overlaps. The neighboring cell is then added to a queue for subsequent iterations. Neighborhoods are shuffled such that there is no particular order in which cells are pushed. After each overlapping cell in the neighborhood is pushed and added to the queue, the search for overlaps is repeated on the first cell in the queue, adding new pairs to the queue, which are in turn iteratively resolved until the queue is empty. Thereby each cell division can set off a cascade of rearrangements of cell positions. This level of microscopic detail of course comes at a computational cost. Using off-lattice cell-based modelling, population sizes of several ten thousand cells can be simulated, compared to billions of cells with a cellular automaton (<xref ref-type="bibr" rid="bib66">Waclaw et al., 2015</xref>).</p><p>In regions of high cancer cell density, the division rate may be reduced (for instance due to lack of nutrients, toxic metabolic products, or mechanical stress). We effectively encode such potential spatial effects in the rate at which individual cells divide: the cell division rate <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> depends on the local density of cells <inline-formula><mml:math id="inf3"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mrow><mml:mi>𝐫</mml:mi><mml:mo form="postfix" stretchy="false" lspace="0em" rspace="0em">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. For simplicity, we consider a division rate <inline-formula><mml:math id="inf4"><mml:mrow><mml:mi>b</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> which decreases in a straight line from <inline-formula><mml:math id="inf5"><mml:mrow><mml:mi>b</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf6"><mml:mrow><mml:mi>b</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, see Fig. S1. Setting <inline-formula><mml:math id="inf7"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math></inline-formula> leads to a constant division rate for all cells, irrespective of their local density. This growth mode is termed volume growth. Lower values of <inline-formula><mml:math id="inf8"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula> lead to an increased growth rate in parts of the tumour where the local density of cancer cell is low, and hence enhance the growth rate at the surface of the tumour relative to the bulk of the tumour. Surface growth is characterized by a <inline-formula><mml:math id="inf9"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula> equal to the density defined by the minimal cell distance. By changing <inline-formula><mml:math id="inf10"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula> one can thus tune the dynamics of this model continuously from volume to surface growth. To describe the genetic changes in the tumour, we use an infinite-sites model and a constant mutation rate per cell division. <xref ref-type="fig" rid="fig1">Figure 1B and C</xref> show the resulting tumor sections for the surface and volume growth mode, respectively.</p><p>For a detailed description of the model, its implementation and performance in comparison with variants of the kinetic Monte Carlo and pushing algorithms, see Appendix 1. The code is available as a Julia package at <ext-link ext-link-type="uri" xlink:href="https://github.com/aangaji/TumorGrowth">https://github.com/aangaji/TumorGrowth</ext-link> (copy archived at <xref ref-type="bibr" rid="bib4">Angaji, 2024</xref>).</p></sec></sec><sec id="s3" sec-type="results"><title>Results</title><sec id="s3-1"><title>Volume versus surface growth</title><p>Under surface growth, cells divide predominantly near the edge of a tumour. Under volume growth on the other hand, cells divide uniformly across the entire tumour mass. To distinguish these two modes in empirical data, we look at the angle between a line from the tumour centre to a parent clone and from the parent to their offspring, see <xref ref-type="fig" rid="fig2">Figure 2A</xref> and Appendix 2. Under surface growth, offspring tend to lie radially outward from their parents, leading to a distribution of these direction angles centered around zero. Under volume growth, cells divide isotropically, leading to a uniform distribution of angles. The distribution of direction angles is a model-independent metric, it does not rely on a particular model of cell dynamics, population dynamics or sampling. It is also robust against the presence of selected subclones: if a subclone grows isotropically from some point, but at an elevated rate, it will contribute to a flat distribution of angles like all other clones.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Relative position of mutants under different growth modes.</title><p>(<bold>A</bold>) The direction angle θ quantifies the direction of a new mutant clone relative to its parent clone. In this illustration, a new mutant clone indicated in blue appears and grows radially outward on a red parental background, resulting in an angle θ near zero. Each pair of cells indicated in red and blue contributes to the distribution of θ, with the statistical weight of each mutant clone adding to one (see Appendix 2). (<bold>B</bold>) The distribution of angles θ for different mutant clones found in the spatially-resolved data of <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>. The peaks at <inline-formula><mml:math id="inf11"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>≈</mml:mo><mml:mo form="prefix" stretchy="false">−</mml:mo><mml:msup><mml:mn>180</mml:mn><mml:mrow><mml:mspace width="0.1667em"/><mml:mi>deg</mml:mi><mml:mo>⁡</mml:mo></mml:mrow></mml:msup><mml:mo separator="true">,</mml:mo><mml:mo form="prefix" stretchy="false">−</mml:mo><mml:msup><mml:mn>90</mml:mn><mml:mrow><mml:mspace width="0.1667em"/><mml:mi>deg</mml:mi><mml:mo>⁡</mml:mo></mml:mrow></mml:msup><mml:mo separator="true">,</mml:mo><mml:msup><mml:mn>0</mml:mn><mml:mrow><mml:mi>deg</mml:mi><mml:mo>⁡</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> come from individual clones. The contributions from different clones to the distribution of angles is shown in <xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref>. (<bold>C and D</bold>) show the corresponding distribution of angles for numerical simulations. Subfigure <bold>C</bold> shows simulations of surface growth, resulting in a distribution of direction angles with a pronounced maximum near zero. Under volume growth (<bold>D</bold>) a nearly flat distribution is seen. For <bold>C and D</bold>, simulations were run in three dimensions with a maximum population size of 40,000 cells grown at division rate <inline-formula><mml:math id="inf12"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, a rate of cell death <inline-formula><mml:math id="inf13"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf14"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula> for surface and volume growth respectively, and a whole-exome mutation rate <inline-formula><mml:math id="inf15"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula> before taking a two-dimensional cross-section of 280 samples mimicking the sampling procedure in <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>. (The different death rates were chosen to make the extinction probabilities of the populations comparable for the two cases. Changing these rates did not affect the distributions of angles.).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-fig2-v1.tif"/></fig><p>In <xref ref-type="fig" rid="fig2">Figure 2B</xref> we show the distribution of direction angles found in the spatially resolved data of <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>. The empirical data clearly show a uniform distribution of the direction angle, and thus no evidence for radially outward growth caused by faster growth near the edge of the tumour. For comparison, we look at the distribution of direction angles in simulations of different growth modes. For surface growth, the histogram of direction angles shows a pronounced maximum at <inline-formula><mml:math id="inf16"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> produced by the radial outgrowth of clones (<xref ref-type="fig" rid="fig2">Figure 2C</xref>), in a simulation of volume growth, we find a flat distribution (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). These simulations were done with samples placed in the same positions as in the real tumour to eliminate effects from uneven sampling.</p><p>This result is corroborated by the average number of mutations of a clone as a function of its distance from the tumour centre. Under surface growth and neutral evolution, the number of cell divisions since tumorigenesis, and hence the number of mutations found in a cell, increases with distance from the tumour centre. However, we do not find this signature of surface growth in the tumour data. Instead, we find that the number of mutations at different distances from the centre is compatible with volume growth (see <xref ref-type="fig" rid="app3fig4">Appendix 3—figure 4</xref>).</p><p>Similarly, the dataset of <xref ref-type="bibr" rid="bib33">Li et al., 2022</xref> with three-dimensional sampling also shows the signature of volume growth, both in the distribution of direction angles (Appendix 2.2) and in the number of mutations as a function of distance from the tumour centre, see Appendix 3.3.</p><p>This result is at variance with a recent spatio-phylogenetic analysis performed by <xref ref-type="bibr" rid="bib32">Lewinsohn et al., 2023</xref>, which finds a signal of surface growth on the same data. In Appendix 3, we show that the findings of <xref ref-type="bibr" rid="bib32">Lewinsohn et al., 2023</xref> are compatible with volume growth; on artificially generated volume-growth data sampled like in Li et al., the algorithm used in <xref ref-type="bibr" rid="bib32">Lewinsohn et al., 2023</xref> also returns a spurious signal of surface growth.</p></sec><sec id="s3-2"><title>Spatial dispersion of cells</title><p>Another aspect where surface and volume growth lead to qualitatively different behaviour is the spatial dispersion of mutations. Cells carrying a particular mutation can in principle form a tightly spaced colony or be dispersed throughout the tumour mass, see <xref ref-type="fig" rid="fig3">Figure 3A</xref>. It turns out this dispersion of mutants differs between surface and volume growth.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Dispersion of mutations within the tumour.</title><p>(<bold>A</bold>) Cells with a particular mutation can form tight spatial clusters within a tumour (simulated example here: mutant shown in blue), or they can be more widely dispersed (mutant shown in red). We quantify the dispersion of a mutation using the dispersion parameter σ, see text and Appendix 4. In this illustrative example, the blue mutation has a small dispersion parameter <inline-formula><mml:math id="inf17"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>1.3</mml:mn></mml:mrow></mml:math></inline-formula>, the red one has <inline-formula><mml:math id="inf18"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>2.5</mml:mn></mml:mrow></mml:math></inline-formula>. (<bold>B</bold>) Histogram of the dispersion parameters σ across 217 mutations in the whole-exome data of <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>. The red line indicates the mean of the histogram. (<bold>C</bold>) and (<bold>D</bold>) show the corresponding histograms for simulations of surface growth and volume growth, respectively. The simulations were run in 3D with populations grown up to 40,000 cells before taking 23 evenly spaced samples from a 2D cross-section. Only mutations with a whole-tumour frequency larger than 1/40 were considered, mimicking the limited sequencing resolution in the Ling et al. data. Simulation parameters were division rate <inline-formula><mml:math id="inf19"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, mutation rate <inline-formula><mml:math id="inf20"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula>, and death rates <inline-formula><mml:math id="inf21"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf22"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula> for surface growth and bulk growth, respectively.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-fig3-v1.tif"/></fig><p>To quantify the spatial dispersion of a mutation, we define the dispersion parameter σ: For a given mutation, we compute the average distance of all pairs of samples carrying that mutation and divide by the average distance these cells would have if they were arranged next to one another in a spherical shape (the tightest configuration possible). Values of σ much larger than one can arise when a mutation is scattered throughout the tumour, with many cells that do not carry that mutation located between cells that do. The dispersion σ can be estimated from mutation frequencies in the whole-exome sequencing data of <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>, see Appendix 4 for details.</p><p><xref ref-type="fig" rid="fig3">Figure 3B</xref> shows a histogram of the dispersion parameter σ for 217 mutations in the whole-exome sequencing data of <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>. We find an average value of the dispersion of approximately 3.5, but the values for specific mutations can be much higher than that (up to 9). <xref ref-type="fig" rid="fig3">Figure 3C and D</xref> show the corresponding distributions for simulations of volume and surface growth, respectively. The distribution of dispersion parameters found under volume growth agrees with that in the empirical data (Kolmogorov-Smirnov statistics 1.13), whereas surface growth generates lower values of the dispersion parameter (Kolmogorov-Smirnov statistics 5.74 indicating a poorer match with the empirical data, see Appendix 4.3 for details). Also in the three-dimensional dataset of <xref ref-type="bibr" rid="bib33">Li et al., 2022</xref>, we find higher values of the dispersion parameter than expected under surface growth (Appendix 4.4). However, the larger distances between samples in three dimensions, compared to the samples in a single plane, turn out to limit the accuracy with which the dispersion parameters can be computed. A higher number of samples would be needed to make the distances between samples comparable between the two- and three-dimensionally sampled data.</p><p>Volume growth offers a simple mechanism causing the dispersion of mutations: Tumour cells displace one another when new cells are born and grow. In this way, two cells which are initially close to one another and share a mutation can be pushed apart by the birth and growth of adjacent cells that do not share the mutation. The further apart a pair of cells becomes, the higher the probability that they will be moved even further apart due to the motion of the increasing number of cells between them. This amplification of initially small distances leads to an instability that can generate the large values of the dispersion σ found both in the data of <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref> and in numerical simulations of the volume growth model (<xref ref-type="fig" rid="fig3">Figure 3B and D</xref>, respectively). On the other hand, under surface growth, cells do not push each other apart, leading to lower values of the dispersion parameter. Also, high values of the dispersion parameter cannot arise spuriously due to positive selection, as selected clones would enter the population later than neutral ones (given the same final frequency), and thus do not have as much time to be moved within the tumour.</p><p>The dispersion of cells in a growing population via this pushing effect is well known in tissue mechanics (<xref ref-type="bibr" rid="bib48">Ranft et al., 2010</xref>; <xref ref-type="bibr" rid="bib39">Malmi-Kakkada et al., 2018</xref>). In the context of cancer, it provides a mechanism for the clonal mixing found by ultra-deep sequencing of multiple samples from a solid tumour (<xref ref-type="bibr" rid="bib54">Sottoriva et al., 2015</xref>; <xref ref-type="bibr" rid="bib60">Suzuki et al., 2017</xref>; <xref ref-type="bibr" rid="bib59">Sun et al., 2017</xref>), which leads to mutations that occur at high frequencies in some samples being present at low (but non-zero) frequencies in other samples. Dispersion and clonal mixing thus arise as a by-product of volume growth. This is in contrast to surface growth, where a specific dispersal mechanism has been postulated to account for the observed spatial distribution of mutations (<xref ref-type="bibr" rid="bib66">Waclaw et al., 2015</xref>).</p><p>To probe how this migration of cells between different regions of a tumour affects multi-region sampling, we look at the number of mutations detectable in a limited number of samples. Specifically, we consider the fraction of mutations present in a certain subset of samples (relative to the mutations appearing in all the samples taken together) and ask how this fraction is affected by migration. <xref ref-type="fig" rid="fig4">Figure 4A</xref> shows the fraction of mutations detectable in a given number of samples randomly picked from the 23 whole-exome samples of <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>. One finds that typically about 75% of all the mutations can be detected with only five samples. We repeat this analysis but do not count mutations in a sample that occur with a higher frequency in some other sample. The rationale is that these mutations have arisen elsewhere (where they are present at higher frequency) and have migrated into the sample, where they are now present at a lower frequency. With such mutations removed, five samples typically only contain about one-fifth of the mutations. This is in line with 5 samples representing only about one-fifth of the 23 whole-exome samples. Migration of cells thus makes a single sample capture a far larger share of the genetic variability than expected from its share of the sampled tumour volume and provides an a-posteriori rationale for assessing the genetic variation found in a tumour on the basis of only a few samples.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Rate of cell death and the mutation rate.</title><p>(<bold>A</bold>) We ask how a limited number of samples identify mutations. We pick a subset of the whole-exome sequenced samples of <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref> and plot the fraction of mutations present at least in one of these samples against the number of samples in the subset (red symbols, fractions are relative to the number of mutations present in at least one of the 23 samples. Mutations must be supported by at least 5 reads at a coverage of at least 150). The procedure is repeated (blue symbols) with those mutations removed that occur in some other sample with a higher frequency than the frequencies with which the mutation occurs in the subset of samples. Error bars indicate the range of the 95-percentile. (<bold>B</bold>) The schematic Muller plot shows how cell death leads to the loss of clones, some of which have extant offspring. Time runs on the horizontal axis, the vertical shows a number of different clones indicated by different colours. In the example shown here, the clone shown in light red becomes extinct, leaving behind its darker-shaded offspring clone with no parental clone. The rate of this loss of parental clones depends on the rate of cell death, and can be used for inference, see text. (<bold>C</bold>) shows the inferred rate of cell death and (<bold>D</bold>) the inferred rate of mutation per generation. The violin plots show how the inferred values vary when subsampling different fractions of all mutations and scaling the inferred mutation rate correspondingly, with the dashed lines indicating the mean inferred values. (The fraction of mutations sampled ranges from 0.5 to 0.9, with the results shown separately in Appendix 9).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-fig4-v1.tif"/></fig></sec><sec id="s3-3"><title>Cell turnover</title><p>At low rates of cell death, tumours grow nearly at the rate at which tumour cells divide. Higher rates of cell death slow down the net growth of the population and lead to a constant turnover of cells. The relative rates of cell birth and death have been studied in cell cultures since the classic work of <xref ref-type="bibr" rid="bib57">Steel, 1967</xref> using thymidine labelling. Also in cell cultures, live cell imaging has been used to track individual cell divisions (<xref ref-type="bibr" rid="bib36">Lorenzo et al., 2011</xref>). In the following, we use the genetic record in spatially resolved genomic data to probe the role of cell death in vivo during early tumour evolution.</p><p>Cell death removes cells, some of which have had offspring prior to death. This can lead to clones without extant parents (<xref ref-type="fig" rid="fig4">Figure 4B</xref>), and the rate at which such ‘orphan clones’ arise can be used to infer the rate of cell death. We consider two metrics which quantify how frequently parental cells are removed from the population by cell death. The clone turnover gives the fraction of genotypes whose parental genotype is no longer extant in the tumour. The clade turnover gives the fraction of clades that coincide with their ancestral clade. (A clade is defined by a given mutation. Without backmutations, it comprises all individuals carrying this mutation.) These two metrics depend on the rate of cell death (relative to the birth rate) and on the mutation rate per cell division. Increasing the rate of cell death increases both clade and clone turnover, whereas increasing the mutation rate leads to a larger clone turnover only. These relationships have been determined analytically for a simple model of a growing population (<xref ref-type="bibr" rid="bib3">Angaji et al., 2021</xref>). Inverting these relationships, the relative rate of cell death and the mutation rate can be determined from these metrics, see Appendix 5 and <xref ref-type="bibr" rid="bib3">Angaji et al., 2021</xref> for details and extensive tests.</p><p><xref ref-type="fig" rid="fig4">Figure 4C and D</xref> show the violin plots for the relative death rate and the mutation rate per cell division inferred in this way from the genotyped data of <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>. We find a rate of cell death nearly as high as the rate of birth (relative death rate 0.975 with 90% confidence interval [0.83, 0.995]). Hence during its early stage, the tumour was balanced nearly perfectly between growth and extinction. The inferred exome-wide mutation rate <inline-formula><mml:math id="inf23"><mml:mi>μ</mml:mi></mml:math></inline-formula> per cell division is 0.015 with 90% confidence interval [0.002, 0.1]. This result is at variance with a recent analysis based on the distribution of mutational distances between samples. <xref ref-type="bibr" rid="bib69">Werner et al., 2020</xref> find low rates of cell death across many cancer data sets. In Appendix 6, we show that this discrepancy arises because widely different rates of cell deaths are compatible with a given distribution of pairwise distances between samples.</p><p>To obtain the mutation rate per nucleotide, we need to divide <inline-formula><mml:math id="inf24"><mml:mi>μ</mml:mi></mml:math></inline-formula> by the effective genome size, that is the number of sites in the genome that could have acquired detectable mutations. For many sites only few or no reads are retrieved during sequencing, so dividing <inline-formula><mml:math id="inf25"><mml:mi>μ</mml:mi></mml:math></inline-formula> by the size of the whole exome would underestimate the mutation rate. Ling et al. apply a set of criteria to filter out sites with poor coverage (<xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>, SI): A site must have (1) a total coverage of more than 150 reads when summed over all samples, (2) at least one sample with a coverage of 10 reads or more, and (3) a coverage of 6 reads or more in the normal tissue sample. We find that <inline-formula><mml:math id="inf26"><mml:mrow><mml:mn>4.8</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> sites in the exome fulfill these criteria, and the resulting mutation rate estimate per nucleotide is <inline-formula><mml:math id="inf27"><mml:mrow><mml:mn>1.6</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo lspace="0em" rspace="0em">−</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> with 90% confidence interval <inline-formula><mml:math id="inf28"><mml:mrow><mml:mo fence="true" form="prefix">[</mml:mo><mml:mn>2</mml:mn><mml:mi>e</mml:mi><mml:mo>−</mml:mo><mml:mn>9</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>1</mml:mn><mml:mi>e</mml:mi><mml:mo>−</mml:mo><mml:mn>7</mml:mn><mml:mo fence="true" form="postfix">]</mml:mo></mml:mrow></mml:math></inline-formula>. This coincides with the result of <inline-formula><mml:math id="inf29"><mml:mrow><mml:mn>2.9</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo lspace="0em" rspace="0em">−</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> SNV per basepair and per generation found in a colon cancer cell line by lineage sequencing (<xref ref-type="bibr" rid="bib8">Brody et al., 2018</xref>). Comparing this result to a mutation rate estimate from a healthy human fibroblasts cell line of <inline-formula><mml:math id="inf30"><mml:mrow><mml:mn>2.7</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo lspace="0em" rspace="0em">−</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib43">Milholland et al., 2017</xref>), this would mean the tumour mutation rate was enhanced by a factor of 5. We note that the relatively small number of mutations in our data likely affects these estimates, and that analyses of larger datasets in the future may lead to more accurate results.</p></sec><sec id="s3-4"><title>Mutational signatures and temporal heterogeneity</title><p>Somatic mutations in cancer tumours are caused by different mutational processes, which can be identified by their mutational signatures (<xref ref-type="bibr" rid="bib1">Alexandrov et al., 2020</xref>). To investigate which processes were active in the tumours analysed here, we decomposed the mutational profiles of all three tumours into mutational signature components. <xref ref-type="fig" rid="fig5">Figure 5</xref> shows that the strongest signature in all tumours is the single-base-substitution signature 22 (SBS22). This signature has been associated with exposure to the exogenous mutagen aristolochic acid (<xref ref-type="bibr" rid="bib25">Hoang et al., 2013</xref>), a herbal component used in traditional Chinese medicine. (The cancer patients of the Ling et al. and Li et al. lived in China.) To ask if there is a pseudo-temporal heterogeneity in the mutational processes, we divided the mutations from each tumour into clonal (early) and subclonal (late) mutations. While the Li et al. tumours maintain similar mutational signatures over pseudo-time, we find that the exposure to aristolochic acid of the patient from Ling et al. appears to have ceased over the course of tumour evolution: while the mutational signature SBS22 dominates the clonal mutations, it is absent in the subclonal mutations, see <xref ref-type="fig" rid="fig5">Figure 5</xref>. The probability of not observing subclonal SBS22 due to sampling noise (p-value) was estimated to be less than 10<sup>−4</sup>, see Appendix 9.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Mutational signature decomposition.</title><p>Relative weights of single-base substitution (SBS) mutational signatures <xref ref-type="bibr" rid="bib8">Brody et al., 2018</xref> in all three tumours were derived with SigNet Refitter where possible (highlighted pie charts), otherwise with non-negative least squares (<xref ref-type="bibr" rid="bib1">Alexandrov et al., 2020</xref>) (Methods). (left) Ling et al., (centre) tumour T1 of Li et al., (right) tumour T2 of Li et al. Top: all mutations, bottom: mutations stratified by their clonality. Signature SBS22 is associated with exposure to aristolochic acid. In the Ling et al. data, this signature is prominent among clonal mutations, but absent in subclonal mutations. Also shown are signatures with relative weight larger than 1% and attributed to endogenous mutational processes (SBS5 and SBS40), tobacco smoking (SBS4) and a signature that resembles SBS22 (SBS25). All other signatures were combined into a single category (‘Others&quot;).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-fig5-v1.tif"/></fig></sec><sec id="s3-5"><title>Population size</title><p>The results on the mode of evolution, migration, and cell turnover characterize the early stages of the tumours analysed here. The reason is that in an exponentially growing population, late-stage mutations have frequencies too low to be detected: Under neutral evolution and neglecting fluctuations in clone sizes, the final frequency (in the entire population) of a mutation that arose when a tumour consisted of <inline-formula><mml:math id="inf31"><mml:mi>N</mml:mi></mml:math></inline-formula> cells is given by <inline-formula><mml:math id="inf32"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib16">Durrett, 2013</xref>). A lower limit on the frequency <inline-formula><mml:math id="inf33"><mml:mi>f</mml:mi></mml:math></inline-formula> thus corresponds to an upper limit on the population size. In order to determine the population size the tumour had when the mutations we analysed here arose, we generalize this result to include the effects of spatial sampling and stochastic population dynamics, see Appendix 7. The higher the spatial resolution, the lower the whole-tumour frequency of a detectable mutation can be. For this reason, a high spatial resolution means that late-coming (low frequency) mutations can be detected. We find that the mutations detected in the samples with high spatial resolution (surface growth/volume growth analysis and genetic turnover) arose when the tumour consisted of about 80,000 cells. The mutations in the whole-exome samples used to measure the dispersion of mutations arose when the tumour size was around 7000 cells.</p></sec></sec><sec id="s4" sec-type="discussion"><title>Discussion</title><sec id="s4-1"><title>Modes of tumour evolution</title><p>We have used genetic data taken from hepatocellular tumours at high spatial resolution (<xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>; <xref ref-type="bibr" rid="bib33">Li et al., 2022</xref>) to analyse the early evolution of a tumour in vivo. We are not the first to link spatial tumour sampling with evolution: on a larger spatial scale, phylogenetic comparison of samples from primary and metastatic tumours has elucidated the dynamics of metastasis (<xref ref-type="bibr" rid="bib29">Jones et al., 2008</xref>; <xref ref-type="bibr" rid="bib72">Zhao et al., 2016</xref>; <xref ref-type="bibr" rid="bib2">Alves et al., 2019</xref>; <xref ref-type="bibr" rid="bib27">Hu et al., 2020</xref>). Analyses of multiple samples from the same tumour have established intra-tumour heterogeneity and found neutral evolution in many cases (<xref ref-type="bibr" rid="bib20">Gerlinger et al., 2012</xref>; <xref ref-type="bibr" rid="bib54">Sottoriva et al., 2015</xref>; <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>; <xref ref-type="bibr" rid="bib70">Williams et al., 2016</xref>; <xref ref-type="bibr" rid="bib59">Sun et al., 2017</xref>; see <xref ref-type="bibr" rid="bib62">Tarabichi et al., 2018</xref> for a critique), as well as instances of selection (<xref ref-type="bibr" rid="bib71">Williams et al., 2018</xref>; <xref ref-type="bibr" rid="bib10">Caravagna et al., 2018</xref>). The mode of growth of a tumour affects the resulting genetic diversity of a tumour (<xref ref-type="bibr" rid="bib46">Noble et al., 2022</xref>; <xref ref-type="bibr" rid="bib19">Fu et al., 2022</xref>).</p><p>Here, we have used the spatial information contained in data based on hundreds of samples from single tumours. We found that the tumour evolved under uniform volume growth; there was no evidence of spatial constraints leading to radially outward growth. We also found a substantial turnover of cells with a rate of cell death comparable to the rate of cell division.</p><p>The rate of cell death being comparable to that of cell division implies that the tumour grew much more slowly than suggested by the rate of cell division. Instead, in its early stage, the tumour was balanced precariously between continued growth to macroscopic size and shrinkage: A small increase in the rate of cell death, or a small decrease in the growth rate would have caused the small net growth rate to become negative, possibly even leading to the extinction of the tumour.</p><p>The high spatial resolution also allows to track changes in the mutational processes over evolutionary time far more easily than in bulk data. Based on the high-resolution data of <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>, we found a drastic difference between the mutational signature of early and late mutations. In this data, the dominant mutational signature in early mutations is associated with an exogenous mutagen (aristolochic acid) found in herbal traditional Chinese medicine and thought to cause liver cancer (<xref ref-type="bibr" rid="bib45">Ng et al., 2017</xref>). This signature is absent in late mutations, compatible with a discontinued dose of the mutagen. In the data set of <xref ref-type="bibr" rid="bib33">Li et al., 2022</xref>, the same signature is dominant both in the early and late mutations, compatible with a continuous dose of the mutagen.</p></sec><sec id="s4-2"><title>Mutation dispersion and sampling</title><p>We have found mutations in the tumour that are widely dispersed throughout the tumour; as a result they can have low frequencies in one particular sample but high frequencies in other parts of the tumour. We find the same level of dispersal of mutations in off-lattice simulations of growing tissues, where it is due to cells pushing each other out of the way as a part of the growth process. Hence, cells that were initially adjacent to each other and share a mutation can get pushed apart during the course of tumour growth and end up with a large distance between them. We found that this effect can be highly advantageous when assessing the mutations in a tumour from a limited number of samples: cells carrying a particular mutation can migrate into a spatial region that is later sampled. Mutations might thus be present at low frequency in a particular sample, because the cells carrying it migrated from afar, rather than because the mutation either arose late during the growth of the tumour (<xref ref-type="bibr" rid="bib70">Williams et al., 2016</xref>) or was under negative selection (<xref ref-type="bibr" rid="bib68">Weghorn and Sunyaev, 2017</xref>).</p><p>Our results are based on three well-encapsulated hepatocellular tumours, resected and sampled in two and three dimensions (<xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>; <xref ref-type="bibr" rid="bib33">Li et al., 2022</xref>). Potentially, different types of tumours or tumours at different stages may exhibit other growth modes. For instance, tumours that are not encapsulated might have a more heterogeneous environment, and evolve under surface growth. Also, the spatial and genomic resolution of any data set imposes limits on how late stage events can be observed. We estimate that the data analysed here capture the evolutionary dynamics up to 80,000 cells. Increasing the genomic and spatial resolution will allow to identify mutations of lower frequency and thus characterize the in-vivo evolution beyond the early stages. Future techniques to sequence resected tumours at higher spatial and genomic resolution than currently possible will allow to trace key later-stage evolutionary changes like angiogenesis, effects of the tumour microenvironment, or the development of genetic instability.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology</p></fn><fn fn-type="con" id="con2"><p>Data curation, Software, Formal analysis, Validation, Investigation</p></fn><fn fn-type="con" id="con3"><p>Data curation, Investigation</p></fn><fn fn-type="con" id="con4"><p>Software, Investigation</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Data curation, Formal analysis, Supervision, Funding acquisition, Investigation, Visualization, Methodology, Writing – original draft, Project administration, Writing – review and editing</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Formal analysis, Supervision, Funding acquisition, Investigation, Visualization, Methodology, Writing – original draft, Project administration, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-95338-mdarchecklist1-v1.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>No new data was generated as part of this project. All data used is available from the original publications under the links provided.</p><p>The following previously published datasets were used:</p><p><element-citation publication-type="data" specific-use="references" id="dataset1"><person-group person-group-type="author"><collab>Ling et al.</collab></person-group><year iso-8601-date="2015">2015</year><data-title>Evolutionary genomics in Hepatocellular carcinoma</data-title><source>NGDC BioProject</source><pub-id pub-id-type="accession" xlink:href="https://ngdc.cncb.ac.cn/bioproject/browse/PRJCA000091">PRJCA000091</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset2"><person-group person-group-type="author"><collab>Li et al.</collab></person-group><year iso-8601-date="2022">2022</year><data-title>HRA000188 Evolution under spatially-heterogeneous selection in solid tumors</data-title><source>NGDC Genome Sequence Archive</source><pub-id pub-id-type="accession" xlink:href="https://ngdc.cncb.ac.cn/gsa-human/browse/HRA000188">HRA000188</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>This work was funded by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) grant SFB1310/2 - 325931972. We acknowledge support of the Spanish Ministry of Science and Innovation through the Centro de Excelencia Severo Ochoa (CEX2020-001049-S, MCIN/AEI /10.13039/501100011033), and the Generalitat de Catalunya through the CERCA programme. We also acknowledge funding by the Spanish Ministry of Science and Innovation through grants PGC2018-100941-A-I00 and PID2021-128976NB-I00. This work was also partially funded by the FWF Austrian Science Fund (Erwin-Schrödinger postdoctoral fellowship, J4366). We thank Xuemei Lu and Chung-I Wu for discussions on the data sets (<xref ref-type="bibr" rid="bib33">Li et al., 2022</xref>) and (<xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>), respectively, and Martin Peifer and Michael Lässig for discussions. Many thanks to Alison Feder and Nicola Müller for discussions on their SDevo algorithm.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alexandrov</surname><given-names>LB</given-names></name><name><surname>Kim</surname><given-names>J</given-names></name><name><surname>Haradhvala</surname><given-names>NJ</given-names></name><name><surname>Huang</surname><given-names>MN</given-names></name><name><surname>Tian Ng</surname><given-names>AW</given-names></name><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Boot</surname><given-names>A</given-names></name><name><surname>Covington</surname><given-names>KR</given-names></name><name><surname>Gordenin</surname><given-names>DA</given-names></name><name><surname>Bergstrom</surname><given-names>EN</given-names></name><name><surname>Islam</surname><given-names>SMA</given-names></name><name><surname>Lopez-Bigas</surname><given-names>N</given-names></name><name><surname>Klimczak</surname><given-names>LJ</given-names></name><name><surname>McPherson</surname><given-names>JR</given-names></name><name><surname>Morganella</surname><given-names>S</given-names></name><name><surname>Sabarinathan</surname><given-names>R</given-names></name><name><surname>Wheeler</surname><given-names>DA</given-names></name><name><surname>Mustonen</surname><given-names>V</given-names></name><collab>PCAWG Mutational Signatures Working Group</collab><name><surname>Getz</surname><given-names>G</given-names></name><name><surname>Rozen</surname><given-names>SG</given-names></name><name><surname>Stratton</surname><given-names>MR</given-names></name><collab>PCAWG Consortium</collab></person-group><year iso-8601-date="2020">2020</year><article-title>The repertoire of mutational signatures in human cancer</article-title><source>Nature</source><volume>578</volume><fpage>94</fpage><lpage>101</lpage><pub-id pub-id-type="doi">10.1038/s41586-020-1943-3</pub-id><pub-id pub-id-type="pmid">32025018</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alves</surname><given-names>JM</given-names></name><name><surname>Prado-López</surname><given-names>S</given-names></name><name><surname>Cameselle-Teijeiro</surname><given-names>JM</given-names></name><name><surname>Posada</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Rapid evolution and biogeographic spread in a colorectal cancer</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>5139</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-12926-8</pub-id><pub-id pub-id-type="pmid">31723138</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Angaji</surname><given-names>A</given-names></name><name><surname>Velling</surname><given-names>C</given-names></name><name><surname>Berg</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Stochastic clonal dynamics and genetic turnover in exponentially growing populations</article-title><source>Journal of Statistical Mechanics</source><volume>2021</volume><elocation-id>103502</elocation-id><pub-id pub-id-type="doi">10.1088/1742-5468/ac257e</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Angaji</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>TumorGrowth</data-title><version designator="swh:1:rev:0255132f3f4a3fb156e522b41dd9025a6bc4f9f7">swh:1:rev:0255132f3f4a3fb156e522b41dd9025a6bc4f9f7</version><source>Software Heriatge</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:3b7773b1af191ea52330c8c2192e29b8e51271fd;origin=https://github.com/aangaji/TumorGrowth;visit=swh:1:snp:a2331625d433c78afe9658d12705a60b888ba4f6;anchor=swh:1:rev:0255132f3f4a3fb156e522b41dd9025a6bc4f9f7">https://archive.softwareheritage.org/swh:1:dir:3b7773b1af191ea52330c8c2192e29b8e51271fd;origin=https://github.com/aangaji/TumorGrowth;visit=swh:1:snp:a2331625d433c78afe9658d12705a60b888ba4f6;anchor=swh:1:rev:0255132f3f4a3fb156e522b41dd9025a6bc4f9f7</ext-link></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Attolini</surname><given-names>CSO</given-names></name><name><surname>Cheng</surname><given-names>YK</given-names></name><name><surname>Beroukhim</surname><given-names>R</given-names></name><name><surname>Getz</surname><given-names>G</given-names></name><name><surname>Abdel-Wahab</surname><given-names>O</given-names></name><name><surname>Levine</surname><given-names>RL</given-names></name><name><surname>Mellinghoff</surname><given-names>IK</given-names></name><name><surname>Michor</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>A mathematical framework to determine the temporal sequence of somatic genetic events in cancer</article-title><source>PNAS</source><volume>107</volume><fpage>17604</fpage><lpage>17609</lpage><pub-id pub-id-type="doi">10.1073/pnas.1009117107</pub-id><pub-id pub-id-type="pmid">20864632</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baish</surname><given-names>JW</given-names></name><name><surname>Jain</surname><given-names>RK</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Fractals and cancer</article-title><source>Cancer Research</source><volume>60</volume><fpage>3683</fpage><lpage>3688</lpage><pub-id pub-id-type="pmid">10919633</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bozic</surname><given-names>I</given-names></name><name><surname>Reiter</surname><given-names>JG</given-names></name><name><surname>Allen</surname><given-names>B</given-names></name><name><surname>Antal</surname><given-names>T</given-names></name><name><surname>Chatterjee</surname><given-names>K</given-names></name><name><surname>Shah</surname><given-names>P</given-names></name><name><surname>Moon</surname><given-names>YS</given-names></name><name><surname>Yaqubie</surname><given-names>A</given-names></name><name><surname>Kelly</surname><given-names>N</given-names></name><name><surname>Le</surname><given-names>DT</given-names></name><name><surname>Lipson</surname><given-names>EJ</given-names></name><name><surname>Chapman</surname><given-names>PB</given-names></name><name><surname>Diaz</surname><given-names>LA</given-names></name><name><surname>Vogelstein</surname><given-names>B</given-names></name><name><surname>Nowak</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Evolutionary dynamics of cancer in response to targeted combination therapy</article-title><source>eLife</source><volume>2</volume><elocation-id>e00747</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.00747</pub-id><pub-id pub-id-type="pmid">23805382</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brody</surname><given-names>Y</given-names></name><name><surname>Kimmerling</surname><given-names>RJ</given-names></name><name><surname>Maruvka</surname><given-names>YE</given-names></name><name><surname>Benjamin</surname><given-names>D</given-names></name><name><surname>Elacqua</surname><given-names>JJ</given-names></name><name><surname>Haradhvala</surname><given-names>NJ</given-names></name><name><surname>Kim</surname><given-names>J</given-names></name><name><surname>Mouw</surname><given-names>KW</given-names></name><name><surname>Frangaj</surname><given-names>K</given-names></name><name><surname>Koren</surname><given-names>A</given-names></name><name><surname>Getz</surname><given-names>G</given-names></name><name><surname>Manalis</surname><given-names>SR</given-names></name><name><surname>Blainey</surname><given-names>PC</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Quantification of somatic mutation flow across individual cell division events by lineage sequencing</article-title><source>Genome Research</source><volume>28</volume><fpage>1901</fpage><lpage>1918</lpage><pub-id pub-id-type="doi">10.1101/gr.238543.118</pub-id><pub-id pub-id-type="pmid">30459213</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brú</surname><given-names>A</given-names></name><name><surname>Albertos</surname><given-names>S</given-names></name><name><surname>Luis Subiza</surname><given-names>J</given-names></name><name><surname>García-Asenjo</surname><given-names>JL</given-names></name><name><surname>Brú</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>The universal dynamics of tumor growth</article-title><source>Biophysical Journal</source><volume>85</volume><fpage>2948</fpage><lpage>2961</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(03)74715-8</pub-id><pub-id pub-id-type="pmid">14581197</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caravagna</surname><given-names>G</given-names></name><name><surname>Giarratano</surname><given-names>Y</given-names></name><name><surname>Ramazzotti</surname><given-names>D</given-names></name><name><surname>Tomlinson</surname><given-names>I</given-names></name><name><surname>Graham</surname><given-names>TA</given-names></name><name><surname>Sanguinetti</surname><given-names>G</given-names></name><name><surname>Sottoriva</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Detecting repeated cancer evolution from multi-region tumor sequencing data</article-title><source>Nature Methods</source><volume>15</volume><fpage>707</fpage><lpage>714</lpage><pub-id pub-id-type="doi">10.1038/s41592-018-0108-x</pub-id><pub-id pub-id-type="pmid">30171232</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chatterjee</surname><given-names>A</given-names></name><name><surname>Vlachos</surname><given-names>DG</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>An overview of spatial microscopic and accelerated kinetic Monte Carlo methods</article-title><source>Journal of Computer-Aided Materials Design</source><volume>14</volume><fpage>253</fpage><lpage>308</lpage><pub-id pub-id-type="doi">10.1007/s10820-006-9042-9</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cheek</surname><given-names>D</given-names></name><name><surname>Johnston</surname><given-names>SGG</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Ancestral reproductive bias in branching processes</article-title><source>Journal of Mathematical Biology</source><volume>86</volume><elocation-id>70</elocation-id><pub-id pub-id-type="doi">10.1007/s00285-023-01907-7</pub-id><pub-id pub-id-type="pmid">37027075</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chkhaidze</surname><given-names>K</given-names></name><name><surname>Heide</surname><given-names>T</given-names></name><name><surname>Werner</surname><given-names>B</given-names></name><name><surname>Williams</surname><given-names>MJ</given-names></name><name><surname>Huang</surname><given-names>W</given-names></name><name><surname>Caravagna</surname><given-names>G</given-names></name><name><surname>Graham</surname><given-names>TA</given-names></name><name><surname>Sottoriva</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Spatially constrained tumour growth affects the patterns of clonal selection and neutral drift in cancer genomic data</article-title><source>PLOS Computational Biology</source><volume>15</volume><elocation-id>e1007243</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1007243</pub-id><pub-id pub-id-type="pmid">31356595</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dentro</surname><given-names>SC</given-names></name><name><surname>Wedge</surname><given-names>DC</given-names></name><name><surname>Van Loo</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Principles of reconstructing the subclonal architecture of cancers</article-title><source>Cold Spring Harbor Perspectives in Medicine</source><volume>7</volume><elocation-id>a026625</elocation-id><pub-id pub-id-type="doi">10.1101/cshperspect.a026625</pub-id><pub-id pub-id-type="pmid">28270531</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drasdo</surname><given-names>D</given-names></name><name><surname>Höhme</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>A single-cell-based model of tumor growth in vitro: monolayers and spheroids</article-title><source>Physical Biology</source><volume>2</volume><fpage>133</fpage><lpage>147</lpage><pub-id pub-id-type="doi">10.1088/1478-3975/2/3/001</pub-id><pub-id pub-id-type="pmid">16224119</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Durrett</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Population genetics of neutral mutations in exponentially growing cancer cell populations</article-title><source>The Annals of Applied Probability</source><volume>23</volume><fpage>230</fpage><lpage>250</lpage><pub-id pub-id-type="doi">10.1214/11-aap824</pub-id><pub-id pub-id-type="pmid">23471293</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Durrett</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2015">2015</year><source>Branching Process Models of Cancer</source><publisher-name>Springer</publisher-name><pub-id pub-id-type="doi">10.1007/978-3-319-16065-8</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foo</surname><given-names>J</given-names></name><name><surname>Michor</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Evolution of acquired resistance to anti-cancer therapy</article-title><source>Journal of Theoretical Biology</source><volume>355</volume><fpage>10</fpage><lpage>20</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2014.02.025</pub-id><pub-id pub-id-type="pmid">24681298</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fu</surname><given-names>X</given-names></name><name><surname>Zhao</surname><given-names>Y</given-names></name><name><surname>Lopez</surname><given-names>JI</given-names></name><name><surname>Rowan</surname><given-names>A</given-names></name><name><surname>Au</surname><given-names>L</given-names></name><name><surname>Fendler</surname><given-names>A</given-names></name><name><surname>Hazell</surname><given-names>S</given-names></name><name><surname>Xu</surname><given-names>H</given-names></name><name><surname>Horswell</surname><given-names>S</given-names></name><name><surname>Shepherd</surname><given-names>STC</given-names></name><name><surname>Spencer</surname><given-names>CE</given-names></name><name><surname>Spain</surname><given-names>L</given-names></name><name><surname>Byrne</surname><given-names>F</given-names></name><name><surname>Stamp</surname><given-names>G</given-names></name><name><surname>O’Brien</surname><given-names>T</given-names></name><name><surname>Nicol</surname><given-names>D</given-names></name><name><surname>Augustine</surname><given-names>M</given-names></name><name><surname>Chandra</surname><given-names>A</given-names></name><name><surname>Rudman</surname><given-names>S</given-names></name><name><surname>Toncheva</surname><given-names>A</given-names></name><name><surname>Furness</surname><given-names>AJS</given-names></name><name><surname>Pickering</surname><given-names>L</given-names></name><name><surname>Kumar</surname><given-names>S</given-names></name><name><surname>Koh</surname><given-names>D-M</given-names></name><name><surname>Messiou</surname><given-names>C</given-names></name><name><surname>Dafydd</surname><given-names>DA</given-names></name><name><surname>Orton</surname><given-names>MR</given-names></name><name><surname>Doran</surname><given-names>SJ</given-names></name><name><surname>Larkin</surname><given-names>J</given-names></name><name><surname>Swanton</surname><given-names>C</given-names></name><name><surname>Sahai</surname><given-names>E</given-names></name><name><surname>Litchfield</surname><given-names>K</given-names></name><name><surname>Turajlic</surname><given-names>S</given-names></name><name><surname>Bates</surname><given-names>PA</given-names></name><collab>TRACERx Renal Consortium</collab></person-group><year iso-8601-date="2022">2022</year><article-title>Spatial patterns of tumour growth impact clonal diversification in a computational model and the TRACERx Renal study</article-title><source>Nature Ecology &amp; Evolution</source><volume>6</volume><fpage>88</fpage><lpage>102</lpage><pub-id pub-id-type="doi">10.1038/s41559-021-01586-x</pub-id><pub-id pub-id-type="pmid">34949820</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerlinger</surname><given-names>M</given-names></name><name><surname>Rowan</surname><given-names>AJ</given-names></name><name><surname>Horswell</surname><given-names>S</given-names></name><name><surname>Math</surname><given-names>M</given-names></name><name><surname>Larkin</surname><given-names>J</given-names></name><name><surname>Endesfelder</surname><given-names>D</given-names></name><name><surname>Gronroos</surname><given-names>E</given-names></name><name><surname>Martinez</surname><given-names>P</given-names></name><name><surname>Matthews</surname><given-names>N</given-names></name><name><surname>Stewart</surname><given-names>A</given-names></name><name><surname>Tarpey</surname><given-names>P</given-names></name><name><surname>Varela</surname><given-names>I</given-names></name><name><surname>Phillimore</surname><given-names>B</given-names></name><name><surname>Begum</surname><given-names>S</given-names></name><name><surname>McDonald</surname><given-names>NQ</given-names></name><name><surname>Butler</surname><given-names>A</given-names></name><name><surname>Jones</surname><given-names>D</given-names></name><name><surname>Raine</surname><given-names>K</given-names></name><name><surname>Latimer</surname><given-names>C</given-names></name><name><surname>Santos</surname><given-names>CR</given-names></name><name><surname>Nohadani</surname><given-names>M</given-names></name><name><surname>Eklund</surname><given-names>AC</given-names></name><name><surname>Spencer-Dene</surname><given-names>B</given-names></name><name><surname>Clark</surname><given-names>G</given-names></name><name><surname>Pickering</surname><given-names>L</given-names></name><name><surname>Stamp</surname><given-names>G</given-names></name><name><surname>Gore</surname><given-names>M</given-names></name><name><surname>Szallasi</surname><given-names>Z</given-names></name><name><surname>Downward</surname><given-names>J</given-names></name><name><surname>Futreal</surname><given-names>PA</given-names></name><name><surname>Swanton</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Intratumor heterogeneity and branched evolution revealed by multiregion sequencing</article-title><source>The New England Journal of Medicine</source><volume>366</volume><fpage>883</fpage><lpage>892</lpage><pub-id pub-id-type="doi">10.1056/NEJMoa1113205</pub-id><pub-id pub-id-type="pmid">22397650</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>González-García</surname><given-names>I</given-names></name><name><surname>Solé</surname><given-names>RV</given-names></name><name><surname>Costa</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Metapopulation dynamics and spatial heterogeneity in cancer</article-title><source>PNAS</source><volume>99</volume><fpage>13085</fpage><lpage>13089</lpage><pub-id pub-id-type="doi">10.1073/pnas.202139299</pub-id><pub-id pub-id-type="pmid">12351679</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greenspan</surname><given-names>HP</given-names></name></person-group><year iso-8601-date="1972">1972</year><article-title>Models for the growth of a solid tumor by diffusion</article-title><source>Studies in Applied Mathematics</source><volume>51</volume><fpage>317</fpage><lpage>340</lpage><pub-id pub-id-type="doi">10.1002/sapm1972514317</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hallatschek</surname><given-names>O</given-names></name><name><surname>Hersen</surname><given-names>P</given-names></name><name><surname>Ramanathan</surname><given-names>S</given-names></name><name><surname>Nelson</surname><given-names>DR</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Genetic drift at expanding frontiers promotes gene segregation</article-title><source>PNAS</source><volume>104</volume><fpage>19926</fpage><lpage>19930</lpage><pub-id pub-id-type="doi">10.1073/pnas.0710150104</pub-id><pub-id pub-id-type="pmid">18056799</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heyde</surname><given-names>A</given-names></name><name><surname>Reiter</surname><given-names>JG</given-names></name><name><surname>Naxerova</surname><given-names>K</given-names></name><name><surname>Nowak</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Consecutive seeding and transfer of genetic diversity in metastasis</article-title><source>PNAS</source><volume>116</volume><fpage>14129</fpage><lpage>14137</lpage><pub-id pub-id-type="doi">10.1073/pnas.1819408116</pub-id><pub-id pub-id-type="pmid">31239334</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoang</surname><given-names>ML</given-names></name><name><surname>Chen</surname><given-names>CH</given-names></name><name><surname>Sidorenko</surname><given-names>VS</given-names></name><name><surname>He</surname><given-names>J</given-names></name><name><surname>Dickman</surname><given-names>KG</given-names></name><name><surname>Yun</surname><given-names>BH</given-names></name><name><surname>Moriya</surname><given-names>M</given-names></name><name><surname>Niknafs</surname><given-names>N</given-names></name><name><surname>Douville</surname><given-names>C</given-names></name><name><surname>Karchin</surname><given-names>R</given-names></name><name><surname>Turesky</surname><given-names>RJ</given-names></name><name><surname>Pu</surname><given-names>YS</given-names></name><name><surname>Vogelstein</surname><given-names>B</given-names></name><name><surname>Papadopoulos</surname><given-names>N</given-names></name><name><surname>Grollman</surname><given-names>AP</given-names></name><name><surname>Kinzler</surname><given-names>KW</given-names></name><name><surname>Rosenquist</surname><given-names>TA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Mutational signature of aristolochic acid exposure as revealed by whole-exome sequencing</article-title><source>Science Translational Medicine</source><volume>5</volume><elocation-id>197ra102</elocation-id><pub-id pub-id-type="doi">10.1126/scitranslmed.3006200</pub-id><pub-id pub-id-type="pmid">23926200</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoefflin</surname><given-names>R</given-names></name><name><surname>Lahrmann</surname><given-names>B</given-names></name><name><surname>Warsow</surname><given-names>G</given-names></name><name><surname>Hübschmann</surname><given-names>D</given-names></name><name><surname>Spath</surname><given-names>C</given-names></name><name><surname>Walter</surname><given-names>B</given-names></name><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Hofer</surname><given-names>L</given-names></name><name><surname>Macher-Goeppinger</surname><given-names>S</given-names></name><name><surname>Tolstov</surname><given-names>Y</given-names></name><name><surname>Korzeniewski</surname><given-names>N</given-names></name><name><surname>Duensing</surname><given-names>A</given-names></name><name><surname>Grüllich</surname><given-names>C</given-names></name><name><surname>Jäger</surname><given-names>D</given-names></name><name><surname>Perner</surname><given-names>S</given-names></name><name><surname>Schönberg</surname><given-names>G</given-names></name><name><surname>Nyarangi-Dix</surname><given-names>J</given-names></name><name><surname>Isaac</surname><given-names>S</given-names></name><name><surname>Hatiboglu</surname><given-names>G</given-names></name><name><surname>Teber</surname><given-names>D</given-names></name><name><surname>Hadaschik</surname><given-names>B</given-names></name><name><surname>Pahernik</surname><given-names>S</given-names></name><name><surname>Roth</surname><given-names>W</given-names></name><name><surname>Eils</surname><given-names>R</given-names></name><name><surname>Schlesner</surname><given-names>M</given-names></name><name><surname>Sültmann</surname><given-names>H</given-names></name><name><surname>Hohenfellner</surname><given-names>M</given-names></name><name><surname>Grabe</surname><given-names>N</given-names></name><name><surname>Duensing</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Spatial niche formation but not malignant progression is a driving force for intratumoural heterogeneity</article-title><source>Nature Communications</source><volume>7</volume><elocation-id>comms11845</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms11845</pub-id><pub-id pub-id-type="pmid">27291893</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>Z</given-names></name><name><surname>Li</surname><given-names>Z</given-names></name><name><surname>Ma</surname><given-names>Z</given-names></name><name><surname>Curtis</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Multi-cancer analysis of clonality and the timing of systemic spread in paired primary tumors and metastases</article-title><source>Nature Genetics</source><volume>52</volume><fpage>701</fpage><lpage>708</lpage><pub-id pub-id-type="doi">10.1038/s41588-020-0628-z</pub-id><pub-id pub-id-type="pmid">32424352</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iwasaki</surname><given-names>WM</given-names></name><name><surname>Innan</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Simulation framework for generating intratumor heterogeneity patterns in a cancer cell population</article-title><source>PLOS ONE</source><volume>12</volume><elocation-id>e0184229</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0184229</pub-id><pub-id pub-id-type="pmid">28877206</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>S</given-names></name><name><surname>Chen</surname><given-names>W-D</given-names></name><name><surname>Parmigiani</surname><given-names>G</given-names></name><name><surname>Diehl</surname><given-names>F</given-names></name><name><surname>Beerenwinkel</surname><given-names>N</given-names></name><name><surname>Antal</surname><given-names>T</given-names></name><name><surname>Traulsen</surname><given-names>A</given-names></name><name><surname>Nowak</surname><given-names>MA</given-names></name><name><surname>Siegel</surname><given-names>C</given-names></name><name><surname>Velculescu</surname><given-names>VE</given-names></name><name><surname>Kinzler</surname><given-names>KW</given-names></name><name><surname>Vogelstein</surname><given-names>B</given-names></name><name><surname>Willis</surname><given-names>J</given-names></name><name><surname>Markowitz</surname><given-names>SD</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Comparative lesion sequencing provides insights into tumor evolution</article-title><source>PNAS</source><volume>105</volume><fpage>4283</fpage><lpage>4288</lpage><pub-id pub-id-type="doi">10.1073/pnas.0712345105</pub-id><pub-id pub-id-type="pmid">18337506</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Komarova</surname><given-names>NL</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Spatial stochastic models for cancer initiation and progression</article-title><source>Bulletin of Mathematical Biology</source><volume>68</volume><fpage>1573</fpage><lpage>1599</lpage><pub-id pub-id-type="doi">10.1007/s11538-005-9046-8</pub-id><pub-id pub-id-type="pmid">16832734</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Lewinsohn</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>State-dependent evolutionary models reveal modes of solid tumor growth</data-title><version designator="dd800ac">dd800ac</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/blab/spatial-tumor-phylodynamics">https://github.com/blab/spatial-tumor-phylodynamics</ext-link></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lewinsohn</surname><given-names>MA</given-names></name><name><surname>Bedford</surname><given-names>T</given-names></name><name><surname>Müller</surname><given-names>NF</given-names></name><name><surname>Feder</surname><given-names>AF</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>State-dependent evolutionary models reveal modes of solid tumour growth</article-title><source>Nature Ecology &amp; Evolution</source><volume>7</volume><fpage>581</fpage><lpage>596</lpage><pub-id pub-id-type="doi">10.1038/s41559-023-02000-4</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>G</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name><name><surname>Wu</surname><given-names>D</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Li</surname><given-names>T</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Liang</surname><given-names>L</given-names></name><name><surname>Zou</surname><given-names>W</given-names></name><name><surname>Wu</surname><given-names>C-I</given-names></name><name><surname>Wang</surname><given-names>H-Y</given-names></name><name><surname>Lu</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Evolution under spatially heterogeneous selection in solid tumors</article-title><source>Molecular Biology and Evolution</source><volume>39</volume><elocation-id>msab335</elocation-id><pub-id pub-id-type="doi">10.1093/molbev/msab335</pub-id><pub-id pub-id-type="pmid">34850073</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ling</surname><given-names>S</given-names></name><name><surname>Hu</surname><given-names>Z</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name><name><surname>Yang</surname><given-names>F</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Lin</surname><given-names>P</given-names></name><name><surname>Chen</surname><given-names>K</given-names></name><name><surname>Dong</surname><given-names>L</given-names></name><name><surname>Cao</surname><given-names>L</given-names></name><name><surname>Tao</surname><given-names>Y</given-names></name><name><surname>Hao</surname><given-names>L</given-names></name><name><surname>Chen</surname><given-names>Q</given-names></name><name><surname>Gong</surname><given-names>Q</given-names></name><name><surname>Wu</surname><given-names>D</given-names></name><name><surname>Li</surname><given-names>W</given-names></name><name><surname>Zhao</surname><given-names>W</given-names></name><name><surname>Tian</surname><given-names>X</given-names></name><name><surname>Hao</surname><given-names>C</given-names></name><name><surname>Hungate</surname><given-names>EA</given-names></name><name><surname>Catenacci</surname><given-names>DVT</given-names></name><name><surname>Hudson</surname><given-names>RR</given-names></name><name><surname>Li</surname><given-names>WH</given-names></name><name><surname>Lu</surname><given-names>X</given-names></name><name><surname>Wu</surname><given-names>CI</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Extremely high genetic diversity in a single tumor points to prevalence of non-Darwinian cell evolution</article-title><source>PNAS</source><volume>112</volume><fpage>E6496</fpage><lpage>E6505</lpage><pub-id pub-id-type="doi">10.1073/pnas.1519556112</pub-id><pub-id pub-id-type="pmid">26561581</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Lomakin</surname><given-names>A</given-names></name><name><surname>Svedlund</surname><given-names>J</given-names></name><name><surname>Strell</surname><given-names>C</given-names></name><name><surname>Gataric</surname><given-names>M</given-names></name><name><surname>Shmatko</surname><given-names>A</given-names></name><name><surname>Park</surname><given-names>JS</given-names></name><name><surname>Ju</surname><given-names>YS</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Spatial Genomics Maps the Structure, Character and Evolution of Cancer Clones</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.04.16.439912</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lorenzo</surname><given-names>C</given-names></name><name><surname>Frongia</surname><given-names>C</given-names></name><name><surname>Jorand</surname><given-names>R</given-names></name><name><surname>Fehrenbach</surname><given-names>J</given-names></name><name><surname>Weiss</surname><given-names>P</given-names></name><name><surname>Maandhui</surname><given-names>A</given-names></name><name><surname>Gay</surname><given-names>G</given-names></name><name><surname>Ducommun</surname><given-names>B</given-names></name><name><surname>Lobjois</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Live cell division dynamics monitoring in 3D large spheroid tumor models using light sheet microscopy</article-title><source>Cell Division</source><volume>6</volume><fpage>1</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1186/1747-1028-6-22</pub-id><pub-id pub-id-type="pmid">22152157</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luebeck</surname><given-names>EG</given-names></name><name><surname>Moolgavkar</surname><given-names>SH</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Multistage carcinogenesis and the incidence of colorectal cancer</article-title><source>PNAS</source><volume>99</volume><fpage>15095</fpage><lpage>15100</lpage><pub-id pub-id-type="doi">10.1073/pnas.222118199</pub-id><pub-id pub-id-type="pmid">12415112</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>MacPherson</surname><given-names>A</given-names></name><name><surname>Louca</surname><given-names>S</given-names></name><name><surname>McLaughlin</surname><given-names>A</given-names></name><name><surname>Joy</surname><given-names>JB</given-names></name><name><surname>Pennell</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Unifying phylogenetic birth-death models in epidemiology and macroevolution</article-title><source>Systematic Biology</source><volume>71</volume><fpage>172</fpage><lpage>189</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syab049</pub-id><pub-id pub-id-type="pmid">34165577</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Malmi-Kakkada</surname><given-names>AN</given-names></name><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Samanta</surname><given-names>HS</given-names></name><name><surname>Sinha</surname><given-names>S</given-names></name><name><surname>Thirumalai</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Cell growth rate dictates the onset of glass to fluidlike transition and long time superdiffusion in an evolving cell colony</article-title><source>Physical Review X</source><volume>8</volume><elocation-id>021025</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevX.8.021025</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McGranahan</surname><given-names>N</given-names></name><name><surname>Swanton</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Biological and therapeutic impact of intratumor heterogeneity in cancer evolution</article-title><source>Cancer Cell</source><volume>27</volume><fpage>15</fpage><lpage>26</lpage><pub-id pub-id-type="doi">10.1016/j.ccell.2014.12.001</pub-id><pub-id pub-id-type="pmid">25584892</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Metzcar</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Heiland</surname><given-names>R</given-names></name><name><surname>Macklin</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A review of cell-based computational modeling in cancer biology</article-title><source>JCO Clinical Cancer Informatics</source><volume>3</volume><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="doi">10.1200/CCI.18.00069</pub-id><pub-id pub-id-type="pmid">30715927</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Michor</surname><given-names>F</given-names></name><name><surname>Iwasa</surname><given-names>Y</given-names></name><name><surname>Nowak</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Dynamics of cancer progression</article-title><source>Nature Reviews. Cancer</source><volume>4</volume><fpage>197</fpage><lpage>205</lpage><pub-id pub-id-type="doi">10.1038/nrc1295</pub-id><pub-id pub-id-type="pmid">14993901</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Milholland</surname><given-names>B</given-names></name><name><surname>Dong</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>Hao</surname><given-names>X</given-names></name><name><surname>Suh</surname><given-names>Y</given-names></name><name><surname>Vijg</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Differences between germline and somatic mutation rates in humans and mice</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>15183</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms15183</pub-id><pub-id pub-id-type="pmid">28485371</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Montel</surname><given-names>F</given-names></name><name><surname>Delarue</surname><given-names>M</given-names></name><name><surname>Elgeti</surname><given-names>J</given-names></name><name><surname>Malaquin</surname><given-names>L</given-names></name><name><surname>Basan</surname><given-names>M</given-names></name><name><surname>Risler</surname><given-names>T</given-names></name><name><surname>Cabane</surname><given-names>B</given-names></name><name><surname>Vignjevic</surname><given-names>D</given-names></name><name><surname>Prost</surname><given-names>J</given-names></name><name><surname>Cappello</surname><given-names>G</given-names></name><name><surname>Joanny</surname><given-names>J-F</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Stress clamp experiments on multicellular tumor spheroids</article-title><source>Physical Review Letters</source><volume>107</volume><elocation-id>188102</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.107.188102</pub-id><pub-id pub-id-type="pmid">22107677</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ng</surname><given-names>AWT</given-names></name><name><surname>Poon</surname><given-names>SL</given-names></name><name><surname>Huang</surname><given-names>MN</given-names></name><name><surname>Lim</surname><given-names>JQ</given-names></name><name><surname>Boot</surname><given-names>A</given-names></name><name><surname>Yu</surname><given-names>W</given-names></name><name><surname>Suzuki</surname><given-names>Y</given-names></name><name><surname>Thangaraju</surname><given-names>S</given-names></name><name><surname>Ng</surname><given-names>CCY</given-names></name><name><surname>Tan</surname><given-names>P</given-names></name><name><surname>Pang</surname><given-names>S-T</given-names></name><name><surname>Huang</surname><given-names>H-Y</given-names></name><name><surname>Yu</surname><given-names>M-C</given-names></name><name><surname>Lee</surname><given-names>P-H</given-names></name><name><surname>Hsieh</surname><given-names>S-Y</given-names></name><name><surname>Chang</surname><given-names>AY</given-names></name><name><surname>Teh</surname><given-names>BT</given-names></name><name><surname>Rozen</surname><given-names>SG</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Aristolochic acids and their derivatives are widely implicated in liver cancers in Taiwan and throughout Asia</article-title><source>Science Translational Medicine</source><volume>9</volume><elocation-id>eaan6446</elocation-id><pub-id pub-id-type="doi">10.1126/scitranslmed.aan6446</pub-id><pub-id pub-id-type="pmid">29046434</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Noble</surname><given-names>R</given-names></name><name><surname>Burri</surname><given-names>D</given-names></name><name><surname>Le Sueur</surname><given-names>C</given-names></name><name><surname>Lemant</surname><given-names>J</given-names></name><name><surname>Viossat</surname><given-names>Y</given-names></name><name><surname>Kather</surname><given-names>JN</given-names></name><name><surname>Beerenwinkel</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Spatial structure governs the mode of tumour evolution</article-title><source>Nature Ecology &amp; Evolution</source><volume>6</volume><fpage>207</fpage><lpage>217</lpage><pub-id pub-id-type="doi">10.1038/s41559-021-01615-9</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Popic</surname><given-names>V</given-names></name><name><surname>Salari</surname><given-names>R</given-names></name><name><surname>Hajirasouliha</surname><given-names>I</given-names></name><name><surname>Kashef-Haghighi</surname><given-names>D</given-names></name><name><surname>West</surname><given-names>RB</given-names></name><name><surname>Batzoglou</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Fast and scalable inference of multi-sample cancer lineages</article-title><source>Genome Biology</source><volume>16</volume><elocation-id>91</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-015-0647-8</pub-id><pub-id pub-id-type="pmid">25944252</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ranft</surname><given-names>J</given-names></name><name><surname>Basan</surname><given-names>M</given-names></name><name><surname>Elgeti</surname><given-names>J</given-names></name><name><surname>Joanny</surname><given-names>JF</given-names></name><name><surname>Prost</surname><given-names>J</given-names></name><name><surname>Jülicher</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Fluidization of tissues by cell division and apoptosis</article-title><source>PNAS</source><volume>107</volume><fpage>20863</fpage><lpage>20868</lpage><pub-id pub-id-type="doi">10.1073/pnas.1011086107</pub-id><pub-id pub-id-type="pmid">21078958</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Serrano Colome</surname><given-names>C</given-names></name><name><surname>Canal Anton</surname><given-names>O</given-names></name><name><surname>Seplyarskiy</surname><given-names>V</given-names></name><name><surname>Weghorn</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Mutational Signature Decomposition with Deep Neural Networks Reveals Origins of Clock-like Processes and Hypoxia Dependencies</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2023.12.06.570467</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shraiman</surname><given-names>BI</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Mechanical feedback as a possible regulator of tissue growth</article-title><source>PNAS</source><volume>102</volume><fpage>3318</fpage><lpage>3323</lpage><pub-id pub-id-type="doi">10.1073/pnas.0404782102</pub-id><pub-id pub-id-type="pmid">15728365</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Sinha</surname><given-names>S</given-names></name><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Thirumalai</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Statistical Mechanical Theory for Spatio-Temporal Evolution of Intra-Tumor Heterogeneity in Cancers: Analysis of Multiregion Sequencing Data</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2022.02.19.481164</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Slatkin</surname><given-names>M</given-names></name><name><surname>Hudson</surname><given-names>RR</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Pairwise comparisons of mitochondrial DNA sequences in stable and exponentially growing populations</article-title><source>Genetics</source><volume>129</volume><fpage>555</fpage><lpage>562</lpage><pub-id pub-id-type="doi">10.1093/genetics/129.2.555</pub-id><pub-id pub-id-type="pmid">1743491</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sottoriva</surname><given-names>A</given-names></name><name><surname>Verhoeff</surname><given-names>JJC</given-names></name><name><surname>Borovski</surname><given-names>T</given-names></name><name><surname>McWeeney</surname><given-names>SK</given-names></name><name><surname>Naumov</surname><given-names>L</given-names></name><name><surname>Medema</surname><given-names>JP</given-names></name><name><surname>Sloot</surname><given-names>PMA</given-names></name><name><surname>Vermeulen</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Cancer stem cell tumor model reveals invasive morphology and increased phenotypical heterogeneity</article-title><source>Cancer Research</source><volume>70</volume><fpage>46</fpage><lpage>56</lpage><pub-id pub-id-type="doi">10.1158/0008-5472.CAN-09-3663</pub-id><pub-id pub-id-type="pmid">20048071</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sottoriva</surname><given-names>A</given-names></name><name><surname>Kang</surname><given-names>H</given-names></name><name><surname>Ma</surname><given-names>Z</given-names></name><name><surname>Graham</surname><given-names>TA</given-names></name><name><surname>Salomon</surname><given-names>MP</given-names></name><name><surname>Zhao</surname><given-names>J</given-names></name><name><surname>Marjoram</surname><given-names>P</given-names></name><name><surname>Siegmund</surname><given-names>K</given-names></name><name><surname>Press</surname><given-names>MF</given-names></name><name><surname>Shibata</surname><given-names>D</given-names></name><name><surname>Curtis</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A Big Bang model of human colorectal tumor growth</article-title><source>Nature Genetics</source><volume>47</volume><fpage>209</fpage><lpage>216</lpage><pub-id pub-id-type="doi">10.1038/ng.3214</pub-id><pub-id pub-id-type="pmid">25665006</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stadler</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>On incomplete sampling under birth-death models and connections to the sampling-based coalescent</article-title><source>Journal of Theoretical Biology</source><volume>261</volume><fpage>58</fpage><lpage>66</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2009.07.018</pub-id><pub-id pub-id-type="pmid">19631666</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stadler</surname><given-names>T</given-names></name><name><surname>Vaughan</surname><given-names>TG</given-names></name><name><surname>Gavryushkin</surname><given-names>A</given-names></name><name><surname>Guindon</surname><given-names>S</given-names></name><name><surname>Kühnert</surname><given-names>D</given-names></name><name><surname>Leventhal</surname><given-names>GE</given-names></name><name><surname>Drummond</surname><given-names>AJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>How well can the exponential-growth coalescent approximate constant-rate birth-death population dynamics?</article-title><source>Proceedings. Biological Sciences</source><volume>282</volume><elocation-id>20150420</elocation-id><pub-id pub-id-type="doi">10.1098/rspb.2015.0420</pub-id><pub-id pub-id-type="pmid">25876846</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steel</surname><given-names>GG</given-names></name></person-group><year iso-8601-date="1967">1967</year><article-title>Cell loss as a factor in the growth rate of human tumours</article-title><source>European Journal of Cancer</source><volume>3</volume><fpage>381</fpage><lpage>387</lpage><pub-id pub-id-type="doi">10.1016/0014-2964(67)90022-9</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stein</surname><given-names>WE</given-names></name><name><surname>Dattero</surname><given-names>R</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>Sampling bias and the inspection paradox</article-title><source>Mathematics Magazine</source><volume>58</volume><fpage>96</fpage><lpage>99</lpage><pub-id pub-id-type="doi">10.1080/0025570X.1985.11977160</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>R</given-names></name><name><surname>Hu</surname><given-names>Z</given-names></name><name><surname>Sottoriva</surname><given-names>A</given-names></name><name><surname>Graham</surname><given-names>TA</given-names></name><name><surname>Harpak</surname><given-names>A</given-names></name><name><surname>Ma</surname><given-names>Z</given-names></name><name><surname>Fischer</surname><given-names>JM</given-names></name><name><surname>Shibata</surname><given-names>D</given-names></name><name><surname>Curtis</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Between-region genetic divergence reflects the mode and tempo of tumor evolution</article-title><source>Nature Genetics</source><volume>49</volume><fpage>1015</fpage><lpage>1024</lpage><pub-id pub-id-type="doi">10.1038/ng.3891</pub-id><pub-id pub-id-type="pmid">28581503</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suzuki</surname><given-names>Y</given-names></name><name><surname>Ng</surname><given-names>SB</given-names></name><name><surname>Chua</surname><given-names>C</given-names></name><name><surname>Leow</surname><given-names>WQ</given-names></name><name><surname>Chng</surname><given-names>J</given-names></name><name><surname>Liu</surname><given-names>SY</given-names></name><name><surname>Ramnarayanan</surname><given-names>K</given-names></name><name><surname>Gan</surname><given-names>A</given-names></name><name><surname>Ho</surname><given-names>DL</given-names></name><name><surname>Ten</surname><given-names>R</given-names></name><name><surname>Su</surname><given-names>Y</given-names></name><name><surname>Lezhava</surname><given-names>A</given-names></name><name><surname>Lai</surname><given-names>JH</given-names></name><name><surname>Koh</surname><given-names>D</given-names></name><name><surname>Lim</surname><given-names>KH</given-names></name><name><surname>Tan</surname><given-names>P</given-names></name><name><surname>Rozen</surname><given-names>SG</given-names></name><name><surname>Tan</surname><given-names>IB</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Multiregion ultra-deep sequencing reveals early intermixing and variable levels of intratumoral heterogeneity in colorectal cancer</article-title><source>Molecular Oncology</source><volume>11</volume><fpage>124</fpage><lpage>139</lpage><pub-id pub-id-type="doi">10.1002/1878-0261.12012</pub-id><pub-id pub-id-type="pmid">28145097</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Takei</surname><given-names>Y</given-names></name><name><surname>Yun</surname><given-names>J</given-names></name><name><surname>Zheng</surname><given-names>S</given-names></name><name><surname>Ollikainen</surname><given-names>N</given-names></name><name><surname>Pierson</surname><given-names>N</given-names></name><name><surname>White</surname><given-names>J</given-names></name><name><surname>Shah</surname><given-names>S</given-names></name><name><surname>Thomassie</surname><given-names>J</given-names></name><name><surname>Suo</surname><given-names>S</given-names></name><name><surname>Eng</surname><given-names>C-HL</given-names></name><name><surname>Guttman</surname><given-names>M</given-names></name><name><surname>Yuan</surname><given-names>G-C</given-names></name><name><surname>Cai</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Integrated spatial genomics reveals global architecture of single nuclei</article-title><source>Nature</source><volume>590</volume><fpage>344</fpage><lpage>350</lpage><pub-id pub-id-type="doi">10.1038/s41586-020-03126-2</pub-id><pub-id pub-id-type="pmid">33505024</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tarabichi</surname><given-names>M</given-names></name><name><surname>Martincorena</surname><given-names>I</given-names></name><name><surname>Gerstung</surname><given-names>M</given-names></name><name><surname>Leroi</surname><given-names>AM</given-names></name><name><surname>Markowetz</surname><given-names>F</given-names></name><collab>PCAWG Evolution and Heterogeneity Working Group</collab><name><surname>Spellman</surname><given-names>PT</given-names></name><name><surname>Morris</surname><given-names>QD</given-names></name><name><surname>Lingjærde</surname><given-names>OC</given-names></name><name><surname>Wedge</surname><given-names>DC</given-names></name><name><surname>Van Loo</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Neutral tumor evolution?</article-title><source>Nature Genetics</source><volume>50</volume><fpage>1630</fpage><lpage>1633</lpage><pub-id pub-id-type="doi">10.1038/s41588-018-0258-x</pub-id><pub-id pub-id-type="pmid">30374075</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Heijden</surname><given-names>M</given-names></name><name><surname>Miedema</surname><given-names>DM</given-names></name><name><surname>Waclaw</surname><given-names>B</given-names></name><name><surname>Veenstra</surname><given-names>VL</given-names></name><name><surname>Lecca</surname><given-names>MC</given-names></name><name><surname>Nijman</surname><given-names>LE</given-names></name><name><surname>van Dijk</surname><given-names>E</given-names></name><name><surname>van Neerven</surname><given-names>SM</given-names></name><name><surname>Lodestijn</surname><given-names>SC</given-names></name><name><surname>Lenos</surname><given-names>KJ</given-names></name><name><surname>de Groot</surname><given-names>NE</given-names></name><name><surname>Prasetyanti</surname><given-names>PR</given-names></name><name><surname>Arricibita Varea</surname><given-names>A</given-names></name><name><surname>Winton</surname><given-names>DJ</given-names></name><name><surname>Medema</surname><given-names>JP</given-names></name><name><surname>Morrissey</surname><given-names>E</given-names></name><name><surname>Ylstra</surname><given-names>B</given-names></name><name><surname>Nowak</surname><given-names>MA</given-names></name><name><surname>Bijlsma</surname><given-names>MF</given-names></name><name><surname>Vermeulen</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Spatiotemporal regulation of clonogenicity in colorectal cancer xenografts</article-title><source>PNAS</source><volume>116</volume><fpage>6140</fpage><lpage>6145</lpage><pub-id pub-id-type="doi">10.1073/pnas.1813417116</pub-id><pub-id pub-id-type="pmid">30850544</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Liedekerke</surname><given-names>P</given-names></name><name><surname>Neitsch</surname><given-names>J</given-names></name><name><surname>Johann</surname><given-names>T</given-names></name><name><surname>Alessandri</surname><given-names>K</given-names></name><name><surname>Nassoy</surname><given-names>P</given-names></name><name><surname>Drasdo</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Quantitative cell-based model predicts mechanical stress response of growing tumor spheroids over various growth conditions and cell lines</article-title><source>PLOS Computational Biology</source><volume>15</volume><elocation-id>e1006273</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006273</pub-id><pub-id pub-id-type="pmid">30849070</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Volz</surname><given-names>EM</given-names></name><name><surname>Frost</surname><given-names>SDW</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Sampling through time and phylodynamic inference with coalescent and birth-death models</article-title><source>Journal of the Royal Society, Interface</source><volume>11</volume><elocation-id>20140945</elocation-id><pub-id pub-id-type="doi">10.1098/rsif.2014.0945</pub-id><pub-id pub-id-type="pmid">25401173</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Waclaw</surname><given-names>B</given-names></name><name><surname>Bozic</surname><given-names>I</given-names></name><name><surname>Pittman</surname><given-names>ME</given-names></name><name><surname>Hruban</surname><given-names>RH</given-names></name><name><surname>Vogelstein</surname><given-names>B</given-names></name><name><surname>Nowak</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A spatial model predicts that dispersal and cell turnover limit intratumour heterogeneity</article-title><source>Nature</source><volume>525</volume><fpage>261</fpage><lpage>264</lpage><pub-id pub-id-type="doi">10.1038/nature14971</pub-id><pub-id pub-id-type="pmid">26308893</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ward</surname><given-names>JP</given-names></name><name><surname>King</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Mathematical modelling of avascular-tumour growth</article-title><source>Mathematical Medicine and Biology</source><volume>14</volume><fpage>39</fpage><lpage>69</lpage><pub-id pub-id-type="doi">10.1093/imammb/14.1.39</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weghorn</surname><given-names>D</given-names></name><name><surname>Sunyaev</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Bayesian inference of negative and positive selection in human cancers</article-title><source>Nature Genetics</source><volume>49</volume><fpage>1785</fpage><lpage>1788</lpage><pub-id pub-id-type="doi">10.1038/ng.3987</pub-id><pub-id pub-id-type="pmid">29106416</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Werner</surname><given-names>B</given-names></name><name><surname>Case</surname><given-names>J</given-names></name><name><surname>Williams</surname><given-names>MJ</given-names></name><name><surname>Chkhaidze</surname><given-names>K</given-names></name><name><surname>Temko</surname><given-names>D</given-names></name><name><surname>Fernández-Mateos</surname><given-names>J</given-names></name><name><surname>Cresswell</surname><given-names>GD</given-names></name><name><surname>Nichol</surname><given-names>D</given-names></name><name><surname>Cross</surname><given-names>W</given-names></name><name><surname>Spiteri</surname><given-names>I</given-names></name><name><surname>Huang</surname><given-names>W</given-names></name><name><surname>Tomlinson</surname><given-names>IPM</given-names></name><name><surname>Barnes</surname><given-names>CP</given-names></name><name><surname>Graham</surname><given-names>TA</given-names></name><name><surname>Sottoriva</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Measuring single cell divisions in human tissues from multi-region sequencing data</article-title><source>Nature Communications</source><volume>11</volume><elocation-id>1035</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-020-14844-6</pub-id><pub-id pub-id-type="pmid">32098957</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Williams</surname><given-names>MJ</given-names></name><name><surname>Werner</surname><given-names>B</given-names></name><name><surname>Barnes</surname><given-names>CP</given-names></name><name><surname>Graham</surname><given-names>TA</given-names></name><name><surname>Sottoriva</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Identification of neutral tumor evolution across cancer types</article-title><source>Nature Genetics</source><volume>48</volume><fpage>238</fpage><lpage>244</lpage><pub-id pub-id-type="doi">10.1038/ng.3489</pub-id><pub-id pub-id-type="pmid">26780609</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Williams</surname><given-names>MJ</given-names></name><name><surname>Werner</surname><given-names>B</given-names></name><name><surname>Heide</surname><given-names>T</given-names></name><name><surname>Curtis</surname><given-names>C</given-names></name><name><surname>Barnes</surname><given-names>CP</given-names></name><name><surname>Sottoriva</surname><given-names>A</given-names></name><name><surname>Graham</surname><given-names>TA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Quantification of subclonal selection in cancer from bulk sequencing data</article-title><source>Nature Genetics</source><volume>50</volume><fpage>895</fpage><lpage>903</lpage><pub-id pub-id-type="doi">10.1038/s41588-018-0128-6</pub-id><pub-id pub-id-type="pmid">29808029</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>ZM</given-names></name><name><surname>Zhao</surname><given-names>B</given-names></name><name><surname>Bai</surname><given-names>Y</given-names></name><name><surname>Iamarino</surname><given-names>A</given-names></name><name><surname>Gaffney</surname><given-names>SG</given-names></name><name><surname>Schlessinger</surname><given-names>J</given-names></name><name><surname>Lifton</surname><given-names>RP</given-names></name><name><surname>Rimm</surname><given-names>DL</given-names></name><name><surname>Townsend</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Early and multiple origins of metastatic lineages within primary tumors</article-title><source>PNAS</source><volume>113</volume><fpage>2140</fpage><lpage>2145</lpage><pub-id pub-id-type="doi">10.1073/pnas.1525677113</pub-id><pub-id pub-id-type="pmid">26858460</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>T</given-names></name><name><surname>Chiang</surname><given-names>ZD</given-names></name><name><surname>Morriss</surname><given-names>JW</given-names></name><name><surname>LaFave</surname><given-names>LM</given-names></name><name><surname>Murray</surname><given-names>EM</given-names></name><name><surname>Del Priore</surname><given-names>I</given-names></name><name><surname>Meli</surname><given-names>K</given-names></name><name><surname>Lareau</surname><given-names>CA</given-names></name><name><surname>Nadaf</surname><given-names>NM</given-names></name><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Earl</surname><given-names>AS</given-names></name><name><surname>Macosko</surname><given-names>EZ</given-names></name><name><surname>Jacks</surname><given-names>T</given-names></name><name><surname>Buenrostro</surname><given-names>JD</given-names></name><name><surname>Chen</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Spatial genomics enables multi-modal study of clonal heterogeneity in tissues</article-title><source>Nature</source><volume>601</volume><fpage>85</fpage><lpage>91</lpage><pub-id pub-id-type="doi">10.1038/s41586-021-04217-4</pub-id><pub-id pub-id-type="pmid">34912115</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec sec-type="appendix" id="s8"><title>Computational modelling of volume and surface growth</title><p>We use a cell-based and off-lattice computational model of neutral spatial tumour growth in three dimensions. The model is based on a continuous-time many-type branching process well known from the population genetics of asexual reproduction (<xref ref-type="bibr" rid="bib17">Durrett, 2015</xref>), coupled to a simple model of spatial dynamics. Under this model, an individual cell can die, divide, and acquire neutral mutations at division. Cells inherit the spatial position from their parents, and a simple pushing algorithm to avoid overlapping cells is used to simulate the tissue mechanics. The model is implemented by a rejection-kinetic Monte Carlo algorithm as outlined below. In this section, we introduce the dynamics of cell division and spatial displacement, specify the spatial sampling in Appendix 1.2, and in Appendix 1.1 we discuss the performance of this algorithm compared to rejection-free kinetic Monte Carlo algorithms such as the Gillespie algorithm. The code to the model is available as a Julia package at <ext-link ext-link-type="uri" xlink:href="https://github.com/aangaji/TumorGrowth">https://github.com/aangaji/TumorGrowth</ext-link>, (copy archived at <xref ref-type="bibr" rid="bib4">Angaji, 2024</xref>).</p><p>In our model, the growth dynamics of a cell can differ depending on its local environment. Under volume growth, the birth and death rates of cells are independent of their spatial position, under surface growth we make the rate of cell birth depend on the local cell density. Specifically, the rate <inline-formula><mml:math id="inf34"><mml:mi>b</mml:mi></mml:math></inline-formula> at which a particular cell divides depends on the local cell density <inline-formula><mml:math id="inf35"><mml:mi>ρ</mml:mi></mml:math></inline-formula> via a function <inline-formula><mml:math id="inf36"><mml:mrow><mml:mi>b</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The local density <inline-formula><mml:math id="inf37"><mml:mi>ρ</mml:mi></mml:math></inline-formula> at a position <inline-formula><mml:math id="inf38"><mml:mi>𝐱</mml:mi></mml:math></inline-formula> is computed as a weighted sum over cells <italic>i</italic> in proximity of <inline-formula><mml:math id="inf39"><mml:mi>𝐱</mml:mi></mml:math></inline-formula>, each contributing a Gaussian weight by their distance<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi>i</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo mathvariant="bold">−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>7</mml:mn><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>σ</mml:mi><mml:msqrt><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:msqrt></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We set the width of the Gaussian σ to 4 cell radii and evaluate the sum over <italic>i</italic> over cells within 7 cell radii. This dependency of the cell birth rate on the local neighborhood is the reason why updating the rates of all cells at each time step (as required by a rejection-free method) would be prohibitively expensive.</p><p>The rejection-kinetic Monte-Carlo algorithm for a density-dependent off-lattice spatial population dynamics is as follows:</p><list list-type="order"><list-item><p>Pick a cell <italic>i</italic> uniformly</p></list-item><list-item><p>Update cell birth rate <inline-formula><mml:math id="inf40"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula></p></list-item><list-item><p>Draw <inline-formula><mml:math id="inf41"><mml:mi>r</mml:mi></mml:math></inline-formula> uniformly from the interval <inline-formula><mml:math id="inf42"><mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo separator="true">,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula></p><list list-type="bullet"><list-item><p><inline-formula><mml:math id="inf43"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> : cell dies</p></list-item><list-item><p><inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>r</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>: cell divides</p><list list-type="simple"><list-item><p>→ each cell draws new mutations <inline-formula><mml:math id="inf45"><mml:mrow><mml:mi>m</mml:mi><mml:mo>∼</mml:mo><mml:mtext>Poisson</mml:mtext><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula></p></list-item><list-item><p>→ resolve overlaps by pushing</p></list-item></list></list-item><list-item><p><inline-formula><mml:math id="inf46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>r</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> : cell skips its turn</p></list-item></list></list-item><list-item><p>Increment time by <inline-formula><mml:math id="inf47"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>t</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mtext/><mml:mi>Exp</mml:mi></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula></p></list-item></list><p>The function <inline-formula><mml:math id="inf48"><mml:mrow><mml:mi>b</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is chosen such that rate of birth is maximal at <inline-formula><mml:math id="inf49"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and zero at a density threshold <inline-formula><mml:math id="inf50"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula>, and (for simplicity) decreases in a straight line with ρ, see <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1A</xref>. This dependence encodes potential effects neighbouring cancer cells may have on the division rate of a cell, for instance due to the buildup of toxic metabolites or mechanical stress. At high values of <inline-formula><mml:math id="inf51"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula> (relative to the maximum density achieved without overlapping cells, see below), the birth rate is independent of the local cell density, at low values of the threshold the birth rate depends on the local density ρ and becomes zero at <inline-formula><mml:math id="inf52"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula>. Thus, by setting a high threshold <inline-formula><mml:math id="inf53"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math></inline-formula> the model produces volume growth, and a low value of <inline-formula><mml:math id="inf54"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula> leads to surface growth. Under surface growth, the growth rate is zero or nearly zero throughout the tumour, except at the surface, where the local cancer cell density is smaller than in the tumour bulk. By tuning the parameter <inline-formula><mml:math id="inf55"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula>, we can continuously vary the mode of growth between surface growth and volume growth.</p><fig id="app1fig1" position="float"><label>Appendix 1—figure 1.</label><caption><title>Density-dependent birth rate.</title><p>A schematic plot of the birth rate <inline-formula><mml:math id="inf56"><mml:mrow><mml:mi>b</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> decreasing with the local density of cells ρ, see text.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app1-fig1-v1.tif"/></fig><p>The cell death rate and the mutation probability at division are the same across all cells. As a result, under volume growth cells divide and die independently of their spatial position and the position of other cells. The population thus evolves like a mixed population would, although every cell has a distinct position in space and this position is inherited from one generation to the next.</p><p>During the simulation, cells are uniformly drawn from the population for birth and death. Importantly, this approach allows us to update a cell’s birth rate only when it is selected for division as the total rate of events - comprising birth, death and null-event - is uniform across cells and constant <inline-formula><mml:math id="inf57"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula>. On the other hand, this means that a cell with a low birth rate might also be rejected (null-event), that is neither die nor divide.</p><p>After each draw of a cell, time is incremented. Time steps are exponentially distributed random variables with the mean total rate given by <inline-formula><mml:math id="inf58"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mtext/><mml:mi>Exp</mml:mi></mml:mrow><mml:mrow><mml:mo fence="true" form="prefix">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mo fence="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf59"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf60"><mml:mi>N</mml:mi></mml:math></inline-formula> is the current population size.</p><p>At division, a new cell is placed randomly on the surface of the dividing cell. The resulting overlaps between cells are resolved by pushing overlapping cells away from each other. This step of the algorithm is computationally expensive, so keeping track of immediate neighborhoods is essential, see Appendix 1.1 on the computational performance.</p><p>The details of the pushing algorithm are as follows: First, the close neighbourhood of the newly placed cell is searched for overlaps. Any overlapping cell is pushed away from the new cell by the overlap plus a small margin which acts as a buffer and avoids many tiny overlaps. The cell is then added to a queue for subsequent iterations. Neighborhoods are shuffled such that there is no particular order in which cells are pushed. After each overlapping cell in the neighborhood is pushed and added to the queue the search for overlaps is repeated on the first cell in the queue, adding new pairs to the queue, which are in turn iteratively resolved until the queue is empty. In this ‘width-first’ approach, overlaps are first resolved within a given neighborhood and new neighborhoods are appended to the queue, as opposed to a ‘depth-first’ approach which follows a sequence of pushes by immediately checking a pushed cell’s neighborhood for new overlaps and adding these to the front of the queue (which then operates like a stack). This can be efficiently implemented by recursion but has no noticeable performance advantage and results in the same growth patterns.</p><p>A commonly used procedure to increase the computational performance in such collision models is to rasterize continuous space. Each cell is assigned to a position on a grid which has a lattice constant of two cell radii. When searching for neighbours - both when pushing and updating the density dependent birth rate <inline-formula><mml:math id="inf61"><mml:mrow><mml:mi>b</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> - a quick selection of the close (Moore) neighbourhood on the grid returns candidates for which to measure the precise distance. After a cell is either pushed or dies, its position on the grid is updated.</p><p>At cell division, each of the two cells - parent and offspring - acquires new mutations whose number is drawn from a Poisson distribution with mean <inline-formula><mml:math id="inf62"><mml:mrow><mml:mi>μ</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. These mutations are taken to be neutral and do not affect the birth or death rates.</p><p>Our model combines a simple computational off-lattice framework combining genetic mutations in a growing population with a simple tissue dynamics. Additional features, such as selection or different growth laws (for instance Gompertzian growth) can be implemented easily. The model avoids the well-recognized problems that arise in lattice-based models: volume growth on a fully occupied lattice necessitates artificial steps like expanding all distances by some factor while keeping the lattice spacing constant (<xref ref-type="bibr" rid="bib63">van der Heijden et al., 2019</xref>), or moving a column of cells one step in one particular direction to generate empty sites (<xref ref-type="bibr" rid="bib13">Chkhaidze et al., 2019</xref>). However, the computational cost of the off-lattice model means that we can only simulate populations of a few ten thousand cells, compared to billions of cell that can be simulated on a lattice (<xref ref-type="bibr" rid="bib66">Waclaw et al., 2015</xref>).</p></sec><sec sec-type="appendix" id="s9"><title>1.1 Algorithm performance and CPU runtimes</title><p>Kinetic Monte Carlo (KMC) is a stochastic simulation of a discrete Markov process under continuous time. Under KMC, cells are picked to potentially replicate or die with a certain probability, and after each event time is incremented by a stochastic waiting time. In a rejection or null-event KMC (rKMC) scheme, the cell that has been drawn for update might not change its state (e.g. replicate or die) after a given time step, in contrast to rejection-free KMC (rfKMC) where all events lead to a change of state.</p><p>The advantage of rKMC compared to a rfKMC algorithm is that one does not need to know the rates of all cells at each step. Instead, the drawn cell’s rates are updated just in time and normalized by a constant, maximum rate, which is larger than each cell’s total rate <inline-formula><mml:math id="inf63"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula>. The maximum rate should be as small as possible to minimize the number of null-events (rejections) and can be conveniently set to <inline-formula><mml:math id="inf64"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula> using the maximum birthrate at <inline-formula><mml:math id="inf65"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>Rejection-free methods, on the other hand, require global updates of the relevant rates at every step. In our model, this would involve computing the local density at every cell. Such an update scales with population size and would be computationally prohibitive. Rejection KMC, on the other hand, allows for local updates and only computes the birth rate <inline-formula><mml:math id="inf66"><mml:mi>b</mml:mi></mml:math></inline-formula> of a single cell per step, at the cost of null-events. However, these null-events do not involve the computationally expensive pushing step (cell movements) and add little to CPU runtime even at low density thresholds <inline-formula><mml:math id="inf67"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula> and high death rates <inline-formula><mml:math id="inf68"><mml:mi>d</mml:mi></mml:math></inline-formula>. For a detailed review on the two classes of KMC algorithms, see <xref ref-type="bibr" rid="bib11">Chatterjee and Vlachos, 2007</xref>. The rKMC approach has already been used in non-spatial simulations of populations of cancer cells (<xref ref-type="bibr" rid="bib71">Williams et al., 2018</xref>).</p><p>A 3D simulation to 40,000 cells at turnover rate <inline-formula><mml:math id="inf69"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula> takes 5 min under surface growth but 16 min under volume growth on an AMD Ryzen 5 3600 CPU at 3.6 GHz. At high turnover rate <inline-formula><mml:math id="inf70"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>0.975</mml:mn></mml:mrow></mml:math></inline-formula> a simulation under volume growth takes from 19 up to 28 min. The time required for a simulation is almost fully spent on moving cells to resolve overlaps. Drawing birth and death events on the other hand is very fast even at high death rates <inline-formula><mml:math id="inf71"><mml:mi>d</mml:mi></mml:math></inline-formula>. High death rates mainly prolong run times by increasing the number of births necessary to reach the final tumour size which entails more pushing steps. This is particularly noticeable for volume growth simulations, where cells predominantly divide and push from within the tumour volume, whereas overlaps under surface growth are more quickly resolved because they affect fewer cells.</p></sec><sec sec-type="appendix" id="s10"><title>1.2 Spatial sampling in simulations</title><p>The tumour data used here stems from a large number of samples taken from histopathological sections of resected tumours (<xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>; <xref ref-type="bibr" rid="bib33">Li et al., 2022</xref>). To compare the results of our simulations with this data, we take samples from the simulated populations in a way that mimicks the empirical sampling.</p><p>Ling et al. take samples from a single planar section through the tumour (<xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>). To mimick their sampling scheme, we first cut a two-dimensional plane out of a three-dimensional simulated cell population, and then take small, circular ‘punch’ samples on a triangular lattice with adjustable number of samples, sample size, and spacing. Given the desired number of samples <inline-formula><mml:math id="inf72"><mml:mi>n</mml:mi></mml:math></inline-formula>, we consider a triangular lattice on the plane with a suitable lattice spacing and place samples on the lattice points. The triangular lattice has the highest packing factor <inline-formula><mml:math id="inf73"><mml:mfrac><mml:mi>π</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mrow></mml:mfrac></mml:math></inline-formula> compared to other lattices and fits the most samples into a given area. Using the packing factor we estimate the lattice constant such that <inline-formula><mml:math id="inf74"><mml:mi>n</mml:mi></mml:math></inline-formula> primitive cells of the lattice cover the area of the plane. The number of samples can fluctuate a little from run to run, depending on the precise shape of the tumour and the orientation of the lattice relative to the tumour. The number of cells in the plane scales poorly with total population size, and at 40,000 total cells, the plane contains about 2600 cells given a narrow plane width of 3 cell radii. To ensure that there is free space between samples (like in <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>), we set the number of cells per sample to 5 when taking 285 samples, but have 20 cells or more per sample when 23 samples are taken. The numbers of samples are picked to be the same as in Ling et al. for the spatially resolved data obtained by genotyping and the genomically resolved date obtained by whole-exome sequencing (WES; see main text and Methods: Spatially resolved data). We always compare the results obtained from this spatial sampling in the cross section of 3D simulations to sampling on 2D simulations of the plane, where for a population size of 10,000 cells we take larger samples of 20 cells for 285 samples. The results, however, do not depend much on this size differences of samples and cell populations but rather on the frequency resolution of mutant frequencies (only mutations with frequency larger than a cutoff set by the sequencing depth are retained) and the number of samples taken.</p><p>Data from samples taken in 3D from two hepatocellular carcinomas (tumours T1 and T2) from a single patient is discussed in a recent publication by <xref ref-type="bibr" rid="bib33">Li et al., 2022</xref>. The data is available from <ext-link ext-link-type="uri" xlink:href="https://ngdc.cncb.ac.cn/search/specific?db=hra&amp;q=+HRA000188">https://ngdc.cncb.ac.cn/search/specific?db=hra&amp;q=+HRA000188</ext-link>. Similar to Ling et al., hundreds of samples were taken from these tumours (169 from tumour T1 and 160 from T2), but different slices out of the upper hemispheres of the two tumours were taken before taking samples within each slice. Again some of these samples were then analysed by whole-genome sequencing (16 in T1 and 9 in T2), and the remaining 153 and 151 samples were genotyped based on the mutations found by WGS. The multi-region sampling scheme of Li et al., is different from Ling et al., in that it takes samples from several planes of a tumour hemisphere as opposed to sampling from only a single cross section. To imitate the sampling scheme of Li et al., we consider slices in the upper hemisphere of our 3D simulated tumours at distances specified by Li et al.,. From these slices we then take small ‘punch’ samples at the coordinates specific to the tumours T1 and T2, both for WGS and genotyped samples. Samples in the two tumours are placed rather unevenly, in contrast to the more uniform sampling by Ling et al. For this reason, we place the samples in simulations close to the empirical positions of the samples given in Li et al.</p></sec></app><app id="appendix-2"><title>Appendix 2</title><sec sec-type="appendix" id="s11"><title>Surface and volume growth: direction of mutants</title><p>We construct a simple metric to distinguish surface growth and volume growth. It is based on the directions of newly occurring mutations with respect to their parental background. If the tumour predominantly grows on the surface, then new mutants appear radially outwards relative to their parental clone. All pairs of parental and offspring cells are assigned a direction angle and a statistical weight such that every mutation <inline-formula><mml:math id="inf75"><mml:mi>m</mml:mi></mml:math></inline-formula> contributes equally to the metric.</p></sec><sec sec-type="appendix" id="s12"><title>2.1 Algorithmic description</title><p>The metric is based on lineages of clones. Clone A is an ancestor of clone B if A’s mutations are a true subset of B’s mutations. We therefore need to determine the set of clones. This is straightforward for single cells where clones are genotypes. Samples containing many cells, however, may display a mixture of different clones. We use a simple clustering scheme where mutations that coincide across samples are clustered into clones, Appendix 8. We compared the results of this clustering scheme also to those of the LICHeE algorithm for the inference of multi-sample lineages (<xref ref-type="bibr" rid="bib47">Popic et al., 2015</xref>), which produces very similar sets of clones and virtually identical final results. The direction angles of new mutations are computed as follows:</p><list list-type="order"><list-item><p>Infer clones and their lineage (Appendix 8)</p></list-item><list-item><p>for each sample <inline-formula><mml:math id="inf76"><mml:msub><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula> that has cells of clone <inline-formula><mml:math id="inf77"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula></p><p>for each ancestral clone <inline-formula><mml:math id="inf78"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">}</mml:mo><mml:mo>⊂</mml:mo><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> and each sample <inline-formula><mml:math id="inf79"><mml:msub><mml:mi>s</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula> that has cells of the ancestral clone</p><list list-type="alpha-lower"><list-item><p>determine distances <inline-formula><mml:math id="inf80"><mml:mrow><mml:msub><mml:mover><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mo stretchy="false" style="transform:scale(0.75) translate(10%, 30%);">→</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false" style="transform:scale(0.75) translate(10%, 30%);">→</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false" style="transform:scale(0.75) translate(10%, 30%);">→</mml:mo></mml:mover><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> between <inline-formula><mml:math id="inf81"><mml:msub><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf82"><mml:msub><mml:mi>s</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula></p><p>and <inline-formula><mml:math id="inf83"><mml:mrow><mml:msub><mml:mover><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mo stretchy="false" style="transform:scale(0.75) translate(10%, 30%);">→</mml:mo></mml:mover><mml:mrow><mml:mi>l</mml:mi><mml:mo separator="true">,</mml:mo><mml:mtext>cm</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false" style="transform:scale(0.75) translate(10%, 30%);">→</mml:mo></mml:mover><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false" style="transform:scale(0.75) translate(10%, 30%);">→</mml:mo></mml:mover><mml:mtext>cm</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> between <inline-formula><mml:math id="inf84"><mml:msub><mml:mi>s</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula> and the tumour centre of mass</p></list-item><list-item><p>skip if <inline-formula><mml:math id="inf85"><mml:mrow><mml:mi>|</mml:mi><mml:msub><mml:mover><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mo stretchy="false" style="transform:scale(0.75) translate(10%, 30%);">→</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mi>|</mml:mi></mml:mrow></mml:math></inline-formula> is larger than the distance between <inline-formula><mml:math id="inf86"><mml:msub><mml:mi>s</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula> and the surface</p></list-item><list-item><p>determine the direction angle <inline-formula><mml:math id="inf87"><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo separator="true">,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>∠</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mover><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mo stretchy="false" style="transform:scale(0.75) translate(10%, 30%);">→</mml:mo></mml:mover><mml:mrow><mml:mi>l</mml:mi><mml:mo separator="true">,</mml:mo><mml:mtext>cm</mml:mtext></mml:mrow></mml:msub><mml:mo separator="true">,</mml:mo><mml:msub><mml:mover><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mo stretchy="false" style="transform:scale(0.75) translate(10%, 30%);">→</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mrow><mml:mtext/><mml:mi>sign</mml:mi></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo separator="true">,</mml:mo><mml:mtext>cm</mml:mtext></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo separator="true">,</mml:mo><mml:mtext>cm</mml:mtext></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula></p><p>(zero if vectors are aligned i.e. offspring lies radially outward relative to the ancestor)</p></list-item><list-item><p>assign weight <inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:munder><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> (one over the number of valid pairs)</p></list-item></list></list-item><list-item><p>plot the histogram of <inline-formula><mml:math id="inf89"><mml:msubsup><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo separator="true">,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:math></inline-formula> with weights <inline-formula><mml:math id="inf90"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo separator="true">,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:math></inline-formula></p></list-item><list-item><p>from <inline-formula><mml:math id="inf91"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo fence="true" form="prefix">⟨</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo separator="true">,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:msubsup><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo separator="true">,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo fence="true" form="postfix">⟩</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> compute mean angle as <inline-formula><mml:math id="inf92"><mml:mrow><mml:mrow><mml:mi>arg</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and radius as <inline-formula><mml:math id="inf93"><mml:mrow><mml:mi>|</mml:mi><mml:mi>c</mml:mi><mml:mi>|</mml:mi></mml:mrow></mml:math></inline-formula></p></list-item></list><fig id="app2fig1" position="float"><label>Appendix 2—figure 1.</label><caption><title>Parent-offspring direction angle algorithm illustration and contributions of different clones.</title><p>(<bold>A</bold>) This cutout of <xref ref-type="fig" rid="fig2">Figure 2A</xref> showcases the different variables used in step 2 of the algorithm to calculate the angles θ. A new mutant clone with mutations <inline-formula><mml:math id="inf94"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> indicated in blue appears and grows radially outward on a red parental background with mutations <inline-formula><mml:math id="inf95"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">}</mml:mo><mml:mo>⊂</mml:mo><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>. For a given parental sample <inline-formula><mml:math id="inf96"><mml:msub><mml:mi>s</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula> belonging to the parental background, we consider every sample <inline-formula><mml:math id="inf97"><mml:msub><mml:mi>s</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula> belonging to the offspring clone within a distance <inline-formula><mml:math id="inf98"><mml:mi>r</mml:mi></mml:math></inline-formula> from <inline-formula><mml:math id="inf99"><mml:msub><mml:mi>s</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula>, where <inline-formula><mml:math id="inf100"><mml:mi>r</mml:mi></mml:math></inline-formula> is the distance between <inline-formula><mml:math id="inf101"><mml:msub><mml:mi>s</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula> and the tumour surface. <inline-formula><mml:math id="inf102"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for the pair <inline-formula><mml:math id="inf103"><mml:msub><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf104"><mml:msub><mml:mi>s</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula> is the angle between the arrow <inline-formula><mml:math id="inf105"><mml:msub><mml:mover><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mo stretchy="false" style="transform:scale(0.75) translate(10%, 30%);">→</mml:mo></mml:mover><mml:mrow><mml:mi>l</mml:mi><mml:mo separator="true">,</mml:mo><mml:mrow><mml:mtext/><mml:mi>cm</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> pointing from the center of mass cm to <inline-formula><mml:math id="inf106"><mml:msub><mml:mi>s</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf107"><mml:msub><mml:mover><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mo stretchy="false" style="transform:scale(0.75) translate(10%, 30%);">→</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> connecting <inline-formula><mml:math id="inf108"><mml:msub><mml:mi>s</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula> to <inline-formula><mml:math id="inf109"><mml:msub><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula> as calculated in step 2c. A weight is assigned to <inline-formula><mml:math id="inf110"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> such that the total weight of all pairs where the blue clone is the offspring is 1; this way each clone contributes equally to the distribution of θ. (<bold>B</bold>) The distribution of angles θ in the Ling et al. data shown <xref ref-type="fig" rid="fig2">Figure 2B</xref> of the main text comprises contributions from different clones. These contributions are shown here separately for each clone. On each subplot, the top-right label gives the private mutations of the clone and on the top-left label gives the number of parent-offspring pairs contributing to the histogram. The color indicates which of 6 distinct clades the clone belongs to. Crucially, there is no bias for a particular value of θ across clones. An artefact of giving equal weights to clones are the sharp peaks when there are few parent-offspring pairs. In particular clones 4 and 18 (panel 9 and 10) each have only 1 parent-offspring angle. (<bold>C</bold>) This figure shows the contribution of the 6 distinct clades (clade colours as in Subfigure B) to the total angle distribution in <xref ref-type="fig" rid="fig2">Figure 2B</xref> of the main text. Histograms of subfigure B of clones belonging to the same clade are added and the resulting clade histograms are stacked (weights of the stacked histogram are divided by the total number of clones for normalisation).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app2-fig1-v1.tif"/></fig><sec sec-type="appendix" id="s12-1-1"><title>Step 1</title><p>In words, when a mutation <inline-formula><mml:math id="inf111"><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> enters the population, it defines a new clone <inline-formula><mml:math id="inf112"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> whose genotype consists of the new mutation <inline-formula><mml:math id="inf113"><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and all its ancestral mutations. The clone <inline-formula><mml:math id="inf114"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> is the most recent common ancestor of all clones containing mutation <inline-formula><mml:math id="inf115"><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. We ask how the radial position of this clone relates to its ancestral clones. (2) Given an ancestral clone <inline-formula><mml:math id="inf116"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> we take one sample that has cells of the offspring clone <inline-formula><mml:math id="inf117"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> and one that has cells of the ancestral clone, (2a) draw a line between the two and (2c) measure the direction angle θ between this line and the line connecting the sample with the ancestral clone to the tumour centre of mass. If tumour growth occurs on its surface (interface with normal tissue), the offspring grows outward, and we expect this angle to be biased towards zero. The direction angle is symmetric with respect to the line between parent and centre of mass, so to recover the whole −180° to 180° range we multiply it by a term which distinguishes clockwise from counterclockwise. We repeat this measurement for all pairs from the two clones and again with all other ancestral clones following the lineage backwards in time. (2d) The weight associated with each direction angle θ is one over the total number of ancestor-offspring angles for clone <inline-formula><mml:math id="inf118"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, such that, after summing over all samples with cells of the ancestral clone, every mutation contributes with equal weight.</p><p>In the case where frequencies of clones are known in each sample, one can assign a weight <inline-formula><mml:math id="inf119"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo separator="true">,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mi>k</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:math></inline-formula> to the sample pair <inline-formula><mml:math id="inf120"><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">}</mml:mo><mml:mo separator="true">,</mml:mo><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf121"><mml:msubsup><mml:mi>f</mml:mi><mml:mi>x</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula> is the frequency of clone <inline-formula><mml:math id="inf122"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:mi>m</mml:mi><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> in sample <inline-formula><mml:math id="inf123"><mml:mi>x</mml:mi></mml:math></inline-formula>. The product of frequencies <inline-formula><mml:math id="inf124"><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mi>k</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:math></inline-formula> is proportional to the number of offspring-ancestor pairs of cells between the two samples. Dividing each weight <inline-formula><mml:math id="inf125"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo separator="true">,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:math></inline-formula> by the sum <inline-formula><mml:math id="inf126"><mml:mrow><mml:mrow><mml:munder><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>l</mml:mi><mml:mo separator="true">,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:munder></mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo separator="true">,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> over all weights involving clone <inline-formula><mml:math id="inf127"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> as offspring again imposes a normalization where each mutation contributes equally to the distribution of direction angles.</p></sec><sec sec-type="appendix" id="s12-1-2"><title>Step 2</title><p>Part (b) accounts for a simple geometric effect: If a sample containing offspring is placed randomly around a sample containing ancestors, the direction angle θ is uniformly distributed, however, more cells lie inward than outward from any point except the centre of the disk resulting in a purely geometric bias towards ±180°. The restriction to only consider offspring samples within the distance between ancestor sample and tumour surface mitigates this bias by only considering as many samples inward from the ancestor sample as lie outward from it.</p></sec><sec sec-type="appendix" id="s12-1-3"><title>Step 3</title><p>Directly plotting the weighted histogram of direction angles θ gives a picture of the radial direction of growth across all mutations, (4) but one can also compute a mean angle and radius as summary statistics of the distribution. The expression for <inline-formula><mml:math id="inf128"><mml:mi>c</mml:mi></mml:math></inline-formula> is the weighted sum over all unit-length 2D vectors pointing in the directions <inline-formula><mml:math id="inf129"><mml:msubsup><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo separator="true">,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:math></inline-formula>, resulting in an average vector pointing towards the direction of growth and whose length quantifies the strength of this bias, that is a radius <inline-formula><mml:math id="inf130"><mml:mrow><mml:mi>|</mml:mi><mml:mi>c</mml:mi><mml:mi>|</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> means that all offspring have a direction angle <inline-formula><mml:math id="inf131"><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false" class="tml-capshift" style="math-style:normal;math-depth:0;">‾</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mi>arg</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> relative to the ancestor, while <inline-formula><mml:math id="inf132"><mml:mrow><mml:mi>|</mml:mi><mml:mi>c</mml:mi><mml:mi>|</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> corresponds to a uniform placement of the offspring relative to the ancestor (in this case <inline-formula><mml:math id="inf133"><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false" class="tml-capshift" style="math-style:normal;math-depth:0;">‾</mml:mo></mml:mover></mml:math></inline-formula> is indeterminate).</p><p>We compare 3D simulations of 40,000 cells under volume growth (<inline-formula><mml:math id="inf134"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math></inline-formula>) and surface growth (<inline-formula><mml:math id="inf135"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula>) both for sampling single cells and with a sampling scheme that imitates the experimental data of Ling et al,. For each simulated tumour, we take a thin planar cross-section through the centre of mass. (The case of 3D sampling is treated in Appendix 2.2).</p><p>For single cells, the distribution of θ can be measured directly for the single cells in the plane, resulting in many offspring-ancestor pairs. To study the effect of sampling, we employ the spatial sampling scheme described in Appendix 1 and take 285 samples of 5 cells each from 2D cross-sections of the 3D simulated tumour. The same sampling is repeated on 2D simulations without taking a cross section allowing for larger sample sizes of 20 cells. Finally, we compute the direction angles <inline-formula><mml:math id="inf136"><mml:msubsup><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false" lspace="0em" rspace="0em">}</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> and weights <inline-formula><mml:math id="inf137"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false" lspace="0em" rspace="0em">}</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> as described above. The resulting distributions are shown in <xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2</xref> for 2D slices of 3D simulations and in <xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3</xref> for 2D simulations (where larger numbers of cells can be achieved). In both cases, we consider both the uniform sampling of single cells from the tumour and the sampling scheme mimicking (<xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>) described in Appendix 1.</p><p>Both 2D and 3D simulations of surface growth clearly display the expected bias in the distribution of direction angles, compared to the flat distribution under volume growth.</p><p>The distribution of direction angles is very similar in 2D and 3D (comparing the left plots for single cells in <xref ref-type="fig" rid="app2fig2">Appendix 2—figures 2</xref> and <xref ref-type="fig" rid="app2fig3">3</xref> and similarly the right plots for samples). On the other hand, between single cells and samples in each figure, showing a small loss in signal strength (surface growth peak against the volume growth background) due to sampling noise and errors in the reconstruction of parent-offspring clone relations from samples.</p><p><xref ref-type="fig" rid="app2fig2">Appendix 2—figures 2</xref> and <xref ref-type="fig" rid="app2fig3">3</xref> show that the signal for surface growth can also be detected in a regime of high cell turnover (high rate of cell death <inline-formula><mml:math id="inf138"><mml:mi>d</mml:mi></mml:math></inline-formula> compared to the birth rate). The distributions of direction angles θ in the low turnover regime are not shown here, they have the same shape as for high <inline-formula><mml:math id="inf139"><mml:mi>d</mml:mi></mml:math></inline-formula> but show less sampling noise.</p><fig id="app2fig2" position="float"><label>Appendix 2—figure 2.</label><caption><title>Distributions of parent-offspring direction angles θ for 3D simulations under volume and surface growth.</title><p>Direction angles are taken from single cells (left) and the 2D spatial sampling scheme (right, Appendix 1). Distributions of parent-offspring direction angles θ for cross-sections of 3D simulations of 40,000 cells at constant division rate <inline-formula><mml:math id="inf140"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, mutation rate <inline-formula><mml:math id="inf141"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula>, as well as cell death rate <inline-formula><mml:math id="inf142"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf143"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:math></inline-formula> under volume growth (red, <inline-formula><mml:math id="inf144"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math></inline-formula>) and surface growth (blue, <inline-formula><mml:math id="inf145"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula>), respectively. On the left, direction angles are determined for single cells (these curves are shown in <xref ref-type="fig" rid="fig2">Figure 2</xref> of the main text), whereas on the right, we additionally apply a spatial sampling with 285 samples. The cell death rate <inline-formula><mml:math id="inf146"><mml:mi>d</mml:mi></mml:math></inline-formula> is set lower in surface growth simulations because also the rate at which cell divisions take place is much lower under surface growth due to the reduced growth in the tumour bulk. This leads to frequent population extinctions at higher rates of cell death <inline-formula><mml:math id="inf147"><mml:mi>d</mml:mi></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app2-fig2-v1.tif"/></fig><fig id="app2fig3" position="float"><label>Appendix 2—figure 3.</label><caption><title>Distributions of parent-offspring direction angles θ for 2D simulations under volume growth (red) and surface growth (blue).</title><p>Direction angles are taken from single cells (left) and the spatial sampling scheme (right). Parameters are as in <xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2</xref> except that populations are grown to 10,000 cells, no cross section is taken, and individual samples consist of 20 cells.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app2-fig3-v1.tif"/></fig></sec></sec><sec sec-type="appendix" id="s13"><title>2.2 Direction of mutants in the 3D sphere</title><p>So far, we have restricted ourselves to a planar cut through the center of a 3D tumour, motivated by the data from Ling et al. which was sampled from such a cross section. However, the definition of the direction of mutants can be readily extended to single cells and samples taken in 3D. An example such data is <xref ref-type="bibr" rid="bib33">Li et al., 2022</xref>.</p><p>The algorithm to determine ancestor-offspring direction angles as presented before is the same in 3D, with the exception that angles are not given a sign in step (2b) of the algorithm. The sign was computed relative to the <inline-formula><mml:math id="inf148"><mml:mi>z</mml:mi></mml:math></inline-formula> axis orthogonal to the plane which defined an orientation to the direction angles and distinguished 0 −180° clockwise from counterclockwise. This notion of orientation does not exist in the sphere.</p><p>More importantly, the most useful metric to quantify direction of mutants and distinguish surface from volume growth in 3D is not simply θ as on the 2D plane. To find the corresponding metric we ask what function of θ is uniformly distributed on the 3D sphere. To this end, we consider θ the polar angle in spherical coordinates. For isotropic growth of new cells the distribution of θ is specified by the volume element in spherical coordinates, and hence proportional to <inline-formula><mml:math id="inf149"><mml:mrow><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mspace width="0.1667em"/></mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula>. Correspondingly, its indefinite integral <inline-formula><mml:math id="inf150"><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mspace width="0.1667em"/></mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula> and hence also <inline-formula><mml:math id="inf151"><mml:mrow><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mspace width="0.1667em"/></mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula> is uniformly distributed on the interval <inline-formula><mml:math id="inf152"><mml:mrow><mml:mo form="prefix" stretchy="false">[</mml:mo><mml:mo form="prefix" stretchy="false">−</mml:mo><mml:mn>1,1</mml:mn><mml:mo form="postfix" stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. (Since we are looking for a function <inline-formula><mml:math id="inf153"><mml:mrow><mml:mi>f</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> that is uniformly distributed, the transformation of probabilities gives <inline-formula><mml:math id="inf154"><mml:mrow><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:math></inline-formula> and hence <inline-formula><mml:math id="inf155"><mml:mrow><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>)</p><p><xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4</xref> showcases these results using 3D simulations and sampling of single cells. Under volume growth, <inline-formula><mml:math id="inf156"><mml:mrow><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mspace width="0.1667em"/></mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula> shows a uniform distribution (red line). Surface growth, on the other hand leads to a bias towards the direction of the pole, <inline-formula><mml:math id="inf157"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, and thus a bias towards <inline-formula><mml:math id="inf158"><mml:mrow><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mspace width="0.1667em"/></mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (blue line).</p><fig id="app2fig4" position="float"><label>Appendix 2—figure 4.</label><caption><title>Distributions of parent-offspring direction cosines <inline-formula><mml:math id="inf159"><mml:mrow><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for single cells in 3D simulations under volume (red) and surface (blue) growth.</title><p>Direction angles θ are taken from single cells in the spherical tumour. Simulation parameters are as in <xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2</xref> except that no cross section is taken.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app2-fig4-v1.tif"/></fig><p>The set of samples taken in 3D by Li et al., see Appendix 1.2, comprises samples that were whole-genome (WG) sequenced as well as samples that were genotyped. The sampling takes places at a lower spatial density than (<xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>) and read counts are not reported for individual SNVs. In both T1 and T2, the spacing between neighboring samples is 8% ± 2% of the tumour diameter whereas in the considerably larger tumour of Ling et al. (3.5cm compared to the .5cm of T1 and .5cm of T2) samples were taken at median distance of 4% ± 1% of the tumour diameter. Measured in tumour diameters, the sampling density in Li et al. is about half that of Ling et al., mainly due to sampling in 3D where the same number of samples is more spread out than in the plane. While 3D sampling may give a global picture of the intra tumour heterogeneity it comes at the cost of reduced spatial resolution.</p><p>However, Li et al. genotype a larger number of mutations than Ling et al. — 906 for T1 and 565 for T2 — because WGS targets a larger part of the genome than WES and they apply less stringent filtering criteria for SNVs compared to Ling et al. (see our discussion of the WES data in Appendix 4).</p><p>As explained in Appendix 8 on clonal inference, given the larger genotyping set of mutations (compared to the Ling et. al data), we use the LICHeE tool to determine clones, before identifying the inferred clones within the larger set of genotyped samples, which provide a higher spatial resolution. We then measure the distribution of ancestor-offspring direction cosine <inline-formula><mml:math id="inf160"><mml:mrow><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mspace width="0.1667em"/></mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula>; the results are shown in <xref ref-type="fig" rid="app2fig5">Appendix 2—figure 5</xref>. For comparison with simulations, we perform a spatial sampling of planar cuts through simulated tumours in 3D under surface and volume growth. We use the coordinates of planes and samples from tumours T1 and T2 to mimick their sampling (and potential spatial inhomogeneities therein) in our simulations. First, we extract samples for sequencing at the coordinates of WGS samples before taking samples at the coordinates specified for genotyped samples (<xref ref-type="bibr" rid="bib33">Li et al., 2022</xref>) to confirm the presence or absence of mutations found in the first set of samples, see Appendix 1.2 on simulated sampling. For the mutations found in the first ‘sequencing’ set we measure the distribution of <inline-formula><mml:math id="inf161"><mml:mrow><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mspace width="0.1667em"/></mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula>, see <xref ref-type="fig" rid="app2fig6">Appendix 2—figure 6</xref>.</p><p>The simulation results show that sampling at the density of the Li et al. data (which is much lower than in the planar sampling by Ling et al.) introduces a radial weak inward bias under volume growth.</p><p>The inward bias also affects the distribution under surface growth - a similar effect as in sampling from the cross <xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3</xref>. This makes it harder to distinguish surface and volume growth in simulations mimicking the sampling in Li et al. in <xref ref-type="fig" rid="app2fig6">Appendix 2—figure 6</xref>.</p><fig id="app2fig5" position="float"><label>Appendix 2—figure 5.</label><caption><title>Distributions of parent-offspring direction cosines <inline-formula><mml:math id="inf162"><mml:mrow><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for the Li et al. 3D sequencing data.</title><p>Direction angles <inline-formula><mml:math id="inf163"><mml:mi>θ</mml:mi></mml:math></inline-formula> are computed from high-spatial-resolution (genotyped) samples of the tumours T1 (left) and T2 (right), after having applied the clustering scheme of 11 to obtain clones from the list of sample genotypes.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app2-fig5-v1.tif"/></fig><fig id="app2fig6" position="float"><label>Appendix 2—figure 6.</label><caption><title>Distributions of parent-offspring direction cosines <inline-formula><mml:math id="inf164"><mml:mrow><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for sampling mimicking the spatial sampling of <xref ref-type="bibr" rid="bib33">Li et al., 2022</xref> of 3D simulations under volume (red) and surface (blue) growth.</title><p>Direction cosines are taken from samples in layers of 3D tumour hemispheres following the sample coordinates of Li et al. for tumour T1 (left) and T2 (right) for direct comparison with <xref ref-type="fig" rid="app2fig5">Appendix 2—figure 5</xref>. Simulation parameters are as in <xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2</xref>, but no cross-section is taken. Volume growth shows a small downward trend, corresponding to a small radially inward bias. This may be due to the geometric effect discussed in Appendix 2.1 (Step 2).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app2-fig6-v1.tif"/></fig></sec></app><app id="appendix-3"><title>Appendix 3</title><sec sec-type="appendix" id="s14"><title>Mutation density on rings</title><p>Surface growth and volume growth can also be distinguished by looking at the accumulation of mutations with increasing distance to the tumour centre of mass, without the need to explicitly infer parent-offspring relationships. Under volume growth, mutations are distributed uniformly in space, whereas under surface growth cells at the surface accumulate mutations at a constant rate as the population grows radially. The latter results in an increasing mutation density (per volume or per area) as a function of distance from the centre of mass.</p><p>In this section, we look at the mutation density as a function of distance. We plot the number of mutations found within a ring of radius <inline-formula><mml:math id="inf165"><mml:mi>r</mml:mi></mml:math></inline-formula> and width <inline-formula><mml:math id="inf166"><mml:mi>w</mml:mi></mml:math></inline-formula> against <inline-formula><mml:math id="inf167"><mml:mi>r</mml:mi></mml:math></inline-formula> and normalize by the number of cells or samples in the ring. To this end, we</p><list list-type="order"><list-item><p>set the origin to the tumour centre of mass</p></list-item><list-item><p>select the ring width <inline-formula><mml:math id="inf168"><mml:mi>w</mml:mi></mml:math></inline-formula> at least larger than the distance to nearest neighbours</p></list-item><list-item><p>for each ring with radius <inline-formula><mml:math id="inf169"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula></p><list list-type="alpha-lower"><list-item><p>take all samples within <inline-formula><mml:math id="inf170"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf171"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:math></inline-formula></p></list-item><list-item><p>count the mutations in each sample and sum up all counts</p></list-item><list-item><p>divide the total count by the number of samples in the ring to obtain the density</p></list-item></list></list-item></list><fig id="app3fig1" position="float"><label>Appendix 3—figure 1.</label><caption><title>Mutation density curves for sampling in 3D simulations.</title><p>We show the mean mutation density within a ring of radius <inline-formula><mml:math id="inf172"><mml:mi>r</mml:mi></mml:math></inline-formula> and width <inline-formula><mml:math id="inf173"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math></inline-formula> (see text). Each curve is averaged over 20 simulations, coloured ribbons indicate the standard deviations from the mean. For each simulation under volume growth (red, <inline-formula><mml:math id="inf174"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math></inline-formula>) and surface growth (blue, <inline-formula><mml:math id="inf175"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>6.0</mml:mn></mml:mrow></mml:math></inline-formula>), we take a cross-section and apply a spatial sampling with 285 samples (high spatial resolution) as described in the text. The right hand side shows simulations with zero death rate <inline-formula><mml:math id="inf176"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.0</mml:mn></mml:mrow></mml:math></inline-formula>. On the left, (relative) death rates are high, <inline-formula><mml:math id="inf177"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula> for volume growth and <inline-formula><mml:math id="inf178"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:math></inline-formula> for surface growth (see also <xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app3-fig1-v1.tif"/></fig><fig id="app3fig2" position="float"><label>Appendix 3—figure 2.</label><caption><title>Mutation density curves for single cells in 3D simulations.</title><p>Same as in <xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1</xref> but for single cells under volume (red) and surface growth (blue) at high (left) and low (right) death rates.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app3-fig2-v1.tif"/></fig><p>To mimic the sampling scheme in <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>, we take a thin planar cross-section through the centre of mass as described in Appendix 1. Given the sample number of circa <inline-formula><mml:math id="inf179"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>285</mml:mn></mml:mrow></mml:math></inline-formula> samples used throughout, the nearest neighbour distance is always below 7 cell diameters, which is why we choose the ring width to be 7 cell diameters for both single cells and samples.</p><p>We model stochastic effects in sequencing by setting a low coverage of 5 total reads per mutant site per sample and drawing alternate and reference reads from to a binomial distribution with the expected number of mutant reads given by the mutation frequency.</p><p>We then measure mutation densities, either for the full population of single cells in the plane or under the sampling scheme.</p><p>The mutation density versus ring radius <inline-formula><mml:math id="inf180"><mml:mi>r</mml:mi></mml:math></inline-formula> is flat for volume growth (see <xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1</xref>) because all cells divide at the same rate regardless of their radial position. The mutation density therefore assumes a value given by the number of mutations a cell is expected to accumulate until the given tumour size <inline-formula><mml:math id="inf181"><mml:mi>N</mml:mi></mml:math></inline-formula>: After <inline-formula><mml:math id="inf182"><mml:mi>T</mml:mi></mml:math></inline-formula> generations (cell divisions) each cell has accumulated <inline-formula><mml:math id="inf183"><mml:mrow><mml:mi>m</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mtext/><mml:mi>Poisson</mml:mi></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mi>μ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> mutations. Notably, a cell that is born after <inline-formula><mml:math id="inf184"><mml:msub><mml:mi>T</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> generations inherits its parents mutations and ends up with <inline-formula><mml:math id="inf185"><mml:mrow><mml:mi>m</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mtext/><mml:mi>Poisson</mml:mi></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>μ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mtext/><mml:mi>Poisson</mml:mi></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>μ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mtext/><mml:mi>Poisson</mml:mi></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mi>μ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> mutations. Consider a ring of radius <inline-formula><mml:math id="inf186"><mml:mi>r</mml:mi></mml:math></inline-formula> with <inline-formula><mml:math id="inf187"><mml:mi>n</mml:mi></mml:math></inline-formula> cells. Due to the high dispersion of cells under volume growth, the number of divisions <inline-formula><mml:math id="inf188"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is independent for different cells <inline-formula><mml:math id="inf189"><mml:mi>i</mml:mi></mml:math></inline-formula> in the ring at radius and the number of mutations is again Poisson-distributed <inline-formula><mml:math id="inf190"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder></mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mtext/><mml:mi>Poisson</mml:mi></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder></mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>μ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The expected mutation density <inline-formula><mml:math id="inf191"><mml:mrow><mml:mo form="prefix" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">⟩</mml:mo><mml:mo>=</mml:mo><mml:mo form="prefix" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mi>/</mml:mi><mml:mi>n</mml:mi><mml:mo form="postfix" stretchy="false">⟩</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mspace width="0.1667em"/></mml:mrow><mml:mi>N</mml:mi><mml:mi>/</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> and standard deviation <inline-formula><mml:math id="inf192"><mml:mrow><mml:mtext>std</mml:mtext><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">⟨</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">⟩</mml:mo><mml:mi>/</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> describe the mutation density curves under volume growth.</p><p>For surface growth, the mutation density increases as a straight line, see <xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1</xref>. At zero death rate, the mutation density is compatible with a linear dependence on the radial distance. However, at a finite death rates there is a clear vertical offset, with a finite mutation density at zero distance. This is because at a finite death rate, cells die uniformly over the tumour volume, and this allows for the division of other cells in their vicinity. Hence, the higher the rate of cell death, the more cells divide also in the bulk of the tumour; the effect of spatial constraints thus diminishes with the death rate. As a result, for a model of surface growth based on local tumour cell densities, the distinction between the surface and volume growth disappears at high rates of cell death. Importantly, this is not a failure of a metric designed to distinguish between different growth modes, but both modes becoming asymptotically the same at high death rates, with cells dividing uniformly throughout the tumour volume. Specifically, the results shown in <xref ref-type="fig" rid="fig2">Figure 2B</xref> of the main text and <xref ref-type="fig" rid="app2fig5">Appendix 2—figure 5</xref> of a flat distribution of direction angles (or direction cosines in the 3D case) show that there is no enhanced cell growth near the edge of the tumour. However, it is possible that surface growth would manifest itself in a tumour that grows more slowly.</p></sec><sec sec-type="appendix" id="s15"><title>3.1 A model of surface growth with explicit spatial dependence</title><p>To probe the distinction of surface growth and volume growth at different rates of cell death, we briefly discuss an alternative model of surface growth. Instead of spatial constraints leading to a density-dependent growth rate (see Appendix 1), we make the rate of cell division explicitly depend on the spatial position of each cell. For concreteness, we consider a division rate that is zero in the tumour centre and increases with the radial distance <inline-formula><mml:math id="inf193"><mml:mi>r</mml:mi></mml:math></inline-formula> from the tumour centre to <inline-formula><mml:math id="inf194"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>.</mml:mi></mml:mrow></mml:math></inline-formula> at its edge,<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi>b</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf195"><mml:mi>R</mml:mi></mml:math></inline-formula> denotes the radius of the tumour, which changes during the simulation, while the parameters edge division rate <inline-formula><mml:math id="inf196"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, edge width <inline-formula><mml:math id="inf197"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:math></inline-formula> and the profile steepness <inline-formula><mml:math id="inf198"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> are initially set. Under this model, cells in the bulk cease to divide as the edge proceeds to grow outwards. Consequently, the mutation density in the bulk does not increase over time. <xref ref-type="fig" rid="app3fig3">Appendix 3—figure 3</xref> shows that under the model where the cell division rate depends on the local density, the surface growth mode has a flat mutation density curve in the high death rate limit because the high turnover allows cells in the tumour bulk to divide at the rate of cell death. In contrast, the mutation density profiles of simulations with explicit spatial dependence of the division rate <inline-formula><mml:math id="inf199"><mml:mi>b</mml:mi></mml:math></inline-formula> on the radial position cells collapse to a line with positive slope when rescaled by the effective mutation rate <inline-formula><mml:math id="inf200"><mml:mrow><mml:mi>μ</mml:mi><mml:mi>/</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The dependence of the scale on the turnover rate <inline-formula><mml:math id="inf201"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula> is simply given by the number of generations <inline-formula><mml:math id="inf202"><mml:mi>T</mml:mi></mml:math></inline-formula> to reach size <inline-formula><mml:math id="inf203"><mml:mi>N</mml:mi></mml:math></inline-formula> with <inline-formula><mml:math id="inf204"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mrow><mml:mspace width="0.1667em"/><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p><fig id="app3fig3" position="float"><label>Appendix 3—figure 3.</label><caption><title>Mutation density profiles under different growth models.</title><p>The mutation density is shown as a function of the ring radius for the model of position-dependent surface growth (with a division rate <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> nearly zero below the surface), for the density-dependent surface growth model, and under volume growth. Rescaling mutation densities by <inline-formula><mml:math id="inf205"><mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> collapses the radial model and the volume growth model to a single curve. Settings for 3D simulations under all models are as in <xref ref-type="fig" rid="app3fig2">Appendix 3—figure 2</xref>: <inline-formula><mml:math id="inf206"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>40000</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf207"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>.</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf208"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app3-fig3-v1.tif"/></fig><p>On the other hand, when cells at the center cannot divide even at low density, any positive cell death rate <inline-formula><mml:math id="inf209"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> leads to a regions without cells (mimicking a necrotic core), which gets larger with higher turnover rate <inline-formula><mml:math id="inf210"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula>.</p><p>Simulations of this model of explicit spatial dependence produce the same signature of surface growth in their distribution of directional angles as found in Appendix 2 for the model of surface growth.</p></sec><sec sec-type="appendix" id="s16"><title>3.2 Mutation density in the Ling et al. data</title><p><xref ref-type="fig" rid="app3fig4">Appendix 3—figure 4</xref> shows the mutation density versus the distance from the tumour centre for the 285 samples from Ling et al. which have been genotyped. The resulting curve is compatible with a flat line, corresponding to a growth mode where new mutations arise uniformly throughout the volume.</p><fig id="app3fig4" position="float"><label>Appendix 3—figure 4.</label><caption><title>Mutation density curve of genotyped samples.</title><p>The 285 samples from Ling et al. that have been genotyped have a mean nearest neighbour distance of about 1.5mm. Choosing a ring width of 2.5mm allows us to define 8 rings around the samples' centre of mass. The horizontal error bars indicate that samples can fall anywhere in this 2.5mm window. Vertical error bars were estimated using the standard deviation of the mutation density under volume growth derived in the text <inline-formula><mml:math id="inf211"><mml:mrow><mml:mtext>std</mml:mtext><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">⟨</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">⟩</mml:mo><mml:mi>/</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>, where we use the measured value of <inline-formula><mml:math id="inf212"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> in place of <inline-formula><mml:math id="inf213"><mml:mrow><mml:mo form="prefix" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula> to estimate the error. We found in numerical simulations that this yields a lower bound on the error in 3D simulations with sampling. The curve can be considered flat if the change in value is of the same scale as the error. Our null model is volume growth, therefore, a lower-bound of the error estimate favors rejecting flatness of the curve (the signature of volume growth), thus making the estimate conservative. The flat shape of the mutation density curve is again consistent with volume growth rather than surface growth. Rings at radius 50 (centre) and 450 (edge) contain only 2 samples each and were thus dropped.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app3-fig4-v1.tif"/></fig><p>Throughout this analysis, we focused on the mutation <italic>density</italic>, rather than the number of mutations found in a ring. The reason is that the area of a ring of fixed width increases linearly with the radius <inline-formula><mml:math id="inf214"><mml:mi>r</mml:mi></mml:math></inline-formula> of the ring (for a small width). For this reason, under volume growth, the <italic>number of mutations</italic> in a ring increases linearly with its radius.</p></sec><sec sec-type="appendix" id="s17"><title>3.3 Mutation density on shells in 3D</title><p>Extending the measurement of the radial change in mutation density to samples taken in a 3D spherical tumour requires only a minor adjustment to the definition as presented in the beginning of Appendix 3. Instead of a ring of radius <inline-formula><mml:math id="inf215"><mml:mi>r</mml:mi></mml:math></inline-formula> we now consider a spherical shell of width <inline-formula><mml:math id="inf216"><mml:mi>w</mml:mi></mml:math></inline-formula> containing the samples with a radial distance within <inline-formula><mml:math id="inf217"><mml:mi>r</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf218"><mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:math></inline-formula> from the tumour centre. The mutation density is the ratio between total count of mutations summed across samples and the number of samples in a given shell.</p><fig id="app3fig5" position="float"><label>Appendix 3—figure 5.</label><caption><title>Mutation density curve of tumour T1 (left) and T1-like sampling in simulations (centre and right).</title><p>The plots show mutation density for spherical shells at different distances <inline-formula><mml:math id="inf219"><mml:mi>r</mml:mi></mml:math></inline-formula> from the tumour center. The left plot is based on the 153 genotyped samples from 9 slices of T1 that report the presence or absence of mutations found by whole-genome sequencing of 16 samples. The other two plots show mutation density as a function of shell radius <inline-formula><mml:math id="inf220"><mml:mi>r</mml:mi></mml:math></inline-formula> in simulations of 3D spherical tumours under T1-like sampling. Within each simulation 16 samples are taken from 3 slices for sequencing and 153 samples from 9 slices to check for the presence of the detected mutations. The positions of slices and samples are specified by T1. Parameters of the 3D simulations are as in <xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app3-fig5-v1.tif"/></fig><fig id="app3fig6" position="float"><label>Appendix 3—figure 6.</label><caption><title>Mutation density curve of tumour T2 (left) and T2-like sampling in simulations (centre and right).</title><p>The plots show mutation density for spherical shells at different distances <inline-formula><mml:math id="inf221"><mml:mi>r</mml:mi></mml:math></inline-formula> from the tumour center. The left plot is based on the 151 genotyped samples from 6 slices of T2 that report the presence or absence of mutations found by whole-genome sequencing of 9 samples. The two plots for simulations (middle and right) are analogous to <xref ref-type="fig" rid="app3fig5">Appendix 3—figure 5</xref> but with T2-like sampling.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app3-fig6-v1.tif"/></fig><p><xref ref-type="fig" rid="app3fig2">Appendix 3—figure 2</xref> shows the mutation density on rings as a function of the radius for single cells of planar cuts through simulated 3D spherical tumours. The corresponding curves for single cells on spherical shells at different radii of the simulated tumours are virtually identical to the mutation density in rings of the cross section. As expected, the density of mutations is independent of the radius for volume growth and increases with radius under surface growth.</p><p>However, imitating the sampling scheme of Li et al. in simulations, as explained in Appendix 2.2, shows a poorer distinction between the two modes of growth, see <xref ref-type="fig" rid="app3fig5">Appendix 3—figure 5</xref> and <xref ref-type="fig" rid="app3fig6">Appendix 3—figure 6</xref>. The radial increase in mutation density under surface growth is dampened in particular at the tumour surface. Under volume growth the curve is still flat (within the error margins). The mutation density calculated for tumours T1 and T2 has a considerably larger decrease near the surface. The slight decrease at high <inline-formula><mml:math id="inf222"><mml:mi>r</mml:mi></mml:math></inline-formula> seen both in the empirical data and the simulations might be caused by the uneven sampling for whole-genome sequencing: WGS samples are taken from few slices mostly inside the tumour and might miss mutations that appear near the surface.</p><p>We note here that these results appear to contradict findings in <xref ref-type="bibr" rid="bib33">Li et al., 2022</xref> concerning the distribution of mutations across the tumour. Specifically, Li et al. state that ‘peripheral regions not only accumulated more mutations, but also contained more changes in genes related to cell proliferation and cell cycle function’ and ‘Phylogenetic trees show that branch lengths vary greatly with the long-branched subclones tending to occur in peripheral regions’. We find that the classification of samples into ‘centre’ and ‘periphery’ by Li et al. does not coincide with the distance of samples from the centre of the tumour, see <xref ref-type="fig" rid="app3fig7">Appendix 3—figure 7</xref>. For tumour T1, there are several samples labeled as ‘centre’ are further from the centre as some samples classified as ‘periphery’, for example L1. Furthermore, the samples labeled ‘centre’ have mutations that belong to a single clade (see Fig. 5 in <xref ref-type="bibr" rid="bib32">Lewinsohn et al., 2023</xref>), which suggest that the classification scheme mixes spatial and genomic information.</p><fig id="app3fig7" position="float"><label>Appendix 3—figure 7.</label><caption><title>Clone sizes and terminal branch lengths (TBL) for genotyped mutations in Li et al. WGS samples.</title><p>The plots on the left (right) show the number of mutations (terminal branch length) of clones in the WGS samples of tumour T1 (top) and T2 (bottom) against the radial position relative to the tumour center of mass in mm on the x-axis. The size of markers indicates abundance of the clone within the sample and colors are determined by the classification of samples by Li et al. into “periphery” and “center”. Samples marked as peripheral have higher terminal branch lengths but in the case of T1 are not located closer to the tumour boundary than those marked as central.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app3-fig7-v1.tif"/></fig></sec><sec sec-type="appendix" id="s18"><title>3.4 SDevo analysis on simulated volume growth</title><p>In this section, we compare our finding of volume growth in the <xref ref-type="bibr" rid="bib33">Li et al., 2022</xref> to the recent result of <xref ref-type="bibr" rid="bib32">Lewinsohn et al., 2023</xref>. In a phylogenetic analysis of the <xref ref-type="bibr" rid="bib33">Li et al., 2022</xref>, Lewinsohn et al. found a significantly elevated rate of cell birth (relative to death) near the edge of the tumour, compared to the tumour’s core. This is at variance with our result on the same data, which showed no signal of the outward growth associated with surface growth. We show that the result of <xref ref-type="bibr" rid="bib32">Lewinsohn et al., 2023</xref> is compatible with volume growth: we demonstrate that the phylogenetic analysis of <xref ref-type="bibr" rid="bib32">Lewinsohn et al., 2023</xref> produces a signal of surface growth also on artificial data from a volume growth model, when samples are placed precisely as in the empirical data by Li et al. and analysed as in <xref ref-type="bibr" rid="bib32">Lewinsohn et al., 2023</xref>.</p><p>We grew a population from a single cell to size 40,000 in 3D at a relative rate of cell death <inline-formula><mml:math id="inf223"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and on average <inline-formula><mml:math id="inf224"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> mutations per generation. The growth mode was volume growth as described in Appendix 1. Repeating the analysis at <inline-formula><mml:math id="inf225"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mi>.</mml:mi><mml:mn>2</mml:mn><mml:mo separator="true">,</mml:mo><mml:mi>.</mml:mi><mml:mn>4</mml:mn><mml:mo separator="true">,</mml:mo><mml:mi>.</mml:mi><mml:mn>6</mml:mn><mml:mo separator="true">,</mml:mo><mml:mi>.</mml:mi><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula> gave similar results. Samples of typically 30 cells were taken from the same positions they were taken from in tumours T1 and T2 of <xref ref-type="bibr" rid="bib33">Li et al., 2022</xref>, respectively. Samples were classified following the classification used in Extended Data Fig. 7 of <xref ref-type="bibr" rid="bib32">Lewinsohn et al., 2023</xref>. In this scheme, the samples with distance from the centre higher than 0.9 of the tumour’s radius are classified as ‘edge samples’, those with distance less than this threshold are classified as ‘core samples’. This classification differs from that that used in the main text of Lewinsohn et al., which uses the classification introduced in <xref ref-type="bibr" rid="bib33">Li et al., 2022</xref> briefly discussed in this Appendix 3.3. As the latter classification is not based on distance alone, we will not pursue it here.</p><p>We then applied the algorithm SDevo developed in <xref ref-type="bibr" rid="bib32">Lewinsohn et al., 2023</xref> with the parameters provided in xml-template-files by Lewinsohn et al. on the Github page <ext-link ext-link-type="uri" xlink:href="https://github.com/blab/spatial-tumor-phylodynamics">https://github.com/blab/spatial-tumor-phylodynamics</ext-link> (<xref ref-type="bibr" rid="bib31">Lewinsohn, 2023</xref>).</p><p>20 shows the resulting distribution of inferred birth rates in the edge and core parts of the tumours across 30 different simulated tumours grown under volume growth. The mean ratio of the inferred birthrates in the edge versus centre samples was 1.47 (95% interval [0.03, 49.7]), even though for volume growth this ratio should be one, or close to one. Specifically, this ratio is higher, and hence the spurious signal for surface growth is stronger, than what Lewinsohn et al. found in the empirical data: Extended Data Fig. 7 of <xref ref-type="bibr" rid="bib32">Lewinsohn et al., 2023</xref> reports the estimated birth rate ratio (edge/core) of 1.15 for tumour T1.</p><p>For samples placed as in tumour T2, we found a mean growth rate ratio of 6.98 (95% interval [0.07,33.12]), compared to 3.89 reported for tumour T2 in Extended Data Fig. 7 of <xref ref-type="bibr" rid="bib32">Lewinsohn et al., 2023</xref>. From <xref ref-type="fig" rid="app3fig8">Appendix 3—figure 8</xref> we conclude that in many cases of artificial tumours grown under volume growth, SDevo detects a higher birth rate in samples near the edge of the tumour, and therefore does not reliably differentiate between surface and volume growth.</p><p>A potential cause for this result is the sampling probabilities. The inference of birth-death model parameters from a phylogenetic tree generally depends on estimates of the probability that an individual from a (possibly large) population was sampled (<xref ref-type="bibr" rid="bib55">Stadler, 2009</xref>). Correspondingly, SDevo requires estimates of the sampling probabilities in the core/edge regions of the tumour as input parameters. From the xml files referenced above we found these parameters were set to 0.2 and 0.1 for the core and edge, respectively. We estimated the sampling probabilities by measuring tumour volume in units of closely packed spheres of the size of samples. Specifically, we calculated the number of samples in a particular part of the tumour (core or edge) divided by the number of spheres of the size of samples that fit into the corresponding volume (edge or core region of a particular tumour) under close packing. This gave <inline-formula><mml:math id="inf226"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mtext>core</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mi>.</mml:mi><mml:mn>00006</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf227"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mtext>edge</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mi>.</mml:mi><mml:mn>00012</mml:mn></mml:mrow></mml:math></inline-formula> for T1 and <inline-formula><mml:math id="inf228"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mtext>core</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mi>.</mml:mi><mml:mn>00004</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf229"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mtext>edge</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mi>.</mml:mi><mml:mn>00024</mml:mn></mml:mrow></mml:math></inline-formula> for T2, much lower than the sampling probabilities used in <xref ref-type="bibr" rid="bib32">Lewinsohn et al., 2023</xref>. The absolute sampling probabilities (not just the relative one between edge and core) can in principle affect the inference results, because the inferred death rate depends non-homogeneously on the sampling probability (<xref ref-type="bibr" rid="bib55">Stadler, 2009</xref>), and birth and death rate are inferred relative to one another. However, there is a difference even in the relative sampling probability of core and edge regions between our estimates and the parameters used in <xref ref-type="bibr" rid="bib32">Lewinsohn et al., 2023</xref>; the ratio of sampling probabilities is 2 (core relative to edge) in <xref ref-type="bibr" rid="bib32">Lewinsohn et al., 2023</xref> and about 1/2 in our estimate for T1 and 1/6 for T2.</p><p>To test this hypothesis by running SDevo with the sampling probabilities as estimated here, however, this not not lead to qualitatively different results. Further work would be needed to determine the capabilities and the limitations of the SDevo algorithm (<xref ref-type="bibr" rid="bib32">Lewinsohn et al., 2023</xref>).</p><fig id="app3fig8" position="float"><label>Appendix 3—figure 8.</label><caption><title>Birth rates for periphery and center inferred with SDevo from simulations of volume growth with spatial sampling.</title><p>We run 30 simulations in 3D to a population size <inline-formula><mml:math id="inf230"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>40000</mml:mn></mml:mrow></mml:math></inline-formula> at rates <inline-formula><mml:math id="inf231"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>.</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf232"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mi>.</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf233"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mi>.</mml:mi></mml:mrow></mml:math></inline-formula> and take punch samples for deep sequencing at positions specified in <xref ref-type="bibr" rid="bib33">Li et al., 2022</xref> for tumours T1 and T2. We only call mutations exceeding a 0.3 cellular fraction threshold within a sample as specified in <xref ref-type="bibr" rid="bib32">Lewinsohn et al., 2023</xref> and use the template xml file provided by Lewinsohn et al. to generate inputs for the SDevo algorithm. Each simulation shows a violin plot of inferred birth rates (95% interval of last 500 sampled states of the MCMC-chain in SDevo) for samples labeled as ‘centre', samples labeled as ‘edge', and the ratios of the two rates, as in Figure 5 of <xref ref-type="bibr" rid="bib32">Lewinsohn et al., 2023</xref>. A circle marker for each violin plot indicates the values at the maximum likelihood, which often falls outside the 95% interval of the last 500 sampled states.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app3-fig8-v1.tif"/></fig></sec></app><app id="appendix-4"><title>Appendix 4</title><sec sec-type="appendix" id="s19"><title>Spatial dispersion of cells</title><p>We quantify how clones are dispersed throughout the tumour, using the WE-sequencing data of <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref> and <xref ref-type="bibr" rid="bib33">Li et al., 2022</xref>. Rather than looking at sum of spatial distances between cells with a particular mutation, we define a dispersion parameter as these sum of distances relative to those in a dense packing of cells. The dispersion parameter is one for a (hypothetical) dense and spherical arrangement of cells carrying a particular mutation, and larger than one if these cells are dispersed within the tumour (with cells not carrying that mutation between them). For each mutation <inline-formula><mml:math id="inf234"><mml:mi>m</mml:mi></mml:math></inline-formula> we compute the dispersion parameter <inline-formula><mml:math id="inf235"><mml:msub><mml:mi>σ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> as follows:</p></sec><sec sec-type="appendix" id="s20"><title>4.1 Algorithmic description</title><list list-type="order"><list-item><p>Obtain all mutant clades and compute whole-tumour frequencies</p></list-item><list-item><p>Discard mutations that occur in a single sample or fall below a resolution threshold <inline-formula><mml:math id="inf236"><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math></inline-formula></p></list-item><list-item><p>Estimate the sample density <inline-formula><mml:math id="inf237"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> as the number of samples devided by the sampled surface area</p></list-item><list-item><p>For each mutant clade <inline-formula><mml:math id="inf238"><mml:mi>m</mml:mi></mml:math></inline-formula> do</p><list list-type="alpha-lower"><list-item><p>obtain the frequencies (cancer cell fractions) <inline-formula><mml:math id="inf239"><mml:msubsup><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula> of mutation <inline-formula><mml:math id="inf240"><mml:mi>m</mml:mi></mml:math></inline-formula> in all samples <inline-formula><mml:math id="inf241"><mml:mi>i</mml:mi></mml:math></inline-formula> of the clade</p></list-item><list-item><p>compute the dense packing radius <inline-formula><mml:math id="inf242"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mrow><mml:munder><mml:mo stretchy="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder></mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mi>/</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false" lspace="0em" rspace="0em">)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula></p></list-item><list-item><p>compute the dense packing dispersion<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>128</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>45</mml:mn><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p> </list-item><list-item><p>compute pairwise distances <inline-formula><mml:math id="inf243"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>|</mml:mi><mml:mover><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false" style="transform:scale(0.75) translate(10%, 30%);">→</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mover><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false" style="transform:scale(0.75) translate(10%, 30%);">→</mml:mo></mml:mover><mml:mi>|</mml:mi></mml:mrow></mml:math></inline-formula> and weights <inline-formula><mml:math id="inf244"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:msubsup><mml:mi>f</mml:mi><mml:mi>j</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula></p></list-item><list-item><p>compute the relative dispersion <inline-formula><mml:math id="inf245"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mtext/><mml:mi>/</mml:mi><mml:mtext/><mml:mrow><mml:munder><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mtext/><mml:mi>/</mml:mi><mml:mtext/><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mtext/><mml:mi>dense</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula></p></list-item></list></list-item><list-item><p>plot the (unweighted) histogram of the values <inline-formula><mml:math id="inf246"><mml:msub><mml:mi>σ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula></p></list-item></list><p>To compute the mean distance of points on a disk, we consider two points on the disk with distance <inline-formula><mml:math id="inf247"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (in units ofthe disk radius <inline-formula><mml:math id="inf248"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) at an angle θ. We note that the probability density <inline-formula><mml:math id="inf249"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is proportional to the area of the disk of radius <inline-formula><mml:math id="inf250"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> with points that have a distance <inline-formula><mml:math id="inf251"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> to another point on the disk at angle θ. This area is given by the intersectof the disk to the disk shifted by r in direction θ. This intersect is segmented by the shift-axis and the orthogonalaxis into four identical circle segments of area <inline-formula><mml:math id="inf252"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>4</mml:mn><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msqrt><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msqrt></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. Considering distance vectors for all θ, the densityfunction <inline-formula><mml:math id="inf253"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is proportional to an additional factor <inline-formula><mml:math id="inf254"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> for the circumference of r-vectors. Normalizing by integration from <inline-formula><mml:math id="inf255"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0 to 2 yields<disp-formula id="equ4"><mml:math id="m4"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi>r</mml:mi><mml:mi>π</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:msqrt><mml:mn>4</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:mi>r</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:msqrt><mml:mn>4</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The mean value of <inline-formula><mml:math id="inf256"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> can then be computed as<disp-formula id="equ5"><mml:math id="m5"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>r</mml:mi><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mi>r</mml:mi><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>128</mml:mn><mml:mrow><mml:mn>45</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Frequencies of mutations within single samples and within the whole tumour are crucial to all quantitative analysis in this work. What we call mutation frequencies are cancer cell fractions (CCF) of mutations in sequencing data which estimate the fraction of cells carrying that mutation. Given a sample with variant allele frequency <inline-formula><mml:math id="inf257"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mtext/><mml:mi>vaf</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (VAF), sample purity ρ and ploidy <inline-formula><mml:math id="inf258"><mml:mi>p</mml:mi></mml:math></inline-formula> we get the mutation’s multiplicity <inline-formula><mml:math id="inf259"><mml:mi>m</mml:mi></mml:math></inline-formula> by rounding <inline-formula><mml:math id="inf260"><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mtext/><mml:mi>vaf</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>⋅</mml:mo><mml:mi>ρ</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ρ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>/</mml:mi><mml:mi>ρ</mml:mi></mml:mrow></mml:math></inline-formula> to the nearest (nonzero) integer and the cancer cell fraction <inline-formula><mml:math id="inf261"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mi>u</mml:mi><mml:mi>/</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>. The whole-tumour frequency of a mutation is its tumour wide cancer cell fraction, computed as the average over samples and weighted by the sample purity (assuming equal sample sizes) <inline-formula><mml:math id="inf262"><mml:mrow><mml:mover><mml:mi>f</mml:mi><mml:mo stretchy="false" class="tml-capshift" style="math-style:normal;math-depth:0;">‾</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>/</mml:mi><mml:mrow><mml:munder><mml:mo stretchy="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder></mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib14">Dentro et al., 2017</xref>).</p><p>To put the algorithm in words, in (1-2) we consider clades of mutations above a whole-tumour frequency cutoff <inline-formula><mml:math id="inf263"><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math></inline-formula>. For a given clade defined by mutation <inline-formula><mml:math id="inf264"><mml:mi>m</mml:mi></mml:math></inline-formula>, we measure the spatial distance <inline-formula><mml:math id="inf265"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, in step 4d between pairs of samples i,j that contain <inline-formula><mml:math id="inf266"><mml:mi>m</mml:mi></mml:math></inline-formula> and assign a weight that estimates the number of single cell pairs that carry <inline-formula><mml:math id="inf267"><mml:mi>m</mml:mi></mml:math></inline-formula> between both samples. The absolute dispersion of mutation <inline-formula><mml:math id="inf268"><mml:mi>m</mml:mi></mml:math></inline-formula> is defined as the weighted average over these pairwise distances. But different mutations have different whole-tumour frequencies and would naturally take up areas of different sizes. We therefore measure dispersion relative to the value of dispersion a clade would have if all cells were densely packed in a disk, as given by step 4e. The dispersion for dense packing can be computed as the mean distance between all points on a disk of radius <inline-formula><mml:math id="inf269"><mml:msub><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> by equation (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref>) in step 4c.</p><p>As in the algorithm for distinguishing surface from volume growth (see Appendix 2), every mutation contributes with equal weight to the computed distribution, here the distribution of dispersion <inline-formula><mml:math id="inf270"><mml:msub><mml:mi>σ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula>. Summary statistics of the dispersion parameter <inline-formula><mml:math id="inf271"><mml:msub><mml:mi>σ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> such as the mean over mutations, or its distribution over mutations show the extent of dispersion and cell migration within the population. To compare dispersion distributions observed in empirical data to those seen in spatial simulations under comparable sampling in the surface and volume growth regimes, we use the (approximate) two-sample Kolmogorov-Smirnov test between the experimental and the simulated distribution. The Kolmogorov-Smirnov (KS) statistic is the maximum distance between the two cumulative distribution functions (cdf) <inline-formula><mml:math id="inf272"><mml:mi>F</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf273"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mi>sup</mml:mi><mml:mi>σ</mml:mi></mml:munder><mml:mo>⁡</mml:mo><mml:mi>|</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo separator="true">,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo separator="true">,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mi>|</mml:mi></mml:mrow></mml:math></inline-formula> with the number samples <inline-formula><mml:math id="inf274"><mml:mi>n</mml:mi></mml:math></inline-formula>,<inline-formula><mml:math id="inf275"><mml:mi>m</mml:mi></mml:math></inline-formula> of the two empirical distributions respectively. <inline-formula><mml:math id="inf276"><mml:mi>D</mml:mi></mml:math></inline-formula> is a measure of how distant the two distributions are from one another and can be used two rank pairs of distributions by similarity. When normalized by the factor <inline-formula><mml:math id="inf277"><mml:msqrt><mml:mrow><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mi>/</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>m</mml:mi><mml:mo form="postfix" stretchy="false" lspace="0em" rspace="0em">)</mml:mo></mml:mrow></mml:msqrt></mml:math></inline-formula> and given a rejection level <inline-formula><mml:math id="inf278"><mml:mi>α</mml:mi></mml:math></inline-formula> (here we use the default <inline-formula><mml:math id="inf279"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>), a p-value can be computed from the statistic <inline-formula><mml:math id="inf280"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> which states how likely it is that the empirical distributions are sampled from the same underlying distribution - that is, a low p-value indicates that the two underlying distributions are significantly different.</p><p>The choice of mean pairwise distance as a measure of dispersion is conceptually simple, but other choices are also possible. Similar measures such as the radius of gyration (root mean square radial displacement) <inline-formula><mml:math id="inf281"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>m</mml:mi><mml:mtext>gyr</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder></mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mi>|</mml:mi><mml:msub><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false" style="transform:scale(0.75) translate(10%, 30%);">→</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mo form="prefix" stretchy="false">⟨</mml:mo><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false" style="transform:scale(0.75) translate(10%, 30%);">→</mml:mo></mml:mover><mml:msub><mml:mo form="postfix" stretchy="false">⟩</mml:mo><mml:mi>m</mml:mi></mml:msub><mml:msup><mml:mi>|</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>/</mml:mi><mml:mrow><mml:munder><mml:mo stretchy="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder></mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> (around the clade center of mass <inline-formula><mml:math id="inf282"><mml:mrow><mml:mo form="prefix" stretchy="false">⟨</mml:mo><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false" style="transform:scale(0.75) translate(10%, 30%);">→</mml:mo></mml:mover><mml:msub><mml:mo form="postfix" stretchy="false">⟩</mml:mo><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder></mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:msub><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false" style="transform:scale(0.75) translate(10%, 30%);">→</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mi>/</mml:mi><mml:mrow><mml:munder><mml:mo stretchy="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder></mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>) yield the same qualitative results and their dispersion under dense packing can readily be calculated as an expectation value over the disk.</p></sec><sec sec-type="appendix" id="s21"><title>4.2 Processing of whole-exome sequencing data</title><p>Fastq files of the sequences were downloaded from <ext-link ext-link-type="uri" xlink:href="https://bigd.big.ac.cn/search/?dbId=gsa&amp;q=PRJCA000091&amp;page=2">https://bigd.big.ac.cn/search/?dbId=gsa&amp;q=PRJCA000091&amp;page=2</ext-link>; <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>. Fastq files were processed using our in-house mapping pipeline based on GATK4 (version 4.1.0.0 from DockerHUB). We used GRCh37.p13 as the reference genome and gencode.v19 as the annotation file. Singletons, and reads with less than 70 bp were discarded. Additionally, we excluded known variants in the human population (taken from <ext-link ext-link-type="uri" xlink:href="https://data.broadinstitute.org">https://data.broadinstitute.org</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://ftp.ncbi.nih.gov/">https://ftp.ncbi.nih.gov/</ext-link>). We used the interval bed file S02972011 from SureSelect all human exon version 3. Variant calling and initial filtering was performed with Mutect2 (GATK), using the joint variant caller mode and applying the optional filter.</p><p>We focus on the high-depth WES data instead of the set of genotyped samples for two reasons: Firstly, because dispersion, unlike the directional growth bias and the turnover, is based on individual mutations alone, we do not need to infer clones or parent-offspring relationships and can effectively leverage the sample frequencies from whole-exome sequencing. Secondly, the distribution of dispersion values turns out to be very noisy for the set of 35 mutations probed by genotyping in the high-spatial-resolution data. However, we have measured the dispersion parameter for this small set of mutations both in the WES samples and the genotyped samples and found that their respective dispersion distribution shows the same large tail as the dispersion distribution of the 217 subclonal SNVs detected by Mutect (see main text, <xref ref-type="fig" rid="fig3">Figure 3</xref>).</p><p>To compute the dispersion parameter for the WE-sequencing data of Ling et al., we call mutations using Mutect 2 which jointly calls on all 23 samples. We obtain 238 subclonal SNVs by imposing the following filters: a given SNV, (1) passes Mutect’s filters, (2) has no supporting ALT reads in the normal sample, (3) has 5 or more supporting reads in total, (4) has a total of 150 or more reads (coverage), and (5) has a whole-tumour frequency (CCF) <inline-formula><mml:math id="inf283"><mml:msub><mml:mover><mml:mi>f</mml:mi><mml:mo stretchy="false" class="tml-capshift" style="math-style:normal;math-depth:0;">‾</mml:mo></mml:mover><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> between 0.025 and 0.3 (subclonal). The criteria (2–4) are adopted from the variant calling by Ling et al. (2 and 3) eliminate false positives, (4) assures accuracy in the estimation of mutant frequencies while at the same time also reducing the effective genome size (see main text, ‘Cell turnover’). Setting a lower bound on the number of supporting alternate reads, filter (3) determines the resolution of mutant frequencies.</p><p>Regarding the cutoffs on whole-tumour frequencies (5), the CCF-sprectrum consists of two clearly distinct clusters: Clonal mutations forming a large gaussian peak near <inline-formula><mml:math id="inf284"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msqrt><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:msqrt></mml:mrow></mml:mstyle></mml:math></inline-formula> and subclonal neutral mutations at low frequencies following a power-law decay, with very few mutations falling around <inline-formula><mml:math id="inf285"><mml:mrow><mml:msub><mml:mover><mml:mi>f</mml:mi><mml:mo stretchy="false" class="tml-capshift" style="math-style:normal;math-depth:0;">‾</mml:mo></mml:mover><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> inbetween the two profiles. We found that imposing an upper cutoff at <inline-formula><mml:math id="inf286"><mml:mrow><mml:msub><mml:mover><mml:mi>f</mml:mi><mml:mo stretchy="false" class="tml-capshift" style="math-style:normal;math-depth:0;">‾</mml:mo></mml:mover><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula> fully removes clonal mutations while recovering most subclonal mutations. The distribution of <inline-formula><mml:math id="inf287"><mml:mi>σ</mml:mi></mml:math></inline-formula> turns out to depend on the minimum whole-tumour frequency of mutations, therefore, we also need to set a cutoff on <inline-formula><mml:math id="inf288"><mml:msub><mml:mover><mml:mi>f</mml:mi><mml:mo stretchy="false" class="tml-capshift" style="math-style:normal;math-depth:0;">‾</mml:mo></mml:mover><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> at the lower end of the SFS CCF-spectrum in order to compare with simulations. This dependence is linked to the size of the tumour when specific mutations arose, see Appendix 7. The distribution of σ turns out to depend on the minimum whole-tumour frequency of mutations, therefore, we need to set a cutoff on <inline-formula><mml:math id="inf289"><mml:msub><mml:mover><mml:mi>f</mml:mi><mml:mo stretchy="false" class="tml-capshift" style="math-style:normal;math-depth:0;">‾</mml:mo></mml:mover><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> at the lower end of the SFS in order to compare with simulations. This dependence is linked to the size of the tumour when specific mutations arose, see Appendix 7.</p><p>We choose a minimum whole-tumour frequency of <inline-formula><mml:math id="inf290"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mn>40</mml:mn></mml:mrow></mml:math></inline-formula>, because this is the frequency in the SFS below which the number of detected mutations drops rapidly, as can be seen from the saturation in the cumulative SFS (see <xref ref-type="fig" rid="app5fig2">Appendix 5—figure 2</xref>). The cumulative SFS counts the number of mutations with frequency larger or equal to <inline-formula><mml:math id="inf291"><mml:mi>f</mml:mi></mml:math></inline-formula> as a function of <inline-formula><mml:math id="inf292"><mml:mrow><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:math></inline-formula>. It is monotonically increasing and would extend to the smallest mutation frequency but effectively flattens below the sequencing resolution <inline-formula><mml:math id="inf293"><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math></inline-formula>. Beyond <inline-formula><mml:math id="inf294"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mn>40</mml:mn></mml:mrow></mml:math></inline-formula> the sequencing disproportionately misses low frequency mutations which would be relevant to the comparison with simulations at cutoffs lower than <inline-formula><mml:math id="inf295"><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math></inline-formula> for the dispersion parameter.</p></sec><sec sec-type="appendix" id="s22"><title>4.3 Dispersion in two dimensions</title><p>We compare the dispersion parameter in the data of Ling et al. to simulations of populations growth to 40,000 cells under volume growth (<inline-formula><mml:math id="inf296"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math></inline-formula>) and surface growth (<inline-formula><mml:math id="inf297"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula>) which we sample to mimic the spatial sampling of <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref> as described in Appendix 1.2. For each simulated 3D tumour, we take a planar cross-section through the centre of mass and cover the plane with a triangular lattice that fits 23 samples of 20 cells each at its nodes. To mimic stochastic effects in sequencing, in each sample and for each mutant we draw a binomially distributed number of alternate reads given the true frequency and a read depth of 20 reads. These choices follow from the sequencing depth in the WES data of Ling et al., which has a mean coverage of 20 reads per sample. In the simulations, samples consist of 20 cells, which allows for a sequencing depth that is sufficiently high to resolve whole-tumour mutation frequencies even below 1/40. In fact, given the limited sequencing depth we found that increasing the sample size has no effect on the distribution of dispersion parameter.</p><p>We compute whole-tumour frequencies <inline-formula><mml:math id="inf298"><mml:msub><mml:mover><mml:mi>f</mml:mi><mml:mo stretchy="false" class="tml-capshift" style="math-style:normal;math-depth:0;">‾</mml:mo></mml:mover><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula>, retain mutants with <inline-formula><mml:math id="inf299"><mml:mrow><mml:msub><mml:mover><mml:mi>f</mml:mi><mml:mo stretchy="false" class="tml-capshift" style="math-style:normal;math-depth:0;">‾</mml:mo></mml:mover><mml:mi>m</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mn>40</mml:mn></mml:mrow></mml:math></inline-formula> - the cutoff used for mutations in the WES data of Ling et al. and determine their dispersion distribution as described above.</p><p>The normalized Kolmogorov-Smirnov statistic and log-p-value between the data and simulations in 3D with sampling (<xref ref-type="fig" rid="app4fig3">Appendix 4—figure 3</xref>) are 5.742 and -65.3 for surface growth and 1.13 and -1.9 for volume growth, confirming that the volume growth regime fits the observed distribution of dispersion parameters much better than the surface growth regime. (A perfect fit, leading to a KS statistics of zero, is not expected, for instance because of fluctuations due to the finite number of mutations.).</p><fig id="app4fig1" position="float"><label>Appendix 4—figure 1.</label><caption><title>Dispersion distributions in simulations including spatial sampling — 2D (left) and 3D (right).</title><p>Histograms of the dispersion parameters under spatial sampling with 23 samples with a sequencing model mimicking the whole-exome sequencing of Ling et al. Samples are taken from populations grown to 10,000 cells in 2D (left) and cross-sections of 3D simulations of populations grown up to 40,000 cells (right). As in Appendix 2, we use the cell division rate <inline-formula><mml:math id="inf300"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, mutation rate <inline-formula><mml:math id="inf301"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula>, as well as cell death rates <inline-formula><mml:math id="inf302"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf303"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula> for volume growth (red) and <inline-formula><mml:math id="inf304"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf305"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math></inline-formula> for surface growth (blue), respectively (see also <xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app4-fig1-v1.tif"/></fig><fig id="app4fig2" position="float"><label>Appendix 4—figure 2.</label><caption><title>Dispersion distributions in simulations with sampling of single cells — 2D (left) and 3D (right).</title><p>Same as in <xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2</xref> but for single cells under volume (red) and surface growth (blue) at the same parameters <inline-formula><mml:math id="inf306"><mml:mrow><mml:mi>b</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>d</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app4-fig2-v1.tif"/></fig><fig id="app4fig3" position="float"><label>Appendix 4—figure 3.</label><caption><title>Normalized Kolmogorov-Smirnov distance between dispersion distributions of Ling et al. data and simulations.</title><p>Each frame compares the histogram of the dispersion values σ of subclonal mutations in the WES data (in green) to that of simulations in 3D with spatial sampling under volume (red) and surface (blue) growth at low and high turnover rates <inline-formula><mml:math id="inf307"><mml:mi>d</mml:mi></mml:math></inline-formula>. Simulation settings are as in <xref ref-type="fig" rid="app4fig1">Appendix 4—figure 1</xref>, right. The KS statistic serves as a measure of distance between the two distributions with smaller values indicating that the data is more likely to match the model. The dispersion observed in the data fits with simulations of volume growth at a high rate of turnover (<inline-formula><mml:math id="inf308"><mml:mrow><mml:mrow><mml:mtext/><mml:mi>KS</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1.13</mml:mn></mml:mrow></mml:math></inline-formula>, bottom right).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app4-fig3-v1.tif"/></fig><p>The same methods apply for uniformly sampled single cells (<inline-formula><mml:math id="inf309"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), see <xref ref-type="fig" rid="app4fig2">Appendix 4—figure 2</xref>, and for the sampling scheme used for <xref ref-type="fig" rid="app4fig1">Appendix 4—figure 1</xref>. However, simulations show that the absolute scale of dispersion <inline-formula><mml:math id="inf310"><mml:msub><mml:mi>σ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> strongly depends on sampling density, namely, the value of mean dispersion (in the volume growth limit) increases as the sampling density gets reduced. It is therefore import to reproduce the sampling settings when comparing simulations to sequencing data.</p></sec><sec sec-type="appendix" id="s23"><title>4.4 Dispersion in three dimensions</title><p>Just like the measure of the direction of mutants in Appendix 2.2, the dispersion can also be computed for samples taken in three dimensions. Only the mean distances of cells in a densely packed sphere <inline-formula><mml:math id="inf311"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>m</mml:mi><mml:mtext>dense</mml:mtext></mml:msubsup></mml:math></inline-formula> is different from that of the two-dimensional disk used in steps 4(b) and 4(c): Given a 3D sample density <inline-formula><mml:math id="inf312"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula>, a mutant occurring with frequencies <inline-formula><mml:math id="inf313"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> in samples <inline-formula><mml:math id="inf314"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> could be packed into a sphere of radius <inline-formula><mml:math id="inf315"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo fence="true" form="prefix">(</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder></mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mi>/</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mi>/</mml:mi><mml:mn>3</mml:mn><mml:mi>π</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo fence="true" form="postfix">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The mean distance of points within this sphere is <inline-formula><mml:math id="inf316"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>m</mml:mi><mml:mtext>dense</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:mn>36</mml:mn><mml:mi>/</mml:mi><mml:mn>35</mml:mn><mml:msub><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. To see this, consider two points x and y within the sphere of radius R on shells of radius <inline-formula><mml:math id="inf317"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>R</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and with an angle θ = ∠(x, y). The distance between the two points is <inline-formula><mml:math id="inf318"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msqrt><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:msqrt></mml:mrow></mml:mstyle></mml:math></inline-formula> , so the average distance for points within the sphere becomes,<disp-formula id="equ6"><mml:math id="m6"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mi>d</mml:mi><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mi>d</mml:mi><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msubsup><mml:mi>d</mml:mi><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msqrt><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:msqrt><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the density functions <inline-formula><mml:math id="inf319"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mo lspace="0em" rspace="0em" class="tml-prime">′</mml:mo></mml:msup><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mo lspace="0em" rspace="0em" class="tml-prime">′</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>/</mml:mi><mml:msup><mml:mi>R</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf320"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mo lspace="0em" rspace="0em" class="tml-prime">′</mml:mo></mml:msup><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mo lspace="0em" rspace="0em" class="tml-prime">′</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>/</mml:mi><mml:msup><mml:mi>R</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> are proportional to the surface area of the sphere with radius <inline-formula><mml:math id="inf321"><mml:msup><mml:mi>r</mml:mi><mml:mo lspace="0em" rspace="0em" class="tml-prime">′</mml:mo></mml:msup></mml:math></inline-formula> and the density function <inline-formula><mml:math id="inf322"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mo lspace="0em" rspace="0em" class="tml-prime">′</mml:mo></mml:msup><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> is proportional to the circumference of the circle defined as the rim of the cone with side length <inline-formula><mml:math id="inf323"><mml:mrow><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mspace width="0.1667em"/></mml:mrow><mml:mrow><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo separator="true">,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo form="postfix" stretchy="false" lspace="0em" rspace="0em">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and opening angle <inline-formula><mml:math id="inf324"><mml:msup><mml:mi>θ</mml:mi><mml:mo lspace="0em" rspace="0em" class="tml-prime">′</mml:mo></mml:msup></mml:math></inline-formula>. The inner integral yields<disp-formula id="equ7"><mml:math id="m7"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msubsup><mml:mi>d</mml:mi><mml:msup><mml:mi>θ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:msqrt><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:msqrt><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>6</mml:mn><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>and the outer integrals can be computed by distinguishing the two cases <inline-formula><mml:math id="inf325"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf326"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> resulting in<disp-formula id="equ8"><mml:math id="m8"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>36</mml:mn><mml:mn>35</mml:mn></mml:mfrac><mml:mi>R</mml:mi><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Based on the corresponding definition of the dispersion parameter, we measure the dispersion of mutants in the whole-genome sequencing (WGS) data of Li et al. The data consists of 16 samples from tumour T1 and 9 samples from tumour T2. The cumulative SFS reaches a plateau at frequency <inline-formula><mml:math id="inf327"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mn>30</mml:mn></mml:mrow></mml:math></inline-formula> for T1 and <inline-formula><mml:math id="inf328"><mml:mrow><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mn>18</mml:mn></mml:mrow></mml:math></inline-formula> for T2, which is the respective whole-tumour frequency resolution, as discussed for the Ling et al in the previous Appendix 4.2. The frequency resolution is lower than in Ling et al., in agreement with the expected linear scaling between the inverse frequency resolution and the number of samples <inline-formula><mml:math id="inf329"><mml:mi>n</mml:mi></mml:math></inline-formula> which can be written as <inline-formula><mml:math id="inf330"><mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub><mml:msub><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mtext>Li</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub><mml:msub><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mtext>Ling</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> given that both studies sequenced at almost the same read depth per sample.</p><p>Whereas in the case of the tumour data of Ling et al., samples were taken nearly spatially uniformly for subsequent deep sequencing analysis, in the two tumours T1 and T2 only few of the slices were used for WGS. To account for this uneven sampling we use the same sample positions in simulated 3D tumours: For each simulation we take slices at specified heights and sample each slice at the positions of the WGS samples from tumours T1 and T2. The resulting distributions of dispersion values for mutants for T1 and the corresponding numerical simulations are shown in <xref ref-type="fig" rid="app4fig4">Appendix 4—figure 4</xref>. The dispersion values observed for tumour T1 are high compared surface growth simulations (as in the 2D data by Ling at al.), and the KS statistics is not compatible with surface growth, see <xref ref-type="fig" rid="app4fig4">Appendix 4—figure 4</xref>.</p><p>In the case of T2, there are insufficient mutations that appear in a sufficiently large number of samples. Out of 150 mutations in T2, only 2 appear in more than 4 samples. (Out of 308 mutations in T1, 58 appear in more than 4 samples.) The dispersion parameter becomes unreliable when the number of samples involved is low; a few samples from a spherical distribution of mutants typically yield artefactual values of σ higher than one, due to the sparse and uneven distribution of samples in space.</p><fig id="app4fig4" position="float"><label>Appendix 4—figure 4.</label><caption><title>Dispersion distribution of tumour T1 and T1-like sampling in simulations.</title><p>The left plot shows dispersion values of 308 mutations with frequencies larger than the frequency resolution <inline-formula><mml:math id="inf331"><mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub><mml:msub><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mtext>T1</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mn>30</mml:mn></mml:mrow></mml:math></inline-formula> based on the 16 WGS samples of T1. The plots on the right show dispersion in simulations of 3D spherical tumours under T1-like sampling, meaning that, from each simulation 16 samples are taken from 3 slices, where the positions of slices and samples are specified by T1. Parameters of the 3D simulations are as in <xref ref-type="fig" rid="app4fig1">Appendix 4—figure 1</xref>. The normalized KS statistic and log-p-value between the data and simulations are 7.272 / 7.267 and -105.1 / -104.9 for surface growth (low/high <inline-formula><mml:math id="inf332"><mml:mi>d</mml:mi></mml:math></inline-formula>) and 1.652 / 2.189 and -4.8 / -8.9 for volume growth (low/high <inline-formula><mml:math id="inf333"><mml:mi>d</mml:mi></mml:math></inline-formula>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app4-fig4-v1.tif"/></fig></sec></app><app id="appendix-5"><title>Appendix 5</title><sec sec-type="appendix" id="s24"><title>Cell turnover</title><p>We infer the cell death rate and mutation rate by tracking the dynamics of clades and clones. A clone describes the set of cells with a particular genotype. In the absence of back mutations, a clade describes the set of cells carrying a particular mutation. (With back mutations, a clade is the set of descendants of a particular mutant cell, including the original mutant itself.) Under (volume) exponential growth, a clade is expected to grow exponentially at the growth rate <inline-formula><mml:math id="inf334"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula> and maintain on average a constant frequency within the tumour (<xref ref-type="bibr" rid="bib16">Durrett, 2013</xref>). A clone grows in a similar way, but at a rate which is reduced to mutations which generate new clones.</p><p>However, clone and clade sizes are also subject to fluctuations due to genetic drift: Clones and clades can become extinct even in growing populations, and the rate at which that happens depends on the rate of cell death (relative to the rate of birth) and the mutation rate. We use the fraction of clones with extinct parental clones and the fraction of offspring clades which coincide with a given ancestral clade to infer both the mutation rate and the relative rate of cell death.</p><p>Any mutation we encounter when tracing back the lineage of an offspring clade constitutes an ancestral clade. A clade coincides with an ancestral clade if all clones within the ancestral clade are also part of the offspring clade (a clone carrying mutations <inline-formula><mml:math id="inf335"><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is part of every clade <italic>i</italic> defined by mutation <inline-formula><mml:math id="inf336"><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>). Under an infinite site model, this situation refers to a pair of coinciding mutations <inline-formula><mml:math id="inf337"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo separator="true">,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, i.e. any cell carrying <inline-formula><mml:math id="inf338"><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> also carries <inline-formula><mml:math id="inf339"><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> and vice versa - <inline-formula><mml:math id="inf340"><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf341"><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> are the branching points within the lineage from which ancestor and offspring clade originated, respectively. A clone with extinct parental clone necessarily implies a clade that coincides with its most recent ancestral clade. Clades however can coincide with several ancestral clades if these underwent successive sweeps and ended in the fixation of the offspring clade. So more generally, for <inline-formula><mml:math id="inf342"><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> ancestral clades coinciding with the offspring lineage there is a set <inline-formula><mml:math id="inf343"><mml:msubsup><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:math></inline-formula> of mutations that is common to all cells carrying any of the mutations <inline-formula><mml:math id="inf344"><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>.</p><p>We begin with a small but illustrative example of clone and clade turnover in Appendix 5.1 before introducing the turnover based inference scheme in Appendix 5.2. We then test this scheme on simulated data (also under spatial sampling) in Appendix 5.3. For a derivation of analytical expressions and a discussion of the inference model used in this section, see Appendix 5.4 below and (<xref ref-type="bibr" rid="bib3">Angaji et al., 2021</xref>).</p></sec><sec sec-type="appendix" id="s25"><title>5.1 Clone and clade turnover example</title><p>We consider a population in which mutations 1, 2, 3, 4, 5 arose in that order (the order is given only to illustrate the example, see <xref ref-type="fig" rid="app5fig1">Appendix 5—figure 1</xref>). In this population, clones carrying mutations <inline-formula><mml:math id="inf345"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf346"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf347"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>2</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>3</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>4</mml:mn><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf348"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>2</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>3</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>4</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>5</mml:mn><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> survived. Clone <inline-formula><mml:math id="inf349"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> has an extant parental genotype, namely <inline-formula><mml:math id="inf350"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>. None of the extant genotypes carry exactly three mutations out of <inline-formula><mml:math id="inf351"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>2</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>3</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>4</mml:mn><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>. The parental clone of this genotype thus became extinct. Finally genotype <inline-formula><mml:math id="inf352"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>2</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>3</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>4</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>5</mml:mn><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> has an extant parent in <inline-formula><mml:math id="inf353"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>2</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>3</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>4</mml:mn><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>.</p><p>Hence 1 out of 3 clones have extinct parents, resulting in a clone turnover of <inline-formula><mml:math id="inf354"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>. In order to compute the clade turnover we go over all mutations 1, 2, 3, 4, 5, which each define a clade. The only ancestral clade of mutant 1 is the original clade which gave birth to all clades. The clone <inline-formula><mml:math id="inf355"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> survived, therefore clade 1 does not coincide with its ancestor. Mutation 1 hence contributes one to the denominator and zero to the numerator of the clade turnover. Mutation 2 does not coincide with either of its two ancestral clades (origin and 1) and thus adds two to the denominator and zero to the numerator.</p><p>The clade of mutation 3 is necessarily also distinct from the ancestral clades of mutation 2 - however, its clade has replaced that of 2 and therefore adds three to the denominator and one to the numerator. Note that the clone <inline-formula><mml:math id="inf356"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>2</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>3</mml:mn><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> does not need to be extant; as long as clade 3, which includes its subclades 4 and 5, replaces clade 2 it adds to the turnover. The clade of 4 in turn coincides with both 2 and 3, resulting in a contribution of four to the denominator and two to the numerator. Lastly, clade 5 has the original clade and mutants 1, 2, 3, 4 as ancestoral clades and coincides with neither of them, adding five to the denominator and zero to the numerator. The clade turnover is hence <inline-formula><mml:math id="inf357"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mi>/</mml:mi><mml:mn>15</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>In this example we assumed that we know the order in which the mutations occurred, but in fact the clade turnover can be computed without knowledge of the phylogenetic tree - we refer to <xref ref-type="bibr" rid="bib3">Angaji et al., 2021</xref> for the tree-free algorithm.</p></sec><sec sec-type="appendix" id="s26"><title>5.2 Algorithmic description</title><p>We consider a population of cells dividing at rate <inline-formula><mml:math id="inf358"><mml:mi>b</mml:mi></mml:math></inline-formula> and dying at rate <inline-formula><mml:math id="inf359"><mml:mi>d</mml:mi></mml:math></inline-formula>. The population starts from a single cell and the dynamics lasts for a time period <inline-formula><mml:math id="inf360"><mml:mi>T</mml:mi></mml:math></inline-formula>. With probability <inline-formula><mml:math id="inf361"><mml:mi>μ</mml:mi></mml:math></inline-formula> a mutation occurs in one of the daughter cells at division. The rates of birth and death are the same for all cells, meaning that the population is under volume growth (Appendix 1, <inline-formula><mml:math id="inf362"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math></inline-formula>).</p><p>Extinctions are not <italic>directly</italic> metric from a single snapshot. Clones and clades that go extinct only leave evidence that they existed through their mutant offspring. We calculated the probability for a clone to have its parental clone become extinct (<xref ref-type="bibr" rid="bib3">Angaji et al., 2021</xref>),<disp-formula id="equ9"><label>(4)</label><mml:math id="m9"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mo>:</mml:mo></mml:mrow><mml:mspace width="1em"/><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>b</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mfrac><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mi>b</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>the probability for a clade to replace an ancestral clade,<disp-formula id="equ10"><label>(5)</label><mml:math id="m10"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mo>:</mml:mo></mml:mrow><mml:mspace width="1em"/><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>see Appendix 5.4 for a brief derivation. The clone turnover <inline-formula><mml:math id="inf363"><mml:msub><mml:mi>W</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:math></inline-formula> depends on the mutation rate, as mutations lead to the establishment of new clones. The clade turnover, however does not depend on the mutation rate. From the empirically measured turnover of clones and clades it is thus possible to infer the mutation rate and the rate of cell death (relative to the growth rate). The model assumes exponential growth and neutral mutations in a infinite site scenario. We infer clones by a simple clustering of coinciding mutations (see Appendix 8) as was done in Appendix 2. Again we find no significant changes when using LICHeE (<xref ref-type="bibr" rid="bib47">Popic et al., 2015</xref>) instead.</p><p>The computation proceeds as follows:</p><list list-type="order"><list-item><p>estimate the population size as <inline-formula><mml:math id="inf364"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mn>3</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula> given the number of samples in the plane <inline-formula><mml:math id="inf365"><mml:mi>n</mml:mi></mml:math></inline-formula></p></list-item><list-item><p>clade turnover:</p><list list-type="alpha-lower"><list-item><p>remove mutations that occur in less than 2 samples from clones</p></list-item><list-item><p>compute the fraction <inline-formula><mml:math id="inf366"><mml:mover><mml:msub><mml:mi>W</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false" style="math-style:normal;math-depth:0;">^</mml:mo></mml:mover></mml:math></inline-formula> of pairs where offspring clade and ancestor clade coincide</p></list-item><list-item><p>Solve <inline-formula><mml:math id="inf367"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula> for <italic>d/b</italic></p></list-item></list></list-item><list-item><p>clone turnover:</p><list list-type="alpha-lower"><list-item><p>remove clones that have mutations that occur in less than 2 samples</p></list-item><list-item><p>compute the fraction <inline-formula><mml:math id="inf368"><mml:mover><mml:msub><mml:mi>W</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo stretchy="false" style="math-style:normal;math-depth:0;">^</mml:mo></mml:mover></mml:math></inline-formula> of clones with missing parental clone</p></list-item><list-item><p>Solve <inline-formula><mml:math id="inf369"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> for <inline-formula><mml:math id="inf370"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></p></list-item></list></list-item><list-item><p>optional: subsample a fraction <inline-formula><mml:math id="inf371"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>L</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> of mutations and repeat from (4) to infer <inline-formula><mml:math id="inf372"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> and compare the results for different values of <inline-formula><mml:math id="inf373"><mml:mi>L</mml:mi></mml:math></inline-formula></p></list-item></list><p><bold>Step 1</bold> Both clade and clone turnover depend on the effective population size <inline-formula><mml:math id="inf374"><mml:mi>N</mml:mi></mml:math></inline-formula>, which depends on the resolution frequency as well as relative cell death rate <inline-formula><mml:math id="inf375"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula> through <xref ref-type="disp-formula" rid="equ33">Equation 28</xref>, as discussed in detail in Appendix 7. To put the points from Appendix 7 briefly: <inline-formula><mml:math id="inf376"><mml:mi>N</mml:mi></mml:math></inline-formula> depends on the inverse frequency resolution <inline-formula><mml:math id="inf377"><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math></inline-formula> which in turn relates to a set frequency cutoff within the sampled plane through <xref ref-type="disp-formula" rid="equ32">Equation 27</xref>. The dependence of <inline-formula><mml:math id="inf378"><mml:mi>N</mml:mi></mml:math></inline-formula> on <inline-formula><mml:math id="inf379"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula> is due to the stochastic extinction of clades from fluctuations in population size. Extinction is frequent at high rates <inline-formula><mml:math id="inf380"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula> and increases the expected population size of a surviving population by a factor <inline-formula><mml:math id="inf381"><mml:mrow><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. This <inline-formula><mml:math id="inf382"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula> dependence of <inline-formula><mml:math id="inf383"><mml:mi>N</mml:mi></mml:math></inline-formula> is therefore included in the inference steps 2c and 3c.</p><p><bold>Steps 2a and 3a</bold>. We set the frequency cutoff to <inline-formula><mml:math id="inf384"><mml:mrow><mml:mn>2</mml:mn><mml:mi>/</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf385"><mml:mi>n</mml:mi></mml:math></inline-formula> is the number of samples, by demanding that a mutation typically occurs in 2 or more of the <inline-formula><mml:math id="inf386"><mml:mi>n</mml:mi></mml:math></inline-formula> genotyped samples. This cutoff is required to avoid cases where clones that are not sampled contribute erroneously to the turnover. The effective population size <inline-formula><mml:math id="inf387"><mml:mi>N</mml:mi></mml:math></inline-formula> then is the size of the tumour at which, under neutral evolution, mutations occur which can just be recovered in the genotyped samples. Mutations that are found in only one sample thereby typically occurred later in time, after the population reached size <inline-formula><mml:math id="inf388"><mml:mi>N</mml:mi></mml:math></inline-formula>, and do not contribute to the observable measures of turnover. These mutations are removed from all clade genomes (2a) and their clones are removed from the set of clones. Plugging the frequency cutoff <inline-formula><mml:math id="inf389"><mml:mrow><mml:mn>2</mml:mn><mml:mi>/</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> into <xref ref-type="disp-formula" rid="equ32">Equation 27</xref> gives the expression for <inline-formula><mml:math id="inf390"><mml:mi>N</mml:mi></mml:math></inline-formula> in step 1.</p><p><bold>Steps 2b and 3b</bold>. Here we calculate clade and clone turnover. See Appendix 5.1 for an example of how to determine clade- and clone-turnover from the set of surviving clones. We again refer to <xref ref-type="bibr" rid="bib3">Angaji et al., 2021</xref> for more detailed instructions.</p><p><bold>Steps 2c and 3c</bold>. The clade and clone turnover calculated from the data are compared to the analytical expressions <xref ref-type="disp-formula" rid="equ10">Equation 5</xref> and <xref ref-type="disp-formula" rid="equ9">Equation 4</xref> to infer rates of mutation and cell death. First, <inline-formula><mml:math id="inf391"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula> is inferred from the clade turnover and then used in 3c to obtain the mutation rate <inline-formula><mml:math id="inf392"><mml:mi>μ</mml:mi></mml:math></inline-formula>.</p><p>As an additional consistency check, the inferred rates can be used to compare a predicted cumulative SFS to the cumulative SFS obtained from the sequencing data, see also Appemdix 4.2. Under neutral evolution and volume growth the cumulative SFS is linear with slope <inline-formula><mml:math id="inf393"><mml:mrow><mml:mi>μ</mml:mi><mml:mi>/</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib70">Williams et al., 2016</xref>). <xref ref-type="fig" rid="app5fig2">Appendix 5—figure 2</xref> shows a good match between the slope given by the inferred rates <inline-formula><mml:math id="inf394"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf395"><mml:mi>μ</mml:mi></mml:math></inline-formula> and the cumulative SFS of the WES whole-tumour frequencies of Ling et al.</p><fig id="app5fig1" position="float"><label>Appendix 5—figure 1.</label><caption><title>Example phylogeny and turnover.</title><p>This illustration shows a growing population of cells that accumulates 5 mutations, on the top showing the muller plot of the 5 clones’ sizes and below the corresponding phylogeny against time t. The growth rate is positive but under stochastic dynamics clones and clades may become extinct. The clones carrying mutations {1, 2} and {1, 2, 3} went extinct and their offspring clones/clades add to the clone/clade turnover, see text. Specifically,the clone {1, 2, 3, 4} lost its parental clone,similarly the clade defined by mutation 3 coincides with clade 2 and clade 4 in turn replaced both clades 2 and 3.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app5-fig1-v1.tif"/></fig><fig id="app5fig2" position="float"><label>Appendix 5—figure 2.</label><caption><title>Cumulative SFS of WES data compared to prediction using inferred rates <inline-formula><mml:math id="inf396"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf397"><mml:mi>μ</mml:mi></mml:math></inline-formula>.</title><p>The number of mutations with frequency larger than <inline-formula><mml:math id="inf398"><mml:mi>f</mml:mi></mml:math></inline-formula> in the entire tumour against <inline-formula><mml:math id="inf399"><mml:mrow><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:math></inline-formula> in genomically-resolved sequencing data (solid blue line). <inline-formula><mml:math id="inf400"><mml:mrow><mml:mi>M</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> flattens below the allele frequency corresponding to the sequencing resolution, <inline-formula><mml:math id="inf401"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mn>40</mml:mn></mml:mrow></mml:math></inline-formula>. The green line indicates the expected curve under neutral evolution for the inferred rates of mutation <inline-formula><mml:math id="inf402"><mml:mi>μ</mml:mi></mml:math></inline-formula> and cell death <inline-formula><mml:math id="inf403"><mml:mi>d</mml:mi></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib16">Durrett, 2013</xref>) and provides a consistency check on our inference. Its slope is the scaled mutation rate <inline-formula><mml:math id="inf404"><mml:mrow><mml:mi>μ</mml:mi><mml:mi>/</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app5-fig2-v1.tif"/></fig><p>In Appendix 7 we test how the choice of the population size <inline-formula><mml:math id="inf405"><mml:mi>N</mml:mi></mml:math></inline-formula> affects the inference of mutation rate and the rate of cell death. We mimick the procedure in Ling et al., where first 23 samples are taken for WE sequencing, and a small set of mutations is then probed by genotyping in a larger set of 285 samples (see <xref ref-type="fig" rid="app5fig3">Appendix 5—figure 3</xref>). We find that (1) the number of samples <inline-formula><mml:math id="inf406"><mml:mi>n</mml:mi></mml:math></inline-formula> required for estimating <inline-formula><mml:math id="inf407"><mml:mi>N</mml:mi></mml:math></inline-formula> is given by the size of the large set of genotyped samples which determines the clonal composition, and (2) setting the lower cutoff of 2 supporting genotyped samples on mutations avoids biasing the turnover towards high death rates. In conclusion, the spatially-resolved set of the Ling et al. data reconstructs the clonal composition of the tumour, determines the effective population size <inline-formula><mml:math id="inf408"><mml:mi>N</mml:mi></mml:math></inline-formula>, and can be used to determine the rate of cell turnover <inline-formula><mml:math id="inf409"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula> and the mutation rate across the target genome. The preceding step of sampling at a lower spatial resolution for whole-exome sequencing, on the other hand, controls the size of the mutational target by filtering sites according to their coverage. We use the number of sites that pass these filters to calculate the mutation rate per nucleotide (see main text, ‘Cell turnover’).</p></sec><sec sec-type="appendix" id="s27"><title>5.3 Testing the inference based on clade/clone turnover</title><p>Our inference scheme for cell turnover based on stochastic clone extinction does not use spatial information. However, to test how the inference works under spatial sampling, we use data from spatial simulations under volume growth. Neutral evolution of the different clones is assumed, compatible with the original findings of <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref> and the corresponding (cumulative) site frequency spectrum shown in <xref ref-type="fig" rid="app5fig2">Appendix 5—figure 2</xref>.</p><p>We test the inference as specified in the steps above both in single cells sampled uniformly and using samples mimicking the sampling scheme in <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref> as described in Appendix 1. <xref ref-type="fig" rid="app5fig3">Appendix 5—figure 3</xref> compares inferred and underlying relative death rates and mutation rates in numerical simulations of volume growth (<inline-formula><mml:math id="inf410"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math></inline-formula>).</p><p>In <xref ref-type="fig" rid="app5fig4">Appendix 5—figure 4</xref>, we perform the same comparison, but focus on the regime of a high relative death rate. Specifically, we set the model parameters (relative death rate and mutation rate) close to the values inferred from the data of <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref> and ask how well the inference scheme can recover those parameters. The average inferred rates match the underlying rates very well, but we also find large fluctuations in individual datasets. The uncertainty in the inferred mutation rate is connected to the high rate of cell death; a small change in <inline-formula><mml:math id="inf411"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula>, say from 0.9 to 0.99 changes the number of generations needed for the cell population to grow by a factor of 10, and in turn changes the inferred mutation rate per generation by the same factor.</p><p>Employing LICHeE clustering of clones in simulations yields inferred rates <inline-formula><mml:math id="inf412"><mml:mi>μ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf413"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula> very similar to those obtained with our simple clustering scheme. As for the analysis of the direction of mutants in Appendix 2, we also compare our inference results for the simple clustering of the Ling et al. data to the results yielded by the LICHeE clustering tool. LICHeE infers a split of clones that is almost identical to our clustering scheme, presumably due to the large number of samples and the low number of mutations. Consequently, turnover inference based on the set of clones by LICHeE results in a very similar, high turnover rate and the median mutation rate falls well into the error margin of inferred mutation rates for the simple clustering.</p><fig id="app5fig3" position="float"><label>Appendix 5—figure 3.</label><caption><title>Turnover inference for simulated sampling from cross-sections in 3D over a range of death rates.</title><p>For each choice of death rate <inline-formula><mml:math id="inf414"><mml:mi>d</mml:mi></mml:math></inline-formula> we simulate 20 populations under volume growth in 3D to 40,000 cells each and take a cross-section. Mutations detected in a first set of 3 samples are then probed for in a set of 285 samples and used to infer <inline-formula><mml:math id="inf415"><mml:mi>d</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf416"><mml:mi>μ</mml:mi></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app5-fig3-v1.tif"/></fig><fig id="app5fig4" position="float"><label>Appendix 5—figure 4.</label><caption><title>Turnover inference for simulated sampling in 3D at the rates <inline-formula><mml:math id="inf417"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf418"><mml:mi>μ</mml:mi></mml:math></inline-formula> compatible with those inferred from the Ling et al. data.</title><p>We run 40 simulations in 3D to 40,000 cells at the rates inferred for the Ling et al. tumour, <inline-formula><mml:math id="inf419"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.975</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf420"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.015</mml:mn></mml:mrow></mml:math></inline-formula>. Spatial sampling is performed as explained in Appendix 1.2 and <xref ref-type="fig" rid="app5fig3">Appendix 5—figure 3</xref>. We plot the measured clade and clone turnover, <inline-formula><mml:math id="inf421"><mml:msub><mml:mi>W</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> (top left) and <inline-formula><mml:math id="inf422"><mml:msub><mml:mi>W</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:math></inline-formula> (top right), with the theoretically expected value as a function of d in red, and the inferred rates, <inline-formula><mml:math id="inf423"><mml:mi>d</mml:mi></mml:math></inline-formula> (bottom left) and <inline-formula><mml:math id="inf424"><mml:mi>μ</mml:mi></mml:math></inline-formula> (bottom right), with the true value of the respective rate in red. The median of inferred rates is <inline-formula><mml:math id="inf425"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.949</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf426"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.024</mml:mn></mml:mrow></mml:math></inline-formula>, but there are substantial fluctuations around these median rates.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app5-fig4-v1.tif"/></fig><p>We also apply the turnover-based inference to the tumours T1 and T2 analyzed by Li et al. and test on simulations with analogous spatial sampling schemes. The results are shown in <xref ref-type="fig" rid="app5fig5">Appendix 5—figure 5</xref>. Clones of T1 and T2 were determined using the LICHeE tool for clone inference in multi-region sequencing data, see Appendix 8.</p><p>The turnover theory described in Appendix 5.4 assumes at most one mutation per cell division. The number of mutations validated by Li et al. is very large compared to Ling et al. (906 mutations for T1 and 565 mutations for T2), resulting in a genomic mutation rate that exceeds this limit. This situation can be easily dealt with by taking subsets of the validated mutations of relative size <inline-formula><mml:math id="inf427"><mml:mi>L</mml:mi></mml:math></inline-formula>, effectively shrinking the genome size by factor <inline-formula><mml:math id="inf428"><mml:mi>L</mml:mi></mml:math></inline-formula>. However, we find that the inferred mutation rates do not scale linear with <inline-formula><mml:math id="inf429"><mml:mi>L</mml:mi></mml:math></inline-formula> - despite showing a downward trend with decreasing <inline-formula><mml:math id="inf430"><mml:mi>L</mml:mi></mml:math></inline-formula> as required by the dependence of the clone turnover on the mutation rate. Only the inferred death rate <inline-formula><mml:math id="inf431"><mml:mi>d</mml:mi></mml:math></inline-formula> is constant as expected.</p><p>To investigate, we use numerical simulations and again imitate the sampling of the two tumours in our 3D spatial simulations for different mutation rates, see <xref ref-type="fig" rid="app5fig6">Appendix 5—figure 6</xref>. The inference scheme fails to infer the true rates in simulations when applying the sampling procedure of T1 and T2, whereas the planar sampling scheme of Ling et al. accurately infers <inline-formula><mml:math id="inf432"><mml:mi>μ</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="app5fig3">Appendix 5—figure 3</xref>) and maintains the proper scaling in simulations when reducing the mutation rate by subsampling of mutations. We conclude that the samples in 3D data of Li et al. are not sufficiently dense to characterize the loss of clones with an accuracy sufficient for inference.</p><p>We suspect that the method of turnover-based inference breaks down in this case due to the low resolution of the clonal composition, which was particularly noticed for T2 in the previous sections. For both tumours, samples are taken from several slices of the upper hemispheres. The sampling covers the hemispheres rather uniformly, therefore, the estimate of the effective number of samples in the whole sphere <inline-formula><mml:math id="inf433"><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false" style="math-style:normal;math-depth:0;">~</mml:mo></mml:mover></mml:math></inline-formula> is simply <inline-formula><mml:math id="inf434"><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf435"><mml:mi>n</mml:mi></mml:math></inline-formula> samples in the hemisphere. Using the same minimal frequency <inline-formula><mml:math id="inf436"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>/</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> as before, the effective population size in step (1I) of the turnover computation becomes <inline-formula><mml:math id="inf437"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>≈</mml:mo><mml:mn>160</mml:mn></mml:mrow></mml:math></inline-formula> for both tumours. This shows that taking a number of samples from the sphere that is comparable to that in the cross section implies a much lower sampling density. The low density of samples, however, in turn makes it harder to accurately infer clones their ancestry needed for inference.</p><p>An issue that goes beyond the scope of this work is the turnover inference if one or more lineages are under selection. Under selection the turnover theory no longer applies to the full population but needs to be modified to apply to individual lineages with different birth and death rates. It would be straightforward to include the effects of selection by defining such clade-specific turnover metrics, but this is outside the scope of this paper. We note that both T1 and T2 have an SFS that deviates to some degree from neutrality exhibiting potential clusters of mutations, which may be due to selection (<xref ref-type="bibr" rid="bib33">Li et al., 2022</xref>).</p></sec><sec sec-type="appendix" id="s28"><title>5.4 Brief derivation of clade and clone turnover</title><p>The probability of eventual extinction can be obtained by first-step analysis, see <xref ref-type="bibr" rid="bib3">Angaji et al., 2021</xref> for details. Consider a single cell whose descendants form a clone or clade. The dynamics of clones and clades can be described by the same master equation by defining the effective rates of cell birth and death α and β. Clades gain cells at rate <inline-formula><mml:math id="inf438"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula> and lose cells at rate <inline-formula><mml:math id="inf439"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula>. But clones only gain a cell if neither parent nor offspring mutates at division, <inline-formula><mml:math id="inf440"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>⋅</mml:mo><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn><mml:msup><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and additionally lose a cell if both mutate <inline-formula><mml:math id="inf441"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>⋅</mml:mo><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn><mml:msup><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>. The probability that the originating cell and all offspring eventually die is denoted by <inline-formula><mml:math id="inf442"><mml:mi>q</mml:mi></mml:math></inline-formula>. After a single small time-step <inline-formula><mml:math id="inf443"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>, the cell either died with probability <inline-formula><mml:math id="inf444"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>, neither died nor divided <inline-formula><mml:math id="inf445"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> or divided <inline-formula><mml:math id="inf446"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>. In each case the remaining cells each independently produce lineages which eventually go extinct with probability <inline-formula><mml:math id="inf447"><mml:mi>q</mml:mi></mml:math></inline-formula>. This leaves us with the following self-consistent equation for <inline-formula><mml:math id="inf448"><mml:mi>q</mml:mi></mml:math></inline-formula><disp-formula id="equ11"><label>(6)</label><mml:math id="m11"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>q</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula></p><p>which can also be rewritten as <inline-formula><mml:math id="inf449"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mi>α</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> in accordance with a time discrete branching process with probability of cell birth <inline-formula><mml:math id="inf450"><mml:mfrac><mml:mi>α</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula> and death <inline-formula><mml:math id="inf451"><mml:mfrac><mml:mi>β</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib17">Durrett, 2015</xref>, chapter 3).</p><p>This equation is readily solved by <inline-formula><mml:math id="inf452"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo separator="true">,</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mi>α</mml:mi></mml:mfrac><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, which is<disp-formula id="equ12"><label>(7)</label><mml:math id="m12"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mspace width="1em"/><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:mfrac><mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="1em"/></mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Given the probability <inline-formula><mml:math id="inf453"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of a clone/clade having size <inline-formula><mml:math id="inf454"><mml:mi>n</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf455"><mml:mi>t</mml:mi></mml:math></inline-formula>, the probability that this clone/clade will eventually die out is<disp-formula id="equ13"><label>(8)</label><mml:math id="m13"><mml:mtable displaystyle="true" style="width:100%;"><mml:mtr><mml:mtd class="tml-right" style="padding:0.5ex 0em 0.5ex 0em;width:50%;"/><mml:mtd class="tml-left" style="padding:0.5ex 0em 0.5ex 1em;"><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>∞</mml:mi></mml:munderover></mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:msub><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mtext/><mml:mo separator="true">,</mml:mo></mml:mrow></mml:mtd><mml:mtd class="tml-right" style="padding:0.5ex 0em 0.5ex 0em;width:50%;"><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>which is also the definition of the generating function <inline-formula><mml:math id="inf456"><mml:mi>z</mml:mi></mml:math></inline-formula> of the time-dependent probability mass function <inline-formula><mml:math id="inf457"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> at <inline-formula><mml:math id="inf458"><mml:mi>q</mml:mi></mml:math></inline-formula>. Instead of finding a solution for <inline-formula><mml:math id="inf459"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we can obtain moments of the size distribution by taking derivatives of the generating function.</p><p>We begin by formulating the master equation governing the size of exponentially growing clones and clades. Consider a population that starts from a single cell and grows for a time <inline-formula><mml:math id="inf460"><mml:mi>T</mml:mi></mml:math></inline-formula>. Clones appear at different times and have different running times during which they can produce offspring. The probability that a cell was born at time <inline-formula><mml:math id="inf461"><mml:mi>t</mml:mi></mml:math></inline-formula> is proportional to the population size <inline-formula><mml:math id="inf462"><mml:mrow><mml:mi>N</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The normalising factor is <inline-formula><mml:math id="inf463"><mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>λ</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>/</mml:mi><mml:mi>λ</mml:mi></mml:mrow></mml:math></inline-formula>, yielding for large final times <inline-formula><mml:math id="inf464"><mml:mi>T</mml:mi></mml:math></inline-formula> an exponential distribution <inline-formula><mml:math id="inf465"><mml:mrow><mml:mi>λ</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>λ</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>T</mml:mi><mml:mo form="postfix" stretchy="false" lspace="0em" rspace="0em">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> for the running times <inline-formula><mml:math id="inf466"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>≡</mml:mo><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>.<disp-formula id="equ14"><label>(9)</label><mml:math id="m14"><mml:mrow><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In addition to the first terms describing a standard birth-death process, the master equation also contains a term <inline-formula><mml:math id="inf467"><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> describing the exponential decay of available running time. The clone’s founding cell is here born at time <inline-formula><mml:math id="inf468"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Using the definition <xref ref-type="disp-formula" rid="equ13">Equation 8</xref>, we get a linear partial differential equation for the generating function<disp-formula id="equ15"><label>(10)</label><mml:math id="m15"><mml:mrow><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>q</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>which for the boundary condition <inline-formula><mml:math id="inf469"><mml:mrow><mml:mi>z</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo separator="true">,</mml:mo><mml:mn>0</mml:mn><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:math></inline-formula> is solved by<disp-formula id="equ16"><label>(11)</label><mml:math id="m16"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mtext> </mml:mtext><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We defined the clone turnover as the probability for a clone to have its parental clone become extinct, and the clade turnover as the probability for a clade to replace an ancestral clade. In both cases, the offspring appears on a background of size <inline-formula><mml:math id="inf470"><mml:mi>n</mml:mi></mml:math></inline-formula> with a probability proportional to <inline-formula><mml:math id="inf471"><mml:mrow><mml:mi>n</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, while the background becomes extinct with probability <inline-formula><mml:math id="inf472"><mml:msup><mml:mi>q</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:math></inline-formula>. Averaging over both the time since the occurrence of the parental clone <inline-formula><mml:math id="inf473"><mml:mi>t</mml:mi></mml:math></inline-formula> and parent size at birth <inline-formula><mml:math id="inf474"><mml:mi>n</mml:mi></mml:math></inline-formula> defines the turnover parameter<disp-formula id="equ17"><label>(12)</label><mml:math id="m17"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munderover><mml:mi>n</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>β</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munderover><mml:mi>n</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:msub><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ18"><label>(13)</label><mml:math id="m18"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mi>α</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>λ</mml:mi><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>λ</mml:mi><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Inserting the respective effective rates α, β for clones and clades finally yields the clone turnover <xref ref-type="disp-formula" rid="equ9">Equation 4</xref> and clade turnover <xref ref-type="disp-formula" rid="equ10">Equation 5</xref>. For the detailed derivation, we refer to <xref ref-type="bibr" rid="bib3">Angaji et al., 2021</xref>.</p><fig id="app5fig5" position="float"><label>Appendix 5—figure 5.</label><caption><title>Cell death and mutation rates inferred from the clade and clone turnover measured on the clones of T1 (left) and T2 (right).</title><p>For a given <inline-formula><mml:math id="inf475"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> we repeatedly subsample a fraction <inline-formula><mml:math id="inf476"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> of the mutations, calculate clade and clone turnover and infer <inline-formula><mml:math id="inf477"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf478"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> for each subsampled set of clones (violinplots, individual samples are shown as blue dots). Blue bars indicate the median. Clones of T1 and T2 were determined using the LICHeE tool for clone inference in multi-region sequencing data, see Appendix 8.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app5-fig5-v1.tif"/></fig><fig id="app5fig6" position="float"><label>Appendix 5—figure 6.</label><caption><title>Turnover-based inference of cell death and mutation rates under 3D sampling of spatial simulations.</title><p>3D simulations are artificially sampled in a way that mimics spatial sampling, sequencing and genotyping in the tumours T1 (left) and T2 (right) by Li et al., as in <xref ref-type="fig" rid="app2fig6">Appendix 2—figure 6</xref>, explained in Appendix 2.2. Red lines indicate the true simulation rates. Under this sampling scheme, the inference of mutation and death rate fails, see text.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app5-fig6-v1.tif"/></fig></sec></app><app id="appendix-6"><title>Appendix 6</title><sec sec-type="appendix" id="s29"><title>Inference from mutational distances</title><p>In this section, we investigate how to jointly infer the mutation rate per generation and the rate of cell death (relative to that of cell birth) from samples from a growing population using the mutational distances. Our approach is based on combining exact results of <xref ref-type="bibr" rid="bib55">Stadler, 2009</xref> on the distribution of the times since the last common ancestor in a population growing under birth-death dynamics and by <xref ref-type="bibr" rid="bib12">Cheek and Johnston, 2023</xref> on the statistics of the number of cell divisions in a sampled lineage. We compare the resulting statistics of the pairwise mutational distances with the distribution of mutational distances used recently Werner and collaborators (<xref ref-type="bibr" rid="bib69">Werner et al., 2020</xref>) to jointly infer the mutation rate and the relative rate of cell death. Our treatment is a modification of the approach of Werner et al., and below we discuss the need for this modification.</p><p>The inference of the mutation rate per generation and the rate at which individuals die (relative to the rate of birth) is a long-standing problem. In population genetics, the times of speciation along a phylogenetic tree and the number of mutations along the tree have been used to perform this inference, using approaches based either on coalescence theory or on birth-death models (<xref ref-type="bibr" rid="bib52">Slatkin and Hudson, 1991</xref>; <xref ref-type="bibr" rid="bib56">Stadler et al., 2015</xref>; <xref ref-type="bibr" rid="bib65">Volz and Frost, 2014</xref>). In these approaches, the accuracy of the inferred parameters (mutations per generations, rates of a birth/death model) depend on how well the times of speciation can be reconstructed. An overview and unified perspective can be found in <xref ref-type="bibr" rid="bib38">MacPherson et al., 2021</xref>. In the present case, due to the low number of mutations along phylogenetic branches the speciation times cannot be determined accurately.</p></sec><sec sec-type="appendix" id="s30"><title>6.1 The distribution of mutational distances</title><p>Picking a pair of samples randomly and uniformly, the members of that pair differ by <inline-formula><mml:math id="inf479"><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf480"><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> mutations, respectively, from their last common ancestor. The mutations of the last common ancestor (relative to the normal tissue) are taken to be the intersection of the mutations in the two samples (this assumes no back-mutations). The distribution of the numbers of mutations <inline-formula><mml:math id="inf481"><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf482"><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> (mutational distances) across pairs of samples is the metric we will use for inference. A related approach has been taken by <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>, who use both coalescent theory and birth-death models to calculate the fraction of pairs of samples that are genetically identical. The full spectrum of mutational distances has recently been used by <xref ref-type="bibr" rid="bib69">Werner et al., 2020</xref> on multi-region tumour sequencing data.</p><p>The starting point is a population of cells (individuals) grown from a single cell. These cells independently divide at a rate <inline-formula><mml:math id="inf483"><mml:mi>b</mml:mi></mml:math></inline-formula> and die at a rate <inline-formula><mml:math id="inf484"><mml:mi>d</mml:mi></mml:math></inline-formula> (a birth-death process). Each cell carries a genome of length <inline-formula><mml:math id="inf485"><mml:mi>L</mml:mi></mml:math></inline-formula> and during division, each genomic site of the two daughter cells is mutated with probability <inline-formula><mml:math id="inf486"><mml:mrow><mml:mi>μ</mml:mi><mml:mi>/</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>. (In <xref ref-type="bibr" rid="bib69">Werner et al., 2020</xref>, <inline-formula><mml:math id="inf487"><mml:mi>μ</mml:mi></mml:math></inline-formula> denotes the mutation probability per site.) The population grows to a final size <inline-formula><mml:math id="inf488"><mml:mi>N</mml:mi></mml:math></inline-formula>, and the pairwise mutational distances between extant cells are measured. The aim is to infer the mutation rate and the rate of cell death relative to the rate of birth from the distribution of mutational distances.</p><p>Starting point is the probability distribution of the times of speciation under a birth death model. A result by theorem 4.1 in <xref ref-type="bibr" rid="bib55">Stadler, 2009</xref> gives the distribution of the time since the last common ancestor in pairs of extant cells picked uniformly from a population that has reached size <inline-formula><mml:math id="inf489"><mml:mi>N</mml:mi></mml:math></inline-formula> as<disp-formula id="equ19"><label>(14)</label><mml:math id="m19"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>b</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:mfrac linethickness="0"><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf490"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:mfrac></mml:mrow><mml:mrow><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. We rescale time to <inline-formula><mml:math id="inf491"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> obtaining the probability distribution for the rescaled time<disp-formula id="equ20"><label>(15)</label><mml:math id="m20"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:mfrac linethickness="0"><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>with <inline-formula><mml:math id="inf492"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula> the death rate relative to the birth rate and <inline-formula><mml:math id="inf493"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>q</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo lspace="0em" rspace="0em">−</mml:mo><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>q</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">−</mml:mo><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>q</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>.</p><p>We now consider a pair of extant cells with time <inline-formula><mml:math id="inf494"><mml:mi>τ</mml:mi></mml:math></inline-formula> since their last common ancestor. The two cells and their ancestor define two lineages, with <inline-formula><mml:math id="inf495"><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf496"><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> cell divisions after speciation, respectively, since the last common ancestor. <xref ref-type="bibr" rid="bib12">Cheek and Johnston, 2023</xref> have calculated the distribution of the number of cell divisions of a lineage of age <inline-formula><mml:math id="inf497"><mml:mi>τ</mml:mi></mml:math></inline-formula> conditioned on survival. The distribution is affected by lineages that have undergone many cell divisions being statistically overrepresented in the set of extant cells. This is an example of the inspection paradox well known in probability (<xref ref-type="bibr" rid="bib58">Stein and Dattero, 1985</xref>), where for instance determining the average size of a family by polling individuals for the number of their siblings results in a biased estimate. The resulting statistics for the number of divisions <inline-formula><mml:math id="inf498"><mml:mi>i</mml:mi></mml:math></inline-formula> found by <xref ref-type="bibr" rid="bib12">Cheek and Johnston, 2023</xref> is a mixture of Poisson distributions and in the present notation is<disp-formula id="equ21"><label>(16)</label><mml:math id="m21"><mml:mtable displaystyle="true" style="width:100%;"><mml:mtr><mml:mtd class="tml-right" style="padding:0.5ex 0em 0.5ex 0em;width:50%;"/><mml:mtd class="tml-left" style="padding:0.5ex 0em 0.5ex 1em;"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>τ</mml:mi></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo lspace="0em" rspace="0em">−</mml:mo><mml:mi>d</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:msup><mml:mfrac><mml:mrow><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo lspace="0em" rspace="0em">−</mml:mo><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">(</mml:mo><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo form="postfix" stretchy="false" lspace="0em" rspace="0em">)</mml:mo></mml:mrow></mml:mfrac><mml:mrow><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:munderover></mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>j</mml:mi><mml:mo form="postfix" stretchy="false" lspace="0em" rspace="0em">!</mml:mo></mml:mrow></mml:mfrac><mml:mrow><mml:mo fence="true" form="prefix">(</mml:mo><mml:mfrac><mml:mrow><mml:mi>b</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">(</mml:mo><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">(</mml:mo><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo fence="true" form="prefix">(</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mrow><mml:mo fence="true" form="prefix">(</mml:mo><mml:mfrac><mml:mrow><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">(</mml:mo><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">(</mml:mo><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mfrac><mml:mo fence="true" form="postfix">)</mml:mo></mml:mrow><mml:mo fence="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">−</mml:mo><mml:mi>b</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:msup><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>τ</mml:mi><mml:msup><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>j</mml:mi></mml:msup><mml:mo fence="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd class="tml-right" style="padding:0.5ex 0em 0.5ex 0em;width:50%;"><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>This expression follows <xref ref-type="disp-formula" rid="equ25">Equation 20</xref> in the archived version (<ext-link ext-link-type="uri" xlink:href="https://arxiv.org/pdf/2205.13875.pdf">https://arxiv.org/pdf/2205.13875.pdf</ext-link>) of <xref ref-type="bibr" rid="bib12">Cheek and Johnston, 2023</xref> the corresponding <xref ref-type="disp-formula" rid="equ26">Equation 21</xref> differs by an erroneous factor of <inline-formula><mml:math id="inf499"><mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mo form="prefix" stretchy="false">−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>j</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>. The partial sum of the exponential series can be written in terms of the incomplete Gamma-function.</p><p>Finally, we look at the distribution of the number of mutations in a lineage given the number of cell divisions <inline-formula><mml:math id="inf500"><mml:mi>i</mml:mi></mml:math></inline-formula> after speciation. Since mutations occur independently at different sites and at different divisions along a lineage, and the per-site mutation probability is small, the number <inline-formula><mml:math id="inf501"><mml:mi>m</mml:mi></mml:math></inline-formula> of mutations after <inline-formula><mml:math id="inf502"><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> divisions (now including the speciation event itself) is Poisson distributed with mean <inline-formula><mml:math id="inf503"><mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula>, giving<disp-formula id="equ22"><label>(17)</label><mml:math id="m22"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>μ</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>m</mml:mi><mml:mo>!</mml:mo><mml:mtext> </mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We combine these results to estimate the distribution of the mutational distances <inline-formula><mml:math id="inf504"><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf505"><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> from the last common ancestor of a pair of cells randomly selected from extant cells in a population of size <inline-formula><mml:math id="inf506"><mml:mi>N</mml:mi></mml:math></inline-formula>, obtaining<disp-formula id="equ23"><label>(18)</label><mml:math id="m23"><mml:mtable displaystyle="true" style="width:100%;"><mml:mtr><mml:mtd class="tml-right" style="padding:0.5ex 0em 0.5ex 0em;width:50%;"/><mml:mtd class="tml-left" style="padding:0.5ex 0em 0.5ex 1em;"><mml:mrow><mml:mi>P</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo separator="true">,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo movablelimits="false">∫</mml:mo><mml:mn>0</mml:mn><mml:mi>∞</mml:mi></mml:msubsup><mml:mi>d</mml:mi><mml:mi>τ</mml:mi><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>∞</mml:mi></mml:munderover></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>τ</mml:mi></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">(</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>∞</mml:mi></mml:munderover></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>τ</mml:mi></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">(</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mtext/><mml:mi>.</mml:mi></mml:mrow></mml:mtd><mml:mtd class="tml-right" style="padding:0.5ex 0em 0.5ex 0em;width:50%;"><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>Similarly, the distribution of individual mutational distances (between the ancestor of a pair of cells and an element of that pair) is given by<disp-formula id="equ24"><label>(19)</label><mml:math id="m24"><mml:mtable displaystyle="true" style="width:100%;"><mml:mtr><mml:mtd class="tml-right" style="padding:0.5ex 0em 0.5ex 0em;width:50%;"/><mml:mtd class="tml-left" style="padding:0.5ex 0em 0.5ex 1em;"><mml:mrow><mml:mi>P</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo movablelimits="false">∫</mml:mo><mml:mn>0</mml:mn><mml:mi>∞</mml:mi></mml:msubsup><mml:mi>d</mml:mi><mml:mi>τ</mml:mi><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>∞</mml:mi></mml:munderover></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>τ</mml:mi></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd class="tml-right" style="padding:0.5ex 0em 0.5ex 0em;width:50%;"><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>These expressions neglect that choosing pairs of samples does not generate the typical number of cell divisions given the age of a lineage, but the error turns out to be small. <xref ref-type="fig" rid="app6fig1">Appendix 6—figure 1A</xref> shows the distribution of mutational distances for a single population (<inline-formula><mml:math id="inf507"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo separator="true">,</mml:mo><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mi>/</mml:mi><mml:mn>4</mml:mn><mml:mo separator="true">,</mml:mo><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>300</mml:mn></mml:mrow></mml:math></inline-formula>) compared to the result <xref ref-type="disp-formula" rid="equ24">Equation 19</xref> (green line).</p><fig id="app6fig1" position="float"><label>Appendix 6—figure 1.</label><caption><title>Inference on artificial data using the likelihood <xref ref-type="disp-formula" rid="equ23">Equation 18</xref> based on mutational distances.</title><p>For a concrete example, in a single run, a population is grown at rate of birth <inline-formula><mml:math id="inf508"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and rate of death <inline-formula><mml:math id="inf509"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mi>/</mml:mi><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> with a genomic mutation rate <inline-formula><mml:math id="inf510"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> from a single cell until the population size has reached <inline-formula><mml:math id="inf511"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>300</mml:mn></mml:mrow></mml:math></inline-formula> cells. (<bold>A</bold>) The histogram of the mutational distances <inline-formula><mml:math id="inf512"><mml:mi>m</mml:mi></mml:math></inline-formula> from the single population is shown in blue. The green solid line shows the corresponding distribution <xref ref-type="disp-formula" rid="equ24">Equation 19</xref>, the red solid line indicates the distribution of mutational distances derived in equation (7) in <xref ref-type="bibr" rid="bib69">Werner et al., 2020</xref>, see text. (<bold>B</bold>) The log-likelihood landscape defined by <xref ref-type="disp-formula" rid="equ23">Equation 18</xref> with the mutation rate <inline-formula><mml:math id="inf513"><mml:mi>μ</mml:mi></mml:math></inline-formula> on the <inline-formula><mml:math id="inf514"><mml:mi>x</mml:mi></mml:math></inline-formula>-axis and the relative death rate <inline-formula><mml:math id="inf515"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula> on the <inline-formula><mml:math id="inf516"><mml:mi>y</mml:mi></mml:math></inline-formula>-axis. The underlying parameters <inline-formula><mml:math id="inf517"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf518"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>0.75</mml:mn></mml:mrow></mml:math></inline-formula> are indicated with a green dot, the maximum of the likelihood landscape is indicated by the red dot. The likelihood landscape shows a pronounced ridge of high likelihoods. The ridge-like shape of the likelihood landscape means that there are many different parameter values compatible with the data that yield nearly the same distribution of mutational distances <xref ref-type="disp-formula" rid="equ23">Equation 18</xref>. (<bold>C</bold>) The last point is illustrated by the distribution of the mutational distances: As in (<bold>A</bold>), the histogram of mutational distances <inline-formula><mml:math id="inf519"><mml:mi>m</mml:mi></mml:math></inline-formula> is shown in blue, and the green solid line again shows the distribution <xref ref-type="disp-formula" rid="equ24">Equation 19</xref> at the underlying parameters <inline-formula><mml:math id="inf520"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf521"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>0.75</mml:mn></mml:mrow></mml:math></inline-formula>. The red line shows the the distribution <xref ref-type="disp-formula" rid="equ24">Equation 19</xref> at the maximum-likelihood parameters (near <inline-formula><mml:math id="inf522"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>2.2</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf523"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>0.33</mml:mn></mml:mrow></mml:math></inline-formula>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app6-fig1-v1.tif"/></fig></sec><sec sec-type="appendix" id="s31"><title>6.2 Likelihood-based inference from pairwise mutational distances</title><p><xref ref-type="disp-formula" rid="equ23">Equation 18</xref> serves as the likelihood function for the parameter inference. Enumerating all pairs of extant cells gives a list of mutational distances between each element of the pair and the last common ancestor, <inline-formula><mml:math id="inf524"><mml:mrow><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mn>1</mml:mn><mml:mi>ν</mml:mi></mml:msubsup><mml:mo separator="true">,</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mn>2</mml:mn><mml:mi>ν</mml:mi></mml:msubsup><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, where the index <inline-formula><mml:math id="inf525"><mml:mi>ν</mml:mi></mml:math></inline-formula> runs over all pairs of extant cells. Maximizing the log-likelihood defined by <xref ref-type="disp-formula" rid="equ23">Equation 18</xref><disp-formula id="equ25"><label>(20)</label><mml:math id="m25"><mml:mtable displaystyle="true" style="width:100%;"><mml:mtr><mml:mtd class="tml-right" style="padding:0.5ex 0em 0.5ex 0em;width:50%;"/><mml:mtd class="tml-left" style="padding:0.5ex 0em 0.5ex 1em;"><mml:mrow><mml:mrow><mml:munder><mml:mo stretchy="true">∑</mml:mo><mml:mi>ν</mml:mi></mml:munder></mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mrow><mml:mo fence="true" form="prefix">(</mml:mo><mml:mi>P</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mn>1</mml:mn><mml:mi>ν</mml:mi></mml:msubsup><mml:mo separator="true">,</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mn>2</mml:mn><mml:mi>ν</mml:mi></mml:msubsup><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo fence="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd class="tml-right" style="padding:0.5ex 0em 0.5ex 0em;width:50%;"><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>with respect to the free parameters <inline-formula><mml:math id="inf526"><mml:mi>q</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf527"><mml:mi>μ</mml:mi></mml:math></inline-formula> for a given population size <inline-formula><mml:math id="inf528"><mml:mi>N</mml:mi></mml:math></inline-formula> yields the maximum-likelihood estimates of the relative death rate <inline-formula><mml:math id="inf529"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula> and the genomic mutation rate <inline-formula><mml:math id="inf530"><mml:mi>μ</mml:mi></mml:math></inline-formula> per cell division and cell. The computation of double sums in the likelihood <xref ref-type="disp-formula" rid="equ23">Equation 18</xref> can be avoided by precomputing the sum over <inline-formula><mml:math id="inf531"><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> for different values of <inline-formula><mml:math id="inf532"><mml:mi>τ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf533"><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and using the same lookup-table for the sum over <inline-formula><mml:math id="inf534"><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>.</p><p>The likelihood <xref ref-type="disp-formula" rid="equ23">Equation 18</xref> differs in three points from the likelihood used in <xref ref-type="bibr" rid="bib69">Werner et al., 2020</xref>: (i) We use a birth-death model, whereas Werner et al. use an approximation based on coalescence theory (<xref ref-type="bibr" rid="bib52">Slatkin and Hudson, 1991</xref>). This point should be inconsequential, the correct use of either model should yield a correct inference (see below). (ii) We use the exact result by <xref ref-type="bibr" rid="bib12">Cheek and Johnston, 2023</xref> for the distribution of the number of divisions <xref ref-type="disp-formula" rid="equ21">Equation 16</xref> which accounts for the skewed statistics due to the inspection paradox. Werner et al. use a heuristic which does not account for this effect. (iii) The distribution <xref ref-type="disp-formula" rid="equ23">Equation 18</xref> describes correlations between the mutational distance <inline-formula><mml:math id="inf535"><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf536"><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>, which enter the log-likelihood <xref ref-type="disp-formula" rid="equ25">Equation 20</xref>. The method in <xref ref-type="bibr" rid="bib69">Werner et al., 2020</xref> does not exploit these correlations.</p><p>Regarding point (i), neither the distribution of pairwise speciation times nor the coalescence probabilities per time can be evaluated without knowing the final population size <inline-formula><mml:math id="inf537"><mml:mi>N</mml:mi></mml:math></inline-formula>, see for instance (<xref ref-type="bibr" rid="bib55">Stadler, 2009</xref> and <xref ref-type="bibr" rid="bib52">Slatkin and Hudson, 1991</xref>; <xref ref-type="disp-formula" rid="equ10">Equation 5</xref>). Yet, the expression derived in <xref ref-type="bibr" rid="bib69">Werner et al., 2020</xref> (equation (6) in <xref ref-type="bibr" rid="bib69">Werner et al., 2020</xref>) for the coalescence probability does not depend on the final population size. The resulting distribution of mutational distances (equation (7) in <xref ref-type="bibr" rid="bib69">Werner et al., 2020</xref>) is shown in <xref ref-type="fig" rid="app6fig1">Appendix 6—figure 1A</xref> (red line) and disagrees strongly both with our result <xref ref-type="fig" rid="app6fig1">Appendix 6—figure 1</xref> (green line) and numerical simulations.</p><fig id="app6fig2" position="float"><label>Appendix 6—figure 2.</label><caption><title>Inference using the likelihood <xref ref-type="disp-formula" rid="equ23">Equation 18</xref> on the the empirical data of Ling et al.</title><p>(<bold>A</bold>) The log-likelihood landscape defined by <xref ref-type="disp-formula" rid="equ23">Equation 18</xref> with the mutation rate <inline-formula><mml:math id="inf538"><mml:mi>μ</mml:mi></mml:math></inline-formula> on the <inline-formula><mml:math id="inf539"><mml:mi>x</mml:mi></mml:math></inline-formula>-axis and the relative death rate on the <inline-formula><mml:math id="inf540"><mml:mi>y</mml:mi></mml:math></inline-formula>-axis, on the basis of mutational distances between samples in the data of <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>. The maximum of the likelihood landscape is indicated by the red dot (<inline-formula><mml:math id="inf541"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.07</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf542"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>0.73</mml:mn></mml:mrow></mml:math></inline-formula>), the parameters previously inferred using the turnover of Appendix 5 (<inline-formula><mml:math id="inf543"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>0.975</mml:mn><mml:mo separator="true">,</mml:mo><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.015</mml:mn></mml:mrow></mml:math></inline-formula>) are indicated with a green dot (top edge left). As in the artificial data of in <xref ref-type="fig" rid="app6fig1">Appendix 6—figure 1</xref>, the likelihood landscape shows a pronounced ridge of high likelihood. (<bold>B</bold>) The histogram of the mutational distances <inline-formula><mml:math id="inf544"><mml:mi>m</mml:mi></mml:math></inline-formula> from samples of Ling et al. is shown in blue. The green line shows the distribution <xref ref-type="disp-formula" rid="equ24">Equation 19</xref> at the parameters inferred using the turnover of Appendix 5. The red line shows the the distribution <xref ref-type="disp-formula" rid="equ24">Equation 19</xref> at the maximum-likelihood parameters.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app6-fig2-v1.tif"/></fig><p>Still, the likelihood of <xref ref-type="bibr" rid="bib69">Werner et al., 2020</xref> can infer the model parameters correctly in the regime of large mutation rates, where there are clear oscillations in the distribution of mutational distances of period <inline-formula><mml:math id="inf545"><mml:mi>μ</mml:mi></mml:math></inline-formula>: The number of cell divisions between two cells is always integer, so the average number of mutations is an integer multiple of <inline-formula><mml:math id="inf546"><mml:mi>μ</mml:mi></mml:math></inline-formula>. In the regime <inline-formula><mml:math id="inf547"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>≫</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, one can resolve individual cell divisions in the spectrum of mutational distances, which cause distinguishable peaks at <inline-formula><mml:math id="inf548"><mml:mrow><mml:mi>μ</mml:mi><mml:mo separator="true">,</mml:mo><mml:mn>2</mml:mn><mml:mi>μ</mml:mi><mml:mo separator="true">,</mml:mo><mml:mn>3</mml:mn><mml:mi>μ</mml:mi><mml:mo separator="true">,</mml:mo><mml:mo>…</mml:mo></mml:mrow></mml:math></inline-formula> (see artifical data in Fig. 2A in <xref ref-type="bibr" rid="bib69">Werner et al., 2020</xref>). In this regime, the likelihood is dominated by parameters yielding the correct oscillation period. In the presence of such oscillations, the model parameters can easily be determined without using a likelihood by reading off the mutation rate from the oscillation period, and the relative death rate from a plot of the cumulative frequency of mutations versus the inverse frequency as in <xref ref-type="bibr" rid="bib70">Williams et al., 2016</xref>. However, outside this regime, we found the method (<xref ref-type="bibr" rid="bib69">Werner et al., 2020</xref>) returns incorrect parameter estimates. For whole-exome data, such as the Ling et al. data set and many of the data sets analyzed in <xref ref-type="bibr" rid="bib69">Werner et al., 2020</xref>, <inline-formula><mml:math id="inf549"><mml:mi>μ</mml:mi></mml:math></inline-formula> need not be much larger than one (in particular in WES data from tumours lacking the hypermutator phenotype), making a correct treatment of either coalescence probability or the distribution of speciation times necessary.</p><p><xref ref-type="fig" rid="app6fig1">Appendix 6—figure 1B</xref> shows the log-likelihood <xref ref-type="disp-formula" rid="equ25">Equation 20</xref> landscape for the same population of 300 cells used in <xref ref-type="fig" rid="app6fig1">Appendix 6—figure 1A</xref>. A pronounced ridge-like shape is seen with a broad plateau of high likelihoods. This ridge includes the underlying parameters (<inline-formula><mml:math id="inf550"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo separator="true">,</mml:mo><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mi>/</mml:mi><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>), although the maximum occurs elsewhere near <inline-formula><mml:math id="inf551"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>2.2</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf552"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula>. In general, broad maxima of the likelihood make the precise position of the likelihood maximum strongly depend on fluctuations in the data. <xref ref-type="fig" rid="app6fig1">Appendix 6—figure 1C</xref> shows how the distribution of mutational distances <xref ref-type="disp-formula" rid="equ24">Equation 19</xref> at the maximum likelihood parameters (red line) and at the underlying parameters (green line). Both of these distributions fit the distribution of mutational distances quite well, although the fitting parameters are rather different. This is a property of the summary statistics used here, in line with the ridge of high likelihood values seen in <xref ref-type="fig" rid="app6fig1">Appendix 6—figure 1B</xref>.</p><p>The same picture is also seen in the empirical data of <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>. <xref ref-type="fig" rid="app6fig2">Appendix 6—figure 2A</xref> shows a pronounced ridge of high likelihood. <xref ref-type="fig" rid="app6fig2">Appendix 6—figure 2B</xref> shows the corresponding distribution of mutational distances (blue histogram) as well as the distribution <xref ref-type="disp-formula" rid="equ24">Equation 19</xref> both for the parameters inferred using the genetic turnover (green line, see Appendix 5) and for the parameters maximising the likelihood <xref ref-type="disp-formula" rid="equ25">Equation 20</xref> based on the mutational distances (red line). Again both parameter set lead to a reasonable fit with the distribution of mutational distances, indicating that mutational distances are not a suitable summary statistics for inference (unless the expected number of mutations per cell division is substantially larger than one, see above).</p></sec></app><app id="appendix-7"><title>Appendix 7</title><sec sec-type="appendix" id="s32"><title>Estimating the population size <inline-formula><mml:math id="inf553"><mml:mi>N</mml:mi></mml:math></inline-formula></title><p>The probability of coalescence or the time since the last common ancestor of two cells both depend on the population size. As a result, the distribution of the mutational distances <xref ref-type="disp-formula" rid="equ24">Equation 19</xref> and hence the likelihood function <xref ref-type="disp-formula" rid="equ23">Equation 18</xref> depend on the population size. Also, to infer the relative growth rate <inline-formula><mml:math id="inf554"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula> from the turnover parameter as in Appendix 5 we need to know the population size. Similarly, when telling surface growth from volume growth in Appendix 2, or tracking the spread of mutations in Appendix 4, we use mutations which entered the population at a specific time when the tumour had a certain size. Therefore our measures describe the growth dynamics at that particular time and tumour size, depending on the input data and mutation filters. In this section we discuss out the effective population sizes <inline-formula><mml:math id="inf555"><mml:mi>N</mml:mi></mml:math></inline-formula> for different sets of mutations.</p><p>Due to the finite sequencing resolution this effective population size is not simply the final number of cells in the tumour population. Rare variants below the frequency resolution <inline-formula><mml:math id="inf556"><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math></inline-formula> are underrepresented or missing due to a finite sequencing coverage and stochastic errors of sequencing. Only mutations with sufficiently high frequency can be identified by sequencing, and those arose early in the evolution of the tumour when the tumour had a small size (<xref ref-type="bibr" rid="bib70">Williams et al., 2016</xref>). The statistics of mutations found in a large tumour with a finite sequencing depth corresponds to a smaller tumour where all mutations and frequencies are known. Here, we address the question of what the effective population size of that smaller tumour is, given a particular frequency resolution <inline-formula><mml:math id="inf557"><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math></inline-formula> and test our answer in numerical simulations.</p><p>Under deterministic exponential growth - that is if one neglects fluctuations in clone sizes - the analysis is simple: each generation brings forth new mutations that have an initial frequency <inline-formula><mml:math id="inf558"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf559"><mml:mi>N</mml:mi></mml:math></inline-formula> is the total population size at birth of the first mutant (<xref ref-type="bibr" rid="bib70">Williams et al., 2016</xref>). Under neutral evolution, new clones match the total population growth rate <inline-formula><mml:math id="inf560"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula> (cell birth rate <inline-formula><mml:math id="inf561"><mml:mi>b</mml:mi></mml:math></inline-formula> and death rate <inline-formula><mml:math id="inf562"><mml:mi>d</mml:mi></mml:math></inline-formula>) and thus maintain their frequency over time. Consequently, keeping only mutations down to a cutoff frequency <inline-formula><mml:math id="inf563"><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math></inline-formula> effectively casts the system into the early stages of tumour growth. Specifically, one observes the clonal makeup of the population at the time when mutations with frequency <inline-formula><mml:math id="inf564"><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math></inline-formula> have just appeared. Correspondingly, one would set the effective population size to<disp-formula id="equ26"><label>(21)</label><mml:math id="m26"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mtext>res</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>see (<xref ref-type="bibr" rid="bib70">Williams et al., 2016</xref>).</p><p>We now discuss a correction to this deterministic result due to stochastic fluctuations in the clone sizes. In an extreme case, such fluctuations can drive a clone to extinction. For <inline-formula><mml:math id="inf565"><mml:mrow><mml:mi>t</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math></inline-formula> the scaled population size <inline-formula><mml:math id="inf566"><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo lspace="0em" rspace="0em">−</mml:mo><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>N</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (of a clone or an entire population) has been shown by <xref ref-type="bibr" rid="bib17">Durrett, 2015</xref> (chapter 3 theorem 1) to have a limiting distribution given by<disp-formula id="equ27"><label>(22)</label><mml:math id="m27"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:mfrac><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mi>λ</mml:mi><mml:mi>b</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>N</mml:mi></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf567"><mml:mfrac><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:mfrac></mml:math></inline-formula> is the extinction probability, such that when conditioning on survival<disp-formula id="equ28"><label>(23)</label><mml:math id="m28"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">∀</mml:mi><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mo stretchy="false">⟶</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>the expected population size becomes <inline-formula><mml:math id="inf568"><mml:mrow><mml:mrow><mml:mo fence="true" form="prefix">⟨</mml:mo><mml:mi>N</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo fence="true" form="postfix">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> for sufficiently large times <inline-formula><mml:math id="inf569"><mml:mi>t</mml:mi></mml:math></inline-formula>. The exponential term in this expression is the result due to determininistic growth, the prefactor is a correction due to fluctuations which can drive a clone to extinction. The contribution is large if the death rate <inline-formula><mml:math id="inf570"><mml:mi>d</mml:mi></mml:math></inline-formula> is close to the rate of birth <inline-formula><mml:math id="inf571"><mml:mi>b</mml:mi></mml:math></inline-formula>, so extinctions events are frequent.</p><p>Whereas <inline-formula><mml:math id="inf572"><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo lspace="0em" rspace="0em">−</mml:mo><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>N</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is an exponentially distributed random variable for an ensemble of populations, but fixed for a given population, the mutant clones have an analogous relation between expectation values of the population size at birth of the mutant, <inline-formula><mml:math id="inf573"><mml:mi>N</mml:mi></mml:math></inline-formula>, and the mutation frequency <inline-formula><mml:math id="inf574"><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math></inline-formula><disp-formula id="equ29"><label>(24)</label><mml:math id="m29"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mtext>res</mml:mtext></mml:mrow></mml:msub></mml:mfrac><mml:mtext> </mml:mtext><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>This gives a correction to the deterministic estimate <inline-formula><mml:math id="inf575"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:mfrac></mml:mrow></mml:math></inline-formula> due to stochastic extinction events.</p><p>We test this relationship numerically in two ways. <xref ref-type="fig" rid="app7fig1">Appendix 7—figure 1</xref> shows the population size at birth of a mutation against (one over) its final frequency and compares the numerical results to the deterministic estimate <xref ref-type="disp-formula" rid="equ26">Equation 21</xref> and the stochastic correction <xref ref-type="disp-formula" rid="equ29">Equation 24</xref>.</p><p><xref ref-type="fig" rid="app7fig2">Appendix 7—figure 2</xref> probes how well the effective population size is described by <xref ref-type="disp-formula" rid="equ29">Equation 24</xref> when low-frequency mutations up to a frequency threshold <inline-formula><mml:math id="inf576"><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math></inline-formula> are disregarded. We grow a population to size <inline-formula><mml:math id="inf577"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>10000</mml:mn></mml:mrow></mml:math></inline-formula> and disregard all mutations with final frequencies less than <inline-formula><mml:math id="inf578"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>. We then compare the resulting mutational distances (mean and standard deviation over each population) with those of populations grown to different final sizes <italic>without</italic> removing low-frequency mutants. Under the deterministic model (<xref ref-type="disp-formula" rid="equ26">Equation 21</xref>), we expect the mutational distances to match those in a population of size <inline-formula><mml:math id="inf579"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula>. Instead, we find that the mutational distances match those in a population of a size given by the stochastic correction (<xref ref-type="disp-formula" rid="equ29">Equation 24</xref>), which increases with the relative rate of cell death <inline-formula><mml:math id="inf580"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula>.</p><fig id="app7fig1" position="float"><label>Appendix 7—figure 1.</label><caption><title>Population size <inline-formula><mml:math id="inf581"><mml:mi>N</mml:mi></mml:math></inline-formula> at birth of a mutation with final frequency <inline-formula><mml:math id="inf582"><mml:mi>f</mml:mi></mml:math></inline-formula> Circular markers show the mean population size <inline-formula><mml:math id="inf583"><mml:mi>N</mml:mi></mml:math></inline-formula> for a given frequency bin.</title><p>The blue ribbon covers the 99th percentile. The red line shows the relation <xref ref-type="disp-formula" rid="equ29">Equation 24</xref> with the correction for fluctuating clone sizes, the black line shows the deterministic result <xref ref-type="disp-formula" rid="equ26">Equation 21</xref>. Mutations were collected from 20 3D spatial simulations up to a population size 40,000 with birth rate <inline-formula><mml:math id="inf584"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>.</mml:mi></mml:mrow></mml:math></inline-formula>, death rate <inline-formula><mml:math id="inf585"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula>, and mutation rate <inline-formula><mml:math id="inf586"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app7-fig1-v1.tif"/></fig><fig id="app7fig2" position="float"><label>Appendix 7—figure 2.</label><caption><title>The effect of disregarding low-frequency mutations.</title><p>The mean mutational distances and their standard deviations (blue markers and blue error bars, respectively) are shown for populations grown to different sizes <inline-formula><mml:math id="inf587"><mml:mi>N</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf588"><mml:mi>x</mml:mi></mml:math></inline-formula> axis) at different relative death rates <inline-formula><mml:math id="inf589"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>0.25,0.5,0.75</mml:mn></mml:mrow></mml:math></inline-formula> (left to right). In each of these panels, the orange markers show the mean and standard deviation of the mutational distance for a population of size <inline-formula><mml:math id="inf590"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>10000</mml:mn></mml:mrow></mml:math></inline-formula> whose low-frequency mutants with frequency <inline-formula><mml:math id="inf591"><mml:mrow><mml:mi>f</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> have been discarded. For the effective population size we use <xref ref-type="disp-formula" rid="equ29">Equation 24</xref>. Rather than staying constant as they would under <xref ref-type="disp-formula" rid="equ26">Equation 21</xref>, the corresponding mean mutational distances increase with the relative death rate <inline-formula><mml:math id="inf592"><mml:mi>q</mml:mi></mml:math></inline-formula>, and this increase is compatible with <xref ref-type="disp-formula" rid="equ29">Equation 24</xref>, as seen from the orange markers following the blue ones. All quantities are averaged over 100 runs. Note that error bars give the standard deviations of the mutational distances, not standard errors.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app7-fig2-v1.tif"/></fig></sec><sec sec-type="appendix" id="s33"><title>7.1 Frequency thresholds in the empirical data</title><p>It remains to set the minimal frequency <inline-formula><mml:math id="inf593"><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math></inline-formula> in the data of <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref> and <xref ref-type="bibr" rid="bib33">Li et al., 2022</xref>. <inline-formula><mml:math id="inf594"><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math></inline-formula> depends not only on the sequencing depth per sample but also the spatial sampling density. We discuss the dependency of the frequency threshold <inline-formula><mml:math id="inf595"><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math></inline-formula> on the spatial sampling for the case of sampling within one cross section of a 3D spherical tumour, as in the Ling et al. data, or several slices of a hemisphere, as in the two tumours from Li et al. In both cases, the idea is that only a fraction of the whole tumour is being sampled. Therefore, the rarest mutations found in the sample actually occur at a lower frequency within the whole 3D tumour and happened to fall within the sampled fraction of the tumour. We set a threshold on the frequency of mutations <inline-formula><mml:math id="inf596"><mml:msub><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> within the set of sequenced samples that is larger or equal to the frequency resolution for the given sequencing depth.</p><p>The minimal resolved whole tumour frequency <inline-formula><mml:math id="inf597"><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math></inline-formula> is the smallest frequency with respect to the whole tumour of any mutation that occurs at a frequency greater than <inline-formula><mml:math id="inf598"><mml:msub><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> in the sampled plane. It necessarily describes a mutation that only occurs in our set of samples and has frequency <inline-formula><mml:math id="inf599"><mml:msub><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> therein. From our choice of <inline-formula><mml:math id="inf600"><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math></inline-formula> on, we proceed to estimate the effective population size <inline-formula><mml:math id="inf601"><mml:mi>N</mml:mi></mml:math></inline-formula> for each of the three tumours.</p><sec sec-type="appendix" id="s33-1-1"><title>Sampling from a tumour cross-section (Ling et al.)</title><p><xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref> take samples from a cross section of the 3D tumour and detect mutations with a range of mutation frequencies within this set of samples. To find which is the minimal mutation frequency with respect to the whole tumour that still passes a threshold <inline-formula><mml:math id="inf602"><mml:msub><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> on the sampled slice, we ask how many samples under the given regular spacing would fit into a spherical tumour of the same diameter.</p><p>Given the spatially even and dense sampling we assume a triangular lattice and take the mean nearest neighbour distance between samples as the lattice constant <inline-formula><mml:math id="inf603"><mml:mi>r</mml:mi></mml:math></inline-formula>. We compute the mean spherical tumour radius <inline-formula><mml:math id="inf604"><mml:mi>R</mml:mi></mml:math></inline-formula> using the dense packing ratio <inline-formula><mml:math id="inf605"><mml:mfrac><mml:mi>π</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mrow></mml:mfrac></mml:math></inline-formula> for the plane.<disp-formula id="equ30"><label>(25)</label><mml:math id="m30"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mi>n</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mfrac><mml:mi>π</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mrow></mml:mfrac></mml:msqrt></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Then <inline-formula><mml:math id="inf606"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the number of samples that fill the spherical tumour of radius <inline-formula><mml:math id="inf607"><mml:mi>R</mml:mi></mml:math></inline-formula> given the dense packing ratio <inline-formula><mml:math id="inf608"><mml:mfrac><mml:mi>π</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow></mml:mfrac></mml:math></inline-formula> for the 3D lattice:<disp-formula id="equ31"><label>(26)</label><mml:math id="m31"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mfrac><mml:mi>π</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ32"><label>(27)</label><mml:math id="m32"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mfrac><mml:mn>2</mml:mn><mml:msqrt><mml:mi>π</mml:mi><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:msqrt></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Finally, given a frequency threshold <inline-formula><mml:math id="inf609"><mml:msub><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> within the sampled plane for <inline-formula><mml:math id="inf610"><mml:mi>n</mml:mi></mml:math></inline-formula> samples, we can estimate the minimal, resolved frequency in the whole tumour to be <inline-formula><mml:math id="inf611"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mtext>res</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> because the total read-depth at a given site on the genome scales linearly with the number of samples from <inline-formula><mml:math id="inf612"><mml:mi>n</mml:mi></mml:math></inline-formula> to <inline-formula><mml:math id="inf613"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>Essentially, if our lower bound on mutation frequency in the sampled plane is <inline-formula><mml:math id="inf614"><mml:msub><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> we include mutations down to the frequency <inline-formula><mml:math id="inf615"><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math></inline-formula> with respect to the 3D tumour regardless of fluctuations in read counts. Increasing the sample size <inline-formula><mml:math id="inf616"><mml:mi>n</mml:mi></mml:math></inline-formula> necessarily improves the frequency resolution as <inline-formula><mml:math id="inf617"><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo lspace="0em" rspace="0em">−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>∝</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> under uniform sampling but the minimal, resolved frequency when sampling only the cross-section of a spherical tumour scales as <inline-formula><mml:math id="inf618"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub><mml:mo>∝</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>.</mml:mi></mml:mrow></mml:math></inline-formula> Thus, the effective population size <xref ref-type="disp-formula" rid="equ29">Equation 24</xref> becomes<disp-formula id="equ33"><label>(28)</label><mml:math id="m33"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mfrac><mml:mi>n</mml:mi><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:mfrac><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula><disp-formula id="equ34"><label>(29)</label><mml:math id="m34"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mfrac><mml:mn>2</mml:mn><mml:msqrt><mml:mi>π</mml:mi><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:msqrt></mml:mfrac><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>In the rest of this section as well as in other sections we will simply refer to the effective population size <inline-formula><mml:math id="inf619"><mml:msub><mml:mi>N</mml:mi><mml:mtext>eff</mml:mtext></mml:msub></mml:math></inline-formula> as <inline-formula><mml:math id="inf620"><mml:mi>N</mml:mi></mml:math></inline-formula>.</p><p>Based on this estimate and the correction for high cell turnover from <xref ref-type="disp-formula" rid="equ29">Equation 24</xref>, we use the effective population size <xref ref-type="disp-formula" rid="equ33">Equation 28</xref> both for the inference of the relative death rate from the turnover, and for the analysis based on the mutational distances.</p><p>Because the frequency resolution and hence the population size estimate depends on the density of sampling we actually have two different effective population sizes: In the set of samples characterized by genotyping (high resolution, used to distinguish between volume and surface growth and for turnover inference) we consider mutations that occur in at least two of these samples. Such mutations can be assigned to clones, whereas it is impossible to confidently tell the relation of a mutation that occurs in a single sample to other mutations in its sample, see Appendix 8. Choosing the frequency cutoff such that mutations occur in at least two genotyped samples means that both metrics (directed growth and turnover) describe the dynamics of the set of clones up to the tumour size where a clone fails to colonize a spatially separated sample and reach detectable size therein until surgical resection. This is where the sampling density comes into play, since increasing the number of samples makes it more likely to sample a region where the clone has already reached sufficient size. We obtain the corresponding effective population size <inline-formula><mml:math id="inf621"><mml:mi>N</mml:mi></mml:math></inline-formula> using <xref ref-type="disp-formula" rid="equ33">Equation 28</xref>: <inline-formula><mml:math id="inf622"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>285</mml:mn></mml:mrow></mml:math></inline-formula> samples underwent genotyping, giving an estimate of <inline-formula><mml:math id="inf623"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mn>4000</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> in 3D, the resolution is set to <inline-formula><mml:math id="inf624"><mml:mrow><mml:mi>n</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> as specified in 8 because mutations must be recovered in two samples, and finally our turnover-based inference results in a turnover rate <inline-formula><mml:math id="inf625"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>0.975</mml:mn></mml:mrow></mml:math></inline-formula>, giving <inline-formula><mml:math id="inf626"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>⋅</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:mfrac><mml:mo>≈</mml:mo><mml:mn>82500</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>In contrast, we can only measure the spatial dispersion of mutations that grew to detectable frequency in at least two whole-exome sequenced samples (deeply sequence samples and used to obtain cancer cell fractions and the site frequency spectrum). These samples resolve mutations up to a minimum frequency of <inline-formula><mml:math id="inf627"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mtext>res</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mn>40</mml:mn></mml:mrow></mml:math></inline-formula> (see Appendix 4), meaning that those mutations arose when the size of the tumour was only around <inline-formula><mml:math id="inf628"><mml:mrow><mml:mi>N</mml:mi><mml:mo>≈</mml:mo><mml:mn>3300</mml:mn></mml:mrow></mml:math></inline-formula> in size, where <inline-formula><mml:math id="inf629"><mml:mi>N</mml:mi></mml:math></inline-formula> is again the effective population size <xref ref-type="disp-formula" rid="equ33">Equation 28</xref>. Further details beyond this early stage of tumour development remain unresolved. Future data with a deeper sequencing and a higher spatial resolution will allow probing tumour evolution beyond this early stage.</p><p>The larger set of 285 genotyped samples targets the sites of mutations detected by whole-exome sequencing in the smaller set consisting of 23 samples. One might therefore ask whether the estimate on effective population size <inline-formula><mml:math id="inf630"><mml:mi>N</mml:mi></mml:math></inline-formula> depends on the smaller, WES-sequenced set of samples which defines the selection of mutations or the larger genotyped set from which clones are inferred, see also Appendix 5. We explored this question in simulations over a range of turnover rates <inline-formula><mml:math id="inf631"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula> from 0 to 0.8 by applying a sampling procedure similar to that of Ling et al. (see <xref ref-type="fig" rid="app5fig3">Appendix 5—figure 3</xref>), varying the size of the smaller (sequencing) and the larger (genotyping) set of samples, and observing how the measured clade and clone turnover <inline-formula><mml:math id="inf632"><mml:msub><mml:mi>W</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf633"><mml:msub><mml:mi>W</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:math></inline-formula> compares to the theoretical prediction which depends on <inline-formula><mml:math id="inf634"><mml:mi>N</mml:mi></mml:math></inline-formula>. How closely the measured turnover fits the theory at a given <inline-formula><mml:math id="inf635"><mml:mi>N</mml:mi></mml:math></inline-formula> reflects in the quality of inference of <inline-formula><mml:math id="inf636"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf637"><mml:mi>μ</mml:mi></mml:math></inline-formula>. We find that, (1) the measured turnover fits the theory closest if <inline-formula><mml:math id="inf638"><mml:mi>N</mml:mi></mml:math></inline-formula> is computed from the (larger) sample size of the genotyping set, (2) the measured turnover does not vary up to sampling noise when taking differently sized mutation-calling sets, and (3) the measured turnover decreases and increases for larger and smaller sample size of the genotyping set, respectively, as is theoretically expected for larger and smaller <inline-formula><mml:math id="inf639"><mml:mi>N</mml:mi></mml:math></inline-formula>, respectively.</p></sec><sec sec-type="appendix" id="s33-1-2"><title>Sampling from a tumour hemisphere (Li et al.)</title><p>Similarly, we estimate the effective population size for the tumours T1 and T2 from <xref ref-type="bibr" rid="bib33">Li et al., 2022</xref>. In contrast to <xref ref-type="bibr" rid="bib34">Ling et al., 2015</xref>, samples are taken from several slices of the upper hemispheres of both tumours. Therefore, the estimate of the effective number of samples in the whole sphere <inline-formula><mml:math id="inf640"><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false" style="math-style:normal;math-depth:0;">~</mml:mo></mml:mover></mml:math></inline-formula> is simply <inline-formula><mml:math id="inf641"><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf642"><mml:mi>n</mml:mi></mml:math></inline-formula> samples in the hemisphere.</p><p>Including the <inline-formula><mml:math id="inf643"><mml:mi>d</mml:mi></mml:math></inline-formula>-dependent correction in the estimate of effective population size <inline-formula><mml:math id="inf644"><mml:mi>N</mml:mi></mml:math></inline-formula> for the conditioning on survival of tumours <xref ref-type="disp-formula" rid="equ29">Equation 24</xref>, given the estimated turnover rates <inline-formula><mml:math id="inf645"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>0.944</mml:mn></mml:mrow></mml:math></inline-formula> and 0.976, yields <inline-formula><mml:math id="inf646"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext/><mml:mi>T1</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>3000</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf647"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext/><mml:mi>T2</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>6600</mml:mn></mml:mrow></mml:math></inline-formula>. Despite the high uncertainty in <inline-formula><mml:math id="inf648"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula>, the estimated population size is lower than what we found for the clonal data of Ling et al. by more than an order of magnitude due to the lower density of samples in the data by Li et al.</p></sec></sec></app><app id="appendix-8"><title>Appendix 8</title><sec sec-type="appendix" id="s34"><title>Inference of clones</title><p>Our methods are based on the spatial distribution of genetic mutations in a mixed population of cells with different genotypes. It is straightforward to evaluate and interpret them for single-cell data where each sample represent a true genotype from the population. However, samples obtained by needle biopsies contain thousands of cells (about 200 in Ling et al. and Li et al. or ∼ 3200 in the Li et al. WGS samples) and generally contain a mixture of clones. This mixing of clones is particularly prevalent under volume growth, as can be seen by the dispersion of mutations, see Appendix 4. Genomic data from a large number of samples is well suited for the reconstruction of clones because the different samples already reveal to some extent the variety in genotypes. The clonal composition can be further resolved by clustering mutations by their sample frequencies on the level of single samples as well as the whole tumour (if mutation frequencies are available). For instance, two mutations might have very similar whole-tumour frequencies but do not coincide across samples (i.e. some samples have mutation A but not B) or have different frequencies in single samples and therefore do not belong to the same clone.</p><p>Clustering by frequency works best given a large number of mutations. Mutations belonging to one clone occur at equal frequency up to sampling noise and hence form a frequency cluster. The more mutations a clone has, the more confidently a clone can be identified, opposed to the random similarity in frequency between unrelated mutations. A larger number of samples on the other hand imposes stricter constraints on the clustering of mutations. Mutations must have very similar frequency in all samples to be part of the same clone, which might be hard to fulfill in the presence of sequencing noise.</p><p>We use two methods for the reconstruction of clones: As a first approach we use a simple clustering scheme where mutations that coincide across samples are clustered into clones. A simple example to illustrate this scheme mixes genotypes labeled by letters A, B, C, D into samples. The samples {AC},{AB},{BD}decompose into {[AC]}, {[A][B]}, {[BD]}, and as a rule, an ancestral clone will not be added to the sample, so {[AC]}does not become {[A],[AC]}. Despite its simplicity this scheme, when applied to artificially sampled simulations, is sufficient to recover the distributions of the direction angle (<xref ref-type="fig" rid="app2fig2">Appendix 2—figures 2</xref> and <xref ref-type="fig" rid="app2fig3">3</xref>) and the rates from the turnover based inference already measured using simulated single cell data of the same simulations (see <xref ref-type="fig" rid="app5fig3">Appendix 5—figure 3</xref>).</p><p>We further compare this simple clone reconstruction scheme to the LICHeE tool (<xref ref-type="bibr" rid="bib47">Popic et al., 2015</xref>) designed specifically for multi-sample clone inference. LICHeE can leverage mutation frequencies of multiple samples to simultaneously cluster clones and determine their lineages and has been shown by the authors to better resolve tumour phylogenies when compared to tools designed for single bulk-samples (<xref ref-type="bibr" rid="bib47">Popic et al., 2015</xref>).</p><p>In the case of the data by Ling et al., LICHeE detects 27 clones and their phylogenetic tree from the presence profiles in the large set of 285 genotyped samples. Out of these clones, 22 agree with clones from our simple clustering, with the remaining 5 only differing each by one mutation which are ambiguous in their assignment to a clone and were removed from the set of mutations. However, both clustered sets of clones produce very similar results in the discussion of directed growth, see Appendix 2, and in the turnover based inference of mutation and cell death rates, see Appendix 5.</p><p>Li et al., on the other hand, probe for the presence of 906 and 565 SNVs using genotyping in the tumours T1 and T2, respectively. Given the large number of mutations per sample, it is more likely than in the data by Ling et al. that the genotyping misses some mutations in a given sample or falsely reports them as present. Our simple clone reconstruction is sensitive to both false negatives and positives and very likely produces false clones here. The LICHeE tool, on the other hand, cannot resolve the constraint network defined by the large sets of genotyped sample profiles.</p><p>Instead, we apply LICHeE to the set of WGS samples, where it first clusters mutations by their measured variant allele frequencies before solving the (smaller) constraint network imposed by the WGS samples. LICHeE infers 25 and 14 clones for T1 and T2, respectively. We then proceed to recover the inferred clones in the genotyped samples by splitting the sample phenotypes into their constituent clones. This is useful for the analysis of the growth mode in Appendix 2.2, which relies on the higher spatial resolution of the genotyped samples. Testing this approach of splitting a sample into the different clones on the WGS samples from which LICHeE inferred the clones in the first place exactly recovers the split proposed by LICHeE.</p><table-wrap id="app8table1" position="float"><label>Appendix 8—table 1.</label><caption><title>Clones and their phylogeny from the Ling et al data.</title><p>Each row shows one branch in the phylogenic tree inferred by LICHeE for the Ling et al. data. Columns labelled ‘parent’ and ‘offspring’ show mutations of the parental and offspring clone, respectively. The mutations along the branch are the private mutations the offspring has gained, the difference between the two sets of mutations. ‘root’ indicates that the clone has no ancestor in the given set of clones other than the common ancestor to all clones which has the clonal mutations.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Parent</th><th align="left" valign="bottom">Offspring</th></tr></thead><tbody><tr><td align="left" valign="bottom">[30]</td><td align="left" valign="bottom">[30, 33, 34]</td></tr><tr><td align="left" valign="bottom">root</td><td align="left" valign="bottom">[30]</td></tr><tr><td align="left" valign="bottom">root</td><td align="left" valign="bottom">[22]</td></tr><tr><td align="left" valign="bottom">root</td><td align="left" valign="bottom">[6]</td></tr><tr><td align="left" valign="bottom">[23, 24]</td><td align="left" valign="bottom">[23, 24, 25]</td></tr><tr><td align="left" valign="bottom">[10, 11]</td><td align="left" valign="bottom">[10, 11, 12, 13, 14]</td></tr><tr><td align="left" valign="bottom">[23, 24]</td><td align="left" valign="bottom">[23, 24, 26]</td></tr><tr><td align="left" valign="bottom">[6, 7]</td><td align="left" valign="bottom">[6, 7, 8]</td></tr><tr><td align="left" valign="bottom">root</td><td align="left" valign="bottom">[3]</td></tr><tr><td align="left" valign="bottom">root</td><td align="left" valign="bottom">[15, 16]</td></tr><tr><td align="left" valign="bottom">[15, 16]</td><td align="left" valign="bottom">[15, 16, 17]</td></tr><tr><td align="left" valign="bottom">[6]</td><td align="left" valign="bottom">[6, 7]</td></tr><tr><td align="left" valign="bottom">[6, 7]</td><td align="left" valign="bottom">[6, 7, 9]</td></tr><tr><td align="left" valign="bottom">[15, 16, 17]</td><td align="left" valign="bottom">[15, 16, 17, 18]</td></tr><tr><td align="left" valign="bottom">[3]</td><td align="left" valign="bottom">[3, 4]</td></tr><tr><td align="left" valign="bottom">[30]</td><td align="left" valign="bottom">[30, 31]</td></tr><tr><td align="left" valign="bottom">[23, 24, 27]</td><td align="left" valign="bottom">[23, 24, 27, 28]</td></tr><tr><td align="left" valign="bottom">root</td><td align="left" valign="bottom">[10]</td></tr><tr><td align="left" valign="bottom">[30]</td><td align="left" valign="bottom">[30, 35]</td></tr><tr><td align="left" valign="bottom">[23, 24]</td><td align="left" valign="bottom">[23, 24, 29]</td></tr><tr><td align="left" valign="bottom">[23, 24]</td><td align="left" valign="bottom">[23, 24, 27]</td></tr><tr><td align="left" valign="bottom">root</td><td align="left" valign="bottom">[23, 24]</td></tr><tr><td align="left" valign="bottom">[3]</td><td align="left" valign="bottom">[3, 5]</td></tr><tr><td align="left" valign="bottom">[30, 31]</td><td align="left" valign="bottom">[30, 31, 32]</td></tr><tr><td align="left" valign="bottom">root</td><td align="left" valign="bottom">[1, 2]</td></tr><tr><td align="left" valign="bottom">[10]</td><td align="left" valign="bottom">[10, 11]</td></tr><tr><td align="left" valign="bottom">[15, 16]</td><td align="left" valign="bottom">[15, 16, 19, 20, 21]</td></tr></tbody></table></table-wrap><table-wrap id="app8table2" position="float"><label>Appendix 8—table 2.</label><caption><title>LICHeE-derived branches for tumours T1 and T2 of the Li et al data.</title><p>Each row shows one branch in the phylogenic tree inferred by LICHeE for the T1 tumour of the Li et al. data. Clones have too many private mutations to list and are therefore only numbered Clone numbers are given in columns ‘parent’ and ‘offspring’ along with the number of mutations along a branch (‘mutations’). ‘root’ indicates that the clone has no ancestor in the given set of clones other than the common ancestor to all clones which has the clonal mutations.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="middle" colspan="3">T1</th><th align="left" valign="middle" colspan="3">T2</th></tr></thead><tbody><tr><td align="left" valign="bottom">parent</td><td align="left" valign="bottom">offspring</td><td align="left" valign="bottom">mutations</td><td align="left" valign="bottom">parent</td><td align="left" valign="bottom">offspring</td><td align="left" valign="bottom">mutations</td></tr><tr><td align="char" char="." valign="bottom">15</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">32</td><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">2</td></tr><tr><td align="char" char="." valign="bottom">15</td><td align="char" char="." valign="bottom">2</td><td align="char" char="." valign="bottom">25</td><td align="char" char="." valign="bottom">3</td><td align="char" char="." valign="bottom">2</td><td align="char" char="." valign="bottom">14</td></tr><tr><td align="char" char="." valign="bottom">13</td><td align="char" char="." valign="bottom">3</td><td align="char" char="." valign="bottom">8</td><td align="char" char="." valign="bottom">8</td><td align="char" char="." valign="bottom">3</td><td align="char" char="." valign="bottom">6</td></tr><tr><td align="char" char="." valign="bottom">8</td><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">7</td><td align="left" valign="bottom">root</td><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">20</td></tr><tr><td align="left" valign="bottom">root</td><td align="char" char="." valign="bottom">5</td><td align="char" char="." valign="bottom">68</td><td align="char" char="." valign="bottom">11</td><td align="char" char="." valign="bottom">5</td><td align="char" char="." valign="bottom">4</td></tr><tr><td align="char" char="." valign="bottom">20</td><td align="char" char="." valign="bottom">6</td><td align="char" char="." valign="bottom">6</td><td align="char" char="." valign="bottom">7</td><td align="char" char="." valign="bottom">6</td><td align="char" char="." valign="bottom">16</td></tr><tr><td align="char" char="." valign="bottom">19</td><td align="char" char="." valign="bottom">7</td><td align="char" char="." valign="bottom">30</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">7</td><td align="char" char="." valign="bottom">27</td></tr><tr><td align="char" char="." valign="bottom">9</td><td align="char" char="." valign="bottom">8</td><td align="char" char="." valign="bottom">10</td><td align="char" char="." valign="bottom">11</td><td align="char" char="." valign="bottom">8</td><td align="char" char="." valign="bottom">17</td></tr><tr><td align="char" char="." valign="bottom">5</td><td align="char" char="." valign="bottom">9</td><td align="char" char="." valign="bottom">56</td><td align="char" char="." valign="bottom">8</td><td align="char" char="." valign="bottom">9</td><td align="char" char="." valign="bottom">7</td></tr><tr><td align="char" char="." valign="bottom">13</td><td align="char" char="." valign="bottom">10</td><td align="char" char="." valign="bottom">3</td><td align="left" valign="bottom">root</td><td align="char" char="." valign="bottom">10</td><td align="char" char="." valign="bottom">38</td></tr><tr><td align="char" char="." valign="bottom">20</td><td align="char" char="." valign="bottom">11</td><td align="char" char="." valign="bottom">6</td><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">11</td><td align="char" char="." valign="bottom">56</td></tr><tr><td align="char" char="." valign="bottom">16</td><td align="char" char="." valign="bottom">12</td><td align="char" char="." valign="bottom">19</td><td align="char" char="." valign="bottom">7</td><td align="char" char="." valign="bottom">12</td><td align="char" char="." valign="bottom">10</td></tr><tr><td align="char" char="." valign="bottom">21</td><td align="char" char="." valign="bottom">13</td><td align="char" char="." valign="bottom">10</td><td align="char" char="." valign="bottom">3</td><td align="char" char="." valign="bottom">13</td><td align="char" char="." valign="bottom">2</td></tr><tr><td align="char" char="." valign="bottom">9</td><td align="char" char="." valign="bottom">14</td><td align="char" char="." valign="bottom">14</td><td align="left" valign="bottom">root</td><td align="char" char="." valign="bottom">14</td><td align="char" char="." valign="bottom">39</td></tr><tr><td align="char" char="." valign="bottom">7</td><td align="char" char="." valign="bottom">15</td><td align="char" char="." valign="bottom">57</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="char" char="." valign="bottom">5</td><td align="char" char="." valign="bottom">16</td><td align="char" char="." valign="bottom">35</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="char" char="." valign="bottom">12</td><td align="char" char="." valign="bottom">17</td><td align="char" char="." valign="bottom">12</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="char" char="." valign="bottom">21</td><td align="char" char="." valign="bottom">18</td><td align="char" char="." valign="bottom">11</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">root</td><td align="char" char="." valign="bottom">19</td><td align="char" char="." valign="bottom">46</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="char" char="." valign="bottom">8</td><td align="char" char="." valign="bottom">20</td><td align="char" char="." valign="bottom">14</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="char" char="." valign="bottom">22</td><td align="char" char="." valign="bottom">21</td><td align="char" char="." valign="bottom">9</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="char" char="." valign="bottom">12</td><td align="char" char="." valign="bottom">22</td><td align="char" char="." valign="bottom">18</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">root</td><td align="char" char="." valign="bottom">23</td><td align="char" char="." valign="bottom">2</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">root</td><td align="char" char="." valign="bottom">24</td><td align="char" char="." valign="bottom">55</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="char" char="." valign="bottom">22</td><td align="char" char="." valign="bottom">25</td><td align="char" char="." valign="bottom">10</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr></tbody></table></table-wrap></sec></app><app id="appendix-9"><title>Appendix 9</title><sec sec-type="appendix" id="s35"><title>Subsampling of mutations and mutational signatures</title><p>In order to estimate the statistical robustness of our estimate of the per-generation mutation rate and the relative rate of cell death, we perform the inference described in Appendix 5 also on subsets of the mutations. (A standard bootstrapping, where mutations are resampled without replacement is not feasible here, as it would produce duplicates of samples with zero mutational distance.) <xref ref-type="fig" rid="app9fig1">Appendix 9—figure 1</xref> shows the inference results for the Ling et al. data for different relative sizes of the subset <inline-formula><mml:math id="inf649"><mml:mi>L</mml:mi></mml:math></inline-formula> ranging from 0.5 to 0.9. No systematic drift with the sampling fraction <inline-formula><mml:math id="inf650"><mml:mi>L</mml:mi></mml:math></inline-formula> is seen; correspondingly <xref ref-type="fig" rid="fig4">Figure 4C</xref> in the main text shows the results from the different fractions combined.</p><fig id="app9fig1" position="float"><label>Appendix 9—figure 1.</label><caption><title>Violin plots of model parameters (number of mutations per generation and relative death rate) inferred from different fractions <inline-formula><mml:math id="inf651"><mml:mi>L</mml:mi></mml:math></inline-formula> of the mutations present in the Ling et al data.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app9-fig1-v1.tif"/></fig><p>An unrelated point linked to subsampling of mutations concerns our observation of a particular mutational signature (SBS22) in the clonal mutations of Ling et al., but not the subclonal mutations. This is compatible with exposure to the mutagen causing this particular signature during tumourigenesis, and the absence of the mutagen during the later stages of tumour growth. Here, we ask how likely is an alternative scenario, namely that the signature is present also in subclonal mutations with the same statistical weight as seen in the clonal mutations, but is not detected due to the finite number of mutations (sampling noise).</p><p>We decomposed the mutational profiles of the tumours from the two studies using our in-house method SigNet (<xref ref-type="bibr" rid="bib49">Serrano Colome et al., 2023</xref>). SigNet is based on an artificial neural network and predicts the weights of the COSMIC v3 mutational signature catalog (<xref ref-type="bibr" rid="bib1">Alexandrov et al., 2020</xref>) in individual samples. If the sample profile does not correspond to the training data, it is decomposed with non-negative least squares (NNLS). SBS1, SBS5 and SBS40 are associated with endogenous mutational processes. Since the samples that contain SBS25 were decomposed with a non-negative least squares approach (as they were classified as out-of-distribution by SigNet), it is likely that SBS25 is an erroneous assignment derived from SBS5 and SBS22 mutations (<xref ref-type="bibr" rid="bib1">Alexandrov et al., 2020</xref>). The high number of signatures classified as ‘Others’ in samples for which the NNLS approach was used is compatible with the low accuracy of this approach when the number of mutations in the sample is small.</p><p>To address the effect of subsampling on the mutational signatures, we run the in-house SigNet algorithm (<xref ref-type="bibr" rid="bib49">Serrano Colome et al., 2023</xref>) on 10<sup>4</sup> artificially generated instances with different weights of SBS22. Weights of the other signatures contributing to each simulated sample were maintained at the same relative proportions as found in the decomposition of the subclonal mutations in the whole-exome data of Ling et al. for all weights of SBS22. Each instance contained 66 mutations, the number of subclonal exomic mutations in the Ling et al. tumour.</p><p>The weight of SBS22 when pooling clonal and subclonal mutations was 0.78. The probability that although subclonal mutations have SBS22 at this particular weight, but the signature is not detected on the basis of only 66 mutations is estimated to be less than 10<sup>−4</sup> (the event did not occur in 10<sup>4</sup> runs of the simulation). This provides an estimate of how likely the alternative scenario of undetected SBS22 is (p-value), leading us to reject the alternative scenario.</p><fig id="app9fig2" position="float"><label>Appendix 9—figure 2.</label><caption><title>Sampling mutations with different weights of a particular signature (SBS22).</title><p>Weights of SBS22 are shown on the x-axis, the probability of not detecting SBS22 given 66 mutations is shown on the y axis and rapidly decays with the underlying weight of SBS22, see text.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-95338-app9-fig2-v1.tif"/></fig></sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.95338.3.sa0</article-id><title-group><article-title>eLife Assessment</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Flegg</surname><given-names>Jennifer</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>The University of Melbourne</institution><country>Australia</country></aff></contrib></contrib-group><kwd-group kwd-group-type="evidence-strength"><kwd>Convincing</kwd></kwd-group><kwd-group kwd-group-type="claim-importance"><kwd>Important</kwd></kwd-group></front-stub><body><p>The article uses a cell-based model to investigate how mutations and cells spread throughout a tumour. The paper uses published data and the proposed model to understand how growth and death mechanisms lead to the observed data. This work provides an <bold>important</bold> insight into the early stages of tumour development. From the work provided here, the results are <bold>convincing</bold>, using a thorough analysis.</p></body></sub-article><sub-article article-type="referee-report" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.95338.3.sa1</article-id><title-group><article-title>Reviewer #1 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>Arman Angaji and his team delved into the intricate world of tumor growth and evolution, utilizing a blend of computer simulations and real patient data from liver cancer.</p><p>Strengths:</p><p>Their analysis of how mutations and clones are distributed within tumors revealed an interesting finding: tumors don't just spread from their edges as previously believed. Instead, they expand both from within and the edges simultaneously, suggesting a unique growth mode. This mode naturally indicates that external forces may play a role in cancer cells dispersion within the tumor. Moreover, their research hints at an intriguing phenomenon - the high death rate of progenitor cells and extremely slow pace in growth in the initial phase of tumor expansion. Understanding this dynamic could significantly impact our comprehension of cancer development.</p><p>Weaknesses:</p><p>It's important to note, however, that this study relies on specific computer models, metrics derived from inferred clones, and a limited number of patient data. While the insights gained are promising, further investigation is essential to validate these findings. Nonetheless, this work opens up exciting avenues for comprehending the evolution of cancers.</p><p>Comments on revised submission:</p><p>The authors have effectively addressed my concerns. This revision is excellent.</p></body></sub-article><sub-article article-type="referee-report" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.95338.3.sa2</article-id><title-group><article-title>Reviewer #2 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>The article uses a cell-based model to investigate how mutations and cells spread throughout a tumour. The paper uses published data and the proposed model to understand how growth and death mechanisms lead to the observed data. This work provides an insight into the early stages of tumour development. From the work provided here, the results are solid, showing a thorough analysis. The article is well written and presents a very suitable and rigorous analysis to describe the data. The authors did a particularly nice job of the discussion and decision of their &quot;metrics of interest&quot;, though this is not the main aim of this work.</p><p>Strengths:</p><p>Due to the particularly nice and tractable cell-based model, the authors are able to perform a thorough analysis to compare the published data to that simulated with their model. They then used their computational model to investigate different growth mechanisms of volume growth and surface growth. With this approach, the authors are able to compare the metric of interest (here, the direction angle of a new mutant clone, the dispersion of mutants throughout the tumour) to quantify how the different growth models compare to the observed data. The authors have also used inference methods to identify model parameters based on the data observed. The authors performed a rigorous analysis and have chosen the metrics in an appropriate manner to compare the different growth mechanisms.</p><p>Context:</p><p>Improved mechanistic understanding into the early developmental stages of tumours will further assist in disease treatment and quantification. Understanding how readily and quickly a tumour is evolving is key to understanding how it will develop and progress. This work provides a solid example as to how this can be achieved with data alongside simulated models.</p></body></sub-article><sub-article article-type="author-comment" id="sa3"><front-stub><article-id pub-id-type="doi">10.7554/eLife.95338.3.sa3</article-id><title-group><article-title>Author response</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Angaji</surname><given-names>Arman</given-names></name><role specific-use="author">Author</role><aff><institution>University of Cologne</institution><addr-line><named-content content-type="city">Cologne</named-content></addr-line><country>Germany</country></aff></contrib><contrib contrib-type="author"><name><surname>Owusu</surname><given-names>Michel</given-names></name><role specific-use="author">Author</role><aff><institution>Centre for Genomic Regulation</institution><addr-line><named-content content-type="city">Barcelona</named-content></addr-line><country>Spain</country></aff></contrib><contrib contrib-type="author"><name><surname>Velling</surname><given-names>Christoph</given-names></name><role specific-use="author">Author</role><aff><institution>University of Cologne</institution><addr-line><named-content content-type="city">Cologne</named-content></addr-line><country>Germany</country></aff></contrib><contrib contrib-type="author"><name><surname>Dick</surname><given-names>Nicola</given-names></name><role specific-use="author">Author</role><aff><institution>Centre for Genomic Regulation</institution><addr-line><named-content content-type="city">Barcelona</named-content></addr-line><country>Spain</country></aff></contrib><contrib contrib-type="author"><name><surname>Weghorn</surname><given-names>Donate</given-names></name><role specific-use="author">Author</role><aff><institution>Centre for Genomic Regulation</institution><addr-line><named-content content-type="city">Barcelona</named-content></addr-line><country>Spain</country></aff></contrib><contrib contrib-type="author"><name><surname>Berg</surname><given-names>Johannes</given-names></name><role specific-use="author">Author</role><aff><institution>University of Cologne</institution><addr-line><named-content content-type="city">Cologne</named-content></addr-line><country>Germany</country></aff></contrib></contrib-group></front-stub><body><p>The following is the authors’ response to the original reviews.</p><p><bold>Public reports:</bold></p><p>In the public reports there is only one point we would like to discuss. It concerns our use of a computational model to analyse spatial tumour growth. Citing from the eLife assessment, which reflects several comments of the referees:</p><p>The paper uses published data and a proposed cell-based model to understand how growth and death mechanisms lead to the observed data. This work provides an important insight into the early stages of tumour development. From the work provided here, the results are solid, showing a thorough analysis. However, the work has not fully specified the model, which can lead to some questions around the model’s suitability.</p><p>The observables we use to determine the (i) growth mode and the (ii) dispersion of cells are modelindependent. The method to determine the (iii) rate of cell death does not use a spatial model. Throughout, our computational model of spatial growth is not used to analyze data. Instead, it is used to check that the observables we use can actually discriminate between different growth modes given the limitations of the data. We have expanded the description of the computational model in the revised version, and have released our code on Github. However, the conclusions we reach do not rely on a computational model. Instead, where we estimate parameters, we use population dynamics as described in section S5. The other observables are parameter free and model-independent. We view this as a strength of our approach.</p><disp-quote content-type="editor-comment"><p><bold>Recommendations for the authors:</bold></p><p><bold>Reviewer #1:</bold></p><p>(1.1) In Figure 1, the data presented by Ling et al. demonstrate a distinctive “comb” pattern. While this pattern diverges from the conventional observations associated with simulated surface growth, it also differs from the simulated volume growth pattern. Is this discrepancy attributable to insufficient data? Alternatively, could the emergence of such a comb-like structure be feasible in scenarios featuring multiple growth centers, wherein clones congregate into spatial clusters?</p></disp-quote><p>We are unsure what you are referring to. One possibility is you refer to the honey-comb structure formed by the samples of the Ling et al. data shown in Fig. 1A of the main text. This is an artefact arising from the cutting of the histological cut into four quadrants, see Fig. S1 in the SI of Ling et al. The perceived horizontal and vertical “white lines” in our Fig. 1A stems from the lack of samples near the edges of these quadrants. We have added this information to the figure caption.</p><p>An alternative is you are referring to the peaks in Fig 2A of the main text. The three of these peaks indeed stem from individual clones. We have placed additional figures in the SI (S2 B and S2 C) to disentangle the contribution from different clones. The peaks have a simple explanation: each clone contributes the same weight to the histogram. If a clone only has few offspring, this statistical weight is concentrated on a few angles only, see SI Figure S2 B.</p><disp-quote content-type="editor-comment"><p>(1.2) I am not sure why there are two sections about “Methods” in the main text: Line 50 as well as Line 293. Furthermore, the methods outlined in the main paper lack the essential details necessary for readers to navigate through the critical aspects of their analysis. While these details are provided in the Supplementary Information, they are not adequately referenced within the methods section of the main text. I would recommend that the authors revise the method sections of the main text to include pertinent descriptions of key concepts or innovations, while also directing readers to the corresponding supplementary method section for further elucidation.</p></disp-quote><p>We have merged the Section “Materials and Methods” at the end of the main text with the SI description of the data in SI 4.2 and placed a reference to this material in the main body.</p><disp-quote content-type="editor-comment"><p>(1.3) The impact of the particular push method (proposed in the model) on the resultant spatial arrangement of clones remains unclear. For instance, it’s conceivable that employing a different pushing method (for example, with more strict constraints on direction) could yield a varied pattern of spatial diversity. Furthermore, there is ambiguity regarding the criteria for determining the sequence of the queue housing overlapping cells.</p></disp-quote><p>Regarding the off-lattice dynamics we use, there are indeed many variants one could use. In nonexhaustive trials, we found that the details of the off-lattice dynamics did not affect the results. The reason may be that at each computational step, each cell only moves a very small amount, and differences in the dynamics tend to average out over time.</p><p>We deliberately do not give constraints on the direction. Such constraints emerge in lattice-based models (when preferred directions arise from the lattice symmetry), but these are artifacts of the lattice.</p><p>At cell division the offspring is placed in a random direction next to the parent regardless of whether this introduces an overlap. Cells then push each other along the axis connecting their two centers of mass – unlike in lattice based models a sequence of pushes does not propagate through the tumor straight away but sets off of a cascade of pushes. Equal pushing of two cells (i.e. two initial displacements as opposed to pushing one of the two) results in the same patterns of directed, low dispersion surface and undirected, high dispersion volume growth but is much harder computationally as it reintroduces overlaps that have been resolved in the previous step.</p><p>We have rewritten the description of the pushing queue in the SI Section 1. The choice of the pushing sequence is somewhat arbitrary but we found that it also has no noticable effect on the growth mode. Maybe putting it in contrast to depth-first approaches helps to illustrate this: We tried two queueing schemes for iterating through overlapping cells, width-first and depth-first. In both cases, we begin by scanning a given cell’s (the root’s) neighborhood for overlaps and shuffle the list of overlapping neighbours. In a width-first approach we then add this list to the queue. Subsequent iterations append their lists of overlapping cells to the queue, such that we always resolve overlaps within the neighborhood of the root first. A depth-first approach follows a sequence of pushes by immediately checking a pushed cell’s neighborhood for new overlaps and adding these to the front of the queue (which works more like a stack then). This can be efficiently implemented by recursion but has no noticeable performance advantage and results in the same patterns of directed, low dispersion surface and undirected, high dispersion volume growth. In our opinion the width-first approach of first resolving overlaps in the immediate neighborhood is more intuitive, which is why we adopted it for our simulation model.</p><disp-quote content-type="editor-comment"><p>(1.4) For the example presented in S5.1, how can the author identify from genomic data that mutation 3 does not replace its ancestral clade mutation 2? In other words, if mutation 2, 3 and 4 are linked meaning clone 4 survives but 2 and 3 dies, how does one know if clone 3 dies before clone 2? I understand that this is a conceptual example, but if one cannot identify this situation from the real data, how can the clade turnover be computed?</p></disp-quote><p>Thank you for this comment, which points to an error of ours in the turnover example of the SI: Clade 3 does in fact replace 2 and contributes to the turnover! (The algorithm correctly annotated clade 3 as orphaned and computes a turnover of 3/15 for this example). We have corrected this.</p><p>In this example, it does not matter for the clade turnover whether clone 3 dies before clone 2. As long as its ancestor (clone 2) becomes extinct it adds to the clade turnover. The term “replaces” applies to the clade of 3 which has a surviving subclone and thereby eventually replaces clade 2. The clade turnover its solely based on the presence of the mutations (which define their clade) and not on the individual clones.</p><disp-quote content-type="editor-comment"><p>(1.5) After reviewing reference 24 (Li et al.), I noticed that the assertions made therein contradict the findings presented in S3 (Mutation Density on Rings). Specifically, Li et al. state that “peripheral regions not only accumulated more mutations, but also contained more changes in genes related to cell proliferation and cell cycle function” (Page 6) and “Phylogenetic trees show that branch lengths vary greatly with the long-branched subclones tending to occur in peripheral regions” (Page 4). However, upon re-analysis of their data, the authors demonstrated a decrease in mutation density near the surface. It is crucial to comprehend the underlying cause of such a disparity.</p></disp-quote><p>The reason for this disparity is the way Li et al. labelled samples as belonging to peripheral or central regions of the tumour. We have added a new figure in the SI to show this: Fig. S14 shows the number of mutations found in samples of Li et al. against their distances from the centre, along with the classification of samples as center/periphery given in Li et al. In the case of tumor T1, the classification of a sample in reference Li et al. does not agree with the distance from the center: samples classified as core are often more distant from the center than those classified as peripheral. Furthermore, Lewinsohn et al. (see below) show in their Fig. 5 that samples classified as ‘center’ by Li all fall into a single clade, and we believe this affects all results derived from this classification. For this reason, we do not consider the classification in reference 24 (Li et al.) further. We now briefly discuss this in Section S3.3.</p><disp-quote content-type="editor-comment"><p>(1.6) The authors consider coinciding mutations to occur when offspring clades align with an ancestral clade. Nevertheless, since multiple mutations can arise simultaneously in a single generation (such as kataegis), it becomes essential to discern its impact on clade turnover and, consequently, the estimation of d/b.</p></disp-quote><p>The mutational signatures found here show no sign of kataegis. Also, the number of polymorphic sites in the whole-exome data is small and the mutations are uniformly spread across the exome. The point is well taken, however, the method requires single mutations per generation. In practice, this can be achieved by subsampling a random part of the genome or exome (see [45]). We tested this point by processing the data from only a fraction of the exome; this did not change the results. In particular, Figure S30 shows the turnover-based inference for different subsampling rates <italic>L</italic> of the Ling et al. data. Subsampling of sites reduces the exome-wide mutation rate, the inferred rate scales linearly with <italic>L</italic>, as expected.</p><disp-quote content-type="editor-comment"><p>(1.7) I could not understand Step 2 in Section S2.1, an illustration may be helpful.</p></disp-quote><p>We have added figure S2 explaining the directional angle algorithm to Section S2.1 in the supplementary information.</p><disp-quote content-type="editor-comment"><p>(1.8) Figure S2, does a large <italic>rhoc</italic> lead to volume growth rather than surface growth, not the other way around?</p></disp-quote><p>Thank you for catching this mix-up!</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2</bold></p><p>I do have a few minor comments/questions, but I am confident the authors will be able to address them appropriately.</p><p>(2.1) Line 56: I am not sure what the units of “average read depth 74X” is in terms of SI units?</p></disp-quote><p>This number gives the number of sequence reads covering a particular nucleotide and is dimensionless. We have added this information.</p><disp-quote content-type="editor-comment"><p>(2.2) Lines 63 - 68: I am unsure what is meant by the terms “T1 of ca.” and “T2 of ca.”. Can these also be explained/defined please?</p></disp-quote><p>These refer to the approximate (circa) diameters of tumor 1 and tumor 2 in the data by Li et al. We have expanded the abbreviations.</p><disp-quote content-type="editor-comment"><p>(2.3) Line 69: I would like to see a more extensive description of the cell-based model here in the main text, such as how do the cells move. Moreover, do cells have a finite reach in space, do they have a volume/area?</p></disp-quote><p>We have expanded the model description in the main body of the paper and placed information there that previously was only in the SI.</p><disp-quote content-type="editor-comment"><p>(2.4) Line 76: You have said cells can “push” one another in your model. Do they also “pull” one another? Cell adhesion is know to contribute to tumour integrity - so this seems important for a model of this nature.</p></disp-quote><p>We have not implemented adhesive forces between pairs of cells so far. This would cause a higher pressure under cell growth (which can have important physiological consequences). However, the hard potential enforcing a distance between adjacent cells would still lead to cells pushing each other apart under population growth, so we expect to see the dispersion effect we discuss even when there is adhesion.</p><disp-quote content-type="editor-comment"><p>(2.5) Line 80-81: “due to lack of nutrient”. Is nutrient included in this work? It is my understanding it is not. No problem if so, it is just that this line makes it seem like it is and important. If it is not, the authors should mention this in the same sentence.</p></disp-quote><p>Thank you for pointing out this source of misunderstanding, your understanding is correct and we have modified the text to remove the ambiguity.</p><disp-quote content-type="editor-comment"><p>(2.6) Line 94-95: Since you are interested in tissue growth, recent work has indicated how the cell boundary (and therefore tissue boundary) description influences growth. Please also be sure to indicate this when you describe the model.</p></disp-quote><p>We presume you refer to the recent paper by Lewinsohn et al. (Nature Ecology and Evolution, 2023), which reports a phylogenetic analysis based on the Li et al. data. Lewinsohn et al. find that cells near the tumour boundary grow significantly faster than those in the tumour’s core. This is at variance with what we find; we were not aware of this paper at the time of submission. We now refer to this paper in the main text, and also have included a new section S3.4 in the SI accounting for this discrepancy. If you refer to a different paper, please let us know.</p><p>Briefly, we repeat the analysis of Lewinsohn et al., using their algorithm on artificial data generated by our model under volume growth. Samples were placed precisely like they were placed in the tumor analyzed by Li et al. We find that, even though the data was generated by volume growth, the algorithm of Lewinsohn et al. finds a signal of surface growth, in many cases even stronger compared to the signal which Lewinsohn et al. find in the empirical data. We have added subsection S3.4 with new figure S15 in the Supplementary Information.</p><disp-quote content-type="editor-comment"><p>(2.7) Line 107: “thus no evidence for enhanced cell growth near the edge of the tumour”. It is unclear to me how this tells us information relative to the tumour edge. It seems to me this is an artifact that at the edge of the tumour, there are less cells to compare with? Could you please expand on this a bit?</p></disp-quote><p>The direction angles tell us if new mutations arise predominantly radially outwards. With this observable, surface growth would lead to a non-uniform distribution of these angles even if we restrict the analysis to samples from the interior of the tumor (which, under surface growth, was once near the surface). So the effect is not linked to fewer cells for comparison. Also, we have checked the direction angles in simulations under different growth modes with the samples placed in the same way as in the data (see Figs. S3 and S4 right panels). We have expanded the text in the main text, section Results accordingly.</p><disp-quote content-type="editor-comment"><p>(2.8) I really enjoyed the clear explanation between lines 119 and 122 regarding cell dispersion!</p></disp-quote><p>Thank you!</p><disp-quote content-type="editor-comment"><p>(2.9) Figure 2B: Since you are looking at a periodic feature in theta, I would have expected the distribution to be periodic too, and therefore equal at theta=-180=180. Can you explain why it is different, please? Interestingly, you simulated data does seem to obey this!</p></disp-quote><p>The distribution of theta is periodic but the binning and midpoints of bins were chosen badly. We have replotted the diagram with bin boundaries that handle the edge-points -180/180 correctly. Thank you for pointing this out.</p><disp-quote content-type="editor-comment"><p>(2.10) Figure 3B: This plot does not have a title. Also, what do the red vertical lines in plots 3B, 3C and 3D indicate?</p></disp-quote><p>We have added the title. The red lines indicate the expectation values of the distributions.</p><disp-quote content-type="editor-comment"><p>(2.11) Figure 4: I am unsure how to read the plot in 4B. Also, what does the y-axis represent in 4C and 4D?</p></disp-quote><p>We have added explanations for 4B and have placed the labels for 4C and 4D in the correct position on the y-axes.</p><disp-quote content-type="editor-comment"><p>(2.12) Lines 194-199: you discuss your inferred parameters here, but you do not indicate how you inferred these parameters. May you please briefly mention how you inferred these, please?</p></disp-quote><p>These were inferred using the turnover method explained in the paragraph above, we have expanded the information. A full account is given in the SI Section S5.</p><disp-quote content-type="editor-comment"><p>(2.13) Line 258-260: “... mutagen (aristolochic acid) found in herbal traditional Chinese medicine and thought to cause liver cancer.” I do not see what this sentence adds to the work. Could you please be clearer with the claim you are making here?</p></disp-quote><p>Mutational signatures allow to infer underlying mutational processes. The strongest signature found in the data is associated with a mutagen that has in the past been used in traditional Chinese medicines. The patients from whom the tumours were biopsied were from China, so past exposure to this potent mutagen is possible. We are not making a big claim here, the mutational signature of aristolochic acid and its cancerogenic nature has been well studied and is referenced here. The result is interesting in our context because in one of the datasets (Li et al.) the signature is present in early (clonal) mutations but absent in later ones, allowing to make inferences from present data on the past. We have added the information that the patients were from China.</p><disp-quote content-type="editor-comment"><p>(2.14) In your Supplementary Information, S1, I believe your summation should not be over i, as you state in the following it is over cells within 7 cell radii. Please fix this by possibly defining a set which are those within 7 cell radii.</p></disp-quote><p>We have done this.</p></body></sub-article></article>