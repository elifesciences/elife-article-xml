<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">64543</article-id><article-id pub-id-type="doi">10.7554/eLife.64543</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>Predicting bacterial promoter function and evolution from random sequences</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-215985"><name><surname>Lagator</surname><given-names>Mato</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7847-3594</contrib-id><email>mato.lagator@manchester.ac.uk</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-215986"><name><surname>Sarikas</surname><given-names>Srdjan</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-48315"><name><surname>Steinrueck</surname><given-names>Magdalena</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1229-9719</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-215988"><name><surname>Toledo-Aparicio</surname><given-names>David</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8381-7590</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-80893"><name><surname>Bollback</surname><given-names>Jonathan P</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4624-4612</contrib-id><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-232760"><name><surname>Guet</surname><given-names>Calin C</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6220-2052</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-234538"><name><surname>Tkačik</surname><given-names>Gašper</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6699-1455</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>School of Biological Sciences, Faculty of Biology, Medicine and Health, University of Manchester</institution><addr-line><named-content content-type="city">Manchester</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff2"><label>2</label><institution>Institute of Science and Technology Austria</institution><addr-line><named-content content-type="city">Klosterneuburg</named-content></addr-line><country>Austria</country></aff><aff id="aff3"><label>3</label><institution>Center for Physiology and Pharmacology, Medical University of Vienna</institution><addr-line><named-content content-type="city">Klosterneuburg</named-content></addr-line><country>Austria</country></aff><aff id="aff4"><label>4</label><institution>Institute of Integrative Biology, Functional and Comparative Genomics, University of Liverpool</institution><addr-line><named-content content-type="city">Liverpool</named-content></addr-line><country>United Kingdom</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Krishna</surname><given-names>Sandeep</given-names></name><role>Reviewing Editor</role><aff><institution>National Centre for Biological Sciences­‐Tata Institute of Fundamental Research</institution><country>India</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><role>Senior Editor</role><aff><institution>École Normale Supérieure</institution><country>France</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn><fn fn-type="con" id="equal-contrib2"><label>‡</label><p>These authors also contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>26</day><month>01</month><year>2022</year></pub-date><pub-date pub-type="collection"><year>2022</year></pub-date><volume>11</volume><elocation-id>e64543</elocation-id><history><date date-type="received" iso-8601-date="2020-11-02"><day>02</day><month>11</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2022-01-09"><day>09</day><month>01</month><year>2022</year></date></history><permissions><copyright-statement>© 2022, Lagator et al</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>Lagator et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-64543-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-64543-figures-v1.pdf"/><abstract><p>Predicting function from sequence is a central problem of biology. Currently, this is possible only locally in a narrow mutational neighborhood around a wildtype sequence rather than globally from any sequence. Using random mutant libraries, we developed a biophysical model that accounts for multiple features of σ<sup>70</sup> binding bacterial promoters to predict constitutive gene expression levels from any sequence. We experimentally and theoretically estimated that 10–20% of random sequences lead to expression and ~80% of non-expressing sequences are one mutation away from a functional promoter. The potential for generating expression from random sequences is so pervasive that selection acts against σ<sup>70</sup>-RNA polymerase binding sites even within inter-genic, promoter-containing regions. This pervasiveness of σ<sup>70</sup>-binding sites implies that emergence of promoters is not the limiting step in gene regulatory evolution. Ultimately, the inclusion of novel features of promoter function into a mechanistic model enabled not only more accurate predictions of gene expression levels, but also identified that promoters evolve more rapidly than previously thought.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>gene regulation</kwd><kwd>RNA polymerase</kwd><kwd>genotype-phenotype map</kwd><kwd>adaptive evolution</kwd><kwd>promoter</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>E. coli</italic></kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution>Royal Society / Wellcome Trust</institution></institution-wrap></funding-source><award-id>216779/Z/19/Z</award-id><principal-award-recipient><name><surname>Lagator</surname><given-names>Mato</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000781</institution-id><institution>European Research Council</institution></institution-wrap></funding-source><award-id>648440</award-id><principal-award-recipient><name><surname>Bollback</surname><given-names>Jonathan P</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution>IPC Grant from IST Austria</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Lagator</surname><given-names>Mato</given-names></name><name><surname>Sarikas</surname><given-names>Srdjan</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>An inferred mechanistic model that connects sequence (genotype) to function (constitutive gene expression phenotype) for any random sequence in <italic>Escherichia coli</italic> reveals the structure of constitutive promoters and how they evolve.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Describing the relationship between sequence (genotype) and function (phenotype) lies at the heart of understanding biology and evolution. Direct experimental characterizations of genotype-phenotype mapping abound (<xref ref-type="bibr" rid="bib25">Lehner, 2013</xref>; <xref ref-type="bibr" rid="bib18">Kemble et al., 2019</xref>), however existing technology limits experimental exploration to only a tiny fraction of all possible sequences (<xref ref-type="bibr" rid="bib37">Sarkisyan et al., 2016</xref>). Due to these technological limitations, there is a need to develop theoretical approaches capable of predicting how any genotype maps onto phenotype (<xref ref-type="bibr" rid="bib46">Yi and Dean, 2019</xref>). Predictive genotype-phenotype maps are rare and incomplete: predicting protein structure from sequence is possible only for a small number of mutations around a well-characterized wildtype (<xref ref-type="bibr" rid="bib23">Kuhlman and Bradley, 2019</xref>), while predicting RNA folding from sequence (<xref ref-type="bibr" rid="bib38">Schuster, 2006</xref>) generally lacks a relevant reference to the function of that secondary structure.</p><p>Gene expression is one of the most fundamental processes of life, and tuning expression levels underpins complex biological function. The critical process in the expression of most bacterial genes is the recruitment of σ<sup>70</sup>-RNA polymerase (RNAP) to a stretch of DNA – the promoter (<xref ref-type="bibr" rid="bib16">Jacob and Monod, 1961</xref>). Computational and theoretical attempts to predict the relationship between genotype (promoter sequence) and its phenotype (gene expression level) have adopted, broadly speaking, three approaches. (i) Bioinformatics – identifies promoters based on sequence homology to the σ<sup>70</sup>-RNAP consensus site (<xref ref-type="bibr" rid="bib29">Mustonen and Lässig, 2005</xref>), which consists of –10 and –35 elements (TATAAT and TTGACA in <italic>Escherichia coli</italic>, respectively) separated by a spacer with canonical length of 17 bp, but does not predict gene expression from them (<xref ref-type="bibr" rid="bib1">Anzolini Cassiano and Silva-Rocha, 2020</xref>). (ii) Machine learning – predicts gene expression patterns in cells (<xref ref-type="bibr" rid="bib2">Beer and Tavazoie, 2004</xref>; <xref ref-type="bibr" rid="bib14">Hossain et al., 2020</xref>), but lacks direct links to the underlying biological mechanisms, limiting insights into promoter structure and evolution (<xref ref-type="bibr" rid="bib26">Libbrecht and Noble, 2015</xref>). (iii) Biophysical models – the most successful of which predict gene expression levels based on the thermodynamic properties of σ<sup>70</sup>-RNAP binding at a promoter in equilibrium (<xref ref-type="bibr" rid="bib4">Bintu et al., 2005</xref>), do not generalize well to random sequences (<xref ref-type="bibr" rid="bib43">Vilar, 2010</xref>). In sum, we lack a generalizable and predictive theoretical and biological understanding of the relationship between promoter genotype and its function (gene expression phenotype) even for constitutive promoters, where σ<sup>70</sup>-RNAP binding (as opposed to the binding of transcription factors) is considered to be the major determinant of gene expression levels (<xref ref-type="bibr" rid="bib10">Forcier et al., 2018</xref>). Without such a canonical model, we cannot properly understand either promoter function or their evolution.</p><p>The standard thermodynamic model (<xref ref-type="bibr" rid="bib4">Bintu et al., 2005</xref>; <xref ref-type="bibr" rid="bib21">Kinney et al., 2010</xref>) considers the energy of binding between σ<sup>70</sup>-RNAP complex and DNA to identify, typically, the single strongest binding site, with the expression level proportional to the equilibrium occupancy of σ<sup>70</sup>-RNAP to that binding site (‘Standard’ model). To calculate equilibrium occupancy, the Standard model assumes that each position in the binding site independently and additively contributes to the binding energy of σ<sup>70</sup>-RNAP. When constructing the Standard model, the energy contribution of each residue (A, C, G, or T) at each position in the binding site is inferred directly from experimental data and represented in the form of an energy matrix. Constructed in this way, the Standard model represents the state-of-the-art mechanistic model of constitutive gene expression, as well as the traditional view of promoters as containing only a single σ<sup>70</sup>-RNAP binding site – a view that is at the heart of all bioinformatics approaches to identifying promoters (<xref ref-type="bibr" rid="bib1">Anzolini Cassiano and Silva-Rocha, 2020</xref>).</p><p>To predict gene expression levels from any random sequence, we developed a mechanistic and generalizable model based on statistical thermodynamics that expands on the Standard model by accounting for several structural features of bacterial promoters. We use this model, as well as several large promoter mutant libraries, to study the promoter function among random sequences as well as the evolutionary dynamics of bacterial promoters.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Extended thermodynamic model</title><p>We developed a comprehensive and generalizable thermodynamic model (‘Extended model’) that expands on the Standard model by accounting for six essential <italic>structural features</italic> of bacterial promoters that are not present in the Standard model (<xref ref-type="fig" rid="fig1">Figure 1A and B</xref>). (i) The possibility that σ<sup>70</sup>-RNAP binds the promoter region in multiple configurations that independently and cumulatively contribute to gene expression (<xref ref-type="bibr" rid="bib40">Storz, 2014</xref>; <xref ref-type="bibr" rid="bib3">Belliveau et al., 2018</xref>), as commonly observed in transcriptomics studies (<xref ref-type="bibr" rid="bib39">Srikumar et al., 2015</xref>). We assume that σ<sup>70</sup>-RNAP concentration is low enough so that the binding of multiple molecules to the promoter has an approximately additive effect on expression. (ii) Spacer length flexibility, assigning an energy penalty for changing the distance between –10 and –35 elements away from the optimum. (iii) Occlusive unproductive binding, occurring when the initiation start site excludes a part of the ribosomal binding site (RBS) resulting in a non-translated transcript. (iv) Occlusive binding on the reverse complement strand, which inhibits productive binding at the promoter (<xref ref-type="bibr" rid="bib5">Brophy and Voigt, 2016</xref>). (v) Dinucleotide interactions between promoter nucleotide residues that are in direct contact with σ<sup>70</sup>-RNAP. (vi) Clearance rate of RNAP from the promoter. We do not account for the UP element (<xref ref-type="bibr" rid="bib33">Ross et al., 1993</xref>), as it has an independent role in determining expression (<xref ref-type="bibr" rid="bib8">Einav and Phillips, 2019</xref>) and was beyond the scope of this study. We experimentally verified features (i), (iii), and (iv), as, unlike feature (ii), they have not been characterized before (<xref ref-type="fig" rid="fig2">Figure 2A–D</xref>). The experimental verification of unproductive binding on the reverse complement was inconclusive – two sets of promoter mutants changed expression in response to increasing strength of binding on the reverse complement, while the other two sets did not (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). However, the inclusion of this feature into the Extended model was justified because it led to a significant increase in predictability (especially of the 36N dataset) (<xref ref-type="fig" rid="fig2">Figure 2D</xref>).</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Standard and Extended models.</title><p>(<bold>A</bold>) The standard thermodynamic model assumes only one (strongest) σ<sup>70</sup>-RNAP binding configuration at the promoter, which generates a productive transcript. We refer to ‘promoter’ as the entire <italic>cis</italic>-regulatory element, while ‘binding site’ refers to the RNA polymerase (RNAP) contact residues of a specific binding configuration (colored area in ‘RNAP binding sites’). The Extended model incorporates structural features of bacterial promoters into the thermodynamic framework: (<bold>i</bold>) cumulative binding, permitting σ<sup>70</sup>-RNAP to bind multiple binding sites independently on the same promoter (binding configurations 1–4); (ii) spacer length flexibility (difference between configurations 1 and 2); (iii) occlusive unproductive binding (configuration 3); (iv) occlusive binding on the reverse complement (RC) (configuration 4). To predict gene expression levels, we calculate the probability of productive σ<sup>70</sup>-RNAP binding (<italic>P</italic><sub>on</sub>), where <italic>μ</italic> is the chemical potential related to RNAP concentration, <italic>E</italic><sub><italic>α</italic></sub> the energy of binding for binding state <italic>α</italic>, <italic>R</italic> the clearance rate relative to σ<sup>70</sup>-RNAP recruitment rate, and <italic>W</italic><sub>block</sub> the binding free energy of unproductive states, which is calculated in the same way as <italic>W</italic><sub>on</sub> but for unproductive as opposed to productive (on) states. The Standard model does not allow for any unproductive binding, and it considers only the single strongest binding site (<italic>α</italic>*). How the structural features are incorporated into the Extended model is shown in orange. (<bold>B</bold>) Example model output for a selected <italic>P</italic><sub>R</sub> mutant (stars mark mutated positions) for the Standard and the Extended model, showing binding configuration on the forward strand. Pixels forming the background grid indicate –10 end-points of binding sites, with the intensity of color corresponding to the strength of binding in that configuration (green productive, red unproductive binding). States that are bound strongly enough to independently lead to measurable expression are framed (one for the Standard model, three for the Extended model – two productive, one unproductive). For illustration purposes, the pixel corresponding to the binding energy of State 1 in panel A is marked with an arrow. (<bold>C</bold>) Main biophysical parameters of the Extended model, fitted from <italic>sort-seq</italic> data. Energy matrix shows the effect of every possible binding site residue on the binding energy between σ<sup>70</sup>-RNAP and DNA (strongest binding indicated by green squares). The optimal energy matrix consists of the –10 and –35 elements (underlined), positions outside the canonical elements that significantly affect quantitative predictions of gene expression levels (dotted underline), and spacer of optimal length 9 bp (corresponding to the canonical 17 bp between –10 and –35 elements). Strongest stabilizing (green) and destabilizing (red) interactions between dinucleotides are shown, with line thickness indicating the deviation from independent energy contribution to binding (range 0.15–0.38<italic>k</italic><sub>B</sub><italic>T</italic>). For other model parameters and all significant dinucleotide interactions, see <xref ref-type="supplementary-material" rid="fig1sdata1">Figure 1—source data 1</xref>. <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> describes the experimental system and protocol; <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref> shows the comparison between our and previously obtained energy matrix for σ<sup>70</sup>-RNAP.</p><p><supplementary-material id="fig1sdata1"><label>Figure 1—source data 1.</label><caption><title>Inferred values for model parameters.</title><p>For each position in the energy matrix, the energy penalty is normalized to the lowest energy (strongest binding) residue in that position, which is set to zero. Same applies for the spacer variation penalty, where the optimal spacer length is set to zero. Orange background marks the canonical –10 and –35 binding sites of σ<sup>70</sup>-RNAP. For pairwise interaction, <bold>‘</bold>identity’ refers to the two positions and specific residues that have a significant positive (destabilizing) or negative (stabilizing) interaction, with numbers indicating the position of the residue in the matrix shown in <xref ref-type="fig" rid="fig1">Figure 1C</xref>. Shaded cells indicate the strongest interactions, which are shown in <xref ref-type="fig" rid="fig1">Figure 1C</xref>. The numbers indicate the position in the energy matrix, starting from the most upstream to the most downstream (left to right in the energy matrix shown in <xref ref-type="fig" rid="fig1">Figure 1C</xref>).</p></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-64543-fig1-data1-v1.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-64543-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Experimental plasmid systems and protocol.</title><p>(<bold>A</bold>) For the <italic>P</italic><sub>R</sub> and <italic>P</italic><sub>L</sub> libraries, the synthetic construct used to detect the effects of promoter mutations consisted of a yellow fluorescent marker (<italic>venus-yfp</italic>), preceded by a ribosomal binding site (RBS), and under the control of either the <italic>P</italic><sub>R</sub> or <italic>P</italic><sub>L</sub> promoter (or a <italic>P</italic><sub>R</sub> or <italic>P</italic><sub>L</sub> promoter mutant). The system was isolated from the rest of the plasmid by a T1 terminator (hairpin). This construct was placed on a small copy number pZS* plasmid (<italic>SC101*</italic> origin) with kanamycin resistance, with <italic>Escherichia coli</italic> MG1655 as host. (<bold>B</bold>) The expression of a green fluorescence protein (<italic>gfp</italic>) was under the control of a random 100 bp sequence consisting of: two 32-bp-long random, non-expressing flanking sequences that were not mutated; and a 36-bp-long sequence that was mutated randomly, with each nucleotide having 25% chance of being found at each position. This construct was placed on a pUA66 plasmid (<italic>SC101</italic> origin), with <italic>E. coli</italic> NEB5α as a host. (<bold>C</bold>) Promoter mutants were cloned into the plasmid system using restriction/modification. The mutations were introduced at random, using pre-synthesized oligonucleotides with a fixed mutation rate (12% for the <italic>P</italic><sub>R</sub>, 9% for the <italic>P</italic><sub>L</sub>, and fully random for the 36N mutant library). The plasmids carrying mutant promoters were cloned either into MG1655 (<italic>P</italic><sub>R</sub> and <italic>P</italic><sub>L</sub> libraries) or NEB5α (36N library). (<bold>D</bold>) Each random mutant library was sorted through fluorescence activated cell sorting (FACS) based on the fluorescence intensity detected at the single cell level. Mutants in <italic>P</italic><sub>R</sub> and <italic>P</italic><sub>L</sub> libraries were sorted into four, while the 36N library was sorted into 12 equidistant bins. 150-bp-long fragments containing the promoter region of each sorted sub-library were PCR-tagged, and each library sequenced in bulk with 5 million total reads per library. (<bold>E</bold>) We screened each sequence library for only those mutants that had at least 30× coverage, and obtained fluorescence distributions of each mutant across the bins. (<bold>F</bold>) Flow cytometry measurements of 1 million mutants from each library showing distributions of fluorescence (as proxy for gene expression levels). The vertical red dotted line separates the mutants with no measurable expression (corresponding to <xref ref-type="fig" rid="fig4">Figure 4A</xref>). The red dotted line and the solid lines separate the four bins used to sort the <italic>P</italic><sub>R</sub> and <italic>P</italic><sub>L</sub> libraries (no, low, intermediate, and high expression, from left to right). The dotted lines mark the boundaries of the additional bins used to sort the 36N library. (<bold>G</bold>) Mutation frequencies in the three experimental libraries are shown as fraction of mutants with a given nucleotide at each position for <italic>P</italic><sub>R</sub>, <italic>P</italic><sub>L</sub>, and 36N libraries. We did not observe any bias in the mutagenesis of libraries. The consensus sequence for each library is provided underneath each plot. (<bold>H</bold>) Number of sequences in each library containing a spacer of specific length. The reported counts are based only on the spacer length of the strongest binding site identified in each sequence. Note that the Extended model accounts for cumulative binding between all possible σ<sup>70</sup>-RNAP configurations binding to a given sequence, meaning that our libraries contained a much greater number of sequences with each spacer length than shown here. In fact, because here we considered only the single strongest binding site, the counts over-represent the optimal spacer length because it has the lowest energy and, hence, binding configurations with that spacer length are more likely to be most strongly bound.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-64543-fig1-figsupp1-v1.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>Comparison of σ<sup>70</sup>-RNAP (RNA polymerase) energy matrix values.</title><p>Correlation between corresponding energy matrix values in the matrix obtained in this study (<xref ref-type="fig" rid="fig1">Figure 1C</xref>) to that obtained by <xref ref-type="bibr" rid="bib21">Kinney et al., 2010</xref>. Points shown in red correspond to the canonical –10 and –35 sites, while the points in black represent other entries in the matrix.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-64543-fig1-figsupp2-v1.tif"/></fig></fig-group><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Experimental validation of structural promoter features.</title><p>(<bold>A</bold>) Cumulative binding affects expression in most tested sequences. We experimentally created 29 promoters with the following property: the Standard model predicts no measurable expression from these promoters, while the Extended model predicts measurable expression due to the existence of multiple σ<sup>70</sup>-RNAP (RNA polymerase) binding sites. Fluorescence measurements are shown in gray bars, with error bars indicating standard error of the mean from three replicate biological measurements. The gray horizontal bar indicates the detectability (‘no measurable expression’) threshold, determined for plate reader measurements as the mean fluorescence/OD<sub>600</sub> value across all replicates of the population carrying the plasmid without any fluorescence markers. All promoters but 10, 13, and 21 exhibited significant measurable expression. We introduced additional mutations into promoters 1–7, in order to remove the secondary binding site(s) without affecting the strongest binding site. White bars show the expression levels of these additional mutants. Only the mutated promoter 5 exhibited significant measurable expression. (<bold>B</bold>) Characterizing sequence determinants of occlusive unproductive binding. (Top left panel) We created 20 promoter sequences for which the Extended model that accounts for occlusive unproductive binding predicted no measurable expression, while the model which did not account for occlusive unproductive binding predicted measurable expression. Bars are mean fluorescence measured from three biological replicates, and error bars are standard error of the mean. The gray shaded area indicates the detectability (‘no measurable expression’) threshold. Only mutants 7 and 20 exhibited significant measurable expression. (Top right panel) We inserted mutations into the wildtype <italic>P</italic><sub>R</sub> promoter to gradually introduce an additional binding site that was predicted to bind in an occlusive unproductive manner. These mutations were not predicted to significantly alter σ<sup>70</sup>-RNAP binding to the existing dominant <italic>P</italic><sub>R</sub> binding site. As mutations are introduced into the promoter, they generate stronger binding to the new site, which lowers gene expression levels. (Bottom left panel) We mutated three promoters (originally found in the <italic>P</italic><sub>R</sub> mutant library) to gradually remove their existing, predicted occlusive unproductive binding sites. As the predicted occlusive unproductive sites were removed, we measured a significant increase in gene expression levels. (Bottom right panel) In order to experimentally verify the occlusive unproductive binding cutoff distance from the –10 end of the binding site to the beginning of the ribosomal binding site (RBS), we started with the same three promoters as in bottom left panel. We used the Extended model to identify the predicted occlusive unproductive binding site, and then we moved the site upstream and downstream to increase or decrease the distance from the RBS, respectively. We identified that a binding site that is 11 or fewer base pairs away from the RBS acts as an unproductive site, while those that are 12 or more base pairs away productively and cumulatively contributed to gene expression levels. (<bold>C)</bold> Mixed support for the role of unproductive binding on the reverse complement in driving expression. We identified four promoter sequences for which we introduced up to eight mutations that would not alter predicted gene expression levels if the model did not account for unproductive binding on the reverse complement, but would if the Extended model was used. In other words, the eight introduced mutations would gradually increase the strength of binding on the reverse complement while having a minimal effect on the strength of binding on the productive strand. Colored points indicate mutants whose measured expression changes in line with Extended model predictions, while black points are mutants whose expression doesn’t change compared to the original promoter. Individual responses of each mutant are shown in <xref ref-type="fig" rid="fig2">Figure 2</xref> – Extended <xref ref-type="fig" rid="fig1">Figure 1</xref>. (<bold>D</bold>) Improvement to predictability based on each promoter feature. Each structural promoter feature was added to the simpler iteration of the model, starting from the Standard model and building progressively toward the Extended. The clearance rate and dinucleotide interactions were included only in the model fitted on all three libraries. The ‘unproductive binding’ term includes the combined contribution of the occlusive unproductive binding and the unproductive binding on the reverse complement, both of which individually provided a small but significant improvement to model predictions. The values are the fraction of variance explained on the evaluation dataset. <xref ref-type="fig" rid="fig2">Figure 2</xref> – Extended <xref ref-type="fig" rid="fig2">Figure 2</xref> contains additional verifications of model predictions.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-64543-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Unproductive binding on the reverse complement.</title><p>We identified four promoter sequences for which we could introduce up to eight mutations that would not alter predicted gene expression levels if the model did not account for unproductive binding on the reverse complement, but would if the Extended model was used (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). Introduction of these mutations reduced the measured gene expression levels for two promoters (1 and 3) but had no effect on the expression levels from promoters 2 and 4.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-64543-fig2-figsupp1-v1.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Validation of model predictions.</title><p>(<bold>A</bold>) Verifying model predictions on 115-bp-long sequences. In order to verify the ability of the Extended model to predict expression levels from 115-bp-long promoters, and in particular to verify the model prediction of the ease of generating promoters from random non-expressing sequences, we generated 20 pairs of promoters. These pairs consisted of a randomly generated non-expressing sequence, and a sequence exactly one point mutation away that was predicted to have measurable expression. White bars are mean expression levels of three biological replicate measurements of non-expressing promoters; gray bars are the promoters with a single point mutation. Error bars are standard error of the mean. The gray horizontal bar indicates the detectability (‘no measurable expression’) threshold. (<bold>B</bold>) Model determination of occlusive unproductive binding sites. We evaluated the Extended model fitted on the <italic>P</italic><sub>R</sub> training dataset, with varying thresholds between productive and occlusive unproductive bindings. Shown is the change in the negative log likelihood on the dataset indicated in the legend. Red arrow indicates the actual threshold ultimately used in the model. Because this modeling only provided a range for the productive/unproductive cutoff distance between the RNA polymerase (RNAP) binding site and the ribosomal binding site (RBS), we carried out dedicated experiments to systematically validate and probe occlusive unproductive binding (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). (<bold>C</bold>) Optimal value of the clearance rate. We scanned through the possible values of the relative clearance rate of the σ<sup>70</sup>-RNAP complex from the promoter, using the Extended model fitted on the training subsets of all mutant libraries. For each value, we refit chemical potential and hyperparameters of logistic regression using the training dataset. Shown is the change in negative log likelihood on the training data. The optimal value is indicated with the red arrow, though a wider range of values is compatible with the data. For the majority of values in the compatible range including the optimal value, the model performance improves also on the validation dataset.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-64543-fig2-figsupp2-v1.tif"/></fig></fig-group></sec><sec id="s2-2"><title>Experimental mutant libraries and the model</title><p>Both, the Standard and the Extended model, were fitted by subsampling a library of &gt;12,000 constitutively expressed random mutants of one of the strongest and best characterized promoters, bacteriophage Lambda <italic>P</italic><sub>R</sub>, that controlled the expression of a <italic>yfp</italic> reporter gene from a small copy number plasmid in <italic>E. coli</italic> (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1A</xref>). In this library, each position in the promoter had a 4% chance of containing each of the non-wildtype bases, resulting in a 12% mutation rate per position. <italic>Sort-seq</italic> experiments were used to measure gene expression levels of mutants (<xref ref-type="bibr" rid="bib22">Kinney and McCandlish, 2019</xref>): mutants were separated using a cell sorter into four phenotypic bins (‘no’, ‘low’, ‘medium’, and ‘high’ expression), PCR-tagged according to the sorted bin, and bulk sequenced to obtain the counts of each mutant sequence in the sorted bins (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1C-E</xref>). The library was randomly split into three subsets: ‘training’ (60% of the sequences), used for training model parameters; ‘validation’ (20%) used for model selection whenever necessary; and ‘evaluation’ (20%) used exclusively for final evaluation and visualization of model performance.</p><p>We inferred model parameters independently for the Standard and the Extended models. For the Standard model, all parameters were inferred under an assumption that only a single (strongest) binding site contributes to expression and that the binding to that site can only contribute positively to expression (i.e. binding of RNAP is never occlusive or unproductive). Note that the Standard model allowed for different spacer lengths but assumed that the energy of binding was not affected by such variations. This already gives our Standard model much more fitting power relative to typical approaches that use a single RNAP energy matrix with a fixed spacer, thereby raising the bar for the Extended model. To infer the parameters for the Extended model, we calculated the binding strengths of σ<sup>70</sup>-RNAP to DNA in all possible configurations allowed by the structural features incorporated into the Extended model. This meant, accounting for the energy impact of spacer length variations, the possibility of a promoter containing multiple σ<sup>70</sup>-RNAP binding sites, and that the binding to a given site can contribute both positively and negatively to expression. Then, we integrated over all positive (‘on’) and negative (‘off’) configurations to obtain the probability (<italic>P</italic><sub>on</sub>) of productive σ<sup>70</sup>-RNAP binding, which, in this model, solely determines expression levels. For both models, we searched for optimal model parameters (<xref ref-type="fig" rid="fig1">Figure 1C</xref>) by maximizing the likelihood of the weighted multinomial logistic regression of log<sub>10</sub><italic>P</italic><sub>on</sub> to the median observed expression bin for a training subset (60%) of the <italic>P</italic><sub>R</sub> mutant library. The energy matrix values obtained by fitting the Extended model correlated strongly with those from a previously published energy matrix of σ<sup>70</sup>-RNAP, but also exhibited some systematic differences (<italic>r</italic><sup>2</sup> = 0.72; p &lt; 0.001) (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>; <xref ref-type="bibr" rid="bib21">Kinney et al., 2010</xref>).</p><p>Both models, which were fitted on the training subset of the <italic>P</italic><sub>R</sub> dataset only, reproduced the evaluation subset of the <italic>P</italic><sub>R</sub> mutant library with high accuracy, with the Extended model significantly improving on the performance of the Standard model (<xref ref-type="fig" rid="fig3">Figure 3A and B</xref>). A closer look at the inferred model parameters (<xref ref-type="supplementary-material" rid="fig1sdata1">Figure 1—source data 1</xref>) provided novel insights into the mechanisms of RNAP binding, including: (i) the energetic cost of altering the length of the spacer between the –10 and –35 DNA binding elements, which appears to be approximately quadratic for each deviation away from the optimal 17 bp (spacer penalties in <xref ref-type="fig" rid="fig1">Figure 1C</xref>); (ii) more precise definition of the binding footprint of RNAP compared to previous RNAP energy matrices (<xref ref-type="bibr" rid="bib21">Kinney et al., 2010</xref>), in particular identifying 11 positions outside the canonical –10 and –35 elements that directly and independently affect σ<sup>70</sup>-RNAP (energy matrix in <xref ref-type="fig" rid="fig1">Figure 1C</xref>); (iii) the role of occlusive unproductive binding of RNAP to the promoter, which reduces overall expression, and whose inclusion into the model significantly improves predictability (<xref ref-type="fig" rid="fig2">Figure 2D</xref>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Model performance.</title><p>(<bold>A</bold>) Model-to-data correlation for the Standard (blue) and the Extended model (orange) trained on <italic>P</italic><sub>R</sub> only, shown for the evaluation subset (20%) of the <italic>P</italic><sub>R</sub> mutant library. The experimentally measured fluorescence of each mutant is the mean bin (out of four) across all sequenced reads of that mutant (we only consider mutants with at least 30× coverage). Best-fit line (dashed for the Standard model, solid black for Extended) and the instrument detectability threshold, which we refer to as the ‘measurable expression’ and which marks the 99th percentile of plasmid-free strain (red dashed line), are shown. Marker sizes indicate data-point weights used in fits. We assume that the model predictions are independent of the instrumentally determined measurable expression threshold. (<bold>B</bold>) Model performance on mutant libraries (<italic>P</italic><sub>R</sub>, <italic>P</italic><sub>L</sub>, 36N), shown as fraction of variance explained on evaluation data. Arrows indicate which bars correspond to the correlation plot shown in (<bold>A</bold>). (<bold>C</bold>) Cartoon of the three mutant libraries: <italic>P</italic><sub>R</sub> and <italic>P</italic><sub>L</sub> sample locally around a wildtype, with each position having a 12% or 9% chance, respectively, of containing the non-wildtype residue; 36N library contains random 36-bp-long sequences, meaning that it uniformly samples the full 36-bp-long genotypic space (see <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2G</xref>). Colored circle and triangle represent the wildtype <italic>P</italic><sub>R</sub> and <italic>P</italic><sub>L</sub> sequences, respectively. <xref ref-type="supplementary-material" rid="fig3sdata1">Figure 3—source data 1</xref>, <xref ref-type="supplementary-material" rid="fig3sdata2">Figure 3—source data 2</xref> provide additional details on the processing of mutant libraries, as does the <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>. <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> shows the performance of the two models on previously published datasets of promoter mutants. <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref> shows the plate reader validation of 36N library data processing.</p><p><supplementary-material id="fig3sdata1"><label>Figure 3—source data 1.</label><caption><title>Processing of the mutant libraries and sizes of datasets after splits.</title><p>The table shows the number of reads remaining in the datasets following each step of data processing, from original sequenced library down to the final library used for model fitting and evaluation.</p></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-64543-fig3-data1-v1.zip"/></supplementary-material></p><p><supplementary-material id="fig3sdata2"><label>Figure 3—source data 2.</label><caption><title>Number of mutants per expression bin for each split of the <italic>P</italic><sub>R</sub>, <italic>P</italic><sub>L</sub>, and 36N dataset.</title><p>Bins are no (‘0’), low (‘1’), intermediate (‘2’), and high (‘3’) for the <italic>P</italic><sub>R</sub> and <italic>P</italic><sub>L</sub> libraries, and are ordered from lowest (‘0’) to highest (‘11’) for the 36N library.</p></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-64543-fig3-data2-v1.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-64543-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Performance of Standard and Extended model on previously published datasets.</title><p>Expression level predictions from the Standard and the Extended model were correlated to measured expression levels, in the promoter mutant libraries published by (<bold>A</bold>) <xref ref-type="bibr" rid="bib17">Johns et al., 2018</xref>; (<bold>B</bold>) <xref ref-type="bibr" rid="bib14">Hossain et al., 2020</xref>; (<bold>C</bold>) <xref ref-type="bibr" rid="bib42">Urtecho et al., 2019</xref>. Red line shows the line of best fit, resulting in the reported correlation coefficient, <italic>r</italic><sup>2</sup>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-64543-fig3-figsupp1-v1.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Processing of mutant libraries.</title><p>(<bold>A–E</bold>) Processing of <italic>P</italic><sub>R</sub> and <italic>P</italic><sub>L</sub> libraries. (<bold>A</bold>) All reads in the <italic>P</italic><sub>R</sub> and <italic>P</italic><sub>L</sub> libraries (gray), from which we take only those reads that are ±4 bp away in length from the wildtype sequence (dark gray). (<bold>B</bold>) Inverse cumulative distribution function (normalized to the total number of sequences), with shaded indicating the sequences we removed due to having less than 10× coverage. (<bold>C</bold>) We removed sequences that had 20 or more single point mutations compared to their respective wildtype sequence. Note that this mainly affected the <italic>P</italic><sub>L</sub> library (orange), as the original plasmid from which the libraries were cloned contained the wildtype <italic>P</italic><sub>R</sub> sequence. (<bold>D</bold>) Cumulative distribution function (CDF) of standard deviation of expression bin numbers, with shaded sequences the ones we removed from subsequent analyses. (<bold>E</bold>) Box plots indicating the distributions of mean values (in bin units) for a given mode (in bin units), before (left) and after (right) selecting for only those where mean, mode, and median are within 0.5. (<bold>F–J</bold>) Processing of the 36N library. (<bold>F</bold>) Average histogram of alignment similarity for the 1000 most covered sequences (shaded area indicates 95% confidence interval). We used the similarity threshold of 0.7 between low- and high-scoring modes to select for unique sequences and eliminate sequencing errors. (<bold>G</bold>) Histogram of coverage (black line), with highlighted contributions of the noise cloud around the reference sequence (dark red), and the clouds around the 10, 100, and 1,000 most abundant sequences (from darkest to lightest shade of red, respectively). (<bold>H</bold>) Histogram of counts for the reference sequence per bin, used to debias all other distributions. (<bold>I</bold>) Template probability distribution functions (PDFs) obtained as averages of PDFs that have the same mode (indicated by color). The inferred fluorescence activated cell sorting (FACS) noise background is shown as a thick gray line. Given a distribution, we only accepted values in the bins in which the appropriate reference was three times above the inferred background. Such filter is shown in (<bold>J</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-64543-fig3-figsupp2-v1.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 3.</label><caption><title>Plate reader validation of 36N data processing.</title><p>Seventy-seven mutants (with an approximately equal number of mutants selected from each of the 12 bins) were selected randomly and their expression levels measured in a plate reader. We correlated their expression measured in the plate reader with our estimates in fluorescence activated cell sorting (FACS) units (left) and bin units (right). The vertical red dotted line marks the measurable expression threshold in the flow cytometer. Measured expression in FACS units and expression estimate are shown in log scale.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-64543-fig3-figsupp3-v1.tif"/></fig></fig-group></sec><sec id="s2-3"><title>Predicting expression from random sequences</title><p>To assess the cross-dataset predictability of the two models, we created two additional mutant libraries (<xref ref-type="fig" rid="fig3">Figure 3C</xref>) with &gt;10,000 mutants each and analyzed them in <italic>sort-seq</italic> experiments. First, we created a library consisting of random mutants of the Lambda <italic>P</italic><sub>L</sub> promoter, which shares sequence homology to <italic>P</italic><sub>R</sub>. Second, in order to determine model performance across the entire unconstrained genotypic landscape, we built a library consisting of completely random 36 nucleotides controlling the expression of a <italic>gfp</italic> reporter gene (‘36N’). In other words, each of the 36 positions had a 25% chance of being either adenine, cytosine, guanine, or thymine. This library was created in a different strain (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1B</xref>), and the expression was sorted into 12 bins instead of 4, giving greater precision in testing the model-to-data fit. Interestingly, ~10% of experimentally measured, random 36-bp-long sequences led to measurable expression (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1F</xref>).</p><p>While the Extended model trained on the <italic>P</italic><sub>R</sub> library only modestly improved predictability of the <italic>P</italic><sub>R</sub> and local cross-predictability (<italic>P</italic><sub>L</sub>) datasets compared to the Standard model, it dramatically improved predictions of gene expression levels from random sequences (<xref ref-type="fig" rid="fig3">Figure 3A and B</xref>). This improved performance of the Extended model compared to the traditional view of promoters (the Standard model) indicates that the structural features we accounted for are key components of promoter function. In fact, their inclusion helps overcome one of the major shortcomings of thermodynamic models of gene expression – their low predictability on novel datasets (<xref ref-type="bibr" rid="bib43">Vilar, 2010</xref>), which is observed in Standard model’s low predictability of the 36N library.</p><p>Each of the structural features included in the Extended model (<xref ref-type="fig" rid="fig1">Figure 1A</xref>) significantly improved predictability (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). The contribution of each structural feature to predictability differed between mutant libraries, but, in general, accounting for the energy cost of variable spacer length improved expression level predictions the most. Fitting the Extended model by subsampling all three libraries (&gt;30,000 mutants), instead of just the <italic>P</italic><sub>R</sub> library, led to further improvements in predictability of expression from random sequences (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). This resulted in <italic>r</italic><sup>2</sup> ~0.8, which corresponds to a mean error in expression predictions of 2.8-fold, across a 1000-fold expression range. Fitting the model on all libraries also allowed for a more reliable estimation of dinucleotide interactions between promoter positions that contact σ<sup>70</sup>-RNAP (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). Dinucleotide interactions are moderate contributors to promoter function (<xref ref-type="bibr" rid="bib32">Otwinowski and Nemenman, 2013</xref>; <xref ref-type="fig" rid="fig2">Figure 2D</xref>), and appear to be stronger when at least one residue is outside of the canonical –10 and –35 binding sites.</p><p>The Standard model explicitly assumes that only a single binding position of RNAP governs promoter activity, which we model by identifying the single strongest binding site present in each random sequence in the 36N library (in contrast to the Extended model, which considers all possible σ<sup>70</sup>-RNAP binding configurations cumulatively). Because of this assumption of the Standard model, its low cross-predictability (i.e. its performance on fully random sequences – <xref ref-type="fig" rid="fig3">Figure 3B</xref>) is often attributed to context dependence: the poorly understood effect of positions flanking the –10 and –35 elements (<xref ref-type="bibr" rid="bib43">Vilar, 2010</xref>; <xref ref-type="bibr" rid="bib10">Forcier et al., 2018</xref>). In this study, the ability of RNAP to bind in multiple configurations to the same promoter, rather than a single one, led to the improved predictability of the Extended compared to the Standard model (<xref ref-type="fig" rid="fig3">Figure 3</xref>). As such, the Extended model explains away the extensive context dependence as a consequence of the promoter structural features that we account for (<xref ref-type="fig" rid="fig1">Figure 1A</xref>).</p></sec><sec id="s2-4"><title>Testing model generalizability</title><p>In order to test how well the Extended model predicts gene expression levels from any sequence, we utilized three published, large-scale, promoter mutant libraries whose expression was measured in <italic>E. coli</italic> (<xref ref-type="bibr" rid="bib17">Johns et al., 2018</xref>; <xref ref-type="bibr" rid="bib42">Urtecho et al., 2019</xref>; <xref ref-type="bibr" rid="bib14">Hossain et al., 2020</xref>). Each study also developed a model to predict the variation in gene expression levels observed in their respective datasets, enabling a comparison of performance to our model. As they were generated for different purposes, these libraries contain promoter variants with different features, including but not limited to the features we included in the Extended model (<xref ref-type="fig" rid="fig1">Figure 1</xref>). We used the Standard and the Extended models with chemical potential as the only physical parameter refitted, meaning that all other model parameters were fitted only from the libraries developed in our study.</p><p><xref ref-type="bibr" rid="bib17">Johns et al., 2018</xref> library consists of ~15,000 promoter sequences harnessed from a wide range of bacterial species and expressed in <italic>E. coli</italic> and contains the most random-like distribution of mutations. As expected, the Extended model (<italic>r</italic><sup>2</sup> = 0.626) outperformed both the Standard model (<italic>r</italic><sup>2</sup> = 0.535) and the model presented in the paper (<italic>r</italic><sup>2</sup> = 0.47) (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1A</xref>). <xref ref-type="bibr" rid="bib14">Hossain et al., 2020</xref> library contained 4350 sequences with the consensus –10 and –35 elements, as well as a fixed spacer length, with all sequence variability contained within the upstream, downstream, and spacer regions. Both the Extended (<italic>r</italic><sup>2</sup> = 0.602) and the Standard (<italic>r</italic><sup>2</sup> = 0.598) models had high performance on the dataset compared to the model presented in the paper (<italic>r</italic><sup>2</sup> = 0.45), indicating that while the conserved consensus –10 and –35 elements drove a bulk of the observed expression variation, we nevertheless extracted significant predictability gains due to the extended RNAP binding footprint (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1B</xref>). <xref ref-type="bibr" rid="bib42">Urtecho et al., 2019</xref>, developed ~11,000 promoters consisting of all combinations of a set of modules: eight –35 elements, eight –10 elements, three UP elements, eight spacers, and eight backgrounds. The Extended (<italic>r</italic><sup>2</sup> = 0.599) slightly outperformed the Standard model (<italic>r</italic><sup>2</sup> = 0.588), suggesting that the eight background sequences contained different secondary σ<sup>70</sup>-RNAP binding sites that cumulatively contributed to expression (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1C</xref>). However, both models underperformed the machine learning approach presented in the paper (<italic>r</italic><sup>2</sup> = 0.955) as the expression variation from these modular promoters was driven by interactions between components (<xref ref-type="bibr" rid="bib42">Urtecho et al., 2019</xref>), which were not captured by the Extended model. It is important to emphasize, however, that the machine learning model developed by Urtecho et al. considers only combinations of a small number of predefined sequence elements, and as such cannot predict expression level from arbitrary sequences.</p><p>Together, these analyses point to two important aspects of promoter function. First, the high performance of the Extended model on most tested datasets without refitting (comparable to the performance on the 36N library of the Extended model trained only on the <italic>P</italic><sub>R</sub> library), combined with its high predictability of expression from random sequences (the 36N library), suggests that the binding energies and the structural promoter features described in this study (<xref ref-type="fig" rid="fig1">Figure 1</xref>) are important quantitative determinants of promoter function. Second, while these features are sufficient to predict expression levels from many sequences, especially if sequences are random, the Extended model failed to capture the variation arising from the interactions between various promoter features (<xref ref-type="bibr" rid="bib42">Urtecho et al., 2019</xref>). The mechanisms that govern the way in which different promoter features – beyond those captured by the Extended model – interact with each other remain largely unclear – but see <xref ref-type="bibr" rid="bib8">Einav and Phillips, 2019</xref>.</p></sec><sec id="s2-5"><title>Constitutive promoters evolve readily from random sequences</title><p>Having a biophysical model capable of predicting gene expression levels from random sequences enabled us to computationally sample the entire genotypic space in order to describe the genotype-phenotype mapping of constitutive promoters. Approximately 20% of random 115-bp-long sequences (average inter-genic region length in <italic>E. coli</italic>) are predicted to have measurable expression, compared to ~8% for the Standard model (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). Surprisingly, for ~82% of non-expressing random sequences, at least one point mutation could be found that would led to measurable expression (<xref ref-type="fig" rid="fig4">Figure 4B</xref>) – a finding that we verified experimentally (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2A</xref>). In total, more than 1.5% of all possible point mutations converted a random non-expressing sequence into a functional promoter (<xref ref-type="fig" rid="fig4">Figure 4C</xref>), indicating that promoter sequences readily emerge, as previously suggested based on a limited sample of ~40 sequences (<xref ref-type="bibr" rid="bib47">Yona et al., 2018</xref>).</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Evolution of promoters.</title><p>(<bold>A</bold>) Probability density function (PDF) for the flow cytometry measurement of the 36N library (gray dashed line) compared to the flow cytometry fluorescence intensities simulated from 10<sup>6</sup> randomly generated 115-bp-long sequences using the Extended model fitted on all three libraries. Red dotted line marks the cutoff for ‘measurable expression’, estimated from experimental data. Measurable expression is defined to correspond to the 99th percentile of fluorescence measurements of the experimental strain carrying no plasmid and, hence, no fluorescence. Inset: cumulative distribution function (CDF) for the same comparison. (<bold>B</bold>) Density heat map (brighter color represents higher density), showing, for every simulated random sequence (expression on x-axis), the expression of a single point mutant with the largest positive effect on predicted expression (<italic>P</italic><sub>on</sub>) (y-axis). For 82% of non-expressing random sequences (sequences left from the dotted line on the x-axis), that mutation led to measurable expression (gray area). (<bold>C</bold>) Box plot showing the percentage of all possible point mutations predicted to convert a given random non-expressing sequence into one with measurable expression (obtained from 10<sup>5</sup> random sequences). (<bold>D</bold>) Increase in rates of adaptive evolution of the Extended relative to the Standard model. Evolution to either weakest measurable expression, or high (<italic>P</italic><sub>R</sub>) expression levels was modeled through single point mutations. Evolution was simulated 100 independent times for each of the 100 random 115-bp-long starting sequences, by mutating the central contiguous part of the indicated length. Evolving promoters would almost never reach high expression levels when only a region smaller than the RNA polymerase (RNAP) binding site (30 bp) was allowed to mutate. (<bold>E</bold>) For evidence of selection against σ<sup>70</sup>-RNAP binding sites, we compared the free energy per bp between either the inter-genic (typically, promoter containing) or the within-genic regions of the <italic>Escherichia coli</italic> genome, and that of a random sequence with the GC% of the corresponding region (note that higher energy means weaker binding and hence lower expression). At lower binding energies (corresponding to stronger binding), the actual number of binding sites in the <italic>E. coli</italic> genome (teal) is lower than expected based on random sequences (gray). Associated p-values are also shown. The total number of binding sites increases with binding energy (i.e. there are a lot more weaker than stronger binding sites), explaining the variability in p-values. (<bold>F</bold>) CDFs for predicted binding strengths of different <italic>E. coli</italic> promoters, obtained from RegulonDB. <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> shows further details on how promoter evolution was modeled. <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref> contains the information about the contribution of cumulative binding to expression. <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref> shows additional tests for selection against σ<sup>70</sup>-RNAP binding sites.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-64543-fig4-v1.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Modeling evolution.</title><p>(<bold>A</bold>) Cumulative distribution function (CDF) of the median times for promoter evolution under the Extended (orange) and Standard (blue) models for <italic>s</italic> = 1, <italic>N</italic> = 10<sup>4</sup>, length of central mutagenized region of 70 bp and high target expression level (that of wildtype <italic>P</italic><sub>R</sub>). Evolution was simulated 100 independent times for each of the 100 starting random sequences. We present this specific set of parameters as this is the case where the largest fraction of simulations stopped at 10 N iterations (our simulation limit), before reaching the target expression. For all parameter combinations, including the one shown here, more Standard model simulations terminate at 10 N iterations compared to Extended model simulations. Taking a ratio of the mean time under this CDF for the Extended model over that for the Standard model therefore represents a conservative lower bound for the speedup in promoter evolution. (<bold>B</bold>) Selection at two different population sizes (top panel: <italic>N</italic> = 10<sup>3</sup>; bottom panel: <italic>N</italic> = 10<sup>4</sup>) using the Strong-Selection-Weak-Mutation model at two selection strengths (<bold>s</bold>) and selecting to either <italic>P</italic><sub>R</sub>-levels of expression or any measurable expression. Selection was simulated through 100 independent runs for each of the 100 random starting sequences, with different lengths of the sequence allowed to mutate. Errors bars are standard errors of the mean across all replicates and starting sequences. Indicated selection refers to the selection on the phenotype difference (Δlog<sub>10</sub><italic>P</italic><sub>on</sub>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-64543-fig4-figsupp1-v1.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>Cumulative binding contributes more to expression at weak promoters.</title><p>For 100,000 random 100-bp-long sequences, we calculated the fold increase in predicted gene expression levels of the Extended model compared to the model that is constrained to only the single strongest σ<sup>70</sup>-RNAP binding site. Predicted expression levels from stronger promoters (higher log<sub>10</sub><italic>P</italic><sub>on</sub>) were determined primarily by binding to the strongest σ<sup>70</sup>-RNAP binding site. In contrast, predicted gene expression levels at weak promoters were more likely to be determined by σ<sup>70</sup>-RNAP binding at multiple sites. The orange line is the trend line obtained through non-linear regression.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-64543-fig4-figsupp2-v1.tif"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 3.</label><caption><title>Further tests of selection against σ<sup>70</sup>-RNAP (RNA polymerase) binding sites.</title><p>(<bold>A</bold>) To provide an alternative measure to that presented in <xref ref-type="fig" rid="fig4">Figure 4E</xref>, instead of creating a random sequence and comparing the number of predicted σ<sup>70</sup>-RNAP binding sites in it and in the <italic>Escherichia coli</italic> genome, here we created 100 shuffled σ<sup>70</sup>-RNAP energy matrices and used each of them to predict the expression from every single position in the <italic>E. coli</italic> genome. For each shuffle, we constructed cumulative histograms of free energy for inter-genic and within-genes regions. For each bin, we then calculated the p-value of the Extended model that used the actual σ<sup>70</sup>-RNAP energy matrix, assuming a normal distribution with mean and standard deviation given by the set of models with shuffled matrices. This is a conservative estimate, as for energies Δ<italic>E</italic> &lt; 1, the assumption of Gaussian distribution leads to overestimates of standard deviation. The matrices were shuffled per position, that is, an energy matrix of dimension 4× <italic>L</italic>, with <italic>L</italic> being the length of the binding site, is shuffled by randomly reordering the <italic>L</italic> columns while leaving the energy entries in each column unchanged in order and magnitude. Gray lines represent 95% confidence intervals. (<bold>B</bold>) For evidence of selection against σ<sup>70</sup>-RNAP binding sites only in the inter-genic regions that contain experimentally confirmed promoters (based on RegulonDB), we compared model-predicted binding energy across the region to the expected binding for a 10<sup>8</sup> bp random sequence with the GC% of the corresponding region. Also shown is the selection against binding sites within genes (same as in <xref ref-type="fig" rid="fig4">Figure 4E</xref>). Gray shaded areas are 95% confidence intervals.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-64543-fig4-figsupp3-v1.tif"/></fig></fig-group><p>To contextualize these findings, we simulated evolution under directional selection for expression from random non-expressing sequences using a Strong-Selection-Weak-Mutation model (<xref ref-type="bibr" rid="bib12">Gillespie, 1983</xref>) adapted from <xref ref-type="bibr" rid="bib41">Tuğrul et al., 2015</xref>. In short, this model considers one mutation at a time: as one mutation arises randomly in the sequence, the model determines the probability of that mutation getting fixed in the population or eliminated due to selection and drift, and only then is the fate of the next random mutation considered. This evolutionary scenario probes the upper speed limit for the emergence of new functional promoters. The Extended model predicts, on average, more rapid evolution from a non-expressing sequence (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1A</xref>), toward either weakest measurable expression or strong (wildtype <italic>P</italic><sub>R</sub> level) expression, when compared to the Standard model (<xref ref-type="fig" rid="fig4">Figure 4D</xref>, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1B</xref>). The difference in rates of evolution becomes even more pronounced as the mutating sequence gets shorter (simulating stronger constraints due to, for example, existence of other transcription factor binding sites) (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). The increased rate of promoter evolution predicted by the Extended, as compared to the Standard model, means that promoters can evolve even more rapidly than expected based on the standard RNAP consensus sequence or the corresponding energy matrix. Under certain conditions, the rate of increase is several orders of magnitude. This increase arises from the inclusion of the new structural promoter features (<xref ref-type="fig" rid="fig1">Figure 1A</xref>), which dramatically enlarges the number of possible productive binding configurations – a phenomenon particularly evident at lower expression levels, where cumulative binding across multiple binding sites substantially contributes to overall expression (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>).</p></sec><sec id="s2-6"><title>Selection against RNAP binding sites in <italic>E. coli</italic> promoters</title><p>The pervasiveness of σ<sup>70</sup>-RNAP binding sites among random DNA sequences has surprising implications for understanding the evolution of gene regulation: the critical question is no longer how do promoters arise, but rather how does a cell avoid expressing everything, all the time. To address this, we asked if there was evidence of selection against σ<sup>70</sup>-RNAP binding sites in the <italic>E. coli</italic> genome (<xref ref-type="fig" rid="fig4">Figure 4E</xref>, <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3A</xref>; <xref ref-type="bibr" rid="bib30">Mustonen et al., 2008</xref>). While identifying strong selection against σ<sup>70</sup>-RNAP binding sites within genes (<xref ref-type="bibr" rid="bib47">Yona et al., 2018</xref>), surprisingly, we also found evidence of selection against binding sites in inter-genic regions (p &lt; 10<sup>–40</sup> across all inter-genic regions). This negative selection was observed even when only the known, experimentally determined σ<sup>70</sup> promoters (obtained from RegulonDB; <xref ref-type="bibr" rid="bib36">Salgado et al., 2013</xref>) were considered (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3B</xref>), most of which strongly bind σ<sup>70</sup>-RNAP and hence lead to intermediate and high expression levels (<xref ref-type="fig" rid="fig4">Figure 4F</xref>). Thus, there is selection against σ<sup>70</sup>-RNAP binding sites not only within genes, but also in the inter-genic regions that contain active promoters. This selection against too many binding sites in promoters could have arisen from a direct competition between σ<sup>70</sup>-RNAP and other transcription factors, and/or in response to the potential, and poorly understood, cost for a promoter to contain multiple weaker (as opposed to fewer stronger) σ<sup>70</sup>-RNAP binding sites.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>While DNA sequence ultimately encodes all the genetic elements for the function of living systems, decoding this function directly from sequence remains a grand challenge. Despite limited success, for example, in connecting the effects of mutations on protein or secondary RNA structures (<xref ref-type="bibr" rid="bib38">Schuster, 2006</xref>; <xref ref-type="bibr" rid="bib7">Dill and MacCallum, 2012</xref>), we lack a quantitative link between most cellular processes and DNA sequence.</p><p>One of the most fundamental cellular processes is the regulation of gene expression, which is governed by the binding of <italic>σ</italic> factors, RNAP, and transcription factors to promoters. Yet, we lack a way to decode promoters: a code or dictionary that would map promoter sequences into their function – the level of gene expression (<xref ref-type="bibr" rid="bib20">Kinkhabwala and Guet, 2008</xref>). This mapping is fundamental for understanding gene regulatory network structure and their evolution (<xref ref-type="bibr" rid="bib44">Voordeckers et al., 2015</xref>; <xref ref-type="bibr" rid="bib24">Lässig et al., 2017</xref>), and for engineering synthetic biological systems (<xref ref-type="bibr" rid="bib19">Kim et al., 2009</xref>). Moreover, gene expression is a phenotype that captures our intuitive notion of promoter function, enabling simulation of evolutionary scenarios that select for that function – a feat that appears unrealistic for cases where a phenotype has no obvious functional significance. Accounting for structural features of promoters (<xref ref-type="fig" rid="fig1">Figure 1A</xref>) improved the predictions of gene expression levels from any DNA sequence, by extending the applicability of thermodynamic modeling toward low expression levels and beyond local neighborhoods of known promoters (<xref ref-type="bibr" rid="bib43">Vilar, 2010</xref>; <xref ref-type="bibr" rid="bib10">Forcier et al., 2018</xref>), to capture the entire genotypic space. This is a necessary precondition to ask questions about de novo promoter evolution. The Extended model also allowed us to better understand key mechanisms of promoter function, such as the existence of multiple binding sites that cumulatively contribute to expression (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). Recently, a complementary approach described two further structural features of DNA-RNAP interaction, the avidity between –10 and –35 binding sites and the UP element (<xref ref-type="bibr" rid="bib8">Einav and Phillips, 2019</xref>), yet this approach was not designed to predict expression from random sequences. Integrating these and other additional mechanisms of RNAP and promoter function (<xref ref-type="bibr" rid="bib13">Hawley and McClure, 1983</xref>; <xref ref-type="bibr" rid="bib34">Roy et al., 1998</xref>) into our Extended model could further improve promoter sequence-to-function predictions. Furthermore, the thermodynamic framework can be extended to model complex, regulated promoters that bind transcription factors, as long as their biophysical parameters (energy matrices) are known (<xref ref-type="bibr" rid="bib4">Bintu et al., 2005</xref>; <xref ref-type="bibr" rid="bib35">Saiz and Vilar, 2008</xref>).</p><p>The flexibility of σ<sup>70</sup>-RNAP binding ensures the proximity of any DNA sequence to a constitutive promoter (<xref ref-type="fig" rid="fig3">Figure 3</xref>). This permits easier evolutionary tuning of gene expression levels, while also allowing σ<sup>70</sup>-RNAP to function as a de facto global regulator (<xref ref-type="bibr" rid="bib36">Salgado et al., 2013</xref>; <xref ref-type="bibr" rid="bib15">Igler et al., 2018</xref>). Selection can thus sustain the binding specificity of required transcription factors and reduce crosstalk while maintaining expression (<xref ref-type="bibr" rid="bib11">Friedlander et al., 2016</xref>). The ease of evolving constitutive promoters, which has been experimentally hinted at using a very limited number of mutants (<xref ref-type="bibr" rid="bib45">Wolf et al., 2015</xref>; <xref ref-type="bibr" rid="bib47">Yona et al., 2018</xref>), remained theoretically puzzling (<xref ref-type="bibr" rid="bib41">Tuğrul et al., 2015</xref>). In fact, Tugrul et al. failed to identify mechanistic or evolutionary factors that would increase the predicted speed of binding site evolution and bring it closer to experimental observations. To address this discrepancy, we linked an extended biophysical model of promoter function, inferred directly from large mutant libraries, with a quantitative evolutionary framework to show that promoters indeed evolve more rapidly than expected based on existing models of protein-DNA interactions. Strikingly, this increase in the rates of promoter evolution, which can be orders of magnitude faster in the Extended compared to the Standard model, arises from the same promoter features that account for only a 2-to-3-fold increase in the likelihood of random sequences resulting in measurable expression. We hypothesize that this potentiation comes about due to a vast expansion in the number of accessible evolutionary paths that lead from a random initial sequence to the functional promoter, likely created by the flexible spacer, which is an interesting question for future research. Another key question that arises from our results is how σ<sup>70</sup>-RNAP navigates the fine balance between evolvability of binding sites and their specificity, the latter hinging on selection against spurious binding. Our study shows how biophysical models that accurately capture mechanisms of biological function offer a robust method for addressing key questions in biology and evolution.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Experimental systems and mutant libraries</title><p>The <italic>P</italic><sub>R</sub> system consisted of <italic>venus-yfp</italic> (<xref ref-type="bibr" rid="bib31">Nagai et al., 2002</xref>) under the control of Lambda bacteriophage <italic>P</italic><sub>R</sub> promoter (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1A</xref>). The system was isolated from the rest of the plasmid with two strong terminators, T1 and T17, obtained from iGem Parts registry. The <italic>O<sub>R3</sub></italic> site of <italic>P</italic><sub>R</sub> was removed in order to remove the <italic>P</italic><sub>RM</sub> promoter. The RBS (carrying the AGGAGG Shine-Delgarno sequence) was 28 bp away from the downstream end of the strongest σ<sup>70</sup>-RNAP binding site in the <italic>P</italic><sub>R</sub> promoter. The entire cassette was inserted into a low-copy number plasmid backbone SC101* carrying a kanamycin resistance gene (<xref ref-type="bibr" rid="bib27">Lutz and Bujard, 1997</xref>). The random <italic>P</italic><sub>R</sub> mutant library was created by cloning custom-made oligonucleotides (IDT Technologies), which had a 12% mutation rate for each of the 67 positions in the <italic>P</italic><sub>R</sub> promoter (4% mutation chance for each possible mutation away from the wildtype). The mutagenized region concluded 8 bp upstream of the wildtype <italic>P</italic><sub>R</sub> promoter transcriptional start site, and hence that start site was not mutated. Ligated plasmids were electroporated into One-Shot Top10 electrocompetent <italic>E. coli</italic> cells (Life Technologies, Carlsbad, CA). This step was used to maximize the library diversity due to One-Shot Top10 cells’ high competency. Following electroporation, cells were grown for 1 hr in LB broth and plated on selective LB plates with 50 μg/mL kanamycin to allow single colony formation and minimize resource competition, and were then grown overnight. To ensure large coverage, we cloned mutagenized PCR products until we obtained at least 30,000 individual colonies (uniquely transformed individuals). We obtained this number of individual colonies by estimating the number of colonies on each selective plate, and then repeating the above cloning procedure until each library contained at least 30,000 individual colonies. Using chilled LB media, colonies were washed off plates and collected. Plasmids were isolated from this collection in bulk using a Qiagen Mediprep kit, and transformed into strain K12-MG1655. The same wildtype layout and mutagenesis protocol was used to create the <italic>P</italic><sub>L</sub> mutant library, with the exception that mutation rates were 9% per nucleotide (with 3% mutation chance for every possible non-wildtype mutation). Cells were always grown in a shaking incubator at 37°C.</p><p>The 36N library was placed in pUA66-lacZ plasmid backbone carrying Kan resistance (<xref ref-type="bibr" rid="bib48">Zaslaver et al., 2006</xref>), by cloning a 100-bp-long oligonucleotide containing 36 randomized base pairs (each of the 36 positions had a 25% chance of being either adenine, thymine, cytosine, or guanine), surrounded on each side by 32 bp of randomly generated, unmutated, non-expressing DNA sequence (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1B</xref>). The two 32-bp-long segments had a different sequence, as each was randomly generated. This 100 bp sequence was placed upstream of the RBS, controlling the expression of a <italic>gfp</italic> gene (<xref ref-type="bibr" rid="bib48">Zaslaver et al., 2006</xref>). The rest of the plasmid had the same components as the one used for the <italic>P</italic><sub>R</sub> library. The 36N plasmid DNA library was generated using a Q5 site directed mutagenesis kit (New England Biolabs, Ipswitch, MA). For amplification, we used the reference plasmid as a template (a plasmid with a random, non-expressing 100 bp fragment) and two pools of primers with a constant 3’ end and an 18N random 5’ end. We cloned the mutagenesis products into electro-competent NEB5α cells. Following electroporation, cells were grown for 1 hr in LB and then plated overnight on selective kanamycin plates. Cells were collected in bulk to form the 36N mutant library. We used different strains between the <italic>P</italic><sub>R</sub> and the 36N libraries in order to better evaluate and increase the generalizability of our model. The mutation rates of all three libraries (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1G</xref>), as well as the sequence-level randomness of the 36N library, were checked based on the <italic>sort-seq</italic> data. The libraries also contained promoter sequences with a range of spacer lengths (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1H</xref>).</p></sec><sec id="s4-2"><title><italic>Sort-seq</italic> Experiments</title><p>Prior to sorting, cells were grown in M9 minimal medium with 0.2% (w/v) Casamino acids, 0.2% (w/v) glucose and 50 μg/mL kanamycin. Frozen aliquots of each mutant library were diluted 1:100 and grown overnight. Prior to sorting, overnight cultures were diluted again 1:100 and grown until exponential phase (for 3 hr in M9 media). We repeated the sorting of each library in three biological replicates.</p><p>Fluorescence activated cell sorting (FACS) was performed on a FACS Aria III flow cytometer (BD Biosciences, San Jose, CA) with a 70 μm nozzle. A 488 nm laser was used to detect forward scatter (FSC) and side scatter (SSC) with a 488/10 band-pass filter. FITC channel was used for excitation of either YFP (<italic>P</italic><sub>R</sub> and <italic>P</italic><sub>L</sub> libraries) or GFP (36N library). The flow rate was set to 1.0 and samples were diluted to obtain a cell count of approximately 2000 events/s. Cells for sorting were manually gated on the densest population in an FSC/SSC scatter plot, which comprised 95.5% of all events exceeding a threshold of 1000 on the SSC axis. For the <italic>P</italic><sub>R</sub> and <italic>P</italic><sub>L</sub> libraries, four sorting gates were set on FITC: no-expression gate, capturing &gt;99% of all measurements from a non-expressing plasmid (control plasmid not containing <italic>yfp</italic>); high-expression gate, capturing &gt;99% of all measurements from the wildtype <italic>P</italic><sub>R</sub> plasmid; two gates equidistant in fluorescence between the no- and high-expression gates (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1F</xref>). The boundary for the no-expression gate (obtained from the SC101* strain without the fluorescence marker) was used to define the ‘measurable expression’ threshold for <italic>P</italic><sub>R</sub> and <italic>P</italic><sub>L</sub> libraries. The 36N library was sorted into 12 gates as follows: The upper boundary of the lowest gate corresponded to the median of an auto-fluorescence control sample (plasmid-free Top10 cells). The upper boundary of the second-lowest gate, which also defined the ‘measurable expression’ threshold for the 36N library, was the 99th percentile of the fluorescence-free cells. The lower boundary of the highest gate (B12) was set to 2 × 10<sup>4</sup>. Distances between the remaining intermediate nine gate boundaries were of equal size on the log-scale FITC histogram (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1F</xref>). For <italic>P</italic><sub>R</sub> and <italic>P</italic><sub>L</sub> libraries we could sort into all four bins simultaneously, and hence we sorted 1 million cells for each of the three biological replicates. For the 36N library, we first recorded 10<sup>5</sup> reads, and then the number of cells sorted into each of the 12 bins corresponded to the number of cells recorded in each of the bins. The recipient plate was cooled to 4°C to halt growth while sorting to other wells was still going on. Only for the 36N library, after sorting we added 1000 cells with the reference plasmid (experimental <italic>P</italic><sub>R</sub> plasmid) into each of the 12 sorted populations. We did this to maximize the precision of our experimental measurements for the 36N library, as it would enable more accurate experimental determination of gene expression levels by enabling normalizing the number of mutants in each bin (see section <italic>Processing of the 36N mutant library</italic>).</p><p>Cells from each sorted bin were grown overnight. We isolated plasmids from the sorted populations. We used high-fidelity PCR (Phusion, New England Biolabs) to amplify 150 bp containing the mutagenized region, and barcoded the primers according to the sorted bin. Four sets of barcoded primers were used for the <italic>P</italic><sub>R</sub> and <italic>P</italic><sub>L</sub> libraries, and 12 for the 36N library. PCR products were column-purified (Zymo Research, Irvine, CA) and eluted in 30 μL, of which 2 μL were run on an agarose gel for product quantification based on band fluorescence. PCR products were pooled to reach approximately equimolar concentrations of each bin, separately for each mutant library. No additional clonal amplification steps were conducted prior to sequencing. Each library was sequenced with millions of reads using 135 bp pair end Illumina sequencing (Hi-seq).</p><p>The nature of the 36N library – it containing completely random 36-bp-long sequences – means that we might not be measuring the effects of each random sequence on σ<sup>70</sup>-RNAP binding, but also possibly on other factors that impact gene expression levels, most important of which could be mRNA stability. Our experimental setup does not allow us to directly disentangle the effects of each individual sequence on mRNA stability versus binding energy. On the other hand, the <italic>P</italic><sub>R</sub> and <italic>P</italic><sub>L</sub> libraries have a clearly defined wildtype sequence around which all mutations were introduced. Introducing a relatively small number of mutations into these promoters is unlikely to dramatically alter mRNA stability (<xref ref-type="bibr" rid="bib28">Mohanty and Kushner, 2016</xref>). The fact that the Extended model trained only on the <italic>P</italic><sub>R</sub> dataset performs so well on the 36N library (<xref ref-type="fig" rid="fig3">Figure 3B</xref>) makes us confident that the majority of 36N mutants predominantly affect σ<sup>70</sup>-RNAP rather than mRNA stability. In other words, while the primary mechanism linking sequence to gene expression might be mRNA stability for some mutants in the 36N library, on average the effect of mutants on binding energy dominates.</p></sec><sec id="s4-3"><title>Processing of <italic>P</italic><sub>R</sub> and <italic>P</italic><sub>L</sub> mutant libraries</title><p>Here, we describe the data processing pipeline for the <italic>P</italic><sub>R</sub> and <italic>P</italic><sub>L</sub> libraries, from the initial sequence reads to a dataset we use for fitting and evaluating our model. For each library, we obtained millions of reads (<xref ref-type="supplementary-material" rid="fig3sdata1">Figure 3—source data 1</xref>), which we paired (using the illumina-utils package; <xref ref-type="bibr" rid="bib9">Eren et al., 2013</xref>), discarding reads with any mismatch. Each read contained a tag on both ends with information of the expression bin the sequence was sorted into, and we only included reads which have the same tag on both ends.</p><p>In each library, the remaining ~2.5 million reads contained more than 300,000 unique sequences, which we filtered based on length, coverage, and the position of the RBS (Shine-Dalgarno sequence that was the same for all sequences in the library as it was not mutated) (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2A</xref>,B). We further required the sequences not to be too different from the ancestral sequence (<italic>P</italic><sub>R</sub> and <italic>P</italic><sub>L</sub>, respectively) (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2C</xref>). This step removed the remaining <italic>P</italic><sub>R</sub> sequence and a small cloud of sequencing errors around it from the <italic>P</italic><sub>L</sub> library. <italic>P</italic><sub>R</sub> wildtype sequences were present in the <italic>P</italic><sub>L</sub> library because both libraries were made using the <italic>P</italic><sub>R</sub> wildtype sequence as the starting point for cloning and ligation – a technique that is nearly but not exactly 100% efficient. Even though we used high-fidelity polymerase for the PCR, still some sequencing errors existed (as evident from the ‘cloud’ of sequencing errors around the <italic>P</italic><sub>R</sub> wildtype in the <italic>P</italic><sub>L</sub> library), but were lower than 0.01%. Finally, we required the distribution of expression bins to be as unambiguous as possible (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2D</xref>,E). This requirement was introduced because <italic>sort-seq</italic> experiments involve several passages of bacterial cultures after they have been sorted into their corresponding bins. This passaging can introduce a bias in the form of over- or under-representation of a given mutant in one bin compared to its abundance in the adjacent bins. Approximately 0.5% of all sequences had highly unequal distributions between adjacent bins, and were thus excluded.</p><p>We observed a discrepancy in the number of unique sequences in the two libraries (<xref ref-type="supplementary-material" rid="fig3sdata1">Figure 3—source data 1</xref>) that arose due to the higher mutation rate of the <italic>P</italic><sub>R</sub> library. This is why we took a more conservative approach and additionally raised the coverage threshold to 30 for all our analyses.</p></sec><sec id="s4-4"><title>Processing of the 36N mutant library</title><p>The original sequences library contained more than 10 million paired reads, almost all of which paired without mismatches (<xref ref-type="supplementary-material" rid="fig3sdata1">Figure 3—source data 1</xref>). Out of those, more than a million contained the reference plasmid sequence, which we extract and treat separately. We required sufficient mapping (higher than 0.75 similarity, using local alignment function from the pairwise2 module in Biopython, with symmetric gap open and extension penalty of <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, and a matching score of <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> , where <italic>L</italic> is the length of the mapping region) of both flanking regions, and that the length of the core region is within 2 bp of the canonical (36 bp) one. Most of those reads were unique and most probably errors, so we originally required coverage of at least two (<xref ref-type="supplementary-material" rid="fig3sdata1">Figure 3—source data 1</xref>).</p><p>At this point we set to estimate the abundance of spurious sequences (e.g. sequencing or PCR errors), by cross-mapping the abundant sequences (with the highest coverage) against all other sequences, using the same scores as defined above (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2F</xref>). In every case the distribution of mapping scores was bimodal, with an overwhelming number of low scores and a small number of very high scores, suggesting that abundant sequences come with a cloud of errors, which are similar to the investigated sequence. Compiling a distribution of similarity scores for the 1000 most covered sequences showed a clear threshold of 0.7 between the low- and high-scored modes. We then accumulated all the sequences that appeared to be associated with a number of high-covered sequences and noted that the histogram of coverages of only those sequences closely matches the low-end part of the histogram of all sequences. Extrapolating from this, we estimated that requiring a coverage of at least 30 reads would lower the number of spurious sequences to only a few dozen (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2G</xref>).</p><p>In contrast to the <italic>P</italic><sub>R</sub> and <italic>P</italic><sub>L</sub> libraries, where FACS was performed simultaneously into four bins, here the experiment involved sequential sorting of the same number of cells into one of the 12 bins (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1F</xref>). Naturally, less abundant expression bins had to be sorted for a longer time, which introduced a systematic bias for higher expressing bins. To account for this bias toward higher-expressing sequences, we introduced during the cell sorting step to each bin a known number (1000) of cells carrying the reference <italic>P</italic><sub>R</sub> plasmid. Note that this was not the same plasmid as the one used for cloning the 36N library, allowing us to easily distinguish between the reference plasmid and the wildtype plasmid that was not cloned successfully (i.e. was not carrying any mutations).</p><p>To debias, we divided each distribution by the distribution for the reference sequence (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2H</xref>), and normalized. We then constructed a set of average distributions for all sequences that have the same mode. This allowed us to fit the background noise (intrinsic to FACS measurements) for all distributions. Next, we cleaned the sequence-specific distribution of potential outliers that may distort the estimate of the mean: for each mode-specific template distribution, we defined a filter that selected only bins in which the background is at max ⅓ of the value of the template. For each sequence-specific distribution, we selected a filter based on its mode, which nullified values in bins defined as outliers (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2I</xref>,J). Afterward, we renormalized the distribution. This filtering is especially important for the higher-expressing sequences, where a single count in the lower bins would get enlarged tremendously by debiasing, drastically skewing the expression estimate (<xref ref-type="supplementary-material" rid="fig3sdata1">Figure 3—source data 1</xref>).</p><p>We used the debiased and filtered distribution over bins <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> , to produce two estimates of gene expression. In the units of bin index, we estimate expression as <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mtext>bin</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mo>≤</mml:mo><mml:mn>11</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, while in the units of luminosity measured in FACS as <inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mtext>facs</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mn>11</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:msub><mml:mi mathvariant="normal">g</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="normal">m</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> where <inline-formula><mml:math id="inf6"><mml:msub><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the median value of measurements in the <inline-formula><mml:math id="inf7"><mml:mi mathvariant="normal">i</mml:mi></mml:math></inline-formula>-th bin. The two estimates are linearly related.</p><p>To validate our data processing, we randomly picked eight mutants from each of the 12 bins, sequenced them and measured in a plate reader. Out of 96 mutants, 79 were unique, and 2 did not exist in the 36N <italic>sort-seq</italic> library. We compared the measurements of the remaining 77 sequences obtained from a plate reader to the estimate of their expression obtained from the <italic>sort-seq</italic> experiment following the above-described debiasing and filtering (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>). Plate reader measurements were conducted in the following manner: mutants were grown overnight in M9 minimal media supplemented with 0.2% (w/v) CAS, 0.2% (w/v) glucose, and 50 μg/mL kanamycin. The overnight populations were diluted 1000-fold, grown until OD<sub>600</sub> of approximately 0.1, and their fluorescence measured in a Bio-Tek Synergy H1 plate reader. Three replicates of each mutant were measured.</p></sec><sec id="s4-5"><title>Data splits and fitting procedure</title><p>We define 60:20:20 percentage splits of each of our libraries into three disjunct datasets (<xref ref-type="supplementary-material" rid="fig3sdata2">Figure 3—source data 2</xref>). The first (‘Training’ dataset) and second (‘Validation’ dataset) were used for training and model selection respectively, while the last (‘Evaluation’ dataset) was used exclusively for final evaluation and visualization of our models. Sequences were randomly divided into three splits. Note that each sequence in our library is unique, thus no sequences were repeated between libraries.</p><p>The central quantity of our modeling approach is the proportion of time RNAP spends bound to the DNA in the ‘on’ configuration, <inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mtext>on</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, that is, in a configuration that can yield productive mRNA and thus lead to protein expression. Our quantification of expression, which we define as log fluorescence, will then be proportional to <inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>⁡</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>on</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib4">Bintu et al., 2005</xref>; <xref ref-type="bibr" rid="bib21">Kinney et al., 2010</xref>).</p><p>The three libraries were different in terms of their output. While for the <italic>P</italic><sub>R</sub> and <italic>P</italic><sub>L</sub> libraries we used only four bins and chose the median bin for each mutant (more conservative statistic), we obtained more plausible estimates of expression for the mutants in the 36N library (as explained above). To keep the procedure the same across all three libraries, for the 36N library we rounded off the estimate of the mean expression in bin units to the closest integer. This allowed us to use multinomial logistic regression for all three datasets and the associated log-likelihood as the objective function.</p><p>Concretely, given a set of parameters (binding matrix, spatial penalties, chemical potential, potential dinucleotide interactions), our model produces <inline-formula><mml:math id="inf10"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>on</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> for each sequence, which we use as an independent variable to fit observed bin expression levels using multinomial logistic regression (from scikit learn, with L-BFGS-B optimization; <xref ref-type="bibr" rid="bib6">Byrd et al., 1995</xref>). When implementing multinomial logistic regression, we treat <inline-formula><mml:math id="inf11"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>on</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> as an independent variable (<inline-formula><mml:math id="inf12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>on</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>), so that the log-odd of a sequence falling into a bin <inline-formula><mml:math id="inf13"><mml:mi>i</mml:mi></mml:math></inline-formula> is a linear function of <inline-formula><mml:math id="inf14"><mml:mi>x</mml:mi></mml:math></inline-formula>: <inline-formula><mml:math id="inf15"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>x</mml:mi><mml:mo>+</mml:mo></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mtext>i</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> . This yields individual probabilities: <inline-formula><mml:math id="inf16"><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math></inline-formula>. In the case of multi-label classification, <inline-formula><mml:math id="inf17"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> needs to be further normalized by 1, so that the probability associated with <inline-formula><mml:math id="inf18"><mml:mi>x</mml:mi></mml:math></inline-formula> being measured in bin <inline-formula><mml:math id="inf19"><mml:mi>i</mml:mi></mml:math></inline-formula> is: <inline-formula><mml:math id="inf20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> . Additionally, we explicitly required a balanced fit by applying weights inversely proportional to the number of observations in each bin for each dataset. This is especially important for the 36N library, due to the highly disproportionate numbers of observations in the 12 bins.</p><p>The main metric for our optimization and model performance is the likelihood of the logistic regression. In the interest of higher interpretability, we also report the <inline-formula><mml:math id="inf21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> value of a linear fit where the independent variable is <inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>⁡</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>on</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and the dependent variable is the log fluorescence estimate, using the same weights as for the logistic regression. The fluorescence estimate is the median for the <italic>P</italic><sub>R</sub> and <italic>P</italic><sub>L</sub> libraries, as a robust measure in the absence of high bin resolution; and mean for the 36N library, as having 12 bins allowed us to accurately estimate the mean. The multinomial logistic regression does not necessarily yield a linear dependence between <inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>⁡</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>on</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and observations. In fact, across the range of reasonable values, the log-likelihood depends on the chemical potential only weakly, yet it may change the correlation coefficient by several percent. For this reason, in <xref ref-type="fig" rid="fig3">Figure 3B</xref>, we show correlation coefficients (<inline-formula><mml:math id="inf24"><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>) for evaluation datasets with chemical potentials re-optimized on the respective training datasets. Raw <inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> values are similar and are reported in <xref ref-type="fig" rid="fig2">Figure 2D</xref>.</p><p>We start from the Standard model, and progress toward the Extended model sequentially, including one structural feature at a time. We fit the model parameters using only the training dataset of the <italic>P</italic><sub>R</sub> library, and only search in the vicinity of the previous best fit. We assess such a model on the <italic>P</italic><sub>R</sub> evaluation and all three datasets of the <italic>P</italic><sub>L</sub> library without any adjustments, since the two libraries were obtained following the same experimental protocol in the same cells. In that sense, the whole <italic>P</italic><sub>L</sub> library played the role of an evaluation set. To evaluate this model on the 36N library, which was obtained using a different strain and through different FACS thresholds, we used the 36N training set to refit the chemical potential and the hyperparameters of the logistic repression. Therefore, in the context of evaluating a model fitted on the <italic>P</italic><sub>R</sub> library alone, both Validation and Evaluation 36N datasets can be considered true validation datasets.</p><p>Ultimately, we wanted to pool the training datasets of all three libraries to fit a unique model to give us the best set of parameters. In this case, all Validation and Evaluation datasets were data-naive. By doing this, we increased the inference power of our models, allowing us to fit pairwise (dinucleotide) interactions between nucleotides and the rate of RNAP clearance from the initial binding site.</p></sec><sec id="s4-6"><title>Standard thermodynamic model</title><p>In thermodynamic models of gene expression, the amount of protein is directly proportional to the fraction of time RNAP is bound to the promoter sequence. In the simplest case, where RNAP can be either bound (‘on’) or not bound (‘off’-state), the probability of the <italic>on</italic>-state is given by the formula:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>on</mml:mtext></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>E</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>where <italic>E</italic> is the binding energy, and <italic>µ</italic> the chemical potential of RNAP in the cytoplasm. All our experiments were performed at room temperature, thus <inline-formula><mml:math id="inf26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>k</mml:mi><mml:mi>B</mml:mi><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>0.59</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> kcal/mol. For simplicity, we define energy and chemical potential in those units, and drop <inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>k</mml:mi><mml:mi>B</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> from subsequent formulas.</p><p>We further expressed binding energy as an independent sum of local interactions between RNAP and individual base pairs in the promoter region, with each of the four possible bases (A,C,G,T) contributing differently depending on the position in the promoter. Such <inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>4</mml:mn><mml:mo>×</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> matrix is referred to as the binding energy matrix. The values of the energy matrix are determined up to an arbitrary offset per position. We set the zero value as the binding energy of the wildtype <italic>P</italic><sub>R</sub> sequence.</p><p>In the case when the promoter sequence <inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is longer than the binding matrix <inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, the number of states is <inline-formula><mml:math id="inf31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, and the <italic>on</italic>-probability takes the form<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>on</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>The Standard model assumes that only one element (i.e. binding site) in the sum dominates, and we follow other studies (<xref ref-type="bibr" rid="bib4">Bintu et al., 2005</xref>; <xref ref-type="bibr" rid="bib21">Kinney et al., 2010</xref>) when formulating our standard thermodynamic model as<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>on</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">μ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math></disp-formula></p></sec><sec id="s4-7"><title>Toward the Extended model: spacer flexibility</title><p>Based on the common observation that RNAP has a flexible spacer length, we extended the Standard model by allowing for spacer lengths that differ from the canonical by up to 2 bp. This effectively increased the number of possible configurations by a factor of 5. The key difference that we introduced was to assign an energy penalty for each non-canonical configuration. Increasing the spacer flexibility beyond ±2 bp did not yield further benefits to predictability. Note that it is in principle possible that the σ<sup>70</sup>-RNAP energy matrix depends on spacer length, so that a different energy matrix would need to be inferred for each spacer length. Exploring this possibility was beyond the scope of this project, as the experimental datasets would be too small for reliable inference if conditioned on individual spacer lengths.</p></sec><sec id="s4-8"><title>Toward the Extended model: cumulative binding</title><p>In order to account for multiple RNAP binding configurations (different positions along the promoter and different spacer lengths) that can lead to a productive transcript, we saw the necessity of performing the thermodynamic sum in <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> instead of just extracting the dominant binding as was done for the Standard model. To do this, we assume that σ<sup>70</sup>-RNAP concentration is not high enough for two molecules to be simultaneously present at the promoter before they initiate transcription. Fully embracing the thermodynamic description at this point provided us with a natural language for all further extensions.</p></sec><sec id="s4-9"><title>Toward the Extended model: occlusive unproductive binding</title><p>We accommodated the occlusive unproductive binding states naturally in the thermodynamic description:<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>on</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>The main challenge here was to find the exact position after which the transcripts that did not contain a full (i.e. non-functional) RBS were produced. To answer this question, we checked computationally whether there was a natural region where this would be the case. First, we aligned all sequences with respect to the position of the RBS (Shine-Dalgarno sequence ‘AGGAG’). Then, using the parameters from the previous model iteration (with cumulative binding), we assessed performance with different positions separating the productive and unproductive binding. This identified an 8-bp-long region, where the separating position was to be expected (<xref ref-type="fig" rid="fig2">Figure 2B</xref>, <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2B</xref>). To determine the location more precisely, we set up a separate experiment (see section <italic>Verifying promoter structural features</italic>).</p></sec><sec id="s4-10"><title>Toward the Extended model: occlusive binding on the reverse complement</title><p>When bound to the reverse complement, we considered RNAP to effectively act as its own repressor. We accommodated this in the model by expanding the set of ‘np’ states in <xref ref-type="disp-formula" rid="equ4">Equation 4</xref> to all reverse complement configurations. Including this effect led to a slight but significant increased performance even without refitting, after which we also re-optimized the parameters locally.</p></sec><sec id="s4-11"><title>Toward the Extended model: dinucleotide interactions</title><p>The previous components of the model were fit exclusively on the <italic>P</italic><sub>R</sub> dataset. In our search for dinucleotide interactions and when exploring departures from thermodynamic equilibrium, we pool the datasets in search for the best fit, as only then could we get a significant estimate of the interactions.</p><p>A common assumption of thermodynamic modeling of gene expression is that the binding energy of any particular transcription factor-promoter complex can be expressed as an independent sum of interactions between individual base pairs and the transcription factor (RNAP in our case) residues. A naive inclusion of all possible dinucleotide interactions between the contact residues of RNAP and the promoter would inflate the number of parameters to thousands, rendering their simultaneous estimation hopeless, even before considering overfitting issues.</p><p>To overcome the pitfalls of overfitting and to estimate the potential importance of dinucleotide interactions, we first included each interaction independently, and required that the best fit increased log-likelihood by at least 2-fold. This reduced the number of interactions from 4416 to 892. Then, we drew 10 random subsets of 20 interactions, and jointly optimized the interactions in the vicinity of the previously obtained values, over 10 cross-validation splits (50:50) of the training and validation datasets and using L1 regularization. This way, we obtained estimates (and associated error) for the interaction value in 10 different ‘backgrounds’. For each interaction, we considered valid only those estimates that were larger in magnitude than a defined threshold, and combined them into a single estimate (mean and standard deviation), allowing for a small amount of leniency due to rather strict L1 regularization. We chose 0.002<italic>k</italic><sub>B</sub><italic>T</italic> as the threshold for acceptance and made sure the results were robust for thresholds of 0.001 and 0.005. We then filtered for only those interactions that were non-compatible with zero at confidence level of 2<italic>σ</italic>. This brought down the number of interactions to 250. In the next step, we again jointly inferred subsets of interactions: this time 12 subsets of 50 interactions. For each interaction, we then estimated the single mean and standard deviation from the 12 values, and conservatively selected only those that were inconsistent with zero at more than 3<italic>σ</italic>, which brought down their number to 77. Finally, we sequentially include dinucleotide interactions starting with the most and moving toward the least significant, requiring that each contributed to at least 3<italic>σ</italic>-level in the background of all accepted up to that point. This left 31 interactions (<xref ref-type="fig" rid="fig2">Figure 2D</xref>).</p></sec><sec id="s4-12"><title>Toward the Extended model: clearance rate</title><p>Finally, we implemented our framework even closer to the real biology by noting that RNAP is not like any other DNA binding protein, in-so-far that it is in fact <italic>not</italic> in thermodynamic equilibrium: to make the transcript, it needs to leave its original binding site, that is, if it binds too strongly it cannot make the transcript. We model this by introducing a parameter <italic>R</italic>, as a rate with which RNAP is cleared away from the binding site, relative to the rate with which it is bound, in the limit of very strong binding. It effectively sets up an upper limit on the amount of time RNAP persists on the binding site, and should make the difference only with strong binding sites.</p><p>Consider a system where RNAP can exist in only three states: (i) bound at a productive position, (ii) bound at an unproductive position, and () unbound (‘off’); and consider the transition rates among them (<xref ref-type="fig" rid="S1">Scheme 1</xref>):</p><fig id="S1" position="anchor"><label>Scheme 1.</label><caption><title>Modelling RNA polymerase binding.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-64543-scheme1-v1.tif"/></fig><p>The transition rate from unbound to any of the bound states <inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is the same and depends only on the concentration of free RNAP in the vicinity of the sites. The reverse transitions depend on the sequence (<inline-formula><mml:math id="inf33"><mml:mi mathvariant="normal">σ</mml:mi></mml:math></inline-formula>), through energy of binding <inline-formula><mml:math id="inf34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mtext>on</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mtext>b</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>∝</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mtext>on</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mtext>b</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. We modeled RNAP clearance as an independent rate Γ, which depletes the bound states <italic>on</italic> and <italic>b,</italic> and eventually contributes to repopulation of RNAP in the cell. We do not model time dependence, and are interested only in the stationary state, thus we do not need to model the time delay between leaving the bound state and reappearing in the cell.</p><p>In stationarity we have:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi> </mml:mi><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula></p><p>Introducing a relative clearance rate <inline-formula><mml:math id="inf35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>R</mml:mi><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi>r</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> , casting the known rates and RNAP concentrations in terms of binding energy <inline-formula><mml:math id="inf36"><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mfenced close="}" open="{" separators="|"><mml:mrow><mml:mo>∆</mml:mo><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:math></inline-formula> , and considering that <inline-formula><mml:math id="inf37"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mn>1</mml:mn></mml:math></inline-formula>, we obtained:<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mi>R</mml:mi><mml:mo> </mml:mo><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo> </mml:mo><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo> </mml:mo><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>This is the same formula as Equation 4, with <inline-formula><mml:math id="inf38"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi mathvariant="normal">μ</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:mo>→</mml:mo><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>R</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mfenced close="}" open="{" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi mathvariant="normal">μ</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> . Considering the clearance rate effectively introduced a cutoff on the binding energy <inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, below which the energy of binding is not important anymore. Note that in the case of <inline-formula><mml:math id="inf40"><mml:mi mathvariant="normal">R</mml:mi><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, the formula reduces to the previous state. In the case of a single (<italic>on</italic>) binding site, <italic>R</italic> is a completely degenerate degree of freedom, which can be manifestly removed by a transformation <inline-formula><mml:math id="inf41"><mml:mi mathvariant="normal">μ</mml:mi><mml:mi> </mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="normal">μ</mml:mi><mml:mi> </mml:mi><mml:mo>-</mml:mo><mml:mi> </mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>.</p><p>The scan over the values of <italic>R</italic> (only on the training dataset) is shown in <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2B</xref>. For each value, we refit the chemical potentials. We obtained the best fit value for the relative clearance rate of <italic>R*</italic> = 0.31, and a large uncertainty region, yet the model quite robustly preferred a non-zero clearance rate. Here, we consider the clearance rate to be a property of the RNAP molecule itself, and independent of sequence. Including the sequence dependence for the clearance rate can be done, however disentangling the exact nature of such dependence would require a dedicated set of experiments that is beyond the scope of this work.</p></sec><sec id="s4-13"><title>Verifying promoter structural features</title><p>We incorporated several structural features of bacterial promoters into the thermodynamic modeling framework (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). When estimated on all three mutant libraries, each of these features independently increased model predictability, providing evidence of its biological role. Nevertheless, we conducted additional, hypothesis-driven experiments to verify the role of these structural features. For all mutant measurements performed for these validation experiments (outlined below), we measured expression levels of three biological replicates of each mutant in a plate reader. The mutants, the <italic>P</italic><sub>R</sub> wildtype, and the negative control (the strain carrying the plasmid without a fluorescence marker in order to define ‘measurable expression’ – i.e. background fluorescence) were grown overnight in M9 minimal media supplemented with 0.2% (w/v) CAS, 0.2% (w/v) glucose, and 50 μg/mL kanamycin. The overnight populations were diluted 1000-fold, grown to OD<sub>600</sub> of ~0.1, and their fluorescence measured in a Bio-Tek Synergy H1 plate reader. All measurements were masked from the experimentalist performing them during the data allocation step. All the mutants were generated on the wildtype <italic>P</italic><sub>R</sub> plasmid backbone, using oligonucleotide cloning. We did not conduct tests for the variable spacer, because changes in spacer length in σ<sup>70</sup>-RNAP binding are well documented, so we assigned them their accurate biophysical meaning in the form of a binding energy penalty to altering spacer length away from the lowest energy spacer (9 bp, corresponding to 17 bp between –10 and –35 sites). We did not independently verify the clearance rate, as we use a simplified description of clearance rate that attempts to capture its effects in a single parameter, rather than explicitly accounting for the mechanisms of σ<sup>70</sup>-RNAP clearance.</p><sec id="s4-13-1"><title>Cumulative bindin<underline>g</underline></title><p>To test for the role of multiple independent σ<sup>70</sup>-RNAP binding on gene expression levels, we created 29 specific promoters, which were derived from the <italic>P</italic><sub>R</sub> wildtype promoter. These promoters were selected so that the prediction of their gene expression levels would be different between two models: (i) the Standard model, which did not include cumulative binding, predicted no measurable expression for these promoters; (ii) a model that included only cumulative binding as a structural promoter feature, and which predicted measurable expression. We measured gene expression levels of these promoters in a plate reader as described above, compared the expression to the negative control through FDR-corrected <italic>t</italic>-tests, and found that the model with cumulative binding described experimental observations systematically better (<xref ref-type="fig" rid="fig2">Figure 2A</xref>).</p><p>We introduced additional mutations into a subset of these promoters in order to remove the additional σ<sup>70</sup>-RNAP binding sites. To do this, we used the Extended model to determine which mutations in the 29 promoters would reduce binding to any but the strongest binding site. Finding mutations that removed the secondary binding site(s), but that do not affect the binding to the strongest σ<sup>70</sup>-RNAP binding site, was possible for only 7 of the 29 promoters. Removal of the additional binding site(s) in this manner led to a reduction of gene expression levels, and six of the seven mutants exhibited no measurable expression – that is, what was predicted by the Standard model which accounted for only a single binding site (<xref ref-type="fig" rid="fig2">Figure 2A</xref>).</p></sec><sec id="s4-13-2"><title>Occlusive unproductive binding</title><p>We performed several different tests to validate various aspects of this structural feature. First, we created 20 promoters to compare predictions from two models: (i) model that allowed for cumulative binding, but all binding had a positive impact on expression; (ii) model that allowed for cumulative binding, but considered every binding that would not transcribe a complete RBS as having a negative effect on expression. Model (i) predicted all 20 sequences to have measurable expression, while Model (ii), which accounted for occlusive unproductive binding, predicted no measurable expression for any of the sequences. By comparing the measured expression of each promoter to the negative control through FDR-corrected <italic>t</italic>-tests, we found that only 2/20 mutants exhibited measurable expression, in better agreement with the model that accounted for occlusive unproductive binding (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B</xref> top left panel).</p><p>Second, we wanted to test if our model accurately predicted how expression levels change when an additional occlusive binding site is introduced. To this end, we started with a wildtype <italic>P</italic><sub>R</sub>, and used the Extended model to generate a series of single point mutations that were predicted to gradually introduce a new binding site. σ<sup>70</sup>-RNAP binding to the newly introduced sites would result in transcripts without a complete RBS. By constructing these mutants in the lab, we found that introduction of such a site into the <italic>P</italic><sub>R</sub> promoter indeed led to a significant reduction in expression levels (<xref ref-type="fig" rid="fig2">Figure 2B</xref> top right panel). Note that the strongest σ<sup>70</sup>-RNAP binding in the wildtype <italic>P</italic><sub>R</sub> promoter is 28 bp upstream of the RBS.</p><p>We also did the reverse – starting with three promoters from the <italic>P</italic><sub>R</sub> mutant library that had a strong occlusive unproductive binding site, we used the Extended model to predict a series of single point mutants that would gradually remove this binding site. Experimental measurements of those mutants, when compared to the expression level of the starting promoter sequence through FDR-corrected <italic>t</italic>-tests, exhibited a significant increase in the expression levels as the binding site was removed – an increase that was consistent with that site acting in an occlusive manner, and not a cumulative one (<xref ref-type="fig" rid="fig2">Figure 2B</xref> bottom left panel).</p><p>Finally, we wanted to determine the exact distance between the –10 element and the RBS that turned an additional binding site from being productive (cumulative) to being occlusive. To do this, we started with the same three promoters from the <italic>P</italic><sub>R</sub> mutant library that had a strong occlusive unproductive binding site as above, but this time we shifted the occlusive position of that binding site relative to the RBS. We shifted the binding site up to two positions closer to the RBS and up to seven positions further away from it, moving the binding site one position at a time – creating nine mutants of each of the three starting promoters. We used FDR-corrected <italic>t</italic>-tests to compare the measured expression of each mutant to the original sequence they were mutated from. We found support for the hypothesis that, as the occlusive binding site was moved further away from the RBS, it became cumulative (<xref ref-type="fig" rid="fig2">Figure 2B</xref> bottom right panel). This position matched the area determined with the model (see section <italic>Toward the Extended model: occlusive unproductive binding</italic>).</p></sec><sec id="s4-13-3"><title>Occlusive binding on the reverse complement</title><p>In order to conduct an independent verification of this structural feature of promoters, we identified four promoters from the 36N mutant library that the Extended model predicted to have strong occlusive binding on the reverse complement. We introduced up to eight mutations into each of these four promoters that would progressively eliminate the occlusive site on the reverse complement. The introduced mutations had minimal predicted effect on binding on the productive strand (<xref ref-type="fig" rid="fig2">Figure 2C</xref>, <xref ref-type="fig" rid="fig2">Figure 2</xref> – Extended <xref ref-type="fig" rid="fig1">Figure 1</xref>). We measured gene expression levels of these mutants as described above and performed a linear regression in order to correlate the measurements with the Extended model predictions of expression. For two sets of mutants, we found that the Extended model, which accounted for occlusive binding on the reverse complement, accurately predicted gene expression levels. For the other two mutant sets, removing the predicted binding site on the reverse complement had no measurable effect on expression levels (<xref ref-type="fig" rid="fig2">Figure 2C</xref>, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). This data shows that occlusive binding on the reverse complement is a more complex promoter feature than what we accounted for in the Extended model. Nevertheless, including this promoter structural feature into the model led to a significant increase in predictability (especially of the 36N dataset), which justified its inclusion into the Extended model.</p></sec></sec><sec id="s4-14"><title>Verifying model predictions</title><p>Arguably the most surprising prediction arising from the Extended model is the ease of generating promoters from random non-expressing sequences. Specifically, we wanted to verify that single point mutations on random non-expressing 115-bp-long sequences could generate dramatic shifts in expression levels. To do this, we experimentally created 20 pairs of promoters, each pair consisting of (i) a random non-expressing sequence; and (ii) the same sequence but with one point mutation that is predicted to lead to expression. We created these promoters on the <italic>P</italic><sub>R</sub> plasmid background and measured gene expression levels as described in the section <italic>Verifying promoter structural features</italic>. By conducting a series of FDR-corrected, paired <italic>t</italic>-tests we found that, indeed, single point mutations improved gene expression levels for all but two of the 20 promoters (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2A</xref>). Of the 20 original promoters, which were predicted not to have any expression, only two exhibited expression (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2A</xref>), confirming the accuracy of the Extended model on sequences of 115 bp length.</p></sec><sec id="s4-15"><title>Testing model generalizability with published datasets</title><p>In order to validate the generalizability of the Extended model, we tested how well it predicts gene expression levels obtained from <italic>RNA-seq</italic> experiments. To do this, we selected three published, large-scale, promoter mutant libraries whose expression was measured in <italic>E. coli</italic> (<xref ref-type="bibr" rid="bib17">Johns et al., 2018</xref>; <xref ref-type="bibr" rid="bib42">Urtecho et al., 2019</xref>; <xref ref-type="bibr" rid="bib14">Hossain et al., 2020</xref>). These libraries had different properties in terms of how they generated promoter mutants and variants (as discussed in the main text).</p><p>Each library consisted of a promoter sequence matched to its measured gene expression level. For each library, we refitted only a single parameter in the Extended model – the chemical potential. All other parameters were fitted only on our three libraries (<italic>P</italic><sub>R</sub>, <italic>P</italic><sub>L</sub>, and 36N). We calculated <italic>Pon</italic> as a proxy for gene expression level from each promoter in the three tested libraries, and correlated our model prediction to experimental measurements to obtain the correlation coefficient (<italic>r</italic><sup>2</sup>). For the purposes of comparison, we did the same for the Standard model. This approach meant that the Extended model’s predictability would very likely increase, if its parameters were to be refitted for each individual dataset. Furthermore, we did not include any genetic context around each promoter. In other words, we evaluated the Standard and the Extended models based only on the actual promoter sequence.</p></sec><sec id="s4-16"><title>Evolution simulations</title><p>We chose 100 random starting sequences of length 115 bp, so that their predicted expression is less than measurable under both the Extended and the Standard model. We implement Gillespie-type simulation under the assumptions of Strong Selection and Weak Mutation, that is, when we can assume no clonal interference. We define the time scale in the units of inverse mutation rate <inline-formula><mml:math id="inf42"><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi mathvariant="normal">μ</mml:mi></mml:math></inline-formula>, so in each iteration of the algorithm we simulate a single mutation that appears and gets fixed in the population with the probability given by the Kimura formula<disp-formula id="equ7"><mml:math id="m7"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>s</mml:mi><mml:mi mathvariant="normal">δ</mml:mi><mml:mi mathvariant="normal">ϕ</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn><mml:mi> </mml:mi><mml:mi>N</mml:mi><mml:mi>s</mml:mi><mml:mi> </mml:mi><mml:mi mathvariant="normal">δ</mml:mi><mml:mi mathvariant="normal">ϕ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>where <italic>N</italic> is the population size, <inline-formula><mml:math id="inf43"><mml:mi mathvariant="normal">δ</mml:mi><mml:mi mathvariant="normal">ϕ</mml:mi></mml:math></inline-formula> is the change in the phenotypic value (gene expression level) due to mutation, and <italic>s</italic> is the selection strength on the phenotype. Note that phenotype and selection are degenerate parameters: only their product represents the actual selection coefficient. We postulate <inline-formula><mml:math id="inf44"><mml:mi mathvariant="normal">ϕ</mml:mi><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> , so the typical mutational effects are in the range of 10<sup>–3</sup> to 10<sup>–2</sup>. Under this regime, selection strength of 100 means a selection coefficient in the range 0.1–1.</p><p>We went through a sufficient number of iterations (new mutation events) until a threshold expression was reached by the population. We considered two thresholds: measurable expression we identified in our experiments to model the emergence of novel (weak) constitutive promoters; and the expression of the wildtype Lambda <italic>P</italic><sub>R</sub> promoter, as an example of a very strong promoter with high constitutive expression levels. For each of the 100 starting sequences, we performed 100 independent evolution runs, to obtain an estimate of the mean exit time (and the associated standard error of the mean) under the Standard and Extended models.</p><p>We also varied the number of nucleotides in the 115-bp-long sequence that were allowed to mutate. The mutagenized region was always in the center of the sequence, over which we always integrated to obtain expression. In simulations with a more constrained region that was allowed to mutate, the simulation would take too long until full convergence. To be robust against these cases, we stopped each simulation after 10N steps, truncating the distributions of evolution times for those sequences. Importantly, doing this introduced a bias that affected the Standard model more so than the Extended (because the Standard model took longer to reach the threshold), leading to an underestimate of how much faster the Extended model is compared to the Standard one. As such, what we report as the increase in the rates of evolution of the Extended model compared to the Standard one is likely the lower bound.</p></sec><sec id="s4-17"><title>Insights from applying the model to the <italic>E. coli</italic> genome</title><p>For all analyses described in this section, we used the <italic>E. coli</italic> K12 MG1655 genome (NCBI reference: NC_000913). Based on the genome annotations, we assigned one of two identities for each of the nucleotide positions in that genome: (i) ‘within genes’ (intragenic) – if the position was a part of the following annotation types: CDS or gene; (ii) inter-genic – if none of the following annotation types were present at the position: misc_feature, mobile_element, repeat_region, tRNA, Sequence Tag Sites (STSs), tmRNA, rRNA, CDS/gene, ncRNA. ‘Within genes’ region accounted for 89.6% of the genome with 51.8% GC content, while ‘inter-genic’ regions formed 9.6% of the genome with the GC content of 41.1%. Because the inter-genic category defined in this way does not guarantee that the sequence actually has a promoter function, we also considered only those sequences that have been experimentally identified as promoters, as found on RegulonDB.</p><p>We calculated binding energy for each of the 5× <italic>G</italic> configurations (five spacer lengths, <italic>G</italic> is the number of positions/base pairs in the genome), and then performed a thermodynamic sum over all spacer lengths for each position aligned so that each configuration coincided with the last base pair of the –10 element of the binding matrix. This way we obtained a free binding energy for each nucleotide (for each of the <italic>G</italic> positions) in the genome. We offset all the obtained free binding energy values such as to set the minimum to zero, in the interest of later easier readability. Surprisingly perhaps, the nearest-neighbor correlation of the free energy values is negligible, so we did not subsample, but kept all values.</p><p>To assess whether there was selection against σ<sup>70</sup>-RNAP binding sites, we constructed a synthetic genome of 100 million base pairs with the same GC content as that region (inter-genic or within-genes) of the <italic>E. coli</italic> genome. We histogram the cumulative distributions, and normalize them to the number of base pairs (inter-genic or within-genes) relevant for the real <italic>E. coli</italic> sequence. For the p-value plot, we calculated the cumulative mass function of the Poisson distribution, at the value of the real histogram, and with mean given by the synthetic histogram value. This corresponded to the one-tailed p-value.</p><p>We also developed an alternative method of evaluating selection against σ<sup>70</sup>-RNAP binding sites, in order to strengthen the validity of our claims. This time, instead of creating a random synthetic genome and comparing the predicted expression levels across that genome using the σ<sup>70</sup>-RNAP energy matrix (<xref ref-type="fig" rid="fig1">Figure 1C</xref>), we created 100 shuffled energy matrices and evaluated free energies of such models across the actual <italic>E. coli</italic> genome. Matrices were permuted <italic>per</italic> position, meaning that the columns of the matrix were shuffled without altering the internal structure of each column. For each such matrix, we evaluated the model at every single position in the <italic>E. coli</italic> matrix and calculated the cumulative histogram, as in the previous paragraph. The p-values were calculated assuming a normal distribution per bin. This is in fact a conservative estimate of the p-value, as for those bins with lower means, Gaussian overestimates the variance and hence the p-value. In the plot we illustrate the 95% confidence interval by showing explicitly the 3rd and the 97th percentile.</p><p>To predict the expression from known <italic>E. coli</italic> promoters, we assigned a free energy to each of the 1951 promoters in RegulonDB by integrating over a symmetric 40 bp region around the reported transcript start. For a fair comparison in plot, we also integrated in the same way over 40 bp chunks of all the inter-genic regions described above (red line in <xref ref-type="fig" rid="fig4">Figure 4F</xref>). For each promoter, we then searched through RegulonDB for all transcription factors that bind it. If all of them were activators, we flagged that promoter as ‘activatable’, and similarly for ‘repressible’. If we found a mixture of activators and repressors affecting a given promoter, we flagged the promoter as ‘dual’. The promoters with no known transcription factor binding were flagged as ‘no info’.</p></sec></sec></body><back><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Investigation, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Formal analysis, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Investigation, Methodology</p></fn><fn fn-type="con" id="con4"><p>Investigation, Writing – review and editing</p></fn><fn fn-type="con" id="con5"><p>Writing – review and editing</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Investigation, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con7"><p>Conceptualization, Formal analysis, Investigation, Writing – review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-64543-transrepform1-v1.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Source data files have been provided for Figures 1 &amp; 3. Code and data has been deposited in GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/szarma/Thermoters">https://github.com/szarma/Thermoters</ext-link> copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:c157c60b04773966e2b4c97f89b928f7f3e80427;origin=https://github.com/szarma/Thermoters;visit=swh:1:snp:631687b2cdfa991df70ffeea0a60f113b924a089;anchor=swh:1:rev:61fe2f54941966469dad801efe06e1c879f27530">swh:1:rev:61fe2f54941966469dad801efe06e1c879f27530</ext-link>.</p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank Hande Acar, Nicholas H Barton, Rok Grah, Tiago Paixao, Maros Pleska, Anna Staron, and Murat Tugrul for insightful comments and input on the manuscript. This work was supported by: Sir Henry Dale Fellowship jointly funded by the Wellcome Trust and the Royal Society (grant number 216779/Z/19/Z) to ML; IPC Grant from IST Austria to ML and SS; European Research Council Funding Programme 7 (2007–2013, grant agreement number 648440) to JPB.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Anzolini Cassiano</surname><given-names>MH</given-names></name><name><surname>Silva-Rocha</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Benchmarking Available Bacterial Promoter Prediction Tools</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.05.05.079335</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beer</surname><given-names>MA</given-names></name><name><surname>Tavazoie</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Predicting gene expression from sequence</article-title><source>Cell</source><volume>117</volume><fpage>185</fpage><lpage>198</lpage><pub-id pub-id-type="doi">10.1016/s0092-8674(04)00304-6</pub-id><pub-id pub-id-type="pmid">15084257</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Belliveau</surname><given-names>NM</given-names></name><name><surname>Barnes</surname><given-names>SL</given-names></name><name><surname>Ireland</surname><given-names>WT</given-names></name><name><surname>Jones</surname><given-names>DL</given-names></name><name><surname>Sweredoski</surname><given-names>MJ</given-names></name><name><surname>Moradian</surname><given-names>A</given-names></name><name><surname>Hess</surname><given-names>S</given-names></name><name><surname>Kinney</surname><given-names>JB</given-names></name><name><surname>Phillips</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Systematic approach for dissecting the molecular mechanisms of transcriptional regulation in bacteria</article-title><source>PNAS</source><volume>115</volume><fpage>E4796</fpage><lpage>E4805</lpage><pub-id pub-id-type="doi">10.1073/pnas.1722055115</pub-id><pub-id pub-id-type="pmid">29728462</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bintu</surname><given-names>L</given-names></name><name><surname>Buchler</surname><given-names>NE</given-names></name><name><surname>Garcia</surname><given-names>HG</given-names></name><name><surname>Gerland</surname><given-names>U</given-names></name><name><surname>Hwa</surname><given-names>T</given-names></name><name><surname>Kondev</surname><given-names>J</given-names></name><name><surname>Phillips</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Transcriptional regulation by the numbers: models</article-title><source>Current Opinion in Genetics &amp; Development</source><volume>15</volume><fpage>116</fpage><lpage>124</lpage><pub-id pub-id-type="doi">10.1016/j.gde.2005.02.007</pub-id><pub-id pub-id-type="pmid">15797194</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brophy</surname><given-names>JAN</given-names></name><name><surname>Voigt</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Antisense transcription as a tool to tune gene expression</article-title><source>Molecular Systems Biology</source><volume>12</volume><elocation-id>854</elocation-id><pub-id pub-id-type="doi">10.15252/msb.20156540</pub-id><pub-id pub-id-type="pmid">26769567</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Byrd</surname><given-names>RH</given-names></name><name><surname>Lu</surname><given-names>P</given-names></name><name><surname>Nocedal</surname><given-names>J</given-names></name><name><surname>Zhu</surname><given-names>C</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>A Limited Memory Algorithm for Bound Constrained Optimization</article-title><source>SIAM Journal on Scientific Computing</source><volume>16</volume><fpage>1190</fpage><lpage>1208</lpage><pub-id pub-id-type="doi">10.1137/0916069</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dill</surname><given-names>KA</given-names></name><name><surname>MacCallum</surname><given-names>JL</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The protein-folding problem, 50 years on</article-title><source>Science</source><volume>338</volume><fpage>1042</fpage><lpage>1046</lpage><pub-id pub-id-type="doi">10.1126/science.1219021</pub-id><pub-id pub-id-type="pmid">23180855</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Einav</surname><given-names>T</given-names></name><name><surname>Phillips</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>How the avidity of polymerase binding to the -35/-10 promoter sites affects gene expression</article-title><source>PNAS</source><volume>116</volume><fpage>13340</fpage><lpage>13345</lpage><pub-id pub-id-type="doi">10.1073/pnas.1905615116</pub-id><pub-id pub-id-type="pmid">31196959</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eren</surname><given-names>AM</given-names></name><name><surname>Vineis</surname><given-names>JH</given-names></name><name><surname>Morrison</surname><given-names>HG</given-names></name><name><surname>Sogin</surname><given-names>ML</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A filtering method to generate high quality short reads using illumina paired-end technology</article-title><source>PLOS ONE</source><volume>8</volume><elocation-id>e66643</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0066643</pub-id><pub-id pub-id-type="pmid">23799126</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Forcier</surname><given-names>TL</given-names></name><name><surname>Ayaz</surname><given-names>A</given-names></name><name><surname>Gill</surname><given-names>MS</given-names></name><name><surname>Jones</surname><given-names>D</given-names></name><name><surname>Phillips</surname><given-names>R</given-names></name><name><surname>Kinney</surname><given-names>JB</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Measuring cis-Regulatory Energetics in Living Cells Using Allelic Manifolds</article-title><source>eLife</source><volume>7</volume><elocation-id>e40618</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.40618</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friedlander</surname><given-names>T</given-names></name><name><surname>Prizak</surname><given-names>R</given-names></name><name><surname>Guet</surname><given-names>CC</given-names></name><name><surname>Barton</surname><given-names>NH</given-names></name><name><surname>Tkačik</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Intrinsic limits to gene regulation by global crosstalk</article-title><source>Nature Communications</source><volume>7</volume><elocation-id>12307</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms12307</pub-id><pub-id pub-id-type="pmid">27489144</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gillespie</surname><given-names>JH</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>Some Properties of Finite Populations Experiencing Strong Selection and Weak Mutation</article-title><source>The American Naturalist</source><volume>121</volume><fpage>691</fpage><lpage>708</lpage><pub-id pub-id-type="doi">10.1086/284095</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hawley</surname><given-names>DK</given-names></name><name><surname>McClure</surname><given-names>WR</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>Compilation and analysis of <italic>Escherichia coli</italic> promoter DNA sequences</article-title><source>Nucleic Acids Research</source><volume>11</volume><fpage>2237</fpage><lpage>2255</lpage><pub-id pub-id-type="doi">10.1093/nar/11.8.2237</pub-id><pub-id pub-id-type="pmid">6344016</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hossain</surname><given-names>A</given-names></name><name><surname>Lopez</surname><given-names>E</given-names></name><name><surname>Halper</surname><given-names>SM</given-names></name><name><surname>Cetnar</surname><given-names>DP</given-names></name><name><surname>Reis</surname><given-names>AC</given-names></name><name><surname>Strickland</surname><given-names>D</given-names></name><name><surname>Klavins</surname><given-names>E</given-names></name><name><surname>Salis</surname><given-names>HM</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Automated design of thousands of nonrepetitive parts for engineering stable genetic systems</article-title><source>Nature Biotechnology</source><volume>38</volume><fpage>1466</fpage><lpage>1475</lpage><pub-id pub-id-type="doi">10.1038/s41587-020-0584-2</pub-id><pub-id pub-id-type="pmid">32661437</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Igler</surname><given-names>C</given-names></name><name><surname>Lagator</surname><given-names>M</given-names></name><name><surname>Tkačik</surname><given-names>G</given-names></name><name><surname>Bollback</surname><given-names>JP</given-names></name><name><surname>Guet</surname><given-names>CC</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Evolutionary potential of transcription factors for gene regulatory rewiring</article-title><source>Nature Ecology &amp; Evolution</source><volume>2</volume><fpage>1633</fpage><lpage>1643</lpage><pub-id pub-id-type="doi">10.1038/s41559-018-0651-y</pub-id><pub-id pub-id-type="pmid">30201966</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jacob</surname><given-names>F</given-names></name><name><surname>Monod</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1961">1961</year><article-title>Genetic regulatory mechanisms in the synthesis of proteins</article-title><source>Journal of Molecular Biology</source><volume>3</volume><fpage>318</fpage><lpage>356</lpage><pub-id pub-id-type="doi">10.1016/s0022-2836(61)80072-7</pub-id><pub-id pub-id-type="pmid">13718526</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johns</surname><given-names>NI</given-names></name><name><surname>Gomes</surname><given-names>ALC</given-names></name><name><surname>Yim</surname><given-names>SS</given-names></name><name><surname>Yang</surname><given-names>A</given-names></name><name><surname>Blazejewski</surname><given-names>T</given-names></name><name><surname>Smillie</surname><given-names>CS</given-names></name><name><surname>Smith</surname><given-names>MB</given-names></name><name><surname>Alm</surname><given-names>EJ</given-names></name><name><surname>Kosuri</surname><given-names>S</given-names></name><name><surname>Wang</surname><given-names>HH</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Metagenomic mining of regulatory elements enables programmable species-selective gene expression</article-title><source>Nature Methods</source><volume>15</volume><fpage>323</fpage><lpage>329</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4633</pub-id><pub-id pub-id-type="pmid">30052624</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kemble</surname><given-names>H</given-names></name><name><surname>Nghe</surname><given-names>P</given-names></name><name><surname>Tenaillon</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Recent Insights Into the Genotype–Phenotype Relationship from Massively Parallel Genetic Assays</article-title><source>Evolutionary Applications</source><volume>8</volume><fpage>312</fpage><lpage>322</lpage><pub-id pub-id-type="doi">10.1111/eva.12846</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>HD</given-names></name><name><surname>Shay</surname><given-names>T</given-names></name><name><surname>O’Shea</surname><given-names>EK</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Transcriptional regulatory circuits: predicting numbers from alphabets</article-title><source>Science</source><volume>325</volume><fpage>429</fpage><lpage>432</lpage><pub-id pub-id-type="doi">10.1126/science.1171347</pub-id><pub-id pub-id-type="pmid">19628860</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kinkhabwala</surname><given-names>A</given-names></name><name><surname>Guet</surname><given-names>CC</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Uncovering cis regulatory codes using synthetic promoter shuffling</article-title><source>PLOS ONE</source><volume>3</volume><elocation-id>e2030</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0002030</pub-id><pub-id pub-id-type="pmid">18446205</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kinney</surname><given-names>JB</given-names></name><name><surname>Murugan</surname><given-names>A</given-names></name><name><surname>Callan</surname><given-names>CGJ</given-names></name><name><surname>Cox</surname><given-names>EC</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Using deep sequencing to characterize the biophysical mechanism of a transcriptional regulatory sequence</article-title><source>PNAS</source><volume>107</volume><fpage>9158</fpage><lpage>9163</lpage><pub-id pub-id-type="doi">10.1073/pnas.1004290107</pub-id><pub-id pub-id-type="pmid">20439748</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kinney</surname><given-names>JB</given-names></name><name><surname>McCandlish</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Massively Parallel Assays and Quantitative Sequence-Function Relationships</article-title><source>Annual Review of Genomics and Human Genetics</source><volume>20</volume><fpage>99</fpage><lpage>127</lpage><pub-id pub-id-type="doi">10.1146/annurev-genom-083118-014845</pub-id><pub-id pub-id-type="pmid">31091417</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuhlman</surname><given-names>B</given-names></name><name><surname>Bradley</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Advances in protein structure prediction and design</article-title><source>Nature Reviews. Molecular Cell Biology</source><volume>20</volume><fpage>681</fpage><lpage>697</lpage><pub-id pub-id-type="doi">10.1038/s41580-019-0163-x</pub-id><pub-id pub-id-type="pmid">31417196</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lässig</surname><given-names>M</given-names></name><name><surname>Mustonen</surname><given-names>V</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Predicting evolution</article-title><source>Nature Ecology &amp; Evolution</source><volume>1</volume><elocation-id>77</elocation-id><pub-id pub-id-type="doi">10.1038/s41559-017-0077</pub-id><pub-id pub-id-type="pmid">28812721</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lehner</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Genotype to phenotype: lessons from model organisms for human genetics</article-title><source>Nature Reviews. Genetics</source><volume>14</volume><fpage>168</fpage><lpage>178</lpage><pub-id pub-id-type="doi">10.1038/nrg3404</pub-id><pub-id pub-id-type="pmid">23358379</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Libbrecht</surname><given-names>MW</given-names></name><name><surname>Noble</surname><given-names>WS</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Machine learning applications in genetics and genomics</article-title><source>Nature Reviews. Genetics</source><volume>16</volume><fpage>321</fpage><lpage>332</lpage><pub-id pub-id-type="doi">10.1038/nrg3920</pub-id><pub-id pub-id-type="pmid">25948244</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lutz</surname><given-names>R</given-names></name><name><surname>Bujard</surname><given-names>H</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Independent and tight regulation of transcriptional units in <italic>Escherichia coli</italic> via the LacR/O, the TetR/O and AraC/I1-I2 regulatory elements</article-title><source>Nucleic Acids Research</source><volume>25</volume><fpage>1203</fpage><lpage>1210</lpage><pub-id pub-id-type="doi">10.1093/nar/25.6.1203</pub-id><pub-id pub-id-type="pmid">9092630</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mohanty</surname><given-names>BK</given-names></name><name><surname>Kushner</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Regulation of mRNA Decay in Bacteria</article-title><source>Annual Review of Microbiology</source><volume>70</volume><fpage>25</fpage><lpage>44</lpage><pub-id pub-id-type="doi">10.1146/annurev-micro-091014-104515</pub-id><pub-id pub-id-type="pmid">27297126</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mustonen</surname><given-names>V</given-names></name><name><surname>Lässig</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Evolutionary population genetics of promoters: predicting binding sites and functional phylogenies</article-title><source>PNAS</source><volume>102</volume><fpage>15936</fpage><lpage>15941</lpage><pub-id pub-id-type="doi">10.1073/pnas.0505537102</pub-id><pub-id pub-id-type="pmid">16236723</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mustonen</surname><given-names>V</given-names></name><name><surname>Kinney</surname><given-names>JB</given-names></name><name><surname>Callan</surname><given-names>CGJ</given-names></name><name><surname>Lässig</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Energy-dependent fitness: a quantitative model for the evolution of yeast transcription factor binding sites</article-title><source>PNAS</source><volume>105</volume><fpage>12376</fpage><lpage>12381</lpage><pub-id pub-id-type="doi">10.1073/pnas.0805909105</pub-id><pub-id pub-id-type="pmid">18723669</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nagai</surname><given-names>T</given-names></name><name><surname>Ibata</surname><given-names>K</given-names></name><name><surname>Park</surname><given-names>ES</given-names></name><name><surname>Kubota</surname><given-names>M</given-names></name><name><surname>Mikoshiba</surname><given-names>K</given-names></name><name><surname>Miyawaki</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>A variant of yellow fluorescent protein with fast and efficient maturation for cell-biological applications</article-title><source>Nature Biotechnology</source><volume>20</volume><fpage>87</fpage><lpage>90</lpage><pub-id pub-id-type="doi">10.1038/nbt0102-87</pub-id><pub-id pub-id-type="pmid">11753368</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Otwinowski</surname><given-names>J</given-names></name><name><surname>Nemenman</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Genotype to phenotype mapping and the fitness landscape of the <italic>E. coli</italic> lac promoter</article-title><source>PLOS ONE</source><volume>8</volume><elocation-id>e61570</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0061570</pub-id><pub-id pub-id-type="pmid">23650500</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ross</surname><given-names>W</given-names></name><name><surname>Gosink</surname><given-names>KK</given-names></name><name><surname>Salomon</surname><given-names>J</given-names></name><name><surname>Igarashi</surname><given-names>K</given-names></name><name><surname>Zou</surname><given-names>C</given-names></name><name><surname>Ishihama</surname><given-names>A</given-names></name><name><surname>Severinov</surname><given-names>K</given-names></name><name><surname>Gourse</surname><given-names>RL</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>A third recognition element in bacterial promoters: DNA binding by the alpha subunit of RNA polymerase</article-title><source>Science</source><volume>262</volume><fpage>1407</fpage><lpage>1413</lpage><pub-id pub-id-type="doi">10.1126/science.8248780</pub-id><pub-id pub-id-type="pmid">8248780</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roy</surname><given-names>S</given-names></name><name><surname>Garges</surname><given-names>S</given-names></name><name><surname>Adhya</surname><given-names>SL</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Activation and repression of transcription by differential contact: two sides of a coin</article-title><source>The Journal of Biological Chemistry</source><volume>273</volume><fpage>14059</fpage><lpage>14062</lpage><pub-id pub-id-type="doi">10.1074/jbc.273.23.14059</pub-id><pub-id pub-id-type="pmid">9603899</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saiz</surname><given-names>L</given-names></name><name><surname>Vilar</surname><given-names>JMG</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Ab initio thermodynamic modeling of distal multisite transcription regulation</article-title><source>Nucleic Acids Research</source><volume>36</volume><fpage>726</fpage><lpage>731</lpage><pub-id pub-id-type="doi">10.1093/nar/gkm1034</pub-id><pub-id pub-id-type="pmid">18056082</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salgado</surname><given-names>H</given-names></name><name><surname>Peralta-Gil</surname><given-names>M</given-names></name><name><surname>Gama-Castro</surname><given-names>S</given-names></name><name><surname>Santos-Zavaleta</surname><given-names>A</given-names></name><name><surname>Muñiz-Rascado</surname><given-names>L</given-names></name><name><surname>García-Sotelo</surname><given-names>JS</given-names></name><name><surname>Weiss</surname><given-names>V</given-names></name><name><surname>Solano-Lira</surname><given-names>H</given-names></name><name><surname>Martínez-Flores</surname><given-names>I</given-names></name><name><surname>Medina-Rivera</surname><given-names>A</given-names></name><name><surname>Salgado-Osorio</surname><given-names>G</given-names></name><name><surname>Alquicira-Hernández</surname><given-names>S</given-names></name><name><surname>Alquicira-Hernández</surname><given-names>K</given-names></name><name><surname>López-Fuentes</surname><given-names>A</given-names></name><name><surname>Porrón-Sotelo</surname><given-names>L</given-names></name><name><surname>Huerta</surname><given-names>AM</given-names></name><name><surname>Bonavides-Martínez</surname><given-names>C</given-names></name><name><surname>Balderas-Martínez</surname><given-names>YI</given-names></name><name><surname>Pannier</surname><given-names>L</given-names></name><name><surname>Olvera</surname><given-names>M</given-names></name><name><surname>Labastida</surname><given-names>A</given-names></name><name><surname>Jiménez-Jacinto</surname><given-names>V</given-names></name><name><surname>Vega-Alvarado</surname><given-names>L</given-names></name><name><surname>Del Moral-Chávez</surname><given-names>V</given-names></name><name><surname>Hernández-Alvarez</surname><given-names>A</given-names></name><name><surname>Morett</surname><given-names>E</given-names></name><name><surname>Collado-Vides</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>RegulonDB v8.0: omics data sets, evolutionary conservation, regulatory phrases, cross-validated gold standards and more</article-title><source>Nucleic Acids Research</source><volume>41</volume><fpage>D203</fpage><lpage>D213</lpage><pub-id pub-id-type="doi">10.1093/nar/gks1201</pub-id><pub-id pub-id-type="pmid">23203884</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sarkisyan</surname><given-names>KS</given-names></name><name><surname>Bolotin</surname><given-names>DA</given-names></name><name><surname>Meer</surname><given-names>MV</given-names></name><name><surname>Usmanova</surname><given-names>DR</given-names></name><name><surname>Mishin</surname><given-names>AS</given-names></name><name><surname>Sharonov</surname><given-names>GV</given-names></name><name><surname>Ivankov</surname><given-names>DN</given-names></name><name><surname>Bozhanova</surname><given-names>NG</given-names></name><name><surname>Baranov</surname><given-names>MS</given-names></name><name><surname>Soylemez</surname><given-names>O</given-names></name><name><surname>Bogatyreva</surname><given-names>NS</given-names></name><name><surname>Vlasov</surname><given-names>PK</given-names></name><name><surname>Egorov</surname><given-names>ES</given-names></name><name><surname>Logacheva</surname><given-names>MD</given-names></name><name><surname>Kondrashov</surname><given-names>AS</given-names></name><name><surname>Chudakov</surname><given-names>DM</given-names></name><name><surname>Putintseva</surname><given-names>EV</given-names></name><name><surname>Mamedov</surname><given-names>IZ</given-names></name><name><surname>Tawfik</surname><given-names>DS</given-names></name><name><surname>Lukyanov</surname><given-names>KA</given-names></name><name><surname>Kondrashov</surname><given-names>FA</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Local fitness landscape of the green fluorescent protein</article-title><source>Nature</source><volume>533</volume><fpage>397</fpage><lpage>401</lpage><pub-id pub-id-type="doi">10.1038/nature17995</pub-id><pub-id pub-id-type="pmid">27193686</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schuster</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Prediction of RNA secondary structures: from theory to models and real molecules</article-title><source>Reports on Progress in Physics</source><volume>69</volume><fpage>1419</fpage><lpage>1477</lpage><pub-id pub-id-type="doi">10.1088/0034-4885/69/5/R04</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Srikumar</surname><given-names>S</given-names></name><name><surname>Kröger</surname><given-names>C</given-names></name><name><surname>Hébrard</surname><given-names>M</given-names></name><name><surname>Colgan</surname><given-names>A</given-names></name><name><surname>Owen</surname><given-names>SV</given-names></name><name><surname>Sivasankaran</surname><given-names>SK</given-names></name><name><surname>Cameron</surname><given-names>ADS</given-names></name><name><surname>Hokamp</surname><given-names>K</given-names></name><name><surname>Hinton</surname><given-names>JCD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>RNA-seq Brings New Insights to the Intra-Macrophage Transcriptome of Salmonella Typhimurium</article-title><source>PLOS Pathogens</source><volume>11</volume><elocation-id>e1005262</elocation-id><pub-id pub-id-type="doi">10.1371/journal.ppat.1005262</pub-id><pub-id pub-id-type="pmid">26561851</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Storz</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Global Transcriptional Start Site Mapping Using Differential RNA</article-title><source>Sequencing Reveals Novel Antisense RNAs in Escherichia coli. Journal of Bacteriology</source><volume>197</volume><fpage>18</fpage><lpage>28</lpage><pub-id pub-id-type="doi">10.1128/JB.02096-14</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tuğrul</surname><given-names>M</given-names></name><name><surname>Paixão</surname><given-names>T</given-names></name><name><surname>Barton</surname><given-names>NH</given-names></name><name><surname>Tkačik</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Dynamics of Transcription Factor Binding Site Evolution</article-title><source>PLOS Genetics</source><volume>11</volume><elocation-id>e1005639</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1005639</pub-id><pub-id pub-id-type="pmid">26545200</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Urtecho</surname><given-names>G</given-names></name><name><surname>Tripp</surname><given-names>AD</given-names></name><name><surname>Insigne</surname><given-names>KD</given-names></name><name><surname>Kim</surname><given-names>H</given-names></name><name><surname>Kosuri</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Systematic Dissection of Sequence Elements Controlling σ70 Promoters Using a Genomically Encoded Multiplexed Reporter Assay in <italic>Escherichia coli</italic></article-title><source>Biochemistry</source><volume>58</volume><fpage>1539</fpage><lpage>1551</lpage><pub-id pub-id-type="doi">10.1021/acs.biochem.7b01069</pub-id><pub-id pub-id-type="pmid">29388765</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vilar</surname><given-names>JMG</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Accurate prediction of gene expression by integration of DNA sequence statistics with detailed modeling of transcription regulation</article-title><source>Biophysical Journal</source><volume>99</volume><fpage>2408</fpage><lpage>2413</lpage><pub-id pub-id-type="doi">10.1016/j.bpj.2010.08.006</pub-id><pub-id pub-id-type="pmid">20959080</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Voordeckers</surname><given-names>K</given-names></name><name><surname>Pougach</surname><given-names>K</given-names></name><name><surname>Verstrepen</surname><given-names>KJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>How do regulatory networks evolve and expand throughout evolution?</article-title><source>Current Opinion in Biotechnology</source><volume>34</volume><fpage>180</fpage><lpage>188</lpage><pub-id pub-id-type="doi">10.1016/j.copbio.2015.02.001</pub-id><pub-id pub-id-type="pmid">25723843</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>L</given-names></name><name><surname>Silander</surname><given-names>OK</given-names></name><name><surname>van Nimwegen</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Expression noise facilitates the evolution of gene regulation</article-title><source>eLife</source><volume>4</volume><elocation-id>987</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.05856</pub-id><pub-id pub-id-type="pmid">26080931</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yi</surname><given-names>X</given-names></name><name><surname>Dean</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Adaptive Landscapes in the Age of Synthetic Biology</article-title><source>Molecular Biology and Evolution</source><volume>36</volume><fpage>890</fpage><lpage>907</lpage><pub-id pub-id-type="doi">10.1093/molbev/msz004</pub-id><pub-id pub-id-type="pmid">30657938</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yona</surname><given-names>AH</given-names></name><name><surname>Alm</surname><given-names>EJ</given-names></name><name><surname>Gore</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Random sequences rapidly evolve into de novo promoters</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>1530</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-04026-w</pub-id><pub-id pub-id-type="pmid">29670097</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zaslaver</surname><given-names>A</given-names></name><name><surname>Bren</surname><given-names>A</given-names></name><name><surname>Ronen</surname><given-names>M</given-names></name><name><surname>Itzkovitz</surname><given-names>S</given-names></name><name><surname>Kikoin</surname><given-names>I</given-names></name><name><surname>Shavit</surname><given-names>S</given-names></name><name><surname>Liebermeister</surname><given-names>W</given-names></name><name><surname>Surette</surname><given-names>MG</given-names></name><name><surname>Alon</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>A comprehensive library of fluorescent transcriptional reporters for <italic>Escherichia coli</italic></article-title><source>Nature Methods</source><volume>3</volume><fpage>623</fpage><lpage>628</lpage><pub-id pub-id-type="doi">10.1038/nmeth895</pub-id><pub-id pub-id-type="pmid">16862137</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.64543.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Krishna</surname><given-names>Sandeep</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>National Centre for Biological Sciences­‐Tata Institute of Fundamental Research</institution><country>India</country></aff></contrib></contrib-group></front-stub><body><p>This paper builds a biophysical model to understand the contribution of the DNA sequence in σ70-RNA polymerase binding activity. The authors provide evidence that taking into account that RNA polymerase can bind in multiple configurations, including non-productive ones, significantly improves predictions. They also confirm and extend previous observations that functional promoter sequences are relatively abundant in random sequences. This work represents an important advance to the field, and will hopefully serve as the stepping stone for better models that include transcription factors and eukaryotic enhancers.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.64543.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Krishna</surname><given-names>Sandeep</given-names></name><role>Reviewing Editor</role><aff><institution>National Centre for Biological Sciences­‐Tata Institute of Fundamental Research</institution><country>India</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>van Nimwegen</surname><given-names>Erik</given-names></name><role>Reviewer</role><aff><institution>University of Basel</institution><country>Switzerland</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Einav</surname><given-names>Tal</given-names></name><role>Reviewer</role><aff><institution>Fred Hutchinson Cancer Research Center</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="box1"><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Predicting Promoter Function and Evolution from Random Sequence&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Aleksandra Walczak as the Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Erik van Nimwegen (Reviewer #3); Tal Einav (Reviewer #4).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>While the reviewers found that the manuscript contains potentially interesting results, as you can see from the reviews appended below, they have many concerns. Most importantly, they are not fully convinced that the model accurately predicts expression levels and would like to see much more analysis of which extensions of the previous thermodynamic models are important for the accuracy of such predictions. They were also concerned that the result that promoters are common among random sequences is not novel and does not warrant the emphasis that the manuscript puts on this result. Therefore, we suggest that in a revised manuscript you:</p><p>(i) focus primarily on the claim that the extensions to the previous thermodynamic model are important for explaining the expression levels from random sequences and real promoters, and show in greater detail how each extension is supported by instances in your dataset;</p><p>(ii) quantify more explicitly the accuracy of predictions from your model following the suggestions of the reviewers, and specifically quantify the importance of the extensions to previous models for predicting the expression levels in your libraries and in native constitutive promoters;</p><p>(iii) test your model on at least one (preferably more) of the additional data sets suggested by Reviewer 4, and provide a clear summary of how your results compare with the data.</p><p>Please do also go through the reviews below and try to address all the additional points raised by the reviewers.</p><p><italic>Reviewer #2:</italic></p><p>This paper builds a biophysical model to understand the contribution of the DNA sequence in σ70-RNA polymerase binding activity. To train their model, which takes into account intra-motif spacing as well as dependencies, they generate large mutant promoter libraries and measure expression from those. The title is a bit too general since the data and model are for a specific constitutive bacteriophage promoter, but nevertheless, the study has novel implications in evolution of gene regulation.</p><p>Lagator et al., have modeled the binding of σ70-RNA polymerase (RNAP) to a constitutive promoter to understand the effect of the promoter sequence in regulating gene-expression. This is a biophysical model that extends the standard thermodynamic model of RNAP binding with its cognate -35 and -10 boxes in several ways: the aim is to account for a variable spacer between the two boxes, binding at non-cognate regions, hindering transcription by binding on the negative strand (opposite orientation), occlusive binding (causing the transcript to begin upstream and not contain the RBS), and relaxing the assumption of independence within the energy matrix by modelling pair-wise nucleotide dependencies. They create three mutant libraries originating from strong λ pR and pL promoters as well as a completely random (25% probability of each nucleotide) set of oligonucleotides to train their model parameters. The model shows an impressive predictive power on a held out set and predicts expression patterns of completely random sequences to a remarkable degree.</p><p>They further conclude that many non-promoter <italic>E. coli</italic> regions are only one bp mutation away from giving rise to measurable expression. They validate their predictions on promoters where the standard model predicts a different expression pattern from their model. The data from their experiments will be a valuable addition to the community in case people want to develop new models or test other hypotheses.</p><p>A few things are unclear:</p><p>1. The thermodynamic model still makes some assumptions which need to be clearly mentioned. The sum suggests there is at the most, a single RNAP molecule (or a binding site at a time) present on each promoter.</p><p>2. The authors learn the models by using multinomial logistic regression (MLR), where the response variable is the median observed expression for each bin (which are four/12 in total, depending on the promoter class). This is a little unusual, since the four expression values are not &quot;categories&quot;, which is typically the expectation in MLR. In other words there is a definite order (or dependence) within the categories, the first bin having a lower expression than the second, etc. That information is lost/unused in MLR.</p><p>3. It is not clear whether there are enough instances of spacer width varying in the mutant pR / pL libraries. If the mutations are single nucleotide changes (not deletions/insertions), would it not be highly unlikely that the library contains instances of the two boxes having different spacing?</p><p>It will be best to mention clearly the assumptions in the cummulative model, mathematically. A more detailed explanation of the sum in equation 2 will be useful. See for example, in the Bintu et al., paper cited in the same section. Similarly, the MLR model should be described with an equation.</p><p>Figure 1 C shows the learned energy matrix. There are other studies which use the standard model to learn their own matrix for RNAP from large mutant libraries. A comparison between the matrices will be useful, even if the promoters are different. In the same vein, this new model can be applied on those data to see if the expression can be better predicted. This will show the generality of the model.</p><p>Does sequence in pR (and pL) contain also the annotated transcription start site (TSS)? Is there any chance that the TSS also gets mutated in their libraries? Since the -10 box is relative to the TSS the distance between the box and TSS is presumably important, which can be defined only with respect to the nucleotide (or a small neighborhood) at the TSS. Does the final energy matrix contain those regions? Figure 1C suggests not.</p><p>I would have expected to see the Y axis of Figure 2B to be stratified across 12 bins. But that is not the case, which means I am missing something.</p><p>Is it not possible that the energy matrix values (those at the two boxes) change with the spacer? I understand that is not allowed in the current model.</p><p>Finally, the contribution of the dinucleotide interactions is not convincing. Perhaps the prediction accuracy on the held out set based on with and without including these terms will help clear that.</p><p><italic>Reviewer #3:</italic></p><p>Lagator et al., extend previous biophysical models to predict gene expression of constitutively expressing <italic>E. coli</italic> promoters from their sequence. They provide evidence that taking into account that RNA-polymerase can bind in multiple configurations, including non-productive ones, significantly improves predictions. They also confirm and extend previous observations that functional promoter sequences are relatively abundant in random sequences.</p><p>The aim of this study is to develop a realistic biophysical model for predicting the expression of (constitutive) <italic>E. coli</italic> promoters from their sequence. From my understanding of the presentation, the main new results that the authors claim are:</p><p>1. They extend existing biophysical models to a more realistic model that takes into account that the spacers between the -35 and -10 sites are flexible, that one should not just focus on the best site in a region but take into account cumulative binding to all possible sites, and that one should also explicitly model that binding to some sites is not productive (e.g. binding to reverse-complemented sites on the opposite strand).</p><p>2. They confirm experimentally that these extensions can indeed have a major impact on expression, for selected promoter sequences.</p><p>3. This biophysical model accurately predicts the gene expression level of any sequence.</p><p>4. They show that a substantial fraction of short random sequences will act as promoters, i.e. drive significant expression.</p><p>5. There is significant evidence for selection against ubiquitous expression, i.e. sigma70 binding sites are depleted both in gene bodies and in intergenic regions.</p><p>In my opinion the strongest parts of the paper are points 1 and 2. The extensions of the 'standard' biophysical model are all very sensible and the model is implemented in a mostly reasonable way. None of the ingredients in the model are particularly novel or surprising, but that's not a bad thing. I do wonder why the authors did not include features such as allowing only one of the two 'feet' of the sigma70 to bind (like in the Einav and Phillips PNAS 2019 paper) or non-specific binding (although maybe the clearing rate that the authors introduce plays a role analogous to non-specific binding). It also was not entirely clear to what extent binding at one site precludes binding at other sites in the model. This could be explained better. But apart from this the model is very reasonable. The only part I am sceptical about is the dinucleotide modeling, which is based on a very ad hoc and rather baroque procedure.</p><p>I particularly liked the experimental confirmations (Figure 1 – supplement 1) that support that several extensions of the model can indeed have a major impact on expression for selected promoter sequences. In my opinion these results should probably have been the main focus of the paper, maybe together with some more rigorous quantification of what role the various extensions play in predicting the expression levels of the random sequences. If, in addition, the authors had provided evidence that these extensions are also important for expression in native constitutive <italic>E. coli</italic> promoters, I think this could have been a very nice paper.</p><p>However, currently the focus seems to be on two aspects that I am much less convinced about. The authors in several places make the claim (point 3 above), that their model accurately predicts expression levels. I do not feel this claim is properly substantiated. First, to give some context, there is a very large body of work going back to the 1980s that aim to predict promoter sequences in <italic>E. coli</italic> directly from sequence, and with just a little bit of googling one will uncover plenty of works in the literature that appear to claim to `solve' this problem, e.g. Cassiano and Silva-Rocha mSystems 2020 present a recent benchmarking of a whole host of promoter prediction tools. I understand that these methods do not specifically aim to predict promoter strength but presumably one could use the 'score' that they calculate as a predictor of promoter strength and it is not clear to me how poorly such predictors would perform in comparison with the model presented here. In addition, there are also several previous papers that specifically claim to successfully predict promoter strength from sequence using either biophysical models close to the ones used here (e.g. Brewster et al., PLoS Comp Biol 2012, Einav and Phillips PNAS 2019) or more general machine learning methods, e.g. Mulligan et al., Nucl Acids Res 1984, Weiler and Wecknagel J Theo Biol 1994, DeMey et al., BMC Biotechnology 2007, Meng et al., Quantitative Biology 2017, and the recent Zhao et al., BioRxiv 2020.06.25.170365. Does the model of the authors significantly improve over these approaches? It is not clear to me. Especially the Einav and Phillips method is curtly dismissed in the discussion, but it is not clear to me whether that model, if trained on this data, would really perform much worse than the current model.</p><p>I understand it is kind of a pain to do extensive comparison with previous methods but in order to make real progress on understanding what determines the expression levels of constitutive <italic>E. coli</italic> promoters, then at a minimum I would have expected a very clear quantification of exactly how well the model performs. What one would want to know is: If I feed the model a random sequence, how accurately does it predict its expression level? Or, how well can the model predict the variation in expression levels of constitutive promoters across the <italic>E. coli</italic> genome? How much accuracy will be lost when various of the extensions are removed, either on native promoters, or on random sequences.</p><p>However, we do not really get such an analysis. The authors only present one scatter and Pearson correlations between the predicted log[Pon] and measured log[expression] for various versions of the model. Crucially, I do not think that a correlation of r<sup>2</sup> ~ 0.75 on a dataset where expression levels vary over a 1000-fold range can be reasonably described as `accurate prediction'. Just as a back-of-the-envelope, if both data and model have a standard-deviation in log-expression levels of about log[100], then r<sup>2</sup> = 0.75 corresponds to the error between model and data having standard-deviation of log[10]. That is, unless I made a mistake in my back-of-the-envelope, the model's predictions would typically be off by 10-fold (and the scatter does seem sort of consistent with this). t is also in line, with the fact that the bins for the P_R data are 10-fold apart in expression level, i.e. the training of the model is done on a dataset in which promoters whose expression levels are within 10-fold of each other are effective treated as equally expressed. I do not think that this level of precision can be called accurate prediction of expression levels. For example, using very similar reporter constructs, the difference in expression of the median and 95th percentile of native <italic>E. coli</italic> promoters is about 20-fold (i.e. see Wolf et al., Figure 1B), so this model could barely tell these apart.</p><p>Another issue is that it is not clear which extensions of the model are the most crucial for the accuracy of the predictions. I was surprised to see (in Figure 2 – source data 1) that, apparently, by far the biggest improvement on the random sequences (36N dataset) comes from including flexible spacers and that cumulative binding and occlusive binding adds rather little. This appears somewhat at odds with the narrative that the authors present in the paper that stresses the importance of cumulative binding.</p><p>In short, although I would like to believe that this reasonable biophysical model improves a lot over previous approaches in the literature, I don't think a convincing case has been made that this is really a major advance in accuracy of promoter strength prediction.</p><p>Finally, regarding points 4 and 5, I do not understand why the authors place so much emphasis on the observation that functional promoters (i.e. sequences that drive gene expression) are common among random sequences, because this is neither novel nor surprising. It has been long-known that the 'position specific weight matrices' that model sigma70 binding sites have low information content, e.g. Schultzaberger et al., Nucl Acids Res 2007 estimate it to be about 6.5 bits. Given this, one would very roughly expect a site every 100 bp in random sequences. In fact, this was one of the reasons why, in Wolf et al., (<italic>eLife</italic> 2015), we were confident that we would easily find a large diversity of functional promoters in a library of random sequences. This expectation was confirmed by our measurements as one can see from Figure 1B of Wolf et al. That is, after selecting the 5% of highest expressing cells from the random library, most of them express at a reasonable level. At the time it didn't even occur to us to mention this as a surprising observation. When the paper of Yona et al., (Nat Comm 2018) appeared, we realized that we misjudged this, and that for many people it WAS surprising that functional promoters are common even in relatively short random sequences. However, now that Yona et al., have an entire paper focused on this observation, including showing depletion of sigma70 sites within gene regions, there is no more novelty to this observation.</p><p>The observations about the frequency of occurrence of promoters in random sequences could have been more interesting if it had been more meaningfully quantified. That is, any sequence will presumably drive expression at some nonzero rate. An interesting (and meaningful) quantitative question is how likely it is that a random sequence drives expression at rate &gt; x, as a function of x. Maybe the authors' data and model could give a reasonable answer to this question. However, instead the authors simply treat this problem as if there is just a binary question whether a promoter is expressing or non-expressing. Moreover, they define the threshold between expressing and non-expressing in a way that is not biologically meaningful but seems determined by instrument precision. I actually had a hard time understanding how precisely 'measurable expression' was defined. My understanding is that, for the P_R and P_L libraries, it is defined as any expression higher than the 99th percentile of measurements for cells carrying no YFP. But how it is defined for the 36N library (with another reporter) was unclear to me. In any case, it appears that 'measurable expression' is defined in terms of the auto-fluorescence level that the cells have in the FACS machine. Unfortunately, this is not a biologically meaningful cut-off. In fact, a substantial fraction of <italic>E. coli</italic> promoters express below the detection limit in the FACS (i.e. not significantly above auto-fluorescence).</p><p>In summary, I think there are some very good ideas in this paper. I in principle like the biophysical model, and the experimental validations of the model's extensions I thought were very nice and, when extended, could make a compelling paper. Unfortunately, the current focus of the papers appears to be on the frequent occurrence of promoters in random sequences (which is not novel) and claims that the model is a major advance in predicting gene expression from sequence, which I do not feel are substantiated by the results presented.</p><p>1. I had real trouble understanding the processing of the 36N dataset. I understand that, because in the 12-bin dataset you sort until you have a certain number of cells in the bin, you need to correct for this when estimating the relative fractions of cells with a given promoter that go to different bins. But I do not understand the approach with the spike-ins. Aren't there, in addition to the spike ins, also an unknown number of reference promoters coming from the sorting?</p><p>2. line 81: &quot;even for constitutive promoters, where σ70-RNAP binding solely determines gene expression levels&quot; Has this really been established? There could be effects of differential binding of topoisomerases that undo supercoiling.. or differential weak binding by other TFs.. and so on. I don't think we really know these levels are solely determined by sigma70-RNAP.</p><p>3. Figure 1 – supplement 1.</p><p>Why is detectability threshold higher in B than in A? I found it generally quite frustrating that it is hard to figure out how exactly this 'measurable expression' threshold, which plays such a crucial role, is defined.</p><p>4. 515-516: Finally, we required the distribution of expression bins to be as unambiguous as possible (Figure 2 —figure supplement 1D,E).</p><p>Why is this done? The way I understand it, this throws out promoters whose expression levels straddle two bins. I guess you want to throw those out because the fitting of the model to only observations in 4 bins only is more accurate when using only promoters that fall sort of in the middle of those bins, but I find this quite unsatisfactory. Would it not have been possible to fit a log-normal to the relative fractions of counts in the different bins and get continuous expression estimates?</p><p>5. 596: &quot;We define 60:20:20% splits of each of our libraries into three disjunct datasets Figure 2 – Source Data 3.&quot;</p><p>Are these splits random? A notorious problem in cross-validation based fitting is when highly correlated datapoints occur in both training and test data. For example, in this case you could have promoters that are virtually identical, and with equal expression, in both training and test datasets. This could lead to misleadingly high performance on the test dataset. I actually doubt this is happening here, but maybe it is worthwhile checking this.</p><p>6. Did you try adding a non-specific binding term to the model? Or the ability for sigma70 to bind through only one of its two feet? If not, why not? Do the authors think sigma70 cannot be bound only at the -10 or -35 sites?</p><p>7. I did not like the way multinomial logistic regression was used to fit the model. Expression should go up monotonically with Pon. It makes no sense to treat the bins as unrelated 'classes'.</p><p>8. Comparing evolution of promoters de novo under the extended model against the 'standard model' is a straw man in my opinion. The standard model is an approximation to the thermodynamic model that is valid when there is one site that dominates the overall affinity of a promoter. I agree that it is often assumed that this is a good approximation for native promoters that have been shaped by selection. But I do not think there is anybody that thinks this is a good model for how promoters appear in random sequences. Obviously weak promoters can then appear anywhere in the sequence.</p><p>9. For Figure 3A, I think it is essential to also predict such a curve for the sequences in each of the libraries and see how well these predicted curves match the observed distributions for these libraries. Otherwise it is hard to judge how meaningful this predicted distribution is.</p><p>10. Many intergenic sequences in <italic>E. coli</italic> will be constrained to have all kinds of TFBSs, precluding sigma70 to occur in those positions. So to check whether there is really depletion of sigma70 sites, comparing with random sequence of the same nucleotide composition is not quite correct in my opinion. First, you should distinguish intergenic regions that are upstream of two operons from those that are upstream of one, and those downstream of two promoters. Those 3 classes of intergenic regions are also known to have different nucleotide composition. The best regions for tests would be downstream regions, and regions that are upstream of an operon that is constitutive.</p><p><italic>Reviewer #4:</italic></p><p>The manuscript by Lagator et al., examines a general framework to predict the constitutive level of gene expression for bacterial DNA, which constitutes one of the most fundamental processes in biology. Whereas previous work has typically been restricted to a limited sampling around a well-studied promoter (such as the lac operon), the authors push towards a model that can characterize all possible sequences, which they support with libraries containing 10,000 mutants each around two strong promoters (PR and PL) as well as a library containing 10,000 random sequences (36N). This work represents an important advance to the field, and will hopefully serve as the stepping stone for better models that include transcription factors and eukaryotic enhancers.</p><p>While the authors provide a clear and compelling story using their impressive data set, the one piece that I felt was missing was a connection with large gene expression data sets from other groups. How robust will their already-trained model be when applied in another context, where the experimental design is somewhat different? This will help other groups understand the potential gain in implementing this model for their own ends, and if any fine-tuning or model adjustments need to be performed, such information would be important to add. To this end, I suggest a few possible data sets below. The authors do not need to analyze all of them (although more is better), and they are welcome to substitute other data sets of their choice:</p><p>1) Hossain 2020 [https://doi.org/10.1038/s41587-020-0584-2] analyzed 4,350 bacterial promoters with a broad range of gene expression measurements varying by 820,000-fold. These promoters should be constitutive, although their random DNA sequences might occasionally give rise to transcription factor binding sites (as in the 36N library). The sequences and read counts are available in their Supplementary Data 3.</p><p>2) Urtecho 2019 [https://doi.org/10.1021/acs.biochem.7b01069] analyzed the constitutive expression from 10,000 promoters. Their setup ensures that no transcription factors are involved, providing a clean test for the model. You can find their expression data at the GEO Accession Number GSE108535 [https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE108535]. The file “GSE108535_sigma70_variant_data.txt.gz” contains the names of promoter variants and the average RNA/DNA expression levels of two biological replicates, while the file “GSE108535_barcode_mapping.txt.gz” contains the name of each promoter variant and its corresponding sequence (where the sequence is specified in the column ‘most_common’). Figure S12 and Table S1 from their supplementary information provide a visual schematic for how to put the pieces together.</p><p>3) Johns 2018 [http://doi.org/10.1038/nmeth.4633] analyzed 30,000 promoters mined from prokaryotic genomes, which would be a very interesting avenue to explore. These promoters may involve transcription factors (although their mining strategy might bias them towards constitutive promoters). Their sequences are given in Supplementary Table 1 and their expression measurements for <italic>E. coli</italic> are provided in Supplementary Table 3.</p><p>I suspect the authors are already planning to do this, but it would be very helpful if a program implementing the fully-trained model was provided (along with some examples of its usage), to help the community utilize these results.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.64543.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>While the reviewers found that the manuscript contains potentially interesting results, as you can see from the reviews appended below, they have many concerns. Most importantly, they are not fully convinced that the model accurately predicts expression levels and would like to see much more analysis of which extensions of the previous thermodynamic models are important for the accuracy of such predictions. They were also concerned that the result that promoters are common among random sequences is not novel and does not warrant the emphasis that the manuscript puts on this result. Therefore, we suggest that in a revised manuscript you:</p><p>(i) focus primarily on the claim that the extensions to the previous thermodynamic model are important for explaining the expression levels from random sequences and real promoters, and show in greater detail how each extension is supported by instances in your dataset;</p><p>(ii) quantify more explicitly the accuracy of predictions from your model following the suggestions of the reviewers, and specifically quantify the importance of the extensions to previous models for predicting the expression levels in your libraries and in native constitutive promoters;</p><p>(iii) test your model on at least one (preferably more) of the additional data sets suggested by Reviewer 4, and provide a clear summary of how your results compare with the data.</p><p>Please do also go through the reviews below and try to address all the additional points raised by the reviewers.</p></disp-quote><p>We thank the Editor and the Reviewers for their comments and suggestions. We have addressed each comment raised by the Reviewers (see below). In particular, we analyzed the performance of our model on three datasets suggested by Reviewer 4, and compared our model performance to that of the models presented in various papers, in order to demonstrate the cross-predictability of our model. We have also expanded on the description of different extensions we added to the existing thermodynamic model, and explored in more detail how each contributed to predictability.</p><p>However, while we appreciate that the Reviewers found the ‘evolutionary’ part of the manuscript less novel, we continue to strongly believe that it constitutes an important contribution to the field. This is because the question of whether expression emerges easily from random sequences is a <italic>quantitative</italic> – not a <italic>qualitative</italic> – one, as we argue below.</p><p>A few previous studies (Wolf, Silander, Nimwegen 2015 and Yona <italic>et al.,</italic> 2018) have shown that random sequences often lead to expression, but have not offered a quantitative understanding of the phenomenon. For example, Yona <italic>et al.,</italic> 2018, used a small dataset of only 40 sequences to show that ~10% of them have promoter activity. The small dataset inherently prevents one from drawing quantitative conclusions about just how likely random sequences are to lead to expression. To obtain a more quantitative understanding of this problem, one could use a standard energy matrix (such as the one obtained by Kinney <italic>et al.,</italic> 2010) over random sequences and identify the likelihood of random sequences leading to expression. This is, in fact, exactly what we did in this study by using the Standard model, which represents a conservative <italic>null</italic> expectation for our studies.</p><p>In contrast to this null expectation, we find that the Extended model, which accounts much better for the experimental data, also predicts a significantly higher likelihood of random sequences leading to expression. This quantitative (as opposed to qualitative) understanding of σ<sup>70</sup>-RNA polymerase binding also allows us to make more precise statements about how promoters evolve from random (and non-random) sequences, allowing us to claim not only that promoter evolve rapidly, but that they evolve <italic>much more</italic> rapidly than previously thought. Similarly, we identified <italic>stronger</italic> selection against σ<sup>70</sup>-RNAP binding sites than was previously thought, as we find evidence of selection against binding sites even within promoter sequences (previous studies have reported selection against binding sites within coding regions only). Importantly, these effects are not small: the fraction of sequences that express above a detectability level is more than double using the Extended compared to Standard model, and the predicted rates of evolution of functional promoters can be faster by orders of magnitude (!) using the Extended compared to the Standard model.</p><p>Put together, our study achieves something unique: it uses a large-scale dataset to develop a model with higher predictability compared to state-of-the-art mechanistic models of gene expression, and then uses that model to improve our quantitative understanding of promoter evolution. In doing that, it points to a potentially huge effect that molecular details of binding of a protein (RNAP) could have on the evolvability of gene expression.</p><p>We have made numerous changes to the text to reflect and better emphasize what is novel, and in particular to emphasize the fact that we predict promoter evolution to be not “just” fast in general, but indeed much <italic>faster</italic> than what the previous state-of-the-art models would predict. We elaborate further on why we think this evolutionary aspect of our study is important in responses to the individual points raised by the Reviewers. The lines referenced in this letter correspond to the revised manuscript document with tracked changes.</p><p>Finally, we would like to apologize to the Editor and the Reviewers for the long time it took us to address all the comments. A combination of the co-authors living in different locations and changing work places (and career paths in some cases), as well as the Covid-19 pandemic introduced substantial delays.</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>This paper builds a biophysical model to understand the contribution of the DNA sequence in σ70-RNA polymerase binding activity. To train their model, which takes into account intra-motif spacing as well as dependencies, they generate large mutant promoter libraries and measure expression from those. The title is a bit too general since the data and model are for a specific constitutive bacteriophage promoter, but nevertheless, the study has novel implications in evolution of gene regulation.</p></disp-quote><p>We thank the Reviewer for the positive assessment of our manuscript. We have amended the title to be more specific, clarifying that we focus on bacterial promoters.</p><disp-quote content-type="editor-comment"><p>Lagator et al., have modeled the binding of σ70-RNA polymerase (RNAP) to a constitutive promoter to understand the effect of the promoter sequence in regulating gene-expression. This is a biophysical model that extends the standard thermodynamic model of RNAP binding with its cognate -35 and -10 boxes in several ways: the aim is to account for a variable spacer between the two boxes, binding at non-cognate regions, hindering transcription by binding on the negative strand (opposite orientation), occlusive binding (causing the transcript to begin upstream and not contain the RBS), and relaxing the assumption of independence within the energy matrix by modelling pair-wise nucleotide dependencies. They create three mutant libraries originating from strong λ pR and pL promoters as well as a completely random (25% probability of each nucleotide) set of oligonucleotides to train their model parameters. The model shows an impressive predictive power on a held out set and predicts expression patterns of completely random sequences to a remarkable degree.</p><p>They further conclude that many non-promoter <italic>E. coli</italic> regions are only one bp mutation away from giving rise to measurable expression. They validate their predictions on promoters where the standard model predicts a different expression pattern from their model. The data from their experiments will be a valuable addition to the community in case people want to develop new models or test other hypotheses.</p><p>A few things are unclear:</p><p>1. The thermodynamic model still makes some assumptions which need to be clearly mentioned. The sum suggests there is at the most, a single RNAP molecule (or a binding site at a time) present on each promoter.</p></disp-quote><p>The Reviewer is correct to point out that our ansatz assumes that only a single RNAP molecule can be present at the promoter at a given time in a productive configuration. Once bound, the RNAP molecule initiates transcription and leaves a promoter faster than another RNAP molecule can find and bind to the promoter. In other words, we assume that RNAP concentration is not high enough for two molecules to be bound to the promoter simultaneously before they initiate transcription and clear the promoter. We explain this assumption in the main text (L117-119) and in the Methods (L804-806).</p><disp-quote content-type="editor-comment"><p>2. The authors learn the models by using multinomial logistic regression (MLR), where the response variable is the median observed expression for each bin (which are four/12 in total, depending on the promoter class). This is a little unusual, since the four expression values are not &quot;categories&quot;, which is typically the expectation in MLR. In other words there is a definite order (or dependence) within the categories, the first bin having a lower expression than the second, etc. That information is lost/unused in MLR.</p></disp-quote><p>We implemented one-vs-rest MLR as a conservative choice, which would allow for a non-monotonic relationship between P_on and gene expression. Ordinal logistic model would force it by definition. In particular, for all the models without the clearance rate, if there were a binding state so strong that the expression is actually lower than for a bit weaker binding, we would be able to detect it (and we were actively looking if any such effect exists; it does not). Despite using MLR, we find a monotonic relationship between P_on and expression, which we took to be one of our internal consistency checks.</p><disp-quote content-type="editor-comment"><p>3. It is not clear whether there are enough instances of spacer width varying in the mutant pR / pL libraries. If the mutations are single nucleotide changes (not deletions/insertions), would it not be highly unlikely that the library contains instances of the two boxes having different spacing?</p></disp-quote><p>We now include a table in Figure 1 —figure supplement 1, as well L496-498, which provides further information about the variability of spacer length variants in our datasets. It is worth noting, however, that the best we can do on fully random sequences is show the spacer for the single strongest binding site in each sequence. The whole premise of the thermodynamic modelling used in this work is that many binding configurations on each sequence can matter. So, while the numbers presented in the figure may appear low e.g. for spacer lengths of -2 and +2, states with those spacers always contribute to P_on; the table simply reports cases where that contribution is the strongest. Note that, when fitting the Extended model, we validate that including spacer lengths of -2 and +2 significantly improves predictability.</p><disp-quote content-type="editor-comment"><p>It will be best to mention clearly the assumptions in the cumulative model, mathematically. A more detailed explanation of the sum in equation 2 will be useful. See for example, in the Bintu et al., paper cited in the same section. Similarly, the MLR model should be described with an equation.</p></disp-quote><p>We thank the Reviewer the suggestion. We have now included a set of summary equations into Figure 1, in order to provide a better explanation for what the model is actually doing. We have also provided equations that describe the MLR model (L712-721).</p><disp-quote content-type="editor-comment"><p>Figure 1 C shows the learned energy matrix. There are other studies which use the standard model to learn their own matrix for RNAP from large mutant libraries. A comparison between the matrices will be useful, even if the promoters are different. In the same vein, this new model can be applied on those data to see if the expression can be better predicted. This will show the generality of the model.</p></disp-quote><p>We have included a comparison of our final energy matrix (obtained by fitting the Extended model on all three datasets) and those obtained by Kinney <italic>et al.,</italic> 2010 (Figure 1 —figure supplement 2; for a visual representation see <xref ref-type="fig" rid="sa2fig1">Author response image 1</xref>). The elements of the two matrices correlate strongly (r<sup>2</sup>=0.83). Note that the Standard model used in this study is, by construction, the same as that used by Kinney <italic>et al.</italic>, meaning that, if we trained our models on their data, we would observe qualitatively the same improvement of the Extended over the Standard model as we observed in the <italic>P<sub>R</sub></italic> library (Figure 3).</p><fig id="sa2fig1" position="float"><label>Author response image 1.</label><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-64543-sa2-fig1-v1.tif"/></fig><disp-quote content-type="editor-comment"><p>Does sequence in pR (and pL) contain also the annotated transcription start site (TSS)? Is there any chance that the TSS also gets mutated in their libraries? Since the -10 box is relative to the TSS the distance between the box and TSS is presumably important, which can be defined only with respect to the nucleotide (or a small neighborhood) at the TSS. Does the final energy matrix contain those regions? Figure 1C suggests not.</p></disp-quote><p>We thank the Reviewer to point out this complex question. On one hand, the original TSS for the <italic>P<sub>R</sub></italic> and <italic>P<sub>L</sub></italic> promoters was not mutated. We clarify this point in the Methods (L456-457). However, we explicitly model for the possibility that RNAP can bind anywhere along the sequence, and some of those binding configurations would have a TSS in the mutated region. We do not model how the changes in the TSS might affect expression levels. However, the fact that the Extended model trained only on the <italic>P<sub>R</sub></italic> library exhibits high predictability on the random sequences (<italic>36N</italic> library) gives us confidence that the effect of mutagenizing the TSS plays a smaller role in determining gene expression levels compared to the binding energy between RNAP and DNA, at least within our sequences.</p><disp-quote content-type="editor-comment"><p>I would have expected to see the Y axis of Figure 2B to be stratified across 12 bins. But that is not the case, which means I am missing something.</p></disp-quote><p>We thank the Reviewer for pointing out this omission in our explanation of Figure 2B (now Figure 3A). For the <italic>36N</italic> library, because we have 12 bins, we could determine the mean expression (rather than using the median bin as we do in the <italic>P<sub>R</sub></italic> library). We now clarify this in the figure legend (L1451-1453).</p><disp-quote content-type="editor-comment"><p>Is it not possible that the energy matrix values (those at the two boxes) change with the spacer? I understand that is not allowed in the current model.</p></disp-quote><p>This is a very good point, and we agree with the Reviewer that energy matrix values might change depending on the spacer length. More broadly, any two (or more) parameters in our model could depend on each other. However, understanding such dependencies in a highly multidimensional space is beyond the scope of our work, except for the dinucleotide interactions which we account for. Specifically, for the question raised by the referee, we expect that we would not have enough data to infer energy matrices reliably conditional on individual spacer lengths. We discuss this in more detail in the Methods section (L794-798).</p><disp-quote content-type="editor-comment"><p>Finally, the contribution of the dinucleotide interactions is not convincing. Perhaps the prediction accuracy on the held out set based on with and without including these terms will help clear that.</p></disp-quote><p>In line with Reviewers’ comment 14, we expanded the text and provided a Figure 2D, which includes detailed information about how each extension to the model (including dinucleotide interactions) individually affects predictability on the held out dataset.</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>Lagator et al., extend previous biophysical models to predict gene expression of constitutively expressing <italic>E. coli</italic> promoters from their sequence. They provide evidence that taking into account that RNA-polymerase can bind in multiple configurations, including non-productive ones, significantly improves predictions. They also confirm and extend previous observations that functional promoter sequences are relatively abundant in random sequences.</p><p>The aim of this study is to develop a realistic biophysical model for predicting the expression of (constitutive) <italic>E. coli</italic> promoters from their sequence. From my understanding of the presentation, the main new results that the authors claim are:</p><p>1. They extend existing biophysical models to a more realistic model that takes into account that the spacers between the -35 and -10 sites are flexible, that one should not just focus on the best site in a region but take into account cumulative binding to all possible sites, and that one should also explicitly model that binding to some sites is not productive (e.g. binding to reverse-complemented sites on the opposite strand).</p><p>2. They confirm experimentally that these extensions can indeed have a major impact on expression, for selected promoter sequences.</p><p>3. This biophysical model accurately predicts the gene expression level of any sequence.</p><p>4. They show that a substantial fraction of short random sequences will act as promoters, i.e. drive significant expression.</p><p>5. There is significant evidence for selection against ubiquitous expression, i.e. sigma70 binding sites are depleted both in gene bodies and in intergenic regions.</p><p>In my opinion the strongest parts of the paper are points 1 and 2. The extensions of the 'standard' biophysical model are all very sensible and the model is implemented in a mostly reasonable way. None of the ingredients in the model are particularly novel or surprising, but that's not a bad thing. I do wonder why the authors did not include features such as allowing only one of the two 'feet' of the sigma70 to bind (like in the Einav and Phillips PNAS 2019 paper) or non-specific binding (although maybe the clearing rate that the authors introduce plays a role analogous to non-specific binding).</p></disp-quote><p>The reviewer has a valid point. Extending the configuration space even further to allow bindings of single feet would indeed be possible, and had we started to work on this model after the Einav and Phillips publication, we would have included it in our model. However, by 2019, we have already had our model fitted and all downstream research completed, and had no indication that the effect from including single feet binding would be large.</p><p>To investigate the potential contribution of this effect at this stage, we split up the effects coming from each of the feet by calculating the free energy of binding of each foot individually across each sequence in our 36N library, and compared it to the binding energy when both feet bind. The <xref ref-type="fig" rid="sa2fig2">Author response image 2</xref> shows the result of such an analysis, where we see that the FVE in the case of both feet binding (right plot) is much larger than the FVE of either of the single feet binding. We report raw, non-weighted r<sup>2</sup>’s, as well as r<sup>2</sup>’s weighted in the same manner as throughout the manuscript, so that the weights of data points in each bin are inversely proportional to the number of sequences that fall in that bin.</p><fig id="sa2fig2" position="float"><label>Author response image 2.</label><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-64543-sa2-fig2-v1.tif"/></fig><p>Our analysis of course does not dismiss the reasonable idea the binding of one foot can individually lead to transcription, nor does it address the possibility of avidity between the binding of two feet (as described by Einav and Phillips), but rather suggests it may have a significant – but maybe not very large – influence, yet comparable to other mechanisms that we included. These results are also consistent with the fact that the energy penalties in the -10 box have a higher mean value than those in the -35 box (2.02 vs 1.61), and hence contribute more to the explanatory power.</p><disp-quote content-type="editor-comment"><p>It also was not entirely clear to what extent binding at one site precludes binding at other sites in the model. This could be explained better.</p></disp-quote><p>Our model assumes that RNAP concentrations are not high enough for two molecules to be bound to the promoter simultaneously before they initiate transcription and clear the promoter; under this assumption the Pon can be written as a sum over single-molecule Boltzmann weights. We do, however, explicitly sum over <italic>all</italic> single-RNAP binding configurations on the piece of DNA that constitutes our promoter; that includes binding in configurations that are productive and the ones that are not (e.g., binding on the reverse complement). The logic here is that, on the productive strand, all bound RNAP molecules are released quickly and move in the same direction. In contrast, the released RNAP on the reverse-complement could clash with the productive RNAP. Formally, if the unproductive binding interferes with the probability of RNAP to bind productively via exclusion, the unproductive terms in the partition sum are still linear order in concentration (as opposed to terms where two RNAP are bound simultaneously, which are quadratic and are thus negligible corrections in the regime we consider). Note that the unproductive binding on the reverse complement has the smallest impact on predictability. We provide further clarification on this in the main text (L117-119) and methods (L804-806).</p><disp-quote content-type="editor-comment"><p>But apart from this the model is very reasonable. The only part I am sceptical about is the dinucleotide modeling, which is based on a very ad hoc and rather baroque procedure.</p></disp-quote><p>We agree with the Reviewer’s assessment that the dinucleotide modelling is not carried out using a clean “textbook” inference procedure that we used for other model extensions. This is because of the extremely large number of possible dinucleotide interactions which we did not manage to learn simultaneously in a robust way even with regularization; each pairwise interaction also adds non-trivial computational time and including dozens of interactions already proved computationally limiting. In turn, we devised a more <italic>ad hoc</italic> method that first effectively performs feature selection by finding significant interactions, after which it attempts to estimate their effect. Our main objective when investigating pairwise interactions was to assess how much they could affect predictability and see whether there is any obvious pattern between interactions that we could identify. First, we found that the effect of dinucleotide interactions on the predictability is fairly limited (Figure 2D). Second, there appears to be an interesting pattern where interactions tend to feature basepairs outside of the canonical -10 and -35 feet, as we mention in the main text.</p><disp-quote content-type="editor-comment"><p>I particularly liked the experimental confirmations (Figure 1 – supplement 1) that support that several extensions of the model can indeed have a major impact on expression for selected promoter sequences. In my opinion these results should probably have been the</p><p>main focus of the paper, maybe together with some more rigorous quantification of what role the various extensions play in predicting the expression levels of the random sequences. If, in addition, the authors had provided evidence that these extensions are also important for expression in native constitutive <italic>E. coli</italic> promoters, I think this could have been a very nice paper.</p></disp-quote><p>We thank the Reviewer for pointing out to us the importance of various extension we included in the model. We now include a new figure (Figure 2) to highlight the experimental confirmations. We quantify their relative impact on predictability in a new table (Figure 2D) and include a brief discussion of this in the main text (L129-137, L226-229).</p><disp-quote content-type="editor-comment"><p>However, currently the focus seems to be on two aspects that I am much less convinced about. The authors in several places make the claim (point 3 above), that their model accurately predicts expression levels. I do not feel this claim is properly substantiated. First, to give some context, there is a very large body of work going back to the 1980s that aim to predict promoter sequences in <italic>E. coli</italic> directly from sequence, and with just a little bit of googling one will uncover plenty of works in the literature that appear to claim to `solve' this problem, e.g. Cassiano and Silva-Rocha mSystems 2020 present a recent benchmarking of a whole host of promoter prediction tools. I understand that these methods do not specifically aim to predict promoter strength but presumably one could use the 'score' that they calculate as a predictor of promoter strength and it is not clear to me how poorly such predictors would perform in comparison with the model presented here. In addition, there are also several previous papers that specifically claim to successfully predict promoter strength from sequence using either biophysical models close to the ones used here (e.g. Brewster et al., PLoS Comp Biol 2012, Einav and Phillips PNAS 2019) or more general machine learning methods, e.g. Mulligan et al., Nucl Acids Res 1984, Weiler and Wecknagel J Theo Biol 1994, DeMey et al., BMC Biotechnology 2007, Meng et al., Quantitative Biology 2017, and the recent Zhao et al., BioRxiv 2020.06.25.170365. Does the model of the authors significantly improve over these approaches? It is not clear to me. Especially the Einav and Phillips method is curtly dismissed in the discussion, but it is not clear to me whether that model, if trained on this data, would really perform much worse than the current model.</p></disp-quote><p>We agree with the Reviewers that we needed to do a better job in demonstrating the predictive power of our model. To this end, we have now analyzed three published datasets – Johns <italic>et al.,</italic> 2018, Urtecho <italic>et al.,</italic> 2019, and Hossain <italic>et al.,</italic> 2020. We selected these datasets because they involved large mutant libraries with 1000s of sequences, and because each of them developed a model to try to predict expression levels directly from sequence. We found that our model led to significant improvements in predictability compared to the models presented by Johns <italic>et al.,</italic> and Hossain <italic>et al.</italic>, while underperforming compared to the machine learning approach used by Urtecho <italic>et al.</italic> It is worth pointing out that this machine learning model is not designed to predict expression from any sequence, as the dataset they based the model on is modular (i.e. they make all possible combinations of pre-set -10, -35, UP element, and spacer sequences). The same applies for the Einav and Phillips 2019 model, which in principle cannot predict expression levels from random sequences because the model is based on the Urtecho <italic>et al.,</italic> dataset. We discuss these findings in the new section of the manuscript (<italic>Testing Model Generalizability</italic> starting at L256).</p><p>We would specifically like to highlight that the tests of our model did <italic>not</italic> include refitting the model to different published data sets, but solely an evaluation of the performance of the already fitted model (with the single parameter readjustment for possibly different RNAP concentrations that was inferred for each data set separately). Given our previous attempts (unpublished) with machine-learning-derived models, such across-dataset generalization (as opposed to within-dataset random splits into training and validation data) is a very powerful test that expressive machine-learning models can easily fail even though they show high within-dataset generalization.</p><p>We also analyzed the Zhao <italic>et al.,</italic> dataset, but identified some issues with the data. In particular, we found that a large fraction of the reported mutations occur in and around the ribosomal binding sites. Our model does not account for the effects of mutations in ribosomal binding sites, resulting in low predictability. For this reason, we decided not to include this analysis in the manuscript, but provide <xref ref-type="fig" rid="sa2fig3">Author response image 3</xref> for your and Reviewers’ reference.</p><fig id="sa2fig3" position="float"><label>Author response image 3.</label><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-64543-sa2-fig3-v1.tif"/></fig><p>We did not analyze any of the other datasets mentioned by the Reviewer above, because all of them contained only a small number of promoters (not more than 100), preventing the authors from developing persuasive models for predicting gene expression levels from sequence.Finally, we did not develop a predictive method based on bioinformatics approaches that aim to identify promoters (as opposed to predict gene expression levels), because these models (as outlined by Cassiano and Silva-Rocha 2020) assume that a promoter has a single dominant RNAP binding site, as well as not accounting for the energy impact of spacer length variability. While constructing a model along these lines would be possible, it would be very labor intensive and would most likely look very similar to the Standard model we used.</p><p>More broadly, we would like to point out – and that we now emphasize much more clearly throughout the manuscript (for example, L89-99, L157-170) – that our study implicitly already compares the performance of the Extended model to various other studies (such as Brewster <italic>et al.,</italic> 2012 and Kinney <italic>et al.,</italic> 2010), through the comparison with the Standard model. The Standard model works under the same assumptions used by all existing mechanistic models aimed at predicting gene expression levels from any sequence (like Brewster <italic>et al.,</italic> 2012 and Kinney <italic>et al.,</italic> 2010). Similarly, it works under the same assumptions as most bioinformatics models for predicting promoters, as they assume that a single RNAP binding site is what defines a promoter. Hence, the comparison between the Extended and the Standard model implicitly already informs about the Extended model performing better than the existing mechanistic approaches. Moreover, the Standard model is given the “best chance” since (i) we fully optimize it on our datasets; (ii) allow it to use a flexible spacer (but with no energy penalty for different spacer lengths); (iii) allow it to use a larger binding footprint than the standard 6+6 basepairs or the matrix by Kinney <italic>et al.</italic> In this sense, any excess performance by the Extended model over Standard model that we report is a conservative estimate for what could be expected if we were to use a previously published mechanistic models with standard features.</p><p>This reasoning, of course, is true only for a comparison with mechanistic approaches. While some machine learning approaches might outperform our model on the specific datasets on which they were trained on, we are not aware of such models that work for any random sequence and generalize well across datasets; in particular, irrespective of their predictive power, such models would lack the mechanistic interpretability that we desired.</p><p>In response to this, and other, Reviewer comments, we have softened our language and removed the use of the subjective term ‘accurate’.</p><disp-quote content-type="editor-comment"><p>I understand it is kind of a pain to do extensive comparison with previous methods but in order to make real progress on understanding what determines the expression levels of constitutive <italic>E. coli</italic> promoters, then at a minimum I would have expected a very clear quantification of exactly how well the model performs. What one would want to know is: If I feed the model a random sequence, how accurately does it predict its expression level? Or, how well can the model predict the variation in expression levels of constitutive promoters across the <italic>E. coli</italic> genome? How much accuracy will be lost when various of the extensions are removed, either on native promoters, or on random sequences.</p></disp-quote><p>We agree with the Reviewer that we should have been clearer and done a more thorough job in validating our model. The Reviewer raises three ways in which we can provide more details and validations of Extended model performance:</p><p>a) “If I feed the model a random sequence, how accurately does it predict expression levels” – we explicitly test this by validating the Extended model on the validation portion of the <italic>36N</italic> library (and now clarify in various locations throughout the manuscript that this is explicitly what we have done).</p><p>b) “How well can the model predict the variation in expression levels of constitutive promoters across the <italic>E. coli</italic> genome” – to this end, we now include a comparison of the Extended model performance on three previously published datasets, and find that the model performs well on all of them (see section <italic>Testing Model Generalizability)</italic>. It is worth noting that this performance was achieve without any fitting of the Extended model to these new datasets (with the exception of chemical potential). We did not examine the performance of our model on constitutive <italic>E. coli</italic> promoters because the existing datasets measuring expression levels of constitutive promoters come from RNA-seq experiments, which are notoriously imprecise.</p><p>c)“How much accuracy will be lost when various of the extensions are removed” – we provide more detail on how each model extension contributes to overall predictability (Figure 3D, L129-137, L217-229).</p><p>In order not to overstate our findings, we toned down the language, especially by minimizing the use of the word ‘accurate predictions’ and instead only talking about ‘predictions’.</p><disp-quote content-type="editor-comment"><p>However, we do not really get such an analysis. The authors only present one scatter and Pearson correlations between the predicted log[Pon] and measured log[expression] for various versions of the model. Crucially, I do not think that a correlation of r<sup>2</sup> ~ 0.75 on a dataset where expression levels vary over a 1000-fold range can be reasonably described as `accurate prediction’. Just as a back-of-the-envelope, if both data and model have a standard-deviation in log-expression levels of about log[100], then r<sup>2</sup> = 0.75 corresponds to the error between model and data having standard-deviation of log[10]. That is, unless I made a mistake in my back-of-the-envelope, the model’s predictions would typically be off by 10-fold (and the scatter does seem sort of consistent with this). T is also in line, with the fact that the bins for the P_R data are 10-fold apart in expression level, i.e. the training of the model is done on a dataset in which promoters whose expression levels are within 10-fold of each other are effective treated as equally expressed. I do not think that this level of precision can be called accurate prediction of expression levels. For example, using very similar reporter constructs, the difference in expression of the median and 95<sup>th</sup> percentile of native <italic>E. coli</italic> promoters is about 20-fold (i.e. see Wolf et al., Figure 1B), so this model could barely tell these apart.</p></disp-quote><p>The reviewer correctly notices that the <italic>P<sub>R</sub></italic> (and <italic>P<sub>L</sub></italic>) datasets consist of wide bins, which encompass sequences potentially 10-fold apart in expression level. Indeed, being able to correctly predict bin identity of a sequence with a 10-fold error should not have been particularly surprising. However – and in part because of that – we also apply the same biophysical model to an independently obtained and more precise dataset (<italic>36N</italic>), where we report higher performance, suggesting that the performance on <italic>P<sub>R</sub></italic> / <italic>P<sub>L</sub></italic> datasets is limited by the measurements themselves. Moreover, even a model fitted only on the <italic>P<sub>R</sub></italic> dataset performs well on the dense and independent <italic>36N</italic> library, indicating that the error of the model predictions themselves cannot be as high as 10-fold. Below, we make the argument more precisely for the <italic>36N</italic> dataset.</p><p>Let V be the variance of the measured log10(expression), and MSE the mean square error of the prediction of the same quantity. The fraction of variance explained (r<sup>2</sup> in the case of a linear fit) is then FVE = 1-MSE/V, so a single theory is evaluated differently depending on the variance of observations V. Our ideal dataset is uniformly sampled across all possible expressions (in particular, the distribution over expressions is not Gaussian), and to approximate that, we introduce weights so that the total weight in each log-equidistant expression bin is equal. For our random library (<italic>36N</italic>) weighted in this way, the variance of log10(expression) V = 1.016. A value of FVE=0.75 yields the MSE of ~0.25, i.e. the error of ~0.5, which corresponds to a 3-fold error in expression. This might not be outstanding, but one should think of it in the context of the 1000-fold dynamic range of measurable expressions that we probe.</p><p>For reference, a uniform distribution of log10(expression) spanning a 1000-fold range has V=0.75; FVE of 0.75 in this case would yield an error of 0.43 for log10(expression), i.e. 2.7-fold for expression; this is close to the calculation for our data, above. The reviewer does the same back-of-the-envelope calculation, assuming standard deviation log10(100), i.e. V=4, thus arriving to a 10-fold error. We agree such a precision would be much less remarkable than what we can report.</p><p>At this point we would like to thank the reviewer for challenging us to think of performance in terms of the errors, rather than r<sup>2</sup>. Consequently, we have included this discussion in the main manuscript (L232-234) in order to explicitly clarify to readers what our r<sup>2</sup> = 0.8 means for individual errors and model accuracy. We make it explicit that it corresponds to a 3-fold error in a dataset spanning expressions from very strong promoters, down to not detectable. Among reported promoters in <italic>E. coli</italic>, which naturally have a narrower range of expression, the same error yields a much lower FVE.</p><disp-quote content-type="editor-comment"><p>Another issue is that it is not clear which extensions of the model are the most crucial for the accuracy of the predictions. I was surprised to see (in Figure 2 – source data 1) that, apparently, by far the biggest improvement on the random sequences (36N dataset) comes from including flexible spacers and that cumulative binding and occlusive binding adds rather little. This appears somewhat at odds with the narrative that the authors present in the paper that stresses the importance of cumulative binding.</p></disp-quote><p>We expanded the discussion of the relative contribution of each extension (L129-137, L217-223), added a new figure to main text (Figure 2, especially panel D) and have also altered the language throughout the manuscript to not insinuate that cumulative binding is more important than other extensions, especially when compared to spacer flexibility. It is worth pointing out that cumulative binding enables multiple spacer length configurations to co-exist within the model, compared to the Standard model which allows only for a single configuration. Hence, the two are intrinsically linked. However, the Reviewer is right to point out that when evaluated individually, spacer flexibility contributes more to overall predictability of our datasets. We see cumulative binding as a necessary basis on which other effects may or may not build upon.</p><p>Importantly, cumulative binding plays a bigger role in determining lower expression levels (see Figure 4 —figure supplement 2). This means that the total r<sup>2</sup> contribution across all sequences could be small while the impact of cumulative binding on weakly expressing sequences is large. Furthermore, cumulative binding has an effect of shifting the mean expression of a random sequence to higher values, with clear evolutionary consequences that we explored in Figure 4. Specifically, the contribution of cumulative binding to low expression levels plays a key role in promoter evolution by providing a greater likelihood of a random mutation leading to an increase in expression, especially when evolving from non-functional sequences (L347-351).</p><disp-quote content-type="editor-comment"><p>In short, although I would like to believe that this reasonable biophysical model improves a lot over previous approaches in the literature, I don't think a convincing case has been made that this is really a major advance in accuracy of promoter strength prediction.</p></disp-quote><p>We hope that the additional analyses included in the revised manuscript persuade the Reviewer that our model either performs better than the existing approaches, provides more mechanistic insights into the functioning of promoters, or both. We have expanded the explanation of the model to include the arguments presented by the Reviewer throughout our revised manuscript.</p><disp-quote content-type="editor-comment"><p>Finally, regarding points 4 and 5, I do not understand why the authors place so much emphasis on the observation that functional promoters (i.e. sequences that drive gene expression) are common among random sequences, because this is neither novel nor surprising. It has been long-known that the 'position specific weight matrices' that model sigma70 binding sites have low information content, e.g. Schultzaberger et al., Nucl Acids Res 2007 estimate it to be about 6.5 bits. Given this, one would very roughly expect a site every 100 bp in random sequences. In fact, this was one of the reasons why, in Wolf et al., (eLife 2015), we were confident that we would easily find a large diversity of functional promoters in a library of random sequences. This expectation was confirmed by our measurements as one can see from Figure 1B of Wolf et al. That is, after selecting the 5% of highest expressing cells from the random library, most of them express at a reasonable level. At the time it didn’t even occur to us to mention this as a surprising observation. When the paper of Yona et al., (Nat Comm 2018) appeared, we realized that we misjudged this, and that for many people it WAS surprising that functional promoters are common even in relatively short random sequences. However, now that Yona et al. have an entire paper focused on this observation, including showing depletion of sigma70 sites within gene regions, there is no more novelty to this observation.</p></disp-quote><p>We appreciate the concerns that the Reviewer has regarding the novelty of the ‘evolutionary’ set of results presented in our manuscript. It is clear that in the original submission we failed to appropriately emphasize the evolutionary relevance of our results.</p><p>First, and most importantly, we specifically compare the predictions about promoter evolution derived from the Extended model to the predictions from the Standard model. This is precisely because the Standard model already captures exactly the assumption that the Reviewer and Yona <italic>et al.,</italic> are talking about – it reflects the standard, textbook view of how bacterial promoters work. Namely, the prediction that you would get roughly 1 RNAP binding site in every 100bp is based on the standard position weight matrices of σ<sup>70</sup>-RNAP and the expression expectation is based on a straightforward view of how binding maps into expression. The Extended model, which captures various additional features of promoter architecture, predicts many more expressive binding configurations <italic>compared to</italic> the Standard model, which shares the assumptions discussed by the Reviewer. We are thus not making a verbal claim about whether there are “a lot” or “a few” expressing sequences among random sequences <italic>per se</italic> (such a qualitative statement is anyway somewhat arbitrary in what is considered “a lot”); rather, we are making a quantitative and comparative statement that the Extended model predicts much more expression from random sequence relative to the Standard model – even if the latter already predicts “a lot”. RNAP binding is more promiscuous than predicted by the Standard model. For quantitative details on how much faster promoter evolution is when predicted with the Extended model, see Figure 4D.</p><p>Second, evolutionary simulations in Figure.4D show further that such differences between the Standard and Extended model can be drastically potentiated by the evolutionary dynamics. Even though we only expect ~3-fold change between Standard and Extended model in the fraction of sequences that measurably express (Figure 4A), this can map into multiple-order-of-magnitude changes in the time-to-evolve under the SSWM evolutionary model. This is because of the multitude of expressing states and evolutionary paths that are available to the Extended model but forbidden to the Standard model. This is most clearly seen when expression has to evolve under constraints (Figure 4D, when only a small region is mutated). This point is not trivial at all: in Tugrul <italic>et al.,</italic> 2015 we showed that the predicted dynamics of evolution of “standard” TF binding sites (with no spacer flexibility and other features of the Extended model) is worryingly slow and difficult to square with the reported estimates for the timescales of regulatory evolution based on comparative genomics studies. There, the authors failed to identify biophysical mechanisms that would enable faster evolution of regulatory sequence. Here, in contrast, starting with data, we see that the particular properties of RNAP binding captured by the Extended model do result in much faster promoter evolution (compared to the Standard model expectation). Therefore, we believe that these results provide a much wider relevance to our work than simply reporting improved predictability due to the inclusion of a host of biophysical mechanisms into the model.</p><p>We have now changed the text in multiple places to reflect and emphasize these points (most substantively in L342-351).</p><p>It is also worth pointing out that we provide a deeper basis for the ‘evolutionary’ findings that we report compared to Yona <italic>et al.,</italic> while also exploring several novel aspects of promoter evolution. For example, we show not only that σ<sup>70</sup>-RNAP sites are selected against in the coding regions (which was shown by Yona <italic>et al.,</italic> as well) but also within <italic>promoter</italic> regions themselves, even when we only use the list of verified promoter sequences from RegulonDB. To us, this seems like a novel finding, that corroborates the promiscuity of RNAP binding under the Extended model. Similarly, it seems relevant to report findings about promoter evolution even if they show the same results as Yona <italic>et al.,</italic> did, because we base our findings on a vastly larger dataset combined with a model capable of actually explaining much of the diversity we observe in that data, as opposed to being based on a sample size of ~40 mutants.</p><p>For all of these reasons, we believe there is substantial novelty in our results. We have changed the manuscript in a variety of places to better emphasize what is novel about our results and to properly explain that the Standard model actually represents the traditional view of promoters (most substantively in L89-99).</p><disp-quote content-type="editor-comment"><p>The observations about the frequency of occurrence of promoters in random sequences could have been more interesting if it had been more meaningfully quantified. That is, any sequence will presumably drive expression at some nonzero rate. An interesting (and meaningful) quantitative question is how likely it is that a random sequence drives expression at rate &gt; x, as a function of x. Maybe the authors' data and model could give a reasonable answer to this question.</p></disp-quote><p>This is a great suggestion and we have now included an additional plot in Figure 4A, which shows the cumulative distribution function (CDF) for the Extended model predictions of expression from random sequences (as well as the CDF for the experimental flow cytometry measurement of the <italic>36N</italic> library). This plot shows the likelihood of finding a random sequence with measurable expression above any set threshold.</p><disp-quote content-type="editor-comment"><p>However, instead the authors simply treat this problem as if there is just a binary question whether a promoter is expressing or non-expressing. Moreover, they define the threshold between expressing and non-expressing in a way that is not biologically meaningful but seems determined by instrument precision. I actually had a hard time understanding how precisely 'measurable expression' was defined. My understanding is that, for the P_R and P_L libraries, it is defined as any expression higher than the 99th percentile of measurements for cells carrying no YFP. But how it is defined for the 36N library (with another reporter) was unclear to me.</p></disp-quote><p>We apologize that our explanation of how we defined ‘measurable expression’ wasn’t clear. The threshold is defined the same way for all three libraries – as the 99<sup>th</sup> percentile of the distribution of fluorescence measurements from cells carrying no fluorescence marker of any sort. The only difference is that in the <italic>36N</italic> library, we include one additional cell sorting gate below the detectability threshold. In modelling, we had to assume that the thermodynamic assumptions behind the model apply the same way to sequences below measurable threshold. We have now clarified these points, both as they relate to experiments and model, in the legends to Figures 3 and 4, as well as the <italic>Sort-seq experiments</italic> section of the Methods (L520-523, L526-528).</p><p>We do appreciate the reviewer’s comment that the simplistic use of the language of whether there is a promoter or not (as opposed to a quantitative distinctions in its strength) is inappropriate, and we have carefully reworded a number of sentences to clarify.</p><disp-quote content-type="editor-comment"><p>In any case, it appears that 'measurable expression' is defined in terms of the auto-fluorescence level that the cells have in the FACS machine. Unfortunately, this is not a biologically meaningful cut-off. In fact, a substantial fraction of <italic>E. coli</italic> promoters express below the detection limit in the FACS (i.e. not significantly above auto-fluorescence).</p></disp-quote><p>We agree with the Reviewer, and have now added a caveat explaining this point in the main text. Specifically, we explain now in the main text that we assume that the energetics of σ<sup>70</sup>-RNAP binding to DNA drive promoter activity below the instrument detectability threshold as they do above it (Figure 3 legend – L1456-1458).</p><disp-quote content-type="editor-comment"><p>In summary, I think there are some very good ideas in this paper. I in principle like the biophysical model, and the experimental validations of the model's extensions I thought were very nice and, when extended, could make a compelling paper. Unfortunately, the current focus of the papers appears to be on the frequent occurrence of promoters in random sequences (which is not novel) and claims that the model is a major advance in predicting gene expression from sequence, which I do not feel are substantiated by the results presented.</p><p>1. I had real trouble understanding the processing of the 36N dataset. I understand that, because in the 12-bin dataset you sort until you have a certain number of cells in the bin, you need to correct for this when estimating the relative fractions of cells with a given promoter that go to different bins. But I do not understand the approach with the spike-ins. Aren't there, in addition to the spike ins, also an unknown number of reference promoters coming from the sorting?</p></disp-quote><p>We understand the Reviewer’s confusion about the spike ins, as we hadn’t explained this procedure well enough in the original submission. Now we clarify in more detail in the Methods (L645-648) how we introduced the spike ins – the spike ins were done using a reference Λ <italic>P<sub>R</sub></italic> promoter, while the plasmid used for cloning the <italic>36N</italic> library (wildtype plasmid) did not carry the Λ <italic>P<sub>R</sub></italic> promoter. Hence, we could easily distinguish between the reference plasmid we added, and the wildtype plasmid that was not cloned properly and was hence not carrying promoter mutations.</p><disp-quote content-type="editor-comment"><p>2. line 81: &quot;even for constitutive promoters, where σ70-RNAP binding solely determines gene expression levels&quot; Has this really been established? There could be effects of differential binding of topoisomerases that undo supercoiling.. or differential weak binding by other TFs.. and so on. I don't think we really know these levels are solely determined by sigma70-RNAP.</p></disp-quote><p>We now discuss in the main text the caveat identified by the Reviewer (L80).</p><disp-quote content-type="editor-comment"><p>3. Figure 1 – supplement 1.</p><p>Why is detectability threshold higher in B than in A? I found it generally quite frustrating that it is hard to figure out how exactly this 'measurable expression' threshold, which plays such a crucial role, is defined.</p></disp-quote><p>We thank the Reviewer for spotting this error. There was a formatting error with the figure which we have now fixed. We have also included an explanation for how ‘measurable expression’ was defined for this specific set of measurements in the legend to Figure 2 (which used to be Figure 1 —figure supplement 1), as it is defined differently for populations measured in a flow cytometer and those measured in a plate reader. Having said that, the logic behind the definition is the same – measurable expression being defined by the fluorescence level of the strain carrying no fluorescence markers.</p><disp-quote content-type="editor-comment"><p>4. 515-516: Finally, we required the distribution of expression bins to be as unambiguous as possible (Figure 2 —figure supplement 1D,E).</p><p>Why is this done? The way I understand it, this throws out promoters whose expression levels straddle two bins. I guess you want to throw those out because the fitting of the model to only observations in 4 bins only is more accurate when using only promoters that fall sort of in the middle of those bins, but I find this quite unsatisfactory. Would it not have been possible to fit a log-normal to the relative fractions of counts in the different bins and get continuous expression estimates?</p></disp-quote><p>By requiring unambiguity, we only meant that we discard sequences with standard deviations larger than 0.5, following with the requirement that the mean, median, and mode of the distribution across bins should point to the same bin. For the P<sub>R</sub> library, the first step reduces the number of sequences from 29020 to 22884, and the second one further to 22769. The same numbers for the P<sub>L</sub> library are 6415, 4239 and 4222. We’ve amended the text to make this fact more explicit (L699-706).</p><p>As for the possibility of using the relative fractions, we opted not to follow that route because of the abundant possibilities for introducing biases during library preparation. From the moment the cells are sorted into their appropriate vials to when we obtain their sequences, they undergo several passages (overnight growth and subsequent dilution) to allow populations to grow large enough numbers so that sequencing is more robust. However, such passaging can introduce a bias in the form of over- or under-representation of a mutant in one bin compared to other surrounding bins. PCR adds further potential for departure from the assumption that the two reads are independent and identically distributed. An additional benefit was that it simplifies the analysis and interpretation. This explanation has now been added to Materials and methods (L596-602).</p><disp-quote content-type="editor-comment"><p>5. 596: &quot;We define 60:20:20% splits of each of our libraries into three disjunct datasets Figure 2 – Source Data 3.&quot;</p><p>Are these splits random? A notorious problem in cross-validation based fitting is when highly correlated datapoints occur in both training and test data. For example, in this case you could have promoters that are virtually identical, and with equal expression, in both training and test datasets. This could lead to misleadingly high performance on the test dataset. I actually doubt this is happening here, but maybe it is worthwhile checking this.</p></disp-quote><p>Due to the nature in which we process our libraries, we are dealing with unique sequences. Namely, we pick each random sequence that appears in the entire sequencing output only once, and use the median bin to represent its fluorescence (in the <italic>P<sub>R</sub></italic> and <italic>P<sub>L</sub></italic> libraries) or the actual mean bin (<italic>36N</italic> library). This sequence then gets assigned either to the testing or training data, but not both; hence, in our dataset, the splits are disjunct by design.</p><p>Sequences in the testing and training sets are correlated (but not identical) in the <italic>P<sub>R</sub></italic> and <italic>P<sub>L</sub></italic> libraries by construction, since all sequences are derived from the same wildtype; sequences are uncorrelated in the 36N library. The fact that our model performs well when tested also on different libraries from the <italic>P<sub>L</sub></italic> on which it was fit should provide strong evidence against any effects that the referee is referring to.</p><p>We clarify this point in more detail in the Methods section <italic>data splits and fitting procedure</italic> (L689-691).</p><disp-quote content-type="editor-comment"><p>6. Did you try adding a non-specific binding term to the model? Or the ability for sigma70 to bind through only one of its two feet? If not, why not? Do the authors think sigma70 cannot be bound only at the -10 or -35 sites?</p></disp-quote><p>To properly address this concern, we need to consider two different scenarios. First, that the binding of σ<sup>70</sup> through only, for example, -10 foot, does not alter in any way its binding preference. In other words, the energy matrix for the -10 foot is the same no matter whether σ<sup>70</sup> is bound only with the -10 foot or with both, -10 and -35 feet. Our model allows for this scenario fully. In fact, our model does not ‘know’ whether the binding occurs predominantly through one foot or the other. All it cares about is the total binding energy, which one can achieve through ‘mix and match’ of positions throughout the entire energy matrix. If, however, this assumption is not true, then the sequence preference of, for example, the -10 foot, would depend on whether and to what extent the -35 foot is bound. To explore for this possibility, we would need to re-fit all model parameters under at least two additional binding configurations – -10 foot bound alone and -35 foot bound alone, and this kind of analysis was beyond the scope of our study. Just to illustrate how much more difficult and time-intensive this task would be, consider that the Einav and Phillips 2020 PNAS paper was entirely dedicated to fitting only this one aspect of polymerase binding, and it did so with only eight -10 and eight -35 variants. We have thousands of sequences variants, which would make this work substantially more complicated. However, it would be very interesting to pursue this line down the road.</p><disp-quote content-type="editor-comment"><p>7. I did not like the way multinomial logistic regression was used to fit the model. Expression should go up monotonically with Pon. It makes no sense to treat the bins as unrelated 'classes'.</p></disp-quote><p>This comment is very similar to that of the Reviewer 1, so here we repeat our response: We implemented one-vs-rest MLR as a conservative choice, which would allow for a non-monotonic relationship between P_on and expression. Ordinal logistic model would force it by definition. In particular, for all the models without the clearance rate, if there were a binding state so strong that the expression is actually lower than for a bit weaker binding, we would be able to detect it (and we were actively looking if any such effect exists; it does not). Despite using MLR, we find a monotonic relationship between P_on and expression, which we took to be one of our internal consistency checks.</p><disp-quote content-type="editor-comment"><p>8. Comparing evolution of promoters de novo under the extended model against the 'standard model' is a straw man in my opinion. The standard model is an approximation to the thermodynamic model that is valid when there is one site that dominates the overall affinity of a promoter. I agree that it is often assumed that this is a good approximation for native promoters that have been shaped by selection. But I do not think there is anybody that thinks this is a good model for how promoters appear in random sequences. Obviously weak promoters can then appear anywhere in the sequence.</p></disp-quote><p>We are glad the Reviewer pointed this lack of clarity in our explanation of how we actually use the Standard model. We do not assume that it has to bind to a specific location in the sequence. In fact, we scan the entire sequence for all possible binding configurations, just like we do with the Extended model, but with the Standard one we then only pick the single strongest binding configuration (as opposed to summing up across all binding configurations like with the Extended model). As such, when simulating promoter evolution, we do not require the Standard model to have a fixed position. Rather, we require it only to have only one binding site, no matter where that site might appear in the sequence. We now clarify this point further in the Legend to Figure 4, as well as the main text (L242-245).</p><disp-quote content-type="editor-comment"><p>9. For Figure 3A, I think it is essential to also predict such a curve for the sequences in each of the libraries and see how well these predicted curves match the observed distributions for these libraries. Otherwise it is hard to judge how meaningful this predicted distribution is.</p></disp-quote><p>We have now predicted the distribution for random sequences using the Extended model and compare it to the experimentally measured distribution of the <italic>36N</italic> library, as shown in Figure 4A.</p><disp-quote content-type="editor-comment"><p>10. Many intergenic sequences in <italic>E. coli</italic> will be constrained to have all kinds of TFBSs, precluding sigma70 to occur in those positions. So to check whether there is really depletion of sigma70 sites, comparing with random sequence of the same nucleotide composition is not quite correct in my opinion. First, you should distinguish intergenic regions that are upstream of two operons from those that are upstream of one, and those downstream of two promoters. Those 3 classes of intergenic regions are also known to have different nucleotide composition. The best regions for tests would be downstream regions, and regions that are upstream of an operon that is constitutive.</p></disp-quote><p>We agree with the Reviewer that the way in which we defined promoters in Figure 4E is neither ideal nor comprehensive. What we wanted to do is check for our hypothesis on the two ends of the spectrum – a relaxed definition of what a promoter is (which is what we used) and a very conservative definition (only experimentally confirmed promoters). Our relaxed definition includes all three ‘classes’ of promoters, including those that are found downstream of operons and hence are unlikely to act as promoters. In order to eliminate all intergenic regions that do not contain a promoter (including all the ‘downstream’ promoters mentioned by the Reviewer), we use the conservative definition that includes only the intergenic regions with known promoter function taken from RegulonDB. We use this conservative definition because we are asking whether there is selection against σ<sup>70</sup>-RNAp binding sites, without discriminating the source of that selection, which can be the existence of one or more transcription factor binding sites and/or selection against having too many σ<sup>70</sup>-RNAp binding sites.</p><p>To supplement our approach, the Reviewer suggested to do the following: to split intergenic regions into three categories and to look for evidence of selection against σ<sup>70</sup>-RNAp binding sites in two of those categories. First is the promoters downstream of operons. These are intergenic regions expected not to have any promoter activity. It is unclear to us how providing evidence of selection against σ<sup>70</sup>-RNAp in such regions would provide novel insights compared to what we already identify by examining selection in coding regions. Furthermore, we already include these regions in our relaxed definition of a promoter in which we demonstrate strong evidence of selection against σ<sup>70</sup>-RNAp binding sites.</p><p>The second set of promoters that the Reviewer suggests to look at, are the upstream regions of a constitutive operon. This definition poses a few technical difficulties for our analysis. First, it is difficult to define a constitutive promoter. Definitions based on experimental evidence are inevitably at the mercy of the specific media conditions used, which in turn define the transcriptome and hence define which promoters might be defined as constitutive. Depending on how many and which environments are tested would therefore give quite a different set of promoters deemed to be constitutive. As carrying out a comprehensive experiment in all possible environments is, obviously, not possible, the best we can do is to look at all promoters reported in RegulonDB or other similar aggregate databases that accumulate information from multiple published sources. ~80% of all σ<sup>70</sup> <italic>E. coli</italic> promoters reported in RegulonDB have at least one associated transcription factor, meaning that following what the Reviewer suggested would result in us analyzing only ~20% of the sequences included in our conservative promoter list. This number of promoters is very low, meaning that we would not have enough statistical power to discern any but the strongest of selections against σ<sup>70</sup>-RNAp. Importantly, we set out to analyze the evidence for selection against σ<sup>70</sup>-RNAp sites, irrespective of the source of that selection, so we consider it important to consider the promoters that bind transcription factors rather than focusing only on constitutive ones.</p><p>We hope that the fact that we found the same evidence for selection against binding sites even within only the known, experimentally confirmed promoters obtained from RegulonDB (Figure 4 —figure supplement 3B) reassures the Reviewer that our findings do hold no matter how we define a promoter. We have added a discussion about the conclusions that can be drawn from our approach with respect to the source of the selection we report (L368-372).</p><disp-quote content-type="editor-comment"><p>Reviewer #4:</p><p>The manuscript by Lagator et al., examines a general framework to predict the constitutive level of gene expression for bacterial DNA, which constitutes one of the most fundamental processes in biology. Whereas previous work has typically been restricted to a limited sampling around a well-studied promoter (such as the lac operon), the authors push towards a model that can characterize all possible sequences, which they support with libraries containing 10,000 mutants each around two strong promoters (PR and PL) as well as a library containing 10,000 random sequences (36N). This work represents an important advance to the field, and will hopefully serve as the stepping stone for better models that include transcription factors and eukaryotic enhancers.</p></disp-quote><p>We thank the Reviewer for the encouraging comments.</p><disp-quote content-type="editor-comment"><p>While the authors provide a clear and compelling story using their impressive data set, the one piece that I felt was missing was a connection with large gene expression data sets from other groups. How robust will their already-trained model be when applied in another context, where the experimental design is somewhat different? This will help other groups understand the potential gain in implementing this model for their own ends, and if any fine-tuning or model adjustments need to be performed, such information would be important to add. To this end, I suggest a few possible data sets below. The authors do not need to analyze all of them (although more is better), and they are welcome to substitute other data sets of their choice:</p><p>1) Hossain 2020 [https://doi.org/10.1038/s41587-020-0584-2] analyzed 4,350 bacterial promoters with a broad range of gene expression measurements varying by 820,000-fold. These promoters should be constitutive, although their random DNA sequences might occasionally give rise to transcription factor binding sites (as in the 36N library). The sequences and read counts are available in their Supplementary Data 3.</p><p>2) Urtecho 2019 [https://doi.org/10.1021/acs.biochem.7b01069] analyzed the constitutive expression from 10,000 promoters. Their setup ensures that no transcription factors are involved, providing a clean test for the model. You can find their expression data at the GEO Accession Number GSE108535 [https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE108535]. The file &quot;GSE108535_sigma70_variant_data.txt.gz&quot; contains the names of promoter variants and the average RNA/DNA expression levels of two biological replicates, while the file &quot;GSE108535_barcode_mapping.txt.gz&quot; contains the name of each promoter variant and its corresponding sequence (where the sequence is specified in the column 'most_common'). Figure S12 and Table S1 from their supplementary information provide a visual schematic for how to put the pieces together.</p><p>3) Johns 2018 [http://doi.org/10.1038/nmeth.4633] analyzed 30,000 promoters mined from prokaryotic genomes, which would be a very interesting avenue to explore. These promoters may involve transcription factors (although their mining strategy might bias them towards constitutive promoters). Their sequences are given in Supplementary Table 1 and their expression measurements for <italic>E. coli</italic> are provided in Supplementary Table 3.</p></disp-quote><p>As suggested by the Reviewer, we have now analyzed the three datasets and evaluated the performance of our model. We did so without any additional fitting (except for the chemical potential, which depends on the strain, growth conditions and other factors influencing the concentration of RNAp inside the cells), and we were very encouraged by the high performance of our model across all three datasets, especially as they were all developed to address very different questions. These datasets were also especially useful as each had a model developed by the respective authors, allowing us to compare our model to their performance. The manuscript now contains a new section discussing these results (<italic>Testing Model Generalizability</italic>).</p><disp-quote content-type="editor-comment"><p>I suspect the authors are already planning to do this, but it would be very helpful if a program implementing the fully-trained model was provided (along with some examples of its usage), to help the community utilize these results.</p></disp-quote><p>The code related to this manuscript has been deposited on github and can be found at https://github.com/szarma/Thermoters.</p></body></sub-article></article>