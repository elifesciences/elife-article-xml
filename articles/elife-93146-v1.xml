<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">93146</article-id><article-id pub-id-type="doi">10.7554/eLife.93146</article-id><article-version article-version-type="publication-state">version of record</article-version><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Microbiology and Infectious Disease</subject></subj-group></article-categories><title-group><article-title>Reversions mask the contribution of adaptive evolution in microbiomes</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Torrillo</surname><given-names>Paul A</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4618-6061</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Lieberman</surname><given-names>Tami D</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5430-3937</contrib-id><email>tami@mit.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/042nb2s44</institution-id><institution>Institute for Medical Engineering and Sciences, Massachusetts Institute of Technology</institution></institution-wrap><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/042nb2s44</institution-id><institution>Department of Civil and Environmental Engineering, Massachusetts Institute of Technology</institution></institution-wrap><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05a0ya142</institution-id><institution>Broad Institute of MIT and Harvard</institution></institution-wrap><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/053r20n13</institution-id><institution>Ragon Institute of MGH, MIT and Harvard</institution></institution-wrap><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Cooper</surname><given-names>Vaughn S</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01an3r305</institution-id><institution>University of Pittsburgh</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Weigel</surname><given-names>Detlef</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0243gzr89</institution-id><institution>Max Planck Institute for Biology Tübingen</institution></institution-wrap><country>Germany</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>06</day><month>09</month><year>2024</year></pub-date><volume>13</volume><elocation-id>e93146</elocation-id><history><date date-type="received" iso-8601-date="2023-09-29"><day>29</day><month>09</month><year>2023</year></date><date date-type="accepted" iso-8601-date="2024-07-30"><day>30</day><month>07</month><year>2024</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at bioRxiv.</event-desc><date date-type="preprint" iso-8601-date="2023-09-17"><day>17</day><month>09</month><year>2023</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.09.14.557751"/></event></pub-history><permissions><copyright-statement>© 2024, Torrillo and Lieberman</copyright-statement><copyright-year>2024</copyright-year><copyright-holder>Torrillo and Lieberman</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-93146-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-93146-figures-v1.pdf"/><abstract><p>When examining bacterial genomes for evidence of past selection, the results depend heavily on the mutational distance between chosen genomes. Even within a bacterial species, genomes separated by larger mutational distances exhibit stronger evidence of purifying selection as assessed by d<sub>N</sub>/d<sub>S</sub>, the normalized ratio of nonsynonymous to synonymous mutations. Here, we show that the classical interpretation of this scale dependence, weak purifying selection, leads to problematic mutation accumulation when applied to available gut microbiome data. We propose an alternative, adaptive reversion model with opposite implications for dynamical intuition and applications of d<sub>N</sub>/d<sub>S</sub>. Reversions that occur and sweep within-host populations are nearly guaranteed in microbiomes due to large population sizes, short generation times, and variable environments. Using analytical and simulation approaches, we show that adaptive reversion can explain the d<sub>N</sub>/d<sub>S</sub> decay given only dozens of locally fluctuating selective pressures, which is realistic in the context of <italic>Bacteroides</italic> genomes. The success of the adaptive reversion model argues for interpreting low values of d<sub>N</sub>/d<sub>S</sub> obtained from long timescales with caution as they may emerge even when adaptive sweeps are frequent. Our work thus inverts the interpretation of an old observation in bacterial evolution, illustrates the potential of mutational reversions to shape genomic landscapes over time, and highlights the importance of studying bacterial genomic evolution on short timescales.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>Bacteroidales</kwd><kwd>human microbiome</kwd><kwd>molecular evolution</kwd><kwd>within-person evolution</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Other</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>1DP2GM140922-01</award-id><principal-award-recipient><name><surname>Lieberman</surname><given-names>Tami D</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100008982</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>Graduate Research Fellowship Program</award-id><principal-award-recipient><name><surname>Torrillo</surname><given-names>Paul A</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>The timescale dependence of d<sub>N</sub>/d<sub>S</sub> in bacteria is better explained by adaptive than purifying dynamics, suggesting comparative genomics can underestimate past adaptation.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Understanding evolutionary pressures acting upon bacterial populations is crucial for predicting the emergence and future virulence of pathogens (<xref ref-type="bibr" rid="bib17">Culyba and Van Tyne, 2021</xref>), modeling strategies to combat antimicrobial resistance (<xref ref-type="bibr" rid="bib20">Davies and Davies, 2010</xref>), and designing genetically modified organisms (<xref ref-type="bibr" rid="bib12">Castle et al., 2021</xref>). Bacteria can adapt at rapid rates due to their short generation times and large population sizes. Indeed, the rapid evolutionary potential of the microbiome has been proposed to assist in the dietary transitions of mammals (<xref ref-type="bibr" rid="bib44">Kolodny and Schulenburg, 2020</xref>). However, the vast majority of possible mutations do not increase bacterial fitness and instead result in a neutral or deleterious effect (<xref ref-type="bibr" rid="bib43">Kimura, 1977</xref>; <xref ref-type="bibr" rid="bib19">Davies et al., 1999</xref>; <xref ref-type="bibr" rid="bib38">Jolley et al., 2000</xref>; <xref ref-type="bibr" rid="bib24">Dingle et al., 2001</xref>). Metrics that estimate the directionality and intensity of past selection at genomic loci of interest have thus become critical tools in modern microbiology and biology more generally.</p><p>The normalized ratio of nonsynonymous (N) to synonymous (S) substitutions, known as d<sub>N</sub>/d<sub>S</sub> or the K<sub>A</sub>/K<sub>S</sub> ratio, is a widely used indicator of past selection (<xref ref-type="bibr" rid="bib39">Jukes and Cantor, 1969</xref>; <xref ref-type="bibr" rid="bib47">Kryazhimskiy and Plotkin, 2008</xref>; <xref ref-type="bibr" rid="bib4">Barber and Elde, 2014</xref>). Nonsynonymous substitutions change the encoded amino acid and thus are considered likely to impact a protein’s function, while synonymous substitutions do not affect the encoded amino acid and are therefore considered effectively neutral, with limited exceptions (<xref ref-type="bibr" rid="bib56">Nowick et al., 2019</xref>). To account for the fact that nonsynonymous mutations are more likely than synonymous mutations based on the genomic code (~3× on average; <xref ref-type="bibr" rid="bib76">Yang and Nielsen, 2000</xref>), the values ‘d<sub>N</sub>’ and ‘d<sub>S</sub>’ normalize mutation counts to available sites on the genome. The d<sub>N</sub>/d<sub>S</sub> ratio therefore summarizes past selection on a genetic sequence, which could be a whole genome, pathway, gene, functional domain, or nucleotide; notably values of d<sub>N</sub>/d<sub>S</sub> averaged genome-wide can obscure signatures of adaptive evolution on other portions of the genome (<xref ref-type="bibr" rid="bib53">Loo et al., 2020</xref>; <xref ref-type="bibr" rid="bib36">Ho et al., 2005</xref>; <xref ref-type="bibr" rid="bib58">Peterson and Masel, 2009</xref>). A d<sub>N</sub>/d<sub>S</sub> ratio of &gt;1 indicates the dominance of past adaptive evolution (i.e., directional selection) while a ratio of &lt;1 traditionally implies past selection against amino acid change (purifying selection).</p><p>Early sequencing work comparing bacterial genomes of the same species reported relatively low d<sub>N</sub>/d<sub>S</sub> values across the whole genome (&lt;0.15) (<xref ref-type="bibr" rid="bib38">Jolley et al., 2000</xref>; <xref ref-type="bibr" rid="bib24">Dingle et al., 2001</xref>). These observations, obtained from comparing distant bacteria within each species, indicated a strong predominance of purifying selection. However, as it became economically feasible to sequence organisms separated by fewer mutations and therefore less evolutionary time, a contrasting pattern emerged in which high d<sub>N</sub>/d<sub>S</sub> values (~1) were found between closely related strains (<xref ref-type="bibr" rid="bib29">Feil et al., 2003</xref>; <xref ref-type="bibr" rid="bib3">Baker et al., 2004</xref>). Recent work in the human microbiome has confirmed such results and furthered the contrast between timescales by finding values of d<sub>N</sub>/d<sub>S</sub> &gt; 1 (<xref ref-type="bibr" rid="bib31">Garud et al., 2019</xref>; <xref ref-type="bibr" rid="bib50">Lieberman et al., 2011</xref>; <xref ref-type="bibr" rid="bib64">Shoemaker et al., 2022</xref>). The timescale dependence of d<sub>N</sub>/d<sub>S</sub> has been mainly attributed to the ongoing action of purifying selection (<xref ref-type="bibr" rid="bib31">Garud et al., 2019</xref>), a model first proposed by <xref ref-type="bibr" rid="bib61">Rocha et al., 2006</xref>. According to this model, weak purifying selection (or locally inactive purifying selection; <xref ref-type="bibr" rid="bib53">Loo et al., 2020</xref>) allows for an initially inflated d<sub>N</sub>/d<sub>S</sub> ratio as deleterious mutations that will eventually be purged remain in the population. As time progresses and purifying selection continuously operates, the d<sub>N</sub>/d<sub>S</sub> ratio decreases (<xref ref-type="bibr" rid="bib53">Loo et al., 2020</xref>; <xref ref-type="bibr" rid="bib31">Garud et al., 2019</xref>; <xref ref-type="bibr" rid="bib61">Rocha et al., 2006</xref>). However, multiple studies have observed genome-wide values of d<sub>N</sub>/d<sub>S</sub> &gt; 1 in these same microbial systems, with values substantially &gt;1 in key genes, which are simply unaccounted for in the purifying model (<xref ref-type="bibr" rid="bib31">Garud et al., 2019</xref>; <xref ref-type="bibr" rid="bib50">Lieberman et al., 2011</xref>; <xref ref-type="bibr" rid="bib54">Marvig et al., 2015</xref>; <xref ref-type="bibr" rid="bib79">Zhao et al., 2019</xref>; <xref ref-type="bibr" rid="bib80">Zhao et al., 2020</xref>).</p><p>Here, we demonstrate fundamental flaws in the purifying selection model in the context of the large within-person population sizes typical to the human microbiome and many bacterial infections (&gt;10<sup>12</sup> bacteria/person). We use analytical, simulation-based, and genomic approaches to support a contrasting model for the timescale dependence of d<sub>N</sub>/d<sub>S</sub>, in which adaptive evolution predominates but is not apparent on long-timescales due to adaptive reversion. The comparative success of the reversion model suggests that the study of closely related bacteria is needed to fully understand evolutionary dynamics.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>A model of purifying selection that fits the data reveals unrealistic parameters</title><p>Explaining the timescale dependence of d<sub>N</sub>/d<sub>S</sub> through an exclusively purifying selection model poses several challenges. Firstly, fitting observed data with purifying selection requires a preponderance of mutations with extraordinarily small effects on fitness (selective coefficients, <italic>s</italic>), which are challenging to eliminate effectively (<xref ref-type="bibr" rid="bib34">Haigh, 1978</xref>). Secondly, the occurrence of an adaptive event during the extensive time required to purge weakly deleterious mutations interrupts the purification of such mutations. Lastly, neutral bottlenecking processes, such as those observed during host-to-host transmission, exacerbate the accumulation of deleterious mutations. For most of this section, we will disregard these last two complications and focus on the problem of small <italic>s</italic>. To provide clarity, we first detail the classic purifying selection model.</p><p>Mutations can be divided into three classes, the first two of which accumulate at a constant rate per unit of time: synonymous mutations (<inline-formula><mml:math id="inf1"><mml:mi>S</mml:mi></mml:math></inline-formula>), neutral nonsynonymous mutations (<inline-formula><mml:math id="inf2"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>), and non-neutral, transient, nonsynonymous mutations (<inline-formula><mml:math id="inf3"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>). We restate the timescale dependence of d<sub>N</sub>/d<sub>S</sub> as the observation that, in a population starting from a single wild type (WT) cell, the average number of non-neutral nonsynonymous mutations per cell in the population (<inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) increases and then asymptotes. Assuming an infinitely large population size and an infinite genome size (to circumvent saturation of mutations), the exclusive purifying selection model (<xref ref-type="bibr" rid="bib31">Garud et al., 2019</xref>; <xref ref-type="bibr" rid="bib61">Rocha et al., 2006</xref>) can thus be written as<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mover><mml:mi>S</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>and<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf5"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the non-neutral mutation rate per core genome per generation, <inline-formula><mml:math id="inf6"><mml:mi>s</mml:mi></mml:math></inline-formula> is the selective disadvantage of a non-neutral nonsynonymous mutation (or the harmonic mean of such mutations; see Appendix 1, Section 1.1), and <inline-formula><mml:math id="inf7"><mml:mi>t</mml:mi></mml:math></inline-formula> is the number of generations. The 3 in the denominator of <xref ref-type="disp-formula" rid="equ1">Equation 1</xref> accounts for the discrepancy in the number of potential nonsynonymous and synonymous sites (<xref ref-type="bibr" rid="bib76">Yang and Nielsen, 2000</xref>). We solve for <inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> by assuming <inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> to obtain:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>s</mml:mi></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We further simplify and combine these equations to create an equation for d<sub>N</sub>/d<sub>S</sub> with only two parameters as previously done (<xref ref-type="bibr" rid="bib31">Garud et al., 2019</xref>). First, since d<sub>N</sub>/d<sub>S</sub> plateaus with time (<xref ref-type="fig" rid="fig1">Figure 1a</xref>), we have <inline-formula><mml:math id="inf10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mover><mml:mi>S</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>3</mml:mn><mml:mover><mml:mi>S</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Conveniently, <inline-formula><mml:math id="inf11"><mml:mi>α</mml:mi></mml:math></inline-formula> represents both the asymptote of d<sub>N</sub><italic>/</italic>d<sub>S</sub> and the proportion of nonsynonymous mutations that are neutral. This allows us to leave only <inline-formula><mml:math id="inf12"><mml:mi>s</mml:mi></mml:math></inline-formula> as the other free parameter, obtaining (see Appendix 1, Section 1.1)<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>The previously proposed explanation for the time dependence of d<sub>N</sub>/d<sub>S</sub> is weak purifying selection.</title><p>(<bold>a</bold>) Time signature of d<sub>N</sub>/d<sub>S</sub> as depicted by data points derived from the studies by <xref ref-type="bibr" rid="bib31">Garud et al., 2019</xref> and <xref ref-type="bibr" rid="bib79">Zhao et al., 2019</xref>. Each dot represents a pairwise comparison between the consensus sequence from two gut microbiomes as computed by <xref ref-type="bibr" rid="bib31">Garud et al., 2019</xref>, using only the top 10 species based on the quality of data points (see ‘Methods’). Where the high initial value of d<sub>N</sub>/d<sub>S</sub> begins to become the low asymptotic value of d<sub>N</sub>/d<sub>S</sub> occurs at approximately <inline-formula><mml:math id="inf13"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula>. Fit lines were derived from these points using <xref ref-type="disp-formula" rid="equ4">Equation 4</xref> to depict the trend. The median <italic>R</italic><sup>2</sup> is 0.81 (range 0.54–0.94). Corresponding data from <xref ref-type="bibr" rid="bib79">Zhao et al., 2019</xref> confirms these observed trends, demonstrating high levels of d<sub>N</sub>/d<sub>S</sub> at short timescales and low levels at longer timescales. Adaptive genes are from <xref ref-type="bibr" rid="bib79">Zhao et al., 2019</xref> and are defined as those that have high d<sub>N</sub>/d<sub>S</sub> values in multiple lineages. Insets<italic>:</italic> d<sub>N</sub> vs. d<sub>S</sub> on a linear scale. Note that the data was fit to minimize variance in the logarithmic scale, not the linear scale, so the fit is not expected to be as good for the inset. See <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> for minimizing variance on a linear scale. See <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref> for all species on separate panels. (<bold>b</bold>) Values of <italic>s</italic> from the output of 999 standard bootstrap iterations of curve fitting, conducted with replacement, demonstrate that only small values of the average selective coefficient can fit the data.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93146-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>The purifying selection model predicts even weaker purifying selection when fitting to nonlogarithmic d<sub>N</sub>/d<sub>S</sub>.</title><p>Equivalent to <xref ref-type="fig" rid="fig1">Figure 1</xref>, except the fit is determined by minimizing variance in d<sub>N</sub>/d<sub>S</sub> rather than logarithmic d<sub>N</sub>/d<sub>S</sub>. In this fit, <italic>s</italic> values tend to be even smaller, with a median of 2.0 × 10<sup>-5</sup>. The median <italic>R</italic><sup>2</sup> = 0.64 (range 0.07–0.88).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93146-fig1-figsupp1-v1.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>Purifying selection model fits by individual species.</title><p>Content of <xref ref-type="fig" rid="fig1">Figure 1a</xref>, with each species given its own panel. One species of note is <italic>B. caccae</italic>, which appears to have substantial initial d<sub>N</sub>/d<sub>S</sub> values &gt;1, at odds with a purifying selection model. Fits for <italic>s</italic>, with uncertainty, are given in <xref ref-type="fig" rid="fig1">Figure 1b</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93146-fig1-figsupp2-v1.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 3.</label><caption><title>Larger selective coefficients rapidly lose explanatory power.</title><p>Here, we use <xref ref-type="disp-formula" rid="equ4">Equation 4</xref> to once again fit the data. We still use <inline-formula><mml:math id="inf14"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:math></inline-formula> but use alternate values of <italic>s</italic>. We see that significantly larger, though still relatively small, levels of purifying selection have essentially no ability to explain the data. <inline-formula><mml:math id="inf15"><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> is for minimizing the logarithmic variance.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93146-fig1-figsupp3-v1.tif"/></fig></fig-group><p>As sequence analysis is not privy to the actual number of generations, we approximate <inline-formula><mml:math id="inf16"><mml:mi>t</mml:mi></mml:math></inline-formula> assuming that synonymous mutations accumulate according to a molecular clock <inline-formula><mml:math id="inf17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, where μ is the mutation rate per generation per base pair, ¼ represents the proportion of random mutations that are synonymous (<xref ref-type="bibr" rid="bib76">Yang and Nielsen, 2000</xref>), and 2 accounts for the fact that divergence is a measure between a pair of genomes. As selection and mutation are both in units per time, any change in μ results in a corresponding change in <italic>s</italic>. Both model fits and consequences are largely dependent on the ratio of these two variables (more on this below), and thus are not sensitive to the choice of μ. We use a relatively high mutation rate of 10<sup>-9</sup> per base pair per generation (<xref ref-type="bibr" rid="bib25">Drake, 1991</xref>; <xref ref-type="bibr" rid="bib6">Barrick and Lenski, 2013</xref>) as lower rate would imply even weaker purifying selection.</p><p>Fitting the data from <xref ref-type="bibr" rid="bib31">Garud et al., 2019</xref>, we infer median values of α ≈ 0.10 (0.09–0.14) and s ≈ 3.5 × 10<sup>-5</sup> (2.6 × 10<sup>-5</sup>-6.5 × 10<sup>–5</sup>) across all species (‘Methods’, <xref ref-type="fig" rid="fig1">Figure 1a</xref>). Aggregating all of the data at once results in a similar optimal fit of α ≈ 0.11 and s ≈ 2.8 × 10<sup>–5</sup>. The similarity across the 10 species is perhaps not surprising, given that all are human gut residents of the order <italic>Bacteroidales</italic>; these values are also in line with the values obtained previously from aggregating across all species (<xref ref-type="bibr" rid="bib31">Garud et al., 2019</xref>). These values indicate a model in which only ~10% of nonsynonymous mutations are neutral and the remaining ~90% are so weakly deleterious that they are beyond the limit of detection of any experimental method to date (<italic>s</italic> ≳ 10<sup>–3</sup>) (<xref ref-type="bibr" rid="bib30">Gallet et al., 2012</xref>). Higher values of <italic>s</italic> that better reflect experimental observations (<xref ref-type="bibr" rid="bib42">Kibota and Lynch, 1996</xref>; <xref ref-type="bibr" rid="bib73">Trindade et al., 2010</xref>; <xref ref-type="bibr" rid="bib60">Robert et al., 2018</xref>) result in poor fits to the data (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>). While the implied proportion of deleterious mutations may seem high, deep mutational scanning experiments have revealed that most amino acid-changing mutations in essential genes are deleterious enough to be measured in the lab (<xref ref-type="bibr" rid="bib40">Kelsic et al., 2016</xref>; <xref ref-type="bibr" rid="bib23">Dewachter et al., 2023</xref>); complex real-world environments are expected to constrain an even larger fraction of the genome.</p><p>In finite populations, the presence of so many weakly deleterious mutations becomes quickly problematic. When <italic>s</italic> is smaller than <inline-formula><mml:math id="inf18"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, organisms without any deleterious mutations (or with the fewest number of deleterious mutations, the ‘least-loaded class’; <xref ref-type="bibr" rid="bib34">Haigh, 1978</xref>) can be easily lost from a finite population before they outcompete less fit organisms and fitness decay begins to occur. The likelihood of loss depends on the population size and mutation-selection balance (<inline-formula><mml:math id="inf19"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>s</mml:mi></mml:math></inline-formula>), a parameter that estimates the average number of deleterious mutations per cell relative to the least-loaded class. Given a core genome of <italic>L</italic> = 1.5 ×10<sup>6</sup> bp that can acquire deleterious mutations, we then expect 0.001 new deleterious mutations per genome per generation (<inline-formula><mml:math id="inf20"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo><mml:mi>L</mml:mi><mml:mi>μ</mml:mi></mml:math></inline-formula>). Thus, the value of <inline-formula><mml:math id="inf21"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>s</mml:mi></mml:math></inline-formula> for the above fits is ~29, indicating that most cells in the population contain dozens of deleterious mutations (see Appendix 1, Section 1.2). With this value of the mutation-selection balance parameter, the frequency of mutation-free organisms in a population is extremely small, even for a population that starts without any deleterious mutations (&lt;10<sup>–12</sup> after 100,000 generations). If the flexible genome also contains deleterious mutations, the least-loaded class is pushed down even further. Simulations substantiate this prediction of mutation accumulation and decrease in frequency of the wild type (<xref ref-type="fig" rid="fig2">Figure 2a</xref>, ‘Methods’).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Models of extremely weak purifying selection that can fit the data suffer from mutation accumulation and fitness decay.</title><p>(<bold>a</bold>) The temporal dynamics of the least-loaded class in a large population under the purifying selection model. The black line represents the predicted frequency of the wild-type (mutation-free) class over time. The simulation curve shows simulation results assuming constant purifying selection in an exceptionally large effective population size (N<sub>e</sub> = 10<sup>18</sup>; see text for a discussion of population size) under a slightly modified Wright–Fisher model (‘Methods’). (<bold>b</bold>) As a consequence of the loss of the least-loaded class, fitness declines in finite populations over time. Colored lines indicate simulations from various effective population sizes with mutations of constant selective effect. The deleterious mutation rate in the simulation is 1.01 × 10<sup>−3</sup> per genome per generation. (<bold>c</bold>) Using the same simulations as in panel (<bold>b</bold>), we see that realistic global effective population sizes fail to fit the d<sub>N</sub>/d<sub>S</sub> curve, with different asymptotes. The black line denotes the infinite population theoretical model, and the colored lines indicate increasing effective population sizes, which change the strength of genetic drift in the simulations. Larger values of <italic>s</italic> and models in which all mutations are deleterious cannot fit the data (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). Generations are assumed to occur once every day.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93146-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Larger selective coefficients that can prevent mutation accumulation in simulations lead to less optimal data fit.</title><p>We first calculate the smallest possible <italic>s</italic> values (as estimated from <xref ref-type="disp-formula" rid="equ5">Equation 5</xref>) that will not lead to mutation accumulation for a given effective population size and the corresponding fits. The core genome size is assumed to be 1,500,000 nucleotides. Once again, we use <xref ref-type="disp-formula" rid="equ4">Equation 4</xref> to fit the data and use <inline-formula><mml:math id="inf22"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93146-fig2-figsupp1-v1.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Even assuming all mutations are deleterious suggests a higher asymptotic d<sub>N</sub>/d<sub>S</sub>.</title><p>A purifying selection simulation as in <xref ref-type="fig" rid="fig2">Figure 2</xref>, except that all mutations are assumed to be weakly deleterious (<italic>s</italic> = 3.5 × 10<sup>-5</sup>) rather than just 90%. In other words, rather than the standard deleterious mutation rate of 1.01 × 10<sup>-3</sup> mutations per genome per generation, the mutation rate is now 1.13 × 10<sup>-3</sup> mutations per genome per generation. With an effective population size of 10<sup>9</sup>, mutations still occur so quickly as to raise the asymptote above the data. Furthermore, all of these mutations contributing to the asymptotic d<sub>N</sub>/d<sub>S</sub> are deleterious rather than neutral, furthering the problem of Muller’s ratchet.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93146-fig2-figsupp2-v1.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>High rates of recombination are unlikely to rescue a model of weak purifying selection.</title><p>A purifying selection simulation with a population of 10<sup>9</sup> with and without recombination. To simulate the potential for recombination to purge deleterious mutations, we assume a 2.5 × 10<sup>-7</sup> chance per codon per generation of return to the ancestral state (500 times the basal mutation rate, dotted blue line), which brings alongside it a linked synonymous mutation. This would represent recombination bringing in fragments of 100 bp in length from a genome with d<sub>S</sub> = 0.01. All other assumptions are the same as the continuous selection simulations in <xref ref-type="fig" rid="fig2">Figure 2</xref>. While recombination does allow more fit genotypes to arise, their selective advantage is quite small, and time to sweep is still slower than mutation accumulation. Recombination is more effective at purging deleterious alleles when many deleterious mutations are present, but this occurs at a longer timescale than the actual drop off of d<sub>N</sub>/d<sub>S</sub> values. We also include a variant where recombination events revert deleterious mutations without linked synonymous mutations. In this model, we have only included recombination events that revert deleterious mutations and chosen not to explicitly model cases of neutral recombination. High levels of neutral recombination with distant organisms would result in closely related organisms having d<sub>N</sub>/d<sub>S</sub> significantly less than 1 and would not fit the data without significant adaptation.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93146-fig2-figsupp3-v1.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 4.</label><caption><title>Transmission bottlenecks and adaptation further complicate purifying selection.</title><p>Results of a simulation with purifying selection that takes into account transmission bottlenecks and the possibility of adaptation. The simulation is meant to represent a potential transmission chain from gut to gut. This simulation is a modified version of the simulation used for the reversion model (see ‘Methods’). Only forward mutations are available when beneficial mutations arrive (<inline-formula><mml:math id="inf23"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.03</mml:mn></mml:math></inline-formula>) and deleterious mutations arrive at a rate of 1.01 × 10<sup>-3</sup> mutations per genome with a selective disadvantage of <italic>s</italic> = 3.5 × 10<sup>-5</sup>. The census size in an individual gut is 10<sup>10</sup>. We choose very conservative values for adaptation rate, bottleneck size, and bottleneck frequency to show how even small levels of these dynamics strongly influence results. Transmission bottlenecks happen on average every 100,000 generations. The population is bottlenecked to 1000 members upon transmission. Beneficial selective pressures are released on average every 8400 generations. Multiple beneficial pressures can occur together (the number released at a time is a Poisson random variable of mean 1). This rate of beneficial mutation does not contribute much to d<sub>N</sub>/d<sub>S</sub> on its own as seen from the dotted line where adaptations are excluded in the d<sub>N</sub>/d<sub>S</sub> calculation. However, both of these scenarios drastically increase the rate of mutation accumulation and the asymptotic d<sub>N</sub>/d<sub>S</sub>. The reversion model can prevent this from occurring with 10 times the amount of adaptation and transmission.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93146-fig2-figsupp4-v1.tif"/></fig></fig-group><p>The time until the least-loaded class is completely lost from the population depends on the strength of genetic drift. The strength of genetic drift is inversely proportional to population size in well-mixed populations (<xref ref-type="bibr" rid="bib33">Gillespie, 2004</xref>), and in less well-mixed or otherwise nonideal populations, is inversely proportional to a smaller parameter, the effective population size, <italic>N</italic><sub><italic>e</italic></sub>. <italic>N</italic><sub><italic>e</italic></sub> is often estimated by assessing polymorphisms in a population (<xref ref-type="bibr" rid="bib33">Gillespie, 2004</xref>) but is hard to estimate from data following a recent bottleneck. Because each individual’s gut microbiome is thought to be well mixed (census size = 10<sup>13</sup>) (<xref ref-type="bibr" rid="bib63">Sender et al., 2016</xref>), it has been recently argued that <italic>N</italic><sub><italic>e</italic></sub> ≈ 10<sup>11</sup> reflects drift processes for dominant gut species (<xref ref-type="bibr" rid="bib32">Ghosh and Good, 2022</xref>; <xref ref-type="bibr" rid="bib48">Labavić et al., 2022</xref>). On the other hand, lower values of <italic>N</italic><sub><italic>e</italic></sub> ≈ 10<sup>9</sup> or less have been estimated for global populations of bacteria (<xref ref-type="bibr" rid="bib8">Bobay and Ochman, 2018</xref>) because of the slow rates of bacterial transmission across people. While this decrease in <italic>N</italic><sub><italic>e</italic></sub> when increasing scales may seem paradoxical, we note this use of <italic>N</italic><sub><italic>e</italic></sub> only reflects the magnitude of the force of drift; for other calculations in nonideal populations, census population size or other parameters should be used.</p><p>Without extremely large values of <italic>N</italic><sub><italic>e</italic></sub>, the least-loaded class will be lost recurrently, rapidly lowering the fitness of the population (i.e., Muller’s ratchet; <xref ref-type="bibr" rid="bib34">Haigh, 1978</xref>). Assuming <inline-formula><mml:math id="inf24"><mml:mi>s</mml:mi></mml:math></inline-formula> is small and thus approximately additive, this recurrent process of fitness decay occurs roughly when the following inequality is satisfied (see Appendix 1, Section 1.2; <xref ref-type="bibr" rid="bib55">Neher and Shraiman, 2012</xref>):<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mn>2</mml:mn><mml:mi>s</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mi>s</mml:mi></mml:mfrac></mml:mrow></mml:msup><mml:mo>&lt;&lt;</mml:mo><mml:mn>1.</mml:mn></mml:mrow></mml:math></disp-formula></p><p>Given  <inline-formula><mml:math id="inf25"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>s</mml:mi></mml:math></inline-formula> = 29 as derived above, <italic>N</italic><sub><italic>e</italic></sub> &gt; 10<sup>15</sup> is required to avoid continual deleterious mutation accumulation and fitness decline (<xref ref-type="fig" rid="fig2">Figure 2b</xref>). Thus, the purifying model requires levels of drift unrealistic at the within-person or across-globe scales. Simulations confirm that deleterious mutations accumulate and compromise the ability of the purifying model to explain empirical d<sub>N</sub><italic>/</italic>d<sub>S</sub> decay in reasonably finite populations (<xref ref-type="fig" rid="fig2">Figure 2c</xref>). Moreover, continuous accumulation of mutations in such populations decreases fitness so much that the average genome contains a sizable fraction (~10%) of deleterious alleles after 1 million years (<xref ref-type="fig" rid="fig2">Figure 2c</xref>), assuming <italic>N</italic><sub><italic>e</italic></sub> = 10<sup>9</sup> and one generation a day (<xref ref-type="bibr" rid="bib45">Korem et al., 2015</xref>). Even if this decreased fitness was biologically maintainable, the accumulation of so many deleterious mutations would lead to many potential adaptive back mutations, complicating the efficiency of purifying selection. Consequently, this value of <inline-formula><mml:math id="inf26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is simply incompatible with a model where a vast majority of alleles are already optimal.</p><p>Lastly, the intolerance of the purifying model to adaptation and transmission is particularly problematic. Within-host adaptive sweeps have been observed in <italic>Bacteroides fragilis</italic> (<xref ref-type="bibr" rid="bib79">Zhao et al., 2019</xref>) and other <italic>Bacteroides</italic> (<xref ref-type="bibr" rid="bib31">Garud et al., 2019</xref>). Such adaptation interferes with inefficient purifying selection; deleterious mutations are likely to hitchhike (<xref ref-type="bibr" rid="bib22">Desai et al., 2013</xref>) to fixation on the genomic background of adaptive mutations. Any given weakly deleterious mutation with <italic>s</italic> = 3.5 × 10<sup>–5</sup> cannot be purged from a within-host population on the timescale of human lifetime (assuming ~1 generation per day), and thus if any adaptive sweep occurred within that host, it would either hitchhike to fixation or be completely removed from the population. Similarly, deleterious mutations can also hitchhike to fixation during neutral transmission bottlenecks, thereby raising the average number of deleterious mutations per cell in the population, furthering mutation accumulation, and hampering the efficiency of purifying selection. Simulations confirm that even infrequent adaptive sweeps and bottlenecks have tangible impacts on d<sub>N</sub>/d<sub>S</sub>, including raising the asymptote (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>).</p></sec><sec id="s2-2"><title>Neither recombination nor differential selection at transmission can easily rescue a model of weak purifying selection</title><p>Homologous recombination, which occurs at detectable rates within human gut microbiomes and within the <italic>Bacteroidales</italic> order (<xref ref-type="bibr" rid="bib52">Liu and Good, 2024</xref>), cannot rescue a population from Muller’s ratchet when such weakly deleterious mutations are so frequent. If we assume a generously high rate of recombination, such that a mutated nucleotide is 500 times more likely to be reverted via recombination than mutation (<italic>r/m</italic> = 500) (<xref ref-type="bibr" rid="bib71">Torrance et al., 2024</xref>; <xref ref-type="bibr" rid="bib52">Liu and Good, 2024</xref>) and brings along a single linked synonymous mutation during each recombination event, the decay of d<sub>N</sub><italic>/</italic>d<sub>S</sub> still cannot be recreated in a population of size 10<sup>9</sup> and fitness will still decay (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>). The inability of recombination to suppress mutation accumulation in this regime arises because the selective advantages themselves are still too small to sweep faster than the rate at which mutations accumulate. While recombination does allow d<sub>N</sub><italic>/</italic>d<sub>S</sub> to eventually decay, the rate of decay is much slower than observed, resulting in a poor fit to the data (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>). While higher values of <italic>N</italic><sub><italic>e</italic></sub> or a higher recombination rate could theoretically approximate the absence of linkage and escape of Muller’s ratchet, we note that the maximum <italic>r/m</italic> across bacteria is estimated to be &lt;50 (<xref ref-type="bibr" rid="bib71">Torrance et al., 2024</xref>) and our simulations are therefore conservative.</p><p>Our presentation so far has implicitly assumed that weak purifying selection has been acting continuously and that values of <italic>s</italic> are constant for any given allele over time. However, apparently weak purifying selection might theoretically emerge from mutations that spend periods under neutral selection (or even local positive selection) and larger periods under strong negative selection, with the estimated value of <italic>s</italic> reflecting the harmonic mean (<xref ref-type="bibr" rid="bib17">Culyba and Van Tyne, 2021</xref>; <xref ref-type="bibr" rid="bib53">Loo et al., 2020</xref>). However, such models will have a hard time overcoming mutation accumulation. For example, a model in which purifying selection acts only during transmission still cannot prevent mutation accumulation without unrealistic assumptions. In particular, the selection-at-transmission model would still require ~29 non-neutral mutations in the average adult population, which implies a very low frequency of the least-loaded class. Assuming each host’s population gets replaced once every 10,000 bacterial generations (~26 years), such a model would require the least-loaded class to be 6000× more likely to colonize them than the average genotype in the population (<inline-formula><mml:math id="inf27"><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>10,000</mml:mn><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>29</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>). The presence of rare cells with strong selective advantages would suggest super-spreading across human microbiomes, which has yet to be reported in the human microbiome (<xref ref-type="bibr" rid="bib27">Faith et al., 2013</xref>). More importantly, Muller’s ratchet would still click because of the low frequency of this least-loaded class.</p></sec><sec id="s2-3"><title>Adaptive reversions can explain the decay of d<sub>N</sub>/d<sub>S</sub></title><p>If purifying selection cannot explain the decay in neutral mutations, what can? One particularly attractive process that removes nonsynonymous mutations over time is strong adaptive mutation and subsequent strong adaptive reversion of the same nucleotide when conditions change. Such reversions are likely to sweep in large populations when mutations are adaptive locally but deleterious in other environments (<xref ref-type="bibr" rid="bib2">Ascensao et al., 2023</xref>). In the gut microbiome, these alternative environments could represent different hosts (<xref ref-type="fig" rid="fig3">Figure 3a</xref>) or environmental changes within a single host (e.g., diet, medication, other microbes). As an illustrative example, the presence of a bacteriophage in one gut microbiome might select for a loss-of-function mutation (premature stop codon or otherwise) in a phage receptor, driving this mutation to fixation in its host, but reverting to the wild-type receptor when transmitted to a phage-free host. Reversions are most likely when compensatory mutations that counteract a mutation’s deleterious effects are either scarce or not as beneficial as direct reversion (<xref ref-type="bibr" rid="bib49">Levin et al., 2000</xref>) (i.e., provided a premature stop codon); we discuss models that include compensatory mutations later in this section.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Locally adaptive mutations and subsequent reversions can explain the decay of nonsynonymous mutations.</title><p>(<bold>a</bold>) Cartoon schematic depicting a potential reversion event within a single transmitted lineage of bacteria. The color of each individual indicates a different local adaptive pressure. Closed arrows represent mutation while open arrows indicate transmission. (<bold>b</bold>) Reversions become increasingly likely at larger population sizes and are nearly guaranteed to occur and fix within 1–10 years when strongly beneficial in gut microbiomes. The probability of revertant arising and fixing (top panel) is calculated as <inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, and the expected time to fixation of reversion (bottom panel) is calculated as <inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> (<inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>4.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> per generation). Generation times are assumed to be 1 day. Note that the mutation rate does not affect time to fixation much when <italic>N<sub>e</sub></italic> is large. Here, we assume no clonal interference or bottlenecks, though simulations do take these processes into account. See Appendix 1, Section 2.2 for derivation. Each line type displays a different selective advantage coefficient. (<bold>c</bold>) The adaptive reversion model can fit the data. Each colored line shows the fit for a different species. The median <italic>R</italic><sup>2</sup> = 0.82 (range 0.54–0.94). Fit minimizes logarithmic variance. See <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> for alternative fitting linear variance. See <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref> for species individually. Insets<italic>:</italic> fit parameters for <inline-formula><mml:math id="inf31"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, the average number of generations for <italic>a given</italic> environmental pressure to switch directions and <inline-formula><mml:math id="inf32"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, the average number of sites under different fluctuating environmental pressures. The scale of the y-axis is linear. Confidence intervals are from 999 bootstrapped resamples.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93146-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Potential for even more adaptation if fitting nonlogarithmic d<sub>N</sub>/d<sub>S</sub>.</title><p>Results of fitting the reversion model (<xref ref-type="disp-formula" rid="equ8">Equation 8</xref>) to minimize d<sub>N</sub>/d<sub>S</sub> rather than logarithmic d<sub>N</sub>/d<sub>S</sub>. This implies a potential longer time to switch for a given selective pressure (median <inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>53</mml:mn><mml:mo>,</mml:mo><mml:mn>340</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) and an increased number of loci undergoing fluctuating selection (median <inline-formula><mml:math id="inf34"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>84</mml:mn></mml:math></inline-formula>). The median <italic>R</italic><sup>2</sup> = 0.72 (range 0.11–0.88).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93146-fig3-figsupp1-v1.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Reversion model fits by individual species.</title><p>Content of <xref ref-type="fig" rid="fig3">Figure 3b</xref>, with each species now given its own panel. One species of note is <italic>B. caccae,</italic> which appears to have initial d<sub>N</sub>/d<sub>S</sub> values &gt;1, which can now be fit with the reversion model (see <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref> for comparison with purifying model).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93146-fig3-figsupp2-v1.tif"/></fig></fig-group><p>Adaptive nonsense mutations have been observed to emerge frequently within individual people in both pathogens (<xref ref-type="bibr" rid="bib17">Culyba and Van Tyne, 2021</xref>; <xref ref-type="bibr" rid="bib50">Lieberman et al., 2011</xref>; <xref ref-type="bibr" rid="bib41">Key et al., 2023</xref>; <xref ref-type="bibr" rid="bib65">Shopsin et al., 2008</xref>) and commensals (<xref ref-type="bibr" rid="bib79">Zhao et al., 2019</xref>; <xref ref-type="bibr" rid="bib5">Barreto et al., 2023</xref>). Identifying reversions in vivo requires both high temporal resolution and deep surveillance such that the probability of persistence of ancestral genotype is removed (<xref ref-type="bibr" rid="bib66">Snitkin et al., 2013</xref>) despite this difficulty, reversions of stop codons have been observed in mouse models (<xref ref-type="bibr" rid="bib67">Sousa et al., 2017</xref>) and during an outbreak of a pathogen infecting the lungs of people with cystic fibrosis (<xref ref-type="bibr" rid="bib59">Poret et al., 2024</xref>). While direct reversion has not yet been observed in gut microbiomes, premature stop codons are frequently observed. Among the 325 observed nonsynonymous de novo mutations in a study of within-host <italic>B. fragilis</italic> adaptation (<xref ref-type="bibr" rid="bib79">Zhao et al., 2019</xref>), 28 were premature stop codons. This frequency is significantly higher than expected by chance (p=0.015; ‘Methods’). Moreover, 4 of the 44 mutations in 16 genes shown to be under adaptive evolution on this short timescale were stop codons. These same 16 genes show a signature of purifying selection on long timescales (<xref ref-type="fig" rid="fig1">Figure 1a</xref>).</p><p>Traditionally, mutational reversions of stop codons and other mutations have been considered exceedingly unlikely and have been ignored in population genetics (<xref ref-type="bibr" rid="bib69">Tajima, 1996</xref>), with a few exceptions (<xref ref-type="bibr" rid="bib13">Charlesworth and Eyre-Walker, 2007</xref>). However, for a bacterial population within a human gut microbiome, the likelihood of a mutational reversion is quite high. A single species within the gut microbiome can have a census population size of 10<sup>13</sup>, with generation rates ranging from 1 to 10 per day (<xref ref-type="bibr" rid="bib63">Sender et al., 2016</xref>; <xref ref-type="bibr" rid="bib45">Korem et al., 2015</xref>). Taking a conservative estimate of one generation per day and a within-person <italic>N</italic><sub><italic>e</italic></sub> of 10<sup>10</sup> (e.g., bacteria at the end of the colon may not contribute much to the next generation; <xref ref-type="bibr" rid="bib48">Labavić et al., 2022</xref>), reversions become highly probable (<xref ref-type="fig" rid="fig3">Figure 3b</xref>; see Appendix 1, Section 2.2). Given a mutation rate of 10<sup>–9</sup> per site per generation, we anticipate 10 mutants at any given site each generation. In the large population sizes relevant for the gut microbiome, a beneficial mutation will then take substantially longer to sweep the population than occur, with values of <italic>s</italic><sub>ben</sub> &gt; 1% generally sweeping within 10 years (<xref ref-type="fig" rid="fig3">Figure 3b</xref>). Consequently, if selection strongly benefits a reverting mutation, a genotype with a beneficial mutation is essentially guaranteed to emerge within days to weeks and replace its ancestors within the host within months to years.</p><p>Given its plausibility, we now consider if the reversion model can explain the observed decay of d<sub>N</sub>/d<sub>S</sub>. The dynamics of the reversion model can be given by<disp-formula id="equ6">.<label> (6)</label><mml:math id="m6"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>With the corresponding solution for <inline-formula><mml:math id="inf35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> being (see Appendix 1, Section 3.1)<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf36"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denotes the number of loci that experience distinct sources of fluctuating selection. The parameter <inline-formula><mml:math id="inf37"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represents the average number of generations required for the sign of selection at a chosen locus to flip and determines the key point in the d<sub>N</sub>/d<sub>S</sub> decay curve where <inline-formula><mml:math id="inf38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> begins to drop. We note that a locus here could be a nucleotide, gene, or gene set – any contiguous or noncontiguous stretch of DNA in which two knockout mutations would be just as beneficial or harmful as one mutation. We again use α to represent the proportion of nonsynonymous mutations that are neutral. Using <xref ref-type="disp-formula" rid="equ7">Equation 7</xref>, we obtain a formula for d<sub>N</sub>/d<sub>S</sub> that has only three free parameters when a single value for <inline-formula><mml:math id="inf39"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is chosen:<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>6</mml:mn><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>When fitting the d<sub>N</sub>/d<sub>S</sub> curve, the values obtained are reasonable in the context of bacterial genomics, with median best-fit values across species of  <inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>46</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> bacterial generations (range 25,000–105,000) and  <inline-formula><mml:math id="inf41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>55</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (range 34–80). Given daily bacterial generations, this value of <inline-formula><mml:math id="inf42"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> suggests the sign of selection on a given allele would flip approximately every 110 years. The average time for any pressure to flip would thus be approximately every 2 years, or less frequently if adaptive events occur in bursts (e.g., upon transmission to a new host). While 55 loci under distinct selective pressures may seem high, <italic>Bacteroidetes</italic> genomes are known to have dozens of invertible promoters (up to 47 in <italic>B. fragilis;</italic> <xref ref-type="bibr" rid="bib37">Jiang et al., 2019</xref>). Invertible promoters are restricted out of the genome and re-ligated in the opposite direction to turn gene expression on or off. The number of invertible promoters in a given genome approximates a lower bound on the number of fluctuating selective pressures that these genomes frequently experience. Interestingly, adaptive loss-of-function mutations reported in <italic>B. fragilis</italic> affect the same genes regulated by invertible promoters (<xref ref-type="bibr" rid="bib79">Zhao et al., 2019</xref>). The plausibility of these fit parameters lends support to a model in which d<sub>N</sub>/d<sub>S</sub> decays solely based on strong and recurrent local adaptations.</p><p>To ensure a reversion model is robust to finite populations, we performed simulations using fit parameters. These simulations capture the dynamics of a single population evolving as it transmits across a series of hosts through random bottlenecks (<xref ref-type="fig" rid="fig4">Figure 4a</xref>; ‘Methods’); these simulations allow for clonal interference between adaptive mutations. We allow new pressures to arise independent of bottlenecks as new selective forces (phage migration [<xref ref-type="bibr" rid="bib46">Koskella and Brockhurst, 2014</xref>]; immune pressures [<xref ref-type="bibr" rid="bib7">Barroso-Batista et al., 2015</xref>]; dietary changes [<xref ref-type="bibr" rid="bib10">Carmody et al., 2019</xref>]) can emerge throughout the lifespan and independent of migration; forcing transmission and bottlenecks to coincide gives similar results (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). As in the purifying selection simulations, the per base pair mutation rate is 10<sup>–9</sup>, and 90% of nonsynonymous substitutions are deleterious, but this time they have a larger <italic>s</italic> of 0.003 (<xref ref-type="bibr" rid="bib60">Robert et al., 2018</xref>) and are thus purged more quickly from the population. Notably, while some of these deleterious mutations hitchhike to fixation during bottlenecks and adaptive sweeps, fitness does not decay because these mutations are subsequently reverted with adaptive sweeps (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). If deleterious mutations had significantly smaller <italic>s</italic>, they would be unable to be reverted due to the long time needed to reach fixation, even if bottlenecks and adaptive events are less frequent (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>).</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Under a model of reversion, the apparent d<sub>N</sub>/d<sub>S</sub> on long timescales underestimates the extent of adaptive evolution.</title><p>(<bold>a</bold>) The reversion model successfully fits the data in simulations. We simulate a population of size 10<sup>10</sup> that has a bottleneck to size 10 on average every 10,000 generations (~27 years or a human generation [<xref ref-type="bibr" rid="bib75">Wang et al., 2023</xref>] given a bacterial generation a day), with one adaptive pressure (<inline-formula><mml:math id="inf43"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.03</mml:mn></mml:math></inline-formula>) occurring on average every 840 generations independently of bottlenecks (see <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> for an alternative where bottlenecks and selection are correlated). New pressures either require forward mutations (which can be acquired at a rate of 1.1 × 10<sup>-8</sup> per available locus per generation) or reversions (which can be acquired at a rate of 4.5 × 10<sup>-10</sup> per available locus per generation), the balance of which depends on the history of pressures on the tracked genome (i.e., more past forward pressures implies more potential future reverse pressures). Based on the best fit to the data, we use <inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>55</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. Deleterious mutations occur at a rate of 1.01 × 10<sup>-3</sup> mutations per genome and have <inline-formula><mml:math id="inf45"><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0.003</mml:mn></mml:math></inline-formula> and can themselves be reverted. More details on the simulation can be found in ‘Methods’. Each curve represents the average of 10 runs; the blue line shows the observed pairwise d<sub>N</sub>/d<sub>S</sub> while the red line includes adaptive mutations and reversions. The theory line is the result of <xref ref-type="disp-formula" rid="equ8">Equation 8</xref>. Observable d<sub>N</sub>/d<sub>S</sub> decays because of reversion, while the actual d<sub>N</sub>/d<sub>S</sub> of mutations that occurred is &gt;1 when taking into account both forward and reverse mutations. (<bold>b</bold>) PAML (<xref ref-type="bibr" rid="bib77">Yang, 2007</xref>) cannot detect true d<sub>N</sub>/d<sub>S</sub> in a given gene in the presence of adaptive reversions. Both lines are d<sub>N</sub>/d<sub>S</sub> as calculated by PAML on a simulated gene phylogeny. In the permanent adaptations simulation (blue), adaptive mutations are acquired simply and permanently. In the transient adaptations simulation (red), only more recent mutations will be visible while older mutations are obscured (‘Methods’). Line is the average of 10 simulated phylogenies and shaded regions show the range. (<bold>c</bold>) Categories of genes in the <italic>Bacteroides fragilis</italic> genome (NCTC_9343) enriched for stop-codon adjacent codons (TTA and TCA) relative to the expectation from the rest of the genome (‘Methods’). The use of these codons suggests these sequences may have recently had premature stop codon mutations. p-Values are displayed above bars and were calculated using a one-proportion Z-test with Bonferroni correction. See ‘Methods’, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>, and <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref> for more details.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93146-fig4-v1.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Effect of correlating mutations with bottleneck has little impact on the fit.</title><p>Same parameters as simulation from <xref ref-type="fig" rid="fig4">Figure 4a</xref> but rather than have new pressures occur independently of bottlenecks, they occur concurrently. To have an overall average of one beneficial mutation every 840 generations, an average of 11.9 mutations (Poisson with mean 11.9) occur every bottleneck, which occurs on average every 10,000 generations. The most noticeable difference is greater variability at low synonymous divergence values. The first 100,000 generations is the average of 50 simulations while subsequent parts of the curve consist of only 5 simulations to save on computing time (hence the slight spike).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93146-fig4-figsupp1-v1.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>Deleterious hitchhikers are reverted over time, preventing fitness decay.</title><p>Besides for reversions potentially occurring due to strong environmental pressures, reversions can also occur because of the fixation of deleterious hitchhikers. These results are from the simulations of <xref ref-type="fig" rid="fig4">Figure 4a</xref>, where deleterious mutations occur at a rate of 1.01 × 10<sup>-3</sup> per genome per generation and with a selective disadvantage of <italic>s</italic> = 0.003. Deleterious mutations are allowed to hitchhike, and reversions of these deleterious mutations are also permitted. Adaptive mutations and reversions are not counted in relative fitness. The curve is the average of 10 simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93146-fig4-figsupp2-v1.tif"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 3.</label><caption><title>Inclusion of compensatory mutation in the reversion model shows that d<sub>N</sub>/d<sub>S</sub> still decays provided reversion occurs at reasonable rates.</title><p>(<bold>a</bold>) Using a Markov chain (see Appendix 1, Section 3.2), we calculate the theoretical values of <inline-formula><mml:math id="inf46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, and thus d<sub>N</sub>/d<sub>S</sub> decay, under varying assumptions about the rate at which compensatory mutations win over true reversions. While compensatory mutations do slow the rate at which d<sub>N</sub>/d<sub>S</sub> decays (relative to no compensatory mutations) if reversions are more likely than compensatory mutations, a decay will be observed. Reducing the number of loci can correct for delayed decay from compensatory mutations. (<bold>b</bold>) The likelihood of true reversion vs. compensatory mutations (treated as mutually exclusive) under different parameter regimes as determined from simulations. Simulations are performed the same as those displayed in <xref ref-type="fig" rid="fig4">Figure 4</xref> and described in the ‘Methods’ section for the reversion model (same population size, bottlenecks, loci, arrival of pressures, mutation rates), except now there is an additional compensatory category that can be used to satisfy an adaptation to a reverse pressure and has a separate rate and selective advantage. Results are obtained by comparing accumulated true reversions to compensatory mutations after 500,000 generations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-93146-fig4-figsupp3-v1.tif"/></fig></fig-group><p>We note that other complex models that include reversion and other processes are also possible. For example, a model with a very large number of loci with selective tradeoffs and pressures that act only transiently (nonfluctuating) could potentially fit the data. However, the agreement between <inline-formula><mml:math id="inf47"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and the number of invertible promoters, and the finding of parallel evolution in vivo, suggests the fluctuating selection model is more realistic than a very many-sites model.</p><p>So far, we have assumed that only exact reversions are selected upon when the sign of selection returns to its original state. However, the reversion model can also accommodate compensatory mutations that exclude any selective advantage for reversion; these compensatory mutations can also be subject to reversion themselves. We conceptualize this as a random walk, in which a locus at a nonancestral state acquires a compensatory mutation with probability <italic>p</italic> or obtains a true reversion with probability 1 – <italic>p</italic> (see Appendix 1, Section 3.2). As long as <inline-formula><mml:math id="inf48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, d<sub>N</sub>/d<sub>S</sub> will decay to the same asymptote despite adaptive dynamics occurring. While compensatory mutations shift the timing of d<sub>N</sub>/d<sub>S</sub> decay to the right, it can be shifted backward by decreasing <inline-formula><mml:math id="inf49"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3a</xref>). The condition <inline-formula><mml:math id="inf50"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> is easily met when  <inline-formula><mml:math id="inf51"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> = 0.03, until excluding compensatory mutations are 10 times more likely than true reversion and provide 95% of the selective advantage of the true reversion (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3b</xref>). If selective pressures are stronger (as they might be in the presence of phage), true reversions will outcompete compensatory mutations even if the supply of compensatory mutations is greater or such mutations provide better relative compensation.</p><p>A critical consequence of the reversion model is that apparent and actual d<sub>N</sub>/d<sub>S</sub> values diverge quickly. Even when the true genome-wide d<sub>N</sub>/d<sub>S</sub> exceeds 1 – meaning that adaptive sweeps have been a dominant force in shaping genomes – the observed value can be close to 0.1 on long timescales. This disparity complicates the interpretation of d<sub>N</sub>/d<sub>S</sub> as it becomes challenging to determine whether a genome or gene lacks nonsynonymous mutations due to reversions or negative selection. We confirmed the inability to detect adaptive selection on a gene when reversion is rampant by simulating protein phylogenies; even the advanced software PAML (Phylogenetic Analysis by Maximum Likelihood) (<xref ref-type="bibr" rid="bib77">Yang, 2007</xref>) significantly underestimates actual d<sub>N</sub>/d<sub>S</sub> (<xref ref-type="fig" rid="fig4">Figure 4b</xref>; ‘Methods’). Without sufficient temporal sampling, no software can realistically estimate these hidden, adaptively driven nonsynonymous mutations.</p><p>Lastly, we sought to find evidence of past reversions of stop codons in certain genes by analyzing codon usage. Both leucine and serine have the property that they can be encoded by six codons, only one of which is highly stop codon adjacent (TTA for leucine and TCA for serine). Across the <italic>B. fragilis</italic> genome, these codons are depleted overall (13.48% usage rather than the neutral expectation of 16.67%). However, specific Clusters of Orthologous Genes (COG) categories are enriched in TTA and TCA codons relative to this baseline, including genes associated with transcription and cell envelope biogenesis (<xref ref-type="fig" rid="fig4">Figure 4c</xref>, ‘Methods’, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). Further, when functionally annotated genes are further categorized by cellular localization, more gene categories exhibit enrichment (<xref ref-type="fig" rid="fig4">Figure 4c</xref>, ‘Methods’, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>), most notably genes involved in inorganic ion transport and metabolism that are localized to the outer membrane. Genes implicated in within-host <italic>B. fragilis</italic> adaptation (<xref ref-type="bibr" rid="bib79">Zhao et al., 2019</xref>) are also found disproportionately in this category of outer membrane transporters (p=1.22 × 10<sup>–4</sup>; ‘Methods’, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). Both the cell envelope and membrane-bound transporters are known to mediate interactions with the immune system and phage (<xref ref-type="bibr" rid="bib68">Sukhithasri et al., 2013</xref>; <xref ref-type="bibr" rid="bib57">Ongenae et al., 2022</xref>), and are therefore expected to experience fluctuating selective pressures. The enrichment of stop-codon adjacent codons in pathways associated with environment-dependent costs further supports a model in which adaptive mutational reversions are frequent.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In this study, we present a new interpretation of the time-dependent changes in d<sub>N</sub>/d<sub>S</sub> for bacterial populations. We show that the traditional weak purifying selection model struggles to replicate theoretical results in realistic population sizes and propose an alternative model with opposite implications that are supported by analytical, simulation, and genomic results. Together, these results challenge the conventional view that high d<sub>N</sub>/d<sub>S</sub> values on short timescales are an artifact and should not be trusted. Instead, the success of the reversion model suggests that adaptive dynamics are underestimated on long timescales because of the saturation of d<sub>N</sub>.</p><p>It is perhaps not surprising that reversions have been relatively overlooked in previous literature. First, most population genetics theory focuses on eukaryotic organisms with smaller population sizes and longer generation times, for which reversion is less likely. The low likelihood of reversion in these populations has inspired the use of the convenient infinite-site model (<xref ref-type="bibr" rid="bib69">Tajima, 1996</xref>), which assumes that reversions never occur and simplifies derivations. While smaller values of <italic>N</italic><sub><italic>e</italic></sub> can be appropriate for modeling global bacterial dynamics – because bottlenecks and geography limit how many organisms effectively compete – they are inappropriate for within-gut populations, which are less structured. While gut microbiomes do have a spatial structure that reduces competition, theoretical work modeling this biogeography suggests that the census and active population sizes differ only approximately tenfold (<xref ref-type="bibr" rid="bib32">Ghosh and Good, 2022</xref>; <xref ref-type="bibr" rid="bib48">Labavić et al., 2022</xref>). This brings the within-gut microbiome <italic>N</italic><sub><italic>e</italic></sub> to substantially larger than the per-nucleotide mutation rate, invalidating the infinite sites model. Secondly, while bacterial geneticists have long observed adaptive loss-of-function mutations, two common misinterpretations of population genetic parameters can underestimate the probability of reversion: molecular clock rates (μ), which are generally low, can easily be confused with the supply of potential mutations (μ<italic>N</italic><sub><italic>e</italic></sub>) (<xref ref-type="bibr" rid="bib51">Lieberman, 2022</xref>); and classical approaches that assess <italic>N</italic><sub><italic>e</italic></sub> from genetic diversity vastly underestimate the currently active population size, particularly if a bottleneck recently occurred (e.g., during transmission). Lastly, simulating large populations, even when appropriate, is computationally difficult. As a consequence, population genetics simulations, including those of bacteria, have used relatively small population sizes (≤10<sup>6</sup> organisms). We overcome computational limitations by tracking genetic classes rather than individual genotypes (‘Methods’). While our approach does not allow explicit comparison between individuals within a population, we believe this framework represents a powerful method to simulate large population sizes when applicable.</p><p>Whether or not a reversion model can be applied beyond host-associated microbial populations remains to be explored. We only analyze microbiome data here, but we anticipate that analyses of highly curated d<sub>N</sub>/d<sub>S</sub> decay curves from microbial pathogens could yield similarly plausible parameter fits for the reversion model given past observations of d<sub>N</sub>/d<sub>S</sub> decay (<xref ref-type="bibr" rid="bib61">Rocha et al., 2006</xref>). When effective population sizes are smaller than 10<sup>9</sup>, reversions are relatively unlikely. For example, while adaptive reversions can sweep individual gut microbiomes, we do not propose that reversions sweep the global bacterial population. Regardless, theoretical work on animal populations has shown that adaptive reversions are possible after local population bottlenecks (<xref ref-type="bibr" rid="bib13">Charlesworth and Eyre-Walker, 2007</xref>). Similarly, environmental variations that change more rapidly than the timescale required for a local selective sweep (e.g., those imposed by daily dietary changes in the gut; or imposed by light-dark cycles in the environment) would be less likely to drive fixation and subsequent reversion than the less rapid changes considered here (e.g., phage migration) (<xref ref-type="bibr" rid="bib18">Cvijović et al., 2015</xref>). On the other hand, adaptive reversions may be particularly relevant for viral populations, which are known to undergo within-host adaptation, have very large population sizes, and experience frequent bottlenecks (<xref ref-type="bibr" rid="bib28">Feder et al., 2017</xref>). Reversions have commonly been observed in certain regions of the HIV genome and have been postulated to diminish measured substitution rates in those regions (<xref ref-type="bibr" rid="bib26">Druelle and Neher, 2023</xref>).</p><p>Despite the success of a model of reversion alone in explaining d<sub>N</sub>/d<sub>S</sub> decay, it remains possible that other forces could additionally contribute. While we have shown that purifying selection alone, either continuously or during transmission, cannot explain d<sub>N</sub>/d<sub>S</sub> decay alone, it is possible that some degree of purifying selection could act alongside a reversion model. Similarly, directional selection could be incorporated into the reversion model by adjusting the parameter <inline-formula><mml:math id="inf52"><mml:mi>α</mml:mi></mml:math></inline-formula>. While the true contribution of adaptive evolution to <inline-formula><mml:math id="inf53"><mml:mi>α</mml:mi></mml:math></inline-formula> is likely nonzero, it is difficult to fit with available data and it is therefore left for future work.</p><p>While we have presented evidence that recombination alone is unlikely to rescue a model of weak purifying selection, it remains possible that recombination could be included in a model that includes adaptation and, notably, could drive adaptive reversions. Microbial geneticists have frequently observed that recombined regions exhibit lower d<sub>N</sub>/d<sub>S</sub> values compared to non-recombined regions (<xref ref-type="bibr" rid="bib11">Castillo-Ramírez et al., 2011</xref>), a signature consistent with having already experienced reversion or purifying selection. Recombination could potentially revert multiple mutations at specific loci simultaneously, which might be particularly beneficial in the presence of genomic epistasis. Thus, despite the success of the mutation-driven model, it is likely that recombination plays some role in the decay of d<sub>N</sub>/d<sub>S</sub>.</p><p>While more direct observation of adaptive reversions is currently lacking, we propose that this paucity is simply an artifact of lacking samples along a line of descent with sufficient genomic resolution. Despite this challenge in observation, a recent study tracking de novo mutations between mothers and infants revealed several cases of apparent reversion, with elevated values of d<sub>N</sub>/d<sub>S</sub> &gt; 1, though not significantly so (<xref ref-type="bibr" rid="bib14">Chen and Garud, 2022</xref>). Moreover, many short-term studies in the gut microbiome and beyond have revealed strong evidence of within-person adaptation, including parallel evolution (<xref ref-type="bibr" rid="bib50">Lieberman et al., 2011</xref>; <xref ref-type="bibr" rid="bib54">Marvig et al., 2015</xref>; <xref ref-type="bibr" rid="bib79">Zhao et al., 2019</xref>; <xref ref-type="bibr" rid="bib16">Cooper and Lenski, 2000</xref>) and loss-of-function changes like premature stop codons (<xref ref-type="bibr" rid="bib41">Key et al., 2023</xref>) – with low long-term d<sub>N</sub>/d<sub>S</sub> values in these same short-term genes (<xref ref-type="bibr" rid="bib74">Vigué and Tenaillon, 2023</xref>). We note that adaptation and reversion do not result in parallel evolution in the genomic record if various initial mutations result in the same phenotype (i.e., loss-of-function mutations); however, it would result in changes in codon usage bias we have shown (<xref ref-type="fig" rid="fig4">Figure 4c</xref>).</p><p>The shortcomings of the purifying model and the success of the reversion model under realistic assumptions highlight the importance of studying evolution in real time for understanding evolutionary dynamics. In addition, our results emphasize the importance of simulating large population sizes for explaining observations in bacterial population genomics, spotlight the potential for strong adaptation in bacterial populations, and underscore the need for continued development of population genetics theory for microbial populations.</p></sec><sec id="s4" sec-type="methods"><title>Methods</title><sec id="s4-1"><title>Data and parameter estimation</title><p>Data was obtained from <xref ref-type="bibr" rid="bib64">Shoemaker et al., 2022</xref> and was initially generated by <xref ref-type="bibr" rid="bib31">Garud et al., 2019</xref>. Pairwise d<sub>N</sub>/d<sub>S</sub> values can be found in the GitHub repository. The parameters are estimated using scipy.optimize.curve_fit. The fit minimizes the RMSD of the <italic>logarithmic</italic> d<sub>N</sub>/d<sub>S</sub>. If we fit the data by minimizing just d<sub>N</sub>/d<sub>S</sub> on a linear scale, we get <italic>s</italic> ≈ 2.0 × 10<sup>–5</sup>, which suggests an even weaker purifying selection (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). We analyzed the 10 species with the most data points reflecting short divergence times (d<sub>S</sub> &lt; 0.0005), which is critical for data fit.</p></sec><sec id="s4-2"><title>Population simulations overview</title><p>The majority of the computational simulations performed are built upon the idea of the Wright–Fisher model with selection (<xref ref-type="bibr" rid="bib70">Tataru et al., 2017</xref>) that population generations can be determined from a multinomial distribution. However, we have made some changes to generalize this model for our purposes.</p><p>First, the simulations do not necessarily assume a constant population size but rather assume the population grows via a logistic growth model with a capacity to allow for the implementation of bottlenecks. Specifically, if <inline-formula><mml:math id="inf54"><mml:mi>P</mml:mi><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:math></inline-formula> is the population on generation <inline-formula><mml:math id="inf55"><mml:mi>t</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf56"><mml:mi>K</mml:mi></mml:math></inline-formula> is the population capacity, then<disp-formula id="equ9"><mml:math id="m9"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mover><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mtext>1</mml:mtext></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mi>K</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>And<disp-formula id="equ10"><mml:math id="m10"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mover><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mtext>1</mml:mtext></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The population size is a Poisson random variable as we choose to determine the offspring of individual genetic classes as a Poisson random variable. We note that except for the very first few generations and after bottlenecks, the population size only has small fluctuations around a fixed capacity.</p><p>To speed the simulation up and enable the simulation of very large population sizes, we implemented a variety of genotype classes, rather than tracking each genotype individually. Genotype classes are similar to the practice of simulating fitness classes (<xref ref-type="bibr" rid="bib21">Desai and Fisher, 2007</xref>), though we manage the number of unique classes via Poisson merging and splitting.</p><p>For all simulations, we start from a single organism that begins with 500,000 neutral alleles, representing a core genome size of this many codons that has yet to receive any mutations. When a mutation occurs, one allele may change types or stay the same, depending on the mutation received and the state of the randomly chosen codon. For example, a deleterious mutation occurring at a codon already in a deleterious state does not change the genotype class of the organism.</p><p>The specific implementations and additional parameters used for this model are provided in the following sections. Here, we outline the theory that ensures that genotype classes accurately represent such a population and enable the calculation of fitness. Consider the total population of size, <inline-formula><mml:math id="inf57"><mml:mi>P</mml:mi><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:math></inline-formula>, at generation <inline-formula><mml:math id="inf58"><mml:mi>t</mml:mi></mml:math></inline-formula>, as a composite of multiple different classes. The number of individuals in class <inline-formula><mml:math id="inf59"><mml:mi>j</mml:mi></mml:math></inline-formula> on generation <inline-formula><mml:math id="inf60"><mml:mi>t</mml:mi></mml:math></inline-formula> will be <inline-formula><mml:math id="inf61"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:math></inline-formula>. We have<disp-formula id="equ11"><mml:math id="m11"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:munder><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Within class <inline-formula><mml:math id="inf62"><mml:mi>j</mml:mi></mml:math></inline-formula>, we store several variables that provide information about the genotype of members of <inline-formula><mml:math id="inf63"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:math></inline-formula>. Specifically, we store a number <inline-formula><mml:math id="inf64"><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> that specifies the number of alleles of type <inline-formula><mml:math id="inf65"><mml:mi>k</mml:mi></mml:math></inline-formula> in the class <inline-formula><mml:math id="inf66"><mml:mi>j</mml:mi></mml:math></inline-formula>. Examples of potential types that are used in our work include deleterious alleles, adaptive alleles, and alleles that result from reversion. Each type of allele is associated with a specific selective advantage <inline-formula><mml:math id="inf67"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. We can now write a formula to calculate the absolute fitness <inline-formula><mml:math id="inf68"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of class <inline-formula><mml:math id="inf69"><mml:mi>j</mml:mi></mml:math></inline-formula>:<disp-formula id="equ12"><mml:math id="m12"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>From the absolute fitness <inline-formula><mml:math id="inf70"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, we calculate the average absolute fitness of the population on generation <inline-formula><mml:math id="inf71"><mml:mi>t</mml:mi></mml:math></inline-formula> via<disp-formula id="equ13"><mml:math id="m13"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>F</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:munder><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We now calculate the relative fitness of class <inline-formula><mml:math id="inf72"><mml:mi>j</mml:mi></mml:math></inline-formula> on generation <inline-formula><mml:math id="inf73"><mml:mi>t</mml:mi></mml:math></inline-formula> as<disp-formula id="equ14"><mml:math id="m14"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>F</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Next, we calculate the expected size of class <inline-formula><mml:math id="inf74"><mml:mi>j</mml:mi></mml:math></inline-formula> in the next generation with<disp-formula id="equ15"><mml:math id="m15"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mi>K</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Note that<disp-formula id="equ16"><mml:math id="m16"><mml:mi>P</mml:mi><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo></mml:math></disp-formula><disp-formula id="equ17"><mml:math id="m17"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>F</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mi>K</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mi>K</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>This allows us to use a logistic model of growth to represent population size rather than being constrained to fixing it, which is useful for simulating bottlenecks.</p><p>To account for genetic drift through random fluctuations, we rewrite the above equations to be<disp-formula id="equ18"><mml:math id="m18"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mi>K</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which also implies<disp-formula id="equ19"><mml:math id="m19"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mi>K</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Note that this simulation still has equivalent dynamics of the frequencies of classes as a Wright–Fisher model with selection in the case of a fixed population size due to the ability to split Poisson processes, that is,<disp-formula id="equ20"><mml:math id="m20"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Mutations are added in every generation depending on the mutation rate. Only single mutants are generated per generation, and an organism cannot get more than one mutation per generation. The number of new mutants is determined by the binomial distribution. New mutants are added then to their appropriate class <inline-formula><mml:math id="inf75"><mml:mi>j</mml:mi></mml:math></inline-formula>. For example, if a deleterious mutation is gained in a class with 10 deleterious alleles (and nothing else), this new mutant will increase the population size of the class with 11 deleterious alleles (and nothing else) while decreasing the population size of the class with 10 deleterious alleles (and nothing else).</p><p>By grouping individuals in classes rather than by genotype, computational costs can be greatly cut down. Grouping individuals does not affect the dynamics of the simulation because the merging of Poisson processes is still Poisson. The downside to this approach is information loss, though by designing custom alleles, we can track specific mutational histories like reversions.</p></sec><sec id="s4-3"><title>Purifying selection simulations</title><p>The purifying selection simulations (<xref ref-type="fig" rid="fig2">Figure 2</xref>) utilized the base framework as mentioned above. Effective population sizes (<italic>N</italic><sub><italic>e</italic></sub>) varied from 10<sup>6</sup> to 10<sup>18</sup> depending on the simulation. The simulation begins with an initial organism with 500,000 neutral alleles (representing a WT core genome). The population quickly grows to the carrying capacity (<italic>N</italic><sub><italic>e</italic></sub>) and follows logistic growth (see ‘Population simulations overview’). The deleterious nonsynonymous mutation rate per genome per generation is 1.01 × 10<sup>–3</sup>. These deleterious mutations have a selective disadvantage of <italic>s</italic> ≈ 3.5 × 10<sup>–5</sup>. Synonymous and neutral nonsynonymous mutations are not simulated directly as they are neutral and are instead assumed to accumulate in the population with an average rate of 3.75 × 10<sup>–4</sup> and 1.12 × 10<sup>–4</sup> per genome per generation, respectively.</p><p>We estimate the average d<sub>N</sub>/d<sub>S</sub> of the population by taking the average number of codon differences between two individuals in the population to be twice the average number of mutations in the population. This approximation is valid due to the lack of selective sweeps, bottlenecks, and large effective population size, which results in expected coalescent time between random individuals being 10<sup>6</sup>–10<sup>18</sup> generations (far longer than our simulations).</p><p>Variations of this basic purifying selection model are performed as described in the article, including increasing the mutation rate to 1.13 × 10<sup>–3</sup> mutations per genome per generation (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>) and the simulation of recombination (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>). For simulations of recombination, we assume that transitions to the ancestral state (purging the deleterious allele) occur at a rate of 2.5 × 10<sup>–7</sup> per codon per genome per generation and bring along a synonymous mutation (tracked via the number of recombinations to the ancestral state). This procedure does not allow for recombination to purge multiple deleterious alleles at a time; such events are unlikely given that deleterious alleles are rare and randomly distributed. We also include a model in which synonymous mutations are not included in this reversion event.</p><p>The simulation of purifying selection through bottlenecks and infrequent adaptive sweeps was performed as in the modified version of the reversion model (see ‘Reversion simulations’), though with less frequent adaptation and larger and less frequent bottlenecks.</p></sec><sec id="s4-4"><title>Stop codon enrichment in the Zhao and Lieberman et al. dataset</title><p>Table S7 in <xref ref-type="bibr" rid="bib79">Zhao et al., 2019</xref> provides an Excel sheet detailing all observed mutations. There were 325 observed nonsynonymous mutations of which 28 were stop codons. Under a null model, there are 415 possible permutations of initial codon and codon one mutation (see ‘Code availability’) away that result in a nonsynonymous substitution of which 23 lead to a stop codon. Assuming no preference for specific mutation or initial codon, we would expect roughly 18 stop codons in this data. Under a null binomial distribution, the p-value for obtaining 28 or more is 0.015.</p></sec><sec id="s4-5"><title>Reversion simulations</title><p>We simulated gut bacterial populations using a modified Wright–Fisher model (see ‘Population simulations overview’) to monitor mutation acquisition over time compared to an ancestor. Like all simulations, we begin with a single organism with 500,000 neutral alleles to represent the WT core genome. The population can grow to a capacity of 10<sup>10</sup> via a logistic growth model. Environmental changes occur with a probability of <inline-formula><mml:math id="inf76"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula> per generation, triggering an average of one selective pressure per environmental change, modeled by a Poisson distribution. Population bottlenecks to 10 individuals occur independently of environmental changes with a probability of 10<sup>–4</sup> per generation (see <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> for an alternative in which bottlenecks and environmental change are correlated).</p><p>Both adaptive selective pressures and adaptive mutations are categorized into two allele types: forward and reverse. These classes are designed to enable tracking of complete mutational history and therefore recorded relative to the ancestral state rather than the current state. Thus, actual d<sub>N</sub>/d<sub>S</sub> is calculated as the sum of these mutations and observed d<sub>N</sub>/d<sub>S</sub> using their difference (plus asymptomatic d<sub>N</sub>/d<sub>S</sub>). When releasing beneficial selective pressures, their classification as forward or reverse is based on the balance of previously released selective pressures: the probability of an adaptive pressure being classified as a reverse adaptation increases as the number of forward pressures increases and is equal to the difference between the forward pressures previously released (<inline-formula><mml:math id="inf77"><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) and reverse pressures previously released (<inline-formula><mml:math id="inf78"><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) divided by the number of loci (i.e., <inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula>). All beneficial mutations have a selective advantage of <italic>s</italic><sub>ben</sub> = 0.03 (for forward or reverse). The rate at which mutations occur given an available pressure depends on whether the mutation is adapting to a forward or reverse pressure: the reversion rate is set at one-fifth the rate of the nonsynonymous per codon mutation rate (4.5 × 10<sup>–10</sup> per generation per cell), while forward mutations are set at a rate five times higher than the nonsynonymous mutation rate because they can happen at multiple sites (25× the reversion rate; 1.1 × 10<sup>–8</sup> per generation per cell).</p><p>This simulation treats each adaptive mutation as occupying a unique codon in the core genome for simplicity. This assumes that the ancestral allele at a given locus has been purged before the next environmental change affecting that locus (or selective pressure); as theory suggests that a beneficial mutation takes 768 generations to fix (see Appendix 1, Section 2.2), compared to 46,200 generations for pressure shifts at any locus we believe this assumption is reasonable. To confirm this theory still holds in the presence of bottlenecks and clonal interference, we tracked the average number of beneficial mutations in the population relative to the number of selective pressures released at any generation in simulations; we found only a 2% deviation between the average and expected total beneficial mutations over 2 × 10<sup>6</sup> generations.</p><p>Throughout the simulation, deleterious mutations occur at a rate of 1.01 × 10<sup>–3</sup> mutations per genome per generation, with a selective disadvantage of <italic>s</italic> = 0.003, and can be reverted to a deleterious reversion allele class (separate from the adaptive reversion allele class).</p><p>To calculate d<sub>N</sub>/d<sub>S</sub>, we assume the simulated population could be compared to an equivalent population but with distinct mutations, allowing us to calculate the d<sub>N</sub>/d<sub>S</sub> as using double the current observed substitutions.</p><p>We assume during the reversion simulations that the ancestor has no initial transient mutations. We make this assumption for computational simplicity but the theoretical curve is equivalent whether starting from no revertible mutations or the equilibrium where half of the loci currently have forward mutations (assuming forward and reverse mutations occur at equal rates; see Appendix 1, Section 3.3).</p></sec><sec id="s4-6"><title>Testing standard d<sub>N</sub>/d<sub>S</sub> software</title><p>We simulated gene sequences with selective pressures acting at specific sites for <xref ref-type="fig" rid="fig4">Figure 4b</xref>. For each genomic distance investigated (every 500,000 bacterial generations), we ran 10 simulations as described below, with each simulation resulting in 10 sequences derived from a branching process. In the permanent adaptations simulation (blue), adaptive mutations in the phylogeny are acquired simply and permanently. In the transient adaptations simulation (red), only more recent mutations in the same phylogeny will be visible while older mutations are obscured by reversion. Both sets of sequences were then fed to PAML v4.8 (<xref ref-type="bibr" rid="bib77">Yang, 2007</xref>) for the estimation of d<sub>N</sub>/d<sub>S</sub> values. PAML uses maximum likelihood analysis to estimate the rate of substitution that best explains a given phylogenetic tree.</p><p>For each simulation, we generated a random 1500 bp open-reading frame and designated 10% of codons as neutral, 10% under positive selection, and 80% under purifying selection. We introduced mutations and branches across several cycles, with each cycle representing 100,000 generations. For each cycle, we assigned mutations at random according to the following probabilities: 67.5% that a nonsynonymous mutation occurred at a codon under positive selection, 12.5% for synonymous mutation at any codon, 3.75% for nonsynonymous mutation at a nonselected site (neutral), and 16.25% for no mutation. These values were selected to give a d<sub>N</sub>/d<sub>S</sub> of around 2 and to match the general ratios in the reversion model.</p><p>Two phylogenies were constructed from each simulation: both received identical mutations, but they differed in how nonsynonymous mutations at selective codon sites were visible at the end of the simulation. In the transient adaptations version of the phylogeny, nonsynonymous mutations at selective codon sites were reverted at the end of the simulation, except those that occurred within the last 500,000 generations. Reverted sites were converted to a synonymous substitution at a frequency based on the codon table (assuming an equal probability of all nucleotide mutations). Both versions of the sequences underwent multiple sequence alignment and neighbor-joining tree construction (Biopython; <xref ref-type="bibr" rid="bib15">Cock et al., 2009</xref>). We calculated treewide d<sub>N</sub>/d<sub>S</sub> ratios using PAML v4.8’s codeML feature (<xref ref-type="bibr" rid="bib1">Álvarez-Carretero et al., 2023</xref>), employing the M2a model to analyze site-specific selection.</p></sec><sec id="s4-7"><title>Closeness to stop codons</title><p>To evaluate possible enrichment for stop codon adjacency, we focused on TTA and TCA codons. TTA and TCA are ideal for measuring the likelihood of nonsense mutations because each has two point mutations that yield a stop codon, unlike the five other redundant codons encoding for the same amino acids (for both leucine and serine, one codon is singly stop codon adjacent and the last four are not stop codon adjacent). In <italic>B. fragilis,</italic> these codons have a codon usage rate of 13% for leucine and 14% for serine.</p><p>We annotated the reference genome NCTC_9343 with Bakta v1.9 (<xref ref-type="bibr" rid="bib62">Schwengers et al., 2021</xref>) and obtained COG categories for each gene using eggNOG v5.0 (<xref ref-type="bibr" rid="bib9">Cantalapiedra et al., 2021</xref>). Genes that did not have a functional COG category (35%) were removed. To control for unusual outlier genes skewing results, only the 15 COG groups that had at least 50 genes were considered for enrichment analyses. For each COG category, we calculated a null codon usage proportion based on the proportion of leucine and serine codons and compared this to the actual proportion using a one-proportion <italic>Z</italic> test. To address the fact that genes in the same functional category but localized to different parts of the cell may be under different selective pressures, we analyzed cellular location classifications from PSORTb v3.02 (<xref ref-type="bibr" rid="bib78">Yu et al., 2010</xref>) and categorized genes by the combination of function and localization. We analyzed the 15 function-location combinations with more than 50 genes. After identifying those categories that were significantly enriched, we cross-referenced which categories of genes shown to be under adaptive within-person evolution in a previous study of <italic>B. fragilis</italic> within-person evolution were in <xref ref-type="bibr" rid="bib79">Zhao et al., 2019</xref>. Of the 16 genes reported in that paper, 8 were assigned a functional COG category/cellular location and in the reference genome (NCTC_9343). Four of these were in outer membrane inorganic ion transport and metabolism, a significant enrichment (<inline-formula><mml:math id="inf80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1.22</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>; binomial test) (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>, <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>).</p></sec><sec id="s4-8"><title>Code availability</title><p>Code and simulation results are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/PaulTorrillo/Microbiome_Reversions">https://github.com/PaulTorrillo/Microbiome_Reversions</ext-link> (copy archived at <xref ref-type="bibr" rid="bib72">Torrillo, 2023</xref>).</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Formal analysis, Investigation, Visualization, Methodology, Writing – original draft</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Supervision, Funding acquisition, Investigation, Writing – original draft, Project administration</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Enrichment of stop adjacent codon usage in specific gene categories of <italic>Bacteroides fragilis</italic> NCTC_9343, related to <xref ref-type="fig" rid="fig4">Figure 4c</xref>.</title><p>Results display TTA/TCA enrichment for statistically significant categories of genes in <italic>B. fragilis</italic> NCTC_9343. Loci from these categories and mutated in <xref ref-type="bibr" rid="bib79">Zhao et al., 2019</xref> (Table S7) are noted in column J.</p></caption><media xlink:href="elife-93146-supp1-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>Genes assigned to COG categories in <italic>B. fragilis</italic> NCTC_9343 and their enrichment of stop-adjacent codons, related to <xref ref-type="fig" rid="fig4">Figure 4c</xref>.</title><p>List of genes assigned COG categories (via eggNOG) to be used to evaluate for closeness to stop codons. Cellular location is also given (if predicted) by PSORTb. Annotations are from Bakta.</p></caption><media xlink:href="elife-93146-supp2-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-93146-mdarchecklist1-v1.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>Code and results of simulations are available at Github repository <ext-link ext-link-type="uri" xlink:href="https://github.com/PaulTorrillo/Microbiome_Reversions">https://github.com/PaulTorrillo/Microbiome_Reversions</ext-link> (copy archived at <xref ref-type="bibr" rid="bib72">Torrillo, 2023</xref>).</p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank Daniel Fisher, two anonymous reviewers, Benjamin Good, Erik van Nimwegen, and all members of the Lieberman Lab for their thoughtful feedback on this manuscript. We also thank William Shoemaker for making the data used in this work easily accessible and for his feedback on the manuscript. This work was funded by a grant from the National Institutes of Health (1DP2GM140922-01 to TDL) and a fellowship for the National Sciences Foundation (to PAT).</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Álvarez-Carretero</surname><given-names>S</given-names></name><name><surname>Kapli</surname><given-names>P</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Beginner’s guide on the use of paml to detect positive selection</article-title><source>Molecular Biology and Evolution</source><volume>40</volume><elocation-id>msad041</elocation-id><pub-id pub-id-type="doi">10.1093/molbev/msad041</pub-id><pub-id pub-id-type="pmid">37096789</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ascensao</surname><given-names>JA</given-names></name><name><surname>Wetmore</surname><given-names>KM</given-names></name><name><surname>Good</surname><given-names>BH</given-names></name><name><surname>Arkin</surname><given-names>AP</given-names></name><name><surname>Hallatschek</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Quantifying the local adaptive landscape of a nascent bacterial community</article-title><source>Nature Communications</source><volume>14</volume><elocation-id>248</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-022-35677-5</pub-id><pub-id pub-id-type="pmid">36646697</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baker</surname><given-names>L</given-names></name><name><surname>Brown</surname><given-names>T</given-names></name><name><surname>Maiden</surname><given-names>MC</given-names></name><name><surname>Drobniewski</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Silent nucleotide polymorphisms and a phylogeny for Mycobacterium tuberculosis</article-title><source>Emerging Infectious Diseases</source><volume>10</volume><fpage>1568</fpage><lpage>1577</lpage><pub-id pub-id-type="doi">10.3201/eid1009.040046</pub-id><pub-id pub-id-type="pmid">15498158</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barber</surname><given-names>MF</given-names></name><name><surname>Elde</surname><given-names>NC</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Escape from bacterial iron piracy through rapid evolution of transferrin</article-title><source>Science</source><volume>346</volume><fpage>1362</fpage><lpage>1366</lpage><pub-id pub-id-type="doi">10.1126/science.1259329</pub-id><pub-id pub-id-type="pmid">25504720</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barreto</surname><given-names>HC</given-names></name><name><surname>Sousa</surname><given-names>A</given-names></name><name><surname>Gordo</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>The landscape of adaptive evolution of a gut commensal bacteria in aging mice</article-title><source>Current Biology</source><volume>33</volume><elocation-id>5272</elocation-id><pub-id pub-id-type="doi">10.1016/j.cub.2023.11.021</pub-id><pub-id pub-id-type="pmid">38052163</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barrick</surname><given-names>JE</given-names></name><name><surname>Lenski</surname><given-names>RE</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Genome dynamics during experimental evolution</article-title><source>Nature Reviews. Genetics</source><volume>14</volume><fpage>827</fpage><lpage>839</lpage><pub-id pub-id-type="doi">10.1038/nrg3564</pub-id><pub-id pub-id-type="pmid">24166031</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barroso-Batista</surname><given-names>J</given-names></name><name><surname>Demengeot</surname><given-names>J</given-names></name><name><surname>Gordo</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Adaptive immunity increases the pace and predictability of evolutionary change in commensal gut bacteria</article-title><source>Nature Communications</source><volume>6</volume><elocation-id>8945</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms9945</pub-id><pub-id pub-id-type="pmid">26615893</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bobay</surname><given-names>LM</given-names></name><name><surname>Ochman</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Factors driving effective population size and pan-genome evolution in bacteria</article-title><source>BMC Evolutionary Biology</source><volume>18</volume><elocation-id>153</elocation-id><pub-id pub-id-type="doi">10.1186/s12862-018-1272-4</pub-id><pub-id pub-id-type="pmid">30314447</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cantalapiedra</surname><given-names>CP</given-names></name><name><surname>Hernández-Plaza</surname><given-names>A</given-names></name><name><surname>Letunic</surname><given-names>I</given-names></name><name><surname>Bork</surname><given-names>P</given-names></name><name><surname>Huerta-Cepas</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>eggNOG-mapper v2: functional annotation, orthology assignments, and domain prediction at the metagenomic scale</article-title><source>Molecular Biology and Evolution</source><volume>38</volume><fpage>5825</fpage><lpage>5829</lpage><pub-id pub-id-type="doi">10.1093/molbev/msab293</pub-id><pub-id pub-id-type="pmid">34597405</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carmody</surname><given-names>RN</given-names></name><name><surname>Bisanz</surname><given-names>JE</given-names></name><name><surname>Bowen</surname><given-names>BP</given-names></name><name><surname>Maurice</surname><given-names>CF</given-names></name><name><surname>Lyalina</surname><given-names>S</given-names></name><name><surname>Louie</surname><given-names>KB</given-names></name><name><surname>Treen</surname><given-names>D</given-names></name><name><surname>Chadaideh</surname><given-names>KS</given-names></name><name><surname>Maini Rekdal</surname><given-names>V</given-names></name><name><surname>Bess</surname><given-names>EN</given-names></name><name><surname>Spanogiannopoulos</surname><given-names>P</given-names></name><name><surname>Ang</surname><given-names>QY</given-names></name><name><surname>Bauer</surname><given-names>KC</given-names></name><name><surname>Balon</surname><given-names>TW</given-names></name><name><surname>Pollard</surname><given-names>KS</given-names></name><name><surname>Northen</surname><given-names>TR</given-names></name><name><surname>Turnbaugh</surname><given-names>PJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Cooking shapes the structure and function of the gut microbiome</article-title><source>Nature Microbiology</source><volume>4</volume><fpage>2052</fpage><lpage>2063</lpage><pub-id pub-id-type="doi">10.1038/s41564-019-0569-4</pub-id><pub-id pub-id-type="pmid">31570867</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Castillo-Ramírez</surname><given-names>S</given-names></name><name><surname>Harris</surname><given-names>SR</given-names></name><name><surname>Holden</surname><given-names>MTG</given-names></name><name><surname>He</surname><given-names>M</given-names></name><name><surname>Parkhill</surname><given-names>J</given-names></name><name><surname>Bentley</surname><given-names>SD</given-names></name><name><surname>Feil</surname><given-names>EJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The impact of recombination on dN/dS within recently emerged bacterial clones</article-title><source>PLOS Pathogens</source><volume>7</volume><elocation-id>e1002129</elocation-id><pub-id pub-id-type="doi">10.1371/journal.ppat.1002129</pub-id><pub-id pub-id-type="pmid">21779170</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Castle</surname><given-names>SD</given-names></name><name><surname>Grierson</surname><given-names>CS</given-names></name><name><surname>Gorochowski</surname><given-names>TE</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Towards an engineering theory of evolution</article-title><source>Nature Communications</source><volume>12</volume><elocation-id>3326</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-021-23573-3</pub-id><pub-id pub-id-type="pmid">34099656</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Charlesworth</surname><given-names>J</given-names></name><name><surname>Eyre-Walker</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>The other side of the nearly neutral theory, evidence of slightly advantageous back-mutations</article-title><source>PNAS</source><volume>104</volume><fpage>16992</fpage><lpage>16997</lpage><pub-id pub-id-type="doi">10.1073/pnas.0705456104</pub-id><pub-id pub-id-type="pmid">17940029</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>DW</given-names></name><name><surname>Garud</surname><given-names>NR</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Rapid evolution and strain turnover in the infant gut microbiome</article-title><source>Genome Research</source><volume>32</volume><fpage>1124</fpage><lpage>1136</lpage><pub-id pub-id-type="doi">10.1101/gr.276306.121</pub-id><pub-id pub-id-type="pmid">35545448</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cock</surname><given-names>PJA</given-names></name><name><surname>Antao</surname><given-names>T</given-names></name><name><surname>Chang</surname><given-names>JT</given-names></name><name><surname>Chapman</surname><given-names>BA</given-names></name><name><surname>Cox</surname><given-names>CJ</given-names></name><name><surname>Dalke</surname><given-names>A</given-names></name><name><surname>Friedberg</surname><given-names>I</given-names></name><name><surname>Hamelryck</surname><given-names>T</given-names></name><name><surname>Kauff</surname><given-names>F</given-names></name><name><surname>Wilczynski</surname><given-names>B</given-names></name><name><surname>de Hoon</surname><given-names>MJL</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Biopython: freely available Python tools for computational molecular biology and bioinformatics</article-title><source>Bioinformatics</source><volume>25</volume><fpage>1422</fpage><lpage>1423</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp163</pub-id><pub-id pub-id-type="pmid">19304878</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cooper</surname><given-names>VS</given-names></name><name><surname>Lenski</surname><given-names>RE</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>The population genetics of ecological specialization in evolving <italic>Escherichia coli</italic> populations</article-title><source>Nature</source><volume>407</volume><fpage>736</fpage><lpage>739</lpage><pub-id pub-id-type="doi">10.1038/35037572</pub-id><pub-id pub-id-type="pmid">11048718</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Culyba</surname><given-names>MJ</given-names></name><name><surname>Van Tyne</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Bacterial evolution during human infection: Adapt and live or adapt and die</article-title><source>PLOS Pathogens</source><volume>17</volume><elocation-id>e1009872</elocation-id><pub-id pub-id-type="doi">10.1371/journal.ppat.1009872</pub-id><pub-id pub-id-type="pmid">34499699</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cvijović</surname><given-names>I</given-names></name><name><surname>Good</surname><given-names>BH</given-names></name><name><surname>Jerison</surname><given-names>ER</given-names></name><name><surname>Desai</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Fate of a mutation in a fluctuating environment</article-title><source>PNAS</source><volume>112</volume><fpage>E5021</fpage><lpage>E5028</lpage><pub-id pub-id-type="doi">10.1073/pnas.1505406112</pub-id><pub-id pub-id-type="pmid">26305937</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davies</surname><given-names>EK</given-names></name><name><surname>Peters</surname><given-names>AD</given-names></name><name><surname>Keightley</surname><given-names>PD</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>High frequency of cryptic deleterious mutations in <italic>Caenorhabditis elegans</italic></article-title><source>Science</source><volume>285</volume><fpage>1748</fpage><lpage>1751</lpage><pub-id pub-id-type="doi">10.1126/science.285.5434.1748</pub-id><pub-id pub-id-type="pmid">10481013</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davies</surname><given-names>J</given-names></name><name><surname>Davies</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Origins and evolution of antibiotic resistance</article-title><source>Microbiology and Molecular Biology Reviews</source><volume>74</volume><fpage>417</fpage><lpage>433</lpage><pub-id pub-id-type="doi">10.1128/MMBR.00016-10</pub-id><pub-id pub-id-type="pmid">20805405</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Desai</surname><given-names>MM</given-names></name><name><surname>Fisher</surname><given-names>DS</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Beneficial mutation selection balance and the effect of linkage on positive selection</article-title><source>Genetics</source><volume>176</volume><fpage>1759</fpage><lpage>1798</lpage><pub-id pub-id-type="doi">10.1534/genetics.106.067678</pub-id><pub-id pub-id-type="pmid">17483432</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Desai</surname><given-names>MM</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name><name><surname>Fisher</surname><given-names>DS</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Genetic diversity and the structure of genealogies in rapidly adapting populations</article-title><source>Genetics</source><volume>193</volume><fpage>565</fpage><lpage>585</lpage><pub-id pub-id-type="doi">10.1534/genetics.112.147157</pub-id><pub-id pub-id-type="pmid">23222656</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dewachter</surname><given-names>L</given-names></name><name><surname>Brooks</surname><given-names>AN</given-names></name><name><surname>Noon</surname><given-names>K</given-names></name><name><surname>Cialek</surname><given-names>C</given-names></name><name><surname>Clark-ElSayed</surname><given-names>A</given-names></name><name><surname>Schalck</surname><given-names>T</given-names></name><name><surname>Krishnamurthy</surname><given-names>N</given-names></name><name><surname>Versées</surname><given-names>W</given-names></name><name><surname>Vranken</surname><given-names>W</given-names></name><name><surname>Michiels</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Deep mutational scanning of essential bacterial proteins can guide antibiotic development</article-title><source>Nature Communications</source><volume>14</volume><elocation-id>241</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-023-35940-3</pub-id><pub-id pub-id-type="pmid">36646716</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dingle</surname><given-names>KE</given-names></name><name><surname>Colles</surname><given-names>FM</given-names></name><name><surname>Wareing</surname><given-names>DR</given-names></name><name><surname>Ure</surname><given-names>R</given-names></name><name><surname>Fox</surname><given-names>AJ</given-names></name><name><surname>Bolton</surname><given-names>FE</given-names></name><name><surname>Bootsma</surname><given-names>HJ</given-names></name><name><surname>Willems</surname><given-names>RJ</given-names></name><name><surname>Urwin</surname><given-names>R</given-names></name><name><surname>Maiden</surname><given-names>MC</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Multilocus sequence typing system for Campylobacter jejuni</article-title><source>Journal of Clinical Microbiology</source><volume>39</volume><fpage>14</fpage><lpage>23</lpage><pub-id pub-id-type="doi">10.1128/JCM.39.1.14-23.2001</pub-id><pub-id pub-id-type="pmid">11136741</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drake</surname><given-names>JW</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>A constant rate of spontaneous mutation in DNA-based microbes</article-title><source>PNAS</source><volume>88</volume><fpage>7160</fpage><lpage>7164</lpage><pub-id pub-id-type="doi">10.1073/pnas.88.16.7160</pub-id><pub-id pub-id-type="pmid">1831267</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Druelle</surname><given-names>V</given-names></name><name><surname>Neher</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Reversions to consensus are positively selected in HIV-1 and bias substitution rate estimates</article-title><source>Virus Evolution</source><volume>9</volume><elocation-id>veac118</elocation-id><pub-id pub-id-type="doi">10.1093/ve/veac118</pub-id><pub-id pub-id-type="pmid">36632482</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faith</surname><given-names>JJ</given-names></name><name><surname>Guruge</surname><given-names>JL</given-names></name><name><surname>Charbonneau</surname><given-names>M</given-names></name><name><surname>Subramanian</surname><given-names>S</given-names></name><name><surname>Seedorf</surname><given-names>H</given-names></name><name><surname>Goodman</surname><given-names>AL</given-names></name><name><surname>Clemente</surname><given-names>JC</given-names></name><name><surname>Knight</surname><given-names>R</given-names></name><name><surname>Heath</surname><given-names>AC</given-names></name><name><surname>Leibel</surname><given-names>RL</given-names></name><name><surname>Rosenbaum</surname><given-names>M</given-names></name><name><surname>Gordon</surname><given-names>JI</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The long-term stability of the human gut microbiota</article-title><source>Science</source><volume>341</volume><elocation-id>1237439</elocation-id><pub-id pub-id-type="doi">10.1126/science.1237439</pub-id><pub-id pub-id-type="pmid">23828941</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feder</surname><given-names>AF</given-names></name><name><surname>Kline</surname><given-names>C</given-names></name><name><surname>Polacino</surname><given-names>P</given-names></name><name><surname>Cottrell</surname><given-names>M</given-names></name><name><surname>Kashuba</surname><given-names>ADM</given-names></name><name><surname>Keele</surname><given-names>BF</given-names></name><name><surname>Hu</surname><given-names>SL</given-names></name><name><surname>Petrov</surname><given-names>DA</given-names></name><name><surname>Pennings</surname><given-names>PS</given-names></name><name><surname>Ambrose</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A spatio-temporal assessment of simian/human immunodeficiency virus (SHIV) evolution reveals A highly dynamic process within the host</article-title><source>PLOS Pathogens</source><volume>13</volume><elocation-id>e1006358</elocation-id><pub-id pub-id-type="doi">10.1371/journal.ppat.1006358</pub-id><pub-id pub-id-type="pmid">28542550</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feil</surname><given-names>EJ</given-names></name><name><surname>Cooper</surname><given-names>JE</given-names></name><name><surname>Grundmann</surname><given-names>H</given-names></name><name><surname>Robinson</surname><given-names>DA</given-names></name><name><surname>Enright</surname><given-names>MC</given-names></name><name><surname>Berendt</surname><given-names>T</given-names></name><name><surname>Peacock</surname><given-names>SJ</given-names></name><name><surname>Smith</surname><given-names>JM</given-names></name><name><surname>Murphy</surname><given-names>M</given-names></name><name><surname>Spratt</surname><given-names>BG</given-names></name><name><surname>Moore</surname><given-names>CE</given-names></name><name><surname>Day</surname><given-names>NPJ</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>How clonal is <italic>Staphylococcus aureus</italic>?</article-title><source>Journal of Bacteriology</source><volume>185</volume><fpage>3307</fpage><lpage>3316</lpage><pub-id pub-id-type="doi">10.1128/JB.185.11.3307-3316.2003</pub-id><pub-id pub-id-type="pmid">12754228</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gallet</surname><given-names>R</given-names></name><name><surname>Cooper</surname><given-names>TF</given-names></name><name><surname>Elena</surname><given-names>SF</given-names></name><name><surname>Lenormand</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Measuring selection coefficients below 10(-3): method, questions, and prospects</article-title><source>Genetics</source><volume>190</volume><fpage>175</fpage><lpage>186</lpage><pub-id pub-id-type="doi">10.1534/genetics.111.133454</pub-id><pub-id pub-id-type="pmid">22042578</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garud</surname><given-names>NR</given-names></name><name><surname>Good</surname><given-names>BH</given-names></name><name><surname>Hallatschek</surname><given-names>O</given-names></name><name><surname>Pollard</surname><given-names>KS</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Evolutionary dynamics of bacteria in the gut microbiome within and across hosts</article-title><source>PLOS Biology</source><volume>17</volume><elocation-id>e3000102</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.3000102</pub-id><pub-id pub-id-type="pmid">30673701</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ghosh</surname><given-names>OM</given-names></name><name><surname>Good</surname><given-names>BH</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Emergent evolutionary forces in spatial models of luminal growth and their application to the human gut microbiota</article-title><source>PNAS</source><volume>119</volume><elocation-id>e2114931119</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2114931119</pub-id><pub-id pub-id-type="pmid">35787046</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gillespie</surname><given-names>JH</given-names></name></person-group><year iso-8601-date="2004">2004</year><source>Population Genetics: A Concise Guide</source><publisher-name>JHU Press</publisher-name></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haigh</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1978">1978</year><article-title>The accumulation of deleterious genes in a population--Muller’s Ratchet</article-title><source>Theoretical Population Biology</source><volume>14</volume><fpage>251</fpage><lpage>267</lpage><pub-id pub-id-type="doi">10.1016/0040-5809(78)90027-8</pub-id><pub-id pub-id-type="pmid">746491</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haldane</surname><given-names>JBS</given-names></name></person-group><year iso-8601-date="1927">1927</year><article-title>A mathematical theory of natural and artificial selection, part v: Selection and mutation</article-title><source>Mathematical Proceedings of the Cambridge Philosophical Society</source><volume>23</volume><fpage>838</fpage><lpage>844</lpage><pub-id pub-id-type="doi">10.1017/S0305004100015644</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ho</surname><given-names>SYW</given-names></name><name><surname>Phillips</surname><given-names>MJ</given-names></name><name><surname>Cooper</surname><given-names>A</given-names></name><name><surname>Drummond</surname><given-names>AJ</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Time dependency of molecular rate estimates and systematic overestimation of recent divergence times</article-title><source>Molecular Biology and Evolution</source><volume>22</volume><fpage>1561</fpage><lpage>1568</lpage><pub-id pub-id-type="doi">10.1093/molbev/msi145</pub-id><pub-id pub-id-type="pmid">15814826</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>X</given-names></name><name><surname>Hall</surname><given-names>AB</given-names></name><name><surname>Arthur</surname><given-names>TD</given-names></name><name><surname>Plichta</surname><given-names>DR</given-names></name><name><surname>Covington</surname><given-names>CT</given-names></name><name><surname>Poyet</surname><given-names>M</given-names></name><name><surname>Crothers</surname><given-names>J</given-names></name><name><surname>Moses</surname><given-names>PL</given-names></name><name><surname>Tolonen</surname><given-names>AC</given-names></name><name><surname>Vlamakis</surname><given-names>H</given-names></name><name><surname>Alm</surname><given-names>EJ</given-names></name><name><surname>Xavier</surname><given-names>RJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Invertible promoters mediate bacterial phase variation, antibiotic resistance, and host adaptation in the gut</article-title><source>Science</source><volume>363</volume><fpage>181</fpage><lpage>187</lpage><pub-id pub-id-type="doi">10.1126/science.aau5238</pub-id><pub-id pub-id-type="pmid">30630933</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jolley</surname><given-names>KA</given-names></name><name><surname>Kalmusova</surname><given-names>J</given-names></name><name><surname>Feil</surname><given-names>EJ</given-names></name><name><surname>Gupta</surname><given-names>S</given-names></name><name><surname>Musilek</surname><given-names>M</given-names></name><name><surname>Kriz</surname><given-names>P</given-names></name><name><surname>Maiden</surname><given-names>MC</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Carried meningococci in the Czech Republic: a diverse recombining population</article-title><source>Journal of Clinical Microbiology</source><volume>38</volume><fpage>4492</fpage><lpage>4498</lpage><pub-id pub-id-type="doi">10.1128/JCM.38.12.4492-4498.2000</pub-id><pub-id pub-id-type="pmid">11101585</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jukes</surname><given-names>TH</given-names></name><name><surname>Cantor</surname><given-names>CR</given-names></name></person-group><year iso-8601-date="1969">1969</year><article-title>Evolution of protein molecules</article-title><source>Mammalian Protein Metabolism</source><volume>3</volume><fpage>21</fpage><lpage>132</lpage><pub-id pub-id-type="doi">10.1016/B978-1-4832-3211-9.50009-7</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kelsic</surname><given-names>ED</given-names></name><name><surname>Chung</surname><given-names>H</given-names></name><name><surname>Cohen</surname><given-names>N</given-names></name><name><surname>Park</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>HH</given-names></name><name><surname>Kishony</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>RNA structural determinants of optimal codons revealed by MAGE-Seq</article-title><source>Cell Systems</source><volume>3</volume><fpage>563</fpage><lpage>571</lpage><pub-id pub-id-type="doi">10.1016/j.cels.2016.11.004</pub-id><pub-id pub-id-type="pmid">28009265</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Key</surname><given-names>FM</given-names></name><name><surname>Khadka</surname><given-names>VD</given-names></name><name><surname>Romo-González</surname><given-names>C</given-names></name><name><surname>Blake</surname><given-names>KJ</given-names></name><name><surname>Deng</surname><given-names>L</given-names></name><name><surname>Lynn</surname><given-names>TC</given-names></name><name><surname>Lee</surname><given-names>JC</given-names></name><name><surname>Chiu</surname><given-names>IM</given-names></name><name><surname>García-Romero</surname><given-names>MT</given-names></name><name><surname>Lieberman</surname><given-names>TD</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>On-person adaptive evolution of <italic>Staphylococcus aureus</italic> during treatment for atopic dermatitis</article-title><source>Cell Host &amp; Microbe</source><volume>31</volume><fpage>593</fpage><lpage>603</lpage><pub-id pub-id-type="doi">10.1016/j.chom.2023.03.009</pub-id><pub-id pub-id-type="pmid">37054679</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kibota</surname><given-names>TT</given-names></name><name><surname>Lynch</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Estimate of the genomic mutation rate deleterious to overall fitness in <italic>E. coli</italic></article-title><source>Nature</source><volume>381</volume><fpage>694</fpage><lpage>696</lpage><pub-id pub-id-type="doi">10.1038/381694a0</pub-id><pub-id pub-id-type="pmid">8649513</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kimura</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1977">1977</year><article-title>Preponderance of synonymous changes as evidence for the neutral theory of molecular evolution</article-title><source>Nature</source><volume>267</volume><fpage>275</fpage><lpage>276</lpage><pub-id pub-id-type="doi">10.1038/267275a0</pub-id><pub-id pub-id-type="pmid">865622</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kolodny</surname><given-names>O</given-names></name><name><surname>Schulenburg</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Microbiome-mediated plasticity directs host evolution along several distinct time scales</article-title><source>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</source><volume>375</volume><elocation-id>20190589</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2019.0589</pub-id><pub-id pub-id-type="pmid">32772662</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Korem</surname><given-names>T</given-names></name><name><surname>Zeevi</surname><given-names>D</given-names></name><name><surname>Suez</surname><given-names>J</given-names></name><name><surname>Weinberger</surname><given-names>A</given-names></name><name><surname>Avnit-Sagi</surname><given-names>T</given-names></name><name><surname>Pompan-Lotan</surname><given-names>M</given-names></name><name><surname>Matot</surname><given-names>E</given-names></name><name><surname>Jona</surname><given-names>G</given-names></name><name><surname>Harmelin</surname><given-names>A</given-names></name><name><surname>Cohen</surname><given-names>N</given-names></name><name><surname>Sirota-Madi</surname><given-names>A</given-names></name><name><surname>Thaiss</surname><given-names>CA</given-names></name><name><surname>Pevsner-Fischer</surname><given-names>M</given-names></name><name><surname>Sorek</surname><given-names>R</given-names></name><name><surname>Xavier</surname><given-names>R</given-names></name><name><surname>Elinav</surname><given-names>E</given-names></name><name><surname>Segal</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Growth dynamics of gut microbiota in health and disease inferred from single metagenomic samples</article-title><source>Science</source><volume>349</volume><fpage>1101</fpage><lpage>1106</lpage><pub-id pub-id-type="doi">10.1126/science.aac4812</pub-id><pub-id pub-id-type="pmid">26229116</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koskella</surname><given-names>B</given-names></name><name><surname>Brockhurst</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Bacteria-phage coevolution as a driver of ecological and evolutionary processes in microbial communities</article-title><source>FEMS Microbiology Reviews</source><volume>38</volume><fpage>916</fpage><lpage>931</lpage><pub-id pub-id-type="doi">10.1111/1574-6976.12072</pub-id><pub-id pub-id-type="pmid">24617569</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kryazhimskiy</surname><given-names>S</given-names></name><name><surname>Plotkin</surname><given-names>JB</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>The population genetics of dN/dS</article-title><source>PLOS Genetics</source><volume>4</volume><elocation-id>e1000304</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1000304</pub-id><pub-id pub-id-type="pmid">19081788</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Labavić</surname><given-names>D</given-names></name><name><surname>Loverdo</surname><given-names>C</given-names></name><name><surname>Bitbol</surname><given-names>AF</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Hydrodynamic flow and concentration gradients in the gut enhance neutral bacterial diversity</article-title><source>PNAS</source><volume>119</volume><elocation-id>e2108671119</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2108671119</pub-id><pub-id pub-id-type="pmid">34969835</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levin</surname><given-names>BR</given-names></name><name><surname>Perrot</surname><given-names>V</given-names></name><name><surname>Walker</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Compensatory mutations, antibiotic resistance and the population genetics of adaptive evolution in bacteria</article-title><source>Genetics</source><volume>154</volume><fpage>985</fpage><lpage>997</lpage><pub-id pub-id-type="doi">10.1093/genetics/154.3.985</pub-id><pub-id pub-id-type="pmid">10757748</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lieberman</surname><given-names>TD</given-names></name><name><surname>Michel</surname><given-names>J-B</given-names></name><name><surname>Aingaran</surname><given-names>M</given-names></name><name><surname>Potter-Bynoe</surname><given-names>G</given-names></name><name><surname>Roux</surname><given-names>D</given-names></name><name><surname>Davis</surname><given-names>MR</given-names><suffix>Jr</suffix></name><name><surname>Skurnik</surname><given-names>D</given-names></name><name><surname>Leiby</surname><given-names>N</given-names></name><name><surname>LiPuma</surname><given-names>JJ</given-names></name><name><surname>Goldberg</surname><given-names>JB</given-names></name><name><surname>McAdam</surname><given-names>AJ</given-names></name><name><surname>Priebe</surname><given-names>GP</given-names></name><name><surname>Kishony</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Parallel bacterial evolution within multiple patients identifies candidate pathogenicity genes</article-title><source>Nature Genetics</source><volume>43</volume><fpage>1275</fpage><lpage>1280</lpage><pub-id pub-id-type="doi">10.1038/ng.997</pub-id><pub-id pub-id-type="pmid">22081229</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lieberman</surname><given-names>TD</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Detecting bacterial adaptation within individual microbiomes</article-title><source>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</source><volume>377</volume><elocation-id>20210243</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2021.0243</pub-id><pub-id pub-id-type="pmid">35989602</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>Z</given-names></name><name><surname>Good</surname><given-names>BH</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Dynamics of bacterial recombination in the human gut microbiome</article-title><source>PLOS Biology</source><volume>22</volume><elocation-id>e3002472</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.3002472</pub-id><pub-id pub-id-type="pmid">38329938</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Loo</surname><given-names>SL</given-names></name><name><surname>Ong</surname><given-names>A</given-names></name><name><surname>Kyaw</surname><given-names>W</given-names></name><name><surname>Thibaut</surname><given-names>LM</given-names></name><name><surname>Lan</surname><given-names>R</given-names></name><name><surname>Tanaka</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Nonsynonymous polymorphism counts in bacterial genomes: A comparative examination</article-title><source>Applied and Environmental Microbiology</source><volume>87</volume><elocation-id>e02002-20</elocation-id><pub-id pub-id-type="doi">10.1128/AEM.02002-20</pub-id><pub-id pub-id-type="pmid">33097502</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marvig</surname><given-names>RL</given-names></name><name><surname>Sommer</surname><given-names>LM</given-names></name><name><surname>Molin</surname><given-names>S</given-names></name><name><surname>Johansen</surname><given-names>HK</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Convergent evolution and adaptation of <italic>Pseudomonas aeruginosa</italic> within patients with cystic fibrosis</article-title><source>Nature Genetics</source><volume>47</volume><fpage>57</fpage><lpage>64</lpage><pub-id pub-id-type="doi">10.1038/ng.3148</pub-id><pub-id pub-id-type="pmid">25401299</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neher</surname><given-names>RA</given-names></name><name><surname>Shraiman</surname><given-names>BI</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Fluctuations of fitness distributions and the rate of Muller’s ratchet</article-title><source>Genetics</source><volume>191</volume><fpage>1283</fpage><lpage>1293</lpage><pub-id pub-id-type="doi">10.1534/genetics.112.141325</pub-id><pub-id pub-id-type="pmid">22649084</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nowick</surname><given-names>K</given-names></name><name><surname>Walter Costa</surname><given-names>MB</given-names></name><name><surname>Höner Zu Siederdissen</surname><given-names>C</given-names></name><name><surname>Stadler</surname><given-names>PF</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Selection pressures on RNA sequences and structures</article-title><source>Evolutionary Bioinformatics Online</source><volume>15</volume><elocation-id>1176934319871919</elocation-id><pub-id pub-id-type="doi">10.1177/1176934319871919</pub-id><pub-id pub-id-type="pmid">31496634</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ongenae</surname><given-names>V</given-names></name><name><surname>Mabrouk</surname><given-names>AS</given-names></name><name><surname>Crooijmans</surname><given-names>M</given-names></name><name><surname>Rozen</surname><given-names>D</given-names></name><name><surname>Briegel</surname><given-names>A</given-names></name><name><surname>Claessen</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Reversible bacteriophage resistance by shedding the bacterial cell wall</article-title><source>Open Biology</source><volume>12</volume><elocation-id>210379</elocation-id><pub-id pub-id-type="doi">10.1098/rsob.210379</pub-id><pub-id pub-id-type="pmid">35673854</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peterson</surname><given-names>GI</given-names></name><name><surname>Masel</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Quantitative prediction of molecular clock and ka/ks at short timescales</article-title><source>Molecular Biology and Evolution</source><volume>26</volume><fpage>2595</fpage><lpage>2603</lpage><pub-id pub-id-type="doi">10.1093/molbev/msp175</pub-id><pub-id pub-id-type="pmid">19661199</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Poret</surname><given-names>AJ</given-names></name><name><surname>Schaefers</surname><given-names>M</given-names></name><name><surname>Merakou</surname><given-names>C</given-names></name><name><surname>Mansour</surname><given-names>KE</given-names></name><name><surname>Lagoudas</surname><given-names>GK</given-names></name><name><surname>Cross</surname><given-names>AR</given-names></name><name><surname>Goldberg</surname><given-names>JB</given-names></name><name><surname>Kishony</surname><given-names>R</given-names></name><name><surname>Uluer</surname><given-names>AZ</given-names></name><name><surname>McAdam</surname><given-names>AJ</given-names></name><name><surname>Blainey</surname><given-names>PC</given-names></name><name><surname>Vargas</surname><given-names>SO</given-names></name><name><surname>Lieberman</surname><given-names>TD</given-names></name><name><surname>Priebe</surname><given-names>GP</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>De Novo Mutations Mediate Phenotypic Switching in an Opportunistic Human Lung Pathogen</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2024.02.06.579193</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robert</surname><given-names>L</given-names></name><name><surname>Ollion</surname><given-names>J</given-names></name><name><surname>Robert</surname><given-names>J</given-names></name><name><surname>Song</surname><given-names>X</given-names></name><name><surname>Matic</surname><given-names>I</given-names></name><name><surname>Elez</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Mutation dynamics and fitness effects followed in single cells</article-title><source>Science</source><volume>359</volume><fpage>1283</fpage><lpage>1286</lpage><pub-id pub-id-type="doi">10.1126/science.aan0797</pub-id><pub-id pub-id-type="pmid">29590079</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rocha</surname><given-names>EPC</given-names></name><name><surname>Smith</surname><given-names>JM</given-names></name><name><surname>Hurst</surname><given-names>LD</given-names></name><name><surname>Holden</surname><given-names>MTG</given-names></name><name><surname>Cooper</surname><given-names>JE</given-names></name><name><surname>Smith</surname><given-names>NH</given-names></name><name><surname>Feil</surname><given-names>EJ</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Comparisons of dN/dS are time dependent for closely related bacterial genomes</article-title><source>Journal of Theoretical Biology</source><volume>239</volume><fpage>226</fpage><lpage>235</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2005.08.037</pub-id><pub-id pub-id-type="pmid">16239014</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwengers</surname><given-names>O</given-names></name><name><surname>Jelonek</surname><given-names>L</given-names></name><name><surname>Dieckmann</surname><given-names>MA</given-names></name><name><surname>Beyvers</surname><given-names>S</given-names></name><name><surname>Blom</surname><given-names>J</given-names></name><name><surname>Goesmann</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Bakta: rapid and standardized annotation of bacterial genomes via alignment-free sequence identification</article-title><source>Microbial Genomics</source><volume>7</volume><elocation-id>000685</elocation-id><pub-id pub-id-type="doi">10.1099/mgen.0.000685</pub-id><pub-id pub-id-type="pmid">34739369</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sender</surname><given-names>R</given-names></name><name><surname>Fuchs</surname><given-names>S</given-names></name><name><surname>Milo</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Revised estimates for the number of human and bacteria cells in the body</article-title><source>PLOS Biology</source><volume>14</volume><elocation-id>e1002533</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1002533</pub-id><pub-id pub-id-type="pmid">27541692</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shoemaker</surname><given-names>WR</given-names></name><name><surname>Chen</surname><given-names>D</given-names></name><name><surname>Garud</surname><given-names>NR</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Comparative population genetics in the human gut microbiome</article-title><source>Genome Biology and Evolution</source><volume>14</volume><elocation-id>evab116</elocation-id><pub-id pub-id-type="doi">10.1093/gbe/evab116</pub-id><pub-id pub-id-type="pmid">34028530</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shopsin</surname><given-names>B</given-names></name><name><surname>Drlica-Wagner</surname><given-names>A</given-names></name><name><surname>Mathema</surname><given-names>B</given-names></name><name><surname>Adhikari</surname><given-names>RP</given-names></name><name><surname>Kreiswirth</surname><given-names>BN</given-names></name><name><surname>Novick</surname><given-names>RP</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Prevalence of agr dysfunction among colonizing <italic>Staphylococcus aureus</italic> strains</article-title><source>The Journal of Infectious Diseases</source><volume>198</volume><fpage>1171</fpage><lpage>1174</lpage><pub-id pub-id-type="doi">10.1086/592051</pub-id><pub-id pub-id-type="pmid">18752431</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Snitkin</surname><given-names>ES</given-names></name><name><surname>Zelazny</surname><given-names>AM</given-names></name><name><surname>Gupta</surname><given-names>J</given-names></name><collab>NISC Comparative Sequencing Program</collab><name><surname>Palmore</surname><given-names>TN</given-names></name><name><surname>Murray</surname><given-names>PR</given-names></name><name><surname>Segre</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Genomic insights into the fate of colistin resistance and Acinetobacter baumannii during patient treatment</article-title><source>Genome Research</source><volume>23</volume><fpage>1155</fpage><lpage>1162</lpage><pub-id pub-id-type="doi">10.1101/gr.154328.112</pub-id><pub-id pub-id-type="pmid">23564252</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sousa</surname><given-names>A</given-names></name><name><surname>Ramiro</surname><given-names>RS</given-names></name><name><surname>Barroso-Batista</surname><given-names>J</given-names></name><name><surname>Güleresi</surname><given-names>D</given-names></name><name><surname>Lourenço</surname><given-names>M</given-names></name><name><surname>Gordo</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Recurrent reverse evolution maintains polymorphism after strong bottlenecks in commensal gut bacteria</article-title><source>Molecular Biology and Evolution</source><volume>34</volume><fpage>2879</fpage><lpage>2892</lpage><pub-id pub-id-type="doi">10.1093/molbev/msx221</pub-id><pub-id pub-id-type="pmid">28961745</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sukhithasri</surname><given-names>V</given-names></name><name><surname>Nisha</surname><given-names>N</given-names></name><name><surname>Biswas</surname><given-names>L</given-names></name><name><surname>Anil Kumar</surname><given-names>V</given-names></name><name><surname>Biswas</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Innate immune recognition of microbial cell wall components and microbial strategies to evade such recognitions</article-title><source>Microbiological Research</source><volume>168</volume><fpage>396</fpage><lpage>406</lpage><pub-id pub-id-type="doi">10.1016/j.micres.2013.02.005</pub-id><pub-id pub-id-type="pmid">23578963</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tajima</surname><given-names>F</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Infinite-allele model and infinite-site model in population genetics</article-title><source>Journal of Genetics</source><volume>75</volume><fpage>27</fpage><lpage>31</lpage><pub-id pub-id-type="doi">10.1007/BF02931749</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tataru</surname><given-names>P</given-names></name><name><surname>Simonsen</surname><given-names>M</given-names></name><name><surname>Bataillon</surname><given-names>T</given-names></name><name><surname>Hobolth</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Statistical inference in the wright-fisher model using allele frequency data</article-title><source>Systematic Biology</source><volume>66</volume><fpage>e30</fpage><lpage>e46</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syw056</pub-id><pub-id pub-id-type="pmid">28173553</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Torrance</surname><given-names>EL</given-names></name><name><surname>Burton</surname><given-names>C</given-names></name><name><surname>Diop</surname><given-names>A</given-names></name><name><surname>Bobay</surname><given-names>LM</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Evolution of homologous recombination rates across bacteria</article-title><source>PNAS</source><volume>121</volume><elocation-id>e2316302121</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2316302121</pub-id><pub-id pub-id-type="pmid">38657048</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Torrillo</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>Microbiome reversions</data-title><version designator="swh:1:rev:70cb1d1484e57a0aa5cfdd719c705515d21e818e">swh:1:rev:70cb1d1484e57a0aa5cfdd719c705515d21e818e</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:cc5db861b46ab1ead5c8a80bf8a29598a614021a;origin=https://github.com/PaulTorrillo/Microbiome_Reversions;visit=swh:1:snp:c07f8832389fa1e5285bde66070bc62e19c69633;anchor=swh:1:rev:70cb1d1484e57a0aa5cfdd719c705515d21e818e">https://archive.softwareheritage.org/swh:1:dir:cc5db861b46ab1ead5c8a80bf8a29598a614021a;origin=https://github.com/PaulTorrillo/Microbiome_Reversions;visit=swh:1:snp:c07f8832389fa1e5285bde66070bc62e19c69633;anchor=swh:1:rev:70cb1d1484e57a0aa5cfdd719c705515d21e818e</ext-link></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trindade</surname><given-names>S</given-names></name><name><surname>Perfeito</surname><given-names>L</given-names></name><name><surname>Gordo</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Rate and effects of spontaneous mutations that affect fitness in mutator <italic>Escherichia coli</italic></article-title><source>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</source><volume>365</volume><fpage>1177</fpage><lpage>1186</lpage><pub-id pub-id-type="doi">10.1098/rstb.2009.0287</pub-id><pub-id pub-id-type="pmid">20308092</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vigué</surname><given-names>L</given-names></name><name><surname>Tenaillon</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Predicting the effect of mutations to investigate recent events of selection across 60,472 <italic>Escherichia coli</italic> strains</article-title><source>PNAS</source><volume>120</volume><elocation-id>e2304177120</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2304177120</pub-id><pub-id pub-id-type="pmid">37487088</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>RJ</given-names></name><name><surname>Al-Saffar</surname><given-names>SI</given-names></name><name><surname>Rogers</surname><given-names>J</given-names></name><name><surname>Hahn</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Human generation times across the past 250,000 years</article-title><source>Science Advances</source><volume>9</volume><elocation-id>eabm7047</elocation-id><pub-id pub-id-type="doi">10.1126/sciadv.abm7047</pub-id><pub-id pub-id-type="pmid">36608127</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name><name><surname>Nielsen</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Estimating synonymous and nonsynonymous substitution rates under realistic evolutionary models</article-title><source>Molecular Biology and Evolution</source><volume>17</volume><fpage>32</fpage><lpage>43</lpage><pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a026236</pub-id><pub-id pub-id-type="pmid">10666704</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>PAML 4: phylogenetic analysis by maximum likelihood</article-title><source>Molecular Biology and Evolution</source><volume>24</volume><fpage>1586</fpage><lpage>1591</lpage><pub-id pub-id-type="doi">10.1093/molbev/msm088</pub-id><pub-id pub-id-type="pmid">17483113</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>NY</given-names></name><name><surname>Wagner</surname><given-names>JR</given-names></name><name><surname>Laird</surname><given-names>MR</given-names></name><name><surname>Melli</surname><given-names>G</given-names></name><name><surname>Rey</surname><given-names>S</given-names></name><name><surname>Lo</surname><given-names>R</given-names></name><name><surname>Dao</surname><given-names>P</given-names></name><name><surname>Sahinalp</surname><given-names>SC</given-names></name><name><surname>Ester</surname><given-names>M</given-names></name><name><surname>Foster</surname><given-names>LJ</given-names></name><name><surname>Brinkman</surname><given-names>FSL</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>PSORTb 3.0: improved protein subcellular localization prediction with refined localization subcategories and predictive capabilities for all prokaryotes</article-title><source>Bioinformatics</source><volume>26</volume><fpage>1608</fpage><lpage>1615</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btq249</pub-id><pub-id pub-id-type="pmid">20472543</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>S</given-names></name><name><surname>Lieberman</surname><given-names>TD</given-names></name><name><surname>Poyet</surname><given-names>M</given-names></name><name><surname>Kauffman</surname><given-names>KM</given-names></name><name><surname>Gibbons</surname><given-names>SM</given-names></name><name><surname>Groussin</surname><given-names>M</given-names></name><name><surname>Xavier</surname><given-names>RJ</given-names></name><name><surname>Alm</surname><given-names>EJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Adaptive evolution within gut microbiomes of healthy people</article-title><source>Cell Host &amp; Microbe</source><volume>25</volume><fpage>656</fpage><lpage>667</lpage><pub-id pub-id-type="doi">10.1016/j.chom.2019.03.007</pub-id><pub-id pub-id-type="pmid">31028005</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>S</given-names></name><name><surname>Dai</surname><given-names>CL</given-names></name><name><surname>Evans</surname><given-names>ED</given-names></name><name><surname>Lu</surname><given-names>Z</given-names></name><name><surname>Alm</surname><given-names>EJ</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Tracking Strains Predicts Personal Microbiomes and Reveals Recent Adaptive Evolution</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.09.14.296970</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec sec-type="appendix" id="s8"><title>Supporting information</title><sec sec-type="appendix" id="s8-1"><title>1.1 d<sub>N</sub>/d<sub>S</sub> theory</title><p>The following is meant to provide a more in-depth walkthrough of how one can build up and interpret the purifying selection model and its effect of time dependence on d<sub>N</sub>/d<sub>S</sub>. To be accessible to a wide audience and self-contained, we have included enough detail that most sections should be followable with basic knowledge of calculus.</p><p>Assume an infinite population of organisms. Consider the existence of <inline-formula><mml:math id="inf81"><mml:mi>m</mml:mi></mml:math></inline-formula> classes of nonsynonymous mutations. The number of mutations of the <italic>i</italic>th class in the population is represented by the variable <inline-formula><mml:math id="inf82"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Each class <inline-formula><mml:math id="inf83"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> has an associated mutation rate <inline-formula><mml:math id="inf84"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (mutations per genome per generation per unit time) and an associated selective disadvantage <inline-formula><mml:math id="inf85"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (mutation purification per unit time). In the purifying selection model, we assume that <inline-formula><mml:math id="inf86"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf87"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. We assume that both the mutation rate and the selective disadvantage of each class remain constant throughout time. We assume this is the global population and hence no migration. We then have<disp-formula id="equ21"><label>(S1)</label><mml:math id="m21"><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math></disp-formula></p><p>Assuming <inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, we can integrate<disp-formula id="equ22"><mml:math id="m22"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Using u-substitution, we let <inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> so that <inline-formula><mml:math id="inf90"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> which implies <inline-formula><mml:math id="inf91"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> so that<disp-formula id="equ23"><mml:math id="m23"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>u</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Integrating both sides, we get<disp-formula id="equ24"><mml:math id="m24"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf92"><mml:mi>C</mml:mi></mml:math></inline-formula> is the constant of integration. Continuing we have<disp-formula id="equ25"><mml:math id="m25"><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula><disp-formula id="equ26"><mml:math id="m26"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula><disp-formula id="equ27"><mml:math id="m27"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We can remove the constant of integration and instead replace it with the initial condition <inline-formula><mml:math id="inf93"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula><disp-formula id="equ28"><mml:math id="m28"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>So, then we have that<disp-formula id="equ29"><mml:math id="m29"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>So that we get<disp-formula id="equ30"><mml:math id="m30"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Since <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> should occur in a homogeneous population that is the most recent common ancestor of the individuals in the population we are observing, we assume  <inline-formula><mml:math id="inf95"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0, so we have<disp-formula id="equ31"><label>(S2)</label><mml:math id="m31"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>If <inline-formula><mml:math id="inf96"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, we have<disp-formula id="equ32"><mml:math id="m32"><mml:mrow><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We also assume that there are synonymous mutations <inline-formula><mml:math id="inf97"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:math></inline-formula> that are neutral and occur with new mutations per unit time <inline-formula><mml:math id="inf98"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> so that<disp-formula id="equ33"><mml:math id="m33"><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>So, if we want to find <inline-formula><mml:math id="inf99"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:math></inline-formula> (the total number of nonsynonymous mutations), that will be given by<disp-formula id="equ34"><label>(S3)</label><mml:math id="m34"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Now observe the following with <italic>G</italic> as the number of base pairs in the core genome, then <inline-formula><mml:math id="inf100"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mn>3</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf101"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mover><mml:mi>S</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. The 2 comes from the fact that there are two diverged lineages when calculating d<sub>N</sub>/d<sub>S</sub>.<disp-formula id="equ35"><label>(S4)</label><mml:math id="m35"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mi>S</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow></mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The ⅓ is for normalization. While the above form is easier to analyze in terms of actual time, it should also be noted that data is given in terms of d<sub>S</sub> rather than <inline-formula><mml:math id="inf102"><mml:mi>t</mml:mi></mml:math></inline-formula> so the following equivalent form can also be helpful when discussing fitting of the timescale dependence of d<sub>N</sub>/d<sub>S</sub>:<disp-formula id="equ36"><mml:math id="m36"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>G</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Furthermore, we can rewrite <inline-formula><mml:math id="inf103"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mn>3</mml:mn><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> so that we have<disp-formula id="equ37"><mml:math id="m37"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>G</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Note <inline-formula><mml:math id="inf104"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is equivalent to <inline-formula><mml:math id="inf105"><mml:mi>α</mml:mi></mml:math></inline-formula> in the main text. Next, we can simply rewrite <inline-formula><mml:math id="inf106"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>G</mml:mi><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula> so that we have<disp-formula id="equ38"><label>(S5)</label><mml:math id="m38"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>To begin analyzing (S5), we consider the asymptotic behavior. First, we note that<disp-formula id="equ39"><label>(S6)</label><mml:math id="m39"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>S</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mo>+</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>For initial behavior, we can use L’Hopital’s rule<disp-formula id="equ40"><label>(S7)</label><mml:math id="m40"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>S</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mo>+</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Finally, we are interested in when d<sub>N</sub>/d<sub>S</sub> ends up being in between these initial and final values. Each class <inline-formula><mml:math id="inf107"><mml:mi>i</mml:mi></mml:math></inline-formula> has a different midpoint at which its contribution to d<sub>N</sub> /d<sub>S</sub> is a half. In mathematical terms, this can be summarized as<disp-formula id="equ41"><mml:math id="m41"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which implies<disp-formula id="equ42"><mml:math id="m42"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Thus, we see that for any class of mutation, <inline-formula><mml:math id="inf108"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula> will determine the midpoint (assuming some constant <inline-formula><mml:math id="inf109"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf110"><mml:mi>G</mml:mi></mml:math></inline-formula>). We can then imagine the curve as similar to a step function where the location of each step is determined by the corresponding <inline-formula><mml:math id="inf111"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula> and how far the function steps down will be determined by the size of the mutation rate <inline-formula><mml:math id="inf112"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Finally, we can surmise that the average step-down occurs at approximately the harmonic average<disp-formula id="equ43"><mml:math id="m43"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf113"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, which represents the total non-neutral nonsynonymous mutation rate. Taking this all into account, here is exactly what is being fit in the d<sub>N</sub>/d<sub>S</sub> curve. We are fitting the equation<disp-formula id="equ44"><label>(S8)</label><mml:math id="m44"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf114"><mml:mi>α</mml:mi></mml:math></inline-formula> is the fraction of nonsynonymous mutations that are neutral. Now <inline-formula><mml:math id="inf115"><mml:mi>β</mml:mi></mml:math></inline-formula> is a compound parameter and we can fit <inline-formula><mml:math id="inf116"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>G</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula> which is essentially half of the harmonic average of selective disadvantages in ratio with the synonymous mutation rate per site per generation. Now we can estimate the synonymous mutation per site per generation with the following:<disp-formula id="equ45"><mml:math id="m45"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:msup><mml:mfrac><mml:mrow><mml:mi>m</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>×</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mn>3</mml:mn><mml:mfrac><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>s</mml:mi><mml:mi>y</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>y</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>m</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:msup><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mi>s</mml:mi><mml:mi>y</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>y</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>m</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mo>×</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Thus, we are truly fitting<disp-formula id="equ46"><label>(S9)</label><mml:math id="m46"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mn>3</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:mo>×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>s</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mi>s</mml:mi><mml:mrow><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p></sec><sec sec-type="appendix" id="s8-2"><title>1.2 Mutation accumulation</title><p>To analyze genetic drift and Muller’s ratchet (<xref ref-type="bibr" rid="bib34">Haigh, 1978</xref>; <xref ref-type="bibr" rid="bib55">Neher and Shraiman, 2012</xref>), we will provide a brief overview of the approach well suited for our work. For any nonsynonymous mutation class <inline-formula><mml:math id="inf117"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> with <inline-formula><mml:math id="inf118"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, we can track the size of a population with 0 mutations of class <inline-formula><mml:math id="inf119"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, denoted by variable <inline-formula><mml:math id="inf120"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, via<disp-formula id="equ47"><label>(S10)</label><mml:math id="m47"><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf121"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is the average number of mutations of class <inline-formula><mml:math id="inf122"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> in the population and <inline-formula><mml:math id="inf123"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is equivalent to mean fitness. This equation reflects how every unit of time, the mutation-free class should increase by its selective advantage relative to the population though also loses members of the population to the mutation rate.</p><p>If we substitute in <inline-formula><mml:math id="inf124"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, we get<disp-formula id="equ48"><mml:math id="m48"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>d</mml:mi><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ49"><mml:math id="m49"><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ50"><mml:math id="m50"><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>So then<disp-formula id="equ51"><mml:math id="m51"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Assuming that <inline-formula><mml:math id="inf125"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> at time 0 is given by <inline-formula><mml:math id="inf126"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> (representing the initial population size which under our assumptions is always free of mutations and hence wild type), then<disp-formula id="equ52"><mml:math id="m52"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ53"><mml:math id="m53"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ54"><label>(S11)</label><mml:math id="m54"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We see that if we set <inline-formula><mml:math id="inf127"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>, then everything can be given in terms of frequencies within the population. Asymptotically, we have that<disp-formula id="equ55"><label>(S12)</label><mml:math id="m55"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Importantly, we also note the following: let <inline-formula><mml:math id="inf128"><mml:mi>W</mml:mi></mml:math></inline-formula> be the frequency of the wild type (mutation-free class) and <inline-formula><mml:math id="inf129"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>. Then,<disp-formula id="equ56"><label>(S13)</label><mml:math id="m56"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>W</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which implies<disp-formula id="equ57"><label>(S14)</label><mml:math id="m57"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mi>s</mml:mi></mml:mfrac></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Once again using<disp-formula id="equ58"><mml:math id="m58"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>And<disp-formula id="equ59"><mml:math id="m59"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Furthermore, the average time for the frequency in the population without mutations of class <italic>i</italic> to reach one-half of the logarithm of the asymptotic frequency is the same when using the above simplifications. In other words, the difference in how much and how fast the wild type is lost should not depend too heavily on the distribution of selective coefficients.</p><p>Finally, we can predict if the least-loaded class will be lost to drift. We can form this prediction via the following. We assume that if the least-loaded class <inline-formula><mml:math id="inf130"><mml:mi>W</mml:mi></mml:math></inline-formula> drops below its steady-state frequency, <inline-formula><mml:math id="inf131"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mi>s</mml:mi></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, it will have advantage <inline-formula><mml:math id="inf132"><mml:mi>s</mml:mi></mml:math></inline-formula> every generation. If the least-loaded class has advantage <inline-formula><mml:math id="inf133"><mml:mi>s</mml:mi></mml:math></inline-formula>, then it has a 2<italic>s</italic> probability of extinction (see Appendix 1, Section 2.1). Hence, if we expect there to be <inline-formula><mml:math id="inf134"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mi>s</mml:mi></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> individuals, we can estimate that mutation accumulation will occur when<disp-formula id="equ60"><label>(S15)</label><mml:math id="m60"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>2</mml:mn><mml:mi>s</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mi>s</mml:mi></mml:mfrac></mml:mrow></mml:msup><mml:mo>&lt;&lt;</mml:mo><mml:mn>1.</mml:mn></mml:mstyle></mml:mrow></mml:math></disp-formula></p></sec><sec sec-type="appendix" id="s8-3"><title>2.1. Extinction and fixation probability</title><p>Here, we will derive how the fixation probability of a mutation with selective advantage <inline-formula><mml:math id="inf135"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is approximately <inline-formula><mml:math id="inf136"><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. This is a standard result that can be found in classic population genetics textbooks. It is usually derived via differential equations but can also be obtained more classically from the study of branching processes (<xref ref-type="bibr" rid="bib35">Haldane, 1927</xref>) ,which we will use here. First, we assume that individuals reproduce via a Galton–Watson branching process with mean of 1 + <inline-formula><mml:math id="inf137"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. We also assume there are no other mutations in the population that can interfere with fixation or extinction. A fundamental result from the study of branching processes is that the extinction probability is given by the smallest non-negative root of the branching processes corresponding probability generating function, <italic>f</italic>(<italic>z</italic>). Being a Galton–Watson branching process, the probability generating function is the probability generating function of a Poisson process so<disp-formula id="equ61"><mml:math id="m61"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Thus, we need to find the smallest non-negative solution, <italic>z</italic>, to<disp-formula id="equ62"><mml:math id="m62"><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0.</mml:mn></mml:mrow></mml:math></disp-formula></p><p>We can use a second-order Taylor approximation to approximate the exponential so we have<disp-formula id="equ63"><mml:math id="m63"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mn>2</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0.</mml:mn></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which has the smallest non-negative solution of<disp-formula id="equ64"><mml:math id="m64"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>If <inline-formula><mml:math id="inf138"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is small, then we have<disp-formula id="equ65"><mml:math id="m65"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>z</mml:mi><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which we can further approximate by doing<disp-formula id="equ66"><label>(S16)</label><mml:math id="m66"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>z</mml:mi><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>≈</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>If <inline-formula><mml:math id="inf139"><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the extinction probability, then the fixation probability will be <inline-formula><mml:math id="inf140"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec sec-type="appendix" id="s8-4"><title>2.2. Likelihood of reversion</title><p>We calculate the time for mutations to occur and fix in the population for demonstration in <xref ref-type="fig" rid="fig3">Figure 3b</xref>. For the sake of simplicity, we consider the weak-mutation strong selection regime (no clonal interference) in our theory but do include such dynamics in our simulations. Regardless, clonal interference will only minorly change the frequency of a revertant with high <inline-formula><mml:math id="inf141"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> in the population as multiple backgrounds will find the same reversion when <inline-formula><mml:math id="inf142"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is sufficiently high. The expected time to fixation given a mutation with selective coefficient <inline-formula><mml:math id="inf143"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is estimated using<disp-formula id="equ67"><mml:math id="m67"><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf144"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the census population size. The above implies<disp-formula id="equ68"><mml:math id="m68"><mml:mrow><mml:mi>t</mml:mi><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>And if <inline-formula><mml:math id="inf145"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is small, then we have<disp-formula id="equ69"><label>(S17)</label><mml:math id="m69"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Now we need to know the expected time for a fixing mutant to arise. First, we want the probability the mutation arises and fixes, which will be given by<disp-formula id="equ70"><mml:math id="m70"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>≈</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This implies the expected time to arrive is approximately<disp-formula id="equ71"><label>(S18)</label><mml:math id="m71"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>So, therefore, in the absence of clonal interference, the time for reversion to fix in the population depends more on the time for it to fix over time than the time for the reversion to arise (and is, therefore, less dependent on the mutation rate) if<disp-formula id="equ72"><mml:math id="m72"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mfrac><mml:mrow><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Alternatively written as<disp-formula id="equ73"><label>(S19)</label><mml:math id="m73"><mml:mrow><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Finally, note that the expected time to fixation is given by<disp-formula id="equ74"><label>(S20)</label><mml:math id="m74"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The second term can be larger because of bottlenecks and clonal interference.</p></sec><sec sec-type="appendix" id="s8-5"><title>3.1 Reversion model with fluctuating loci</title><p>The reversion model can be derived in the following way. First, one can rewrite <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> as a generic negative feedback model in which mutations emerge and are purged from the population at a rate proportional to how many mutations have accumulated:<disp-formula id="equ75"><label>(S21)</label><mml:math id="m75"><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In this formulation, <italic>R</italic><sub><italic>in</italic></sub> is simply the rate of accumulation of transient non-neutral nonsynonymous mutations per genome per unit time and <italic>P</italic><sub><italic>out</italic></sub> is the loss rate of these mutations per unit time.</p><p>From this more general form, we can develop the reversion model. Similar to the original purifying selection model, it is possible to assume a variety of classes of mutations, but for simplicity, we only assume 1. If we make the following definitions for<disp-formula id="equ76"><mml:math id="m76"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ77"><mml:math id="m77"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>we can link <xref ref-type="disp-formula" rid="equ75">Equation S21</xref> to a fluctuating loci model via<disp-formula id="equ78"><label>(S22)</label><mml:math id="m78"><mml:mrow><mml:mtable columnalign="center center" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd></mml:mtr></mml:mtable><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf146"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represents the average number of generations it takes for a <italic>given</italic> selective pressure on a locus to switch direction, and <inline-formula><mml:math id="inf147"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, the number of loci under fluctuating selective pressures. <xref ref-type="disp-formula" rid="equ78">Equation S22</xref> can be more directly linked to a fluctuating loci model as we see the rate of nonsynonymous mutations is proportional to <inline-formula><mml:math id="inf148"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (the number of loci unmutated) and the rate out is proportional to <inline-formula><mml:math id="inf149"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> the number of loci mutated.</p><p>Solving similar to the purifying selection model, we have<disp-formula id="equ79"><label>(S23)</label><mml:math id="m79"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>This can then be used to obtain d<sub>N</sub>/d<sub>S</sub><disp-formula id="equ80"><mml:math id="m80"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Or equivalently<disp-formula id="equ81"><mml:math id="m81"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>G</mml:mi><mml:mi>d</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>G</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>If we set <inline-formula><mml:math id="inf150"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mn>3</mml:mn><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf151"><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula> so that<disp-formula id="equ82"><label>(S24)</label><mml:math id="m82"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mi>γ</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mi>d</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which is equivalent to <xref ref-type="disp-formula" rid="equ46">Equation S9</xref> with one more free parameter.</p></sec><sec sec-type="appendix" id="s8-6"><title>3.2 Effect of compensatory mutations</title><p>We can further extend the theory to include compensatory mutations by calculating the expected value of <inline-formula><mml:math id="inf152"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> as a Markov chain. First, let <inline-formula><mml:math id="inf153"><mml:mi>v</mml:mi></mml:math></inline-formula> be the state vector for a locus under selection where the index of each row corresponds to the number of observed mutations currently at that locus and <inline-formula><mml:math id="inf154"><mml:mi>A</mml:mi></mml:math></inline-formula> be the corresponding stochastic matrix with rows <italic>i</italic> and columns <inline-formula><mml:math id="inf155"><mml:mi>j</mml:mi></mml:math></inline-formula>. First, we need to consider the probability the state does not change on a given generation (i.e., the diagonal of <inline-formula><mml:math id="inf156"><mml:mi>A</mml:mi></mml:math></inline-formula>). This will be <inline-formula><mml:math id="inf157"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula>. For every element on the diagonal of <inline-formula><mml:math id="inf158"><mml:mi>A</mml:mi></mml:math></inline-formula>, we thus have <inline-formula><mml:math id="inf159"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula>.</p><p>Supposing there is a state change, let us define <inline-formula><mml:math id="inf160"><mml:mi>p</mml:mi></mml:math></inline-formula> as the probability there is an increase in observed mutations (a forward or compensatory mutation) and <inline-formula><mml:math id="inf161"><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:math></inline-formula>, the probability there is a decrease in observed mutations (a reversion). Then, <inline-formula><mml:math id="inf162"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>p</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf163"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> (with the exception of <inline-formula><mml:math id="inf164"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula>). Finally, with <inline-formula><mml:math id="inf165"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> being the number of time steps and assuming <inline-formula><mml:math id="inf166"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf167"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, then<disp-formula id="equ83"><label>(S25)</label><mml:math id="m83"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>If <inline-formula><mml:math id="inf168"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, compensatory mutations are gained at a linear rate and the compensatory mutation rate will factor into the asymptotic d<sub>N</sub>/d<sub>S</sub> value. Conversely, if <inline-formula><mml:math id="inf169"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, the number of compensatory mutations is almost surely finite by the central limit theorem and hence will not factor into the asymptotic d<sub>N</sub>/d<sub>S</sub>. Finally, if <inline-formula><mml:math id="inf170"><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:math></inline-formula>, this is the classic elementary random walk well known to deviate from the origin with <inline-formula><mml:math id="inf171"><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo>)</mml:mo></mml:math></inline-formula>. Interestingly, this is also sublinear and will not factor into asymptotic d<sub>N</sub>/d<sub>S</sub>.</p></sec><sec sec-type="appendix" id="s8-7"><title>3.3 Reversion model starting from equilibrium conditions</title><p>Our simulations and theory assume that the initial population starts with no forward mutations (i.e., WT) for simplicity. However, starting at equilibrium conditions does not impact the shape of the curve. The intuition here is that while starting from equilibrium enables the identification of reversions of initially transient mutations, these will be subsequently hidden by parallel evolution. Noting <xref ref-type="disp-formula" rid="equ79">Equation S23</xref>, we have that for our simulations and base theory:<disp-formula id="equ84"><label>(S26)</label><mml:math id="m84"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We can show the same result occurs starting at equilibrium conditions. A Python script confirming the algebra is available on the GitHub repository. First, let there be three states a given locus can be in. The first state (<italic>i</italic> = 1) will be initial transient mutations, the second state (<italic>i</italic> = 2) will be ancestral alleles, and the third state (<italic>i</italic> = 3) will be subsequent transient mutations. We can then build a transition matrix:<disp-formula id="equ85"><label>(S27)</label><mml:math id="m85"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnalign="center center center" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mtd><mml:mtd><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>0</mml:mn></mml:mstyle></mml:mtd><mml:mtd><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mtd><mml:mtd><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We can then use the transition matrix to find the probability of being in a state at any given time via the matrix exponential, which is<disp-formula id="equ86"><label>(S28)</label><mml:math id="m86"><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnalign="center center center" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mi>t</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:mstyle></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mi>t</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:mstyle></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Now note that we can use <inline-formula><mml:math id="inf172"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> to find the probability of being in a given state <italic>j</italic> after starting at initial state <italic>i</italic>. First, let us calculate expected d<sub>N</sub> at a locus that started from the ancestral allele and has subsequently diverged for time <italic>t</italic>. Take note that subsequent transient mutations are assumed to be distinct (i.e., they will always lead to at least one difference when compared to a different lineage).<disp-formula id="equ87"><label>(S29)</label><mml:math id="m87"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Now let us calculate <inline-formula><mml:math id="inf173"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> assuming the allele was initially a transient mutation.<disp-formula id="equ88"><label>(S30)</label><mml:math id="m88"><mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Noting that we have assumed equal rates of forward and reverse adaptations throughout, the equilibrium would be composed of <inline-formula><mml:math id="inf174"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>/2 initially ancestral loci and of <inline-formula><mml:math id="inf175"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>/2 initially transient loci. Working through all of the algebra, we find<disp-formula id="equ89"><mml:math id="m89"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ90"><mml:math id="m90"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ91"><mml:math id="m91"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p> </sec></sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.93146.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Cooper</surname><given-names>Vaughn S</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01an3r305</institution-id><institution>University of Pittsburgh</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group></front-stub><body><p>This valuable study addresses the interpretation of patterns of synonymous and nonsynonymous diversity in microbial genomes. The authors present solid theoretical and computational evidence that adaptive mutations that revert the amino acids to an earlier state can significantly impact the observed ratios of synonymous and nonsynonymous mutations in human commensal bacteria. This article will be of interest to microbiologists with a background in evolution and to researchers studying the human microbiome.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.93146.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Cooper</surname><given-names>Vaughn S</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01an3r305</institution-id><institution>University of Pittsburgh</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Fisher</surname><given-names>Daniel S</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00f54p054</institution-id><institution>Stanford University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Reversions mask the contribution of adaptive evolution in microbiomes&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation has been overseen by Detlef Weigel as the Senior Editor.</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions (for the authors):</p><p>1) Address how recombination affects assumptions of your model, which invokes Muller's Ratchet to necessitate back–mutation. In effect, recombination of the wild–type allele is equivalent to back–mutation, but recombination can also revert or incorporate multiple linked variants at once and alter the assumptions of your model and analyses. As recombination tends to bring in many more mutations overall than occur in regions of a pair of genomes with asexual ancestry, the effects cannot be neglected. To what extent can this give rise to a similar dependence of dN/dS on dS as seen in the data?</p><p>2) Clarify the underlying assumptions of the model (e.g., the fitting parameters nloci and Tadapt), its theoretical results, and experimental applications. In addition, it clarifies the environmental conditions used for simulations, which could involve colonization of new hosts or environments, affect selection at many sites at once, and lead to clonal interference.</p><p>3) Evaluate the alternative that many compensatory mutations that could phenotypically revert an earlier mutation might overcome the exact specific reversion mutation in greater detail, including whether clonal interference between compensatory and reversion mutations would result in the mutations with the largest s – eg, as mentioned, reversion of a stop codon – being much more likely to sweep. Additional discussion of this important issue would be valuable.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>This study makes a substantial contribution to our understanding of the molecular evolutionary dynamics of microbial genomes by proposing a model that incorporates relatively frequent adaptive reversion mutations. In many ways, this makes sense from my own experience with evolutionary genomic data of microbes, where reversions are surprisingly familiar as evidence of the immense power of selection in large populations.</p><p>One criticism is the reliance on one major data set of B. fragilis to test fits of these models, but this is relatively minor in my opinion and can be caveated by discussion of other relevant datasets for parallel investigation.</p><p>Another point is that this problem isn't as new as the manuscript indicates, see for example https://journals.asm.org/doi/10.1128/aem.02002–20.</p><p>Nonetheless, the paper succeeds by both developing theory and offering concrete parameters to illustrate the magnitudes of the problems that distinguish competing ideas, for example, the risk of mutational load posed in the absence of frequent back mutation.</p><p>Please expand the discussion of the novelty of incorporating (or overlooking) reversion mutations as well as the broader problems of dN/dS metrics for population–wide data where fixation is rare.</p><p>I'm otherwise enthusiastic about this study.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>This manuscript asks how different forms of selection affect the patterns of genetic diversity in microbial populations. One popular metric used to infer signatures of selection is dN/dS, the ratio of nonsynonymous to synonymous distances between two genomes. Previous observations across many bacterial species have found dN/dS decreases with dS, which is a proxy for the divergence time. The most common interpretation of this pattern was proposed by Rocha et al. (2006), who suggested the excess in nonsynonymous mutations on short divergence times represent transient deleterious mutations that have not yet been purged by selection.</p><p>In this study, the authors propose an alternative model based on the population structure of human gut bacteria, in which dN is dominated by selective sweeps of SNPs that revert previous mutations within local populations. The authors argue that contrary to standard population genetics models, which are based on the population dynamics of large eukaryotes, the large populations in the human gut mean that reversions may be quite common and may have a large impact on evolutionary dynamics. They show that such a model can fit the decrease of dN/dS in time at least as well as the purifying selection model.</p><p>Strengths</p><p>The main strength of the manuscript is to show that adaptive sweeps in gut microbial populations can lead to small dN/dS. While previous work has shown that using dN/dS to infer the strength of selection within a population is problematic (see Kryazhimskiy and Plotkin, 2008, cited in the paper) the particular mechanism proposed by the authors is new to my knowledge. In addition, despite the known caveats, dN/dS values are still routinely reported in studies of microbial evolution, and so their interpretation should be of considerable interest to the community.</p><p>The authors provide compelling justification for the importance of adaptive reversions and make a good case that these need to be carefully considered by future studies of microbial evolution. The authors show that their model can fit the data as well as the standard model based on purifying selection and the parameters they infer appear to be plausible given known data. More generally, I found the discussion on the implications of traditional population genetics models in the context of human gut bacteria to be a valuable contribution of the paper.</p><p>Weaknesses</p><p>The authors argue that the purifying selection model would predict a gradual loss in fitness via Muller's ratchet. This is true if recombination is ignored, but this assumption is inconsistent with the data from Garud, et al. (2019) cited in the manuscript, who showed a significant linkage decrease in the bacteria also used in this study.</p><p>I also found that the data analysis part of the paper added little new to what was previously known. Most of the data comes directly from the Garud et al. study and the analysis is very similar as well. Even if other appropriate data may not currently be available, I feel that more could be done to test specific predictions of the model with more careful analysis.</p><p>Finally, I found the description of the underlying assumptions of the model and the theoretical results difficult to understand. I could not, for example, relate the fitting parameters nloci and Tadapt to the simulations after reading the main text and the supplement. In addition, it was not clear to me if simulations involved actual hosts or how the changes in selection coefficients for different sites was implemented. Note that these are not simply issues of exposition since the specific implementation of the model could conceivably lead to different results. For example, if the environmental change is due to the colonization of a different host, it would presumably affect the selection coefficients at many sites at once and lead to clonal interference. Related to this point, it was also not clear that the weak mutation strong selection assumption is consistent with the microscopic parameters of the model. The authors also mention that &quot;superspreading&quot; may somehow make a difference to the probability of maintaining the least loaded class in the purifying selection model, but what they mean by this was not adequately explained.</p><p>I see three main issues that would significantly improve the manuscript if addressed. The first is the issue of recombination, which undermines using Muller's ratchet to motivate the proposed model. Including the effects of recombination in the model would be a significant project in itself so I do not expect the authors to do that, but I do believe it is important that the issue be seriously addressed. In any case, I think the fact that the values of s implied by the purifying selection model are so small is already problematic, for many of the reasons discussed in the paper, so I would suggest focusing more on that. It might be more useful perhaps to demonstrate in simulations how even rare adaptive sweeps would affect the purging of deleterious mutations with small s, which is mentioned in the manuscript but not developed.</p><p>The second issue I found is the data analysis. It would be useful to check some of the hypotheses raised in the text directly from the data. For example, the authors mention that premature stop codons may preferentially be subject to reversions, which could be verified. Even if these analyses do not directly support the model, the authors can still comment on them and I believe it would significantly add to the paper.</p><p>Finally, I found the presentation of the model and simulations to be confusing and feel that it needs to be made significantly clearer for readers to be able to understand. In general, the supplement had considerable detail on standard results (Sec. 2.1 and 2.2 for example), but was very vague on the actual model itself (Sec. 3.1 and 3.2). If anything, this emphasis should be reversed. I've added some more specific comments below which might help with this issue. It should also be noted that the inferred values of s from any simple model will be effective parameters that may not be directly related to measurable parameters from experiments or observations. To give a very simple example, if selection coefficients are varying quickly in time, the relevant s for the accumulation of mutations would be the time average s, which may be considerably smaller than the typical value.</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>The diversity of bacterial species in the human gut microbiome is widely known, but the extensive diversity within each species is far less appreciated. Strains found in individuals on opposite sides of the globe can differ by as little as handfuls of mutations, while strains found in an individual's gut, or in the same household, might have a common ancestor tens of thousands of years ago. What are the evolutionary, ecological, and transmission dynamics that established and maintain this diversity?</p><p>The time, T, since the common ancestor of two strains, can be directly inferred by comparing their core genomes and finding the fraction of synonymous (non–amino acid changing) sites at which they differ: dS. With the per–site per–generation mutation rate, μ, and the mean generation times roughly known, this directly yields T (albeit with substantial uncertainty of the generation time.) A traditional way to probe the extent to which selection plays a role is to study pairs of strains and compare the fraction of non–synonymous (amino acid or stop–codon changing) sites, dN, at which the strains differ with their dS. Small dN/dS, as found between distantly related strains, is attributed to purifying selection against deleterious mutations dominating over mutations that have driven adaptive evolution. Large dN/dS as found in laboratory evolution experiments, is caused by beneficial mutations that quickly arise in large bacterial populations, and, with substantial selective advantages, per generation, can rise to high abundance fast enough that very few synonymous mutations arise in the lineages that take over the population.</p><p>A number of studies (including by Lieberman's group) have analyzed large numbers of strains of various dominant human gut species and studied how dN/dS varies. Although between closely related strains the variations are large – often much larger than attributable to just statistical variations – a systematic trend from dN/dS around unity or larger for close relatives to dN/dS ~ 0.1 for more distant relatives has been found in enough species that it is natural to conjecture a general explanation.</p><p>The conventional explanation is that, for close relatives, the effects of selection over the time since they diverged has not yet purged weakly deleterious mutations that arose by chance – roughly mutations with sT&lt;1 – while since the common ancestor of more distantly related strains, there is plenty of time for most of those that arose to have been purged.</p><p>Torrillo and Lieberman have carried out an in–depth – sophisticated and quantitative – analysis of models of some of the evolutionary processes that shape the dependence of dN/dS on dS – and hence on their divergence time, T. They first review the purifying selection model and show that – even ignoring its inability to explain dN/dS &gt; 1 for many closely related pairs – the model has major problems explaining the crossover from dN/dS somewhat less than unity to much smaller values as dS goes through – on a logarithmic scale – the 10^–4 range. The first problem, already seen in the infinite–population–size deterministic model, is that a very large fraction of non–synonymous mutations would have to have deleterious s's in the 10^–5 per generation range to fit the data (and a small fraction effectively neutral). As the s's are naturally expected (at least in the absence of quantitative analysis to the contrary) to be spread out over a wide range on a logarithmic scale of s, this seems implausible. But the authors go further and analyze the effects of fluctuations that occur even in the very large populations: ~ &gt;10^12 bacteria per species in one gut, and 10^10 human guts globally. They show that Muller's ratchet – the gradual accumulation of weakly deleterious mutations that are not purged by selection – leads to a mutational meltdown with the parameters needed to fit the purifying selection model. In particular, with N_e the &quot;effective population size&quot; that roughly parametrizes the magnitude of stochastic birth–death and transition fluctuations, and U the total mutation rate to such deleterious mutations this occurs for U/s &gt; log(sN_e) which they show would obtain with the fitted parameters.</p><p>Torrillo and Lieberman promise an alternate model: that there are a modest number of &quot;loci&quot; at which conditionally beneficial mutations can occur that are beneficial in some individual guts (or other environmental conditions) at some times, but deleterious in other (or the same) gut at other times. With the ancestors of a pair of strains having passed through one too many individuals and transmissions, it is possible for a beneficial mutation to occur and rise in the population, only later to be reverted by the beneficial inverse mutation. With tens of loci at which this can occur, they show that this process could explain the drop of dN/dS from short times – in which very few such mutations have occurred – to very long times by which most have flipped back and forth so that a random pair of strains will have the same nucleotide at such sites with 50% probability. Their qualitative analysis of a minimally simple model of this process shows that the bacterial populations are plenty big enough for such specific mutations to occur many times in each individual's gut, and with modest beneficials, to takeover. With a few of these conditionally beneficial mutations or reversions occurring during an individuals lifetime, they get a reasonably quantitative agreement with the dN/dS vs dS data with very few parameters. A key assumption of their model is that genetically exact reversion mutations are far more likely to takeover a gut population – and spread – than compensatory mutations which have a similar phenotypic–reversion effect: a mutation that is reverted does not show up in dN, while one that is compensated by another shows up as a two–mutation difference after the environment has changed twice.</p><p>Strengths:</p><p>The quantitative arguments made against the conventional purifying selection model are highly compelling, especially the consideration of multiple aspects that are usually ignored, including – crucially – how Muller's ratchet arises and depends on the realistic and needed–to–fit parameters; the effects of bottlenecks in transmission and the possibility that purifying selection mainly occurs then; and complications of the model of a single deleterious s, to include a distribution of selective disadvantages. Generally, the author's approach of focusing on the simplest models with as few as possible parameters (some roughly known), and then adding in various effects one–by–one, is outstanding and, in being used to analyze environmental microbial data, exceptional.</p><p>The reversion model the authors propose and study is a simple general one and they again explore carefully various aspects of it – including dynamics within and between hosts – and the consequent qualitative and quantitative effects. Again, the quantitive analysis of almost all aspects is exemplary. Although it is hard to make a compelling guess of the number of loci that are subject to alternating selection on the needed time–scales (years to centuries) they make a reasonable argument for a lower bound in terms of the number of known invertible promoters (that can genetically switch gene expression on and off).</p><p>Weaknesses:</p><p>The primary weakness of this paper is one that the author's are completely open about: the assumption that, collectively, any of possibly–many compensatory mutations that could phenotypically revert an earlier mutation, are less likely to arise and takeover local populations than the exact specific reversion mutation. While detailed analysis of this is, reasonably enough, beyond the scope of the present paper, more discussion of this issue would add substantially to this work. Quantitatively, the problem is that even a modest number of compensatory mutations occurring as the environmental pressures change could lead to enough accumulation of non–synonymous mutations that they could cause dN/dS to stay large – easily &gt;1 – to much larger dS than is observed. If, say, the appropriate locus is a gene, the number of combinations of mutations that are better in each environment would play a role in how large dN would saturate to in the steady state (1/2 of n_loci in the author's model). It is possible that clonal interference between compensatory and reversion mutations would result in the mutations with the largest s – eg, as mentioned, reversion of a stop codon – being much more likely to take over, and this could limit the typical number of differences between quite well–diverged strains. However, the reversion and subsequent re–reversion would have to both beat out other possible compensatory mutations – naively less likely. I recommend that a few sentences in the Discussion be added on this important issue along with comments on the more general puzzle – at least to this reader! – as to why there appear to be so little adaptive genetic changes in core genomes on time scales of human lifetimes and civilization.</p><p>An important feature of gut bacterial evolution that is now being intensely studied is only mentioned in passing at the end of this paper: horizontal transfer and recombination of core genetic material. As this tends to bring in many more mutations overall than occur in regions of a pair of genomes with asexual ancestry, the effects cannot be neglected. To what extent can this give rise to a similar dependence of dN/dS on dS as seen in the data? Of course, such a picture begs the question as to what sets the low dN/dS of segments that are recombined –– often from genetic distances comparable to the diameter of the species.</p><p>The main substantive criticisms are summarized in &quot;Weaknesses&quot; section. Here are a few more minor points, and then presentational and pedagogical comments.</p><p>1) The analysis of the effects of a distribution of values of s is not convincing. A simple argument that for each s there is a crossover dS ~ mu/s, and approximating the corresponding portion of dN/dS vs dS as a step function at that crossover, gives a better approximation that using the harmonic mean: the rough distribution of s needed to fit, can then be eyeballed from the data – roughly by derivative d[dN/dS]/dS. (This point is roughly made – although hard to parse and confounded by uninformative details – in the Supplement).</p><p>2) For Muller's ratchet and deleterious loading: The time dependence computed from the deterministic analysis is rather misleading as it assumes – unreasonably – that the common ancestor had no deleterious mutations. The main point is the small fraction of the least–loaded subpopulation, W(t=infinity), being very small. The comparison of this with the appropriate N_e – whether N_e s exp(–U/s) is small or large – determining whether Muller's ratchet operates is the important point which needs emphasizing more: and this should be in the main text. [Note that for Muller's ratchet, using the harmonic mean s is roughly correct.] I would replace existing Eq(5) with an equation with this comparison in it (now just loosely in words around L 163) and refer to Ref(29) for analyses. Explain that if N is large enough or U small enough, reversions of the deleterious mutations will prevent Muller's ratchet.</p><p>Additionally, make clear that the model assumes additive effects of the deleterious mutations, and note that the average burden is small – and thus additive probably reasonable – even when large enough that Muller's ratchet is effective.</p><p>3) Some more discussion of &quot;effective population size&quot; is needed when introduced, in addition to that in the Discussion. This is especially true here, since – as noted in Discussion – it is often taken from the dS of a species via N_e = /mu: simply the overall T_MRCA in units of generations. The way the present paper uses N_e, is how it appears in modeling and thus controls several actual biological quantities: how much mutations can change abundance by drift, and how often beneficial mutations occur. This is thus a &quot;real&quot; effective population size. It is important to note, however, that with clonal interference (both in individuals and across human populations) different &quot;N_e&quot;'s are involved for different processes. A detailed discussion is not needed, but a couple of sentences (and a reference) in the main text is – around L165 – and a note in caption of Figure 2.</p><p>4) What is being assumed in various places (eg Figure 2) for the generation time is unclear.</p><p>5) The heuristic explanation for the time dependence of the reversion model is missing. T_adapt is rather confusing. A basic quantity – call it eg tau_change – is how often the conditions for a particular transient mutation change from beneficial to deleterious. This is the time that corresponds to the dS at which the crossover in the dN/dS data occurs – and indeed what is in the equations. T_adapt = tau_change/n_loci is the typical time between when any of these mutations switch. This determines dN. The distinction needs explaining.</p><p>6) The meaning of &quot;loci&quot; in counting the number of possible reverting mutations is unclear. Presumably what is meant is that at each locus there may be a number of roughly equivalent mutations – with each changing the phenotype so the others would no longer be beneficial – but to revert the phenotype needs to revert the specific one that occurred. This needs to be made clearer. Also, note that this would change the numbers somewhat as the beneficial mutation rate would be higher, but it has shown that analysis is not sensitive to that factor because of the large populations. Generally, a clearer statement that the beneficial s is the important quantity setting the time scales – log(Ns)/s – rather than the time for mutation to arise, is needed in the main text.</p><p>7) Effects of recombination: It would be good to add some more discussion on whether the effects of recombination alone (with an assumption about the effects of purifying selection on long time scales) could fit the data – as pointed out in &quot;Weaknesses&quot; section.</p><p>Is reversion by recombination likely to have a substantial role in dN/dS? I do not find the suggestion that multiple mutations could be simultaneously reverted by recombination at all believable. The further away the segment is, the more implausible is the scenario that compensatory mutations – let all other beneficial mutations with epistasis between them – have not occurred.</p><p>8) Generally, for each of the models and extensions used, make clear the number and set of parameters, and the assumptions. (Eg Figure 3)</p><p>Presentation:</p><p>Although the overall scenario, points made, and many of the explanations are quite clear, aspects of the presentation, figures, and captions are unclear or sloppy and detract from the paper's readability and potential impact. More specific and clear statements of the assumptions and model features are needed. And which of the mathematics to include or not in the main text, the supplement, or not at all, could be improved.</p><p>Notation:</p><p>– Mutation rates: mu_S etc are more often used per site: Here they are used for genome–wide instead of the more conventional – and better – U_S etc</p><p>– Use some notation for s of beneficial mutants – eg s_adapt.</p><p>– T_adapt see above</p><p>– N is used both for population size and numbers. With the use of n_loci, might be better to use n(t)'s – perhaps best with an overbar – for the average number of mutations that accumulate with time.</p><p>In many figures, notations such as &quot;1.8e+01&quot; or, in one, &quot;quadrillion&quot; are used: Use standard notation and, eg 10^1 mark instead of 1.8 times this.</p><p>Figure 1:</p><p>It is not clear what is meant by &quot;adaptive genes&quot; in the Zhao et al. data shown.</p><p>In the caption, say that crossover occurs at roughly dS ~ mu/s : this makes the role of s clear. In general, this kind of heuristic note is useful – independently of whether or not a reader is mathematically inclined!</p><p>L98: Make clear N_transient etc are averages. Spell out that for dS &lt;&lt; 1, dS ~ 2 U_S T_MRCA, and this regime obtains for all the data.</p><p>L127: Spell out mu_S (or better U_S) in terms of the number of sites and generation time.</p><p>L150: the minus sign in the exponent is not visible (similarly in some other equations)</p><p>L187–194: It is unclear what is meant by &quot;superspreaders&quot; and what the 30,000X factor means. Is it that strains from one individual would have to spread to 30,000 others before reversions etc? The argument against superspreaders could be expanded beyond &quot;seems unlikely&quot;.</p><p>L204–213: Equation (6) and surrounding text on general process, is not needed and confusing. Instead, the left side and last equality in Eq S23 should be pulled into the main text. Then can go directly to Eq(7) with an explanation that the n_loci/2 factor is simply the average number of differences between distantly related bacteria.</p><p>L259: Is the fitted T_adapt in generations? Also, give in years. And don't pretend to precision as &quot;840&quot;, and later &quot;110 years&quot;: give ranges.</p><p>Figure 4: (a): note in the caption that actual dN/dS &gt; 1 and why.</p><p>Specify n_loci used.</p><p>(b) &quot;discounting beneficial mutations&quot; is unclear: are or aren't the reversions included in this statement?</p><p>L287: Explain what PAML is/assumes.</p><p>L321: Note that in the simulations with genetic classes, the dN, etc between two individuals cannot be directly kept track of. Correct?</p><p>L348: Meaning of &quot;negative feedback&quot; is unclear.</p><p>L353: As per main comments: more is needed on how tiny the rate of compensatory or other beneficial mutations would have to be to not raise α hugely.</p><p>L365: Explain &quot;pseudogenized&quot;.</p><p>Methods and Theory:</p><p>Generally, much more than needed deriving standard results.</p><p>Wright–Fisher simulations: The notation here is very bad, with nearby letters being used for very different things – eg why not t instead of i which is in any case elsewhere used to mean something different? – and j_k used as it is but with j being an index. And generally, it is overly long and unclear.</p><p>L 673: what is RMSD?</p><p>L678: Explain PAML</p><p>dN/dS Theory: Much too much detail as most very standard Eg: certainly don't need all the derivation leading up to L742 equation.</p><p>L777: Make clear that α used in the main text is that with 0 subscript here.</p><p>L791–815 is confusing, not needed, and probably not valid. The point made in L817 is all that is needed – see comment (1) above.</p><p>L860: Say that sNW factor is mean fitness.</p><p>L895 is a classic result and not all derivation is needed.</p><p>L912: &quot;has 2s probability of extinction&quot; is unclear what it means: I presume something about the rate of ratchet. L915 equations, as noted in (2) should be in the main text.</p><p>Extinction and Fixation Probability:</p><p>This is all standard and not needed beyond quoting results.</p><p>L980: &quot;Mutation is accessible if… &quot; is very misleading. If L982 is satisfied, then there will be clonal interference between multiple mutations, and much of the analysis changes. But whether satisfied or not, the mutations can arise and fix: what changes is which will dominate the time to fixation as in L989</p><p>L1005: As noted, should pull part of this into the main text.</p><p>Implied Amount of Superspreading: extremely unclear. (and S26 is not even an equation)</p><p>SI Figures: There are probably more than needed and captions are often insufficient. Would be better to have a few paragraphs of text explaining them collectively, and the figures interspersed in the text.</p><p>Figure S4: What is &quot;theory&quot; curve?</p><p>Figure S5: Very unclear what was done or what modeled. Why is every 100,000 generations underestimated of bottleneck? What does &quot;beneficial mutations are released&quot; mean.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.93146.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions (for the authors):</p><p>1) Address how recombination affects assumptions of your model, which invokes Muller's Ratchet to necessitate back–mutation. In effect, recombination of the wild–type allele is equivalent to back–mutation, but recombination can also revert or incorporate multiple linked variants at once and alter the assumptions of your model and analyses. As recombination tends to bring in many more mutations overall than occur in regions of a pair of genomes with asexual ancestry, the effects cannot be neglected. To what extent can this give rise to a similar dependence of dN/dS on dS as seen in the data?</p></disp-quote><p>We now discuss the effect of recombination on the purifying selection model on page 6 and in Figure 2—figure supplement 3. In short, we now show that reasonable levels of recombination cannot rescue the purifying selection model from Muller’s ratchet when <italic>s</italic> is so low and the influx of new deleterious mutations is so high. We thank the reviewers for prompting this improvement.</p><disp-quote content-type="editor-comment"><p>2) Clarify the underlying assumptions of the model (e.g., the fitting parameters nloci and Tadapt), its theoretical results, and experimental applications. In addition, it clarifies the environmental conditions used for simulations, which could involve colonization of new hosts or environments, affect selection at many sites at once, and lead to clonal interference.</p></disp-quote><p>More clarification has been given in the text and the methods regarding the reversion model simulations and fitting. We initially left too much of the implementation to the reader reviewing the Github code, and we apologize for this oversight.</p><disp-quote content-type="editor-comment"><p>3) Evaluate the alternative that many compensatory mutations that could phenotypically revert an earlier mutation might overcome the exact specific reversion mutation in greater detail, including whether clonal interference between compensatory and reversion mutations would result in the mutations with the largest s – eg, as mentioned, reversion of a stop codon – being much more likely to sweep. Additional discussion of this important issue would be valuable.</p></disp-quote><p>We have now added simulations that include the possibility of compensatory mutations, and we have updated both the text and added an additional Figure 4—figure supplement 3. In short, we show that adding compensatory mutations that do not completely restore original fitness (as would be expected following a loss-of-function mutation) leads to a strengthening of the reversion model and a lower required number of locally adaptive loci. We thank the reviewers for prompting this improvement.</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>This study makes a substantial contribution to our understanding of the molecular evolutionary dynamics of microbial genomes by proposing a model that incorporates relatively frequent adaptive reversion mutations. In many ways, this makes sense from my own experience with evolutionary genomic data of microbes, where reversions are surprisingly familiar as evidence of the immense power of selection in large populations.</p><p>One criticism is the reliance on one major data set of B. fragilis to test fits of these models, but this is relatively minor in my opinion and can be caveated by discussion of other relevant datasets for parallel investigation.</p></disp-quote><p>We analyze data from 10 species of the <italic>Bacteroidales</italic> family, and we compare it to a dataset of <italic>Bacteroides fragilis.</italic> We have now added a reference to a recent manuscript from our group showing phenotypic alteration by reversion of a stop codon and further breaking of the same pathway through stop codons in other genes in <italic>Burkholderia dolosa</italic> on page 7, and have added a new analysis of codon usage in support of the reversion model on page 9-10.</p><p>We have chosen not to analyze other species as there are no large data sets with rigorous and evenly-applied quality control across scales. We anticipate the reversion model would be able to fit the data in these cases. We now note that this work remains to be done in the discussion.</p><disp-quote content-type="editor-comment"><p>Another point is that this problem isn't as new as the manuscript indicates, see for example https://journals.asm.org/doi/10.1128/aem.02002–20.</p></disp-quote><p>Loo et al. puts forward an explanation similar to the purifying model proposed by Rocha et al, which we refute here. Quoting from Loo et al: “Our results confirm the observation that nonsynonymous SNPs are relatively elevated under shorter time periods and that purifying selection is more apparent over longer periods or during transmission.” While there is some linguistic similarity between the weak purifying model and our model of strong local adaptation model and strong adaptive reversion, we believe that the dynamical and predictive implications suggested by the reversion model are an important conceptual leap and correction to the literature. We now cite Loo et al. and additional works cited therein. We have updated the abstract, introduction, and discussion to further emphasize the distinction of the reversion model from previous models: namely the implication of the reversion model that long-time scale dN/dS hides dynamics.</p><disp-quote content-type="editor-comment"><p>Nonetheless, the paper succeeds by both developing theory and offering concrete parameters to illustrate the magnitudes of the problems that distinguish competing ideas, for example, the risk of mutational load posed in the absence of frequent back mutation.</p><p>Please expand the discussion of the novelty of incorporating (or overlooking) reversion mutations as well as the broader problems of dN/dS metrics for population–wide data where fixation is rare.</p></disp-quote><p>We now better emphasize the distinction between the weak purifying selection model and reversion model in both the abstract, results, and discussion. We further emphasize that this work inverts the conclusion from prior works -- that dN/dS gives misleading interpretations of dynamics on long time scales, and that short-term measures (intra-population) of dN/dS may be more informative than long-term (inter-population) measures of dN/dS for dynamical inferences. Thank you for instigating this improvement.</p><disp-quote content-type="editor-comment"><p>I'm otherwise enthusiastic about this study.</p><p>Reviewer #2 (Recommendations for the authors):</p><p>This manuscript asks how different forms of selection affect the patterns of genetic diversity in microbial populations. One popular metric used to infer signatures of selection is dN/dS, the ratio of nonsynonymous to synonymous distances between two genomes. Previous observations across many bacterial species have found dN/dS decreases with dS, which is a proxy for the divergence time. The most common interpretation of this pattern was proposed by Rocha et al. (2006), who suggested the excess in nonsynonymous mutations on short divergence times represent transient deleterious mutations that have not yet been purged by selection.</p><p>In this study, the authors propose an alternative model based on the population structure of human gut bacteria, in which dN is dominated by selective sweeps of SNPs that revert previous mutations within local populations. The authors argue that contrary to standard population genetics models, which are based on the population dynamics of large eukaryotes, the large populations in the human gut mean that reversions may be quite common and may have a large impact on evolutionary dynamics. They show that such a model can fit the decrease of dN/dS in time at least as well as the purifying selection model.</p><p>Strengths</p><p>The main strength of the manuscript is to show that adaptive sweeps in gut microbial populations can lead to small dN/dS. While previous work has shown that using dN/dS to infer the strength of selection within a population is problematic (see Kryazhimskiy and Plotkin, 2008, cited in the paper) the particular mechanism proposed by the authors is new to my knowledge. In addition, despite the known caveats, dN/dS values are still routinely reported in studies of microbial evolution, and so their interpretation should be of considerable interest to the community.</p><p>The authors provide compelling justification for the importance of adaptive reversions and make a good case that these need to be carefully considered by future studies of microbial evolution. The authors show that their model can fit the data as well as the standard model based on purifying selection and the parameters they infer appear to be plausible given known data. More generally, I found the discussion on the implications of traditional population genetics models in the context of human gut bacteria to be a valuable contribution of the paper.</p></disp-quote><p>Thank you for the kind words and appreciation of the manuscript.</p><disp-quote content-type="editor-comment"><p>Weaknesses</p><p>The authors argue that the purifying selection model would predict a gradual loss in fitness via Muller's ratchet. This is true if recombination is ignored, but this assumption is inconsistent with the data from Garud, et al. (2019) cited in the manuscript, who showed a significant linkage decrease in the bacteria also used in this study.</p></disp-quote><p>We now investigate the effect of recombination on the purifying selection model on page 6 and in Figure 2—figure supplement 3. In short, we show that reasonable levels of recombination (obtained from literature r/m values) cannot rescue the purifying selection model from Muller’s ratchet when <italic>s</italic> is so low and the influx of new deleterious mutations is so high. We thank the reviewers for prompting this improvement.</p><disp-quote content-type="editor-comment"><p>I also found that the data analysis part of the paper added little new to what was previously known. Most of the data comes directly from the Garud et al. study and the analysis is very similar as well. Even if other appropriate data may not currently be available, I feel that more could be done to test specific predictions of the model with more careful analysis.</p></disp-quote><p>In addition to new analyses regarding recombination and compensatory mutations using the Garud et al. data set, we have now added two new analyses, both using <italic>Bacteroides fragilis</italic>. First, we show that de novo mutations in Zhao &amp; Lieberman et al. dataset include an enrichment of premature stop codons (page 7). Second we show that genes expected to be under fluctuating selection in <italic>B. fragilis</italic> displays a significant closeness to stop codons, consistent with recent stop codons and reversions. We thank the reviewer for prompting the improvement.</p><disp-quote content-type="editor-comment"><p>Finally, I found the description of the underlying assumptions of the model and the theoretical results difficult to understand. I could not, for example, relate the fitting parameters nloci and Tadapt to the simulations after reading the main text and the supplement. In addition, it was not clear to me if simulations involved actual hosts or how the changes in selection coefficients for different sites was implemented. Note that these are not simply issues of exposition since the specific implementation of the model could conceivably lead to different results. For example, if the environmental change is due to the colonization of a different host, it would presumably affect the selection coefficients at many sites at once and lead to clonal interference. Related to this point, it was also not clear that the weak mutation strong selection assumption is consistent with the microscopic parameters of the model. The authors also mention that &quot;superspreading&quot; may somehow make a difference to the probability of maintaining the least loaded class in the purifying selection model, but what they mean by this was not adequately explained.</p></disp-quote><p>We apologize for leaving the specifics of the implementation from the paper and only accessible through the Github page and have corrected this. We have added a new section in the methods further detailing the reversion model and the specifics of how nloci and Tadapt (now tau_switch as of the edits) are implemented in the code.</p><p>The possibility for clonal interference is indeed included in the simulation. Switching is not correlated with transmissions in our main figure simulations (Figure 4a). When we run simulations in which transmission and selection are correlated, the results remain essentially the same, barring higher variance at lower divergences Figure 4-figure supplement 1. We have now clarified these points in the results, and have also better clarified the selection only at transmission model in the main results.</p><disp-quote content-type="editor-comment"><p>I see three main issues that would significantly improve the manuscript if addressed. The first is the issue of recombination, which undermines using Muller's ratchet to motivate the proposed model. Including the effects of recombination in the model would be a significant project in itself so I do not expect the authors to do that, but I do believe it is important that the issue be seriously addressed. In any case, I think the fact that the values of s implied by the purifying selection model are so small is already problematic, for many of the reasons discussed in the paper, so I would suggest focusing more on that. It might be more useful perhaps to demonstrate in simulations how even rare adaptive sweeps would affect the purging of deleterious mutations with small s, which is mentioned in the manuscript but not developed.</p></disp-quote><p>As mentioned above, we have updated the manuscript to include a section and SI figure detailing the effect of recombination on the purifying selection model.</p><p>We demonstrate the problem of rare adaptive sweeps on the purifying model in Figure 2—figure supplement 4. We have now expanded this paragraph to further emphasize this point.</p><disp-quote content-type="editor-comment"><p>The second issue I found is the data analysis. It would be useful to check some of the hypotheses raised in the text directly from the data. For example, the authors mention that premature stop codons may preferentially be subject to reversions, which could be verified. Even if these analyses do not directly support the model, the authors can still comment on them and I believe it would significantly add to the paper.</p></disp-quote><p>As mentioned above, we have added two new analyses regarding <italic>B. fragilis,</italic> frequency of stop codons, and codon usage which support the reversion model.</p><disp-quote content-type="editor-comment"><p>Finally, I found the presentation of the model and simulations to be confusing and feel that it needs to be made significantly clearer for readers to be able to understand. In general, the supplement had considerable detail on standard results (Sec. 2.1 and 2.2 for example), but was very vague on the actual model itself (Sec. 3.1 and 3.2). If anything, this emphasis should be reversed. I've added some more specific comments below which might help with this issue. It should also be noted that the inferred values of s from any simple model will be effective parameters that may not be directly related to measurable parameters from experiments or observations. To give a very simple example, if selection coefficients are varying quickly in time, the relevant s for the accumulation of mutations would be the time average s, which may be considerably smaller than the typical value.</p></disp-quote><p>As mentioned above, we now have fixed this oversight and added much more detail about the model.</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>The diversity of bacterial species in the human gut microbiome is widely known, but the extensive diversity within each species is far less appreciated. Strains found in individuals on opposite sides of the globe can differ by as little as handfuls of mutations, while strains found in an individual's gut, or in the same household, might have a common ancestor tens of thousands of years ago. What are the evolutionary, ecological, and transmission dynamics that established and maintain this diversity?</p><p>The time, T, since the common ancestor of two strains, can be directly inferred by comparing their core genomes and finding the fraction of synonymous (non–amino acid changing) sites at which they differ: dS. With the per–site per–generation mutation rate, μ, and the mean generation times roughly known, this directly yields T (albeit with substantial uncertainty of the generation time.) A traditional way to probe the extent to which selection plays a role is to study pairs of strains and compare the fraction of non–synonymous (amino acid or stop–codon changing) sites, dN, at which the strains differ with their dS. Small dN/dS, as found between distantly related strains, is attributed to purifying selection against deleterious mutations dominating over mutations that have driven adaptive evolution. Large dN/dS as found in laboratory evolution experiments, is caused by beneficial mutations that quickly arise in large bacterial populations, and, with substantial selective advantages, per generation, can rise to high abundance fast enough that very few synonymous mutations arise in the lineages that take over the population.</p><p>A number of studies (including by Lieberman's group) have analyzed large numbers of strains of various dominant human gut species and studied how dN/dS varies. Although between closely related strains the variations are large – often much larger than attributable to just statistical variations – a systematic trend from dN/dS around unity or larger for close relatives to dN/dS ~ 0.1 for more distant relatives has been found in enough species that it is natural to conjecture a general explanation.</p><p>The conventional explanation is that, for close relatives, the effects of selection over the time since they diverged has not yet purged weakly deleterious mutations that arose by chance – roughly mutations with sT&lt;1 – while since the common ancestor of more distantly related strains, there is plenty of time for most of those that arose to have been purged.</p><p>Torrillo and Lieberman have carried out an in–depth – sophisticated and quantitative – analysis of models of some of the evolutionary processes that shape the dependence of dN/dS on dS – and hence on their divergence time, T. They first review the purifying selection model and show that – even ignoring its inability to explain dN/dS &gt; 1 for many closely related pairs – the model has major problems explaining the crossover from dN/dS somewhat less than unity to much smaller values as dS goes through – on a logarithmic scale – the 10^–4 range. The first problem, already seen in the infinite–population–size deterministic model, is that a very large fraction of non–synonymous mutations would have to have deleterious s's in the 10^–5 per generation range to fit the data (and a small fraction effectively neutral). As the s's are naturally expected (at least in the absence of quantitative analysis to the contrary) to be spread out over a wide range on a logarithmic scale of s, this seems implausible. But the authors go further and analyze the effects of fluctuations that occur even in the very large populations: ~ &gt;10^12 bacteria per species in one gut, and 10^10 human guts globally. They show that Muller's ratchet – the gradual accumulation of weakly deleterious mutations that are not purged by selection – leads to a mutational meltdown with the parameters needed to fit the purifying selection model. In particular, with N_e the &quot;effective population size&quot; that roughly parametrizes the magnitude of stochastic birth–death and transition fluctuations, and U the total mutation rate to such deleterious mutations this occurs for U/s &gt; log(sN_e) which they show would obtain with the fitted parameters.</p><p>Torrillo and Lieberman promise an alternate model: that there are a modest number of &quot;loci&quot; at which conditionally beneficial mutations can occur that are beneficial in some individual guts (or other environmental conditions) at some times, but deleterious in other (or the same) gut at other times. With the ancestors of a pair of strains having passed through one too many individuals and transmissions, it is possible for a beneficial mutation to occur and rise in the population, only later to be reverted by the beneficial inverse mutation. With tens of loci at which this can occur, they show that this process could explain the drop of dN/dS from short times – in which very few such mutations have occurred – to very long times by which most have flipped back and forth so that a random pair of strains will have the same nucleotide at such sites with 50% probability. Their qualitative analysis of a minimally simple model of this process shows that the bacterial populations are plenty big enough for such specific mutations to occur many times in each individual's gut, and with modest beneficials, to takeover. With a few of these conditionally beneficial mutations or reversions occurring during an individuals lifetime, they get a reasonably quantitative agreement with the dN/dS vs dS data with very few parameters. A key assumption of their model is that genetically exact reversion mutations are far more likely to takeover a gut population – and spread – than compensatory mutations which have a similar phenotypic–reversion effect: a mutation that is reverted does not show up in dN, while one that is compensated by another shows up as a two–mutation difference after the environment has changed twice.</p><p>Strengths:</p><p>The quantitative arguments made against the conventional purifying selection model are highly compelling, especially the consideration of multiple aspects that are usually ignored, including – crucially – how Muller's ratchet arises and depends on the realistic and needed–to–fit parameters; the effects of bottlenecks in transmission and the possibility that purifying selection mainly occurs then; and complications of the model of a single deleterious s, to include a distribution of selective disadvantages. Generally, the author's approach of focusing on the simplest models with as few as possible parameters (some roughly known), and then adding in various effects one–by–one, is outstanding and, in being used to analyze environmental microbial data, exceptional.</p><p>The reversion model the authors propose and study is a simple general one and they again explore carefully various aspects of it – including dynamics within and between hosts – and the consequent qualitative and quantitative effects. Again, the quantitive analysis of almost all aspects is exemplary. Although it is hard to make a compelling guess of the number of loci that are subject to alternating selection on the needed time–scales (years to centuries) they make a reasonable argument for a lower bound in terms of the number of known invertible promoters (that can genetically switch gene expression on and off).</p></disp-quote><p>We are very grateful for the reviewer’s kind words and careful reading.</p><disp-quote content-type="editor-comment"><p>Weaknesses:</p><p>The primary weakness of this paper is one that the author's are completely open about: the assumption that, collectively, any of possibly–many compensatory mutations that could phenotypically revert an earlier mutation, are less likely to arise and takeover local populations than the exact specific reversion mutation. While detailed analysis of this is, reasonably enough, beyond the scope of the present paper, more discussion of this issue would add substantially to this work. Quantitatively, the problem is that even a modest number of compensatory mutations occurring as the environmental pressures change could lead to enough accumulation of non–synonymous mutations that they could cause dN/dS to stay large – easily &gt;1 – to much larger dS than is observed. If, say, the appropriate locus is a gene, the number of combinations of mutations that are better in each environment would play a role in how large dN would saturate to in the steady state (1/2 of n_loci in the author's model). It is possible that clonal interference between compensatory and reversion mutations would result in the mutations with the largest s – eg, as mentioned, reversion of a stop codon – being much more likely to take over, and this could limit the typical number of differences between quite well–diverged strains. However, the reversion and subsequent re–reversion would have to both beat out other possible compensatory mutations – naively less likely. I recommend that a few sentences in the Discussion be added on this important issue along with comments on the more general puzzle – at least to this reader! – as to why there appear to be so little adaptive genetic changes in core genomes on time scales of human lifetimes and civilization.</p></disp-quote><p>We now directly consider compensatory mutations (page 9, SI text 3.2, and Figure 4-figure supplement 3). We show that as long as true reversions are more likely than compensatory mutations overall, (adaptive) nonsynonymous mutations will still tend to revert towards their initial state and not contribute to asymptotic dN/dS, and show that true reversions are expected in a large swath of parameter space. Thank you for motivating this improvement!</p><p>We note in the discussion that directional selection could be incorporated into the parameter α (assuming even more of the genome is deleterious) on page 11.</p><disp-quote content-type="editor-comment"><p>An important feature of gut bacterial evolution that is now being intensely studied is only mentioned in passing at the end of this paper: horizontal transfer and recombination of core genetic material. As this tends to bring in many more mutations overall than occur in regions of a pair of genomes with asexual ancestry, the effects cannot be neglected. To what extent can this give rise to a similar dependence of dN/dS on dS as seen in the data? Of course, such a picture begs the question as to what sets the low dN/dS of segments that are recombined –– often from genetic distances comparable to the diameter of the species.</p></disp-quote><p>We now discuss the effect of recombination on the purifying selection model on page 6 and in Figure 2—figure supplement 3. In short, we now show that reasonable levels of recombination cannot rescue the purifying selection model from Muller’s ratchet when <italic>s</italic> is so low and the influx of new deleterious mutations is so high. We thank the reviewers for prompting this improvement</p><disp-quote content-type="editor-comment"><p>The main substantive criticisms are summarized in &quot;Weaknesses&quot; section. Here are a few more minor points, and then presentational and pedagogical comments.</p><p>1) The analysis of the effects of a distribution of values of s is not convincing. A simple argument that for each s there is a crossover dS ~ mu/s, and approximating the corresponding portion of dN/dS vs dS as a step function at that crossover, gives a better approximation that using the harmonic mean: the rough distribution of s needed to fit, can then be eyeballed from the data – roughly by derivative d[dN/dS]/dS. (This point is roughly made – although hard to parse and confounded by uninformative details – in the Supplement).</p></disp-quote><p>We agree that an argument involving a step function is more straightforward. We have changed the analysis to now use this logic for explaining the effects of a distribution of s and have streamlined this section more generally. Thank you for the improvement.</p><disp-quote content-type="editor-comment"><p>2) For Muller's ratchet and deleterious loading: The time dependence computed from the deterministic analysis is rather misleading as it assumes – unreasonably – that the common ancestor had no deleterious mutations. The main point is the small fraction of the least–loaded subpopulation, W(t=infinity), being very small. The comparison of this with the appropriate N_e – whether N_e s exp(–U/s) is small or large – determining whether Muller's ratchet operates is the important point which needs emphasizing more: and this should be in the main text. [Note that for Muller's ratchet, using the harmonic mean s is roughly correct.] I would replace existing Eq(5) with an equation with this comparison in it (now just loosely in words around L 163) and refer to Ref(29) for analyses. Explain that if N is large enough or U small enough, reversions of the deleterious mutations will prevent Muller's ratchet.</p><p>Additionally, make clear that the model assumes additive effects of the deleterious mutations, and note that the average burden is small – and thus additive probably reasonable – even when large enough that Muller's ratchet is effective.</p></disp-quote><p>We replaced equation 5 with S17 which puts into context the size needed for Muller’s Ratchet to be prevented and suggested ref(29) (now ref (40)) for further analysis. We also noted the assumption of additive mutation effects. Thank you for the improvement.</p><disp-quote content-type="editor-comment"><p>3) Some more discussion of &quot;effective population size&quot; is needed when introduced, in addition to that in the Discussion. This is especially true here, since – as noted in Discussion – it is often taken from the dS of a species via N_e = /mu: simply the overall T_MRCA in units of generations. The way the present paper uses N_e, is how it appears in modeling and thus controls several actual biological quantities: how much mutations can change abundance by drift, and how often beneficial mutations occur. This is thus a &quot;real&quot; effective population size. It is important to note, however, that with clonal interference (both in individuals and across human populations) different &quot;N_e&quot;'s are involved for different processes. A detailed discussion is not needed, but a couple of sentences (and a reference) in the main text is – around L165 – and a note in caption of Figure 2.</p></disp-quote><p>We now more thoroughly discuss effective population size in the main text when introduced (page 4-5) and refer to it in the caption of Figure 2. Thank you for the improvement.</p><disp-quote content-type="editor-comment"><p>4) What is being assumed in various places (eg Figure 2) for the generation time is unclear.</p></disp-quote><p>We assume about one generation a day. We added this in the text and apologize for the confusion.</p><disp-quote content-type="editor-comment"><p>5) The heuristic explanation for the time dependence of the reversion model is missing. T_adapt is rather confusing. A basic quantity – call it eg tau_change – is how often the conditions for a particular transient mutation change from beneficial to deleterious. This is the time that corresponds to the dS at which the crossover in the dN/dS data occurs – and indeed what is in the equations. T_adapt = tau_change/n_loci is the typical time between when any of these mutations switch. This determines dN. The distinction needs explaining.</p></disp-quote><p>We agree that using tau_change (which we call Tau_flip) over T_adapt provides a more intuitive understanding of the time dependence and have changed text and equations accordingly. We thank the reviewer for prompting this improvement.</p><disp-quote content-type="editor-comment"><p>6) The meaning of &quot;loci&quot; in counting the number of possible reverting mutations is unclear. Presumably what is meant is that at each locus there may be a number of roughly equivalent mutations – with each changing the phenotype so the others would no longer be beneficial – but to revert the phenotype needs to revert the specific one that occurred. This needs to be made clearer. Also, note that this would change the numbers somewhat as the beneficial mutation rate would be higher, but it has shown that analysis is not sensitive to that factor because of the large populations. Generally, a clearer statement that the beneficial s is the important quantity setting the time scales – log(Ns)/s – rather than the time for mutation to arise, is needed in the main text.</p></disp-quote><p>Yes, this is the correct interpretation. We have clarified this in the text and figure legend. In the simulations, the beneficial forward mutation rate is higher than the reversion rate to take this into account, and this has been made clear in the new methods section detailing how the reversion mutations function.</p><p>We have also adjusted the text and Figure 3b to emphasize the importance of s vs. mutation rate in setting time to reversion. Thanks for prompting the improvement.</p><disp-quote content-type="editor-comment"><p>7) Effects of recombination: It would be good to add some more discussion on whether the effects of recombination alone (with an assumption about the effects of purifying selection on long time scales) could fit the data – as pointed out in &quot;Weaknesses&quot; section.</p></disp-quote><p>We now discuss the effect of recombination on the purifying selection model on page 8 and in Figure 2—figure supplement 3. In short, we now show that reasonable levels of recombination cannot rescue the purifying selection model from Muller’s ratchet when <italic>s</italic> is so low and the influx of new deleterious mutations is so high.</p><disp-quote content-type="editor-comment"><p>Is reversion by recombination likely to have a substantial role in dN/dS? I do not find the suggestion that multiple mutations could be simultaneously reverted by recombination at all believable. The further away the segment is, the more implausible is the scenario that compensatory mutations – let all other beneficial mutations with epistasis between them – have not occurred.</p></disp-quote><p>We have now clarified this part of the discussion. Recombination would be helpful in the reversion model if multiple mutations had occurred in the same gene over longer periods of time, and the gene being completely replaced with the ancestral version would be beneficial upon environmental change. This is particularly likely if epistasis enables only 2+ step mutants to be beneficial upon environmental change. We hope the revised version is more convincing.</p><disp-quote content-type="editor-comment"><p>8) Generally, for each of the models and extensions used, make clear the number and set of parameters, and the assumptions. (Eg Figure 3)</p></disp-quote><p>We apologize for the confusion and have added more detail to the figure captions.</p><disp-quote content-type="editor-comment"><p>Presentation:</p><p>Although the overall scenario, points made, and many of the explanations are quite clear, aspects of the presentation, figures, and captions are unclear or sloppy and detract from the paper's readability and potential impact. More specific and clear statements of the assumptions and model features are needed. And which of the mathematics to include or not in the main text, the supplement, or not at all, could be improved.</p><p>Notation:</p><p>– Mutation rates: mu_S etc are more often used per site: Here they are used for genome–wide instead of the more conventional – and better – U_S etc</p></disp-quote><p>Done.</p><disp-quote content-type="editor-comment"><p>– Use some notation for s of beneficial mutants – eg s_adapt.</p></disp-quote><p>Done.</p><disp-quote content-type="editor-comment"><p>– T_adapt see above</p></disp-quote><p>Done.</p><disp-quote content-type="editor-comment"><p>– N is used both for population size and numbers. With the use of n_loci, might be better to use n(t)'s – perhaps best with an overbar – for the average number of mutations that accumulate with time.</p></disp-quote><p>We added in an overbar (thank you for the suggestion!), but we continue to use capitalize N for nonsynonymous mutations for the sake of matching to dN.</p><disp-quote content-type="editor-comment"><p>In many figures, notations such as &quot;1.8e+01&quot; or, in one, &quot;quadrillion&quot; are used: Use standard notation and, eg 10^1 mark instead of 1.8 times this.</p></disp-quote><p>Done.</p><disp-quote content-type="editor-comment"><p>Figure 1:</p><p>It is not clear what is meant by &quot;adaptive genes&quot; in the Zhao et al. data shown.</p></disp-quote><p>Clarification has been added. We apologize for the confusion.</p><disp-quote content-type="editor-comment"><p>In the caption, say that crossover occurs at roughly dS ~ mu/s : this makes the role of s clear. In general, this kind of heuristic note is useful – independently of whether or not a reader is mathematically inclined!</p></disp-quote><p>We have made the changes. Thank you for the suggestion.</p><disp-quote content-type="editor-comment"><p>L98: Make clear N_transient etc are averages. Spell out that for dS &lt;&lt; 1, dS ~ 2 U_S T_MRCA, and this regime obtains for all the data.</p></disp-quote><p>We have made the changes. Thank you for the suggestion.</p><disp-quote content-type="editor-comment"><p>L127: Spell out mu_S (or better U_S) in terms of the number of sites and generation time.</p></disp-quote><p>For fitting the data, since dS=#S / number of S sites, only the mutation rate per base pair matters. We now further discuss the molecular clock on page 3 to provide better clarity. U_N does depend on the number of sites and we have now made this more explicit on page 4.</p><disp-quote content-type="editor-comment"><p>L150: the minus sign in the exponent is not visible (similarly in some other equations)</p></disp-quote><p>We are unsure how to remedy this as they do appear on our version of the document.</p><disp-quote content-type="editor-comment"><p>L187–194: It is unclear what is meant by &quot;superspreaders&quot; and what the 30,000X factor means. Is it that strains from one individual would have to spread to 30,000 others before reversions etc? The argument against superspreaders could be expanded beyond &quot;seems unlikely&quot;.</p></disp-quote><p>We apologize for the confusion and have added more clarification. We now only discuss superspreaders more directly in the Results section relating to the purifying selection model for clarity.</p><disp-quote content-type="editor-comment"><p>L204–213: Equation (6) and surrounding text on general process, is not needed and confusing. Instead, the left side and last equality in Eq S23 should be pulled into the main text. Then can go directly to Eq(7) with an explanation that the n_loci/2 factor is simply the average number of differences between distantly related bacteria.</p></disp-quote><p>We agree and have made the changes accordingly and left some of the notes on the more general process to the SI. Thank you for the improvement.</p><disp-quote content-type="editor-comment"><p>L259: Is the fitted T_adapt in generations? Also, give in years. And don't pretend to precision as &quot;840&quot;, and later &quot;110 years&quot;: give ranges.</p></disp-quote><p>We have clarified and given ranges. Thank you for the suggestion.</p><disp-quote content-type="editor-comment"><p>Figure 4: (a): note in the caption that actual dN/dS &gt; 1 and why.</p></disp-quote><p>Done.</p><disp-quote content-type="editor-comment"><p>Specify n_loci used.</p></disp-quote><p>Done.</p><disp-quote content-type="editor-comment"><p>(b) &quot;discounting beneficial mutations&quot; is unclear: are or aren't the reversions included in this statement?</p></disp-quote><p>Reworded and clarified.</p><disp-quote content-type="editor-comment"><p>L287: Explain what PAML is/assumes.</p></disp-quote><p>Done.</p><disp-quote content-type="editor-comment"><p>L321: Note that in the simulations with genetic classes, the dN, etc between two individuals cannot be directly kept track of. Correct?</p></disp-quote><p>Correct, this is now noted.</p><disp-quote content-type="editor-comment"><p>L348: Meaning of &quot;negative feedback&quot; is unclear.</p></disp-quote><p>Reworded.</p><disp-quote content-type="editor-comment"><p>L353: As per main comments: more is needed on how tiny the rate of compensatory or other beneficial mutations would have to be to not raise α hugely.</p></disp-quote><p>See new section on compensatory mutations.</p><disp-quote content-type="editor-comment"><p>L365: Explain &quot;pseudogenized&quot;.</p></disp-quote><p>Changed word to nonfunctional.</p><disp-quote content-type="editor-comment"><p>Methods and Theory:</p><p>Generally, much more than needed deriving standard results.</p><p>Wright–Fisher simulations: The notation here is very bad, with nearby letters being used for very different things – eg why not t instead of i which is in any case elsewhere used to mean something different? – and j_k used as it is but with j being an index. And generally, it is overly long and unclear.</p></disp-quote><p>We have reworked the indices to make it more clear. Thank you for the suggestion.</p><disp-quote content-type="editor-comment"><p>L 673: what is RMSD?</p></disp-quote><p>Root mean square deviation. This has been added in the text.</p><disp-quote content-type="editor-comment"><p>L678: Explain PAML</p></disp-quote><p>Clarification has been added.</p><disp-quote content-type="editor-comment"><p>dN/dS Theory: Much too much detail as most very standard Eg: certainly don't need all the derivation leading up to L742 equation.</p></disp-quote><p>Yes, the theory is purposely very highly detailed. The intent is to make it available to a wide audience of readers including those who may not know mathematics beyond basic calculus, as the majority of the theory doesn’t use any very advanced techniques. We hope that this helps interest more readers in doing theory. We now clarify this intent.</p><disp-quote content-type="editor-comment"><p>L777: Make clear that α used in the main text is that with 0 subscript here.</p></disp-quote><p>Done.</p><disp-quote content-type="editor-comment"><p>L791–815 is confusing, not needed, and probably not valid. The point made in L817 is all that is needed – see comment (1) above.</p></disp-quote><p>We do agree it is probably not needed and now make the point in a quicker more straightforward way that depends upon the step function approximation as suggested.</p><disp-quote content-type="editor-comment"><p>L860: Say that sNW factor is mean fitness.</p></disp-quote><p>Done.</p><disp-quote content-type="editor-comment"><p>L895 is a classic result and not all derivation is needed.</p></disp-quote><p>Yes, this was included in an attempt to make the work self contained for readers without a background in population genetics. We hope that this is useful to readers. We now add the word classic result to make sure the historical context of this is understood.</p><disp-quote content-type="editor-comment"><p>L912: &quot;has 2s probability of extinction&quot; is unclear what it means: I presume something about the rate of ratchet. L915 equations, as noted in (2) should be in the main text.</p></disp-quote><p>Yes, clarified. The equation has been moved.</p><disp-quote content-type="editor-comment"><p>Extinction and Fixation Probability:</p><p>This is all standard and not needed beyond quoting results.</p></disp-quote><p>Yes, this was included in an attempt to make the work self contained for readers without a background in population genetics.</p><disp-quote content-type="editor-comment"><p>L980: &quot;Mutation is accessible if… &quot; is very misleading. If L982 is satisfied, then there will be clonal interference between multiple mutations, and much of the analysis changes. But whether satisfied or not, the mutations can arise and fix: what changes is which will dominate the time to fixation as in L989</p></disp-quote><p>Changed language used, thank you.</p><disp-quote content-type="editor-comment"><p>L1005: As noted, should pull part of this into the main text.</p></disp-quote><p>Done.</p><disp-quote content-type="editor-comment"><p>Implied Amount of Superspreading: extremely unclear. (and S26 is not even an equation)</p></disp-quote><p>We decided to remove this part of the SI as it was not adding much and clarify more in the main text.</p><disp-quote content-type="editor-comment"><p>SI Figures: There are probably more than needed and captions are often insufficient. Would be better to have a few paragraphs of text explaining them collectively, and the figures interspersed in the text.</p></disp-quote><p>Most of the SI figures are more for checks of robustness than major points about theory and are more meant to be looked at in context of the main text. Thus, we kept them as are though we expanded upon the captions to add more detail.</p><disp-quote content-type="editor-comment"><p>Figure S4: What is &quot;theory&quot; curve?</p></disp-quote><p>Changed label to infinite population in top panel. Removed theory line in the second panel upon review as it is confusing since the asymptote occurs because of mutation accumulation which is not modeled by theory.</p><disp-quote content-type="editor-comment"><p>Figure S5: Very unclear what was done or what modeled. Why is every 100,000 generations underestimated of bottleneck? What does &quot;beneficial mutations are released&quot; mean.</p></disp-quote><p>We apologize for the confusion. This is just running the simulation for the reversion model, which assumes a population transmitting through bottlenecks and adaptations under the assumptions of the purifying selection model (ie. so remove the reversions part, have less frequent forward mutations, and make deleterious mutations have a smaller deleterious effect). We have added more to the figure captions to explain.</p></body></sub-article></article>