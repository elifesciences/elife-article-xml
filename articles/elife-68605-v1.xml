<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><?covid-19-tdm ?><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">68605</article-id><article-id pub-id-type="doi">10.7554/eLife.68605</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Immunology and Inflammation</subject></subj-group></article-categories><title-group><article-title>TCR meta-clonotypes for biomarker discovery with <italic>tcrdist3</italic> enabled identification of public, HLA-restricted clusters of SARS-CoV-2 TCRs</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-231866"><name><surname>Mayer-Blackwell</surname><given-names>Koshlan</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1652-4023</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-96623"><name><surname>Schattgen</surname><given-names>Stefan</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-260566"><name><surname>Cohen-Lavi</surname><given-names>Liel</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-143491"><name><surname>Crawford</surname><given-names>Jeremy C</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-230340"><name><surname>Souquette</surname><given-names>Aisha</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-231868"><name><surname>Gaevert</surname><given-names>Jessica A</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-231869"><name><surname>Hertz</surname><given-names>Tomer</given-names></name><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf3"/></contrib><contrib contrib-type="author" id="author-42849"><name><surname>Thomas</surname><given-names>Paul G</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf4"/></contrib><contrib contrib-type="author" id="author-174735"><name><surname>Bradley</surname><given-names>Philip G</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0224-6464</contrib-id><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf5"/></contrib><contrib contrib-type="author" corresp="yes" id="author-231332"><name><surname>Fiore-Gartland</surname><given-names>Andrew</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7627-2166</contrib-id><email>agartlan@fredhutch.org</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con10"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Vaccine and Infectious Disease Division, Fred Hutchinson Cancer Research Center</institution><addr-line><named-content content-type="city">Seattle</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution>Department of Immunology, St Jude Children's Research Hospital</institution><addr-line><named-content content-type="city">Memphis</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution>Department of Industrial Engineering and Management, Ben-Gurion University of the Negev</institution><addr-line><named-content content-type="city">Be'er Sheva</named-content></addr-line><country>Israel</country></aff><aff id="aff4"><label>4</label><institution>Department of Immunology, St Jude Children's Research Hospital</institution><addr-line><named-content content-type="city">Memphis</named-content></addr-line><country>United States</country></aff><aff id="aff5"><label>5</label><institution>St Jude Children's Research Hospital</institution><addr-line><named-content content-type="city">Memphis</named-content></addr-line><country>United States</country></aff><aff id="aff6"><label>6</label><institution>Shraga Segal Department of Microbiology and Immunology, Ben-Gurion University of the Negev</institution><addr-line><named-content content-type="city">Be'er Sheva</named-content></addr-line><country>United States</country></aff><aff id="aff7"><label>7</label><institution>Fred Hutchinson Cancer Research Center</institution><addr-line><named-content content-type="city">Seattle</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Chain</surname><given-names>Benny</given-names></name><role>Reviewing Editor</role><aff><institution>University College London</institution><country>United Kingdom</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><role>Senior Editor</role><aff><institution>École Normale Supérieure</institution><country>France</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>30</day><month>11</month><year>2021</year></pub-date><pub-date pub-type="collection"><year>2021</year></pub-date><volume>10</volume><elocation-id>e68605</elocation-id><history><date date-type="received" iso-8601-date="2021-03-20"><day>20</day><month>03</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2021-11-11"><day>11</day><month>11</month><year>2021</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at bioRxiv.</event-desc><date date-type="preprint" iso-8601-date="2020-12-26"><day>26</day><month>12</month><year>2020</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2020.12.24.424260"/></event></pub-history><permissions><copyright-statement>© 2021, Mayer-Blackwell et al</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>Mayer-Blackwell et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-68605-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-68605-figures-v1.pdf"/><abstract><p>T-cell receptors (TCRs) encode clinically valuable information that reflects prior antigen exposure and potential future response. However, despite advances in deep repertoire sequencing, enormous TCR diversity complicates the use of TCR clonotypes as clinical biomarkers. We propose a new framework that leverages experimentally inferred antigen-associated TCRs to form meta-clonotypes – groups of biochemically similar TCRs – that can be used to robustly quantify functionally similar TCRs in bulk repertoires across individuals. We apply the framework to TCR data from COVID-19 patients, generating 1831 public TCR meta-clonotypes from the SARS-CoV-2 antigen-associated TCRs that have strong evidence of restriction to patients with a specific human leukocyte antigen (HLA) genotype. Applied to independent cohorts, meta-clonotypes targeting these specific epitopes were more frequently detected in bulk repertoires compared to exact amino acid matches, and 59.7% (1093/1831) were more abundant among COVID-19 patients that expressed the putative restricting HLA allele (false discovery rate [FDR]&lt;0.01), demonstrating the potential utility of meta-clonotypes as antigen-specific features for biomarker development. To enable further applications, we developed an open-source software package, <italic>tcrdist3,</italic> that implements this framework and facilitates flexible workflows for distance-based TCR repertoire analysis.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>T cell receptor</kwd><kwd>immune repertoire</kwd><kwd>SARS-CoV-2</kwd><kwd>software</kwd><kwd>biomarkers</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000060</institution-id><institution>National Institute of Allergy and Infectious Diseases</institution></institution-wrap></funding-source><award-id>AI136514-03</award-id><principal-award-recipient><name><surname>Mayer-Blackwell</surname><given-names>Koshlan</given-names></name><name><surname>Schattgen</surname><given-names>Stefan</given-names></name><name><surname>Crawford</surname><given-names>Jeremy C</given-names></name><name><surname>Souquette</surname><given-names>Aisha</given-names></name><name><surname>Gaevert</surname><given-names>Jessica A</given-names></name><name><surname>Hertz</surname><given-names>Tomer</given-names></name><name><surname>Thomas</surname><given-names>Paul G</given-names></name><name><surname>Bradley</surname><given-names>Philip G</given-names></name><name><surname>Fiore-Gartland</surname><given-names>Andrew</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>ORIP S10OD028685</award-id><principal-award-recipient><name><surname>Mayer-Blackwell</surname><given-names>Koshlan</given-names></name><name><surname>Fiore-Gartland</surname><given-names>Andrew</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection, and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Distance-based TCR analysis enables grouping of biochemically similar clonotypes into meta-clonotypes that have increased publicity, and therefore statistical power, for population-level detection of antigen-specific T cells in infection and vaccination.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>An individual’s unique repertoire of T-cell receptors (TCRs) is shaped by antigen exposure and is a critical component of immunological memory (<xref ref-type="bibr" rid="bib10">Emerson et al., 2017</xref>; <xref ref-type="bibr" rid="bib39">Welsh and Selin, 2002</xref>). With the advancement of immune repertoire profiling, TCR repertoires are a largely untapped source of biomarkers that could potentially be used to predict immune responses to a wide range of exposures including viral infections (<xref ref-type="bibr" rid="bib41">Wolf et al., 2018</xref>), tumor neoantigens (<xref ref-type="bibr" rid="bib1">Ahmadzadeh et al., 2019</xref>; <xref ref-type="bibr" rid="bib4">Chiou et al., 2021</xref>; <xref ref-type="bibr" rid="bib17">Kato et al., 2018</xref>), or environmental allergens (<xref ref-type="bibr" rid="bib3">Cao et al., 2020</xref>). However, the extreme diversity characterizing TCR repertoires, both within and between individuals, presents major hurdles to biomarker development. Using peptide—major histocompatibility complex (pMHC) tetramer sorting to focus on TCRs recognizing individual epitopes, which depends on knowing the peptide antigen and its MHC restriction, typically reveals that many distinct TCRs are able to recognize even a single pMHC (<xref ref-type="bibr" rid="bib5">Coles et al., 2020</xref>; <xref ref-type="bibr" rid="bib25">Meysman et al., 2019</xref>). This complicates detection of population-wide signatures of antigen exposure. Modeling (<xref ref-type="bibr" rid="bib9">Elhanati et al., 2018</xref>) and empirical evidence (<xref ref-type="bibr" rid="bib37">Soto et al., 2019</xref>) suggest that only 10–15% of single-chain TCRs are public or shared by multiple individuals. Furthermore, only a fraction of the repertoire can be sampled, making it difficult to reproducibly detect relevant TCR clonotypes from an individual, let alone reliably detect public clonotypes in a population; in practice, the problem can be exacerbated by heterogeneous repertoire sequencing depth, which affects the precision with which the frequency of rare TCRs can be estimated. Thus, individual T-cell clonotypes are currently suboptimal and underpowered for population-level investigations of TCR specificity, which limits their application in the development of TCR-based clinical biomarkers.</p><p>In this study, we describe a framework for engineering ‘meta-clonotypes’: groupings of TCRs sharing biochemically similar complementarity determining regions (CDRs), which enable population-level biomarker development (<xref ref-type="fig" rid="fig1">Figure 1</xref>). Previously, we introduced TCRdist, a biochemically informed distance metric that enabled grouping of paired αβ TCRs by antigen specificity based on their sequence similarity (<xref ref-type="bibr" rid="bib7">Dash et al., 2017</xref>). TCRdist is correlated with edit distance, but it can vary considerably among TCRs with identical edit distances (<xref ref-type="fig" rid="fig2">Figure 2</xref>). While other tools exist to identify statistically anomalous groups of TCRs within a single sample that may be indicative of a polyclonal response to antigenic selection (<xref ref-type="bibr" rid="bib13">Glanville et al., 2017</xref>; <xref ref-type="bibr" rid="bib14">Huang et al., 2020</xref>; <xref ref-type="bibr" rid="bib28">Pogorelyy et al., 2019</xref>; <xref ref-type="bibr" rid="bib29">Pogorelyy and Shugay, 2019</xref>; <xref ref-type="bibr" rid="bib31">Ritvo et al., 2018</xref>; <xref ref-type="bibr" rid="bib34">Shugay et al., 2015</xref>), the meta-clonotype framework has been developed for a different task: leveraging receptor–antigen associations determined from in vitro experiments to create public, antigen-associated meta-clonotypes from otherwise private TCRs. This application is made possible by a new open-source Python3 software package <italic>tcrdist3</italic> that brings flexibility to distance-based repertoire analysis, allowing customization of the distance metric, and at-scale computation with sparse data representations and parallelized, byte-compiled code.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>T-cell receptor (TCR) meta-clonotypes.</title><p>(<bold>A</bold>) <italic>Defining meta-clonotypes from antigen-associated TCRs</italic>. Sets of antigen-associated TCRs were used together with synthetic background repertoires to engineer TCR meta-clonotypes that define biochemically similar TCRs based on a centroid TCR and a TCRdist radius. For each antigen-specific clonotype, we used <italic>tcrdist3</italic> to evaluate the proportion of TCRs spanned at different TCRdist radii within (i) its antigen-associated TCR set (black) and (ii) a synthetic control V- and J-gene-matched background set (purple). A synthetic background was generated using 100,000 Optimized Likelihood estimate of Immunoglobulin Amino acid sequences (OLGA)-generated TCRs and 100,000 TCRs subsampled from umbilical cord blood; OLGA-generated TCRs were sampled to match the V–J gene frequency in each MIRA receptor set, with weighting to account for the sampling bias (see Methods for details). The objective was to select the largest radius that includes no more than an estimated proportion of 1E<sup>−6</sup> TCRs in the background. The subset of antigen-associated TCRs spanned by the selected radius were then used to develop an additional meta-clonotype motif constraint based on conserved residues in the complementarity determining region (CDR)3 (see Methods for details). An example logo plot shows the CDR3 β-chain motif formed from TCRs – activated by a SARS-CoV-2 peptide (MIRA55 ORF1ab amino acids 1316:1330, ALRKVPTDNYITTY) – within a TCRdist radius 16 of this meta-clonotype’s centroid TCR. (<bold>B</bold>) <italic>Quantifying meta-clonotype conformant TCRs in bulk repertoires</italic>. The definition of each TCR meta-clonotype can be used to quantify the frequency of similar TCRs in bulk repertoires. EXACT sequences match the meta-clonotype centroid at the amino acid level, RADIUS-conformant sequences diverge from the centroid by no more than the radius distance, and RADIUS + MOTIF conformant sequences is the subset of radius-conformant TCRs with a CDR3 sequences matching the meta-clonotype’s CDR3 motif. (<bold>C</bold>) <italic>Population-level analysis of TCR meta-clonotype frequency</italic>. The frequency of meta-clonotype conformant sequences in multiple bulk repertoires allows comparison across a population. In this study, to test whether meta-clonotypes carry important antigen-specific signals above and beyond individual clonotypes, we searched for meta-clonotype conformant TCRs in COVID-19 patients with repertoires collected 0–30 days after diagnosis. We found stronger associations with predicted HLA restrictions based on counts of meta-clonotype conforming TCRs compared to associations using counts of exact clonotypes.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68605-fig1-v1.tif"/></fig><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>TCRdist compared to edit distance.</title><p>(<bold>A</bold>) Correspondence between edit distance (<italic>x</italic>-axis) and TCRdist (<italic>y</italic>-axis) for MIRA55 T-cell receptors (TCRs) with matching TRBV genes. The grayscale colormap shows the percentage of TCRs with a given TCRdist score within each edit distance category. (<bold>B</bold>) Examples of complementarity determining region (CDR)3s with TCRdist varying between 6 and 24 units among sequences with edit distance 2 (2 substitutions) from a centroid with matching TRBV genes. TCR distances range based on differential penalties assigned to specific residue substitutions.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68605-fig2-v1.tif"/></fig><p>The framework is based on TCR sequences that have been experimentally enriched for antigen recognition, most commonly by sorting T cells labeled by peptide–MHC multimers or by activation-induced markers upon stimulation (we refer to these as ‘antigen-associated’ TCRs). Each meta-clonotype is defined by an antigen-associated centroid TCR and a TCRdist radius chosen so that the expected frequency of antigen-naive receptors within the radius is low. A CDR3 ‘motif’ is constructed from the subset of antigen-associated TCRs within the radius to further refine the meta-clonotype’s specificity. Together the centroid receptor, radius, and the CDR3 motif can be used to search for conformant TCRs in large bulk-sequenced repertoires and quantify their frequency (<xref ref-type="fig" rid="fig1">Figure 1</xref>). As intended, we find that TCR centroids, which are often private, gain publicity as meta-clonotypes. The expanded publicity of meta-clonotypes provides an opportunity to develop population-level biomarkers that may depend on antigen-specific features of the TCR repertoire. Shifting the focus of repertoire analysis from clonotypes to meta-clonotypes increases statistical power; grouping similar clonotypes reduces the sparsity of finite repertoire samples and increases the precision with which antigen-specific cell abundance can be estimated.</p><p>To demonstrate one potential application of meta-clonotypes and to characterize their ability to estimate the frequency of similar antigen-specific T cells in bulk-sequenced TCR repertoires, we apply the meta-clonotype framework to a large publicly available dataset of SARS-CoV-2 antigen-associated TCRs. The dataset comes from a recent study that sought to elucidate the role of cellular immune responses in acute SARS-CoV-2 infection and examined the TCR repertoires of patients diagnosed with COVID-19 disease. Researchers used an assay based on antigen stimulation and flow cytometric sorting of activated CD8+ T cells to identify SARS-CoV-2 peptide-associated TCR β-chains; the assay is called ‘multiplex identification of TCR antigen specificity’ or MIRA (<xref ref-type="bibr" rid="bib18">Klinger et al., 2015</xref>) and the output is a set of predicted antigen-associated TCR sequences. Data from these experiments were released publicly in July 2020 by Adaptive Biotechnologies and Microsoft as part of ‘immuneRACE’ and their efforts to stimulate science on COVID-19 (<xref ref-type="bibr" rid="bib27">Nolan et al., 2020</xref>; <xref ref-type="bibr" rid="bib36">Snyder et al., 2020</xref>). The MIRA antigen stimulation assays identified 253 sets of 6 or more TCR β-chains associated with CD8+ T cells activated by exposure to SARS-CoV-2 peptides, with TCR sets analyzed ranging in size from 6 to 16,607 TCRs (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1b</xref>); we refer to these sets as MIRA0 through MIRA252 in rank order by their size. The deposited immuneRACE datasets also included bulk TCR β-chain repertoires from 694 patients within 0–30 days of COVID-19 diagnosis. Our analysis of these data demonstrates how it is possible to define public meta-clonotypes from sets of private antigen-associated TCRs and directly evaluates their ability to carry population-level antigen-specific signals in comparison with individual clonotypes.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Experimental enrichment of antigen-specific T cells allows discovery of TCRs with biochemically similar neighbors</title><p>Searching for identical TCRs within a repertoire – arising either from clonal expansion or convergent nucleotide encoding of amino acids in the CDR3 – is a common strategy for identifying functionally important receptors. However, in the absence of experimental enrichment procedures, observing T cells with the same amino acid TCR sequence in a bulk sample is rare. For example, in 10,000 β-chain TCRs from an umbilical cord blood sample, less than 1 % of TCR amino acid sequences were observed more than once, inclusive of possible clonal expansions (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). By contrast, a valuable feature of antigen-associated TCRs is the presence of multiple receptors with identical or highly similar amino acid sequences (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). For instance, 45% of amino acid TCR sequences were observed more than once (excluding clonal expansions) in a set of influenza M1(GILGFVFTL)-A*02:01 peptide–MHC tetramer-sorted subrepertoires from 15 subjects (<xref ref-type="bibr" rid="bib7">Dash et al., 2017</xref>). Enrichment was evident compared to cord blood for additional peptide–MHC tetramer-sorted subrepertoires obtained from VDJdb (<xref ref-type="bibr" rid="bib35">Shugay et al., 2018</xref>), though the proportion of TCRs with an identical or similar TCR in each set was heterogeneous.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Experimental enrichment of antigen-associated T-cell receptors (TCRs) increases neighbor density.</title><p>(<bold>A</bold>) TCR repertoire subsets obtained by single-cell sorting with peptide–major histocompatibility complex (MHC) tetramers (green), MIRA peptide stimulation enrichment (MIRA55, MIRA48; purple), or random subsampling of umbilical cord blood (1000 or 10,000 TCRs; blue). Biochemical distances were computed among all pairs of TCRs in each subset using the TCRdist metric. Neighborhoods were formed around each TCR using a variable radius (<italic>x</italic>-axis) and the percent of TCRs in the set with at least one other TCR within its neighborhood was computed; notably the line represents a summary of TCRs in each set and is therefore more precise for larger TCR sets. A radius of zero indicates the proportion of TCRs that have at least one TCR with an identical amino acid sequence (solid square). Dash BMLF (Epstein–Barr Virus), M1 (Influenza), and pp65 (Cytomegalovirus) refer to epitopes from <xref ref-type="bibr" rid="bib7">Dash et al., 2017</xref>. ELAGIGILTV (Human Mart-1 antigen) and LLLGIFILV (HM1.24 antigen in multiple myeloma) downloaded from VDJdb (<xref ref-type="bibr" rid="bib35">Shugay et al., 2018</xref>), which were submitted by Andrew Sewell et al. (<bold>B</bold>) Analysis of MIRA sets for which the participants contributing the TCRs were significantly enriched with a specific class I HLA allele <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1c</xref>. Colors are assigned based on the vertical ranking of the lines along the right <italic>y</italic>-axis and match the order in the color legend.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68605-fig3-v1.tif"/></fig><p>We investigated the degree to which the MIRA assay employed by <xref ref-type="bibr" rid="bib27">Nolan et al., 2020</xref> identified TCRs with identical or similar amino acid sequences. In general, across sets of MIRA-identified β-chain TCRs, each associated with a different antigen, the proportion of amino acid sequences observed more than once was generally lower than in the tetramer-enriched repertoires and varied considerably across the sets; some MIRA sets resembled tetramer-sorted subrepertoires (<xref ref-type="fig" rid="fig3">Figure 3B</xref>; see MIRA133), while others were more similar to unenriched repertoires (<xref ref-type="fig" rid="fig3">Figure 3B</xref>; see MIRA90). The increased diversity in MIRA-enriched TCR sets versus tetramer-enriched TCR sets may, in part, be explained by: (1) peptides being presented by the full complement of the native host’s MHC molecules compared to a single defined peptide–MHC complex, (2) recruitment of lower affinity receptors, (3) antigen specificity conferred primarily by the alpha rather than the sequenced beta chain, or (4) nonspecific ‘bystander’ activation in the MIRA stimulation assay. From an experimental standpoint, MIRA offers the benefit of being able to identify TCRs associated with an antigen before a specific pMHC has been identified; however, the resultant diversity in antigen-associated TCRs recovered by MIRA poses a challenge for identifying relevant TCR motifs associated with multiple possible TCR:pMHC interactions.</p></sec><sec id="s2-2"><title>TCR biochemical neighborhood density is heterogeneous among set of antigen-associated TCRs</title><p>We next investigated the proportion of unique TCRs with at least one biochemically similar neighbor among TCRs with the same putative antigen specificity. We and others have shown that a single peptide–MHC epitope is often recognized by many distinct TCRs with closely related amino acid sequences <xref ref-type="bibr" rid="bib7">Dash et al., 2017</xref>; in fact, the detection of such clusters in bulk-sequenced repertoires is the basis of several existing tools: GLIPH (<xref ref-type="bibr" rid="bib13">Glanville et al., 2017</xref>; <xref ref-type="bibr" rid="bib14">Huang et al., 2020</xref>), ALICE (<xref ref-type="bibr" rid="bib28">Pogorelyy et al., 2019</xref>), TCRNET (<xref ref-type="bibr" rid="bib31">Ritvo et al., 2018</xref>), and RepAn (<xref ref-type="bibr" rid="bib42">Yohannes et al., 2021</xref>). Therefore, to better understand sets of antigen-associated TCRs, like the SARS-CoV-2 MIRA data, we evaluated the neighborhood surrounding each TCR, defined as the set of similar TCRs whose sequence divergence is within a specified radius. The radius was measured using TCRdist, a position weighted, multi-CDR distance metric. Briefly, differences in the amino acid sequences of the CDRs are totaled based on the number of gaps (−4) and their BLOSUM62 substitution penalties (ranging from 0 to −4) with a default threefold weighting on CDR3 substitutions (see Methods for details of <italic>tcrdist3</italic> reimplementation of TCRdist); a one amino acid mismatch in the CDR3 results in a maximal distance of 12 TCRdist units (tdus). As the radius about a TCR centroid expands, the number of TCRs it encompasses naturally increases. The increase was greater among the sets of antigen-associated TCRs compared to the ‘background’ repertoires that were not experimentally enriched for antigen-specific T cells (<xref ref-type="fig" rid="fig3">Figure 3</xref>).</p><p>To better understand the relationship between the TCR distance radius and the density of proximal TCRs, we constructed empirical cumulative distribution functions (ECDFs) for each unique TCR (<xref ref-type="fig" rid="fig4">Figure 4</xref>). The ECDF for each unique TCR (each represented by one line in <xref ref-type="fig" rid="fig4">Figure 4</xref>) shows the proportion of all TCRs within the indicated radius; those with sparse neighborhoods appear as lines that remain low and do not increase along the <italic>y</italic>-axis even as the search radius expands (lines are hidden by the <italic>x</italic>-axis). The proportion of these TCRs with sparse or empty neighborhoods (ECDF proportion &lt;0.001) is indicated by the height of the gray area plotted below the ECDF (<xref ref-type="fig" rid="fig4">Figure 4</xref>). We observed the highest density neighborhoods within repertoires that were sorted based on binding to a single peptide–MHC tetramer. For instance, with the influenza M1(GILGFVFTL)-A*02:01 tetramer-enriched repertoire from 15 subjects, we observed that many TCRs were concentrated in dense neighborhoods, which included as much as 30 % of the other influenza M1-recognizing TCRs within a radius of 12 tdus (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). Notably there were also many TCRs with empty or sparse neighborhoods using a radius of 12 tdus (111/247, 44%) or 24 tdus (83/247, 34%). Based on previous work (<xref ref-type="bibr" rid="bib7">Dash et al., 2017</xref>), we assume that the majority of these tetramer-sorted CD8+ T cells with few proximal neighbors do indeed bind the influenza M1:A*02:01 tetramer. This suggests that TCRs within sparse neighborhoods represent uncommon modes of antigen recognition and highlights the broad heterogeneity of neighborhood densities even among TCRs recognizing a single peptide–MHC.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>T-cell receptor (TCR) neighborhoods have higher density among TCRs that have been experimentally enriched for antigen-specific T cells compare to unenriched repertoires.</title><p>TCR β-chains from (<bold>A</bold>) a peptide–major histocompatibility complex (MHC) tetramer-enriched subrepertoire (<italic>n</italic> = 247), (<bold>B</bold>) a MIRA peptide stimulation-enriched subrepertoire (<italic>n</italic> = 497), or (<bold>C</bold>) an umbilical cord blood unenriched repertoire (<italic>n</italic> = 9966), and (<bold>D</bold>) synthetically generated sequences using Optimized Likelihood estimate of Immunoglobulin Amino acid sequences (OLGA; <italic>n</italic> = 10,000; <xref ref-type="bibr" rid="bib33">Sethna et al., 2019</xref>). Within each subrepertoire, an empirical cumulative distribution function (ECDF) was estimated for each TCR (one line) acting as the centroid of a neighborhood over a range of distance radii (<italic>x</italic>-axis). Each ECDF shows the proportion of TCRs within the set with a distance to the centroid less than the indicated radius. ECDF color corresponds to the length of the complementarity determining region (CDR)3-β loop. ECDF curves were randomly shifted by &lt;1 unit along the <italic>x</italic>-axis to reduce overplotting. Vertical ECDF lines starting at 10<sup>−4</sup> indicate no similar TCRs at or below that radius. Percentage of TCRs with an ECDF proportion &lt;10<sup>−3</sup> (bottom panels), indicates the percentage of TCRs without, or with very few biochemically similar neighbors at the given radius.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68605-fig4-v1.tif"/></fig><p>Neighbor densities for individual TCRs within the MIRA sets were highly heterogeneous. Densities for an illustrative MIRA set are shown in <xref ref-type="fig" rid="fig5">Figure 5</xref> (MIRA55:ORF1ab; 1316:1330 [amino acid]; peptide ALRKVPTDNYITTY). Within this antigen-associated repertoire, at 24 tdus 8.9 % (44/497) of TCR neighborhoods included &gt;10% of the other antigen-activated CD8+ TCRs (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). As expected, TCR neighborhoods in the umbilical cord blood repertoire were sparser (<xref ref-type="fig" rid="fig5">Figure 5B</xref>); the densest neighborhood included only 0.13 % of the repertoire at 24 tdus. We also noted that TCRs with sparse or empty neighborhoods tended to have longer CDR3 loops (<xref ref-type="fig" rid="fig4">Figure 4C</xref>) and lower generation of probability (p<sub>gen</sub>; <xref ref-type="fig" rid="fig5">Figure 5B</xref>). This is consistent with mathematical modeling that shows that TCRs with longer CDR3 loops have a lower p<sub>gen</sub> during genomic recombination of the TCR locus (<xref ref-type="bibr" rid="bib20">Marcou et al., 2018</xref>; <xref ref-type="bibr" rid="bib26">Murugan et al., 2012</xref>; <xref ref-type="bibr" rid="bib33">Sethna et al., 2019</xref>). Absent strong selection for antigen recognition, longer TCRs with lower generation probabilities are thus likely to have less dense biochemical neighborhoods. Together, these observations suggest that biochemical neighborhood density is highly heterogeneous among TCRs and that it may depend on mechanisms of antigen recognition as well as receptor V(D)J recombination biases (<xref ref-type="bibr" rid="bib38">Thomas and Crawford, 2019</xref>).</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Radius-defined neighborhood densities within an antigen-associated and a synthetic background repertoire.</title><p>(<bold>A</bold>) Each T-cell receptor (TCR) (one line, <italic>n</italic> = 497) in the MIRA55 antigen-associated set acts as the centroid of a neighborhood and an empirical cumulative distribution function (ECDF) is estimated over a range of distance radii (<italic>x</italic>-axis). Each ECDF shows the proportion of TCRs within the MIRA set having a distance to the centroid less than the indicated radius. The ECDF line color corresponds to the TCR probability of generation (p<sub>gen</sub>) estimated using Optimized Likelihood estimate of Immunoglobulin Amino acid sequences (OLGA; <xref ref-type="bibr" rid="bib33">Sethna et al., 2019</xref>). The ECDF curves are randomly shifted by &lt;1 unit along the <italic>x</italic>-axis to reduce overplotting. The bottom panel shows the percentage of TCRs with an ECDF proportion &lt;10<sup>−3</sup>. (<bold>B</bold>) Estimated ECDF for each MIRA55 TCR based on the proportion of TCRs in a synthetic background repertoire that are within the indicated radius (<italic>x</italic>-axis). A synthetic background was generated using 100,000 OLGA-generated TCRs and 100,000 TCRs subsampled from umbilical cord blood; OLGA-generated TCRs were sampled to match the V–J gene frequency in the MIRA 55 receptor set, with weighting to account for the sampling bias (see Methods for details). (<bold>C</bold>) Antigen-associated ECDF (<italic>y</italic>-axis) of one example TCR’s neighborhood (red line) plotted against ECDF within the synthetic background (<italic>x</italic>-axis). Example TCR neighborhood is the same indicated by the red line in (<bold>A</bold>) and (<bold>B</bold>). The dashed gray line indicates neighborhoods that are equally dense with TCRs from the antigen-associated and background subrepertoires. Annotations indicate the meta-clonotype radius for each data point in TCRdist units.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68605-fig5-v1.tif"/></fig></sec><sec id="s2-3"><title>Meta-clonotype radius can be tuned to balance sensitivity and specificity</title><p>The utility of a TCR-based biomarker depends on the antigen specificity of the TCRs. Therefore, a limitation of distance-based clustering is the presence of similar TCR sequences that lack the ability to recognize the target antigen. To be useful, a meta-clonotype definition should be broad enough to capture multiple biochemically similar TCRs with shared antigen recognition, but not excessively broad as to include a high proportion of nonspecific TCRs. Statistically, we think of a meta-clonotype definition as a way to balance sensitivity and specificity, respectively, the ability to include antigen-recognizing TCRs and exclude nonspecific TCRs. Because the density of neighborhoods around TCRs are heterogeneous, we hypothesized that the optimal radius defining a meta-clonotype may differ for each TCR. To find the ideal radius we proposed comparing the relative density of a radius-defined neighborhood within a set of antigen-associated TCRs (<xref ref-type="fig" rid="fig5">Figure 5A</xref>) to the density of the radius-defined neighborhood within a background TCR repertoire (<xref ref-type="fig" rid="fig5">Figure 5B,C</xref>); here, the background repertoire can be any set of TCRs from antigen-naive repertoires. Though ideally this background comparator would explicitly exclude antigen-specific TCRs, we can use a nonselected repertoire as a background because the frequency of antigen-specific T cells in a large background drawn from antigen-naive donors is assumed to be low. Also, a nonselected background is a relevant comparator because it provides an estimate of the number of false detections we expect when each meta-clonotype is ultimately used to search for and quantify putatively antigen-specific sequences in bulk repertoires.</p><p>An ideal radius would define a meta-clonotype with a high density of conformant sequences within a set of antigen-associated TCRs and a low density among a set of background TCRs. We demonstrate an algorithm for selecting an optimal radius for each TCR in the MIRA55:ORF1ab dataset, which includes TCRs from 15 COVID-19 diagnosed subjects (see Methods for details about MIRA and the immuneRACE dataset). First, an ECDF is constructed for each centroid TCR showing the relationship between the meta-clonotype radius and its sensitivity: its inclusion of similar antigen-recognizing TCRs, approximated by the proportion of TCRs in the antigen-associated MIRA set that are within the centroid’s radius (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). Next, an ECDF is constructed for each TCR showing the relationship between the meta-clonotype radius and its specificity: its exclusion of TCRs with divergent antigen recognition, approximated by the proportion of TCRs in a background repertoire within the centroid’s radius (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). The objective is to select the largest radius that includes no more than one in one-million background TCRs; while this threshold is arbitrary, practically it means that in a deeply sampled repertoire we expect to observe only a few TCRs within the radius and that deviation from this may indicate antigenic selection. Typically, to accurately estimate the frequency of a rare event, one would prefer to observe many such events and use the average; here, this would require having a background set of many millions of TCRs that would be used to evaluate every potential radius for each TCR centroid, presenting a substantial computational hurdle.</p><p>We noted that, based on germline encoded CDR residues alone, much of the TCR background is too distant from a single TCR to be relevant and therefore realized that efficiency could be gained by focusing on TCRs that share the same TRBV and TRBJ genes. Therefore, for each set of antigen-associated TCRs identified using MIRA, we created a two part background. One part consisted of 100,000 synthetic TCRs whose TRBV- and TRBJ-gene frequencies matched those of the antigen-associated TCRs; TCRs were generated using the software OLGA with slight modification to allow V–J gene directed sequence generation (<xref ref-type="bibr" rid="bib20">Marcou et al., 2018</xref>; <xref ref-type="bibr" rid="bib33">Sethna et al., 2019</xref>). The other part consisted of 100,000 umbilical cord blood TCRs sampled from 8 subjects (<xref ref-type="bibr" rid="bib2">Britanova et al., 2016</xref>). This composition balanced denser sampling of sequences near the candidate meta-clonotype centroids with broad sampling of TCRs from an antigen-naive repertoire. The dense sampling of TCRs with similar V–J combinations to the antigen-associated TCRs allowed for estimation of the overall frequency of meta-clonotype neighbors in the background well below 1 in 200,000. Conceptually, this is achievable because we oversampled the TCRs that were more likely to be within the meta-clonotype radius, therefore greatly increasing the statistical efficiency and precision with which we could estimate the overall frequency of meta-clonotype neighbors in the background. This idea is an adaptation of methods that are commonly used to adjust survey results when the sampling has known biases (<xref ref-type="bibr" rid="bib12">Gelman, 2007</xref>). It is helpful to demonstrate the concept with an example: suppose we generate background TCRs (i.e., OLGA-generated) from one V–J gene combination, if we find that 5/50,000 (i.e., 10<sup>–4</sup>) TCRs are within a TCR’s radius, but that they are sampled from a V–J gene combination with 1% (i.e., 10<sup>–2</sup>) prevalence, the estimated frequency in the full background would be 1 in 1 million (10<sup>−4</sup> × 10<sup>−2</sup> = 10<sup>−6</sup>). Across all V–J gene defined strata in the synthetic background, the adjusted frequency <italic>P<sub>BG</sub></italic> can be estimated as a weighted average, with V–J gene strata frequencies from the full background as the weights (<italic>w<sub>i</sub></italic>):<disp-formula id="equ1"><mml:math id="m1"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mi>J</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula></p><p>where <italic>Y<sub>i</sub></italic> is the number of TCRs within the radius of the centroid in the <italic>i</italic>th V–J gene defined strata and <italic>n<sub>i</sub></italic> is the number of total sampled TCRs in the strata. Estimating neighbor frequency from a V–J gene-matched background alone, however, assumes there are zero neighbors in the unobserved strata with nonmatched V–J genes. Therefore, to avoid overlooking other regions of TCR space, we combined the synthetic background with a uniformly sampled background from antigen-naive cord blood repertoires. This is potentially important because with TCRdist – in contrast to metrics that require a matched V-gene – it is possible to find biochemically similar TCRs with different V-genes.</p><p>We found that for each TCR, its radius-defined meta-clonotype was more abundant within a repertoire and more prevalent in a human cohort than the exact clonotype; for example, TCR meta-clonotypes formed from the MIRA55:ORF1ab TCR set were detected in 3–12 (median 6) of 15 HLA-A*01 participants in the MIRA cohort, despite 34 of the 46 centroid clonotype TCRs being private (i.e., found in only 1 of 15 HLA-A*01 participants) (<xref ref-type="fig" rid="fig6">Figure 6</xref>). Generally, the neighborhoods around TCR centroids with higher probabilities of generation consistently spanned a larger proportion of background TCRs across a range of radii, suggesting that a smaller radius may be desirable for forming meta-clonotypes from high p<sub>gen</sub> TCRs. With a large radius, most TCR centroids had high sensitivity but low specificity, indicated by the meta-clonotypes including both a high proportion of TCRs from the antigen-associated and background repertoires. Some TCRs had low sensitivity even at a radius of 24 tdus, which is indicative of a low p<sub>gen</sub> or a ‘snowflake’ TCR: a seemingly unique TCR among the antigen-associated and background TCRs. However, radius-defined neighborhoods around many TCRs in the MIRA55:ORF1ab repertoire included 1–10% of the antigen-associated TCRs (5–50 clonotypes) with a radius that included fewer than 0.0001 % of background TCRs (equivalent to 1 out of 10<sup>6</sup>), demonstrating a level of sensitivity and specificity that would be favorable for the development of a TCR biomarker. In <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>, additional information is provided about the other MIRA sets and the properties of meta-clonotypes that were generated.</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Publicity analysis in MIRA participants of CD8+ T-cell receptor (TCR) β-chain features activated by SARS-CoV-2 peptide ORF1ab (MIRA55) predicted to bind HLA-A*01.</title><p>The grid shows all features that were present in two or more MIRA participants. TCR feature publicity across individuals was assessed using two methods: (1) tcrdist3 <italic>meta-clonotypes</italic> (rectangles) – inclusion criteria defined by a centroid TCR and all TCRs within an optimized TCRdist radius selected to span &lt;10<sup>−6</sup> TCRs in a bulk-sequenced background repertoire, and (2) exact public clonotypes (circles) are defined by matching TRBV gene usage and identical complementarity determining region (CDR)3 amino acid sequence. Per subject, the color-scale shows the meta-clonotype conformant clone with the highest probability of generation (p<sub>gen</sub>). All TCRs captured by a ‘redundant’ meta-clonotypes were completely captured by a higher-ranked meta-clonotype. Redundant meta-clonotypes were not subsequently evaluated.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68605-fig6-v1.tif"/></fig></sec><sec id="s2-4"><title>Sensitivity of optimized meta-clonotype radius to background size and specification</title><p>We conducted sensitivity analyses to evaluate how the optimal radius was dependent upon the size of the synthetic background. Using meta-clonotype centroids from the MIRA55:ORF1ab TCR set we recomputed the optimal radius for each meta-clonotype using 2,000,000 background sequences (1,000,000 synthetics V–J-matched OLGA and 1,000,000 cord blood TCRs), then drew repeated random samples from that background varying in size from 25,000 to 1,000,000 TCRs. We found that with a smaller background the optimal radius tended to be greater and was more variable over repeat samples; this is consistent with a lower and more variable chance of finding a sequence in the background that would help constrain the optimal radius. As the size of the background increased to 1,000,000 the estimates of the optimal radius generally approached the estimate using a 2,000,000 TCR background (<xref ref-type="fig" rid="fig7">Figure 7</xref>). For large sets of antigen-associated TCRs (i.e., greater than 10,000) or for users with modest computing resources, using 200,000 sequences with V–J-matched sampling strikes a balance between computational efficiency and bias in radius estimates, where the median radius over many iterations coincided with the median radius estimated from a background of 2,000,000 TCRs. Generally, the potential bias in estimation of an optimal radius is small, with the IQR ranging from 0 to 6 tdus, however, reducing bias by estimating optimal radii from a larger synthetic background (1–2 million TCRs) may still be prudent and computationally tractable. For instance, with <italic>tcrdist3,</italic> computing radii for 500 unique MIRA TCRs using a synthetic background of 1,000,000 TCRs (500,000 synthetic V–J matched and 500,000 sampled from cord blood) can be completed in 1 min using 12 CPUs and 48 GB of memory.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Sensitivity of optimized meta-clonotype radius to background size and specification.</title><p>(<bold>A</bold>) Radius estimates for MIRA55 T-cell receptors (TCRs) using different synthetic backgrounds: (<bold>i</bold>) randomly generated TCRs from Optimized Likelihood estimate of Immunoglobulin Amino acid sequences (OLGA; <xref ref-type="bibr" rid="bib33">Sethna et al., 2019</xref>), (ii) V–J gene-matched sequences generated with OLGA, and (iii) an equal mixture of V–J gene-matched sequences with randomly sampled cord blood TCRs. We compare the estimates generated with the three synthetic backgrounds (of total size 50 , 100 , 200 , and 500 K) to the radii estimates derived using 1 million cord blood TCRs uniformly sampled from eight donors. Weights were applied to correct for biased sampling as described in the paper. (<bold>B</bold>) Evaluation of bias in radius estimates based on background size. Here, we compared bias in subsampled estimate to the estimate derived from a synthetic background of 2 million TCRs (50 % [1 million] cord blood and 50 % [1 million] V–J gene-matched sequences synthesized with OLGA). For each background size, we drew 10 subsamples from the 2 million TCR set.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68605-fig7-v1.tif"/></fig><p>Next, for a fixed background size (200,000 TCRs), we evaluated the ability to estimate the optimal radius using three background sets: (1) 100,000 V–J gene-matched OLGA + 100,000 cord blood (primary background), (2) 200,000 V–J gene-matched OLGA, or (3) 200,000 OLGA without V–J gene matching (<xref ref-type="fig" rid="fig7">Figure 7</xref>). Each method was benchmarked against the optimal radii estimated from 1,000,000 cord blood TCRs from eight individuals. We found that the 200,000 TCRs generated from OLGA without V–J gene-matched sampling resulted in radii estimates that were substantially larger and more variable than those that were estimated using V–J gene-matched sampling and adjustment; this bias suggests that the resulting meta-clonotypes would have reduced specificity and therefore supports use of V–J gene focused sampling and adjustment to obtain less biased and more efficient estimation of the optimal radius. There was minimal further reduction in the estimation bias by using the background that mixed cord blood and OLGA-generated TCRs. We concluded that using a mixed background was desirable because it reduced dependency on sampling from TCRs with specific V–J gene rearrangements, which may be limiting for rarer V–J gene rearrangements; also, the mix helped guard against any idiosyncrasies that may exist in purely synthetic or purely cord blood backgrounds. Ultimately, the best choice for a background may depend on the question being asked and the data that is available, with the ideal background considering factors including donor HLA, age, potential antigen exposures, and other factors that may influence the repertoires.</p></sec><sec id="s2-5"><title>Application and meta-clonotype evaluation: engineering meta-clonotypes for SARS-CoV-2</title><p>The MIRA antigen stimulation assays used to generate the IMMUNEcode 2.0 database (<xref ref-type="bibr" rid="bib27">Nolan et al., 2020</xref>) identified sets of TCR β-chains associated with recognition of a SARS-CoV-2 antigen using CD8+ T cells enriched from PBMC samples from 62 COVID-19 diagnosed patients and 26 COVID-19-negative subjects. Of these, 253 included at least 6 unique TCRs and included TCRs from more than 1 subject, which we refer to as MIRA0 – MIRA252 based on the number of sequences observed, in descending order (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1b</xref>). From the MIRA sets, all TCR clonotypes (defined by identical TRBV gene, TRBJ gene, and CDR3 at the amino acid level) were initially considered as candidate centroids; only 2.7 % of the clonotypes were found in more than one MIRA participant. For each candidate TCR, a meta-clonotype was engineered by estimating the maximum radius that limited the estimated number of neighboring TCRs in a bulk antigen-naive repertoire to less than 1 in 10<sup>6</sup>, using a synthetic background as described above. For each MIRA set we then ranked the meta-clonotypes by their sensitivity, approximated as the proportion of TCRs in the set that were within the meta-clonotype radius and matched by CDR3 motif (diagrammed in <xref ref-type="fig" rid="fig1">Figure 1</xref>). Lower-ranked meta-clonotypes were eliminated from further analysis if all included sequences were completely encompassed by a higher-ranked meta-clonotype; while this reduced redundancy, some overlap remained among meta-clonotypes. We further required that meta-clonotypes be public, including sequences from at least two subjects in the MIRA cohort. We found that 97 of the 252 MIRA sets had sufficiently similar TCRs observed in multiple subjects allowing formation of public meta-clonotypes. From 91,122 TCR β-clonotypes across these 97 MIRA sets – targeting antigens in ORF1ab (<italic>n</italic> = 35), S (<italic>n</italic> = 27), N (<italic>n</italic> = 10), M (<italic>n</italic> = 7), ORF3a (<italic>n</italic> = 7), ORF7a (<italic>n</italic> = 4), E (<italic>n</italic> = 2), ORF8 (<italic>n</italic> = 2), ORF6 (<italic>n</italic> = 1), ORF7b (<italic>n</italic> = 1), and ORF10 (<italic>n</italic> = 1) – we engineered 4548 public meta-clonotypes, which spanned 15 % (13,949/91,122) of the original TCR sequences (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1f</xref>). The proportion of MIRA antigen-associated TCRs spanned by the meta-clonotypes ranged widely from &lt;1% in MIRA25% to 63% in MIRA7, reflecting broad heterogeneity in the diversity of TCRs inferred as activated by each peptide in the assay.</p><p>As an example, the MIRA55 ORF1ab set (TCRs associated with stimulation peptides ALRKVPTDNYITTY or KVPTDNYITTY) included TCR clonotypes from 15 individuals. From the 449 potential centroids, we defined 40 public meta-clonotypes. Among these features, the radii ranged from 10 to 36 tdus (median 22 tdus), and the publicity – the number of unique subjects spanned by the meta-clonotype – ranged from 3 to 12 individuals (median 6). Meta-clonotype summary statistics for other antigen-associated repertoires are provided in Supplemental Materials (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1f</xref>). The result was a set of nonredundant, public meta-clonotypes (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1g</xref>) that could be used to search for and quantify similar putative SARS-CoV-2-specific TCRs in bulk repertoires. In addition to the radius-defined meta-clonotypes (RADIUS), we also developed a modified approach that additionally enforced a sequence motif constraint (RADIUS + MOTIF). The constraint further limited sequence divergence in highly conserved positions of the CDR3, requiring that candidate bulk TCRs match specific amino acids found in the meta-clonotype CDR3s to be counted as part of the neighborhood (see <xref ref-type="fig" rid="fig1">Figure 1</xref> and Methods).</p></sec><sec id="s2-6"><title>Validating meta-clonotypes through confirmation of HLA restriction in COVID-19 patients</title><p>Given the integral role of HLA class I molecules in antigen presentation and TCR repertoire selection (<xref ref-type="bibr" rid="bib8">DeWitt et al., 2018</xref>), we further focused on 17 of the 252 MIRA sets that showed strong evidence of HLA-A or HLA-B restriction based on meeting both criteria: (1) computational prediction of HLA binding to the SARS-CoV-2 stimulation peptides, and (2) enrichment of an HLA among participants contributing to the MIRA TCRs. With each set of the MIRA TCRs and the associated SARS-CoV-2 peptides we used HLA-binding predictions (NetMHCpan4.0) to identify the class I HLA alleles that were predicted to bind with strong (IC50 &lt; 50 nM) or weak (50 nm &lt; IC50 &lt; 500 nM) affinity to any of the 8-, 9-, 10-, or 11-mers derived from the stimulation peptides (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1c and d</xref>). For instance, the peptides associated with MIRA55 TCRs (ORF1ab amino acid positions 1316:1330) are predicted to preferentially bind A*01 (IC50 21 nM), B*15 (IC50 120 nM), and B*35 (IC50 32 nM), and 13 of 13 A*01-positive, and 2 of 34 A*01-negative, patients contributed to the MIRA55 TCR set (Fisher’s exact test, p = 10e<sup>−7</sup>). We found that for 17 of the MIRA sets, the patients contributing TCRs were significantly enriched for at least 1 HLA-A or HLA-B allele (Fisher’s exact test, p &lt; 0.001) (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1e</xref>). Strong HLA restriction in 17 SARS-CoV-2 MIRA-identified TCR sets provided us an opportunity to validate that meta-clonotypes are antigen-specific features. We hypothesized that in an independent cohort of COVID-19 patients, the abundance of TCRs conforming to each meta-clonotype would be greater in patients having the restricting HLA genotype.</p><p>To test this hypothesis, we compared three TCR-based feature sets: (1) radius-defined meta-clonotypes (RADIUS), (2) radius and motif-defined meta-clonotypes (RADIUS + MOTIF), and (3) centroid clonotypes alone, using TRBV-CDR3 amino acid matching (EXACT). Using the features in each set we screened TCRs from the bulk TCR β-chain repertoires of 694 COVID-19 patients whose repertoires were publicly released as part of the immuneRACE datasets (see Methods for details); these patients were not part of the smaller cohort that contributed samples for TCR identification in MIRA experiments. Testing the HLA restriction hypothesis required having the HLA genotype of each individual, which was not provided in the dataset. To overcome this, we inferred each participant’s HLA genotype with a classifier that was based on previously published HLA-associated TCR β-chain sequences (<xref ref-type="bibr" rid="bib8">DeWitt et al., 2018</xref>) and their abundance in each patient’s repertoire (see Methods for details). MIRA TCRs were not used to assign HLA types to the 694 COVID-19 patients. We then used a beta-binomial counts regression model (<xref ref-type="bibr" rid="bib32">Rytlewski et al., 2019</xref>) with each TCR feature to test for an association of feature abundance with the presence of the restricting allele in the participant’s HLA genotype, controlling for participant age, sex, and days since COVID-19 diagnosis. We conducted tests for each meta-clonotype individually, aggregating in each bulk sample the sum of counts of all TCRs conformant with that meta-clonotype’s definition. The models revealed that there were radius-defined meta-clonotypes with a strong positive and statistically significant association (FDR &lt;0.01) for 11 of the 17 HLA-restricted MIRA sets that were evaluated (<xref ref-type="fig" rid="fig8">Figure 8A</xref>; <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1g</xref>); the significant HLA regression odds ratios ranged from 1.4 to 40 (median 4.9), indicating differences in the frequency of meta-clonotype conformant TCRs between patients with and without the HLA genotype. Across all MIRA sets, a positive HLA association (FDR &lt;0.01) was detected for 51.5 % (943/1831) and 59.7 % (1093/1831) of the meta-clonotypes using the RADIUS or RADIUS + MOTIF definitions, respectively. In comparison, an HLA association (FDR &lt;0.01) was detected for fewer than 3.7 % (69/1831) of EXACT centroid features, largely because the specific TRBV gene and CDR3 sequences discovered in the MIRA experiments were infrequently observed in bulk-sequenced samples (<xref ref-type="fig" rid="fig8">Figure 8B</xref>). When detectable, the abundance of centroid TCRs in bulk repertoires tended to be positively associated with expression of the restricting HLA allele, as hypothesized. However, in most cases, the associated FDR-adjusted <italic>q</italic> value of these associations were orders of magnitude larger (i.e., less statistically significant) than those obtained from using the engineered RADIUS or RADIUS + MOTIF feature with the same clonotype as a centroid (<xref ref-type="fig" rid="fig9">Figure 9</xref>). The improved performance of meta-clonotypes as query features is particularly evident when testing for HLA-associated enrichment of TCRs recognizing MIRA1 A*01, MIRA48 A*02, MIRA51 A*03, MIRA53 A*24, and MIRA55 A*01 (<xref ref-type="fig" rid="fig9">Figure 9B</xref>). Moreover, the regression models with meta-clonotypes also revealed possible negative associations between TCR abundance and participant age and positive associations with sample collection more than 2 days post-COVID-19 diagnosis (<xref ref-type="fig" rid="fig9">Figure 9A</xref>).</p><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>HLA restriction of T-cell receptor (TCR) clonotypes and meta-clonotypes in bulk-sequenced TCRβ repertoires of COVID-19 patients.</title><p>(<bold>A</bold>) Percentage of TCR features with a statistically significant (false discovery rate [FDR] &lt;0.01) association with a restricting HLA allele. We tested for associations between patients’ inferred genotype and TCR feature abundance using beta-binomial regression controlling for age, sex, and days since COVID-19 diagnosis. (<bold>B</bold>) For each clonotype/meta-clonotype, the percent of bulk repertoires from COVID-19 patients (<italic>n</italic> = 694) containing TCRs meeting the criteria defined by (1) EXACT (TCRs matching the centroid TRBV gene and amino acid sequence of the complementarity determining region [CDR]3), (2) RADIUS (TCR centroid with inclusion criteria defined by an optimized TCRdist radius), or (3) RADIUS + MOTIF (inclusion criteria defined by TCR centroid, optimized radius, and the CDR3 motif constraint). See <xref ref-type="fig" rid="fig1">Figure 1</xref> and Methods for details. Meta-clonotype radii were engineered using synthesized backgrounds developed for each MIRA set. Each background contained 100,000 Optimized Likelihood estimate of Immunoglobulin Amino acid sequences (OLGA)-generated TCRs and 100,000 TCRs subsampled from umbilical cord blood; OLGA-generated TCRs were sampled to match to the V–J gene frequency in each MIRA receptor set (i.e., MIRA1, 10, 30, 44, 45, 48, 51, 53, 55, 70, 99, 110, 111,118, 133, 140, or 183) with weighting to account for the sampling bias (see Methods for details).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68605-fig8-v1.tif"/></fig><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>Associations of T-cell receptor (TCR) features with participant age, days postdiagnosis, HLA genotype, and sex in TCR β-chain repertoires of COVID-19 patients (<italic>n</italic> = 694).</title><p>(<bold>A</bold>) Beta-binomial regression coefficient estimates (<italic>x</italic>-axis) and negative log<sub>10</sub> false discovery rates (<italic>y</italic>-axis) for features developed from CD8+ TCRs activated by SARS-CoV-2 MIRA55 ORF1ab amino acids 1636:1647, HTTDPSFLGRY. The abundances of meta-clonotype conformant TCRs are more robustly associated with predicted HLA type than for exact clonotypes. (<bold>B</bold>) Signal strength indicating a positive association between the HLA genotype (two-digit) with TCR β-chain clonotypes (EXACT) and meta-clonotype conformant TCRs (RADIUS or RADIUS + MOTIF), where the restricting HLA genotype was inferred from independent data: (i) MIRA48, (ii) MIRA51, (iii) MIRA53, (iv) MIRA55, (v) MIRA110, and (vi) MIRA111 (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1f</xref>). Each set of three symbols connected by a line represents an evaluation TCRs conformant to an individual clonotype or a meta-clonotype. Models were estimated with counts of productive TCRs matching a clonotype (EXACT) or conforming to a meta-clonotype (RADIUS or RADIUS + MOTIF) with the following definitions: (1) EXACT (inclusion of TCRs matching the centroid TRBV gene and amino acid sequence of the complementarity determining region [CDR]3), (2) RADIUS (inclusion criteria defined by a TCR centroid and optimized TCRdist radius), and (3) RADIUS + MOTIF (inclusion criteria defined by TCR centroid, optimized radius, and CDR3 motif constraint). See Methods for details. Meta-clonotype radii were engineered using synthesized backgrounds developed for each MIRA set. Each background contained 100,000 Optimized Likelihood estimate of Immunoglobulin Amino acid sequences (OLGA)-generated TCRs and 100,000 TCRs subsampled from umbilical cord blood; OLGA-generated TCRs were sampled to match to the V–J gene frequency in each MIRA receptor set (i.e., MIRA1, 48, 51, 53, 55, 110, or 111) with weighting to account for the sampling bias (see Methods for details).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68605-fig9-v1.tif"/></fig></sec><sec id="s2-7"><title>Meta-clonotypes provide opportunities to better understand antigen specificity</title><p>Since meta-clonotypes cluster similar antigen-annotated TCRs and allow further clustering of similar TCRs from bulk repertoires, they provide an opportunity to visualize and refine hypotheses about the characteristics of TCRs that confer antigen specificity. After observing that in many instances, the strength of evidence of HLA-restriction in bulk repertoires was greater for RADIUS + MOTIF versus RADIUS meta-clonotypes, we sought to directly inspect the differences between MOTIF-conformant and non-MOTIF-conformant TCRs and utilize one meta-clonotype as an illustrative example. The MIRA55 meta-clonotype based on the centroid TRBV28*01 + TRBJ27*01 + CASSLKTDAYEQFY provided substantially stronger evidence of HLA association in bulk samples when applied as a RADIUS + MOTIF (radius = 20 tdus, motif = SL[RK][ST][ND].YEQ; FDR-<italic>q</italic> = 2.4e<sup>−10</sup>) versus as a RADIUS (radius = 20 tdus; FDR-<italic>q</italic> = 1.4e<sup>−5</sup>) or an individual TCR (i.e., EXACT comparator, FDR-<italic>q</italic> = 1.0).</p><p>To identify critical residues, we constructed a logo plot of all TCR CDR3 amino acid sequences from the COVID-19 patient repertoires that were within the optimal radius (20 tdus) and conformed to the motif constraint (SL[RK][ST][ND].YEQ) together with a ‘background-adjusted’ logo plot. The background-adjusted plot shows the position-specific Kullback–Leibler divergence from an alignment of background CDR3s that were sampled from cord blood and constrained to use the same V and J genes; it emphasizes the uncommon amino acid residues in the meta-clonotype, reducing the size in particular of residues encoded by the germline V and J genes (<xref ref-type="fig" rid="fig10">Figure 10A</xref>). Inspection of the logo plots shows that five positions in the CDR3 often contain the amino acids ‘LRTDS’, which are not commonly found in CDR3s using TRBV28*01 and TRBJ2-7*01. Next, we constructed a second background-adjusted logo from the CDR3s that were within the meta-clonotype radius, but did not conform to the meta-clonotype motif (i.e., RADIUS-ONLY TCRs) (<xref ref-type="fig" rid="fig10">Figure 10B</xref>). These TCRs are important to characterize because they represented the TCRs that decrease the strength of the meta-clonotype’s HLA association and therefore may be more likely to contain nonspecific receptors. RADIUS-ONLY CDR3s tended to differ from the MOTIF conformant sequences at logo positions 6 and 8. The interchangeability of basic amino acids R and K at position 6, which is accommodated by the meta-clonotype MOTIF, was supported by the appearance of both ‘LRTDS’ and ‘LKTDS’ in the COVID-19 patient repertoires. However, RADIUS-ONLY TCRs, which may be less likely to recognize the target epitope, frequently differed at position 6, where a G residue or a deletion was present. At position 8, the MOTIF tolerated N or D, as both residues were observed in the aligned MIRA-derived TCRs used to form the meta-clonotype. However, in bulk samples no sequences with N at position eight were detected within 20 tdus of this centroid. An E or a deletion in position eight was common in RADIUS-ONLY neighbors. At position 9, the MOTIF tolerated any amino acid, as there was substantial variability there among the MIRA-derived TCRs, however an S was common in motif-conformant TCRs and A was exclusively found among RADIUS-ONLY TCRs. Together, these analyses, made possible by meta-clonotypes and <italic>tcrdist3</italic>, generate hypotheses about the positions and amino acid residues that are important for antigen specificity.</p><fig id="fig10" position="float"><label>Figure 10.</label><caption><title>Meta-clonotypes provide opportunities to investigate basis of antigen specificity.</title><p>Logo plots of T-cell receptors (TCRs) from bulk repertoires of acute and convalescent COVID-19 patients (<italic>n</italic> = 694) within 20 TCRdist units of MIRA-identified TCR β-chain meta-clonotype M_55_1E6+ TRBV28*01+ CASSLKTDAYEQYF + 20+(SL[RK][ST][ND].YEQ) centroid. (<bold>A</bold>) Logo plot of TCRs with complementarity determining region (CDR)3 conforming to motif-constraint (SL[RK][ST][ND].YEQ), and (<bold>B</bold>) logo plot of TCRs with CDR3 that do not conform to the motif constraint. The MIRA55 antigen-associated TCR set used to learn the motif included 21 antigen-associated TCRs from 10 subjects. In both panels (<bold>A</bold>) and (<bold>B</bold>), the upper logo motif depicts a ‘background-adjusted’ logo plot showing the position-specific Kullback–Leibler divergence from an alignment of background CDR3s that were sampled from cord blood TCRs using the same TRBV and TRBJ genes. Lower logo motifs show position-specific amino acid usage. To accommodate CDR3s of different length in the logo plot we aligned each CDR3 to the centroid. The background-adjusted logos are constructed by randomly sampling TCR beta receptors from cord blood with the same TRBV- and TRBJ-gene usage, with 100 V–J-matched TCRs sampled for every receptor in the foreground set.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68605-fig10-v1.tif"/></fig></sec><sec id="s2-8"><title>Comparison to k-mer-based CDR3 features</title><p>Alternative methods exist for generating public TCR features from clustered clonotypes. One strategy is to identify clusters of TCRs that are each uniquely enriched with a short CDR3 k-mer, as implemented in GLIPH2 <xref ref-type="bibr" rid="bib14">Huang et al., 2020</xref>; this approach is well suited for identifying CDR3 k-mers associated with antigenic selection across bulk repertoires when knowledge of the specific antigens is unavailable (<xref ref-type="bibr" rid="bib4">Chiou et al., 2021</xref>). Here, we evaluate the similarities and differences of GLIPH2 and distance-based meta-clonotypes for generating public TCR features from antigen-associated TCRs, by applying both methods to the HLA-restricted MIRA sets (see Methods for details). Both methods identified public molecular patterns from MIRA TCRs (<xref ref-type="fig" rid="fig11">Figure 11</xref>) that were strongly HLA associated in the large independent cohort of COVID-19 diagnosed patients (<xref ref-type="fig" rid="fig12">Figure 12</xref>). For this nonstandard application of GLIPH2, we found that specificity groups based on global CDR3 k-mers (e.g., ‘SFRTD.YE’) tended to be more consistently HLA associated than specificity groups based on shorter local k-mers (e.g., ‘FRTD’). Compared to the GLIPH2 specificity groups based on global CDR3 kmers, meta-clonotypes tended to show similar or more evidence of HLA association (i.e., smaller FDR-<italic>q</italic> values) (<xref ref-type="fig" rid="fig12">Figure 12</xref>). MIRA55:ORF1ab is an illustrative example; both the <italic>tcrdist3</italic> meta-clonotypes and GLIPH2-identified TCR groups were more strongly associated with the predicted A*01 HLA restriction than exact clonotypes, supporting the general applicability of using antigen-associated TCRs to create public features from otherwise private antigen-recognizing TCRs. Inspection of the meta-clonotypes and GLIPH2 groups showed that they were often overlapping, with meta-clonotypes subsuming multiple GLIPH2 groups. For example, the A*01-associated meta-clonotype motif S.G[QE]G[AS]F[ST]DTQ (p value 1E−12) fully overlaps several A*01-associated GLIPH2 patterns including S.GQGAFTDT (p value 1E−12), QGAF (p value 1E-11), and SLG.GAFTDT (p value 1E−6). Similarly, the A*01-associated meta-clonotype motif S[RLMF][RK][ST][ND].YEQ (p value 1E−13) covers 21 global GLIPH motifs including SFRTD.YE (p value 1E−10), SLRTD.YE (p value 1E−7), and SF.TDSYE (p value 1E−4) (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1i</xref>). These observations suggest that the motif constraints of the meta-clonotypes were able to match a broader set of antigen-specific CDR3s compared to any one GLIPH2 specificity pattern, which may have helped boost detection sensitivity in the COVID-19 repertoires.</p><fig id="fig11" position="float"><label>Figure 11.</label><caption><title>Publicity and breadth analysis of CD8+ T-cell receptor (TCR) β-chain features activated by SARS-CoV-2 peptide ORF1ab (MIRA55) using <italic>tcrdist3</italic> and GLIPH2.</title><p>TCR feature publicity was determined using two methods for clustering similar TCR sequences: (<bold>A</bold>) <italic>tcrdist3</italic>-identified meta-clonotypes and (<bold>B</bold>) GLIPH2 specificity groups, sets of TCRs with a shared complementarity determining region (CDR)3 k-mer pattern uncommon in the program’s default background CD8+ receptor data. Grid fill color shows the breadth – or number of conformant clones – within the MIRA-identified clones from each patient.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68605-fig11-v1.tif"/></fig><fig id="fig12" position="float"><label>Figure 12.</label><caption><title>Associations between HLA genotypes in COVID-19 patients and abundance of epitope-specific complementarity determining region (CDR)3 k-mers or meta-clonotypes.</title><p>(<bold>A</bold>) Beta-binomial regression coefficient estimates (<italic>x</italic>-axis) for participant genotype matching a hypothesized restricting HLA allele and negative log<sub>10</sub> false discovery rates (FDRs; <italic>y</italic>-axis) for features developed from CD8+ T-cell receptors (TCRs) activated by one of 17 HLA-restricted SARS-CoV-2 epitopes found in ORF1ab, ORF3a, nucleocapsid (N), and surface glycoprotein (S). MIRA183 yielded no significant meta-clonotypes (results not shown). Regression models included age, sex, and days postdiagnosis as covariates (not shown). Positive HLA coefficient estimates correspond with greater abundance of the TCR feature in those patients expressing the restricting allele. (<bold>B</bold>) Distribution of FDRs by feature identification method (k-mer local, k-mer global, or meta-clonotype [RADIUS + MOTIF]). Larger negative log<sub>10</sub>-tranformed FDR values (<italic>y</italic>-axis) indicate more statistically significant associations. Local k-mer (e.g., FRTD) and global k-mer (e.g., SFRTD.YE) were identified using GLIPH2 (<xref ref-type="bibr" rid="bib14">Huang et al., 2020</xref>) and were used to quantify counts of conforming TCRs in each bulk-sequenced COVID-19 repertoire (see Method for details).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68605-fig12-v1.tif"/></fig></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Given the extent of TCR diversity, only antigen-associated TCRs with high probability of generation (p<sub>gen</sub>) are likely to be detected reliably across individuals (<xref ref-type="fig" rid="fig13">Figure 13</xref>). While public, high-p<sub>gen</sub> TCRs may sometimes be available for detecting a prior antigen exposure, to better understand the population-level dynamics of complex polyclonal T-cell responses across a gradient of generation probabilities, it is critical to develop methods for finding public meta-clonotypes that capture otherwise private TCRs (<xref ref-type="fig" rid="fig13">Figure 13</xref>). We developed a novel framework, leveraging antigen-associated TCRs and efficiently sampled background repertoires, to engineer meta-clonotypes that balance the need for sufficiently public features with the need to maintain antigen specificity. The output of the analysis framework (<xref ref-type="fig" rid="fig1">Figure 1</xref>) is a set of portable meta-clonotypes, each defined by a (1) centroid, (2) radius, and (3) a CDR3 motif pattern, that can be used to rapidly search bulk repertoires for similar TCRs that likely share a cognate antigen. To demonstrate this analytical framework, we analyzed publicly available sets of antigen-associated TCR β-chain sequences that putatively recognize SARS-CoV-2 peptides (<xref ref-type="bibr" rid="bib27">Nolan et al., 2020</xref>). From these, we generated 4548 TCR radius-defined public meta-clonotypes that can be used to further investigate CD8+ T-cell response to SARS-CoV-2 (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1G and H</xref>).</p><fig id="fig13" position="float"><label>Figure 13.</label><caption><title>Detectable HLA association and complementarity determining region (CDR)3 probability of generation.</title><p>We evaluated 1831 meta-clonotypes from 17 MIRA sets in a cohort of 694 COVID-19 patients for their association with predicted HLA-restricting alleles. Statistical evidence of the HLA association for each meta-clonotype (RADIUS or RADIUS + MOTIF) and the centroid alone (EXACT) is indicated by the associated false discovery rate (FDR; <italic>y</italic>-axis) in beta-binomial regressions (see Methods for model details). The probability of generation (p<sub>gen</sub>) of each centroid’s CDR3-β was estimated using the software OLGA (<italic>x</italic>-axis). Using exact matching, only associations with high probability of generation (p<sub>gen</sub>) antigen-specific T-cell receptors (TCRs) are likely to be detected reliably. However, using meta-clonotypes, <italic>tcrdist3</italic> revealed strong evidence of HLA-restriction for TCRs with both high and low probability of generation. Meta-clonotype radii were engineered using synthesized backgrounds developed for each MIRA set. Each background contained 100,000 Optimized Likelihood estimate of Immunoglobulin Amino acid sequences (OLGA)-generated TCRs and 100,000 TCRs subsampled from umbilical cord blood; OLGA-generated TCRs were sampled to match to the V–J gene frequency in each MIRA receptor set with weighting to account for the sampling bias (see Methods for details).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-68605-fig13-v1.tif"/></fig><p>To evaluate the properties of radius-defined meta-clonotypes we utilized the immuneRACE dataset and focused on the SARS-CoV-2 epitopes with the strongest evidence of HLA restriction (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1g</xref><italic>, n</italic> = 1831 associated meta-clonotypes). We reasoned that we could compare the abundance of meta-clonotypes in COVID-19 patients with and without the restricting HLA genotype, and that a significant positive association of abundance with the restricting genotype would provide confirmatory evidence of the meta-clonotype’s SARS-CoV-2 antigen specificity in addition to its HLA restriction. Overall, we found significant confirmatory evidence of the HLA restriction of meta-clonotype abundance for a majority of the MIRA sets we analyzed (11/17, 64%) and for a majority (1080/1831, 59%) of the individual meta-clonotypes tested using the RADIUS + MOTIF approach; importantly, there were no meta-clonotypes significantly associated with the absence of expression of the restricting HLA allele. There are several plausible explanations for the remaining meta-clonotypes that did not have a significant signal of HLA restriction in this study. One possibility is that meta-clonotype definitions were not sufficiently specific for the target antigen; the radius is optimized for specificity, but not all amino acid substitutions accommodated within the radius are guaranteed to preserve antigen recognition, and while the motif constraint increases specificity, it is likely that meta-clonotype definitions could be further refined with more antigen-associated TCR data and enhanced motif refinement methods. Also, subdominant SARS-CoV-2 epitopes may not be ubiquitously presented, even among participants that share the required HLA genotype, which weakens the signal of HLA restriction detectable by regression analysis.</p><p>The meta-clonotype framework we present joins a class of commonly used methods for TCR analysis that depend on comparisons to an antigen-naive background repertoire. For example, GLIPH2 attempts to find CDR3 <italic>k</italic>-mers that are significantly more frequent in the data compared to a naive background and TCRNET organizes repertoires into networks to identify nodes with an enriched number of edges compared to the number of edges formed within a background repertoire. An important distinction is that the meta-clonotype framework is designed to leverage data that has been experimentally pre-enriched with antigen-specific TCRs. In contrast, GLIPH2 and TCRNET have been designed to identify clusters of similar TCRs in a bulk repertoire and calibrated to find statistically significant enrichment of each cluster in the bulk repertoire compared to a background. This distinction is important because among a set of TCRs enriched for antigen specificity, it is possible that many CDR3 signatures (or network nodes) might be statistically enriched compared to a background, yet they may still be abundant in the background and lack sufficient specificity for subsequent analyses of bulk repertoires. We saw evidence of this in our comparison with GLIPH2; while many ‘global’ GLIPH2 groups performed similar to meta-clonotypes, the short ‘local’ groups identified by the algorithm were often too short to be specific, and they were generally not as strongly associated with the restricting HLA in our analysis. The meta-clonotype approach is distinct because it estimates an optimal radius to control the probability of finding conformant TCRs in a naive background at a prespecified level (i.e., 1 in 1 million). This probability is further reduced by the CDR3 motif constraint, which requires that conformant TCRs match at least one of the residues in the antigen-associated sequences at critical conserved positions; other methods developed primarily for identifying TCRs under antigenic selection from bulk repertoire data do not leverage this information. Finding a radius to control the frequency of meta-clonotype conformant TCRs in the background was also made more efficient by a background sampling algorithm that focused on TCRs with matching V and J genes with weighting to account for the sampling bias. Ultimately, it is the focus on controlling the absolute frequency of meta-clonotype conformant TCRs in an antigen-naive background that gives the meta-clonotype definitions portability to be applied to analyses of bulk repertoires, where quantification of similar antigen-specific TCRs is required.</p><p>Recently, <xref ref-type="bibr" rid="bib36">Snyder et al., 2020</xref> analyzed 1521 bulk TCR β-chain repertoires from COVID-19 patients in the immuneRACE dataset and an additional 3500 (not yet publicly available) repertoires from healthy controls to identify public TCR β-chains that could be used to identify SARS-COV-2 infected individuals with high sensitivity and specificity. Their results show that with sufficient data it is possible to engineer performant TCR biomarkers of antigen exposure from exact clonotypes. We show that by leveraging antigen-associated TCR repertoires it is possible to engineer meta-clonotypes from a relatively small group of COVID-19 diagnosed individuals (<italic>n</italic> = 62; HLA-typed <italic>n</italic> = 47), with TCRs conformant to these meta-clonotypes frequently detectable in a larger independent cohort. We propose that meta-clonotypes constitute a set of potential features that could be leveraged in developing TCR-based clinical biomarkers that go beyond detection of infection or exposure. For example, biomarkers predictive of infection, disease severity, or vaccine protection may each require different TCR features. We note that meta-clonotypes are often overlapping in that a single TCR may be conformant with the definition of multiple meta-clonotypes, which should be a consideration when applying a set of meta-clonotypes together. For instance, tallying conformant TCRs in a repertoire should avoid counting a TCR more than once, while in a biomarker context many statistical and machine learning algorithms may benefit from a set of partially redundant features to amplify the clinically relevant signals. We also note that it may be more immunologically relevant to quantitate the frequency of <italic>unique</italic> clonotypes conforming to a meta-clonotype in each repertoire (i.e., clonal breadth) in addition to the overall frequency; it is plausible both may carry important signals. Much like any biomarker study, to establish a TCR-based predictor of a particular outcome, the features must be measured among a sufficiently large cohort of individuals, with a sufficient mix of outcomes; meta-clonotypes offer a way to build public features that are suitable for this process.</p><p>Though demonstrating HLA restriction of the SARS-CoV-2 meta-clonotypes establishes their potential utility, it also highlighted how HLA diversity could be a major hurdle to biomarker development. The sensitivity of a TCR-based biomarker in a diverse population may depend on combining meta-clonotypes with diverse HLA restrictions since individuals with different HLA genotypes often target different epitopes using divergent TCRs. Our analysis shows that having HLA genotype information for TCR repertoire analysis can be critical to interpreting results. The simple HLA classifier we developed suggests that soon it may be possible to infer high-resolution HLA genotype from bulk TCR repertoires, but until then it is valuable to have sequenced-based HLA genotyping. In the absence of HLA genotype information, it may still be feasible to generate informative TCR meta-clonotypes. For example, a poly-antigenic TCR-enrichment strategy (i.e., peptide pools or whole proteins) could help generate meta-clonotypes that broadly cover HLA diversity if the sample donors are racially, ethnically, and geographically representative of the ultimate target population. For these reasons, donor unrestricted T cells and their receptors (e.g., MAITs and γδ T cells) may also be good targets for TCR biomarker development.</p><p>To enable TCR biomarker development and innovative extensions of distance-based immune repertoire analysis, we developed <italic>tcrdist3</italic>, which provides open-source (<ext-link ext-link-type="uri" xlink:href="https://github.com/kmayerb/tcrdist3">https://github.com/kmayerb/tcrdist3</ext-link>), documented (<ext-link ext-link-type="uri" xlink:href="https://tcrdist3.readthedocs.io">https://tcrdist3.readthedocs.io</ext-link>) computational building blocks for a wide array of TCR repertoire workflows in Python3. The software is highly flexible, allowing for: (1) customization of the distance metric with position and CDR-specific weights and amino acid substitution matrices, (2) inclusion of CDRs beyond the CDR3, (3) clustering based on single-chain or paired-chain data for α/β or γ/δ TCRs, and (4) use of default as well as user-provided TCR repertoires as background for controlling meta-clonotype specificity (e.g., users may want to use HLA genotype-matched, or age-matched backgrounds). <italic>tcrdist3</italic> makes efficient use of available CPU and memory resources; as a reference, identification of meta-clonotypes from the MIRA55:ORF1ab dataset (<italic>n</italic> = 479 TCRs) was completed in less than 5 min using 2 CPUs and &lt;4 GB of memory including distance computation and radius optimization. Quantification of the identified meta-clonotypes (<italic>n</italic> = 40) conformant TCRs in 694 bulk β-chain repertoires, ranging in size from 10,395 to 1,038,012 in-frame clones (~5 billion total pairwise comparisons) could be completed in less than 2 hr using 2 CPUs and &lt;6 GB memory. The package also can generate multiple types of publication-ready figures (e.g., background-adjusted CDR3 sequence logos, paired TRAV–TRAJ/TRBV–TRBJ-gene usage chord diagrams, and annotated TCR dendrograms). The continued maturation of multiple adaptive immune receptor repertoire sequencing technologies will open possibilities for basic immunology and clinical applications, and <italic>tcrdist3</italic> provides a flexible tool that researchers can use to integrate the data sources needed to detect and quantify antigen-specific TCR features.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Reagent type (species) or resource</th><th align="left" valign="bottom">Designation</th><th align="left" valign="bottom">Source or reference</th><th align="left" valign="bottom">Identifiers</th><th align="left" valign="bottom">Additional information</th></tr></thead><tbody><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">Python3,Numpy,Pandas,</td><td align="left" valign="bottom"/><td align="left" valign="bottom">Python Programming Language, RRID:<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/RRID/RRID:SCR_008394">SCR_008394</ext-link>NumPy, RRID:<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/RRID/RRID:SCR_00863">SCR_00863</ext-link>Pandas, RRID:<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/RRID/RRID:SCR_01821">SCR_01821</ext-link></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">R, ggplot2</td><td align="left" valign="bottom"/><td align="left" valign="bottom">R Project for Statistical Computing, RRID:<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/RRID/RRID:SCR_001905">SCR_001905</ext-link>ggplot2, RRID:<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/RRID/RRID:SCR_014601">SCR_014601</ext-link></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">tcrdist3</td><td align="left" valign="bottom">This study</td><td align="left" valign="bottom">tcrdist3 0.2.0</td><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://github.com/kmayerb/tcrdist3">https://github.com/kmayerb/tcrdist3</ext-link></td></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">pwseqdist</td><td align="left" valign="bottom">This study</td><td align="left" valign="bottom">pwseqdist 0.5</td><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://github.com/agartland/pwseqdist">https://github.com/agartland/pwseqdist</ext-link></td></tr><tr><td align="left" valign="bottom">Script, algorithm</td><td align="left" valign="bottom">hla3</td><td align="left" valign="bottom">This study</td><td align="left" valign="bottom">version 0.1.0</td><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://github.com/kmayerb/hla3">https://github.com/kmayerb/hla3</ext-link></td></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">corncob</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib21">Martin et al., 2020</xref> doi:<ext-link ext-link-type="uri" xlink:href="https://doi.org.10.1214/19-aoas1283">10.1214/19-aoas1283</ext-link></td><td align="left" valign="bottom"/><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://github.com/bryandmartin/corncob">https://github.com/bryandmartin/corncob</ext-link> (<xref ref-type="bibr" rid="bib22">Martin, 2021</xref>)</td></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">OLGA</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib33">Sethna et al., 2019</xref><ext-link ext-link-type="uri" xlink:href="https://doi.org.10.1093/bioinformatics/btz035">10.1093/bioinformatics/btz035</ext-link></td><td align="left" valign="bottom"/><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://github.com/statbiophys/OLGA">https://github.com/statbiophys/OLGA</ext-link>(<xref ref-type="bibr" rid="bib15">Isacchini, 2021</xref>) See slight modifications in: <ext-link ext-link-type="uri" xlink:href="https://github.com/kmayerb/tcrdist3/blob/master/tcrdist/olga_directed.py">https://github.com/kmayerb/tcrdist3/blob/master/tcrdist/olga_directed.py</ext-link></td></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">GLIPH2</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib14">Huang et al., 2020</xref><ext-link ext-link-type="uri" xlink:href="https://doi.org.10.1038/s41587-020-0505-4">10.1038/s41587-020-0505-4</ext-link></td><td align="left" valign="bottom">version 2</td><td align="left" valign="bottom">http://50.255.35.37:8,080</td></tr></tbody></table></table-wrap><sec id="s4-1"><title>TCR data: immuneRACE datasets and MIRA assay</title><p>The study utilized two primary sources of TCR data (<xref ref-type="bibr" rid="bib27">Nolan et al., 2020</xref>; <xref ref-type="bibr" rid="bib36">Snyder et al., 2020</xref>). The first data source was a table of TCR β-chains amplified from CD8+ T cells activated after exposure to a pool of SARS-CoV-2 peptides, using a Multiplex Identification of Receptor Antigen (MIRA) (<xref ref-type="bibr" rid="bib18">Klinger et al., 2015</xref>); data were accessed July 21, 2020 and labeled ‘ImmuneCODE-MIRA-Release002’. The samples used for the MIRA analysis included samples from 62 individuals diagnosed (3 acute, 1 nonacute, 58 convalescent) with COVID-19, of whom 47 (3 acute, 44 convalescent) were HLA genotyped in the ImmuneCODE-MIRA-Release002 <italic>subject-metadata.csv</italic> file. When assessing the frequency of neighboring TCRs in antigen-associated MIRA sets, we also used TCRs evaluated by MIRA from 26 COVID-19-negative control subjects activate by SARS-CoV-2 peptides that were part of ImmuneCODE-MIRA-Release002. We analyzed the 253 MIRA sets with at least six unique TCRs contributed by ≥2 people, referred to as MIRA0-MIRA252 in rank order by their size (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1b</xref>); each ‘MIRA set’ included antigen-associated TCRs across all assayed individuals. Adaptive Biotechnologies also made publicly available bulk-sequenced TCR β-chain repertoires from COVID-19 patients participating in a collaborative immuneRACE network of international clinical trials. We analyzed repertoires from 694 individuals where meta-data were available indicating that the sample was collected from 0 to 30 days from the time of diagnosis. COVID-19-DLS (Alabama, USA, <italic>n</italic> = 374); COVID-19-HUniv12Oct (Madrid, Spain, <italic>n</italic> = 117); COVID-19-NIH/NIAID (Pavia, Italy, <italic>n</italic> = 125)+ COVID-19-ISB (Washington, USA, <italic>n</italic> = 78). The sampling depth of these repertoires varied from 15,626 to 1,220,991 productive templates (median 208,709) and 10,395–1,038,012 productive rearrangements (median 113,716). We did not use bulk samples from the COVID-19-ADAPTIVE dataset as the average age was substantially lower than other immuneRACE populations and to avoid possible overlap with individuals that contributed samples to the MIRA experiments.</p></sec><sec id="s4-2"><title>HLA genotype inferences</title><p>No publicly available HLA genotyping was available for the 694 bulk-sequenced immuneRACE T-cell repertoires (<xref ref-type="bibr" rid="bib27">Nolan et al., 2020</xref>). Before considering SARS-CoV-2-specific features, we inferred the HLA genotypes of these participants based on their TCR repertoires. Predictions were based on previously published HLA-associated TCR β-chain sequences (<xref ref-type="bibr" rid="bib8">DeWitt et al., 2018</xref>) and their detection in each repertoire. Briefly, a weight-of-evidence classifier for each HLA loci was computed as follows: For each sample and for each common allele, the number of detected HLA-diagnostic TCR β-chains was divided by the total possible number of HLA-diagnostic TCR β-chains. The weights were normalized as a probability vector and the two highest HLA-allele probabilities (if the probability was larger than 0.1) were assigned to each repertoire; homozygosity was inferred if only one allele had probability &gt;0.1. The sensitivity and specificity of this simple classifier for each allele prediction were assessed using 550 HLA-typed bulk repertoires (<xref ref-type="bibr" rid="bib10">Emerson et al., 2017</xref>). Sensitivities for common alleles A*01:01, A*02:01, A*03:01, A*24:02, A*11:01, B*07:02, B*44:02, B*15:01, B*35:01, B*40:01, and B*57:01 were between 0.85 and 1. Specificities for these major HLA-A and HLA-B alleles were between 0.97 and 1.0. Inference of the HLA genotype of most participants was deemed sufficient in the absence of direct HLA genotyping. This weight-of-evidence predictor is implemented as an open-source python script (<ext-link ext-link-type="uri" xlink:href="https://github.com/kmayerb/hla3">https://github.com/kmayerb/hla3</ext-link>, copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:9a9cf65125b450c5b8b7082cd71912c51db363b2;origin=https://github.com/kmayerb/hla3;visit=swh:1:snp:141220cefe7c28fe33b2bbec8d0047fb1fdb873f;anchor=swh:1:rev:daaa03b89883629e53974c8e5cab2563971acfa0">swh:1:rev:daaa03b89883629e53974c8e5cab2563971acfa0</ext-link>, <xref ref-type="bibr" rid="bib23">Mayer-Blackwell, 2021a</xref>).</p></sec><sec id="s4-3"><title>Peptide–HLA-binding prediction</title><p>HLA-binding affinities of peptides used in the MIRA stimulation assay were computationally predicted using NetMHCpan4.0 (<xref ref-type="bibr" rid="bib16">Jurtz et al., 2017</xref>). Specifically, the affinities of all 8-, 9-, 10-, and 11-mer peptides derived from the stimulation peptides were computed with each of the class I HLA alleles expressed by participants in the MIRA cohort (<italic>n</italic> = 47). From these data, we derived two-digit HLA-binding predictions (e.g., A*02) for each MIRA set by pooling the predictions for all the four-digit HLA variants (e.g., A*02:01, A*02:02) across all the derivative peptides and selecting the lowest IC50 (strongest affinity). Predictions with IC50 &lt;50 nM were considered strong binders and IC50 &lt;500 nM were considered weak binders (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1c and d</xref>).</p></sec><sec id="s4-4"><title>TCR distances</title><p>Weighted multi-CDR distances between TCRs were computed using <italic>tcrdist3</italic>, an open-source Python3 package for TCR repertoire analysis and visualization, using the procedure first described in <xref ref-type="bibr" rid="bib7">Dash et al., 2017</xref>. The package has been expanded to accommodate γδ TCRs; it has also been recoded to increase CPU efficiency using <italic>numba</italic>, a high-performance just-in-time compiler. A numba-coded edit/Levenshtein distance is also included for comparison.</p><p>Briefly, the distance metric in this study is based on comparing TCR β-chain sequences. The <italic>tcrdist3</italic> default settings compare TCRs at the CDR1, CDR2, and CDR2.5 and CDR3 positions. By default, IMGT aligned CDR1, CDR2, and CDR2.5 amino acids are inferred from TRVB gene names, using the *01 allele sequences when allele-level information is not available. The CDR3 junction sequences are trimmed three amino acids on the N-terminal side and two amino acids on the C-terminus, positions that are highly conserved and less crucial for mediation of antigen recognition. For two CDR3s with different lengths, a set of consecutive gaps are inserted at a position in the shorter sequence that minimizes the summed substitution penalties based on a BLOSUM62 substitution matrix. Insertions are penalized as nonconservative amino acid substitutions. Distances are then the weighted sum of substitution penalties across all CDRs, with the CDR3 penalty weighted three times that of the other CDRs.</p></sec><sec id="s4-5"><title>Synthetic TCR backgrounds</title><p>To estimate optimal radii at which background TCRs are expected to be detected at a frequency of &lt;10<sup>−6</sup>, for each antigen-associated MIRA set, we constructed synthetic backgrounds that combine efficient sampling of OLGA-generated TCR sequences V–J matched to the MIRA set with randomly sampled antigen-naive TCRs from eight cord blood donors (<xref ref-type="bibr" rid="bib2">Britanova et al., 2016</xref>). A slightly modified version of OLGA (Optimized Likelihood estimate of Immunoglobulin Amino acid sequences) from <xref ref-type="bibr" rid="bib33">Sethna et al., 2019</xref> was used to efficiently generate V–J gene-matched CDRs based on a previously trained statistical model of VDJ recombination (<xref ref-type="bibr" rid="bib20">Marcou et al., 2018</xref>). Prevalence weights were assigned to the OLGA sequences to correct for the oversampling of specific V–J gene pairings in the synthetic background. The expected prevalence of TCRs using a given V–J gene pairing was inferred from natural frequencies observed in the cord blood data. The slightly modified version of OLGA source code used to generate synthetic TCRs directed by selected V and J genes is contained within the <italic>tcrdist3</italic> source code.</p></sec><sec id="s4-6"><title>TCR meta-clonotype MOTIF constraint</title><p>Radius-optimized meta-clonotypes from antigen-associated TCRs provided an opportunity to discover key conserved residues most likely mediating antigen specificity. We developed a ‘motif’ constraint as an optional part of each meta-clonotype definition that limited allowable amino acid substitutions in highly conserved positions of the CDR3 to those observed in the antigen-associated TCRs. The motif constraint for each radius-defined meta-clonotype was defined by aligning each of the conformant CDR3 amino acid sequences to the centroid CDR3. Alignment positions with five or fewer distinct amino acids were considered conserved and added to the motif as a set of possible residues. Thus, the motif constraint is permissive of only specific substitutions in select positions relative to the centroid, however these substitutions are still penalized by the radius constraint. The motif constraint was encoded as a regular expression, with the ‘.’ character indicating nonconserved positions and bracketed residues indicating a degenerate position with a set of allowable residues (e.g., ‘SL[RK][ND]YEQ’). Position with gaps, where some sequences are missing a residue, are accommodated by making that position optional (e.g., ‘SL[RK]?[ND]YEQ’). Since the motif constraints form regular expressions, they can be used to rapidly scan large repertoires for conformant TCRs and easily be combined with a radius constraint. When applied to bulk repertoires, the motif constraint eliminates CDR3s that did not match key conserved residues.</p></sec><sec id="s4-7"><title>Quantifying meta-clonotype conformant TCRs in bulk repertoires</title><p>After defining a set of meta-clonotypes using antigen-associated TCRs, we searched for similar TCRs in 694 bulk repertoires from COVID-19 patients 0–30 days from diagnosis. Association with predicted HLA was tested based on the count TCRs conformant with each meta-clonotype individually; however, we note that meta-clonotypes are often overlapping in that a single TCR may be conformant with the definition of multiple meta-clonotypes. A full example of tabulating EXACT, RADIUS, and RADUS+ MOTIF meta-clonotypes conformant TCRs in a bulk repertoire, while avoiding such double counting, is provided in <italic>tcrdist3</italic> documentation page (<ext-link ext-link-type="uri" xlink:href="https://tcrdist3.readthedocs.io">https://tcrdist3.readthedocs.io</ext-link>).</p></sec><sec id="s4-8"><title>Abundance regression modeling</title><p>Similar to bulk RNA sequencing data, TCR frequencies are count data drawn from samples of heterogeneous size. Thus, we initially attempted to fit a negative binomial model to the data, for example, DESEQ2 (<xref ref-type="bibr" rid="bib19">Love et al., 2013</xref>). We found that the negative binomial model did not adequately fit TCR counts, which – compared to transcriptomic data – were characterized by (1) more technical zeros due to inevitable under sampling and (2) even greater biological overdispersion, which could be due to clonal expansions and HLA genotype diversity. Instead we found that the beta-binomial distribution, which was recently used for TCR abundance modeling (<xref ref-type="bibr" rid="bib32">Rytlewski et al., 2019</xref>), provided the flexibility needed to adequately fit the TCR data. We used an R package, <italic>corncob</italic>, which provides maximum likelihood methods for inference and hypothesis testing with beta-binomial regression models (<xref ref-type="bibr" rid="bib21">Martin et al., 2020</xref>). Due to the sparsity of some meta-clonotypes, 7% of coefficient estimates in regression models had p values larger than 0.99 (i.e., nonsignificant) and unreliable high magnitude coefficient estimates. These values are not shown in the horizontal range of the volcano plots. From the p values for each regression coefficient we computed FDR-adjusted <italic>q</italic> values and accepted <italic>q</italic> values &lt;0.01 (1%) as statistically significant; adjustment was performed across meta-clonotypes within each MIRA set and within each variable class (e.g., HLA, age, sex, or days since diagnosis). The HLA regression coefficients from the beta-binomial models indicate log-fold differences in meta-clonotype abundance between patients with and without the HLA genotype.</p></sec><sec id="s4-9"><title>Comparison with k-mer-based CDR3 features</title><p><italic>GLIPH2</italic> (<xref ref-type="bibr" rid="bib14">Huang et al., 2020</xref>) software <italic>irtools.osx</italic> was applied to 17 antigen-associated subrepertoire of TCRs with epitopes with strong prior evidence of restriction to an HLA-A or HLA-B allele to demonstrate how a k-mer-based tool might also be used to cluster biochemically similar antigen-specific TCRs to discover potential TCR biomarker features. GLIPH2 generates ‘global’ TCR specificity groups of CDR3s of identical length with a single optional nonconserved position based on enrichment frequency of ‘local’ continuous 2-, 3-, and 4-mers. We used the GLIPH2-provided ‘ref_CD8_v2.0.txt’ background file as a background to identify enriched features. Across epitope-specific MIRA sets, we tested HLA associations of 812 GLIPH2 pattern ranging from 3 to 11 amino acids in length. The MIRA55:ORF1ab set was chosen for detailed analysis because, among the MIRA sets, it is comprised of CD8+ TCR β-chains activated by a peptide with the strongest evidence of HLA restriction, primarily HLA-A*01. The MIRA55 set of TCRs, GLIPH2 returned 121 testable public clusters based on 67 local k-mers (e.g., FRTD) and 54 global k-mer (e.g., SFRTD.YE), associated with CDR3 patterns enriched relative the program’s default CD8+ TCR background (GLIPH2 default Fisher’s exact test, p value &lt;0.001). The GLIPH2 patterns and their associated ‘specificity group’ TRBV gene usages and sequence length were then used to search for conforming TCRs in the 694 bulk-sequenced COVID-19 repertoires, allowing comparison to exact and meta-clonotype features. GLIPH2 represents degenerate positions using the ‘%’ character, which we represent throughout this study by the ‘.’ character.</p></sec><sec id="s4-10"><title>Tcrdist3: software for TCR repertoire analysis</title><p><italic>tcrdist3</italic> is an open-source Python3 package for TCR repertoire analysis and visualization. The core of the package is the TCRdist, a distance metric for relating two TCRs, which has been expanded beyond what was previously published (<xref ref-type="bibr" rid="bib7">Dash et al., 2017</xref>) to include γδ-TCRs. It has also been recoded to increase CPU efficiency using <italic>numba</italic>, a high-performance just-in-time compiler. A numba-coded edit/Levenshtein distance is also included for comparison, with the flexibility to accommodate novel TCR metrics as they are developed. The package can accommodate data in standardized format including AIRR, vdjdb exports, MIXCR output, 10× Cell Ranger output or Adaptive Biotechnologies immunoSeq output. The package is well documented including examples and tutorials, with source code available on <ext-link ext-link-type="uri" xlink:href="https://github.com/">github.com</ext-link> under an MIT license (<ext-link ext-link-type="uri" xlink:href="https://github.com/kmayerb/tcrdist3">https://github.com/kmayerb/tcrdist3</ext-link>; <xref ref-type="bibr" rid="bib24">Mayer-Blackwell, 2021b</xref>). <italic>tcrdist3</italic> imports modules from several other open-source, pip installable packages by the same authors that support the functionality of <italic>tcrdist3</italic>, while also providing more general utility. Briefly, the novel features of these packages and their relevance for TCR repertoire analysis is described here: <italic>pwseqdist</italic> enables fast and flexible computation of pairwise sequence-based distances using either <italic>numba</italic>-enabled tcrdist and edit distances or any user-coded Python3 metric to relate TCRs; it can also accommodate computation of ‘rectangular’ pairwise matrices: distances between a relatively small set of TCRs with all TCRs in a much larger set (e.g., bulk repertoire). On a modern laptop, distances can be computed at a rate of ~70 M per minute, per CPU.</p><p><italic>tcrsampler</italic> is a tool for subsampling large bulk datasets to estimate the frequency of TCRs and TCR neighborhoods in background repertoires. The module comes with large, bulk sequenced, default databases for human TCR α, β, γ, and δ and mouse TCR β (<xref ref-type="bibr" rid="bib2">Britanova et al., 2016</xref>; <xref ref-type="bibr" rid="bib30">Ravens et al., 2018</xref>; <xref ref-type="bibr" rid="bib40">Wirasinha et al., 2018</xref>). Datasets were selected because they represented the largest preantigen exposure TCR repertoires available; users can optionally supply their own background repertoires when applicable. An important feature of <italic>tcrsampler</italic> is the ability to specify sampling strata; for example, sampling is stratified on individual by default so that results are not biased by one individual with deeper sequencing. Sampling can also be stratified on V- and/or J-gene usage to oversample TCRs that are somewhat similar to the TCR neighborhood of interest. This greatly improves sampling efficiency, since comparing a TCR neighborhood to a background set of completely unrelated TCRs is computationally inefficient; however, we note that it is important to adjust for biased sampling approaches to estimate the frequency of oversampled TCRs in a bulk-sequenced repertoire.</p><p><italic>palmotif</italic> is a collection of functions for computing symbol heights for sequence logo plots and rendering them as SVG graphics for integration with interactive HTML visualizations or print publication. Much of the computation is based on existing methods that use either KL divergence/entropy or odds ratio-based approaches to calculate symbol heights. We contribute a novel method for creating a logo from CDR3s with varying lengths. The target sequences are first globally aligned (parasail C++ implementation of Needleman–Wunsch) to a preselected centroid sequence (<xref ref-type="bibr" rid="bib6">Daily, 2016</xref>). For logos expressing relative symbol frequency, background sequences are also aligned to the centroid. Logo computation then proceeds as usual, estimating the relative entropy between target and background sequences at each position in the alignment and the contribution of each symbol. Gaps introduced in the centroid sequence are ignored, while gap symbols in the aligned sequences are treated as an additional symbol.</p></sec><sec id="s4-11"><title>Software availability</title><p>The <italic>tcrdist3</italic> code base used in this analysis is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/kmayerb/tcrdist3/">https://github.com/kmayerb/tcrdist3/</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:5540206adb8374f150bbbc976cebac9a0f7e48dc;origin=https://github.com/kmayerb/tcrdist3;visit=swh:1:snp:73fd22b6e095666d5e4df95c2a87cc1379682e73;anchor=swh:1:rev:ecfc60a1569d656440c7fcfda841132451ad8b6e">swh:1:rev:ecfc60a1569d656440c7fcfda841132451ad8b6e</ext-link>, <xref ref-type="bibr" rid="bib24">Mayer-Blackwell, 2021b</xref>) with documented examples at <ext-link ext-link-type="uri" xlink:href="https://tcrdist3.readthedocs.io/">https://tcrdist3.readthedocs.io/</ext-link> relies on the Python package <italic>pwseqdist</italic> – freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/agartland/pwseqdist">https://github.com/agartland/pwseqdist</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:56bebb14365c45c120d6b0d60a5d28300c30c26c;origin=https://github.com/agartland/pwseqdist;visit=swh:1:snp:331e458aef8095ce79e2aca5e2c3ca01fabd1d1d;anchor=swh:1:rev:d48d3bf4e6c79e5ba2417a1010f673179b27da68">swh:1:rev:d48d3bf4e6c79e5ba2417a1010f673179b27da68</ext-link>, <xref ref-type="bibr" rid="bib11">Fiore-Gartland, 2021</xref>) – for numba-optimized just-in-time compiled versions of the TCRdist measure.</p></sec></sec></body><back><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>JCC served as unpaid consultant for 10X Genomics on the initial analysis of the 10x_200k dataset.</p></fn><fn fn-type="COI-statement" id="conf3"><p>TH has equity in Poold Diagnostics.</p></fn><fn fn-type="COI-statement" id="conf4"><p>is on the Scientific Advisory Boards of Immunoscape and Cytoagents, consulted for Elevate Bio and PACT Pharma, and has received travel costs and speaking fees from 10X Genomics and Illumina. PT served as unpaid consultant for 10X Genomics on the initial analysis of the 10x_200k dataset. PT also has filed patents on methods for sequencing and cloning TCRs (International PCT applications published December 24, 2020 as WO 2020/257575 and January 7, 2021 as WO 2021/003114). These applications are pending and have not yet been granted.</p></fn><fn fn-type="COI-statement" id="conf5"><p>served as unpaid consultant for 10X Genomics on the initial analysis of the 10x_200k dataset.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Formal analysis, Methodology, Software, Visualization, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Writing - review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Writing - review and editing</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Writing - review and editing</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Writing - review and editing</p></fn><fn fn-type="con" id="con7"><p>Conceptualization, Funding acquisition, Supervision, Writing - review and editing</p></fn><fn fn-type="con" id="con8"><p>Conceptualization, Funding acquisition, Supervision, Writing - review and editing</p></fn><fn fn-type="con" id="con9"><p>Conceptualization, Funding acquisition, Supervision, Writing - review and editing</p></fn><fn fn-type="con" id="con10"><p>Conceptualization, Formal analysis, Methodology, Software, Supervision, Visualization, Writing - original draft, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-68605-transrepform1-v1.pdf"/></supplementary-material><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Supporting data and analysis results.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-68605-supp1-v1.xlsx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Source immune repertoire data is available through the immuneRACE project (<ext-link ext-link-type="uri" xlink:href="https://immunerace.adaptivebiotech.com/data/">https://immunerace.adaptivebiotech.com/data/</ext-link>).</p><p>The following previously published datasets were used:</p><p><element-citation id="dataset1" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Nolan</surname><given-names>S</given-names></name><name><surname>Vignali</surname><given-names>M</given-names></name><name><surname>Klinger</surname><given-names>M</given-names></name><name><surname>Dines</surname><given-names>JN</given-names></name><name><surname>Kaplan</surname><given-names>IM</given-names></name><name><surname>Svejnoha</surname><given-names>E</given-names></name><name><surname>Craft</surname><given-names>T</given-names></name><name><surname>Boland</surname><given-names>K</given-names></name><name><surname>Pesesky</surname><given-names>M</given-names></name><name><surname>Gittelman</surname><given-names>RM</given-names></name><name><surname>Snyder</surname><given-names>TM</given-names></name><name><surname>Gooley</surname><given-names>CJ</given-names></name><name><surname>Semprini</surname><given-names>S</given-names></name><name><surname>Cerchione</surname><given-names>C</given-names></name><name><surname>Mazza</surname><given-names>M</given-names></name><name><surname>Delmonte</surname><given-names>OM</given-names></name><name><surname>Dobbs</surname><given-names>K</given-names></name><name><surname>Carreño-Tarragona</surname><given-names>G</given-names></name><name><surname>Barrio</surname><given-names>S</given-names></name><name><surname>Sambri</surname><given-names>V</given-names></name><name><surname>Martinelli</surname><given-names>G</given-names></name><name><surname>Goldman</surname><given-names>JD</given-names></name><name><surname>Heath</surname><given-names>JR</given-names></name><name><surname>Notarangelo</surname><given-names>LD</given-names></name><name><surname>Carlson</surname><given-names>JM</given-names></name><name><surname>Martinez-Lopez</surname><given-names>J</given-names></name><name><surname>Robins</surname><given-names>HS</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>A large-scale database of T-cell receptor beta (TCRβ) sequences and binding associations from natural and synthetic exposure to SARS CoV-2</data-title><source>ImmuneCODE-MIRA-Release002</source><pub-id pub-id-type="accession" xlink:href="https://immunerace.adaptivebiotech.com/data/">immunerace.adaptivebiotech.com/data/</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>This work was funded by NIH NIAID R01 AI136514-03 (PI Thomas) and ALSAC at St. Jude. The authors thank M Pogorelyy and A Minervina for extensive feedback on the manuscript. Scientific Computing Infrastructure at Fred Hutchinson Cancer Research Center was funded by ORIP grant S10OD028685.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahmadzadeh</surname><given-names>M</given-names></name><name><surname>Pasetto</surname><given-names>A</given-names></name><name><surname>Jia</surname><given-names>L</given-names></name><name><surname>Deniger</surname><given-names>DC</given-names></name><name><surname>Stevanović</surname><given-names>S</given-names></name><name><surname>Robbins</surname><given-names>PF</given-names></name><name><surname>Rosenberg</surname><given-names>SA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Tumor-infiltrating human CD4+ regulatory T cells display a distinct TCR repertoire and exhibit tumor and neoantigen reactivity</article-title><source>Science Immunology</source><volume>4</volume><elocation-id>eaao4310</elocation-id><pub-id pub-id-type="doi">10.1126/sciimmunol.aao4310</pub-id><pub-id pub-id-type="pmid">30635355</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Britanova</surname><given-names>OV</given-names></name><name><surname>Shugay</surname><given-names>M</given-names></name><name><surname>Merzlyak</surname><given-names>EM</given-names></name><name><surname>Staroverov</surname><given-names>DB</given-names></name><name><surname>Putintseva</surname><given-names>EV</given-names></name><name><surname>Turchaninova</surname><given-names>MA</given-names></name><name><surname>Mamedov</surname><given-names>IZ</given-names></name><name><surname>Pogorelyy</surname><given-names>MV</given-names></name><name><surname>Bolotin</surname><given-names>DA</given-names></name><name><surname>Izraelson</surname><given-names>M</given-names></name><name><surname>Davydov</surname><given-names>AN</given-names></name><name><surname>Egorov</surname><given-names>ES</given-names></name><name><surname>Kasatskaya</surname><given-names>SA</given-names></name><name><surname>Rebrikov</surname><given-names>DV</given-names></name><name><surname>Lukyanov</surname><given-names>S</given-names></name><name><surname>Chudakov</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Dynamics of Individual T Cell Repertoires: From Cord Blood to Centenarians</article-title><source>Journal of Immunology</source><volume>196</volume><fpage>5005</fpage><lpage>5013</lpage><pub-id pub-id-type="doi">10.4049/jimmunol.1600005</pub-id><pub-id pub-id-type="pmid">27183615</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cao</surname><given-names>K</given-names></name><name><surname>Wu</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Xie</surname><given-names>H</given-names></name><name><surname>Tang</surname><given-names>C</given-names></name><name><surname>Zhao</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>S</given-names></name><name><surname>Chen</surname><given-names>L</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>An</surname><given-names>Y</given-names></name><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Lin</surname><given-names>L</given-names></name><name><surname>Chai</surname><given-names>R</given-names></name><name><surname>Fang</surname><given-names>M</given-names></name><name><surname>Yue</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Ding</surname><given-names>Y</given-names></name><name><surname>Zhou</surname><given-names>L</given-names></name><name><surname>Zhao</surname><given-names>Q</given-names></name><name><surname>Yang</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>He</surname><given-names>S</given-names></name><name><surname>Liu</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>T-cell receptor repertoire data provides new evidence for hygiene hypothesis of allergic diseases</article-title><source>Allergy</source><volume>75</volume><fpage>681</fpage><lpage>683</lpage><pub-id pub-id-type="doi">10.1111/all.14014</pub-id><pub-id pub-id-type="pmid">31393607</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chiou</surname><given-names>S-H</given-names></name><name><surname>Tseng</surname><given-names>D</given-names></name><name><surname>Reuben</surname><given-names>A</given-names></name><name><surname>Mallajosyula</surname><given-names>V</given-names></name><name><surname>Molina</surname><given-names>IS</given-names></name><name><surname>Conley</surname><given-names>S</given-names></name><name><surname>Wilhelmy</surname><given-names>J</given-names></name><name><surname>McSween</surname><given-names>AM</given-names></name><name><surname>Yang</surname><given-names>X</given-names></name><name><surname>Nishimiya</surname><given-names>D</given-names></name><name><surname>Sinha</surname><given-names>R</given-names></name><name><surname>Nabet</surname><given-names>BY</given-names></name><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Shrager</surname><given-names>JB</given-names></name><name><surname>Berry</surname><given-names>MF</given-names></name><name><surname>Backhus</surname><given-names>L</given-names></name><name><surname>Lui</surname><given-names>NS</given-names></name><name><surname>Wakelee</surname><given-names>HA</given-names></name><name><surname>Neal</surname><given-names>JW</given-names></name><name><surname>Padda</surname><given-names>SK</given-names></name><name><surname>Berry</surname><given-names>GJ</given-names></name><name><surname>Delaidelli</surname><given-names>A</given-names></name><name><surname>Sorensen</surname><given-names>PH</given-names></name><name><surname>Sotillo</surname><given-names>E</given-names></name><name><surname>Tran</surname><given-names>P</given-names></name><name><surname>Benson</surname><given-names>JA</given-names></name><name><surname>Richards</surname><given-names>R</given-names></name><name><surname>Labanieh</surname><given-names>L</given-names></name><name><surname>Klysz</surname><given-names>DD</given-names></name><name><surname>Louis</surname><given-names>DM</given-names></name><name><surname>Feldman</surname><given-names>SA</given-names></name><name><surname>Diehn</surname><given-names>M</given-names></name><name><surname>Weissman</surname><given-names>IL</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Wistuba</surname><given-names>II</given-names></name><name><surname>Futreal</surname><given-names>PA</given-names></name><name><surname>Heymach</surname><given-names>JV</given-names></name><name><surname>Garcia</surname><given-names>KC</given-names></name><name><surname>Mackall</surname><given-names>CL</given-names></name><name><surname>Davis</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Global analysis of shared T cell specificities in human non-small cell lung cancer enables HLA inference and antigen discovery</article-title><source>Immunity</source><volume>54</volume><fpage>586</fpage><lpage>602</lpage><pub-id pub-id-type="doi">10.1016/j.immuni.2021.02.014</pub-id><pub-id pub-id-type="pmid">33691136</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coles</surname><given-names>CH</given-names></name><name><surname>Mulvaney</surname><given-names>RM</given-names></name><name><surname>Malla</surname><given-names>S</given-names></name><name><surname>Walker</surname><given-names>A</given-names></name><name><surname>Smith</surname><given-names>KJ</given-names></name><name><surname>Lloyd</surname><given-names>A</given-names></name><name><surname>Lowe</surname><given-names>KL</given-names></name><name><surname>McCully</surname><given-names>ML</given-names></name><name><surname>Martinez Hague</surname><given-names>R</given-names></name><name><surname>Aleksic</surname><given-names>M</given-names></name><name><surname>Harper</surname><given-names>J</given-names></name><name><surname>Paston</surname><given-names>SJ</given-names></name><name><surname>Donnellan</surname><given-names>Z</given-names></name><name><surname>Chester</surname><given-names>F</given-names></name><name><surname>Wiederhold</surname><given-names>K</given-names></name><name><surname>Robinson</surname><given-names>RA</given-names></name><name><surname>Knox</surname><given-names>A</given-names></name><name><surname>Stacey</surname><given-names>AR</given-names></name><name><surname>Dukes</surname><given-names>J</given-names></name><name><surname>Baston</surname><given-names>E</given-names></name><name><surname>Griffin</surname><given-names>S</given-names></name><name><surname>Jakobsen</surname><given-names>BK</given-names></name><name><surname>Vuidepot</surname><given-names>A</given-names></name><name><surname>Harper</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>TCRs with Distinct Specificity Profiles Use Different Binding Modes to Engage an Identical Peptide-HLA Complex</article-title><source>Journal of Immunology</source><volume>204</volume><fpage>1943</fpage><lpage>1953</lpage><pub-id pub-id-type="doi">10.4049/jimmunol.1900915</pub-id><pub-id pub-id-type="pmid">32102902</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Daily</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Parasail: SIMD C library for global, semi-global, and local pairwise sequence alignments</article-title><source>BMC Bioinformatics</source><volume>17</volume><elocation-id>81</elocation-id><pub-id pub-id-type="doi">10.1186/s12859-016-0930-z</pub-id><pub-id pub-id-type="pmid">26864881</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dash</surname><given-names>P</given-names></name><name><surname>Fiore-Gartland</surname><given-names>AJ</given-names></name><name><surname>Hertz</surname><given-names>T</given-names></name><name><surname>Wang</surname><given-names>GC</given-names></name><name><surname>Sharma</surname><given-names>S</given-names></name><name><surname>Souquette</surname><given-names>A</given-names></name><name><surname>Crawford</surname><given-names>JC</given-names></name><name><surname>Clemens</surname><given-names>EB</given-names></name><name><surname>Nguyen</surname><given-names>THO</given-names></name><name><surname>Kedzierska</surname><given-names>K</given-names></name><name><surname>La Gruta</surname><given-names>NL</given-names></name><name><surname>Bradley</surname><given-names>P</given-names></name><name><surname>Thomas</surname><given-names>PG</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Quantifiable predictive features define epitope-specific T cell receptor repertoires</article-title><source>Nature</source><volume>547</volume><fpage>89</fpage><lpage>93</lpage><pub-id pub-id-type="doi">10.1038/nature22383</pub-id><pub-id pub-id-type="pmid">28636592</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DeWitt</surname><given-names>WS</given-names></name><name><surname>Smith</surname><given-names>A</given-names></name><name><surname>Schoch</surname><given-names>G</given-names></name><name><surname>Hansen</surname><given-names>JA</given-names></name><name><surname>Matsen</surname><given-names>FA</given-names></name><name><surname>Bradley</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Human T cell receptor occurrence patterns encode immune history, genetic background, and receptor specificity</article-title><source>eLife</source><volume>7</volume><elocation-id>e38358</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.38358</pub-id><pub-id pub-id-type="pmid">30152754</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elhanati</surname><given-names>Y</given-names></name><name><surname>Sethna</surname><given-names>Z</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Predicting the spectrum of TCR repertoire sharing with a data-driven model of recombination</article-title><source>Immunological Reviews</source><volume>284</volume><fpage>167</fpage><lpage>179</lpage><pub-id pub-id-type="doi">10.1111/imr.12665</pub-id><pub-id pub-id-type="pmid">29944757</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emerson</surname><given-names>RO</given-names></name><name><surname>DeWitt</surname><given-names>WS</given-names></name><name><surname>Vignali</surname><given-names>M</given-names></name><name><surname>Gravley</surname><given-names>J</given-names></name><name><surname>Hu</surname><given-names>JK</given-names></name><name><surname>Osborne</surname><given-names>EJ</given-names></name><name><surname>Desmarais</surname><given-names>C</given-names></name><name><surname>Klinger</surname><given-names>M</given-names></name><name><surname>Carlson</surname><given-names>CS</given-names></name><name><surname>Hansen</surname><given-names>JA</given-names></name><name><surname>Rieder</surname><given-names>M</given-names></name><name><surname>Robins</surname><given-names>HS</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Immunosequencing identifies signatures of cytomegalovirus exposure history and HLA-mediated effects on the T cell repertoire</article-title><source>Nature Genetics</source><volume>49</volume><fpage>659</fpage><lpage>665</lpage><pub-id pub-id-type="doi">10.1038/ng.3822</pub-id><pub-id pub-id-type="pmid">28369038</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Fiore-Gartland</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>pwseqdist</data-title><version designator="swh:1:rev:d48d3bf4e6c79e5ba2417a1010f673179b27da68">swh:1:rev:d48d3bf4e6c79e5ba2417a1010f673179b27da68</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:56bebb14365c45c120d6b0d60a5d28300c30c26c;origin=https://github.com/agartland/pwseqdist;visit=swh:1:snp:331e458aef8095ce79e2aca5e2c3ca01fabd1d1d;anchor=swh:1:rev:d48d3bf4e6c79e5ba2417a1010f673179b27da68">https://archive.softwareheritage.org/swh:1:dir:56bebb14365c45c120d6b0d60a5d28300c30c26c;origin=https://github.com/agartland/pwseqdist;visit=swh:1:snp:331e458aef8095ce79e2aca5e2c3ca01fabd1d1d;anchor=swh:1:rev:d48d3bf4e6c79e5ba2417a1010f673179b27da68</ext-link></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gelman</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Struggles with Survey Weighting and Regression Modeling</article-title><source>Statistical Science</source><volume>22</volume><fpage>153</fpage><lpage>164</lpage><pub-id pub-id-type="doi">10.1214/088342306000000691</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glanville</surname><given-names>J</given-names></name><name><surname>Huang</surname><given-names>H</given-names></name><name><surname>Nau</surname><given-names>A</given-names></name><name><surname>Hatton</surname><given-names>O</given-names></name><name><surname>Wagar</surname><given-names>LE</given-names></name><name><surname>Rubelt</surname><given-names>F</given-names></name><name><surname>Ji</surname><given-names>X</given-names></name><name><surname>Han</surname><given-names>A</given-names></name><name><surname>Krams</surname><given-names>SM</given-names></name><name><surname>Pettus</surname><given-names>C</given-names></name><name><surname>Haas</surname><given-names>N</given-names></name><name><surname>Arlehamn</surname><given-names>CSL</given-names></name><name><surname>Sette</surname><given-names>A</given-names></name><name><surname>Boyd</surname><given-names>SD</given-names></name><name><surname>Scriba</surname><given-names>TJ</given-names></name><name><surname>Martinez</surname><given-names>OM</given-names></name><name><surname>Davis</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Identifying specificity groups in the T cell receptor repertoire</article-title><source>Nature</source><volume>547</volume><fpage>94</fpage><lpage>98</lpage><pub-id pub-id-type="doi">10.1038/nature22976</pub-id><pub-id pub-id-type="pmid">28636589</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Rubelt</surname><given-names>F</given-names></name><name><surname>Scriba</surname><given-names>TJ</given-names></name><name><surname>Davis</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Analyzing the Mycobacterium tuberculosis immune response by T-cell receptor clustering with GLIPH2 and genome-wide antigen screening</article-title><source>Nature Biotechnology</source><volume>38</volume><fpage>1194</fpage><lpage>1202</lpage><pub-id pub-id-type="doi">10.1038/s41587-020-0505-4</pub-id><pub-id pub-id-type="pmid">32341563</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Isacchini</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>OLGA</data-title><version designator="4e0bc36">4e0bc36</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/statbiophys/OLGA">https://github.com/statbiophys/OLGA</ext-link></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jurtz</surname><given-names>V</given-names></name><name><surname>Paul</surname><given-names>S</given-names></name><name><surname>Andreatta</surname><given-names>M</given-names></name><name><surname>Marcatili</surname><given-names>P</given-names></name><name><surname>Peters</surname><given-names>B</given-names></name><name><surname>Nielsen</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>NetMHCpan-4.0: Improved Peptide-MHC Class I Interaction Predictions Integrating Eluted Ligand and Peptide Binding Affinity Data</article-title><source>Journal of Immunology</source><volume>199</volume><fpage>3360</fpage><lpage>3368</lpage><pub-id pub-id-type="doi">10.4049/jimmunol.1700893</pub-id><pub-id pub-id-type="pmid">28978689</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kato</surname><given-names>T</given-names></name><name><surname>Matsuda</surname><given-names>T</given-names></name><name><surname>Ikeda</surname><given-names>Y</given-names></name><name><surname>Park</surname><given-names>JH</given-names></name><name><surname>Leisegang</surname><given-names>M</given-names></name><name><surname>Yoshimura</surname><given-names>S</given-names></name><name><surname>Hikichi</surname><given-names>T</given-names></name><name><surname>Harada</surname><given-names>M</given-names></name><name><surname>Zewde</surname><given-names>M</given-names></name><name><surname>Sato</surname><given-names>S</given-names></name><name><surname>Hasegawa</surname><given-names>K</given-names></name><name><surname>Kiyotani</surname><given-names>K</given-names></name><name><surname>Nakamura</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Effective screening of T cells recognizing neoantigens and construction of T-cell receptor-engineered T cells</article-title><source>Oncotarget</source><volume>9</volume><fpage>11009</fpage><lpage>11019</lpage><pub-id pub-id-type="doi">10.18632/oncotarget.24232</pub-id><pub-id pub-id-type="pmid">29541393</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klinger</surname><given-names>M</given-names></name><name><surname>Pepin</surname><given-names>F</given-names></name><name><surname>Wilkins</surname><given-names>J</given-names></name><name><surname>Asbury</surname><given-names>T</given-names></name><name><surname>Wittkop</surname><given-names>T</given-names></name><name><surname>Zheng</surname><given-names>J</given-names></name><name><surname>Moorhead</surname><given-names>M</given-names></name><name><surname>Faham</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Multiplex Identification of Antigen-Specific T Cell Receptors Using a Combination of Immune Assays and Immune Receptor Sequencing</article-title><source>PLOS ONE</source><volume>10</volume><elocation-id>e0141561</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0141561</pub-id><pub-id pub-id-type="pmid">26509579</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Love</surname><given-names>M</given-names></name><name><surname>Anders</surname><given-names>S</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2013">2013</year><source>Differential Analysis of RNA-Seq Data at the Gene Level Using the DESeq2 Package</source><publisher-loc>Barcelona, Spain</publisher-loc><publisher-name>European Molecular Biology Laboratory (EMBL)</publisher-name></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marcou</surname><given-names>Q</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>High-throughput immune repertoire analysis with IGoR</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>561</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-02832-w</pub-id><pub-id pub-id-type="pmid">29422654</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>BD</given-names></name><name><surname>Witten</surname><given-names>D</given-names></name><name><surname>Willis</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Modeling microbial abundances and dysbiosis with beta-binomial regression</article-title><source>The Annals of Applied Statistics</source><volume>14</volume><fpage>94</fpage><lpage>115</lpage><pub-id pub-id-type="doi">10.1214/19-aoas1283</pub-id><pub-id pub-id-type="pmid">32983313</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>corncob</data-title><version designator="5cc85ba">5cc85ba</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/bryandmartin/corncob">https://github.com/bryandmartin/corncob</ext-link></element-citation></ref><ref id="bib23"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Mayer-Blackwell</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2021">2021a</year><data-title>hla3</data-title><version designator="swh:1:rev:daaa03b89883629e53974c8e5cab2563971acfa0">swh:1:rev:daaa03b89883629e53974c8e5cab2563971acfa0</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:9a9cf65125b450c5b8b7082cd71912c51db363b2;origin=https://github.com/kmayerb/hla3;visit=swh:1:snp:141220cefe7c28fe33b2bbec8d0047fb1fdb873f;anchor=swh:1:rev:daaa03b89883629e53974c8e5cab2563971acfa0">https://archive.softwareheritage.org/swh:1:dir:9a9cf65125b450c5b8b7082cd71912c51db363b2;origin=https://github.com/kmayerb/hla3;visit=swh:1:snp:141220cefe7c28fe33b2bbec8d0047fb1fdb873f;anchor=swh:1:rev:daaa03b89883629e53974c8e5cab2563971acfa0</ext-link></element-citation></ref><ref id="bib24"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Mayer-Blackwell</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2021">2021b</year><data-title>tcrdist3</data-title><version designator="swh:1:rev:ecfc60a1569d656440c7fcfda841132451ad8b6e">swh:1:rev:ecfc60a1569d656440c7fcfda841132451ad8b6e</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:5540206adb8374f150bbbc976cebac9a0f7e48dc;origin=https://github.com/kmayerb/tcrdist3;visit=swh:1:snp:73fd22b6e095666d5e4df95c2a87cc1379682e73;anchor=swh:1:rev:ecfc60a1569d656440c7fcfda841132451ad8b6e">https://archive.softwareheritage.org/swh:1:dir:5540206adb8374f150bbbc976cebac9a0f7e48dc;origin=https://github.com/kmayerb/tcrdist3;visit=swh:1:snp:73fd22b6e095666d5e4df95c2a87cc1379682e73;anchor=swh:1:rev:ecfc60a1569d656440c7fcfda841132451ad8b6e</ext-link></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meysman</surname><given-names>P</given-names></name><name><surname>De Neuter</surname><given-names>N</given-names></name><name><surname>Gielis</surname><given-names>S</given-names></name><name><surname>Bui Thi</surname><given-names>D</given-names></name><name><surname>Ogunjimi</surname><given-names>B</given-names></name><name><surname>Laukens</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>On the viability of unsupervised T-cell receptor sequence clustering for epitope preference</article-title><source>Bioinformatics</source><volume>35</volume><fpage>1461</fpage><lpage>1468</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bty821</pub-id><pub-id pub-id-type="pmid">30247624</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murugan</surname><given-names>A</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Statistical inference of the generation probability of T-cell receptors from sequence repertoires</article-title><source>PNAS</source><volume>109</volume><fpage>16161</fpage><lpage>16166</lpage><pub-id pub-id-type="doi">10.1073/pnas.1212755109</pub-id><pub-id pub-id-type="pmid">22988065</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nolan</surname><given-names>S</given-names></name><name><surname>Vignali</surname><given-names>M</given-names></name><name><surname>Klinger</surname><given-names>M</given-names></name><name><surname>Dines</surname><given-names>JN</given-names></name><name><surname>Kaplan</surname><given-names>IM</given-names></name><name><surname>Svejnoha</surname><given-names>E</given-names></name><name><surname>Craft</surname><given-names>T</given-names></name><name><surname>Boland</surname><given-names>K</given-names></name><name><surname>Pesesky</surname><given-names>M</given-names></name><name><surname>Gittelman</surname><given-names>RM</given-names></name><name><surname>Snyder</surname><given-names>TM</given-names></name><name><surname>Gooley</surname><given-names>CJ</given-names></name><name><surname>Semprini</surname><given-names>S</given-names></name><name><surname>Cerchione</surname><given-names>C</given-names></name><name><surname>Mazza</surname><given-names>M</given-names></name><name><surname>Delmonte</surname><given-names>OM</given-names></name><name><surname>Dobbs</surname><given-names>K</given-names></name><name><surname>Carreño-Tarragona</surname><given-names>G</given-names></name><name><surname>Barrio</surname><given-names>S</given-names></name><name><surname>Sambri</surname><given-names>V</given-names></name><name><surname>Martinelli</surname><given-names>G</given-names></name><name><surname>Goldman</surname><given-names>JD</given-names></name><name><surname>Heath</surname><given-names>JR</given-names></name><name><surname>Notarangelo</surname><given-names>LD</given-names></name><name><surname>Carlson</surname><given-names>JM</given-names></name><name><surname>Martinez-Lopez</surname><given-names>J</given-names></name><name><surname>Robins</surname><given-names>HS</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A large-scale database of T-cell receptor beta (TCRβ) sequences and binding associations from natural and synthetic exposure to SARS-CoV-2</article-title><source>Research Square</source><volume>1</volume><elocation-id>51964</elocation-id><pub-id pub-id-type="doi">10.21203/rs.3.rs-51964/v1</pub-id><pub-id pub-id-type="pmid">32793896</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pogorelyy</surname><given-names>MV</given-names></name><name><surname>Minervina</surname><given-names>AA</given-names></name><name><surname>Shugay</surname><given-names>M</given-names></name><name><surname>Chudakov</surname><given-names>DM</given-names></name><name><surname>Lebedev</surname><given-names>YB</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Detecting T cell receptors involved in immune responses from single repertoire snapshots</article-title><source>PLOS Biology</source><volume>17</volume><elocation-id>e3000314</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.3000314</pub-id><pub-id pub-id-type="pmid">31194732</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pogorelyy</surname><given-names>MV</given-names></name><name><surname>Shugay</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A Framework for Annotation of Antigen Specificities in High-Throughput T-Cell Repertoire Sequencing Studies</article-title><source>Frontiers in Immunology</source><volume>10</volume><elocation-id>2159</elocation-id><pub-id pub-id-type="doi">10.3389/fimmu.2019.02159</pub-id><pub-id pub-id-type="pmid">31616409</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ravens</surname><given-names>S</given-names></name><name><surname>Schultze-Florey</surname><given-names>C</given-names></name><name><surname>Raha</surname><given-names>S</given-names></name><name><surname>Sandrock</surname><given-names>I</given-names></name><name><surname>Drenker</surname><given-names>M</given-names></name><name><surname>Oberdörfer</surname><given-names>L</given-names></name><name><surname>Reinhardt</surname><given-names>A</given-names></name><name><surname>Ravens</surname><given-names>I</given-names></name><name><surname>Beck</surname><given-names>M</given-names></name><name><surname>Geffers</surname><given-names>R</given-names></name><name><surname>von Kaisenberg</surname><given-names>C</given-names></name><name><surname>Heuser</surname><given-names>M</given-names></name><name><surname>Thol</surname><given-names>F</given-names></name><name><surname>Ganser</surname><given-names>A</given-names></name><name><surname>Förster</surname><given-names>R</given-names></name><name><surname>Koenecke</surname><given-names>C</given-names></name><name><surname>Prinz</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Publisher Correction: Human γδ T cells are quickly reconstituted after stem-cell transplantation and show adaptive clonal expansion in response to viral infection</article-title><source>Nature Immunology</source><volume>19</volume><elocation-id>1037</elocation-id><pub-id pub-id-type="doi">10.1038/s41590-018-0054-x</pub-id><pub-id pub-id-type="pmid">29449629</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ritvo</surname><given-names>PG</given-names></name><name><surname>Saadawi</surname><given-names>A</given-names></name><name><surname>Barennes</surname><given-names>P</given-names></name><name><surname>Quiniou</surname><given-names>V</given-names></name><name><surname>Chaara</surname><given-names>W</given-names></name><name><surname>El Soufi</surname><given-names>K</given-names></name><name><surname>Bonnet</surname><given-names>B</given-names></name><name><surname>Six</surname><given-names>A</given-names></name><name><surname>Shugay</surname><given-names>M</given-names></name><name><surname>Mariotti-Ferrandiz</surname><given-names>E</given-names></name><name><surname>Klatzmann</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>High-resolution repertoire analysis reveals a major bystander activation of Tfh and Tfr cells</article-title><source>PNAS</source><volume>115</volume><fpage>9604</fpage><lpage>9609</lpage><pub-id pub-id-type="doi">10.1073/pnas.1808594115</pub-id><pub-id pub-id-type="pmid">30158170</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rytlewski</surname><given-names>J</given-names></name><name><surname>Deng</surname><given-names>S</given-names></name><name><surname>Xie</surname><given-names>T</given-names></name><name><surname>Davis</surname><given-names>C</given-names></name><name><surname>Robins</surname><given-names>H</given-names></name><name><surname>Yusko</surname><given-names>E</given-names></name><name><surname>Bienkowska</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Model to improve specificity for identification of clinically-relevant expanded T cells in peripheral blood</article-title><source>PLOS ONE</source><volume>14</volume><elocation-id>e0213684</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0213684</pub-id><pub-id pub-id-type="pmid">30870493</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sethna</surname><given-names>Z</given-names></name><name><surname>Elhanati</surname><given-names>Y</given-names></name><name><surname>Callan</surname><given-names>CG</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>OLGA: fast computation of generation probabilities of B- and T-cell receptor amino acid sequences and motifs</article-title><source>Bioinformatics</source><volume>35</volume><fpage>2974</fpage><lpage>2981</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btz035</pub-id><pub-id pub-id-type="pmid">30657870</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shugay</surname><given-names>M</given-names></name><name><surname>Bagaev</surname><given-names>DV</given-names></name><name><surname>Turchaninova</surname><given-names>MA</given-names></name><name><surname>Bolotin</surname><given-names>DA</given-names></name><name><surname>Britanova</surname><given-names>OV</given-names></name><name><surname>Putintseva</surname><given-names>EV</given-names></name><name><surname>Pogorelyy</surname><given-names>MV</given-names></name><name><surname>Nazarov</surname><given-names>VI</given-names></name><name><surname>Zvyagin</surname><given-names>IV</given-names></name><name><surname>Kirgizova</surname><given-names>VI</given-names></name><name><surname>Kirgizov</surname><given-names>KI</given-names></name><name><surname>Skorobogatova</surname><given-names>EV</given-names></name><name><surname>Chudakov</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>VDJtools: Unifying Post-analysis of T Cell Receptor Repertoires</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004503</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004503</pub-id><pub-id pub-id-type="pmid">26606115</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shugay</surname><given-names>M</given-names></name><name><surname>Bagaev</surname><given-names>DV</given-names></name><name><surname>Zvyagin</surname><given-names>IV</given-names></name><name><surname>Vroomans</surname><given-names>RM</given-names></name><name><surname>Crawford</surname><given-names>JC</given-names></name><name><surname>Dolton</surname><given-names>G</given-names></name><name><surname>Komech</surname><given-names>EA</given-names></name><name><surname>Sycheva</surname><given-names>AL</given-names></name><name><surname>Koneva</surname><given-names>AE</given-names></name><name><surname>Egorov</surname><given-names>ES</given-names></name><name><surname>Eliseev</surname><given-names>AV</given-names></name><name><surname>Van Dyk</surname><given-names>E</given-names></name><name><surname>Dash</surname><given-names>P</given-names></name><name><surname>Attaf</surname><given-names>M</given-names></name><name><surname>Rius</surname><given-names>C</given-names></name><name><surname>Ladell</surname><given-names>K</given-names></name><name><surname>McLaren</surname><given-names>JE</given-names></name><name><surname>Matthews</surname><given-names>KK</given-names></name><name><surname>Clemens</surname><given-names>EB</given-names></name><name><surname>Douek</surname><given-names>DC</given-names></name><name><surname>Luciani</surname><given-names>F</given-names></name><name><surname>van Baarle</surname><given-names>D</given-names></name><name><surname>Kedzierska</surname><given-names>K</given-names></name><name><surname>Kesmir</surname><given-names>C</given-names></name><name><surname>Thomas</surname><given-names>PG</given-names></name><name><surname>Price</surname><given-names>DA</given-names></name><name><surname>Sewell</surname><given-names>AK</given-names></name><name><surname>Chudakov</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>VDJdb: a curated database of T-cell receptor sequences with known antigen specificity</article-title><source>Nucleic Acids Research</source><volume>46</volume><fpage>D419</fpage><lpage>D427</lpage><pub-id pub-id-type="doi">10.1093/nar/gkx760</pub-id><pub-id pub-id-type="pmid">28977646</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Snyder</surname><given-names>TM</given-names></name><name><surname>Gittelman</surname><given-names>RM</given-names></name><name><surname>Klinger</surname><given-names>M</given-names></name><name><surname>May</surname><given-names>DH</given-names></name><name><surname>Osborne</surname><given-names>EJ</given-names></name><name><surname>Taniguchi</surname><given-names>R</given-names></name><name><surname>Zahid</surname><given-names>HJ</given-names></name><name><surname>Kaplan</surname><given-names>IM</given-names></name><name><surname>Dines</surname><given-names>JN</given-names></name><name><surname>Noakes</surname><given-names>MT</given-names></name><name><surname>Pandya</surname><given-names>R</given-names></name><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Elasady</surname><given-names>S</given-names></name><name><surname>Svejnoha</surname><given-names>E</given-names></name><name><surname>Ebert</surname><given-names>P</given-names></name><name><surname>Pesesky</surname><given-names>MW</given-names></name><name><surname>De Almeida</surname><given-names>P</given-names></name><name><surname>O’Donnell</surname><given-names>H</given-names></name><name><surname>DeGottardi</surname><given-names>Q</given-names></name><name><surname>Keitany</surname><given-names>G</given-names></name><name><surname>Lu</surname><given-names>J</given-names></name><name><surname>Vong</surname><given-names>A</given-names></name><name><surname>Elyanow</surname><given-names>R</given-names></name><name><surname>Fields</surname><given-names>P</given-names></name><name><surname>Greissl</surname><given-names>J</given-names></name><name><surname>Baldo</surname><given-names>L</given-names></name><name><surname>Semprini</surname><given-names>S</given-names></name><name><surname>Cerchione</surname><given-names>C</given-names></name><name><surname>Nicolini</surname><given-names>F</given-names></name><name><surname>Mazza</surname><given-names>M</given-names></name><name><surname>Delmonte</surname><given-names>OM</given-names></name><name><surname>Dobbs</surname><given-names>K</given-names></name><name><surname>Laguna-Goya</surname><given-names>R</given-names></name><name><surname>Carreño-Tarragona</surname><given-names>G</given-names></name><name><surname>Barrio</surname><given-names>S</given-names></name><name><surname>Imberti</surname><given-names>L</given-names></name><name><surname>Sottini</surname><given-names>A</given-names></name><name><surname>Quiros-Roldan</surname><given-names>E</given-names></name><name><surname>Rossi</surname><given-names>C</given-names></name><name><surname>Biondi</surname><given-names>A</given-names></name><name><surname>Bettini</surname><given-names>LR</given-names></name><name><surname>D’Angio</surname><given-names>M</given-names></name><name><surname>Bonfanti</surname><given-names>P</given-names></name><name><surname>Tompkins</surname><given-names>MF</given-names></name><name><surname>Alba</surname><given-names>C</given-names></name><name><surname>Dalgard</surname><given-names>C</given-names></name><name><surname>Sambri</surname><given-names>V</given-names></name><name><surname>Martinelli</surname><given-names>G</given-names></name><name><surname>Goldman</surname><given-names>JD</given-names></name><name><surname>Heath</surname><given-names>JR</given-names></name><name><surname>Su</surname><given-names>HC</given-names></name><name><surname>Notarangelo</surname><given-names>LD</given-names></name><name><surname>Paz-Artal</surname><given-names>E</given-names></name><name><surname>Martinez-Lopez</surname><given-names>J</given-names></name><name><surname>Carlson</surname><given-names>JM</given-names></name><name><surname>Robins</surname><given-names>HS</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Magnitude and Dynamics of the T-Cell Response to SARS-CoV-2 Infection at Both Individual and Population Levels</article-title><source>medRxiv</source><pub-id pub-id-type="doi">10.1101/2020.07.31.20165647</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soto</surname><given-names>C</given-names></name><name><surname>Bombardi</surname><given-names>RG</given-names></name><name><surname>Branchizio</surname><given-names>A</given-names></name><name><surname>Kose</surname><given-names>N</given-names></name><name><surname>Matta</surname><given-names>P</given-names></name><name><surname>Sevy</surname><given-names>AM</given-names></name><name><surname>Sinkovits</surname><given-names>RS</given-names></name><name><surname>Gilchuk</surname><given-names>P</given-names></name><name><surname>Finn</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>High frequency of shared clonotypes in human B cell receptor repertoires</article-title><source>Nature</source><volume>566</volume><fpage>398</fpage><lpage>402</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-0934-8</pub-id><pub-id pub-id-type="pmid">30760926</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thomas</surname><given-names>PG</given-names></name><name><surname>Crawford</surname><given-names>JC</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Selected before selection: A case for inherent antigen bias in the T cell receptor repertoire</article-title><source>Current Opinion in Systems Biology</source><volume>18</volume><fpage>36</fpage><lpage>43</lpage><pub-id pub-id-type="doi">10.1016/j.coisb.2019.10.007</pub-id><pub-id pub-id-type="pmid">32601606</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Welsh</surname><given-names>RM</given-names></name><name><surname>Selin</surname><given-names>LK</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>No one is naive: the significance of heterologous T-cell immunity</article-title><source>Nature Reviews. Immunology</source><volume>2</volume><fpage>417</fpage><lpage>426</lpage><pub-id pub-id-type="doi">10.1038/nri820</pub-id><pub-id pub-id-type="pmid">12093008</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wirasinha</surname><given-names>RC</given-names></name><name><surname>Singh</surname><given-names>M</given-names></name><name><surname>Archer</surname><given-names>SK</given-names></name><name><surname>Chan</surname><given-names>A</given-names></name><name><surname>Harrison</surname><given-names>PF</given-names></name><name><surname>Goodnow</surname><given-names>CC</given-names></name><name><surname>Daley</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>αβ T-cell receptors with a central CDR3 cysteine are enriched in CD8αα intraepithelial lymphocytes and their thymic precursors</article-title><source>Immunology and Cell Biology</source><volume>96</volume><fpage>553</fpage><lpage>561</lpage><pub-id pub-id-type="doi">10.1111/imcb.12047</pub-id><pub-id pub-id-type="pmid">29726044</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>K</given-names></name><name><surname>Hether</surname><given-names>T</given-names></name><name><surname>Gilchuk</surname><given-names>P</given-names></name><name><surname>Kumar</surname><given-names>A</given-names></name><name><surname>Rajeh</surname><given-names>A</given-names></name><name><surname>Schiebout</surname><given-names>C</given-names></name><name><surname>Maybruck</surname><given-names>J</given-names></name><name><surname>Buller</surname><given-names>RM</given-names></name><name><surname>Ahn</surname><given-names>TH</given-names></name><name><surname>Joyce</surname><given-names>S</given-names></name><name><surname>DiPaolo</surname><given-names>RJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Identifying and Tracking Low-Frequency Virus-Specific TCR Clonotypes Using High-Throughput Sequencing</article-title><source>Cell Reports</source><volume>25</volume><fpage>2369</fpage><lpage>2378</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2018.11.009</pub-id><pub-id pub-id-type="pmid">30485806</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yohannes</surname><given-names>DA</given-names></name><name><surname>Kaukinen</surname><given-names>K</given-names></name><name><surname>Kurppa</surname><given-names>K</given-names></name><name><surname>Saavalainen</surname><given-names>P</given-names></name><name><surname>Greco</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Clustering based approach for population level identification of condition-associated T-cell receptor β-chain CDR3 sequences</article-title><source>BMC Bioinformatics</source><volume>22</volume><elocation-id>159</elocation-id><pub-id pub-id-type="doi">10.1186/s12859-021-04087-7</pub-id><pub-id pub-id-type="pmid">33765908</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.68605.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Chain</surname><given-names>Benny</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>University College London</institution><country>United Kingdom</country></aff></contrib></contrib-group><related-object id="sa0ro1" link-type="continued-by" object-id="10.1101/2020.12.24.424260" object-id-type="id" xlink:href="https://sciety.org/articles/activity/10.1101/2020.12.24.424260"/></front-stub><body><p>This paper introduces and validates a novel concept which will be of great interest to all those interested in T cell immunity and especially the T cell receptor repertoire. The concept builds on the idea that TCRs to the same antigen often share sequence similarities, which they quantify using a bespoke tool tcrdist3. Using this tool they develop the idea of a meta-clone, a set of TCRs sharing biochemical similarities and potentially recognising the same antigen. In this paper they further show that such clonotypes may show increased sharing between HLA-related individuals, and explore the use of such clonotypes in characterising antigen-specific immune response across cohorts of individuals.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.68605.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Chain</surname><given-names>Benny</given-names></name><role>Reviewing Editor</role><aff><institution>University College London</institution><country>United Kingdom</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Chain</surname><given-names>Benny</given-names></name><role>Reviewer</role><aff><institution>University College London</institution><country>United Kingdom</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Ronel</surname><given-names>Tahel</given-names></name><role>Reviewer</role><aff><institution>University College London</institution><country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2020.12.24.424260">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2020.12.24.424260v2">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;TCR meta-clonotypes for biomarker discovery with tcrdist3 enabled identification of public, HLA-restricted, SARS-CoV-2 associated TCR features&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, including Benny Chain as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by Aleksandra Walczak as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Tahel Ronel (Reviewer #3).</p><p>The reviewers are all agreed that the content of the paper is of interest to the readership of the journal. However, they are also agreed that significant revisions are necessary to increase the impact of the paper, and we would like to invite you to submit a revised version of the manuscript.</p><p>Please address the detailed comments from all three reviewers and provide a point-by-point response. In particular, the emphasis of the paper needs to be shifted from COVID to the idea of the meta-clonotype. In order to achieve this, and to make the maximum impact, the paper must be thoroughly revised, to provide much more detail and clarity on the definition/construction of meta-clones, and how they can be used to define antigen-specific responses.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>The authors should sharpen the manuscript to focus it exclusively on evaluating their new concept of a meta-clonotype, and not on evaluating the MIRA-based SARS-Cov-2 data set. For example, Lines 302-325 – what is the relevance of this section ? It analyses the MIRA dataset, and suggests the peptide-specific responses show HLA preference (hardly surprising) but doesn't say anything about the meta clonotypes.</p><p>The extension of TCRdist to gamma/delta cells seems irrelevant to this paper. No gamma-delta data are evaluated.</p><p>I found the section 560-574 (the details of generating the meta-clonotypes) very hard to follow. This is surely the crux of the whole paper, and the method for generating meta-clonotypes needs to be crystal clear. For example what does &quot;With each candidate centroid, a meta-clonotype was engineered by selecting the maximum distance radius that still controlled the number of neighboring TCRs in the weighted unenriched background to 1 in 10<sup>6</sup>&quot;. How do you reach 10<sup>6</sup> with only 200000 background TCRs?</p><p>Critically , in order to increase the impact of this study, it would be important to show that meta-clonotypes perform better than public clonotypes in identifying COVID-infected individuals (as done for clonotypes for CMV in Emerson et al. Nature Genetics 49,659).</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>Title: It's a bit strange to refer to meta-clonotypes as features (especially since machine learning was not performed). Also. the term feature does not have the same meaning throughout the manuscript. Can you adjust the title to be a bit more direct and less confusing?</p><p>Abstract: &quot;As the mechanistic basis of adaptive cellular antigen recognition, T cell receptors (TCRs) encode&quot; → this sentence doesn't make sense. There are many mechanisms involved in immune recognition (binding, proliferation etc…), TCR sequences are certainly a part of it but I would hardly call them the &quot;mechanistic basis&quot; – can you rephrase? I would like the term &quot;mechanistic&quot; to go – this paper is not mechanistic in any way.</p><p>&quot;17 SARS-CoV-2 antigen-enriched repertoires&quot; → antigen-enriched doesn't mean what you think it means. Can you please rephrase throughout the manuscript? What you mean is antigen-annotated/antigen-specific/etc…</p><p>Introduction: The introduction seems a bit verbose (the entire paper is quite verbose…more streamlining by making text and captions more precise would greatly enhance readability). This is not a covid-centric paper – please dramatically reduce the SARS-CoV-2 section. Also, the first paragraph can be written in 5 instead of 35 lines. Please try to get closer to one page overall.</p><p>Results Figure 1A: what does &quot;searchable public meta-clonotype&quot; mean? It's not mentioned anywhere else in the text.</p><p>I think it would be much more useful to the reader if you illustrate how tcrdist calculates tdus, how they are to be interpreted (you mention in the text: 1 aa mismatch is 12 tdus – this is great and would be nice to see in Figure 1A for example).</p><p>Figure 1B In my opinion, the figure does not reflect what you want it to say (quantification of the frequency of putative meta-clonotypes). Please adjust the figure accordingly.</p><p>Figure 2A &quot;As the radius about a TCR centroid expands, the number of TCRs it encompasses naturally increases; the rate of increase is more rapid in the antigen-enriched 167 repertoires compared to the unenriched repertoires&quot; → can you quantify this rate? How does the rate depend on sequencing depth? Can you also add the OLGA-generated data to this plot? Is your assumption that the OLGA-generated data would perform close to that of the cord blood data?</p><p>For all figures: can you change the bold text of the caption to the main result of the figure. As of now, the bold text doesn't really say much.</p><p>If I do a text search in the main text for &quot;Dash BMLF&quot;, I don't find anything. Please define all named datasets in the methods/main text.</p><p>Regarding the antigen-specific data – is the higher rate in antigen-specific data due to the fact that you are focusing on only a few peptides here? Would the rate be similar to the baseline data if you somehow normalized for that? Like for example only taking one tcr per peptide? Probably not possible, right, given the sparsity of the data..?</p><p>How does Tcrdist3 normalize for length differences? Do these curves differ across tcr length, germline genes?</p><p>Figure 2B</p><p>Can you explain in the main text and the methods what MIRA M48 means –specifically, what do each of the numbers mean?</p><p>Figure 3</p><p>&quot;This suggests that TCRs within sparse neighborhoods represent less common modes of antigen recognition and highlights the broad heterogeneity of neighborhood densities even among TCRs recognizing a single pMHC.&quot; → to what extent can TCRs with sparse neighborhood be a result of undersampling?</p><p>Can you add OLGA-generated data to Figure 3 as well?</p><p>Figure 4</p><p>Can you mention in the caption how many TCRs you are investigating in this subfigure? Please also check for all other figures where relevant.</p><p>&quot;We also noted that TCRs with 191 empty neighborhoods tended to have longer CDR3 loops (Figure 4C)&quot; Where and how do I see this in Figure 4C?</p><p>&quot;To be useful, a meta-clonotype definition should be broad enough 206 to capture multiple biochemically similar TCRs&quot; → what do you mean by biochemically similar? I think, in the AIRR field, when people speak of biochemically similar, they mean something related to Atchley/Kidera factors. I don't think this is what you mean here, right? Maybe rephrase to avoid misunderstandings?</p><p>&quot;This is similar to previous approaches taken by tools like ALICE and TCRNET, except that we employ a biochemically informed distance measure (TCRdist)&quot; → this statement is a bit indirect for my taste. Can you rephrase and make it really clear in what respect tcrdist3 differs from Alice et al.?</p><p>How did you decide on the number of 100000 IGOR and cord blood TCRs?</p><p>&quot;One part consisted of 100,000 synthetic TCRs whose TRBV- and TRBJ-gene frequencies matched those in the antigen-enriched repertoire; TCRs were generated using the software OLGA&quot; → how did you make sure that frequencies matched?</p><p>&quot;Using this approach, we are able to estimate the abundance of TCRs similar to a centroid TCR in an unenriched background repertoire of effectively ~1,000,000 TCRs,&quot; → Where does the number of 1M TCRs come from? Can you show that calculations don't change if you sample another 100000? To what extent do you think it plays a role that the cord blood data has been generated with a completely different experimental protocol than the MIRA data?</p><p>Figure 5</p><p>Can you please add to &quot;HLA genotype inferences&quot; section in Methods the prediction accuracies for HLA-B alleles used in Figure 5A? If prediction accuracies are low, please remove those data also from Figure 5A.</p><p>Is the HLA-classifier publicly available? Does a package for it exist as well? Which HLA alleles other than those mentioned are quite safe to predict from sequencing data?</p><p>Independently of Figure 5, is there a Figure where I see how much meta-clonotypes make up of a repertoire in terms of sequences and sequencing reads? Basically, how much more of the antigen-specific portion of a repertoire does one capture if looking at meta-clonotypes?</p><p>Furthermore, how do you compare meta-clonotypes across individuals (publicity)? Can a TCR be part of several meta-clonotypes? Can you explain all of this more in Figure 1 and the main text?</p><p>Figure 7</p><p>To what extent is this figure needed in the main text?</p><p>Since your approach is actually quite similar to Alice, especially, since you include in your analysis pgens, wouldn't it be more interesting to relate in depth to Alice than to GLIPH?</p><p>GLIPH2 was used with the default TCR background (line 629). Would this give the TCRdist3 meta-clonotypes an advantage, since the used background for TCRdist3 has been more densely sampled around the biochemical neighborhoods of interest (line 563)?</p><p>In the comparison to k-mer based CDR3 features, were meta-clonotypes defined by RADIUS or RADIUS +MOTIF? Please also mention this in Figure 7.</p><p>More general comments:</p><p>The paper presents meta-clonotypes as a novel approach to comparing similar TCRs across repertoires and mainly compares the meta-clonotypes approach to the use of public exact TCRs. This comparison seems a bit trivial since any sequence similarity clustering approach is expected to perform better than exact TCR matches. I think it's very interesting to show that meta-clonotype spaces differ between antigen-specific and non-specific repertoires. It would have been nice to focus the analysis more on this and to actually discover something cool about the repertoire biology than trying to relate exclusively to covid.</p><p>How does your method compare to this recently published approach based on TCR sub-repertoires shared across individuals? https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-021-04087-7</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>The methodology proposed in this manuscript (tcrdist3) has been made publicly available through GitHub. The application to COVID-19 is based on public datasets and is clearly referenced. Data derived in the analysis, such as NetMHCpan predictions and the set of derived meta-clonotypes are included as supplementary material, which is helpful and adheres to <italic>eLife</italic>'s policies.</p><p>The dataset of derived COVID-19 related meta-clonotypes is a valuable resource for the analysis of other bulk repertoire COVID-19 datasets, and the proposed method should be applicable in a variety of antigenic settings. This dataset could be further characterised, perhaps as a supplementary/additional figure: the distribution of optimal radii, distribution of number of TCRs conforming to each meta-clonotype, number of people contributing TCRs to the meta-clonotype, are these different between the strong HLA meta-clonotypes and weak HLA meta-clonotypes? This would help when applying the method in other contexts.</p><p>[Editors' note: further revisions were suggested prior to acceptance, as described below.]</p><p>Thank you for resubmitting your work entitled &quot;TCR meta-clonotypes for biomarker discovery with <italic>tcrdist3</italic> enabled identification of public, HLA-restricted clusters of SARS-CoV-2 TCRs&quot; for further consideration by <italic>eLife</italic>. Your revised article has been reviewed by 3 peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation has been overseen by Aleksandra Walczak as the Senior Editor.</p><p>The reviewers agree that the manuscript has been considerably improved but there are a few remaining issues of clarity that need to be addressed, as outlined below by reviewer 3.</p><p>Specifically:</p><p>1. Please include a clear and consistent definition of a meta-clone in the Discussion. If in fact there are multiple alternative definitions, please clearly set these out, with an indication of when each would be used.</p><p>2. Clearly indicate which background set is used in each figure/section of the paper.</p><p>3. Further sharpen the Discussion around comparing the meta-clonotype approach to other existing methods. Specifically, please clarify the relative importance to the novel meta-clonotype defining which derives from the new TCRdist3 metric, the motif, and the novel approach to establishing background comparisons.</p><p>The comments of the reviewers are listed below.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>The authors have addressed all of my comments.</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>The authors have placed more focus in the revised manuscript on the definition and generation of meta-clonotypes, as suggested, with the covid data used as an example application. They have included a couple of new analyses to this effect (background sets 'sensitivity analysis', logo sequence characterisation). While I still think that the idea of meta-clonotypes is both interesting and potentially useful, I find some of the paper a bit long and difficult to follow.</p><p>For example, it looks to me like the definition of meta-clonotype changes along the paper: e.g. In Figure 1/Figure 6 a meta-clonotype is centroid (TRBV + CDR3) + radius +/- motif; in Figure 10 it also includes what I think is an identifier for the set it comes from; and in Figure 12 it is TRBV + TRBJ + CDR3 + radius. As this is the main focus of the paper I think this definition should be made clear, consistent and explained somewhere.</p><p>Secondly, it was unclear to me when the authors use which set for background: e.g. does Figure 1 and caption 'synthetic set' refer to the set of 100k OLGA V-J biased + 100k cord used later? cf Lines 535-537 &quot;background CDR3s that were sampled from cord blood and constrained to use the same V and J genes&quot;, and elsewhere unadjusted cord blood is used without the OLGA adjusted set.</p><p>I also think that the advantage / unique usage of the proposed meta-clonotype method over existing methods for grouping antigen-specific TCRs should be further clarified and emphasised: I personally don't find the Results section 'Comparison to k-mer based CDR3 features' or Figures 11 and 12 very convincing to this effect, and think this message should be made clearer in the paper before the sentence in the discussion &quot;Our framework is designed for a different task than these algorithms…&quot;.</p><p>I do think the meta-clonotype method is useful, these changes are addressable and the paper has the potential to be made more readable and more impactful, if the authors streamline the definition and explanations, remove repetitive sections, and cross-reference to the relevant places in the text where things are referred to in the text before their explanations.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.68605.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>The authors should sharpen the manuscript to focus it exclusively on evaluating their new concept of a meta-clonotype, and not on evaluating the MIRA-based SARS-Cov-2 data set. For example, Lines 302-325 – what is the relevance of this section ? It analyses the MIRA dataset, and suggests the peptide-specific responses show HLA preference (hardly surprising) but doesn't say anything about the meta clonotypes.</p></disp-quote><p>We agree with you and understand why you think it’s important to focus on the concept of the meta-clonotype and have revised the manuscript towards this goal. Lines 333-337 help to establish prior evidence of HLA restriction for a subset of the MIRA datasets, which becomes critical later when we provide evidence of consistent HLA restriction of meta-clonotype conforming TCRs in COVID-19 patients; it’s this consistency that helps demonstrate the value of meta-clonotypes over individual clonotypes. However, we recognized that HLA analysis section in our original version distracted from our main point, so we have shortened this section in the main text.</p><disp-quote content-type="editor-comment"><p>The extension of TCRdist to gamma/delta cells seems irrelevant to this paper. No gamma-delta data are evaluated.</p></disp-quote><p>We agree that this is not a focus of the paper, however we included this information as the ability to analyze gamma/delta TCRs differentiate tcrdist3 from other currently available tools. The ability to perform analysis on paired-chain data as well as gamma/delta TCRs are important features of the software and therefore we’ve left one brief reference to these features in the Discussion section.</p><disp-quote content-type="editor-comment"><p>I found the section 560-574 (the details of generating the meta-clonotypes) very hard to follow.</p></disp-quote><p>Thank you for bringing this to our attention. We have substantially revised the Results paragraph that describes how meta-clonotypes are generated, including the radius selection procedure (lines 178-258). The additions include a formula (line 235) for implementing the adjustment required for the sampling design and a sensitivity analysis (lines 259-294) supporting the choice of background size and make-up. With all details in the Results, we have removed this section from the Methods.</p><disp-quote content-type="editor-comment"><p>This is surely the crux of the whole paper, and the method for generating meta-clonotypes needs to be crystal clear. For example what does &quot;With each candidate centroid, a meta-clonotype was engineered by selecting the maximum distance radius that still controlled the number of neighboring TCRs in the weighted unenriched background to 1 in 10<sup>6</sup>&quot;. How do you reach 10<sup>6</sup> with only 200000 background TCRs?</p></disp-quote><p>This is achieved by sampling background TCRs from regions of “TCR space” that are proximal to the centroid, based on VJ-gene matching. This greatly increases the efficiency of the background comparison since the vast majority of TCR space is not relevant and can be more sparsely sampled. We then use weighting to account for this sampling bias; previously we referred to this technique as inverse probability weighting (IPW), and while the concept is derived from IPW we think it’s more clearly communicated without this statistical terminology, and therefore have removed this from the manuscript. This is explained in greater detail in the Results section, “Meta-clonotype radius can be tuned to balance sensitivity and specificity” on lines 178-258.</p><disp-quote content-type="editor-comment"><p>Critically , in order to increase the impact of this study, it would be important to show that meta-clonotypes perform better than public clonotypes in identifying COVID-infected individuals (as done for clonotypes for CMV in Emerson et al. Nature Genetics 49,659).</p></disp-quote><p>While it may seem that building a repertoire-based classifier for SARS-CoV-2 infection would be a great way to demonstrate the value of meta-clonotypes, there are good reasons not to include such an analysis in the manuscript. One reason is that we would not necessarily expect that meta-clonotypes would be better than public clonotypes for identifying SARS-CoV-2 infected individuals. In fact, others have shown (Snyder et al., 2020) that with a massive dataset of cases and controls it is possible to identify a relatively small number of individual clones that are capable of identifying individuals with prior infection. Instead, we propose that meta-clonotypes would be more useful than individual clonotypes when, (a) less case-control data is available to train a classifier, (b) focus on a specific epitope is required, or (c) when it would be useful to gain insight into the underlying biology (e.g., epitope immunodominance hierarchies, response polyclonality, or CDR3 motifs defining antigen specificity). We also note that the uninfected control dataset that enabled the above analysis at the clonotype level has not been made publicly available, preventing us and others from making further improvements. Lastly, we agree with previous comments that this manuscript would benefit from a sharpened focus on the concept of the meta-clonotype. Therefore, we have chosen not to make efforts to build a classifier for prior infection and instead have emphasized the existing application, which demonstrates how meta-clonotypes retain antigen-specificity and how they can be used for population-level analysis.</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>Title: It's a bit strange to refer to meta-clonotypes as features (especially since machine learning was not performed). Also. the term feature does not have the same meaning throughout the manuscript. Can you adjust the title to be a bit more direct and less confusing?</p></disp-quote><p>We see how referring to meta-clonotypes as features may be confusing and have revised the title accordingly: “TCR meta-clonotypes for biomarker discovery with tcrdist3 enabled identification of public, HLA-restricted clusters of SARS-CoV-2 TCRs”</p><disp-quote content-type="editor-comment"><p>Abstract: &quot;As the mechanistic basis of adaptive cellular antigen recognition, T cell receptors (TCRs) encode&quot; → this sentence doesn't make sense. There are many mechanisms involved in immune recognition (binding, proliferation etc…), TCR sequences are certainly a part of it but I would hardly call them the &quot;mechanistic basis&quot; – can you rephrase? I would like the term &quot;mechanistic&quot; to go – this paper is not mechanistic in any way.</p></disp-quote><p>We agree and removed that phrasing.</p><disp-quote content-type="editor-comment"><p>&quot;17 SARS-CoV-2 antigen-enriched repertoires&quot; → antigen-enriched doesn't mean what you think it means. Can you please rephrase throughout the manuscript? What you mean is antigen-annotated/antigen-specific/etc…</p></disp-quote><p>We appreciate that the term “antigen-enriched” may not mean the same thing to everyone. We have adopted the term antigen-associated TCRs to refer to a set of TCRs that have an overrepresentation of those that recognize a particular antigen. We have provided an explicit definition of this usage in the Introduction and use the term throughout.</p><disp-quote content-type="editor-comment"><p>Introduction: The introduction seems a bit verbose (the entire paper is quite verbose…more streamlining by making text and captions more precise would greatly enhance readability). This is not a covid-centric paper – please dramatically reduce the SARS-CoV-2 section. Also, the first paragraph can be written in 5 instead of 35 lines. Please try to get closer to one page overall.</p></disp-quote><p>We appreciate the need for brevity. The Introduction has been streamlined and any background on COVID-19 that was not directly related to the analyses was removed.</p><disp-quote content-type="editor-comment"><p>Results Figure 1A: what does &quot;searchable public meta-clonotype&quot; mean? It's not mentioned anywhere else in the text.</p></disp-quote><p>This phrase has been replaced with “Public meta-clonotype”: we had meant that the meta-clonotype was something that could be used to search for conformant sequences in bulk repertoires, but this point is now clarified elsewhere.</p><disp-quote content-type="editor-comment"><p>I think it would be much more useful to the reader if you illustrate how tcrdist calculates tdus, how they are to be interpreted (you mention in the text: 1 aa mismatch is 12 tdus – this is great and would be nice to see in Figure 1A for example).</p></disp-quote><p>We agree that having an intuition for tdus is important to understanding the definition of a meta-clonotype and its radius. We have added a new Figure 2 that plots the distances between illustrative pairs of antigen-associated TCR CDR3s (MIRA55) using units of edit-distance versus TCR distance units.</p><disp-quote content-type="editor-comment"><p>Figure 1B In my opinion, the figure does not reflect what you want it to say (quantification of the frequency of putative meta-clonotypes). Please adjust the figure accordingly.</p></disp-quote><p>The Figure 1B caption now begins: “Quantifying meta-clonotype conformant TCRs in a bulk repertoire” and Figure 1C “Population-level analysis of TCR meta-clonotype frequency”</p><disp-quote content-type="editor-comment"><p>Figure 2A &quot;As the radius about a TCR centroid expands, the number of TCRs it encompasses naturally increases; the rate of increase is more rapid in the antigen-enriched 167 repertoires compared to the unenriched repertoires&quot; → can you quantify this rate? How does the rate depend on sequencing depth? Can you also add the OLGA-generated data to this plot? Is your assumption that the OLGA-generated data would perform close to that of the cord blood data?</p></disp-quote><p>Figure 2 is now Figure 3. What we meant here was to make the observation that the proportion of TCRs with a neighbor within a set of antigen-associated TCRs was greater than for TCRs among a set that has not been experimentally enriched for T cells recognizing a single antigen (e.g., cord blood), across a range of neighborhood radii. Indeed, the size of the set of TCRs does affect the proportion of TCRs with at least one neighbor, which is why we chose to include cord blood repertoires with 1K and 10K TCRs each; the bigger a set of TCRs the more likely it is to find at least one that is a neighbor. As we push this observation further in the manuscript, it’s helpful to consider the proportion of TCRs included in each TCR’s neighborhood rather than the proportion with at least one neighbor; this is what we plot in Figure 3 (now revised Figure 4), again for antigen-associated and cord blood TCRs. The goal of Figure 2 (now revised Figure 3) is to start with a more intuitive observation and then move to Figure 3 (now revised Figure 4) which is a better way to quantify the observation of neighborhood density as a function of radius; the statistic plotted in Figure 3 (now revised Figure 4) for each TCR, “proportion of TCRs within a specified radius” is also now robust to the set size compared to a simple indicator of whether or not a neighbor is present.</p><p>We have conducted several sensitivity analyses evaluating cord blood, OLGA sequences and a mix of the two, as background repertoires for selecting the optimal radius for each meta-clonotype (lines 259-294). These analyses show efficiently sampled OLGA sequences behave similarly to cord blood sequences when estimating meta-clonotype neighborhood densities. We concluded that additional lines on Figure 3A for OLGA repertoires of comparable sizes wouldn’t help make the intended point that neighborhoods around antigen-associated TCRs are more densely populated than those around individual TCRs in an unselected repertoire (e.g. cord blood). We have added a sub-panel with ECDFs from OLGA generated TCRs in the new Figure 4D.</p><disp-quote content-type="editor-comment"><p>For all figures: can you change the bold text of the caption to the main result of the figure. As of now, the bold text doesn't really say much.</p></disp-quote><p>The first line of the figure captions have been revised to be more descriptive.</p><disp-quote content-type="editor-comment"><p>If I do a text search in the main text for &quot;Dash BMLF&quot;, I don't find anything. Please define all named datasets in the methods/main text.</p></disp-quote><p>The Dash et al. publicly available source of these tetramer-sorted TCRs is now included in the figure caption.</p><disp-quote content-type="editor-comment"><p>Regarding the antigen-specific data – is the higher rate in antigen-specific data due to the fact that you are focusing on only a few peptides here? Would the rate be similar to the baseline data if you somehow normalized for that? Like for example only taking one tcr per peptide? Probably not possible, right, given the sparsity of the data..?</p></disp-quote><p>We’re not sure we fully understand your point, but will try to offer further clarification. We think you are making the point that the size of the TCR set matters. For instance, you could take one TCR from either an antigen-associated set or a background set and count how many neighbors it has within its set for a given radius. The number tallied would depend on the size of the set AND on the density of the neighborhood. We show 1K and 10K cord blood repertoires because it shows that as the set size decreases there are fewer TCRs in the neighborhood. If we used 100 or 500 TCRs, which would be similar to some of the antigen-associated sets, it would probably result in an even flatter line; we included 1K and 10K because they are conservatively larger than the antigen-associated sets and yet are still generally flatter lines. Also, keep in mind that the line represents an average across all TCRs in the set, which will also be more variable for smaller sets. We’ve now noted this last point of clarification in the Figure 3 caption.</p><disp-quote content-type="editor-comment"><p>How does Tcrdist3 normalize for length differences? Do these curves differ across tcr length, germline genes?</p></disp-quote><p>The TCRdist metric penalizes differences in CDR3 length as a non-conservative amino-acid substitution; this has been clarified in the methods. We show in Figures 3 and 4 (now Figures 4 and 5) that neighborhood density is related to CDR3 length by plotting curves by centroid generation probability. TCRs with lower probability of generation typically have fewer neighbors in the background. We have not systematically studied different VJ-genes but their usage in a background repertoire would have a similar effect on neighborhood density.</p><disp-quote content-type="editor-comment"><p>Figure 2B</p><p>Can you explain in the main text and the methods what MIRA M48 means – specifically, what do each of the numbers mean?</p></disp-quote><p>This is an important point so we have pulled the definition from the Methods and added a definition in the Introduction: “we refer to these sets as MIRA1 through MIRA252 in rank order by their size” (Lines 95-96).</p><disp-quote content-type="editor-comment"><p>Figure 3</p><p>&quot;This suggests that TCRs within sparse neighborhoods represent less common modes of antigen recognition and highlights the broad heterogeneity of neighborhood densities even among TCRs recognizing a single pMHC.&quot; → to what extent can TCRs with sparse neighborhood be a result of undersampling?</p></disp-quote><p>If we make an assumption that sampling is uniform across the repertoire space, then, while the absolute number of neighbors may be affected by under/over sampling, the relative number of neighbors for one TCR compared to another should be controlled for within a set of antigen-associated TCRs. It’s possible that near the level of detection (e.g. frequencies near 1/n) the presence of a neighbor may be observed in this experiment, but not if we had repeated the experiment (i.e. high variability), but it shouldn’t be biased to underestimate or overestimate density. Therefore, we believe that the heterogeneity we see within each MIRA set represents real variation in neighborhood density.</p><disp-quote content-type="editor-comment"><p>Can you add OLGA-generated data to Figure 3 as well?</p></disp-quote><p>Yes. We have added OLGA-generated data to revised Figure 3D, now Figure 4D.</p><disp-quote content-type="editor-comment"><p>Figure 4</p><p>Can you mention in the caption how many TCRs you are investigating in this subfigure? Please also check for all other figures where relevant.</p></disp-quote><p>Yes, added and addressed throughout.</p><disp-quote content-type="editor-comment"><p>&quot;We also noted that TCRs with 191 empty neighborhoods tended to have longer CDR3 loops (Figure 4C)&quot; Where and how do I see this in Figure 4C?</p></disp-quote><p>We have clarified this observation in the text. Revised Figure 4C shows that TCRs with sparse or empty neighborhoods tend to have longer CDR3 loops.</p><disp-quote content-type="editor-comment"><p>&quot;To be useful, a meta-clonotype definition should be broad enough 206 to capture multiple biochemically similar TCRs&quot; → what do you mean by biochemically similar? I think, in the AIRR field, when people speak of biochemically similar, they mean something related to Atchley/Kidera factors. I don't think this is what you mean here, right? Maybe rephrase to avoid misunderstandings?</p></disp-quote><p>While a sequence-based distance could simply count substitutions, with TCRdist we are using a substitution matrix (BLOSUM62) that down-weights substitutions of biochemically similar amino acids. It also upweights the CDR3 because of its importance in making contacts with the antigen. Therefore, we think that referring to TCRdist defined neighbors as biochemically similar is appropriate.</p><disp-quote content-type="editor-comment"><p>&quot;This is similar to previous approaches taken by tools like ALICE and TCRNET, except that we employ a biochemically informed distance measure (TCRdist)&quot; → this statement is a bit indirect for my taste. Can you rephrase and make it really clear in what respect tcrdist3 differs from Alice et al.?</p></disp-quote><p>Yes, please see response above. A complete comparison of these methods now appears in the Discussion.</p><disp-quote content-type="editor-comment"><p>How did you decide on the number of 100000 IGOR and cord blood TCRs?</p><p>&quot;One part consisted of 100,000 synthetic TCRs whose TRBV- and TRBJ-gene frequencies matched those in the antigen-enriched repertoire; TCRs were generated using the software OLGA&quot; → how did you make sure that frequencies matched?</p><p>&quot;Using this approach, we are able to estimate the abundance of TCRs similar to a centroid TCR in an unenriched background repertoire of effectively ~1,000,000 TCRs,&quot; → Where does the number of 1M TCRs come from? Can you show that calculations don't change if you sample another 100000? To what extent do you think it plays a role that the cord blood data has been generated with a completely different experimental protocol than the MIRA data?</p></disp-quote><p>Please see response above. We have conducted sensitivity analyses studying the impact of the size of the background on meta-clonotype radius optimization, which appear in the revised manuscript. To your specific questions that are not answered above: V and J gene frequencies of the OLGA set were matched to their frequencies in the cord blood dataset. Also, OLGA was modified to generate synthetic TCRs with specific V and J genes (this modified version is available on GitHub). We don’t know to what extent the technical factors play a role in sampling from the background and using it as a comparator for the MIRA data. Ideally, one could generate a background that is relevant to the experiment and employ identical sequencing protocols. We think its promising that the OLGA (after VJ-gene matching) and cord blood background performed consistently. Ultimately, we think the choice of background should be informed by the experiment, including possible technical factors. We’ve added this commentary to the manuscript.</p><disp-quote content-type="editor-comment"><p>Figure 5</p><p>Can you please add to &quot;HLA genotype inferences&quot; section in Methods the prediction accuracies for HLA-B alleles used in Figure 5A? If prediction accuracies are low, please remove those data also from Figure 5A.</p><p>Is the HLA-classifier publicly available? Does a package for it exist as well? Which HLA alleles other than those mentioned are quite safe to predict from sequencing data?</p></disp-quote><p>Yes, this classifier has been made available on GitHub (github.com/kmayerb/hla3). Prediction accuracies and sensitivity vary by allele, but generally sensitivity ranged between 0.85-0.97 and specificity 0.97-1 for the major HLA-A and HLA-B alleles we have analyzed here: HLA-A*01:01, HLA-A*02:01, HLA-A*03:01, HLA-A*24:02, HLA-A*11:01, HLA-B*07:02, HLA-B*15:01, HLA-B*35:03, HLA-B*57:01, HLA-B*40:01.</p><disp-quote content-type="editor-comment"><p>Independently of Figure 5, is there a Figure where I see how much meta-clonotypes make up of a repertoire in terms of sequences and sequencing reads? Basically, how much more of the antigen-specific portion of a repertoire does one capture if looking at meta-clonotypes?</p></disp-quote><p>This is an important question, but we do not know the answer. With something like a tetramer-sorted dataset we can answer that question and show what proportion of the antigen-specific sequences are captured by meta-clonotypes. We are essentially doing this with the MIRA ECDFs in Figures 3, 4, and 5 (now Figures 4,5,6), but this is circular because the meta-clonotypes were of course defined to identify these TCRs. Perhaps with a large hold-out dataset one could look to see how well these meta-clonotypes perform; experimentally one might want to generate large tetramer-sorted datasets from many individuals to show that the meta-clonotypes work in a population. With the COVID-19 analysis we have attempted to demonstrate this statistically, and while it doesn’t provide an estimate of how much of the antigen-specific repertoire we’re capturing, it does show that the antigen-specific signal is statistically significant.</p><disp-quote content-type="editor-comment"><p>Furthermore, how do you compare meta-clonotypes across individuals (publicity)? Can a TCR be part of several meta-clonotypes? Can you explain all of this more in Figure 1 and the main text?</p></disp-quote><p>Yes, see response above about overlapping meta-clonotypes.</p><disp-quote content-type="editor-comment"><p>Figure 7</p><p>To what extent is this figure needed in the main text?</p></disp-quote><p>Figure 7 is now Figure 11. This figure compares meta-clonotype to k-mere based features for 16 MIRA sets.</p><disp-quote content-type="editor-comment"><p>Since your approach is actually quite similar to Alice, especially, since you include in your analysis pgens, wouldn't it be more interesting to relate in depth to Alice than to GLIPH?</p></disp-quote><p>Our impression is that GLIPH2 is a more commonly used tool (due to computational performance) for finding potentially interesting groups of TCRs and the feedback we’ve received is that it would be helpful to compare the two in the manuscript. Therefore, we have kept Figure 7 (now Figure 11) in the manuscript. To clarify, we do not explicitly use Pgen in forming meta-clonotypes; instead we are estimating the likelihood of observing a meta-clonotype conformant TCR in the background empirically. As we understand it, ALICE would not be applicable to this context when trying to find public features among TCRs that have already been enriched for sharing an antigen specificity; this enrichment would make most if not all groupings seem significantly unexpected in an ALICE model.</p><disp-quote content-type="editor-comment"><p>GLIPH2 was used with the default TCR background (line 629). Would this give the TCRdist3 meta-clonotypes an advantage, since the used background for TCRdist3 has been more densely sampled around the biochemical neighborhoods of interest (line 563)?</p></disp-quote><p>The GLIPH2 default background is large (CD8, 573,211 clones, CD4 772,312 clones), which may actually give GLIPH2 the advantage. Instead, we use a smaller background that has greater efficiency, due to the dense sampling of biochemically similar TCRs. We decided that using the default GLIPH2 background is the most relevant for comparison since that’s what most people seem to use.</p><disp-quote content-type="editor-comment"><p>In the comparison to k-mer based CDR3 features, were meta-clonotypes defined by RADIUS or RADIUS+MOTIF? Please also mention this in Figure 7.</p></disp-quote><p>The comparisons were based on RADIUS+MOTIF meta-clonotypes. This has been clarified in Figure 7 (now Figure 11).</p><disp-quote content-type="editor-comment"><p>More general comments:</p><p>The paper presents meta-clonotypes as a novel approach to comparing similar TCRs across repertoires and mainly compares the meta-clonotypes approach to the use of public exact TCRs. This comparison seems a bit trivial since any sequence similarity clustering approach is expected to perform better than exact TCR matches. I think it's very interesting to show that meta-clonotype spaces differ between antigen-specific and non-specific repertoires. It would have been nice to focus the analysis more on this and to actually discover something cool about the repertoire biology than trying to relate exclusively to covid.</p></disp-quote><p>We’ve revised the manuscript to show how meta-clonotypes can be to form interesting biological hypotheses about antigen specificity from experiments that enrich antigen-specific TCRs. We also think it’s important that meta-clonotypes can be used for population-level statistics and biomarker development, a necessary step towards clinical translation. Still we’ve de-emphasize the COVID-19 analysis, focusing on how it demonstrates the performance of meta-clonotypes.</p><disp-quote content-type="editor-comment"><p>How does your method compare to this recently published approach based on TCR sub-repertoires shared across individuals? https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-021-04087-7</p></disp-quote><p>Yohannes et al. 2021 recently published an interesting methodology. Briefly, Yohannes and colleagues use 4-nt-mers or 3-aa-mers to cluster sets of CDR3 sequences within a sample from a single TCR repertoire. In the 3-mer aa amino acid case, a (20<sup>3</sup>) 8000-dimension vector represents each CDR3s. Within-repertoire diversity is reduced by clustering vectors via agglomerative clustering. Mean valued vector represents each cluster (which the authors call a centroid). Centroid verctors from multiple samples are clustered across samples to identify clusters representing common repertoire features. This novel approach was applied to a small cohort of patients with Celiac disease and was able to identify clusters of similar but non-identical TCRs across samples that were similar to antigen-associated TCRs from prior studies. This and other k-mer methods (see also Grief et al. 2017) and GLIPH (Glanville 2017) and GLIPH2 (Huang 2020), have shown that k-mer representation of CDR3s encode information that generalizes across samples.</p><p>The crucial distinction is that these bottom up methods learn enriched k-mer features within a single repertoire and then seek to see if those patterns are found in multiple samples. By contrast, the methodology we describe attempts to leverage information gained from experimental identification of antigen-associated TCRs from many samples to identify more antigen-associated TCRs in bulk data. We have sought to make this distinction clear in the revised manuscript, in particular line 53-65, 483-497.</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>The methodology proposed in this manuscript (tcrdist3) has been made publicly available through GitHub. The application to COVID-19 is based on public datasets and is clearly referenced. Data derived in the analysis, such as NetMHCpan predictions and the set of derived meta-clonotypes are included as supplementary material, which is helpful and adheres to eLife's policies.</p><p>The dataset of derived COVID-19 related meta-clonotypes is a valuable resource for the analysis of other bulk repertoire COVID-19 datasets, and the proposed method should be applicable in a variety of antigenic settings. This dataset could be further characterised, perhaps as a supplementary/additional figure: the distribution of optimal radii, distribution of number of TCRs conforming to each meta-clonotype, number of people contributing TCRs to the meta-clonotype, are these different between the strong HLA meta-clonotypes and weak HLA meta-clonotypes? This would help when applying the method in other contexts.</p></disp-quote><p>These are interesting points. We provide characteristics of the other MIRA sets in supporting Table S6 including the number of unique TCRs contributing to each meta-clonotype and the number of participants contributing to each meta-clonotype. The additional sensitivity analyses focused on radius optimization now show the distribution of radii across meta-clonotypes; radius and the number of subjects contributing to each meta-clonotype is also included in Tables S7 and S8. In general, the highest quality meta-clonotypes include many input TCRs and are highly public.</p><p>[Editors' note: further revisions were suggested prior to acceptance, as described below.]</p><disp-quote content-type="editor-comment"><p>The reviewers agree that the manuscript has been considerably improved but there are a few remaining issues of clarity that need to be addressed, as outlined below by reviewer 3.</p><p>Specifically:</p><p>1. Please include a clear and consistent definition of a meta-clone in the Discussion. If in fact there are multiple alternative definitions, please clearly set these out, with an indication of when each would be used.</p></disp-quote><p>We appreciate the opportunity to further refine the manuscript. We agree that clarity on the definition of a meta-clonotype is critical. As a result, we have moved a clear description to the introduction; technical discussion of the definition and its contrast with other TCR groupings is in the Discussion, with greater clarity.</p><p>We define a meta-clonotype to be a grouping of biochemically similar clonotypes surrounding a centroid clonotype, which enables population-level analyses that can consider all members of the meta-clonotype as a functional unit. In this study we developed a framework for defining meta-clonotypes from antigen associated TCRs based on a similarity threshold (i.e., a radius) and optionally, a CDR3 motif, which represent a portable set of criteria that can be used to identify meta-clonotype conformant TCRs across datasets. As experimental and statistical approaches evolve, we welcome new methods for defining TCR meta-clonotypes, and hope that the new term and concept continues to be useful, in so much that it captures the need for defining groups of functionally similar clonotypes for analysis. See lines 53-80 for clarification of this definition in the manuscript.</p><disp-quote content-type="editor-comment"><p>2. Clearly indicate which background set is used in each figure/section of the paper.</p></disp-quote><p>Throughout the manuscript, the background used to generate meta-clonotypes refers to the following, which we now state explicitly:</p><p>“A synthetic background was generated using 100,000 OLGA-generated TCRs and 100,000 TCRs sub-sampled from umbilical cord blood; OLGA-generated TCRs were sampled to match the V-J gene frequency in each MIRA receptor set, with weighting to account for the sampling bias (see Methods for details).”</p><p>In one separate instance, a different type of “background” is used to create motif visualization as shown as Figure 10. In Figure 10, the “background” used to refers to a background-subtracted CDR3 logo motif. Here the background is a random sampling of TCR beta receptors from cord blood with the same TRBV and TRBJ gene usage frequency as the receptors found within a TCRdist 20 radius of meta-clonotype centroid TRBV28*01 CASSLKTDAYEQYF.</p><p>To ensure clarity, we have modified figure captions with explicit descriptions of the backgrounds:</p><p>– We have added this description to Figure 1A caption to match wording in Figure 6:</p><p>“A synthetic background was generated using 100,000 OLGA-generated TCRs and 100,000 TCRs sub-sampled from umbilical cord blood; OLGA-generated TCRs were sampled to match the V-J gene frequency in each MIRA receptor set, with weighting to account for the sampling bias (see Methods for details).”</p><p>– Figure 4C and 4D, respectively shows proportion of neighbors in 9866 OLGA and 10,000 Cord Blood receptors as now specified in the caption text.</p><p>– Figure 7 involves sensitivity testing varying background size and type as specified in the caption.</p><p>– Figure 8: we added the caption text for clarity:</p><p>“Meta-clonotype radii were engineered using synthesized backgrounds developed for each MIRA set. Each background contained 100,000 OLGA-generated TCRs and 100,000 TCRs sub-sampled from umbilical cord blood; OLGA-generated TCRs were sampled to match to the V-J gene frequency in each MIRA receptor set (i.e., MIRA 1, 10, 30, 44,45, 48, 51, 53, 55, 70, 99, 110, 111,118, 133, 140, or 183) with weighting to account for the sampling bias (see Methods for details).”</p><p>– Figure 10: The background-adjusted logos are constructed by randomly sampling TCR β receptors from cord blood with the same TRBV and TRBJ gene usage, with 100 V-J matched TCRs sampled for every receptor in the foreground set.</p><p>– Figure 13: we added the caption text for clarity:</p><p>“Meta-clonotype radii were engineered using synthesized backgrounds developed for each MIRA set. Each background contained 100,000 OLGA-generated TCRs and 100,000 TCRs sub-sampled from umbilical cord blood; OLGA-generated TCRs were sampled to match to the V-J gene frequency in each MIRA receptor set with weighting to account for the sampling bias (see Methods for details).”</p><disp-quote content-type="editor-comment"><p>3. Further sharpen the Discussion around comparing the meta-clonotype approach to other existing methods. Specifically, please clarify the relative importance to the novel meta-clonotype defining which derives from the new TCRdist3 metric, the motif, and the novel approach to establishing background comparisons.</p></disp-quote><p>We agree that its critical to provide clarity about how this framework to develop antigen-associated meta-clonotypes is different from other published methods of grouping TCRs and also about when meta-clonotypes are a suitable tool for analysis. The fundamental difference is that other tools like GLIPH2, TCRNET and ALICE were not developed to find groups of similar TCRs among TCRs that have been experimentally pre-enriched for antigen-specificity. We’ve included a paragraph in the Discussion (quoted below), which emphasizes this distinction and the consequence for analyses.</p><p>We also address how the TCRdist radius, the motif and the novel approach to efficient background comparisons all contribute to differentiating our meta-clonotype framework from existing methods. In the revised manuscript, we write:</p><p>“The meta-clonotype framework we present joins a class of commonly used methods for TCR analysis that depend on comparisons to an antigen-naïve background repertoire. […] Ultimately, it is the focus on controlling the absolute frequency of meta-clonotype conformant TCRs in an antigen-naïve background that gives the meta-clonotype definitions portability to be applied to analyses of bulk repertoires, where quantification of similar antigen-specific TCRs is required.”</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>The authors have placed more focus in the revised manuscript on the definition and generation of meta-clonotypes, as suggested, with the covid data used as an example application. They have included a couple of new analyses to this effect (background sets 'sensitivity analysis', logo sequence characterisation). While I still think that the idea of meta-clonotypes is both interesting and potentially useful, I find some of the paper a bit long and difficult to follow.</p><p>For example, it looks to me like the definition of meta-clonotype changes along the paper: e.g. In Figure 1/Figure 6 a meta-clonotype is centroid (TRBV + CDR3) + radius +/- motif; in Figure 10 it also includes what I think is an identifier for the set it comes from; and in Figure 12 it is TRBV + TRBJ + CDR3 + radius. As this is the main focus of the paper I think this definition should be made clear, consistent and explained somewhere.</p></disp-quote><p>The nomenclature for defining meta-clonotypes is specified in Supplemental Table 1G and 1H:</p><p>Set Name+Background Frequency+ Centroid V-Gene+Centroid CDR3+TCRdist Radius+MOTIF Constraint</p><p>(e.g., M_1_1E6+TRBV27*01+CASSDRGPPDTQYF+22+([AST][DE]RG[GP].[DE]TQ) )</p><p>– Set Name (e.g., M_1)</p><p>– Background Frequency Estimate Used to Set Radius (e.g, 1E6)</p><p>– Centroid V-Gene (e.g, TRBV27*01)</p><p>– Centroid CDR3 (e.g., CASSDRGPPDTQYF)</p><p>– TCRdist Radius (e.g., 22)</p><p>– MOTIF Constraint (e.g., ([AST][DE]RG[GP].[DE]TQ))</p><p>The reviewer is correct for Figure 10 we do include the meta-clonotype nomenclature: M_55_1E6+TRBV28*01+CASSLKTDAYEQYF+20+(SL[RK][ST][ND].YEQ)</p><p>We have addressed the reviewer’s comment and made the identifiers consistent in the updated Figure 12. We have listed identifiers as TRBV27*01+CASSDRGPPDTQYF+22+([AST][DE]RG[GP].[DE]TQ). Because all of these come from a single MIRA set we omit the M_55_1E6 portion of the tag for visual clarity.</p><disp-quote content-type="editor-comment"><p>Secondly, it was unclear to me when the authors use which set for background: e.g. does Figure 1 and caption 'synthetic set' refer to the set of 100k OLGA V-J biased + 100k cord used later? cf Lines 535-537 &quot;background CDR3s that were sampled from cord blood and constrained to use the same V and J genes&quot;, and elsewhere unadjusted cord blood is used without the OLGA adjusted set.</p></disp-quote><p>Thank you for the careful review. See comment above about clarifying the captions to explicitly explain the background in each figure. Addressing the previous sentences at line 398-400:</p><p>“The background-adjusted plot shows the position-specific Kullback-Leibler divergence from an alignment of background CDR3s that were sampled from cord blood and constrained to use the same V and J genes”</p><p>The source of confusion is that the backgrounds used to estimate an optimal meta-clonotype radius are based on V-J gene usage of each of the set of antigen-annotated TCRs. This includes the 200K TCRs: 100,000 OLGA V-J matched combined with a random 100,000 sampled from cord blood.</p><p>Whereas for background-adjusted logo motifs and computation of position specific Kullback-Leibler divergence, we use TCRsampler to randomly select TCRs from cord blood with V-J gene usage matching that of the TCRs used for the motif. The new caption states:</p><p>“The background-adjusted logos are constructed by randomly sampling TCR β receptors from cord blood with the same TRBV and TRBJ gene usage, with 100 V-J matched TCRs sampled for every receptor in the foreground set.”</p><p>The methodology to select a 200K synthetic background is more extensive than that used to generate a background to visualize CDR3 logo motif. More sequences and sampling adjustments are needed to estimate the optimal radius lengths for a large set of antigen-annotated TCRs. By contrast 1000 V-J matched clones is sufficient for the CDR3 logo visualization.</p><disp-quote content-type="editor-comment"><p>I also think that the advantage / unique usage of the proposed meta-clonotype method over existing methods for grouping antigen-specific TCRs should be further clarified and emphasised: I personally don't find the Results section 'Comparison to k-mer based CDR3 features' or Figures 11 and 12 very convincing to this effect, and think this message should be made clearer in the paper before the sentence in the discussion &quot;Our framework is designed for a different task than these algorithms…&quot;.</p></disp-quote><p>We have clarified in the Discussion the differences in the design of GLIPH2 and other tools compared to the meta-clonotype framework.</p><disp-quote content-type="editor-comment"><p>I do think the meta-clonotype method is useful, these changes are addressable and the paper has the potential to be made more readable and more impactful, if the authors streamline the definition and explanations, remove repetitive sections, and cross-reference to the relevant places in the text where things are referred to in the text before their explanations.</p></disp-quote><p>Thanks, for your feedback. See above for the changes we’ve made to the Introduction and Discussion which address several of these issues.</p></body></sub-article></article>