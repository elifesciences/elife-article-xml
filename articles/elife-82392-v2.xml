<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><?covid-19-tdm ?><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">82392</article-id><article-id pub-id-type="doi">10.7554/eLife.82392</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Epidemiology and Global Health</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>Taxonium, a web-based tool for exploring large phylogenetic trees</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-282578"><name><surname>Sanderson</surname><given-names>Theo</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4177-2851</contrib-id><email>theo.sanderson@crick.ac.uk</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04tnbqb63</institution-id><institution>The Francis Crick Institute</institution></institution-wrap><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Neher</surname><given-names>Richard A</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02s6k3f65</institution-id><institution>University of Basel</institution></institution-wrap><country>Switzerland</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Ferguson</surname><given-names>Neil M</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/041kmwe10</institution-id><institution>Imperial College London</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>15</day><month>11</month><year>2022</year></pub-date><pub-date pub-type="collection"><year>2022</year></pub-date><volume>11</volume><elocation-id>e82392</elocation-id><history><date date-type="received" iso-8601-date="2022-08-02"><day>02</day><month>08</month><year>2022</year></date><date date-type="accepted" iso-8601-date="2022-10-27"><day>27</day><month>10</month><year>2022</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2022-06-03"><day>03</day><month>06</month><year>2022</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.06.03.494608"/></event></pub-history><permissions><copyright-statement>© 2022, Sanderson</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>Sanderson</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-82392-v2.pdf"/><abstract><p>The COVID-19 pandemic has resulted in a step change in the scale of sequencing data, with more genomes of SARS-CoV-2 having been sequenced than any other organism on earth. These sequences reveal key insights when represented as a phylogenetic tree, which captures the evolutionary history of the virus, and allows the identification of transmission events and the emergence of new variants. However, existing web-based tools for exploring phylogenies do not scale to the size of datasets now available for SARS-CoV-2. We have developed Taxonium, a new tool that uses WebGL to allow the exploration of trees with tens of millions of nodes in the browser for the first time. Taxonium links each node to associated metadata and supports mutation-annotated trees, which are able to capture all known genetic variation in a dataset. It can either be run entirely locally in the browser, from a server-based backend, or as a desktop application. We describe insights that analysing a tree of five million sequences can provide into SARS-CoV-2 evolution, and provide a tool at <ext-link ext-link-type="uri" xlink:href="http://cov2tree.org">cov2tree.org</ext-link> for exploring a public tree of more than five million SARS-CoV-2 sequences. Taxonium can be applied to any tree, and is available at <ext-link ext-link-type="uri" xlink:href="http://taxonium.org">taxonium.org</ext-link>, with source code at <ext-link ext-link-type="uri" xlink:href="https://github.com/theosanderson/taxonium">github.com/theosanderson/taxonium</ext-link>.</p></abstract><abstract abstract-type="plain-language-summary"><title>eLife digest</title><p>Since 2020, the SARS-CoV-2 virus has infected billions of people and spread to 185 countries. The virus spreads by making new copies of its genome inside human cells and exploits the cells’ machinery to synthesise viral proteins it needs to infect further cells. Each time the virus copies its genetic material there’s a chance that the replication process introduces an error to the genetic sequence. Over time, these mutations accumulate which can give rise to new variants with different properties. These new variants, originating from a common ancestor, may spread faster or be able to evade immune systems that have learnt to recognise previous variants.</p><p>To understand where new variants of SARS-CoV-2 come from and how related they are to each other, scientists build family trees called ‘phylogenetic trees’ based on similarities in the genetic sequences of different variants of the virus. Looking at these trees researchers can track how a variant spreads geographically, and also attempt to identify new worrying variants that might lead to a new wave of infections. The scale of the COVID-19 pandemic together with the global effort by clinicians and researchers to sequence SARS-CoV-2 genetic material means a library of over 13 million SARS-CoV-2 genomes now exists, making it the largest such collection for any organism.</p><p>Although phylogenetic trees of viruses have been studied for a long time, exploring the SARS-CoV-2 library presents technical and practical challenges due to its sheer size. Sanderson has developed an open-source web tool called Taxonium that allows users to explore phylogenetic trees with millions of sequences. With help from collaborators at the University of California, Santa Cruz, Sanderson built a website called Cov2Tree, that uses the Taxonium platform to allow immediate access to an expansive tree of all publicly available SARS-CoV-2 sequences. Cov2Tree enables users to visualise all SARS-CoV-2 genomes in a birds-eye view akin to a ‘Google Earth for virus sequences’ where anyone can zoom in on a related family of viruses down to the level of individual sequences. This can be used to compare variants and follow geographic spread.</p><p>Using Taxonium, scientists can explore how virus sequences are related to each other. They can also see the individual mutations that have occurred at each branch of the tree, and can search for sequences based on mutation, geographical location, or other factors. Interestingly, a trend appearing in the SARS-CoV-2 phylogenetic tree is the emergence of identical mutations at different branches of the tree without a common origin. These mutations may be a result of convergent evolution, a phenomenon that occurs when a mutation appears independently in different variants as it confers an advantage to the virus making such mutations more likely to persist. This means that scientists may be able to expect certain mutations to appear in more distantly related variants if they have appeared independently in several different variants already.</p><p>Overall, Taxonium is an important tool for monitoring SARS-CoV-2 genomes, but it also has broader applications. The tool can be used to browse phylogenetic trees of other viruses and organisms. Furthermore, the Taxonium website offers a way to browse a tree of life, with images and links to Wikipedia. The SARS-CoV-2 library might be the largest now, but in the future even bigger datasets will likely be available, highlighting the importance of tools like Taxonium.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>phylogenetics</kwd><kwd>tree</kwd><kwd>phylogeny</kwd><kwd>virus</kwd><kwd>epidemiology</kwd><kwd>web</kwd><kwd>genomics</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Viruses</kwd><kwd>Other</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004440</institution-id><institution>Wellcome Trust</institution></institution-wrap></funding-source><award-id>210918/Z/18/Z</award-id><principal-award-recipient><name><surname>Sanderson</surname><given-names>Theo</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004440</institution-id><institution>Wellcome Trust</institution></institution-wrap></funding-source><award-id>FC001043</award-id><principal-award-recipient><name><surname>Sanderson</surname><given-names>Theo</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000289</institution-id><institution>Cancer Research UK</institution></institution-wrap></funding-source><award-id>FC001043</award-id><principal-award-recipient><name><surname>Sanderson</surname><given-names>Theo</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000265</institution-id><institution>Medical Research Council</institution></institution-wrap></funding-source><award-id>FC001043</award-id><principal-award-recipient><name><surname>Sanderson</surname><given-names>Theo</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication. For the purpose of Open Access, the authors have applied a CC BY public copyright license to any Author Accepted Manuscript version arising from this submission.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A new tool allows researchers to dive into phylogenetic trees containing millions of nodes using just their web browser.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Genomic researchers responded to the emergence of SARS-CoV-2 with rapid collaboration at unprecedented scale. Open protocols were quickly generated for amplicon sequencing (<xref ref-type="bibr" rid="bib37">Tyson et al., 2020</xref>), and allowed researchers across the globe to produce ever-growing genomic datasets stored both in the INSDC databases (<xref ref-type="bibr" rid="bib7">Cochrane et al., 2016</xref>), and in GISAID (<xref ref-type="bibr" rid="bib33">Shu and McCauley, 2017</xref>), with the latter recently surpassing 11 million sequences. Importantly, new tools were also developed to understand the functional diversity of these samples, by assigning them into lineages proposed by the community (<xref ref-type="bibr" rid="bib27">Rambaut et al., 2020</xref>; <xref ref-type="bibr" rid="bib26">O’Toole et al., 2021</xref>), and allowing interactive exploration of trends in these data over time (<xref ref-type="bibr" rid="bib15">Hodcroft, 2021</xref>; <xref ref-type="bibr" rid="bib5">Chen et al., 2021</xref>; <xref ref-type="bibr" rid="bib35">Tsueng et al., 2022</xref>).</p><p>The fundamental representation of a viral epidemic for genomic epidemiology is a phylogenetic tree, which approximates the transmission tree and can allow insights into the direction of migration of viral lineages (<xref ref-type="bibr" rid="bib39">Wohl et al., 2016</xref>). When trees are annotated with the mutations that have occurred at each internal node, they capture information about parallel and convergent evolution, which can identify recurrent mutations of concern.</p><p>The unparalleled size of SARS-CoV-2 datasets has posed challenges for the array of tools that researchers have previously relied upon to manipulate, analyse, and visualise genomic data. In particular, the construction of phylogenetic trees, and the visualisation of these trees, have been major bottlenecks preventing full-scale analyses. There are two broad responses possible to this issue. One is to downsample the sequences analysed in order to create a smaller dataset with which existing tools are able to work efficiently. This has been an important approach, and has allowed Nextstrain (<xref ref-type="bibr" rid="bib12">Hadfield et al., 2018</xref>) to provide one of the most widely-used and important tools for exploring SARS-CoV-2 genetic diversity. Briefly, the Nextstrain pipeline downsamples sequences in a rational way, and then uses iqtree (<xref ref-type="bibr" rid="bib24">Minh et al., 2020</xref>) to assemble them into a tree, assigns chronology and ancestral states to this tree using TreeTime (<xref ref-type="bibr" rid="bib28">Sagulenko et al., 2018</xref>), and displays the results in a user-friendly interactive interface using Auspice (<xref ref-type="bibr" rid="bib12">Hadfield et al., 2018</xref>). All three of these post-downsampling stages are bottlenecks which prevent the use of full datasets, and so Nextstrain analyses are typically limited to ~4000 sequences – sampled in a structured way to ensure they either provide an overview of the pandemic or hone in on particular sequences of interest.</p><p>The new scale of data available provides an impetus to develop new tools that are able to operate on these large datasets directly without downsampling. Recently the development of UShER (<xref ref-type="bibr" rid="bib36">Turakhia et al., 2021</xref>) has permitted larger trees to be built than ever previously. UShER takes a starting tree, built with iqtree or a similar approach, and incrementally adds sequences by maximum parsimony. For densely sampled sequencing efforts, as in the SARS-CoV-2 pandemic, such an approach still yields tree topologies of very high quality (<xref ref-type="bibr" rid="bib34">Thornlow et al., 2022</xref>). To turn this distance tree into a time tree, by estimating a time associated with each node in the tree, we recently developed Chronumental (<xref ref-type="bibr" rid="bib29">Sanderson, 2021</xref>) which uses stochastic gradient descent to efficiently construct chronologies from very large trees, which was not possible with previous approaches. A final necessary component is a tool for exploring these large trees, ideally in a browser.</p><p>Here, we describe Taxonium, a web-based tool for for analysing and exploring large trees. Taxonium scales to trees with millions of nodes, and allows for rapid panning and zooming using WebGL. In addition to reading Newick format trees, Taxonium can also display UShER mutation-annotated trees which capture genotype information in mutations at internal branches. It permits searching for nodes by metadata or genotype, and a range of annotation options. Taxonium is available in a server-backed mode, which in a matter of seconds loads to allow exploration of all publicly available SARS-CoV-2 sequences, and also a fully client-side mode suitable for exploring custom datasets, including those with sensitive data.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>The Taxonium web client allows exploration of million-node phylogenies in the browser</title><p>To allow interactive examination of very large phylogenies, we built the Taxonium web client, a React application available at <ext-link ext-link-type="uri" xlink:href="http://taxonium.org">taxonium.org</ext-link>. One major bottleneck for previous approaches was the use of web technologies involving SVG or Canvas to visualize the tree, which have performance limitations. We instead use WebGL, a web standard that allows a computer’s GPU to display web graphics, for efficient visualisation of the tree – we implement this using DeckGL (<xref ref-type="bibr" rid="bib38">Uber, 2016</xref>). Even so, rendering every node in the tree would still be too slow, and would involve hundreds of nodes overplotted on each pixel when a tree was zoomed out. We address this by rendering a sparsified version of the tree, with the sparsification dependent on the zoom level such that only nodes that overlap other nodes are excluded (see Materials and methods). This approach allows for fast and responsive tree exploration.</p><p>The input to Taxonium is a tree (e.g. in Newick format) and, optionally, metadata. Metadata is associated with each node of the tree, and the tree can be coloured by any chosen metadata item. Colours are by default selected using an algorithm that hashes the metadata’s string value into a unique colour, ensuring consistency over time without the need for comprehensive look-up tables. In addition, the tree can be searched based on the metadata, with identified nodes circled. Complex hierarchical boolean combination queries using AND, OR, or NOT are supported.</p><p>The user interface of the Taxonium web client is shown in <xref ref-type="fig" rid="fig1">Figure 1</xref>. The tree, at the left hand side of the screen, can be panned, and can be zoomed in the vertical and horizontal axes independently. The latter is a crucial feature for large trees, which are invariably much larger in their y-axis. A toggleable minimap is provided for orientation. The right hand panel allows users to search for nodes of interest, to select how the tree is coloured, and to select between a chronological and a distance tree. It also displays information about the selected node; similar information is available upon hovering over a node of interest.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Tree exploration at unprecendented scale.</title><p>This figure presents a screenshot of the Taxonium web client displaying a 5,151,952 sequence tree of SARS-CoV-2 sequences. The left hand panel shows the zoomable tree with a minimap for orientation, and the right hand panel provides options for searching for nodes and for changing the colour scheme. Hovering over a node shows information in a tooltip, while clicking on a node displays further information in the right-hand panel. A search has been carried out for mutations at S:501 to Y, filtered to such nodes with at least 5,000 descendants, which are circled in red. Genomes are coloured by their PANGO lineage.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82392-fig1-v2.tif"/></fig><p>In addition to accepting traditional trees, Taxonium also supports mutation annotated trees (MATs, <xref ref-type="bibr" rid="bib20">McBroome et al., 2021a</xref>), generated by UShER, where internal nodes are annotated with mutations inferred to have occurred at that branch of the phylogeny (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Since an MAT essentially captures the full sequence of each sample in the tree, its use as an input permits the user to colour the tree by genotype at any desired site (<xref ref-type="fig" rid="fig3">Figure 3</xref>), or alternatively to search for particular mutations in internal modes (<xref ref-type="fig" rid="fig4">Figure 4</xref>), and to filter by how many terminal nodes these mutations gave rise to.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Components of the Taxonium project.</title><p>At the core of Taxonium is a graphical interface that runs in the web browser. It can connect either to a web-worker running in the same browser (for purely local use) or to an API web-server that serves parts of the tree on demand. Trees can be loaded from Newick format files with metadata TSVs (tab-separated value files), or from a specialised Taxonium JSONL (JSON-lines) format which is able to capture mutation-annotated trees. Taxonium JSONLs can be produced using the Taxoniumtools library.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82392-fig2-v2.tif"/></fig><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Mutation-annotated trees capture full sequence variation.</title><p>In this screenshot, genotype data at position Spike 681 is overlaid onto the full SARS-CoV-2 tree with Taxonium. This analysis can be reproduced by setting the ‘Color by’ field to <italic>genotype</italic>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82392-fig3-v2.tif"/></fig><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Taxonium reveals recurrent mutations in SARS-CoV-2.</title><p>This figure shows a tree zoomed in on Omicron (B.1.1.529), with 1,422,024 sequences until late May 2022. Circled nodes feature a mutation at S:452 to either M or Q which have more than 10 descendants. These (independent) mutation are much more common on the BA.2 genetic background, revealing epistasis.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82392-fig4-v2.tif"/></fig><p>Taxonium can allow visualisation of trees entirely in the client (<xref ref-type="fig" rid="fig2">Figure 2</xref>, l.h.s.), which is especially important for trees which may contain sensitive patient-level data. Trees are loaded either from a Newick file and TSV metadata file, or from a custom preprocessed Taxonium JSONL format combining the two. The Taxonium JSONL format contains a pre-computed layout for the tree, reducing the amount of computation required for its display, but Newick files can also be laid out in the client, which is achieved using an approach heavily based on JStree (<xref ref-type="bibr" rid="bib19">Li, 2021</xref>). More expensive computational operations, such as the sparsification of the tree for display, are performed in a web worker in order to maintain a responsive interface.</p></sec><sec id="s2-2"><title>An optional server-based implementation empowers rapid analysis</title><p>The client-side only version of Taxonium is highly responsive, and permits loading trees with millions of nodes on typical consumer computers. However, the process of deserialising tree data from disk into Javascript objects in memory is a bottleneck, requiring one minute and 20 s for a tree of 5.4 million sequences. Large trees also demand increasing amounts of RAM and download bandwidth which might rule out the use of lower spec devices. To allow near instantaneous access to trees with millions of nodes on almost any internet-connected device, we built a server-backed mode for Taxonium, in which a server reads trees from disk in advance and then serves required parts of them to each client on demand (<xref ref-type="fig" rid="fig2">Figure 2</xref>, r.h.s.). The server-backed mode is more efficient, as it does not require all data to be sent to the client, and the computationally expensive operations can be performed on a more powerful machine. Using this mode, a 5.4 million sequence tree can initially load in seconds. We continue to offer the client-side mode, which has the advantage that it can be used with custom data, and especially for data that may be sensitive and not suitable for uploading.</p><p>The Taxonium backend is implemented in NodeJS using Express. It runs from the same codebase that runs in the web worker in the browser. We made substantial efforts to make this backend code as efficient as possible. Nodes are stored sorted by their y coordinates, meaning that two binary searches can be used to identify the slice of nodes that lie within a supplied window.</p></sec><sec id="s2-3"><title>The Taxonium desktop application enables local loading of particularly large trees</title><p>Like most other tools for tree exploration, Taxonium stores data on nodes in random-access memory (RAM). Most computers now have 8 GB or more of RAM, which is sufficient to store data from a very large tree. However memory limits in the browser can be significantly lower than the total system memory, and efficiency of storage can depend on the specific web browser, which can limit the size of trees which can be loaded locally in the Taxonium web client to ~6 M terminal nodes on some systems. This could be avoided by manually starting an instance of the Taxonium backend, but this would be a difficult procedure for non-expert users. In response to this issue, we built the Taxonium Desktop App.</p><p>The app is developed using <ext-link ext-link-type="uri" xlink:href="https://www.electronjs.org/">Electron</ext-link> and is available in binary format for MacOS, Linux, and Windows. It automatically starts an instance of the backend using a packaged version of NodeJS, which can use as much system memory as is available, and then starts a client to connect to this backend, running in Chromium. We were able to use the Taxonium Desktop App to explore a mutation-annotated phylogeny of 12.5 M sequences and metadata on a laptop with 8 GB of RAM.</p></sec><sec id="s2-4"><title>User-friendly tooling for tree generation</title><p>We provide a simple Python package, taxoniumtools, which allows straightforward generation of a Taxonium JSONL file from an UShER MAT or a Newick tree using the command-line. The Taxonium JSONL format combines tree topology, node metadata, and mutations, in a row-wise format. The tree’s structure is encoded only in the parent_id property of each node.</p><p>Taxoniumtools uses TreeSwift (<xref ref-type="bibr" rid="bib25">Moshiri, 2020</xref>) for rapid loading of the Newick string located within the UShER MAT file. Optionally it can run Chronumental (<xref ref-type="bibr" rid="bib29">Sanderson, 2021</xref>) as part of the building process and integrate the resulting time tree into the final JSONL file.</p><p>Full documentation for Taxonium and Taxoniumtools is available at <ext-link ext-link-type="uri" xlink:href="http://docs.taxonium.org">docs.taxonium.org</ext-link>.</p></sec><sec id="s2-5"><title>A resource for the phylogenetic analysis of all public SARS-CoV-2 genomes</title><p>We used Taxonium to build the Cov2Tree web application (<ext-link ext-link-type="uri" xlink:href="http://cov2tree.org">cov2tree.org</ext-link>), which allows users to explore the full global diversity of public SARS-CoV-2 sequences (<xref ref-type="fig" rid="fig3">Figure 3</xref>).</p><p>Cov2Tree is based on the daily-updated UShER tree built by <xref ref-type="bibr" rid="bib21">McBroome et al., 2021b</xref>, which currently contains 5.6 million sequences. We provide a time tree inferred by Chronumental, and also provide a daily-updated file containing the date placements inferred by <ext-link ext-link-type="uri" xlink:href="https://cov2tree.nyc3.cdn.digitaloceanspaces.com/chron_dates.tsv.gz">Chronumental</ext-link> which can allow the identification of sequences with metadata errors (<xref ref-type="bibr" rid="bib29">Sanderson, 2021</xref>).</p><p>We run a backend server that supports the Cov2Tree application, meaning that the user needs only to load the data for the region of the tree on which they have zoomed in. This helps to enable analysis in lower bandwidth settings. Users can colour the tree by PANGO lineage, by sample country, or by genotype, and use searches to conduct complex queries.</p><p>The application of Taxonium to global SARS-CoV-2 datasets provides important insights into the evolution of the virus. Taxonium readily displays the number of independent times a given mutation has occurred during viral evolution, and the lineages in which these mutations evolved. This can be a key analytical approach to understand evolutionary processes such as epistasis. For example, Taxonium reveals a very heavy enrichment for occurrences of S:452 M/S:452Q are within the BA.2 lineage (<xref ref-type="fig" rid="fig3">Figure 3</xref>), providing evidence of epistatic interactions between this position and BA.2 defining mutations. Similar effects are seen at S:212.(see this <ext-link ext-link-type="uri" xlink:href="https://cov2tree.org/?srch=%5B%7B%22key%22%3A%22aa1%22%2C%22type%22%3A%22mutation%22%2C%22method%22%3A%22mutation%22%2C%22text%22%3A%22%22%2C%22gene%22%3A%22S%22%2C%22position%22%3A%22212%22%2C%22new_residue%22%3A%22any%22%2C%22min_tips%22%3A%2210%22%7D%5D&amp;color=%7B%22field%22%3A%22None%22%7D">tree</ext-link>).</p><p>Taxonium has also been used to probe regional introduction events and transmission clusters during the SARS-CoV-2 pandemic (<xref ref-type="bibr" rid="bib22">McBroome et al., 2022</xref>), to identify a convergent origin for two sets of mutations which each create a new ORF (<xref ref-type="bibr" rid="bib23">Mears et al., 2022</xref>), and to examine new tools for pandemic-scale tree reconstruction (<xref ref-type="bibr" rid="bib9">De Maio et al., 2022</xref>).</p></sec><sec id="s2-6"><title>Taxonium has applications beyond SARS-CoV-2</title><p>We have used Taxonium to create a tool that allows exploration of the NCBI Taxonomy database (<xref ref-type="bibr" rid="bib11">Federhen, 2012</xref>). The resulting visualisation, which can be found at <ext-link ext-link-type="uri" xlink:href="http://taxonomy.taxonium.org">taxonomy.taxonium.org</ext-link>, allows interactive viewing of the taxonomic relationships between 2.2 million species, as well as searches (<xref ref-type="fig" rid="fig5">Figure 5</xref>).</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Taxonium has applications beyond SARS-CoV-2.</title><p>(<bold>A</bold>) Phylogeny of monkeypox sequences at <ext-link ext-link-type="uri" xlink:href="https://mpx.taxonium.org/">mpx.taxonium.org</ext-link>. The large clade represents the current outbreak (<bold>B</bold>) NCBI’s taxonomy of 2.2 M species as explorable at <ext-link ext-link-type="uri" xlink:href="https://taxonomy.taxonium.org/">taxonomy.taxonium.org</ext-link>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82392-fig5-v2.tif"/></fig><p>We have also collaborated with the Serratus project (<xref ref-type="bibr" rid="bib10">Edgar et al., 2022</xref>) to allow visualisation of trees of viral RdRP sequences identified in a search of petabases of reads from the Sequence Read Archive. Each viral order and family at <ext-link ext-link-type="uri" xlink:href="http://serratus.io/trees">serratus.io/trees</ext-link> now provides an option to open a custom Taxonium tree.</p><p>With the arrival of the 2022 monkeypox outbreak in Europe, we launched <ext-link ext-link-type="uri" xlink:href="http://mpx.taxonium.org">mpx.taxonium.org</ext-link> (<xref ref-type="fig" rid="fig5">Figure 5</xref>) to allow exploration of an open genomic dataset from LAPIS (<xref ref-type="bibr" rid="bib6">Chen, 2022</xref>).</p></sec><sec id="s2-7"><title>Taxonium scales to larger trees than any existing tool</title><p>We argue that Taxonium is currently the tool that best scales to the largest trees. To examine this we here compare a number of tools for their ability to load a very large tree. We stress that many of these tools were likely not specifically designed to be able to load trees of this size, unlike Taxonium.</p><p>We used the example of a Newick tree derived from a recent UShER public tree (<xref ref-type="bibr" rid="bib21">McBroome et al., 2021b</xref>) featuring 5,326,538 sequences(tree can be downloaded <ext-link ext-link-type="uri" xlink:href="https://hgwdev.gi.ucsc.edu/~angie/UShER_SARS-CoV-2/2022/05/17/public-2022-05-17.all.nwk.gz">here</ext-link>). On a Macbook Pro (2018 version, 2.3 GHz quad-core i5), Taxonium loaded this tree from the Newick file in 31 s.</p><p>Archaeopteryx (<xref ref-type="bibr" rid="bib13">Han and Zmasek, 2009</xref>) took &gt;5 min to load this tree with stack size set to 5 GB, and then was essentially unresponsive. Empress 1.20 (<xref ref-type="bibr" rid="bib4">Cantrell, 2021</xref>) did not load this tree in the browser in any reasonable length of time. We were unable to upload this file to iTOL (<xref ref-type="bibr" rid="bib18">Letunic and Bork, 2021</xref>) or the ETE Tree Explorer (<xref ref-type="bibr" rid="bib16">Huerta-Cepas et al., 2010</xref>).</p><p>We attempted to load the same file on <ext-link ext-link-type="uri" xlink:href="https://microreact.org/">Microreact.org</ext-link> (<xref ref-type="bibr" rid="bib2">Argimón et al., 2016</xref>) (which now uses Phylocanvas.gl), but the screen locked up and had not loaded within a reasonable time. A <ext-link ext-link-type="uri" xlink:href="https://www.phylocanvas.gl/examples/very-large-tree.html">Phylocanvas.GL demo</ext-link> does show that the library (<xref ref-type="bibr" rid="bib1">Abudahab et al., 2021</xref>) is able to load a SARS-CoV-2 tree with &gt;1 M leaves, panning relatively slowly on our hardware.</p><p>We found it difficult to evaluate the performance of Dendroscope (<xref ref-type="bibr" rid="bib17">Huson et al., 2007</xref>): we were able to open this file – for which we increased its allotted RAM to 5 GB. The tree loaded in 1 min and 23 s. However, it rendered as a single black rectangle which only began to resolve upon zooming in substantially, making it difficult to extract insights about the tree. Dendroscope used all available RAM whereas Taxonium used 1.7 GB. In general, Taxonium felt substantially more responsive.</p><p>It must be noted that all these tools have different feature sets. Many of the tools above allow for features absent from Taxonium, such as re-rooting, displaying trees radially, collapsing subtrees, and more. Support for these features to an extent trades-off against scale. Conversely, Taxonium is unique among these tools in supporting mutation-annotated trees, and perhaps in its ability to toggle to a time tree – features shared with, and inspired by, Auspice (<xref ref-type="bibr" rid="bib12">Hadfield et al., 2018</xref>) – which is limited to phylogenies of &lt;~10,000 tips (around 0.2% of Taxonium scale). In sum, we argue that Taxonium is the only tool able to fluidly explore the largest trees in current use on consumer-grade hardware.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>The increased scale of recent genomic datasets has prevented existing tools from being used to explore entire phylogenies in the case of SARS-CoV-2. While unprecedented, these SARS-CoV-2 datasets likely provide a preview of future data volumes for many other organisms given the decreasing costs of sequencing and increasing infrastructure for genomic surveillance.</p><p>Taxonium allows exploration of these large phylogenies, and is also one of few tools to allow the visualisation of a mutation-annotated tree capturing all known sequence diversity in an organism. It is open-source and highly configurable for use with any tree. We have used Taxonium to build the Cov2Tree website, which has been widely used to explore the global diversity of SARS-CoV-2.</p><p>Some tools for phylogenetic trees are designed primarily for generating static figures suited for publications. These may offer features Taxonium lacks, such as the ability to visualise phylogenies in a circular layout, and the ability to output vector graphics. In contrast, Taxonium is intended primarily for exploring a tree dynamically – in the case of very large trees, this is often the only way to extract useful information.</p><p>One challenge in this new era of vast datasets is the variable quality of sequences, and therefore resultant phylogenies. Artifacts in sequences (e.g. <xref ref-type="bibr" rid="bib14">Heguy et al., 2022</xref>; <xref ref-type="bibr" rid="bib30">Sanderson and Barrett, 2021</xref>; <xref ref-type="bibr" rid="bib31">Sanderson et al., 2021</xref>) are often systematic, and in such cases can create entire clades brought together by shared errors. Existing efforts to tackle these issues have been important, for example pooling knowledge of known sites of common spurious mutations (<xref ref-type="bibr" rid="bib8">De Maio et al., 2020</xref>). The development of new pipelines and assemblers that minimize artifacts will be important in the future, and the development of tree-building algorithms that are able to consider the possibility of variation due to artifacts, or pre-tree masking steps that mask different sites in each sequence, may be valuable. Widespread deposition of raw reads would allow systematic assembly by pipelines designed to minimise errors. In Taxonium, we provide a search option that highlights ‘revertant’ mutations in which a branch apparently mutates back towards the reference genome. In large SARS-CoV-2 phylogenies, many of these mutations appear to in fact represent sequencing artifacts, or reversion from them, and so this approach may help identify areas of a tree that have technical issues.</p><p>Even where sequences are accurate, phylogenetic topology is often uncertain, and finding ways to communicate this at scale, building on prior work (<xref ref-type="bibr" rid="bib3">Bouckaert, 2010</xref>) would be useful. A further challenge is the vastly different densities of sampling in different geographic regions. Because Cov2Tree does not downsample sequences from countries which are able to sequence a greater proportion of their cases, the number of tips in a particular region of the tree is not always indicative of the size of an outbreak, and in some cases even inferences of the directionality of migration may be confounded. There would be value in the development of techniques that allow visual normalisation of trees for sampling biases, which might allow for less biased phylogenetic representations without downsampling.</p><p>Taxonium is an ongoing project to create and maintain a tree viewer able to scale to the latest phylogenies. It forms part of an ecosystem of open-source tools that together turn an avalanche of sequencing data into actionable insights into ongoing evolution. We welcome contributions from the community and hope that the features described here will be useful to those working on epidemiological surveillance and outbreak response.</p></sec><sec id="s4" sec-type="methods"><title>Methods</title><sec id="s4-1"><title>Data sources</title><p>In order to be able to share trees through a web application, we present data at Cov2Tree and in this paper derived from SARS-CoV-2 sequences made available openly in the INSDC databases. We are fortunate to be able to use a pre-computed UShER tree also made available openly on a daily basis (<xref ref-type="bibr" rid="bib21">McBroome et al., 2021b</xref>).</p></sec><sec id="s4-2"><title>The Taxonium web client</title><p>The Taxonium web client is implemented in React. All source code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/theosanderson/taxonium/tree/master/taxonium_web_client">https://github.com/theosanderson/taxonium/tree/master/taxonium_web_client</ext-link> (<xref ref-type="bibr" rid="bib32">Sanderson, 2022</xref>). The core of the visualisation runs in DeckGL, which is heavily modified to allow independent zooming in X and Y. The data consumed by DeckGL is generated either in a web worker (local mode) or in from an external API running the Taxonium backend (remote mode).</p><p>In either case, the key endpoint provides a sparsified tree, a pruned version focused on nodes in the currently visible region, with overlying nodes reduced (see <italic>Reducing overplotting</italic> below). Outputting a full pruned tree means that the genotypes of all terminal nodes can be computed by traversing the mutations associated with each node.</p><p>The returned dataset includes all metadata for each included node, meaning that users can select any item to colour nodes by, or alternatively can colour nodes by genotype.</p><p>Alternatively the <italic>Search</italic> endpoint allows users to search across the whole dataset, with nodes matching the search circled in the interface.</p><p>Taxonium is capable of storing two different distance metrics in the same tree, allowing users to switch between the genetic distance and the temporal phylogeny.</p></sec><sec id="s4-3"><title>Taxonium backend</title><p>The Taxonium backend is implemented in NodeJS in an <ext-link ext-link-type="uri" xlink:href="https://expressjs.com/">Express</ext-link>-based framework. Full source code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/theosanderson/taxonium/tree/master/taxonium_backend">https://github.com/theosanderson/taxonium/tree/master/taxonium_backend</ext-link>. The core code for filtering and searching that runs in the web-worker for the front-end is reused through a shared package, <italic>taxonium_data_handling</italic>.</p><p>The backend keeps the full tree in memory, then serves filtered slices of it to users on demand. In the case of the SARS-CoV-2 dataset, the server backend requires around 5 GB of RAM per server instance. We run Cov2Tree on an autoscaling <ext-link ext-link-type="uri" xlink:href="http://k8s.io">Kubernetes</ext-link> cluster.</p></sec><sec id="s4-4"><title>Reducing overplotting</title><sec id="s4-4-1"><title>Nodes</title><p>To minimise both the overhead for displaying data in DeckGL, and the amount of data that needs to be transferred from a backend to the client, it is necessary to filter the tree so that we do not aim to draw every single node. Drawing every single node is unnecessary given that a tree with 5 M terminal nodes contains more nodes than there are pixels available on a typical screen, meaning that many nodes lie on top of one another. Therefore, we aim to filter out some of these overlying nodes while ensuring that the user sees essentially the same tree that they would have done without filtering.</p><p>This approach is assisted by the fact that the tree’s layout is pre-calculated, with each node assigned an X and Y value which is stored in the Taxonium JSONL (or generated at load-time from a Newick file).</p><p>When the user zooms to a particular region of the tree, we create a bounding box, which is a little larger than the area visible on the screen. We then calculate a ‘precision’ value for the X and Y axes, which is a value &lt;1, inversely proportional of the dimensions of the bounding box in X and Y, so that as the bounding box targets a smaller area the precision value increases. We initially select all the nodes which are within the bounding box, and then filter down overlying nodes, using the following approach which is designed to be as streamlined as possible to minimise computational work:</p><list list-type="bullet"><list-item><p>Create a variable to store already-included positions (which are indexed as <monospace>included_points[rounded_x][rounded_y]</monospace>)</p></list-item><list-item><p>Iterate over nodes</p><list list-type="bullet"><list-item><p>For each node calculate a ‘rounded position’, with an x-value of <monospace>Math.round(node.x * precisionX) / precisionX</monospace> and the corresponding y-value.</p></list-item><list-item><p>If this rounded position is <italic>not</italic> among the already-included positions then:</p><list list-type="bullet"><list-item><p>include this position in the output</p></list-item><list-item><p>add this position to the already-included positions</p></list-item></list></list-item></list></list-item></list></sec><sec id="s4-4-2"><title>Search</title><p>In order to ensure that search results are always comprehensive, but at the same time to avoid overplotting, we take the following approach:</p><list list-type="bullet"><list-item><p>Searches are performed across every single node on the tree to identify a set of nodes that match the search. The total number of matches is displayed in the client.</p></list-item><list-item><p>If fewer than 10,000 matches are detected, these are simply directly displayed in the client as circles</p></list-item><list-item><p>If more than 10,000 matches are detected, the results are first sparsified using the same method described above for nodes, and then displayed.</p></list-item><list-item><p>Upon zooming or panning, the sparsification is repeated for the new bounding box.</p></list-item></list></sec></sec><sec id="s4-5"><title>Taxoniumtools and tree processing</title><p>The <italic>taxoniumtools</italic> package is written in Python and distributed with PyPI. Tree manipulation is performed with TreeSwift (<xref ref-type="bibr" rid="bib25">Moshiri, 2020</xref>). The package includes the ability to number internal nodes, with a numbering scheme that matches UShER newick exports. An optional feature, used for display on Cov2Tree, ‘shears’ off outlier nodes with very few descendants, which often represent sequencing errors or occasionally recombinants. This pruning can help to make large trees more interpretable.</p></sec><sec id="s4-6"><title>Data availability statement</title><p>The input mutation-annotated trees from publicly available SARS-CoV-2 genomes are described in <xref ref-type="bibr" rid="bib21">McBroome et al., 2021b</xref> and made available at <ext-link ext-link-type="uri" xlink:href="http://hgdownload.soe.ucsc.edu/goldenPath/wuhCor1/UShER_SARS-CoV-2/">http://hgdownload.soe.ucsc.edu/goldenPath/wuhCor1/UShER_SARS-CoV-2/</ext-link>.</p><p>The code for Taxonium is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/theosanderson/taxonium">https://github.com/theosanderson/taxonium</ext-link> (<xref ref-type="bibr" rid="bib32">Sanderson, 2022</xref>).</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Formal analysis, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing – original draft, Project administration, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-82392-mdarchecklist1-v2.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>All code is available on GitHub. Data was not generated as part of this study. Data sources are indicated in the manuscript and raw data is available in all cases, without the need for requests.</p><p>The following previously published dataset was used:</p><p><element-citation publication-type="data" specific-use="references" id="dataset1"><person-group person-group-type="author"><name><surname>McBroome</surname><given-names>J</given-names></name><name><surname>Bryan</surname><given-names>T</given-names></name><name><surname>Hinrichs</surname><given-names>AS</given-names></name><name><surname>Kramer</surname><given-names>A</given-names></name><name><surname>De Maio</surname><given-names>N</given-names></name><name><surname>Goldman</surname><given-names>N</given-names></name><name><surname>Haussler</surname><given-names>D</given-names></name><name><surname>Corbett-Detig</surname><given-names>R</given-names></name><name><surname>Turakhia</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>A Daily-Updated Database and Tools for Comprehensive SARS-CoV-2 Mutation-Annotated Trees</data-title><source>UCSC</source><pub-id pub-id-type="accession" xlink:href="http://hgdownload.soe.ucsc.edu/goldenPath/wuhCor1/UShER_SARS-CoV-2/">UShER_SARS-CoV-2</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>Phylogenetic analysis of viral genomes is only possible thanks to a community of researchers and clinicians who take viral samples, generate genomes, and submit to sequence databases such as the INSDC databases and GISAID, and I am very grateful to all contributors. I am indebted to Richard Goater for development advice and to Angie Hinrichs for maintenance of the underlying tree that powers Cov2Tree. This work was supported by the Wellcome Trust (210918/Z/18/Z) and the Francis Crick Institute which receives its core funding from Cancer Research UK (FC001043), the UK Medical Research Council (FC001043), and the Wellcome Trust (FC001043). This research was funded in whole, or in part, by the Wellcome Trust [210918/Z/18/Z, FC001043]. For the purpose of Open Access, the author has applied a CC BY public copyright licence to any Author Accepted Manuscript version arising from this submission.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abudahab</surname><given-names>K</given-names></name><name><surname>Underwood</surname><given-names>A</given-names></name><name><surname>Taylor</surname><given-names>B</given-names></name><name><surname>Yeats</surname><given-names>C</given-names></name><name><surname>Aanensen</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Phylocanvas.gl: A webGL-powered javascript library for large tree visualisation</article-title><source>Open Science Framework</source><volume>1</volume><elocation-id>nfv6m</elocation-id><pub-id pub-id-type="doi">10.31219/osf.io/nfv6m</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Argimón</surname><given-names>S</given-names></name><name><surname>Abudahab</surname><given-names>K</given-names></name><name><surname>Goater</surname><given-names>RJE</given-names></name><name><surname>Fedosejev</surname><given-names>A</given-names></name><name><surname>Bhai</surname><given-names>J</given-names></name><name><surname>Glasner</surname><given-names>C</given-names></name><name><surname>Feil</surname><given-names>EJ</given-names></name><name><surname>Holden</surname><given-names>MTG</given-names></name><name><surname>Yeats</surname><given-names>CA</given-names></name><name><surname>Grundmann</surname><given-names>H</given-names></name><name><surname>Spratt</surname><given-names>BG</given-names></name><name><surname>Aanensen</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Microreact: visualizing and sharing data for genomic epidemiology and phylogeography</article-title><source>Microbial Genomics</source><volume>2</volume><elocation-id>e000093</elocation-id><pub-id pub-id-type="doi">10.1099/mgen.0.000093</pub-id><pub-id pub-id-type="pmid">28348833</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bouckaert</surname><given-names>RR</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>DensiTree: making sense of sets of phylogenetic trees</article-title><source>Bioinformatics</source><volume>26</volume><fpage>1372</fpage><lpage>1373</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btq110</pub-id><pub-id pub-id-type="pmid">20228129</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cantrell</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Empress enables tree-guided, interactive, and exploratory analyses of multi-omic data sets</article-title><source>MSystems</source><volume>6</volume><elocation-id>01216-20</elocation-id><pub-id pub-id-type="doi">10.1128/mSystems.01216-20</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>C</given-names></name><name><surname>Nadeau</surname><given-names>S</given-names></name><name><surname>Yared</surname><given-names>M</given-names></name><name><surname>Voinov</surname><given-names>P</given-names></name><name><surname>Xie</surname><given-names>N</given-names></name><name><surname>Roemer</surname><given-names>C</given-names></name><name><surname>Stadler</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>CoV-spectrum: analysis of globally shared SARS-CoV-2 data to identify and characterize new variants</article-title><source>Bioinformatics</source><volume>38</volume><fpage>1735</fpage><lpage>1737</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btab856</pub-id><pub-id pub-id-type="pmid">34954792</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>LAPIS for monkeypox</article-title><ext-link ext-link-type="uri" xlink:href="https://mpox-lapis.genspectrum.org/docs/#introduction">https://mpox-lapis.genspectrum.org/docs/#introduction</ext-link><date-in-citation iso-8601-date="2022-02-06">February 6, 2022</date-in-citation></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cochrane</surname><given-names>G</given-names></name><name><surname>Karsch-Mizrachi</surname><given-names>I</given-names></name><name><surname>Takagi</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The international nucleotide sequence database collaboration</article-title><source>Nucleic Acids Research</source><volume>44</volume><fpage>D48</fpage><lpage>D50</lpage><pub-id pub-id-type="doi">10.1093/nar/gkv1323</pub-id><pub-id pub-id-type="pmid">26657633</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>De Maio</surname><given-names>N</given-names></name><name><surname>Walker</surname><given-names>C</given-names></name><name><surname>Borges</surname><given-names>R</given-names></name><name><surname>Weilguny</surname><given-names>L</given-names></name><name><surname>Slodkowicz</surname><given-names>G</given-names></name><name><surname>Goldman</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Masking strategies for SARS-CoV-2 alignments</article-title><ext-link ext-link-type="uri" xlink:href="https://virological.org/t/masking-strategies-for-sars-cov-2-alignments/480">https://virological.org/t/masking-strategies-for-sars-cov-2-alignments/480</ext-link><date-in-citation iso-8601-date="2022-11-23">November 23, 2022</date-in-citation></element-citation></ref><ref id="bib9"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>De Maio</surname><given-names>N</given-names></name><name><surname>Kalaghatgi</surname><given-names>P</given-names></name><name><surname>Turakhia</surname><given-names>Y</given-names></name><name><surname>Corbett-Detig</surname><given-names>R</given-names></name><name><surname>Minh</surname><given-names>BQ</given-names></name><name><surname>Goldman</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Maximum Likelihood Pandemic-Scale Phylogenetics</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2022.03.22.485312</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edgar</surname><given-names>RC</given-names></name><name><surname>Taylor</surname><given-names>J</given-names></name><name><surname>Lin</surname><given-names>V</given-names></name><name><surname>Altman</surname><given-names>T</given-names></name><name><surname>Barbera</surname><given-names>P</given-names></name><name><surname>Meleshko</surname><given-names>D</given-names></name><name><surname>Lohr</surname><given-names>D</given-names></name><name><surname>Novakovsky</surname><given-names>G</given-names></name><name><surname>Buchfink</surname><given-names>B</given-names></name><name><surname>Al-Shayeb</surname><given-names>B</given-names></name><name><surname>Banfield</surname><given-names>JF</given-names></name><name><surname>de la Peña</surname><given-names>M</given-names></name><name><surname>Korobeynikov</surname><given-names>A</given-names></name><name><surname>Chikhi</surname><given-names>R</given-names></name><name><surname>Babaian</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Petabase-scale sequence alignment catalyses viral discovery</article-title><source>Nature</source><volume>602</volume><fpage>142</fpage><lpage>147</lpage><pub-id pub-id-type="doi">10.1038/s41586-021-04332-2</pub-id><pub-id pub-id-type="pmid">35082445</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Federhen</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The NCBI taxonomy database</article-title><source>Nucleic Acids Research</source><volume>40</volume><fpage>D136</fpage><lpage>D143</lpage><pub-id pub-id-type="doi">10.1093/nar/gkr1178</pub-id><pub-id pub-id-type="pmid">22139910</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hadfield</surname><given-names>J</given-names></name><name><surname>Megill</surname><given-names>C</given-names></name><name><surname>Bell</surname><given-names>SM</given-names></name><name><surname>Huddleston</surname><given-names>J</given-names></name><name><surname>Potter</surname><given-names>B</given-names></name><name><surname>Callender</surname><given-names>C</given-names></name><name><surname>Sagulenko</surname><given-names>P</given-names></name><name><surname>Bedford</surname><given-names>T</given-names></name><name><surname>Neher</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Nextstrain: real-time tracking of pathogen evolution</article-title><source>Bioinformatics</source><volume>34</volume><fpage>4121</fpage><lpage>4123</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bty407</pub-id><pub-id pub-id-type="pmid">29790939</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Han</surname><given-names>MV</given-names></name><name><surname>Zmasek</surname><given-names>CM</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>PhyloXML: XML for evolutionary biology and comparative genomics</article-title><source>BMC Bioinformatics</source><volume>10</volume><elocation-id>356</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2105-10-356</pub-id><pub-id pub-id-type="pmid">19860910</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heguy</surname><given-names>A</given-names></name><name><surname>Dimartino</surname><given-names>D</given-names></name><name><surname>Marier</surname><given-names>C</given-names></name><name><surname>Zappile</surname><given-names>P</given-names></name><name><surname>Guzman</surname><given-names>E</given-names></name><name><surname>Duerr</surname><given-names>R</given-names></name><name><surname>Wang</surname><given-names>G</given-names></name><name><surname>Plitnick</surname><given-names>J</given-names></name><name><surname>Russell</surname><given-names>A</given-names></name><name><surname>Lamson</surname><given-names>DM</given-names></name><name><surname>St George</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Amplification artifact in SARS-CoV-2 Omicron sequences carrying P681R mutation, New York, USA</article-title><source>Emerging Infectious Diseases</source><volume>28</volume><fpage>881</fpage><lpage>883</lpage><pub-id pub-id-type="doi">10.3201/eid2804.220146</pub-id><pub-id pub-id-type="pmid">35130474</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Hodcroft</surname><given-names>EB</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Covariants: SARS-CoV-2 mutations and variants of interest</article-title><ext-link ext-link-type="uri" xlink:href="https://covariants.org/">https://covariants.org/</ext-link><date-in-citation iso-8601-date="2022-11-22">November 22, 2022</date-in-citation></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huerta-Cepas</surname><given-names>J</given-names></name><name><surname>Dopazo</surname><given-names>J</given-names></name><name><surname>Gabaldón</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>ETE: a python environment for tree exploration</article-title><source>BMC Bioinformatics</source><volume>11</volume><fpage>1</fpage><lpage>7</lpage><pub-id pub-id-type="doi">10.1186/1471-2105-11-24</pub-id><pub-id pub-id-type="pmid">20070885</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huson</surname><given-names>DH</given-names></name><name><surname>Richter</surname><given-names>DC</given-names></name><name><surname>Rausch</surname><given-names>C</given-names></name><name><surname>Dezulian</surname><given-names>T</given-names></name><name><surname>Franz</surname><given-names>M</given-names></name><name><surname>Rupp</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Dendroscope: an interactive viewer for large phylogenetic trees</article-title><source>BMC Bioinformatics</source><volume>8</volume><elocation-id>460</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2105-8-460</pub-id><pub-id pub-id-type="pmid">18034891</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Letunic</surname><given-names>I</given-names></name><name><surname>Bork</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Interactive tree of life (iTOL) V5: an online tool for phylogenetic tree display and annotation</article-title><source>Nucleic Acids Research</source><volume>49</volume><fpage>W293</fpage><lpage>W296</lpage><pub-id pub-id-type="doi">10.1093/nar/gkab301</pub-id><pub-id pub-id-type="pmid">33885785</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Jstree</data-title><version designator="0.1">0.1</version><source>Lh3lh3</source><ext-link ext-link-type="uri" xlink:href="http://lh3lh3.users.sourceforge.net/jstree.shtml">http://lh3lh3.users.sourceforge.net/jstree.shtml</ext-link></element-citation></ref><ref id="bib20"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>McBroome</surname><given-names>J</given-names></name><name><surname>Thornlow</surname><given-names>B</given-names></name><name><surname>Hinrichs</surname><given-names>AS</given-names></name><name><surname>De Maio</surname><given-names>N</given-names></name><name><surname>Goldman</surname><given-names>N</given-names></name><name><surname>Haussler</surname><given-names>D</given-names></name><name><surname>Corbett-Detig</surname><given-names>R</given-names></name><name><surname>Turakhia</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2021">2021a</year><article-title>Matutils: Tools to Interpret and Manipulate Mutation Annotated Trees</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.04.03.438321</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McBroome</surname><given-names>J</given-names></name><name><surname>Thornlow</surname><given-names>B</given-names></name><name><surname>Hinrichs</surname><given-names>AS</given-names></name><name><surname>Kramer</surname><given-names>A</given-names></name><name><surname>De Maio</surname><given-names>N</given-names></name><name><surname>Goldman</surname><given-names>N</given-names></name><name><surname>Haussler</surname><given-names>D</given-names></name><name><surname>Corbett-Detig</surname><given-names>R</given-names></name><name><surname>Turakhia</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2021">2021b</year><article-title>A daily-updated database and tools for comprehensive SARS-CoV-2 mutation-annotated trees</article-title><source>Molecular Biology and Evolution</source><volume>38</volume><fpage>5819</fpage><lpage>5824</lpage><pub-id pub-id-type="doi">10.1093/molbev/msab264</pub-id><pub-id pub-id-type="pmid">34469548</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McBroome</surname><given-names>J</given-names></name><name><surname>Martin</surname><given-names>J</given-names></name><name><surname>de Bernardi Schneider</surname><given-names>A</given-names></name><name><surname>Turakhia</surname><given-names>Y</given-names></name><name><surname>Corbett-Detig</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Identifying SARS-CoV-2 regional introductions and transmission clusters in real time</article-title><source>Virus Evolution</source><volume>8</volume><elocation-id>veac048</elocation-id><pub-id pub-id-type="doi">10.1093/ve/veac048</pub-id><pub-id pub-id-type="pmid">35769891</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Mears</surname><given-names>HV</given-names></name><name><surname>Young</surname><given-names>GR</given-names></name><name><surname>Sanderson</surname><given-names>T</given-names></name><name><surname>Harvey</surname><given-names>R</given-names></name><name><surname>Crawford</surname><given-names>M</given-names></name><name><surname>Snell</surname><given-names>DM</given-names></name><name><surname>Fowler</surname><given-names>AS</given-names></name><name><surname>Hussain</surname><given-names>S</given-names></name><name><surname>Nicod</surname><given-names>J</given-names></name><name><surname>Peacock</surname><given-names>TP</given-names></name><name><surname>Emmott</surname><given-names>E</given-names></name><name><surname>Finsterbusch</surname><given-names>K</given-names></name><name><surname>Luptak</surname><given-names>J</given-names></name><name><surname>Wall</surname><given-names>E</given-names></name><name><surname>Williams</surname><given-names>B</given-names></name><name><surname>Gandhi</surname><given-names>S</given-names></name><name><surname>Swanton</surname><given-names>C</given-names></name><name><surname>Bauer</surname><given-names>DL</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Emergence of New Subgenomic MRNAs in SARS-CoV-2</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2022.04.20.488895</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Minh</surname><given-names>BQ</given-names></name><name><surname>Schmidt</surname><given-names>HA</given-names></name><name><surname>Chernomor</surname><given-names>O</given-names></name><name><surname>Schrempf</surname><given-names>D</given-names></name><name><surname>Woodhams</surname><given-names>MD</given-names></name><name><surname>von Haeseler</surname><given-names>A</given-names></name><name><surname>Lanfear</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>IQ-TREE 2: new models and efficient methods for phylogenetic inference in the genomic era</article-title><source>Molecular Biology and Evolution</source><volume>37</volume><fpage>1530</fpage><lpage>1534</lpage><pub-id pub-id-type="doi">10.1093/molbev/msaa015</pub-id><pub-id pub-id-type="pmid">32011700</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moshiri</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>TreeSwift: a massively scalable python tree package</article-title><source>SoftwareX</source><volume>11</volume><elocation-id>100436</elocation-id><pub-id pub-id-type="doi">10.1016/j.softx.2020.100436</pub-id><pub-id pub-id-type="pmid">35903557</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O’Toole</surname><given-names>Á</given-names></name><name><surname>Scher</surname><given-names>E</given-names></name><name><surname>Underwood</surname><given-names>A</given-names></name><name><surname>Jackson</surname><given-names>B</given-names></name><name><surname>Hill</surname><given-names>V</given-names></name><name><surname>McCrone</surname><given-names>JT</given-names></name><name><surname>Colquhoun</surname><given-names>R</given-names></name><name><surname>Ruis</surname><given-names>C</given-names></name><name><surname>Abu-Dahab</surname><given-names>K</given-names></name><name><surname>Taylor</surname><given-names>B</given-names></name><name><surname>Yeats</surname><given-names>C</given-names></name><name><surname>du Plessis</surname><given-names>L</given-names></name><name><surname>Maloney</surname><given-names>D</given-names></name><name><surname>Medd</surname><given-names>N</given-names></name><name><surname>Attwood</surname><given-names>SW</given-names></name><name><surname>Aanensen</surname><given-names>DM</given-names></name><name><surname>Holmes</surname><given-names>EC</given-names></name><name><surname>Pybus</surname><given-names>OG</given-names></name><name><surname>Rambaut</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Assignment of epidemiological lineages in an emerging pandemic using the pangolin tool</article-title><source>Virus Evolution</source><volume>7</volume><elocation-id>veab064</elocation-id><pub-id pub-id-type="doi">10.1093/ve/veab064</pub-id><pub-id pub-id-type="pmid">34527285</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rambaut</surname><given-names>A</given-names></name><name><surname>Holmes</surname><given-names>EC</given-names></name><name><surname>O’Toole</surname><given-names>Á</given-names></name><name><surname>Hill</surname><given-names>V</given-names></name><name><surname>McCrone</surname><given-names>JT</given-names></name><name><surname>Ruis</surname><given-names>C</given-names></name><name><surname>du Plessis</surname><given-names>L</given-names></name><name><surname>Pybus</surname><given-names>OG</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A dynamic nomenclature proposal for sars-cov-2 lineages to assist genomic epidemiology</article-title><source>Nature Microbiology</source><volume>5</volume><fpage>1403</fpage><lpage>1407</lpage><pub-id pub-id-type="doi">10.1038/s41564-020-0770-5</pub-id><pub-id pub-id-type="pmid">32669681</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sagulenko</surname><given-names>P</given-names></name><name><surname>Puller</surname><given-names>V</given-names></name><name><surname>Neher</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>TreeTime: maximum-likelihood phylodynamic analysis</article-title><source>Virus Evolution</source><volume>4</volume><elocation-id>vex042</elocation-id><pub-id pub-id-type="doi">10.1093/ve/vex042</pub-id><pub-id pub-id-type="pmid">29340210</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Sanderson</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Chronumental: Time Tree Estimation from Very Large Phylogenies</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.10.27.465994</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanderson</surname><given-names>T</given-names></name><name><surname>Barrett</surname><given-names>JC</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Variation at spike position 142 in SARS-CoV-2 Delta genomes is a technical artifact caused by dropout of a sequencing amplicon</article-title><source>Wellcome Open Research</source><volume>6</volume><elocation-id>305</elocation-id><pub-id pub-id-type="doi">10.12688/wellcomeopenres.17295.1</pub-id><pub-id pub-id-type="pmid">35634532</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="report"><person-group person-group-type="author"><name><surname>Sanderson</surname><given-names>T</given-names></name><name><surname>De Maio</surname><given-names>N</given-names></name><name><surname>Hinrichs</surname><given-names>AS</given-names></name><name><surname>Bernardi Schneider</surname><given-names>A d.</given-names></name><name><surname>Walker</surname><given-names>C</given-names></name><name><surname>Goldman</surname><given-names>N</given-names></name><name><surname>Turakhia</surname><given-names>Y</given-names></name><name><surname>Lanfear</surname><given-names>R</given-names></name><name><surname>Corbett-Detig</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2021">2021</year><source>Systematic errors associated with some implementations of ARTIC v4 and a fast workflow to prescreen samples for new problematic sites</source><publisher-name>Virological.org</publisher-name></element-citation></ref><ref id="bib32"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Sanderson</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Taxonium source code</data-title><version designator="v2.85">v2.85</version><source>Zenodo</source><ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.7351577">https://doi.org/10.5281/zenodo.7351577</ext-link></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shu</surname><given-names>Y</given-names></name><name><surname>McCauley</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>GISAID: global initiative on sharing all influenza data-from vision to reality</article-title><source>Euro Surveillance</source><volume>22</volume><elocation-id>13</elocation-id><pub-id pub-id-type="doi">10.2807/1560-7917.ES.2017.22.13.30494</pub-id><pub-id pub-id-type="pmid">28382917</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Thornlow</surname><given-names>B</given-names></name><name><surname>Kramer</surname><given-names>A</given-names></name><name><surname>Ye</surname><given-names>C</given-names></name><name><surname>De Maio</surname><given-names>N</given-names></name><name><surname>McBroome</surname><given-names>J</given-names></name><name><surname>Hinrichs</surname><given-names>AS</given-names></name><name><surname>Lanfear</surname><given-names>R</given-names></name><name><surname>Turakhia</surname><given-names>Y</given-names></name><name><surname>Corbett-Detig</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Online Phylogenetics Using Parsimony Produces Slightly Better Trees and Is Dramatically More Efficient for Large SARS-Cov-2 Phylogenies than de Novo and Maximum-Likelihood Approaches</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.12.02.471004</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Tsueng</surname><given-names>G</given-names></name><name><surname>Mullen</surname><given-names>JL</given-names></name><name><surname>Alkuzweny</surname><given-names>M</given-names></name><name><surname>Cano</surname><given-names>M</given-names></name><name><surname>Rush</surname><given-names>B</given-names></name><name><surname>Haag</surname><given-names>E</given-names></name><name><surname>Latif</surname><given-names>AA</given-names></name><name><surname>Zhou</surname><given-names>X</given-names></name><name><surname>Qian</surname><given-names>Z</given-names></name><name><surname>Hufbauer</surname><given-names>E</given-names></name><name><surname>Zeller</surname><given-names>M</given-names></name><name><surname>Andersen</surname><given-names>KG</given-names></name><name><surname>Wu</surname><given-names>C</given-names></name><name><surname>Su</surname><given-names>AI</given-names></name><name><surname>Gangavarapu</surname><given-names>K</given-names></name><name><surname>Hughes</surname><given-names>LD</given-names></name><collab>Outbreak Curators</collab></person-group><year iso-8601-date="2022">2022</year><article-title>Outbreak.Info Research Library: A Standardized, Searchable Platform to Discover and Explore Covid-19 Resources</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2022.01.20.477133</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turakhia</surname><given-names>Y</given-names></name><name><surname>Thornlow</surname><given-names>B</given-names></name><name><surname>Hinrichs</surname><given-names>AS</given-names></name><name><surname>De Maio</surname><given-names>N</given-names></name><name><surname>Gozashti</surname><given-names>L</given-names></name><name><surname>Lanfear</surname><given-names>R</given-names></name><name><surname>Haussler</surname><given-names>D</given-names></name><name><surname>Corbett-Detig</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Ultrafast sample placement on existing trees (UShER) enables real-time phylogenetics for the SARS-CoV-2 pandemic</article-title><source>Nature Genetics</source><volume>53</volume><fpage>809</fpage><lpage>816</lpage><pub-id pub-id-type="doi">10.1038/s41588-021-00862-7</pub-id><pub-id pub-id-type="pmid">33972780</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Tyson</surname><given-names>JR</given-names></name><name><surname>James</surname><given-names>P</given-names></name><name><surname>Stoddart</surname><given-names>D</given-names></name><name><surname>Sparks</surname><given-names>N</given-names></name><name><surname>Wickenhagen</surname><given-names>A</given-names></name><name><surname>Hall</surname><given-names>G</given-names></name><name><surname>Choi</surname><given-names>JH</given-names></name><name><surname>Lapointe</surname><given-names>H</given-names></name><name><surname>Kamelian</surname><given-names>K</given-names></name><name><surname>Smith</surname><given-names>AD</given-names></name><name><surname>Prystajecky</surname><given-names>N</given-names></name><name><surname>Goodfellow</surname><given-names>I</given-names></name><name><surname>Wilson</surname><given-names>SJ</given-names></name><name><surname>Harrigan</surname><given-names>R</given-names></name><name><surname>Snutch</surname><given-names>TP</given-names></name><name><surname>Loman</surname><given-names>NJ</given-names></name><name><surname>Quick</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Improvements to the ARTIC Multiplex PCR Method for SARS-Cov-2 Genome Sequencing Using Nanopore</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.09.04.283077</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="software"><person-group person-group-type="author"><collab>Uber</collab></person-group><year iso-8601-date="2016">2016</year><data-title>Deck.gl: WebGL2 powered geospatial visualization layers</data-title><version designator="b673f40">b673f40</version><source>Github</source><ext-link ext-link-type="uri" xlink:href="https://github.com/visgl/deck.gl">https://github.com/visgl/deck.gl</ext-link></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wohl</surname><given-names>S</given-names></name><name><surname>Schaffner</surname><given-names>SF</given-names></name><name><surname>Sabeti</surname><given-names>PC</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Genomic analysis of viral outbreaks</article-title><source>Annual Review of Virology</source><volume>3</volume><fpage>173</fpage><lpage>195</lpage><pub-id pub-id-type="doi">10.1146/annurev-virology-110615-035747</pub-id><pub-id pub-id-type="pmid">27501264</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.82392.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Neher</surname><given-names>Richard A</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02s6k3f65</institution-id><institution>University of Basel</institution></institution-wrap><country>Switzerland</country></aff></contrib></contrib-group><related-object id="sa0ro1" object-id-type="id" object-id="10.1101/2022.06.03.494608" link-type="continued-by" xlink:href="https://sciety.org/articles/activity/10.1101/2022.06.03.494608"/></front-stub><body><p>Sanderson developed novel interactive software for visualizing phylogenetic trees representing millions of sequences. This is a fundamental advance over previous software that is typically limited to trees with a few thousand tips. Taxonium has been used intensively by the virus evolution community over the past months and has thus already proven its utility and performance.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.82392.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Neher</surname><given-names>Richard A</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02s6k3f65</institution-id><institution>University of Basel</institution></institution-wrap><country>Switzerland</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Neher</surname><given-names>Richard A</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02s6k3f65</institution-id><institution>University of Basel</institution></institution-wrap><country>Switzerland</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Poon</surname><given-names>Art FY</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02grkyz14</institution-id><institution>Western University</institution></institution-wrap><country>Canada</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Hadfield</surname><given-names>James</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/007ps6h72</institution-id><institution>Fred Hutchinson Cancer Research Center</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2022.06.03.494608">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2022.06.03.494608v3">the preprint</ext-link> for the benefit of readers; ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Exploration of million-sequence viral phylogenies with Taxonium&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, including Richard A Neher as Reviewing Editor and Reviewer #1, and the evaluation has been overseen by a Reviewing Editor and Neil Ferguson as the Senior Editor. The following individuals involved in the review of your submission have agreed to reveal their identity: Art FY Poon (Reviewer #2); James Hadfield (Reviewer #3).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>All reviewers agreed that Taxonium enables the interactive exploration of phylogenies orders of magnitude larger than what was possible before and represents an urgently needed technological advance given the large volume of SARS-CoV-2 data that was generated over the last 3 years. The reviewer comments mostly represent clarifications and suggestions for a more precise description of the tool, its scientific context, or prior work. The most essential revision is the following:</p><p>We would like to see a more detailed description of the &quot;sparsification&quot; algorithm. How are the tips selected that is being rendered? how does this interact with the search? Could this (possibly as in future development) be made dependent on metadata (hosts, geography)?</p><p>In addition to improvements to the manuscript, the reviewers have identified a number of points that might be useful to consider during the future development of Taxonium.</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>Terminology: the term &quot;nodes&quot; is used in the manuscript to represent tips (as far as I can tell), whereas this typically refers to both internal nodes and terminal nodes (tips).</p><p>Examples: &quot;Taxonium scales to trees with millions of nodes' and &quot;NextStrain analyses are typically limited to ~4,000 nodes&quot;. I suggest changing to &quot;tips&quot; or &quot;terminal nodes&quot;.</p><p>The introduction talks about 11 million sequences, but Cov2Tree only uses the NCBI set (~6 million). I presume this is due to GISAID data-sharing conditions and not a technical limitation of Taxonium. This is a delicate situation however it was strange to introduce the former but then present the latter.</p><p>The following points should be thought of as suggestions to improve Taxonium rather than requirements for publication:</p><p>– A legend to explain the colours is needed – you essentially add this in Figure 3 but it should be part of the software.</p><p>– Panning of trees (x + y direction) is intuitive but it's easy to get lost and pan the tree off the screen! It should be possible to prevent panning outside the bounds of the tree.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.82392.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>Terminology: the term &quot;nodes&quot; is used in the manuscript to represent tips (as far as I can tell), whereas this typically refers to both internal nodes and terminal nodes (tips).</p><p>Examples: &quot;Taxonium scales to trees with millions of nodes' and &quot;NextStrain analyses are typically limited to ~4,000 nodes&quot;. I suggest changing to &quot;tips&quot; or &quot;terminal nodes&quot;.</p></disp-quote><p>Thank you for pointing this out. I have changed the Nextstrain sentence to refer to sequences, and am sorry for that error. (I have also belatedly corrected my mis-capitalisation of Nextstrain in the final manuscript file!) I then went through the manuscript and considered each use of the word &quot;node&quot;, making some changes. I suspect I have kept more of the bare term &quot;node&quot; than you might prefer. The way in which Taxonium is implemented means that terminal and non-terminal nodes behave in almost exactly the same way. Although in Cov2Tree they are not, internal nodes can be associated with metadata, and can (using the settings cog) be coloured by that metadata. Limitations on tree size relate more with the total number of nodes than the number of tips. That is the rationale for describing things in those terms, but I do also see that readers have a better intuition for tip-number. In general for the polytomous SARS-CoV-2 trees that we consider here the numbers are surprisingly similar.</p><disp-quote content-type="editor-comment"><p>The introduction talks about 11 million sequences, but Cov2Tree only uses the NCBI set (~6 million). I presume this is due to GISAID data-sharing conditions and not a technical limitation of Taxonium. This is a delicate situation however it was strange to introduce the former but then present the latter.</p></disp-quote><p>This is a fair point. Taxonium has been designed to scale to the full size of datasets available globally (i.e. including GISAID sequences as well as those from INSDC). A number of groups are privately using Taxonium in that way. In the updated manuscript I have added a paragraph on the newly developed Electron-implementation of Taxonium and there I discuss loading a tree with 12M nodes, which may help with this point.</p><disp-quote content-type="editor-comment"><p>The following points should be thought of as suggestions to improve Taxonium rather than requirements for publication:</p><p>– A legend to explain the colours is needed – you essentially add this in Figure 3 but it should be part of the software.</p></disp-quote><p>Thank you for flagging this. (As you'll be aware,) this isn't completely trivial because e.g. there are more than 2,000 PANGO lineages and in theory almost all could be semi-visible on the initial load of the SARS-CoV-2 tree. But it's also not impossible: one would count the number of each colour, and sort from the most frequent, truncating at some point. I will track this in https://github.com/theosanderson/taxonium/issues/438.</p><disp-quote content-type="editor-comment"><p>– Panning of trees (x + y direction) is intuitive but it's easy to get lost and pan the tree off the screen! It should be possible to prevent panning outside the bounds of the tree.</p></disp-quote><p>That's a great idea. I will track this in https://github.com/theosanderson/taxonium/issues/439.</p></body></sub-article></article>