<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">73760</article-id><article-id pub-id-type="doi">10.7554/eLife.73760</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group></article-categories><title-group><article-title>Comprehensive and unbiased multiparameter high-throughput screening by compaRe finds effective and subtle drug responses in AML models</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-254641"><name><surname>Chalabi Hajkarim</surname><given-names>Morteza</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2039-2676</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-254642"><name><surname>Karjalainen</surname><given-names>Ella</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9865-5384</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-254643"><name><surname>Osipovitch</surname><given-names>Mikhail</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-254644"><name><surname>Dimopoulos</surname><given-names>Konstantinos</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-254645"><name><surname>Gordon</surname><given-names>Sandra L</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0270-8291</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-254646"><name><surname>Ambri</surname><given-names>Francesca</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1999-9294</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-254647"><name><surname>Rasmussen</surname><given-names>Kasper Dindler</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7344-4177</contrib-id><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-254648"><name><surname>Grønbæk</surname><given-names>Kirsten</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1535-9601</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-137079"><name><surname>Helin</surname><given-names>Kristian</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-131223"><name><surname>Wennerberg</surname><given-names>Krister</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1352-4220</contrib-id><email>krister.wennerberg@bric.ku.dk</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con10"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-254649"><name><surname>Won</surname><given-names>Kyoung-Jae</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2924-9630</contrib-id><email>kyoung.won@bric.ku.dk</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con11"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/035b05819</institution-id><institution>Biotech Research and Innovation Centre (BRIC) and Novo Nordisk Foundation Center for Stem Cell Biology (DanStem), University of Copenhagen</institution></institution-wrap><addr-line><named-content content-type="city">Copenhagen</named-content></addr-line><country>Denmark</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/040af2s02</institution-id><institution>Institute for Molecular Medicine Finland (FIMM), Helsinki Institute of Life Science, University of Helsinki</institution></institution-wrap><addr-line><named-content content-type="city">Helsinki</named-content></addr-line><country>Finland</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03mchdq19</institution-id><institution>Rigshospitalet</institution></institution-wrap><addr-line><named-content content-type="city">Copenhagen</named-content></addr-line><country>Denmark</country></aff><aff id="aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03h2bxq36</institution-id><institution>Centre for Gene Regulation and Expression, School of Life Sciences, University of Dundee</institution></institution-wrap><addr-line><named-content content-type="city">Dundee</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02yrq0923</institution-id><institution>Cell Biology Program and Center for Epigenetics Research, Memorial Sloan Kettering Cancer Center (MSKCC)</institution></institution-wrap><addr-line><named-content content-type="city">New York</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02feahw73</institution-id><institution>CNRS LPENS</institution></institution-wrap><country>France</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02feahw73</institution-id><institution>CNRS LPENS</institution></institution-wrap><country>France</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>15</day><month>02</month><year>2022</year></pub-date><pub-date pub-type="collection"><year>2022</year></pub-date><volume>11</volume><elocation-id>e73760</elocation-id><history><date date-type="received" iso-8601-date="2021-09-09"><day>09</day><month>09</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2022-02-14"><day>14</day><month>02</month><year>2022</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at bioRxiv.</event-desc><date date-type="preprint" iso-8601-date="2021-01-09"><day>09</day><month>01</month><year>2021</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2021.01.08.425880"/></event></pub-history><permissions><copyright-statement>© 2022, Chalabi Hajkarim et al</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>Chalabi Hajkarim et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-73760-v3.pdf"/><abstract><p>Large-scale multiparameter screening has become increasingly feasible and straightforward to perform thanks to developments in technologies such as high-content microscopy and high-throughput flow cytometry. The automated toolkits for analyzing similarities and differences between large numbers of tested conditions have not kept pace with these technological developments. Thus, effective analysis of multiparameter screening datasets becomes a bottleneck and a limiting factor in unbiased interpretation of results. Here we introduce compaRe, a toolkit for large-scale multiparameter data analysis, which integrates quality control, data bias correction, and data visualization methods with a mass-aware gridding algorithm-based similarity analysis providing a much faster and more robust analyses than existing methods. Using mass and flow cytometry data from acute myeloid leukemia and myelodysplastic syndrome patients, we show that compaRe can reveal interpatient heterogeneity and recognizable phenotypic profiles. By applying compaRe to high-throughput flow cytometry drug response data in AML models, we robustly identified multiple types of both deep and subtle phenotypic response patterns, highlighting how this analysis could be used for therapeutic discoveries. In conclusion, compaRe is a toolkit that uniquely allows for automated, rapid, and precise comparisons of large-scale multiparameter datasets, including high-throughput screens.</p></abstract><abstract abstract-type="executive-summary"><title>eLife digest</title><p>Biology has seen huge advances in technology in recent years. This has led to state-of-the-art techniques which can test hundreds of conditions simultaneously, such as how cancer cells respond to different drugs. In addition to this, each of the tens of thousands of cells studied can be screened for multiple variables, such as certain proteins or genes. This generates massive datasets with large numbers of parameters, which researchers can use to find similarities and differences between the tested conditions.</p><p>Analyzing these ‘high-throughput’ experiments, however, is no easy task, as the data is often contaminated with meaningless information, or ‘background noise’, as well as sources of bias, such as non-biological variations between experiments. As a result, most analysis methods can only probe one parameter at a time, or are unautomated and require manual interpretation of the data.</p><p>Here, Chalabi Hajkarim et al. have developed a new toolkit that can analyze multiparameter datasets faster and more robustly than current methods. The kit, which was named ‘compaRe’, combines a range of computational tools that automatically ‘clean’ the data of background noise or bias: the different conditions are then compared and any similarities are visually displayed using a graphical interface that is easy to explore.</p><p>Chalabi Hajkarim et al. used their new method to study data from patients with acute myeloid leukemia (AML) and myelodysplastic syndrome, two forms of cancer that disrupt the production of functional immune cells. The toolkit was able to identify subtle differences between the patients and categorize them into groups based on the proteins present on immune cells.</p><p>Chalabi Hajkarim et al. also applied compaRe to high-throughput data on cells from patients and mouse models with AML that had been treated with large numbers of specific drugs. This revealed that different cell types in the samples responded to the treatments in distinct ways.</p><p>These findings suggest that the toolkit created by Chalabi Hajkarim et al. can automatically, rapidly and precisely compare large multiparameter datasets collected using high-throughput screens. In the future, compaRe could be used to identify drugs that illicit a specific response, or to predict how newly developed treatments impact different cell types in the body.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>high-throughput screening</kwd><kwd>high-content screening</kwd><kwd>drug dose response analysis</kwd><kwd>AML</kwd><kwd>single cell</kwd><kwd>drug discovery</kwd><kwd>sample clustering</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd><kwd>Mouse</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100009708</institution-id><institution>Novo Nordisk Foundation</institution></institution-wrap></funding-source><award-id>NNF17CC0027852</award-id><principal-award-recipient><name><surname>Grønbæk</surname><given-names>Kirsten</given-names></name><name><surname>Helin</surname><given-names>Kristian</given-names></name><name><surname>Wennerberg</surname><given-names>Krister</given-names></name><name><surname>Won</surname><given-names>Kyoung-Jae</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008363</institution-id><institution>Kræftens Bekæmpelse</institution></institution-wrap></funding-source><award-id>R223‐A13071</award-id><principal-award-recipient><name><surname>Grønbæk</surname><given-names>Kirsten</given-names></name><name><surname>Helin</surname><given-names>Kristian</given-names></name><name><surname>Wennerberg</surname><given-names>Krister</given-names></name><name><surname>Won</surname><given-names>Kyoung-Jae</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003554</institution-id><institution>Lundbeck Foundation</institution></institution-wrap></funding-source><award-id>R313-2019-421</award-id><principal-award-recipient><name><surname>Won</surname><given-names>Kyoung-Jae</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>compaRe can be used to optimize cytometric high-parameter immunophenotypic characterization of heterogeneous cell populations.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Technological developments have accelerated the generation of large-scale multiparameter screening data through methodologies such as high-content microscopy and high-throughput flow cytometry (<xref ref-type="bibr" rid="bib6">Boutros et al., 2015</xref>; <xref ref-type="bibr" rid="bib27">Saeys et al., 2016</xref>; <xref ref-type="bibr" rid="bib9">Caraus et al., 2015</xref>). These technologies can test hundreds of samples (such as drug treatments) each with tens of thousands of events (e.g. cells) labeled for numerous biomarkers (such as cytoplasmic or membrane markers). However, analyzing this massive multiparameter data to provide an overview of similarities and differences between hundreds of samples is still a challenge (<xref ref-type="bibr" rid="bib6">Boutros et al., 2015</xref>; <xref ref-type="bibr" rid="bib27">Saeys et al., 2016</xref>; <xref ref-type="bibr" rid="bib9">Caraus et al., 2015</xref>). This analytical challenge is further complicated by various sources of bias and noise often existing in the data, such as batch effect and signal drift (a gradual shift in the marker intensity across a multi-well plate) (<xref ref-type="bibr" rid="bib6">Boutros et al., 2015</xref>; <xref ref-type="bibr" rid="bib27">Saeys et al., 2016</xref>; <xref ref-type="bibr" rid="bib9">Caraus et al., 2015</xref>).</p><p>There have been efforts to cluster samples from large-scale multiparameter (multidimensional) screening data. A simple approach is to use a representative value for each cell marker such as median fluorescence intensity (MFI) for clustering samples (<xref ref-type="bibr" rid="bib12">Cossarizza et al., 2019</xref>). However, using a single representative value can easily lead to loss of information about biologically relevant variance within and between cell subpopulations. Meta-clustering with single-cell clustering algorithms has been suggested to cluster samples based on the similarity of the centroids of cell subpopulations identified in the individual samples (<xref ref-type="bibr" rid="bib26">Qiu et al., 2011</xref>; <xref ref-type="bibr" rid="bib20">Levine et al., 2015</xref>; <xref ref-type="bibr" rid="bib29">Van Gassen et al., 2015</xref>; <xref ref-type="bibr" rid="bib24">Ogishi et al., 2021</xref>). While these algorithms are widely used in single-cell data analysis for clustering cells, they are not efficient for clustering of samples. This is because centroid-based analysis can be misleading when subclusters are not sufficiently distinct or the number of sub-clusters varies. Additionally, the heavy computing cost of meta-clustering makes it poorly suited for analyses of large datasets with many samples. Manual gating and machine learning based on prior knowledge have been used to cluster samples (<xref ref-type="bibr" rid="bib3">Amir et al., 2019</xref>; <xref ref-type="bibr" rid="bib8">Bruggner et al., 2014</xref>), but using prior knowledge for subpopulation identification can both lead to biased interpretations and failure to make de novo discoveries. Dimension reduction methods (<xref ref-type="bibr" rid="bib21">Lvd and Hinton, 2008</xref>; <xref ref-type="bibr" rid="bib2">Amir et al., 2013</xref>; <xref ref-type="bibr" rid="bib22">McInnes et al., 2018</xref>) coupled with the Jensen-Shannon divergence (JSD) metric have also been used to cluster multidimensional samples (<xref ref-type="bibr" rid="bib2">Amir et al., 2013</xref>). These algorithms including factor analysis and principal component analysis (PCA) still require excessive computing costs with an inherent information loss. It is also important to note that none of the methodologies developed so far efficiently correct for sources of bias and noise in large-scale multiparameter screening data.</p><p>Available computational toolkits (<xref ref-type="bibr" rid="bib4">BioScience E, 2020</xref>; <xref ref-type="bibr" rid="bib25">Potdar et al., 2020</xref>; <xref ref-type="bibr" rid="bib5">Boutros et al., 2006</xref>) mostly allow for single-parameter or unautomated analyses of large-scale screening data using the aforementioned methods. In these toolkits, each well should be first represented by a single parameter such as cell counts or centroids or they require manual intervention. To provide a useful toolkit for precise and effective interpretation of small- to large-scale multiparameter screening data, we developed compaRe. This toolkit has several unique modules for quality control, bias correction, pairwise comparisons, clustering, and data visualization. The quality control and bias correction modules can effectively reveal and remove various sources of bias in the screening data. compaRe clusters samples by measuring the similarity between them using a dynamic mass-aware gridding algorithm. This algorithm increases the robustness of the toolkit to the size of data and signal shift (a technical term referring to batch effect and signal drift), while guaranteeing fast clustering, as it does not bear the computing cost of dimension reduction and subsampling. The toolkit is available both as a command-line version and a graphical user interface (GUI) version that provides various visualizations to help with the interpretation of its readouts.</p><p>compaRe performed robustly in the presence of background noise and batch effects even where these input data artifacts could not be corrected. compaRe analyses of multiparameter mass and flow cytometric data from acute myeloid leukemia (AML) and myelodysplastic syndrome (MDS) patient samples revealed interpatient heterogeneity and recognizable phenotypic profiles. When applied to high-throughput flow cytometry of the dose response of AML samples treated with various drugs, compaRe successfully corrected for various sources of bias and clustered the samples based on their response to treatment, allowing for detection of both drastic and subtle phenotypic responses.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>compaRe is a comprehensive toolkit for multiparameter screening data</title><p>compaRe is designed to analyze the data from small to large-scale multiparameter screening assays such as high-throughput flow cytometry, high-content microscopy, mass cytometry, and standard flow cytometry. The toolkit comprises several modules for quality control, bias correction, clustering, and visualization. <xref ref-type="fig" rid="fig1">Figure 1</xref> shows the modules for a high-throughput flow cytometry of AML samples taken from a mouse model treated with various drugs. During quality control, several sources of bias such as autofluorescence, bioluminescence, carryover effect, edge effect, signal drift, and cell viability drift (drift in the number of live cells across the plate) were identified. The bias correction module could effectively correct for signal and cell viability drifts (two main sources of bias in high-throughput screening with fluorescent markers) using regression analysis (<xref ref-type="fig" rid="fig1">Figure 1</xref>, Materials and methods).</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>compaRe is a comprehensive suite for multiparameter screening data.</title><p>High-throughput flow cytometry generates massive multidimensional data from hundreds of samples. compaRe’s quality control (QC) module reveals several sources of bias in the assay such as signal (intensity difference between the top left and bottom right corners) and cell viability drifts. These two are corrected for in the bias correction modules within and between the plates. compaRe performs a pairwise similarity calculation between the samples using dynamic gridding and forming hypercubes (represented by distinct colors). The portions of the data within individual hypercubes are used to calculate similarity. Clustering is performed based on similarity. The graphical user interface (GUI) provides several ways to thoroughly explore and visualize the read-outs.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-fig1-v3.tif"/></fig><p>At the core of the compaRe toolkit is a module for pairwise comparisons of samples. It measures the similarity between two samples using a dynamic mass-aware gridding algorithm (<xref ref-type="fig" rid="fig1">Figure 1</xref>, Materials and methods). Given two samples, the algorithm divides the higher dimensional space (formed by, for example, cell surface markers) of the samples individually into several spatial units called hypercubes. The average difference between proportions of data points present in corresponding hypercubes across the samples is used to represent similarity. In this setting, the module becomes robust to signal shift and data size difference between the two samples (Appendix 1). This module generates a similarity (affinity) matrix for the clustering module.</p><p>The clustering module uses a graphical algorithm (<xref ref-type="fig" rid="fig1">Figure 1</xref>, Materials and methods). Initially, all nodes (samples) are connected forming a complete weighted graph wherein weights represent similarity values. The graph is then pruned to remove potential false positive edges using a threshold inferred from negative controls (untreated samples). After constructing a linked graph, clustering is tantamount to finding maximal cliques (complete subgraphs that cannot be extended), each containing samples with similar responses. compaRe benefits from parallel computing and modular design. Its modular design allows the modules to run independently; thus, the similarity and clustering modules of compaRe can be potentially applied to any problem space.</p></sec><sec id="s2-2"><title>compaRe is ultra-fast and robust to background noise and batch effect</title><p>To evaluate the robustness of compaRe’s comparison module to noise and batch effect, we benchmarked it against JSD with UMAP (for simplicity just JSD) and meta-clustering with PhenoGraph (for simplicity just meta-clustering) (<xref ref-type="bibr" rid="bib20">Levine et al., 2015</xref>). We analyzed the publicly available mass cytometry data of a total of 21 bone marrow aspirate samples collected from 16 pediatric AML patients and five healthy adult donors labeled for detection of 16 cell surface markers (<xref ref-type="bibr" rid="bib20">Levine et al., 2015</xref>). We introduced random noise with Gaussian distribution to the 16 parameters of each sample to simulate a batch effect. In this setting, although the added noise undermines similarity, the overall cell population configuration remains intact, and consequently the simulated samples will still have the highest similarity with their original samples.</p><p>Even with the added noise, the comparison module correctly identified similar samples (<xref ref-type="fig" rid="fig2">Figure 2a</xref>). Conversely, the batch effect seriously compromised the performance of both meta-clustering and JSD, showing several maximum similarities other than the originals (<xref ref-type="fig" rid="fig2">Figure 2b and C</xref>). In additional comparison with FlowSOM and SPADE, other commonly used tools for flow cytometry, compaRe’s performance far exceeded their performance (<xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>). This result demonstrates the advantage of using dynamic gridding for comparison of samples in the presence of noise or batch effect.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>compaRe robustly measures the similarity between samples in the presence of batch effect.</title><p>Similarity matrix generated by compaRe is shown in (<bold>a</bold>). Size and color of dots represent the level of similarity. Self-comparisons were removed. Noise was added (marked with *) to the original 21 mass cytometry samples of bone marrow aspirates from 16 pediatric AML patients (S) and five healthy adult donors (H). Similarity matrices using JSD with UMAP and meta-clustering with PhenoGraph are shown in (<bold>b</bold>) and (<bold>c</bold>), respectively. The run time of comparing each sample to itself is shown in (<bold>d</bold>). Samples were sorted based on their size.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-fig2-v3.tif"/></fig><p>Notably, compaRe took only 25 min to analyze the 21 samples (210 pairwise comparisons), without subsampling or dimension reduction. Meanwhile, meta-clustering and JSD took 39 hr and 10 hr respectively. For the feasibility of JSD, we subsampled each sample to 100,000 cells (default value suggested in <xref ref-type="bibr" rid="bib2">Amir et al., 2013</xref>). When we fixed this limit to 60% of each sample, the computing time of JSD increased to 3 days. To investigate the relation between run time and sample size, we compared each sample to itself and sorted measured times based on sample size (<xref ref-type="fig" rid="fig2">Figure 2d</xref>). The run time increased steeply for both meta-clustering and JSD as the sample size increased, while the increase for compaRe was almost unnoticeable.</p><p>To further show that compaRe can identify phenotypic changes from a high-dimensional dataset, we used a subset of the data with three healthy and two AML samples stained with 29 (15 membrane and 14 intracellular signaling) markers (<xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref>). Taking H1 as reference, we gradually removed 25%, 50%, 75%, and 100% of cells from a target cluster identified by PhenoGraph. The gradual removal can be regarded as a phenotypic change and the 75% reduction can potentially resemble a rare cell population (a small cluster of cells). As shown in the UMAP projections<bold>,</bold> the similarity decreased concurrently and more drastically after 100% reduction when phenotypic changes were detected, indicating compaRe is sensitive to phenotypic changes and the existence of rare cell populations.</p></sec><sec id="s2-3"><title>compaRe reveals interpatient similarity</title><p>Non-AML myeloid neoplasias such as MDS can evolve to become AML. Over time, about one-third of all MDS cases develop into AML (<xref ref-type="bibr" rid="bib13">DeVita and Lawrence, 2015</xref>; <xref ref-type="bibr" rid="bib23">Niederhuber et al., 2020</xref>). The risk of developing AML largely depends on the MDS subtype at the time of diagnosis, with high-risk MDS developing into AML more often than the lower-risk MDS subtypes (<xref ref-type="bibr" rid="bib16">Greenberg et al., 2012</xref>). As many immunophenotypic abnormalities are not unique to MDS, several diagnostic flow cytometric antibody panels have been proposed (<xref ref-type="bibr" rid="bib28">van Dongen et al., 2012</xref>; <xref ref-type="bibr" rid="bib1">Alhan et al., 2016</xref>). The EuroFlow AML/MDS antibody panel (<xref ref-type="bibr" rid="bib28">van Dongen et al., 2012</xref>) aims at the parallel identification and categorization of AML and MDS. Both diseases are heterogeneous, affecting multiple cell lineages and multiple maturation stages. Therefore, this panel concerns major myeloid lineages (neutrophilic, monocytic and erythroid) and the detection of abnormal lymphoid maturation profiles in four tubes. The panel uses four backbone markers to identify myeloblasts and an additional set of 15 markers devoted to the characterization of myeloid lineages (<xref ref-type="supplementary-material" rid="supp1 supp2">Supplementary files 1 and 2</xref>).</p><p>Unlike the backbone markers, the characterization markers are divided into each tube exclusively. This design was made so that characterization markers from different tubes can be inferred on the same backbone marker subpopulations, but the design makes it impossible to form a multiparameter dataset which is required for clustering methods. However, as compaRe’s comparison module can compare cell population morphologies even in subspaces, we were able to use it to measure similarities between patient samples.</p><p>We analyzed 25 bone marrow mononuclear cell samples collected from 16 MDS patients and 9 AML patients (<xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref>). The comparison module provided a detailed overview of similarities of samples. As expected, the AML samples exhibited a great amount of interpatient heterogeneity compared to the MDS samples (<xref ref-type="fig" rid="fig3">Figure 3a and b</xref>) with all MDS samples clustered together, and the AML samples spread over three clusters. To verify the performance of the module, we visualized the pairwise comparisons using UMAP projection (<xref ref-type="fig" rid="fig3">Figure 3c</xref> and <xref ref-type="fig" rid="app1fig3">Appendix 1—figures 3</xref>–<xref ref-type="fig" rid="app1fig26">26</xref>). The measured similarities perfectly matched the projections so that from top left to bottom right, as the similarity decreases, the degree of overlap decreases, and the number of exclusive cell populations increases.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>compaRe highlights immunophenotypic similarities.</title><p>(<bold>a</bold>) The similarity band plot visualizes the similarity between a sample specified by its row (band) and other samples measured by compaRe (H: higher-risk MDS, L: lower-risk MDS and A: AML). Each band was independently transformed by an exponential function to emphasize the highest and the lowest similarity values. (<bold>b</bold>) A graphical representation of the similarities. The graph nodes (samples) were clustered by a random walk. (<bold>c</bold>) The UMAP projection of A1 sample against the other patient samples is provided as an example. The other projections are given in <xref ref-type="fig" rid="app1fig3">Appendix 1—figures 3</xref>–<xref ref-type="fig" rid="app1fig26">26</xref>. The projections were sorted based on similarity.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-fig3-v3.tif"/></fig><p>We further investigated how different the three groups of the AML samples were (<xref ref-type="fig" rid="fig4">Figure 4</xref> and <xref ref-type="fig" rid="app1fig27">Appendix 1—figure 27</xref>). AML samples 1 and 9 of the blue cluster were confirmed to have a high degree of monocytic differentiation with marked expression of the monocytic maturation markers CD14, CD35, CD64, and CD300e. The AML samples of the green cluster, on the other hand, represented a cluster of poorly differentiated AML cases with low expression of differentiation markers and high expression of the stem cell/progenitor markers CD34 and CD117. Unlike the blue cluster with high monocytic differentiation, and the green cluster with poor monocytic differentiation, the AML samples 2 and 5 of the red cluster included both positive and negative populations of CD11b which is a common granulocytic and monocytic maturity marker, a feature observed in all MDS samples as well (<xref ref-type="fig" rid="app1fig27">Appendix 1—figure 27</xref>).</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Immunophenotypic profiles of two different groups of AML patients.</title><p>Each row shows the UMAP projection of AML samples 1 and 9 (red and orange) vs AML samples 3, 4, 6-8 (blue) of the green cluster of <xref ref-type="fig" rid="fig3">Figure 3b</xref> stained by the markers available in each tube.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-fig4-v3.tif"/></fig><p>In conclusion, compaRe’s comparison module can be used to optimize true cytometric n-dimensional immunophenotypic characterization of patient samples. Interpretation can then be performed in a conventional manner assisted by lower-dimensional projection tools such as PCA and UMAP that promptly provide a phenotypic profile of the patient samples.</p></sec><sec id="s2-4"><title>Identifying cell-subtype-specific drug responses in mouse AML cells</title><p>We applied compaRe to high-throughput flow cytometry data to identify cell subtype-specific responses evoked by antineoplastic agents in leukemic spleen cells from an AML mouse model. Splenic cells were sorted for c-Kit cell surface expression, allowing for the enrichment of stem/progenitor-type leukemic cells. On ex vivo expansion, these cells continuously expand and differentiate in a similar way as in vivo with a clear stem cell/progenitor population and partial differentiation towards CD11b/Gr-1 or CD16/CD32-expressing myeloid cells. After ex vivo expansion, the leukemic cells were plated onto multi-well plates containing a library of 116 antineoplastic agents including surface and nuclear receptor inhibitors and activators, enzyme inhibitors and, cytotoxic chemotherapy in a five-point concentration range, as well as 20 negative control wells (<xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>). After 72 hr of drug exposure, we stained the cells with fluorescently labeled antibodies against three cell surface markers (CD16/32, Gr-1 and CD11b) and quantified cell surface marker expression using a high-throughput flow cytometer.</p><p>compaRe corrected the intraplate signal drift, sources of bias in cell numbers, as well as inter-plate sources of bias (<xref ref-type="fig" rid="app1fig28">Appendix 1—figure 28</xref>). After clustering and clique analysis, we obtained 134 cliques, each sharing similar drug responses (<xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref>).</p><p>To get an overview of the assay, we generated a dispersion map of the clusters (<xref ref-type="fig" rid="fig5">Figure 5a and b</xref> and Materials and methods). We identified a distinct response group characterized with decreased Gr-1 and concomitant increase of CD16/CD32 as compared to control (Group one in <xref ref-type="fig" rid="fig5">Figure 5a</xref>). Most of the cliques included in this response group consisted of drugs in high concentrations with cytotoxic/cytostatic effects. However, some drugs in this group had a milder effect on live cell numbers, and these were enriched for mitogen-activated protein kinase (MAPK) pathway-associated inhibitors (<xref ref-type="fig" rid="fig5">Figure 5c</xref>, <xref ref-type="supplementary-material" rid="supp6">Supplementary file 6</xref>). For instance, trametinib (2.5 nM) in clique 23 (C23) showed a marked decrease of Gr-1 and increase of CD16/CD32, further confirming the results of compaRe (<xref ref-type="fig" rid="fig5">Figure 5d</xref>). The MAPK pathway is a regulator of diverse cellular processes such as proliferation, survival, differentiation, and motility (<xref ref-type="bibr" rid="bib14">Dhillon et al., 2007</xref>). Our findings suggest that MAPK signaling controls the differentiation and/or proliferation towards Gr-1-/CD16+ cells.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>compaRe analysis identifies several distinct cell subtype-specific responses in a high-throughput flow cytometry screening of mouse AML cells.</title><p>(<bold>a</bold>) A UMAP plot of cliques identified by compaRe. Cliques are colored by Gr-1 and CD16/CD32 MFIs. Group one is characterized with reduced Gr-1 and increased CD16/CD32 as compared with control. Group two has increased Gr-1 expression compared with control. (<bold>b</bold>) Heatmap of marker MFIs. Values are normalized between 0 and 1 per marker to make cross-comparisons possible. Cliques containing control, trametinib (2.5 nM) (<bold>C23</bold>), molibresib and birabresib (C100 and C110), and vincristine (<bold>C80</bold>) are marked. (<bold>c</bold>) Waterfall plot of compounds belonging to response group 1, showing live cell count as a percentage of control treatment (DMSO). (<bold>d</bold>) Density scatter plots for Control (DMSO), C23, C100, and C80.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-fig5-v3.tif"/></fig><p>In high concentration, molibresib and birabresib, inhibitors of BET proteins BRD2, BRD3, and BRD4, caused a reduction in live cell counts but also a reduction of MFI in all the measured markers, which corresponds to the loss of differentiation marker positive cells (Gr-1+, CD11b+, CD16/CD32 high) (<xref ref-type="fig" rid="fig5">Figure 5b</xref>: C100, C110, <xref ref-type="fig" rid="fig5">Figure 5d</xref>). The BRD2/3/4 proteins regulate transcription via recognition of acetylated lysines on histones and concomitant recruitment of other transcription and chromatin remodeling factors to enhance transcriptional activity (<xref ref-type="bibr" rid="bib15">Ferri et al., 2016</xref>). The enrichment of undifferentiated cells could therefore be due to an early block in differentiation or that inhibition of BRD2/3/4 has led to a general decrease of cell surface protein transcription.</p><p>In this cell model, the leukemic stem-like cells are expected to be present within the differentiation marker negative population. These cells are potential targets for treatments against leukemia. We observed response group 2 (<xref ref-type="fig" rid="fig5">Figure 5a</xref>) had a higher MFI in marker Gr-1 as compared to control, the increase was very slight and seemed to be linked to toxic drug concentrations. However, three drugs, vincristine (C80), tazemetostat, and tretinoin clearly reduced the proportion of differentiation marker negative cells (<xref ref-type="fig" rid="fig5">Figure 5d</xref>). Interestingly, these three drugs have distinct modes of action: vincristine is a microtubule polymerization inhibitor, tazemetostat inhibits the histone methyltransferase EZH2, and tretinoin is a retinoic acid receptor agonist (<xref ref-type="supplementary-material" rid="supp6">Supplementary file 6</xref>).</p><p>Taken together, compaRe analysis of the high-throughput flow cytometry screening data allowed rapid identification of several distinct phenotypic responses in this mouse AML model, as well as the cellular signals that drive them. Drugs of different mechanism of action can still cluster together if the cellular processes they affect converge in a specific model. Drug response in association with genetic alterations can be one of the applications of compaRe. The genetic alteration could be visualized in the clusters that compaRe identifies.</p></sec><sec id="s2-5"><title>Identifying highly selective signal transduction inhibitors in human AML cells</title><p>We further applied compaRe to the drug screening data from an AML patient sample. Primary AML bone marrow mononuclear cells were dispensed into a 384-multiwell plate containing a library of 40 drugs and drug combinations in seven-point concentration ranges (<xref ref-type="supplementary-material" rid="supp7">Supplementary file 7</xref>). After 72 hr of drug exposure, the cells were stained with fluorescently labeled antibodies against a panel of AML-related cell surface markers (CD45, CD34, CD38, CD117, HLA-DR, CD45-RA, CD3 and a mix of myeloid differentiation-related markers). A high-throughput flow cytometer was used to quantify cell surface marker expression.</p><p>compaRe analysis identified several distinct response groups (<xref ref-type="fig" rid="fig6">Figure 6a</xref>, <xref ref-type="supplementary-material" rid="supp8">Supplementary file 8</xref>). Response group one had notably higher MFIs in the CD34 and CD38 channels compared to controls. Interestingly, the increase in MFIs was due to a drug concentration-dependent appearance of a CD34+/CD38+ cell population that was barely detectable in the DMSO control samples (<xref ref-type="fig" rid="fig6">Figure 6b</xref>). The appearance of this CD34+/CD38+ population was also concomitant to a general increase in live cell count (<xref ref-type="fig" rid="fig6">Figure 6c</xref>). Altogether, seven different drugs had the same effect (<xref ref-type="fig" rid="fig6">Figure 6d</xref>), most of them being selective signal transduction inhibitors such as trametinib (MEK inhibitor), copanlisib (PI3K inhibitor), and PIM447 (PIM kinase inhibitor).</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Identification of drugs that induce expansion of CD34+/CD38+ cells in an AML patient sample.</title><p>(<bold>a</bold>) UMAP of cliques identified by compaRe. Cliques are colored by CD34 and CD38 MFIs. Response groups of interest are indicated using a dashed line. (<bold>b</bold>) Example of response group 1: density scatter plot of markers CD34 and CD38 in different concentrations of PIM kinase inhibitor PIM447. (<bold>c</bold>) Count of live cells after 72 hr exposure to different concentrations of PIM kinase inhibitor PIM447. (<bold>d</bold>) Table of drugs that induced expansion of the CD34+/CD38+ cell population.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-fig6-v3.tif"/></fig><p>Response group 2 consisted of two drugs: birabresib and lenalidomide in different concentrations. These induced a decrease in the MFI of CD45-RA and CD45 channels (<xref ref-type="fig" rid="app1fig29">Appendix 1—figure 29a</xref>). In the case of lenalidomide, this response was likely due to cell toxicity and/or growth inhibition (<xref ref-type="fig" rid="app1fig29">Appendix 1—figure 29b</xref>). Interestingly, the birabresib response was very pronounced without the loss of live cell numbers, (<xref ref-type="fig" rid="app1fig29">Appendix 1—figure 29b</xref>) but with a decrease in the MFI in the cell differentiation marker mix channel (<xref ref-type="fig" rid="app1fig29">Appendix 1—figure 29c</xref>).</p><p>compaRe also detected response group three as distinct from the controls. This group includes treatment with tretinoin (several concentrations), navitoclax, and mitoxantrone (low dose). Further validation showed the phenotypic response in group three is subtle but with a distinct increase in CD34+ cells (<xref ref-type="fig" rid="app1fig29">Appendix 1—figure 29d</xref>). This result highlights compaRe analysis is sensitive enough to identify these subtle changes.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Technological advancements in multiparameter high-throughput screening have enabled testing thousands of biological conditions in a short amount of time. This requires algorithmic development to analyze the large amount of data generated by such technologies. We developed an automated comprehensive toolkit, compaRe, for robust analysis of small- to large-scale multidimensional screening data with several modules for quality control, bias correction, comparison, clustering, and visualization.</p><p>The toolkit is unique in many ways. Its quality control and bias correction modules can correct for signal and cell viability drifts in large-scale fluorescence-based screening assays using regression analysis. Its comparison module utilizes a dynamic mass-aware gridding algorithm, which substantially reduces the computing cost and provides robustness to signal shift (batch effect and signal drift). Alternative approaches such as meta-clustering and JSD require both sub-sampling of the data, with the possible loss of valuable subpopulations, and considerably more computing time.</p><p>We tested the robustness of the comparison module to batch effect and noise through simulation. The module effectively circumvented the batch effect while JSD and meta-clustering significantly suffered from it. The poor accuracy of meta-clustering demonstrates the drawback of using cluster centroids for similarity comparison across samples while the poor performance of JSD indicates that this approach can work well only in the absence of signal shift. It is of particular note that compaRe does not need subsampling or dimension reduction of the input data.</p><p>Multiparameter cytometric analysis of immunophenotypes of AML and MDS patient samples by the comparison module coupled with the EuroFlow AML/MDS antibody panel revealed interpatient heterogeneity and recognizable phenotypic profiles. Even though EuroFlow markers are divided into several discrete tubes, compaRe’s comparison module can compare the cell population distribution to measure similarities between patient samples.</p><p>We investigated several types of responses evoked by different doses of antineoplastic agents in two high-throughput flow cytometry screening assays of an AML mouse model and an AML human patient. We could identify subtle but distinct phenotypic drug-induced changes. We also identified drugs with different mechanism of action but similar responses. In general, we showed that drugs will cluster together if the cellular processes they affect converge in a specific model.</p><p>The quality control and bias correction modules could successfully correct for signal and cell viability drifts in these studies. In our explored assays, signal drift was obviously associated with the order in which wells were read. It was caused by the time differences in antibody incubation across the plate as the high-throughput flow cytometer requires more than one hour to sample all wells in a 384-well plate. For high-density assay plate formats with large numbers of wells, this can cause gradual incremental influences in intensity and cell viability. Therefore, when aligning wells along the order that the flow cytometer sampled the wells, we found a linear trend in MFIs. We benefited from regression analysis to remove the effect of signal shifts.</p><p>During the analyses, the compaRe toolkit made it easy to explore and compare highly complex datasets in a substantially reduced timeline. It is equipped with multithreading and can run through command-line interface on a computer server or GUI on a desktop. The GUI provides the investigator with numerous interactive visualization tools including cell staining, graphical representation, and gating. In sum, it provides a total package for fast, accurate, and readily interpretable multiparameter screening data analysis.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Mass cytometry of healthy and pediatric AML bone marrow aspirates</title><p>Mass cytometry dataset for 21 samples labeled with 16 surface markers collected from 16 pediatric AML patients obtained at diagnosis and five healthy adult donors (<xref ref-type="bibr" rid="bib20">Levine et al., 2015</xref>) were downloaded from Cytobank Community with the experiment ID <ext-link ext-link-type="uri" xlink:href="https://community.cytobank.org/cytobank/experiments/44185">44185</ext-link>. There are 378 FCS files in this experiment with one FCS file for each of 21 patients for each of 17 conditions (two basal replicates and 16 perturbations). All FCS files from a single patient had been pooled then clustered with the PhenoGraph algorithm. Each file includes a column named PhenoGraph that specifies the PhenoGraph cluster to which each event was assigned as an integer. A value of 0 indicates no cluster was assigned because the cells were identified as outliers during some stage of analysis. Using the PhenoGraph column, we determined centroids of cell clusters, and used PhenoGraph to meta-cluster them as described in <xref ref-type="bibr" rid="bib20">Levine et al., 2015</xref> To generate the similarity matrix, we adapted an approach similar to that of compaRe such that each meta-cluster as a spatial unit was treated like a hypercube. We set compaRe’s <italic>n</italic> to four for this assay (Materials and methods and Appendix 1).</p></sec><sec id="s4-2"><title>High-throughput flow cytometry of AML mouse model</title><p>AML primary splenic cells from Npm1<sup>+/cA</sup> (<xref ref-type="bibr" rid="bib30">Vassiliou et al., 2011</xref>); Flt3<sup>+/ITD</sup> (<xref ref-type="bibr" rid="bib19">Lee et al., 2007</xref>); Dnmt3a<sup>+/-</sup> (<xref ref-type="bibr" rid="bib17">Kaneda et al., 2004</xref>) Mx1-Cre+ (<xref ref-type="bibr" rid="bib18">Kühn et al., 1995</xref>) moribund mice were sorted for c-Kit positivity and expanded ex vivo. AML cells were treated with a library of 116 chemotherapy and immunotherapy antineoplastic agents in a five-point concentration range (<xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>). Treated samples were stained with three informative cell surface antibodies (<xref ref-type="supplementary-material" rid="supp9">Supplementary file 9</xref>) and fluorescence was detected using a high-throughput flow cytometer iQue Screener Plus (Intellicyt). We set compaRe’s <italic>n</italic> to five for this assay.</p></sec><sec id="s4-3"><title>High-throughput flow cytometry of an AML human patient sample</title><p>Mononuclear cells were isolated from a donated human bone marrow aspirate from an AML patient (Danish National Ethical committee/National Videnskabsetisk Komité permit 1705391). The cells were treated with a library of 40 chemotherapy and targeted antineoplastic agents in a seven-point concentration range (<xref ref-type="supplementary-material" rid="supp7">Supplementary file 7</xref>) for 72 hr. Cells were subsequently incubated with fluorescently labeled antibodies targeting 11 informative cell surface proteins in eight fluorescence channels (<xref ref-type="supplementary-material" rid="supp10">Supplementary file 10</xref>). Samples were read using a high-throughput flow cytometer (iQue Screener Plus, Intellicyt). We set compaRe’s <italic>n</italic> to three for this assay.</p></sec><sec id="s4-4"><title>Flow cytometry of AML and MDS patients</title><p>Clinical flow cytometry data using a slightly modified AML panel as described by the Euroflow Consortium (<xref ref-type="bibr" rid="bib28">van Dongen et al., 2012</xref>) from 25 bone marrow aspirates from MDS and AML patients from Rigshospitalet (Copenhagen, DK) were used for analysis. Each sample was analyzed using a total of four tubes (Euroflow AML panel tubes 1–4) with eight antibodies in each tube (<xref ref-type="supplementary-material" rid="supp1 supp2">Supplementary files 1 and 2</xref>). Acquisition of data was performed on a FACS Canto (Becton Dickinson Immunocytometry Systems), and data analysis was done in the Infinicyt software (Cytognos, Salamanca, Spain). We set compaRe’s <italic>n</italic> to five for this assay.</p></sec><sec id="s4-5"><title>Quality control (QC)</title><p>Multiwell plate heatmaps of medians come in handy in QC to reveal issues such as signal and cell viability drifts occurring during screening. However, as a typical heatmap has an equally spaced color palette, small but significant differences between wells may be obscured and not visible. Therefore, we normalized the color palette by the distribution of the medians. Also, before clustering, we removed outliers in the negative controls that were different from the others in terms of similarity values measured by compaRe.</p></sec><sec id="s4-6"><title>Correcting signal and cell viability drifts</title><p>Depending on the protocol by which wells are processed, time may become a major concern so that some specific wells may have lower or higher values than expected. To correct for these sources of bias, we employed a two-step correction: intra-plate shift (signal drift) correction and inter-plate shift (batch effect) correction. For a given plate, we first fit a linear regression model and then vertically translate points (well values) with respect to the learned line as it rotates to the slope zero. After correcting for the intra-plate bias, the inter-plate bias is corrected by aligning medians of the plates, that is, translating to a common baseline.</p></sec><sec id="s4-7"><title>Similarity calculation using dynamic gridding</title><p>To measure the similarity between two datasets, compaRe divides each dimension into <italic>n</italic> subsets for each dataset individually so that a dataset with <italic>d</italic> dimensions (markers) will be gridded into at most <italic>n<sup>d</sup></italic> spatial units called hypercubes. compaRe grids only the part of the space encompassing data points, avoiding empty regions. It then measures the proportion of data points for either dataset within each of the corresponding hypercubes. The difference between the two proportions is indicative of the similarity within that relative spatial position represented by each hypercube. The similarity in the exclusive hypercubes is considered 0. We employed local outlier factor (<xref ref-type="bibr" rid="bib7">Breunig et al., 2000</xref>) for anomaly detection and removing noise cells. Averaging these differences across all the hypercubes indicates the amount of similarity between the two datasets.</p><p>compaRe captures the configuration of data enabling it to measure similarity even without correcting for signal drift or batch effect (Appendix 1). This way, two technical replicates analyzed by two different instruments or configurations suffering from signal shift will still have the highest similarity. To generate a similarity matrix of multiple input samples, compaRe runs in parallel. The similarity matrix could then be used for identifying clusters of samples such as drugs with similar dose responses.</p></sec><sec id="s4-8"><title>Graphical clustering of samples</title><p>To cluster samples, we developed a graphical clustering algorithm in which initially all nodes (samples) are connected forming a weighted complete graph wherein edges represent similarity between nodes. This graph is then pruned to remove potential false positive edges for a given cutoff inferred from negative controls. The optimal cutoff turns out to be the minimum weight in the maximum spanning tree of negative control nodes. After pruning, some samples may end up being connected to the negative controls (biologically inactive agents) and some disconnected (active agents). After constructing this graph, clustering is tantamount to finding maximal cliques among potent agents. In addition to maximal cliques, it also reports communities (a clique is a subset of a community). Communities can be seen as loose clusters. In a community, unlike a clique, similarity is not necessarily transitive meaning that if A is similar to B and B is similar to C, A is not necessarily similar to C. If these were three drugs within a community, concluding they had an equal response was not necessarily right unless they would form a clique.</p></sec><sec id="s4-9"><title>Dispersion graph and Dispersion map</title><p>compaRe visualizes the similarity of samples in the form of a dispersion graph by constructing their maximum spanning tree (Appendix 1, <xref ref-type="fig" rid="app1fig30">Appendix 1—figure 30</xref>). compaRe also uses UMAP to represent a dispersion map of clusters. The map is constructed using the centroid (median) of each clique. An informative map shows different groups by coloring the centroids according to their value. These groups are mostly the identified communities the cliques come from.</p></sec><sec id="s4-10"><title>Availability of data</title><p>Mass cytometry datasets were downloaded from Cytobank Community with the experiment ID <ext-link ext-link-type="uri" xlink:href="https://community.cytobank.org/cytobank/experiments/44185">44185</ext-link>. AML mouse and human high-throughput flow cytometry data have been deposited in FLOWRepository with the repository IDs <ext-link ext-link-type="uri" xlink:href="https://flowrepository.org/id/FR-FCM-Z357">FR-FCM-Z357</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://flowrepository.org/id/FR-FCM-Z3DP">FR-FCM-Z3DP</ext-link> respectively. Flow cytometry data of AML and MDS patients have been deposited in FLOWRepository with the repository ID <ext-link ext-link-type="uri" xlink:href="https://flowrepository.org/id/FR-FCM-Z3ET">FR-FCM-Z3ET</ext-link>. Acquisition, installation and more technical details are available in compaRe’s online tutorial on (<ext-link ext-link-type="uri" xlink:href="https://github.com/morchalabi/COMPARE-suite">https://github.com/morchalabi/COMPARE-suite</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:8b04b06555f2b4f0f101fe7a81370490ea4bc716;origin=https://github.com/morchalabi/COMPARE-suite;visit=swh:1:snp:d16f3aa6ccb9d4fb3376349ac274c35126d465e2;anchor=swh:1:rev:df2feaf6aa982e0f6f077eb85f26acce6bb61063">swh:1:rev:df2feaf6aa982e0f6f077eb85f26acce6bb61063</ext-link>, <xref ref-type="bibr" rid="bib11">Chalabi, 2022b</xref>). Similarity measurement and clustering modules as stand-alone tools have been merged into a separate R package and are available for download at (<ext-link ext-link-type="uri" xlink:href="https://github.com/morchalabi/compaRe">https://github.com/morchalabi/compaRe</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:1eca481c73534a790d4d35abe319416477cd1553;origin=https://github.com/morchalabi/compaRe;visit=swh:1:snp:3317f51ce45717efc76ca5cd76dfd1d036200c39;anchor=swh:1:rev:594106b1e34c17b405064f1a0f9fb39975a4ec79">swh:1:rev:594106b1e34c17b405064f1a0f9fb39975a4ec79</ext-link>, <xref ref-type="bibr" rid="bib10">Chalabi, 2022a</xref>).</p></sec></sec></body><back><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Formal analysis, Methodology, Software, Validation, Visualization, Writing – original draft, Writing – review and editing, conceived, designed, and wrote the study with equal contribution</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Formal analysis, Methodology, Validation, Writing – original draft, Writing – review and editing, conceived, designed, and wrote the study with equal contribution</p></fn><fn fn-type="con" id="con3"><p>Software, developed the GUI</p></fn><fn fn-type="con" id="con4"><p>Data curation, Validation, assembled and annotated clinical cytometry data and assisted in its analysis</p></fn><fn fn-type="con" id="con5"><p>Data curation, Formal analysis, Validation, Writing – original draft, designed and completed the AML patient sample drug screening, Writing – review and editing</p></fn><fn fn-type="con" id="con6"><p>Data curation, Formal analysis, Validation, designed and completed the AML patient sample drug screening</p></fn><fn fn-type="con" id="con7"><p>Methodology, generated the mouse cell models, Writing – review and editing</p></fn><fn fn-type="con" id="con8"><p>Funding acquisition, Supervision, assembled and annotated clinical cytometry data and assisted in its analysis, Writing – review and editing</p></fn><fn fn-type="con" id="con9"><p>Funding acquisition, Supervision, generated the mouse cell models</p></fn><fn fn-type="con" id="con10"><p>Conceptualization, Funding acquisition, Investigation, Methodology, Project administration, Supervision, Validation, Writing – original draft, conceived, designed, and wrote the study with equal contribution, Writing – review and editing</p></fn><fn fn-type="con" id="con11"><p>Conceptualization, Funding acquisition, Investigation, Methodology, Project administration, Supervision, Validation, Writing – original draft, conceived, designed, and wrote the study with equal contribution, Writing – review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Human subjects: The informed consent, and consent to publish of patient samples in this study has been approved by the Danish National Science Ethics Committee/National Videnskabsetisk Komite: Målrettet behandling af patienter med blodsygdomme, license no. 1705391.</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>EuroFlow antibody panel for AML and MDS.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-73760-supp1-v3.xlsx"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>Antibodies used by compaRe in the AML/MDS study.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-73760-supp2-v3.xlsx"/></supplementary-material><supplementary-material id="supp3"><label>Supplementary file 3.</label><caption><title>Clinical reports of the patients in the AML/MDS study.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-73760-supp3-v3.xlsx"/></supplementary-material><supplementary-material id="supp4"><label>Supplementary file 4.</label><caption><title>Drug panel of the AML mouse model study.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-73760-supp4-v3.xlsx"/></supplementary-material><supplementary-material id="supp5"><label>Supplementary file 5.</label><caption><title>Drug clusters identified by compaRe in the AML mouse model study.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-73760-supp5-v3.xlsx"/></supplementary-material><supplementary-material id="supp6"><label>Supplementary file 6.</label><caption><title>Mechanism of action of the response group one in <xref ref-type="fig" rid="fig5">Figure 5c</xref>.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-73760-supp6-v3.xlsx"/></supplementary-material><supplementary-material id="supp7"><label>Supplementary file 7.</label><caption><title>Drug panel of the AML human sample study.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-73760-supp7-v3.xlsx"/></supplementary-material><supplementary-material id="supp8"><label>Supplementary file 8.</label><caption><title>Drug clusters identified by compaRe in the AML human sample study.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-73760-supp8-v3.xlsx"/></supplementary-material><supplementary-material id="supp9"><label>Supplementary file 9.</label><caption><title>Antibodies used by compaRe in the AML mouse model study.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-73760-supp9-v3.xlsx"/></supplementary-material><supplementary-material id="supp10"><label>Supplementary file 10.</label><caption><title>Antibodies used by compaRe in the AML human model study.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-73760-supp10-v3.xlsx"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-73760-transrepform1-v3.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Mass cytometry datasets were downloaded from Cytobank Community with the experiment ID 44185. AML mouse and human high-throughput flow cytometry data have been deposited in FLOWRepository with the repository IDs FR-FCM-Z357 and FR-FCM-Z3DP respectively. Flow cytometry data of AML and MDS patients have been deposited in FLOWRepository with the repository ID FR-FCM-Z3ET. Acquisition, installation and more technical details are available in compaRe's online tutorial on (<ext-link ext-link-type="uri" xlink:href="https://github.com/morchalabi/COMPARE-suite">https://github.com/morchalabi/COMPARE-suite</ext-link>, (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:8b04b06555f2b4f0f101fe7a81370490ea4bc716;origin=https://github.com/morchalabi/COMPARE-suite;visit=swh:1:snp:d16f3aa6ccb9d4fb3376349ac274c35126d465e2;anchor=swh:1:rev:df2feaf6aa982e0f6f077eb85f26acce6bb61063">swh:1:rev:df2feaf6aa982e0f6f077eb85f26acce6bb61063</ext-link>)). Similarity measurement and clustering modules as stand-alone tools have been merged into a separate R package and are available for download at (<ext-link ext-link-type="uri" xlink:href="https://github.com/morchalabi/compaRe">https://github.com/morchalabi/compaRe</ext-link>, (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:1eca481c73534a790d4d35abe319416477cd1553;origin=https://github.com/morchalabi/compaRe;visit=swh:1:snp:3317f51ce45717efc76ca5cd76dfd1d036200c39;anchor=swh:1:rev:594106b1e34c17b405064f1a0f9fb39975a4ec79">swh:1:rev:594106b1e34c17b405064f1a0f9fb39975a4ec79</ext-link>)).</p><p>The following datasets were generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Morteza</surname><given-names>C H</given-names></name><name><surname>Ella</surname><given-names>K</given-names></name><name><surname>Mikhail</surname><given-names>O</given-names></name><name><surname>Konstantinos</surname><given-names>D</given-names></name><name><surname>Sandra</surname><given-names>L G</given-names></name><name><surname>Francesca</surname><given-names>A</given-names></name><name><surname>Kasper</surname><given-names>D R</given-names></name><name><surname>Kirsten</surname><given-names>G</given-names></name><name><surname>Kristian</surname><given-names>H</given-names></name><name><surname>Krister</surname><given-names>W</given-names></name><name><surname>Kyoung-Jae</surname><given-names>W</given-names></name></person-group> <year iso-8601-date="2021">2021</year> <data-title>AML/MDS Flow Cytometry</data-title>  <source>Flowrepository</source>  <pub-id pub-id-type="accession" xlink:href="https://flowrepository.org/id/FR-FCM-Z3ET">FR-FCM-Z3ET</pub-id></element-citation></p><p><element-citation id="dataset2" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Morteza</surname><given-names>C H</given-names></name><name><surname>Ella</surname><given-names>K</given-names></name><name><surname>Mikhail</surname><given-names>O</given-names></name><name><surname>Konstantinos</surname><given-names>D</given-names></name><name><surname>Sandra</surname><given-names>L G</given-names></name><name><surname>Francesca</surname><given-names>A</given-names></name><name><surname>Kasper</surname><given-names>D R</given-names></name><name><surname>Kirsten</surname><given-names>G</given-names></name><name><surname>Kristian</surname><given-names>H</given-names></name><name><surname>Krister</surname><given-names>W</given-names></name><name><surname>Kyoung-Jae</surname><given-names>W</given-names></name></person-group> <year iso-8601-date="2021">2021</year> <data-title>AML Mouse High-throughput Flow Cytometry</data-title>  <source>Flowrepository</source>  <pub-id pub-id-type="accession" xlink:href="https://flowrepository.org/id/FR-FCM-Z357">FR-FCM-Z357</pub-id></element-citation></p><p><element-citation id="dataset3" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Morteza</surname><given-names>C H</given-names></name><name><surname>Ella</surname><given-names>K</given-names></name><name><surname>Mikhail</surname><given-names>O</given-names></name><name><surname>Konstantinos</surname><given-names>D</given-names></name><name><surname>Sandra</surname><given-names>L G</given-names></name><name><surname>Francesca</surname><given-names>A</given-names></name><name><surname>Kasper</surname><given-names>D R</given-names></name><name><surname>Kirsten</surname><given-names>G</given-names></name><name><surname>Kristian</surname><given-names>H</given-names></name><name><surname>Krister</surname><given-names>W</given-names></name><name><surname>Kyoung-Jae</surname><given-names>W</given-names></name></person-group> <year iso-8601-date="2021">2021</year> <data-title>AML Human High-throughput Flow Cytometry</data-title>  <source>Flowrepository</source>  <pub-id pub-id-type="accession" xlink:href="https://flowrepository.org/id/FR-FCM-Z3DP">FR-FCM-Z3DP</pub-id></element-citation></p><p><element-citation id="dataset4" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Morteza</surname><given-names>CH</given-names></name></person-group> <year iso-8601-date="2022">2022</year> <data-title>Comprehensive and unbiased multiparameter high-throughput screening by compaRe finds effective and subtle drug responses in AML models</data-title>  <source>GitHub</source>  <pub-id pub-id-type="accession" xlink:href="https://github.com/morchalabi/compaRe">github.com/morchalabi/compaRe</pub-id></element-citation></p><p>The following previously published dataset was used:</p><p><element-citation id="dataset5" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Levine</surname><given-names>JH</given-names></name><name><surname>Simonds</surname><given-names>EF</given-names></name><name><surname>Bendall</surname><given-names>SC</given-names></name><name><surname>Davis</surname><given-names>KL</given-names></name><name><surname>Amir el</surname><given-names>AD</given-names></name><name><surname>Tadmor</surname><given-names>MD</given-names></name></person-group> <year iso-8601-date="2015">2015</year> <data-title>Data-Driven Phenotypic Dissection of AML Reveals Progenitor-like Cells that Correlate with Prognosis</data-title>  <source>Cytobank</source>  <pub-id pub-id-type="accession" xlink:href="https://premium.cytobank.org/cytobank/experiments">44185</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>This work was supported through Novo Nordisk Foundation (Novo Nordisk Foundation Center for Stem Cell Biology, DanStem; Grant Number NNF17CC0027852) and Danish Research Center for Precision Medicine in Blood Cancers funded by the Danish Cancer Society (Grant number R223‐A13071) and Greater Copenhagen Health Science Partners.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alhan</surname><given-names>C</given-names></name><name><surname>Westers</surname><given-names>TM</given-names></name><name><surname>Cremers</surname><given-names>EMP</given-names></name><name><surname>Cali</surname><given-names>C</given-names></name><name><surname>Witte</surname><given-names>BI</given-names></name><name><surname>Ossenkoppele</surname><given-names>GJ</given-names></name><name><surname>van de Loosdrecht</surname><given-names>AA</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The myelodysplastic syndromes flow cytometric score: a three-parameter prognostic flow cytometric scoring system</article-title><source>Leukemia</source><volume>30</volume><fpage>658</fpage><lpage>665</lpage><pub-id pub-id-type="doi">10.1038/leu.2015.295</pub-id><pub-id pub-id-type="pmid">26503643</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amir</surname><given-names>ED</given-names></name><name><surname>Davis</surname><given-names>KL</given-names></name><name><surname>Tadmor</surname><given-names>MD</given-names></name><name><surname>Simonds</surname><given-names>EF</given-names></name><name><surname>Levine</surname><given-names>JH</given-names></name><name><surname>Bendall</surname><given-names>SC</given-names></name><name><surname>Shenfeld</surname><given-names>DK</given-names></name><name><surname>Krishnaswamy</surname><given-names>S</given-names></name><name><surname>Nolan</surname><given-names>GP</given-names></name><name><surname>Pe’er</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>viSNE enables visualization of high dimensional single-cell data and reveals phenotypic heterogeneity of leukemia</article-title><source>Nature Biotechnology</source><volume>31</volume><fpage>545</fpage><lpage>552</lpage><pub-id pub-id-type="doi">10.1038/nbt.2594</pub-id><pub-id pub-id-type="pmid">23685480</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amir</surname><given-names>E-AD</given-names></name><name><surname>Lee</surname><given-names>B</given-names></name><name><surname>Badoual</surname><given-names>P</given-names></name><name><surname>Gordon</surname><given-names>M</given-names></name><name><surname>Guo</surname><given-names>XV</given-names></name><name><surname>Merad</surname><given-names>M</given-names></name><name><surname>Rahman</surname><given-names>AH</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Development of a Comprehensive Antibody Staining Database Using a Standardized Analytics Pipeline</article-title><source>Frontiers in Immunology</source><volume>10</volume><elocation-id>1315</elocation-id><pub-id pub-id-type="doi">10.3389/fimmu.2019.01315</pub-id><pub-id pub-id-type="pmid">31244854</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="book"><person-group person-group-type="author"><collab>BioScience E</collab></person-group><year iso-8601-date="2020">2020</year><source>Eliminating Data Analysis Bottlenecks with IQue Forecyt Software</source><publisher-name>Essen BioScience</publisher-name></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boutros</surname><given-names>M</given-names></name><name><surname>Brás</surname><given-names>LP</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Analysis of cell-based RNAi screens</article-title><source>Genome Biology</source><volume>7</volume><elocation-id>R66</elocation-id><pub-id pub-id-type="doi">10.1186/gb-2006-7-7-R66</pub-id><pub-id pub-id-type="pmid">16869968</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boutros</surname><given-names>M</given-names></name><name><surname>Heigwer</surname><given-names>F</given-names></name><name><surname>Laufer</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Microscopy-Based High-Content Screening</article-title><source>Cell</source><volume>163</volume><fpage>1314</fpage><lpage>1325</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.11.007</pub-id><pub-id pub-id-type="pmid">26638068</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breunig</surname><given-names>MM</given-names></name><name><surname>Kriegel</surname><given-names>HP</given-names></name><name><surname>Ng</surname><given-names>RT</given-names></name><name><surname>Sander</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>LOF: Identifying density-based local outliers</article-title><source>Sigmod Record</source><volume>29</volume><fpage>93</fpage><lpage>104</lpage><pub-id pub-id-type="doi">10.1145/335191.335388</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bruggner</surname><given-names>RV</given-names></name><name><surname>Bodenmiller</surname><given-names>B</given-names></name><name><surname>Dill</surname><given-names>DL</given-names></name><name><surname>Tibshirani</surname><given-names>RJ</given-names></name><name><surname>Nolan</surname><given-names>GP</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Automated identification of stratifying signatures in cellular subpopulations</article-title><source>PNAS</source><volume>111</volume><fpage>E2770</fpage><lpage>E2777</lpage><pub-id pub-id-type="doi">10.1073/pnas.1408792111</pub-id><pub-id pub-id-type="pmid">24979804</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caraus</surname><given-names>I</given-names></name><name><surname>Alsuwailem</surname><given-names>AA</given-names></name><name><surname>Nadon</surname><given-names>R</given-names></name><name><surname>Makarenkov</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Detecting and overcoming systematic bias in high-throughput screening technologies: a comprehensive review of practical issues and methodological solutions</article-title><source>Briefings in Bioinformatics</source><volume>16</volume><fpage>974</fpage><lpage>986</lpage><pub-id pub-id-type="doi">10.1093/bib/bbv004</pub-id><pub-id pub-id-type="pmid">25750417</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Chalabi</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2022">2022a</year><data-title>COMPARE</data-title><version designator="swh:1:rev:594106b1e34c17b405064f1a0f9fb39975a4ec79">swh:1:rev:594106b1e34c17b405064f1a0f9fb39975a4ec79</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:1eca481c73534a790d4d35abe319416477cd1553;origin=https://github.com/morchalabi/compaRe;visit=swh:1:snp:3317f51ce45717efc76ca5cd76dfd1d036200c39;anchor=swh:1:rev:594106b1e34c17b405064f1a0f9fb39975a4ec79">https://archive.softwareheritage.org/swh:1:dir:1eca481c73534a790d4d35abe319416477cd1553;origin=https://github.com/morchalabi/compaRe;visit=swh:1:snp:3317f51ce45717efc76ca5cd76dfd1d036200c39;anchor=swh:1:rev:594106b1e34c17b405064f1a0f9fb39975a4ec79</ext-link></element-citation></ref><ref id="bib11"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Chalabi</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2022">2022b</year><data-title>COMPARE-suite</data-title><version designator="swh:1:rev:df2feaf6aa982e0f6f077eb85f26acce6bb61063">swh:1:rev:df2feaf6aa982e0f6f077eb85f26acce6bb61063</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:8b04b06555f2b4f0f101fe7a81370490ea4bc716;origin=https://github.com/morchalabi/COMPARE-suite;visit=swh:1:snp:d16f3aa6ccb9d4fb3376349ac274c35126d465e2;anchor=swh:1:rev:df2feaf6aa982e0f6f077eb85f26acce6bb61063">https://archive.softwareheritage.org/swh:1:dir:8b04b06555f2b4f0f101fe7a81370490ea4bc716;origin=https://github.com/morchalabi/COMPARE-suite;visit=swh:1:snp:d16f3aa6ccb9d4fb3376349ac274c35126d465e2;anchor=swh:1:rev:df2feaf6aa982e0f6f077eb85f26acce6bb61063</ext-link></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cossarizza</surname><given-names>A</given-names></name><name><surname>Chang</surname><given-names>H-D</given-names></name><name><surname>Radbruch</surname><given-names>A</given-names></name><name><surname>Acs</surname><given-names>A</given-names></name><name><surname>Adam</surname><given-names>D</given-names></name><name><surname>Adam-Klages</surname><given-names>S</given-names></name><name><surname>Agace</surname><given-names>WW</given-names></name><name><surname>Aghaeepour</surname><given-names>N</given-names></name><name><surname>Akdis</surname><given-names>M</given-names></name><name><surname>Allez</surname><given-names>M</given-names></name><name><surname>Almeida</surname><given-names>LN</given-names></name><name><surname>Alvisi</surname><given-names>G</given-names></name><name><surname>Anderson</surname><given-names>G</given-names></name><name><surname>Andrä</surname><given-names>I</given-names></name><name><surname>Annunziato</surname><given-names>F</given-names></name><name><surname>Anselmo</surname><given-names>A</given-names></name><name><surname>Bacher</surname><given-names>P</given-names></name><name><surname>Baldari</surname><given-names>CT</given-names></name><name><surname>Bari</surname><given-names>S</given-names></name><name><surname>Barnaba</surname><given-names>V</given-names></name><name><surname>Barros-Martins</surname><given-names>J</given-names></name><name><surname>Battistini</surname><given-names>L</given-names></name><name><surname>Bauer</surname><given-names>W</given-names></name><name><surname>Baumgart</surname><given-names>S</given-names></name><name><surname>Baumgarth</surname><given-names>N</given-names></name><name><surname>Baumjohann</surname><given-names>D</given-names></name><name><surname>Baying</surname><given-names>B</given-names></name><name><surname>Bebawy</surname><given-names>M</given-names></name><name><surname>Becher</surname><given-names>B</given-names></name><name><surname>Beisker</surname><given-names>W</given-names></name><name><surname>Benes</surname><given-names>V</given-names></name><name><surname>Beyaert</surname><given-names>R</given-names></name><name><surname>Blanco</surname><given-names>A</given-names></name><name><surname>Boardman</surname><given-names>DA</given-names></name><name><surname>Bogdan</surname><given-names>C</given-names></name><name><surname>Borger</surname><given-names>JG</given-names></name><name><surname>Borsellino</surname><given-names>G</given-names></name><name><surname>Boulais</surname><given-names>PE</given-names></name><name><surname>Bradford</surname><given-names>JA</given-names></name><name><surname>Brenner</surname><given-names>D</given-names></name><name><surname>Brinkman</surname><given-names>RR</given-names></name><name><surname>Brooks</surname><given-names>AES</given-names></name><name><surname>Busch</surname><given-names>DH</given-names></name><name><surname>Büscher</surname><given-names>M</given-names></name><name><surname>Bushnell</surname><given-names>TP</given-names></name><name><surname>Calzetti</surname><given-names>F</given-names></name><name><surname>Cameron</surname><given-names>G</given-names></name><name><surname>Cammarata</surname><given-names>I</given-names></name><name><surname>Cao</surname><given-names>X</given-names></name><name><surname>Cardell</surname><given-names>SL</given-names></name><name><surname>Casola</surname><given-names>S</given-names></name><name><surname>Cassatella</surname><given-names>MA</given-names></name><name><surname>Cavani</surname><given-names>A</given-names></name><name><surname>Celada</surname><given-names>A</given-names></name><name><surname>Chatenoud</surname><given-names>L</given-names></name><name><surname>Chattopadhyay</surname><given-names>PK</given-names></name><name><surname>Chow</surname><given-names>S</given-names></name><name><surname>Christakou</surname><given-names>E</given-names></name><name><surname>Čičin-Šain</surname><given-names>L</given-names></name><name><surname>Clerici</surname><given-names>M</given-names></name><name><surname>Colombo</surname><given-names>FS</given-names></name><name><surname>Cook</surname><given-names>L</given-names></name><name><surname>Cooke</surname><given-names>A</given-names></name><name><surname>Cooper</surname><given-names>AM</given-names></name><name><surname>Corbett</surname><given-names>AJ</given-names></name><name><surname>Cosma</surname><given-names>A</given-names></name><name><surname>Cosmi</surname><given-names>L</given-names></name><name><surname>Coulie</surname><given-names>PG</given-names></name><name><surname>Cumano</surname><given-names>A</given-names></name><name><surname>Cvetkovic</surname><given-names>L</given-names></name><name><surname>Dang</surname><given-names>VD</given-names></name><name><surname>Dang-Heine</surname><given-names>C</given-names></name><name><surname>Davey</surname><given-names>MS</given-names></name><name><surname>Davies</surname><given-names>D</given-names></name><name><surname>De Biasi</surname><given-names>S</given-names></name><name><surname>Del Zotto</surname><given-names>G</given-names></name><name><surname>Dela Cruz</surname><given-names>GV</given-names></name><name><surname>Delacher</surname><given-names>M</given-names></name><name><surname>Della Bella</surname><given-names>S</given-names></name><name><surname>Dellabona</surname><given-names>P</given-names></name><name><surname>Deniz</surname><given-names>G</given-names></name><name><surname>Dessing</surname><given-names>M</given-names></name><name><surname>Di Santo</surname><given-names>JP</given-names></name><name><surname>Diefenbach</surname><given-names>A</given-names></name><name><surname>Dieli</surname><given-names>F</given-names></name><name><surname>Dolf</surname><given-names>A</given-names></name><name><surname>Dörner</surname><given-names>T</given-names></name><name><surname>Dress</surname><given-names>RJ</given-names></name><name><surname>Dudziak</surname><given-names>D</given-names></name><name><surname>Dustin</surname><given-names>M</given-names></name><name><surname>Dutertre</surname><given-names>C-A</given-names></name><name><surname>Ebner</surname><given-names>F</given-names></name><name><surname>Eckle</surname><given-names>SBG</given-names></name><name><surname>Edinger</surname><given-names>M</given-names></name><name><surname>Eede</surname><given-names>P</given-names></name><name><surname>Ehrhardt</surname><given-names>GRA</given-names></name><name><surname>Eich</surname><given-names>M</given-names></name><name><surname>Engel</surname><given-names>P</given-names></name><name><surname>Engelhardt</surname><given-names>B</given-names></name><name><surname>Erdei</surname><given-names>A</given-names></name><name><surname>Esser</surname><given-names>C</given-names></name><name><surname>Everts</surname><given-names>B</given-names></name><name><surname>Evrard</surname><given-names>M</given-names></name><name><surname>Falk</surname><given-names>CS</given-names></name><name><surname>Fehniger</surname><given-names>TA</given-names></name><name><surname>Felipo-Benavent</surname><given-names>M</given-names></name><name><surname>Ferry</surname><given-names>H</given-names></name><name><surname>Feuerer</surname><given-names>M</given-names></name><name><surname>Filby</surname><given-names>A</given-names></name><name><surname>Filkor</surname><given-names>K</given-names></name><name><surname>Fillatreau</surname><given-names>S</given-names></name><name><surname>Follo</surname><given-names>M</given-names></name><name><surname>Förster</surname><given-names>I</given-names></name><name><surname>Foster</surname><given-names>J</given-names></name><name><surname>Foulds</surname><given-names>GA</given-names></name><name><surname>Frehse</surname><given-names>B</given-names></name><name><surname>Frenette</surname><given-names>PS</given-names></name><name><surname>Frischbutter</surname><given-names>S</given-names></name><name><surname>Fritzsche</surname><given-names>W</given-names></name><name><surname>Galbraith</surname><given-names>DW</given-names></name><name><surname>Gangaev</surname><given-names>A</given-names></name><name><surname>Garbi</surname><given-names>N</given-names></name><name><surname>Gaudilliere</surname><given-names>B</given-names></name><name><surname>Gazzinelli</surname><given-names>RT</given-names></name><name><surname>Geginat</surname><given-names>J</given-names></name><name><surname>Gerner</surname><given-names>W</given-names></name><name><surname>Gherardin</surname><given-names>NA</given-names></name><name><surname>Ghoreschi</surname><given-names>K</given-names></name><name><surname>Gibellini</surname><given-names>L</given-names></name><name><surname>Ginhoux</surname><given-names>F</given-names></name><name><surname>Goda</surname><given-names>K</given-names></name><name><surname>Godfrey</surname><given-names>DI</given-names></name><name><surname>Goettlinger</surname><given-names>C</given-names></name><name><surname>González-Navajas</surname><given-names>JM</given-names></name><name><surname>Goodyear</surname><given-names>CS</given-names></name><name><surname>Gori</surname><given-names>A</given-names></name><name><surname>Grogan</surname><given-names>JL</given-names></name><name><surname>Grummitt</surname><given-names>D</given-names></name><name><surname>Grützkau</surname><given-names>A</given-names></name><name><surname>Haftmann</surname><given-names>C</given-names></name><name><surname>Hahn</surname><given-names>J</given-names></name><name><surname>Hammad</surname><given-names>H</given-names></name><name><surname>Hämmerling</surname><given-names>G</given-names></name><name><surname>Hansmann</surname><given-names>L</given-names></name><name><surname>Hansson</surname><given-names>G</given-names></name><name><surname>Harpur</surname><given-names>CM</given-names></name><name><surname>Hartmann</surname><given-names>S</given-names></name><name><surname>Hauser</surname><given-names>A</given-names></name><name><surname>Hauser</surname><given-names>AE</given-names></name><name><surname>Haviland</surname><given-names>DL</given-names></name><name><surname>Hedley</surname><given-names>D</given-names></name><name><surname>Hernández</surname><given-names>DC</given-names></name><name><surname>Herrera</surname><given-names>G</given-names></name><name><surname>Herrmann</surname><given-names>M</given-names></name><name><surname>Hess</surname><given-names>C</given-names></name><name><surname>Höfer</surname><given-names>T</given-names></name><name><surname>Hoffmann</surname><given-names>P</given-names></name><name><surname>Hogquist</surname><given-names>K</given-names></name><name><surname>Holland</surname><given-names>T</given-names></name><name><surname>Höllt</surname><given-names>T</given-names></name><name><surname>Holmdahl</surname><given-names>R</given-names></name><name><surname>Hombrink</surname><given-names>P</given-names></name><name><surname>Houston</surname><given-names>JP</given-names></name><name><surname>Hoyer</surname><given-names>BF</given-names></name><name><surname>Huang</surname><given-names>B</given-names></name><name><surname>Huang</surname><given-names>F-P</given-names></name><name><surname>Huber</surname><given-names>JE</given-names></name><name><surname>Huehn</surname><given-names>J</given-names></name><name><surname>Hundemer</surname><given-names>M</given-names></name><name><surname>Hunter</surname><given-names>CA</given-names></name><name><surname>Hwang</surname><given-names>WYK</given-names></name><name><surname>Iannone</surname><given-names>A</given-names></name><name><surname>Ingelfinger</surname><given-names>F</given-names></name><name><surname>Ivison</surname><given-names>SM</given-names></name><name><surname>Jäck</surname><given-names>H-M</given-names></name><name><surname>Jani</surname><given-names>PK</given-names></name><name><surname>Jávega</surname><given-names>B</given-names></name><name><surname>Jonjic</surname><given-names>S</given-names></name><name><surname>Kaiser</surname><given-names>T</given-names></name><name><surname>Kalina</surname><given-names>T</given-names></name><name><surname>Kamradt</surname><given-names>T</given-names></name><name><surname>Kaufmann</surname><given-names>SHE</given-names></name><name><surname>Keller</surname><given-names>B</given-names></name><name><surname>Ketelaars</surname><given-names>SLC</given-names></name><name><surname>Khalilnezhad</surname><given-names>A</given-names></name><name><surname>Khan</surname><given-names>S</given-names></name><name><surname>Kisielow</surname><given-names>J</given-names></name><name><surname>Klenerman</surname><given-names>P</given-names></name><name><surname>Knopf</surname><given-names>J</given-names></name><name><surname>Koay</surname><given-names>H-F</given-names></name><name><surname>Kobow</surname><given-names>K</given-names></name><name><surname>Kolls</surname><given-names>JK</given-names></name><name><surname>Kong</surname><given-names>WT</given-names></name><name><surname>Kopf</surname><given-names>M</given-names></name><name><surname>Korn</surname><given-names>T</given-names></name><name><surname>Kriegsmann</surname><given-names>K</given-names></name><name><surname>Kristyanto</surname><given-names>H</given-names></name><name><surname>Kroneis</surname><given-names>T</given-names></name><name><surname>Krueger</surname><given-names>A</given-names></name><name><surname>Kühne</surname><given-names>J</given-names></name><name><surname>Kukat</surname><given-names>C</given-names></name><name><surname>Kunkel</surname><given-names>D</given-names></name><name><surname>Kunze-Schumacher</surname><given-names>H</given-names></name><name><surname>Kurosaki</surname><given-names>T</given-names></name><name><surname>Kurts</surname><given-names>C</given-names></name><name><surname>Kvistborg</surname><given-names>P</given-names></name><name><surname>Kwok</surname><given-names>I</given-names></name><name><surname>Landry</surname><given-names>J</given-names></name><name><surname>Lantz</surname><given-names>O</given-names></name><name><surname>Lanuti</surname><given-names>P</given-names></name><name><surname>LaRosa</surname><given-names>F</given-names></name><name><surname>Lehuen</surname><given-names>A</given-names></name><name><surname>LeibundGut-Landmann</surname><given-names>S</given-names></name><name><surname>Leipold</surname><given-names>MD</given-names></name><name><surname>Leung</surname><given-names>LYT</given-names></name><name><surname>Levings</surname><given-names>MK</given-names></name><name><surname>Lino</surname><given-names>AC</given-names></name><name><surname>Liotta</surname><given-names>F</given-names></name><name><surname>Litwin</surname><given-names>V</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Ljunggren</surname><given-names>H-G</given-names></name><name><surname>Lohoff</surname><given-names>M</given-names></name><name><surname>Lombardi</surname><given-names>G</given-names></name><name><surname>Lopez</surname><given-names>L</given-names></name><name><surname>López-Botet</surname><given-names>M</given-names></name><name><surname>Lovett-Racke</surname><given-names>AE</given-names></name><name><surname>Lubberts</surname><given-names>E</given-names></name><name><surname>Luche</surname><given-names>H</given-names></name><name><surname>Ludewig</surname><given-names>B</given-names></name><name><surname>Lugli</surname><given-names>E</given-names></name><name><surname>Lunemann</surname><given-names>S</given-names></name><name><surname>Maecker</surname><given-names>HT</given-names></name><name><surname>Maggi</surname><given-names>L</given-names></name><name><surname>Maguire</surname><given-names>O</given-names></name><name><surname>Mair</surname><given-names>F</given-names></name><name><surname>Mair</surname><given-names>KH</given-names></name><name><surname>Mantovani</surname><given-names>A</given-names></name><name><surname>Manz</surname><given-names>RA</given-names></name><name><surname>Marshall</surname><given-names>AJ</given-names></name><name><surname>Martínez-Romero</surname><given-names>A</given-names></name><name><surname>Martrus</surname><given-names>G</given-names></name><name><surname>Marventano</surname><given-names>I</given-names></name><name><surname>Maslinski</surname><given-names>W</given-names></name><name><surname>Matarese</surname><given-names>G</given-names></name><name><surname>Mattioli</surname><given-names>AV</given-names></name><name><surname>Maueröder</surname><given-names>C</given-names></name><name><surname>Mazzoni</surname><given-names>A</given-names></name><name><surname>McCluskey</surname><given-names>J</given-names></name><name><surname>McGrath</surname><given-names>M</given-names></name><name><surname>McGuire</surname><given-names>HM</given-names></name><name><surname>McInnes</surname><given-names>IB</given-names></name><name><surname>Mei</surname><given-names>HE</given-names></name><name><surname>Melchers</surname><given-names>F</given-names></name><name><surname>Melzer</surname><given-names>S</given-names></name><name><surname>Mielenz</surname><given-names>D</given-names></name><name><surname>Miller</surname><given-names>SD</given-names></name><name><surname>Mills</surname><given-names>KHG</given-names></name><name><surname>Minderman</surname><given-names>H</given-names></name><name><surname>Mjösberg</surname><given-names>J</given-names></name><name><surname>Moore</surname><given-names>J</given-names></name><name><surname>Moran</surname><given-names>B</given-names></name><name><surname>Moretta</surname><given-names>L</given-names></name><name><surname>Mosmann</surname><given-names>TR</given-names></name><name><surname>Müller</surname><given-names>S</given-names></name><name><surname>Multhoff</surname><given-names>G</given-names></name><name><surname>Muñoz</surname><given-names>LE</given-names></name><name><surname>Münz</surname><given-names>C</given-names></name><name><surname>Nakayama</surname><given-names>T</given-names></name><name><surname>Nasi</surname><given-names>M</given-names></name><name><surname>Neumann</surname><given-names>K</given-names></name><name><surname>Ng</surname><given-names>LG</given-names></name><name><surname>Niedobitek</surname><given-names>A</given-names></name><name><surname>Nourshargh</surname><given-names>S</given-names></name><name><surname>Núñez</surname><given-names>G</given-names></name><name><surname>O’Connor</surname><given-names>J</given-names></name><name><surname>Ochel</surname><given-names>A</given-names></name><name><surname>Oja</surname><given-names>A</given-names></name><name><surname>Ordonez</surname><given-names>D</given-names></name><name><surname>Orfao</surname><given-names>A</given-names></name><name><surname>Orlowski-Oliver</surname><given-names>E</given-names></name><name><surname>Ouyang</surname><given-names>W</given-names></name><name><surname>Oxenius</surname><given-names>A</given-names></name><name><surname>Palankar</surname><given-names>R</given-names></name><name><surname>Panse</surname><given-names>I</given-names></name><name><surname>Pattanapanyasat</surname><given-names>K</given-names></name><name><surname>Paulsen</surname><given-names>M</given-names></name><name><surname>Pavlinic</surname><given-names>D</given-names></name><name><surname>Penter</surname><given-names>L</given-names></name><name><surname>Peterson</surname><given-names>P</given-names></name><name><surname>Peth</surname><given-names>C</given-names></name><name><surname>Petriz</surname><given-names>J</given-names></name><name><surname>Piancone</surname><given-names>F</given-names></name><name><surname>Pickl</surname><given-names>WF</given-names></name><name><surname>Piconese</surname><given-names>S</given-names></name><name><surname>Pinti</surname><given-names>M</given-names></name><name><surname>Pockley</surname><given-names>AG</given-names></name><name><surname>Podolska</surname><given-names>MJ</given-names></name><name><surname>Poon</surname><given-names>Z</given-names></name><name><surname>Pracht</surname><given-names>K</given-names></name><name><surname>Prinz</surname><given-names>I</given-names></name><name><surname>Pucillo</surname><given-names>CEM</given-names></name><name><surname>Quataert</surname><given-names>SA</given-names></name><name><surname>Quatrini</surname><given-names>L</given-names></name><name><surname>Quinn</surname><given-names>KM</given-names></name><name><surname>Radbruch</surname><given-names>H</given-names></name><name><surname>Radstake</surname><given-names>TRDJ</given-names></name><name><surname>Rahmig</surname><given-names>S</given-names></name><name><surname>Rahn</surname><given-names>H-P</given-names></name><name><surname>Rajwa</surname><given-names>B</given-names></name><name><surname>Ravichandran</surname><given-names>G</given-names></name><name><surname>Raz</surname><given-names>Y</given-names></name><name><surname>Rebhahn</surname><given-names>JA</given-names></name><name><surname>Recktenwald</surname><given-names>D</given-names></name><name><surname>Reimer</surname><given-names>D</given-names></name><name><surname>Reis e Sousa</surname><given-names>C</given-names></name><name><surname>Remmerswaal</surname><given-names>EBM</given-names></name><name><surname>Richter</surname><given-names>L</given-names></name><name><surname>Rico</surname><given-names>LG</given-names></name><name><surname>Riddell</surname><given-names>A</given-names></name><name><surname>Rieger</surname><given-names>AM</given-names></name><name><surname>Robinson</surname><given-names>JP</given-names></name><name><surname>Romagnani</surname><given-names>C</given-names></name><name><surname>Rubartelli</surname><given-names>A</given-names></name><name><surname>Ruland</surname><given-names>J</given-names></name><name><surname>Saalmüller</surname><given-names>A</given-names></name><name><surname>Saeys</surname><given-names>Y</given-names></name><name><surname>Saito</surname><given-names>T</given-names></name><name><surname>Sakaguchi</surname><given-names>S</given-names></name><name><surname>Sala-de-Oyanguren</surname><given-names>F</given-names></name><name><surname>Samstag</surname><given-names>Y</given-names></name><name><surname>Sanderson</surname><given-names>S</given-names></name><name><surname>Sandrock</surname><given-names>I</given-names></name><name><surname>Santoni</surname><given-names>A</given-names></name><name><surname>Sanz</surname><given-names>RB</given-names></name><name><surname>Saresella</surname><given-names>M</given-names></name><name><surname>Sautes-Fridman</surname><given-names>C</given-names></name><name><surname>Sawitzki</surname><given-names>B</given-names></name><name><surname>Schadt</surname><given-names>L</given-names></name><name><surname>Scheffold</surname><given-names>A</given-names></name><name><surname>Scherer</surname><given-names>HU</given-names></name><name><surname>Schiemann</surname><given-names>M</given-names></name><name><surname>Schildberg</surname><given-names>FA</given-names></name><name><surname>Schimisky</surname><given-names>E</given-names></name><name><surname>Schlitzer</surname><given-names>A</given-names></name><name><surname>Schlosser</surname><given-names>J</given-names></name><name><surname>Schmid</surname><given-names>S</given-names></name><name><surname>Schmitt</surname><given-names>S</given-names></name><name><surname>Schober</surname><given-names>K</given-names></name><name><surname>Schraivogel</surname><given-names>D</given-names></name><name><surname>Schuh</surname><given-names>W</given-names></name><name><surname>Schüler</surname><given-names>T</given-names></name><name><surname>Schulte</surname><given-names>R</given-names></name><name><surname>Schulz</surname><given-names>AR</given-names></name><name><surname>Schulz</surname><given-names>SR</given-names></name><name><surname>Scottá</surname><given-names>C</given-names></name><name><surname>Scott-Algara</surname><given-names>D</given-names></name><name><surname>Sester</surname><given-names>DP</given-names></name><name><surname>Shankey</surname><given-names>TV</given-names></name><name><surname>Silva-Santos</surname><given-names>B</given-names></name><name><surname>Simon</surname><given-names>AK</given-names></name><name><surname>Sitnik</surname><given-names>KM</given-names></name><name><surname>Sozzani</surname><given-names>S</given-names></name><name><surname>Speiser</surname><given-names>DE</given-names></name><name><surname>Spidlen</surname><given-names>J</given-names></name><name><surname>Stahlberg</surname><given-names>A</given-names></name><name><surname>Stall</surname><given-names>AM</given-names></name><name><surname>Stanley</surname><given-names>N</given-names></name><name><surname>Stark</surname><given-names>R</given-names></name><name><surname>Stehle</surname><given-names>C</given-names></name><name><surname>Steinmetz</surname><given-names>T</given-names></name><name><surname>Stockinger</surname><given-names>H</given-names></name><name><surname>Takahama</surname><given-names>Y</given-names></name><name><surname>Takeda</surname><given-names>K</given-names></name><name><surname>Tan</surname><given-names>L</given-names></name><name><surname>Tárnok</surname><given-names>A</given-names></name><name><surname>Tiegs</surname><given-names>G</given-names></name><name><surname>Toldi</surname><given-names>G</given-names></name><name><surname>Tornack</surname><given-names>J</given-names></name><name><surname>Traggiai</surname><given-names>E</given-names></name><name><surname>Trebak</surname><given-names>M</given-names></name><name><surname>Tree</surname><given-names>TIM</given-names></name><name><surname>Trotter</surname><given-names>J</given-names></name><name><surname>Trowsdale</surname><given-names>J</given-names></name><name><surname>Tsoumakidou</surname><given-names>M</given-names></name><name><surname>Ulrich</surname><given-names>H</given-names></name><name><surname>Urbanczyk</surname><given-names>S</given-names></name><name><surname>van de Veen</surname><given-names>W</given-names></name><name><surname>van den Broek</surname><given-names>M</given-names></name><name><surname>van der Pol</surname><given-names>E</given-names></name><name><surname>Van Gassen</surname><given-names>S</given-names></name><name><surname>Van Isterdael</surname><given-names>G</given-names></name><name><surname>van Lier</surname><given-names>RAW</given-names></name><name><surname>Veldhoen</surname><given-names>M</given-names></name><name><surname>Vento-Asturias</surname><given-names>S</given-names></name><name><surname>Vieira</surname><given-names>P</given-names></name><name><surname>Voehringer</surname><given-names>D</given-names></name><name><surname>Volk</surname><given-names>H-D</given-names></name><name><surname>von Borstel</surname><given-names>A</given-names></name><name><surname>von Volkmann</surname><given-names>K</given-names></name><name><surname>Waisman</surname><given-names>A</given-names></name><name><surname>Walker</surname><given-names>RV</given-names></name><name><surname>Wallace</surname><given-names>PK</given-names></name><name><surname>Wang</surname><given-names>SA</given-names></name><name><surname>Wang</surname><given-names>XM</given-names></name><name><surname>Ward</surname><given-names>MD</given-names></name><name><surname>Ward-Hartstonge</surname><given-names>KA</given-names></name><name><surname>Warnatz</surname><given-names>K</given-names></name><name><surname>Warnes</surname><given-names>G</given-names></name><name><surname>Warth</surname><given-names>S</given-names></name><name><surname>Waskow</surname><given-names>C</given-names></name><name><surname>Watson</surname><given-names>JV</given-names></name><name><surname>Watzl</surname><given-names>C</given-names></name><name><surname>Wegener</surname><given-names>L</given-names></name><name><surname>Weisenburger</surname><given-names>T</given-names></name><name><surname>Wiedemann</surname><given-names>A</given-names></name><name><surname>Wienands</surname><given-names>J</given-names></name><name><surname>Wilharm</surname><given-names>A</given-names></name><name><surname>Wilkinson</surname><given-names>RJ</given-names></name><name><surname>Willimsky</surname><given-names>G</given-names></name><name><surname>Wing</surname><given-names>JB</given-names></name><name><surname>Winkelmann</surname><given-names>R</given-names></name><name><surname>Winkler</surname><given-names>TH</given-names></name><name><surname>Wirz</surname><given-names>OF</given-names></name><name><surname>Wong</surname><given-names>A</given-names></name><name><surname>Wurst</surname><given-names>P</given-names></name><name><surname>Yang</surname><given-names>JHM</given-names></name><name><surname>Yang</surname><given-names>J</given-names></name><name><surname>Yazdanbakhsh</surname><given-names>M</given-names></name><name><surname>Yu</surname><given-names>L</given-names></name><name><surname>Yue</surname><given-names>A</given-names></name><name><surname>Zhang</surname><given-names>H</given-names></name><name><surname>Zhao</surname><given-names>Y</given-names></name><name><surname>Ziegler</surname><given-names>SM</given-names></name><name><surname>Zielinski</surname><given-names>C</given-names></name><name><surname>Zimmermann</surname><given-names>J</given-names></name><name><surname>Zychlinsky</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Guidelines for the use of flow cytometry and cell sorting in immunological studies (second edition)</article-title><source>European Journal of Immunology</source><volume>49</volume><fpage>1457</fpage><lpage>1973</lpage><pub-id pub-id-type="doi">10.1002/eji.201970107</pub-id><pub-id pub-id-type="pmid">31633216</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>DeVita</surname><given-names>VT</given-names></name><name><surname>Lawrence</surname><given-names>TS</given-names></name></person-group><year iso-8601-date="2015">2015</year><source>Devita, Hellman, and Rosenberg’s Cancer: Principles &amp; Practice of Oncology</source><publisher-name>Williams &amp; Wilkins Publishers</publisher-name></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dhillon</surname><given-names>AS</given-names></name><name><surname>Hagan</surname><given-names>S</given-names></name><name><surname>Rath</surname><given-names>O</given-names></name><name><surname>Kolch</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>MAP kinase signalling pathways in cancer</article-title><source>Oncogene</source><volume>26</volume><fpage>3279</fpage><lpage>3290</lpage><pub-id pub-id-type="doi">10.1038/sj.onc.1210421</pub-id><pub-id pub-id-type="pmid">17496922</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferri</surname><given-names>E</given-names></name><name><surname>Petosa</surname><given-names>C</given-names></name><name><surname>McKenna</surname><given-names>CE</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Bromodomains: Structure, function and pharmacology of inhibition</article-title><source>Biochemical Pharmacology</source><volume>106</volume><fpage>1</fpage><lpage>18</lpage><pub-id pub-id-type="doi">10.1016/j.bcp.2015.12.005</pub-id><pub-id pub-id-type="pmid">26707800</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greenberg</surname><given-names>PL</given-names></name><name><surname>Tuechler</surname><given-names>H</given-names></name><name><surname>Schanz</surname><given-names>J</given-names></name><name><surname>Sanz</surname><given-names>G</given-names></name><name><surname>Garcia-Manero</surname><given-names>G</given-names></name><name><surname>Solé</surname><given-names>F</given-names></name><name><surname>Bennett</surname><given-names>JM</given-names></name><name><surname>Bowen</surname><given-names>D</given-names></name><name><surname>Fenaux</surname><given-names>P</given-names></name><name><surname>Dreyfus</surname><given-names>F</given-names></name><name><surname>Kantarjian</surname><given-names>H</given-names></name><name><surname>Kuendgen</surname><given-names>A</given-names></name><name><surname>Levis</surname><given-names>A</given-names></name><name><surname>Malcovati</surname><given-names>L</given-names></name><name><surname>Cazzola</surname><given-names>M</given-names></name><name><surname>Cermak</surname><given-names>J</given-names></name><name><surname>Fonatsch</surname><given-names>C</given-names></name><name><surname>Le Beau</surname><given-names>MM</given-names></name><name><surname>Slovak</surname><given-names>ML</given-names></name><name><surname>Krieger</surname><given-names>O</given-names></name><name><surname>Luebbert</surname><given-names>M</given-names></name><name><surname>Maciejewski</surname><given-names>J</given-names></name><name><surname>Magalhaes</surname><given-names>SMM</given-names></name><name><surname>Miyazaki</surname><given-names>Y</given-names></name><name><surname>Pfeilstöcker</surname><given-names>M</given-names></name><name><surname>Sekeres</surname><given-names>M</given-names></name><name><surname>Sperr</surname><given-names>WR</given-names></name><name><surname>Stauder</surname><given-names>R</given-names></name><name><surname>Tauro</surname><given-names>S</given-names></name><name><surname>Valent</surname><given-names>P</given-names></name><name><surname>Vallespi</surname><given-names>T</given-names></name><name><surname>van de Loosdrecht</surname><given-names>AA</given-names></name><name><surname>Germing</surname><given-names>U</given-names></name><name><surname>Haase</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Revised international prognostic scoring system for myelodysplastic syndromes</article-title><source>Blood</source><volume>120</volume><fpage>2454</fpage><lpage>2465</lpage><pub-id pub-id-type="doi">10.1182/blood-2012-03-420489</pub-id><pub-id pub-id-type="pmid">22740453</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaneda</surname><given-names>M</given-names></name><name><surname>Okano</surname><given-names>M</given-names></name><name><surname>Hata</surname><given-names>K</given-names></name><name><surname>Sado</surname><given-names>T</given-names></name><name><surname>Tsujimoto</surname><given-names>N</given-names></name><name><surname>Li</surname><given-names>E</given-names></name><name><surname>Sasaki</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Essential role for de novo DNA methyltransferase Dnmt3a in paternal and maternal imprinting</article-title><source>Nature</source><volume>429</volume><fpage>900</fpage><lpage>903</lpage><pub-id pub-id-type="doi">10.1038/nature02633</pub-id><pub-id pub-id-type="pmid">15215868</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kühn</surname><given-names>R</given-names></name><name><surname>Schwenk</surname><given-names>F</given-names></name><name><surname>Aguet</surname><given-names>M</given-names></name><name><surname>Rajewsky</surname><given-names>K</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Inducible gene targeting in mice</article-title><source>Science (New York, N.Y.)</source><volume>269</volume><fpage>1427</fpage><lpage>1429</lpage><pub-id pub-id-type="doi">10.1126/science.7660125</pub-id><pub-id pub-id-type="pmid">7660125</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>BH</given-names></name><name><surname>Tothova</surname><given-names>Z</given-names></name><name><surname>Levine</surname><given-names>RL</given-names></name><name><surname>Anderson</surname><given-names>K</given-names></name><name><surname>Buza-Vidas</surname><given-names>N</given-names></name><name><surname>Cullen</surname><given-names>DE</given-names></name><name><surname>McDowell</surname><given-names>EP</given-names></name><name><surname>Adelsperger</surname><given-names>J</given-names></name><name><surname>Fröhling</surname><given-names>S</given-names></name><name><surname>Huntly</surname><given-names>BJP</given-names></name><name><surname>Beran</surname><given-names>M</given-names></name><name><surname>Jacobsen</surname><given-names>SE</given-names></name><name><surname>Gilliland</surname><given-names>DG</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>FLT3 mutations confer enhanced proliferation and survival properties to multipotent progenitors in a murine model of chronic myelomonocytic leukemia</article-title><source>Cancer Cell</source><volume>12</volume><fpage>367</fpage><lpage>380</lpage><pub-id pub-id-type="doi">10.1016/j.ccr.2007.08.031</pub-id><pub-id pub-id-type="pmid">17936561</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levine</surname><given-names>JH</given-names></name><name><surname>Simonds</surname><given-names>EF</given-names></name><name><surname>Bendall</surname><given-names>SC</given-names></name><name><surname>Davis</surname><given-names>KL</given-names></name><name><surname>Amir</surname><given-names>ED</given-names></name><name><surname>Tadmor</surname><given-names>MD</given-names></name><name><surname>Litvin</surname><given-names>O</given-names></name><name><surname>Fienberg</surname><given-names>HG</given-names></name><name><surname>Jager</surname><given-names>A</given-names></name><name><surname>Zunder</surname><given-names>ER</given-names></name><name><surname>Finck</surname><given-names>R</given-names></name><name><surname>Gedman</surname><given-names>AL</given-names></name><name><surname>Radtke</surname><given-names>I</given-names></name><name><surname>Downing</surname><given-names>JR</given-names></name><name><surname>Pe’er</surname><given-names>D</given-names></name><name><surname>Nolan</surname><given-names>GP</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Data-Driven Phenotypic Dissection of AML Reveals Progenitor-like Cells that Correlate with Prognosis</article-title><source>Cell</source><volume>162</volume><fpage>184</fpage><lpage>197</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.05.047</pub-id><pub-id pub-id-type="pmid">26095251</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lvd</surname><given-names>M</given-names></name><name><surname>Hinton</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Visualizing Data using t-SNE</article-title><source>Journal of Machine Learning Research</source><volume>9</volume><fpage>2579</fpage><lpage>2605</lpage></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McInnes</surname><given-names>L</given-names></name><name><surname>Healy</surname><given-names>J</given-names></name><name><surname>Saul</surname><given-names>N</given-names></name><name><surname>Großberger</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>UMAP: Uniform Manifold Approximation and Projection</article-title><source>Journal of Open Source Software</source><volume>3</volume><elocation-id>861</elocation-id><pub-id pub-id-type="doi">10.21105/joss.00861</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Niederhuber</surname><given-names>JE</given-names></name><name><surname>Armitage</surname><given-names>J</given-names></name><name><surname>Doroshow</surname><given-names>J</given-names></name><name><surname>Kastan</surname><given-names>M</given-names></name><name><surname>Tepper</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><source>Abeloff’s Clinical Oncology</source><publisher-name>Abeloff Leo</publisher-name></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ogishi</surname><given-names>M</given-names></name><name><surname>Yang</surname><given-names>R</given-names></name><name><surname>Gruber</surname><given-names>C</given-names></name><name><surname>Zhang</surname><given-names>P</given-names></name><name><surname>Pelham</surname><given-names>SJ</given-names></name><name><surname>Spaan</surname><given-names>AN</given-names></name><name><surname>Rosain</surname><given-names>J</given-names></name><name><surname>Chbihi</surname><given-names>M</given-names></name><name><surname>Han</surname><given-names>JE</given-names></name><name><surname>Rao</surname><given-names>VK</given-names></name><name><surname>Kainulainen</surname><given-names>L</given-names></name><name><surname>Bustamante</surname><given-names>J</given-names></name><name><surname>Boisson</surname><given-names>B</given-names></name><name><surname>Bogunovic</surname><given-names>D</given-names></name><name><surname>Boisson-Dupuis</surname><given-names>S</given-names></name><name><surname>Casanova</surname><given-names>JL</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Multibatch Cytometry Data Integration for Optimal Immunophenotyping</article-title><source>Journal of Immunology (Baltimore, Md)</source><volume>206</volume><fpage>206</fpage><lpage>213</lpage><pub-id pub-id-type="doi">10.4049/jimmunol.2000854</pub-id><pub-id pub-id-type="pmid">33229441</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Potdar</surname><given-names>S</given-names></name><name><surname>Ianevski</surname><given-names>A</given-names></name><name><surname>Mpindi</surname><given-names>JP</given-names></name><name><surname>Bychkov</surname><given-names>D</given-names></name><name><surname>Fiere</surname><given-names>C</given-names></name><name><surname>Ianevski</surname><given-names>P</given-names></name><name><surname>Yadav</surname><given-names>B</given-names></name><name><surname>Wennerberg</surname><given-names>K</given-names></name><name><surname>Aittokallio</surname><given-names>T</given-names></name><name><surname>Kallioniemi</surname><given-names>O</given-names></name><name><surname>Saarela</surname><given-names>J</given-names></name><name><surname>Östling</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Breeze: an integrated quality control and data analysis application for high-throughput drug screening</article-title><source>Bioinformatics (Oxford, England)</source><volume>36</volume><fpage>3602</fpage><lpage>3604</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btaa138</pub-id><pub-id pub-id-type="pmid">32119072</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiu</surname><given-names>P</given-names></name><name><surname>Simonds</surname><given-names>EF</given-names></name><name><surname>Bendall</surname><given-names>SC</given-names></name><name><surname>Gibbs</surname><given-names>KD</given-names></name><name><surname>Bruggner</surname><given-names>RV</given-names></name><name><surname>Linderman</surname><given-names>MD</given-names></name><name><surname>Sachs</surname><given-names>K</given-names></name><name><surname>Nolan</surname><given-names>GP</given-names></name><name><surname>Plevritis</surname><given-names>SK</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Extracting a cellular hierarchy from high-dimensional cytometry data with SPADE</article-title><source>Nature Biotechnology</source><volume>29</volume><fpage>886</fpage><lpage>891</lpage><pub-id pub-id-type="doi">10.1038/nbt.1991</pub-id><pub-id pub-id-type="pmid">21964415</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saeys</surname><given-names>Y</given-names></name><name><surname>Van Gassen</surname><given-names>S</given-names></name><name><surname>Lambrecht</surname><given-names>BN</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Computational flow cytometry: helping to make sense of high-dimensional immunology data</article-title><source>Nature Reviews. Immunology</source><volume>16</volume><fpage>449</fpage><lpage>462</lpage><pub-id pub-id-type="doi">10.1038/nri.2016.56</pub-id><pub-id pub-id-type="pmid">27320317</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Dongen</surname><given-names>JJM</given-names></name><name><surname>Lhermitte</surname><given-names>L</given-names></name><name><surname>Böttcher</surname><given-names>S</given-names></name><name><surname>Almeida</surname><given-names>J</given-names></name><name><surname>van der Velden</surname><given-names>VHJ</given-names></name><name><surname>Flores-Montero</surname><given-names>J</given-names></name><name><surname>Rawstron</surname><given-names>A</given-names></name><name><surname>Asnafi</surname><given-names>V</given-names></name><name><surname>Lécrevisse</surname><given-names>Q</given-names></name><name><surname>Lucio</surname><given-names>P</given-names></name><name><surname>Mejstrikova</surname><given-names>E</given-names></name><name><surname>Szczepański</surname><given-names>T</given-names></name><name><surname>Kalina</surname><given-names>T</given-names></name><name><surname>de Tute</surname><given-names>R</given-names></name><name><surname>Brüggemann</surname><given-names>M</given-names></name><name><surname>Sedek</surname><given-names>L</given-names></name><name><surname>Cullen</surname><given-names>M</given-names></name><name><surname>Langerak</surname><given-names>AW</given-names></name><name><surname>Mendonça</surname><given-names>A</given-names></name><name><surname>Macintyre</surname><given-names>E</given-names></name><name><surname>Martin-Ayuso</surname><given-names>M</given-names></name><name><surname>Hrusak</surname><given-names>O</given-names></name><name><surname>Vidriales</surname><given-names>MB</given-names></name><name><surname>Orfao</surname><given-names>A</given-names></name><collab>EuroFlow Consortium EU-FP6, LSHB-CT-2006-018708</collab></person-group><year iso-8601-date="2012">2012</year><article-title>EuroFlow antibody panels for standardized n-dimensional flow cytometric immunophenotyping of normal, reactive and malignant leukocytes</article-title><source>Leukemia</source><volume>26</volume><fpage>1908</fpage><lpage>1975</lpage><pub-id pub-id-type="doi">10.1038/leu.2012.120</pub-id><pub-id pub-id-type="pmid">22552007</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Gassen</surname><given-names>S</given-names></name><name><surname>Callebaut</surname><given-names>B</given-names></name><name><surname>Van Helden</surname><given-names>MJ</given-names></name><name><surname>Lambrecht</surname><given-names>BN</given-names></name><name><surname>Demeester</surname><given-names>P</given-names></name><name><surname>Dhaene</surname><given-names>T</given-names></name><name><surname>Saeys</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>FlowSOM: Using self-organizing maps for visualization and interpretation of cytometry data</article-title><source>Cytometry. Part A</source><volume>87</volume><fpage>636</fpage><lpage>645</lpage><pub-id pub-id-type="doi">10.1002/cyto.a.22625</pub-id><pub-id pub-id-type="pmid">25573116</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vassiliou</surname><given-names>GS</given-names></name><name><surname>Cooper</surname><given-names>JL</given-names></name><name><surname>Rad</surname><given-names>R</given-names></name><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Rice</surname><given-names>S</given-names></name><name><surname>Uren</surname><given-names>A</given-names></name><name><surname>Rad</surname><given-names>L</given-names></name><name><surname>Ellis</surname><given-names>P</given-names></name><name><surname>Andrews</surname><given-names>R</given-names></name><name><surname>Banerjee</surname><given-names>R</given-names></name><name><surname>Grove</surname><given-names>C</given-names></name><name><surname>Wang</surname><given-names>W</given-names></name><name><surname>Liu</surname><given-names>P</given-names></name><name><surname>Wright</surname><given-names>P</given-names></name><name><surname>Arends</surname><given-names>M</given-names></name><name><surname>Bradley</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Mutant nucleophosmin and cooperating pathways drive leukemia initiation and progression in mice</article-title><source>Nature Genetics</source><volume>43</volume><fpage>470</fpage><lpage>475</lpage><pub-id pub-id-type="doi">10.1038/ng.796</pub-id><pub-id pub-id-type="pmid">21441929</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec id="s8" sec-type="appendix"><title>High-throughput flow cytometry of AML mouse model</title><p>Leukemic spleen cells were sorted for c-Kit positivity from Npm1<sup>+/cA</sup>; Flt3<sup>+/ITD</sup>; Dnmt3<sup>a+/-</sup>; Mx1-Cre+ moribund mice. Shortly, c-Kit+ splenic cells were expanded for two passages in StemPro-34 SFM media (Gibco) with 100 µM 2-Mercaptoethanol (Gibco), 20 ng/ml murine SCF, 10 ng/ml murine IL-3 and 10 ng/ml IL-6 added (Peprotech), with complete media change every two/three days. Aliquots of one million cells were frozen down in 90% media 10% DMSO. Frozen aliquots were taken up and expanded for one week before drug screening. 5000 cells in 25 µl of media per well was seeded into 384-well plates (Greiner) containing a library of 116 compounds (<xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>) in a five-point concentration range. After 72 h incubation at 37 °C, 15 µl of medium was aspirated from each well and antibodies (<xref ref-type="supplementary-material" rid="supp9">Supplementary file 9</xref>) were added to drug plates using acoustic dispensing. Plates were incubated 40 min at RT, covered from light. Next, dead cell dye 7-AAD (BD) was added, and samples were read using a high-throughput flow cytometer iQue Screener Plus (Intellicyt). To remove noise from the data by excluding the most broadly toxic treatments, doublets and dead cells were omitted (<xref ref-type="fig" rid="app1fig31">Appendix 1—figure 31</xref>) and only samples with at least 1,000 live cells were selected for further analyses (selected 465 wells out of 600).</p></sec><sec id="s9" sec-type="appendix"><title>High-throughput flow cytometry of human AML</title><p>Donated MNCs from human bone marrow aspirates (Danish National Ethical committee/National Videnskabsetisk Komité permit 1705391) were thawed and allowed to rest overnight in assay media: StemSpan II-SFEM (StemCell), 100 U/ml penicillin/streptomycin (Thermo), including the following human recombinant cytokines from Preprotech (unless otherwise stated), 50 ng/ml Flt3 ligand (StemCell), 10 ng/ml IL3, 10 ng/ml IL-1beta, 20 ng/ml IL6, 20 ng/ml G-CSF, 20 ng/ml GM-CSF, and 10 ng/ml SCF, and the following compounds diluted in DMSO (Merck) 1 µM UM729 (Selleckchem) and 500 nM StemRegenin-1 (MedChemExpress). Before being counted and re-suspended in fresh assay media at a density of 5 × 10<sup>5</sup> cells/ml. A 20 µl/well was plated in 384-well conical bottom plates (Greiner Bio-One) containing 25 nl of compounds (<xref ref-type="supplementary-material" rid="supp7">Supplementary file 7</xref>) in DMSO. After 72 hr incubation at 37 °C, 95% RH, 5% CO<sub>2</sub> antibodies and viability dye were added to the plates using acoustic dispensing (Echo, Labcyte). Plates were incubated for 1.5 hr covered from light at RT. The samples were then run on an iQue Screener Plus (Intellicyt) high-throughput flow cytometer. The data was gated to remove noise, doublets, and dead cells (<xref ref-type="fig" rid="app1fig30">Appendix 1—figure 30</xref>). The antibodies and stains used are described in <xref ref-type="supplementary-material" rid="supp10">Supplementary file 10</xref>.</p></sec><sec id="s10" sec-type="appendix"><title>Signal and cell viability drifts correction in compaRe</title><p>To correct signal drift, we employed a two-step correction: intra-plate correction and inter-plate correction. For a given plate, we first fit a linear regression model and then vertically translate points (MFIs) with respect to the leaned line as it rotates to slope zero. This is because the relative distance between the points must be retained as much as possible, and no point must be translated to <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></inline-formula> quadrant after correction. To make sure the learned line is not affected by outliers, we first removed them using the interquartile range. In this way, a point at <inline-formula><mml:math id="inf2"><mml:mfenced separators="|"><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> is translated to <inline-formula><mml:math id="inf3"><mml:mfenced separators="|"><mml:mrow><mml:mi>y</mml:mi><mml:mfrac><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> after intra-plate correction. The correction coefficient <inline-formula><mml:math id="inf4"><mml:mfrac><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula> derives from the ratio of y-coordinates of any point on the regression line before and after translation: <inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mi>y</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mi>b</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> where <inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is translated <inline-formula><mml:math id="inf7"><mml:mi>y</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf8"><mml:mi>m</mml:mi></mml:math></inline-formula> is the slope and <inline-formula><mml:math id="inf9"><mml:mi>b</mml:mi></mml:math></inline-formula> is the intercept of the line. This ratio holds true for all other points in the <inline-formula><mml:math id="inf10"><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:math></inline-formula>-plane.</p><p>After correcting for intra-plate signal drift, inter-plate signal drift is corrected by aligning MFI medians of the plates, that is, translating to a common baseline. Let <inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> be the baseline, and <inline-formula><mml:math id="inf12"><mml:mi>b</mml:mi></mml:math></inline-formula> be the median of corrected MFIs in a plate, then the inter-plate correction coefficient is given by <inline-formula><mml:math id="inf13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mi>b</mml:mi></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> , and a point at <inline-formula><mml:math id="inf14"><mml:mfenced separators="|"><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> is translated to <inline-formula><mml:math id="inf15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mfrac><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mi>b</mml:mi></mml:mfrac><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> . The same approach is employed for correcting cell viability bias (<xref ref-type="fig" rid="app1fig28">Appendix 1—figure 28</xref>).</p></sec><sec id="s11" sec-type="appendix"><title>Similarity measurement in compaRe</title><p>compaRe can measure the similarity between two datasets with many variables (dimensions) and observations (data points). compaRe divides each dimension into <inline-formula><mml:math id="inf16"><mml:mi>n</mml:mi></mml:math></inline-formula> subsets so that a dataset with <inline-formula><mml:math id="inf17"><mml:mi>d</mml:mi></mml:math></inline-formula> dimensions will be divided into at most <inline-formula><mml:math id="inf18"><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> spatial units called hypercubes. The hypercubes are formed for either dataset individually. It, then measures the proportion of the observations within each of the corresponding hypercubes. The difference between the two proportions is indicative of the similarity within that relative spatial position represented by that hypercube so that for two similar datasets this difference is near zero in the majority of the hypercubes. Averaging these differences across all the hypercubes indicates the amount of similarity between the two datasets.</p><p>It is important to compare two samples across their corresponding hypercubes representing the same relative spatial positions. This means a universal numbering rule is required to ensure having corresponding hypercubes for the two samples in the end. This problem can be modeled as a tree that at each level <inline-formula><mml:math id="inf19"><mml:mi>l</mml:mi></mml:math></inline-formula> (dimension) grows <inline-formula><mml:math id="inf20"><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> new branches (divisions) (<xref ref-type="fig" rid="app1fig32">Appendix 1—figure 32</xref>). However, as the number of branches increases exponentially with <inline-formula><mml:math id="inf21"><mml:mi>l</mml:mi></mml:math></inline-formula>, implementing the tree is infeasible. To overcome this problem, we instead employed a dynamic algorithm in which the hypercube number of each observation is dynamically updated at each iteration. In this approach, the child node number must be found from its parent’s, that is, previous iteration.</p><p>Rewriting the branch numbers to include more information reveals that if <inline-formula><mml:math id="inf22"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> is the parent node’s number, the child node’s number will be <inline-formula><mml:math id="inf23"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> where <inline-formula><mml:math id="inf24"><mml:mi>l</mml:mi></mml:math></inline-formula> is the child’s level, <inline-formula><mml:math id="inf25"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> is the number of families behind, and <inline-formula><mml:math id="inf26"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> is the number of siblings behind. Therefore, to find child node <inline-formula><mml:math id="inf27"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, we first need to calculate <inline-formula><mml:math id="inf28"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf29"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> of its parent as follows:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>⌊</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>⌋</mml:mo></mml:math></disp-formula><disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></disp-formula></p><p>It can be noticed that <inline-formula><mml:math id="inf30"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf31"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are always known, <inline-formula><mml:math id="inf32"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> , and <inline-formula><mml:math id="inf33"><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> is actually the largest node number at the <inline-formula><mml:math id="inf34"><mml:mi>l</mml:mi></mml:math></inline-formula> th level. Therefore, the problem we need to dynamically solve for each child at each dimension as the tree grows is:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></disp-formula></p><p>Since the similarity metric decreases for each exclusive hypercube, it is important to rid the two samples of outliers lying significantly far from the subpopulations of observations. However, at the same time we need to make sure smaller subpopulations (like rare cell subpopulations) are not mistaken for outliers. We employed local outlier factor which is a powerful tool for anomaly detection. <xref ref-type="fig" rid="fig1">Figure 1</xref> shows an actual AML dataset with three surface markers dissected by compaRe wherein each distinct color corresponds to data points within one abstract hypercube.</p><p>compaRe captures the morphology of high dimensional data enabling it to measure similarity even in the presence of moderate signal shift. For example, two technical replicates analyzed by two different instruments or configurations suffering from signal shift will still have the highest similarity by compaRe unless the shift is severe or has modified the morphology of the cell populations which practically does not happen as a result of batch effect or signal drift. This strategy helps compaRe circumvent signal drift or batch effect left uncorrected. Considering that any signal drift correction is essentially an approximate method, this feature is an advantage for compaRe, because together with the correction method they create a synergistic effect.</p><p>compaRe is a mass-aware approach meaning it forms hypercubes only around concentrations of data points avoiding areas which are devoid of data points. This substantially speeds up the process by saving a lot of CPU time and memory space making it feasible to compare datasets with numerous variables. As an example, dividing each dimension blindly into just three regions yields more than 1.5 billion regions for consideration for a dataset with as few as 19 surface markers. In practice, however, it turns out many of these regions are empty so using a mass-aware gridding instead of blind gridding improves the comparison complexity from <inline-formula><mml:math id="inf35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> to <inline-formula><mml:math id="inf36"><mml:mi>O</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math></inline-formula> (asymptotic notations to represent algorithmic complexity). Even if no region is empty, since compaRe benefits from dynamic programming, it can still finish the process quite fast. Changing <inline-formula><mml:math id="inf37"><mml:mi>n</mml:mi></mml:math></inline-formula> tunes the level of smoothing so that a value between 3–5 works for most assays.</p><p>Dynamic programming is key for reducing processing power. In general, the goal is to bin/grid data into relative expression groups (hypercubes). Gridding can be implemented by a simple algorithm dividing each dimension in each iteration. However, as pointed out above, after a couple of rounds, this naïve algorithm turns out to be infeasible. Therefore, one need a more efficient algorithm for implementing gridding. Dynamic programming turned out to be quite effective. What makes dynamic programming very effective is its ability to memorize the values computed in the previous iterations avoiding recomputing potentially expensive algebraic operations (Appendix 1-equation 3).</p><p>To generate a similarity matrix of multiple input samples, compaRe runs in parallel for the samples in the upper-triangular submatrix using a multithreading approach. The similarity matrix could then be used for identifying clusters of samples such as drugs with similar dose responses like predicting the mechanism of action of drugs in development.</p><fig id="app1fig1" position="float"><label>Appendix 1—figure 1.</label><caption><title>Performance of meta-clustering with SPADE FlowSOM in the presence of batch effect.</title><p>Similarity matrices generated by FlowSOM and SPADE are shown in (<bold>a</bold>) and (<bold>b</bold>) respectively. Size and color of dots represent the level of similarity. Self-comparisons were removed. Noise was added (marked with *) to the original 21 mass cytometry samples of bone marrow aspirates from 16 pediatric AML patients (<bold>S</bold>) and five healthy adult donors (<bold>H</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig1-v3.tif"/></fig><fig id="app1fig2" position="float"><label>Appendix 1—figure 2.</label><caption><title>Phenotypic characterization in a high-parameter heterogeneous population of cell types.</title><p>Cells from a target cluster (an immunophenotypic cell population) were gradually removed to contort its configuration. We used a dataset of 3 healthy and two pediatric AML bone marrow mononuclear cell samples from the data provided in the 6th reference. Samples were stained with 29 (15 membrane and 14 intracellular signaling) markers. Taking H1 as reference, we gradually removed 25%, 50%, 75% and 100% (phenotypic changes) of cells from the target cluster identified by PhenoGraph. To capture the higher heterogeneity harbored in the AML samples, we set compaRe's <italic>n</italic> to 4 while we set it to 3 for healthy samples. Each column was scaled individually retaining mutual differences.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig2-v3.tif"/></fig><fig id="app1fig3" position="float"><label>Appendix 1—figure 3.</label><caption><title>UMAP projections of A2 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig3-v3.tif"/></fig><fig id="app1fig4" position="float"><label>Appendix 1—figure 4.</label><caption><title>UMAP projections of A3 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig4-v3.tif"/></fig><fig id="app1fig5" position="float"><label>Appendix 1—figure 5.</label><caption><title>UMAP projections of A4 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig5-v3.tif"/></fig><fig id="app1fig6" position="float"><label>Appendix 1—figure 6.</label><caption><title>UMAP projections of A5 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig6-v3.tif"/></fig><fig id="app1fig7" position="float"><label>Appendix 1—figure 7.</label><caption><title>UMAP projections of A6 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig7-v3.tif"/></fig><fig id="app1fig8" position="float"><label>Appendix 1—figure 8.</label><caption><title>UMAP projections of A7 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig8-v3.tif"/></fig><fig id="app1fig9" position="float"><label>Appendix 1—figure 9.</label><caption><title>UMAP projections of A8 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig9-v3.tif"/></fig><fig id="app1fig10" position="float"><label>Appendix 1—figure 10.</label><caption><title>UMAP projections of A9 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig10-v3.tif"/></fig><fig id="app1fig11" position="float"><label>Appendix 1—figure 11.</label><caption><title>UMAP projections of H1 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig11-v3.tif"/></fig><fig id="app1fig12" position="float"><label>Appendix 1—figure 12.</label><caption><title>UMAP projections of H2 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig12-v3.tif"/></fig><fig id="app1fig13" position="float"><label>Appendix 1—figure 13.</label><caption><title>UMAP projections of H3 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig13-v3.tif"/></fig><fig id="app1fig14" position="float"><label>Appendix 1—figure 14.</label><caption><title>UMAP projections of H4 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig14-v3.tif"/></fig><fig id="app1fig15" position="float"><label>Appendix 1—figure 15.</label><caption><title>UMAP projections of H5 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig15-v3.tif"/></fig><fig id="app1fig16" position="float"><label>Appendix 1—figure 16.</label><caption><title>UMAP projections of L1 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig16-v3.tif"/></fig><fig id="app1fig17" position="float"><label>Appendix 1—figure 17.</label><caption><title>UMAP projections of L2 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig17-v3.tif"/></fig><fig id="app1fig18" position="float"><label>Appendix 1—figure 18.</label><caption><title>UMAP projections of L3 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig18-v3.tif"/></fig><fig id="app1fig19" position="float"><label>Appendix 1—figure 19.</label><caption><title>UMAP projections of L4 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig19-v3.tif"/></fig><fig id="app1fig20" position="float"><label>Appendix 1—figure 20.</label><caption><title>UMAP projections of L5 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig20-v3.tif"/></fig><fig id="app1fig21" position="float"><label>Appendix 1—figure 21.</label><caption><title>UMAP projections of L6 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig21-v3.tif"/></fig><fig id="app1fig22" position="float"><label>Appendix 1—figure 22.</label><caption><title>UMAP projections of L7 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig22-v3.tif"/></fig><fig id="app1fig23" position="float"><label>Appendix 1—figure 23.</label><caption><title>UMAP projections of L8 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig23-v3.tif"/></fig><fig id="app1fig24" position="float"><label>Appendix 1—figure 24.</label><caption><title>UMAP projections of L9 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig24-v3.tif"/></fig><fig id="app1fig25" position="float"><label>Appendix 1—figure 25.</label><caption><title>UMAP projections of L10 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig25-v3.tif"/></fig><fig id="app1fig26" position="float"><label>Appendix 1—figure 26.</label><caption><title>UMAP projections of L11 sample against all other patient samples.</title><p>From top left to bottom right, the similarity measured by compaRe decreases as the degree of overlap decreases and the number of exclusive cell populations increases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig26-v3.tif"/></fig><fig id="app1fig27" position="float"><label>Appendix 1—figure 27.</label><caption><title>Band plots of AML and MDS patient samples.</title><p>The immunophenotype of each patient sample is shown in a multiparameter band-dot plot (HrMDS: higher-MDS, LrMDS: lower-MDS). Rectangles gate positive and/or negative populations of monocytic maturation markers as well as the CD11b marker.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig27-v3.tif"/></fig><fig id="app1fig28" position="float"><label>Appendix 1—figure 28.</label><caption><title>Correcting signal and cell viability drift.</title><p>(<bold>a</bold>) Intra- and inter-plate signal drift correction. Accumulation of green-blue tiles in the bottom right corner of the left heatmap shows signal drift in CD11b expression for drugs in plate 1. Sorting median expressions (MFIs) of wells into reading order (column wise left to right) reveals a linear slope. After correction, the slope becomes non-positive (intra-plate correction). Still, there are different baselines between the two plates. Matching median lines of corrected values of all plates correct for this bias (inter-plate correction). (<bold>b</bold>) Intra- and inter-plate cell viability correction. Accumulation of green tiles in the bottom right corner of the left heatmap shows cell viability drift (7-AAD marker). We follow similar steps with (<bold>a</bold>) for cell viability correction.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig28-v3.tif"/></fig><fig id="app1fig29" position="float"><label>Appendix 1—figure 29.</label><caption><title>Birabresib treatment leads to loss of CD45 and CD45-RA expression without loss of live cell numbers.</title><p>(<bold>a</bold>) Birabresib response as density scatter plot, CD45 vs CD45-RA. (<bold>b</bold>) Count of live cells per different concentrations of lenalidomide and birabresib. (<bold>c</bold>) Heatmap of birabresib response in all marker channels. (<bold>d</bold>) Example of response group 3: density scatter plots of DMSO-control vs. tretinoin 375 nM in different marker channels.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig29-v3.tif"/></fig><fig id="app1fig30" position="float"><label>Appendix 1—figure 30.</label><caption><title>Dispersion graph.</title><p>The (maximum spanning) tree demonstrates the dispersion of tens of potent antineoplastic agents around the control node containing negative controls (DMSO) and impotent agents. The drug library was analyzed by high-throughput flow cytometry coupled with compaRe in an AML human sample. Edge color and label show the amount of similarity between the agents. Impotent drugs are those which were similar enough to negative controls for a cutoff inferred during clustering. As the tree branches and spreads, drugs with stronger potency, usually with higher doses, tend to lie farther from the control node. Using the graph, the investigator can easily pick potent agents such as hits. The graph may also be potentially used to investigate different paths for mechanism of action, leading to different branches.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig30-v3.tif"/></fig><fig id="app1fig31" position="float"><label>Appendix 1—figure 31.</label><caption><title>Removal of noise, dead cells and doublet cells from mouse and human AML sample drug screening data.</title><p>(<bold>a</bold>) AML mouse model drug screening. (<bold>b</bold>) AML human sample drug screening. Cells were separated from debris using a side scatter height (SSC-H) vs forward scatter height (FSC-H) plot. Singlet cells were determined from FSC-H vs forward scatter area (FSC-A) plot. Live cells were separated from dead cells using a dead-cell-labelling dye, either 7-AAD or DRAQ7.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig31-v3.tif"/></fig><fig id="app1fig32" position="float"><label>Appendix 1—figure 32.</label><caption><title>Demonstration of compaRe algorithm using a 2-dimensional table.</title><p>It first forms an abstract square grid (red) encompassing all the data points within the range (1.1, 9.6). At the top level, all the cells (table rows) are in the region number (RN) 0. First iteration divides the first dimension formed by CD1 marker into 3 ( = <inline-formula><mml:math id="inf38"><mml:mi>n</mml:mi></mml:math></inline-formula>) subsets. Assuming a left-first numbering rule, the RN column is dynamically updated (blue column) for each subset using some information such as current RN (grey column), current dimension and possible number of families and siblings behind. For instance, child node 12 has parent node 3, could have two siblings (node 6, node 9) and two families (parent 1, parent 2) behind, although children 11 and 9 were never born as marked with ☓. Final leaves are called hypercubes (HCs). The corresponding grid on the biplot demonstrates that two regions which were devoid of data points have not been assigned any hypercube. For comparing two samples, they are first jointly normalized between a range. The tree graph is just for better visualization and will not be implemented.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73760-app1-fig32-v3.tif"/></fig> </sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.73760.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02feahw73</institution-id><institution>CNRS LPENS</institution></institution-wrap><country>France</country></aff></contrib></contrib-group></front-stub><body><p>This paper aims to address the current gap in the efficient analysis of large-scale multiparameter flow cytometry and other datasets. The authors offer a software toolkit with an efficient algorithm for comparing numerous samples at once. The study is well presented and is relevant to single cell analysis research.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.73760.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02feahw73</institution-id><institution>CNRS LPENS</institution></institution-wrap><country>France</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Tan</surname><given-names>Aik Choon</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01xf75524</institution-id><institution>Moffitt Cancer Center</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2021.01.08.425880">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2021.01.08.425880v4">the preprint</ext-link> for the benefit of readers; ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Comprehensive and unbiased multiparameter high-throughput screening by compaRe finds effective and subtle drug responses in AML models&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Aleksandra Walczak as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Aik Choon Tan (Reviewer #2).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>Please address all the reviewers comments. The reviewers agree it is a strong paper that is well written but certain improvements can still be made. Especially please give the reader more context in the introduction and compare your method with other existing methods.</p><p><italic>Reviewer #1:</italic></p><p>Comprehensive and unbiased multiparameter high-throughput screening by compaRe finds effective and subtle drug responses in AML models by Hajkariim et al. introduces a pipeline for pre-processing and analyzing data from multiplex flow cytometry and other technologies. Preprocessing steps include algorithms for correcting common sources of bias in such data. Another key feature is a robust approach to measuring cell similarity across samples. Among the strengths are that the manuscript is well-written, the analysis pipeline is well-motivated, and illustrated with apt examples. The similarity measure is very interesting as well.</p><p>There are a few weaknesses as well. It is not completely clear to me how this pipeline agrees and disagrees with common practice in the field. References 1-3, cited to document ongoing analytic challenges, are all at least 5 years old. Comparisons to other approaches, including the use Jensen-Shannon Divergence for similarity, make a convincing case that the proposed method is both effective and computationally efficient, but it is not clear if the comparators represent true standard of practice, or mere straw men. Methodologies are complex and can be difficult to follow, especially the similarity measure.</p><p>I would like to see the current state of the field described more clearly in the introduction, as context for the current effort. What makes this unique and important today? This type of clustering is common in single cell sequencing analysis, is it also commonly done in multiplex flow etc, maybe with less computationally demanding tools than JSD? If not, why not?</p><p>I think I understand how the similarity measure here works, though its hard to follow the details. Its very interesting, but to be honest, I can't decide if I think its a good solution or needlessly complex. The key, as I understand it, is the binning into &quot;relative&quot; expression groups. This is, after all, how 2-dimensional flow data is commonly interpreted – with plots treated as a visual 2 X 2 table, with row and column boundaries existing largely in the eye of the beholder. The methods need to be clearer throughout, esp. this part. It might help to add another author, a third party who has to understand the method from scratch, and who, having not lived with the details as long, might be expected to provide a more user friendly sense of the overall approach.</p><p><italic>Reviewer #2:</italic></p><p>In this manuscript, Hajkarim et al. developed compaRe, a user friendly software suite (written in R) for analyzing high-throughput, multi-parameter screening data. There are several modules included in the compaRe toolkit, which can be individually invoked to perform specific tasks, such as quality control, bias correction, pairwise comparisons, clustering and data visualization. All of these modules are available as command-line version and a GUI version for users to use in data analysis, visualization and results interpretation. The authors showed the utility of their toolkit in analyzing multiparameter mass and flow cytometric data from AML and MDS patient samples. Through this analysis using compaRe, the authors showed that they can identify patient heterogeneity and drug response profiles. Overall, this is a well organized and written manuscript describing the development of the new compaRe toolkit. The method is clearly described, and the user manual/tutorial is easy to follow. It seems like compaRe will be a useful toolkit for the research community, which is eager for a one-stop pipeline for analyzing high-throughout multiparameter screening data.</p><p>et al.</p><p>Strengths:</p><p>1. All of these modules are available as command-line version and a GUI version for users to use in data analysis, visualization and results interpretation.</p><p>2. The authors showed the utility of their toolkit in analyzing multiparameter mass and flow cytometric data from AML and MDS patient samples. Through this analysis using compaRe, the authors showed that they can identify patient heterogeneity and drug response profiles.</p><p>3. Overall, this is a well organized and written manuscript describing the development of the new compaRe toolkit. The method is clearly described, and the user manual/tutorial is easy to follow.</p><p>4. It seems like compaRe will be a useful toolkit for the research community, which is eager for a one-stop pipeline for analyzing high-throughout multiparameter screening data.</p><p>Weaknesses:</p><p>1. The current manuscript didn't compare with some other existing programs/software in analyzing flow and mass cytometry data. It will be important to compare compaRe with existing tools, to show the strengths and weaknesses of compaRe with other tools.</p><p>2. The authors could think about adding an additional module to integrate other &quot;omics&quot; data (e.g. such as mutational or gene expression/signatures or pathways), this could be useful for doing the clustering step or to identify patients having the same mutational profiles.</p><p><italic>Reviewer #3:</italic></p><p>Hajkarim et al. implement an algorithm in their presented toolkit compaRe to compare samples based on the similarities of samples, distinct from the more commonly used meta-clustering approaches, such as PhenoGraph, or dimensional reduction with Jenssen-Shannon Divergence analysis. Similarities among samples are calculated based on the proportions of cells within a sample belonging to an n-dimensional &quot;hypercubes&quot; (or &quot;hypergridding&quot; that is actually mass-aware and not blind) that are stratified by expression levels for n number of markers. The authors demonstrate that this method is much more time-efficient, obviates subsampling, and is robust to batch effects. This method is particularly appropriate for large-scale datasets, facilitating the comparison of numerous samples which would be helpful in screening efforts. The manuscript is written and presented well.</p><p>Major strengths:</p><p>1. The study demonstrates sufficiently strong support for the toolkit's ability to determine similarity across samples and its computing efficiency with Figure 2, an important advantage of this tool.</p><p>2. Compared to other approaches, the method is advantageous for identifying groups of samples that may be similar in a very large-scale dataset. CompaRe does not require (or make use of) manual expert annotation of meta-clusters. The workflow is efficient and unbiased.</p><p>Major weakness:</p><p>A major weakness of the current presentation of the study is that it has not clearly demonstrated the toolkit's utility in exploring specific phenotypes in-depth within a high-parameter dataset. The following are two examples in which this limitation is relevant, and the authors may address this to strengthen this paper, if in fact detailed phenotyping is considered by the authors as an important feature of the toolkit. If not, the authors should revise the manuscript as such.</p><p>First, the authors stated that their approach can be used to &quot;optimize true cytometric n-dimensional immunophenotypic characterization&quot; even in the setting of multi-panel workflow. However, the demonstration was based on samples that seem to have predominant phenotypes that are almost mutually exclusive. It is unlikely that this toolkit would be useful for reliable phenotypic characterization in a largely heterogeneous population of cell types, e.g. even in normal peripheral blood, unless a high number of parameters was concurrently acquired within the dataset. This is an inherent limitation. Nonetheless, a revision to demonstrate how compaRe can evaluate specific clusters of phenotypes with biological significance from a high-parameter dataset (20-30 marker cytometry) would be very helpful.</p><p>Second, the authors refer to the method's ability to include all rare cell subsets in the analysis, i.e. the ability to forego any subsampling. The work does not, however, demonstrate clearly how the presence of a rare cell subset in a given sample influences its similarity to other samples. Thus, the toolkit's value of being able to include such a rare subset in the analysis remains unestablished. It would be beneficial to include such a test to see whether the algorithm is sensitive to such changes.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.73760.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>Please address all the reviewers’ comments. The reviewers agree it is a strong paper that is well written but certain improvements can still be made. Especially please give the reader more context in the introduction and compare your method with other existing methods.</p><p>Reviewer #1:</p><p>[…] There are a few weaknesses as well. It is not completely clear to me how this pipeline agrees and disagrees with common practice in the field. References 1-3, cited to document ongoing analytic challenges, are all at least 5 years old. Comparisons to other approaches, including the use Jensen-Shannon Divergence for similarity, make a convincing case that the proposed method is both effective and computationally efficient, but it is not clear if the comparators represent true standard of practice, or mere straw men. Methodologies are complex and can be difficult to follow, especially the similarity measure.</p><p>I would like to see the current state of the field described more clearly in the introduction, as context for the current effort. What makes this unique and important today? This type of clustering is common in single cell sequencing analysis, is it also commonly done in multiplex flow etc, maybe with less computationally demanding tools than JSD? If not, why not?</p></disp-quote><p>Thank you for your comments. We believe compaRe is a unique tool in that it is designed specifically to cluster samples. Other methods that are commonly used for the analysis of mass/flow cytometry data are primarily designed to cluster cells within samples. The obtained cell clustering information is subsequently used for assessing similarity between samples by meta-clustering. Also, using clustering-free algorithms is often computationally expensive and not as robust as one may wish. For example, JSD was employed to compare samples, but it is not efficient for comparing a large number of samples, and, as we showed in the results, is computationally expensive.</p><p>We had previously highlighted these limitations by comparing the outcome of a compaRe analysis to meta-clustering and JSD. We have now provided the comparisons with other well-established and commonly used cell clustering approaches for mass/flow cytometry: FlowSOM and SPADE (main text lines 113-115 and Appendix 1-figure 31). To make these points clearer, we have modified the Introduction. Specifically, we added that:</p><p>i. Main text lines 33-35: ‘These technologies can test hundreds of samples (such as drug treatments) each with tens of thousands of events (e.g., cells) labeled for numerous biomarkers (such as cytoplasmic or membrane markers).’</p><p>ii. Main text lines 43-48: ‘Meta-clustering with single-cell clustering algorithms has been suggested to cluster samples based on the similarity of the centroids of cell subpopulations identified in the individual samples (5-8). While these algorithms are widely used in single-cell data analysis for clustering cells, they are not efficient for clustering of samples. This is because centroid-based analysis can be misleading when subclusters are not sufficiently distinct or the number of sub-clusters varies.’</p><p>iii. Main text 56-58: ‘Available computational toolkits mostly allow for single-parameter or unautomated analyses of large-scale screening data using the aforementioned methods. In these toolkits, each well should be first represented by a single parameter such as cell counts or centroids or they require manual intervention.’</p><disp-quote content-type="editor-comment"><p>I think I understand how the similarity measure here works, though it’s hard to follow the details. It’s very interesting, but to be honest, I can't decide if I think it’s a good solution or needlessly complex. The key, as I understand it, is the binning into &quot;relative&quot; expression groups. This is, after all, how 2-dimensional flow data is commonly interpreted – with plots treated as a visual 2 X 2 table, with row and column boundaries existing largely in the eye of the beholder. The methods need to be clearer throughout, esp. this part. It might help to add another author, a third party who has to understand the method from scratch, and who, having not lived with the details as long, might be expected to provide a more user friendly sense of the overall approach.</p></disp-quote><p>Dynamic programming is key for reducing processing power. We try to explain the concept more clearly as follows (also added to the Appendix 1 lines 114-120). As you pointed out, the goal is to bin/grid data into relative expression groups (hypercubes). Gridding can be implemented by a simple algorithm dividing each dimension in each iteration. However, after a couple of rounds, this naïve algorithm turns out to be infeasible. This can be shown through visualizing the gridding algorithm by a tree graph (Appendix 1-figure 29). The tree clearly shows that the comparison complexity of the gridding algorithm is exponential since the tree grows exponentially. Therefore, we were forced to use a more efficient algorithm for implementing gridding. Dynamic programming (algorithm) turned out to be quite effective. What makes dynamic programming very effective is its ability to memorize the values computed in the previous iterations avoiding recomputing potentially expensive algebraic operations (Appendix 1-equation 3). Moreover, considering that any signal drift correction is essentially an approximate method, the robustness of this algorithm to noise creates a synergistic effect. Therefore, we believe that the current description about similarity measure is required.</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>[…] 1. The current manuscript didn't compare with some other existing programs/software in analyzing flow and mass cytometry data. It will be important to compare compaRe with existing tools, to show the strengths and weaknesses of compaRe with other tools.</p></disp-quote><p>Thank you for your comments. We previously benchmarked compaRe’s similarity module against meta-clustering with several cell clustering methods and selected widely used PhenoGraph which performed better than others (considering several factors). We also used JSD as a clustering-free approach. In response to the request from the reviewer, we have now added the comparisons with SPADE and FlowSOM, two other commonly used algorithms for the analysis of flow and mass cytometry data (main text lines 113-115 and Appendix 1-figure 31). However, please note that available automated and commonly used tools are primarily cell clustering/automatic gating approaches. These include methods such as PhenoGraph, SPADE, and FlowSOM. A key reason why compaRe outperforms these and other methods is that they are designed to cluster cells rather than samples, while compaRe clusters samples.</p><disp-quote content-type="editor-comment"><p>2. The authors could think about adding an additional module to integrate other &quot;omics&quot; data (e.g. such as mutational or gene expression/signatures or pathways), this could be useful for doing the clustering step or to identify patients having the same mutational profiles.</p></disp-quote><p>Drug response in association with genetic alterations is one of the applications of compaRe. The genetic alteration can be visualized in the clusters that compaRe identifies. However, at the moment, we do not have relevant data to apply this type of analysis for visualization. To highlight that the functionality for this type of analyses exists within compRe, we have now explained this in the main text lines 212-213.</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>[…] A major weakness of the current presentation of the study is that it has not clearly demonstrated the toolkit's utility in exploring specific phenotypes in-depth within a high-parameter dataset. The following are two examples in which this limitation is relevant, and the authors may address this to strengthen this paper, if in fact detailed phenotyping is considered by the authors as an important feature of the toolkit. If not, the authors should revise the manuscript as such.</p><p>First, the authors stated that their approach can be used to &quot;optimize true cytometric n-dimensional immunophenotypic characterization&quot; even in the setting of multi-panel worklow. However, the demonstration was based on samples that seem to have predominant phenotypes that are almost mutually exclusive. It is unlikely that this toolkit would be useful for reliable phenotypic characterization in a largely heterogeneous population of cell types, e.g. even in normal peripheral blood, unless a high number of parameters was concurrently acquired within the dataset. This is an inherent limitation. Nonetheless, a revision to demonstrate how compaRe can evaluate specific clusters of phenotypes with biological significance from a high-parameter dataset (20-30 marker cytometry) would be very helpful.</p></disp-quote><p>Thank you for your comments. To address this comment, we generated Appendix 1-figure 32 and added the result to the main text lines 124-131. As compaRe measures the similarity between cluster morphologies, we carried out an analysis in which cells from a cluster (an immunophenotypic cell population) were gradually removed to contort its configuration. We used a dataset of 3 healthy and 2 pediatric AML bone marrow mononuclear cell samples from the data provided in the 6th reference. Samples were stained with 29 (15 membrane and 14 intracellular signaling) markers. Taking H1 as reference, we gradually removed 25%, 50%, 75% and 100% (phenotypic changes) of cells from a target cluster identified by PhenoGraph. As the UMAP projections show, the similarity decreased concurrently and more drastically when phenotypic changes were detected.</p><disp-quote content-type="editor-comment"><p>Second, the authors refer to the method's ability to include all rare cell subsets in the analysis, i.e. the ability to forego any subsampling. The work does not, however, demonstrate clearly how the presence of a rare cell subset in a given sample influences its similarity to other samples. Thus, the toolkit's value of being able to include such a rare subset in the analysis remains unestablished. It would be beneficial to include such a test to see whether the algorithm is sensitive to such changes.</p></disp-quote><p>We previously discussed in the manuscript that ‘the poor performance of JSD indicates that this approach can work well only in the absence of signal shift. It is of particular note that compaRe does not need subsampling or dimension reduction of the input data, avoiding the risk of losing rare subpopulations.’ The use of full data rather than subsampled data allows for more robust analyses, in part, simply, owing to using more data and the ability to establish a more refined overall cell cluster morphology of each sample.</p><p>Additionally, in the analysis explained above (Appendix 1-figure 32), the 75% sample potentially resembles a rare cell population, a cell cluster with a small number of cells. The analysis demonstrated compaRe was sensitive enough to maintain a certain similarity in the presence of a rare cell population, as the similarity score was reduced when this population was gone in the 100% sample. Nonetheless, since subsampling does not necessarily lose rare subpopulations and to avoid confusion, we removed the phrase ‘avoiding the risk of losing rare subpopulations’ from the discussion.</p></body></sub-article></article>