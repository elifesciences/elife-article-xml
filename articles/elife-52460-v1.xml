<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">52460</article-id><article-id pub-id-type="doi">10.7554/eLife.52460</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Recurrent circuit dynamics underlie persistent activity in the macaque frontoparietal network</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-159596"><name><surname>Hart</surname><given-names>Eric</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6042-8389</contrib-id><email>ehart004@gmail.com</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-21382"><name><surname>Huk</surname><given-names>Alexander C</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1430-6935</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Center for Perceptual Systems, Department of Neuroscience, Department of Psychology, The University of Texas at Austin</institution><addr-line><named-content content-type="city">Austin</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Salinas</surname><given-names>Emilio</given-names></name><role>Reviewing Editor</role><aff><institution>Wake Forest School of Medicine</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Behrens</surname><given-names>Timothy E</given-names></name><role>Senior Editor</role><aff><institution>University of Oxford</institution><country>United Kingdom</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>07</day><month>05</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e52460</elocation-id><history><date date-type="received" iso-8601-date="2019-10-04"><day>04</day><month>10</month><year>2019</year></date><date date-type="accepted" iso-8601-date="2020-04-23"><day>23</day><month>04</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, Hart and Huk</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Hart and Huk</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-52460-v1.pdf"/><abstract><p>During delayed oculomotor response tasks, neurons in the lateral intraparietal area (LIP) and the frontal eye fields (FEF) exhibit persistent activity that reflects the active maintenance of behaviorally relevant information. Despite many computational models of the mechanisms of persistent activity, there is a lack of circuit-level data from the primate to inform the theories. To fill this gap, we simultaneously recorded ensembles of neurons in both LIP and FEF while macaques performed a memory-guided saccade task. A population encoding model revealed strong and symmetric long-timescale recurrent excitation between LIP and FEF. Unexpectedly, LIP exhibited stronger local functional connectivity than FEF, and many neurons in LIP had longer network and intrinsic timescales. The differences in connectivity could be explained by the strength of recurrent dynamics in attractor networks. These findings reveal reciprocal multi-area circuit dynamics in the frontoparietal network during persistent activity and lay the groundwork for quantitative comparisons to theoretical models.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>persistent activity</kwd><kwd>LIP</kwd><kwd>FEF</kwd><kwd>GLM</kwd><kwd>working memory</kwd><kwd>coupling</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Rhesus macaque</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>IIS-173491</award-id><principal-award-recipient><name><surname>Huk</surname><given-names>Alexander C</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000053</institution-id><institution>National Eye Institute</institution></institution-wrap></funding-source><award-id>R01-EY017366</award-id><principal-award-recipient><name><surname>Huk</surname><given-names>Alexander C</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000053</institution-id><institution>National Eye Institute</institution></institution-wrap></funding-source><award-id>T32-EY021462</award-id><principal-award-recipient><name><surname>Hart</surname><given-names>Eric</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Simultaneous recordings of neural ensembles in both the frontal and parietal cortices reveal how persistent activity can be maintained in the primate brain during visuospatial working memory.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Persistent neural activity is prevalent in many cortical and subcortical areas (<xref ref-type="bibr" rid="bib4">Andersen et al., 1987</xref>; <xref ref-type="bibr" rid="bib12">Bruce and Goldberg, 1985</xref>; <xref ref-type="bibr" rid="bib21">Constantinidis and Steinmetz, 1996</xref>; <xref ref-type="bibr" rid="bib26">Fuster and Alexander, 1971</xref>; <xref ref-type="bibr" rid="bib27">Fuster and Jervey, 1981</xref>; <xref ref-type="bibr" rid="bib10">Bolkan et al., 2017</xref>; <xref ref-type="bibr" rid="bib23">Ferraina et al., 2002</xref>; <xref ref-type="bibr" rid="bib33">Guo et al., 2017</xref>; <xref ref-type="bibr" rid="bib36">Inagaki et al., 2019</xref>; <xref ref-type="bibr" rid="bib43">Mays and Sparks, 1980</xref>; <xref ref-type="bibr" rid="bib58">Schmitt et al., 2017</xref>), and has been studied extensively in the context of delayed oculomotor response tasks (<xref ref-type="bibr" rid="bib24">Funahashi et al., 1989</xref>; <xref ref-type="bibr" rid="bib30">Gnadt and Andersen, 1988</xref>; <xref ref-type="bibr" rid="bib34">Hikosaka and Wurtz, 1983</xref>). In these tasks, a subject must remember the location of a visual stimulus and make a saccadic eye movement to that location after a delay. During this delay period, single neurons in many primate brain areas, such as the lateral intraparietal area (LIP) and frontal eye fields (FEF), continue to spike vigorously in absence of the stimulus, leading up to the behavioral response (<xref ref-type="bibr" rid="bib8">Balan and Ferrera, 2003</xref>; <xref ref-type="bibr" rid="bib16">Clark et al., 2012</xref>; <xref ref-type="bibr" rid="bib24">Funahashi et al., 1989</xref>; <xref ref-type="bibr" rid="bib30">Gnadt and Andersen, 1988</xref>). This neural activity bridges sensory inputs with subsequent motor outputs and is thought to reflect the active maintenance of information in working memory, a process that forms the basis of many complex adaptive behaviors (<xref ref-type="bibr" rid="bib7">Baddeley, 2012</xref>).</p><p>Because persistent activity lasts far longer than the intrinsic cellular time constants of most neurons, theoretical models of persistent activity have focused on how a mix of circuit and cellular mechanisms might interact to transcend the timescale of individual neurons. Classically, these models rely on a core architecture that includes recurrent excitatory connectivity, balanced inhibition, and a subset of single neurons with long (but realistic) intrinsic time constants (<xref ref-type="bibr" rid="bib3">Amit and Brunel, 1997</xref>; <xref ref-type="bibr" rid="bib19">Compte, 2006</xref>; <xref ref-type="bibr" rid="bib18">Compte et al., 2000</xref>; <xref ref-type="bibr" rid="bib64">Tegnér et al., 2002</xref>; <xref ref-type="bibr" rid="bib65">Wang, 1999</xref>; <xref ref-type="bibr" rid="bib66">Wang, 2001</xref>). Although these models are remarkable for using biologically plausible elements to show how the brain could in theory exhibit persistent activity at an aggregate level, little is known about the detailed patterns of circuit-scale spiking activity in the primate brain areas that originally motivated these theories. Furthermore, population models have yet to reconcile the fact that real neurons with persistent activity are often highly dynamic, heterogeneous, and exhibit mixtures of sensory and motor response components (<xref ref-type="bibr" rid="bib44">Meister et al., 2013</xref>; <xref ref-type="bibr" rid="bib53">Premereur et al., 2011</xref>; <xref ref-type="bibr" rid="bib54">Rigotti et al., 2013</xref>).</p><p>To fill these gaps, we conducted simultaneous recordings of neural ensembles in LIP and FEF during a memory-guided saccade task and characterized the trial-by-trial dynamics in this circuit with a multi-neuron generalized linear model (GLM). This task is often employed to evoke persistent responses in both LIP and FEF, and is routinely used to identify neurons with long timescale dynamics that are thought to play a role in sensory integration (<xref ref-type="bibr" rid="bib14">Chafee and Goldman-Rakic, 1998</xref>; <xref ref-type="bibr" rid="bib31">Gold and Shadlen, 2007</xref>). It also serves as the fundamental test case for modeling persistent activity in theoretical studies (<xref ref-type="bibr" rid="bib47">Murray et al., 2017a</xref>; <xref ref-type="bibr" rid="bib48">Murray et al., 2017b</xref>; <xref ref-type="bibr" rid="bib60">Spaak et al., 2017</xref>). The population-level GLM allowed us to isolate the effects of each neuron’s spiking activity on the activity of other simultaneously recorded neurons, while statistically parceling out the effects of shared task variables (such as visual responses to the flashed target, and motor responses related to the impending saccade). This analysis revealed remarkably strong and slow recurrent excitation both within and between areas. Interneuronal coupling between LIP and FEF was highly reciprocal, without a clear asymmetry between feedforward and feedback connections. Furthermore, the spiking activity of most neurons was driven by spikes from other neurons more than the cell’s own recent spike history. In addition to slow recurrent excitation, inhibition with moderate timescales was also present, followed by more standard fast timescale excitation. The existence of corresponding inhibitory interactions lends support to the idea that inhibition may act as a stabilizing mechanism to curb runaway excitation.</p><p>Together, these results demonstrate the core aspects of theoretical models (i.e. slow recurrent excitation, balancing inhibition) while also providing quantitative estimates of the various timescales and magnitudes of these theorized components. However, we also found that there were stronger local functional interactions within LIP than FEF, and that many neurons in LIP had longer spike-history and coupling timescales. These aspects of our results run contrary to recent theoretical hypotheses about the relative roles of LIP and FEF (e.g. <xref ref-type="bibr" rid="bib48">Murray et al., 2017b</xref>), but concur with previous findings that examine correlations between pairs of neurons locally in each area (<xref ref-type="bibr" rid="bib37">Katsuki et al., 2014</xref>). By analyzing synthetic spike trains from a classic ‘bump’ attractor network used to model spatial working memory (<xref ref-type="bibr" rid="bib18">Compte et al., 2000</xref>; <xref ref-type="bibr" rid="bib29">Gerstner et al., 2014</xref>), we found that the differences in coupling between LIP and FEF could be explained by differences in the strength of recurrent connections in attractor networks. Interestingly, this analysis revealed that both areas could support persistent activity independently, but between-area interactions alone were insufficient to generate persistent activity (despite reflecting statistically-significant coupling). Thus, our results support and refine key components in models of persistent activity, and offer unexpected insights into how and where the brain implements circuit-based computations critical for linking sensation and action over time.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Simultaneous recordings in LIP and FEF during memory-guided saccades</title><p>In order to test whether recurrent functional interactions in the frontoparietal network underlie persistent activity, we recorded ensembles of neurons (~5–20 cells per session) in areas LIP and FEF simultaneously (<xref ref-type="fig" rid="fig1">Figure 1a</xref>; 967 units, LIP: 407; FEF: 560; 7448 pairs). This allowed us to measure and compare the neuronal interactions both locally (within a cortical area) and over longer distances (between cortical areas). Macaques performed a classical memory-guided saccade task with two crucial refinements. First, the timing of all trial events including the delay period was variable (<xref ref-type="fig" rid="fig1">Figure 1b</xref>). Second, the location of the target was continuously jittered in space, thus the ensuing saccades also had variability in their timings and endpoints. This trial-by-trial spatiotemporal variability allowed us to fit a population encoding model (on ensembles of simultaneously-recorded neurons) at the level of single trials which, in turn, enabled us to disentangle the relative influences of various task events and network activity on the spiking activity of each recorded neuron. The saccade target was presented either within the constellation of receptive fields (‘in-RF’) of the neurons under study (in the hemifield contralateral relative to the recording sites), or diametrically opposed in the ipsilateral hemifield (‘out-RF’; <xref ref-type="fig" rid="fig1">Figure 1c</xref>). <xref ref-type="fig" rid="fig1">Figure 1</xref> (d,e bottom) shows two example simultaneously recorded neurons with canonical responses. Each example neuron responded transiently to the visual target, and exhibited stimulus-selective persistent activity throughout the delay period. However, even in these example cells (selected to show robust and fairly constant persistent activity), substantial variability was present in their single-trial responses, reinforcing the value of an analysis scheme that can capture single-trial dynamics when assessing interactions between neurons (rasters <xref ref-type="fig" rid="fig1">Figure 1d,e</xref> top).</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Memory-guided saccade task and simultaneously recorded neurons in LIP and FEF.</title><p>(<bold>a</bold>) Linear (stereotrode) probes (24–32 channels) were used to record in both LIP and FEF. (<bold>b</bold>) The timings of task events were varied continuously from trial to trial, making the delay (memory) period variable. (<bold>c</bold>) The monkey fixates and a target is flashed in the periphery (either ‘in’ or ‘out’ of the receptive fields); after a delay period (in which the monkey must maintain fixation) the fixation point is removed, indicating a ‘go-signal,’ and the monkey must make a saccade to where the target was. (<bold>d,e</bold>) Simultaneously recorded neurons in LIP (<bold>d</bold>) and FEF (<bold>e</bold>) with canonical responses. Each has a transient response to the visual target and a sustained response throughout the delay period (PSTH, bottom image). Even in these example neurons with strong persistent activity, there is significant variability during single trials (rasters, top image).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52460-fig1-v1.tif"/></fig><p>Persistent activity is traditionally observed (and quantified) in the average responses of neurons across many trials, but during natural behavior, the monkey must remember the stimulus and make decisions based solely on individual trials. To characterize and exploit the dynamics of single-trial responses across the circuit, we developed a population encoding model (i.e. a fully coupled generalized linear model [GLM]; <xref ref-type="fig" rid="fig2">Figure 2a</xref>). This regression-based statistical approach describes the time-varying spike rate of each neuron in terms of the external task events (i.e. the visual target being flashed and the saccadic response), the recent spike-history of that neuron, and the activity of other simultaneously recorded neurons. This approach allowed us to investigate the single-trial interactions between neurons while parceling out the influences of the visual stimulus (<xref ref-type="fig" rid="fig2">Figure 2b</xref>, first column), the motor response (<xref ref-type="fig" rid="fig2">Figure 2c</xref>), and each neuron’s autocorrelation (i.e. the ‘spike-history’; <xref ref-type="fig" rid="fig2">Figure 2d</xref>). We characterized the functional interactions between neurons with ‘coupling kernels,’ which describe the statistical dependencies between single-trial spike trains over time (<xref ref-type="fig" rid="fig2">Figure 2e</xref>). Critically, these coupling terms explain variance not explained by the other predictors, and are fit directionally (i.e. they capture the impact of one neuron’s spikes on the subsequent activity of another neuron). The population GLM goes beyond simple pairwise comparisons by fitting the model using spikes from all simultaneously recorded neurons. Thus, the ‘full’ population GLM characterizes the response of the fitted neuron with respect to the spiking activity of all the other neurons, providing a less ambiguous characterization than standard one-pair-at-a-time pairwise correlations (<xref ref-type="bibr" rid="bib61">Stevenson et al., 2008</xref>). This model-based approach provides a disentangled estimate of spike-on-spike coupling across all recorded neurons, while simultaneously parsing out the shared drive due to the stimulus or motor response (i.e. it naturally ‘models out’ the signal correlation).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Population encoding model and analysis of example session.</title><p>(<bold>a</bold>) This generalized linear model (GLM)-based approach describes the time-varying spike rate of each neuron in terms of the external task events (i.e. the saccade target being flashed and the saccadic response), the recent spike-history of that neuron, and the activity of other simultaneously recorded neurons (within and across regions). The model is defined by three stages: 1) a linear stage that takes a weighted sum of the covariates and temporal filters, 2) an exponential point non-linearity that converts the linear output to a spike rate, and 3) conditionally Poisson spiking. (<bold>b–g</bold>) Each row corresponds to a neuron (1–3 in FEF, 4–8 LIP) and each column corresponds to the kernel of a particular predictor: (<bold>b</bold>) onset of the visual target; target in RF (solid line) and out RF (dashed line), (<bold>c</bold>) time of the saccade response, (<bold>d</bold>) recent spike-history and (<bold>e</bold>) coupling from other neurons (in LIP: green; in FEF: blue). Each kernel represents the time-varying gain on spiking for the fitted neuron due to the particular predictor while simultaneously accounting for the influence of the other predictors. (<bold>f,g</bold>) Each column displays the true PSTH (dashed lines) and predicted PSTH (solid lines) for each neuron (rows) for targets in (dark lines) and out (light lines) of the RF, aligned to the (<bold>f</bold>) target on and the (<bold>g</bold>) saccade. The predicted PSTHs were constructed from generating single-trial spike trains from the full population model for each neuron and averaging them.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52460-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Cross-correlations of the example session (<xref ref-type="fig" rid="fig2">Figure 2</xref>) and the relationship between coupling and correlations.</title><p>(<bold>a</bold>) Cross-correlograms for all pairs of neurons in the example session. Center bin was removed from the autocorrelations for visualization purposes. (<bold>b</bold>) The relationship between peak coupling (estimated from the GLM) and the peak of the cross-correlations (R-squared = 0.57).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52460-fig2-figsupp1-v1.tif"/></fig></fig-group><p>The example session (<xref ref-type="fig" rid="fig2">Figure 2b–e</xref>) showcases the diversity of responses of eight simultaneously recorded neurons. The GLM captures all aspects of the apparent heterogeneity well: idiosyncrasies in temporal dynamics, variations in functional interactions, and cell-to-cell differences in stimulus dependence. As an initial standard validation, we simulated single-trial spike trains from the GLM fits and averaged these to calculate a predicted peristimulus time histogram (PSTH), which captured the average responses of each neuron quite well (<xref ref-type="fig" rid="fig2">Figure 2f,g</xref>). The GLM-derived measure of coupling reveals similar patterns as seen via traditional measures of correlations (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>; <xref ref-type="bibr" rid="bib52">Pillow et al., 2008</xref>) but offers the advantage that it can ‘explain away’ potentially misleading correlations by leveraging the simultaneous fits across the ensemble of neurons and thus provides a cleaner estimate of the true functional connectivity of the network (<xref ref-type="bibr" rid="bib61">Stevenson et al., 2008</xref>). Although of course a perfect characterization would require measuring every single neuron in the network (<xref ref-type="bibr" rid="bib1">Aertsen et al., 1989</xref>), these methods have been previously validated in physiological circuits with better-known connectivity (<xref ref-type="bibr" rid="bib28">Gerhard et al., 2013</xref>; <xref ref-type="bibr" rid="bib52">Pillow et al., 2008</xref>).</p></sec><sec id="s2-2"><title>Strong coupling exists both within and between areas but is stronger within LIP</title><p>Strong coupling was observed throughout the frontoparietal network. We quantified the overall coupling strength for each pair of simultaneously recorded neurons by summing the weight of each coupling kernel, allowing the overall effect of coupling for each neuron pair to be excitatory or inhibitory (i.e. one neuron was more or less likely to spike given another neuron’s spike). <xref ref-type="fig" rid="fig3">Figure 3a</xref> (left column) summarizes the overall strengths of coupling for the four main classes of interneuronal interactions: both neurons within LIP (‘LIP-LIP’), both neurons within FEF (‘FEF-FEF’), from an LIP neuron to an FEF neuron (‘LIP-FEF’), and from an FEF neuron to an LIP neuron (‘FEF-LIP’). For all of these functional interactions, the observed coupling (colored bars in histograms) was far stronger than expected by a null distribution (gray bars, calculated by permuting the trial order of other neurons relative to the neuron being fitted, and then re-fitting the model; permuting the data in this way destroys the correlational structure between the neurons, but crucially preserves the spike times and model-based analysis of task events for all spike trains [<xref ref-type="bibr" rid="bib52">Pillow et al., 2008</xref>]; Wilcoxon rank-sum test, LIP-LIP, p=6.45×10<sup>−79</sup>; FEF-FEF, p=6.78×10<sup>−165</sup>; LIP-FEF, p=1.69×10<sup>−86</sup>; FEF-LIP, p=8.52×10<sup>−84</sup>). A large fraction of the individual coupling kernels was substantially greater than the null distribution (&gt;2 SD of mean of the null [~0]) for each area interaction (LIP-LIP = 60%; FEF-FEF = 54%; LIP-FEF = 60%; FEF-LIP = 58%).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Exceptionally strong coupling both within and between areas.</title><p>(<bold>a</bold>) Distributions of raw coupling weights (colored histograms) defined by the sum of each kernel for each area interaction (LIP-LIP, FEF-FEF, LIP-FEF, FEF-LIP). Positive weights denote an excitatory interaction (the fitted neuron was more likely to spike given that another neuron just spiked) and negative weights indicate an inhibitory interaction (the fitted neuron was less likely to spike given that another neuron just spiked). A null distribution was constructed by shuffling the order of the trials for each neuron (gray histograms), effectively destroying the correlations between the ensemble of neurons but preserving the stimulus dependence and spike times. These distributions describe the probability of observing coupling due to chance alone (Wilcoxon rank-sum test, p=6.45×10<sup>−79</sup>; p=6.78×10<sup>−165</sup>; p=1.69×10<sup>−86</sup>; p=8.52×10<sup>−84</sup>). (<bold>b</bold>) Principal components analysis was performed on the coupling kernels split by each area interaction (as in (<bold>a</bold>)); the first three principal components (dark to light lines) accounted for around 90% of the variance (legend: variance explained for each PC). (<bold>c</bold>) Cumulative fraction of coupling weights for each interaction, corresponding to the distributions in (<bold>a</bold>). (<bold>d</bold>) Variance explained of the predicted PSTHs of the coupled model vs. the uncoupled model (median 76% variance explained under both models). Coupling was unnecessary to capture the average response of most neurons (the points fell near the unity line). (<bold>e</bold>) Predicted single-trial spike times (in units of bits-per-spike) of the coupled model vs. the uncoupled model. Coupling improved the predictions of the single-trial spike trains by 22% on average (25% for LIP; 19% for FEF; points fell above the unity line).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52460-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Absolute magnitudes of coupling and overall excitation and inhibition.</title><p>The core results held for a comparison of the absolute differences in coupling (<bold>a</bold>) as well as the overall (<bold>b</bold>) excitation and (<bold>c</bold>) inhibition (computed from the raw coupling weights across all kernels) for all area interactions.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52460-fig3-figsupp1-v1.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Distributions of max coupling kernels (gain).</title><p>Comparisons of MT with LIP-LIP, FEF-FEF, LIP-FEF, FEF-LIP, (Wilcoxon rank-sum test): p=2.19e-143; p=6.92e-103; p=2.18e-07; p=7.98e-22. Magnitude of the effect size (Cohen’s D): LIP-LIP = 0.89 (large effect), FEF-FEF = 0.41 (medium effect), LIP-FEF = 0.16 (small effect), FEF-LIP = 0.24 (small effect). MT data was collected during a perceptual decision making task under conditions reported previously (<xref ref-type="bibr" rid="bib67">Yates et al., 2017</xref>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52460-fig3-figsupp2-v1.tif"/></fig></fig-group><p>Interneuronal coupling often manifested as excitatory interactions (i.e. positive values), but many instances of stronger-than-chance suppressive interactions were also evident (i.e. negative values). The coupling components were strongest for the within-LIP interactions, although within-FEF interactions were also far greater than chance levels. Between-area coupling (LIP-FEF and FEF-LIP) was also strong and spanned approximately the same range of magnitudes as the within-FEF interactions. These quantitative comparisons of the distributions of coupling strength are graphically apparent in the cumulative distributions (<xref ref-type="fig" rid="fig3">Figure 3c</xref>). The results also held for a comparison of the absolute coupling magnitudes, as well as a comparison of the overall excitation and inhibition (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>).</p><p>Beyond assessing the overall magnitudes of each interaction, we examined the time courses of the coupling kernels by performing principal components analysis (PCA) on all of the kernels within each of the four interaction types (LIP-LIP, FEF-FEF, LIP-FEF, and FEF-LIP), and plotted the first three PCs (which together accounted for ~90% of the variance). Across all interaction types, coupling was dominated by long timescale excitation, indicating that spikes from one neuron increased the gain on spiking of other neurons for up to ~200 ms (<xref ref-type="fig" rid="fig3">Figure 3b</xref>, first PC/darkest curves). A second, sharper, fast excitation component followed (<xref ref-type="fig" rid="fig3">Figure 3b</xref>, 2nd PC/medium shaded curves), and was more pronounced within both areas than between areas, consistent with this component reflecting local interneuronal interactions. Finally, a third component was primarily suppressive (<xref ref-type="fig" rid="fig3">Figure 3b</xref>, 3rd PC/lightest curves), with a timescale between the first (slow) and second (fast) excitatory components. The suppressive component was proportional to the fast excitation component in magnitude and lag. These three timescales and signs of interaction are ubiquitous in biophysical models of persistent activity, and are posited to reflect the relative contributions of NMDA, AMPA, and GABA receptors, respectively (<xref ref-type="bibr" rid="bib18">Compte et al., 2000</xref>; <xref ref-type="bibr" rid="bib32">Goldman-Rakic, 1995</xref>; <xref ref-type="bibr" rid="bib65">Wang, 1999</xref>).</p><p>We verified the fits across all sessions (<xref ref-type="fig" rid="fig3">Figure 3d</xref>) by comparing predicted PSTHs generated from the GLM to the true PSTHs (as in <xref ref-type="fig" rid="fig2">Figure 2f,g</xref>); the predicted PSTHs did a good job of explaining the real PSTHs of most neurons regardless of whether the neurons were treated independently (in an ‘uncoupled’ model with only task and history kernels) or not (in the ‘full’ coupled model with task, history, and coupling kernels; median 76% variance explained under both models). Although interneuronal coupling terms did not improve predictions of the average response (i.e., the PSTH; <xref ref-type="fig" rid="fig3">Figure 3d</xref>), they were important for capturing the spike times in single-trial spike trains (<xref ref-type="fig" rid="fig3">Figure 3e</xref>; the coupled model provides 22% more information on average). This distinction has been noted previously (<xref ref-type="bibr" rid="bib52">Pillow et al., 2008</xref>; <xref ref-type="bibr" rid="bib57">Runyan et al., 2017</xref>) and means that the shared variability of the population carries information about a single neuron’s spike trains beyond that provided by the task components alone, and is unsurprising given that the PSTHs naturally obscure the single-trial dynamics by averaging them away. These findings emphasize the value of this analysis scheme because it allows us to examine the single-trial dynamics of the network during the timescales relevant for working memory.</p><p>In addition to comparing the observed coupling to null (permutation-fitted) distributions and an uncoupled model (with independent neurons by design), we also compared our results in the LIP-FEF network to similar coupling quantifications from other brain areas and tasks. Coupling between simultaneously-recorded neurons in visual area MT (recorded in the lab for other projects), although detectable, was considerably weaker than observed in these experiments (mean gain of max coupling filters, MT-MT = 1.08; LIP-LIP = 1.34; FEF-FEF = 1.16, LIP-FEF = 1.10; FEF-LIP = 1.12; <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). Likewise, analysis of coupling between MT and LIP during a perceptual decision-making task was unable to detect interactions beyond that expected by chance (<xref ref-type="bibr" rid="bib67">Yates et al., 2017</xref>).</p><p>Thus, conventional statistical tests, quantitative and qualitative comparisons to a null distribution, and comparisons of effect sizes measured in other contexts, all point to the existence of exceptionally strong recurrent interactions within the frontoparietal network. These were most pronounced within area LIP but were prevalent throughout this multi-area circuit. These interactions were primarily excitatory, but also contained substantial instances of suppression. Between-area coupling was roughly symmetrical in strength and timescale (<xref ref-type="fig" rid="fig3">Figure 3a,b</xref>), consistent with anatomy (<xref ref-type="bibr" rid="bib5">Andersen et al., 1990</xref>; <xref ref-type="bibr" rid="bib23">Ferraina et al., 2002</xref>; <xref ref-type="bibr" rid="bib59">Selemon and Goldman-Rakic, 1988</xref>). Together, these results suggest a reciprocal inter-area network rather than a serial multi-stage system.</p></sec><sec id="s2-3"><title>Interneuronal coupling outweighs spike-history dynamics, especially in LIP</title><p>In the prior section, we described how certain neurons impacted the probability of other neurons’ subsequent spiking. It is also reasonable to expect that a cell’s own spiking affects the probability of its subsequent firing. To characterize the relative impacts of (interneuronal) coupling and (‘intrinsic’) spike-history for each neuron, we defined predictive indices as the difference between the performance of the GLM with and without coupling, or with and without spike-history. For example, a coupling index of one would indicate that the neuron’s spike trains are completely predictable from the spiking activity of other neurons, and a value of zero would mean that spikes from other neurons add no predictive power over and above the task predictors and the neuron’s recent spike-history. The history index was constructed in an analogous fashion.</p><p><xref ref-type="fig" rid="fig4">Figure 4</xref> shows the relative effects of interneuronal coupling and spike-history for neurons in both areas. A greater number of neurons in FEF were predicted by their own spike-history than in LIP (<xref ref-type="fig" rid="fig4">Figure 4a</xref>), whereas the spike trains of LIP neurons were better predicted by spikes from other neurons than the analogous case in FEF (<xref ref-type="fig" rid="fig4">Figure 4b</xref>). These contrasting results may reflect fundamental differences in the functional connectivity and distributions of cell types in the underlying neural populations (<xref ref-type="bibr" rid="bib42">Masse et al., 2017</xref>; <xref ref-type="bibr" rid="bib56">Rosenbaum et al., 2017</xref>). However, overall, neurons in both areas were more influenced by interneuronal coupling than by their own spike-history (<xref ref-type="fig" rid="fig4">Figure 4c</xref>), pointing to the importance of circuit-level interactions driving spiking activity. This is especially striking given that the coupling is estimated while also accounting for the responses of all neurons to the task events, and thus reflects the interactions while statistically controlling for shared responses due to visual and motor drive. Neurons in both LIP and FEF tended to be driven by either the concurrent spiking activity of the population, or by their own spike-history, with few neurons impacted equally by both (<xref ref-type="fig" rid="fig4">Figure 4c</xref>).</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Network drive dominates circuit dynamics, especially in LIP.</title><p>For each neuron, we constructed predictive indices to further assess the influence of the spiking activity from other neurons (coupling) and itself (history). These indices are defined as the difference between the deviance explained by the model with or without history (<bold>a</bold>) or with or without coupling (<bold>b</bold>). (<bold>a</bold>) The cumulative fraction of history indices for neurons in each area. Overall, more neurons in FEF than LIP were impacted by their recent spike-history. (<bold>b</bold>) Same as in (<bold>a</bold>) but for coupling. Conversely, more neurons in LIP were influenced by the spiking activity of other neurons. (<bold>c</bold>) Comparison of the history and coupling indices. On the whole, spiking activity of neurons in both regions was more predicted by coupling than history (88.4% of neurons). For a large fraction of neurons, the history term was uninformative over and above the coupling and task terms (many neurons had a history index of zero). For a small subset of neurons (11%), predominantly in FEF, history had far more influence than coupling.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52460-fig4-v1.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>The relationship between persistent activity, coupling, and spike-history.</title><p>We compared the traditional measure of persistent activity (depicted by the size of circles in plot) quantified by calculating d-prime on the delay period activity (of the PSTH) between the target ‘in RF’ and ‘out RF’ conditions with measures of coupling and spike-history from the GLM. There was little relationship between the classic trial-average measure of persistent activity and estimates of coupling and spike-history effects on single trials (‘PA’=persistent activity; Pearson’s r, LIP: coupling/PA: R = −0.07; history/PA: R = −0.08; FEF: coupling/PA: R = −0.12; history/PA: R = −0.007).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52460-fig4-figsupp1-v1.tif"/></fig></fig-group><p>Across both areas, the ability to predict spikes for a large number of neurons was not improved by including a history term, meaning that their spike trains were predicted just as well by a model with only spikes from other neurons and the task components (<xref ref-type="fig" rid="fig4">Figure 4c</xref>). However, for a small subset of neurons (11%), the recent spike-history was far more predictive than coupling. Interestingly, these neurons were predominantly in FEF (nearly twice as many as in LIP; <xref ref-type="fig" rid="fig4">Figure 4c</xref>). Overall, these results imply that network dynamics play a more vital role than intrinsic dynamics for most neurons in both areas during persistent activity. Network contributions were especially strong in LIP, consistent with our prior observation that the magnitudes of the within-area coupling kernels were especially large in LIP (<xref ref-type="fig" rid="fig3">Figure 3a</xref>). We also wanted to assess whether neurons with strong persistent activity (determined in the traditional way, via inspection of their PSTH) were more driven by coupling or spike-history effects. Interestingly, there was no clear relationship to either (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). This emphasizes the earlier point that the average responses of single neurons may reveal little about the single-trial dynamics of the network (<xref ref-type="bibr" rid="bib40">Latimer et al., 2015</xref>; <xref ref-type="bibr" rid="bib63">Stokes and Spaak, 2016</xref>). The most ‘persistent’ responses evident in trial-averaged assays might be those that are more reliably driven by regular task events (i.e. the pre-motor build-up or the decaying visual response, or both), as opposed to reflecting a unique and persistent network contribution.</p><p>The interplay and balance of intrinsic versus network time constants is a major component of successful models of persistent activity (<xref ref-type="bibr" rid="bib13">Cavanagh et al., 2018</xref>; <xref ref-type="bibr" rid="bib57">Runyan et al., 2017</xref>). We therefore assessed the relative contributions of spike-history and interneuronal coupling timescales. The history kernels are of course an intriguing but imperfect extracellular lens into the intrinsic time constants of the neurons, estimated by modeling the effect of recent spikes on that neuron’s probability of spiking as a function of time and excluding the effects of task and coupling drive. Although the history kernel does not necessarily or directly describe intracellular or biophysical mechanisms, it does characterize the temporal response properties of the neuron due to ‘self-drive’ (e.g. long timescale autocorrelation, refractory periods, bursting dynamics etc.) as distinct from the effects of other (recorded) neurons and the task events that drive most (or all) neurons. We summarized the history kernels for each area with the first three principal components (<xref ref-type="fig" rid="fig5">Figure 5a,b</xref>). The dominant history component for both areas reflected a slow, gradually decaying time course. We estimated the spike-history time constants of each neuron by fitting an exponential curve to the history kernels (<xref ref-type="fig" rid="fig5">Figure 5c</xref>). Most neurons in both areas had short time constants, but the distributions had heavy right tails, with many neurons exhibiting longer timescales (100–300 ms). Overall, LIP had more neurons with long time constants than FEF (<xref ref-type="fig" rid="fig5">Figure 5c</xref>, inset), which may be surprising given the traditional notion that FEF lies higher up the cortical hierarchy of the visual system (which usually constitutes longer timescales; <xref ref-type="bibr" rid="bib35">Honey et al., 2012</xref>; <xref ref-type="bibr" rid="bib46">Murray et al., 2014</xref>). However, from the oculomotor point of view, the hierarchy is reversed, given that FEF receives direct input from subcortical areas involved in eye movements, and exhibits lower microstimulation thresholds for generating saccades (<xref ref-type="bibr" rid="bib23">Ferraina et al., 2002</xref>; <xref ref-type="bibr" rid="bib38">Kimmel and Moore, 2007</xref>).</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Spike-history and coupling time constants are similar but longer in LIP than FEF.</title><p>The first three principal components for the history kernels in LIP (<bold>a</bold>) and FEF (<bold>b</bold>), which capture the spike-history time constant of the neurons, while controlling for the task and coupling drive. The dominant component in both areas was a slow decay. An exponential curve was fit to the history kernel of each neuron to estimate a time constant (tau). (<bold>c</bold>) The distribution of spike-history time constants differed between areas (Wilcoxon rank-sum test, p=1.20×10<sup>−06</sup>; LIP mean = 99.6 ms; FEF mean = 68.2 ms). Most neurons had short time constants, but there was a ‘long tail’ of neurons with much longer time constants (100–300 ms). (<bold>d</bold>) Same as (<bold>c</bold>) but for the mean coupling kernel of each neuron. Coupling time constants were larger overall than history time constants and also differed between areas (Wilcoxon rank-sum test, p=6.43×10<sup>−07</sup>; LIP mean = 133.8 ms; FEF mean = 76.5 ms). Insets shows the cumulative distributions of the time constants; LIP had more neurons than FEF with long coupling and history time constants.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52460-fig5-v1.tif"/></fig><p>We estimated the time constant from the mean coupling kernel for each neuron in an analogous way, and found that coupling time constants were similar to the spike-history time constants on the whole (<xref ref-type="fig" rid="fig5">Figure 5d</xref>). These findings are consistent with the idea that persistent activity results from a combination of network and intrinsic dynamics, both with relatively slow time constants that can extend into the 200–300 millisecond-long range. We emphasize that the population GLM estimates both the coupling and spike-history kernels while simultaneously accounting for the effects of the task variables that presumably drive most, if not all, of the neurons. In simpler, traditional analyses (such as the autocorrelation from binned spike counts), the impact of visual and motor drive would overshadow and confound the measured network dynamics (<xref ref-type="bibr" rid="bib17">Cohen and Kohn, 2011</xref>).</p></sec><sec id="s2-4"><title>Interneuronal coupling is dynamic across behavioral epochs</title><p>The nature of neural population dynamics during working memory is currently a matter of debate (<xref ref-type="bibr" rid="bib13">Cavanagh et al., 2018</xref>; <xref ref-type="bibr" rid="bib20">Constantinidis et al., 2018</xref>; <xref ref-type="bibr" rid="bib41">Lundqvist et al., 2018</xref>). Some models of working memory propose that the activity of the network should remain stable over time and others suggest that it can drift, or that the time-varying activity is critical to the computation (<xref ref-type="bibr" rid="bib9">Barak and Tsodyks, 2014</xref>; <xref ref-type="bibr" rid="bib62">Stokes, 2015</xref>). To examine how the dynamics of the network evolved over the course of the trial in the neural data, we compared coupling between several temporal epochs. As a baseline, we measured the coupling during the fixation period at the beginning of each trial and compared it to coupling during the delay period. In both cases, the visual input was identical (i.e. a fixation point and nothing else on the screen), but during the delay period the monkey had to remember the location of the target in order to perform the subsequent memory-guided saccade.</p><p>We found strong coupling across the circuit even during fixation, in accordance with earlier findings investigating local pairwise correlations (<xref ref-type="bibr" rid="bib37">Katsuki et al., 2014</xref>). Rather than a profound global change in network interactions from fixation to delay, we observed a subtle yet systematic shift in increased excitatory coupling in all area interactions, with the most pronounced change occurring locally within LIP (<xref ref-type="fig" rid="fig6">Figure 6a</xref>; Wilcoxon rank-sum test, LIP-LIP, p=4.87×10<sup>−09</sup>; FEF-FEF, p=5.17×10<sup>−04</sup>; LIP-FEF, p=1.64×10<sup>−04</sup>; FEF-LIP, p=3.01×10<sup>−03</sup>). This highlights the potential role of nuanced changes in the dynamics of the network, rather than an indiscriminate increase in overall population activity. This is consistent with work showing that the distribution of firing rates of the population in PFC remains relatively constant between the fixation period and the delay period, despite changes in firing rates of individual neurons (<xref ref-type="bibr" rid="bib47">Murray et al., 2017a</xref>).</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Interneuronal coupling is dynamic across behavioral epochs.</title><p>(<bold>a</bold>) The strength of coupling increased between the fixation period and delay period across all area interactions, especially within LIP (Wilcoxon rank-sum test, p=4.87×10<sup>−09</sup>; p=5.17×10<sup>−04</sup>; p=1.64×10<sup>−04</sup>; p=3.01×10<sup>−03</sup>). Strong coupling was observed even during fixation. (<bold>b</bold>) Coupling increased from early in the delay period to late in the delay across all area interactions (Wilcoxon rank-sum test, p=1.08×10<sup>−06</sup>; p=1.65×10<sup>−27</sup>; p=3.96×10<sup>−23</sup>; p=1.97×10<sup>−17</sup>). LIP exhibited increases in excitatory and inhibitory interneuronal interactions, whereas FEF and between area interactions were dominated by increases in excitatory connectivity. (<bold>c</bold>) Interneuronal coupling between the fixation and the delay period was systematic (Pearson’s r, R = 0.61; R = 0.66; R = 0.70; R = 0.72), (<bold>d</bold>) whereas the coupling strength between early and late in the delay showed no relationship (Pearson’s r, R = 0.04; R = 0.04; R = 0.06; R = 0.03).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52460-fig6-v1.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Pairwise coupling as a function of spatial tuning similarity.</title><p>Classic models of persistent activity suppose that neurons with similar tuning properties should be more coupled. The absolute max of the coupling kernel weight for each neuron pair is plotted as a function of tuning similarity. The difference in selectivity was calculated by fitting a 1D circular Gaussian tuning curve to the responses of each neuron at each target location and taking the difference between the peak of the tuning curves for each pair of neurons (smaller numbers means more similar). Lines are least-squares fit (R-squared: LIP-LIP: −0.16, FEF-FEF: −0.05, LIP-FEF: −0.03, FEF-LIP: −0.08).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52460-fig6-figsupp1-v1.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 2.</label><caption><title>Spike-history dynamics over behavioral epochs.</title><p>(<bold>a</bold>) Distributions of max spike-history weights in LIP and FEF for the fixation and delay periods. History dynamics were consistent across the fixation and delay. (<bold>b</bold>) The pairwise relationship between spike-history between fixation and delay for LIP and FEF (Pearson’s r, R = 0.67; R = 0.64). (<bold>c</bold>) Distributions of max spike-history weights in LIP and FEF for early and late in the delay period. (<bold>d</bold>) The pairwise relationship between spike-history between early and late in the delay for LIP and FEF (Pearson’s r, R = 0.13; R = −0.03). Spike-history weights shifted from negative to positive from early to late in the delay, predominately in FEF.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52460-fig6-figsupp2-v1.tif"/></fig></fig-group><p>One potential explanation for the differences in coupling between LIP and FEF (<xref ref-type="fig" rid="fig3">Figure 3</xref>) could be due to differences in receptive field overlap between pairs of neurons. However, the finding that differences in coupling exist even during fixation (<xref ref-type="fig" rid="fig6">Figure 6a</xref>) suggests true differences in the underlying functional organization of the areas rather than simply an artifact of sampling. To explore the relationship between spatial selectivity and coupling further, we analyzed the coupling between neurons as a function of their spatial tuning similarity based on the distance between the peaks of the their 1D tuning curves (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). We found that coupling was modestly stronger for pairs of neurons with more similar spatial tuning, which was most pronounced for neurons within LIP. Interestingly, this feature is predicted by classic bump attractor models of spatial working memory.</p><p>To assess the temporal stability of the network interactions across the delay period, we compared coupling early in the delay period to coupling late in the delay period. Coupling increased late in the delay period for all interactions (<xref ref-type="fig" rid="fig6">Figure 6b</xref>; Wilcoxon rank-sum test, LIP-LIP, p=1.08×10<sup>−06</sup>; FEF-FEF, p=1.65×10<sup>−27</sup>; LIP-FEF, p=3.96×10<sup>−23</sup>; FEF-LIP, p=1.97×10<sup>−17</sup>). LIP exhibited the smallest change overall, but a closer view of the distribution of within-LIP coupling kernels revealed a relatively symmetrical increase in excitatory and inhibitory weights. In contrast, within-FEF and between-area coupling reflected primarily excitatory shifts (<xref ref-type="fig" rid="fig6">Figure 6b</xref>).</p><p>Although the increase in coupling between the fixation period and delay period was subtle, it was systematic across all interactions within and between areas (<xref ref-type="fig" rid="fig6">Figure 6c</xref>). However, unlike the pair-by-pair relationship between fixation and delay coupling, there was little correlation between coupling early and late in the delay period (<xref ref-type="fig" rid="fig6">Figure 6d</xref>). Notably, within-LIP activity had the largest increase in excitatory coupling from the fixation period to the delay (<xref ref-type="fig" rid="fig6">Figure 6a</xref>), but the smallest change from early to late in the delay period (<xref ref-type="fig" rid="fig6">Figure 6b</xref>). This temporal pattern suggests that the network dynamics within LIP are engaged first and then the larger circuit becomes more strongly coupled as the delay period goes on.</p><p>We also examined the dynamics of single neurons’ spike-history across the temporal epochs. The strength of the spike-history kernels remained consistent between the fixation and delay periods as one might expect (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2a,b</xref>), but interestingly many neurons in FEF had larger spike-history effects later rather than earlier in the delay period (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2c,d</xref>), meaning that their autocorrelation increased over the delay. Crucially, remember that the impact of the history term is estimated while controlling for the drive of the saccadic response.</p></sec><sec id="s2-5"><title>Coupling differences in LIP and FEF can be explained by the strength of recurrent connectivity in attractor networks</title><p>To further explore the implications of our results for mechanistic models of persistent activity, we fit the population GLM to spiking data from a classical ‘bump’ attractor network used to model spatial working memory (<xref ref-type="fig" rid="fig7">Figure 7a,b</xref>; <xref ref-type="bibr" rid="bib29">Gerstner et al., 2014</xref>; <xref ref-type="bibr" rid="bib18">Compte et al., 2000</xref>). Our main goal was to attempt to infer the recurrent connectivity of the attractor network using the GLM to provide a benchmark to relate the data to the mechanistic models (or perhaps vice versa). We parametrically varied the recurrent connection strength of the excitatory population in the attractor network while holding all other parameters constant (at their default values) to generate synthetic datasets from each of these network variants. We then sampled spike trains from a subset of the total network population, akin to a real experiment (20 neurons, 500 trials per session). To further mimic the real experiment, we varied the onset and location of the stimulus on a per trial basis, and the sample of neurons remained the same throughout each session. We fit the population GLM to the spike trains of the ensemble of neurons in each session in the exact same way we did for the real datasets.</p><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Coupling differences in LIP and FEF can be explained by the strength of recurrent connectivity in attractor networks.</title><p>Synthetic datasets were generated from a classic attractor network and fit with the GLM using the same procedure used with the real data. (<bold>a</bold>) Schematic of classic attractor network used to model spatial working memory (adapted from <xref ref-type="bibr" rid="bib29">Gerstner et al., 2014</xref>). (<bold>b</bold>) Population activity of attractor network for an example session with high recurrent strength (2.3): a stimulus triggers selective persistent activity (top, middle row); voltage traces from three example neurons (bottom row). (<bold>c</bold>) A systematic relationship was revealed between the mean coupling (estimated from the fitted GLM) and the internal recurrent strength of the attractor network (error bars = SEM). The black dashed line indicates the level of coupling at the minimum recurrent strength necessary to generate persistent activity. The green and blue lines are LIP and FEF’s coupling determined from the data, respectively. (<bold>d</bold>) Stimulus, spike-history, and coupling kernels of an example neuron. PCA of history (<bold>e</bold>) and coupling (<bold>f</bold>) kernels for an example session revealed the ‘fast’ and ‘slow’ dynamics of the neurons specified in the network, which accounted for virtually all the variance explained (legend).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52460-fig7-v1.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>The relationship between coupling (GLM) and recurrent strength (attractor network) for the other area interactions and the shuffling control.</title><p>(<bold>a</bold>) As in <xref ref-type="fig" rid="fig7">Figure 7</xref>, including coupling values for LIP-FEF, FEF-LIP, and MT. Gray points are coupling values from the GLM trained on permuted data (as explained in the methods; error bars are so small as to be invisible for most points). As expected, disrupting the correlational structure of the population eliminates the relationship between coupling and the recurrent strength. The small increase in coupling at the lowest recurrent strength in the shuffled condition is artificially inflated due to the very few spike trains that are sampled from the network at this parameter value (the network is producing very little activity and is only borderline persistent), and the identical nature of the artificial neurons. (<bold>b</bold>) Controlling for overall firing rate differences between ROIs with shuffling. Coupling and mean firing rates increase with recurrent strength under normal conditions (top row). During the shuffling control (bottom row), the coupling is reduced to chance levels but the mean firing rates are identical, showing that coupling tracks the internal recurrent strength of the attractor network and not simply overall increases in firing rate (error bars so small as to be invisible at most points). This is bolstered by the fact that neurons in FEF actually had a significantly higher mean firing rate than LIP, whereas LIP had much stronger coupling than FEF (see Materials and methods).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52460-fig7-figsupp1-v1.tif"/></fig><fig id="fig7s2" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 2.</label><caption><title>All history and coupling kernels from an example session from the attractor network.</title><p>The parameter for the recurrent strength of the attractor network was 2.3 (a network that can generate strong persistent activity). (<bold>a</bold>) History kernels from the GLM for all neurons in the example session (N = 20). (<bold>b</bold>) Coupling kernels from the GLM for all neurons in the example session, each neuron has N-1 coupling kernels in the fully coupled model.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52460-fig7-figsupp2-v1.tif"/></fig></fig-group><p>The coupling between neurons (determined by the GLM) systematically increased with greater recurrent connectivity in the attractor network, confirming that coupling can act as a valuable proxy for the strength of the recurrent weights of the population (<xref ref-type="fig" rid="fig7">Figure 7c</xref>). The black dashed line in <xref ref-type="fig" rid="fig7">Figure 7c</xref> indicates the level of coupling at the minimum recurrent strength necessary to generate persistent activity. The green and blue lines are LIP and FEF’s true coupling determined from the data, respectively. Given these simulations, LIP appears to exhibit strong attractor dynamics (i.e. near the point of saturation of recurrent functional connectivity), whereas FEF acts as a weak attractor, but one still independently capable of maintaining persistent activity (i.e. near the model’s theoretical minimum for exhibiting persistent firing, at least given the other parameter settings). The coupling we observed between LIP and FEF was statistically significant, but lay below the threshold to be able to generate persistent activity on their own (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>). Data from area MT (from other experiments, described earlier) had even lower coupling (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>), consistent with that area’s role in visual function and lack of strong persistent responses.</p><p>The stimulus, history, and coupling kernels fit to spike trains from the attractor network all resembled those recovered from the real data. The GLM captured the effects of the stimulus, both when it was in or out of the receptive fields of the sampled neurons (<xref ref-type="fig" rid="fig7">Figure 7d</xref>, panel 1). The history term recovered the ‘built-in’ hard refractory period of the neurons, as well as the longer autocorrelation (<xref ref-type="fig" rid="fig7">Figure 7d</xref>, panel 2). The coupling terms captured the strong and prevalent interneuronal correlations (<xref ref-type="fig" rid="fig7">Figure 7d</xref>, panel 3), although coupling tended to be faster in the attractor network than in the data, which may be an interesting difference worthy of consideration in modeling. The first two principal components (<xref ref-type="fig" rid="fig7">Figure 7e,f</xref>) of all the history kernels and coupling kernels (<xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref>) explained virtually all of the variance, and revealed the temporal profiles of the fast and slow excitatory components (AMPA and NMDA receptors, respectively), which are explicitly specified as part of the synaptic weights of the population in the attractor network. It is unsurprising that the coupling and history kernels are similar, given that the artificial neurons in the population are all identical and the profile of connection weights yokes the between-neuron connection strength and self-recurrent strength in the attractor network.</p><p>These findings from the GLM analysis of the attractor network serve not only to verify the inferences that came from the core analysis scheme as applied to real data, but also to help situate our results more broadly with respect to theoretical models. The GLM recovered reasonable stimulus, history, and coupling kernels from the artificial population, and captured the underlying strength of recurrent connections in the attractor network. Our initial comparisons also revealed that LIP and FEF both fell within the range of theoretically-predicted couplings required for persistent activity, although at intriguingly different positions within that range. There are, of course, numerous parameter tradeoffs that can be explored in this and other similar network models (<xref ref-type="bibr" rid="bib15">Chaudhuri and Fiete, 2016</xref>; <xref ref-type="bibr" rid="bib68">Zylberberg and Strowbridge, 2017</xref>). The analyses reported above are only the first steps to interrogating attractor networks in detail and linking the theories back to data, but they demonstrate the exciting feasibility and validity of using a population GLM to link theoretical spiking models with recordings of neuronal ensembles.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>The primate frontoparietal network is often put forth as a model system in which to study cognitive processes, yet little is known about the circuit-level spiking activity within and between regions in this network. We therefore characterized the interneuronal interactions in this circuit during oculomotor working memory using multi-area multi-site simultaneous recordings, and a population encoding framework that extended the generalized linear model to simultaneous fits of multiple neurons recorded at the same time in two cortical areas. This enabled us to isolate the contributions of network and intrinsic dynamics to persistent activity while simultaneously disambiguating the effects of task variables.</p><p>Historically, models of cortical persistent activity have focused on the challenges posed to generic architectures, identifying particular network interactions and cellular properties whose interplay might be capable of maintaining the sorts of persistent activity seen in the brain (for review: <xref ref-type="bibr" rid="bib66">Wang, 2001</xref>). Such models have emphasized strong recurrent activity (to maintain spiking without additional input), broadly tuned inhibition (useful for damping the runaway dynamics), and a degree of (realistic) slow intrinsic time constants to stabilize the network (perhaps mediated by NMDA receptors). Using a population encoding model, we were able to identify several of these key features in the population activity, and to map these on to data from specific brain areas.</p><p>We found evidence of strong reciprocal interactions both between and within FEF and LIP. These circuit-level interactions comprised three main components. First, the slow timescale excitation we observed confirms the existence of strong reverberatory activity, the primary functional component used in models to generate persistent activity. Second, slow inhibitory interactions were present that could serve to perform the hypothesized tempering of reverberatory excitation, curbing potentially runaway attractor dynamics. Finally, we observed a fast excitation component, primarily within areas, which corresponds to more conventional local neuron-to-neuron interactions. The magnitude and time courses of all components serendipitously map on to three key biophysical features that are prevalent in theoretical models of persistent activity: NMDARs, GABARs, and AMPARs (<xref ref-type="bibr" rid="bib18">Compte et al., 2000</xref>; <xref ref-type="bibr" rid="bib32">Goldman-Rakic, 1995</xref>; <xref ref-type="bibr" rid="bib65">Wang, 1999</xref>). Of course, our characterizations provide summaries of temporal scales at the level of spikes, and how these quantitatively relate to intracellular mechanisms invites further study. Recent work suggests a more complicated story at such lower biophysical levels (<xref ref-type="bibr" rid="bib55">Rodermund et al., 2020</xref>). However, our validation of the GLM analysis with the attractor network lends credence to the estimates of the neurons’ temporal dynamics. The time constants of neuron-to-neuron interactions, as well as the history dynamics of individual cells, were on order of 100–250 ms, and are therefore consistent with the relatively long dynamics that are called for theoretically to maintain persistent activity over timescales of many 100 s of milliseconds to a few seconds.</p><p>Theories of persistent activity have only recently begun to tackle the multi-area circuit dynamics underlying working memory (e.g. <xref ref-type="bibr" rid="bib48">Murray et al., 2017b</xref>). This distributed frontoparietal model attempts to explain working memory and perceptual decision making with two interconnected modules with differences in the recurrent structure of the local networks. The idea is that stronger attractor dynamics in PFC than PPC leads to more robust persistent activity during working memory, and categorically different computations during decision making (i.e. winner-take-all choice in PFC, and slow temporal integration in PPC). Work by <xref ref-type="bibr" rid="bib48">Murray et al. (2017b)</xref> nicely lays out several potential scenarios for the local and long-range network structure that could support attractor dynamics in the frontoparietal circuit. Our GLM analysis of the attractor network provides the unique opportunity to speak directly to these architectures. Both LIP and FEF appear to be independently capable of stable attractor dynamics, whereas the between-area interactions fell below the threshold for independently generating persistent activity, despite significant coupling (this is the first option: row 1 of <xref ref-type="fig" rid="fig3">Figure 3c</xref> of their paper). However, unexpectedly, LIP had much stronger recurrent connectivity than FEF, which runs counter to the initial proposal for the specific differences in local structure in the two areas. Thus, our results suggest that the proposed underlying differences in network structure are unlikely responsible for the theoretical functional differences between LIP and FEF in this distributed frontoparietal model (or at least not in the expected way).</p><p>Although our results suggest that LIP has a stronger degree of locally-recurrent connectivity, the strong interactions both between and within these areas on single trials support the idea of a tightly linked network which might be better thought of as parts of a single functional unit. The observed timescales of recurrent excitation between neurons likely indicate evidence for attractor-like models of network dynamics, not only within LIP and FEF, but across the entire circuit, which could be effectively acting as a single distributed attractor with only quantitative differences across areal nodes. The superior colliculus and thalamus are also likely critical parts of this circuit (<xref ref-type="bibr" rid="bib23">Ferraina et al., 2002</xref>). Recent work in rodents has suggested that the thalamus plays a central role in maintaining persistent activity (<xref ref-type="bibr" rid="bib10">Bolkan et al., 2017</xref>; <xref ref-type="bibr" rid="bib33">Guo et al., 2017</xref>; <xref ref-type="bibr" rid="bib36">Inagaki et al., 2019</xref>; <xref ref-type="bibr" rid="bib58">Schmitt et al., 2017</xref>), a proposition that needs to be tested in the primate, and which might further enrich our perspective on the full network (or networks) involved in even simple instances of persistent activity.</p><p>Taken together, our results provide direct empirical support for strong recurrent excitation and balancing inhibition in primate brain areas that exhibit persistent activity. These findings inform and constrain the structure of the connectivity, both qualitatively and quantitatively. An important next step will be to test a multi-area mechanistic model that incorporates attractor dynamics within and between areas using magnitudes and timescales informed by our data, and which takes into account the differences in architecture and network/intrinsic drive in each area. However, a crucial difference between the data and the model may lie in the fact that bump attractor networks fundamentally link the spatial connectivity of the network to the spatial selectivity profile of the neurons in the population, but relatively little is known about the fine-grained retinotopy (and microcircuit architecture) in area LIP (<xref ref-type="bibr" rid="bib6">Arcaro et al., 2011</xref>). Augmenting the attractor network model by incorporating heterogenous tuning functions and/or extending the model to capture 2D receptive field profiles would be valuable next steps to better understand the nature of the functional architecture in these areas. It is possible that the heterogeneity and mixed selectivity prevalent in this circuit is a result of heavily interconnected networks that are continuously active (<xref ref-type="bibr" rid="bib25">Fusi et al., 2016</xref>; <xref ref-type="bibr" rid="bib44">Meister et al., 2013</xref>; <xref ref-type="bibr" rid="bib54">Rigotti et al., 2013</xref>). These features may be critical for normal oculomotor behavior, in which the eyes move almost constantly, and sensory inputs must be continuously and flexibly mapped to motor actions.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Stimulus presentation apparatus</title><p>Macaques were seated, head-fixed, in custom primate chairs facing a rear-projection screen (IRUS; Draper; 150 cm ×86 cm) at a distance of 57 cm, which covered the central 106◦×73◦ of visual angle. Images were projected onto the screen by a PROPixx projector (VPixx; resolution = 1920 × 1080 pixels, refresh rate = 120 Hz). Visual stimuli were generated using Matlab (MathWorks) and Psychtoolbox (<xref ref-type="bibr" rid="bib11">Brainard, 1997</xref>; <xref ref-type="bibr" rid="bib39">Kleiner et al., 2007</xref>). Neural data and task events were recorded with the OmniPlex system (Plexon) using a Datapixx I/O box (VPixx) for precise temporal registration. Electrical microstimulation was administered with a PlexStim device (Plexon). All hardware and software were integrated using the PLDAPS experimental framework (<xref ref-type="bibr" rid="bib22">Eastman and Huk, 2012</xref>). Eye position was tracked using an Eyelink 1000 video eye tracker (SR Research), sampled at 1 kHz. Reward was delivered through a computer-controlled syringe pump (New Era).</p></sec><sec id="s4-2"><title>Memory-guided saccade task</title><p>Macaques were trained to perform a classic visuospatial delayed-response task: memory-guided saccades. On a trial, the monkey fixates on a central point while a target is flashed (for 200 ms) at a random location in the periphery. After a delay period, in which he must maintain fixation, a ‘go signal’ is indicated by extinguishing the fixation point, and he must make a saccade to the remembered location of the target. There are two key differences in our specific version of this task: 1) the timing of the task events: the fixation point onset (1–1.5 s durations), target onset, and fixation off (go signal) are variable, making the delay period variable on a trial-by-trial basis (delays = 0.5 s - 2 s), and 2) the spatial location of the target is jittered continuously (eccentricities were drawn from a Gaussian distribution, mean = 10°, SD = 5°), rather than being presented at one of an array of fixed grid locations. The spatial jitter was applied to the position of the target in X and Y in the visual field (in degrees of visual angle), not radially from the center. The delay durations (as well as other task timings) were constructed from uniform distributions. This task served a dual purpose: to functionally map LIP and FEF, and as our primary way to investigate persistent activity during working memory.</p></sec><sec id="s4-3"><title>Preparation and electrophysiology</title><p>We performed electrophysiological recordings in cortical areas LIP and FEF in two male rhesus macaques (9 y.o., 10.1 kg, and 5 y.o., 6.8 kg). Each monkey had two custom titanium chambers implanted over the regions of interest (ROIs) to allow for simultaneous recordings in both areas. Chambers were placed according to structural MRI scans and anatomical landmarks. An accurate 3D model of the skull (both digitally, and 3D-printed) was used to craft an individualized fit of the chamber to the skull for a more stable and sealed implant. All experimental protocols were approved by The University of Texas Institutional Animal Care and Use Committee and in accordance with National Institute of Health standards for care and use of laboratory animals.</p><p>Extracellular electrophysiological recordings were conducted with multisite linear electrode arrays (U-probes; Plexon; 24 or 32 channels) with stereotrode geometry (50 µm between adjacent sites; 100 µm between pairs). Probes were lowered daily into both chambers. ROIs were identified using electrode depths, sulci landmarks (using the physiological characteristics of white/gray matter), neuronal properties, and in the case of FEF, electrical microstimulation. Both LIP and FEF were functionally identified and mapped by observing spatially selective visual and saccadic activity, as well as delay-period persistent activity in the memory-guided saccade task (<xref ref-type="bibr" rid="bib30">Gnadt and Andersen, 1988</xref>). In addition, FEF was mapped with a well-established microstimulation protocol (<xref ref-type="bibr" rid="bib38">Kimmel and Moore, 2007</xref>; <xref ref-type="bibr" rid="bib45">Moore and Fallah, 2001</xref>), in which conventional currents (~50µa, 200 Hz) tended to generate fixed vector saccades to regions of visual space.</p></sec><sec id="s4-4"><title>Neural analysis</title><p>We collected a wide sample of units in LIP and FEF (967 units; LIP: 407; FEF: 560; Monkey A: 459; Monkey L: 508; 160 sessions; 7448 pairs; mean firing rates: FEF: 36 sp/s; LIP: 28 sp/s; p=1.16×10<sup>−5</sup> Wilcoxon Rank-Sum test). Offline spike sorting was conducted in a semi-automatic fashion, first with KiloSort (<xref ref-type="bibr" rid="bib49">Pachitariu et al., 2016</xref>), and then manually in Phy. Clusters were merged or split based on the units’ characteristics: waveforms, ISI distributions, temporal continuity, and principal components. Peri-stimulus time histograms (PSTHs) were constructed by aligning the spike times to the major task events (target onset or saccade), binning at 1 ms resolution, averaging across trials, and smoothing with a Gaussian filter (SD = 30 ms). MT data were collected during a different experiment under the same behavioral conditions in prior reports (<xref ref-type="bibr" rid="bib67">Yates et al., 2017</xref>).</p></sec><sec id="s4-5"><title>Encoding model</title><p>We built and compared several population encoding models, which were all variants of a generalized linear model (GLM). This statistical approach allowed us to characterize how a neuron’s spike trains (on single trials) depended on the task events (the visual stimulus and motor response), spikes from simultaneously recorded neurons, and the fitted neuron’s own recent spike-history. In this way, we could infer the functional connectivity of the network on a trial-by-trial basis. Each daily session (including all simultaneously recorded neurons) went into the GLM analysis. The data (and fits) were then summarized across all sessions.</p><p>Spike trains were discretized into 1 ms bins (Δ). Covariates were represented as delta functions at the time of the event and parameterized with temporal filters (nonlinearly time-scaled raised cosine functions) following previous conventions (<xref ref-type="bibr" rid="bib52">Pillow et al., 2008</xref>; <xref ref-type="bibr" rid="bib51">Park et al., 2014</xref>; <xref ref-type="bibr" rid="bib67">Yates et al., 2017</xref>). The conditions inside and outside the receptive field were modeled together along with the rest of the parameters. The model does not include details about the specific saccade location or the stimulus spatial jitter. The number of parameters and data points depends on the number of simultaneously recorded neurons in each session (and the length of the trials which varies; time bins = 1 ms). For each neuron, the target and saccade kernels are each 8 parameters and 800 ms long, and the history and coupling filters are each 10 parameters and 250 ms long. There are <italic>n</italic>-1 coupling filters for each neuron, where <italic>n</italic> is the number of simultaneously recorded neurons during each session. These parameterizations are conventional and conform to previous uses of this method (<xref ref-type="bibr" rid="bib52">Pillow et al., 2008</xref>; <xref ref-type="bibr" rid="bib51">Park et al., 2014</xref>; <xref ref-type="bibr" rid="bib67">Yates et al., 2017</xref>).</p><p>Each neuron was fit with a GLM using maximum a posteriori estimation (MAP) with a log-Gaussian prior, where the instantaneous spike rate (conditional intensity) of the fully coupled model at time <italic>t</italic> is given by<disp-formula id="equ1"><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>=</mml:mo><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">k</mml:mi></mml:mrow><mml:mo>∗</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mo>∗</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mo>∗</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <bold>k</bold> comprises the <italic>n</italic><sub>i</sub> weights on the <italic>m</italic> task covariates <bold>x</bold>, and <bold>k</bold>*<bold>x</bold> is shorthand for<disp-formula id="equ2"><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="bold">k</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:mrow><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <italic>f</italic> is the temporal basis functions described previously. <bold>h</bold> is the weights on the recent spike-history (which is notation for the neuron’s spikes leading up to but excluding the current time bin), <bold>c</bold> is the coupling weights on <bold>s</bold> simultaneously recorded spikes, and <bold>b</bold> is a constant term that captures the neuron’s baseline firing rate. We used an exponential as our choice of nonlinearity (inverse-link function) to map the linear predictors to Poisson spiking.</p><p>The log-likelihood of a Poisson GLM for a single neuron is<disp-formula id="equ3"><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Only simultaneously recorded neurons within each session were included in the full (coupled) population encoding models. To prevent overfitting, we used ridge regression to penalize the weights on the regressors, which has the effect of shrinking the coefficients.<disp-formula id="equ4"><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo symmetric="true">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">k</mml:mi></mml:mrow><mml:mo symmetric="true">‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo symmetric="true">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mo symmetric="true">‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo symmetric="true">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mo symmetric="true">‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>For each neuron, we performed 5-fold cross-validation, in which the model was trained on 80% of the data and tested on the withheld 20%. The goodness-of-fit was computed by generating spike trains from the model, averaging them to get a predicted PSTH and calculating the variance explained of the real PSTH (R-squared).</p><p>To evaluate and compare the performance of the models, we calculated a likelihood test statistic by taking the difference of the log-likelihood for the full model and the log-likelihood of a homogeneous Poisson process model (with a constant rate), which acts as a null or ‘saturated’ model (<xref ref-type="bibr" rid="bib57">Runyan et al., 2017</xref>),<disp-formula id="equ5"><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>λ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>λ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the mean firing rate of the neuron (over the entire trial) and we divide by the sum of the spike counts. This formulation gives the prediction accuracy in units of bits per spike (<xref ref-type="bibr" rid="bib50">Paninski et al., 2004</xref>; <xref ref-type="bibr" rid="bib52">Pillow et al., 2008</xref>).</p><p>The models we considered varied in their inclusion of the coupling, history, and stimulus terms, as well as their parameterizations. We verified the fits by comparing the variance explained of the PSTHs and single-trial spike trains between the full model (with coupling, history, and task terms) and an ‘uncoupled’ model, which had no coupling terms (i.e. no connections between the neurons) but was otherwise the same. Unsurprisingly, adding coupling to the model (which captures the correlational structure of the single-trial spike trains) does not improve the fit of the predicted PSTHs (<xref ref-type="fig" rid="fig3">Figure 3d</xref>; points fell around the unity line; median 76% variance explained under both models) because PSTHs (by their very nature) ignore single-trial dynamics by averaging across trials. However, crucially, predictions of the single-trial spike trains universally benefit from the inclusion of the coupling terms (<xref ref-type="fig" rid="fig3">Figure 3e</xref>; points fell above the unity line; on average a log-likelihood improvement of 22% in units of bits per spike).</p><p>We also compared models that only included spikes from different temporal epochs of the trial to identify neural population dynamics that varied as a function of task demands. In the cases where two temporal epochs were compared, the window sizes and task parameters were matched. To summarize the coupling results within and between ROIs, we performed principal component analysis (PCA) on the coupling kernels sorted by each interaction. The first three principal components explained around 90% of the variance for each interaction. The same was true for the history kernels. To estimate the history and coupling time constants, we fit a double exponential curve to each kernel or the first principal component of the kernels for each ROI. History kernels exhibiting strong refractory periods rather than long timescale dynamics were poorly fit by an exponential decay and were excluded from this analysis (48%). To further characterize the impact of the coupling terms for each neuron, we constructed a predictive index defined by the difference between the deviance explained by the full model, and the deviance explained by the model without coupling (the ‘uncoupled’ model— only task and history predictors) divided by the deviance explained by the coupled model (<xref ref-type="bibr" rid="bib57">Runyan et al., 2017</xref>; <xref ref-type="bibr" rid="bib2">Agresti, 2002</xref>). A coupling index of one indicates that the neuron’s spike trains are completely predicted by the spiking activity of other neurons, and a value of zero indicates that spikes from other neurons add no predictive power over and above the task predictors and the neuron’s recent spike-history. We constructed the analogous index for the spike-history as well.</p><p>To further validate the coupling, we constructed null distributions by fitting the GLM to permuted data (following <xref ref-type="bibr" rid="bib52">Pillow et al., 2008</xref>; see supplement). We permuted the order of the trials (i.e. trial identity) for each neuron (whose spike trains are used as predictors) relative to each fitted neuron, which eliminates the correlations between neurons but maintains the temporal dependencies of the task events and the spike times <italic>within</italic> each trial for the fitted neuron. In other words, the signal correlations are preserved while the noise correlations are disrupted. Crucially, the task events and spike times are never misaligned on single trials (on which the model is fit). This procedure is equivalent to treating each neuron independently in the model and obscuring the simultaneous nature of the recordings. The permutation analysis provides a clear null model against which to identify functional interactions within the GLM (i.e. beyond what is expected by chance) and is a principled validation of the coupling (<xref ref-type="bibr" rid="bib52">Pillow et al., 2008</xref>; <xref ref-type="bibr" rid="bib67">Yates et al., 2017</xref>; <xref ref-type="bibr" rid="bib57">Runyan et al., 2017</xref>).</p><p>An additional concern might be that the differences in coupling between areas is driven by differences in receptive field overlap due to artifacts of sampling. The overall differences in coupling between LIP and FEF were also present during fixation when there is no visual stimulus in the receptive fields or memory of the stimulus being maintained (<xref ref-type="fig" rid="fig6">Figure 6a</xref>), meaning the coupling differences are likely due to differences in the underlying functional connectivity and not due to sampling artifacts regarding the receptive fields (which concurs with previous work: <xref ref-type="bibr" rid="bib37">Katsuki et al., 2014</xref>). In addition, experiments were conducted using identical methods in both areas during simultaneous recordings and using a relatively indiscriminate sampling protocol (all neurons with isolatable waveforms were included regardless of selectivity). We also quantified the effect of coupling as a function of tuning similarity (using 1D circular Gaussian tuning curves), and found that coupling was modestly stronger for pairs of neurons with more similar spatial tuning across all interactions, and that relationship was most pronounced for neurons within LIP (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>), a feature predicted by classic attractor network models. However, to fully address this question, the extent, shape, and response profile of the response fields would need to be mapped in greater spatial detail.</p><p>In addition, differences in coupling between the ROIs were unlikely due to overall differences in mean spike rates. The coupling kernels for each area were compared to the null (shuffled) distributions within each respective area. Under both conditions, the spike rates were identical but during the shuffled condition the correlation structure between neurons was broken, providing an independent estimate of coupling due to chance alone for each area regardless of mean spike rates. We have also demonstrated this in the GLM analysis of the simulated data from the attractor network (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>), in which coupling tracked the internal recurrent strength of the attractor network independent of overall changes in mean firing rate. These results are further bolstered by the data– neurons in FEF actually had a significantly higher mean firing rate than LIP, whereas LIP had much stronger coupling than FEF.</p><p>Area MT’s coupling was estimated using the same GLM analysis, but the data was collected during a perceptual decision making task rather than a working memory task (details described in <xref ref-type="bibr" rid="bib67">Yates et al., 2017</xref>). Coupling within MT was significantly lower than each other area interaction (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>): LIP-LIP, FEF-FEF, LIP-FEF, FEF-LIP, (Wilcoxon rank-sum test): p=2.19×10<sup>−143</sup>; p=6.92×10<sup>−103</sup>; p=2.18×10<sup>−07</sup>; p=7.98×10<sup>−22</sup>. Magnitude of the effect size (Cohen’s D): LIP-LIP = 0.89 (large effect), FEF-FEF = 0.41 (medium effect), LIP-FEF = 0.16 (small effect), FEF-LIP = 0.24 (small effect).</p></sec><sec id="s4-6"><title>Attractor network</title><p>To validate our analyses and situate our results more broadly we generated synthetic datasets from a spiking attractor network (<xref ref-type="bibr" rid="bib29">Gerstner et al., 2014</xref>; <ext-link ext-link-type="uri" xlink:href="https://neuronaldynamics.epfl.ch/">https://neuronaldynamics.epfl.ch/</ext-link>) and fit them with the GLM. This attractor network was based on a classic model of spatial working memory (<xref ref-type="bibr" rid="bib18">Compte et al., 2000</xref>). We parametrically varied the strength of the recurrent connections in the excitatory population while holding all other parameters constant. To replicate the real experiments, we varied the location and onset of the stimulus (i.e. the ‘visual target’) trial-by-trial (200 ms duration; onset jittered from 200 to 500 ms; 1 s trial duration), and sampled a small subset of neurons from the overall population (N = 20). 500 trials were simulated per session and this sample of neurons remained the same throughout the session. Parameters of the network were kept at their default values unless otherwise noted, as in the case of the recurrent strength of the excitatory population. Some of the main parameters of interest are noted (using their names from the simulation code): N_excitatory = 1024, N_inhibitory = 256, N_extern_poisson = 1000, poisson_firing_rate = 1.3 * hertz, weight_scaling_factor = 2.0, sigma_weight_profile = 20.0, Jpos_excit2excit = 1.6 (strength of the recurrent input), stimulus_center_deg = 120, stimulus_width_deg = 30, stimulus_strength = 0.06 * b2.namp. Note that the default NMDA time constant was 65 ms (<xref ref-type="bibr" rid="bib29">Gerstner et al., 2014</xref>) rather than the 100 ms in the original model (<xref ref-type="bibr" rid="bib18">Compte et al., 2000</xref>).</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank A Levi for sharing the MT data, C Badillo for technical support, and A Laudano, K Mitchell, and C Carter for animal support. We also thank E Salinas, A Compte, and an anonymous reviewer for their helpful comments, and W Gerstner, W M Kistler, R Naud, and L Paninksi for making the attractor network code available. This research was supported by a National Science Foundation grant (IIS-173491) to ACH and Il Memming Park (Stony Brook University) and a National Eye Institute grant (R01-EY017366) to ACH, and a National Eye Institute training grant (T32-EY021462).</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Supervision, Funding acquisition, Project administration</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Animal experimentation: All experimental protocols were approved by The University of Texas Institutional Animal Care and Use Committee (AUP-20418-00063, AUP-2015-00068) and in accordance with National Institute of Health standards for care and use of laboratory animals.</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-52460-transrepform-v1.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Data files have been deposited to Data Dryad under <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5061/dryad.gb5mkkwk7">https://doi.org/10.5061/dryad.gb5mkkwk7</ext-link>.</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Hart</surname><given-names>E</given-names></name><name><surname>Huk</surname><given-names>AC</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>Data from: Recurrent circuit dynamics underlie persistent activity in the macaque frontoparietal network</data-title><source>Data Dryad</source><pub-id assigning-authority="Dryad" pub-id-type="accession" xlink:href="https://doi.org/10.5061/dryad.gb5mkkwk7">10.5061/dryad.gb5mkkwk7</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aertsen</surname> <given-names>AM</given-names></name><name><surname>Gerstein</surname> <given-names>GL</given-names></name><name><surname>Habib</surname> <given-names>MK</given-names></name><name><surname>Palm</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Dynamics of neuronal firing correlation: modulation of &quot;effective connectivity&quot;</article-title><source>Journal of Neurophysiology</source><volume>61</volume><fpage>900</fpage><lpage>917</lpage><pub-id pub-id-type="doi">10.1152/jn.1989.61.5.900</pub-id><pub-id pub-id-type="pmid">2723733</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Agresti</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2002">2002</year><source>Categorical Data Analysis</source><edition>Second Edition</edition><publisher-name>Wiley-Interscience</publisher-name><pub-id pub-id-type="doi">10.1002/0471249688</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amit</surname> <given-names>DJ</given-names></name><name><surname>Brunel</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Model of global spontaneous activity and local structured activity during delay periods in the cerebral cortex</article-title><source>Cerebral Cortex</source><volume>7</volume><fpage>237</fpage><lpage>252</lpage><pub-id pub-id-type="doi">10.1093/cercor/7.3.237</pub-id><pub-id pub-id-type="pmid">9143444</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andersen</surname> <given-names>RA</given-names></name><name><surname>Essick</surname> <given-names>GK</given-names></name><name><surname>Siegel</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Neurons of area 7 activated by both visual stimuli and oculomotor behavior</article-title><source>Experimental Brain Research</source><volume>67</volume><fpage>316</fpage><lpage>322</lpage><pub-id pub-id-type="doi">10.1007/BF00248552</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andersen</surname> <given-names>RA</given-names></name><name><surname>Asanuma</surname> <given-names>C</given-names></name><name><surname>Essick</surname> <given-names>G</given-names></name><name><surname>Siegel</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Corticocortical connections of anatomically and physiologically defined subdivisions within the inferior parietal lobule</article-title><source>The Journal of Comparative Neurology</source><volume>296</volume><fpage>65</fpage><lpage>113</lpage><pub-id pub-id-type="doi">10.1002/cne.902960106</pub-id><pub-id pub-id-type="pmid">2358530</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arcaro</surname> <given-names>MJ</given-names></name><name><surname>Pinsk</surname> <given-names>MA</given-names></name><name><surname>Li</surname> <given-names>X</given-names></name><name><surname>Kastner</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Visuotopic organization of macaque posterior parietal cortex: a functional magnetic resonance imaging study</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>2064</fpage><lpage>2078</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3334-10.2011</pub-id><pub-id pub-id-type="pmid">21307244</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baddeley</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Theories Working Memory: models, and controversies</article-title><source>Annual Review of Psychology</source><volume>63</volume><fpage>1</fpage><lpage>29</lpage><pub-id pub-id-type="doi">10.1146/annurev-psych-120710-100422</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balan</surname> <given-names>PF</given-names></name><name><surname>Ferrera</surname> <given-names>VP</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Effects of gaze shifts on maintenance of spatial memory in macaque frontal eye field</article-title><source>The Journal of Neuroscience</source><volume>23</volume><fpage>5446</fpage><lpage>5454</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.23-13-05446.2003</pub-id><pub-id pub-id-type="pmid">12843243</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barak</surname> <given-names>O</given-names></name><name><surname>Tsodyks</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Working models of working memory</article-title><source>Current Opinion in Neurobiology</source><volume>25</volume><fpage>20</fpage><lpage>24</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2013.10.008</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bolkan</surname> <given-names>SS</given-names></name><name><surname>Stujenske</surname> <given-names>JM</given-names></name><name><surname>Parnaudeau</surname> <given-names>S</given-names></name><name><surname>Spellman</surname> <given-names>TJ</given-names></name><name><surname>Rauffenbart</surname> <given-names>C</given-names></name><name><surname>Abbas</surname> <given-names>AI</given-names></name><name><surname>Harris</surname> <given-names>AZ</given-names></name><name><surname>Gordon</surname> <given-names>JA</given-names></name><name><surname>Kellendonk</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Thalamic projections sustain prefrontal activity during working memory maintenance</article-title><source>Nature Neuroscience</source><volume>20</volume><fpage>987</fpage><lpage>996</lpage><pub-id pub-id-type="doi">10.1038/nn.4568</pub-id><pub-id pub-id-type="pmid">28481349</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brainard</surname> <given-names>DH</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>The psychophysics toolbox</article-title><source>Spatial Vision</source><volume>10</volume><fpage>433</fpage><lpage>436</lpage><pub-id pub-id-type="doi">10.1163/156856897X00357</pub-id><pub-id pub-id-type="pmid">9176952</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bruce</surname> <given-names>CJ</given-names></name><name><surname>Goldberg</surname> <given-names>ME</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>Primate frontal eye fields. I. single neurons discharging before saccades</article-title><source>Journal of Neurophysiology</source><volume>53</volume><fpage>603</fpage><lpage>635</lpage><pub-id pub-id-type="doi">10.1152/jn.1985.53.3.603</pub-id><pub-id pub-id-type="pmid">3981231</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cavanagh</surname> <given-names>SE</given-names></name><name><surname>Towers</surname> <given-names>JP</given-names></name><name><surname>Wallis</surname> <given-names>JD</given-names></name><name><surname>Hunt</surname> <given-names>LT</given-names></name><name><surname>Kennerley</surname> <given-names>SW</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Reconciling persistent and dynamic hypotheses of working memory coding in prefrontal cortex</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>3498</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-05873-3</pub-id><pub-id pub-id-type="pmid">30158519</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chafee</surname> <given-names>MV</given-names></name><name><surname>Goldman-Rakic</surname> <given-names>PS</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Matching patterns of activity in primate prefrontal area 8a and parietal area 7ip neurons during a spatial working memory task</article-title><source>Journal of Neurophysiology</source><volume>79</volume><fpage>2919</fpage><lpage>2940</lpage><pub-id pub-id-type="doi">10.1152/jn.1998.79.6.2919</pub-id><pub-id pub-id-type="pmid">9636098</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chaudhuri</surname> <given-names>R</given-names></name><name><surname>Fiete</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Computational principles of memory</article-title><source>Nature Neuroscience</source><volume>19</volume><fpage>394</fpage><lpage>403</lpage><pub-id pub-id-type="doi">10.1038/nn.4237</pub-id><pub-id pub-id-type="pmid">26906506</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clark</surname> <given-names>KL</given-names></name><name><surname>Noudoost</surname> <given-names>B</given-names></name><name><surname>Moore</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Persistent spatial information in the frontal eye field during object-based short-term memory</article-title><source>Journal of Neuroscience</source><volume>32</volume><fpage>10907</fpage><lpage>10914</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1450-12.2012</pub-id><pub-id pub-id-type="pmid">22875925</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cohen</surname> <given-names>MR</given-names></name><name><surname>Kohn</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Measuring and interpreting neuronal correlations</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>811</fpage><lpage>819</lpage><pub-id pub-id-type="doi">10.1038/nn.2842</pub-id><pub-id pub-id-type="pmid">21709677</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Compte</surname> <given-names>A</given-names></name><name><surname>Brunel</surname> <given-names>N</given-names></name><name><surname>Goldman-Rakic</surname> <given-names>PS</given-names></name><name><surname>Wang</surname> <given-names>XJ</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Synaptic mechanisms and network dynamics underlying spatial working memory in a cortical network model</article-title><source>Cerebral Cortex</source><volume>10</volume><fpage>910</fpage><lpage>923</lpage><pub-id pub-id-type="doi">10.1093/cercor/10.9.910</pub-id><pub-id pub-id-type="pmid">10982751</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Compte</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Computational and in vitro studies of persistent activity: edging towards cellular and synaptic mechanisms of working memory</article-title><source>Neuroscience</source><volume>139</volume><fpage>135</fpage><lpage>151</lpage><pub-id pub-id-type="doi">10.1016/j.neuroscience.2005.06.011</pub-id><pub-id pub-id-type="pmid">16337341</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Constantinidis</surname> <given-names>C</given-names></name><name><surname>Funahashi</surname> <given-names>S</given-names></name><name><surname>Lee</surname> <given-names>D</given-names></name><name><surname>Murray</surname> <given-names>JD</given-names></name><name><surname>Qi</surname> <given-names>XL</given-names></name><name><surname>Wang</surname> <given-names>M</given-names></name><name><surname>Arnsten</surname> <given-names>AFT</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Persistent spiking activity underlies working memory</article-title><source>The Journal of Neuroscience</source><volume>38</volume><fpage>7020</fpage><lpage>7028</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2486-17.2018</pub-id><pub-id pub-id-type="pmid">30089641</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Constantinidis</surname> <given-names>C</given-names></name><name><surname>Steinmetz</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Neuronal activity in posterior parietal area 7a during the delay periods of a spatial memory task</article-title><source>Journal of Neurophysiology</source><volume>76</volume><fpage>1352</fpage><lpage>1355</lpage><pub-id pub-id-type="doi">10.1152/jn.1996.76.2.1352</pub-id><pub-id pub-id-type="pmid">8871242</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eastman</surname> <given-names>KM</given-names></name><name><surname>Huk</surname> <given-names>AC</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>PLDAPS: a hardware architecture and software toolbox for neurophysiology requiring complex visual stimuli and online behavioral control</article-title><source>Frontiers in Neuroinformatics</source><volume>6</volume><elocation-id>1</elocation-id><pub-id pub-id-type="doi">10.3389/fninf.2012.00001</pub-id><pub-id pub-id-type="pmid">22319490</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferraina</surname> <given-names>S</given-names></name><name><surname>Paré</surname> <given-names>M</given-names></name><name><surname>Wurtz</surname> <given-names>RH</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Comparison of cortico-cortical and cortico-collicular signals for the generation of saccadic eye movements</article-title><source>Journal of Neurophysiology</source><volume>87</volume><fpage>845</fpage><lpage>858</lpage><pub-id pub-id-type="doi">10.1152/jn.00317.2001</pub-id><pub-id pub-id-type="pmid">11826051</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Funahashi</surname> <given-names>S</given-names></name><name><surname>Bruce</surname> <given-names>CJ</given-names></name><name><surname>Goldman-Rakic</surname> <given-names>PS</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Mnemonic coding of visual space in the monkey's dorsolateral prefrontal cortex</article-title><source>Journal of Neurophysiology</source><volume>61</volume><fpage>331</fpage><lpage>349</lpage><pub-id pub-id-type="doi">10.1152/jn.1989.61.2.331</pub-id><pub-id pub-id-type="pmid">2918358</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fusi</surname> <given-names>S</given-names></name><name><surname>Miller</surname> <given-names>EK</given-names></name><name><surname>Rigotti</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Why neurons mix: high dimensionality for higher cognition</article-title><source>Current Opinion in Neurobiology</source><volume>37</volume><fpage>66</fpage><lpage>74</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2016.01.010</pub-id><pub-id pub-id-type="pmid">26851755</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fuster</surname> <given-names>JM</given-names></name><name><surname>Alexander</surname> <given-names>GE</given-names></name></person-group><year iso-8601-date="1971">1971</year><article-title>Neuron activity related to short-term memory</article-title><source>Science</source><volume>173</volume><fpage>652</fpage><lpage>654</lpage><pub-id pub-id-type="doi">10.1126/science.173.3997.652</pub-id><pub-id pub-id-type="pmid">4998337</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fuster</surname> <given-names>JM</given-names></name><name><surname>Jervey</surname> <given-names>JP</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>Inferotemporal neurons distinguish and retain behaviorally relevant features of visual stimuli</article-title><source>Science</source><volume>212</volume><fpage>952</fpage><lpage>955</lpage><pub-id pub-id-type="doi">10.1126/science.7233192</pub-id><pub-id pub-id-type="pmid">7233192</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerhard</surname> <given-names>F</given-names></name><name><surname>Kispersky</surname> <given-names>T</given-names></name><name><surname>Gutierrez</surname> <given-names>GJ</given-names></name><name><surname>Marder</surname> <given-names>E</given-names></name><name><surname>Kramer</surname> <given-names>M</given-names></name><name><surname>Eden</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Successful reconstruction of a physiological circuit with known connectivity from spiking activity alone</article-title><source>PLOS Computational Biology</source><volume>9</volume><elocation-id>e1003138</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003138</pub-id><pub-id pub-id-type="pmid">23874181</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gerstner</surname> <given-names>W</given-names></name><name><surname>Kistler</surname> <given-names>WM</given-names></name><name><surname>Naud</surname> <given-names>R</given-names></name><name><surname>Paninski</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2014">2014</year><source>Neuronal Dynamics: From Single Neurons to Networks and Models of Cognition</source><publisher-name>Cambridge University Press</publisher-name><pub-id pub-id-type="doi">10.1017/CBO9781107447615</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gnadt</surname> <given-names>JW</given-names></name><name><surname>Andersen</surname> <given-names>RA</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>Memory related motor planning activity in posterior parietal cortex of macaque</article-title><source>Experimental Brain Research</source><volume>70</volume><fpage>216</fpage><lpage>220</lpage><pub-id pub-id-type="doi">10.1007/bf00271862</pub-id><pub-id pub-id-type="pmid">3402565</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gold</surname> <given-names>JI</given-names></name><name><surname>Shadlen</surname> <given-names>MN</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>The neural basis of decision making</article-title><source>Annual Review of Neuroscience</source><volume>30</volume><fpage>535</fpage><lpage>574</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.29.051605.113038</pub-id><pub-id pub-id-type="pmid">17600525</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldman-Rakic</surname> <given-names>PS</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Cellular basis of working memory</article-title><source>Neuron</source><volume>14</volume><fpage>477</fpage><lpage>485</lpage><pub-id pub-id-type="doi">10.1016/0896-6273(95)90304-6</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname> <given-names>ZV</given-names></name><name><surname>Inagaki</surname> <given-names>HK</given-names></name><name><surname>Daie</surname> <given-names>K</given-names></name><name><surname>Druckmann</surname> <given-names>S</given-names></name><name><surname>Gerfen</surname> <given-names>CR</given-names></name><name><surname>Svoboda</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Maintenance of persistent activity in a frontal thalamocortical loop</article-title><source>Nature</source><volume>545</volume><fpage>181</fpage><lpage>186</lpage><pub-id pub-id-type="doi">10.1038/nature22324</pub-id><pub-id pub-id-type="pmid">28467817</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hikosaka</surname> <given-names>O</given-names></name><name><surname>Wurtz</surname> <given-names>RH</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>Visual and oculomotor functions of monkey substantia nigra pars reticulata IV relation of substantia nigra to superior colliculus</article-title><source>Journal of Neurophysiology</source><volume>49</volume><fpage>1285</fpage><lpage>1301</lpage><pub-id pub-id-type="doi">10.1152/jn.1983.49.5.1285</pub-id><pub-id pub-id-type="pmid">6306173</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Honey</surname> <given-names>CJ</given-names></name><name><surname>Thesen</surname> <given-names>T</given-names></name><name><surname>Donner</surname> <given-names>TH</given-names></name><name><surname>Silbert</surname> <given-names>LJ</given-names></name><name><surname>Carlson</surname> <given-names>CE</given-names></name><name><surname>Devinsky</surname> <given-names>O</given-names></name><name><surname>Doyle</surname> <given-names>WK</given-names></name><name><surname>Rubin</surname> <given-names>N</given-names></name><name><surname>Heeger</surname> <given-names>DJ</given-names></name><name><surname>Hasson</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Slow cortical dynamics and the accumulation of information over long timescales</article-title><source>Neuron</source><volume>76</volume><fpage>423</fpage><lpage>434</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.08.011</pub-id><pub-id pub-id-type="pmid">23083743</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Inagaki</surname> <given-names>HK</given-names></name><name><surname>Fontolan</surname> <given-names>L</given-names></name><name><surname>Romani</surname> <given-names>S</given-names></name><name><surname>Svoboda</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Discrete attractor dynamics underlies persistent activity in the frontal cortex</article-title><source>Nature</source><volume>566</volume><fpage>212</fpage><lpage>217</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-0919-7</pub-id><pub-id pub-id-type="pmid">30728503</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Katsuki</surname> <given-names>F</given-names></name><name><surname>Qi</surname> <given-names>XL</given-names></name><name><surname>Meyer</surname> <given-names>T</given-names></name><name><surname>Kostelic</surname> <given-names>PM</given-names></name><name><surname>Salinas</surname> <given-names>E</given-names></name><name><surname>Constantinidis</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Differences in intrinsic functional organization between dorsolateral prefrontal and posterior parietal cortex</article-title><source>Cerebral Cortex</source><volume>24</volume><fpage>2334</fpage><lpage>2349</lpage><pub-id pub-id-type="doi">10.1093/cercor/bht087</pub-id><pub-id pub-id-type="pmid">23547137</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kimmel</surname> <given-names>DL</given-names></name><name><surname>Moore</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Temporal patterning of saccadic eye movement signals</article-title><source>The Journal of Neuroscience</source><volume>27</volume><fpage>7619</fpage><lpage>7630</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0386-07.2007</pub-id><pub-id pub-id-type="pmid">17634356</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kleiner</surname> <given-names>M</given-names></name><name><surname>Brainard</surname> <given-names>D</given-names></name><name><surname>Pelli</surname> <given-names>D</given-names></name><name><surname>Ingling</surname> <given-names>A</given-names></name><name><surname>Murray</surname> <given-names>R</given-names></name><name><surname>Broussard</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>What’s new in psychtoolbox-3</article-title><source>Perception</source><volume>36</volume><fpage>1</fpage><lpage>16</lpage><pub-id pub-id-type="doi">10.1177/03010066070360S101</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Latimer</surname> <given-names>KW</given-names></name><name><surname>Yates</surname> <given-names>JL</given-names></name><name><surname>Meister</surname> <given-names>ML</given-names></name><name><surname>Huk</surname> <given-names>AC</given-names></name><name><surname>Pillow</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>NEURONAL MODELING Single-trial spike trains in parietal cortex reveal discrete steps during decision-making</article-title><source>Science</source><volume>349</volume><fpage>184</fpage><lpage>187</lpage><pub-id pub-id-type="doi">10.1126/science.aaa4056</pub-id><pub-id pub-id-type="pmid">26160947</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lundqvist</surname> <given-names>M</given-names></name><name><surname>Herman</surname> <given-names>P</given-names></name><name><surname>Miller</surname> <given-names>EK</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Working memory: delay activity, yes! persistent activity? maybe not</article-title><source>The Journal of Neuroscience</source><volume>38</volume><fpage>7013</fpage><lpage>7019</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2485-17.2018</pub-id><pub-id pub-id-type="pmid">30089640</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Masse</surname> <given-names>NY</given-names></name><name><surname>Hodnefield</surname> <given-names>JM</given-names></name><name><surname>Freedman</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Mnemonic encoding and cortical organization in parietal and prefrontal cortices</article-title><source>The Journal of Neuroscience</source><volume>37</volume><fpage>6098</fpage><lpage>6112</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3903-16.2017</pub-id><pub-id pub-id-type="pmid">28539423</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mays</surname> <given-names>LE</given-names></name><name><surname>Sparks</surname> <given-names>DL</given-names></name></person-group><year iso-8601-date="1980">1980</year><article-title>Dissociation of visual and saccade-related responses in superior colliculus neurons</article-title><source>Journal of Neurophysiology</source><volume>43</volume><fpage>207</fpage><lpage>232</lpage><pub-id pub-id-type="doi">10.1152/jn.1980.43.1.207</pub-id><pub-id pub-id-type="pmid">6766178</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meister</surname> <given-names>ML</given-names></name><name><surname>Hennig</surname> <given-names>JA</given-names></name><name><surname>Huk</surname> <given-names>AC</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Signal multiplexing and single-neuron computations in lateral intraparietal area during decision-making</article-title><source>Journal of Neuroscience</source><volume>33</volume><fpage>2254</fpage><lpage>2267</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2984-12.2013</pub-id><pub-id pub-id-type="pmid">23392657</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moore</surname> <given-names>T</given-names></name><name><surname>Fallah</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Control of eye movements and spatial attention</article-title><source>PNAS</source><volume>98</volume><fpage>1273</fpage><lpage>1276</lpage><pub-id pub-id-type="doi">10.1073/pnas.98.3.1273</pub-id><pub-id pub-id-type="pmid">11158629</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murray</surname> <given-names>JD</given-names></name><name><surname>Bernacchia</surname> <given-names>A</given-names></name><name><surname>Freedman</surname> <given-names>DJ</given-names></name><name><surname>Romo</surname> <given-names>R</given-names></name><name><surname>Wallis</surname> <given-names>JD</given-names></name><name><surname>Cai</surname> <given-names>X</given-names></name><name><surname>Padoa-Schioppa</surname> <given-names>C</given-names></name><name><surname>Pasternak</surname> <given-names>T</given-names></name><name><surname>Seo</surname> <given-names>H</given-names></name><name><surname>Lee</surname> <given-names>D</given-names></name><name><surname>Wang</surname> <given-names>XJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A hierarchy of intrinsic timescales across primate cortex</article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>1661</fpage><lpage>1663</lpage><pub-id pub-id-type="doi">10.1038/nn.3862</pub-id><pub-id pub-id-type="pmid">25383900</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murray</surname> <given-names>JD</given-names></name><name><surname>Bernacchia</surname> <given-names>A</given-names></name><name><surname>Roy</surname> <given-names>NA</given-names></name><name><surname>Constantinidis</surname> <given-names>C</given-names></name><name><surname>Romo</surname> <given-names>R</given-names></name><name><surname>Wang</surname> <given-names>XJ</given-names></name></person-group><year iso-8601-date="2017">2017a</year><article-title>Stable population coding for working memory coexists with heterogeneous neural dynamics in prefrontal cortex</article-title><source>PNAS</source><volume>114</volume><fpage>394</fpage><lpage>399</lpage><pub-id pub-id-type="doi">10.1073/pnas.1619449114</pub-id><pub-id pub-id-type="pmid">28028221</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murray</surname> <given-names>JD</given-names></name><name><surname>Jaramillo</surname> <given-names>J</given-names></name><name><surname>Wang</surname> <given-names>XJ</given-names></name></person-group><year iso-8601-date="2017">2017b</year><article-title>Working memory and Decision-Making in a frontoparietal circuit model</article-title><source>The Journal of Neuroscience</source><volume>37</volume><fpage>12167</fpage><lpage>12186</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0343-17.2017</pub-id><pub-id pub-id-type="pmid">29114071</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Pachitariu</surname> <given-names>M</given-names></name><name><surname>Steinmetz</surname> <given-names>N</given-names></name><name><surname>Kadir</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Kilosort: realtime spike-sorting for extracellular electrophysiology with hundreds of channels</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/061481</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paninski</surname> <given-names>L</given-names></name><name><surname>Shoham</surname> <given-names>S</given-names></name><name><surname>Fellows</surname> <given-names>MR</given-names></name><name><surname>Hatsopoulos</surname> <given-names>NG</given-names></name><name><surname>Donoghue</surname> <given-names>JP</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Superlinear population encoding of dynamic hand trajectory in primary motor cortex</article-title><source>Journal of Neuroscience</source><volume>24</volume><fpage>8551</fpage><lpage>8561</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0919-04.2004</pub-id><pub-id pub-id-type="pmid">15456829</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Park</surname> <given-names>IM</given-names></name><name><surname>Meister</surname> <given-names>ML</given-names></name><name><surname>Huk</surname> <given-names>AC</given-names></name><name><surname>Pillow</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Encoding and decoding in parietal cortex during sensorimotor decision-making</article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>1395</fpage><lpage>1403</lpage><pub-id pub-id-type="doi">10.1038/nn.3800</pub-id><pub-id pub-id-type="pmid">25174005</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pillow</surname> <given-names>JW</given-names></name><name><surname>Shlens</surname> <given-names>J</given-names></name><name><surname>Paninski</surname> <given-names>L</given-names></name><name><surname>Sher</surname> <given-names>A</given-names></name><name><surname>Litke</surname> <given-names>AM</given-names></name><name><surname>Chichilnisky</surname> <given-names>EJ</given-names></name><name><surname>Simoncelli</surname> <given-names>EP</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Spatio-temporal correlations and visual signalling in a complete neuronal population</article-title><source>Nature</source><volume>454</volume><fpage>995</fpage><lpage>999</lpage><pub-id pub-id-type="doi">10.1038/nature07140</pub-id><pub-id pub-id-type="pmid">18650810</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Premereur</surname> <given-names>E</given-names></name><name><surname>Vanduffel</surname> <given-names>W</given-names></name><name><surname>Janssen</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Functional heterogeneity of macaque lateral intraparietal neurons</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>12307</fpage><lpage>12317</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2241-11.2011</pub-id><pub-id pub-id-type="pmid">21865473</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rigotti</surname> <given-names>M</given-names></name><name><surname>Barak</surname> <given-names>O</given-names></name><name><surname>Warden</surname> <given-names>MR</given-names></name><name><surname>Wang</surname> <given-names>X-J</given-names></name><name><surname>Daw</surname> <given-names>ND</given-names></name><name><surname>Miller</surname> <given-names>EK</given-names></name><name><surname>Fusi</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The importance of mixed selectivity in complex cognitive tasks</article-title><source>Nature</source><volume>497</volume><fpage>585</fpage><lpage>590</lpage><pub-id pub-id-type="doi">10.1038/nature12160</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rodermund</surname> <given-names>P</given-names></name><name><surname>Westendorff</surname> <given-names>S</given-names></name><name><surname>Nieder</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Blockage of NMDA- and GABA(A) Receptors improves working memory selectivity of primate prefrontal neurons</article-title><source>The Journal of Neuroscience</source><volume>40</volume><fpage>1527</fpage><lpage>1537</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2009-19.2019</pub-id><pub-id pub-id-type="pmid">31911457</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosenbaum</surname> <given-names>R</given-names></name><name><surname>Smith</surname> <given-names>MA</given-names></name><name><surname>Kohn</surname> <given-names>A</given-names></name><name><surname>Rubin</surname> <given-names>JE</given-names></name><name><surname>Doiron</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The spatial structure of correlated neuronal variability</article-title><source>Nature Neuroscience</source><volume>20</volume><fpage>107</fpage><lpage>114</lpage><pub-id pub-id-type="doi">10.1038/nn.4433</pub-id><pub-id pub-id-type="pmid">27798630</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Runyan</surname> <given-names>CA</given-names></name><name><surname>Piasini</surname> <given-names>E</given-names></name><name><surname>Panzeri</surname> <given-names>S</given-names></name><name><surname>Harvey</surname> <given-names>CD</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Distinct timescales of population coding across cortex</article-title><source>Nature</source><volume>548</volume><fpage>92</fpage><lpage>96</lpage><pub-id pub-id-type="doi">10.1038/nature23020</pub-id><pub-id pub-id-type="pmid">28723889</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmitt</surname> <given-names>LI</given-names></name><name><surname>Wimmer</surname> <given-names>RD</given-names></name><name><surname>Nakajima</surname> <given-names>M</given-names></name><name><surname>Happ</surname> <given-names>M</given-names></name><name><surname>Mofakham</surname> <given-names>S</given-names></name><name><surname>Halassa</surname> <given-names>MM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Thalamic amplification of cortical connectivity sustains attentional control</article-title><source>Nature</source><volume>545</volume><fpage>219</fpage><lpage>223</lpage><pub-id pub-id-type="doi">10.1038/nature22073</pub-id><pub-id pub-id-type="pmid">28467827</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Selemon</surname> <given-names>LD</given-names></name><name><surname>Goldman-Rakic</surname> <given-names>PS</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>Common cortical and subcortical targets of the dorsolateral prefrontal and posterior parietal cortices in the rhesus monkey: evidence for a distributed neural network subserving spatially guided behavior</article-title><source>The Journal of Neuroscience</source><volume>8</volume><fpage>4049</fpage><lpage>4068</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.08-11-04049.1988</pub-id><pub-id pub-id-type="pmid">2846794</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spaak</surname> <given-names>E</given-names></name><name><surname>Watanabe</surname> <given-names>K</given-names></name><name><surname>Funahashi</surname> <given-names>S</given-names></name><name><surname>Stokes</surname> <given-names>MG</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Stable and dynamic coding for working memory in primate prefrontal cortex</article-title><source>The Journal of Neuroscience</source><volume>37</volume><fpage>6503</fpage><lpage>6516</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3364-16.2017</pub-id><pub-id pub-id-type="pmid">28559375</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stevenson</surname> <given-names>IH</given-names></name><name><surname>Rebesco</surname> <given-names>JM</given-names></name><name><surname>Miller</surname> <given-names>LE</given-names></name><name><surname>Körding</surname> <given-names>KP</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Inferring functional connections between neurons</article-title><source>Current Opinion in Neurobiology</source><volume>18</volume><fpage>582</fpage><lpage>588</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2008.11.005</pub-id><pub-id pub-id-type="pmid">19081241</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stokes</surname> <given-names>MG</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>'Activity-silent' working memory in prefrontal cortex: a dynamic coding framework</article-title><source>Trends in Cognitive Sciences</source><volume>19</volume><fpage>394</fpage><lpage>405</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2015.05.004</pub-id><pub-id pub-id-type="pmid">26051384</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stokes</surname> <given-names>M</given-names></name><name><surname>Spaak</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The importance of Single-Trial analyses in cognitive neuroscience</article-title><source>Trends in Cognitive Sciences</source><volume>20</volume><fpage>483</fpage><lpage>486</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2016.05.008</pub-id><pub-id pub-id-type="pmid">27237797</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tegnér</surname> <given-names>J</given-names></name><name><surname>Compte</surname> <given-names>A</given-names></name><name><surname>Wang</surname> <given-names>XJ</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>The dynamical stability of reverberatory neural circuits</article-title><source>Biological Cybernetics</source><volume>87</volume><fpage>471</fpage><lpage>481</lpage><pub-id pub-id-type="doi">10.1007/s00422-002-0363-9</pub-id><pub-id pub-id-type="pmid">12461636</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>XJ</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Synaptic basis of cortical persistent activity: the importance of NMDA receptors to working memory</article-title><source>The Journal of Neuroscience</source><volume>19</volume><fpage>9587</fpage><lpage>9603</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.19-21-09587.1999</pub-id><pub-id pub-id-type="pmid">10531461</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>XJ</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Synaptic reverberation underlying mnemonic persistent activity</article-title><source>Trends in Neurosciences</source><volume>24</volume><fpage>455</fpage><lpage>463</lpage><pub-id pub-id-type="doi">10.1016/S0166-2236(00)01868-3</pub-id><pub-id pub-id-type="pmid">11476885</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yates</surname> <given-names>JL</given-names></name><name><surname>Park</surname> <given-names>IM</given-names></name><name><surname>Katz</surname> <given-names>LN</given-names></name><name><surname>Pillow</surname> <given-names>JW</given-names></name><name><surname>Huk</surname> <given-names>AC</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Functional dissection of signal and noise in MT and LIP during decision-making</article-title><source>Nature Neuroscience</source><volume>20</volume><fpage>1285</fpage><lpage>1292</lpage><pub-id pub-id-type="doi">10.1038/nn.4611</pub-id><pub-id pub-id-type="pmid">28758998</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zylberberg</surname> <given-names>J</given-names></name><name><surname>Strowbridge</surname> <given-names>BW</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Mechanisms of persistent activity in cortical circuits: possible neural substraStrowbridgetes for working memory</article-title><source>Annual Review of Neuroscience</source><volume>40</volume><fpage>603</fpage><lpage>627</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-070815-014006</pub-id><pub-id pub-id-type="pmid">28772102</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.52460.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Salinas</surname><given-names>Emilio</given-names></name><role>Reviewing Editor</role><aff><institution>Wake Forest School of Medicine</institution><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Salinas</surname><given-names>Emilio</given-names> </name><role>Reviewer</role><aff><institution>Wake Forest School of Medicine</institution><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Compte</surname><given-names>Albert</given-names> </name><role>Reviewer</role><aff><institution>Institut d'Investigacions Biomèdiques August Pi i Sunyer (IDIBAPS)</institution><country>Spain</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>This study combines multi-neuron recordings from two cortical areas, FEF and LIP, with advanced fitting techniques (GLM modeling) to investigate the underlying neuronal dynamics that unfold during a classic memory-based visuomotor task. The approach is notable because it teases apart the contributions of task events, firing history, and functional coupling across neurons to the evoked spiking activity, doing so in a way that is interpretable. The observed neuronal interactions (magnitudes and timescales) are broadly consistent with those proposed by classic theoretical models of persistent activity and working memory, but the data also reveal intriguing differences and similarities between FEF and LIP that should serve to constrain and refine future models of the frontoparietal attentional network.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Recurrent circuit dynamics underlie persistent activity in the macaque frontoparietal network&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, including Emilio Salinas as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by Timothy Behrens as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Albert Compte (Reviewer #2).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>This manuscript analyzes single-neuron activity in the FEF and area LIP during the classic memory-guided saccade task. The novelty here lies in the recording of multiple neurons (5-20 per session) from both areas simultaneously, and in the GLM analyses, which are able to tease apart how task events, firing history, and interneuronal coupling determine the spikes fired by each neuron. The results provide a statistical view of the recurrent interactions between and within these two areas that is of relevance to their functional characterization, and to models of recurrent circuits and working memory in general.</p><p>All reviewers agreed that this is fantastic data set and that the analysis is interesting and novel. The general concern was that the methods require more thorough validation in order to put the interpretations on a more solid footing. The suggested revisions will require additional analyses, but not additional experiments. The consensus was that they are important for supporting the conclusions (which could change as a result).</p><p>Essential revisions:</p><p>1) All reviewers identified potential problems with the analysis/interpretation of the results of the GLM procedure, as can be seen in the individual reviews below. However, as detailed by reviewer 2, many of these concerns could be addressed by testing the GLM methods against synthetic data from the very network models that the results seem to support. This would require substantial work, but is in principle straightforward. This sort of analysis, where the model is tested with designed data sets for which the correct answers are known, would substantially strengthen the credibility of the results and their interpretation.</p><p>Some important methodological concerns that could be at least partially addressed in this way are the following:</p><p>a) It is not entirely clear why the &quot;exceptionally strong coupling&quot; between neurons contributes in such a subtle way to the predictions of neural activity (i.e., they are not needed to accurately replicate the PSTHs).</p><p>b) Verifying the shuffling procedure (null hypothesis) for determining the significance of the coupling terms.</p><p>c) It is unclear whether the history-dependent kernels only capture intrinsic neuronal properties, as opposed to influences from other neurons that could be equivalent to history effects.</p><p>d) How do the results depend on receptive field overlap? In particular, it is possible that the differences between LIP and FEF are the consequence of different overlap patterns in the two areas.</p><p>2) The total coupling strength, which is the net result of adding the positive and negative (inhibitory) kernel weights, is used as a summary measure of coupling between neurons. As elaborated by reviewer 1, this is a potentially misleading quantity, as it does not consider the magnitudes of the excitatory and inhibitory components. The analyses should be run also with alternative measures that take this distinction into account.</p><p>3) Consideration of differences across neuronal classes; in particular, whether the results are distinctly different for neurons with significant delay period activity, as mentioned by reviewer 2.</p><p>4) There is insufficient validation of the model against traditional analysis techniques, such as cross-correlation analyses.</p><p>5) There is insufficient description of some of the analytical procedures (see specific comments below).</p><p><italic>Reviewer #1:</italic></p><p>This work addresses important problems in oculomotor physiology, is sound, clearly described, and contains many interesting nuggets about the FEF-LIP circuitry. Just to mention one of them, the three interaction kernels provide convincing measures of the time constants of these circuits, confirming long-help ideas based on theory and modeling. Other results, such as the stronger interactions across than within areas, are interesting precisely because they do go a bit against the grain.</p><p>I only have one substantial comment. Several analyses are based on the total coupling strength, which is the net result of adding the positive and negative (inhibitory) kernel weights. This leads to the conclusion that &quot;coupling in LIP was greater than FEF, suggesting a greater degree of recurrent connectivity in LIP&quot;. But the total strength is a crude measure. If the subtraction of excitation and inhibition gives 1 = 20 – 19 net excitation in one area and 2 = 5 – 3 in the other, is it really fair to say that the coupling is stronger in the latter? Clearly not. Stronger nonlinearities are expected for highly balanced circuits in which both excitation and inhibition are stronger. This intuition is missing in the Discussion paragraphs four and five. In that case, identical excitation in both areas but stronger inhibition in FEF than LIP would be perfectly consistent with stronger winner-take-all dynamics in FEF and more tolerance to spatial ambiguity in LIP, in turn consistent with saccade selection in the former and divided attention in the latter.</p><p>My suggestion is to quantify the excitatory and inhibitory interactions separately. For instance, by computing the total excitatory coupling on one hand, and the total inhibitory coupling on the other. If both terms <italic>and</italic> the net result are stronger in LIP than FEF, then that would credibly verify the current conclusion (&quot;greater coupling in LIP than FEF&quot;). But I suspect (from Figure 3B) that the situation is a bit more nuanced. For instance, stronger inhibitory coupling in FEF would be consistent with stronger motor competition and/or narrower visual tuning. Likewise, one could argue that the relevant indicator of stronger or more reliable delay-period activity is not the net coupling (excitation minus inhibition) but the total absolute coupling (i.e., the total summed magnitude of the coupling weights). I think that, in general, consideration of these alternatives beyond the net coupling would provide a broader and more substantial view of the data, and a more nuanced basis for their functional interpretation, without any alterations to the GLM model.</p><p><italic>Reviewer #2:</italic></p><p>This manuscript provides evidence that recurrent mechanisms in LIP, FEF and between these two areas are engaged during persistent activity in a delayed response task. This is supported by fitting neuronal spiking data simultaneously recorded in these areas with a population encoding model. A GLM fitting procedure estimates parameters for visual and motor dependencies, neuronal history dependence, and coupling kernels between simultaneously recorded neurons. The coupling kernels are reported strong in comparison to history kernels, and contain time scales consistent with excitatory and inhibitory mechanisms typically included in attractor models of working memory.</p><p>The manuscript is a valuable and significant contribution to the research on the mechanisms of working memory. For this classic task, a population-level analysis of simultaneous recordings in two cortical areas has not yet been presented, and provides important insights into the relative importance of different mechanisms that have been proposed to support persistent activity: intrinsic mechanisms, local circuit recurrence, and recurrent interactions between areas. The methods applied are aimed at testing this with advanced statistical methods.</p><p>My major concerns regarding the conclusions drawn from these analyses are:</p><p>1) There is an inconsistency in the manuscript in that, on the one hand, interneuronal couplings do not improve PSTH predictions (Figure 3D) and yet various analyses (Figure 3A, Figure 4C) are interpreted as demonstrating &quot;exceptionally strong coupling&quot;, &quot;exceptionally strong recurrent interactions&quot; or that &quot;network dynamics play a more vital role than intrinsic dynamics&quot;. If recurrent interactions are removed from an attractor model persistent activity collapses, and PSTHs are profoundly affected. At face value, the findings thus do not seem to represent a direct support of these models. The fact that exceptionally strong couplings do not have an impact in the PSTH should be better explained.</p><p>2) I am concerned about the &quot;null hypothesis&quot; in Figure 3A: if trials are shuffled for each neuron before the fit, then neural activity is modeled with spiking data of other neurons obtained in trials with different delay duration, so not aligned to the stimulus and saccade predictors used in the model. Since these events are typically associated with an increase in firing rate, interneuronal couplings will be reduced in this model because of these misalignments. The reading of &quot;strong recurrence&quot; that now emanates from the comparison with this &quot;null hypothesis&quot; might instead result from this misalignment. Maybe a more direct assessment of how strong is the contribution of couplings to the network would be to evaluate what fraction they represent in the sum of all predictor terms in the model.</p><p>3) The manuscript emphasizes the role of recurrent interactions in generating persistent activity. However, not all neurons recorded in LIP and FEF show persistent activity in this task. In particular, Figure 2 shows that neurons with robust persistent activity show sustained history kernels, which supposedly affect just a minority of neurons in the database (Figure 4C). Some of the conclusions may change if one considers separately neurons with strong persistent activity from other neurons. For instance, if neurons with persistent activity mostly populate the right cloud of dots in Figure 4C the interpretation of this panel's results would be very different. Example neurons shown in Figure 1 could be explicitly identified in Figure 4C and other panels with individual neuron data. If the question is how persistent activity is generated, then it should be relevant to consider separately neurons with and without persistent activity.</p><p>4) The interpretations in the manuscript jump very easily between the statistical description contained in the fitted kernels and biophysical mechanisms, and this should be more carefully considered. Any &quot;temporal integration above and beyond that explained by the external task elements&quot; (Park et al., 2014) and the spike times of the few simultaneously recorded neurons in that session will be attributed to history kernels, which would therefore be inappropriate to attribute to intrinsic cellular mechanisms. In general, authors should be cautious with the possible confusion in using &quot;intrinsic&quot; to refer to the history kernel. The history kernel might include traces of other network dynamics not captured by the few neurons recorded simultaneously in the session.</p><p>Importantly, many of these concerns could be directly addressed by analyzing spike trains from a few neurons selected from attractor network simulations (many of which freely available) to verify if their GLM approach is able to extract the biophysically-based parameters of the model, as currently argued. My intuition is that model neurons without any specific intrinsic mechanism with long time course would show a long-lasting history dependence (self excitation) when modeled against the activity of just a handful of their close neighbors. The number of neurons used as predictors, or the similarity of their memory fields, could also conceivably have an impact in the decay time of history and coupling kernels, and thus contribute to possible differences between FEF and LIP in this analysis. These computational models are freely available (for instance https://neuronaldynamics-exercises.readthedocs.io/en/latest/) and the model data can be generated easily and analyzed with the authors' methods.</p><p><italic>Reviewer #3:</italic></p><p>The paper uses a novel analytical technique to infer functional connectivity among FEF and LIP cells during a memory guided saccade task. The analysis takes a GLM-based approach and fits spike trains of simultaneously recorded FEF and LIP cells as weighted combinations of kernels related to (1) target location, (2) saccade direction, (3) coupling filters modeling interactions among cells and (4) history filter modeling within-neuron autocorrelations. The main conclusions are that FEF and LIP neurons show strong coupling both within and across areas, and that LIP shows stronger coupling and longer intrinsic timescales than FEF.</p><p>While the approach is interesting and potentially useful, I am afraid it is not sufficiently justified in the present version of the manuscript. The level of detail provided is simply not sufficient to support the claims based on this novel analysis technique. I see two main problems with the manuscript as it is now:</p><p>1) There is insufficient control for potentially differential sampling of neurons in FEF and LIP: Could the apparent stronger coupling in LIP vs. FEF be due to different neural sampling in the two areas? For instance, if the RF of the recorded cells had more overlap in LIP relative to FEF, that may produce stronger apparent coupling in two different ways. Stronger coupling may arise if the model mis-attributes shared stimulus/saccade related activity to the coupling weights. The authors emphasize that their model identified coupling above and beyond any stimulus-related response, but they provide little evidence to substantiate this assertion. Stronger coupling may also arise if the model correctly attributes variance but the neurons are in fact more coupled by virtue of being more functionally similar. In that case, the areal differences are only artefacts of the neurons the authors happened to sample. We need much more thorough analyses of the similarity in RF profiles and temporal response profiles of the recorded cells to rule out a sampling confound.</p><p>2) There is insufficient validation of the model against traditional analysis techniques. The field has several traditional, established measures of neural coupling or connectivity, including noise correlations and joint PSTHs or autocorrelograms. The authors dismiss those analyses off hand with little justification except for saying that they do not adequately remove stimulus-evoked activity. But there are actually many ways for them to get around confounds with these methods. Comparing their model results to these traditional analyses is essential to validate their results.</p><p>3) There is insufficient description of the analytical procedures:</p><p>– How were the neurons combined across recording days? Clearly, the neurons that were simultaneously recorded each day could be fit using the described method. But the authors say that they simultaneously fit the entire data set – including neurons recorded on different days. How precisely did they set this up and how did this affect the results?</p><p>– What were the kernels that the authors used in the model fits? How were those kernels selected? What properties must the kernels have to make the model work? Are the conclusions robust over reasonable changes in kernel shape?</p><p>– Goodness of fit and model comparisons: The authors should provide a complete description of the type of models they compared.</p><p>– Individual monkey results: How many cells were recorded in each monkey? Did the critical results hold in both monkeys?</p><p>[Editors' note: further revisions were suggested prior to acceptance, as described below.]</p><p>Thank you for re-submitting your article &quot;Recurrent circuit dynamics underlie persistent activity in the macaque frontoparietal network&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by two peer reviewers, including Emilio Salinas as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by Timothy Behrens as the Senior Editor.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>The authors have been very responsive to the comments made in the original reviews, and have thoroughly revised the manuscript. The methods are clearer and the conclusions and rationale for the model more robust. Importantly, the GLM approach has now been validated by applying it to simulated data, and the new results are largely consistent with the original intuition provided by the authors.</p><p>However, several implementation details that can potentially affect the results were still unclear and require more thorough explanation.</p><p>Essential revisions:</p><p>1) What exactly is the uncoupled model?</p><p>2) How exactly is the shuffling across trials performed?</p><p>3) More careful analyses of the activity during fixation and early delay.</p><p>4) Clarification of the dependence on overall firing rate (separate from the variations in connectivity).</p><p>These points are discussed at length by reviewer 2 below.</p><p><italic>Reviewer #2:</italic></p><p>The revised manuscript contains significant improvements over the previous version, notably the new computational model data that provides support to the methods applied. However, I still maintain some relevant concerns on the controls required to support the interpretations of their analyses as couplings between neurons. This concerns primarily the shuffle approach and the control of firing rate confounds as detailed below.</p><p>1) Related to previous Major concern 1.</p><p>I realize that part of the confusion here is that the “uncoupled model” is never fully described. I understood that this was the full fitted model, to which couplings were set to zero. From this model I would expect PSTHs to differ largely from measured PSTHs, if couplings are contributing significantly to the GLM. Instead, I gather from Pillow et al. (2008) that the uncoupled model is a reduced model refitted to the data, and then I understand that the fit may be good even if couplings for the full model are strong contributors to the fit. I urge the authors to explain clearly what their uncoupled model is. In fact, in the current revision this is further confused in the Materials and methods (“Unsurprisingly,…”), where the “uncoupled method” is commented in the middle of the description of the shuffle approach. These two separate controls should be clearly distinguished and specified so the reader understands their separate implications. Now this is very confusing.</p><p>2) Related to previous Major concern 2.</p><p>I am still not convinced about the shuffle approach on which the &quot;extraordinarily strong coupling&quot; result is based. If I understand it correctly, the structure of the data is as schematically depicted in Decision letter image 1, with simultaneous spike trains recorded (here 10 neurons in 10 lines per panel) for separate trials (here 8 trials in 8 panels), where in each trial the stimulus is presented in different locations (here different colors of the simulus and response shadings) and delay durations are also different from trial to trial. Neurons respond with spiking activity depending on whether the stimulus falls within their receptive field or not.</p><fig id="respfig1"><label>Decision letter image 1.</label><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52460-des-fig1-v1.tif"/></fig><p>The GLM for the neuron on the gray background would then model spikes based on its specific stimulus and response events for each different trial, on its previous spikes in the corresponding trial, and on the previous spikes of all other neurons in the corresponding trials. Crucially the spikes for these other same-trial neurons are collected based on the same stimulus location, response and delay duration.If I understand correctly the shuffle condition applied in Figure 3, the GLM now models the gray-background neuron based on its specific stimulus and response events for each different trial and on its previous spikes in the corresponding trial, exactly as before, but now the spikes of other neurons are taken from randomly picked trials. This is represented in the schematic in Decision letter image 2 (notice the first lines of each panel are the same for both schematics). If this is the case, then now the spikes for these other shuffled neurons were <italic>not</italic> collected based on the same stimulus location, response and delay duration as the modeled neuron. As a result, the consistency of stimulus activation of neuron 9 and neuron 7 shown in Decision letter image 1 (they are both active or inactive in response to stimuli in all trials), and the consistency of the timing of response events, are broken with the shuffle in Decision letter image 2. This will lead to a radical change in the cross-correlations between these two neurons, even if these spike trains were totally independently generated.</p><fig id="respfig2"><label>Decision letter image 2.</label><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52460-des-fig2-v1.tif"/></fig><p>I have run this simulation. Data for these spike trains were independently generated for each neuron (so with no coupling between them), only keeping the consistency of stimulus, response and delay within trials. As shown in the histograms in Decision letter image 3, the mean cross-correlations (as a proxy of the couplings obtained with the GLM) were radically affected by the shuffling procedure. This does not demonstrate any functional coupling between the neurons, but the fact that task events that elicited neural responses were misaligned by the shuffling procedure.</p><fig id="respfig3"><label>Decision letter image 3.</label><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52460-des-fig3-v1.tif"/></fig><p>In my view, this effect could explain the extraordinary changes in shuffle histograms in Figure 3. To clarify this, the shuffle should be performed only between trials with equal stimulus location and delay duration, or else apply other commonly used resampling procedures to estimate cross- correlations (Fujisawa et al., 2008; Katsuki et al., 2014), such as within-trial jitter correction methods (Amarasingham et al., J Neurophysiol 2012).3) The section on “Interneuronal coupling is dynamic across behavioral epochs” is very confusing and is not really addressing the point that they are formulating. The fact that there are not very marked changes between couplings measured in the fixation and delay periods is taken as evidence of dynamical working memory without much justification. Later on the comparison of early and late delay periods yields stronger couplings as delay progresses. In my view, this attempt to contribute to the debate on dynamic delay activity, or even activity-silent working memory (Stokes et al., 2015) is overambitious and needs more specific analyses (consider for instance possible traces of the stimuli in the couplings after the response period, by comparing in and out conditions in the baseline period where there is no confound of firing rate for in/out conditions, e.g. Spaak et al., SfN 2017 #339.14; Barbosa et al., Biorxiv, 2019, doi:10.1101/763938). Further, in the interpretations of this paragraph it is disclosed that their measure of coupling is confounded by changes in firing rate (“This finding highlights the potential role of nuanced changes in the dynamics of the network rather than an overall increase in population activity”). This should be declared early on, as this confound may affect many of the interpretations. Any interpretations of difference in coupling strengths should be cautious in previously demonstrating no difference in firing rates, or else in applying more stringent rate-correcting methods such as jitter correction (Fujisawa et al., 2008). Currently, the manuscript does not parallel each of the coupling comparisons (FEF-LIP, fixation-delay, etc.) with corresponding comparisons of mean firing rates, or rate-correcting measures, to support these conclusions.</p><p>4) The computational model is a nice demonstration of their methods, in particular of the retrieval of the correct time scale of the interactions between neurons (the AMPA and NMDA current time courses). However, in terms of the strengths of the couplings, the model may also be confounded by changes in firing rate. It will be useful to plot the mean firing rate of model neurons as recurrent connectivity is increased. If this mean firing rate is increasing too, then some compensatory change may be introduced to maintain rates constant as recurrent connectivity increases in order to resolve this concern. The stimulus kernels derived from the model in Figure 7D, left panel, do not seem to correspond to the simulation results: stimuli in receptive fields should generate increase in rates, and stimuli outside the receptive field a suppression of rates.</p><p>5) Because of the possible rate confound that affects the coupling measure, the manuscript should provide a mean firing rate description of the various areas and task periods, for instance through average PSTHs.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.52460.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Summary:</p><p>This manuscript analyzes single-neuron activity in the FEF and area LIP during the classic memory-guided saccade task. The novelty here lies in the recording of multiple neurons (5-20 per session) from both areas simultaneously, and in the GLM analyses, which are able to tease apart how task events, firing history, and interneuronal coupling determine the spikes fired by each neuron. The results provide a statistical view of the recurrent interactions between and within these two areas that is of relevance to their functional characterization, and to models of recurrent circuits and working memory in general.</p><p>All reviewers agreed that this is fantastic data set and that the analysis is interesting and novel. The general concern was that the methods require more thorough validation in order to put the interpretations on a more solid footing. The suggested revisions will require additional analyses, but not additional experiments. The consensus was that they are important for supporting the conclusions (which could change as a result).</p></disp-quote><p>We thank the reviewers and editor for the thoughtful feedback, and were very happy that there is shared enthusiasm about the value of these experiments. We are grateful for the chance to both add and clarify validation assessments. These are very important both for making inferences about the data, and for linking those inferences to theories of persistent activity. We describe specifics below, but at a high level, we have addressed this issue in a number of ways.</p><p>First, we have clarified the value of the shuffling analyses that we used throughout the first submitted version. There was some misunderstanding on how this validation procedure works, which we have elaborated on in the specific responses, the methods, and in the manuscript. In short, we shuffle the order (i.e., trial numbers) of the trials for each neuron relative to other neurons – which eliminates the correlations between neurons but maintains the temporal dependencies of the task events and the spike times within each trial. This is equivalent to treating each neuron independently in the model and ignoring the simultaneous nature of the recordings. Unsurprisingly, adding coupling to the model (which captures the correlational structure of the single-trial spike trains) does not improve the fit of the predicted PSTHs because PSTHs (by their very nature) ignore single trial dynamics by averaging across trials (a point that we discuss in more detail in specific responses). The shuffling analysis provides a clear null model against which to identify functional interactions within the GLM (i.e., beyond what is expected by chance) and was used as a validation in the original coupled-GLM work (Pillow et al., 2008). It is therefore well-suited to provide the very validation of the coupling required by the reviewers (and ourselves).</p><p>Second, we have run the same GLM-based analyses on simulated datasets generated from a conventional attractor network (Figure 7). This is the closest we could come to the spirit of the request to do an analysis where the “correct answers are known” (beyond the null model). There is a wrinkle to this, which is that, in fact, although the synthetic network architecture is of course known, the resulting covariance structure is not known. To the best of our (and some of our more computationally-expert collaborators) knowledge, there is no general way to specify in advance the correlation structure of an attractor-style spiking network, which of course have a series of interacting nonlinearities that would make this exceedingly difficult. Regardless of this technical point, we think that direct comparison to the classical model is highly valuable. We had envisioned saving this for a second paper, as there are a plethora of potential analyses one could do to test the mechanistic models against our dataset. But we spent a lot of time on the core comparison and provide some interesting results at the end of the revised manuscript. Indeed, we were pleasantly surprised to see that the GLM did a really nice job of estimating the recurrent connectivity of the network and recovering the temporal dynamics built into the model neurons, which we take as an additional validation along the lines of the “known right answer” logic proposed by the reviews.</p><p>Third, we have also clarified the value of the simultaneous fitting (i.e., estimation of all neuron-to-neuron interactions within a recording session). In retrospect, we really goofed on making both the nature of the “simultaneous” fitting and its value clear in the first submission. The revised manuscript now clarifies how the simultaneous fitting is done (i.e., at the level of all neurons recorded within a session), and how this approach mitigates the usual interpretive ambiguities of standard pairwise correlation measures. Imagine that Cell A drives both Cell B and Cell C, without any additional drive between B and C. Standard pairwise correlations, estimated one pair at a time in series, would identify correlations not just between A and B and A and C, but also between B and C (the latter by virtue of their shared input from A, which is not considered in a pairwise correlation). But by estimating these impacts simultaneously, the fully-coupled GLM could capture the impacts of A on B and C, but can also “explain away” the correlation between B and C. This issue has been laid out nicely in Stevenson et al. (2008), which we now cite. We have also added comparisons to more traditional measures of correlations in the supplemental.</p><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) All reviewers identified potential problems with the analysis/interpretation of the results of the GLM procedure, as can be seen in the individual reviews below. However, as detailed by reviewer 2, many of these concerns could be addressed by testing the GLM methods against synthetic data from the very network models that the results seem to support. This would require substantial work, but is in principle straightforward. This sort of analysis, where the model is tested with designed data sets for which the correct answers are known, would substantially strengthen the credibility of the results and their interpretation.</p></disp-quote><p>We appreciate the push to directly compare data to theory. This was planned to be a detailed second paper, and we have several collaborations underway to that effect. Nevertheless, we have made, frankly, faster and more clear progress on this than we expected. We have generated synthetic datasets from an attractor network while parametrically varying the recurrent strength of the excitatory population (Figure 7). We sampled spike trains from these networks akin to the experiment and fit the GLM in the exact same way we did for the real data. We found that coupling (estimated from the GLM) is systematically related to the internal connectivity strength of the attractor network. This finding is not only an important validation but allows us to situate our LIP and FEF results relative not just to each other, but to theory. We now conclude the manuscript with these analyses.</p><disp-quote content-type="editor-comment"><p>Some important methodological concerns that could be at least partially addressed in this way are the following:</p><p>a) It is not entirely clear why the &quot;exceptionally strong coupling&quot; between neurons contributes in such a subtle way to the predictions of neural activity (i.e., they are not needed to accurately replicate the PSTHs).</p></disp-quote><p>We have clarified the dissociation between explaining the mean responses (PSTHs) and explaining the single-trial responses (which benefit from characterizations of correlated noise, both between and within neurons). This dissociation is commonly observed in such single-trial fitting schemes, such as the classic population GLM paper by Pillow et al., as well as in more recent work in LIP and MT (Park et al., 2014; Yates et al., 2017). It’s worth mentioning that the contribution of coupling to the predictions of neural activity are not “subtle” in the data. As explained, coupling has little effect on predicting the PSTHs because they collapse across trials and ignore correlations (Figure 3D), but coupling universally benefits the predictions for single-trial spike trains (Figure 3E). As noted in the manuscript and in our more detailed replies, to understand the network dynamics underlying persistent activity during behaviorally relevant timescales, we must focus on single trials rather than averages that obscure the single-trial dynamics (for more discussion see Stokes and Spaak, 2016; Latimer et al., 2015). That said, it is also important to note that the GLM does a very good job predicting the PSTH of most neurons regardless of coupling (variance explained in Figure 3D) which is also consistent with the work cited above. We have attempted to clarify and emphasize this point in the manuscript.</p><disp-quote content-type="editor-comment"><p>b) Verifying the shuffling procedure (null hypothesis) for determining the significance of the coupling terms.</p></disp-quote><p>This appears to reflect a major weakness in our description of our validation procedures. Either that, or we’re not exactly sure what additional verification of the shuffling procedure (already akin to a permutation test, which is a standard nonparametric validation) would be. So, we’ve tried to clarify the description of this and to emphasize the value of the shuffling at appropriate points. In our detailed reply to reviewer 2, we similarly state that there might have been a misunderstanding of the methods as originally described, as the reviewer appears to request an important validation that was provided in the original manuscript. Our utmost apologies, we have worked on the phrasing around that important part in the revised manuscript. We have also noted that this procedure was used to validate the coupling in the seminal coupled-GLM work (Pillow et al., 2008; see supplement) and many more recent uses of this analysis scheme (Runyan et al., 2017; Yates et al., 2017).</p><disp-quote content-type="editor-comment"><p>c) It is unclear whether the history-dependent kernels only capture intrinsic neuronal properties, as opposed to influences from other neurons that could be equivalent to history effects.</p></disp-quote><p>We have clarified this point in the revised manuscript. At a first pass, the simultaneous nature of the fit allows the model to parse out distinct effects of history and other neurons (in addition to task factors). This is another facet of the “explaining away” issue described above. However, at a deeper level, this “explaining away” is only as good as the data are complete, and so it is indeed possible that some of the history properties reflect the impacts of unobserved inputs as opposed to intrinsic cellular properties. We have now clarified this in the manuscript.</p><disp-quote content-type="editor-comment"><p>d) How do the results depend on receptive field overlap? In particular, it is possible that the differences between LIP and FEF are the consequence of different overlap patterns in the two areas.</p></disp-quote><p>We did not map the 2D spatial extent of the receptive fields in detail. For the two-area ensembles we recorded from, doing so would require another more complex (e.g., white noise) stimulus and additional data collection time. We would love to have such data but in the interest of statistical power and stability for the main experiment, we did coarser online mapping of the ensemble response fields. Therefore we cannot estimate the precise overlap of the receptive fields. Few studies have done this during working memory tasks, but it’s a very interesting question that we had considered previously, and our thinking was that the very large size and idiosyncratic shapes of RFs in these areas may dilute the potential for nuanced insights with the topic becoming the primary focus of an experiment.</p><p>Regardless, we did our best to explore this issue in our data. Classical experiments (and simulations) use a simplified 1D representation of the spatial selectivity: the angle (saccade direction) from fixation. We have added a supplemental figure showing the relationship between coupling and the similarity of the neurons’ spatial tuning using this type of tuning curve (Figure 6—figure supplement 1). However, critically, the differences in coupling between LIP and FEF are present even during the fixation period when there is no visual stimulus (or memory of the stimulus) driving the RFs of the neurons (Figure 6A). Therefore, this result is hard to explain simply by differences in selectivity for the stimuli. This result is in accordance with previous findings that relied on a similar analysis and logic (Katsuki et al., 2014). We have also elaborated on this topic in the Discussion.</p><disp-quote content-type="editor-comment"><p>2) The total coupling strength, which is the net result of adding the positive and negative (inhibitory) kernel weights, is used as a summary measure of coupling between neurons. As elaborated by reviewer 1, this is a potentially misleading quantity, as it does not consider the magnitudes of the excitatory and inhibitory components. The analyses should be run also with alternative measures that take this distinction into account.</p></disp-quote><p>Absolutely a fair point. We’d previously explored a range of metrics and now include alternatives. No major changes in the pattern or interpretation of the results present themselves. We do wish to point out that quantifying the coupling impact by calculating the sum of the kernel weights over time is indeed quite coarse, but it is not “misleading” because the magnitudes and excitatory and inhibitory components are considered in the sum. So this seems a pretty legitimate way to simply describe the time-averaged net impact. The major shortcoming of this approach is that it collapses over time, but that’s what the remaining analyses that use PCA serve to add.</p><disp-quote content-type="editor-comment"><p>3) Consideration of differences across neuronal classes; in particular, whether the results are distinctly different for neurons with significant delay period activity, as mentioned by reviewer 2.</p></disp-quote><p>We were interested in this as well, but unfortunately no clear patterns emerged. We have added a supplemental figure depicting what the reviewer suggests (Figure 4—figure supplement 1).</p><disp-quote content-type="editor-comment"><p>4) There is insufficient validation of the model against traditional analysis techniques, such as cross-correlation analyses.</p></disp-quote><p>We had performed these internally as an initial validation before feeling good about relying on the GLM fits, but we now add these in the revised manuscript and the supplement (Figure 2—figure supplement 1). However, from our perspective, these more traditional assessments of correlation suffer from a weakness that the population GLM was designed to fix (as described previously; Stevenson et al., 2008). Additionally, this GLM approach has been validated in physiological circuits/populations where the connectivity was better-known (Gerhard et al., 2013; Pillow et al., 2008). Bottom line, we were in a bit too “in our heads” in trusting the GLM, but we hope we’ve shared convergent evidence to build the reviewer’s trust in the technique now.</p><disp-quote content-type="editor-comment"><p>5) There is insufficient description of some of the analytical procedures (see specific comments below).</p></disp-quote><p>Agreed. Internally, we had relied on nearly-identical analysis schemes in Yates et al. (2017) and Park et al. (2014) and were likely too internally context-deep when we summarized the methods to others. We are big proponents of manuscripts standing on their own and have expanded the treatment of the analytic procedures both in the methods and at various interpretive points. These are indeed important clarifications, which are of relevance to some of the major/general issues described above. Thanks for pushing us to improve on this axis.</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>This work addresses important problems in oculomotor physiology, is sound, clearly described, and contains many interesting nuggets about the FEF-LIP circuitry. Just to mention one of them, the three interaction kernels provide convincing measures of the time constants of these circuits, confirming long-help ideas based on theory and modeling. Other results, such as the stronger interactions across than within areas, are interesting precisely because the do go a bit against the grain.</p><p>I only have one substantial comment. Several analyses are based on the total coupling strength, which is the net result of adding the positive and negative (inhibitory) kernel weights. This leads to the conclusion that &quot;coupling in LIP was greater than FEF, suggesting a greater degree of recurrent connectivity in LIP&quot;. But the total strength is a crude measure. If the subtraction of excitation and inhibition gives 1 = 20 – 19 net excitation in one area and 2 = 5 – 3 in the other, is it really fair to say that the coupling is stronger in the latter? Clearly not. Stronger nonlinearities are expected for highly balanced circuits in which both excitation and inhibition are stronger. This intuition is missing in the Discussion paragraphs four and five. In that case, identical excitation in both areas but stronger inhibition in FEF than LIP would be perfectly consistent with stronger winner-take-all dynamics in FEF and more tolerance to spatial ambiguity in LIP, in turn consistent with saccade selection in the former and divided attention in the latter.</p><p>My suggestion is to quantify the excitatory and inhibitory interactions separately. For instance, by computing the total excitatory coupling on one hand, and the total inhibitory coupling on the other. If both terms AND the net result are stronger in LIP than FEF, then that would credibly verify the current conclusion (&quot;greater coupling in LIP than FEF&quot;). But I suspect (from Figure 3B) that the situation is a bit more nuanced. For instance, stronger inhibitory coupling in FEF would be consistent with stronger motor competition and/or narrower visual tuning. Likewise, one could argue that the relevant indicator of stronger or more reliable delay-period activity is not the net coupling (excitation minus inhibition) but the total absolute coupling (i.e., the total summed magnitude of the coupling weights). I think that, in general, consideration of these alternatives beyond the net coupling would provide a broader and more substantial view of the data, and a more nuanced basis for their functional interpretation, without any alterations to the GLM model.</p></disp-quote><p>This is a valid concern; we struggled to find a good way to summarize the coupling with a single metric that was devoid of caveats. We have plotted the absolute coupling (Figure 3—figure supplement 1A), and the primary result holds. Considering the excitatory/inhibitory comparison, in the current analysis (just to clarify) the coupling strength is only summed for each individual kernel across time, not across kernels, providing a simple scalar measure of the net impact of one neuron’s spikes on another. Thus, the histograms in Figure 3 show the net relationship of each neuron pair, and show how many neuron pairs were (in general) excitatory and inhibitory for each area interaction (the tails of the distributions). It is true that this is a coarse metric and can obscure the changes in positive and negative weights over the time period of each kernel, but we were looking for a simple descriptive measure of the overall relationship of each neuron pair. If we were to sum all positive and negative weights for all time bins separately we lose the fundamental relationships between the kernels (and thus the pairs of neurons), which can be challenging to interpret. Nevertheless, we have included separate comparisons of the overall excitatory and inhibitory interactions as well (Figure 3—figure supplement 1B,C). Most importantly, this is one of the reasons we used PCA to summarize the temporal profile of the kernels in a more principled way.</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>This manuscript provides evidence that recurrent mechanisms in LIP, FEF and between these two areas are engaged during persistent activity in a delayed response task. This is supported by fitting neuronal spiking data simultaneously recorded in these areas with a population encoding model. A GLM fitting procedure estimates parameters for visual and motor dependencies, neuronal history dependence, and coupling kernels between simultaneously recorded neurons. The coupling kernels are reported strong in comparison to history kernels, and contain time scales consistent with excitatory and inhibitory mechanisms typically included in attractor models of working memory.</p><p>The manuscript is a valuable and significant contribution to the research on the mechanisms of working memory. For this classic task, a population-level analysis of simultaneous recordings in two cortical areas has not yet been presented, and provides important insights into the relative importance of different mechanisms that have been proposed to support persistent activity: intrinsic mechanisms, local circuit recurrence, and recurrent interactions between areas. The methods applied are aimed at testing this with advanced statistical methods.</p><p>My major concerns regarding the conclusions drawn from these analyses are:</p><p>1) There is an inconsistency in the manuscript in that, on the one hand, interneuronal couplings do not improve PSTH predictions (Figure 3D) and yet various analyses (Figure 3A, Figure 4C) are interpreted as demonstrating &quot;exceptionally strong coupling&quot;, &quot;exceptionally strong recurrent interactions&quot; or that &quot;network dynamics play a more vital role than intrinsic dynamics&quot;. If recurrent interactions are removed from an attractor model persistent activity collapses, and PSTHs are profoundly affected. At face value, the findings thus do not seem to represent a direct support of these models. The fact that exceptionally strong couplings do not have an impact in the PSTH should be better explained.</p></disp-quote><p>This is an important issue and (as stated in the general reply above) one we have tried to clarify substantially. PSTHs only quantify the average responses of the neurons across trials. The memory of the target itself, and thus, the neural dynamics act on single trials, the behavioral relevant time periods. Our findings show that coupling (and thus the correlations between the neurons) is not necessary to capture the average responses, (i.e. considering the spike trains from each neuron as independent would give you the same result; Figure 3D). But, if you look at the predicted spike trains on individual trials (recalling that the model was fit on individual trials), you can see that there is useful information in the correlations between neurons that increase the accuracy of predictions of single trial responses (Figure 3E). Hence, the interesting result here is that the correlation structure matters for the population code on individual trials. It is not surprising that it does not matter for the average responses across trials because PSTHs obscure (i.e. average away) single-trial fluctuations by design. This distinction was also found in the retina in the seminal work applying the coupled-GLM approach to modeling population data (Pillow et al., 2008). This finding emphasizes that PSTHs may be a limited way of trying to understand the population code on the time scale that matters for working memory. We have attempted to clarify and elaborate these points in the revised manuscript.</p><disp-quote content-type="editor-comment"><p>2) I am concerned about the &quot;null hypothesis&quot; in Figure 3A: if trials are shuffled for each neuron before the fit, then neural activity is modeled with spiking data of other neurons obtained in trials with different delay duration, so not aligned to the stimulus and saccade predictors used in the model. Since these events are typically associated with an increase in firing rate, interneuronal couplings will be reduced in this model because of these misalignments. The reading of &quot;strong recurrence&quot; that now emanates from the comparison with this &quot;null hypothesis&quot; might instead result from this misalignment. Maybe a more direct assessment of how strong is the contribution of couplings to the network would be to evaluate what fraction they represent in the sum of all predictor terms in the model.</p></disp-quote><p>Thanks for raising this! We believe there is an essential clarification (but not a problem with the shuffling procedure). As noted in the manuscript, the timings of the trial events and spikes within each trial are always preserved in the GLM analysis. Only the order of the trials is shuffled (i.e., the trial “labels”), e.g. what might be considered trial 1 for neuron 1 is trial 23 for neuron 2 etc (but each neuron still gets the “right” event times for that spike train within each trial). Therefore, only the temporal relationship between neurons is disrupted. That is why this approach is an especially strong test of the presence of coupling, because only the correlations between the neurons are eliminated while the task dependence and autocorrelation are unaffected. This procedure was used to validate the presence of coupling in the seminal neural GLM paper (Pillow et al., 2008).</p><p>With that clarification, we hope it’s clear that the coupling predictive index (Figure 4) is in essence what the reviewer suggests. It describes the contribution of the coupling filters in terms of their deviance explained (a classic goodness-of-fit measure for GLMs) as a fraction of the deviance explained by all the predictors in the ‘“full” model (Materials and methods). Sorry, again, for not being sufficiently clear about this.</p><disp-quote content-type="editor-comment"><p>3) The manuscript emphasizes the role of recurrent interactions in generating persistent activity. However, not all neurons recorded in LIP and FEF show persistent activity in this task. In particular, Figure 2 shows that neurons with robust persistent activity show sustained history kernels, which supposedly affect just a minority of neurons in the database (Figure 4C). Some of the conclusions may change if one considers separately neurons with strong persistent activity from other neurons. For instance, if neurons with persistent activity mostly populate the right cloud of dots in Figure 4C the interpretation of this panel's results would be very different. Example neurons shown in Figure 1 could be explicitly identified in Figure 4C and other panels with individual neuron data. If the question is how persistent activity is generated, then it should be relevant to consider separately neurons with and without persistent activity.</p></disp-quote><p>These were our thoughts exactly. We conducted these analyses, but unfortunately there was no systematic relationship between traditionally determined persistent activity (from PSTHs) and the coupling or history terms. This is demonstrated in the supplement by an updated version of Figure 4C (Figure 4—figure supplement 1). We believe this finding reemphasizes the above point – that single-trial dynamics and the across-trial average responses may be very different, and the traditional ways of describing single-neuron activity may be too limited to capture the dynamics of the network during which working memory is actually active. Furthermore, we acquired large somewhat unbiased samples of neurons from the ROIs, and although we looked for neurons with traditionally-determined persistent activity to place our recording probes, we included all isolated units in our analyses. Our goal was to get a broad sample of the network. Therefore, unlike classical experiments, we do not cater the stimulus to a single neuron’s RF (this would be impossible, as we get many neurons with a variety of RFs). Hence, this difference in approach may have an effect on the traditional measures of persistent activity in the single neuron PSTHs. As approaches have moved to large scale simultaneous recordings, we must revisit how we go about analyzing and thinking about this kind of data. This topic has been expanded in the Discussion.</p><disp-quote content-type="editor-comment"><p>4) The interpretations in the manuscript jump very easily between the statistical description contained in the fitted kernels and biophysical mechanisms, and this should be more carefully considered. Any &quot;temporal integration above and beyond that explained by the external task elements&quot; (Park et al., 2014) and the spike times of the few simultaneously recorded neurons in that session will be attributed to history kernels, which would therefore be inappropriate to attribute to intrinsic cellular mechanisms. In general, authors should be cautious with the possible confusion in using &quot;intrinsic&quot; to refer to the history kernel. The history kernel might include traces of other network dynamics not captured by the few neurons recorded simultaneously in the session.</p><p>Importantly, many of these concerns could be directly addressed by analyzing spike trains from a few neurons selected from attractor network simulations (many of which freely available) to verify if their GLM approach is able to extract the biophysically-based parameters of the model, as currently argued. My intuition is that model neurons without any specific intrinsic mechanism with long time course would show a long-lasting history dependence (self excitation) when modeled against the activity of just a handful of their close neighbors. The number of neurons used as predictors, or the similarity of their memory fields, could also conceivably have an impact in the decay time of history and coupling kernels, and thus contribute to possible differences between FEF and LIP in this analysis. These computational models are freely available (for instance https://neuronaldynamics-exercises.readthedocs.io/en/latest/) and the model data can be generated easily and analyzed with the authors' methods.</p></disp-quote><p>Thanks a million! This is a good point and we are deeply grateful for the pointer to that model.</p><p>The reviewer has a valid concern regarding over-attributing the history effects to intrinsic biophysical mechanisms. It is true that the model cannot account for the influence of unobserved neurons (which no doubt play a substantial role), although to be fair, all electrophysiological recordings and analyses deal with this limitation. However, only the fitted neuron’s own spikes impact the history kernel, and although the model cannot account for the role of unobserved neurons driving that spiking, it is not true that simply any unexplained variance by the other predictors will show up in the history kernel (i.e., they would need to be well correlated with the cell’s spike train). All parameters are fit in the model simultaneously, and only the predictive power of the neuron’s own spikes can contribute to the history term. The history kernel does a good job of capturing the neuron’s autocorrelation while partialling out the effects of the other (observed) predictors, and hence gives a reasonable estimate of “self-drive,” but it’s true we cannot make any specific claims about the biophysical mechanisms, only statistical relationships. We have edited the main text to remove and clarify the usage of intrinsic in reference to the history kernels. It’s also worth mentioning that GLM approaches can extract accurate parameter estimates of intracellular mechanisms when modeling these explicitly (Latimer et al., 2014).</p><p>We thank the reviewer for suggesting this resource for the spiking attractor network models. We have used it for our additional analyses that conclude the manuscript (Figure 7). We highlight several important insights (above and in the manuscript), but of relevance here: the analysis of the model recovers the temporal dynamics of the neurons with known properties, so this is a useful validation.</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>The paper uses a novel analytical technique to infer functional connectivity among FEF and LIP cells during a memory guided saccade task. The analysis takes a GLM-based approach and fits spike trains of simultaneously recorded FEF and LIP cells as weighted combinations of kernels related to (1) target location, (2) saccade direction, (3) coupling filters modeling interactions among cells and (4) history filter modeling within-neuron autocorrelations. The main conclusions are that FEF and LIP neurons show strong coupling both within and across areas, and that LIP shows stronger coupling and longer intrinsic timescales than FEF.</p><p>While the approach is interesting and potentially useful, I am afraid it is not sufficiently justified in the present version of the manuscript. The level of detail provided is simply not sufficient to support the claims based on this novel analysis technique. I see two main problems with the manuscript as it is now:</p><p>1) There is insufficient control for potentially differential sampling of neurons in FEF and LIP: Could the apparent stronger coupling in LIP vs. FEF be due to different neural sampling in the two areas? For instance, if the RF of the recorded cells had more overlap in LIP relative to FEF, that may produce stronger apparent coupling in two different ways. Stronger coupling may arise if the model mis-attributes shared stimulus/saccade related activity to the coupling weights. The authors emphasize that their model identified coupling above and beyond any stimulus-related response, but they provide little evidence to substantiate this assertion. Stronger coupling may also arise if the model correctly attributes variance but the neurons are in fact more coupled by virtue of being more functionally similar. In that case, the areal differences are only artefacts of the neurons the authors happened to sample. We need much more thorough analyses of the similarity in RF profiles and temporal response profiles of the recorded cells to rule out a sampling confound.</p></disp-quote><p>This is an important point. The differences in RF organization between these areas and the implications for network architecture is an interesting (and open) question, but unfortunately our dataset (as with most prior work) is not equipped to perfectly disentangle sampling noise from true areal differences. To really nail this issue, we would need to more precisely map the spatial extent and temporal profile of very many neurons with a dynamic (white noise) stimulus in addition to the current experiment (and/or to already know the full distribution of RFs in each area).</p><p>It’s worth mentioning that the 2D nature of the receptive fields (and the memory representation) is often simplified in classical experiments (and simulations) to 1D tuning curves representing the saccade direction angle from fixation. In this classical form of the analysis, the spatial structure and extent of the RFs are summarized rather coarsely. Despite this missing detail, we compared the coupling between neurons as a function of their spatial tuning similarity in an effort to address these questions (Figure 6—figure supplement 1). For all area interactions coupling was slightly stronger for pairs of neurons with more similar spatial tuning, and that relationship was most pronounced for neurons within LIP, a feature predicted by classic attractor network models. However, most importantly, the overall differences in coupling between LIP and FEF were also present during fixation when there is no visual stimulus in the receptive fields or memory being maintained (Figure 6A), meaning the coupling differences could not be simply due to differentially driving RFs with different degrees of overlap. This result points to differences in the functional connectivity.</p><p>Of course, differences in sampling can always be a potential problem in electrophysiology experiments, but we conducted the experiments using identical recording equipment, under identical conditions within the same sessions (which we suggest is the best we could do given current methods viable in these areas in the macaque). If we may muse a bit more beyond the pragmatic realities of currently available data, it’s intriguing to appreciate that functional differences in the organization of receptive fields may reflect differences in the underlying architecture; there is no strong reason to assume identical coverage of the visual fields with respect to receptive field sampling. Thus, differences in coupling due to receptive fields could be due to the underlying cortical organization and potentially interesting rather than just an artifact of sampling.</p><p>Regarding the concern that: “Stronger coupling may arise if the model mis-attributes shared stimulus/saccade related activity to the coupling weights. The authors emphasize that their model identified coupling above and beyond any stimulus-related response, but they provide little evidence to substantiate this assertion.” This is a separate issue, and as we have clarified in the revised paper (and in several of the replies above): All the parameters are fit simultaneously, so variance explained by one of the covariates can not be explained by another. In other words, the coupling kernels only explain variance not explained by the stimulus, saccade, and history kernels. So it’s not just catch all; it’s predicated on the likelihood of one neuron spiking given that another neuron spiked, given the likelihood of all other covariates in the model (effectively “partialling out” or “controlling for” their impact).</p><disp-quote content-type="editor-comment"><p>2) There is insufficient validation of the model against traditional analysis techniques. The field has several traditional, established measures of neural coupling or connectivity, including noise correlations and joint PSTHs or autocorrelograms. The authors dismiss those analyses off hand with little justification except for saying that they do not adequately remove stimulus-evoked activity. But there are actually many ways for them to get around confounds with these methods. Comparing their model results to these traditional analyses is essential to validate their results.</p></disp-quote><p>We are very happy to add in these analyses, as we’d actually file-drawered them after doing many such validations early in the project. We have added supplemental figures showing cross-correlograms and the relationship between correlations and coupling estimated from the GLM (Figure 2—figure supplement 1). These methods have also been validated previously with traditional correlations in physiological circuits with better-known connectivity (Gerhard et al., 2013; Pillow et al., 2008). In addition, previous work has shown the merits of GLM approaches over traditional measures of cross-correlations (see above replies for a treatment of this issue; for a previous review article on the topic, see Stevenson et al., 2008). We highlight (now, more clearly) that we jointly fit all simultaneously recorded neurons from each session, unlike correlation measures that only consider pairwise combinations in isolation. This approach allows us to “explain away” potentially misleading correlations and better estimate the connectivity of the network.</p><disp-quote content-type="editor-comment"><p>3) There is insufficient description of the analytical procedures:</p><p>– How were the neurons combined across recording days? Clearly, the neurons that were simultaneously recorded each day could be fit using the described method. But the authors say that they simultaneously fit the entire data set – including neurons recorded on different days. How precisely did they set this up and how did this affect the results?</p></disp-quote><p>We regret the lack of clarity and have updated the manuscript. Neurons were not combined across recording days. Each daily session (including all simultaneously recorded neurons) was fit with the model. The data (and fits) were then summarized across all sessions. These points are now clarified in the Materials and methods.</p><disp-quote content-type="editor-comment"><p>– What were the kernels that the authors used in the model fits? How were those kernels selected? What properties must the kernels have to make the model work? Are the conclusions robust over reasonable changes in kernel shape?</p></disp-quote><p>Kernels were constructed from smooth temporal basis functions (nonlinearly time-scaled raised cosine functions) as described in previous work (Pillow et al., 2008; Park et al., 2014; Yates et al., 2017). Kernel fitting procedures were consistent with these previous studies and fits have been shown to be insensitive to reasonable changes in the lengths and shapes of the kernels. (But still sorry for not putting these details into the initial submission!). These parameterizations are conventional in the literature and simply used to capture smooth temporal dependencies and reduce the dimensionality (i.e. as an alternative to specifying a parameter at every single time bin). The Materials and methods have been expanded to include more details about the kernels to accompany the references.</p><disp-quote content-type="editor-comment"><p>– Goodness of fit and model comparisons: The authors should provide a complete description of the type of models they compared.</p></disp-quote><p>Of course. The description of model comparisons has been elaborated in the Materials and methods.</p><p>Figure 3D shows the goodness-of-fit as the variance explained of each neuron for the coupled and uncoupled models. Figure 3E shows the accuracy of single-trial spike train predictions. Figure 4 shows the results of model comparisons for models with and without coupling (coupling predictive index), and with and without history (history predictive index). These are measures of the deviance explained of the GLMs (Agresti, 2002).</p><disp-quote content-type="editor-comment"><p>o Individual monkey results: How many cells were recorded in each monkey? Did the critical results hold in both monkeys?</p></disp-quote><p>The results held for both monkeys (number of neurons: Monkey A = 459, Monkey L = 508). Symbols indicating from which subject the data came has been added to the goodness-of-fit plots (Figure 3D,E). This has been updated in the manuscript.</p><p>[Editors' note: further revisions were suggested prior to acceptance, as described below.]</p><disp-quote content-type="editor-comment"><p>Essential revisions:</p></disp-quote><p>The main concern communicated in the last set of reviews had to do with, not just a lack of clarity regarding the GLM validation via permutation, but a pair of regrettable misunderstandings. One to do with the shuffling, and one to do with the role of the uncoupled model. We do our best, in words and in code, to clarify these issues.</p><p>We now call the shuffling test a “permutation” process in the manuscript to hopefully avoid any misinterpretations that might be associated with “shuffling” in related contexts. That said, the permutation test is not the key statistical test – the comparison to the uncoupled model is (i.e., it supports principled validations of the GLM and model comparisons, the results of which suggest highly significant coupling contributions). The permutation/shuffling results are useful supplemental analyses because they provide reasonable estimates of null distributions in the same language and units as the main results (i.e. coupling strengths). Unsurprisingly, the shuffling analysis provides similar results to the uncoupled model, because they are simply different ways of making the neurons independent. In the uncoupled model, the neurons are truly independent (there are no connections between them) and in the shuffling case the correlation structure is disrupted which effectively makes the connections random. However, the shuffling analysis has the added benefit of providing a comparison using the full model (with all the same parameters). The field usually uses both, as we have.</p><p>We hope to have now sufficiently explained both to reviewers and to a potentially broad readership that the major criticism/concern put forth does not apply to our analysis (or to the large number of preceding papers that have used the same permutation process).</p><disp-quote content-type="editor-comment"><p>1) What exactly is the uncoupled model?</p></disp-quote><p>The uncoupled model does not include any coupling kernels – only task and history kernels (i.e. there are no connections between the neurons in the uncoupled model; each fitted neuron does not take into account spikes from other neurons, but it does still take its own spikes into account via its history kernel). This “dropping of terms” is akin to standard linear regression techniques (e.g., stepwise, nested tests, etc.), where terms might be added or removed and the resulting changes in quality of fit are assessed and interpreted.</p><p>The uncoupled model is therefore the standard principled statistical technique for validating the explanatory power of the coupling kernels. This is reflected in several ways in the paper: as the difference in the variance explained (goodness-of-fit) between the two models (in the PSTHs, Figure 3D and on single trials, Figure 3E), and also in the model comparisons (measured as the deviance explained between models with and without coupling and history terms; Figure 4; Materials and methods). All of these methods are used to quantify the explanatory power of adding coupling (or history) to the model over and above the other covariates. We have clarified the importance of the uncoupled model’s role in the manuscript.</p><disp-quote content-type="editor-comment"><p>2) How exactly is the shuffling across trials performed?</p></disp-quote><p>We very much regret that our ways of describing the shuffling procedure clearly weren’t working for some of the audience. In the last round of reviews, there was still a misunderstanding regarding how the shuffling procedure is performed – something we certainly need to get right. We deeply appreciate the reviewer’s willingness to dig in and build a simulation. Here we explain how the simulation helped us understand the disconnect here – for all readers, we wish to state clearly that the concern reflected in the simulations does not apply to our actual analysis scheme.</p><p>The shuffle-trained GLM includes all parameters of the full model (task, history, and coupling). The permutation procedure we use only disrupts the relationship between neurons (i.e., the coupling kernels) but <italic>leaves the dependence on the task (stimulus, saccade etc.) and history for all neurons intact</italic> (more on this below). The stimulus/trial event times and spike times are never misaligned for any spike train, and the time bins in which these events occur are never shuffled within trials (which seems to make our analysis different from what the reviewer so patiently and constructively coded up— the colored raster figure was key, thanks!). How is this done? It is difficult to conceive in the mindset of standard shuffling analyses, so let’s start fresh…</p><p>Consider Neuron A, which is the neuron being fitted in this run of the GLM. A standard fully-coupled GLM would then model neuron A’s response as a function of task events, its own spike history, and the impacts of Neurons B through Z (in the hypothetical case of 26 simultaneously-recorded neurons). The “impacts” of Neurons B through Z are simultaneously modeled with respect to the task events and history of the fitted neuron, so only the residual spikes of Neuron A are predicted by the spikes from the other neurons. The effective use of residuals to capture coupling is one of the most powerful aspects of a GLM, as it allows for the task terms to remove the signal drive, while still allowing for the unexplained activity to be used for other aspects of the fit (e.g., for the history and coupling terms). (We discuss more of these big picture issues later, but now get back to the permutation analysis implementation).</p><p>By relying on the GLM’s modeling of the task variables (which always use the correct timings while fitting each trial), the permutation can now be done. For each trial, we keep Neuron A’s original spike train (and its stimulus drive and autocorrelation is simultaneously partialed out), and we use the spike trains for Neurons B through Z from other independently/randomly selected trials (i.e., shuffled without replacement) as predictors. We do <italic>not</italic> then need to pretend that those spike trains came from the original trial – the goal is to solely eliminate the relationship between the neurons. The spike trains from other trials should not have any predictive power with respect to the fitted neuron’s spike train (Neuron A) beyond simple chance, allowing us to estimate a baseline level of coupling due to noise. The spike trains from Neuron’s B-Z are then analyzed with respect to the task events from the respective/corresponding trials when those neurons’ spike trains are fit.</p><p>This scheme effectively treats each neuron <italic>independently</italic> (analogous to removing the simultaneous nature of the recordings and is similar to the uncoupled model where the neurons are independent by design, i.e. there are no coupling kernels). But, again, the single-trial time courses of the spikes and task events for each neuron are <italic>unchanged</italic>. So, from the perspective of a fitted single neuron, nothing is different except its relationship to other neurons in the session; the fitted neuron’s autocorrelation and stimulus dependence is preserved. This can be seen in the PSTHs, which are <italic>unaffected by this shuffling procedure</italic> – and shouldn’t be because the model’s fitting of the task event terms is still totally proper. In summary, this model-based analysis is flexible enough to use trials with different timings (because it is fit on single trials) to allow the signal correlations to be maintained while the noise correlations are disrupted.</p><p>In practice, of course, no model is perfect. The possibility of mis-modeled aspects of the neurons’ responses is certainly possible, but because the task events are randomly-timed from trial to trial, this is solely likely to create coupling estimates around zero simply due to noise, as opposed to having any bias (which can be confirmed via simulation of neurons that are independent by design). Additionally (and critically), since the task events are jittered trial by trial, any “bleed through” effect of task dependence on the coupling terms from other trials actually makes the shuffled comparison a <italic>more</italic> conservative estimate, because this would artificially inflate the null distribution and hence make our estimate of the true coupling smaller.</p><p>Although the scheme is clearly not straightforward to explain, especially in the historical context of standard CCGs and shuffling controls, we hope that it is not just clear, but more directly addresses (i.e., models out) the potential for stimulus drive contamination, which many clever but imperfect traditional shuffling controls attempt to sidestep. But it’s nothing magic – the catch is that if you want to use a GLM, you need event timings to be randomized from trial to trial to decorrelate the predictors (and you can use all trials for the coupling analysis); if you want to use CCGs, you prefer to have multiple repetitions of trials that are as identical as possible. We favored the former technique because it allows for all simultaneously recorded neurons (B-Z) to go into the coupling for Neuron A at the same time, thus being able to “explain away” partial correlations in a way that standard pairwise correlation analyses cannot (the GLM also has other nice properties, because it provides descriptions of a cell’s own spike history and responses to various task events, all in the same fit and language). Finally, the permutation analysis is really just meant to be an intuitive way to visualize the magnitude of the observed coupling relative to a reasonable null model. The statistical comparison between the fully-coupled GLM and the uncoupled model (i.e., the GLM without the coupling terms) is the more straightforward test of whether coupling adds to the quality of fit and is also used when assessing the relative impacts of coupling and history via the model comparisons (between models with and without coupling and history).</p><p>We have clarified this in the body of the manuscript and in the Materials and methods. In addition, this is how such a model has been described in previous work, both originally and more recently (e.g., Pillow et al., 2008; Yates et al., 2017; Runyan et al., 2017). Runyan et al. shows a more recent example of this shuffling control for the GLM which was conducted (and explained) in the same way (Runyan et al., 2017).</p><p>In addition, we have attached some code and figures demonstrating how the shuffling/permutation procedure works with an example session looking using cross-correlations and have also shared a simplified version of the GLM fit to simulated data from the attractor network. Jonathan Pillow also has a series of detailed GLM tutorials using the same sort of approach on his website which may be beneficial: https://github.com/pillowlab/GLMspiketraintutorial.</p><p>Again, we really appreciate the reviewer putting the time into the code and figures. To revisit the clarification in the context of their generous analysis, in the reviewer’s example (in the non-shuffled figure), imagine shuffling only the rows (the neurons’ identities) within each panel (each trial) – the stimulus alignments (and spike times) over the time course of the trial would remain unchanged. If you do this for each trial, the relationship between neurons across trials is broken but the within trial time courses are preserved. This is not exactly what we did, but is similar conceptually to what we explained earlier. Instead, in our data structure, each panel would be a neuron, the number of rows would be trials, and the columns would still be time bins (i.e. conventional raster plots for each neuron). Now, if we shuffle the rows (the trials) for each other neuron (each panel) independently, nothing has changed for the fitted neuron whose response we are modelling, the single trial timings are the same, and the PSTH (which averages across rows in this scenario) is identical, but now the relationship to the other neurons is made random. Thus, the true timings of the covariates in the GLM (the stimulus on, the saccade, spike times etc.) on single trials are always used. Keep in mind that, because in our task (unlike traditional ones) the trial parameters are variable on every trial, the analyses must always be referenced to the values on individual trials (e.g. PSTHs are plotted aligned to the target or the saccade; spikes are counted in windows around those events on each trial), so single-trial timings must always be preserved. In addition, that means it’s impossible to construct some sort of conditioned-matched surrogate dataset with the shuffling analysis since every trial is unique.</p><p>In the reviewer’s code, it appears that a difference might arise because the randomization is done on every trial with replacement and thus there can be an effect of “double dipping,” but it’s hard to know for sure without being able to run the code (we tried; more on this below). To replicate our permutation procedure in spirit, one would want to do the permutation in the neuron loop, or make sure the trials are sampled without replacement. In essence, the reviewer has also highlighted why cross-correlations are fraught measures for estimating connectivity – by showing how illusory correlations can arise between independently simulated neurons. This reiterates one of the points of using the permutation procedure as a control, because one can actually estimate the amount of coupling due to chance alone (in effectively independent neurons) and use that to construct a reasonable null distribution.</p><disp-quote content-type="editor-comment"><p>3) More careful analyses of the activity during fixation and early delay.</p></disp-quote><p>Please see below for detailed replies – we have tried to clarify these issues in the manuscript, and remove any implications/interpretations for other models that were deemed overly ambitious.</p><disp-quote content-type="editor-comment"><p>4) Clarification of the dependence on overall firing rate (separate from the variations in connectivity).</p></disp-quote><p>We believe this issue also stems from the regrettable mutual disconnect regarding the GLM and the shuffling procedure. One of the benefits to using the GLM approach is to avoid confounds like this, and give a better estimate of interneuronal interactions (i.e, more pure, via “modeling out” the task events). Baseline firing rates are captured by an additive (constant) term in the GLM. Coupling can be thought of as lagged correlations in the residuals after controlling for the other covariates (i.e. visual/motor responses, auto-correlation, and baseline firing rate). Thus, estimates of coupling already partial out effects of baseline firing rate.</p><p>To further assuage any remaining wonder about whether the overall differences in firing rates between the areas could affect coupling, the shuffling control comes in handy again. The coupling kernels for each area were compared to null (shuffled) distributions within each respective area, hence the spike rates in the normal case and the shuffled control were identical (the number and time of spikes are unchanged), but during shuffling the relationship between the neurons is obliterated giving us an estimate of coupling simply due to noise. Therefore, we have an estimation of how much coupling exceeds what is expected by chance for each particular area while controlling for differences in spike rate. We have included an additional supplemental figure demonstrating that this holds in the GLM analysis of simulated data from the attractor network (Figure 7—figure supplement 1). Furthermore, we have now included data on the mean firing rates in LIP and FEF, and FEF actually has significantly higher mean firing rates than LIP whereas LIP had much stronger coupling. Thus, this provides empirical confirmation that coupling is unlikely driven by a confound in firing rates.</p><disp-quote content-type="editor-comment"><p>These points are discussed at length by reviewer 2 below.</p><p>Reviewer #2:</p><p>The revised manuscript contains significant improvements over the previous version, notably the new computational model data that provides support to the methods applied. However, I still maintain some relevant concerns on the controls required to support the interpretations of their analyses as couplings between neurons. This concerns primarily the shuffle approach and the control of firing rate confounds as detailed below.</p><p>1) Related to previous Major concern 1.</p><p>I realize that part of the confusion here is that the “uncoupled model” is never fully described. I understood that this was the full fitted model, to which couplings were set to zero. From this model I would expect PSTHs to differ largely from measured PSTHs, if couplings are contributing significantly to the GLM. Instead, I gather from (Pillow et al., 2008) that the uncoupled model is a reduced model refitted to the data, and then I understand that the fit may be good even if couplings for the full model are strong contributors to the fit. I urge the authors to explain clearly what their uncoupled model is. In fact, in the current revision this is further confused in the Materials and methods (“Unsurprisingly,…”), where the “uncoupled method” is commented in the middle of the description of the shuffle approach. These two separate controls should be clearly distinguished and specified so the reader understands their separate implications. Now this is very confusing.</p></disp-quote><p>We have revised the manuscript to make this more clear. Thank you for calling our attention to it. In addition, as mentioned previously, the inclusion or not of coupling parameters in the model or their disruption with shuffling has little (or no) effect on the PSTHs because these are averages across trials that by their very nature obscure the trial-by-trial correlations between neurons (Figure 3D).</p><disp-quote content-type="editor-comment"><p>2) related to previous Major concern 2.</p><p>I am still not convinced about the shuffle approach on which the &quot;extraordinarily strong coupling&quot; result is based. If I understand it correctly, the structure of the data is as schematically depicted in Decision letter image 1, with simultaneous spike trains recorded (here 10 neurons in 10 lines per panel) for separate trials (here 8 trials in 8 panels), where in each trial the stimulus is presented in different locations (here different colors of the simulus and response shadings) and delay durations are also different from trial to trial. Neurons respond with spiking activity depending on whether the stimulus falls within their receptive field or not.</p><p>The GLM for the neuron on the gray background would then model spikes based on its specific stimulus and response events for each different trial, on its previous spikes in the corresponding trial, and on the previous spikes of all other neurons in the corresponding trials. Crucially the spikes for these other same-trial neurons are collected based on the same stimulus location, response and delay duration.</p><p>If I understand correctly the shuffle condition applied in Figure 3, the GLM now models the gray-background neuron based on its specific stimulus and response events for each different trial and on its previous spikes in the corresponding trial, exactly as before, but now the spikes of other neurons are taken from randomly picked trials. This is represented in the schematic in Decision letter image 2 (notice the first lines of each panel are the same for both schematics). If this is the case, then now the spikes for these other shuffled neurons were not collected based on the same stimulus location, response and delay duration as the modeled neuron. As a result, the consistency of stimulus activation of neuron 9 and neuron 7 shown in Decision letter image 1 (they are both active or inactive in response to stimuli in all trials), and the consistency of the timing of response events, are broken with the shuffle in Decision letter image 2. This will lead to a radical change in the cross-correlations between these two neurons, even if these spike trains were totally independently generated.</p><p>&lt;Decision letter image 2&gt;</p><p>I have run this simulation. Data for these spike trains were independently generated for each neuron (so with no coupling between them), only keeping the consistency of stimulus, response and delay within trials. As shown in the histograms in Decision letter image 3, the mean cross- correlations (as a proxy of the couplings obtained with the GLM) were radically affected by the shuffling procedure. This does not demonstrate any functional coupling between the neurons, but the fact that task events that elicited neural responses were misaligned by the shuffling procedure.</p><p>In my view, this effect could explain the extraordinary changes in shuffle histograms in Figure 3. To clarify this, the shuffle should be performed only between trials with equal stimulus location and delay duration, or else apply other commonly used resampling procedures to estimate cross- correlations (Fujisawa et al., 2008; Katsuki et al., 2014), such as within-trial jitter correction methods (Amarasingham et al., J Neurophysiol, 2012).</p></disp-quote><p>Unfortunately, we were unable to run the attached simulation code. There were errors in some of the lines and the intention of the code at this point was a bit unclear to us, so after a few attempts we ended up reading the code and studying the figures – regardless, they were very helpful! We hope that the main issues have been explained to the reviewer’s satisfaction in the earlier reply. We have provided examples of how the shuffling procedure works using real data and simulations in an example session with cross-correlations and also with the GLM. This illustrates what we have discussed in the general reply above. The confusion comes from a simple misunderstanding of how we permute the data, and how the GLM preserves the task dependence, which we hope is now clear. We have also added additional supplementary figures showing the shuffling analysis of the simulated attractor network data and the possible firing rate confound (Figure 7—figure supplement 1A,B). See below for more details on the possible firing rate confound.</p><disp-quote content-type="editor-comment"><p>3) The section on “Interneuronal coupling is dynamic across behavioral epochs” is very confusing and is not really addressing the point that they are formulating. The fact that there are not very marked changes between couplings measured in the fixation and delay periods is taken as evidence of dynamical working memory without much justification. Later on the comparison of early and late delay periods yields stronger couplings as delay progresses. In my view, this attempt to contribute to the debate on dynamic delay activity, or even activity-silent working memory (Stokes et al., 2015) is overambitious and needs more specific analyses (consider for instance possible traces of the stimuli in the couplings after the response period, by comparing in and out conditions in the baseline period where there is no confound of firing rate for in/out conditions, e.g. Spaak et al. SfN 2017 #339.14; Barbosa et al., Biorxiv, 2019, doi:10.1101/763938). Further, in the interpretations of this paragraph it is disclosed that their measure of coupling is confounded by changes in firing rate (“This finding highlights the potential role of nuanced changes in the dynamics of the network rather than an overall increase in population activity”). This should be declared early on, as this confound may affect many of the interpretations. Any interpretations of difference in coupling strengths should be cautious in previously demonstrating no difference in firing rates, or else in applying more stringent rate-correcting methods such as jitter correction (Fujisawa et al., 2008). Currently, the manuscript does not parallel each of the coupling comparisons (FEF-LIP, fixation-delay, etc.) with corresponding comparisons of mean firing rates, or rate-correcting measures, to support these conclusions.</p></disp-quote><p>Good points. It was not our intention to weigh in definitively on the debates about dynamic or stable coding, or activity-silent working memory. We are simply reporting what we found from analyzing the network dynamics during different trial epochs, which (like several other aspects of these data) will be of interest to these debates, but are in this case just the first descriptive step. We have attempted to remove any interpretations or implications that could be viewed as overreaching, as we believe a complete treatment of these issues warrants a rather long follow-up study as well. We do note that dynamics in the population activity (which are commonly observed) do not necessarily mean a dynamic code for working memory (Murray et al., 2017), which is definitely not what we wished to imply. We have rewritten the text to be more responsible and constrained here.</p><p>We also hope that the earlier responses explain why the GLM coupling estimates are inherently “rate-corrected.” We also note that the GLM parcels out the effect of the stimulus – both “in RF” and “out of RF” covariates are fit simultaneously, thus, the model is the same in both conditions (in the different trial epochs), as are the stimulus and task parameters.</p><p>Regarding: “Further, in the interpretations of this paragraph it is disclosed that their measure of coupling is confounded by changes in firing rate (“This finding highlights the potential role of nuanced changes in the dynamics of the network rather than an overall increase in population activity”)”</p><p>We were puzzled why this statement in the conclusions might be taken as admission of a flaw regarding a firing rate confound in the GLM analysis. Any help would be appreciated here. We re-read it a few times ourselves, trying to figure out how to avoid this unintended interpretation, but in the context we think it is clear that statement is simply highlighting the connection to other work (Murray et al., 2017, see above) that calls attention to the possibility of a more complicated story in the dynamics rather than a simple overall increase in persistent activity. (We discuss the firing rate issue both above and below.)</p><disp-quote content-type="editor-comment"><p>4) The computational model is a nice demonstration of their methods, in particular of the retrieval of the correct time scale of the interactions between neurons (the AMPA and NMDA current time courses). However, in terms of the strengths of the couplings, the model may also be confounded by changes in firing rate. It will be useful to plot the mean firing rate of model neurons as recurrent connectivity is increased. If this mean firing rate is increasing too, then some compensatory change may be introduced to maintain rates constant as recurrent connectivity increases in order to resolve this concern. The stimulus kernels derived from the model in Figure 7D, left panel, do not seem to correspond to the simulation results: stimuli in receptive fields should generate increase in rates, and stimuli outside the receptive field a suppression of rates.</p></disp-quote><p>As discussed in the response to general questions above, the GLM analysis parcels out changes in firing rate, and we also have provided an additional supplementary figure addressing this concern using the simulated data from the attractor network (Figure 7—figure supplement 1). This figure shows that coupling estimated from the GLM provides an accurate inference of the recurrent connectivity of the network regardless of changes in the mean spike rates. This analysis is yet another sanity check showing that the shuffling procedure disrupts the estimate of coupling of the network without affecting the time course of the neurons (or their PSTHs) and maintains identical spike rates as the true condition.</p><p>Specifically regarding: “The stimulus kernels derived from the model in Figure 7D, left panel, do not seem to correspond to the simulation results: stimuli in receptive fields should generate increase in rates, and stimuli outside the receptive field a suppression of rates.”</p><p>Thanks for the careful look at this, we checked the analysis and simulation and believe everything is OK here. The large bump (in the “in RF” condition) captures the transient response to the stimulus, the rest of the time course is simply noise around zero (a gain of 1) in both conditions. We are only sampling from a small number of neurons, and if the stimulus is not presented in their RFs we should expect no changes in their responses in either direction (which is what you see in real data for such conditions). Even in the idealized scenario in the attractor model, a suppressive effect would depend on how far the stimulus is presented from the RFs of the neurons you are observing, the strength and width (in RF size) of the stimulus, and the strength and range of the inhibitory connections. Thus, there are many potential factors at play here.</p><disp-quote content-type="editor-comment"><p>5) Because of the possible rate confound that affects the coupling measure, the manuscript should provide a mean firing rate description of the various areas and task periods, for instance through average PSTHs.</p></disp-quote><p>We have discussed the possible firing rate confound in the other responses, and now we have included descriptions of the mean firing rates of both areas in the Materials and methods. Neurons in FEF actually had a significantly higher mean firing rate than LIP (FEF: 36 sp/s; LIP: 28 sp/s; P=1.16x10<sup>-5</sup>Wilcoxon Rank-Sum test) which provides further evidence that coupling was not artificially inflated by differences in firing rate given that LIP had much higher coupling the FEF.</p></body></sub-article></article>