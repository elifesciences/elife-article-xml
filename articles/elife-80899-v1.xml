<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">80899</article-id><article-id pub-id-type="doi">10.7554/eLife.80899</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Cell Biology</subject></subj-group></article-categories><title-group><article-title>Crosshair, semi-automated targeting for electron microscopy with a motorised ultramicrotome</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-282401"><name><surname>Meechan</surname><given-names>Kimberly</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4939-4170</contrib-id><email>kimberly.meechan@embl.de</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-282523"><name><surname>Guan</surname><given-names>Wei</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-282762"><name><surname>Riedinger</surname><given-names>Alfons</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-282763"><name><surname>Stankova</surname><given-names>Vera</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-282764"><name><surname>Yoshimura</surname><given-names>Azumi</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-282765"><name><surname>Pipitone</surname><given-names>Rosa</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6855-5614</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-282766"><name><surname>Milberger</surname><given-names>Arthur</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-282767"><name><surname>Schaar</surname><given-names>Helmuth</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-282768"><name><surname>Romero-Brey</surname><given-names>Inés</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-282769"><name><surname>Templin</surname><given-names>Rachel</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2800-5826</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="pa1">†</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con10"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-134516"><name><surname>Peddie</surname><given-names>Christopher J</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-8329-5419</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con11"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-282770"><name><surname>Schieber</surname><given-names>Nicole L</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3212-5057</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="pa2">‡</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con12"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-31877"><name><surname>Jones</surname><given-names>Martin L</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0994-5652</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con13"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-71639"><name><surname>Collinson</surname><given-names>Lucy</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con14"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" corresp="yes" id="author-159861"><name><surname>Schwab</surname><given-names>Yannick</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8027-1836</contrib-id><email>yannick.schwab@embl.de</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con15"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03mstc592</institution-id><institution>Cell Biology and Biophysics Unit, European Molecular Biology Laboratory (EMBL)</institution></institution-wrap><addr-line><named-content content-type="city">Heidelberg</named-content></addr-line><country>Germany</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/038t36y30</institution-id><institution>Collaboration for Joint PhD Degree Between EMBL and Heidelberg University, Faculty of Biosciences</institution></institution-wrap><addr-line><named-content content-type="city">Heidelberg</named-content></addr-line><country>Germany</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04tnbqb63</institution-id><institution>Francis Crick Institute</institution></institution-wrap><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03mstc592</institution-id><institution>Electronic Workshop, European Molecular Biology Laboratory (EMBL)</institution></institution-wrap><addr-line><named-content content-type="city">Heidelberg</named-content></addr-line><country>Germany</country></aff><aff id="aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03mstc592</institution-id><institution>Mechanical Workshop, European Molecular Biology Laboratory (EMBL)</institution></institution-wrap><addr-line><named-content content-type="city">Heidelberg</named-content></addr-line><country>Germany</country></aff><aff id="aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03mstc592</institution-id><institution>Electron Microscopy Core Facility, European Molecular Biology Laboratory (EMBL)</institution></institution-wrap><addr-line><named-content content-type="city">Heidelberg</named-content></addr-line><country>Germany</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Cardona</surname><given-names>Albert</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/013meh722</institution-id><institution>University of Cambridge</institution></institution-wrap><country>United Kingdom</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Akhmanova</surname><given-names>Anna</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04pp8hn57</institution-id><institution>Utrecht University</institution></institution-wrap><country>Netherlands</country></aff></contrib></contrib-group><author-notes><fn fn-type="present-address" id="pa1"><label>†</label><p>Ramaciotti Centre for Cryo-EM, Monash University, Melbourne, Australia</p></fn><fn fn-type="present-address" id="pa2"><label>‡</label><p>Centre for Microscopy and Microanalysis, University of Queensland, Brisbane, Australia</p></fn></author-notes><pub-date publication-format="electronic" date-type="publication"><day>15</day><month>11</month><year>2022</year></pub-date><pub-date pub-type="collection"><year>2022</year></pub-date><volume>11</volume><elocation-id>e80899</elocation-id><history><date date-type="received" iso-8601-date="2022-06-08"><day>08</day><month>06</month><year>2022</year></date><date date-type="accepted" iso-8601-date="2022-10-23"><day>23</day><month>10</month><year>2022</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at bioRxiv.</event-desc><date date-type="preprint" iso-8601-date="2022-06-02"><day>02</day><month>06</month><year>2022</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.06.02.491151"/></event></pub-history><permissions><copyright-statement>© 2022, Meechan et al</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>Meechan et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-80899-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-80899-figures-v1.pdf"/><abstract><p>Volume electron microscopy (EM) is a time-consuming process – often requiring weeks or months of continuous acquisition for large samples. In order to compare the ultrastructure of a number of individuals or conditions, acquisition times must therefore be reduced. For resin-embedded samples, one solution is to selectively target smaller regions of interest by trimming with an ultramicrotome. This is a difficult and labour-intensive process, requiring manual positioning of the diamond knife and sample, and much time and training to master. Here, we have developed a semi-automated workflow for targeting with a modified ultramicrotome. We adapted two recent commercial systems to add motors for each rotational axis (and also each translational axis for one system), allowing precise and automated movement. We also developed a user-friendly software to convert X-ray images of resin-embedded samples into angles and cutting depths for the ultramicrotome. This is provided as an open-source Fiji plugin called Crosshair. This workflow is demonstrated by targeting regions of interest in a series of <italic>Platynereis dumerilii</italic> samples.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>electron microscopy</kwd><kwd>targeted acquisition</kwd><kwd>open-source software</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>P. dumerilii</italic></kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010438</institution-id><institution>Francis Crick Institute</institution></institution-wrap></funding-source><award-id>FC001999</award-id><principal-award-recipient><name><surname>Guan</surname><given-names>Wei</given-names></name><name><surname>Yoshimura</surname><given-names>Azumi</given-names></name><name><surname>Peddie</surname><given-names>Christopher J</given-names></name><name><surname>Jones</surname><given-names>Martin L</given-names></name><name><surname>Collinson</surname><given-names>Lucy</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100013060</institution-id><institution>European Molecular Biology Laboratory</institution></institution-wrap></funding-source><award-id>Predoctoral Fellowship</award-id><principal-award-recipient><name><surname>Meechan</surname><given-names>Kimberly</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100013060</institution-id><institution>European Molecular Biology Laboratory</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Riedinger</surname><given-names>Alfons</given-names></name><name><surname>Stankova</surname><given-names>Vera</given-names></name><name><surname>Pipitone</surname><given-names>Rosa</given-names></name><name><surname>Milberger</surname><given-names>Arthur</given-names></name><name><surname>Schaar</surname><given-names>Helmuth</given-names></name><name><surname>Romero-Brey</surname><given-names>Inés</given-names></name><name><surname>Templin</surname><given-names>Rachel</given-names></name><name><surname>Schieber</surname><given-names>Nicole L</given-names></name><name><surname>Schwab</surname><given-names>Yannick</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A new method using a motorised ultramicrotome and open-source software allows semi-automatic targeting of regions of interest for electron microscopy.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Imaging samples with electron microscopy (EM) is a time-consuming process – often requiring weeks or months of continuous acquisition for large samples (<xref ref-type="bibr" rid="bib23">Scheffer et al., 2020</xref>; <xref ref-type="bibr" rid="bib35">Zheng et al., 2018</xref>; <xref ref-type="bibr" rid="bib31">Vergara et al., 2021</xref>). This means that it is rarely feasible to acquire image volumes from entire specimens, and we must instead target specific regions of interest. For resin-embedded samples, this process is usually done with an ultramicrotome that allows manual trimming of the block using a razor blade and/or diamond knife, followed by cutting of thin sections at precise locations.</p><p>Targeting with an ultramicrotome is a difficult and manual process. The operator must rely on surface features that are visible through the ultramicrotome’s binocular microscope. This makes it challenging to target regions deep within a sample, especially when heavy metals make the sample opaque. In addition, the orientation of cutting must be set manually by adjusting three different ultramicrotome axes. This kind of 3D thinking is challenging, taking much time and training to master.</p><p>Other studies have improved the precision and ease of targeting by leveraging external 3D maps from light or X-ray microscopy (<xref ref-type="bibr" rid="bib10">Karreman et al., 2016</xref>; <xref ref-type="bibr" rid="bib11">Karreman et al., 2017</xref>; <xref ref-type="bibr" rid="bib34">Xu et al., 2021</xref>; <xref ref-type="bibr" rid="bib19">Musser et al., 2021</xref>; <xref ref-type="bibr" rid="bib5">Bushong et al., 2015</xref>; <xref ref-type="bibr" rid="bib22">Ronchi et al., 2021</xref>). X-ray offers many advantages for EM targeting – for example, it is readily compatible with standard EM sample preparation methods (<xref ref-type="bibr" rid="bib3">Bosch et al., 2022</xref>; <xref ref-type="bibr" rid="bib13">Kuan et al., 2020</xref>; <xref ref-type="bibr" rid="bib5">Bushong et al., 2015</xref>; <xref ref-type="bibr" rid="bib11">Karreman et al., 2017</xref>) and provides images that highlight similar structures to volume EM (although at a lower resolution) (<xref ref-type="bibr" rid="bib3">Bosch et al., 2022</xref>; <xref ref-type="bibr" rid="bib13">Kuan et al., 2020</xref>; <xref ref-type="bibr" rid="bib5">Bushong et al., 2015</xref>; <xref ref-type="bibr" rid="bib19">Musser et al., 2021</xref>). Laboratory micro-CT systems are becoming ever more popular and can provide an isotropic resolution of about 1 micron, with scan times in the range of a few hours (<xref ref-type="bibr" rid="bib33">Withers et al., 2021</xref>; <xref ref-type="bibr" rid="bib10">Karreman et al., 2016</xref>). In addition, there is increasing access to synchrotrons for X-ray imaging, which can provide resolutions in the range of hundreds or even tens of nanometres, and scan times in the range of minutes (depending on the resolution required) (<xref ref-type="bibr" rid="bib33">Withers et al., 2021</xref>; <xref ref-type="bibr" rid="bib3">Bosch et al., 2022</xref>; <xref ref-type="bibr" rid="bib13">Kuan et al., 2020</xref>). X-ray imaging therefore offers a fast, non-destructive method for obtaining 3D maps of the internal features of a sample for targeting.</p><p>Most methods that use light or X-ray microscopy for targeting rely on measuring the depth of regions of interest from the resin block’s surface, followed by trimming with an ultramicrotome. As these methods do not compensate for the exact position and orientation of the sample in the ultramicrotome, progress must be checked at regular intervals by iterative rounds of X-ray or light microscopy and trimming, slowing this process down. In addition, these methods focus on the depth of the region of interest, but still require the orientation of cutting to be set entirely manually.</p><p>Other studies have sought to bring more automation to the ultramicrotome to make it easier to use (<xref ref-type="bibr" rid="bib1">Baena et al., 2019</xref>; <xref ref-type="bibr" rid="bib27">Templier, 2019</xref>; <xref ref-type="bibr" rid="bib14">Lee et al., 2018</xref>). These efforts have mostly focused on the collection of serial sections, with little automation of the initial trimming and targeting process. An exception is <xref ref-type="bibr" rid="bib4">Brama et al., 2016</xref>, in which a miniature fluorescence microscope was integrated into the ultramicrotome, allowing automated tracking of regions of interest during cutting. However, this requires a fluorescent signal to be present within the sample embedded in the resin block and is therefore not compatible with standard heavy-metal stained specimens. Also, while this technique allows detection and collection of sections from regions of interest, it does not automate the depth or orientation of ultramicrotome cutting.</p><p>Here, we created a workflow for semi-automated targeting of regions of interest with a modified ultramicrotome. We introduced automation to two recent commercial systems in the form of motorisation for each of the ultramicrotome axes. This allowed precise and automated angular movement for both systems, as well as translational movement for one system. We also created new software that allows selection of a plane of interest from X-ray images, and automatic conversion into angles and cutting depths for the ultramicrotome. This is provided as an open-source, user-friendly Fiji (<xref ref-type="bibr" rid="bib24">Schindelin et al., 2012</xref>) plugin called Crosshair.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Automation of ultramicrotome</title><p>We modified two of the most recent commercial ultramicrotomes (Leica EM UC7 and RMC PowerTome PC [PTPC]) to add automation of movement (<xref ref-type="fig" rid="fig1">Figure 1</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). For the UC7, this consisted of three extra motors (one for each rotational axis) controlled by a small Raspberry Pi computer (<xref ref-type="fig" rid="fig1">Figure 1B and D</xref>). This system can be controlled via a simple touchscreen interface (developed with Node-RED), allowing the angles of each axis to be precisely set and measured (see section ‘Ultramicrotome systems and calibration’). All translational movements of the knife (north–south [NS] and east–west [EW]) were controlled manually via the existing Leica stage motors and Leica user interface.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Motorised ultramicrotome.</title><p>(<bold>A</bold>) Summary of the main ultramicrotome axes of rotation (sample tilt, sample rotation, and knife tilt), and movement (north–south [NS]/east–west [EW]), which are common to both Leica and RMC systems. (<bold>B</bold>) Overview of motorised Leica system. (<bold>C</bold>) Overview of motorised RMC system. (<bold>D</bold>) Zoom of (<bold>B</bold>), showing motors attached to each axis. (<bold>E</bold>) Zoom of (<bold>C</bold>), showing motors attached to each axis.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80899-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Motorised ultramicrotomes and user interfaces.</title><p>(<bold>A</bold>) Leica ultramicrotome arm with sample holder removed. This shows the additional hole that was drilled (here there are three holes, but the top labelled one is the only required). (<bold>B</bold>) Zoom of the back of the Leica sample holder, showing the small metal pin that was added to fit into the hole in (<bold>A</bold>). (<bold>C</bold>) Knife tilt page of the user interface for the motorised Leica system. This is shown on a touchscreen to the right of the ultramicrotome and allows motors to be enabled/disabled and set to specific angles. (<bold>D</bold>) User interface of the motorised RMC system.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80899-fig1-figsupp1-v1.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>Calibration of sample tilt axis.</title><p>(<bold>A</bold>) Diagram of calibration setup, with RMC system. (<bold>B</bold>) Graph of sample tilt vs. motor steps for RMC system. A linear fit is shown in red. (<bold>C</bold>) Same as (<bold>B</bold>) for Leica system.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80899-fig1-figsupp2-v1.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 3.</label><caption><title>Calibration of sample rotation axis.</title><p>(<bold>A</bold>) Diagram of calibration setup, with RMC system. (<bold>B</bold>) Graph of sample rotation vs. motor steps for RMC system. A linear fit is shown in red. (<bold>C</bold>) Same as (<bold>B</bold>) for Leica system.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80899-fig1-figsupp3-v1.tif"/></fig><fig id="fig1s4" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 4.</label><caption><title>Calibration of knife tilt axis.</title><p>(<bold>A</bold>) Diagram of calibration setup, with RMC system. (<bold>B</bold>) Graph of knife tilt vs. motor steps for RMC system. A linear fit is shown in red. (<bold>C</bold>) Same as (<bold>B</bold>) for Leica system.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80899-fig1-figsupp4-v1.tif"/></fig></fig-group><p>For the RMC, motors were added to the same rotational axes, with additional automation of the two translational stage movements (<xref ref-type="fig" rid="fig1">Figure 1C and E</xref>). These additional NS and EW motors allowed the position of the knife to be precisely controlled within the same user interface as the orientation. This is in contrast to the Leica system, where currently the translational and rotational movements are controlled separately. The five motors on the RMC system were controlled by a Trinamic TMCM-6110 6-axis stepper motor driver board. The graphical user interface (GUI) was developed with LabVIEW and installed onto a touchscreen PC, allowing users to control the motions via keyboard/mouse, touchscreen, or a joystick (see section ‘Ultramicrotome systems and calibration’).</p><p>Both systems were calibrated with special adaptors made to convert a rotational movement into the rotation of the dial of a Thorlabs CRM1PT/M rotation mount, whose Vernier scale provides 5 arcmin (0.083°) resolution (see section ‘Ultramicrotome systems and calibration).</p></sec><sec id="s2-2"><title>Targeting calculations</title><p>Our goal was to allow automatic calculation of the ultramicrotome moves required to cut to a specific target plane. The target plane defined the final position and orientation of the desired block surface (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). Thin sections could then be taken for transmission electron microscopy (TEM) or array tomography or the surface could be imaged directly with volume scanning electron microscopy (SEM).</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Targeting problem.</title><p>(<bold>A</bold>) Left: diagram of a resin block with a <italic>Platynereis</italic> sample inside. The top surface has been trimmed flat with a diamond knife. Right: same resin block with labelled block plane (i.e. the plane parallel to the flat trimmed surface) and target plane. (<bold>B</bold>) Diagram of the block in the ultramicrotome before (left) and after (right) the orientation solution is applied. A top view (with diamond knife at the bottom, and sample holder at the top) and side view (with diamond knife on the left, and sample holder on the right) are shown. <inline-formula><mml:math id="inf1"><mml:msub><mml:mi>θ</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:math></inline-formula> is the knife tilt angle, <inline-formula><mml:math id="inf2"><mml:msub><mml:mi>θ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></inline-formula> is the sample tilt angle, and <inline-formula><mml:math id="inf3"><mml:msub><mml:mi>θ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula> is the sample rotation angle. (<bold>C</bold>) Diagram of the block in the ultramicrotome before (left) and after (right) the distance solution is applied. Top/side view are the same as in (<bold>B</bold>). <inline-formula><mml:math id="inf4"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the NS cutting distance.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80899-fig2-v1.tif"/></fig><p>This targeting problem was broken down into two steps: orientation and distance. For the orientation problem, we found a combination of three angles (knife tilt, sample tilt, sample rotation; <xref ref-type="fig" rid="fig1">Figure 1A</xref>) that brought the target plane to be vertical and parallel to the knife (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). For the distance problem, we found the depth to cut from the sample surface to reach the target plane (<xref ref-type="fig" rid="fig2">Figure 2C</xref>).</p><p>The orientation problem required a mathematical description of how the target plane orientation changed as the knife tilt, sample tilt, and sample rotation were varied. This was a similar problem to that which must be solved to, for example, orient the ‘end-effector’ of a robotic arm by varying the angle of its individual joints. In robotics, this is solved by construction of a ‘forward kinematics’ equation that calculates the end-effector position, given the angles of the joints, and an ‘inverse kinematics’ equation, which calculates the joint angles, given the desired end-effector position. We therefore applied similar principles, constructing a forward and inverse kinematics equation for the ultramicrotome.</p><p>We first constructed the forward kinematics equation to describe the orientation of the target plane in terms of the three input angles. To do so, we defined orthogonal coordinate frames for each of the ultramicrotome parts (e.g. the knife holder, the sample holder, etc.) (<xref ref-type="fig" rid="fig3">Figure 3A and B</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>) and calculated the rotations that relate each piece. This is summarised in the pose diagram in <xref ref-type="fig" rid="fig3">Figure 3C</xref>. The relation between the sample holder and sample block surface is unknown in this pose diagram. This is because the sample holder does not hold the sample in a fixed orientation, meaning that the resin block has a slightly different orientation every time it is placed inside.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Coordinate frames, pose diagrams, and solutions.</title><p>(<bold>A</bold>) Diagram of all coordinate frames. World: x is parallel to EW, y is parallel to NS, z is vertical. Knife: z points out of the page, and is parallel to the world frame z. Arc: x is parallel to the world frame x. Holder: y points into the page and is parallel to the arc frame y. Block: x is parallel to the bottom edge of the block face. Two variations are shown: a rectangular block face (left) and a trapezium block face (right). Target: y is perpendicular to the target plane (shown in grey). (<bold>B</bold>) Diagram of relation between block and target coordinate frames. Left: 3D view of the block, showing the block frame (red) and target plane (grey). Middle: 2D view of the block frame’s xy plane (i.e. looking down on the block from above). The target plane intersects along the shown grey line, and <inline-formula><mml:math id="inf5"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the angle between the red and blue x axes, that is, the rotation angle about the block frame z. Right: 2D view of the blue axes’ zy plane (i.e. looking down the line of intersection from the middle panel). <inline-formula><mml:math id="inf6"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the angle between the blue and green z axes, that is, the rotation angle about the blue frame x. The green axes are the final target coordinate frame (as shown in <bold>A</bold>). (<bold>C</bold>) Pose diagram showing relations between coordinate frames. <inline-formula><mml:math id="inf7"><mml:msub><mml:mi>R</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf8"><mml:msub><mml:mi>R</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf9"><mml:msub><mml:mi>R</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:math></inline-formula>: rotation matrices about the x, y, and z axes, respectively; <inline-formula><mml:math id="inf10"><mml:msub><mml:mi>θ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></inline-formula>: sample tilt angle; <inline-formula><mml:math id="inf11"><mml:msub><mml:mi>θ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula>: sample rotation angle; <inline-formula><mml:math id="inf12"><mml:msub><mml:mi>θ</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:math></inline-formula>: knife angle; <inline-formula><mml:math id="inf13"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>: target offset angle; <inline-formula><mml:math id="inf14"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>: target rotation angle. Dashed arrows are unknown relations. (<bold>D</bold>) Pose diagram when the knife is aligned to the block face. Here, the knife frame is in the same orientation as the block (red arrow), and therefore we can infer the Holder to Block relation that was unknown in (<bold>C</bold>). <inline-formula><mml:math id="inf15"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the initial sample tilt angle and <inline-formula><mml:math id="inf16"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the initial knife tilt angle, when the knife and block are aligned. We define <inline-formula><mml:math id="inf17"><mml:msub><mml:mi>θ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula> to be zero at this aligned orientation. (<bold>E</bold>) Graphs of knife and sample tilt solution for all sample rotation angles. This used values of  <inline-formula><mml:math id="inf18"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> = 10, <inline-formula><mml:math id="inf19"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> = 10, <inline-formula><mml:math id="inf20"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> = –3.3, and <inline-formula><mml:math id="inf21"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> = 5.4. (<bold>F</bold>) Solution graphs with more extreme initial angles. <inline-formula><mml:math id="inf22"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> = 10, <inline-formula><mml:math id="inf23"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> = 10, <inline-formula><mml:math id="inf24"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> = –60, and  <inline-formula><mml:math id="inf25"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> = 5.4.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80899-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Coordinate frames at different angles.</title><p>(<bold>A</bold>) Knife coordinate frame at 0° (top) and 10° (bottom). Note that at 0° the knife frame has the same orientation as the world frame. (<bold>B</bold>) Arc coordinate frame at 0° (top) and 14° (bottom). Note that at 0° the arc frame has the same orientation as the world frame. (<bold>C</bold>) Holder coordinate frame at two positions separated by a 90° rotation. Note that here the 0 position depends on the particular targeting run as it is defined as the rotation when the knife and block face are aligned.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80899-fig3-figsupp1-v1.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Distance calculation.</title><p>Here, the same block and target plane as in <xref ref-type="fig" rid="fig3">Figure 3B</xref> are shown in an example solution orientation. In red is the World coordinate frame, showing we are looking down the world z-axis. The knife is aligned to the vertical target plane, but the ultramicrotome arm (and therefore the block) advances towards the knife in the world y-axis (NS) between cuts. Therefore, the required cutting distance is not the same as the perpendicular distance between the knife and target plane. <inline-formula><mml:math id="inf26"><mml:msub><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math></inline-formula> is the perpendicular distance between the target plane and the furthest surface point, <inline-formula><mml:math id="inf27"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the corresponding NS distance (i.e. the required cutting depth), and <inline-formula><mml:math id="inf28"><mml:msub><mml:mi>θ</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:math></inline-formula> is the knife angle.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80899-fig3-figsupp2-v1.tif"/></fig></fig-group><p>To calculate this relation, we therefore required an initial alignment step where the knife is manually aligned to the block face. This is standard procedure for cutting with an ultramicrotome, and so should be familiar to anyone who has used a ultramicrotome previously. In this aligned position, the orientation of the knife and block coordinate frames was the same, allowing the holder to block relation to be calculated (<xref ref-type="fig" rid="fig3">Figure 3D</xref>).</p><p>This meant that the full forward kinematics equation, describing the rotation from the World coordinate frame to the target plane, was<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf29"><mml:msub><mml:mi mathvariant="bold-italic">R</mml:mi><mml:mi mathvariant="bold-italic">x</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf30"><mml:msub><mml:mi mathvariant="bold-italic">R</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf31"><mml:msub><mml:mi mathvariant="bold-italic">R</mml:mi><mml:mi mathvariant="bold-italic">z</mml:mi></mml:msub></mml:math></inline-formula> are rotation matrices about the x, y, and z axes, respectively. <inline-formula><mml:math id="inf32"><mml:msub><mml:mi>θ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></inline-formula> is the sample tilt angle and <inline-formula><mml:math id="inf33"><mml:msub><mml:mi>θ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula> is the sample rotation angle. <inline-formula><mml:math id="inf34"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf35"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf36"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf37"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are constants for a particular targeting run representing the initial sample tilt angle (on alignment), the initial knife tilt angle (on alignment), the offset angle between the block face and the target plane (measured from X-ray), and the rotation angle between the block face and the target plane (measured from X-ray). See <xref ref-type="fig" rid="fig3">Figure 3B</xref> for details of how <inline-formula><mml:math id="inf38"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf39"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are calculated.</p><p>With the forward kinematics equation complete, we then constructed and solved an inverse kinematics equation to determine the required angles for each solution (see section ‘Orientation calculation’). This gave the solution tilt and knife angles as<disp-formula id="equ2"><mml:math id="m2"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>arctan</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ3"><mml:math id="m3"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>arctan</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mroot><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mroot><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf40"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> are constants for a particular targeting run (see ‘Materials and methods’ for details). This means that, as expected, there are many possible solutions for each targeting setup. In fact, any point on these lines (<xref ref-type="fig" rid="fig3">Figure 3E</xref>) is a possible solution. Note that there will be some situations where no solution is possible due to the constraints of the ultramicrotome axes, for example, in <xref ref-type="fig" rid="fig3">Figure 3F</xref>, the sample tilt of some solutions exceeds the maximum sample tilt of 20°. In these situations, the sample would need to be remounted or re-trimmed to aim for an angular difference within the ultramicrotome constraints.</p><p>For the distance problem, we calculated the distance between the block surface and target plane (from the X-ray images), and compensated for the current knife angle to give the true cutting distance:<disp-formula id="equ4"><mml:math id="m4"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf41"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the north–south (NS) distance (cutting distance), <inline-formula><mml:math id="inf42"><mml:msub><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math></inline-formula> is the perpendicular distance between the target plane and the furthest surface point, and <inline-formula><mml:math id="inf43"><mml:msub><mml:mi>θ</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:math></inline-formula> is the knife angle (see section ‘Distance calculation’ and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>).</p></sec><sec id="s2-3"><title>Crosshair targeting workflow</title><p>The entire workflow is summarised in <xref ref-type="fig" rid="fig4">Figure 4</xref>, with details given in the section ‘Targeting workflow’. In brief, the resin block was first trimmed manually close to the sample, with a rectangular face in its surface. This block face (which can be any shape with four corners and straight lines in between) provided the reference to define the block coordinate frame (<xref ref-type="fig" rid="fig3">Figure 3A</xref>).</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Targeting workflow.</title><p>Summary of targeting workflow steps with representative images/3D renders.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80899-fig4-v1.tif"/></fig><p>Next, the sample was imaged with X-ray at the highest resolution possible (around 1 micron isotropic voxel size is feasible on lab-based micro-CT systems). From this X-ray image, two planes were defined: one on the flat block surface, and one on the target plane using the Crosshair plugin (see section ‘Crosshair’ and <xref ref-type="fig" rid="fig2">Figure 2A</xref>). Then, the corners of the block surface were marked in the software as these were used to determine where cutting would begin and the distance required. Finally, the orientation was decided, that is, which edge of the block would face upwards in the ultramicrotome.</p><p>Next, we moved to the ultramicrotome. The zero position of the sample tilt and knife tilt axes was checked (see ‘Materials and methods’) to ensure all angular measures began from the correct position. Then, the resin-embedded sample was inserted, and the knife and block face manually aligned. This aligned position was defined as the zero position for the sample rotation to simplify the targeting calculations.</p><p>The aligned sample and knife tilt angles (<inline-formula><mml:math id="inf44"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf45"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> were then precisely read from the motorised ultramicrotome system and entered into the targeting calculations. This allowed all solutions to be calculated and one selected by the ultramicrotome user. For example, the user may want to minimise the knife and sample tilt angles to make it easier to collect thin sections after targeting. Finally, the ultramicrotome was precisely set to the three solution angles using the motors and the solution distance cut.</p><p>At this point, thin sections could be taken for TEM, or array tomography, or the block could be transferred for volume imaging in a focused ion beam scanning electron microscope (FIB-SEM) or serial block face scanning electron microscope (SBF-SEM).</p></sec><sec id="s2-4"><title>Crosshair</title><p>To make this workflow accessible to all, we developed the open-source Fiji (<xref ref-type="bibr" rid="bib24">Schindelin et al., 2012</xref>) plugin Crosshair (<ext-link ext-link-type="uri" xlink:href="https://github.com/automated-ultramicrotomy/crosshair">https://github.com/automated-ultramicrotomy/crosshair</ext-link>; <xref ref-type="bibr" rid="bib16">Meechan, 2022b</xref>), which allows user-friendly measurement of X-ray images, and access to the calculations described above (<xref ref-type="fig" rid="fig5">Figure 5</xref>, <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). It uses BigDataViewer (<xref ref-type="bibr" rid="bib21">Pietzsch et al., 2015</xref>) to allow browsing of large images in arbitrary 2D slices, and the ImageJ 3D Viewer (<xref ref-type="bibr" rid="bib25">Schmid et al., 2010</xref>) to allow browsing in 3D.</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Crosshair.</title><p>(<bold>A</bold>) Crosshair plugin user interface, with an example <italic>Platynereis dumerilii</italic> X-ray image. Left: controls; middle: BigDataViewer window showing 2D cross-section. Right: ImageJ 3D viewer showing volume rendering with block and target planes (blue and green, respectively). The green target plane is the same as the 2D slice shown. (<bold>B</bold>) Left: microtome mode controls and solution display. Right: corresponding 3D representation of ultramicrotome and sample.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80899-fig5-v1.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Crosshair user interface.</title><p>Crosshair. Left column: 2D slice. Right column: 3D volume rendering. (<bold>A</bold>) Three points placed on the block surface to fit a plane. (<bold>B</bold>) Block surface shown in 2D and 3D (blue plane) with labelled corners and orientation. The green points in the 2D view are the points used to fit the plane originally. (<bold>C</bold>) Example of ‘cutting mode’. The 2D slice shows the predicted surface at a certain cut depth, indicated in 3D by the large pink plane.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80899-fig5-figsupp1-v1.tif"/></fig></fig-group><p>Crosshair allows the planes and points required for the targeting workflow (<xref ref-type="fig" rid="fig4">Figure 4</xref>) to be created and viewed interactively. It also allows the orientation of the block to be marked and visualised in 2D and 3D.</p><p>To make selection of solutions easier, Crosshair also has a ‘microtome mode’ which allows a simple representation of the ultramicrotome to be manipulated in 3D (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). This has the constraints of the ultramicrotome built in and displays a volume rendering of the X-ray imaged sample at the appropriate orientation. In this way, users can interactively move sliders in the user interface and view the orientation of the ultramicrotome and sample in real time. This also outputs the corresponding angles and cutting distance for each solution.</p><p>Finally, Crosshair also has a ‘cutting mode’ which allows the predicted cutting progression to be viewed in 2D and 3D (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1C</xref>). In this way, users can choose a solution and then easily view which structures will be visible at which cutting distances. This makes it simple to choose an appropriate solution for their targeting problem.</p></sec><sec id="s2-5"><title>Accuracy measures</title><p>To test the accuracy of this workflow, we targeted a series of 6-day-old <italic>Platynereis dumerilii</italic> samples. <italic>Platynereis</italic> is a marine annelid, which is an established model system for development, evolution, and neurobiology (<xref ref-type="bibr" rid="bib20">Özpolat et al., 2021</xref>; <xref ref-type="bibr" rid="bib7">Fischer and Dorresteijn, 2004</xref>; <xref ref-type="bibr" rid="bib32">Williams and Jékely, 2016</xref>). As they can be bred quickly and easily in the lab, and have well-defined tissue morphology, we decided to use them as a test case for targeting regions of interest. We set our target plane on each sample to cut through both of the anterior dorsal cirrus that protrude from either side of the <italic>Platynereis</italic> head.</p><p>All samples were targeted with the workflow described above: five on the motorised Leica system (samples a–e) and five on the RMC system (samples f–j). After targeting, samples were X-ray imaged again and registered to the pre-targeting scan. This registration was completed with another Fiji plugin we created – RegistrationTree – which is also freely available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/K-Meech/RegistrationTree">https://github.com/K-Meech/RegistrationTree</ext-link>; <xref ref-type="bibr" rid="bib17">Meechan, 2022c</xref>). This plugin is a wrapper around two existing registration software – BigWarp (<xref ref-type="bibr" rid="bib2">Bogovic et al., 2016</xref>) and elastix (<xref ref-type="bibr" rid="bib12">Klein et al., 2010</xref>; <xref ref-type="bibr" rid="bib26">Shamonin et al., 2013</xref>) – allowing easy passing of images from one software to the other, and smooth use of very large images with elastix. It is standalone, so it can also be used for general registration of large images, independent of the Crosshair workflow.</p><p>Once the images were registered, we calculated a series of angle and distance accuracy measures using the built-in features in the Crosshair plugin (<xref ref-type="fig" rid="fig6">Figures 6</xref> and <xref ref-type="fig" rid="fig7">7</xref>; see section ‘Accuracy tests’).</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Accuracy test results.</title><p>(<bold>A</bold>) Graph of point-to-plane distance error vs. angle error for all 10 samples (<bold>a–j</bold>). (<bold>B</bold>) Graph of absolute solution distance error vs. angle error. (<bold>C</bold>) For each sample (<bold>a–j</bold>), two images are shown. Top: registered before and after X-ray images. Bottom: snapshot of the 3D viewer in Crosshair. In the 3D view, the block surface is shown in blue, the target in green, and the plane reached in yellow. In most cases, the green and yellow planes are too close together to distinguish well. The axes shown in some of these images are the 3D viewer coordinate system.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80899-fig6-v1.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Registration accuracy.</title><p>(<bold>A</bold>) Beeswarm plot of distance error (microns) measured between manually placed corresponding points on pairs of registered X-ray images for samples (<bold>a–j</bold>). Two repeats of manually placing points in the same locations on the same images are shown. (<bold>B</bold>) Absolute difference (microns) between the distance error measured in (<bold>A</bold>) between repeat 1 and repeat 2 for each point.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80899-fig6-figsupp1-v1.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 2.</label><caption><title>Sample mounting for trimming, X-ray imaging, and targeting for samples f–j.</title><p>(<bold>A</bold>) Resin-embedded sample mounted onto an aluminium pin using conductive epoxy glue. (<bold>B</bold>) An aluminium pin with sample inserted into a Gatan Rivet Holder which is directly inserted into an ultramicrotome chuck holder for trimming and targeting at the ultramicrotome. (<bold>C</bold>) An aluminium pin with sample mounted to a sample holder of Versa 510 X-ray microscope for X-ray imaging.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80899-fig6-figsupp2-v1.tif"/></fig></fig-group><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Comparison of target plane (from the before scan) to the block surface (after scan).</title><p>Each sample (<bold>a–j</bold>) has a column with three images. Top row: the target plane from the before targeting scan. Middle row: the block surface from the after targeting scan. Bottom row: cross-section parallel to block surface, but 3 µm inside the block. The middle row images can be quite dark/noisy as they slice right along the surface of the block, so the bottom row is provided so the cross-section can be seen more easily.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80899-fig7-v1.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>Comparison of example <italic>Platynereis</italic> X-ray cross-sections, both acquired with 1 micron isotropic voxel size.</title><p>(<bold>A</bold>) Sample d X-ray, acquired with Bruker SkyScan 1272 (system used for samples a–e). (<bold>B</bold>) Sample f X-ray, acquired with Zeiss Versa 510 (system used for samples f–j). Note the sharper block edges and the finer anatomical details visible in (<bold>B</bold>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-80899-fig7-figsupp1-v1.tif"/></fig></fig-group><p>Comparison of the target plane and trimmed block surface showed that all samples hit their target of cutting through both anterior dorsal cirrus, and provided similar <italic>Platynereis</italic> cross-sections to those predicted from the X-ray (<xref ref-type="fig" rid="fig7">Figure 7</xref>). The accuracy measures gave a mean angular error of 0.9°, a mean absolute solution distance error of 3.1 microns, and a mean point-to-plane distance error of 3.1 microns (see section ‘Accuracy tests’ for details of these different measures). Note that there will be some error in these distance measures due to slight inaccuracies in the registration process – estimated at around 2 microns error (see section ‘Accuracy tests’ and <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). Given that our X-ray voxel size is only 1 micron, there is a limit to how precisely such small distances can be measured. This could be improved in future by moving to higher-resolution X-ray imaging from synchrotrons, which can provide resolutions in the range of hundreds of nanometres.</p><p>Note that there were also some differences between the mean targeting accuracy reached with the Leica and RMC systems. The Leica system had a mean angular error of 1.1°, mean absolute solution distance error of 4.5 microns, and a mean point-to-plane distance error of 4.8 microns. The RMC system had a mean angular error of 0.7°, mean absolute solution distance error of 1.6 microns, and a mean point-to-plane distance error of 1.3 microns. There are a number of factors that could have contributed to this difference. Firstly, the samples tested with the Leica system were X-ray imaged with a different micro-CT system to those tested on the RMC system (see section ‘X-ray imaging’). While all were scanned with the same voxel size (1 micron), the amount of detail that could be seen inside the <italic>Platynereis</italic> was quite different (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>). Therefore, the higher quality of the X-ray scans for samples f–j (tested with RMC) may have contributed to the improved average targeting accuracy. Secondly, there are still a number of manual steps in this workflow (such as the manual alignment of knife and block face), which can allow human error to contribute to the accuracy. Samples a–e and f–j were targeted by different researchers, so this may also contribute to the differing average accuracy. Finally, the Leica and RMC systems use different hardware (e.g. motors) which will also contribute to their differing average accuracy.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>The motorised ultramicrotome systems and targeting workflow presented here provide a user-friendly solution for targeted EM. The workflow allows X-ray images of resin-embedded samples to be converted into a set of three angles (sample tilt, sample rotation, and knife tilt) and a cutting distance for the ultramicrotome. These moves can then be precisely executed with the two motorised ultramicrotome systems we developed to reach a target plane. All measurement steps are integrated into the open-source Fiji plugin Crosshair, making it easily accessible to all. Across 10 targeting runs, the workflow provided a mean angular error of 0.9° and a mean distance error of 3.1 microns. Once the X-ray images have been acquired, the Crosshair measurements and trimming can be done in 1–2 hr, depending on the sample. This is a significant speed up where, in our experience, non-assisted targeting from X-ray may take 1–2 days for complex samples.</p><p>There are a number of factors that limit the accuracy of the current system – the first is the resolution of the X-ray images. All X-ray imaging in this article was done with lab-based micro-CT systems, which offer a maximum resolution of around 1 micron isotropic voxel size. As all measurements are based on these images, this voxel size limits the achievable accuracy and contributes to our registration uncertainty. A future direction would be to combine Crosshair with higher-resolution X-ray imaging from a synchrotron. Synchrotrons are extremely powerful sources of X-rays and can provide resolutions in the range of hundreds or even tens of nanometres. In recent years, there have been a number of studies that combine X-ray imaging from a synchrotron with EM (<xref ref-type="bibr" rid="bib3">Bosch et al., 2022</xref>; <xref ref-type="bibr" rid="bib13">Kuan et al., 2020</xref>; <xref ref-type="bibr" rid="bib19">Musser et al., 2021</xref>), demonstrating the power of combining the large field of view and fast scan times of X-ray, with the high resolution of targeted EM acquisition. As this combination becomes ever more popular, it is more important than ever to have user-friendly targeting solutions like Crosshair.</p><p>Another accuracy limitation are the manual steps that remain in this targeting workflow. While we automate the motorised movements and angle/distance calculations, a number of steps still require manual use of the ultramicrotome, and will therefore vary in accuracy depending on how experienced the user is. For example, the setting of the zero positions of the knife and sample tilt, alignment of the knife and block face, and approach of the knife to the block surface are all done manually. This will therefore introduce some variation due to human error.</p><p>Each of these manual steps should be minimised or eliminated in future work to improve accuracy. For example, the zero for the sample tilt could be set by precise measurement of the arc piece, rather than by eye. Also, it would be useful to find a more automated way to set the knife zero (although this is more complex as the knife is removed and replaced each time, and different knives are used for different purposes).</p><p>The manual alignment of the knife and block face could be removed if another method was found to determine the relation between the block surface and the sample holder. For example, the sample could be X-ray imaged directly inside the sample holder, although this is challenging in many micro-CT systems due to its large size. Alternately, a thin pin could be designed that would fit in the micro-CT and also fit tightly inside the sample holder at a fixed orientation. This is very similar to how samples f–j were mounted for targeting (see section ‘Initial sample trimming and mounting’ and <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>). Each of these samples was mounted to a thin aluminium pin at the start of the targeting process, and all trimming steps completed with a Gatan 3View Rivet holder that allows the pin to slot tightly inside. To eliminate the manual alignment step, this pin/holder would have to be adapted so the pin only slots inside in a fixed orientation. For example, by adding a groove to the side of the pin, that fits a corresponding projection on the sample holder. This would allow the relation between the block surface and sample holder to be calculated directly from the X-ray images alone.</p><p>The final manual step is the approach of the knife to the block surface. Currently, the user must move the knife forward and assess whether it has reached the block surface visually by examining the block through the ultramicrotome’s binocular microscope. If cutting starts from one corner, it is easy to cut some distance before debris are visually detected on the knife (especially for less experienced ultramicrotome users). This results in errors in the final distance cut. This error increases each time the ultramicrotome is reset, meaning the greatest accuracy is achieved when the cutting distance is less than one feed length (200 microns). This being said, we did still achieve good accuracy with samples h, i, and j in this study that had cutting distances greater than one feed length (requiring one reset mid-run) (<xref ref-type="fig" rid="fig6">Figure 6</xref>). Even so, the requirement to manually reset and approach every 200 microns means that larger samples require more manual user intervention, and therefore more time and effort. Automation of this step is challenging and would require hardware improvements that extend the feed length of the ultramicrotome to minimise resets or a method to allow automatic resets. An automatic reset method would require a means to know the absolute distance between the knife and block surface, which is currently complex to achieve.</p><p>Moving away from improving the workflow’s accuracy, it would also be interesting to expand the workflow’s scope in future work. For example, Crosshair’s calculations should be applicable to any 3D map (not only X-ray), and so could be expanded to targeting from 3D light microscopy. This would be useful for targeting fluorescently labelled structures during CLEM (correlative light and electron microscopy) as in <xref ref-type="bibr" rid="bib22">Ronchi et al., 2021</xref>. Also, Crosshair could be expanded to allow multiple modalities to be used together; for example, displaying registered light microscopy and X-ray images of the same sample.</p><p>In addition, Crosshair could be expanded to automate hitting not only a target plane, but a specific location within that plane. For example, for the <italic>Platynereis</italic>, we may cut to a target plane that gives a cross-section through the entire head, and then automatically trim the block sides to leave only a certain sub-structure of interest. This is useful for methods such as FIB-SEM that cannot image large block surfaces. This would require precise, automated east–west movement of the knife (as already implemented on the RMC system), and expansion of the targeting calculations and Crosshair plugin.</p><p>In summary, this targeting workflow offers a first step towards fully automated targeting of structures within resin blocks for EM. By making it simpler, and faster, to target a specific plane of interest, we can achieve higher throughput and shorter overall acquisition times. Also, by providing a user-friendly software for this process, we lower the barrier for newcomers to get started with 3D targeting. By providing the motorised ultramicrotome plans and software fully open-source, we hope that this work will enable more EM labs to rapidly target regions of interest for EM.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Data availability</title><p>All X-ray images are available on EMPIAR with id ‘EMPIAR-11055’ (<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/empiar/EMPIAR-11055/">https://www.ebi.ac.uk/empiar/EMPIAR-11055/</ext-link>). All files for the accuracy measures tests (Crosshair settings and solutions, accuracy measures, registration metadata, registration accuracy measures) and calibration of the angular rotation of the ultramicrotomes are available on BioStudies with id ‘S-BSST845’ (<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/biostudies/studies/S-BSST845">https://www.ebi.ac.uk/biostudies/studies/S-BSST845</ext-link>). Diagrams, CAD files, and software for the two ultramicrotome systems are available in the following GitHub repositories: <ext-link ext-link-type="uri" xlink:href="https://github.com/automated-ultramicrotomy/embl-system">https://github.com/automated-ultramicrotomy/embl-system</ext-link> (<xref ref-type="bibr" rid="bib15">Meechan, 2022a</xref>) and <ext-link ext-link-type="uri" xlink:href="https://github.com/automated-ultramicrotomy/crick-system">https://github.com/automated-ultramicrotomy/crick-system</ext-link> (<xref ref-type="bibr" rid="bib9">Jones, 2022</xref>). The Crosshair Fiji plugin is available with tutorials and documentation at the following GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/automated-ultramicrotomy/crosshair">https://github.com/automated-ultramicrotomy/crosshair</ext-link> (<xref ref-type="bibr" rid="bib16">Meechan, 2022b</xref>), along with a video tutorial on YouTube for the Leica system (<ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=OM712ECthGg">https://www.youtube.com/watch?v=OM712ECthGg</ext-link>).</p></sec><sec id="s4-2"><title>Ultramicrotome systems and calibration</title><sec id="s4-2-1"><title>Leica system</title><p>The motorised Leica system was designed as a simple add-on to any existing Leica UC7 (or similar ultramicrotome). This means it can easily be added/removed when it is required. Only one modification was made to the ultramicrotome itself – a hole was drilled into the cutting arm at a precisely vertical position (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1A</xref>). This fits a small pin that was added to the back of the arc piece (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1B</xref>) to keep the arc piece precisely vertical.</p><p>A new sample holder/arc and knife holder were purchased from Leica and modified with FAULHABER DC motors for each axis (<xref ref-type="fig" rid="fig1">Figure 1B and D</xref>). These motors have their own driver module that uses serial communication RS232 (12 V). A cable with a converter (RS232 to UART) is used to communicate with a Raspberry Pi running a Node-RED (<ext-link ext-link-type="uri" xlink:href="https://nodered.org/">https://nodered.org/</ext-link>) program for user interface and motor control. The Raspberry Pi is connected to a Raspberry Pi 7-inch touchscreen display and a StromPi3 battery. The battery is designed to hold up the shutdown process for 1 s and allow Linux to shut down properly, avoiding damage to the SD memory card that holds the operating system. The setup uses a desktop power supply (that provides 12 V) and connects to the StromPi3 battery module. The StromPi3 then provides the 5 V needed for the Raspberry Pi. All electronics are housed in a case with an adjustable arm for good screen visibility/ease of use. This allows the motor positions to be controlled and monitored easily by interacting with the touchscreen. The Node-RED user interface ‘flow’ json is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/automated-ultramicrotomy/embl-system/blob/main/node-red/node-red-flow.json">https://github.com/automated-ultramicrotomy/embl-system/blob/main/node-red/node-red-flow.json</ext-link> (<xref ref-type="bibr" rid="bib15">Meechan, 2022a</xref>). Once Node-RED is installed, the flow can be loaded by selecting ‘import’ from the menu and providing this .json file. This also requires the following nodes to be installed: node-red-dashboard (<ext-link ext-link-type="uri" xlink:href="https://flows.nodered.org/node/node-red-dashboard">https://flows.nodered.org/node/node-red-dashboard</ext-link>) and node-red-node-serialport (<ext-link ext-link-type="uri" xlink:href="https://flows.nodered.org/node/node-red-node-serialport">https://flows.nodered.org/node/node-red-node-serialport</ext-link>).</p><p>Diagrams, CAD files, and software for this system are available on the following GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/automated-ultramicrotomy/embl-system">https://github.com/automated-ultramicrotomy/embl-system</ext-link> (<xref ref-type="bibr" rid="bib15">Meechan, 2022a</xref>).</p></sec><sec id="s4-2-2"><title>RMC system</title><p>To motorise the existing RMC PTPC ultramicrotome, we replaced the manual operational knobs with Trinamic stepper motors and KHK gear sets. For each gear set, one gear was mounted on the shaft originally holding the knob, and another gear was mounted onto the stepper motor. There are five stepper motors and gear sets used in total to motorise the sample tilt/rotation on the sample holder, knife tilt, and stage NS/EW translations. Each stepper motor was chosen based on the consideration of both its maximum torque and its weight. For example, the motor to tilt the sample on the sample holder needs to be reasonably powerful as it is holding both the motor to rotate the sample and itself, which means it cannot be too heavy at the same time. The motor mount on the sample holder was 3D printed to reduce the weight and other motor mounts were manufactured in the Francis Crick Institute’s mechanical workshop.</p><p>The retrofitted five motors were controlled by a Trinamic TMCM-6110 6-axis stepper motor driver board, which was linked via USB to a touchscreen PC. The GUI, as shown in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1D</xref>, was developed with LabVIEW and installed onto this PC, allowing users to control the motions via keyboard/mouse, touchscreen, or even a joystick. The stepper motors can provide 51,200 microsteps per full 360° revolutions, which is equivalent to an accuracy of up to 0.00703125° per microstep.</p><p>Diagrams, CAD files, and software for this system are available on the following GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/automated-ultramicrotomy/crick-system">https://github.com/automated-ultramicrotomy/crick-system</ext-link> (<xref ref-type="bibr" rid="bib9">Jones, 2022</xref>).</p></sec><sec id="s4-2-3"><title>Calibration of Leica and RMC system</title><p>In order to calibrate the number of degrees rotated by these stepper motors via different gear sets (not only gear sets for retrofitted motors but also internal gears in the original RMC and Leica sample holder and knife holder to conduct the rotation), therefore, different gear ratios, we designed special adaptors to convert the rotational movement of the sample holder and the knife holder to the rotation of the dial of a Thorlabs CRM1PT/M rotation mount, whose Vernier scale provides 5 arcmin (0.083°) resolution. We rotated/tilted the sample and knife clockwise and anticlockwise travelling the whole range, then recorded the microstep numbers and readings from the rotation mount with roughly equal intervals. A linear regression was performed to finally work out the microstep numbers of the angle resolution, which we set to 0.1° to match the Vernier scale used (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplements 2</xref>–<xref ref-type="fig" rid="fig1s4">4</xref>).</p><p>Diagrams/CAD files of the calibration setup are available in the following GitHub repositories: <ext-link ext-link-type="uri" xlink:href="https://github.com/automated-ultramicrotomy/embl-system">https://github.com/automated-ultramicrotomy/embl-system</ext-link> (<xref ref-type="bibr" rid="bib15">Meechan, 2022a</xref>) and <ext-link ext-link-type="uri" xlink:href="https://github.com/automated-ultramicrotomy/crick-system">https://github.com/automated-ultramicrotomy/crick-system</ext-link> (<xref ref-type="bibr" rid="bib9">Jones, 2022</xref>). The tables of values used for the angular calibration are available on BioStudies (<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/biostudies/studies/S-BSST845">https://www.ebi.ac.uk/biostudies/studies/S-BSST845</ext-link>).</p></sec></sec><sec id="s4-3"><title>Orientation calculation</title><p>For this section, we use the symbols in <xref ref-type="table" rid="table1">Table 1</xref> and the constants in <xref ref-type="table" rid="table2">Table 2</xref>. See <xref ref-type="fig" rid="fig3">Figure 3B</xref> for details of how <inline-formula><mml:math id="inf46"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf47"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are calculated.</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Symbols for orientation calculation.</title></caption><table frame="hsides" rules="groups"><thead><tr><th valign="bottom">Variable</th><th valign="bottom">Explanation</th></tr></thead><tbody><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf48"><mml:msub><mml:mi mathvariant="bold-italic">R</mml:mi><mml:mi mathvariant="bold-italic">x</mml:mi></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">Rotation matrix about the x-axis</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf49"><mml:msub><mml:mi mathvariant="bold-italic">R</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">Rotation matrix about the y-axis</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf50"><mml:msub><mml:mi mathvariant="bold-italic">R</mml:mi><mml:mi mathvariant="bold-italic">z</mml:mi></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">Rotation matrix about the z-axis</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf51"><mml:msub><mml:mi>θ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">Tilt angle of sample</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf52"><mml:msub><mml:mi>θ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">Rotation angle of sample</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf53"><mml:msub><mml:mi>θ</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">Tilt angle of knife</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf54"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">Initial tilt of sample (on alignment)</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf55"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">Initial tilt of knife (on alignment)</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf56"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">Target offset angle, i.e. block face to target plane z-axis rotation (measured from X-ray)</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf57"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td align="left" valign="bottom">Target rotation angle, i.e. block face to target plane x-axis rotation (measured from X-ray)</td></tr></tbody></table></table-wrap><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Constants for orientation calculation.</title></caption><table frame="hsides" rules="groups"><thead><tr><th valign="bottom">Constant</th><th valign="bottom">Full expression</th></tr></thead><tbody><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf58"><mml:mi>A</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf59"><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf60"><mml:mi>B</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf61"><mml:mrow><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf62"><mml:mi>C</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf63"><mml:mrow><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf64"><mml:mi>D</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf65"><mml:mrow><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf66"><mml:mi>E</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf67"><mml:mrow><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf68"><mml:mi>F</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf69"><mml:mrow><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf70"><mml:mi>G</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf71"><mml:mrow><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf72"><mml:mi>H</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf73"><mml:mrow><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf74"><mml:mi>I</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom"><inline-formula><mml:math id="inf75"><mml:mrow><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr></tbody></table></table-wrap></sec><sec id="s4-4"><title>Forward kinematics equation</title><p>The forward kinematics equation was constructed by calculating the rotation matrices that relate each of the individual coordinate frames (<xref ref-type="fig" rid="fig3">Figure 3A and B</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). The World coordinate frame was fixed and defined x as parallel to the east–west movement of the ultramicrotome, y as parallel to the north–south movement, and z as vertical. The other coordinate frames could be imagined as attached to their respective components, moving with them as they move. These relations are summarised in the pose diagram in <xref ref-type="fig" rid="fig3">Figure 3C</xref>. We only focused on the orientation, and not relative position, as the position was solved in a separate process (see section ‘Distance calculation’). When the knife and block surface were aligned, the orientation of the knife coordinate frame was the same as the block coordinate frame. This allowed the rotation matrix between the holder and block to be calculated by going the ‘long way round’ in this diagram, that is, from Holder, to Arc, to World, to Knife, and then to Block (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). This was made simpler by defining the sample rotation to be zero at this aligned position.</p><p>The full forward kinematics equation, describing the rotation from the World coordinate frame to the target plane, was then<disp-formula id="equ5"><label>(1)</label><mml:math id="m5"><mml:mrow><mml:mrow><mml:mi mathvariant="italic">F</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="italic">R</mml:mi><mml:mrow><mml:mi mathvariant="italic">x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="italic">R</mml:mi><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="italic">R</mml:mi><mml:mrow><mml:mi mathvariant="italic">x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="italic">R</mml:mi><mml:mrow><mml:mi mathvariant="italic">z</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="italic">R</mml:mi><mml:mrow><mml:mi mathvariant="italic">z</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="italic">R</mml:mi><mml:mrow><mml:mi mathvariant="italic">x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This equation allowed us to accurately describe the orientation of the target plane for any set of input angles (sample tilt, sample rotation, and knife tilt).</p></sec><sec id="s4-5"><title>Sample tilt solution</title><p>The next step was to calculate the required inverse kinematics equation. For us, the constraint to satisfy was that the target coordinate frame’s y-axis (which was the same as the target plane’s normal) must be perpendicular to the world’s z-axis. This would mean that the plane was vertical and, as the knife cuts vertically, could be reached by the knife (as long as it was within the angle range it could reach).</p><p>This was framed mathematically as<disp-formula id="equ6"><mml:math id="m6"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Fy</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf76"><mml:mi mathvariant="bold-italic">F</mml:mi></mml:math></inline-formula> is the forward kinematics equation defined above, <inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the y vector <inline-formula><mml:math id="inf78"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mstyle scriptlevel="1"><mml:mtable rowspacing=".2em" columnspacing="0.333em" displaystyle="false"><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mstyle><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="italic">z</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the z vector <inline-formula><mml:math id="inf80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mstyle scriptlevel="1"><mml:mtable rowspacing=".2em" columnspacing="0.333em" displaystyle="false"><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mstyle><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, and · denotes the dot product. <inline-formula><mml:math id="inf81"><mml:mi mathvariant="bold-italic">Fy</mml:mi></mml:math></inline-formula> gave the vector for the target plane y-axis in terms of the World coordinate frame. Constraining this so its dot product with the world z-axis must be 0 meant it must be perpendicular to world z, that is, the plane must be vertical.</p><p>Using the SymPy (<xref ref-type="bibr" rid="bib18">Meurer et al., 2017</xref>) Python package to help with rearrangement gave<disp-formula id="equ7"><mml:math id="m7"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>As <inline-formula><mml:math id="inf82"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf83"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf84"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf85"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> were constants for a particular targeting run, we could replace these with the A–I constants defined above to make the expression easier to work with:<disp-formula id="equ8"><mml:math id="m8"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></disp-formula><disp-formula id="equ9"><mml:math id="m9"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ10"><mml:math id="m10"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ11"><mml:math id="m11"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>tan</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:mfrac><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mi>E</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:mfrac><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>This meant that the final solution for the sample tilt was<disp-formula id="equ12"><label>(2)</label><mml:math id="m12"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>arctan</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:mfrac><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mi>E</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:mfrac><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>This solution could of course be simplified further by combining these constants together to give something of the form<disp-formula id="equ13"><mml:math id="m13"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>arctan</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>In practice, we used the form with constants A–I as this allowed the same constants to be used for this and the knife solution below.</p><p>The script for the SymPy parts is available in the Crosshair GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/automated-ultramicrotomy/crosshair/blob/master/python_scripts/multiple_solutions.py">https://github.com/automated-ultramicrotomy/crosshair/blob/master/python_scripts/multiple_solutions.py</ext-link>.</p></sec><sec id="s4-6"><title>Knife tilt solution</title><p>Now we had to find the knife angle that corresponded to a particular sample rotation. For this, we needed the signed angle between global y (i.e. ultramicrotome NS) and local y (the target plane’s normal) in the z plane (i.e. the plane with the global z-axis as its normal). This was because the knife could only rotate about the z-axis, so we only needed the angle within this plane.</p><p>This was equal to<disp-formula id="equ14"><mml:math id="m14"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>arctan</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="italic">F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mrow><mml:mi mathvariant="italic">z</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow><mml:mo>⋅</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="italic">F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf86"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the y vector <inline-formula><mml:math id="inf87"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mstyle scriptlevel="1"><mml:mtable rowspacing=".2em" columnspacing="0.333em" displaystyle="false"><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mstyle><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="italic">z</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the z vector <inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mstyle scriptlevel="1"><mml:mtable rowspacing=".2em" columnspacing="0.333em" displaystyle="false"><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mstyle><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, · denotes the dot product, × denotes the cross-product, and <inline-formula><mml:math id="inf90"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="italic">F</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the matrix from the forward kinematics equation defined in <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>.</p><p>Using SymPy (<xref ref-type="bibr" rid="bib18">Meurer et al., 2017</xref>) to help with rearrangement, and substitution of the same constants A–I from above, this became<disp-formula id="equ15"><mml:math id="m15"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>arctan</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>E</mml:mi><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>−</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>−</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>This equation gives the corresponding signed knife angle for all values of <inline-formula><mml:math id="inf91"><mml:msub><mml:mi>θ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf92"><mml:msub><mml:mi>θ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula>, but we only wanted the values that are valid given the solution calculated above for the sample tilt. That is, we only wanted knife angles where the target plane was vertical, and therefore reachable by the knife. Therefore, we substituted in the solution from above (<xref ref-type="disp-formula" rid="equ1">Equation 2</xref>) for <inline-formula><mml:math id="inf93"><mml:msub><mml:mi>θ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></inline-formula>.</p><p>This gave (with some rearrangement/simplification with SymPy)<disp-formula id="equ16"><label>(3)</label><mml:math id="m16"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>arctan</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mi>A</mml:mi><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:mi>H</mml:mi><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mi>E</mml:mi><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>−</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mroot><mml:mrow><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mi>A</mml:mi><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:mi>H</mml:mi><mml:msup><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mi>E</mml:mi><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mroot><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>A</mml:mi><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:mi>H</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>This solution could of course be simplified further by combining these constants together to give something of the form<disp-formula id="equ17"><mml:math id="m17"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>arctan</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mroot><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mroot><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>In practice, we used the form with constants A–I in the Crosshair code.</p><p>Therefore, with <xref ref-type="disp-formula" rid="equ1">Equation 2</xref> and <xref ref-type="disp-formula" rid="equ1">Equation 3</xref>, we could find the corresponding sample tilt and knife tilt for any given sample rotation.</p><p>The script for the SymPy parts is available in the Crosshair GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/automated-ultramicrotomy/crosshair/blob/master/python_scripts/multiple_solutions.py">https://github.com/automated-ultramicrotomy/crosshair/blob/master/python_scripts/multiple_solutions.py</ext-link> (<xref ref-type="bibr" rid="bib16">Meechan, 2022b</xref>).</p></sec><sec id="s4-7"><title>Distance calculation</title><p>Once the orientation was solved, we calculated the distance to cut from the sample to reach the target plane. As the cutting direction (NS) may not have been parallel to the target plane normal, this had to be done in two steps. First, the perpendicular distance was calculated from the target plane to the furthest point of the block face, then this was compensated for the offset between this and NS.</p><p>When the orientation was solved, we knew that the target plane must be vertical. Therefore, to find the NS distance we only needed to compensate for the current knife angle (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>).</p><p>This meant that the distance was<disp-formula id="equ18"><mml:math id="m18"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf94"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the NS distance, <inline-formula><mml:math id="inf95"><mml:msub><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math></inline-formula> is the perpendicular distance between the target plane and the furthest surface point, and <inline-formula><mml:math id="inf96"><mml:msub><mml:mi>θ</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:math></inline-formula> is the knife angle.</p></sec><sec id="s4-8"><title>Crosshair</title><p>Crosshair is a Fiji (<xref ref-type="bibr" rid="bib24">Schindelin et al., 2012</xref>) plugin written in Java and is freely available from the following GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/automated-ultramicrotomy/crosshair">https://github.com/automated-ultramicrotomy/crosshair</ext-link>; <xref ref-type="bibr" rid="bib16">Meechan, 2022b</xref>. A user guide is also available (<ext-link ext-link-type="uri" xlink:href="https://github.com/automated-ultramicrotomy/crosshair/wiki">https://github.com/automated-ultramicrotomy/crosshair/wiki</ext-link>; <xref ref-type="bibr" rid="bib16">Meechan, 2022b</xref>), along with a video tutorial of the entire workflow demonstrated on the Leica system (<ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=OM712ECthGg">https://www.youtube.com/watch?v=OM712ECthGg</ext-link>). It can also be easily installed via a Fiji update site (instructions in the GitHub repository).</p><p>It builds on top of BigDataViewer (<xref ref-type="bibr" rid="bib21">Pietzsch et al., 2015</xref>) for viewing images in 2D, and the ImageJ 3D Viewer (<xref ref-type="bibr" rid="bib25">Schmid et al., 2010</xref>) for viewing images in 3D. It also builds on a number of functions from Christian Tischer’s imagej-utils repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/embl-cba/imagej-utils">https://github.com/embl-cba/imagej-utils</ext-link>; <xref ref-type="bibr" rid="bib29">Tischer et al., 2022a</xref>).</p></sec><sec id="s4-9"><title>RegistrationTree</title><p>RegistrationTree is a Fiji (<xref ref-type="bibr" rid="bib24">Schindelin et al., 2012</xref>) plugin written in Java and is freely available from the following GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/K-Meech/RegistrationTree">https://github.com/K-Meech/RegistrationTree</ext-link>; <xref ref-type="bibr" rid="bib17">Meechan, 2022c</xref>. A user guide is also available (<ext-link ext-link-type="uri" xlink:href="https://github.com/K-Meech/RegistrationTree/wiki">https://github.com/K-Meech/RegistrationTree/wiki</ext-link>; <xref ref-type="bibr" rid="bib17">Meechan, 2022c</xref>). It can be easily installed via a Fiji update site (instructions in the GitHub repository).</p><p>RegistrationTree is a wrapper around BigWarp (<xref ref-type="bibr" rid="bib2">Bogovic et al., 2016</xref>) and elastix (<xref ref-type="bibr" rid="bib12">Klein et al., 2010</xref>; <xref ref-type="bibr" rid="bib26">Shamonin et al., 2013</xref>) registration software. It allows easy passing of images between the two software tools, as well as easing the integration of large images with elastix. Users can build arbitrary trees of affine transformations to register their images together and visualise/compare these easily. RegistrationTree uses BigDataViewer (<xref ref-type="bibr" rid="bib21">Pietzsch et al., 2015</xref>) for 2D visualisation, and BigDataViewer style file formats (HDF5 and N5) to allow very large images to be viewed efficiently on a normal laptop. It builds on top of Christian Tischer’s elastixWrapper (<xref ref-type="bibr" rid="bib28">Tischer, 2019</xref>, <ext-link ext-link-type="uri" xlink:href="https://github.com/embl-cba/elastixWrapper">https://github.com/embl-cba/elastixWrapper</ext-link>) and imagej-utils repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/embl-cba/imagej-utils">https://github.com/embl-cba/imagej-utils</ext-link>; <xref ref-type="bibr" rid="bib29">Tischer et al., 2022a</xref>). Also, the open-source repositories for image-transform-converters (<ext-link ext-link-type="uri" xlink:href="https://github.com/image-transform-converters/image-transform-converters">https://github.com/image-transform-converters/image-transform-converters</ext-link>; <xref ref-type="bibr" rid="bib30">Tischer et al., 2022b</xref>) and bigdataviewer-playground (<ext-link ext-link-type="uri" xlink:href="https://github.com/bigdataviewer/bigdataviewer-playground">https://github.com/bigdataviewer/bigdataviewer-playground</ext-link>; <xref ref-type="bibr" rid="bib6">Chiaruttini et al., 2022</xref>).</p></sec><sec id="s4-10"><title>Targeting workflow</title><p>The targeting workflow is summarised in <xref ref-type="fig" rid="fig4">Figure 4</xref>. We expand on those steps in detail here in the form of a step-by-step protocol. They are also described in detail in the Crosshair user guide (<ext-link ext-link-type="uri" xlink:href="https://github.com/automated-ultramicrotomy/crosshair/wiki">https://github.com/automated-ultramicrotomy/crosshair/wiki</ext-link>; <xref ref-type="bibr" rid="bib16">Meechan, 2022b</xref>) and in a video tutorial demonstrated on the Leica system (<ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=OM712ECthGg">https://www.youtube.com/watch?v=OM712ECthGg</ext-link>). Note that there are some differences between the motorised Leica and RMC systems that are highlighted throughout the workflow.</p><sec id="s4-10-1"><title>Trim block</title><p>Trim the block at the ultramicrotome with a diamond knife. A flat surface must be made that has four corners and straight lines in between. Make sure the sides of the block face are trimmed deep enough, so the knife will always touch part of this face first, and not other parts of the block (even if the solution requires a more extreme set of angles). We usually trim about 40–100 microns, depending on the sample.</p><p>Ideally, the block surface should be within one ultramicrotome feed length of the target for the greatest accuracy (i.e. 200 microns or less for both the Leica and RMC systems). Every time the cutting feed is reset, the approach of the knife to the block must be repeated, and some accuracy will be lost. If necessary, the distance can be greater though; for example, samples h–j in this study had cutting depths greater than one feed length (requiring one reset mid-run), and their accuracy was not greatly affected (see <xref ref-type="fig" rid="fig6">Figure 6</xref>).</p><p>Note that there are a number of different ways to mount the sample for trimming and later X-ray imaging. For example, see the different solutions we used in the section ‘Initial sample trimming and mounting’.</p></sec><sec id="s4-10-2"><title>X-ray</title><p>Convert the X-ray image to 8-bit (if it is not already), for example, in Fiji with Image – Type – 8-bit. The image can also be cropped at this stage if there is a lot of empty area outside the resin block. Open the X-ray in Crosshair and compare the 3D view/image stack and the sample. If it appears as a mirror image of the sample, then flip the image stack. This can be done, for example, in Fiji with Image – Transform – Flip Vertically, or Image – Transform – Flip Z.</p></sec><sec id="s4-10-3"><title>Define block + target plane</title><p>Open the X-ray image in Crosshair and set the block and target planes. The target plane can be set using the ‘TRACK’ button and navigating in the 2D viewer. The block face can be set by placing a series of points on the block surface and fitting a plane to them.</p></sec><sec id="s4-10-4"><title>Define block vertices + orientation</title><p>Place one point (vertex) on each of the four corners of the block face. Then, decide on the orientation the block will have in the ultramicrotome, that is, which side of the block will face up? Mark the points accordingly as ‘Top Left’, ‘Top Right’, ‘Bottom Left’, and ‘Bottom Right’ in Crosshair.</p><p>Once this is complete, it is good practice to ‘Save Settings’ in Crosshair to make a .json file as a record of the planes and points.</p></sec><sec id="s4-10-5"><title>Set sample tilt 0</title><p>Set the sample tilt to zero by eye (just by looking at the scale on the arc piece and trying to get it as close to zero as possible). For the Leica system, press ‘Set Zero’ in the ‘sample tilt’ page of the ultramicrotome user interface. For the RMC system, make a note of the current sample tilt angle.</p></sec><sec id="s4-10-6"><title>Set knife tilt 0</title><p>For the knife zero, there is a slightly more complicated procedure than for the sample tilt. We assumed that since the knife is removed and replaced every time, there may be more variation in its position and therefore an extra step may be required to accurately find its proper zero.</p><p>Put a blank block into the ultramicrotome sample holder (i.e. just resin with no sample). Set the knife tilt to zero by eye (just by looking at the scale on the knife holder and trying to get it as close to zero as possible). Cut into the blank block at this orientation to make a flat face. Back the knife away and rotate the sample holder exactly 90° (using the motorised ultramicrotome controls). Align the knife to this face again (only adjusting the knife tilt!). For the Leica system, press ‘Set Zero’ in the ‘knife tilt’ page of the ultramicrotome user interface. For the RMC system, make a note of the current knife tilt angle.</p></sec><sec id="s4-10-7"><title>Align knife and block face</title><p>Replace the blank block with the resin-embedded sample. Make sure it is placed the same way up as indicated in Crosshair.</p><p>Align the knife and block face, ensuring the bottom edge of the block is also aligned along the cutting edge of the knife. Any axis can be freely changed for this step, just as in normal ultramicrotome usage. For the Leica system, the motors can be disabled for this step, and the alignment done manually as with normal ultramicrotome usage. For the RMC system, the motors cannot be disabled, and the motors must be used for this alignment.</p></sec><sec id="s4-10-8"><title>Set sample rotation 0</title><p>For the Leica system, set the sample rotation to zero by pressing ‘Set Zero’ in the ‘sample rotation’ page of the ultramicrotome user interface. For the RMC system, make a note of the current sample rotation angle.</p></sec><sec id="s4-10-9"><title>Enter <italic>θ</italic><sub><italic>IK</italic></sub> and <italic>θ</italic><sub><italic>IT</italic></sub></title><p>Enter the current knife angle and sample tilt angle into Crosshair. For the RMC system, make sure you adjust for the recorded ‘zero’ position, for example, if the current angle is 10°, and the zero was 2°, then you would enter 8° into Crosshair.</p></sec><sec id="s4-10-10"><title>Choose solution</title><p>Use the Crosshair ‘Microtome Mode’ to cycle through all the possible solutions, and choose one to use. The target plane will turn red in the 3D view when there is a valid solution.</p><p>Once this is complete, it is good practice to ‘Save Solution’ in Crosshair to make a .json file as a record of the solution.</p></sec><sec id="s4-10-11"><title>Set solution angles</title><p>Back the knife away from the block to ensure there is no risk of hitting it. Using the motors, move each axis to the angles stated in the solution from Crosshair. For the RMC system, make sure you adjust for the recorded ‘zero’ position of each axis, for example, if the solution angle is 10°, and the zero was 2°, then you would move the ultramicrotome to 12° for that axis.</p></sec><sec id="s4-10-12"><title>Approach block surface + cut solution distance</title><p>Manually approach the block and get as close as possible to its surface. Any error in this distance (i.e. starting before touching the block, or once it has already been cut into) will contribute to the final error. A good solution is to get as close as possible with the ultramicrotome’s NS movement, then set the cutting thickness to some small value (e.g. 70–100 nm). Then cutting can be started slowly, carefully watching the knife edge through the ultramicrotome’s binocular at high magnification, and stopped as soon as any debris is visible on the knife/any pieces being cut from the block. This ensures the knife is as close as possible to the true surface.</p><p>Once complete, cut the distance specified in the Crosshair solution.</p></sec></sec><sec id="s4-11"><title><italic>Platynereis</italic> sample preparation</title><p><italic>Platynereis</italic> were prepared with a modification of the method from <xref ref-type="bibr" rid="bib8">Hua et al., 2015</xref>, aided by microwave processing (see details in <xref ref-type="table" rid="table3">Table 3</xref>). <italic>Platynereis</italic> were flat embedded in thin pieces of resin.</p><table-wrap id="table3" position="float"><label>Table 3.</label><caption><title>Table of <italic>Platynereis</italic> preparation steps.</title></caption><table frame="hsides" rules="groups"><thead><tr><th valign="bottom" rowspan="1">Step no.</th><th valign="bottom" rowspan="1">Step</th><th valign="bottom" rowspan="1">Time</th><th rowspan="1" valign="bottom">Temperature</th><th valign="bottom" rowspan="1">Microwave (W)</th><th valign="bottom" rowspan="1">Vacuum</th></tr></thead><tbody><tr><td align="char" char="." valign="bottom">1</td><td align="left" valign="bottom">2% paraformaldehyde, 2.5% glutaraldehyde in seawater</td><td align="char" char="." valign="bottom">2 min</td><td align="left" valign="bottom">21°C</td><td align="char" char="." valign="bottom">100</td><td align="left" valign="bottom">On</td></tr><tr><td align="char" char="." valign="bottom">2</td><td align="left" valign="bottom">2% paraformaldehyde, 2.5% glutaraldehyde in 0.1 M cacodylate</td><td align="left" valign="bottom">2 × 14 min (2 min on/off cycles)</td><td align="left" valign="bottom">21°C</td><td align="char" char="." valign="bottom">100</td><td align="left" valign="bottom">On</td></tr><tr><td align="char" char="." valign="bottom">3</td><td align="left" valign="bottom">0.1 M cacodylate</td><td align="left" valign="bottom">1 immediate<break/>Then 2 × 40 s.</td><td align="left" valign="bottom">21°C</td><td align="char" char="." valign="bottom">100</td><td align="left" valign="bottom">On</td></tr><tr><td align="char" char="." valign="bottom">4</td><td align="left" valign="bottom">2% OsO<sub>4</sub> in 0.1 M cacodylate</td><td align="left" valign="bottom">2 × 14 min (2 min on/off cycles)</td><td align="left" valign="bottom">21°C</td><td align="char" char="." valign="bottom">100</td><td align="left" valign="bottom">On</td></tr><tr><td align="char" char="." valign="bottom">5</td><td align="left" valign="bottom">2.5% K<sub>4</sub>[Fe(CN)<sub>6</sub>].3H<sub>2</sub>O in 0.1 M cacodylate</td><td align="left" valign="bottom">2 × 14 min (2 min on/off cycles)</td><td align="left" valign="bottom">21°C</td><td align="char" char="." valign="bottom">100</td><td align="left" valign="bottom">On</td></tr><tr><td align="char" char="." valign="bottom">6</td><td align="left" valign="bottom">Water wash</td><td align="left" valign="bottom">1 immediate<break/>Then 2 × 40 s</td><td align="left" valign="bottom">21°C</td><td align="char" char="." valign="bottom">100</td><td align="left" valign="bottom">On</td></tr><tr><td align="char" char="." valign="bottom">7</td><td align="left" valign="bottom">1% TCH unbuffered</td><td align="left" valign="bottom">2 × 14 min (2 min on/off cycles)</td><td align="left" valign="bottom">40°C</td><td align="char" char="." valign="bottom">100</td><td align="left" valign="bottom">On</td></tr><tr><td align="char" char="." valign="bottom">8</td><td align="left" valign="bottom">Water wash</td><td align="left" valign="bottom">1 immediate<break/>Then 2 × 40 s</td><td align="left" valign="bottom">40°C</td><td align="char" char="." valign="bottom">100</td><td align="left" valign="bottom">On</td></tr><tr><td align="char" char="." valign="bottom">9</td><td align="char" char="." valign="bottom">2% OsO<sub>4</sub> aqueous</td><td align="left" valign="bottom">2 × 14 min (2 min on/off cycles)</td><td align="left" valign="bottom">21°C</td><td align="char" char="." valign="bottom">100</td><td align="left" valign="bottom">On</td></tr><tr><td align="char" char="." valign="bottom">10</td><td align="left" valign="bottom">Water wash</td><td align="left" valign="bottom">1 immediate<break/>Then 2 × 40 s</td><td align="left" valign="bottom">21°C</td><td align="char" char="." valign="bottom">100</td><td align="left" valign="bottom">On</td></tr><tr><td align="char" char="." valign="bottom">11</td><td align="left" valign="bottom">Dehydration series in ethanol (25%, 50%, 75%, 3 × 100%)</td><td align="left" valign="bottom">40 s each</td><td align="left" valign="bottom">10°C</td><td align="char" char="." valign="bottom">250</td><td align="left" valign="bottom">Off</td></tr><tr><td align="char" char="." valign="bottom">12</td><td align="left" valign="bottom">Infiltration series in Durcupan (25%, 50%, 75%, 90%, 3 × 100%)</td><td align="char" char="." valign="bottom">3 min each</td><td align="left" valign="bottom">21°C</td><td align="char" char="." valign="bottom">150</td><td align="left" valign="bottom">On</td></tr><tr><td align="char" char="." valign="bottom">13</td><td align="char" char="." valign="bottom">100% Durcupan</td><td align="left" valign="bottom">Overnight</td><td align="left" valign="bottom">21°C</td><td align="left" valign="bottom">N/A</td><td align="left" valign="bottom">N/A</td></tr><tr><td align="char" char="." valign="bottom">14</td><td align="left" valign="bottom">Polymerisation in oven</td><td align="char" char="." valign="bottom">48 hr</td><td align="left" valign="bottom">60°C</td><td align="left" valign="bottom">N/A</td><td align="left" valign="bottom">N/A</td></tr></tbody></table></table-wrap></sec><sec id="s4-12"><title>Accuracy tests</title><sec id="s4-12-1"><title>Initial sample trimming and mounting</title><p>Samples were prepared as specified in the section <italic>‘Platynereis</italic> sample preparation’. Individual <italic>Platynereis</italic> were then cut out in small pieces of resin with a razor blade.</p><p>For samples a–e, these pieces were glued to larger resin blocks to make them easier to handle in the ultramicrotome. These blocks were then inserted into standard Leica sample holders and mounted to the ultramicrotome for trimming.</p><p>For samples f–j, the small pieces of resin containing <italic>Platynereis</italic> were mounted onto aluminium pins using conductive epoxy glue (ITW Chemtronics). The pin was then inserted into a Gatan 3View Rivet Holder (Gatan 3VRHBM) and mounted to the ultramicrotome (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2A, B</xref>) for trimming.</p><p>Blocks were trimmed close to the <italic>Platynereis</italic> with a diamond knife, so the block surface for most samples was less than one feed length (200 microns) from the target. A flat surface was trimmed with a rectangular shape as required for Crosshair. Note that samples h–j had cutting distances greater than one feed length, but their accuracy was not greatly affected (see <xref ref-type="fig" rid="fig6">Figure 6</xref>).</p></sec><sec id="s4-12-2"><title>X-ray imaging</title><p>Samples a–e were imaged with a Bruker SkyScan 1272, with an isotropic voxel size of 1 micron. The resin blocks were mounted onto small pins with wax for the X-ray, and then removed from these pins for all further steps at the ultramicrotome. The log files with the specific settings for each sample are provided on EMPIAR alongside the images (<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/empiar/EMPIAR-11055/">https://www.ebi.ac.uk/empiar/EMPIAR-11055/</ext-link>). Imaging each sample took 2 hr to complete. Fiji was then used to convert the X-ray images to 8-bit, flip them vertically (Image – Transform – Flip Vertically), and crop to remove empty areas outside the resin block.</p><p>Samples f–j were imaged with a Versa 510 X-ray microscope (Zeiss). Aluminium pins were mounted to a Versa 510 sample holder (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2C</xref>) and imaged at a voltage of 40 kV, power of 3 W. No filter was used, and images were acquired at a binning of 2 with an exposure time of 10 s. Pixel size was chosen to be as close to 1 micron as possible (actual reading varied between 0.9999 and 1.0001 microns for different runs). The field of view thus varied between 1014.9 and 1015.1 microns<sup>2</sup>. A total of 1601 projections were captured over the 360° tilt range. Imaging each sample took 5 hr and 30 min to complete. Fiji was then used to convert the X-ray images to 8-bit, adjust their brightness and contrast, flip vertically (Image – Transform – Flip Vertically), and finally reverse the image stack (Image – Stacks – Tools – Stack Sorter – Reverse).</p><p>For all samples, raw and reconstructed X-ray images are available (before and after targeting), as well as the X-ray images used for Crosshair (i.e. after any flipping, cropping, etc., was done) (<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/empiar/EMPIAR-11055/">https://www.ebi.ac.uk/empiar/EMPIAR-11055/</ext-link>).</p></sec><sec id="s4-12-3"><title>Crosshair and targeting</title><p>The X-ray images were then processed with Crosshair. The block face plane was set by fitting to a series of points placed on the surface. The target plane was set by browsing in 2D to find a plane that cut through both anterior dorsal cirrus that protrude from either side of the <italic>Platynereis</italic> head. The remaining targeting steps were completed as specified in the workflow in the section ‘Targeting workflow’. For samples a–e, all steps were completed using a standard Leica sample holder. For samples f–j, a Gatan 3View Rivet Holder was used (as specified in the section ‘Initial sample trimming and mounting’).</p><p>All Crosshair settings and solution files are available on BioStudies (<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/biostudies/studies/S-BSST845">https://www.ebi.ac.uk/biostudies/studies/S-BSST845</ext-link>).</p></sec><sec id="s4-12-4"><title>Registration</title><p>After targeting, the samples were imaged with X-ray again as described in the section ‘X-ray imaging’. The before and after X-ray images were then registered using our RegistrationTree plugin (see section ‘RegistrationTree’). For this, the before scan (moving image) was registered to the after scan (fixed image). This used two registration steps: first, a rough point-based registration with BigWarp (<xref ref-type="bibr" rid="bib2">Bogovic et al., 2016</xref>), followed by an intensity-based registration with elastix (<xref ref-type="bibr" rid="bib12">Klein et al., 2010</xref>; <xref ref-type="bibr" rid="bib26">Shamonin et al., 2013</xref>). Both steps were limited to rotation and translation only. Once complete, this was exported from RegistrationTree as a BigDataViewer xml file containing the required transform in the ‘MOVING’ space, that is, so it transformed the after scan onto the before scan.</p><p>For some of our X-ray images, we saw slight variation in the before and after scans of the same sample (particularly with the Bruker system). We therefore also calculated an approximate error in the accuracy of our registration. This was done by manually labelling four corresponding points in each registered pair of X-ray images for all samples. For example, the tips of the <italic>Platynereis</italic> parapodia (appendages used for swimming and crawling). These were placed using BigWarp’s features for point placement, and then exported to csv files. The Euclidean distance between each pair of points was then calculated for <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>. This gave a mean error of 1.9 microns (for the points labelled repeat 1). As there was also some error due to manual placement of these points, we repeated the process twice for the same locations and images (repeats 1 and 2 in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1A</xref>). The mean difference between these repeats was 1.1 microns. As the average difference between repeats was less than the error we measured, it implies that this likely comes from error in the registration, rather than inaccuracy of the manual point placement. As they are of a similar size though, it does emphasise the difficulty of accurately measuring these small distances, given that the voxel size of our micro-CT was only 1 micron.</p><p>For all samples, the RegistrationTree and registration accuracy files are available on BioStudies (<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/biostudies/studies/S-BSST845">https://www.ebi.ac.uk/biostudies/studies/S-BSST845</ext-link>).</p></sec><sec id="s4-12-5"><title>Accuracy measures</title><p>Accuracy measures were calculated using features built-in to the Crosshair Fiji plugin (‘Measure Targeting Accuracy’ command). This takes the before X-ray image, the registered after X-ray image and the Crosshair settings and solution files, and allows user-friendly calculation of accuracy measures. A plane was fitted to the after scan’s block surface by manually placing a series of points on its surface (same workflow as fitting the planes in usual Crosshair usage). A point was also placed on the before scan’s target plane approximately at the centre of the <italic>Platynereis</italic> cross-section. Then, the ‘Save Measures’ option was used to save a simple .json file containing the measures.</p><p>This included three measures: one for the angle error, one for the solution distance error, and one for the point-to-plane distance error. The angle error was calculated as the absolute angle between the normals of the target plane and the after scan surface. The distance error was more complex to calculate as any planes that are not exactly parallel will intersect at some location (i.e. distance = 0). Therefore, we provided two different measures for this: the solution and point-to-plane distance.</p><p>The solution distance calculated the approximate difference between the solution distance and the distance actually cut (inferred from the Crosshair settings, and after block surface position). It was therefore a measure of how accurately the solution’s distance was cut, rather than a direct measure of how close the final surface was to the target plane. This was calculated by determining the shortest distance between the predicted first touch point (on the original block surface) and the after scan block surface. This was then converted to the NS cutting distance by compensating for the solution knife angle:<disp-formula id="equ19"><mml:math id="m19"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf97"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the NS distance, <inline-formula><mml:math id="inf98"><mml:msub><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math></inline-formula> is the perpendicular distance between the after surface plane and the first touch point, and <inline-formula><mml:math id="inf99"><mml:msub><mml:mi>θ</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:math></inline-formula> is the knife angle from the chosen solution.</p><p>The final distance error was then<disp-formula id="equ20"><mml:math id="m20"><mml:mrow><mml:mi>Error</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf100"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the NS distance, and <inline-formula><mml:math id="inf101"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the distance from the chosen solution. A positive error indicates that the sample was trimmed too far, while a negative error indicates it was not trimmed enough.</p><p>Note that these calculations assumed that cutting started from the predicted point. If the angle was so far off that cutting started from another point, this measure would be erroneous. This is something that was checked at the start of each run though by examining the block and checking that the correct vertex was touched first. This calculation also assumed that the knife angle was the same as stated in the solution. If there was any error in the knife angle setting, then this would also affect this accuracy measure.</p><p>To have a more direct measure of how close the final surface was to the target plane, we also provided the point-to-plane distance error. This is calculated as the shortest distance between a point on the before target plane (near to the centre of the region of interest) and the after block surface. Note that therefore this measure will vary depending on where this point was placed within the target plane.</p><p>See the following website for the calculation scripts: <ext-link ext-link-type="uri" xlink:href="https://github.com/automated-ultramicrotomy/crosshair/blob/master/src/main/java/de/embl/schwab/crosshair/targetingaccuracy/AccuracyCalculator.java">https://github.com/automated-ultramicrotomy/crosshair/blob/master/src/main/java/de/embl/schwab/crosshair/targetingaccuracy/AccuracyCalculator.java</ext-link> (<xref ref-type="bibr" rid="bib16">Meechan, 2022b</xref>). For all samples, all accuracy settings and accuracy measures files are available on BioStudies (<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/biostudies/studies/S-BSST845">https://www.ebi.ac.uk/biostudies/studies/S-BSST845</ext-link>).</p></sec></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Software, Methodology</p></fn><fn fn-type="con" id="con4"><p>Software, Methodology</p></fn><fn fn-type="con" id="con5"><p>Formal analysis, Validation, Investigation, Visualization, Writing – review and editing</p></fn><fn fn-type="con" id="con6"><p>Investigation</p></fn><fn fn-type="con" id="con7"><p>Visualization, Methodology</p></fn><fn fn-type="con" id="con8"><p>Methodology</p></fn><fn fn-type="con" id="con9"><p>Investigation</p></fn><fn fn-type="con" id="con10"><p>Investigation</p></fn><fn fn-type="con" id="con11"><p>Conceptualization, Validation, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con12"><p>Conceptualization, Supervision, Project administration</p></fn><fn fn-type="con" id="con13"><p>Conceptualization, Supervision, Project administration, Writing – review and editing</p></fn><fn fn-type="con" id="con14"><p>Conceptualization, Resources, Formal analysis, Supervision, Funding acquisition, Validation, Investigation, Project administration, Writing – review and editing</p></fn><fn fn-type="con" id="con15"><p>Conceptualization, Resources, Supervision, Funding acquisition, Project administration, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-80899-mdarchecklist1-v1.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>All X-ray images are available on EMPIAR with id 'EMPIAR-11055': <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/empiar/EMPIAR-11055/">https://www.ebi.ac.uk/empiar/EMPIAR-11055/</ext-link>. All files for the accuracy measures tests (Crosshair settings and solutions, accuracy measures, registration metadata, registration accuracy measures) and calibration of the angular rotation of the ultramicrotomes are available on BioStudies with id 'S-BSST845': <ext-link ext-link-type="uri" xlink:href="https://ebi.ac.uk/biostudies/studies/S-BSST845">https://ebi.ac.uk/biostudies/studies/S-BSST845</ext-link>. Diagrams, CAD files and software for the two ultramicrotome systems are available in the following github repositories: <ext-link ext-link-type="uri" xlink:href="https://github.com/automated-ultramicrotomy/embl-system">https://github.com/automated-ultramicrotomy/embl-system</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:31d4b1d34370c587a5e353135c714855a24f397f;origin=https://github.com/automated-ultramicrotomy/embl-system;visit=swh:1:snp:d6a85d9038a16c3c782fd29d438053e7cca240da;anchor=swh:1:rev:78471b53c3dc8b4f6d6fac357171c42cf5af8134">swh:1:rev:78471b53c3dc8b4f6d6fac357171c42cf5af8134</ext-link>) and <ext-link ext-link-type="uri" xlink:href="https://github.com/automated-ultramicrotomy/crick-system">https://github.com/automated-ultramicrotomy/crick-system</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:e20f435436a27bd59766f25fd8ccac782ec4e169;origin=https://github.com/automated-ultramicrotomy/crick-system;visit=swh:1:snp:b8833d0da174effb19994054d179ea5e1394cc99;anchor=swh:1:rev:d7f91bf6dba69cfa823f8ebcef96da907d769a0e">swh:1:rev:d7f91bf6dba69cfa823f8ebcef96da907d769a0e</ext-link>). The Crosshair Fiji plugin is available with tutorials and documentation at the following github repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/automated-ultramicrotomy/crosshair">https://github.com/automated-ultramicrotomy/crosshair</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:814312f3fdddefe878f5dc4c1c4deca58544075a;origin=https://github.com/automated-ultramicrotomy/crosshair;visit=swh:1:snp:94dad522240c369d40c2cee75eb33ebe47be940a;anchor=swh:1:rev:43291bc07467612e4561e402e623a9fad5ae77bc">swh:1:rev:43291bc07467612e4561e402e623a9fad5ae77bc</ext-link>), along with a video tutorial on YouTube for the Leica system: <ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=OM712ECthGg">https://www.youtube.com/watch?v=OM712ECthGg</ext-link>.</p><p>The following datasets were generated:</p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset1"><person-group person-group-type="author"><name><surname>Meechan</surname><given-names>K</given-names></name><name><surname>Guan</surname><given-names>W</given-names></name><name><surname>Riedinger</surname><given-names>A</given-names></name><name><surname>Stankova</surname><given-names>V</given-names></name><name><surname>Yoshimura</surname><given-names>A</given-names></name><name><surname>Pipitone</surname><given-names>R</given-names></name><name><surname>Milberger</surname><given-names>A</given-names></name><name><surname>Schaar</surname><given-names>H</given-names></name><name><surname>Romero-Brey</surname><given-names>I</given-names></name><name><surname>Templin</surname><given-names>R</given-names></name><name><surname>Peddie</surname><given-names>CJ</given-names></name><name><surname>Schieber</surname><given-names>NL</given-names></name><name><surname>Jones</surname><given-names>ML</given-names></name><name><surname>Collinson</surname><given-names>L</given-names></name><name><surname>Schwab</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>X-ray images</data-title><source>EMPIAR</source><pub-id pub-id-type="accession" xlink:href="https://www.ebi.ac.uk/empiar/EMPIAR-11055/">EMPIAR-11055</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset2"><person-group person-group-type="author"><name><surname>Meechan</surname><given-names>K</given-names></name><name><surname>Guan</surname><given-names>W</given-names></name><name><surname>Riedinger</surname><given-names>A</given-names></name><name><surname>Stankova</surname><given-names>V</given-names></name><name><surname>Yoshimura</surname><given-names>A</given-names></name><name><surname>Pipitone</surname><given-names>R</given-names></name><name><surname>Milberger</surname><given-names>A</given-names></name><name><surname>Schaar</surname><given-names>H</given-names></name><name><surname>Romero-Brey</surname><given-names>I</given-names></name><name><surname>Templin</surname><given-names>R</given-names></name><name><surname>Peddie</surname><given-names>CJ</given-names></name><name><surname>Schieber</surname><given-names>NL</given-names></name><name><surname>Jones</surname><given-names>ML</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Files for accuracy measures and ultramicrotome calibration</data-title><source>BioStudies</source><pub-id pub-id-type="accession" xlink:href="https://www.ebi.ac.uk/biostudies/studies/S-BSST845">S-BSST845</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank the Electron Microscopy Core Facility (EMBL) for access to the instrumentation for electron microscopy and the Arendt lab (EMBL Heidelberg) for providing the <italic>Platynereis dumerilii</italic> samples. We also thank Christian Tischer (Centre for Bioimage Analysis, EMBL Heidelberg) for his help with creating the Fiji plugins, and the Mechanical Workshop at The Francis Crick Institute for their mechanical expertise and practical assistance during the development.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baena</surname><given-names>V</given-names></name><name><surname>Schalek</surname><given-names>RL</given-names></name><name><surname>Lichtman</surname><given-names>JW</given-names></name><name><surname>Terasaki</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Serial-section electron microscopy using automated tape-collecting ultramicrotome (ATUM)</article-title><source>Methods in Cell Biology</source><volume>152</volume><fpage>41</fpage><lpage>67</lpage><pub-id pub-id-type="doi">10.1016/bs.mcb.2019.04.004</pub-id><pub-id pub-id-type="pmid">31326026</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Bogovic</surname><given-names>JA</given-names></name><name><surname>Hanslovsky</surname><given-names>P</given-names></name><name><surname>Wong</surname><given-names>A</given-names></name><name><surname>Saalfeld</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Robust registration of calcium images by learned contrast synthesis</article-title><conf-name>2016 IEEE 13th International Symposium on Biomedical Imaging (ISBI 2016</conf-name><conf-loc>Prague, Czech Republic</conf-loc><fpage>1123</fpage><lpage>1126</lpage><pub-id pub-id-type="doi">10.1109/ISBI.2016.7493463</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bosch</surname><given-names>C</given-names></name><name><surname>Ackels</surname><given-names>T</given-names></name><name><surname>Pacureanu</surname><given-names>A</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Peddie</surname><given-names>CJ</given-names></name><name><surname>Berning</surname><given-names>M</given-names></name><name><surname>Rzepka</surname><given-names>N</given-names></name><name><surname>Zdora</surname><given-names>MC</given-names></name><name><surname>Whiteley</surname><given-names>I</given-names></name><name><surname>Storm</surname><given-names>M</given-names></name><name><surname>Bonnin</surname><given-names>A</given-names></name><name><surname>Rau</surname><given-names>C</given-names></name><name><surname>Margrie</surname><given-names>T</given-names></name><name><surname>Collinson</surname><given-names>L</given-names></name><name><surname>Schaefer</surname><given-names>AT</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Functional and multiscale 3D structural investigation of brain tissue through correlative in vivo physiology, synchrotron micro-tomography and volume electron microscopy</article-title><source>Nature Communications</source><volume>13</volume><elocation-id>2923</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-022-30199-6</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brama</surname><given-names>E</given-names></name><name><surname>Peddie</surname><given-names>CJ</given-names></name><name><surname>Wilkes</surname><given-names>G</given-names></name><name><surname>Gu</surname><given-names>Y</given-names></name><name><surname>Collinson</surname><given-names>LM</given-names></name><name><surname>Jones</surname><given-names>ML</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>UltraLM and minilm: locator tools for smart tracking of fluorescent cells in correlative light and electron microscopy</article-title><source>Wellcome Open Research</source><volume>1</volume><elocation-id>26</elocation-id><pub-id pub-id-type="doi">10.12688/wellcomeopenres.10299.1</pub-id><pub-id pub-id-type="pmid">28090593</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bushong</surname><given-names>EA</given-names></name><name><surname>Johnson</surname><given-names>DD</given-names></name><name><surname>Kim</surname><given-names>KY</given-names></name><name><surname>Terada</surname><given-names>M</given-names></name><name><surname>Hatori</surname><given-names>M</given-names></name><name><surname>Peltier</surname><given-names>ST</given-names></name><name><surname>Panda</surname><given-names>S</given-names></name><name><surname>Merkle</surname><given-names>A</given-names></name><name><surname>Ellisman</surname><given-names>MH</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>X-ray microscopy as an approach to increasing accuracy and efficiency of serial block-face imaging for correlated light and electron microscopy of biological specimens</article-title><source>Microscopy and Microanalysis</source><volume>21</volume><fpage>231</fpage><lpage>238</lpage><pub-id pub-id-type="doi">10.1017/S1431927614013579</pub-id><pub-id pub-id-type="pmid">25392009</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Chiaruttini</surname><given-names>N</given-names></name><name><surname>Tischer</surname><given-names>C</given-names></name><name><surname>Haase</surname><given-names>R</given-names></name><name><surname>Pietzsch</surname><given-names>T</given-names></name><name><surname>Rueden</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Bigdataviewer-playground</data-title><version designator="0.3.13">0.3.13</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/bigdataviewer/bigdataviewer-playground">https://github.com/bigdataviewer/bigdataviewer-playground</ext-link></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fischer</surname><given-names>A</given-names></name><name><surname>Dorresteijn</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>The polychaete <italic>Platynereis dumerilii</italic> (annelida): a laboratory animal with spiralian cleavage, lifelong segment proliferation and a mixed benthic/pelagic life cycle</article-title><source>BioEssays</source><volume>26</volume><fpage>314</fpage><lpage>325</lpage><pub-id pub-id-type="doi">10.1002/bies.10409</pub-id><pub-id pub-id-type="pmid">14988933</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hua</surname><given-names>Y</given-names></name><name><surname>Laserstein</surname><given-names>P</given-names></name><name><surname>Helmstaedter</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Large-volume en-bloc staining for electron microscopy-based connectomics</article-title><source>Nature Communications</source><volume>6</volume><fpage>1</fpage><lpage>7</lpage><pub-id pub-id-type="doi">10.1038/ncomms8923</pub-id><pub-id pub-id-type="pmid">26235643</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Crick-system</data-title><version designator="swh:1:rev:d7f91bf6dba69cfa823f8ebcef96da907d769a0e">swh:1:rev:d7f91bf6dba69cfa823f8ebcef96da907d769a0e</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:e20f435436a27bd59766f25fd8ccac782ec4e169;origin=https://github.com/automated-ultramicrotomy/crick-system;visit=swh:1:snp:b8833d0da174effb19994054d179ea5e1394cc99;anchor=swh:1:rev:d7f91bf6dba69cfa823f8ebcef96da907d769a0e">https://archive.softwareheritage.org/swh:1:dir:e20f435436a27bd59766f25fd8ccac782ec4e169;origin=https://github.com/automated-ultramicrotomy/crick-system;visit=swh:1:snp:b8833d0da174effb19994054d179ea5e1394cc99;anchor=swh:1:rev:d7f91bf6dba69cfa823f8ebcef96da907d769a0e</ext-link></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karreman</surname><given-names>MA</given-names></name><name><surname>Mercier</surname><given-names>L</given-names></name><name><surname>Schieber</surname><given-names>NL</given-names></name><name><surname>Solecki</surname><given-names>G</given-names></name><name><surname>Allio</surname><given-names>G</given-names></name><name><surname>Winkler</surname><given-names>F</given-names></name><name><surname>Ruthensteiner</surname><given-names>B</given-names></name><name><surname>Goetz</surname><given-names>JG</given-names></name><name><surname>Schwab</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Fast and precise targeting of single tumor cells in vivo by multimodal correlative microscopy</article-title><source>Journal of Cell Science</source><volume>129</volume><fpage>444</fpage><lpage>456</lpage><pub-id pub-id-type="doi">10.1242/jcs.181842</pub-id><pub-id pub-id-type="pmid">26659665</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karreman</surname><given-names>MA</given-names></name><name><surname>Ruthensteiner</surname><given-names>B</given-names></name><name><surname>Mercier</surname><given-names>L</given-names></name><name><surname>Schieber</surname><given-names>NL</given-names></name><name><surname>Solecki</surname><given-names>G</given-names></name><name><surname>Winkler</surname><given-names>F</given-names></name><name><surname>Goetz</surname><given-names>JG</given-names></name><name><surname>Schwab</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Find your way with X-ray: using microct to correlate in vivo imaging with 3D electron microscopy</article-title><source>Methods in Cell Biology</source><volume>140</volume><fpage>277</fpage><lpage>301</lpage><pub-id pub-id-type="doi">10.1016/bs.mcb.2017.03.006</pub-id><pub-id pub-id-type="pmid">28528637</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klein</surname><given-names>S</given-names></name><name><surname>Staring</surname><given-names>M</given-names></name><name><surname>Murphy</surname><given-names>K</given-names></name><name><surname>Viergever</surname><given-names>MA</given-names></name><name><surname>Pluim</surname><given-names>JPW</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Elastix: a toolbox for intensity-based medical image registration</article-title><source>IEEE Transactions on Medical Imaging</source><volume>29</volume><fpage>196</fpage><lpage>205</lpage><pub-id pub-id-type="doi">10.1109/TMI.2009.2035616</pub-id><pub-id pub-id-type="pmid">19923044</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuan</surname><given-names>AT</given-names></name><name><surname>Phelps</surname><given-names>JS</given-names></name><name><surname>Thomas</surname><given-names>LA</given-names></name><name><surname>Nguyen</surname><given-names>TM</given-names></name><name><surname>Han</surname><given-names>J</given-names></name><name><surname>Chen</surname><given-names>CL</given-names></name><name><surname>Azevedo</surname><given-names>AW</given-names></name><name><surname>Tuthill</surname><given-names>JC</given-names></name><name><surname>Funke</surname><given-names>J</given-names></name><name><surname>Cloetens</surname><given-names>P</given-names></name><name><surname>Pacureanu</surname><given-names>A</given-names></name><name><surname>Lee</surname><given-names>WCA</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Dense neuronal reconstruction through X-ray holographic nano-tomography</article-title><source>Nature Neuroscience</source><volume>23</volume><fpage>1637</fpage><lpage>1643</lpage><pub-id pub-id-type="doi">10.1038/s41593-020-0704-9</pub-id><pub-id pub-id-type="pmid">32929244</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>TJ</given-names></name><name><surname>Kumar</surname><given-names>A</given-names></name><name><surname>Balwani</surname><given-names>AH</given-names></name><name><surname>Brittain</surname><given-names>D</given-names></name><name><surname>Kinn</surname><given-names>S</given-names></name><name><surname>Tovey</surname><given-names>CA</given-names></name><name><surname>Dyer</surname><given-names>EL</given-names></name><name><surname>da Costa</surname><given-names>NM</given-names></name><name><surname>Reid</surname><given-names>RC</given-names></name><name><surname>Forest</surname><given-names>CR</given-names></name><name><surname>Bumbarger</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Large-scale neuroanatomy using LASSO: loop-based automated serial sectioning operation</article-title><source>PLOS ONE</source><volume>13</volume><elocation-id>e0206172</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0206172</pub-id><pub-id pub-id-type="pmid">30352088</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Meechan</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2022">2022a</year><data-title>Embl-system</data-title><version designator="Software Heritage">Software Heritage</version><source>Swh:1:Rev:78471b53c3dc8b4f6d6fac357171c42cf5af8134</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:31d4b1d34370c587a5e353135c714855a24f397f;origin=https://github.com/automated-ultramicrotomy/embl-system;visit=swh:1:snp:d6a85d9038a16c3c782fd29d438053e7cca240da;anchor=swh:1:rev:78471b53c3dc8b4f6d6fac357171c42cf5af8134">https://archive.softwareheritage.org/swh:1:dir:31d4b1d34370c587a5e353135c714855a24f397f;origin=https://github.com/automated-ultramicrotomy/embl-system;visit=swh:1:snp:d6a85d9038a16c3c782fd29d438053e7cca240da;anchor=swh:1:rev:78471b53c3dc8b4f6d6fac357171c42cf5af8134</ext-link></element-citation></ref><ref id="bib16"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Meechan</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2022">2022b</year><data-title>Crosshair</data-title><version designator="swh:1:rev:43291bc07467612e4561e402e623a9fad5ae77bc">swh:1:rev:43291bc07467612e4561e402e623a9fad5ae77bc</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:814312f3fdddefe878f5dc4c1c4deca58544075a;origin=https://github.com/automated-ultramicrotomy/crosshair;visit=swh:1:snp:94dad522240c369d40c2cee75eb33ebe47be940a;anchor=swh:1:rev:43291bc07467612e4561e402e623a9fad5ae77bc">https://archive.softwareheritage.org/swh:1:dir:814312f3fdddefe878f5dc4c1c4deca58544075a;origin=https://github.com/automated-ultramicrotomy/crosshair;visit=swh:1:snp:94dad522240c369d40c2cee75eb33ebe47be940a;anchor=swh:1:rev:43291bc07467612e4561e402e623a9fad5ae77bc</ext-link></element-citation></ref><ref id="bib17"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Meechan</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2022">2022c</year><data-title>RegistrationTree</data-title><version designator="swh:1:rev:15e8f9efb539700d708b4fe52f715aabb0c1e88b">swh:1:rev:15e8f9efb539700d708b4fe52f715aabb0c1e88b</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:382d7e34feeed6444c26a89e1a43e9979b04e4bc;origin=https://github.com/K-Meech/RegistrationTree;visit=swh:1:snp:b607198b0f085cc8bdd7c63cafbbfb6ea8afb61e;anchor=swh:1:rev:15e8f9efb539700d708b4fe52f715aabb0c1e88b">https://archive.softwareheritage.org/swh:1:dir:382d7e34feeed6444c26a89e1a43e9979b04e4bc;origin=https://github.com/K-Meech/RegistrationTree;visit=swh:1:snp:b607198b0f085cc8bdd7c63cafbbfb6ea8afb61e;anchor=swh:1:rev:15e8f9efb539700d708b4fe52f715aabb0c1e88b</ext-link></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meurer</surname><given-names>A</given-names></name><name><surname>Smith</surname><given-names>CP</given-names></name><name><surname>Paprocki</surname><given-names>M</given-names></name><name><surname>Čertík</surname><given-names>O</given-names></name><name><surname>Kirpichev</surname><given-names>SB</given-names></name><name><surname>Rocklin</surname><given-names>M</given-names></name><name><surname>Kumar</surname><given-names>A</given-names></name><name><surname>Ivanov</surname><given-names>S</given-names></name><name><surname>Moore</surname><given-names>JK</given-names></name><name><surname>Singh</surname><given-names>S</given-names></name><name><surname>Rathnayake</surname><given-names>T</given-names></name><name><surname>Vig</surname><given-names>S</given-names></name><name><surname>Granger</surname><given-names>BE</given-names></name><name><surname>Muller</surname><given-names>RP</given-names></name><name><surname>Bonazzi</surname><given-names>F</given-names></name><name><surname>Gupta</surname><given-names>H</given-names></name><name><surname>Vats</surname><given-names>S</given-names></name><name><surname>Johansson</surname><given-names>F</given-names></name><name><surname>Pedregosa</surname><given-names>F</given-names></name><name><surname>Curry</surname><given-names>MJ</given-names></name><name><surname>Terrel</surname><given-names>AR</given-names></name><name><surname>Roučka</surname><given-names>Š</given-names></name><name><surname>Saboo</surname><given-names>A</given-names></name><name><surname>Fernando</surname><given-names>I</given-names></name><name><surname>Kulal</surname><given-names>S</given-names></name><name><surname>Cimrman</surname><given-names>R</given-names></name><name><surname>Scopatz</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>SymPy: symbolic computing in python</article-title><source>PeerJ Computer Science</source><volume>3</volume><elocation-id>e103</elocation-id><pub-id pub-id-type="doi">10.7717/peerj-cs.103</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Musser</surname><given-names>JM</given-names></name><name><surname>Schippers</surname><given-names>KJ</given-names></name><name><surname>Nickel</surname><given-names>M</given-names></name><name><surname>Mizzon</surname><given-names>G</given-names></name><name><surname>Kohn</surname><given-names>AB</given-names></name><name><surname>Pape</surname><given-names>C</given-names></name><name><surname>Ronchi</surname><given-names>P</given-names></name><name><surname>Papadopoulos</surname><given-names>N</given-names></name><name><surname>Tarashansky</surname><given-names>AJ</given-names></name><name><surname>Hammel</surname><given-names>JU</given-names></name><name><surname>Wolf</surname><given-names>F</given-names></name><name><surname>Liang</surname><given-names>C</given-names></name><name><surname>Hernández-Plaza</surname><given-names>A</given-names></name><name><surname>Cantalapiedra</surname><given-names>CP</given-names></name><name><surname>Achim</surname><given-names>K</given-names></name><name><surname>Schieber</surname><given-names>NL</given-names></name><name><surname>Pan</surname><given-names>L</given-names></name><name><surname>Ruperti</surname><given-names>F</given-names></name><name><surname>Francis</surname><given-names>WR</given-names></name><name><surname>Vargas</surname><given-names>S</given-names></name><name><surname>Kling</surname><given-names>S</given-names></name><name><surname>Renkert</surname><given-names>M</given-names></name><name><surname>Polikarpov</surname><given-names>M</given-names></name><name><surname>Bourenkov</surname><given-names>G</given-names></name><name><surname>Feuda</surname><given-names>R</given-names></name><name><surname>Gaspar</surname><given-names>I</given-names></name><name><surname>Burkhardt</surname><given-names>P</given-names></name><name><surname>Wang</surname><given-names>B</given-names></name><name><surname>Bork</surname><given-names>P</given-names></name><name><surname>Beck</surname><given-names>M</given-names></name><name><surname>Schneider</surname><given-names>TR</given-names></name><name><surname>Kreshuk</surname><given-names>A</given-names></name><name><surname>Wörheide</surname><given-names>G</given-names></name><name><surname>Huerta-Cepas</surname><given-names>J</given-names></name><name><surname>Schwab</surname><given-names>Y</given-names></name><name><surname>Moroz</surname><given-names>LL</given-names></name><name><surname>Arendt</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Profiling cellular diversity in sponges informs animal cell type and nervous system evolution</article-title><source>Science</source><volume>374</volume><fpage>717</fpage><lpage>723</lpage><pub-id pub-id-type="doi">10.1126/science.abj2949</pub-id><pub-id pub-id-type="pmid">34735222</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Özpolat</surname><given-names>BD</given-names></name><name><surname>Randel</surname><given-names>N</given-names></name><name><surname>Williams</surname><given-names>EA</given-names></name><name><surname>Bezares-Calderón</surname><given-names>LA</given-names></name><name><surname>Andreatta</surname><given-names>G</given-names></name><name><surname>Balavoine</surname><given-names>G</given-names></name><name><surname>Bertucci</surname><given-names>PY</given-names></name><name><surname>Ferrier</surname><given-names>DEK</given-names></name><name><surname>Gambi</surname><given-names>MC</given-names></name><name><surname>Gazave</surname><given-names>E</given-names></name><name><surname>Handberg-Thorsager</surname><given-names>M</given-names></name><name><surname>Hardege</surname><given-names>J</given-names></name><name><surname>Hird</surname><given-names>C</given-names></name><name><surname>Hsieh</surname><given-names>YW</given-names></name><name><surname>Hui</surname><given-names>J</given-names></name><name><surname>Mutemi</surname><given-names>KN</given-names></name><name><surname>Schneider</surname><given-names>SQ</given-names></name><name><surname>Simakov</surname><given-names>O</given-names></name><name><surname>Vergara</surname><given-names>HM</given-names></name><name><surname>Vervoort</surname><given-names>M</given-names></name><name><surname>Jékely</surname><given-names>G</given-names></name><name><surname>Tessmar-Raible</surname><given-names>K</given-names></name><name><surname>Raible</surname><given-names>F</given-names></name><name><surname>Arendt</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>The nereid on the rise: platynereis as a model system</article-title><source>EvoDevo</source><volume>12</volume><fpage>1</fpage><lpage>22</lpage><pub-id pub-id-type="doi">10.1186/s13227-021-00180-3</pub-id><pub-id pub-id-type="pmid">34579780</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pietzsch</surname><given-names>T</given-names></name><name><surname>Saalfeld</surname><given-names>S</given-names></name><name><surname>Preibisch</surname><given-names>S</given-names></name><name><surname>Tomancak</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>BigDataViewer: visualization and processing for large image data sets</article-title><source>Nature Methods</source><volume>12</volume><fpage>481</fpage><lpage>483</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3392</pub-id><pub-id pub-id-type="pmid">26020499</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ronchi</surname><given-names>P</given-names></name><name><surname>Mizzon</surname><given-names>G</given-names></name><name><surname>Machado</surname><given-names>P</given-names></name><name><surname>D’Imprima</surname><given-names>E</given-names></name><name><surname>Best</surname><given-names>BT</given-names></name><name><surname>Cassella</surname><given-names>L</given-names></name><name><surname>Schnorrenberg</surname><given-names>S</given-names></name><name><surname>Montero</surname><given-names>MG</given-names></name><name><surname>Jechlinger</surname><given-names>M</given-names></name><name><surname>Ephrussi</surname><given-names>A</given-names></name><name><surname>Leptin</surname><given-names>M</given-names></name><name><surname>Mahamid</surname><given-names>J</given-names></name><name><surname>Schwab</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>High-precision targeting workflow for volume electron microscopy</article-title><source>The Journal of Cell Biology</source><volume>220</volume><elocation-id>e202104069</elocation-id><pub-id pub-id-type="doi">10.1083/jcb.202104069</pub-id><pub-id pub-id-type="pmid">34160561</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scheffer</surname><given-names>LK</given-names></name><name><surname>Xu</surname><given-names>CS</given-names></name><name><surname>Januszewski</surname><given-names>M</given-names></name><name><surname>Lu</surname><given-names>Z</given-names></name><name><surname>Takemura</surname><given-names>SY</given-names></name><name><surname>Hayworth</surname><given-names>KJ</given-names></name><name><surname>Huang</surname><given-names>GB</given-names></name><name><surname>Shinomiya</surname><given-names>K</given-names></name><name><surname>Maitlin-Shepard</surname><given-names>J</given-names></name><name><surname>Berg</surname><given-names>S</given-names></name><name><surname>Clements</surname><given-names>J</given-names></name><name><surname>Hubbard</surname><given-names>PM</given-names></name><name><surname>Katz</surname><given-names>WT</given-names></name><name><surname>Umayam</surname><given-names>L</given-names></name><name><surname>Zhao</surname><given-names>T</given-names></name><name><surname>Ackerman</surname><given-names>D</given-names></name><name><surname>Blakely</surname><given-names>T</given-names></name><name><surname>Bogovic</surname><given-names>J</given-names></name><name><surname>Dolafi</surname><given-names>T</given-names></name><name><surname>Kainmueller</surname><given-names>D</given-names></name><name><surname>Kawase</surname><given-names>T</given-names></name><name><surname>Khairy</surname><given-names>KA</given-names></name><name><surname>Leavitt</surname><given-names>L</given-names></name><name><surname>Li</surname><given-names>PH</given-names></name><name><surname>Lindsey</surname><given-names>L</given-names></name><name><surname>Neubarth</surname><given-names>N</given-names></name><name><surname>Olbris</surname><given-names>DJ</given-names></name><name><surname>Otsuna</surname><given-names>H</given-names></name><name><surname>Trautman</surname><given-names>ET</given-names></name><name><surname>Ito</surname><given-names>M</given-names></name><name><surname>Bates</surname><given-names>AS</given-names></name><name><surname>Goldammer</surname><given-names>J</given-names></name><name><surname>Wolff</surname><given-names>T</given-names></name><name><surname>Svirskas</surname><given-names>R</given-names></name><name><surname>Schlegel</surname><given-names>P</given-names></name><name><surname>Neace</surname><given-names>E</given-names></name><name><surname>Knecht</surname><given-names>CJ</given-names></name><name><surname>Alvarado</surname><given-names>CX</given-names></name><name><surname>Bailey</surname><given-names>DA</given-names></name><name><surname>Ballinger</surname><given-names>S</given-names></name><name><surname>Borycz</surname><given-names>JA</given-names></name><name><surname>Canino</surname><given-names>BS</given-names></name><name><surname>Cheatham</surname><given-names>N</given-names></name><name><surname>Cook</surname><given-names>M</given-names></name><name><surname>Dreher</surname><given-names>M</given-names></name><name><surname>Duclos</surname><given-names>O</given-names></name><name><surname>Eubanks</surname><given-names>B</given-names></name><name><surname>Fairbanks</surname><given-names>K</given-names></name><name><surname>Finley</surname><given-names>S</given-names></name><name><surname>Forknall</surname><given-names>N</given-names></name><name><surname>Francis</surname><given-names>A</given-names></name><name><surname>Hopkins</surname><given-names>GP</given-names></name><name><surname>Joyce</surname><given-names>EM</given-names></name><name><surname>Kim</surname><given-names>S</given-names></name><name><surname>Kirk</surname><given-names>NA</given-names></name><name><surname>Kovalyak</surname><given-names>J</given-names></name><name><surname>Lauchie</surname><given-names>SA</given-names></name><name><surname>Lohff</surname><given-names>A</given-names></name><name><surname>Maldonado</surname><given-names>C</given-names></name><name><surname>Manley</surname><given-names>EA</given-names></name><name><surname>McLin</surname><given-names>S</given-names></name><name><surname>Mooney</surname><given-names>C</given-names></name><name><surname>Ndama</surname><given-names>M</given-names></name><name><surname>Ogundeyi</surname><given-names>O</given-names></name><name><surname>Okeoma</surname><given-names>N</given-names></name><name><surname>Ordish</surname><given-names>C</given-names></name><name><surname>Padilla</surname><given-names>N</given-names></name><name><surname>Patrick</surname><given-names>CM</given-names></name><name><surname>Paterson</surname><given-names>T</given-names></name><name><surname>Phillips</surname><given-names>EE</given-names></name><name><surname>Phillips</surname><given-names>EM</given-names></name><name><surname>Rampally</surname><given-names>N</given-names></name><name><surname>Ribeiro</surname><given-names>C</given-names></name><name><surname>Robertson</surname><given-names>MK</given-names></name><name><surname>Rymer</surname><given-names>JT</given-names></name><name><surname>Ryan</surname><given-names>SM</given-names></name><name><surname>Sammons</surname><given-names>M</given-names></name><name><surname>Scott</surname><given-names>AK</given-names></name><name><surname>Scott</surname><given-names>AL</given-names></name><name><surname>Shinomiya</surname><given-names>A</given-names></name><name><surname>Smith</surname><given-names>C</given-names></name><name><surname>Smith</surname><given-names>K</given-names></name><name><surname>Smith</surname><given-names>NL</given-names></name><name><surname>Sobeski</surname><given-names>MA</given-names></name><name><surname>Suleiman</surname><given-names>A</given-names></name><name><surname>Swift</surname><given-names>J</given-names></name><name><surname>Takemura</surname><given-names>S</given-names></name><name><surname>Talebi</surname><given-names>I</given-names></name><name><surname>Tarnogorska</surname><given-names>D</given-names></name><name><surname>Tenshaw</surname><given-names>E</given-names></name><name><surname>Tokhi</surname><given-names>T</given-names></name><name><surname>Walsh</surname><given-names>JJ</given-names></name><name><surname>Yang</surname><given-names>T</given-names></name><name><surname>Horne</surname><given-names>JA</given-names></name><name><surname>Li</surname><given-names>F</given-names></name><name><surname>Parekh</surname><given-names>R</given-names></name><name><surname>Rivlin</surname><given-names>PK</given-names></name><name><surname>Jayaraman</surname><given-names>V</given-names></name><name><surname>Costa</surname><given-names>M</given-names></name><name><surname>Jefferis</surname><given-names>GS</given-names></name><name><surname>Ito</surname><given-names>K</given-names></name><name><surname>Saalfeld</surname><given-names>S</given-names></name><name><surname>George</surname><given-names>R</given-names></name><name><surname>Meinertzhagen</surname><given-names>IA</given-names></name><name><surname>Rubin</surname><given-names>GM</given-names></name><name><surname>Hess</surname><given-names>HF</given-names></name><name><surname>Jain</surname><given-names>V</given-names></name><name><surname>Plaza</surname><given-names>SM</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A connectome and analysis of the adult <italic>Drosophila</italic> central brain</article-title><source>eLife</source><volume>9</volume><elocation-id>e57443</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.57443</pub-id><pub-id pub-id-type="pmid">32880371</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schindelin</surname><given-names>J</given-names></name><name><surname>Arganda-Carreras</surname><given-names>I</given-names></name><name><surname>Frise</surname><given-names>E</given-names></name><name><surname>Kaynig</surname><given-names>V</given-names></name><name><surname>Longair</surname><given-names>M</given-names></name><name><surname>Pietzsch</surname><given-names>T</given-names></name><name><surname>Preibisch</surname><given-names>S</given-names></name><name><surname>Rueden</surname><given-names>C</given-names></name><name><surname>Saalfeld</surname><given-names>S</given-names></name><name><surname>Schmid</surname><given-names>B</given-names></name><name><surname>Tinevez</surname><given-names>JY</given-names></name><name><surname>White</surname><given-names>DJ</given-names></name><name><surname>Hartenstein</surname><given-names>V</given-names></name><name><surname>Eliceiri</surname><given-names>K</given-names></name><name><surname>Tomancak</surname><given-names>P</given-names></name><name><surname>Cardona</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Fiji: an open-source platform for biological-image analysis</article-title><source>Nature Methods</source><volume>9</volume><fpage>676</fpage><lpage>682</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2019</pub-id><pub-id pub-id-type="pmid">22743772</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmid</surname><given-names>B</given-names></name><name><surname>Schindelin</surname><given-names>J</given-names></name><name><surname>Cardona</surname><given-names>A</given-names></name><name><surname>Longair</surname><given-names>M</given-names></name><name><surname>Heisenberg</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>A high-level 3D visualization API for java and imagej</article-title><source>BMC Bioinformatics</source><volume>11</volume><elocation-id>274</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2105-11-274</pub-id><pub-id pub-id-type="pmid">20492697</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shamonin</surname><given-names>DP</given-names></name><name><surname>Bron</surname><given-names>EE</given-names></name><name><surname>Lelieveldt</surname><given-names>BPF</given-names></name><name><surname>Smits</surname><given-names>M</given-names></name><name><surname>Klein</surname><given-names>S</given-names></name><name><surname>Staring</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Fast parallel image registration on CPU and gpu for diagnostic classification of alzheimer’s disease</article-title><source>Frontiers in Neuroinformatics</source><volume>7</volume><fpage>1</fpage><lpage>15</lpage><pub-id pub-id-type="doi">10.3389/fninf.2013.00050</pub-id><pub-id pub-id-type="pmid">24474917</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Templier</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>MagC, magnetic collection of ultrathin sections for volumetric correlative light and electron microscopy</article-title><source>eLife</source><volume>8</volume><elocation-id>e45696</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.45696</pub-id><pub-id pub-id-type="pmid">31294691</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Tischer</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>ElastixWrapper: fiji plugin for 3D image registration with elastix</data-title><source>Zenodo</source><ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.2602549">https://doi.org/10.5281/zenodo.2602549</ext-link></element-citation></ref><ref id="bib29"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Tischer</surname><given-names>C</given-names></name><name><surname>Meechan</surname><given-names>K</given-names></name><name><surname>Pape</surname><given-names>C</given-names></name><name><surname>Eglinger</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2022">2022a</year><data-title>Imagej-utils</data-title><version designator="0.6.4">0.6.4</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/embl-cba/imagej-utils">https://github.com/embl-cba/imagej-utils</ext-link></element-citation></ref><ref id="bib30"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Tischer</surname><given-names>C</given-names></name><name><surname>Chiaruttini</surname><given-names>N</given-names></name><name><surname>Bogovic</surname><given-names>J</given-names></name><name><surname>Meechan</surname><given-names>K</given-names></name><name><surname>Patterson</surname><given-names>H</given-names></name><name><surname>Eglinger</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2022">2022b</year><data-title>Image-transform-converters</data-title><version designator="0.1.7">0.1.7</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/image-transform-converters/image-transform-converters">https://github.com/image-transform-converters/image-transform-converters</ext-link></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vergara</surname><given-names>HM</given-names></name><name><surname>Pape</surname><given-names>C</given-names></name><name><surname>Meechan</surname><given-names>KI</given-names></name><name><surname>Zinchenko</surname><given-names>V</given-names></name><name><surname>Genoud</surname><given-names>C</given-names></name><name><surname>Wanner</surname><given-names>AA</given-names></name><name><surname>Mutemi</surname><given-names>KN</given-names></name><name><surname>Titze</surname><given-names>B</given-names></name><name><surname>Templin</surname><given-names>RM</given-names></name><name><surname>Bertucci</surname><given-names>PY</given-names></name><name><surname>Simakov</surname><given-names>O</given-names></name><name><surname>Dürichen</surname><given-names>W</given-names></name><name><surname>Machado</surname><given-names>P</given-names></name><name><surname>Savage</surname><given-names>EL</given-names></name><name><surname>Schermelleh</surname><given-names>L</given-names></name><name><surname>Schwab</surname><given-names>Y</given-names></name><name><surname>Friedrich</surname><given-names>RW</given-names></name><name><surname>Kreshuk</surname><given-names>A</given-names></name><name><surname>Tischer</surname><given-names>C</given-names></name><name><surname>Arendt</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Whole-body integration of gene expression and single-cell morphology</article-title><source>Cell</source><volume>184</volume><fpage>4819</fpage><lpage>4837</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2021.07.017</pub-id><pub-id pub-id-type="pmid">34380046</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Williams</surname><given-names>EA</given-names></name><name><surname>Jékely</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Towards a systems-level understanding of development in the marine annelid <italic>Platynereis dumerilii</italic></article-title><source>Current Opinion in Genetics &amp; Development</source><volume>39</volume><fpage>175</fpage><lpage>181</lpage><pub-id pub-id-type="doi">10.1016/j.gde.2016.07.005</pub-id><pub-id pub-id-type="pmid">27501412</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Withers</surname><given-names>PJ</given-names></name><name><surname>Bouman</surname><given-names>C</given-names></name><name><surname>Carmignato</surname><given-names>S</given-names></name><name><surname>Cnudde</surname><given-names>V</given-names></name><name><surname>Grimaldi</surname><given-names>D</given-names></name><name><surname>Hagen</surname><given-names>CK</given-names></name><name><surname>Maire</surname><given-names>E</given-names></name><name><surname>Manley</surname><given-names>M</given-names></name><name><surname>Du Plessis</surname><given-names>A</given-names></name><name><surname>Stock</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>X-ray computed tomography</article-title><source>Nature Reviews Methods Primers</source><volume>1</volume><elocation-id>14</elocation-id><pub-id pub-id-type="doi">10.1038/s43586-021-00015-4</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>CS</given-names></name><name><surname>Pang</surname><given-names>S</given-names></name><name><surname>Shtengel</surname><given-names>G</given-names></name><name><surname>Müller</surname><given-names>A</given-names></name><name><surname>Ritter</surname><given-names>AT</given-names></name><name><surname>Hoffman</surname><given-names>HK</given-names></name><name><surname>Takemura</surname><given-names>SY</given-names></name><name><surname>Lu</surname><given-names>Z</given-names></name><name><surname>Pasolli</surname><given-names>HA</given-names></name><name><surname>Iyer</surname><given-names>N</given-names></name><name><surname>Chung</surname><given-names>J</given-names></name><name><surname>Bennett</surname><given-names>D</given-names></name><name><surname>Weigel</surname><given-names>AV</given-names></name><name><surname>Freeman</surname><given-names>M</given-names></name><name><surname>van Engelenburg</surname><given-names>SB</given-names></name><name><surname>Walther</surname><given-names>TC</given-names></name><name><surname>Farese</surname><given-names>RV</given-names></name><name><surname>Lippincott-Schwartz</surname><given-names>J</given-names></name><name><surname>Mellman</surname><given-names>I</given-names></name><name><surname>Solimena</surname><given-names>M</given-names></name><name><surname>Hess</surname><given-names>HF</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>An open-access volume electron microscopy atlas of whole cells and tissues</article-title><source>Nature</source><volume>599</volume><fpage>147</fpage><lpage>151</lpage><pub-id pub-id-type="doi">10.1038/s41586-021-03992-4</pub-id><pub-id pub-id-type="pmid">34616045</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>Z</given-names></name><name><surname>Lauritzen</surname><given-names>JS</given-names></name><name><surname>Perlman</surname><given-names>E</given-names></name><name><surname>Robinson</surname><given-names>CG</given-names></name><name><surname>Nichols</surname><given-names>M</given-names></name><name><surname>Milkie</surname><given-names>D</given-names></name><name><surname>Torrens</surname><given-names>O</given-names></name><name><surname>Price</surname><given-names>J</given-names></name><name><surname>Fisher</surname><given-names>CB</given-names></name><name><surname>Sharifi</surname><given-names>N</given-names></name><name><surname>Calle-Schuler</surname><given-names>SA</given-names></name><name><surname>Kmecova</surname><given-names>L</given-names></name><name><surname>Ali</surname><given-names>IJ</given-names></name><name><surname>Karsh</surname><given-names>B</given-names></name><name><surname>Trautman</surname><given-names>ET</given-names></name><name><surname>Bogovic</surname><given-names>JA</given-names></name><name><surname>Hanslovsky</surname><given-names>P</given-names></name><name><surname>Jefferis</surname><given-names>G</given-names></name><name><surname>Kazhdan</surname><given-names>M</given-names></name><name><surname>Khairy</surname><given-names>K</given-names></name><name><surname>Saalfeld</surname><given-names>S</given-names></name><name><surname>Fetter</surname><given-names>RD</given-names></name><name><surname>Bock</surname><given-names>DD</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A complete electron microscopy volume of the brain of adult <italic>Drosophila melanogaster</italic></article-title><source>Cell</source><volume>174</volume><fpage>730</fpage><lpage>743</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2018.06.019</pub-id><pub-id pub-id-type="pmid">30033368</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.80899.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Cardona</surname><given-names>Albert</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/013meh722</institution-id><institution>University of Cambridge</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group><related-object id="sa0ro1" object-id-type="id" object-id="10.1101/2022.06.02.491151" link-type="continued-by" xlink:href="https://sciety.org/articles/activity/10.1101/2022.06.02.491151"/></front-stub><body><p>Meechan et al. present a systematic approach to semi-automate an ultramicrotome operation for targeting a specific plane aided by X-ray tomography measurements, and it is a fundamental work of great interest to any users of electron microscopy (EM), particularly when targeting the imaging of thin sections in a select region of interest by ultramicrotomy, or when targeting volume EM of select sample regions. The article documents with exceptional detail a workflow including both microtome modifications and software adaptations for semi-automated targeting of structures with micrometre precision, resulting in a faster and more accurate orientation of the image acquisition planes for volume electron microscopy, a task that has traditionally been difficult and time-consuming. Therefore, this work will reduce sample preparation labour and, critically, facilitate the comparison of the ultrastructure of multiple samples. The method is based on X-ray imaging acquisition prior to any sectioning and proposes a solution for the two instruments commercially available in the field, and by transparently sharing all the data, hardware, and software, and describing every detail of the workflow, this fundamental method can be readily adopted by any practitioner, enabling its wide application – it is a key step in the field regarding speed-up, accuracy, and reproducibility in electron microscopy.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.80899.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Cardona</surname><given-names>Albert</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/013meh722</institution-id><institution>University of Cambridge</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Genoud</surname><given-names>Christel</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/019whta54</institution-id><institution>University of Lausanne</institution></institution-wrap><country>Switzerland</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Pang</surname><given-names>Song</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03v76x132</institution-id><institution>Yale University</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Wilsch-Bräuninger</surname><given-names>Michaela</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05b8d3w18</institution-id><institution>Max Planck Institute of Molecular Cell Biology and Genetics</institution></institution-wrap><country>Germany</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2022.06.02.491151">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2022.06.02.491151v1">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Crosshair, semi-automated targeting for electron microscopy with a motorised ultramicrotome&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Anna Akhmanova as the Senior Editor. The following individuals involved in the review of your submission have agreed to reveal their identity: Christel Genoud (Reviewer #1); Song Pang (Reviewer #2); Michaela Wilsch-Bräuninge (Reviewer #3).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>1) Please note the suggested expansion of figure 3 to include its own supplements 1 and 2 into the main figure for clarity of exposition and to be able to logically follow the argument. And also to relabel the axes for clarity, for example, to move the axis caption to be near the axis itself, so that the text runs nearly flush, and parallel, with the axis it captions. Otherwise, it's unclear which label corresponds to which label.</p><p>2) Please discuss the limitations in the ultramicrotome feed length and how these can affect automation.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>This article is providing a critical tool to all the community.</p><p>I cannot judge the geometry approach as I am not good enough in geometry to critically assess or propose any improvement in this part.</p><p>Figures are of outstanding quality and make the article easy to read and interesting even for readers not directly interested in implementing the approach.</p><p>I do not see at this point any need for major improvements or modifications of the article.</p><p>As the limitations are explained by the authors at the end and the future developments are proposed and openly discussed, I do not have suggestions that will improve this article sufficiently to delay its publication and make a second run of revision.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>Enabling a solution to avoid the reset of the cutting feed (with a feed of 500 nm or less) will be a critical step towards automation. This feature will not only greatly reduce the labor requirement – freeing users from babysitting microtome during trimming, but also improve the target accuracy and operation throughput.</p><p>Figure 3 is difficult to follow without the prelude of Figure 3—figure supplements 1 and 2. Combining these two supplement figures into Figure 3 will be more intelligible. Additionally, the axes labels in Figures 3 C and 3 D are confusing. It would be helpful to spell out in the caption which label is for x and which is for y, respectively.</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>The comparison between two different setups for the motorization of the microtomes is a very useful piece of data. In the description, however, the difference between the 3 motors for the Leica system and the additional translational stage motors for the RMC is not explained. It may be useful to give a simple explanation.</p><p>The print version of the equations is rather difficult to read (small) – another font (sans serif) for the subscript letters could help.</p><p>EW and NS knife motors are clear to users of a similar microtome, but may not be self-explanatory.</p><p>Figure 1- Figure Suppl 1: Panel A: Add an arrow for the hole corresponding to the pin in Panel B.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.80899.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) Please note the suggested expansion of figure 3 to include its own supplements 1 and 2 into the main figure for clarity of exposition and to be able to logically follow the argument. And also to relabel the axes for clarity, for example, to move the axis caption to be near the axis itself, so that the text runs nearly flush, and parallel, with the axis it captions. Otherwise, it's unclear which label corresponds to which label.</p></disp-quote><p>We expanded Figure 3 to include the panels from its original supplements 1 and 2. We also added an additional panel to the new Figure 3A to show the target coordinate frame alongside all the others. This should make it easier to relate the labels in panels C and D to the axes shown in A.</p><p>We also updated the axis labels for the graphs in panels E and F. The labels were moved closer, and parallel to the axes to make it easier to distinguish which label corresponds to which axis.</p><p>The only part of the original supplements 1 and 2 that wasn’t integrated into the new figure were the images of coordinate frames at different angles. These remain in the supplemental as the new, smaller Figure 3 —figure supplement 1. These were omitted from the main figure as they are not essential to understanding panels C and D, and help to reduce the number of panels in the main figure.</p><disp-quote content-type="editor-comment"><p>2) Please discuss the limitations in the ultramicrotome feed length and how these can affect automation.</p></disp-quote><p>We expanded the discussion to include an explanation of the feed length and its limitations (edits from line 298 – 311). We explain how the ultramicrotome must be manually reset every 200 microns (one feed length), and how this contributes to the accuracy of the workflow. We add reference to samples h/i/j in this study that all had cutting distances greater than one feed length. We also explain how further automation would require hardware improvements to increase the feed length, or allow automatic resets when the feed length is exceeded.</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>This article is providing a critical tool to all the community.</p><p>I cannot judge the geometry approach as I am not good enough in geometry to critically assess or propose any improvement in this part.</p><p>Figures are of outstanding quality and make the article easy to read and interesting even for readers not directly interested in implementing the approach.</p><p>I do not see at this point any need for major improvements or modifications of the article.</p><p>As the limitations are explained by the authors at the end and the future developments are proposed and openly discussed, I do not have suggestions that will improve this article sufficiently to delay its publication and make a second run of revision.</p></disp-quote><p>Thanks to reviewer 1 for these kind comments!</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>Enabling a solution to avoid the reset of the cutting feed (with a feed of 500 nm or less) will be a critical step towards automation. This feature will not only greatly reduce the labor requirement – freeing users from babysitting microtome during trimming, but also improve the target accuracy and operation throughput.</p></disp-quote><p>We agree that the need to manually reset the ultramicrotome every 200µm is a big limitation in the automation of this workflow. Unfortunately, to resolve this limitation significant hardware improvements would be necessary. Either the feed length of the ultramicrotome would have to be extended, or a method for automatic approach of knife and block face would have to be designed. As both approaches would require much development, we believe they are out of scope for this work. To reflect the importance of this issue though, we have expanded the discussion to highlight it (see comments for the second essential revision above).</p><disp-quote content-type="editor-comment"><p>Figure 3 is difficult to follow without the prelude of Figure 3—figure supplements 1 and 2. Combining these two supplement figures into Figure 3 will be more intelligible. Additionally, the axes labels in Figures 3 C and 3 D are confusing. It would be helpful to spell out in the caption which label is for x and which is for y, respectively.</p></disp-quote><p>See comments for the first essential revision above.</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>The comparison between two different setups for the motorization of the microtomes is a very useful piece of data. In the description, however, the difference between the 3 motors for the Leica system and the additional translational stage motors for the RMC is not explained. It may be useful to give a simple explanation.</p></disp-quote><p>We expand the description in the ‘automation of the ultramicrotome’ section, to more clearly describe the differences between the motor setups in the Leica and RMC systems (edits from line 87-94). We explain how the additional translational stage motors in the RMC allow the position of the knife to be controlled in the same user interface as the orientation. We contrast this to the Leica system where translation and rotation are controlled separately through two different interfaces. In this section, we also link to the methods section ‘Ultramicrotome systems and calibration’ where the technical specifications for the motors in each system are described in detail.</p><disp-quote content-type="editor-comment"><p>The print version of the equations is rather difficult to read (small) – another font (sans serif) for the subscript letters could help.</p></disp-quote><p>We have increased the font size for all equations in the text to make the subscript easier to read.</p><disp-quote content-type="editor-comment"><p>EW and NS knife motors are clear to users of a similar microtome, but may not be self-explanatory.</p></disp-quote><p>We add the full terms ‘North-South’ and ‘East-West’ to Figure 1A and its caption, to make it clearer what these abbreviations stand for. We also add this to the first mention of NS/EW in the main text (line 88).</p><disp-quote content-type="editor-comment"><p>Figure 1- Figure Suppl 1: Panel A: Add an arrow for the hole corresponding to the pin in Panel B.</p></disp-quote><p>We add a label to Figure 1 —figure supplement 1 pointing to the required hole in the ultramicrotome.</p></body></sub-article></article>