<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">88670</article-id><article-id pub-id-type="doi">10.7554/eLife.88670</article-id><article-id pub-id-type="doi" specific-use="version">10.7554/eLife.88670.3</article-id><article-version article-version-type="publication-state">version of record</article-version><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>I-Spin live, an open-source software based on blind-source separation for real-time decoding of motor unit activity in humans</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Rossato</surname><given-names>Julien</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Hug</surname><given-names>François</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Tucker</surname><given-names>Kylie</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Gibbs</surname><given-names>Ciara</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Lacourpaille</surname><given-names>Lilian</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Farina</surname><given-names>Dario</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7883-2697</contrib-id><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Avrillon</surname><given-names>Simon</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2226-3528</contrib-id><email>s.avrillon@imperial.ac.uk</email><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03gnr7b55</institution-id><institution>Nantes Université, Laboratory “Movement, Interactions, Performance” (UR 4334)</institution></institution-wrap><addr-line><named-content content-type="city">Nantes</named-content></addr-line><country>France</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/019tgvf94</institution-id><institution>Université Côte d'Azur, LAMHESS</institution></institution-wrap><addr-line><named-content content-type="city">Nice</named-content></addr-line><country>France</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00rqy9422</institution-id><institution>The University of Queensland, School of Biomedical Sciences</institution></institution-wrap><addr-line><named-content content-type="city">Brisbane</named-content></addr-line><country>Australia</country></aff><aff id="aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/041kmwe10</institution-id><institution>Department of Bioengineering, Faculty of Engineering, Imperial College London</institution></institution-wrap><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Pruszynski</surname><given-names>J Andrew</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02grkyz14</institution-id><institution>Western University</institution></institution-wrap><country>Canada</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Büchel</surname><given-names>Christian</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01zgy1s35</institution-id><institution>University Medical Center Hamburg-Eppendorf</institution></institution-wrap><country>Germany</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>02</day><month>10</month><year>2024</year></pub-date><volume>12</volume><elocation-id>RP88670</elocation-id><history><date date-type="sent-for-review" iso-8601-date="2023-04-28"><day>28</day><month>04</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint.</event-desc><date date-type="preprint" iso-8601-date="2023-04-15"><day>15</day><month>04</month><year>2023</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.04.14.536933"/></event><event><event-desc>This manuscript was published as a reviewed preprint.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2023-07-12"><day>12</day><month>07</month><year>2023</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.88670.1"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-09-17"><day>17</day><month>09</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.88670.2"/></event></pub-history><permissions><copyright-statement>© 2023, Rossato et al</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Rossato et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-88670-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-88670-figures-v1.pdf"/><abstract><p>Decoding the activity of individual neural cells during natural behaviours allows neuroscientists to study how the nervous system generates and controls movements. Contrary to other neural cells, the activity of spinal motor neurons can be determined non-invasively (or minimally invasively) from the decomposition of electromyographic (EMG) signals into motor unit firing activities. For some interfacing and neuro-feedback investigations, EMG decomposition needs to be performed in real time. Here, we introduce an open-source software that performs real-time decoding of motor neurons using a blind-source separation approach for multichannel EMG signal processing. Separation vectors (motor unit filters) are optimised for each motor unit from baseline contractions and then re-applied in real time during test contractions. In this way, the firing activity of multiple motor neurons can be provided through different forms of visual feedback. We provide a complete framework with guidelines and examples of recordings to guide researchers who aim to study movement control at the motor neuron level. We first validated the software with synthetic EMG signals generated during a range of isometric contraction patterns. We then tested the software on data collected using either surface or intramuscular electrode arrays from five lower limb muscles (gastrocnemius lateralis and medialis, vastus lateralis and medialis, and tibialis anterior). We assessed how the muscle or variation of contraction intensity between the baseline contraction and the test contraction impacted the accuracy of the real-time decomposition. This open-source software provides a set of tools for neuroscientists to design experimental paradigms where participants can receive real-time feedback on the output of the spinal cord circuits.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>electromyography</kwd><kwd>motor unit</kwd><kwd>decomposition</kwd><kwd>neural decoding</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001665</institution-id><institution>Agence Nationale de la Recherche</institution></institution-wrap></funding-source><award-id>ANR-15-IDEX-01</award-id><principal-award-recipient><name><surname>Hug</surname><given-names>François</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000781</institution-id><institution>European Research Council</institution></institution-wrap></funding-source><award-id>#810346</award-id><principal-award-recipient><name><surname>Farina</surname><given-names>Dario</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000266</institution-id><institution>Engineering and Physical Sciences Research Council</institution></institution-wrap></funding-source><award-id>EP/T020970</award-id><principal-award-recipient><name><surname>Farina</surname><given-names>Dario</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000268</institution-id><institution>Biotechnology and Biological Sciences Research Council</institution></institution-wrap></funding-source><award-id>BB/V00896X</award-id><principal-award-recipient><name><surname>Farina</surname><given-names>Dario</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>I-Spin enables researchers to decode motor unit firings from surface and intramuscular electromyographic signals in real time.</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>publishing-route</meta-name><meta-value>prc</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Motor units transduce the neural signals that originate from supraspinal centres, spinal circuits, and sensory systems into force (<xref ref-type="bibr" rid="bib52">Sherrington, 1925</xref>). In healthy individuals, each action potential propagating along the axon of an alpha motor neuron elicits action potentials in all its innervated muscle fibres. The activity of motor neuron – in the form of spike trains – represents the neural code of movement to muscles. Decoding this firing activity in real time during various behaviours can thus substantially enhance our understanding of movement control (<xref ref-type="bibr" rid="bib4">Basmajian, 1963</xref>; <xref ref-type="bibr" rid="bib21">Formento et al., 2021</xref>; <xref ref-type="bibr" rid="bib5">Bräcklein et al., 2022</xref>; <xref ref-type="bibr" rid="bib51">Rossato et al., 2024</xref>). Real-time decoding is also essential for interfacing with external devices (<xref ref-type="bibr" rid="bib20">Farina et al., 2023</xref>) or virtual limbs (<xref ref-type="bibr" rid="bib48">Oliveira et al., 2024</xref>) when activity is present at the periphery of the nervous system. For example, individuals with a spinal cord injury can control a virtual hand with the residual firing activity of the motor units in their forearm (<xref ref-type="bibr" rid="bib48">Oliveira et al., 2024</xref>). Furthermore, sampling the activity of motor units receiving a substantial portion of independent synaptic inputs may pave the way for movement augmentation – specifically, extending a person’s movement repertoire through the increase of controllable degrees of freedom (<xref ref-type="bibr" rid="bib13">Eden et al., 2022</xref>). In this way, <xref ref-type="bibr" rid="bib21">Formento et al., 2021</xref> showed that individuals can intuitively learn to independently control motor units within the same muscle using visual cues. Having access to open-source tools that perform the real-time decoding of motor units would allow an increasing number of researchers to improve and expand the range of these applications.</p><p>To date, researchers classically identify a few motor units during relatively weak contractions using concentric needle or fine wire recording electrodes (<xref ref-type="bibr" rid="bib35">LeFever and De Luca, 1982</xref>). They then separate the overlapping spike trains with a spike-sorting algorithm (e.g. <xref ref-type="bibr" rid="bib41">McGill et al., 2005</xref>). Recent developments of intramuscular (<xref ref-type="bibr" rid="bib17">Farina et al., 2008b</xref>; <xref ref-type="bibr" rid="bib44">Muceli et al., 2015</xref>; <xref ref-type="bibr" rid="bib45">Muceli et al., 2022</xref>; <xref ref-type="bibr" rid="bib11">Chung et al., 2023</xref>) and surface (<xref ref-type="bibr" rid="bib19">Farina et al., 2016</xref>; <xref ref-type="bibr" rid="bib7">Caillet et al., 2023</xref>) electromyography (EMG) electrode arrays facilitate both a larger recording zone (i.e. the volume from which motor unit action potentials are recorded), and the recording of the same motor unit action potential across multiple channels. In conjunction with this hardware advance, the development of novel EMG decomposition software/programs, such as multichannel spike-sorting (<xref ref-type="bibr" rid="bib50">Rey et al., 2015</xref>; <xref ref-type="bibr" rid="bib6">Buccino et al., 2020</xref>; <xref ref-type="bibr" rid="bib53">Steinmetz et al., 2021</xref>; <xref ref-type="bibr" rid="bib49">Pachitariu et al., 2023</xref>) and blind-source separation (<xref ref-type="bibr" rid="bib28">Holobar and Zazula, 2007</xref>; <xref ref-type="bibr" rid="bib30">Holobar and Farina, 2014</xref>; <xref ref-type="bibr" rid="bib18">Farina and Holobar, 2016</xref>; <xref ref-type="bibr" rid="bib46">Negro et al., 2016</xref>; <xref ref-type="bibr" rid="bib9">Chen et al., 2019</xref>) algorithms, enables a relatively large number of individual motor units to be decoded from each recording (<xref ref-type="bibr" rid="bib44">Muceli et al., 2015</xref>; <xref ref-type="bibr" rid="bib45">Muceli et al., 2022</xref>; <xref ref-type="bibr" rid="bib11">Chung et al., 2023</xref>; <xref ref-type="bibr" rid="bib7">Caillet et al., 2023</xref>). Contrary to spike-sorting algorithms, blind-source separation does not directly sort action potential shapes, but rather optimises a set of separation vectors, that is, motor unit filters, which maximises the sparseness of motor unit pulse trains from which discharge times are estimated (<xref ref-type="bibr" rid="bib28">Holobar and Zazula, 2007</xref>; <xref ref-type="bibr" rid="bib30">Holobar and Farina, 2014</xref>; <xref ref-type="bibr" rid="bib18">Farina and Holobar, 2016</xref>; <xref ref-type="bibr" rid="bib46">Negro et al., 2016</xref>; <xref ref-type="bibr" rid="bib9">Chen et al., 2019</xref>). The current open-source implementations of this approach rely on offline processing, which restricts its ability to be used for neurofeedback and human interfacing technologies.</p><p>Recent studies have reported real-time capabilities of motor unit identification by adapting the offline blind-source separation algorithm (<xref ref-type="bibr" rid="bib21">Formento et al., 2021</xref>; <xref ref-type="bibr" rid="bib5">Bräcklein et al., 2022</xref>; <xref ref-type="bibr" rid="bib3">Barsakcioglu et al., 2021</xref>; <xref ref-type="bibr" rid="bib10">Chen et al., 2020</xref>; <xref ref-type="bibr" rid="bib56">Zheng and Hu, 2019</xref>). These studies used a two-step approach: (1) the separation vector for each motor unit is identified with offline decomposition during the training phase and (2) the same vectors are applied in real time to new EMG recordings. The real-time identification of motor units is only used by a few specialised research teams, and there are no publicly available algorithms or user interfaces for this task. In addition, the accuracy and capabilities of online decomposition have not been systematically tested in multiple muscles or intensities.</p><p>Here, we provide an open-source software that can be used to visualise and track motor unit firing activities in real time. We document the software validity and its capabilities on data collected from five lower limb muscles (gastrocnemius lateralis and medialis, vastus lateralis and medialis, and tibialis anterior) during isometric contractions of varying force levels, using either surface or intramuscular electrode arrays. The real-time identification of motor unit firing activity was first validated using synthetic EMG signals. Then, the accuracy of the algorithm was determined during experiments from the rate of agreement calculated between the motor unit spike trains identified in real time and those identified offline after manual editing. Data, codes, and a user manual are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/simonavrillon/I-Spin">https://github.com/simonavrillon/I-Spin</ext-link> (copy archived at <xref ref-type="bibr" rid="bib1">Avrillon, 2024</xref>).</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Overview of the approach</title><p>An EMG signal represents the sum of trains of action potentials from all the active motor units within the recorded muscle volume (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). During stationary conditions, for example, isometric contractions, the train of motor unit action potentials can be modelled as the convolution of series of discrete delta functions, representing the discharge times, and motor unit action potentials that have a consistent shape across time. When EMG signals are recorded with an array of electrodes, the shape of the recorded potential of each motor unit differs across electrodes. This is due to (1) the varying conduction velocity of action potentials among the muscle fibres and (2) the location/depth of the muscle fibres that belong to each motor unit relatively to the electrodes, which impact the low pass filtering effect of the tissue on the recorded potential. Increasing the number and density of recording electrodes increases the likelihood that each motor unit will have a unique motor unit action potential profile (shape), that is, a temporal and spatial profile that differs from all the other active motor unit within the recorded volume (<xref ref-type="bibr" rid="bib7">Caillet et al., 2023</xref>; <xref ref-type="bibr" rid="bib16">Farina et al., 2008a</xref>). The uniqueness of motor unit action potential profiles is necessary for the blind-source separation to accurately estimate the motor unit discharge times. Conversely, the spike trains of two motor units with similar action potential profiles will be merged by the model.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Overview of the approach.</title><p>(<bold>A</bold>) During isometric contractions, electromyographic (EMG) signals can be considered as the sum of all action potentials that originate from the muscle fibres of all the active motor units that lie within the electrodes recording zone. The shape of the recorded action potentials differs across electrodes when recorded with an array of surface or intramuscular electrodes. The EMG signal and each individual MUAP profile depends on the position of the electrode, as highlighted by the different colours. (<bold>B</bold>) Decomposing EMG signals consists of solving the inverse problem, that is, to estimate the discharge times of the active motor units from the EMG signals. Our software uses a fast independent component analysis (fasICA) to optimise a set of separation vectors for each motor unit. To this end, each separation vector is iteratively optimised to maximise the sparseness of the motor unit pulse train. At the end of this step, the motor unit pulse train is refined, and a k-mean classification is applied to separate the high peaks, which represent the targeted motor unit spikes, from the low peaks (other motor units and noise). (<bold>C</bold>) During the online EMG decomposition, the extended EMG signals recorded over 125 ms segments are projected on the separation vectors, and the peaks are detected using the function ‘islocalmax’. Each peak is classified as <italic>spike</italic> or <italic>noise</italic> depending on the distance separating them from the centroids of the classes identified during the calibration. At the end of this process, the motor unit firing activity is translated into visual feedback, in the form of a raster plot, a quadrant, or the smoothed firing rate of an identified motor unit.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88670-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Workflow of a typical experimental session with I-Spin live.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88670-fig1-figsupp1-v1.tif"/></fig></fig-group><p>Our software uses a fast independent component analysis (fastICA) to retrieve motor unit spike trains from the EMG signals. For this, it iteratively optimises a separation vector (i.e. the motor unit filter) for each motor unit (<xref ref-type="fig" rid="fig1">Figure 1B</xref>; <xref ref-type="bibr" rid="bib46">Negro et al., 2016</xref>; <xref ref-type="bibr" rid="bib9">Chen et al., 2019</xref>; <xref ref-type="bibr" rid="bib3">Barsakcioglu et al., 2021</xref>; <xref ref-type="bibr" rid="bib46">Negro et al., 2016</xref>; <xref ref-type="bibr" rid="bib9">Chen et al., 2019</xref>; <xref ref-type="bibr" rid="bib3">Barsakcioglu et al., 2021</xref>). The projection of the EMG signals on this separation vector generates a sparse motor unit pulse train, with most of its samples close to zero and a smaller number of samples significantly greater than zero (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). The discharge times are estimated from this motor unit pulse train using a peak detection function and a k-mean classification with two classes to separate the high peaks (spikes) from the low peaks (noise and other motor units). During the decomposition in real time, short segments of EMG signals are projected on the saved separation vectors, and the peaks are classified as discharge times if they are closer to the centroid of the class ‘spikes’ than to the centroid of the class ‘noise’ (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). The algorithm used to identify motor units discharge activity is based on that proposed by <xref ref-type="bibr" rid="bib46">Negro et al., 2016</xref> and <xref ref-type="bibr" rid="bib3">Barsakcioglu et al., 2021</xref>.</p></sec><sec id="s2-2"><title>Overview of the software</title><p>The software used in this article was coded as a MATLAB app (version 2022a, The MathWorks, Inc, USA), but an alternative version coded with Python is also available. It allows researchers to record and process signals from surface and intramuscular electrode arrays using multiple acquisition systems (EMG-Quattrocento, OT Bioelettronica, Italy; Open Ephys acquisition board, Open Ephys, USA; Intan RHD recording system; Intan Technologies, USA). As the accuracy of the algorithm relies on the consistency of motor unit filters, it is recommended to record these EMG signals during stationary conditions – for example, isometric contractions – to limit changes in muscle geometry or position/orientation of the active muscle fibres relative to the electrodes (<xref ref-type="bibr" rid="bib25">Glaser and Holobar, 2019</xref>; <xref ref-type="bibr" rid="bib47">Oliveira and Negro, 2021</xref>). The framework to perform real-time identification of motor neuron activity has four steps (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). First, the EMG signal is recorded while participants perform a contraction at the requested intensity such that an <italic>electrode mask</italic> is manually generated to remove channels with artefacts or low signal-to-noise ratio. This <italic>electrode mask</italic> is then used for the rest of the experimental session. Second, the force offset is measured and removed before performing maximal voluntary contraction (MVC). The measured MVC is used to standardise all the submaximal isometric contractions. Third, a baseline contraction is performed at a force level close to, or slightly above, the intensity of the testing task, and the separation vectors are identified with offline blind-source separation. Fourth, the separation vectors are applied over incoming segments of EMG signals during a test contraction to identify motor unit firing activity in real time.</p><p>Three forms of feedback can be displayed to the participant: a raster plot of the discharge times for each motor unit of a given array, a quadrant displaying the firing rates of two motor units, and the smoothed firing rate of a given motor unit with a scrolling target to track (<xref ref-type="fig" rid="fig1">Figure 1C</xref>).</p></sec><sec id="s2-3"><title>Manual editing to improve the accuracy of the motor unit pulse train</title><p>Manual editing of motor unit discharge times identified with automatic decomposition (or spike-sorting) generally improves the accuracy of the spike trains (<xref ref-type="bibr" rid="bib12">Del Vecchio et al., 2020</xref>; <xref ref-type="bibr" rid="bib32">Hug et al., 2021</xref>; <xref ref-type="bibr" rid="bib2">Avrillon et al., 2024</xref>). In the case of online decomposition, manual editing can be performed after the baseline contraction to improve the accuracy of the motor unit filters. It results in a motor unit pulse train with peaks easily separable from the noise. Several metrics have been proposed to automatically remove the unreliable motor unit pulse trains (<xref ref-type="bibr" rid="bib46">Negro et al., 2016</xref>; <xref ref-type="bibr" rid="bib31">Holobar et al., 2014</xref>). For example, the silhouette value (SIL) measures the normalised distance between the spikes and the noise after k-mean classification (<xref ref-type="bibr" rid="bib46">Negro et al., 2016</xref>). As an example, <xref ref-type="fig" rid="fig2">Figure 2A</xref> displays the silhouette values of all the motor units identified after the baseline contraction in five different muscles (vastus lateralis [VL] and medialis [VM], gastrocnemius lateralis [GL] and medialis [GM], and tibialis anterior [TA]) with either grids of surface electrodes or intramuscular electrodes arrays. When considering the baseline contractions performed at 20% MVC, on average 20 ± 9 (VL), 14 ± 5 (VM), 25 ± 11 (GL), 19 ± 9 (GM), 15 ± 4 (TA grid), and 10 (TA intra) motor units per participant were identified. Their SIL values calculated before manual editing were 0.89 ± 0.05 for VL, 0.83 ± 0.04 for VM, 0.82 ± 0.03 for GL, 0.87 ± 0.04 for GM, 0.94 ± 0.01 for TAgrid, and 0.95 ± 0.02 for TAintra. After visual inspection, a significant number of motor units was removed as their pulse train showed no clear separation between the spikes and the noise. The number of motor units removed was 6 ± 5 for VL, 10 ± 5 for VM, 21 ± 12 for GL, 6 ± 5 for GM, and 1 for TA grid and TA intra (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). The remaining motor units exhibited a SIL value of 0.91 ± 0.04, 0.89 ± 0.06, 0.89 ± 0.03, and 0.90 ± 0.02, 0.94 ± 0.01, and 0.95 ± 0.02 for VL, VM, GL, GM, TAgrid, and TA intra, respectively (<xref ref-type="fig" rid="fig2">Figure 2B</xref>).</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Effect of the manual editing on the reliability of motor unit pulse trains.</title><p>Once the participants completed the baseline contraction, we ran an automatic offline decomposition. Then, an operator visually inspected and removed all the motor units for which the spikes were not clearly separated from the noise (red dots in <bold>A</bold>). The remaining motor units were manually edited (black dots in <bold>A</bold>). (<bold>B</bold>) The manual editing consisted of removing false positives and adding the false negatives, before updating the motor unit filter. The effect of this step on the SIL value and the coefficient of variation of the interspike intervals (CoV of ISI, without units) is shown on the right panel. The CoV of ISI estimates the regularity of spiking for each motor unit, an expected behaviour during isometric contractions at consistent levels of force. The red dots are the motor units before editing and the green dots are the motor units after editing. These scatters are connected with a grey vector to show the changes in SIL value and CoV of ISI. Vastus lateralis (VL), vastus medialis (VM), gastrocnemius lateralis (GL), gastrocnemius medialis (GM), and tibialis anterior (TA).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88670-fig2-v1.tif"/></fig><p>When considering the baseline contraction performed at 40% MVC, on average 17 ± 6 (VL), 15 ± 5 (VM), 29 ± 13 (GL), and 13 ± 4 (GM) motor units were identified by automatic decomposition, with 12 ± 8 (VL), 3 ± 3 (VM), 5 ± 6 (GL), and 4 ± 3 (GM) motor units kept after visual inspection (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). The SIL value of the selected motor units reached 0.91 ± 0.03 for VL, 0.89 ± 0.05 for VM, 0.87 ± 0.02 for GL, and 0.88 ± 0.03 for GM after manual editing (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). These results show how manual editing can improve the accuracy of spike detection from the motor unit pulse trains. Moreover, a SIL value around 0.9 can be used as a threshold to automatically remove the motor unit pulse trains with a poor quality a priori. Thus, these two steps were performed in the all the subsequent analyses. Importantly, it is worth noting that the motor unit pulse train must always be visually inspected after the session to check for errors of the automatic identification of discharge times.</p></sec><sec id="s2-4"><title>Validation of the algorithm</title><p>We first validated the accuracy of the algorithm using synthetic EMG signals generated with an anatomical model entailing a cylindrical muscle volume with parallel fibres (see <xref ref-type="bibr" rid="bib16">Farina et al., 2008a</xref>, <xref ref-type="bibr" rid="bib34">Konstantin et al., 2020</xref> for a full description of the model). In this model, subcutaneous and skin layers separate the muscle from a grid of 65 surface electrodes (5 columns, 13 rows), while an intramuscular array of electrodes is directly inserted in the muscle under the grid with an angle of 30°. A total of 150 motor units were distributed within the cross-section of the muscle. Recruitment thresholds, firing rate/excitatory drive relations, and twitch parameters were assigned to each motor unit using the same procedure as <xref ref-type="bibr" rid="bib22">Fuglevand et al., 1993</xref>. During each simulation, a proportional-integral-derivative controller adjusted the level of excitatory drive to minimise the error between a predefined target of force and the force generated by the active motor units.</p><p><xref ref-type="fig" rid="fig3">Figure 3A</xref> displays the raster plots of the active motor units during simulated trapezoidal isometric contractions with plateaus of force set at 10, 20, and 30% MVC. A sinusoidal isometric contraction ranging between 15 and 25% MVC at a frequency of 0.5 Hz was also simulated. We identified on average 10 ± 1 and 12 ± 2 motor units with surface and intramuscular arrays, respectively (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). During the offline decomposition, the rate of agreement between the identified discharge times and the ground truth, that is, the simulated discharge times, reached 100.0 ± 0.0% for intramuscular EMG signals and 99.2 ± 1.8% for surface EMG signals (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). The offline estimation of motor unit filters was therefore highly accurate, independently of the level of force or the pattern of the isometric contraction.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Validation of the algorithm with synthetic electromyographic (EMG) signals.</title><p>Surface and intramuscular EMG signals were generated using an anatomical model with 150 motor units. (<bold>A</bold>) Raster plots of the active motor units during simulated trapezoidal contractions performed at 10, 20, and 30% of the maximal force (maximal voluntary contraction [MVC]), and during a sinusoidal contraction with the force varying between 15 and 25% MVC at a rate of 0.5 Hz. The spike trains in red, blue, or green were respectively identified from intramuscular, surface, or both EMG signals. (<bold>B</bold>) The identified discharge times were compared to the ground truth, that is, the simulated discharge times, using the rate of agreement. Each dot is a motor unit, and the line is the median. (<bold>C</bold>) The motor unit filters identified from the reference contraction (i.e. trapezoidal contraction at 20% MVC) were then applied in real-time on the incoming EMG signals simulated during the sinusoidal contraction. The rates of agreement are displayed for each motor unit; the line is the median. (<bold>D</bold>) The motor unit filters identified at 20% MVC were applied in real-time on signals simulated during contractions at 10 and 30% MVC. Rates of agreement, sensitivity (sens.), false negative rates (FNR.), and precision (prec.) are displayed for each motor unit. The lower precision for motor units identified in real time at 30% MVC can be explained by the presence of a <italic>merged</italic> motor unit, as highlighted on this example. The red dots represent the discharge times of this <italic>merged</italic> motor unit while the green dots represent the discharge times of the targeted motor unit.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88670-fig3-v1.tif"/></fig><p>Motor unit filters estimated during a baseline contraction at 20% MVC were then applied in real time on signals simulated during a contraction with a different pattern (sinusoidal; <xref ref-type="fig" rid="fig3">Figure 3C</xref>). The rates of agreement between the online decomposition and the ground truth reached 96.3 ± 4.6% and 98.4 ± 2.3% for surface and intramuscular EMG signals, respectively. Finally, we tested whether the accuracy of the online decomposition changed when the level of force decreased or increased by 10% MVC when compared to the calibration performed at 20% MVC (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). The rate of agreement remained high when applying the motor unit filters on signals recorded at 10% MVC: 99.8 ± 0.2% (surface EMG) and 99.5 ± 0.3% (intramuscular EMG). It is worth noting that only 3 out of 10 motor units identified from surface EMG at 20% MVC were active at 10% MVC, while 8 out of 12 motor units identified from intramuscular EMG were active at 10% MVC. This shows how the decomposition of EMG signals tends to identify the last recruited motor units, which often innervate a larger number of fibres than the early recruited motor units (<xref ref-type="bibr" rid="bib26">Henneman, 1957</xref>). On the contrary, the application of motor unit filters on signals simulated at 30% MVC led to a decrease in the rate of agreement, with values of 88.6 ± 14.0% (surface EMG) and 80.3 ± 19.2% (intramuscular EMG). This decrease in accuracy did not impact all the motor units, with five motor units keeping a rate of agreement above 95% in both signals. For the other motor units, we observed a decrease in precision, which estimates the ratio of true discharge times over the total number of identified discharge times. This was caused by the recruitment of two motor units sharing a similar space within the muscle, which resulted in a merge in the same pulse train (<xref ref-type="fig" rid="fig3">Figure 3D</xref>).</p></sec><sec id="s2-5"><title>Application of motor unit filters in experimental data</title><p>We then asked eight participants (four males and four females) to perform trapezoidal isometric contractions with plateaus of force set at 10 and 20% MVC during which surface EMG signals were recorded from the TA with 256 electrodes separated by 4 mm. The aim of this experiment was to confirm the results of the simulation; specifically, to test the accuracy of the online decomposition when the level of force was below, equal to, or above the level of force produced during the baseline contraction used to estimate the motor unit filters (<xref ref-type="fig" rid="fig4">Figure 4</xref>). We assessed the accuracy of the motor unit spike trains identified in real time using their manually edited version as reference. A total of 144 motor units were identified at both 10 and 20% MVC. When the test signals were recorded at the same level of force as the baseline contraction, we obtained rates of agreement of 95.6 ± 6.8% (10% MVC) and 93.9 ± 5.9% (20% MVC). The sensitivity reached 95.9 ± 6.7% (10% MVC) and 94.4 ± 5.6% (20% MVC), and the precision reached 99.6 ± 1.3% (10% MVC) and 99.4 ± 1.9% (20% MVC).</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Reapplication of motor unit filters on electromyographic (EMG) signals recorded at varying contraction intensities.</title><p>Surface EMG signals were recorded during isometric contractions at 10 and 20% maximal voluntary contraction (MVC). We compared the motor unit spike trains identified in real time with their manually edited version. The contraction intensity of the test contraction was either equal to (20% =&gt; 20% in <bold>A</bold>; dark red &amp; 10% =&gt; 10% in <bold>B</bold>; light red), below (20% =&gt; 10% in <bold>A</bold>; light red), or above (10%=&gt;20% in B; dark red) the level of the baseline contraction. We calculated the rate of agreement (ROA), the sensitivity (Sens.), the false negative rate (FNR.), and the precision (Prec.) for each motor unit. Each dot is an individual motor unit, each box represents the 25th and 75th percentiles of the distribution of values, and each line is the median. The lower precision in (<bold>B</bold>) was caused by the presence of a <italic>merged</italic> motor unit in the motor unit pulse train. The red dots represent the discharge times of this <italic>merged</italic> motor units while the green dots represent the discharge times of the targeted motor unit.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88670-fig4-v1.tif"/></fig><p>When the filters identified at 20% MVC were applied on signals recorded at a lower level of force (10% MVC), the rates of agreement decreased to 87.9 ± 16.2%. The sensitivity also decreased to 88.0 ± 16.2%, but the precision remained high (99.4 ± 4.3). Thus, the decrease in accuracy was mostly caused by missed discharge times rather than the false identification of artefacts or spikes from other motor units. When the filters identified at 10% MVC were applied to signals recorded at a higher level of force, the rates of agreement decreased to 83.3 ± 13.5%. The sensitivity decreased to 90.7 ± 8.1%, and the precision also decreased to 90.9 ± 12.6%. This result confirms what was observed with synthetic EMG, that is, motor units recruited between 10 and 20% MVC can substantially disrupt the accuracy of the decomposition in real time, as highlighted in <xref ref-type="fig" rid="fig4">Figure 4</xref> (lower panel). Importantly, this situation does not happen for all the motor units, as suggested by the distribution of the values in <xref ref-type="fig" rid="fig4">Figure 4</xref>.</p></sec><sec id="s2-6"><title>Accuracy of the online decomposition in different muscles</title><p>Twenty-one male participants completed additional experiments to test the accuracy of the online decomposition in different muscles (vastus lateralis [VL] and medialis [VM], gastrocnemius lateralis [GL] and medialis [GM], and tibialis anterior [TA]). They all performed isometric contractions at 20 and 40% MVC while EMG signals were recorded with either grids of 64 surface electrodes (VL, VM, GL, GM, TA) or an intramuscular array of 16 electrodes (TA).</p><p>At 20% MVC, 94 (VL; eight participants), 21 (VM; eight participants), 14 (GL; eight participants), 56 (GM; eight participants), 68 (TA grid; five participants), and 9 motor units (TA intra; one participant) motor units were identified. At 40% MVC, 76 (VL), 21 (VM), 19 (GL), and 25 (GM) motor units were identified. For the sake of clarity, we only report in this section the rates of agreement for each intensity and muscle. Values of sensitivity, precision, and rates of false negatives are reported in <xref ref-type="fig" rid="fig5">Figure 5</xref>. The highest rate of agreement was observed for the TA (93.6 ± 9.2% with the grid and 97.3 ± 5.2% with the intramuscular array). Those values were lower for the vastii (VL: 82.1 ± 19.7%; VM: 75.3 ± 18.5%) and gastrocnemii muscles (GL: 88.1 ± 7.8%; GM: 81.0 ± 17.7). When considering the contractions performed at 40% MVC, the rate of agreement was 84.0 ± 15.6% for VL, 75.2 ± 20.6% for VM, 82.5 ± 8.1% for GL, and 87.9 ± 8.7% for GM (<xref ref-type="fig" rid="fig5">Figure 5</xref>).</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Accuracy of the online electromyographic (EMG) decomposition.</title><p>We compared the motor unit spike trains identified in real time with their manually edited version. We calculated the rate of agreement, the sensitivity, the false negative rate, and the precision for each motor unit. Each dot is an individual motor unit, each box represents the 25th and 75th percentiles of the distribution of values, each bar represents the 5th and 95th percentiles of the distribution of values, and each line is the median. VL: vastus lateralis, VM: vastus medialis, GL: gastrocnemius lateralis, GM: gastrocnemius medialis, TAg: tibialis anterior recorded with a high-density grid of electrodes, and TAi: tibialis anterior recorded with an intramuscular array of electrodes.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88670-fig5-v1.tif"/></fig></sec><sec id="s2-7"><title>Accuracy of the real-time biofeedback</title><p>Because the accuracy of the raster plot feedback is directly related to the accuracy of the estimation of the discharge times reported in the previous sections, here we only focus on the accuracy of the smoothed firing rates. It can either be displayed in a quadrant, with a cursor moving within a two-dimensional space according to the firing rates of two motor units, or with one cursor for a given identified motor units moving in the vertical direction and following a scrolling path.</p><p>At 20% MVC, the root mean squared error (RMSE) between the firing rate estimated in real time and its edited version was consistently below two pulses per second for all the motor units (<xref ref-type="fig" rid="fig6">Figure 6</xref>). The lowest RMSE was observed with the TA muscle (0.64 ± 0.77 pps and 0.44 ± 0.43 pps with grids and intramuscular arrays of electrodes). RMSE was 1.4 ± 1.5 pps for VL, 1.8 ± 1.5 pps for VM, 1.7 ± 1.1 pps for GL, and 1.1 ± 1.1 pps for GM. At 40% MVC, the RMSE reached 1.1 ± 1.2 pps for VL, 1.8 ± 1.1 pps for VM, 0.8 ± 0.5 pps for GL, and 0.6 ± 0.4 pps for GM. Overall, these RMSE provides strong evidence that the biofeedback accurately reflects the motor unit firing activity. It is highlighted by the two examples displayed in <xref ref-type="fig" rid="fig6">Figure 6B</xref>, with a raw smoothed firing rate with an RMSE at 0.83 pps, and in <xref ref-type="fig" rid="fig6">Figure 6C</xref>, with firing rates displayed in a quadrant with an average RMSE of 1.75 pps. Videos of the different forms of feedback are available in the GitHub.</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Accuracy of the visual feedback based on the motor unit smoothed firing rates.</title><p>The online electromyographic (EMG) decomposition was provided to the participants in the form of different visual feedback. We estimated the accuracy of the feedback by calculating the root mean squared error (RMSE) between the smoothed firing rates estimated from the motor unit spike trains identified in real time and from their manually edited version at 20% maximal voluntary contraction (MVC) (<bold>A</bold>) and 40% MVC (<bold>B</bold>). Each dot is an individual motor unit, each box represents the 25th and 75th percentiles of the distribution of values, each bar represents the 5th and 95th percentiles of the distribution of values, and each line is the median. VL: vastus lateralis, VM: vastus medialis, GL: gastrocnemius lateralis, GM: gastrocnemius medialis, TAg: tibialis anterior recorded with a high-density grid of surface electrodes, and TAi: tibialis anterior recorded with an intramuscular array of electrodes. (<bold>C</bold>) Smoothed firing rate of a motor unit provided in real time (Real time, red) vs. its manually edited version (Reference, grey). (<bold>D</bold>) Quadrant plot provided in real time (Real time, red) vs. its manually edited version (Reference, grey). Each dot represents the position of the cursor during one window of 125 ms.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88670-fig6-v1.tif"/></fig></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><sec id="s3-1"><title>Assumptions of the algorithm</title><p>There are processing assumptions for the blind-source separation algorithm to accurately identify motor unit discharge times from multichannel EMG signals. Among them, the most important is the uniqueness of the distribution of motor unit action potentials across electrodes (that defines the separation vector) among all the other active motor units within the recording volume (<xref ref-type="bibr" rid="bib7">Caillet et al., 2023</xref>; <xref ref-type="bibr" rid="bib16">Farina et al., 2008a</xref>). When this condition is not met, merged motor units appear in the motor unit pulse train, causing an increase in false positives (<xref ref-type="fig" rid="fig3">Figures 3</xref> and <xref ref-type="fig" rid="fig4">4</xref>) One way to satisfy this condition is to increase the selectivity of the electrodes to record the discharge activity of only a few motor units from a small volume of muscle (<xref ref-type="bibr" rid="bib35">LeFever and De Luca, 1982</xref>). For example, <xref ref-type="fig" rid="fig1">Figure 1A</xref> shows motor unit action potentials detected only over 3–4 electrode sites along the array of intramuscular electrodes, while a motor unit action potential can be observed across many more electrodes with grids of surface electrodes. Therefore, the likelihood of having spatially overlapping motor unit action potentials – and thus merged motor units – is lower, which explains why the rate of agreement of motor units identified from intramuscular arrays of electrodes is much higher than grids of surface electrodes (<xref ref-type="bibr" rid="bib44">Muceli et al., 2015</xref>; <xref ref-type="bibr" rid="bib45">Muceli et al., 2022</xref>). A second way to increase the percentage of discriminable motor units among all the active motor units in the recording volume is to increase the spatial sampling of their activity using multiple electrodes (<xref ref-type="bibr" rid="bib19">Farina et al., 2016</xref>; <xref ref-type="bibr" rid="bib7">Caillet et al., 2023</xref>; <xref ref-type="bibr" rid="bib18">Farina and Holobar, 2016</xref>; <xref ref-type="bibr" rid="bib16">Farina et al., 2008a</xref>). This has led to the growth of EMG recording systems with dense grids of surface electrodes (<xref ref-type="bibr" rid="bib19">Farina et al., 2016</xref>), which compensate for the lack of specificity of motor unit action potential profiles that are recorded when using a pair of traditional bipolar EMG electrodes (<xref ref-type="bibr" rid="bib36">Lindstrom and Magnusson, 1977</xref>).</p><p>Another necessary condition for EMG decomposition using the blind-source separation algorithm is the consistency of the motor unit filters across time. An obvious reason inducing changes in motor unit filters would be the displacement of the electrodes relatively to the source. Such drifts also exist with intracortical arrays and can be corrected with appropriate methods that track waveforms across electrodes (<xref ref-type="bibr" rid="bib53">Steinmetz et al., 2021</xref>). However, the geometry of the muscle tissue is much more variable than that of the cortical tissue, especially during movements. For example, muscle bellies become bulkier while shortening (<xref ref-type="bibr" rid="bib27">Herbert et al., 2019</xref>), increasing the distance between the surface electrodes and the deep sources. In addition, the pennation angle of muscle fibres can change with contraction intensity (<xref ref-type="bibr" rid="bib23">Fukunaga et al., 1997</xref>), modifying the direction of the propagation of motor unit action potentials along the fibres relatively to the position of the electrodes. All these factors impact the recorded motor unit action potential profiles across electrodes, which in turn will reduce the capacity to discriminate the same motor unit from the EMG signal (<xref ref-type="bibr" rid="bib47">Oliveira and Negro, 2021</xref>; <xref ref-type="bibr" rid="bib15">Farina et al., 2004</xref>; <xref ref-type="bibr" rid="bib24">Glaser et al., 2017</xref>). For these reasons, we recommend applying our approach during isometric contractions with a stable level of force, as even large changes in force during isometric contractions can impact the orientation of the muscle fibres relatively to the skin within muscles (<xref ref-type="bibr" rid="bib33">Ito et al., 1998</xref>).</p></sec><sec id="s3-2"><title>Usage of the software</title><p>The first step of the algorithm consists of identifying motor unit separation vectors (motor unit filters) from EMG signals with fastICA (<xref ref-type="bibr" rid="bib46">Negro et al., 2016</xref>; <xref ref-type="bibr" rid="bib3">Barsakcioglu et al., 2021</xref>; <xref ref-type="bibr" rid="bib8">Chen and Zhou, 2016</xref>). Classically, metrics such as the Pulse to Noise ratio (<xref ref-type="bibr" rid="bib31">Holobar et al., 2014</xref>) or the silhouette value (<xref ref-type="bibr" rid="bib46">Negro et al., 2016</xref>) are used to assess the reliability of the identified motor units by estimating the distance between the spikes and the noise. Here, we purposely reported all the motor units identified from offline decomposition in <xref ref-type="fig" rid="fig2">Figure 2</xref> to illustrate the importance of manual editing, but a threshold should be used to automatically remove inaccurate spike trains (i.e. 0.9 in <xref ref-type="bibr" rid="bib46">Negro et al., 2016</xref>). It is noteworthy that such approach must always be associated with extensive manual editing to remove the discharge times incorrectly selected and to add missing spikes (<xref ref-type="bibr" rid="bib12">Del Vecchio et al., 2020</xref>; <xref ref-type="bibr" rid="bib32">Hug et al., 2021</xref>). This necessary step precedes the update of the motor unit filter with all the detected spikes (<xref ref-type="bibr" rid="bib29">Holobar et al., 2010</xref>), leading to an increase in the silhouette value and a decrease in the coefficient of variation of the interspike intervals (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). Alternatively, one could speed up the processing flow by setting a higher threshold for the silhouette value. This would decrease the burden of manual editing at the cost of decreasing the number of identified motor units. However, it is important to note that using more stringent criteria does not preclude the manual editing, even for motor units with a high silhouette value (see motor units 1 and 2 with missed spikes in <xref ref-type="fig" rid="fig1">Figure 1B</xref>).</p><p>The second step of the algorithm consists of identifying motor units discharge times in real time by projecting extended segments of EMG signals on separation vectors (motor unit filters) to estimate motor unit pulse trains (<xref ref-type="fig" rid="fig1">Figure 1B</xref>; <xref ref-type="bibr" rid="bib3">Barsakcioglu et al., 2021</xref>; <xref ref-type="bibr" rid="bib10">Chen et al., 2020</xref>). This method was effective at identifying motor unit discharge times, with rates of agreement &gt;0.75, regardless of the contraction intensity and muscle (<xref ref-type="fig" rid="fig5">Figure 5</xref>). It is noteworthy that the performance was particularly high for the recordings made with an intramuscular array of electrodes (rate of agreement of 0.97 ± 0.05, <xref ref-type="fig" rid="fig5">Figure 5</xref>). As mentioned above, the better performance of blind-source separation on multichannel intramuscular EMG has already been reported with offline analyses (<xref ref-type="bibr" rid="bib44">Muceli et al., 2015</xref>; <xref ref-type="bibr" rid="bib45">Muceli et al., 2022</xref>; <xref ref-type="bibr" rid="bib9">Chen et al., 2019</xref>). This is explained by the higher spatial selectivity of the electrodes (<xref ref-type="bibr" rid="bib35">LeFever and De Luca, 1982</xref>), the larger bandwidth of the signal (<xref ref-type="bibr" rid="bib36">Lindstrom and Magnusson, 1977</xref>), and the higher robustness of the motor unit filter as the signal is less affected by the geometric changes of the volume conductor. In contrast, precision and rates of agreements were lower for motor units identified over the vastii and gastrocnemii muscles when compared to the TA muscle (<xref ref-type="fig" rid="fig5">Figure 5</xref>). Even though the reason for this between-muscle difference is unclear, it is possible that the specific activation level of the vastii and gastrocnemii muscles varied more than that of TA between the baseline and test contractions because of muscle redundancy leading to multiple coordination strategies possible to perform knee flexion or plantarflexion. For example, a decrease in activation would decrease the height of the peaks of the estimated sources, potentially classified in the noise class during the online decomposition (<xref ref-type="bibr" rid="bib10">Chen et al., 2020</xref>). Conversely, an increase in activation may activate motor units spatially close to those observed during the baseline contraction, corrupting their pulse train with merged sources (<xref ref-type="bibr" rid="bib30">Holobar and Farina, 2014</xref>; <xref ref-type="bibr" rid="bib18">Farina and Holobar, 2016</xref>). This explanation is in line with the lower rate of agreement observed when participants tracked a force target higher than the level of the baseline contraction (<xref ref-type="fig" rid="fig3">Figures 3</xref> and <xref ref-type="fig" rid="fig4">4</xref>). One way to overcome these challenges would be to dynamically update the motor unit filters and the centroids of the ‘spikes’ and ‘noise’ classes (<xref ref-type="bibr" rid="bib10">Chen et al., 2020</xref>; <xref ref-type="bibr" rid="bib55">Yeung et al., 2024</xref>; <xref ref-type="bibr" rid="bib42">Mendez Guerra et al., 2024</xref>). While appealing, this approach is also computationally demanding (<xref ref-type="bibr" rid="bib10">Chen et al., 2020</xref>; <xref ref-type="bibr" rid="bib55">Yeung et al., 2024</xref>; <xref ref-type="bibr" rid="bib42">Mendez Guerra et al., 2024</xref>). We propose to update the motor unit filters and the centroids of the ‘spikes’ and ‘noise’ classes during the resting periods. In addition, it is recommended that the operator displays the motor unit pulse trains and identified discharge times between contractions to check for decomposition accuracy across the session.</p></sec><sec id="s3-3"><title>Inter-individual differences in motor unit yields</title><p>An important consideration regarding the implementation of offline or real-time surface EMG decomposition is the difference between individuals, with an overall lower yield in number of identified motor units in females (here: 9 ± 12) than in males (here: 30 ± 13). Typically, the number of identified motor units from surface EMG is twice as low in females than males (<xref ref-type="bibr" rid="bib12">Del Vecchio et al., 2020</xref>; <xref ref-type="bibr" rid="bib37">Lulic-Kuryllo and Inglis, 2022</xref>; <xref ref-type="bibr" rid="bib54">Taylor et al., 2022</xref>). The cause for this difference remains unclear. It may be related to variations in properties of the tissues separating the motor units from the recording electrodes, or to differences in the morphological and physiological properties of muscle fibres, as well as to the innervation ratios of motor units. These sex-related differences have so far only been supported by data extracted from animal experiments (<xref ref-type="bibr" rid="bib43">Mierzejewska-Krzyżowska et al., 2011</xref>). However, the recent developments of simulation frameworks capable of generating highly realistic EMG signals for anthropometrically diverse populations may help understanding the impact of sex-related differences in humans (<xref ref-type="bibr" rid="bib38">Maksymenko et al., 2023</xref>). Specifically, these simulations can account for diverse anatomical (e.g. muscle volume and architecture, thickness of subcutaneous tissues) and physiological characteristics (e.g. innervation ratio, number of motor units, fibre cross-sectional area, fibre conduction velocity, contribution of rate coding vs. spatial recruitment). Generating such dataset could help identifying the primary factors affecting EMG decomposition performance, ultimately enabling the refinement of algorithms and/or surface electrode design.</p></sec><sec id="s3-4"><title>Summary</title><p>Overall, the main purpose of our software is to display to the participant a real-time visual feedback based on the activity of individual motor units or populations of motor units. The RMSE of the smoothed discharge rates was constantly below two pulses per second, with values as low as 0.44 ± 0.43 pps for the TA muscle recorded with intramuscular electrode arrays. Thus, the movement of the cursors accurately represented the variations in motor unit firing activity to the participant. In this study we have presented results of control of smoothed firing rates over a relatively large smoothing window, but the duration of the smoothing filter can be chosen by the user according to the needs and applications. Operators could use the provided software to interact with a virtual environment, such as typing on a keyboard with a cursor moved by modulating motor unit firing rates (<xref ref-type="bibr" rid="bib21">Formento et al., 2021</xref>). In the field of motor control, neuroscientists may train participants to selectively activate individual motor units (<xref ref-type="bibr" rid="bib5">Bräcklein et al., 2022</xref>), testing the concept of rigid versus flexible motor control (<xref ref-type="bibr" rid="bib21">Formento et al., 2021</xref>; <xref ref-type="bibr" rid="bib5">Bräcklein et al., 2022</xref>; <xref ref-type="bibr" rid="bib39">Marshall et al., 2022</xref>), or movement augmentation (<xref ref-type="bibr" rid="bib13">Eden et al., 2022</xref>). Generally, we hope that this open-source software will open perspectives for neuroscientists to design experimental paradigms that takes advantage of online EMG decomposition to study the neural control of movements at the motor neuron level.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Simulation of EMG signals</title><p>We generated synthetic EMG signals using an anatomical model of a cylindrical muscle volume with parallel fibres surrounded by subcutaneous tissues and skin (<xref ref-type="bibr" rid="bib16">Farina et al., 2008a</xref>; <xref ref-type="bibr" rid="bib34">Konstantin et al., 2020</xref>). The muscle radius was 10 mm, and the thicknesses of the subcutaneous and skin layers were 4 mm and 1 mm, respectively. The centres of 150 motor unit territories were randomly and evenly distributed across the muscle cross-section. The number of fibres innervated by each motor neuron followed an exponential distribution, ranging from 66 to 3321 (<xref ref-type="bibr" rid="bib14">Enoka and Fuglevand, 2001</xref>). The fibres of the same motor unit were positioned around the centre of the motor unit within areas of 0.8–78.5 mm². The fibre density in the muscle reached 400 fibres/mm². The motor unit action potentials were detected in the model by either a grid of 64 circular surface electrodes with a diameter of 1 mm arranged in 5 columns and 13 rows (inter-electrode distance: 4 mm) or 16 circular intramuscular electrodes arranged in a single array (inter-electrode distance: 1 mm). The grid was centred over the muscle in the transverse direction. The intramuscular electrode array was centred with respect to the grid and inserted at an angle of 30° along the longitudinal direction of the volume toward the centre of the muscle.</p><p>Four profiles of force were generated, with either trapezoidal patterns reaching 10, 20, or 30% of the maximal force, or a sinusoidal pattern with the force varying between 15 and 25% MVC at a rate of 0.5 Hz. Each discharge time elicited single-fibre electrical potentials, summed together within each motor unit. The profile of each motor unit action potential changed between electrodes according to the morphology of the fibres and the distance of the fibres relative to the electrode. Ultimately, the synthetic EMG signal represented the sum of all motor unit action potentials and Gaussian noise.</p></sec><sec id="s4-2"><title>Electromyographic recordings</title><p>The accuracy and capabilities of the online EMG decomposition algorithm was tested on a series of experimental data collected with either surface or intramuscular arrays of electrodes from five different muscles.</p><p>Surface EMG signals were recorded from the gastrocnemius medialis and lateralis (GM and GL; triceps surae protocol) or the vastus medialis and lateralis (VM and VL; quadriceps protocol) with two-dimensional adhesive grids of 64 electrodes (13 × 5 electrodes with one electrode absent on a corner, gold-coated, interelectrode distance: 8 mm; GR08MM1305, OT Bioelettronica). Surface EMG signals were recorded from the tibialis anterior with four two-dimensional adhesive grids of 64 electrodes (13 × 5 electrodes with one electrode absent on a corner, gold-coated, interelectrode distance: 4 mm; GR04MM1305, OT Bioelettronica). Before the placement of the grids, the skin was shaved and cleaned with an abrasive gel (Nuprep, Weaver and Company, USA). Each adhesive grid was held on the skin using a disposable adhesive foam layer. The cavities within the adhesive layer were filled with conductive paste (SpesMedica, Italy) to facilitate the skin-electrode contact. A 10-cm-wide elastic band was placed over the electrodes to ensure good contact between the electrodes and the skin throughout the experiment.</p><p>An intramuscular linear array of 16 electrodes on a thin-film (platinum-coated, interelectrode distance: 1 mm) was inserted into the tibialis anterior in one participant at an approximate angle of 30°. The insertion was guided with a portable ultrasound probe (Butterfly IQ+, Butterfly Network, USA).</p><p>A reference electrode was positioned over the tibia of the right limb (triceps surae protocol), over the patella of the right limb (quadriceps protocol), or over the medial malleolus (tibialis anterior protocol). A strap electrode dampened with water was placed around the ankle (ground electrode) for each data collection. The EMG signals were recorded in monopolar mode and digitized together with the torque signal at a sampling rate of 2048 Hz for the grids of surface electrodes and 10,240 Hz for the intramuscular array of electrodes (EMG-Quattrocento, 400 channel EMG amplifier; OT Bioelettronica).</p></sec><sec id="s4-3"><title>Experimental procedure</title><p>A total of 29 individuals participated in the experiments (4 females/25 males; 28 ± 5 years old; 178 ± 6 cm; 73 ± 16 kg). None of the participants reported lower limb injury or pain in the 6 months prior to testing. Ethical committees approved the study (triceps surae and quadriceps protocols: CERNI – Nantes Université, n°04022022; tibialis anterior protocol: Imperial College London, no. 18IC4685). All participants provided their informed written consent before the beginning of the experiment.</p><p>The right side of the body was tested for all participants and for all protocols. For the triceps surae protocol, participants sat on a dynamometer (Biodex System 3 Pro, Biodex Medical, USA) with their hip flexed at 80°, 0° being the neutral position, and their right leg fully extended. Their ankle angle was set to 10° of plantarflexion, 0° being the foot perpendicular to the shank. For the quadriceps protocol, participants sat on the dynamometer with their hips flexed at 80° and the knee of their right leg flexed at 80°, 0° being the full extension. Inextensible straps were tightened during both tasks to immobilise the torso, pelvis, and thigh on the test side. For the tibialis anterior protocol, participants sat on a chair while their foot was fixed onto the pedal of a dynamometer (OT Bioelettronica) coupled with a load cell (CCT Transducer, Italy) and positioned at 30° in the plantarflexion direction (0° being the foot perpendicular to the shank). The foot was fixed to the pedal with inextensible straps positioned around the proximal phalanx, metatarsal, and cuneiform. Force signals were recorded using the same acquisition system as for the EMG recordings (EMG-Quattrocento; OT Bioelettronica).</p><p>All experiments began with a standardised warm up, which included five 3 s isometric plantar flexion or knee extension contractions at 50, 60, 70, and 80%, and three 3 s contractions at 90% of the participants’ subjective maximal torque. Then, after 2 min of rest, participants performed three MVCs for 3–4 s, with 60 s of rest in between. Peak MVC torque was considered as the maximal value obtained from a moving average window of 250 ms.</p><p>For the triceps surae and quadriceps protocols, participants performed three trapezoid isometric contractions at 40% of the MVC (referred to as baseline contractions) to identify motor unit filters offline. Each of these contractions involved a 5 s ramp-up, a 20 s plateau, and a 5 s ramp-down phase and was separated by 60 s of rest. The separation vectors were identified offline from these contractions and then applied in real time to estimate the firing activity of each identified motor unit during three additional trapezoid contractions (referred to as the online task). Each of these online tasks involved a 5 s ramp-up, a 30 s plateau, and a 5 s ramp-down phase and was separated by 60 s of rest. To test the effect of variations in contraction intensity between the online task and the baseline contraction used to identify the separation vectors, each plateau consisted of three successive 10 s targets at 35, 40, or 45% of the MVC performed in a random order. During these online tasks, feedback of motor unit discharge times and torque output was displayed in real time on a monitor to the participants.</p><p>To test the effect of the baseline contraction intensity on the accuracy of real-time identification of motor unit discharge activity; the procedure was repeated with a baseline intensity of 20% MVC. During the last three trapezoidal contractions, each plateau consisted of three successive 10 s targets at 15, 20, or 25% of the MVC performed in a random order.</p><p>For the tibialis anterior protocol with grids of surface electrodes, participants performed a trapezoid contraction at 10 and/or 20% of the MVC, involving a 10 s ramp up, a 60 s plateau, and a 10 s ramp-down phase (baseline contraction). The separation vectors were identified from this contraction and then applied in real time over a second identical contraction (online task). The same procedure was repeated for the tibialis anterior protocol with an intramuscular array of electrodes, with contractions involving a ramp up phase of 2 s, a plateau of 20 s, and a ramp-down phase of 2 s.</p></sec><sec id="s4-4"><title>Data processing</title><sec id="s4-4-1"><title>Mathematical modelling of the recorded spike trains</title><p>The spike train of a motor neuron recorded over time <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> can be described as the result of a convolution between a delta function (δ) representing the firing times (φ), and finite impulse responses (<italic>h</italic>) representing action potentials of duration <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi><mml:mo>:</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>r</mml:mi></mml:munder><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. In practice, the nature of <italic>h</italic> and the duration L depend on the type of recordings. For electrophysiological measurements, <italic>h</italic> characterises the local electrical field generated by the spike and conducted through the surrounding tissues.</p><p>As the recorded volume of tissue comprises many active neurons, each recording can be considered as a convolutive mixture of multiple sources, and the previous equation can be expressed in the form of a matrix to also consider all the electrodes of an array: given <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>r</mml:mi></mml:munder><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>φ</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>;</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is a matrix of <italic>m</italic> electrophysiological signals, <inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>  is a matrix of <italic>n</italic> motor neurons’ spike trains, and <inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is a <italic>m</italic> by <italic>n</italic> matrix containing the <italic>l</italic>th sample of action potentials from <italic>n</italic> neurons and <italic>m</italic> signals. In this situation, we can reformulate the model as an instantaneous mixture of an extended set of sources, that is, the motor neurons’ spike trains and their delayed versions. This allows us to simply write the previous equation as a multiplication of matrices, in which each source is delayed L times, L being the duration of the impulse response <italic>h</italic>. This model can be inverted for neural decoding with source-separation approaches.</p></sec><sec id="s4-4-2"><title>Identification of separation vectors (motor unit filters) with blind-source separation</title><p>The monopolar EMG signals collected during the baseline contractions were extended with an extension factor of <inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mn>1000</mml:mn><mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib28">Holobar and Zazula, 2007</xref>), where <italic>m</italic> is the number of channels free of any noise or artefact. The signals were then demeaned and whitened. A contrast function was iteratively applied to estimate a separation vector that maximised the level of sparseness of the motor unit pulse train (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). This loop stopped when the variation of the separation vector between two successive iterations reaches a predefined lower bound. After the application of a peak detection algorithm, the motor unit pulse train contained high peaks (i.e. the spikes from the identified motor unit) and low peaks from other motor units and noise. High peaks were separated from low peaks and noise using k-mean classification with two classes (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). The peaks from the class with the highest centroid were considered as spikes of the identified motor unit. A second algorithm refined the estimation of the discharge times by iteratively recalculating the separation vector and repeating the steps with peak detection and k-mean classification until the coefficient of variation of the interspike intervals was minimised. The accuracy of each estimated spike train was assessed by computing the silhouette (SIL) value between the two classes of peaks identified with k-mean classification (<xref ref-type="bibr" rid="bib46">Negro et al., 2016</xref>). When the SIL exceeded a predetermined threshold, the motor unit filter was saved for the real-time decomposition, together with the centroids of the ‘spikes’ and ‘noise’ classes (<xref ref-type="fig" rid="fig1">Figure 1B</xref>).</p></sec><sec id="s4-4-3"><title>Manual editing</title><p>There is a consensus among experts that automatic decomposition should be followed by visual inspection and manual editing (<xref ref-type="bibr" rid="bib40">Martinez-Valdes et al., 2023</xref>). Manual editing involves the following steps: (1) removing spikes that result in erroneous firing rates (outliers), (2) adding discharge times that are clearly distinguishable from the noise, (3) recalculating the separation vector, (4) reapplying the separation vector on the EMG signals (either a selected window or the entire signal), and (5) repeating this procedure until no outliers are present and all clearly distinguishable spikes have been selected. Importantly, the manual editing of potentially missed or falsely identified discharge times should not be accepted before the application of the updated motor unit separation vector, thereby generating a new pulse train. Manual edits should be accepted only if the silhouette value improves following this operation or remains well above the pre-established threshold. A more extensive description of the manual editing of motor unit pulse trains can be found in <xref ref-type="bibr" rid="bib12">Del Vecchio et al., 2020</xref>. Even though some of the aforementioned steps involve subjective decision-making, evidence suggests that manual editing after EMG decomposition with blind-source separation approaches remains highly reliable across operators (<xref ref-type="bibr" rid="bib32">Hug et al., 2021</xref>). Specifically, the median rate of agreement calculated for 126 motor units over eight operators with various experience in manual editing was 99.6%. All raw and processed data have been made available on a public data repository so that they can be used for training new operators (<ext-link ext-link-type="uri" xlink:href="http://doi.org/10.6084/m9.figshare.13695937">http://doi.org/10.6084/m9.figshare.13695937</ext-link>).</p></sec><sec id="s4-4-4"><title>Real-time identification of motor neuron activities</title><p>EMG signals were transmitted by packages of 256 data points for the surface grid recordings (125 ms with a sampling frequency of 2048 Hz) or 1280 data points for the intramuscular array recordings (125 ms with a sampling frequency of 10,240 Hz). The <italic>electrode mask</italic> determined from the baseline contractions was applied to remove the channels with noise or artefacts and the data was extended using the same extension factor as for the baseline contraction (see the section on EMG decomposition above). The matrix of separation vectors identified during the baseline contraction was applied over the extended EMG signal. Local peaks were identified for each motor unit using the MATLAB function ‘islocalmax’ with a minimal separation of 25 ms between peaks to limit the number of false positives (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). These peaks were considered as spikes when their distance from the centroid of the ‘spike’ class was shorter than the distance from the centroid of the ‘noise’ class (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). Both centroids were identified from the offline decomposition made on the baseline contraction.</p><p>We calculated the firing rate (i.e. spikes per second) of individual motor units as the sum of the spikes over a moving window of eight consecutive epochs of 125 ms. We chose this approach to facilitate the smoothness of the visual feedback, in contrast to the instantaneous firing rate, which is calculated as the instantaneous inversed interspike interval, which oscillates more due to the presence of synaptic noise. While this approach introduces a delay of 500 ms in the estimation of the firing rate, we identified in pilot testing that this also facilitates the control of motor unit firing activities by the participant. To further increase the smoothness of the online biofeedback, we added the option in the software to average individual firing rates using a moving window. For the data reported in this article, we selected a value of four consecutive values, corresponding to a window of 500 ms. Note that researchers who aim to minimise the delay of the visual feedback can disable this option, change its value, or use the real-time raster plots that displays the instantaneous discharge times of each motor unit.</p></sec><sec id="s4-4-5"><title>Computational time</title><p>The computational time depends on the number of identified motor units during the baseline contraction, the number of peaks sorted during each epoch, and the number of EMG channels retained for the analysis. We considered the computational time for the decomposition as the time between the reception of the EMG signals by the computer and the estimation of the discharge times of all the identified motor units. We considered the computational time for the feedback as the time between the decomposition of the EMG signals and the update of the online feedback. The computational times were calculated on a laptop equipped with an Apple M1 Max chip and 64 GB of RAM.</p><p>On average, the time between the reception of an epoch of EMG signals and the identification of the spikes was 4.9 ± 3.0 ms for data collected with high-density grids of surface electrodes. To estimate the computational time per motor unit, we performed a linear regression between the number of identified motor units and the computational time per epoch using data from all the experiments made with high-density surface electrodes. The slope of the linear fit, that is, the computational time per motor unit, was 0.37 ms (<xref ref-type="fig" rid="fig7">Figure 7A</xref>). Across all the experiments, the maximal computational time was 13.1 ms for 26 identified motor units. Of note, when considering the experiment made with intramuscular arrays of electrodes, the computational time reached 32.0 ms for nine identified motor units. This was longer than observed for the same number of identified motor units using high-density surface electrodes (5.2 ms; <xref ref-type="fig" rid="fig7">Figure 7B</xref>) and was due to the greater sampling frequency used for the intramuscular recordings.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Computational time of the online electromyographic (EMG) decomposition.</title><p>(<bold>A</bold>) We considered the computational time for the decomposition as the time between the reception of the EMG signals and the identification of the spikes for all the motor units. We computed the linear regression between the number of identified motor units and the computational time and considered the slope as the computational time per motor unit. Each dot represents one decomposition, and the colour scheme depends on the muscle. (<bold>B</bold>) As the sampling frequency differed between recordings with high-density grids and intramuscular arrays of electrodes, we compared the computational times for both techniques with the same number of identified motor units (i.e. 9). (<bold>C, D</bold>) After the decomposition, the motor unit discharge activity was translated into visual feedback, either in the form of a raster plot or the smoothed firing rates for all the identified motor units. As for the decomposition, we normalised the computational time per motor unit using a linear regression.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88670-fig7-v1.tif"/></fig><p>We then calculated the additional computational time to display visual feedback in the form of a raster plot or smoothed firing rates of all the identified motor units. On average, we observed computational times of 8.6 ± 5.7 ms and 11.2 ± 7.6 ms for raster plots and smoothed firing rates, respectively. The computational time per motor unit was 0.74 ms and 0.99 ms for raster plots and smoothed firing rates, respectively (<xref ref-type="fig" rid="fig7">Figure 7</xref>). Of note, the computational time for the quadrant plot made from the activity of two motor units reached 14.8 ± 0.0 ms on average. The standard deviation of computational times across windows reached 5.4 ± 4.0 ms (raster plot), 4.0 ± 3.2 ms (smoothed firing rate), and 2.8 ± 2.5 ms (quadrant). It is noteworthy that the computational times for experiments with grids of electrodes or intramuscular arrays of electrodes was similar regardless of the type of visual feedback (<xref ref-type="fig" rid="fig7">Figure 7</xref>). Overall, as the total computational time was constantly shorter than the duration of an epoch of EMG signals, the visual feedback was always updated during the recording of the next epoch of EMG signals. Therefore, the only delay was the incompressible recording time per epoch of signals, that is, 125 ms.</p></sec><sec id="s4-4-6"><title>Accuracy of the real-time identification of motor unit firing activity</title><p>To assess the accuracy of the real-time identification of motor unit spike trains, we compared the motor unit spike trains identified in real time with those obtained after manual editing. The manual editing was performed offline as described above (<xref ref-type="bibr" rid="bib12">Del Vecchio et al., 2020</xref>; <xref ref-type="bibr" rid="bib32">Hug et al., 2021</xref>).</p><p>The accuracy of the real-time decomposition was assessed for each motor unit by computing the sensitivity [TP/(TP + FN)], the precision [TP/(TP + FP)], the false negative rate [FN/(TP + FN)], and the rate of agreement [TP/(TP + FN + FP)] between the manually edited spike train (offline) and the spike train identified in real time.</p><p>Here, TP (true positive) is the number of spikes identified in both the real time and edited spike trains, FP (false positive) is the number of spikes only identified in the real-time spike train and FN (false negative) is the number of spikes only identified in the edited spike train.</p><p>To assess the accuracy of the biofeedback provided by the software, we measured the RMSE between the path drawn by the smoothed firing rate of motor units estimated in real time and the path estimated from the manually edited motor unit spike trains.</p></sec></sec><sec id="s4-5"><title>Data availability</title><p>The entire data set (raw and processed data) codes and a user manual of the software are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/simonavrillon/I-Spin">https://github.com/simonavrillon/I-Spin</ext-link>, copy archived at <xref ref-type="bibr" rid="bib1">Avrillon, 2024</xref>.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>inventor of a patent (Neural Interface. UK Patent application no. GB1813762.0. August23, 2018) and of a patent application (Neural interface. UK Patent application no.GB2014671.8. September 17, 2020), which are partly related to the methods and applicationsof this work. All other authors have no financial or other relationships that might lead to aconflict of interest</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Resources, Supervision, Funding acquisition, Validation, Investigation, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Supervision, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Software, Validation, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con5"><p>Supervision, Writing – review and editing</p></fn><fn fn-type="con" id="con6"><p>Resources, Writing – review and editing</p></fn><fn fn-type="con" id="con7"><p>Conceptualization, Data curation, Software, Formal analysis, Supervision, Validation, Investigation, Methodology, Writing – original draft, Writing – review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Ethical committees approved the study (triceps surae and quadriceps protocols: CERNI - Nantes Université, no. 04022022; tibialis anterior protocol: Imperial College London, no. 18IC4685). All participants provided their informed written consent before the beginning of the experiment.</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-88670-mdarchecklist1-v1.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>All data recorded for this study are available on Figshare. Code and apps associated with this study are available on Github at <ext-link ext-link-type="uri" xlink:href="https://github.com/simonavrillon/I-Spin">https://github.com/simonavrillon/I-Spin</ext-link> (copy archived at <xref ref-type="bibr" rid="bib1">Avrillon, 2024</xref>).</p><p>The following datasets were generated:</p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset1"><person-group person-group-type="author"><name><surname>Avrillon</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>TA - thin films</data-title><source>figshare</source><pub-id pub-id-type="doi">10.6084/m9.figshare.26984026</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset2"><person-group person-group-type="author"><name><surname>Avrillon</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>TA - grids</data-title><source>figshare</source><pub-id pub-id-type="doi">10.6084/m9.figshare.26983384</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset3"><person-group person-group-type="author"><name><surname>Avrillon</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>GL GM - grids</data-title><source>figshare</source><pub-id pub-id-type="doi">10.6084/m9.figshare.26983615</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset4"><person-group person-group-type="author"><name><surname>Avrillon</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>VL VM - grids</data-title><source>figshare</source><pub-id pub-id-type="doi">10.6084/m9.figshare.26983963</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Avrillon</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>I-spin</data-title><version designator="swh:1:rev:dfc9cfad9b5f078f245e64565d7bd15a3f66d116">swh:1:rev:dfc9cfad9b5f078f245e64565d7bd15a3f66d116</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:212e825295aadf996806cf8373d0efe34b90297d;origin=https://github.com/simonavrillon/I-Spin;visit=swh:1:snp:30c23b8f78d223a62b1cb6e56a2210ba30578cdb;anchor=swh:1:rev:dfc9cfad9b5f078f245e64565d7bd15a3f66d116">https://archive.softwareheritage.org/swh:1:dir:212e825295aadf996806cf8373d0efe34b90297d;origin=https://github.com/simonavrillon/I-Spin;visit=swh:1:snp:30c23b8f78d223a62b1cb6e56a2210ba30578cdb;anchor=swh:1:rev:dfc9cfad9b5f078f245e64565d7bd15a3f66d116</ext-link></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Avrillon</surname><given-names>S</given-names></name><name><surname>Hug</surname><given-names>F</given-names></name><name><surname>Baker</surname><given-names>SN</given-names></name><name><surname>Gibbs</surname><given-names>C</given-names></name><name><surname>Farina</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Tutorial on MUedit: An open-source software for identifying and analysing the discharge timing of motor units from electromyographic signals</article-title><source>Journal of Electromyography and Kinesiology</source><volume>77</volume><elocation-id>102886</elocation-id><pub-id pub-id-type="doi">10.1016/j.jelekin.2024.102886</pub-id><pub-id pub-id-type="pmid">38761514</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barsakcioglu</surname><given-names>DY</given-names></name><name><surname>Bracklein</surname><given-names>M</given-names></name><name><surname>Holobar</surname><given-names>A</given-names></name><name><surname>Farina</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Control of spinal motoneurons by feedback from a non-invasive real-time interface</article-title><source>IEEE Transactions on Bio-Medical Engineering</source><volume>68</volume><fpage>926</fpage><lpage>935</lpage><pub-id pub-id-type="doi">10.1109/TBME.2020.3001942</pub-id><pub-id pub-id-type="pmid">32746024</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Basmajian</surname><given-names>JV</given-names></name></person-group><year iso-8601-date="1963">1963</year><article-title>Control and training of individual motor units</article-title><source>Science</source><volume>141</volume><fpage>440</fpage><lpage>441</lpage><pub-id pub-id-type="doi">10.1126/science.141.3579.440</pub-id><pub-id pub-id-type="pmid">13969854</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bräcklein</surname><given-names>M</given-names></name><name><surname>Barsakcioglu</surname><given-names>DY</given-names></name><name><surname>Ibáñez</surname><given-names>J</given-names></name><name><surname>Eden</surname><given-names>J</given-names></name><name><surname>Burdet</surname><given-names>E</given-names></name><name><surname>Mehring</surname><given-names>C</given-names></name><name><surname>Farina</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>The control and training of single motor units in isometric tasks are constrained by a common input signal</article-title><source>eLife</source><volume>11</volume><elocation-id>e72871</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.72871</pub-id><pub-id pub-id-type="pmid">35670561</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buccino</surname><given-names>AP</given-names></name><name><surname>Hurwitz</surname><given-names>CL</given-names></name><name><surname>Garcia</surname><given-names>S</given-names></name><name><surname>Magland</surname><given-names>J</given-names></name><name><surname>Siegle</surname><given-names>JH</given-names></name><name><surname>Hurwitz</surname><given-names>R</given-names></name><name><surname>Hennig</surname><given-names>MH</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>SpikeInterface, a unified framework for spike sorting</article-title><source>eLife</source><volume>9</volume><elocation-id>e61834</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.61834</pub-id><pub-id pub-id-type="pmid">33170122</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caillet</surname><given-names>AH</given-names></name><name><surname>Avrillon</surname><given-names>S</given-names></name><name><surname>Kundu</surname><given-names>A</given-names></name><name><surname>Yu</surname><given-names>T</given-names></name><name><surname>Phillips</surname><given-names>ATM</given-names></name><name><surname>Modenese</surname><given-names>L</given-names></name><name><surname>Farina</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Larger and denser: an optimal design for surface grids of emg electrodes to identify greater and more representative samples of motor units</article-title><source>eNeuro</source><volume>10</volume><elocation-id>ENEURO.0064-23.2023</elocation-id><pub-id pub-id-type="doi">10.1523/ENEURO.0064-23.2023</pub-id><pub-id pub-id-type="pmid">37657923</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>M</given-names></name><name><surname>Zhou</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A novel framework based on FastICA for high density surface EMG decomposition</article-title><source>IEEE Transactions on Neural Systems and Rehabilitation Engineering</source><volume>24</volume><fpage>117</fpage><lpage>127</lpage><pub-id pub-id-type="doi">10.1109/TNSRE.2015.2412038</pub-id><pub-id pub-id-type="pmid">25775496</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>M</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Zhou</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Automatic multichannel intramuscular electromyogram decomposition: progressive fastICA peel-off and performance validation</article-title><source>IEEE Transactions on Neural Systems and Rehabilitation Engineering</source><volume>27</volume><fpage>76</fpage><lpage>84</lpage><pub-id pub-id-type="doi">10.1109/TNSRE.2018.2882338</pub-id><pub-id pub-id-type="pmid">30475723</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>C</given-names></name><name><surname>Ma</surname><given-names>S</given-names></name><name><surname>Sheng</surname><given-names>X</given-names></name><name><surname>Farina</surname><given-names>D</given-names></name><name><surname>Zhu</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Adaptive real-time identification of motor unit discharges from non-stationary high-density surface electromyographic signals</article-title><source>IEEE Transactions on Bio-Medical Engineering</source><volume>67</volume><fpage>3501</fpage><lpage>3509</lpage><pub-id pub-id-type="doi">10.1109/TBME.2020.2989311</pub-id><pub-id pub-id-type="pmid">32324538</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Chung</surname><given-names>B</given-names></name><name><surname>Zia</surname><given-names>M</given-names></name><name><surname>Thomas</surname><given-names>KA</given-names></name><name><surname>Michaels</surname><given-names>JA</given-names></name><name><surname>Jacob</surname><given-names>A</given-names></name><name><surname>Pack</surname><given-names>A</given-names></name><name><surname>Williams</surname><given-names>MJ</given-names></name><name><surname>Nagapudi</surname><given-names>K</given-names></name><name><surname>Teng</surname><given-names>LH</given-names></name><name><surname>Arrambide</surname><given-names>E</given-names></name><name><surname>Ouellette</surname><given-names>L</given-names></name><name><surname>Oey</surname><given-names>N</given-names></name><name><surname>Gibbs</surname><given-names>R</given-names></name><name><surname>Anschutz</surname><given-names>P</given-names></name><name><surname>Lu</surname><given-names>J</given-names></name><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Kashefi</surname><given-names>M</given-names></name><name><surname>Oya</surname><given-names>T</given-names></name><name><surname>Kersten</surname><given-names>R</given-names></name><name><surname>Mosberger</surname><given-names>AC</given-names></name><name><surname>O’Connell</surname><given-names>S</given-names></name><name><surname>Wang</surname><given-names>R</given-names></name><name><surname>Marques</surname><given-names>H</given-names></name><name><surname>Mendes</surname><given-names>AR</given-names></name><name><surname>Lenschow</surname><given-names>C</given-names></name><name><surname>Kondakath</surname><given-names>G</given-names></name><name><surname>Kim</surname><given-names>JJ</given-names></name><name><surname>Olson</surname><given-names>W</given-names></name><name><surname>Quinn</surname><given-names>KN</given-names></name><name><surname>Perkins</surname><given-names>P</given-names></name><name><surname>Gatto</surname><given-names>G</given-names></name><name><surname>Thanawalla</surname><given-names>A</given-names></name><name><surname>Coltman</surname><given-names>S</given-names></name><name><surname>Kim</surname><given-names>T</given-names></name><name><surname>Smith</surname><given-names>T</given-names></name><name><surname>Binder-Markey</surname><given-names>B</given-names></name><name><surname>Zaback</surname><given-names>M</given-names></name><name><surname>Thompson</surname><given-names>CK</given-names></name><name><surname>Giszter</surname><given-names>S</given-names></name><name><surname>Person</surname><given-names>A</given-names></name><name><surname>Goulding</surname><given-names>M</given-names></name><name><surname>Azim</surname><given-names>E</given-names></name><name><surname>Thakor</surname><given-names>N</given-names></name><name><surname>O’Connor</surname><given-names>D</given-names></name><name><surname>Trimmer</surname><given-names>B</given-names></name><name><surname>Lima</surname><given-names>SQ</given-names></name><name><surname>Carey</surname><given-names>MR</given-names></name><name><surname>Pandarinath</surname><given-names>C</given-names></name><name><surname>Costa</surname><given-names>RM</given-names></name><name><surname>Pruszynski</surname><given-names>JA</given-names></name><name><surname>Bakir</surname><given-names>M</given-names></name><name><surname>Sober</surname><given-names>SJ</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Myomatrix arrays for high-definition muscle recording</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2023.02.21.529200</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Del Vecchio</surname><given-names>A</given-names></name><name><surname>Holobar</surname><given-names>A</given-names></name><name><surname>Falla</surname><given-names>D</given-names></name><name><surname>Felici</surname><given-names>F</given-names></name><name><surname>Enoka</surname><given-names>RM</given-names></name><name><surname>Farina</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Tutorial: Analysis of motor unit discharge characteristics from high-density surface EMG signals</article-title><source>Journal of Electromyography and Kinesiology</source><volume>53</volume><elocation-id>102426</elocation-id><pub-id pub-id-type="doi">10.1016/j.jelekin.2020.102426</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eden</surname><given-names>J</given-names></name><name><surname>Bräcklein</surname><given-names>M</given-names></name><name><surname>Ibáñez</surname><given-names>J</given-names></name><name><surname>Barsakcioglu</surname><given-names>DY</given-names></name><name><surname>Di Pino</surname><given-names>G</given-names></name><name><surname>Farina</surname><given-names>D</given-names></name><name><surname>Burdet</surname><given-names>E</given-names></name><name><surname>Mehring</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Principles of human movement augmentation and the challenges in making it a reality</article-title><source>Nature Communications</source><volume>13</volume><elocation-id>1345</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-022-28725-7</pub-id><pub-id pub-id-type="pmid">35292665</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Enoka</surname><given-names>RM</given-names></name><name><surname>Fuglevand</surname><given-names>AJ</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Motor unit physiology: some unresolved issues</article-title><source>Muscle &amp; Nerve</source><volume>24</volume><fpage>4</fpage><lpage>17</lpage><pub-id pub-id-type="doi">10.1002/1097-4598(200101)24:1&lt;4::aid-mus13&gt;3.0.co;2-f</pub-id><pub-id pub-id-type="pmid">11150961</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farina</surname><given-names>D</given-names></name><name><surname>Merletti</surname><given-names>R</given-names></name><name><surname>Enoka</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>The extraction of neural strategies from the surface EMG</article-title><source>Journal of Applied Physiology</source><volume>96</volume><fpage>1486</fpage><lpage>1495</lpage><pub-id pub-id-type="doi">10.1152/japplphysiol.01070.2003</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farina</surname><given-names>D</given-names></name><name><surname>Negro</surname><given-names>F</given-names></name><name><surname>Gazzoni</surname><given-names>M</given-names></name><name><surname>Enoka</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2008">2008a</year><article-title>Detecting the unique representation of motor-unit action potentials in the surface electromyogram</article-title><source>Journal of Neurophysiology</source><volume>100</volume><fpage>1223</fpage><lpage>1233</lpage><pub-id pub-id-type="doi">10.1152/jn.90219.2008</pub-id><pub-id pub-id-type="pmid">18497352</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farina</surname><given-names>D</given-names></name><name><surname>Yoshida</surname><given-names>K</given-names></name><name><surname>Stieglitz</surname><given-names>T</given-names></name><name><surname>Koch</surname><given-names>KP</given-names></name></person-group><year iso-8601-date="2008">2008b</year><article-title>Multichannel thin-film electrode for intramuscular electromyographic recordings</article-title><source>Journal of Applied Physiology</source><volume>104</volume><fpage>821</fpage><lpage>827</lpage><pub-id pub-id-type="doi">10.1152/japplphysiol.00788.2007</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farina</surname><given-names>D</given-names></name><name><surname>Holobar</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Characterization of human motor units from surface EMG decomposition</article-title><source>Proceedings of the IEEE</source><volume>104</volume><fpage>353</fpage><lpage>373</lpage><pub-id pub-id-type="doi">10.1109/JPROC.2015.2498665</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farina</surname><given-names>D</given-names></name><name><surname>Negro</surname><given-names>F</given-names></name><name><surname>Muceli</surname><given-names>S</given-names></name><name><surname>Enoka</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Principles of motor unit physiology evolve with advances in technology</article-title><source>Physiology</source><volume>31</volume><fpage>83</fpage><lpage>94</lpage><pub-id pub-id-type="doi">10.1152/physiol.00040.2015</pub-id><pub-id pub-id-type="pmid">26889014</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farina</surname><given-names>D</given-names></name><name><surname>Vujaklija</surname><given-names>I</given-names></name><name><surname>Brånemark</surname><given-names>R</given-names></name><name><surname>Bull</surname><given-names>AMJ</given-names></name><name><surname>Dietl</surname><given-names>H</given-names></name><name><surname>Graimann</surname><given-names>B</given-names></name><name><surname>Hargrove</surname><given-names>LJ</given-names></name><name><surname>Hoffmann</surname><given-names>K-P</given-names></name><name><surname>Huang</surname><given-names>HH</given-names></name><name><surname>Ingvarsson</surname><given-names>T</given-names></name><name><surname>Janusson</surname><given-names>HB</given-names></name><name><surname>Kristjánsson</surname><given-names>K</given-names></name><name><surname>Kuiken</surname><given-names>T</given-names></name><name><surname>Micera</surname><given-names>S</given-names></name><name><surname>Stieglitz</surname><given-names>T</given-names></name><name><surname>Sturma</surname><given-names>A</given-names></name><name><surname>Tyler</surname><given-names>D</given-names></name><name><surname>Weir</surname><given-names>RFF</given-names></name><name><surname>Aszmann</surname><given-names>OC</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Toward higher-performance bionic limbs for wider clinical use</article-title><source>Nature Biomedical Engineering</source><volume>7</volume><fpage>473</fpage><lpage>485</lpage><pub-id pub-id-type="doi">10.1038/s41551-021-00732-x</pub-id><pub-id pub-id-type="pmid">34059810</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Formento</surname><given-names>E</given-names></name><name><surname>Botros</surname><given-names>P</given-names></name><name><surname>Carmena</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Skilled independent control of individual motor units via a non-invasive neuromuscular-machine interface</article-title><source>Journal of Neural Engineering</source><volume>18</volume><pub-id pub-id-type="doi">10.1088/1741-2552/ac35ac</pub-id><pub-id pub-id-type="pmid">34727532</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fuglevand</surname><given-names>AJ</given-names></name><name><surname>Winter</surname><given-names>DA</given-names></name><name><surname>Patla</surname><given-names>AE</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Models of recruitment and rate coding organization in motor-unit pools</article-title><source>Journal of Neurophysiology</source><volume>70</volume><fpage>2470</fpage><lpage>2488</lpage><pub-id pub-id-type="doi">10.1152/jn.1993.70.6.2470</pub-id><pub-id pub-id-type="pmid">8120594</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fukunaga</surname><given-names>T</given-names></name><name><surname>Kawakami</surname><given-names>Y</given-names></name><name><surname>Kuno</surname><given-names>S</given-names></name><name><surname>Funato</surname><given-names>K</given-names></name><name><surname>Fukashiro</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Muscle architecture and function in humans</article-title><source>Journal of Biomechanics</source><volume>30</volume><fpage>457</fpage><lpage>463</lpage><pub-id pub-id-type="doi">10.1016/s0021-9290(96)00171-6</pub-id><pub-id pub-id-type="pmid">9109557</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Glaser</surname><given-names>V</given-names></name><name><surname>Farina</surname><given-names>D</given-names></name><name><surname>Holobar</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Simulations of high-density surface electromyograms in dynamic muscle contractions</article-title><conf-name>Annual International Conference of the IEEE Engineering in Medicine and Biology Society. IEEE Engineering in Medicine and Biology Society. Annual International Conference</conf-name><fpage>3453</fpage><lpage>3456</lpage><pub-id pub-id-type="doi">10.1109/EMBC.2017.8037599</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glaser</surname><given-names>V</given-names></name><name><surname>Holobar</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Motor unit identification from high-density surface electromyograms in repeated dynamic muscle contractions</article-title><source>IEEE Transactions on Neural Systems and Rehabilitation Engineering: A Publication of the IEEE Engineering in Medicine and Biology Society</source><volume>27</volume><fpage>66</fpage><lpage>75</lpage><pub-id pub-id-type="doi">10.1109/TNSRE.2018.2885283</pub-id><pub-id pub-id-type="pmid">30571641</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Henneman</surname><given-names>E</given-names></name></person-group><year iso-8601-date="1957">1957</year><article-title>Relation between size of neurons and their susceptibility to discharge</article-title><source>Science</source><volume>126</volume><fpage>1345</fpage><lpage>1347</lpage><pub-id pub-id-type="doi">10.1126/science.126.3287.1345</pub-id><pub-id pub-id-type="pmid">13495469</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Herbert</surname><given-names>RD</given-names></name><name><surname>Bolsterlee</surname><given-names>B</given-names></name><name><surname>Gandevia</surname><given-names>SC</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Passive changes in muscle length</article-title><source>Journal of Applied Physiology</source><volume>126</volume><fpage>1445</fpage><lpage>1453</lpage><pub-id pub-id-type="doi">10.1152/japplphysiol.00673.2018</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holobar</surname><given-names>A</given-names></name><name><surname>Zazula</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Multichannel blind source separation using convolution kernel compensation</article-title><source>IEEE Transactions on Signal Processing</source><volume>55</volume><fpage>4487</fpage><lpage>4496</lpage><pub-id pub-id-type="doi">10.1109/TSP.2007.896108</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holobar</surname><given-names>A</given-names></name><name><surname>Minetto</surname><given-names>MA</given-names></name><name><surname>Botter</surname><given-names>A</given-names></name><name><surname>Negro</surname><given-names>F</given-names></name><name><surname>Farina</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Experimental analysis of accuracy in the identification of motor unit spike trains from high-density surface EMG</article-title><source>IEEE Transactions on Neural Systems and Rehabilitation Engineering</source><volume>18</volume><fpage>221</fpage><lpage>229</lpage><pub-id pub-id-type="doi">10.1109/TNSRE.2010.2041593</pub-id><pub-id pub-id-type="pmid">20144921</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holobar</surname><given-names>A</given-names></name><name><surname>Farina</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Blind source identification from the multichannel surface electromyogram</article-title><source>Physiological Measurement</source><volume>35</volume><fpage>R143</fpage><lpage>R165</lpage><pub-id pub-id-type="doi">10.1088/0967-3334/35/7/R143</pub-id><pub-id pub-id-type="pmid">24943407</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holobar</surname><given-names>A</given-names></name><name><surname>Minetto</surname><given-names>MA</given-names></name><name><surname>Farina</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Accurate identification of motor unit discharge patterns from high-density surface EMG and validation with a novel signal-based performance metric</article-title><source>Journal of Neural Engineering</source><volume>11</volume><elocation-id>016008</elocation-id><pub-id pub-id-type="doi">10.1088/1741-2560/11/1/016008</pub-id><pub-id pub-id-type="pmid">24654270</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hug</surname><given-names>F</given-names></name><name><surname>Avrillon</surname><given-names>S</given-names></name><name><surname>Del Vecchio</surname><given-names>A</given-names></name><name><surname>Casolo</surname><given-names>A</given-names></name><name><surname>Ibanez</surname><given-names>J</given-names></name><name><surname>Nuccio</surname><given-names>S</given-names></name><name><surname>Rossato</surname><given-names>J</given-names></name><name><surname>Holobar</surname><given-names>A</given-names></name><name><surname>Farina</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Analysis of motor unit spike trains estimated from high-density surface electromyography is highly reliable across operators</article-title><source>Journal of Electromyography and Kinesiology</source><volume>58</volume><elocation-id>102548</elocation-id><pub-id pub-id-type="doi">10.1016/j.jelekin.2021.102548</pub-id><pub-id pub-id-type="pmid">33838590</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ito</surname><given-names>M</given-names></name><name><surname>Kawakami</surname><given-names>Y</given-names></name><name><surname>Ichinose</surname><given-names>Y</given-names></name><name><surname>Fukashiro</surname><given-names>S</given-names></name><name><surname>Fukunaga</surname><given-names>T</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Nonisometric behavior of fascicles during isometric contractions of a human muscle</article-title><source>Journal of Applied Physiology</source><volume>85</volume><fpage>1230</fpage><lpage>1235</lpage><pub-id pub-id-type="doi">10.1152/jappl.1998.85.4.1230</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Konstantin</surname><given-names>A</given-names></name><name><surname>Yu</surname><given-names>T</given-names></name><name><surname>Le Carpentier</surname><given-names>E</given-names></name><name><surname>Aoustin</surname><given-names>Y</given-names></name><name><surname>Farina</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Simulation of motor unit action potential recordings from intramuscular multichannel scanning electrodes</article-title><source>IEEE Transactions on Bio-Medical Engineering</source><volume>67</volume><fpage>2005</fpage><lpage>2014</lpage><pub-id pub-id-type="doi">10.1109/TBME.2019.2953680</pub-id><pub-id pub-id-type="pmid">31825857</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>LeFever</surname><given-names>RS</given-names></name><name><surname>De Luca</surname><given-names>CJ</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>A procedure for decomposing the myoelectric signal into its constituent action potentials--Part I: Technique, theory, and implementation</article-title><source>IEEE Transactions on Bio-Medical Engineering</source><volume>29</volume><fpage>149</fpage><lpage>157</lpage><pub-id pub-id-type="doi">10.1109/tbme.1982.324881</pub-id><pub-id pub-id-type="pmid">7084948</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lindstrom</surname><given-names>LH</given-names></name><name><surname>Magnusson</surname><given-names>RI</given-names></name></person-group><year iso-8601-date="1977">1977</year><article-title>Interpretation of myoelectric power spectra: A model and its applications</article-title><source>Proceedings of the IEEE</source><volume>65</volume><fpage>653</fpage><lpage>662</lpage><pub-id pub-id-type="doi">10.1109/PROC.1977.10544</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lulic-Kuryllo</surname><given-names>T</given-names></name><name><surname>Inglis</surname><given-names>JG</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Sex differences in motor unit behaviour: A review</article-title><source>Journal of Electromyography and Kinesiology</source><volume>66</volume><elocation-id>102689</elocation-id><pub-id pub-id-type="doi">10.1016/j.jelekin.2022.102689</pub-id><pub-id pub-id-type="pmid">36095969</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maksymenko</surname><given-names>K</given-names></name><name><surname>Clarke</surname><given-names>AK</given-names></name><name><surname>Mendez Guerra</surname><given-names>I</given-names></name><name><surname>Deslauriers-Gauthier</surname><given-names>S</given-names></name><name><surname>Farina</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>A myoelectric digital twin for fast and realistic modelling in deep learning</article-title><source>Nature Communications</source><volume>14</volume><elocation-id>1600</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-023-37238-w</pub-id><pub-id pub-id-type="pmid">36959193</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marshall</surname><given-names>NJ</given-names></name><name><surname>Glaser</surname><given-names>JI</given-names></name><name><surname>Trautmann</surname><given-names>EM</given-names></name><name><surname>Amematsro</surname><given-names>EA</given-names></name><name><surname>Perkins</surname><given-names>SM</given-names></name><name><surname>Shadlen</surname><given-names>MN</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name><name><surname>Cunningham</surname><given-names>JP</given-names></name><name><surname>Churchland</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Flexible neural control of motor units</article-title><source>Nature Neuroscience</source><volume>25</volume><fpage>1492</fpage><lpage>1504</lpage><pub-id pub-id-type="doi">10.1038/s41593-022-01165-8</pub-id><pub-id pub-id-type="pmid">36216998</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martinez-Valdes</surname><given-names>E</given-names></name><name><surname>Enoka</surname><given-names>RM</given-names></name><name><surname>Holobar</surname><given-names>A</given-names></name><name><surname>McGill</surname><given-names>K</given-names></name><name><surname>Farina</surname><given-names>D</given-names></name><name><surname>Besomi</surname><given-names>M</given-names></name><name><surname>Hug</surname><given-names>F</given-names></name><name><surname>Falla</surname><given-names>D</given-names></name><name><surname>Carson</surname><given-names>RG</given-names></name><name><surname>Clancy</surname><given-names>EA</given-names></name><name><surname>Disselhorst-Klug</surname><given-names>C</given-names></name><name><surname>van Dieën</surname><given-names>JH</given-names></name><name><surname>Tucker</surname><given-names>K</given-names></name><name><surname>Gandevia</surname><given-names>S</given-names></name><name><surname>Lowery</surname><given-names>M</given-names></name><name><surname>Søgaard</surname><given-names>K</given-names></name><name><surname>Besier</surname><given-names>T</given-names></name><name><surname>Merletti</surname><given-names>R</given-names></name><name><surname>Kiernan</surname><given-names>MC</given-names></name><name><surname>Rothwell</surname><given-names>JC</given-names></name><name><surname>Perreault</surname><given-names>E</given-names></name><name><surname>Hodges</surname><given-names>PW</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Consensus for experimental design in electromyography (CEDE) project: Single motor unit matrix</article-title><source>Journal of Electromyography and Kinesiology</source><volume>68</volume><elocation-id>102726</elocation-id><pub-id pub-id-type="doi">10.1016/j.jelekin.2022.102726</pub-id><pub-id pub-id-type="pmid">36571885</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McGill</surname><given-names>KC</given-names></name><name><surname>Lateva</surname><given-names>ZC</given-names></name><name><surname>Marateb</surname><given-names>HR</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>EMGLAB: an interactive EMG decomposition program</article-title><source>Journal of Neuroscience Methods</source><volume>149</volume><fpage>121</fpage><lpage>133</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2005.05.015</pub-id><pub-id pub-id-type="pmid">16026846</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Mendez Guerra</surname><given-names>I</given-names></name><name><surname>Barsakcioglu</surname><given-names>DY</given-names></name><name><surname>Farina</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Wearable neural interfaces: real-time identification of motor neuron discharges in dynamic motor tasks</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2024.02.05.578874</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mierzejewska-Krzyżowska</surname><given-names>B</given-names></name><name><surname>Drzymała-Celichowska</surname><given-names>H</given-names></name><name><surname>Celichowski</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Gender differences in the morphometric properties of muscle fibres and the innervation ratio of motor units in rat medial gastrocnemius muscle</article-title><source>Anatomia, Histologia, Embryologia</source><volume>40</volume><fpage>249</fpage><lpage>255</lpage><pub-id pub-id-type="doi">10.1111/j.1439-0264.2011.01066.x</pub-id><pub-id pub-id-type="pmid">21426379</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muceli</surname><given-names>S</given-names></name><name><surname>Poppendieck</surname><given-names>W</given-names></name><name><surname>Negro</surname><given-names>F</given-names></name><name><surname>Yoshida</surname><given-names>K</given-names></name><name><surname>Hoffmann</surname><given-names>KP</given-names></name><name><surname>Butler</surname><given-names>JE</given-names></name><name><surname>Gandevia</surname><given-names>SC</given-names></name><name><surname>Farina</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Accurate and representative decoding of the neural drive to muscles in humans with multi-channel intramuscular thin-film electrodes</article-title><source>The Journal of Physiology</source><volume>593</volume><fpage>3789</fpage><lpage>3804</lpage><pub-id pub-id-type="doi">10.1113/JP270902</pub-id><pub-id pub-id-type="pmid">26174910</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muceli</surname><given-names>S</given-names></name><name><surname>Poppendieck</surname><given-names>W</given-names></name><name><surname>Holobar</surname><given-names>A</given-names></name><name><surname>Gandevia</surname><given-names>S</given-names></name><name><surname>Liebetanz</surname><given-names>D</given-names></name><name><surname>Farina</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Blind identification of the spinal cord output in humans with high-density electrode arrays implanted in muscles</article-title><source>Science Advances</source><volume>8</volume><elocation-id>eabo5040</elocation-id><pub-id pub-id-type="doi">10.1126/sciadv.abo5040</pub-id><pub-id pub-id-type="pmid">36383647</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Negro</surname><given-names>F</given-names></name><name><surname>Muceli</surname><given-names>S</given-names></name><name><surname>Castronovo</surname><given-names>AM</given-names></name><name><surname>Holobar</surname><given-names>A</given-names></name><name><surname>Farina</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Multi-channel intramuscular and surface EMG decomposition by convolutive blind source separation</article-title><source>Journal of Neural Engineering</source><volume>13</volume><elocation-id>026027</elocation-id><pub-id pub-id-type="doi">10.1088/1741-2560/13/2/026027</pub-id><pub-id pub-id-type="pmid">26924829</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oliveira</surname><given-names>AS</given-names></name><name><surname>Negro</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Neural control of matched motor units during muscle shortening and lengthening at increasing velocities</article-title><source>Journal of Applied Physiology</source><volume>130</volume><fpage>1798</fpage><lpage>1813</lpage><pub-id pub-id-type="doi">10.1152/japplphysiol.00043.2021</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oliveira</surname><given-names>DS</given-names></name><name><surname>Ponfick</surname><given-names>M</given-names></name><name><surname>Braun</surname><given-names>DI</given-names></name><name><surname>Osswald</surname><given-names>M</given-names></name><name><surname>Sierotowicz</surname><given-names>M</given-names></name><name><surname>Chatterjee</surname><given-names>S</given-names></name><name><surname>Weber</surname><given-names>D</given-names></name><name><surname>Eskofier</surname><given-names>B</given-names></name><name><surname>Castellini</surname><given-names>C</given-names></name><name><surname>Farina</surname><given-names>D</given-names></name><name><surname>Kinfe</surname><given-names>TM</given-names></name><name><surname>Del Vecchio</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>A direct spinal cord–computer interface enables the control of the paralysed hand in spinal cord injury</article-title><source>Brain</source><volume>10</volume><elocation-id>1093</elocation-id><pub-id pub-id-type="doi">10.1093/brain/awae088</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Pachitariu</surname><given-names>M</given-names></name><name><surname>Sridhar</surname><given-names>S</given-names></name><name><surname>Stringer</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Solving the spike sorting problem with kilosort</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2023.01.07.523036</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rey</surname><given-names>HG</given-names></name><name><surname>Pedreira</surname><given-names>C</given-names></name><name><surname>Quian Quiroga</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Past, present and future of spike sorting techniques</article-title><source>Brain Research Bulletin</source><volume>119</volume><fpage>106</fpage><lpage>117</lpage><pub-id pub-id-type="doi">10.1016/j.brainresbull.2015.04.007</pub-id><pub-id pub-id-type="pmid">25931392</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rossato</surname><given-names>J</given-names></name><name><surname>Avrillon</surname><given-names>S</given-names></name><name><surname>Tucker</surname><given-names>K</given-names></name><name><surname>Farina</surname><given-names>D</given-names></name><name><surname>Hug</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>The volitional control of individual motor units is constrained within low-dimensional neural manifolds by common inputs</article-title><source>The Journal of Neuroscience</source><volume>44</volume><elocation-id>e0702242024</elocation-id><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0702-24.2024</pub-id><pub-id pub-id-type="pmid">38951036</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sherrington</surname><given-names>CS</given-names></name></person-group><year iso-8601-date="1925">1925</year><article-title>Remarks on some aspects of reflex inhibition</article-title><source>Proceedings of the Royal Society of London. Series B, Containing Papers of a Biological Character</source><volume>97</volume><fpage>519</fpage><lpage>545</lpage><pub-id pub-id-type="doi">10.1098/rspb.1925.0017</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steinmetz</surname><given-names>NA</given-names></name><name><surname>Aydin</surname><given-names>C</given-names></name><name><surname>Lebedeva</surname><given-names>A</given-names></name><name><surname>Okun</surname><given-names>M</given-names></name><name><surname>Pachitariu</surname><given-names>M</given-names></name><name><surname>Bauza</surname><given-names>M</given-names></name><name><surname>Beau</surname><given-names>M</given-names></name><name><surname>Bhagat</surname><given-names>J</given-names></name><name><surname>Böhm</surname><given-names>C</given-names></name><name><surname>Broux</surname><given-names>M</given-names></name><name><surname>Chen</surname><given-names>S</given-names></name><name><surname>Colonell</surname><given-names>J</given-names></name><name><surname>Gardner</surname><given-names>RJ</given-names></name><name><surname>Karsh</surname><given-names>B</given-names></name><name><surname>Kloosterman</surname><given-names>F</given-names></name><name><surname>Kostadinov</surname><given-names>D</given-names></name><name><surname>Mora-Lopez</surname><given-names>C</given-names></name><name><surname>O’Callaghan</surname><given-names>J</given-names></name><name><surname>Park</surname><given-names>J</given-names></name><name><surname>Putzeys</surname><given-names>J</given-names></name><name><surname>Sauerbrei</surname><given-names>B</given-names></name><name><surname>van Daal</surname><given-names>RJJ</given-names></name><name><surname>Vollan</surname><given-names>AZ</given-names></name><name><surname>Wang</surname><given-names>S</given-names></name><name><surname>Welkenhuysen</surname><given-names>M</given-names></name><name><surname>Ye</surname><given-names>Z</given-names></name><name><surname>Dudman</surname><given-names>JT</given-names></name><name><surname>Dutta</surname><given-names>B</given-names></name><name><surname>Hantman</surname><given-names>AW</given-names></name><name><surname>Harris</surname><given-names>KD</given-names></name><name><surname>Lee</surname><given-names>AK</given-names></name><name><surname>Moser</surname><given-names>EI</given-names></name><name><surname>O’Keefe</surname><given-names>J</given-names></name><name><surname>Renart</surname><given-names>A</given-names></name><name><surname>Svoboda</surname><given-names>K</given-names></name><name><surname>Häusser</surname><given-names>M</given-names></name><name><surname>Haesler</surname><given-names>S</given-names></name><name><surname>Carandini</surname><given-names>M</given-names></name><name><surname>Harris</surname><given-names>TD</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Neuropixels 2.0: A miniaturized high-density probe for stable, long-term brain recordings</article-title><source>Science</source><volume>372</volume><elocation-id>eabf4588</elocation-id><pub-id pub-id-type="doi">10.1126/science.abf4588</pub-id><pub-id pub-id-type="pmid">33859006</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taylor</surname><given-names>CA</given-names></name><name><surname>Kopicko</surname><given-names>BH</given-names></name><name><surname>Negro</surname><given-names>F</given-names></name><name><surname>Thompson</surname><given-names>CK</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Sex differences in the detection of motor unit action potentials identified using high-density surface electromyography</article-title><source>Journal of Electromyography and Kinesiology</source><volume>65</volume><elocation-id>102675</elocation-id><pub-id pub-id-type="doi">10.1016/j.jelekin.2022.102675</pub-id><pub-id pub-id-type="pmid">35728511</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yeung</surname><given-names>D</given-names></name><name><surname>Negro</surname><given-names>F</given-names></name><name><surname>Vujaklija</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Adaptive HD-sEMG decomposition: towards robust real-time decoding of neural drive</article-title><source>Journal of Neural Engineering</source><volume>21</volume><elocation-id>ad33b0</elocation-id><pub-id pub-id-type="doi">10.1088/1741-2552/ad33b0</pub-id><pub-id pub-id-type="pmid">38479007</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>Y</given-names></name><name><surname>Hu</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Real-time isometric finger extension force estimation based on motor unit discharge information</article-title><source>Journal of Neural Engineering</source><volume>16</volume><elocation-id>066006</elocation-id><pub-id pub-id-type="doi">10.1088/1741-2552/ab2c55</pub-id><pub-id pub-id-type="pmid">31234147</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.88670.3.sa0</article-id><title-group><article-title>eLife assessment</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Pruszynski</surname><given-names>J Andrew</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>Western University</institution><country>Canada</country></aff></contrib></contrib-group><kwd-group kwd-group-type="evidence-strength"><kwd>Compelling</kwd></kwd-group><kwd-group kwd-group-type="claim-importance"><kwd>Valuable</kwd></kwd-group></front-stub><body><p>This article compiles existing algorithms into an open-source software package that enables real-time (and offline) motor unit decomposition from muscle activity collected via grids of surface electrodes and indwelling electrode arrays. The package is <bold>valuable</bold> given that many motor neuroscience labs are using such algorithms and that there exists a host of potential applications for such data. Validation of the software package is <bold>compelling</bold>, suggesting that it can be successfully applied across a range of muscles and tasks.</p></body></sub-article><sub-article article-type="referee-report" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.88670.3.sa1</article-id><title-group><article-title>Reviewer #1 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Many labs world-wide now use the blind source deconvolution technique to identify the firing patterns of multiple motor units simultaneously in human subjects. This technique has had a truly transformative effective on our understanding of the structure of motor output in both normal subjects and, increasingly, in persons with neurological disorders. The key advance presented here is that the software provides real time identification of these firing patterns.</p><p>The main strengths are the clarity of the presentation and the great potential that real-time decoding will provide. Figures are especially effective and statistical analyses are excellent.</p></body></sub-article><sub-article article-type="referee-report" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.88670.3.sa2</article-id><title-group><article-title>Reviewer #3 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>In this manuscript, Rossato and colleagues present a method for real-time decoding of EMG into putative single motor units. Their manuscript details a variety of decision points in their code and data collection pipeline that lead to a final result of recording on the order of ~10 putative motor units per muscle in human males. Overall the manuscript is highly restricted in its potential utility but may be of interest to aficionados. For those outside the field of human or nonhuman primate EMG, these methods will be of limited interest.</p><p>Comment on revised version</p><p>The revised manuscript has thoroughly and responsively addressed the concerns and suggestions raised in the first review. I think the method will be of use to the field and fits well within the purview of eLife's publications on methods development.</p></body></sub-article><sub-article article-type="author-comment" id="sa3"><front-stub><article-id pub-id-type="doi">10.7554/eLife.88670.3.sa3</article-id><title-group><article-title>Author response</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Rossato</surname><given-names>Julien</given-names></name><role specific-use="author">Author</role><aff><institution>The University of Nantes</institution><addr-line><named-content content-type="city">Nantes</named-content></addr-line><country>France</country></aff></contrib><contrib contrib-type="author"><name><surname>Hug</surname><given-names>François</given-names></name><role specific-use="author">Author</role><aff><institution>Université Côte d'Azur</institution><addr-line><named-content content-type="city">Nice</named-content></addr-line><country>France</country></aff></contrib><contrib contrib-type="author"><name><surname>Tucker</surname><given-names>Kylie</given-names></name><role specific-use="author">Author</role><aff><institution>The University of Queensland</institution><addr-line><named-content content-type="city">Brisbane</named-content></addr-line><country>Australia</country></aff></contrib><contrib contrib-type="author"><name><surname>Gibbs</surname><given-names>Ciara</given-names></name><role specific-use="author">Author</role><aff><institution>Imperial College London</institution><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff></contrib><contrib contrib-type="author"><name><surname>Lacourpaille</surname><given-names>Lilian</given-names></name><role specific-use="author">Author</role><aff><institution>The University of Nantes</institution><addr-line><named-content content-type="city">Nantes</named-content></addr-line><country>France</country></aff></contrib><contrib contrib-type="author"><name><surname>Farina</surname><given-names>Dario</given-names></name><role specific-use="author">Author</role><aff><institution>Imperial College London</institution><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff></contrib><contrib contrib-type="author"><name><surname>Avrillon</surname><given-names>Simon</given-names></name><role specific-use="author">Author</role><aff><institution>Imperial College London</institution><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><p>The following is the authors’ response to the original reviews.</p><disp-quote content-type="editor-comment"><p><bold>eLife assessment</bold></p><p>This manuscript compiles existing algorithms into an open-source software package that enables realtime motor unit decomposition from muscle activity collected via grids of surface electrodes and indwelling electrode arrays. The software package is valuable given that many motor neuroscience labs are using such algorithms and that there exist a host of potential real-time applications for such data. Validation of the software package is generally solid but incomplete in some important areas: the primary data is narrow in scope and only from male participants, and there is a lack of ground truth tests on synthetic data. The impact of the software package could be strengthened by making it less tied to specific electrode hardware and by expanding it to easily permit offline analysis.</p></disp-quote><p>We thank the reviewers and editors for their comments and suggestions after reading the initial version of our manuscript. In this second iteration, we have performed a validation of the algorithm using synthetic EMG signals. We have also added experimental data collected in female participants. Finally, the new version of I-Spin is compatible with the Open Ephys GUI that can interface with devices such as the Open Ephys and Intan acquisition boards. Another version has been developed for interfacing with the devices provided by the TMSi company (<ext-link ext-link-type="uri" xlink:href="https://info.tmsi.com/blog/ispin-saga-real-timemotor-unit-decomposition-tool">https://info.tmsi.com/blog/ispin-saga-real-timemotor-unit-decomposition-tool</ext-link>). We believe that such changes will make I-Spin more accessible for a broad range of experimental setups and research teams. Please find below the specific answers to the reviewers’ comments.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #1 (Public Review):</bold></p><p>Many labs worldwide now use the blind source deconvolution technique to identify the firing patterns of multiple motor units simultaneously in human subjects. This technique has had a truly transformative effect on our understanding of the structure of motor output in both normal subjects and, increasingly, in persons with neurological disorders. The key advance presented here is that the software provides real-time identification of these firing patterns. The main strengths are the clarity of the presentation and the great potential that real-time decoding will provide. Figures are especially effective and statistical analyses are excellent.</p></disp-quote><p>We thank the reviewer for this positive appreciation of our work.</p><disp-quote content-type="editor-comment"><p>The main limitation of the work is that only male subjects were included in the validation of the software. The reason given - that yield of number of motor units identified is generally larger in males than females - is reasonable in the sense that this is the first systematic test of this real-time approach. At a minimum, however, the authors should clearly commit to future work with female subjects and emphasize the importance of considering sex differences.</p></disp-quote><p>As emphasised by the reviewer, the number of identified motor units is typically higher in males than females when using surface EMG (Taylor et al., 2022), which is the current main limitation of the implementation of offline EMG decomposition technique in a broad and representative sample of research participants. These differences between biological sex are less present when using intramuscular EMG, as the signals are less affected by the filtering effect of the volume conductor separating the motor units from the recording electrodes. Besides the different yields expected between males and females, we do not expect differences in terms of the accuracy of the motor unit identification algorithm, which is the main outcome of this paper.</p><p>Nevertheless, we acknowledge the importance to understand the reasons for this difference, and the imperative to refine algorithms and/or surface electrode design to mitigate this major limitation with surface EMG.</p><p>To support this point, the discussion has been updated (P20; L480):</p><p>‘An important consideration regarding the implementation of offline or real-time surface EMG decomposition is the difference between individuals, with an overall lower yield in number of identified motor units in females (here: 9 ± 12) than in males (here: 30 ± 13). Typically, the number of identified motor units from surface EMG is twice as low in females than males (32, 49, 50). The cause for this difference remains unclear. It may be related to variations in properties of the tissues separating the motor units from the recording electrodes, or to differences in the morphological and physiological properties of muscle fibres, as well as to the innervation ratios of motor units. These sex-related differences have so far only been supported by data extracted from animal experiments (51). However, the recent developments of simulation frameworks capable of generating highly realistic EMG signals for anthropometrically diverse populations may help understanding the impact of sex-related differences in humans (52). Specifically, these simulations can account for diverse anatomical (e.g. muscle volume and architecture, thickness of subcutaneous tissues) and physiological characteristics (e.g. innervation ratio, number of motor units, fibre cross sectional area, fibre conduction velocity, contribution of rate coding vs. spatial recruitment). Generating such dataset could help identifying the primary factors affecting EMG decomposition performance, ultimately enabling the refinement of algorithms and/or surface electrode design.’</p><p>Finally, we have completed new experiments including males and females in this new iteration (P.12; L.295):</p><p>‘Application of motor unit filters in experimental data</p><p>We then asked eight participants (4 males and 4 females) to perform trapezoidal isometric contractions with plateaus of force set at 10% and 20% MVC during which surface EMG signals were recorded from the TA with 256 electrodes separated by 4 mm. The aim of this experiment was to confirm the results of the simulation; specifically, to test the accuracy of the online decomposition when the level of force was below, equal to, or above the level of force produced during the baseline contraction used to estimate the motor unit filters (Figure 4). We assessed the accuracy of the motor unit spike trains identified in real time using their manually edited version as reference. 144 motor units were identified at both 10 and 20% MVC. When the test signals were recorded at the same level of force as the baseline contraction, we obtained rates of agreement of 95.6 ± 6.8% (10% MVC) and 93.9 ± 5.9% (20% MVC). The sensitivity reached 95.9 ± 6.7% (10% MVC) and 94.4 ± 5.6% (20% MVC), and the precision reached 99.6 ± 1.3% (10% MVC) and 99.4 ± 1.9% (20% MVC).</p><p>When the filters identified at 20% MVC were applied on signals recorded at a lower level of force (10% MVC), the rates of agreement decreased to 87.9 ± 16.2%. The sensitivity also decreased to 88.0 ± 16.2%, but the precision remained high (99.4 ± 4.3). Thus, the decrease in accuracy was mostly caused by missed discharge times rather than the false identification of artifacts or spikes from other motor units. When the filters identified at 10% MVC were applied to signals recorded at a higher level of force, the rates of agreement decreased to 83.3 ± 13.5%. The sensitivity decreased to 90.7 ± 8.1%, and the precision also decreased to 90.9 ± 12.6%. This result confirms what was observed with synthetic EMG, that is motor units recruited between 10 and 20% MVC can substantially disrupt the accuracy of the decomposition in real-time, as highlighted in Figure 4 (lower panel). Importantly, this situation does not happen for all the motor units, as suggested by the distribution of the values in Figure 4.’</p><disp-quote content-type="editor-comment"><p>A second weakness is that the Introduction does a poor job of establishing the potential importance of the real-time approach.</p></disp-quote><p>The introduction has been modified to highlight the importance of identifying the spiking activity of motor units in real time. Specifically, the first paragraph has been rewritten to read (P3; L67):</p><p>‘The activity of motor neuron – in the form of spike trains – represents the neural code of movement to muscles. Decoding this firing activity in real-time during various behaviours can thus substantially enhance our understanding of movement control (2-5). Real-time decoding is also essential for interfacing with external devices (6) or virtual limbs (7) when activity is present at the periphery of the nervous system. For example, individuals with a spinal cord injury can control a virtual hand with the residual firing activity of the motor units in their forearm (7). Furthermore, sampling the activity of motor units receiving a substantial portion of independent synaptic inputs may pave the way for movement augmentation – specifically, extending a person’s movement repertoire through the increase of controllable degrees of freedom (8). In this way, Formento et al. (3) showed that individuals can intuitively learn to independently control motor units within the same muscle using visual cues. Having access to open-source tools that perform the real-time decoding of motor units would allow an increasing number of researchers to improve and expand the range of these applications’</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Public Review):</bold></p><p>Rossato et al present I-spin live, a software package to perform real-time blind-source separation-based sorting of motor unit activity. The core contribution of this manuscript is the development and validation of a software package to perform motor unit sorting, apply the resulting motor unit filters in real-time during muscle contractions, and provide real-time visual feedback of the motor unit activity. I have a few concerns with the work as presented:</p><p>I found it challenging to specifically understand the technical contributions of this manuscript. The authors do not appear to be claiming anything novel algorithmically (with respect to spike sorting) or methodologically (with respect to manual editing of spikes before the use of the algorithms in real-time). My takeaway is that the key contributions are C1 development of an open-source implementation of the Negro algorithm, C2 validating it for real-time application (evaluating its sorting efficacy, and closed-loop performance, etc), and developing a software package to run in closed-loop with visual feedback. I will comment on each of these items separately below. It would be great if the authors could more explicitly lay out the key contributions of this manuscript in the text.</p></disp-quote><p>The main objective of this work was to provide an open-source implementation of the real-time identification of motor units together with a user interface that allow researchers to easily process the data and display the firing activity of motor unit in the form of several visual feedback. We have explicitly laid out these key contributions in the introduction: “Having access to open-source tools that perform the real-time decoding of motor units would allow an increasing number of researchers to improve and expand the range of these applications.’</p><disp-quote content-type="editor-comment"><p>Related to the above, much of the validation of the algorithms in this manuscript has a &quot;trust me&quot; feel. The authors note that the Negro et al. algorithm has already been validated, so very few details or presentations of primary data showing the algorithm's performance are shown. Similarly, the efficacy of the decomposition approach is evaluated using manual editing of the sorting output as a reference, which is a subjective process, and users would greatly benefit from explicit guidance. There are very few details of manual editing shown in this manuscript (I believe the authors reference the Hug et al. 2021 paper for these details), and little discussion of the core challenges and variability of that process, even though it seems to be a critical step in the proposed workflow. So this is very hard to evaluate and would be challenging for readers to replicate.</p></disp-quote><p>To address the reviewer’s comment, we added a validation step using synthetic EMG data (P.10; L.235).</p><p>‘Validation of the algorithm</p><p>We first validated the accuracy of the algorithm using synthetic EMG signals generated with an anatomical model entailing a cylindrical muscle volume with parallel fibres [see Farina et al. (29), Konstantin et al. (36) for a full description of the model]. In this model, subcutaneous and skin layers separate the muscle from a grid of 65 surface electrodes (5 columns, 13 rows), while an intramuscular array of electrodes is directly inserted in the muscle under the grid with an angle of 30 degrees. 150 motor units were distributed within the cross section of the muscle. Recruitment thresholds, firing rate/excitatory drive relations, and twitch parameters were assigned to each motor unit using the same procedure as Fuglevand et al. (37). During each simulation, a proportional-integral-derivative controller adjusted the level of excitatory drive to minimise the error between a predefined target of force and the force generated by the active motor units.</p><p>Figure 3A displays the raster plots of the active motor units during simulated trapezoidal isometric contractions with plateaus of force set at 10%, 20%, and 30% MVC. A sinusoidal isometric contraction ranging between 15 and 25% MVC at a frequency of 0.5 Hz was also simulated. We identified on average 10 ± 1 and 12 ± 2 motor units with surface and intramuscular arrays, respectively (Figure 3A). During the offline decomposition, the rate of agreement between the identified discharge times and the ground truth, that is, the simulated discharge times, reached 100.0 ± 0.0% for intramuscular EMG signals and 99.2 ± 1.8% for surface EMG signals (Figure 3B). The offline estimation of motor unit filters was therefore highly accurate, independently of the level of force or the pattern of the isometric contraction.</p><p>Motor unit filters estimated during a baseline contraction at 20% MVC were then applied in real-time on signals simulated during a contraction with a different pattern (sinusoidal; Figure 3C). The rates of agreement between the online decomposition and the ground truth reached 96.3 ± 4.6% and 98.4 ± 2.3% for surface and intramuscular EMG signals, respectively. Finally, we tested whether the accuracy of the online decomposition changed when the level of force decreased or increased by 10% MVC when compared to the calibration performed at 20% MVC (Figure 3D). The rate of agreement remained high when applying the motor unit filters on signals recorded at 10% MVC: 99.8 ± 0.2% (surface EMG) and 99.5 ± 0.3% (intramuscular EMG). It is worth noting that only 3 out of 10 motor units identified from surface EMG at 20% MVC were active at 10% MVC, while 8 out of 12 motor units identified from intramuscular EMG were active at 10 % MVC. This shows how the decomposition of EMG signals tends to identify the last recruited motor units, which often innervate a larger number of fibres than the early recruited motor units (38). On the contrary, the application of motor unit filters on signals simulated at 30% MVC led to a decrease in the rate of agreement, with values of 88.6 ± 14.0% (surface EMG) and</p><p>80.3 ± 19.2% (intramuscular EMG). This decrease in accuracy did not impact all the motor units, with 5 motor units keeping a rate of agreement above 95% in both signals. For the other motor units, we observed a decrease in precision, which estimates the ratio of true discharge times over the total number of identified discharge times. This was caused by the recruitment of two motor units sharing a similar space within the muscle, which resulted in a merge in the same pulse train (Figure 3D).’</p><p>In addition, we added a new paragraph in the Method section to describe the manual editing process (P.26; L.658).</p><p>‘There is a consensus among experts that automatic decomposition should be followed by visual inspection and manual editing (55). Manual editing involves the following steps: (i) removing spikes that result in erroneous firing rates (outliers), (ii) adding discharge times thar are clearly distinguishable from the noise, (iii) recalculating the separation vector, (iv) reapplying the separation vector on the EMG signals (either a selected window or the entire signal), and (v) repeating this procedure until no outliers are present and all clearly distinguishable spikes have been selected. Importantly, the manual editing of potentially missed or falsely identified discharge times should not be accepted before the application of the updated motor unit separation vector, thereby generating a new pulse train. Manual edits should be accepted only if the silhouette value improves following this operation or remains well above the preestablished threshold. A more extensive description of the manual editing of motor unit pulse trains can be found in (32). Even though some of the aforementioned steps involve subjective decision-making, evidence suggests that manual editing after EMG decomposition with blind source separation approaches remains highly reliable across operators (33). Specifically, the median rates of agreement calculated for 126 motor units over eight operators with various experience in manual editing was 99.6%. All raw and processed data have been made available on a public data repository so that they can be used for training new operators (10.6084/m9.figshare.13695937).’</p><disp-quote content-type="editor-comment"><p>I found the User Guide in the Github package to be easy to follow. Importantly, it seems heavily tied to the specific hardware (Quattrocento). I understand it may be difficult to make the full software package work with different hardware, but it seems important to at least make an offline analysis of recorded data possible for this package to be useful more broadly.</p></disp-quote><p>The software was updated to perform real-time decomposition with signals recorded from the Quattrocento and the Open Ephys GUI, which is compatible with Intan and Open Ephys acquisition boards. I-Spin has also been adapted by TMSi to perform real-time decomposition with their devices (<ext-link ext-link-type="uri" xlink:href="https://info.tmsi.com/blog/ispin-saga-real-time-motor-unit-decomposition-tool">https://info.tmsi.com/blog/ispin-saga-real-time-motor-unit-decomposition-tool</ext-link>).</p><p>Moreover, the manual editing panel of the software can now import any files from these devices and allow users to reformat data in mat files to perform offline analyses.</p><disp-quote content-type="editor-comment"><p>While this may be a powerful platform, it is also very possible that without more details and careful guidance for users on potential pitfalls, many non-experts in sorting could use this as a platform for somewhat sloppy science.</p></disp-quote><p>We fully agree with the reviewer that real-time EMG decomposition - with a different approach here than spike sorting - may yield unreliable results if not applied properly. As outlined in the introduction of our initial manuscript, assessing the accuracy and limitations of real-time decomposition was a primary motivation for this study. Specifically, we compared accuracy between contraction intensities, muscles, and electrode types (see Results section).</p><p>We also demonstrated that manual editing of the decomposition outputs should be done after the training phase to improve the motor unit filters, thereby improving the accuracy of real-time decomposition. We also outlined the importance to never blindly accept the result of the decomposition without visual inspection and manual editing. (P8; L214)</p><p>‘These results show how manual editing can improve the accuracy of spike detection from the motor unit pulse trains. Moreover, a SIL value around 0.9 can be used as a threshold to automatically remove the motor unit pulse trains with a poor quality a priori. Thus, these two steps were performed in the all the subsequent analyses. Importantly, it is worth noting that the motor unit pulse train must always be visually inspected after the session to check for errors of the automatic identification of discharge times.’</p><p>We have also included more detailed information about the manual editing process (see above).</p><disp-quote content-type="editor-comment"><p>The authors mention that data is included with the Github software package. I could not find any included data, or instructions on how to run the software offline on example data.</p></disp-quote><p>This link to the data on figshare was added in the GitHub.</p><disp-quote content-type="editor-comment"><p>Given the centrality of the real-time visual feedback to their system, the authors should show some examples of the actual display etc. so readers can understand what the system in action actually looks like (I believe there is no presentation of the actual system in the manuscript, just in the User Guide). Similarly, it would be helpful to have a schematic figure outlining the full workflow that a user goes through when using this system.</p></disp-quote><p>A figure of the workflow is present in the user manual. Additionally, we now display traces of visual feedback in figure 5 and we added videos of the software during each of the visual feedback in supplemental materials.</p><disp-quote content-type="editor-comment"><p>The authors note all data was collected with male subjects because more motor units can be decomposed from male subjects relative to females. But what is the long-term outlook for the field if studies avoid female subjects because their motor units may be harder to decompose? This should at least be discussed - it is an important challenge for the field to solve, and it is unacceptable if new methods just avoid this problem and are only tested on male subjects.</p></disp-quote><p>This point was rightly raised by each of the three reviewers. To solve this, we added data collected on four females, and discussed future developments to make the decomposition of surface EMG equally performant for everyone (P.20; L.480).</p><p>‘An important consideration regarding the implementation of offline or real-time surface EMG decomposition is the difference between individuals, with an overall lower yield in number of identified motor units in females (here: 9 ± 12) than in males (here: 30 ± 13). Typically, the number of identified motor units from surface EMG is twice as low in females than males (32, 49, 50). The cause for this difference remains unclear. It may be related to variations in properties of the tissues separating the motor units from the recording electrodes, or to differences in the morphological and physiological properties of muscle fibres, as well as to the innervation ratios of motor units. These sex-related differences have so far only been supported by data extracted from animal experiments (51). However, the recent developments of simulation frameworks capable of generating highly realistic EMG signals for anthropometrically diverse populations may help understanding the impact of sex-related differences in humans (52). Specifically, these simulations can account for diverse anatomical (e.g. muscle volume and architecture, thickness of subcutaneous tissues) and physiological characteristics (e.g. innervation ratio, number of motor units, fibre cross sectional area, fibre conduction velocity, contribution of rate coding vs. spatial recruitment). Generating such dataset could help identifying the primary factors affecting EMG decomposition performance, ultimately enabling the refinement of algorithms and/or surface electrode design.’</p><disp-quote content-type="editor-comment"><p>Specific comments on the core contributions of this paper:</p><p>C1. Development of an open-source implementation of the Negro algorithm</p><p>This seems an important contribution and useful for the community. There are very few figures showing any primary data, the efficacy of sorting, raw traces showing the waveforms that are identified, cluster shapes, etc. I realize the high-level algorithm has been outlined elsewhere, but the implementation in this package, and its efficacy, is a core component of the system and the claims being made in this paper. Much more presentation of data is needed to evaluate this.</p></disp-quote><p>It is worth noting that the approach used here is based on blind source separation, which is different than spike-sorting algorithms as it relies on the statistical properties of the spike trains (their sparseness) rather than the profiles of the action potentials. In short, we optimise separation vectors that are applied onto the whitened signal to generate a sparse motor unit pulse train. The discharge times are then directly estimated from the high peaks of this pulse train (Section 1 of the results; overview of the approach).</p><p>We are thus displaying motor unit pulse trains in three figures with the automatically detected discharge times, with cases of successful separation in figure 1 and merged motor units in the same pulse train in figures 3 and 4.</p><p>We also validated the algorithm with synthetic EMG to provide objective data on the accuracy of the algorithm. These results are shown in the section ‘Validation of the algorithm’ and displayed in figure 3.</p><disp-quote content-type="editor-comment"><p>Similarly, more information on the offline manual editing process (e.g. showing before/after examples with primary data) would be important to gain confidence in the method. The current paper shows application to both surface EMG and intramuscular EMG, but I could not find IM EMG examples in the Hug paper (apologies if I missed them). Surface and IM data are very, very different, so one would imagine the considerations when working with them should also be different.</p></disp-quote><p>In response to another comment from the reviewer, we have included more detailed information about the manual editing process (see above). As stated above, the decomposition approach used in our software differs from a spike sorting approach. Therefore, even though intramuscular and surface EMG signals are different, the decomposition and manual editing process is the same.</p><disp-quote content-type="editor-comment"><p>All descriptions of math/algorithms are presented in text, without any actual math, variable definitions, etc. This presentation makes it difficult to understand what is done. I would strongly recommend writing out equations and defining variables where possible.</p><p>More details on how the level of sparseness is controlled during optimization would be helpful.</p><p>And how this sparseness penalty is weighed against other optimization costs.</p></disp-quote><p>A mathematical description of the model has been added in the methods (P25; L620)</p><p>‘Mathematical modelling of the recorded spike trains.</p><p>The spike train of a motor neuron recorded over time 𝑡 ∈ [0, 𝑇] can be described as the result of a convolution between a delta function (d) representing the firing times (j), and finite impulse responses (h) representing action potentials of duration L: <inline-formula><mml:math id="sa3m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>φ</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. In practice, the nature of h and the duration L depend on the type of recordings. For electrophysiological measurements, h characterises the local electrical field generated by the spike and conducted through the surrounding tissues.</p><p>As the recorded volume of tissue comprises many active neurons, each recording can be considered as a convolutive mixture of multiple sources, and the previous equation can be expressed in the form of a matrix to also consider all the electrodes of an array: given <inline-formula><mml:math id="sa3m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>φ</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi mathvariant="bold-italic">H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula><inline-formula><mml:math id="sa3m3"><mml:mi id="e6398ed2-f8de-46ea-8463-1d7164c5118d">N</mml:mi><mml:mo stretchy="false" id="b164c206-ee8e-4fb2-8db4-ba54194ca3ac">(</mml:mo><mml:mi id="af4875a1-6fd5-4439-a173-8873af190a8a">t</mml:mi><mml:mo stretchy="false" id="f8e01390-2d5b-4e2b-8af2-0dd2c40fce74">)</mml:mo></mml:math></inline-formula>, where <inline-formula><mml:math id="sa3m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is a matrix of m electrophysiological signals, <inline-formula><mml:math id="sa3m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula><inline-formula><mml:math id="sa3m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is a matrix of n motor neurons’ spike trains, and 𝐻(𝑙) is a m by n matrix containing the lth sample of action potentials from n neurons and m signals. In this situation, we can reformulate the model as an instantaneous mixture of an extended set of sources, that is, the motor neurons’ spike trains and their delayed versions. This allows us to simply write the previous equation as a multiplication of matrices, in which each source is delayed L times, L being the duration of the impulse response h. This model can be inverted for neural decoding with source-separation approaches.’</p><p>The rest of the decomposition approach was rewritten to make it clearer for the reader:</p><p>‘The monopolar EMG signals collected during the baseline contractions were extended with an extension factor of 1000/m (21), where m is the number of channels free of any noise or artifact. The signals were then demeaned and whitened. A contrast function was iteratively applied to estimate a separation vector that maximised the level of sparseness of the motor unit pulse train (Figure 1B). This loop stopped when the variation of the separation vector between two successive iterations reaches a predefined lower bound. After the application of a peak detection algorithm, the motor unit pulse train contained high peaks (i.e., the spikes from the identified motor unit) and low peaks from other motor units and noise. High peaks were separated from low peaks and noise using K-mean classification with two classes (Figure 1B). The peaks from the class with the highest centroid were considered as spikes of the identified motor unit. A second algorithm refined the estimation of the discharge times by iteratively recalculating the separation vector and repeating the steps with peak detection and K-mean classification until the coefficient of variation of the inter-spike intervals was minimised. The accuracy of each estimated spike train was assessed by computing the silhouette (SIL) value between the two classes of peaks identified with K-mean classification (24). When the SIL exceeded a predetermined threshold, the motor unit filter was saved for the real-time decomposition, together with the centroids of the ‘spikes’ and ‘noise’ classes (Figure 2A).’</p><disp-quote content-type="editor-comment"><p>Overall the paper is not very rigorous about the accuracy of motor unit identification. For example, the authors note that SIL of 0.9 is generally used for offline evaluation (why is this acceptable?), but it was lowered to 0.8 for particular muscles in this study. But overall, it is unclear how sorting accuracy/inaccuracy affects performance in the target applications of this work.</p></disp-quote><p>In the section mentioned by the reviewer, we aimed to show how this metric can help to automatically select motor units that are likely to have a higher accuracy of spike detections as the peaks of their pulse train are easily separable from the noise.</p><p>We reformulated the conclusion of this section to make it clearer (P8; L214):</p><p>‘These results show how manual editing can improve the accuracy of spike detection from the motor unit pulse trains. Moreover, a SIL value around 0.9 can be used as a threshold to automatically remove the motor unit pulse trains with a poor quality a priori. Thus, these two steps were performed in the all the subsequent analyses. Importantly, it is worth noting that the motor unit pulse train must always be visually inspected after the session to check for errors of the automatic identification of discharge times.’</p><disp-quote content-type="editor-comment"><p>C2. For real-time experiments, variability/jitter is important to characterize. Fig. 4 seems to be presenting mean computational times, etc, but no presentation of variability is shown. It would be helpful to depict data distributions somehow, rather than just mean values.</p></disp-quote><p>The variability in computational time was added to this section (P.28; L.730):</p><p>‘The standard deviation of computational times across windows reached 5.4 ± 4.0 ms (raster plot), 4.0 ± 3.2 ms (smoothed firing rate), and 2.8 ± 2.5 ms (quadrant)’</p><p>The computational time minimally varied between the successive windows, except when the labels of the x-axis were updated in real-time with scrolling feedback. It was overall always well below the duration of the window.</p><fig id="sa3fig1" position="float"><label>Author response image 1.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88670-sa3-fig1-v1.tif"/></fig><p>Computational time for each iteration of the algorithm in one participant. The top panels display the continuous computation time through the recording, while the bottom panels display the distribution of computational times. The dash line represents the duration of a window of EMG signals.</p><disp-quote content-type="editor-comment"><p>There is some description about the difference between units identified during baseline contractions, and how they might be misidentified during online contractions (&quot;Accuracy of the real-time identification...&quot;). This should be described in more detail.</p></disp-quote><p>We added an additional section in the results to clarify the concept of motor unit filters, and the reapplication of motor unit filters on signals in real-time. We highlighted how each motor unit must have a unique spatio-temporal signature to be accurately identified by our algorithms, in opposition to merged motor units sharing the same spatio-temporal features. This section shows how motor units accurately identified during baseline contractions can be misidentified during online contractions (P12; L295).</p><p>‘Application of motor unit filters in experimental data</p><p>We then asked eight participants (4 males and 4 females) to perform trapezoidal isometric contractions with plateaus of force set at 10% and 20% MVC during which surface EMG signals were recorded from the TA with 256 electrodes separated by 4 mm. The aim of this experiment was to confirm the results of the simulation; specifically, to test the accuracy of the online decomposition when the level of force was below, equal to, or above the level of force produced during the baseline contraction used to estimate the motor unit filters (Figure 4). We assessed the accuracy of the motor unit spike trains identified in real time using their manually edited version as reference. 144 motor units were identified at both 10 and 20% MVC. When the test signals were recorded at the same level of force as the baseline contraction, we obtained rates of agreement of 95.6 ± 6.8% (10% MVC) and 93.9 ± 5.9% (20% MVC). The sensitivity reached 95.9 ± 6.7% (10% MVC) and 94.4 ± 5.6% (20% MVC), and the precision reached 99.6 ± 1.3% (10% MVC) and 99.4 ± 1.9% (20% MVC).</p><p>When the filters identified at 20% MVC were applied on signals recorded at a lower level of force (10% MVC), the rates of agreement decreased to 87.9 ± 16.2%. The sensitivity also decreased to 88.0 ± 16.2%, but the precision remained high (99.4 ± 4.3). Thus, the decrease in accuracy was mostly caused by missed discharge times rather than the false identification of artifacts or spikes from other motor units.</p><p>When the filters identified at 10% MVC were applied to signals recorded at a higher level of force, the rates of agreement decreased to 83.3 ± 13.5%. The sensitivity decreased to 90.7 ± 8.1%, and the precision also decreased to 90.9 ± 12.6%. This result confirms what was observed with synthetic EMG, that is motor units recruited between 10 and 20% MVC can substantially disrupt the accuracy of the decomposition in real-time, as highlighted in Figure 4 (lower panel). Importantly, this situation does not happen for all the motor units, as suggested by the distribution of the values in Figure 4.’</p><disp-quote content-type="editor-comment"><p>Fig. 6: Given that a key challenge in sorting should be that collisions occur during large contractions, much more primary data should be presented/visualized to show how the accuracy of sorting changes during larger contractions in online experiments.</p></disp-quote><p>As indicated above, the decomposition approach implemented in our software is not based on spikesorting, so it does not require to separate overlapping profiles of action potentials (see Methods).</p><disp-quote content-type="editor-comment"><p>Fig.7: In presenting the accuracy of biofeedback, it is very hard to gain any intuition for performance by just looking at RMSE values. Showing the online decoded and edited trajectories would help readers understand the magnitude of errors.</p></disp-quote><p>We updated the figure to display examples of visual feedback before and after manual editing.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #3 (Public Review):</bold></p><p>In this manuscript, Rossato and colleagues present a method for real-time decoding of EMG into putative single motor units. Their manuscript details a variety of decision points in their code and data collection pipeline that led to a final result of recording on the order of ~10 putative motor units per muscle in human males. Overall, the manuscript is highly restricted in its potential utility but may be of interest to aficionados. For those outside the field of human or nonhuman primate EMG, these methods will be of limited interest.</p></disp-quote><p>We thank the reviewer for his/her throughout evaluation of our manuscript. We recognise that this tool/resource will immediately benefit groups working with humans or nonhuman primate models. However, the recent development of intramuscular thin films with various designs adapted to rodents and smaller animals could expand the range of future users (Chung et al., 2023, Elife). Nonetheless, decoding motor units in humans could be useful for many fields, e.g. in the domains of movement restoration and augmentation. The following paragraph has been added in the introduction section to highlight the importance of real-time decoding of motor unit activity (P3; L67):</p><p>‘The activity of motor neuron – in the form of spike trains – represents the neural code of movement to muscles. Decoding this firing activity in real-time during various behaviours can thus substantially enhance our understanding of movement control (2-5). Real-time decoding is also essential for interfacing with external devices (6) or virtual limbs (7) when activity is present at the periphery of the nervous system. For example, individuals with a spinal cord injury can control a virtual hand with the residual firing activity of the motor units in their forearm (7). Furthermore, sampling the activity of motor units receiving a substantial portion of independent synaptic inputs may pave the way for movement augmentation – specifically, extending a person’s movement repertoire through the increase of controllable degrees of freedom (8). In this way, Formento et al. (3) showed that individuals can intuitively learn to independently control motor units within the same muscle using visual cues. Having access to open-source tools that perform the real-time decoding of motor units would allow an increasing number of researchers to improve and expand the range of these applications.’</p><disp-quote content-type="editor-comment"><p>Notes</p><p>(1) Artificial data should be used with this method to provide ground truth performance evaluations. Without it, the study assumptions are unchallenged and could be seriously flawed.</p></disp-quote><p>A new section on the validation of the algorithm has been added. We verified the accuracy of the algorithm by comparing the series of identified discharge times with the ground truth, i.e., the simulated discharge times. (P10; L235)</p><p>‘Validation of the algorithm</p><p>We first validated the accuracy of the algorithm using synthetic EMG signals generated with an anatomical model entailing a cylindrical muscle volume with parallel fibres [see Farina et al. (29), Konstantin et al. (36) for a full description of the model]. In this model, subcutaneous and skin layers separate the muscle from a grid of 65 surface electrodes (5 columns, 13 rows), while an intramuscular array of electrodes is directly inserted in the muscle under the grid with an angle of 30 degrees. 150 motor units were distributed within the cross section of the muscle. Recruitment thresholds, firing rate/excitatory drive relations, and twitch parameters were assigned to each motor unit using the same procedure as Fuglevand et al. (37). During each simulation, a proportional-integral-derivative controller adjusted the level of excitatory drive to minimise the error between a predefined target of force and the force generated by the active motor units.</p><p>Figure 3A displays the raster plots of the active motor units during simulated trapezoidal isometric contractions with plateaus of force set at 10%, 20%, and 30% MVC. A sinusoidal isometric contraction ranging between 15 and 25% MVC at a frequency of 0.5 Hz was also simulated. We identified on average 10 ± 1 and 12 ± 2 motor units with surface and intramuscular arrays, respectively (Figure 3A). During the offline decomposition, the rate of agreement between the identified discharge times and the ground truth, that is, the simulated discharge times, reached 100.0 ± 0.0% for intramuscular EMG signals and 99.2 ± 1.8% for surface EMG signals (Figure 3B). The offline estimation of motor unit filters was therefore highly accurate, independently of the level of force or the pattern of the isometric contraction.</p><p>Motor unit filters estimated during a baseline contraction at 20% MVC were then applied in real-time on signals simulated during a contraction with a different pattern (sinusoidal; Figure 3C). The rates of agreement between the online decomposition and the ground truth reached 96.3 ± 4.6% and 98.4 ± 2.3% for surface and intramuscular EMG signals, respectively. Finally, we tested whether the accuracy of the online decomposition changed when the level of force decreased or increased by 10% MVC when compared to the calibration performed at 20% MVC (Figure 3D). The rate of agreement remained high when applying the motor unit filters on signals recorded at 10% MVC: 99.8 ± 0.2% (surface EMG) and 99.5 ± 0.3% (intramuscular EMG). It is worth noting that only 3 out of 10 motor units identified from surface EMG at 20% MVC were active at 10% MVC, while 8 out of 12 motor units identified from intramuscular EMG were active at 10 % MVC. This shows how the decomposition of EMG signals tends to identify the last recruited motor units, which often innervate a larger number of fibres than the early recruited motor units (38). On the contrary, the application of motor unit filters on signals simulated at 30% MVC led to a decrease in the rate of agreement, with values of 88.6 ± 14.0% (surface EMG) and 80.3 ± 19.2% (intramuscular EMG). This decrease in accuracy did not impact all the motor units, with 5 motor units keeping a rate of agreement above 95% in both signals. For the other motor units, we observed a decrease in precision, which estimates the ratio of true discharge times over the total number of identified discharge times. This was caused by the recruitment of two motor units sharing a similar space within the muscle, which resulted in a merge in the same pulse train (Figure 3D).’</p><disp-quote content-type="editor-comment"><p>(2) From the point of view of a motor control neuroscientist studying movement in animals other than humans or non-human primates, the title was misleadingly hopeful. The use case presented in this study requires human participants to perform isometric contractions, facilitating spatially redundant recordings across the muscle for the algorithm to work. It is unclear whether these methods will be of utility to use cases under more physiological conditions (ie. dynamic movement).</p></disp-quote><p>We modified the title to read: “I-Spin live: An open-source software based on blind-source separation for real-time decoding of motor unit activity in humans”.</p><disp-quote content-type="editor-comment"><p>(3) The text states that &quot;EMG signals recorded with an array of electrodes can be considered and instantaneous mixture of the original motor unit spike trains and their delayed versions.&quot; While this may be a true statement, it is not a complete statement, since motor units at distal sites may be shared, not shared, or novel. It was not clear to me whether the diversity of these scenarios would affect the performance of the software or introduce artifacts. In other words, if at site 1 you can pick up the bulk signal of units 1,2,3,4; at site two you pick up the signals of units 2,3,4,5 and site three you pick up the signal of units 3,4,5,6, what does the algorithm assume is happening and what does it report and why?</p></disp-quote><p>This section has been rewritten to clarify this point. The EMG signal represents indeed the sum of the active motor units within the recorded muscle volume. Put in other words, it is possible that deep motor units or motor units with innervated fibres far away from the grid were not in this recorded muscle volume, and thus non-identifiable. Another necessary condition to ensure the identifiability of the motor unit is its unique spatio-temporal signature within the signal. It means that two motor units close to each other within the muscle volume will be merged by the model. This point was clarified in the results during the validation and the application of filters on experimental data.</p><p>(P5; L115)</p><p>‘An EMG signal represents the sum of trains of action potentials from all the active motor units within the recorded muscle volume (Figure 1A). During stationary conditions, e.g., isometric contractions, the train of motor unit action potentials can be modelled as the convolution of series of discrete delta functions, representing the discharge times, and motor unit action potentials that have a consistent shape across time. When EMG signals are recorded with an array of electrodes, the shape of the recorded potential of each motor unit differs across electrodes. This is due to (1) the varying conduction velocity of action potentials among the muscle fibres, and (2) the location/depth of the muscle fibres that belong to each motor unit relatively to the electrodes, which impact the low pass filtering effect of the tissue on the recorded potential. Increasing the number and density of recording electrodes increases the likelihood that each motor unit will have a unique motor unit action potential profile (shape), i.e., a temporal and spatial profile that differs from all the other active motor unit within the recorded volume (16, 29). The uniqueness of motor unit action potential profiles is necessary for the blind source separation to accurately estimate the motor unit discharge times. Conversely, the spike trains of two motor units with similar action potential profiles will be merged by the model.</p><p>Our software uses a fast independent component analysis (fastICA) to retrieve motor unit spike trains from the EMG signals. For this, it iteratively optimises a separation vector (i.e., the motor unit filter) for each motor unit [Figure 1B; (24-26)]. (24-26). The projection of the EMG signals on this separation vector generates a sparse motor unit pulse train, with most of its samples close to zero and a smaller number of samples significantly greater than zero (Figure 1B). The discharge times are estimated from this motor unit pulse train using a peak detection function and a k-mean classification with two classes to separate the high peaks (spikes) from the low peaks (noise and other motor units). During the decomposition in real-time, short segments of EMG signals are projected on the saved separation vectors, and the peaks are classified as discharge times if they are closer to the centroid of the class ‘spikes’ than to the centroid of the class ‘noise’ (Figure 1C). The algorithm used to identify motor units discharge activity is based on that proposed by Negro et al. (24) and Barsakcioglu et al. (26).’</p><disp-quote content-type="editor-comment"><p>(4) I could not fully appreciate the performance gap solved by the current methods. What was not achievable before that is now achievable? The 125 ms speed of deconvolution? What was achievable before? Intro text around ln 85 states that 'most of the current implementations of this approach rely on offline processing, which restricts its ability to be used...&quot; but no reference is provided here about what the non 'most' of can achieve.</p><p>(8) The authors might try to add text to be more circumspect about the contributions of this method. I would recommend emphasizing the conceptual advances over the specifics of the performance of the algorithm since processor speed and implementation of the ideas in a faster environment (Matlab can be slow) will change those outcomes in a trivial way. Yet, much of the results section is very focused on these metrics.</p></disp-quote><p>The main contribution of this work submitted to the section ‘Tools and Resource’ of Elife is to provide a user interface that enables researchers to decompose EMG signals recorded with multichannel systems into motor unit activities, to perform this process in real-time, and to translate it into visual feedback. The user interface is fully open source and does not require coding experience. If necessary, the users can inspect the commented code and even modify it for their own experimental setup. The toolbox is now compatible with various acquisition boards, which can expand its use to novel surface and intramuscular arrays of electrodes.</p><disp-quote content-type="editor-comment"><p>(5) Relatedly, it would have been nice to see a proof of concept using real-time feedback for some kind of biofeedback signal. If that is the objective here, why not show us this? I found the actual readout metrics of performance rather esoteric. They may be of interest to very close experts so I will defer to them for input.</p></disp-quote><p>We agree with the reviewer. Videos were added to the supplemental materials to show the different forms of feedback, together with a case scenario where the participant try to separate the activity of two motor units from the same muscle.</p><disp-quote content-type="editor-comment"><p>(6) I was disappointed to see that only male participants are used because of some vague statement that 'it is widely known in the field' that more motor units can be resolved in males, without thorough referencing. It seems that the objective of the algorithm is the speed of analysis, not the number of units, which makes the elimination of female participants not justified.</p></disp-quote><p>The reviewer is right and that was corrected in the new version of the manuscript. We first performed additional experiments in both males and females focused on the accuracy of the approach, and further discussed the differences in yield between men and women in the discussion together with research perspectives to solve this issue.</p><p>Results (P12; L296):</p><p>‘We then asked eight participants (4 males and 4 females) to perform trapezoidal isometric contractions with plateaus of force set at 10% and 20% MVC during which surface EMG signals were recorded from the TA with 256 electrodes separated by 4 mm. The aim of this experiment was to confirm the results of the simulation; specifically, to test the accuracy of the online decomposition when the level of force was below, equal to, or above the level of force produced during the baseline contraction used to estimate the motor unit filters (Figure 4). We assessed the accuracy of the motor unit spike trains identified in real time using their manually edited version as reference. 144 motor units were identified at both 10 and 20% MVC. When the test signals were recorded at the same level of force as the baseline contraction, we obtained rates of agreement of 95.6 ± 6.8% (10% MVC) and 93.9 ± 5.9% (20% MVC). The sensitivity reached 95.9 ± 6.7% (10% MVC) and 94.4 ± 5.6% (20% MVC), and the precision reached 99.6 ± 1.3% (10% MVC) and 99.4 ± 1.9% (20% MVC).</p><p>When the filters identified at 20% MVC were applied on signals recorded at a lower level of force (10% MVC), the rates of agreement decreased to 87.9 ± 16.2%. The sensitivity also decreased to 88.0 ± 16.2%, but the precision remained high (99.4 ± 4.3). Thus, the decrease in accuracy was mostly caused by missed discharge times rather than the false identification of artifacts or spikes from other motor units. When the filters identified at 10% MVC were applied to signals recorded at a higher level of force, the rates of agreement decreased to 83.3 ± 13.5%. The sensitivity decreased to 90.7 ± 8.1%, and the precision also decreased to 90.9 ± 12.6%. This result confirms what was observed with synthetic EMG, that is motor units recruited between 10 and 20% MVC can substantially disrupt the accuracy of the decomposition in real-time, as highlighted in Figure 4 (lower panel). Importantly, this situation does not happen for all the motor units, as suggested by the distribution of the values in Figure 4.’</p><p>Discussion (P20; L480):</p><p>“An important consideration regarding the implementation of offline or real-time surface EMG decomposition is the difference between individuals, with an overall lower yield in number of identified motor units in females (here: 9 ± 12) than in males (here: 30 ± 13). Typically, the number of identified motor units from surface EMG is twice as low in females than males (32, 49, 50). The cause for this difference remains unclear. It may be related to variations in properties of the tissues separating the motor units from the recording electrodes, or to differences in the morphological and physiological properties of muscle fibres, as well as to the innervation ratios of motor units. These sex-related differences have so far only been supported by data extracted from animal experiments (51). However, the recent developments of simulation frameworks capable of generating highly realistic EMG signals for anthropometrically diverse populations may help understanding the impact of sex-related differences in humans (52). Specifically, these simulations can account for diverse anatomical (e.g. muscle volume and architecture, thickness of subcutaneous tissues) and physiological characteristics (e.g. innervation ratio, number of motor units, fibre cross sectional area, fibre conduction velocity, contribution of rate coding vs. spatial recruitment). Generating such dataset could help identifying the primary factors affecting EMG decomposition performance, ultimately enabling the refinement of algorithms and/or surface electrode design.”</p><disp-quote content-type="editor-comment"><p>(7) Human curation is often used in spike sorting, but the description of criteria used in this step or how the human curation choices are documented is missing.</p></disp-quote><p>To address the reviewer’s comment, we added a new paragraph in the Method section to describe the manual editing process: (P26; L657)</p><p>“There is a consensus among experts that automatic decomposition should be followed by visual inspection and manual editing (55). Manual editing involves the following steps: (i) removing spikes that result in erroneous firing rates (outliers), (ii) adding discharge times thar are clearly distinguishable from the noise, (iii) recalculating the separation vector, (iv) reapplying the separation vector on the EMG signals (either a selected window or the entire signal), and (v) repeating this procedure until no outliers are present and all clearly distinguishable spikes have been selected. Importantly, the manual editing of potentially missed or falsely identified discharge times should not be accepted before the application of the updated motor unit separation vector, thereby generating a new pulse train. Manual edits should be accepted only if the silhouette value improves following this operation or remains well above the preestablished threshold. A more extensive description of the manual editing of motor unit pulse trains can be found in (32). Even though some of the aforementioned steps involve subjective decision-making, evidence suggests that manual editing after EMG decomposition with blind source separation approaches remains highly reliable across operators (33). Specifically, the median rates of agreement calculated for 126 motor units over eight operators with various experience in manual editing was 99.6%. All raw and processed data have been made available on a public data repository so that they can be used for training new operators (10.6084/m9.figshare.13695937).”</p><disp-quote content-type="editor-comment"><p>Minor</p><p>Ln 115, &quot;inversing&quot; is not a word. &quot;inverse&quot; is not a verb</p></disp-quote><p>Changed as suggested</p><disp-quote content-type="editor-comment"><p>Ln 186, typo, bioadhesive</p></disp-quote><p>Changed as suggested</p><disp-quote content-type="editor-comment"><p>MVC should be defined on first use. It is currently defined on 3rd use or so.</p><p>The term rate is used in a variety of places without units. Eg line 465 but not limited to that</p></disp-quote><p>Changed as suggested</p><disp-quote content-type="editor-comment"><p><bold>Recommendations for the authors:</bold></p><p><bold>Reviewer #1 (Recommendations For The Authors):</bold></p><p>Two minor comments: Para 125: it is not clear what is meant by &quot;spatial distribution&quot; of recording electrodes.</p></disp-quote><p>‘Density’ was used instead of ‘spatial distribution’ to now read:</p><p>‘Increasing the number and density of recording electrodes increases the likelihood that each motor unit will have a unique motor unit action potential profile (shape), i.e., a temporal and spatial profile that differs from all the other active motor unit within the recorded volume (16, 29).’</p><disp-quote content-type="editor-comment"><p>Para 545: perhaps a bit more explanation about why low spatial overlap is better would be appropriate.</p></disp-quote><p>We added a section in the results showing how motor units with similar spatial signatures are merged by our model, leading to a lower precision. We therefore changed this sentence to now read:</p><p>‘Therefore, the likelihood of having spatially overlapping motor unit action potentials - and thus merged motor units - is lower, which explains why the rate of agreement of motor units identified from intramuscular arrays of electrodes is much higher than grids of surface electrodes (12, 13).’</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Recommendations For The Authors):</bold></p><p>The authors mention that data is included with the Github software package. I could not find any included data, or instructions on how to run the software offline on example data. (Apologies if I missed this - it would be helpful to make it more prominent)</p></disp-quote><p>The link to the data on figshare was added in the GitHub, as well as data samples to run the algorithm offline and test manual editing.</p><disp-quote content-type="editor-comment"><p>Minor comments:</p><p>Not sure what is meant by &quot;boundary capabilities of online decomposition&quot;</p></disp-quote><p>This was removed to only discuss the accuracy of online decomposition.</p><disp-quote content-type="editor-comment"><p>CoV for ISIs is not formally defined or justified.</p></disp-quote><p>This was added to the caption of figure 2:</p><p>‘The CoV of ISI estimates the regularity of spiking for each motor unit, an expected behaviour during isometric contractions at consistent levels of force.’</p><disp-quote content-type="editor-comment"><p>Fig. 4: slope units should be ms/motor unit, perhaps?</p></disp-quote><p>Changed as suggested.</p><disp-quote content-type="editor-comment"><p>In some places, the manuscript uses &quot;edition&quot; to describe the editing process. I am not familiar with this usage, &quot;editing&quot; may be more common.</p></disp-quote><p>Editing is now used through the entire manuscript.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #3 (Recommendations For The Authors):</bold></p><p>I would recommend that the authors revise their manuscript to conform to eLife formatting guidelines, including moving the methods to the end of the manuscript. This change may entail substantial editing since many ideas are presented in order from the beginning of the methods. While this suggestion may seem superficial, the success of the new publishing model might benefit from general uniformity in manuscript style.</p></disp-quote><p>We changed and edited the draft to follow the classic format of Elife papers.</p></body></sub-article></article>