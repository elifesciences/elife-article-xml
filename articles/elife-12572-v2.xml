<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">12572</article-id><article-id pub-id-type="doi">10.7554/eLife.12572</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title><bold>A stochastic neuronal model predicts random search behaviors at multiple spatial scales in</bold> <italic>C. elegans</italic></article-title> </title-group><contrib-group><contrib contrib-type="author" id="author-35258"><name><surname>Roberts</surname><given-names>William M</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-35250"><name><surname>Augustine</surname><given-names>Steven B</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-35251"><name><surname>Lawton</surname><given-names>Kristy J</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-35252"><name><surname>Lindsay</surname><given-names>Theodore H</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-19365"><name><surname>Thiele</surname><given-names>Tod R</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-35265"><name><surname>Izquierdo</surname><given-names>Eduardo J</given-names></name><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-2733"><name><surname>Faumont</surname><given-names>Serge</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-35254"><name><surname>Lindsay</surname><given-names>Rebecca A</given-names></name><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-35255"><name><surname>Britton</surname><given-names>Matthew Cale</given-names></name><xref ref-type="aff" rid="aff8">8</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-35256"><name><surname>Pokala</surname><given-names>Navin</given-names></name><xref ref-type="aff" rid="aff9">9</xref><xref ref-type="fn" rid="con10"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-45343"><name><surname>Bargmann</surname><given-names>Cornelia I</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8484-0618</contrib-id><xref ref-type="aff" rid="aff10">10</xref><xref ref-type="fn" rid="con11"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-34529"><name><surname>Lockery</surname><given-names>Shawn R</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8535-7989</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="fn" rid="con12"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Institute of Neuroscience</institution>, <institution>University of Oregon</institution>, <addr-line><named-content content-type="city">Eugene</named-content></addr-line>, <country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">School of Nursing</institution>, <institution>University of Pennsylvania</institution>, <addr-line><named-content content-type="city">Philadelphia</named-content></addr-line>, <country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Biology Department</institution>, <institution>Reed College</institution>, <addr-line><named-content content-type="city">Portland</named-content></addr-line>, <country>United States</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">Division of Biology and Biological Engineering</institution>, <institution>California Institute of Technology</institution>, <addr-line><named-content content-type="city">Pasadena</named-content></addr-line>, <country>United States</country></aff><aff id="aff5"><label>5</label><institution content-type="dept">Department of Biological Sciences</institution>, <institution>University of Toronto</institution>, <addr-line><named-content content-type="city">Toronto</named-content></addr-line>, <country>Canada</country></aff><aff id="aff6"><label>6</label><institution content-type="dept">Cognitive Science Program</institution>, <institution>Indiana University</institution>, <addr-line><named-content content-type="city">Bloomington</named-content></addr-line>, <country>United States</country></aff><aff id="aff7"><label>7</label><institution content-type="dept">Department of Ophthalmology, The Vision Center</institution>, <institution>Children's Hospital Los Angeles</institution>, <addr-line><named-content content-type="city">Los Angeles</named-content></addr-line>, <country>United States</country></aff><aff id="aff8"><label>8</label><institution content-type="dept">Department of Neurology</institution>, <institution>University of Minnesota</institution>, <addr-line><named-content content-type="city">Minneapolis</named-content></addr-line>, <country>United States</country></aff><aff id="aff9"><label>9</label><institution content-type="dept">Department of Life Sciences</institution>, <institution>New York Institute of Technology</institution>, <addr-line><named-content content-type="city">Old Westbury</named-content></addr-line>, <country>United States</country></aff><aff id="aff10"><label>10</label><institution>Howard Hughes Medical Institute, Rockefeller University</institution>, <addr-line><named-content content-type="city">New York</named-content></addr-line>, <country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Reviewing editor</role><aff id="aff11"><institution>Emory University</institution>, <country>United States</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>shawn@uoregon.edu</email></corresp><fn fn-type="con" id="equal-contrib"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="pub" publication-format="electronic"><day>29</day><month>01</month><year>2016</year></pub-date><pub-date pub-type="collection"><year>2016</year></pub-date><volume>5</volume><elocation-id>e12572</elocation-id><history><date date-type="received"><day>26</day><month>10</month><year>2015</year></date><date date-type="accepted"><day>19</day><month>01</month><year>2016</year></date></history><permissions><copyright-statement>© 2016, Roberts et al</copyright-statement><copyright-year>2016</copyright-year><copyright-holder>Roberts et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-12572-v2.pdf"/><related-article ext-link-type="doi" id="ra1" related-article-type="article-reference" xlink:href="10.7554/eLife.08966"/><abstract><object-id pub-id-type="doi">10.7554/eLife.12572.001</object-id><p>Random search is a behavioral strategy used by organisms from bacteria to humans to locate food that is randomly distributed and undetectable at a distance. We investigated this behavior in the nematode <italic>Caenorhabditis elegans</italic>, an organism with a small, well-described nervous system. Here we formulate a mathematical model of random search abstracted from the <italic>C. elegans</italic> connectome and fit to a large-scale kinematic analysis of <italic>C. elegans</italic> behavior at submicron resolution. The model predicts behavioral effects of neuronal ablations and genetic perturbations, as well as unexpected aspects of wild type behavior. The predictive success of the model indicates that random search in <italic>C. elegans</italic> can be understood in terms of a neuronal flip-flop circuit involving reciprocal inhibition between two populations of stochastic neurons. Our findings establish a unified theoretical framework for understanding <italic>C. elegans</italic> locomotion and a testable neuronal model of random search that can be applied to other organisms.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.001">http://dx.doi.org/10.7554/eLife.12572.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.12572.002</object-id><title>eLife digest</title><p>An animal’s ability to rapidly and efficiently locate new sources of food in its environment can mean the difference between life and death. As a result, animals have evolved foraging strategies that are adapted to the distribution and detectability of food sources. Organisms ranging from bacteria to humans use one such strategy, called random search, to locate food that cannot be detected at a distance and that is randomly distributed in their surroundings. The biological mechanisms that underpin random search are relatively well understood in single-cell organisms such as bacteria, but this information tells us little about the mechanisms that are used by animals, which use their nervous system to control their foraging behavior.</p><p>Roberts et al. have now investigated the biological basis for random search behavior in a tiny roundworm called <italic>Caenorhabditis elegans</italic>. This worm forages for pockets of bacteria in decaying plant matter and has a simple and well-understood nervous system. Roberts et al. used information on how the cells in this worm’s nervous system connect together into so-called “neural circuits” to generate a mathematical model of random searching.</p><p>The model revealed that the worm’s neural circuitry for random searching can be understood in terms of two groups of neuron-like components that switch randomly between “ON” and “OFF” states. While one group promotes forward movement, the other promotes backward movement, which is associated with a change in search direction. These two groups inhibit each other so that only one group usually is active at a given time. By adjusting this model to reproduce the behavioral records of real worms searching for food, Roberts et al. could predict the key neuronal connections involved. These predictions were then confirmed by taking electrical recordings from neurons. The model could also account for the unexpected behavioral effects that are seen when a neuron in one of these groups was destroyed or altered by a genetic mutation.</p><p>These findings thus reveal a biological mechanism for random search behavior in worms that might operate in other animals as well. The findings might also provide future insight into the neural circuits involved in sleep and wakefulness in mammals, which is organized in a similar way.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.002">http://dx.doi.org/10.7554/eLife.12572.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>hidden markov model</kwd><kwd>locomotion</kwd><kwd>spatial orientation</kwd><kwd>stochastic neural network</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd>&lt;i&gt;C. elegans&lt;/i&gt;</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>RO1 MH051383</award-id><principal-award-recipient><name><surname>Augustine</surname><given-names>Steven B</given-names></name><name><surname>Lawton</surname><given-names>Kristy J</given-names></name><name><surname>Lindsay</surname><given-names>Theodore H</given-names></name><name><surname>Thiele</surname><given-names>Tod R</given-names></name><name><surname>Faumont</surname><given-names>Serge</given-names></name><name><surname>Lindsay</surname><given-names>Rebecca A</given-names></name><name><surname>Britton</surname><given-names>Matthew Cale</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A stochastic model of locomotory control in <italic>C. elegans</italic> based on an extensive new set of tracking data can explain and predict effects of ablations and mutations on behavior.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Random search is an evolutionarily ancient set of foraging strategies that evolved as an adaptation to environments in which prey items are undetectable at a distance and occur at unpredictable locations. Rather than attempting to exhaustively search a region of interest, the organism samples the environment at randomly selected points. This is achieved by executing a series of straight-line movements, called 'runs,' terminated at random intervals by sampling episodes during which the organism may or may not find prey. Sampling ends in a reorientation event, called a 'turn,' such that the next run is usually in a different direction from the preceding one. In optimal random foraging strategies the probability distribution of run length is matched to the statistical distribution of isolated food patches or prey items (<xref ref-type="bibr" rid="bib99">Viswanathan, 2011</xref>), with power law distributions predominating when resources are sparsely distributed and exponential distributions predominating when resources are densely distributed (<xref ref-type="bibr" rid="bib41">Humphries et al., 2010</xref>; <xref ref-type="bibr" rid="bib85">Sims et al., 2012</xref>; <xref ref-type="bibr" rid="bib42">Humphries et al., 2012</xref>).</p><p>Random search has been documented in a wide range of species including microorganisms, nematodes, insects, mollusks, fish, birds, and mammals including humans (<xref ref-type="bibr" rid="bib99">Viswanathan, 2011</xref>; <xref ref-type="bibr" rid="bib5">Berg and Brown, 1972</xref>; <xref ref-type="bibr" rid="bib65">Pierce-Shimomura et al., 1999</xref>). In humans this strategy is observed in diverse contexts, from traditional hunter-gatherer societies (<xref ref-type="bibr" rid="bib12">Brown et al., 2007</xref>; <xref ref-type="bibr" rid="bib43">Humphries and Sims, 2014</xref>) to technologically enhanced fishing industries (<xref ref-type="bibr" rid="bib6">Bertrand et al., 2007</xref>). The formal similarities between random search across widely diverse phyla and spatial scales (Viswanathan, 2011) may point to a common mechanism, even in organisms that are highly cognitive. Despite the universality of random search, little is known about its neuronal basis, in part because of the difficulty of recording and manipulating activity in the brain of an unrestrained animal while it explores a large region of space.</p><p>The relatively small spatial scale of random search behavior in <italic>C. elegans</italic>, coupled with the simplicity of its nervous system, provides a unique opportunity to identify the neuronal basis of random search in this species. To the unaided eye, <italic>C. elegans</italic> search behavior consists of forward runs, each terminated after a variable interval by a briefer period of reverse locomotion, which is also variable in duration (<xref ref-type="bibr" rid="bib65">Pierce-Shimomura et al., 1999</xref>; <xref ref-type="bibr" rid="bib107">Zhao et al., 2003</xref>; <xref ref-type="bibr" rid="bib101">Wakabayashi et al., 2004</xref>), with apparently stochastic switching between these two behavioral states. Reversals are followed by resumption of forward movement that frequently begins with a deep body bend. These bends are highly variable in amplitude and lead to movement in a new direction. Thus, the sequence reverse–forward–deep bend, called a 'pirouette' (<xref ref-type="bibr" rid="bib65">Pierce-Shimomura et al., 1999</xref>) is the fundamental turning event in <italic>C. elegans</italic> random search, with functional analogies to tumbles in bacterial chemotaxis (<xref ref-type="bibr" rid="bib5">Berg and Brown, 1972</xref>). Careful inspection reveals a third state, called “pause,” in which locomotion ceases for a fraction of a second or more (<xref ref-type="bibr" rid="bib19">Croll, 1975</xref>; <xref ref-type="bibr" rid="bib85">Shingai, 2000</xref>; <xref ref-type="bibr" rid="bib87">Stephens et al., 2008</xref>; <xref ref-type="bibr" rid="bib75">Rakowski et al., 2013</xref>; <xref ref-type="bibr" rid="bib78">Salvador et al., 2014</xref>). Thus, <italic>C. elegans</italic> locomotion consists of three main behavioral states – forward, reverse, and pause – together with the transitions between them.</p><p> <italic>C.  elegans</italic> subsists on a diet of bacteria that it finds mainly in rotting plant material (<xref ref-type="bibr" rid="bib27">Frézal and Félix, 2015</xref>). In the laboratory, search behavior is studied in worms foraging on agar plates containing one or more dense bacterial lawns, analogous to food patches in the ethological literature. Like many other organisms, <italic>C. elegans</italic> can tune the spatial scale of random search to its physiological state, the availability of food (<xref ref-type="bibr" rid="bib101">Wakabayashi et al., 2004</xref>; <xref ref-type="bibr" rid="bib35">Gray et al., 2005</xref>), and prior knowledge of its distribution (<xref ref-type="bibr" rid="bib14">Calhoun et al., 2014</xref>). The lowest values of search scale are observed during “cropping,” (<xref ref-type="bibr" rid="bib45">Jander, 1975</xref>) the exploitation of a dense food patch. In <italic>C. elegans</italic>, two substates of cropping have been described: &quot;dwelling,&quot; characterized by especially low crawling speed and frequent (presumably short) reversals, and &quot;roaming,&quot; characterized by somewhat higher speeds and less frequent reversals. Transitions between dwelling and roaming, like the transitions between forward and reverse locomotion, are stochastic (<xref ref-type="bibr" rid="bib3">Ben Arous et al., 2009</xref>; <xref ref-type="bibr" rid="bib28">Fujiwara et al., 2002</xref>; <xref ref-type="bibr" rid="bib25">Flavell et al., 2013</xref>). Intermediate values of search scale are observed during &quot;local search&quot; (<xref ref-type="bibr" rid="bib101">Wakabayashi et al., 2004</xref>; <xref ref-type="bibr" rid="bib39">Hills et al., 2004</xref>) when, for example, the animal is suddenly transferred from a bacterial lawn to a foodless region of the plate. The highest values of search scale are observed during “ranging,” when food is exhausted, starvation sets in, and the need to find a new food patch becomes urgent (<xref ref-type="bibr" rid="bib101">Wakabayashi et al., 2004</xref>; <xref ref-type="bibr" rid="bib35">Gray et al., 2005</xref>). Worms sometimes spontaneously leave a food patch well before it is exhausted, with leaving rate inversely related to food quality and food density (<xref ref-type="bibr" rid="bib84">Shtonda and Avery, 2006</xref>; <xref ref-type="bibr" rid="bib37">Harvey, 2009</xref>), which may reflect a trade-off between exploitation and exploration (<xref ref-type="bibr" rid="bib4">Bendesky et al., 2011</xref>).</p><p>At the heart of the <italic>C. elegans</italic> locomotion circuit are five pairs of premotor 'command' interneurons organized into two functional groups that promote forward and reverse locomotion, respectively (<xref ref-type="bibr" rid="bib17">Chalfie et al., 1985</xref>; <xref ref-type="bibr" rid="bib108">Zheng et al., 1999</xref>; <xref ref-type="bibr" rid="bib91">Stirman et al., 2010</xref>; <xref ref-type="bibr" rid="bib81">Schmitt et al., 2012</xref>). The two groups are reciprocally connected, and make output synapses onto distinct, non-overlapping sets of motor neurons that control body-wall muscle. The locomotory state (forward or reverse) is believed to be determined mainly by whichever set of motor neurons is more highly activated by input from the command neurons (<xref ref-type="bibr" rid="bib47">Kawano et al., 2011</xref>; <xref ref-type="bibr" rid="bib106">Xie et al., 2013</xref>; <xref ref-type="bibr" rid="bib29">Gao et al., 2015</xref>; <xref ref-type="bibr" rid="bib54">Liu et al., 2014</xref>). Command neuron activation depends upon influences that are both external and intrinsic to the command neuron network, and appears to have a strong stochastic component that underlies switching between forward and reverse locomotion. Some command neurons are tightly linked both functionally and synaptically to upstream interneurons that also switch state stochastically in concert and counterpoint to them (<xref ref-type="bibr" rid="bib31">Gordus et al., 2015</xref>), providing a potential additional source of the stochasticity on which random search depends. At least nine classes of chemosensory neurons and twelve classes of upstream interneurons are required for normal regulation of the duration of forward locomotion (<xref ref-type="bibr" rid="bib101">Wakabayashi et al., 2004</xref>; <xref ref-type="bibr" rid="bib35">Gray et al., 2005</xref>; <xref ref-type="bibr" rid="bib96">Tsalik and Hobert, 2003</xref>; <xref ref-type="bibr" rid="bib22">Fang-Yen et al., 2015</xref>). Input from these neurons onto the command neuron network modulates the mean run length and, thereby, the spatial scale of random search. Search scale also appears to be modulated by neurons that release biogenic amines (serotonin, dopamine, and tyramine) (<xref ref-type="bibr" rid="bib25">Flavell et al., 2013</xref>; <xref ref-type="bibr" rid="bib39">Hills et al., 2004</xref>; <xref ref-type="bibr" rid="bib4">Bendesky et al., 2011</xref>) or peptides (<xref ref-type="bibr" rid="bib3">Ben Arous et al., 2009</xref>; <xref ref-type="bibr" rid="bib25">Flavell et al., 2013</xref>; <xref ref-type="bibr" rid="bib30">Gloria-Soria and Azevedo, 2008</xref>; <xref ref-type="bibr" rid="bib92">Styer et al., 2008</xref>; <xref ref-type="bibr" rid="bib76">Reddy et al., 2009</xref>; <xref ref-type="bibr" rid="bib7">Bhattacharya et al., 2014</xref>). These diverse signaling pathways may provide the means by which the worm optimizes its search strategy in response to feeding history (<xref ref-type="bibr" rid="bib35">Gray et al., 2005</xref>), the quality, density and spatial distribution of food (<xref ref-type="bibr" rid="bib84">Shtonda and Avery, 2006</xref>; <xref ref-type="bibr" rid="bib15">Calhoun et al., 2015</xref>), and other factors that constrain survival and reproduction (<xref ref-type="bibr" rid="bib30">Gloria-Soria and Azevedo, 2008</xref>; <xref ref-type="bibr" rid="bib70">Pujol et al., 2001</xref>; <xref ref-type="bibr" rid="bib68">Pradel et al., 2007</xref>; <xref ref-type="bibr" rid="bib52">Lipton et al., 2004</xref>).</p><p>Although the neural circuitry for local search has been described in considerable detail, our understanding of the system remains limited, partly for lack of key physiological data, but also for lack of a model in which to interpret the data. Common sense suggests that the forward and reverse command neurons should inhibit each other to minimize simultaneous occurrences of neuronal states for incompatible behaviors (<xref ref-type="bibr" rid="bib108">Zheng et al., 1999</xref>). A plausible anatomical substrate for such reciprocal inhibitory connections between command neurons exists in the <italic>C. elegans</italic> connectome (<xref ref-type="bibr" rid="bib103">White et al., 1986</xref>), but anatomical data do not specify the signs or strengths of synaptic connections. A quantitative model that incorporates physiological properties of the command neurons and their synaptic connections is needed to interpret experimental results, such as the unexpected observation that silencing some of the reverse command neurons causes a reduction in forward dwell time, and conversely for forward command neurons (<xref ref-type="bibr" rid="bib75">Rakowski et al., 2013</xref>; <xref ref-type="bibr" rid="bib108">Zheng et al., 1999</xref>). It is also needed to explain complex patterns of changes in dwell times observed across the three locomotory states caused by introducing or eliminating tonic membrane conductances in the command neurons, and to answer basic mechanistic questions about the control of <italic>C. elegans</italic> locomotion.</p><p>At present, the experimental data are insufficient for creating a neuron-by-neuron model of the command network that incorporates biophysical details such as synaptic and membrane conductances without introducing a heavy load of unconstrained parameters (<xref ref-type="bibr" rid="bib75">Rakowski et al., 2013</xref>). Nor would such a mechanistically detailed model necessarily provide the appropriate level of abstraction in which to intuitively understand <italic>C. elegans</italic> search behaviors, including their strong stochastic component. Instead, we have kept the level of biological detail to the minimum needed to predict the statistical distributions of dwell times in forward, reverse and pause states, and other fundamental aspects of the behavior. Each of the model's three main assumptions remains within the bounds of widely accepted experimental results; our mathematical analysis simply shows what follows necessarily from these assumptions.</p><p>To provide an empirical basis for the model we quantified <italic>C. elegans</italic> search behavior in terms of tangential velocity, defined as the speed and direction of worm's movement along its sinuous trajectory, which we recorded at higher resolution than previously possible. Behavioral data were then fit to a four-state hidden Markov model in which each state corresponds to a unique pattern of activation across the command neurons. Importantly, rate constants governing probabilistic transitions between states in the Markov model are expressed in terms of synaptic weights in an analytically tractable version of the model. We were therefore able to validate the model by showing that it correctly predicts phenomena on which it was not fit, such as reciprocal inhibition between forward and reverse command neurons in the biological network and the behavioral effects of perturbations introduced by laser ablations and genetic mutations. Although the model is inherently probabilistic, we found that it also makes accurate predictions concerning deterministic behaviors in <italic>C. elegans</italic>, indicating a potentially high level of generality. The present findings thus establish a simple theory of <italic>C. elegans</italic> locomotory control and provide a testable model of random search that can be applied to other organisms.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>A neuronal model of random search in <italic>C. elegans</italic> is a theory of the relationship between activation states of the command neurons and foraging behavior. Methods presently available for observing neuronal activity in freely behaving <italic>C. elegans</italic> utilize calcium-sensitive probes that have insufficient temporal resolution to observe the changes in neuronal activity associated with the rapidly changing behavioral states, especially the frequent brief pauses that are an integral part of the behavior. Therefore, as a proxy for command neuron state, we used the worm's tangential velocity, defined as the speed and direction of worm's movement along its sinuous trajectory. We focused on tangential velocity because in sinusoidal locomotion the net reactive forces produced by body-wall muscle contractions acting against the substrate are tangential to the body surface (<xref ref-type="bibr" rid="bib35">Gray et al., 2005</xref>). Tangential velocity therefore provides the most direct readout of which group of motor neurons and command neurons (forward or reverse) is more active (<xref ref-type="bibr" rid="bib72">Qi et al., 2013</xref>). Alternative measures of the rate of translation such as centroid velocity (<xref ref-type="bibr" rid="bib65">Pierce-Shimomura et al., 1999</xref>) or postural phase velocity (<xref ref-type="bibr" rid="bib89">Stephens et al., 2011</xref>) have a less direct relationship to command neuron state because these measures either depend in complex ways on the shape of the worm, or rely on a representation of posture that ignores some of the thrust-generating components of the worm’s shape that come into play unless the worm is moving along a fairly linear trajectory. To monitor tangential velocity as directly as possible, we painted a microscopic black spot on the worm and used a motorized stage controlled by a computer to keep the spot in the field of view (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). The most common alternative method for measuring tangential velocity, tracking virtual points obtained by segmenting the worm’s centerline, is subject to segmentation errors introduced by low contrast images of the worm's head and tail (see <xref ref-type="bibr" rid="bib20">Cronin et al., 2005</xref> ) which changes the distance between virtual points. This method can also be compromised by dropped frames when the worm's centerline crosses itself during tight turns.<fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.12572.003</object-id><label>Figure 1.</label><caption><title>Descriptive statistics of wild type worm tracks.</title><p>(<bold><bold>A</bold></bold>) <inline-formula><mml:math id="inf1"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>-coordinates of a worm during 10 min of foraging. <italic>Inset</italic>: Image of a worm showing the black spot (arrow) used for optical tracking (scale bar = 200 µm). (<bold>B</bold>) The speed distribution computed from the distance moved between successive video frames had a peak at 180 µm/s, which includes both forward and reverse locomotion. A second peak at 14 µm/s corresponds to pauses. The decreased probability of observing speeds &lt;14 µm/s (&lt;0.47 μm/frame) is due to noise in the position measurement. (<bold>C</bold>) At least three time constants were required to fit (red) the speed autocovariance function (black; grey shading shows ± 1 sem). (<bold>D</bold>) The worm’s heading remained nearly constant for ~10 s except for a transient peak at 1.4 s (▼), which corresponds to the period of one half cycle of undulation during sinusoidal locomotion. The dashed line shows random reorientation; shading shows ± 1 sem. (<bold>E</bold>) Example of <inline-formula><mml:math id="inf2"><mml:mrow><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> showing periods of forward locomotion, reverse locomotion and pauses of various durations. Upward triangles (▲) mark forward-pause-forward (FPF) events; the downward triangle (▼) marks a reverse-pause-reverse (RPR) event. (<bold>F</bold>) Velocity distributions for the 5 wild type cohorts (5 colors) analyzed in this study. (<bold>G</bold>) Ensemble-averaged velocity during FPR transitions. All FPR transitions in all wild type cohorts were aligned at the end of forward movement, grouped according to the duration of the pause (2–9 frames), and averaged. Such transitions were defined using a threshold criterion of <inline-formula><mml:math id="inf3"><mml:mfenced close="|" open="|"><mml:mi>v</mml:mi></mml:mfenced></mml:math></inline-formula> &lt; 50 μm/s to identify state P (<xref ref-type="bibr" rid="bib75">Rakowski et al., 2013</xref>). Pauses lasting ≤ 1 frame are not shown because of ambiguity in state identification; pauses lasting ≥ 10 frames are omitted for clarity. (<bold>H</bold>) Identical to G except RPF transitions are shown. (<bold>I</bold>) Cumulative probability distributions for dwell time in the pause state defined as in G and H for all FPR and RPF transitions of duration &gt;1 frame in wild type worms.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.003">http://dx.doi.org/10.7554/eLife.12572.003</ext-link></p></caption><graphic xlink:href="elife-12572-fig1-v2"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.12572.004</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Optical tracking error.</title><p>Position data recorded for 1 min each from 4 dead worms spotted by the usual procedure. Under these conditions the stage is stationary. Data from each worm are shown in a different color. The circle encloses 1 standard deviation of the combined 2-D distribution. Optical tracking is more precise than the resolution of the stage position encoder, and thus does not limit the overall resolution of the position measurement.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.004">http://dx.doi.org/10.7554/eLife.12572.004</ext-link></p></caption><graphic xlink:href="elife-12572-fig1-figsupp1-v2"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.12572.005</object-id><label>Figure 1—figure supplement 2.</label><caption><title>The worm’s search behavior closely resembles a Brownian random walk on time scales longer than 10 s, but not on shorter time scales.</title><p>(<bold>A</bold>) the velocity autocorrelation function (<inline-formula><mml:math id="inf4"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) averaged across the 5 wild-type cohorts shows that movements become uncorrelated after ~10 s, primarily as a result of random reorientation during transitions from reverse to forward motion. The period of the damped oscillations in <inline-formula><mml:math id="inf5"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> corresponds to the period of sinusoidal undulations during locomotion. (<bold><bold>B</bold></bold>) The observed linear increase in mean-squared distance travelled with time (black; mean ± sem, averaged data from all wild-type worms) shows that on this time scale search behavior approximates a Brownian random walk. (<bold>C</bold>) At shorter times the observed (black) relation curves upward because worms travel in relatively straight lines during runs. Assuming that the behavior is stationary over the 10 min observation period, the dependence of <inline-formula><mml:math id="inf6"><mml:mover accent="true"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> on <inline-formula><mml:math id="inf7"><mml:mi>t</mml:mi></mml:math></inline-formula> can be calculated from the velocity autocorrelation function (red curves in B and C):</p><p><disp-formula id="equ1"><mml:math id="m1"><mml:mover accent="true"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>¯</mml:mo></mml:mover><mml:mfenced><mml:mi>t</mml:mi></mml:mfenced><mml:mo>≅</mml:mo><mml:mfenced close="&gt;" open="&lt;"><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mfenced><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>τ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>τ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>τ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>V</mml:mi><mml:mfenced><mml:mi>τ</mml:mi></mml:mfenced><mml:mo>·</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mfenced><mml:mn>0</mml:mn></mml:mfenced><mml:mi>d</mml:mi><mml:mi>τ</mml:mi></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf8"><mml:mfenced close="&gt;" open="&lt;"><mml:mo>·</mml:mo></mml:mfenced></mml:math></inline-formula> denotes statistical expectation (eq. 2.5.12 of <xref ref-type="bibr" rid="bib9">Boon and Yip, 1980</xref>). Thus, the worm’s movements approximate Brownian motion on a time scale that is longer than the persistence of the velocity autocorrelation, but not at shorter times.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.005">http://dx.doi.org/10.7554/eLife.12572.005</ext-link></p></caption><graphic xlink:href="elife-12572-fig1-figsupp2-v2"/></fig></fig-group></p><p>At the start of a 10 min observation period an individual worm was transferred from a food-laden culture plate to a bare agar surface devoid of overt sensory cues, thereby inducing a period of intensive local search behavior (<xref ref-type="bibr" rid="bib45">Jander, 1975</xref>; <xref ref-type="bibr" rid="bib39">Hills et al., 2004</xref>). The (<italic>x, y</italic>)-coordinates of the centroid of the spot were recorded with a temporal resolution of 33 ms (i.e., frame rate = 30 Hz) and a spatial resolution of 0.5 μm that was limited mainly by the precision of the stage position encoder; the optical tracking error was much smaller (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). A spatial resolution of approximately 0.5 μm amounts to an approximately 10-fold improvement over previously published tracking systems (<xref ref-type="bibr" rid="bib48">Kocabas et al., 2012</xref>); thus worm speed (<xref ref-type="fig" rid="fig1">Figure 1B</xref>) could be extracted with unprecedented accuracy. For statistical analysis, worms were grouped into cohorts having the same genotype or neurons ablated (17–31 worms per cohort), which had been reared together and tested in parallel as young adults within the same 2–3 day period. This approach yielded a comprehensive data set containing a total of 8.3 million position measurements from 501 individuals in 20 cohorts.</p><sec id="s2-1"><title>Model-independent identification of locomotory states</title><p><xref ref-type="fig" rid="fig1">Figure 1A– D</xref> describes important features of search behavior obtained by regarding the worm as a point moving in an external reference frame (allocentric coordinates) without regard to the orientation of the body axis. The speed distribution was bimodal (<xref ref-type="fig" rid="fig1">Figure 1B</xref>) with a broad peak around 180 µm/s that includes both forward and reverse motion, and a narrower peak near zero that corresponds to pauses. The speed autocovariance function had multiple exponential components (<xref ref-type="fig" rid="fig1">Figure 1C</xref>), suggesting at least three locomotory states. The average change in heading angle (<inline-formula><mml:math id="inf9"><mml:mover accent="true"><mml:mrow><mml:mo>|</mml:mo><mml:mo>∆</mml:mo><mml:mi>φ</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>), plotted as a function of the intervening time interval (<xref ref-type="fig" rid="fig1">Figure 1D</xref>), showed that worms maintained a nearly constant heading for up to 10 s (<xref ref-type="bibr" rid="bib88">Stephens et al., 2010</xref>; <xref ref-type="bibr" rid="bib64">Peliti et al., 2013</xref>), but reoriented randomly within ~30 s, establishing the shortest time scale over which the behavior can be considered a Brownian random walk (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>), the simplest form of random search. On shorter time scales the path takes on the character of a truncated Lévy flight (<xref ref-type="bibr" rid="bib59">Mantegna and Stanley, 1994</xref>).</p><p>For more detailed analysis we distinguished forward from reverse movement by visual inspection of the recorded videos, and defined velocity, <inline-formula><mml:math id="inf10"><mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, to be a signed scalar value that denotes the speed of movement along the worm’s track in the direction of the head (+) or tail (-) (<xref ref-type="fig" rid="fig1">Figure 1E</xref>; see Materials and methods). The probability distribution of <inline-formula><mml:math id="inf11"><mml:mrow><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1">Figure 1F</xref>) showed two broad peaks that correspond to forward and reverse movement, and a narrow third peak centered at zero that corresponds to pauses. For the initial analysis we defined pauses using a fixed speed threshold of 0.05 mm/sec (<xref ref-type="bibr" rid="bib75">Rakowski et al., 2013</xref>). Pauses occurred most frequently as transient interruptions of forward locomotion, causing the worm to stutter as it moves (<xref ref-type="fig" rid="fig1">Figure 1E</xref>; <xref ref-type="other" rid="media1">Video 1</xref>); stuttering also occurred, albeit less frequently, during reverse locomotion (<xref ref-type="fig" rid="fig1">Figure 1E</xref>; <xref ref-type="other" rid="media2">Video 2</xref>). Distinct pauses were also observed during transitions from forward to reverse (<xref ref-type="fig" rid="fig1">Figure 1G</xref>; <xref ref-type="other" rid="media3">Video 3</xref>) and from reverse to forward (<xref ref-type="fig" rid="fig1">Figure 1H</xref>; <xref ref-type="other" rid="media4">Video 4</xref>). Most pauses lasted longer than one video frame, indicating the presence of a locomotory state having a detectable dwell time; thus pauses were not merely zero crossings in plots of velocity versus time. We found that pauses during forward to reverse transitions were on average longer in duration than pauses during reverse to forward transitions (<xref ref-type="fig" rid="fig1">Figure 1I</xref>; <italic>p</italic>&lt;10<sup>–5</sup> ; Mann-Whitney U-test). These findings are consistent with the predictions of the model presented below, which uses a probabilistic criterion rather than a fixed velocity threshold to identify pauses.<media content-type="glencoe play-in-place height-250 width-310" id="media1" mime-subtype="mp4" mimetype="video" xlink:href="elife-12572-media1.mp4"><object-id pub-id-type="doi">10.7554/eLife.12572.006</object-id><label>Video 1.</label><caption><title>Forward-Pause-Forward transition.</title><p>The worm is crawling on a foodless agar plate. The microscope stage moves continuously to keep the tracking spot near the center of the frame. Stage movement can be assessed by monitoring the white streaks in the background, which are segments of the worm's track at earlier times. Behavioral state is indicated in the upper left corner of the frame. The indicated behavioral transition is shown at normal speed, and slowed down by a factor of 5. The worm is paused when the tracking spot is stationary relative to the streaks.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.006">http://dx.doi.org/10.7554/eLife.12572.006</ext-link></p></caption></media><media content-type="glencoe play-in-place height-250 width-310" id="media2" mime-subtype="mp4" mimetype="video" xlink:href="elife-12572-media2.mp4"><object-id pub-id-type="doi">10.7554/eLife.12572.007</object-id><label>Video 2.</label><caption><title>Reverse-Pause-Reverse transition.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.007">http://dx.doi.org/10.7554/eLife.12572.007</ext-link></p></caption></media><media content-type="glencoe play-in-place height-250 width-310" id="media3" mime-subtype="mp4" mimetype="video" xlink:href="elife-12572-media3.mp4"><object-id pub-id-type="doi">10.7554/eLife.12572.008</object-id><label>Video 3.</label><caption><title>Forward-Pause-Reverse transition.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.008">http://dx.doi.org/10.7554/eLife.12572.008</ext-link></p></caption></media><media content-type="glencoe play-in-place height-250 width-310" id="media4" mime-subtype="mp4" mimetype="video" xlink:href="elife-12572-media4.mp4"><object-id pub-id-type="doi">10.7554/eLife.12572.009</object-id><label>Video 4.</label><caption><title>Reverse-Pause-Forward transition.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.009">http://dx.doi.org/10.7554/eLife.12572.009</ext-link></p></caption></media></p></sec><sec id="s2-2"><title>The stochastic switch model</title><p>Based on the results presented in <xref ref-type="fig" rid="fig1">Figure 1</xref> and previous studies noted below, we propose a minimal model for the control of random search behavior that involves two opposing neuron-like “units” that can exist in four distinct states corresponding to forward locomotion, reverse locomotion, and two pause states. This model differs from a previous model that represents the worm as a point in “shape space” (<xref ref-type="bibr" rid="bib87">Stephens et al., 2008</xref>) in that here velocity is measured directly by observing the motion of a point on the body surface relative to the substrate, rather than indirectly by the temporal progression of shape changes. It also differs from previous models (<xref ref-type="bibr" rid="bib75">Rakowski et al., 2013</xref>; <xref ref-type="bibr" rid="bib108">Zheng et al., 1999</xref>; <xref ref-type="bibr" rid="bib104">Wicks et al., 1996</xref>; <xref ref-type="bibr" rid="bib49">Kunert et al., 2014</xref>) by representing changes in locomotory state as probabilistic transitions in a Markov process.</p><p>Ablation of individual premotor interneurons (<xref ref-type="bibr" rid="bib17">Chalfie et al., 1985</xref>) has led to the hypothesis that the direction of locomotion is controlled by a network comprising five pairs of premotor command interneurons organized into two functional groups that promote forward and reverse locomotion, respectively. Although the anatomical pattern of synaptic connectivity among these interneurons has been established (<xref ref-type="bibr" rid="bib103">White et al., 1986</xref>) (<xref ref-type="fig" rid="fig2">Figure 2A</xref>), this information does not yield an intuitive explanation of how the direction of locomotion is regulated. Nor, in our view, does the present state of the anatomical connectivity provide the basis for a neuron-by-neuron simulation of the network (but see <xref ref-type="bibr" rid="bib75">Rakowski et al., 2013</xref>), as neither signs nor physiological strengths (weights) of synapses in <italic>C. elegans</italic> can be inferred reliably from anatomical structure or neurotransmitter type, and almost nothing is known about the intrinsic membrane currents of these neurons or how they shape the input-output function of individual command neurons.<fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.12572.010</object-id><label>Figure 2.</label><caption><title>Assumptions with supporting data for the Stochastic Switch Model.</title><p>(<bold><bold>A</bold></bold>) Connectivity of forward and reverse command neurons. Arrows with single heads are monosynaptic connections inferred from the <italic>C. elegans</italic> connectome (<xref ref-type="bibr" rid="bib103">White et al., 1986</xref>; <xref ref-type="bibr" rid="bib97">Varshney et al., 2011</xref>) line thickness is proportional to the number of presynaptic specializations seen in the reconstruction of each pairwise connection. Open, double-headed arrows indicate synaptic pathways from or to the indicated pool of neurons outside the network. (<bold><bold>B</bold></bold>) Voltage recording from the command neuron AVA in the absence of injected current. In this neuron, quasi-stable membrane potentials are seen at -17 and -32 mV. These results differ from previously published AVA recordings, which were made in the presence of hyperpolarizing current (5–10 pA) that kept the membrane potential near -55 mV (<xref ref-type="bibr" rid="bib51">Lindsay et al., 2011</xref>). (<bold>C</bold>) Neuronal representation of the Stochastic Switch Model. Forward and reverse command neurons are represented as single binary neuron-like units <inline-formula><mml:math id="inf12"><mml:mi>ℱ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf13"><mml:mi>ℛ</mml:mi></mml:math></inline-formula>, respectively. Arrows depicting cross connections (<inline-formula><mml:math id="inf14"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf15"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) represent functional (net mono- and polysynaptic) connections between forward and reverse units. Self-connections (<inline-formula><mml:math id="inf16"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf17"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) represent synaptic connections between neurons comprising a given unit, voltage dependent currents in these neurons, and polysynaptic recurrent pathways involving non-command neurons. Downward arrows (<inline-formula><mml:math id="inf18"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf19"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) represent the combined effects of input from presynaptic neurons, including sensory neurons, and neuromodulation. (<bold><bold>D</bold></bold>) Markov model representation of the command neuron network. The color of a unit indicates its state of activation (red on, white off). In addition to the forward state F and the reverse state R, there are two pause states, X and Y. Arrows, with their associated rate constants, indicate transitions in which a single unit changes state. Transitions in which two units change state simultaneously have probability zero because single-unit transitions are assumed to be statistically independent. (<bold><bold>E</bold></bold>) The most likely sequence of states in the hidden Markov model (computed using the Viterbi algorithm) for a representative data segment.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.010">http://dx.doi.org/10.7554/eLife.12572.010</ext-link></p></caption><graphic xlink:href="elife-12572-fig2-v2"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.12572.011</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Effects of synaptic input on transition rates in stochastic units <inline-formula><mml:math id="inf20"><mml:mi>ℱ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf21"><mml:mi>ℛ</mml:mi></mml:math></inline-formula>.</title><p>Rate constants are exponential functions of the unit’s net synaptic input <italic>S</italic>. Excitatory input increases the on rate and decreases the off rate, whereas inhibitory input has the opposite effect. When synaptic input equals zero, the unit switches stochastically between on and off states with rate constant <italic>A</italic>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.011">http://dx.doi.org/10.7554/eLife.12572.011</ext-link></p></caption><graphic xlink:href="elife-12572-fig2-figsupp1-v2"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.12572.012</object-id><label>Figure 2—figure supplement 2.</label><caption><title>Velocity distributions in forward, reverse and pause states.</title><p>For each cohort, the velocity distribution <inline-formula><mml:math id="inf22"><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (black; binwidth 2 µm/s) was smoothed by 10 passes of a 1-2-1 binomial smoothing algorithm, then separated into three overlapping velocity distributions: <inline-formula><mml:math id="inf23"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>F</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (dashed green), <inline-formula><mml:math id="inf24"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>R</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (dashed blue), <inline-formula><mml:math id="inf25"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>P</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (dashed red).</p><p>For <inline-formula><mml:math id="inf26"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>P</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> we used a Cauchy distribution (half width 18 µm/s) scaled to fit <inline-formula><mml:math id="inf27"><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We estimated <inline-formula><mml:math id="inf28"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>F</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf29"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>R</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> by subtracting <inline-formula><mml:math id="inf30"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>P</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> from <inline-formula><mml:math id="inf31"><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and restricting the F and R distributions to positive and negative velocities, respectively. The sum <inline-formula><mml:math id="inf32"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>F</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>R</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>P</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is shown in solid orange.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.012">http://dx.doi.org/10.7554/eLife.12572.012</ext-link></p></caption><graphic xlink:href="elife-12572-fig2-figsupp2-v2"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.12572.013</object-id><label>Figure 2—figure supplement 3.</label><caption><title>Cumulative dwell time distributions in states F, R, X and Y.</title><p>Comparisons between cumulative dwell time distributions (solid lines) and the exponential distributions predicted by the hidden Markov model (<inline-formula><mml:math id="inf33"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf34"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the mean dwell time in state <inline-formula><mml:math id="inf35"><mml:mi>S</mml:mi></mml:math></inline-formula>; <xref ref-type="table" rid="tbl1">Table 1</xref>). The observed dwell times were tabulated from the most likely sequence of states obtained using the Viterbi algorithm. The origin on the time axis corresponds to one frame.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.013">http://dx.doi.org/10.7554/eLife.12572.013</ext-link></p></caption><graphic xlink:href="elife-12572-fig2-figsupp3-v2"/></fig></fig-group></p><p>To establish a mathematically tractable framework for understanding how the command network functions during search behavior, we created a minimal model based on three simplifying assumptions, each of which was biologically motivated. (i) Command neurons act like binary units (<xref ref-type="bibr" rid="bib40">Hopfield, 1982</xref>). This assumption was based on voltage recordings from command neurons in which we regularly observed two stable membrane potentials with rapid transitions between them (<xref ref-type="fig" rid="fig2">Figure 2B</xref>; also see <xref ref-type="bibr" rid="bib46">Kato et al., 2015</xref>). It is also supported by the observation of a bimodal distribution of calcium activity in AVA neurons and their upstream partners AIB and RIM (<xref ref-type="bibr" rid="bib31">Gordus et al., 2015</xref>), and the report of distinct up and down states in voltage recordings from motor neruons (<xref ref-type="bibr" rid="bib54">Liu et al., 2014</xref>). (ii) Command neurons switch state stochastically. This assumption was based on the observation that <italic>C. elegans</italic> locomotory behavior has a strong stochastic component, with exponentially distributed dwell times in forward and reverse states (<xref ref-type="bibr" rid="bib65">Pierce-Shimomura et al., 1999</xref>; <xref ref-type="bibr" rid="bib107">Zhao et al., 2003</xref>; <xref ref-type="bibr" rid="bib25">Flavell et al., 2013</xref>; <xref ref-type="bibr" rid="bib31">Gordus et al., 2015</xref>; <xref ref-type="bibr" rid="bib89">Stephens et al., 2011</xref>). (iii) Command neurons within the forward pool are co-active, as are command neurons in the reverse pool. This assumption is based on simultaneous calcium imaging data from multiple command neurons in freely moving animals which suggest that the activity of neurons within the reversal pool is tightly correlated (<xref ref-type="bibr" rid="bib82">Schrödel et al., 2013</xref>; <xref ref-type="bibr" rid="bib69">Prevedel et al., 2014</xref>). Additionally, neurons in opposing groups are likely to be reciprocally active, as indicated by simultaneous calcium imaging from AVA and AVB (<xref ref-type="bibr" rid="bib69">Prevedel et al., 2014</xref>; <xref ref-type="bibr" rid="bib23">Faumont et al., 2011</xref>), as well as AVE and AVB (<xref ref-type="bibr" rid="bib47">Kawano et al., 2011</xref>). A fourth assumption, concerning the relationship between neuronal states and behavioral states, is introduced below.</p><p>The three simplifying assumptions, together with the anatomical data (<xref ref-type="bibr" rid="bib103">White et al., 1986</xref>), lead to a model that has two binary stochastic elements, <inline-formula><mml:math id="inf36"><mml:mi>ℱ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf37"><mml:mi>ℛ</mml:mi></mml:math></inline-formula>, and six synaptic weights (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). Each type of weight has a specific interpretation. The cross-connections (<inline-formula><mml:math id="inf38"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf39"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) represent mono- and polysynaptic connections between command neurons in different groups. The self-connections (<inline-formula><mml:math id="inf40"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf41"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) represent connections between command neurons in the same group, including recurrent polysynaptic pathways involving neurons outside the command network. Self-connections also represent possible intrinsic voltage dependent currents within the command neurons, such as <italic>C. elegans</italic> plateau currents (<xref ref-type="bibr" rid="bib60">Mellem et al., 2008</xref>). The pair of connections originating from an <inline-formula><mml:math id="inf42"><mml:mi>ℱ</mml:mi></mml:math></inline-formula>or <inline-formula><mml:math id="inf43"><mml:mrow><mml:mi>ℛ</mml:mi><mml:mo/></mml:mrow></mml:math></inline-formula> unit can have either the same sign or different signs. Allowing a single unit to have opposing effects on different postsynaptic targets is justified by the fact that synaptic weights in the model represent polysynaptic pathways, the effects of which can be excitatory or inhibitory, and by the observation that some <italic>C. elegans</italic> neurons can monosynpatically excite some postsynaptic neurons while inhibiting others (<xref ref-type="bibr" rid="bib16">Chalasani et al., 2007</xref>). Two additional weights, <inline-formula><mml:math id="inf44"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf45"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, represent inputs from sensory neurons, interneurons, neural modulators, and any other sources outside the network (<xref ref-type="bibr" rid="bib35">Gray et al., 2005</xref>; <xref ref-type="bibr" rid="bib26">Fry et al., 2014</xref>), plus intrinsic membrane conductances that produce sustained effects on membrane potential (<xref ref-type="bibr" rid="bib108">Zheng et al., 1999</xref>; <xref ref-type="bibr" rid="bib29">Gao et al., 2015</xref>). The summed synaptic inputs onto <inline-formula><mml:math id="inf46"><mml:mi>ℱ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf47"><mml:mi>ℛ</mml:mi></mml:math></inline-formula> are, respectively, <inline-formula><mml:math id="inf48"><mml:msub><mml:mi>S</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mfenced><mml:mi>t</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>b</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mfenced><mml:mi>t</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>b</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf49"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>b</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>b</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf50"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf51"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> are the states of <inline-formula><mml:math id="inf52"><mml:mi>ℱ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf53"><mml:mi>ℛ</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf54"><mml:mi>t</mml:mi></mml:math></inline-formula> (1 = ON, 0 = OFF). The quantities <inline-formula><mml:math id="inf55"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf56"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> were assumed to be constant during the 10 min observation period of local search behavior on a bare agar surface.</p><p>State transitions of <inline-formula><mml:math id="inf57"><mml:mi>ℱ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf58"><mml:mi>ℛ</mml:mi></mml:math></inline-formula> were modeled as independent non-homogeneous Poisson processes in which the transition rates are exponential functions of the summed synaptic input to the units, as shown in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>. Changes of the state of <inline-formula><mml:math id="inf59"><mml:mi>ℱ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf60"><mml:mi>ℛ</mml:mi></mml:math></inline-formula> can be regarded as thermally-driven transitions across energy barriers of height proportional to <inline-formula><mml:math id="inf61"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf62"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>, respectively. Inhibitory synaptic input increased the height of the barrier for OFF→ON transitions while decreasing the height of the barrier for ON→OFF transitions by the same amount; excitatory synaptic inputs had the opposite effect. The variable <inline-formula><mml:math id="inf63"><mml:mi>A</mml:mi></mml:math></inline-formula> (Materials and methods, <xref ref-type="disp-formula" rid="equ27 equ28">Equations 26, 27</xref>) represents the fundamental timescale of the system, defined as the rate at which units <inline-formula><mml:math id="inf64"><mml:mi>ℱ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf65"><mml:mi>ℛ</mml:mi></mml:math></inline-formula> change state when the summed synaptic input is zero. The present model is distinct from deterministic models of the command neuron network (<xref ref-type="bibr" rid="bib75">Rakowski et al., 2013</xref>; <xref ref-type="bibr" rid="bib108">Zheng et al., 1999</xref>; <xref ref-type="bibr" rid="bib104">Wicks et al., 1996</xref>; <xref ref-type="bibr" rid="bib49">Kunert et al., 2014</xref>) in that it is inherently stochastic, like the behavior it is meant to predict. In particular, the synaptic input to a unit does not immediately determine its state, but instead modifies the transition rates between ON and OFF states.</p><p>The two binary units of the model can exist in four states (F, R, X, Y; <xref ref-type="fig" rid="fig2">Figure 2D</xref>), and provide the basis for a hidden Markov model having eight transitions in which a single unit changes state. The model was further constrained by the synaptic model, which allows the eight transition rate constants to be specified by only six synaptic weights as shown in <xref ref-type="disp-formula" rid="equ32 equ33 equ34 equ35 equ36">Equations 31–35</xref> (Materials and methods). A Markov model was adopted to represent the biological system because dwell times in Markov states, like the observed dwell times in forward and reverse states (<xref ref-type="bibr" rid="bib107">Zhao et al., 2003</xref>; <xref ref-type="bibr" rid="bib101">Wakabayashi et al., 2004</xref>), are exponentially distributed. A hidden Markov model was required because, as noted above, states of command neurons cannot be observed directly in freely moving animals, even using optical recording methods.</p><p>The fourth assumption is a particular mapping between the states of the two command units and behavioral states of the worm. The command units, <inline-formula><mml:math id="inf66"><mml:mi>ℱ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf67"><mml:mi>ℛ</mml:mi></mml:math></inline-formula>, are intended to represent the two pools of forward and reverse command neurons, respectively, such that the worm moves forward when <inline-formula><mml:math id="inf68"><mml:mi>ℱ</mml:mi></mml:math></inline-formula> is ON and <inline-formula><mml:math id="inf69"><mml:mi>ℛ</mml:mi></mml:math></inline-formula> is OFF (state F), backwards when <inline-formula><mml:math id="inf70"><mml:mi>ℛ</mml:mi></mml:math></inline-formula> is ON and <inline-formula><mml:math id="inf71"><mml:mi>ℱ</mml:mi></mml:math></inline-formula> is OFF (state R), and pauses when both <inline-formula><mml:math id="inf72"><mml:mi>ℱ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf73"><mml:mi>ℛ</mml:mi></mml:math></inline-formula> are OFF (state X). These associations between states of the model and activation states of the command neurons are well supported by previous experimental evidence, including studies showing that genetic ablation or silencing of all command interneurons induces prolonged pauses (<xref ref-type="bibr" rid="bib108">Zheng et al., 1999</xref>; <xref ref-type="bibr" rid="bib47">Kawano et al., 2011</xref>), but they also assume the major simplification that all command neurons in a given pool act together as a unit.</p><p>The model also permits a fourth state, in which <inline-formula><mml:math id="inf74"><mml:mi>ℱ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf75"><mml:mi>ℛ</mml:mi></mml:math></inline-formula> are simultaneously ON (state Y). Whether the corresponding co-activation state of forward and reverse command neurons normally exists with any significant probability remains to be shown, but it has been observed that their downstream targets, the forward and reverse motor neurons, can be active simultaneously, causing the worm to pause (<xref ref-type="bibr" rid="bib47">Kawano et al., 2011</xref>). Given the existence of gap junction synapses between the main forward and reverse command neurons and their respective sets of forward and reverse motor neurons, it is reasonable to suppose that forward and reverse command neurons are co-active when their motor neurons are co-active. Thus, there is some evidence to designate state Y as a second pause state, which we consider to be a working hypothesis. Together, states X and Y comprise the phenomenological pause state denoted P. In what follows, we explore the logical consequences of the model’s four assumptions; it remains to be shown experimentally how closely the states of the model correspond to activity states of the command neurons.</p><p>We used a maximum likelihood method (<xref ref-type="bibr" rid="bib18">Colquhoun and Hawkes, 1995</xref>) (Materials and methods) to estimate the set of transition rate constants that had the highest probability of generating the observed time series <inline-formula><mml:math id="inf76"><mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Direct transitions between F and R, and between X and Y, were disallowed because the assumed statistical independence of the two command units implies that the probability of simultaneous transitions in <inline-formula><mml:math id="inf77"><mml:mi>ℱ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf78"><mml:mi>ℛ</mml:mi></mml:math></inline-formula> is vanishingly small. (Note, however, that the model does allow transitions between any two states during the interval between successive video frames by making two or more non-simultaneous transitions; see <xref ref-type="disp-formula" rid="equ22">Equation 21</xref>). We first fit the velocity distribution for each cohort with three overlapping probability distributions corresponding to forward, reverse and pause states (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>), then searched for the set of transition rate constants that maximized the likelihood of the observed <inline-formula><mml:math id="inf79"><mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> given the velocity distributions. The resulting rate constants were used to compute the most likely sequence of states via the Viterbi algorithm (<xref ref-type="bibr" rid="bib74">Rabiner, 1989</xref>; <xref ref-type="bibr" rid="bib100">Viterbi, 1967</xref>). The agreement between observed velocity data and the sequence of states shown in <xref ref-type="fig" rid="fig2">Figure 2E</xref> was typical of the entire data set.</p></sec><sec id="s2-3"><title>Wild type locomotion</title><p>The maximum likelihood rate constants for 5 wild-type cohorts, together with the predicted state probabilities and mean dwell times computed from them, are given in column A of <xref ref-type="table" rid="tbl1">Table 1</xref>. The model’s predicted mean dwell time in the reverse state (<inline-formula><mml:math id="inf80"><mml:msub><mml:mi>d</mml:mi><mml:mtext>R</mml:mtext></mml:msub><mml:mo>=</mml:mo></mml:math></inline-formula> 1.94 ± 0.04 s) agreed with previously reported values (<xref ref-type="bibr" rid="bib108">Zheng et al., 1999</xref>; <xref ref-type="bibr" rid="bib47">Kawano et al., 2011</xref>). In contrast, the predicted mean dwell time in the forward state (<inline-formula><mml:math id="inf81"><mml:msub><mml:mi>d</mml:mi><mml:mtext>F</mml:mtext></mml:msub><mml:mo>=</mml:mo></mml:math></inline-formula> 5.33 ± 0.25 s) was smaller than previously reported when dwell time was measured by eye (13–35 sec) (<xref ref-type="bibr" rid="bib107">Zhao et al., 2003</xref>; <xref ref-type="bibr" rid="bib108">Zheng et al., 1999</xref>; <xref ref-type="bibr" rid="bib11">Brockie et al., 2001</xref>; <xref ref-type="bibr" rid="bib77">Ryu and Samuel, 2002</xref>) or by velocity threshold crossings (9–16 sec) (<xref ref-type="bibr" rid="bib75">Rakowski et al., 2013</xref>; <xref ref-type="bibr" rid="bib89">Stephens et al., 2011</xref>). To determine whether this difference arose because we used a hidden Markov model rather than a fixed velocity threshold, we also identified states based on a fixed velocity threshold of 0.05 mm/s, and calculated the resulting mean dwell times: <inline-formula><mml:math id="inf82"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mtext>F</mml:mtext><mml:mo>,</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:math></inline-formula> 1.86 ± 0.03 s; <inline-formula><mml:math id="inf83"><mml:mo/><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mtext>R</mml:mtext><mml:mo>,</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:math></inline-formula> 1.23 ± 0.02 s; <inline-formula><mml:math id="inf84"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>05</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:math></inline-formula> 0.14 ± 0.001 s. We attribute the short mean dwell times in state F that we observed using either the hidden Markov model or a fixed velocity threshold to the fact that our tracking system is capable of revealing briefer visits to state P, which interrupt forward runs, than previous methods. Ignoring transient interruptions of forward locomotion (i.e., FPF transitions) and using the fixed velocity threshold of 0.05 mm/s yielded longer a mean forward dwell time of 9.13 ± 0.15 s, which matches the value obtained by others using the same threshold (8.98 ± 0.57 s) (<xref ref-type="bibr" rid="bib75">Rakowski et al., 2013</xref>). Predicted mean dwell times in the two pause states differed substantially from each other (<inline-formula><mml:math id="inf85"><mml:msub><mml:mi>d</mml:mi><mml:mtext>X</mml:mtext></mml:msub><mml:mo>=</mml:mo></mml:math></inline-formula>0.44 ± 0.03 s, <inline-formula><mml:math id="inf86"><mml:msub><mml:mi>d</mml:mi><mml:mtext>Y</mml:mtext></mml:msub><mml:mo>=</mml:mo></mml:math></inline-formula> 0.21 ± 0.02). We assigned the long and short pause states to X and Y, respectively, based on the idea that the energetically expensive state in which both units are on should be relatively short-lived.<table-wrap id="tbl1" position="float"><object-id pub-id-type="doi">10.7554/eLife.12572.014</object-id><label>Table 1.</label><caption><p>Maximum likelihood fits of transition rates in wild type <italic>C. elegans</italic>. Each cohort was fitted separately; values are expressed as mean ± sem (<italic>n</italic> = 5 cohorts). Data from wild type cohorts were obtained on the same days as the experimental cohorts for which they served as controls (<xref ref-type="table" rid="tbl3">Tables 3</xref> and <xref ref-type="table" rid="tbl4">4</xref>), but experimental cohorts in this study were separated by weeks to months. All transition rates were constrained to be ≥0. Transition rates that were calculated using the synaptic constraints (<xref ref-type="disp-formula" rid="equ36">Equation 35</xref>) are shaded orange; other constrained values are shaded grey. Mean dwell times and state probabilities were calculated from the transition rates. Column A shows fits using the standard model, which has 8 rate constants with two synaptic constraints, resulting in 6 free parameters that determine the 6 synaptic weights (<xref ref-type="fig" rid="fig2">Figure 2C,D</xref>; Materials and methods <xref ref-type="disp-formula" rid="equ32 equ33 equ34 equ35 equ36">Equations 31–35</xref>). Column B shows fits to a model that has only one pause state (X); this model was derived from the standard model by imposing two more constraints: <inline-formula><mml:math id="inf87"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>≅</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, yielding 4 free parameters. To allow comparison of models A and B by the likelihood ratio test, which requires that model B be a special case of model A, <inline-formula><mml:math id="inf88"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf89"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> were set slightly &gt;0 (10<sup>-10</sup> s<sup>-1</sup>), thereby avoiding infinite values for <inline-formula><mml:math id="inf90"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>Y</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf91"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>Y</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> when applying the synaptic constraints, while maintaining a vanishingly small probability of being in state Y (<inline-formula><mml:math id="inf92"><mml:msub><mml:mi>p</mml:mi><mml:mtext>Y</mml:mtext></mml:msub><mml:mo>&lt;</mml:mo></mml:math></inline-formula> 10<sup>-18</sup>). The log<sub>e</sub> likelihood (summed over the 5 cohorts) for model B was 1854 less than for model A, with 30 degrees of freedom for model A (6 per cohort × 5 cohorts) and 20 degrees of freedom for model B (4 per cohort × 5 cohorts). Applying the likelihood ratio test, the difference was highly significant (<italic>p</italic>&lt;10<sup>-100</sup>; <italic>p</italic>=Chi-squared(2<italic>L, df</italic>), where <italic>L </italic> = 1854 and <italic>df </italic> = 30–20 =10. Model C is the most general 3-state (F, R, P) model, which allows all six transitions between the three states. The fitted transition rates for model C were nearly identical to model B. Likelihood values are relative to model A.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.014">http://dx.doi.org/10.7554/eLife.12572.014</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="center" rowspan="2"/><th align="center"><p>A</p></th><th align="center"><p>B</p></th><th align="center"><p>C</p></th></tr><tr><th align="center"><p>2 pause states6 free parameters</p></th><th align="center"><p>1 pause state4 free parameters</p></th><th align="center"><p>1 pause state6 free parameters</p></th></tr><tr><th align="center"><p>Δ log<sub>e</sub> likelihood</p></th><th align="center"><p>0</p></th><th align="center"><p>-1854</p></th><th align="center"><p>-1836</p></th></tr><tr><th align="center"><p>Degrees of freedom</p></th><th align="center"><p>30</p></th><th align="center"><p>20</p></th><th align="center"><p>30</p></th></tr><tr><th align="center"/><th align="center"><p>mean ± sem (<italic>n </italic> = 5)</p></th><th align="center"><p>mean ± sem (<italic>n </italic> = 5)</p></th><th align="center"><p>mean ± sem (<italic>n </italic> = 5)</p></th></tr></thead><tbody><tr><td align="center"><p><inline-formula><mml:math id="inf93"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>XR</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (s<sup>-1</sup>)</p></td><td align="center"><p>1.201 ± 0.099</p></td><td align="center"><p>1.019 ± 0.085</p></td><td align="center"><p>1.008 ± 0.090</p></td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf95"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>XF</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (s<sup>-1</sup>)</p></td><td align="center"><p>1.115 ± 0.087</p></td><td align="center"><p>1.915 ± 0.152</p></td><td align="center"><p>1.914 ± 0.152</p></td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf97"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>RX</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (s<sup>-1</sup>)</p></td><td align="center"><p>0.025 ± 0.008</p></td><td align="center"><p>0.507 ± 0.013</p></td><td align="center"><p>0.507 ± 0.013</p></td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf99"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>RY</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (s<sup>-1</sup>)</p></td><td align="center"><p>0.490 ± 0.015</p></td><td align="center" style="background: #C0C0C0;"><p>10<sup>-10</sup></p></td><td align="center"/></tr><tr><td align="center"><p><inline-formula><mml:math id="inf101"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>FX</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (s<sup>-1</sup>)</p></td><td align="center"><p>0.182 ± 0.007</p></td><td align="center"><p>0.198 ± 0.009</p></td><td align="center"><p>0.196 ± 0.008</p></td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf103"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>FY</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (s<sup>-1</sup>)</p></td><td align="center"><p>0.007 ± 0.002</p></td><td align="center" style="background: #C0C0C0;"><p>10<sup>-10</sup></p></td><td align="center"/></tr><tr><td align="center"><p><inline-formula><mml:math id="inf105"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>YR</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (s<sup>-1</sup>)</p></td><td align="center" style="background: #FFCC99;"><p>0.411 ± 0.019</p></td><td align="center" style="background: #FFCC99;"><p>&gt;10<sup>9</sup></p> </td><td align="center"/></tr><tr><td align="center"><p><inline-formula><mml:math id="inf107"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>YF</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (s<sup>-1</sup>)</p></td><td align="center" style="background: #FFCC99;"><p>4.575 ± 0.533</p></td><td align="center" style="background: #FFCC99;"><p>&gt;10<sup>9</sup></p> </td><td align="center"/></tr><tr><td align="center"><p><inline-formula><mml:math id="inf109"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>FR</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (s<sup>-1</sup>)</p></td><td align="center"/><td align="center"/><td align="center"><p>0.001 ± 0.001</p></td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf111"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>RF</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (s<sup>-1</sup>)</p></td><td align="center"/><td align="center"/><td align="center"><p>0.000 ± 0.000</p></td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf113"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> (s)</p></td><td align="center"><p>5.329 ± 0.245</p></td><td align="center"><p>5.096 ± 0.235</p></td><td align="center"><p>5.135 ± 0.227</p></td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf115"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> (s)</p></td><td align="center"><p>1.945 ± 0.043</p></td><td align="center"><p>1.975 ± 0.049</p></td><td align="center"><p>1.976 ± 0.049</p></td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf117"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>X</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> (s)</p></td><td align="center"><p>0.441 ± 0.032</p></td><td align="center"><p>0.349 ± 0.026</p></td><td align="center"><p>0.351 ± 0.027</p></td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf119"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>Y</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> (s)</p></td><td align="center"><p>0.208 ± 0.019</p></td><td align="center"><p>&lt;10<sup>-9</sup></p></td><td align="center"/></tr><tr><td align="center"><p><inline-formula><mml:math id="inf121"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center"><p>0.762 ± 0.015</p></td><td align="center"><p>0.7641 ± 0.015</p></td><td align="center"><p>0.764 ± 0.014</p></td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf123"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center"><p>0.158 ± 0.007</p></td><td align="center"><p>0.158 ± 0.007</p></td><td align="center"><p>0.155 ± 0.007</p></td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf125"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>X</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center"><p>0.063 ± 0.006</p></td><td align="center"><p>0.081 ± 0.008</p></td><td align="center"><p>0.080 ± 0.008</p></td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf127"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>Y</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center"><p>0.017 ± 0.002</p></td><td align="center"><p>&lt;10<sup>-18</sup></p></td><td align="center"/></tr></tbody></table></table-wrap></p><p>In previous work, transitions between locomotory states in <italic>C. elegans</italic> have been analyzed by choosing a speed threshold to distinguish pause states from the movement states (<xref ref-type="bibr" rid="bib75">Rakowski et al., 2013</xref>; <xref ref-type="bibr" rid="bib78">Salvador et al., 2014</xref>; <xref ref-type="bibr" rid="bib89">Stephens et al., 2011</xref>). The choice of threshold is important because it affects the measured dwell times, yet is necessarily arbitrary because the velocity distributions of the states overlap (<xref ref-type="fig" rid="fig1">Figure 1F</xref>). The hidden Markov model used here replaces arbitrary thresholds with empirically determined state transition rates (i.e., the set of rates that maximizes the probability of the observed velocity time series), from which one can determine the sequence of states that is most likely to have generated the data (the Viterbi algorithm). The hidden Markov model thus offers two advantages: (1) it provides a statistical criterion for selecting the best parameter values and (2) it takes into account the uncertainties in identifying the state of the system from velocity data.</p><p>Under the assumptions of the hidden Markov model the state of the system cannot be observed directly because the velocity distributions overlap, making it impossible to test directly whether the predicted state probabilities agree with the observed velocity data. Nevertheless, an important test of the model can be obtained using the Viterbi algorithm to identify the most likely sequence of states given the observed velocity data, from which the histogram of dwell times in each state can be computed and compared to the exponential distribution predicted by the Markov model (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>). The degree of agreement between the distributions shows that our model provides a good description of the system.</p><p>The initial rationale for including two pause states in the hidden Markov model came from our model-independent analysis of the tracking data (<xref ref-type="fig" rid="fig1">Figure 1I</xref>), which showed different dwell time distributions for pauses at FPR and RPF transitions. To test whether having two pause states yielded a statistically significant improvement in the ability of the model to fit the data, we eliminated one of the pause states and asked whether the resulting reduction in likelihood was greater than could be attributed to the reduction in the number of free parameters (see <xref ref-type="table" rid="tbl1">Table 1</xref>). For this comparison we constrained the transition rates into state Y to be extremely small (<inline-formula><mml:math id="inf129"><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:math></inline-formula> 10<sup>-10</sup> s<sup>-1</sup>), effectively eliminating state Y and reducing the number of free parameters from six to four. The reduction in likelihood caused by eliminating one of the pause states was highly significant, and cannot be attributed simply to the elimination of two parameters (<italic>p</italic>&lt;10<sup>-100</sup>; likelihood ratio test). Separately, we considered the most general one-pause state model, which allows direct transitions between states F and R and has no constraints on the 6 transition rates other than that they are all ≥0. The fit of this model (<xref ref-type="table" rid="tbl1">Table 1</xref> column C) converged to nearly the same set of transition rates as the one-state model described above (Model B). These comparisons show that our model with two pause states and six free parameters (the six synaptic weights) provides a much better fit to the data than models with only one pause state. We conclude that the tracking data contain a statistically significant signature of two distinct pause states. The model explains the observation that the pause dwell times during FPR transitions are longer than during RPF transitions (<xref ref-type="fig" rid="fig1">Figure 1I</xref>) in terms of the different dwell times in states X and Y (<inline-formula><mml:math id="inf130"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>X</mml:mtext></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mtext>Y</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>), and the strong tendency to cycle clockwise through state space, exiting from state F to state X and from state R to state Y as shown by the fate diagram (<xref ref-type="fig" rid="fig3">Figure 3</xref>).<fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.12572.015</object-id><label>Figure 3.</label><caption><title>Fate diagram of the model. </title><p>The system typically cycles clockwise through states F, X, R, Y, with state F frequently interrupted by FXF transitions, leading to state sequences of the form …(FX)<sub>n</sub>RY(FX)<sub>n</sub>RY…. Nearly unidirectional transitions out of a given state are shown by red arrows; blue arrows indicate nearly equiprobable transitions. The width of the arrows and the numbers beside them show the probability that the transition out of the state at the tail of the arrow is into the state at the head. The area of each circle is proportional to the probability of the corresponding state (<xref ref-type="table" rid="tbl1">Table 1</xref>, column A).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.015">http://dx.doi.org/10.7554/eLife.12572.015</ext-link></p></caption><graphic xlink:href="elife-12572-fig3-v2"/></fig></p><p>It has been reported that pauses in <italic>C. elegans</italic> locomotion occur at specific points in “shape space” (<xref ref-type="bibr" rid="bib89">Stephens et al., 2011</xref>), suggesting the worm pauses in preferred postures. To investigate this possibility, we analyzed worm tracks before and after pauses, inferring posture from the path of the tracking spot. This inference is justified by the fact that on an agar surface the worm moves without slipping, such that each segment of the body traces the trajectory of the one before it. Thus, the path of the tracking spot leading up to the pause reveals the worm’s posture posterior to the spot during forward locomotion, and anterior to the spot during reverse locomotion (<xref ref-type="fig" rid="fig4">Figure 4</xref>).<fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.12572.016</object-id><label>Figure 4.</label><caption><title>Relationship between pauses and posture.</title><p>(<bold>A</bold>) Average track curvature upon entry in to the pause state in wild type worms. Prior to computing curvature, tracks of individual worms were mirror-imaged as needed such that positive curvature corresponds to a ventral bend. Tracks in the vicinity of pause events were aligned according to the location of the tracking spot in the pause state, converted to curvature, then averaged over all FX transitions (solid blue line; <italic>n</italic> = 1907), and all RY transitions (red; <italic>n</italic> = 295) for which the track length was &gt;1.5 mm; shading shows ± 1 S.D. The trace depicts the curvature of the worm posterior to the tracking spot at the end of forward movement (FX transitions) and anterior to the tracking spot at the end of reverse movement (RY transitions). The dashed blue line shows the average curvature at FXR transitions (i.e., excluding FXF stutters). (<bold><bold>B</bold></bold>) Locomotory phases at which FX transitions occurred, plotted as blue dots on the unit circle. The phase at each FX transition was computed as <inline-formula><mml:math id="inf131"><mml:mrow><mml:mi>φ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf132"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf133"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are the positions of the two downward zero crossings of curvature preceding the pause as indicated in panel <bold>A</bold>, right. The uniform distribution of points around the circle, and therefore the small magnitude of the vector strength (<inline-formula><mml:math id="inf134"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.14</mml:mn></mml:mrow></mml:math></inline-formula>; arrow), shows that there was only a small (but statistically significant) phase preference at the end of forward motion (<inline-formula><mml:math id="inf135"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>; Rayleigh test). (C) Same as <bold>B</bold>, but for RY transitions. Vector strength is large (<inline-formula><mml:math id="inf136"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.71</mml:mn></mml:mrow></mml:math></inline-formula>), indicating a strong tendency to end reverse runs at a particular phase (<inline-formula><mml:math id="inf137"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>63</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>), with a ventral bend in the middle of the body. (<bold>D</bold>) Average posture at FXR transitions, calculated by integrating the average curvature, computed over all tracks that persisted for &gt;1.5 mm in state F before the pause and &gt;1 mm in state R after the pause. Arrows indicate direction of motion along the track (blue, forward; red, reverse). FXR transitions were typically a simple reversal along the same track. (<bold>E</bold>) Same as <bold>D</bold> but for RYF transitions that persisted for &gt;1.5 mm in state R before the pause and &gt;1 mm in state F after the pause. RYF transitions at the end of reverse runs that persisted for &gt;1.5 mm were usually associated with a ventral bend that resulted in a ~180° change of direction as previously described (<xref ref-type="bibr" rid="bib35">Gray et al., 2005</xref>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.016">http://dx.doi.org/10.7554/eLife.12572.016</ext-link></p></caption><graphic xlink:href="elife-12572-fig4-v2"/></fig></p><p>Plotting mean curvature versus distance along the track (<xref ref-type="fig" rid="fig4">Figure 4A</xref>) reveals only a weak tendency to stop in a particular posture in state X (<italic>r</italic> = 0.14; <xref ref-type="fig" rid="fig4">Figure 4B</xref>). Nearly all of the transitions into state X were either stutters during forward locomotion (FXF transitions) or reversals (FXR transitions); when these were analyzed separately, similarly weak postural preferences were found at FXF transitions (<italic>r</italic> = 0.14) and FXR transitions (<italic>r</italic> = 0.14). A nearly identical result (<italic>r</italic> = 0.14 ) was obtained using a fixed velocity threshold of 0.05 mm/s rather than the hidden Markov model to determine state. For the latter case, in which there is only one pause state, we analyzed the posture at all FP transitions, which almost always correspond to FX transitions in the hidden Markov model because FY transitions are extremely rare (see <xref ref-type="fig" rid="fig3">Figure 3</xref> ).To test whether the failure to find a strong postural preference at FX transitions was due to including very short pauses in the analysis, we repeated the analysis after reclassifying all pauses shorter than a minimum duration as a continuation of the previous state, and obtained the same result; we found no strong postural preference at FX transitions for minimum pause durations up to 2 s (<italic>r</italic> = 0.16, 0.19, 0.23, 0.3 for X dwell times &gt; 0.33 s, 0.67 s, 1 s, and 2 s, respectively); longer dwells in state X were too rare to analyze. Thus, FX transitions can occur at any locomotory phase and do not occur preferentially at a particular posture (<xref ref-type="fig" rid="fig4">Figure 4D</xref>); in the case of FXR transitions the worm generally retreats along the same track. In contrast, we found a strong tendency to stop in a particular posture in state Y (<xref ref-type="fig" rid="fig4">Figure 4A,C,E</xref>; <italic>r</italic> = 0.71). Almost all entries into state Y were RYF transitions and these were associated with a ventral bend in the middle of the worm (<xref ref-type="fig" rid="fig4">Figure 4E</xref>). These results suggest fundamental differences between the control of forward and reverse locomotion. In our model, forward locomotion terminates when forward command neurons turn OFF, and this can happen at any phase, whereas reverse locomotion terminates when forward neurons turn ON, and this is most likely to happen at a particular phase. The latter could be explained by phasic feedback from the locomotory pattern generator to the forward neurons (<xref ref-type="bibr" rid="bib50">Li et al., 2006</xref>).</p></sec><sec id="s2-4"><title>Ablation of command neurons</title><p>To determine the contributions of individual command neurons to the overall function of the command network, we separately ablated the pair of neurons that comprises each command neuron class, then tracked ablated and sham operated animals during local search. Mean velocities in F and R, if significantly changed, were reduced (<xref ref-type="bibr" rid="bib67">Pokala et al., 2014</xref>) (<xref ref-type="fig" rid="fig5">Figure 5A</xref>; <inline-formula><mml:math id="inf138"><mml:mrow><mml:mo>⋆</mml:mo><mml:mo>⋆</mml:mo></mml:mrow></mml:math></inline-formula>), as was the frequency of undulations during forward and reverse locomotion (<xref ref-type="table" rid="tbl3">Table 3</xref>). In many organisms, the frequency of rhythmic behaviors is regulated by the amplitude of tonic excitatory drive to the associated pattern generator (<xref ref-type="bibr" rid="bib102">Weeks, 1978</xref>; <xref ref-type="bibr" rid="bib80">Satterlie and Norekian, 2001</xref>; <xref ref-type="bibr" rid="bib13">Böhm and Schildberger, 1992</xref>; <xref ref-type="bibr" rid="bib20">Deliagina et al., 2000</xref>; <xref ref-type="bibr" rid="bib21">Dembrow et al., 2003</xref>; <xref ref-type="bibr" rid="bib38">Hedwig, 2000</xref>; <xref ref-type="bibr" rid="bib86">Sirota et al., 2000</xref>). To explain our results we propose that ablation of the locomotory command neurons reduces tonic drive to the presumptive locomotory pattern generator (<xref ref-type="bibr" rid="bib106">Xie et al., 2013</xref>; <xref ref-type="bibr" rid="bib29">Gao et al., 2015</xref>).<fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.12572.017</object-id><label>Figure 5.</label><caption><title>Ablation of command neurons.</title><p>(<bold>A</bold>) Velocity distribution of ablated cohorts (red) compared to sham operated controls (grey) when the indicated command neuron was killed. Stars indicate significant reduction in velocity for the indicated peak (<italic>p</italic>&lt;0.05 without (<inline-formula><mml:math id="inf139"><mml:mo>⋆</mml:mo></mml:math></inline-formula>) or with (<inline-formula><mml:math id="inf140"><mml:mrow><mml:mo>⋆</mml:mo><mml:mo>⋆</mml:mo></mml:mrow></mml:math></inline-formula>) correction for multiple comparisons; <xref ref-type="table" rid="tbl3">Table 3</xref>). (<bold>B</bold>) Dwell times in F, R, and P in ablated (red) and sham operated animals (grey). Stars indicate significant differences from sham (as defined in <xref ref-type="table" rid="tbl4">Table 4</xref>). Horizontal lines indicate the estimated range of <inline-formula><mml:math id="inf141"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, the dwell time in the uncoupled state. Each group of ablated animals was tested in parallel with a distinct set of sham operated controls to minimize the effects of variation between populations. Error bars for dwell times are not shown because statistical significance was calculated using the likelihood ratio test (see <xref ref-type="table" rid="tbl4">Table 4</xref> legend), which does not generate sem estimates, and calculation of confidence intervals would have required an excessive amount of computation time. Stars indicate <italic>p</italic>&lt;0.05 without (<inline-formula><mml:math id="inf142"><mml:mo>⋆</mml:mo></mml:math></inline-formula>) or with (<inline-formula><mml:math id="inf143"><mml:mrow><mml:mo>⋆</mml:mo><mml:mo>⋆</mml:mo></mml:mrow></mml:math></inline-formula>) correction for multiple comparisons (<xref ref-type="table" rid="tbl4">Table 4</xref>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.017">http://dx.doi.org/10.7554/eLife.12572.017</ext-link></p></caption><graphic xlink:href="elife-12572-fig5-v2"/></fig><table-wrap id="tbl2" position="float"><object-id pub-id-type="doi">10.7554/eLife.12572.018</object-id><label>Table 2.</label><caption><p>Synaptic weights derived from the transition rate constants. The rate constants were taken from <xref ref-type="table" rid="tbl1">Table 1</xref>, column A. Two values of the fundamental switching time, <italic>A</italic>, corresponding to the minimum (0.40 Hz) and maximum (0.86 Hz) values consistent with the ablation results were used in Materials and methods, <xref ref-type="disp-formula" rid="equ37 equ38 equ39">Equations 36–38</xref> to calculate the corresponding synaptic weights.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.018">http://dx.doi.org/10.7554/eLife.12572.018</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th> </th><th align="center"><p><inline-formula><mml:math id="inf144"><mml:mi>A</mml:mi><mml:mo>=</mml:mo></mml:math></inline-formula> 0.4 Hzmean ± sem (<italic>n</italic> = 5)</p></th><th align="center"><p><inline-formula><mml:math id="inf146"><mml:mi>A</mml:mi><mml:mo>=</mml:mo></mml:math></inline-formula> 0.86 Hzmean ± sem (<italic>n</italic> = 5)</p></th></tr></thead><tbody><tr><td><inline-formula><mml:math id="inf148"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula></td><td>1.01 ± 0.08</td><td>0.25 ± 0.08</td></tr><tr><td style="background: #FFFFFF;"><inline-formula><mml:math id="inf150"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula></td><td style="background: #FFFFFF;">1.09 ± 0.08</td><td style="background: #FFFFFF;">0.32 ± 0.08</td></tr><tr><td><inline-formula><mml:math id="inf152"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></td><td>-5.40 ± 0.43</td><td>-5.40 ± 0.43</td></tr><tr><td><inline-formula><mml:math id="inf154"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></td><td>-0.81 ± 0.06</td><td>-0.81 ± 0.06</td></tr><tr><td><inline-formula><mml:math id="inf156"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></td><td>-0.22 ± 0.06</td><td>1.31 ± 0.06</td></tr><tr><td><inline-formula><mml:math id="inf158"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></td><td>1.90 ± 0.33</td><td>3.43 ± 0.33</td></tr></tbody></table></table-wrap><table-wrap id="tbl3" position="float"><object-id pub-id-type="doi">10.7554/eLife.12572.019</object-id><label>Table 3.</label><caption><p>Effects of command neuron ablations on undulation frequency, forward velocity and reverse velocity. Values were computed separately for each worm and are shown as mean ± sem (<italic>n</italic> = 19–29 ). Undulation frequency was estimated as one-half of the reciprocal of the time of the first local minimum in the heading autocorrelation function. All <italic>p</italic>-values are from two-tailed <italic>t</italic>-tests and are shown without correction for multiple comparisons. Blue denotes significance at p&lt;0.05. Red denotes significance at p&lt;0.05 after Bonferroni correction for 15 comparisons.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.019">http://dx.doi.org/10.7554/eLife.12572.019</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th/><th colspan="3">Undulation frequency (Hz)</th><th colspan="3">Forward velocity (μm/s)</th><th colspan="3">Reverse velocity (μm/s)</th></tr><tr><th>Neuron</th><th>Class</th><th>Sham</th><th>Ablated</th><th><italic>p</italic> &lt;</th><th>Sham</th><th>Ablated</th><th><italic>p</italic> &lt;</th><th>Sham</th><th>Ablated</th><th><italic>p</italic> &lt;</th></tr></thead><tbody><tr><td>AVB</td><td>Forward</td><td>0.355 ± 0.009</td><td>0.230 ± 0.007</td><td style="color: #FF0000;"><styled-content>7x10<sup>-11</sup></styled-content></td><td>236 ± 6</td><td>109 ± 4</td><td style="color: #FF0000;"><styled-content>5x10<sup>-20</sup></styled-content></td><td>-327 ± 7</td><td>-302 ± 8</td><td><styled-content>0.04</styled-content></td></tr><tr><td>PVC</td><td>Forward</td><td>0.283 ± 0.011</td><td>0.290 ± 0.010</td><td>0.5</td><td>187 ± 7</td><td>192 ± 7</td><td>0.7</td><td>-253 ± 8</td><td>-248 ± 6</td><td>0.7</td></tr><tr><td>AVD</td><td>Reverse</td><td>0.270 ± 0.008</td><td>0.236 ± 0.008</td><td><styled-content>0.009</styled-content></td><td>173 ± 6</td><td>141 ± 5</td><td style="color: #FF0000;"><styled-content>0.0002</styled-content></td><td>-243 ± 4</td><td>-229 ± 5</td><td>0.06</td></tr><tr><td>AVA</td><td>Reverse</td><td>0.302 ± 0.005</td><td>0.254 ± 0.009</td><td style="color: #FF0000;"><styled-content>4x10<sup>-5</sup></styled-content></td><td>195 ± 5</td><td>155 ± 7</td><td style="color: #FF0000;"><styled-content>4x10<sup>-5</sup></styled-content></td><td>-293 ± 7</td><td>-69 ± 3</td><td style="color: #FF0000;"><styled-content>3x10<sup>-22</sup></styled-content></td></tr><tr><td>AVE</td><td>Reverse</td><td>0.264 ± 0.007</td><td>0.256 ± 0.008</td><td>0.6</td><td>165 ± 4</td><td>160 ± 5</td><td>0.5</td><td>-235 ± 4</td><td>-211 ± 6</td><td style="color: #FF0000;"><styled-content>0.003</styled-content></td></tr></tbody></table></table-wrap></p><p>A previous study found that ablating a subset of the reverse command neurons (AVAL and AVAR) reduces dwell time in the reverse state but also paradoxically reduces dwell time in the forward state (<xref ref-type="bibr" rid="bib108">Zheng et al., 1999</xref>). Similarly paradoxical effects have been reported following ablation of the reciprocally connected brain stem nuclei that regulate sleep and wakefulness (<xref ref-type="bibr" rid="bib79">Saper et al., 2010</xref>). The stochastic switch model predicts and explains such effects. In principle, the ablation of a subset of neurons in a pool of co-active neurons can have widespread effects on the pool’s overall input and output connectivity. Widespread effects can be expected because ablation removes not only the outgoing synaptic connections from the ablated neurons, but also the targets of incoming synaptic connections. In the <italic>C. elegans</italic> command neuron network, ablating a reverse command neuron such as AVA potentially reduces four of the six weights in the network: <inline-formula><mml:math id="inf160"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf161"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf162"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf163"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Thus, a single ablation can move the system a considerable distance in weight space toward the uncoupled state in which all weights are zero. In the limiting case of a fully uncoupled network, all dwell times approach a value of <inline-formula><mml:math id="inf164"><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mi>A</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf165"><mml:mi>A</mml:mi></mml:math></inline-formula> is the intrinsic switching time of the stochastic units (see Materials and methods, <xref ref-type="disp-formula" rid="equ32 equ33 equ34 equ35">equations 31–34</xref>); henceforth we will use <inline-formula><mml:math id="inf166"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> to denote the uncoupled dwell time. Dwell times that in intact animals are greater than <inline-formula><mml:math id="inf167"><mml:msub><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> will be reduced by ablation, whereas dwell times that are less than <inline-formula><mml:math id="inf168"><mml:msub><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> will be increased. In particular, if <inline-formula><mml:math id="inf169"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf170"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> are both greater than <inline-formula><mml:math id="inf171"><mml:msub><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, ablation of a reverse command neuron is expected to reduce both dwell times; the same is true for ablation of a forward command neuron. Thus the observed paradoxical effects of ablations are to be expected if <inline-formula><mml:math id="inf172"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is below <inline-formula><mml:math id="inf173"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf174"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>.</p><p>To determine the actual relationship between <inline-formula><mml:math id="inf175"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and dwell times in the forward and reverse state, we estimated the rate constants in ablated animals and sham operated controls, and computed the corresponding dwell times (<xref ref-type="fig" rid="fig5">Figure 5B</xref>; <xref ref-type="table" rid="tbl4">Table 4</xref>). Dwell times in F and R, if significantly altered by the ablation (<inline-formula><mml:math id="inf176"><mml:mrow><mml:mo>⋆</mml:mo><mml:mo>⋆</mml:mo></mml:mrow></mml:math></inline-formula>), were reduced, indicating that <inline-formula><mml:math id="inf177"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is indeed below <inline-formula><mml:math id="inf178"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf179"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>. Additionally, dwell times in the pause states <inline-formula><mml:math id="inf180"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>X</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf181"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>Y</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> were increased, with one exception (<inline-formula><mml:math id="inf182"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>Y</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>, AVB). Thus, the observed pattern of dwell time changes is consistent, overall, with a value of <inline-formula><mml:math id="inf183"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> that is between the dwell times of the movement states and the dwell times of the pause states. This finding allowed us to place bounds on <inline-formula><mml:math id="inf184"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. Specifically, <inline-formula><mml:math id="inf185"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> must be less than or equal to the lowest post-ablation value of <inline-formula><mml:math id="inf186"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>, and greater than or equal to the largest post-ablation value of <inline-formula><mml:math id="inf187"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>X</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>; thus, 0.58 ≤ <inline-formula><mml:math id="inf188"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> ≤ 1.24 sec. Furthermore, because <inline-formula><mml:math id="inf189"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, we can infer that 0.40 Hz ≤ <inline-formula><mml:math id="inf190"><mml:mi>A</mml:mi></mml:math></inline-formula> ≤ 0.86 Hz. This inequality provides an estimate of the fundamental time scale of stochastic switching in <italic>C. elegans</italic> locomotion. For subsequent analysis, we defined <inline-formula><mml:math id="inf191"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:math></inline-formula> 0.40 Hz and <inline-formula><mml:math id="inf192"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:math></inline-formula> 0.86 Hz.<table-wrap id="tbl4" position="float"><object-id pub-id-type="doi">10.7554/eLife.12572.020</object-id><label>Table 4.</label><caption><p>Effects of command neuron ablations on model parameters. The sign of the change (Δ) caused by the ablation is shown as “+” if the value moved away from 0, “–” if the value moved towards 0. Significance was determined using the likelihood ratio test (Weisstein, Eric W. &quot;Likelihood Ratio.&quot; From MathWorld--A Wolfram Web Resource. <ext-link ext-link-type="uri" xlink:href="http://mathworld.wolfram.%20com/LikelihoodRatio.html">http://mathworld.wolfram. com/LikelihoodRatio.html</ext-link>), which is based on the reduction in likelihood caused by constraining one of the parameters to have the same value in both the ablated cohort and the corresponding sham cohort. The unconstrained fit thus had 12 free parameters (6 for each of the 2 cohorts being compared), while the constrained fit had 11 free parameters. For example, to test the significance of the change in the mean dwell time in the pause state (<inline-formula><mml:math id="inf193"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>P</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>X</mml:mtext></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mtext>X</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mtext>Y</mml:mtext></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mtext>Y</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>X</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mtext>Y</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) caused by ablation of the AVA neuron pair, two cohorts (ablated and sham) were grown and tested under identical conditions. The ln likelihood with 12 free parameters was found to be 894794.075. When <inline-formula><mml:math id="inf194"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>P</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> was constrained to be the same for both cohorts, the ln likelihood for the 11 parameter fit was found to be 894784.676. The test statistic <inline-formula><mml:math id="inf195"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>894794.075</mml:mn><mml:mo>−</mml:mo><mml:mn>894784.676</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo/><mml:mn>18.798</mml:mn></mml:mrow></mml:math></inline-formula> was assumed to come from a chi-squared distribution with one degree of freedom, which yielded <inline-formula><mml:math id="inf196"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1.45</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> (shown in the table as <inline-formula><mml:math id="inf197"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>). The constrained fitting process was repeated in turn for each ablation/sham pair for each of the 9 rows shown in the table. All <italic>p</italic>-values are shown without correction for multiple comparisons. Blue denotes significance at p&lt;0.05. Red denotes significance at p&lt;0.05 after Bonferroni correction for 27 comparisons</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.020">http://dx.doi.org/10.7554/eLife.12572.020</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th> </th><th colspan="12">REVERSE</th><th colspan="8">FORWARD</th></tr><tr><th> </th><th colspan="4">AVE</th><th colspan="4">AVD</th><th colspan="4">AVA</th><th colspan="4">AVB</th><th colspan="4">PVC</th></tr><tr><th> </th><th>Sham</th><th>Ablate</th><th>∆</th><th>p&lt;</th><th>Sham</th><th>Ablate</th><th>∆</th><th>p&lt;</th><th>Sham</th><th>Ablate</th><th>∆</th><th>p&lt;</th><th>Sham</th><th>Ablate</th><th>∆</th><th>p&lt;</th><th>Sham</th><th>Ablate</th><th>∆</th><th>p&lt;</th></tr></thead><tbody><tr><td><inline-formula><mml:math id="inf198"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> (s)</td><td>5.455</td><td>5.221</td><td>–</td><td>0.2</td><td>5.158</td><td>4.081</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-15</sup></styled-content></td><td>6.730</td><td>3.143</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-99</sup></styled-content></td><td>7.289</td><td>2.642</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-99</sup></styled-content></td><td>6.058</td><td>6.558</td><td>+</td><td><styled-content>0.02</styled-content></td></tr><tr><td><inline-formula><mml:math id="inf200"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> (s)</td><td>3.019</td><td>2.436</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-6</sup></styled-content></td><td>2.540</td><td>2.367</td><td>–</td><td><styled-content>0.05</styled-content></td><td>2.359</td><td>1.243</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-41</sup></styled-content></td><td>2.127</td><td>1.681</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-6</sup></styled-content></td><td>2.842</td><td>2.396</td><td>–</td><td style="color: #FF0000;"><styled-content>0.0005</styled-content></td></tr><tr><td><inline-formula><mml:math id="inf202"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>X</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> (s)</td><td>0.548</td><td>0.548</td><td>–</td><td>1</td><td>0.514</td><td>0.520</td><td>+</td><td>0.6</td><td>0.480</td><td>0.582</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-7</sup></styled-content></td><td>0.370</td><td>0.437</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-6</sup></styled-content></td><td>0.457</td><td>0.508</td><td>+</td><td style="color: #33CCCC;"><styled-content>0.004</styled-content></td></tr><tr><td><inline-formula><mml:math id="inf204"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>Y</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> (s)</td><td>0.229</td><td>0.263</td><td>+</td><td style="color: #FF0000;"><styled-content>0.002</styled-content></td><td>0.229</td><td>0.241</td><td>+</td><td>0.07</td><td>0.214</td><td>0.331</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-7</sup></styled-content></td><td>0.197</td><td>0.144</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-7</sup></styled-content></td><td>0.220</td><td>0.226</td><td>+</td><td>0.5</td></tr><tr><td><inline-formula><mml:math id="inf206"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>P</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> (s)</td><td>0.495</td><td>0.496</td><td>+</td><td>1</td><td>0.460</td><td>0.468</td><td>+</td><td>0.5</td><td>0.437</td><td>0.510</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-4</sup></styled-content></td><td>0.331</td><td>0.416</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-11</sup></styled-content></td><td>0.410</td><td>0.457</td><td>+</td><td style="color: #33CCCC;"><styled-content>0.003</styled-content></td></tr><tr><td><inline-formula><mml:math id="inf208"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td>0.720</td><td>0.747</td><td>+</td><td><styled-content>0.004</styled-content></td><td>0.723</td><td>0.689</td><td>–</td><td style="color: #FF0000;"><styled-content>0.0005</styled-content></td><td>0.809</td><td>0.704</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-24</sup></styled-content></td><td>0.818</td><td>0.745</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-15</sup></styled-content></td><td>0.749</td><td>0.787</td><td>+</td><td style="color: #FF0000;"><styled-content>0.0002</styled-content></td></tr><tr><td><inline-formula><mml:math id="inf210"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td>0.192</td><td>0.158</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-4</sup></styled-content></td><td>0.188</td><td>0.203</td><td>+</td><td><styled-content>0.05</styled-content></td><td>0.122</td><td>0.137</td><td>+</td><td><styled-content>0.04</styled-content></td><td>0.129</td><td>0.120</td><td>–</td><td>0.2</td><td>0.181</td><td>0.139</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-9</sup></styled-content></td></tr><tr><td><inline-formula><mml:math id="inf212"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>X</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td>0.073</td><td>0.078</td><td>+</td><td>0.07</td><td>0.072</td><td>0.088</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-7</sup></styled-content></td><td>0.058</td><td>0.113</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-9</sup></styled-content></td><td>0.041</td><td>0.125</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-99</sup></styled-content></td><td>0.056</td><td>0.061</td><td>+</td><td>0.2</td></tr><tr><td><inline-formula><mml:math id="inf214"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>Y</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td>0.014</td><td>0.017</td><td>+</td><td><styled-content>0.02</styled-content></td><td>0.017</td><td>0.020</td><td>+</td><td><styled-content>0.005</styled-content></td><td>0.011</td><td>0.046</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-23</sup></styled-content></td><td>0.012</td><td>0.010</td><td>–</td><td><styled-content>0.01</styled-content></td><td>0.014</td><td>0.013</td><td>–</td><td>0.5</td></tr></tbody></table></table-wrap></p></sec><sec id="s2-5"><title>Synaptic weights in the stochastic switch model</title><p>Having placed bounds on <inline-formula><mml:math id="inf216"><mml:mi>A</mml:mi></mml:math></inline-formula>, we were able to compute synaptic weights in the model (<xref ref-type="table" rid="tbl2">Table 2</xref>). This was done by deriving expressions for the weights in terms of the rate constants (Materials and methods, <xref ref-type="disp-formula" rid="equ37 equ38 equ39">Equations 36–38</xref>) and substituting into these equations our estimates of rate constants together with the values of <inline-formula><mml:math id="inf217"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf218"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. We found that input weights, <inline-formula><mml:math id="inf219"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf220"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, are small and positive, suggesting that these inputs may provide modest but steady excitation to the system (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). The self-connections <inline-formula><mml:math id="inf221"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf222"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are also mainly positive, indicating that the ON states may be stabilized by intrinsic or extrinsic positive feedback. The cross-connections <inline-formula><mml:math id="inf223"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf224"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are negative, indicating reciprocal inhibition, as expected for neurons that activate opposing behavioral states. Furthermore, the magnitude of <inline-formula><mml:math id="inf225"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is greater than the magnitude of <inline-formula><mml:math id="inf226"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, suggesting that the animal spends more time in the forward state than the reverse state in part because the forward neurons inhibit the reverse neurons more strongly than the reverse neurons inhibit the forward neurons.<fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.12572.021</object-id><label>Figure 6.</label><caption><title>The Stochastic Switch Model correctly predicts the sign and strength of synaptic connections.</title><p>(<bold>A</bold>) Synaptic weights (mean ± sem, <italic>n</italic> = 5 cohorts) from maximum likelihood fits to velocity data from wild type worms. (<bold>B</bold>, <bold>C</bold>) <italic>Left</italic>, synaptic current in AVB or AVA when the indicated presynaptic neuron was photoactivated (blue line). <italic>Right</italic>, mean synaptic current during the first 100 ms of the stimulus plotted against holding potential in the postsynaptic neuron (<italic>I-V</italic> curve). Lines show linear fits to the data at negative holding potentials which were used to estimate <inline-formula><mml:math id="inf227"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mtext>Rev</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. (<bold>D</bold>), Zero-current holding potential and reversal potential of synaptic currents (mean ± sem) in the indicated postsynaptic neuron (paired <italic>t</italic>-tests: AVA to AVB, <italic>p</italic>= 0.043, <italic>n</italic> = 9; AVB to AVA, <italic>p</italic>= 0.019, <italic>n</italic> = 17). (<bold>E</bold>), Scatter plot of synaptic currents recorded at a holding potential of -15 mV (unpaired <italic>t</italic>-test: <italic>p</italic>= 0.010, <italic>n</italic> ≥ 25).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.021">http://dx.doi.org/10.7554/eLife.12572.021</ext-link></p></caption><graphic xlink:href="elife-12572-fig6-v2"/></fig></p><p>Synaptic weights in an abstract network model such as this one, where neuronal state is activation rather than voltage, are not generally interpretable as synaptic conductances. Rather, they represent the functional effects of one neuron on another, such as the degree of excitation or inhibition produced by a unit change in activation. Thus, synaptic weights in the Stochastic Switch model cannot be said to predict the magnitude of synaptic conductances, but they can be said to predict aspects of functional connectivity in certain cases. For example, as command neurons AVA and AVB are behaviorally much more important than the others (<xref ref-type="bibr" rid="bib17">Chalfie et al., 1985</xref>) (see also <xref ref-type="fig" rid="fig5">Figure 5A,B</xref>), it is reasonable to assume that the signs of their functional synaptic connections match the signs of the net functional connections in the biological network. Thus, the model predicts reciprocal inhibition (<xref ref-type="bibr" rid="bib71">Qi et al., 2012</xref>) between AVA and AVB under this assumption. We tested this prediction by photoactivating either AVA or AVB with channelRhodopsin-2 and recording electrophysiologically from AVB or AVA, respectively (<xref ref-type="fig" rid="fig6">Figure 6B,C</xref>). We found that the reversal potential of optically induced synaptic currents in AVA and AVB was more negative than the zero-current potential in these neurons (<xref ref-type="fig" rid="fig6">Figure 6B,C,D</xref>), indicating synaptic inhibition as predicted by the model. This inhibition is likely to be monosynaptic as <italic>C. elegans</italic> command neurons are cholinergic and express inhibitory postsynaptic receptors that respond to acetylcholine (<xref ref-type="bibr" rid="bib109">Pereira et al., 2015</xref>). Additionally, the connection from AVB to AVA appeared to be stronger than the connection from AVA to AVB (<xref ref-type="fig" rid="fig6">Figure 6E</xref>), measured in terms of the amplitude of the synaptic current at a holding potential approximately equal to the membrane potential when command neurons are in their depolarized state (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). However, we do not exclude the possibility that AVB was more strongly activated than AVA as a result of differential expression of the photoprobe. These findings demonstrate the feasibility of using the worm’s velocity, <inline-formula><mml:math id="inf228"><mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, a simple behavioral measure, to predict functional synaptic connections between populations of neurons in a biological neural network, at least under certain assumptions concerning the relationship between model network weights and physiological synaptic strengths.</p></sec><sec id="s2-6"><title>Genetic effects on command neuron function</title><p>Two classes of ion channel mutants that affect membrane conductances in the command neurons are also known to alter locomotory behavior in systematic ways, thus providing key insights into command neuron function (<xref ref-type="bibr" rid="bib108">Zheng et al., 1999</xref>). The hyperpolarizing class (“HYP”) comprises three genotypes in which release of the excitatory neurotransmitter glutamate, presumed to be tonic, is disrupted by mutations that affect either presynaptic (<italic>eat-4(ad572), eat-4(ky5)</italic>) or postsynaptic mechanisms (<italic>glr-1(n2461)</italic>). These mutations are hypothesized to cause chronic hyperpolarization of the command neurons by reducing depolarizing currents. The depolarizing class (“DEP”) comprises two genotypes in which a constitutively activated glutamate receptor is expressed in the command neurons (<italic>glr-1::glr-1(A/T), nmr-1::glr-1(A/T)</italic>). These mutants are hypothesized to chronically depolarize the command neurons.</p><p>We found that the frequency of locomotory undulations was decreased in HYP mutants and increased in DEP mutants compared to wild-type controls (<xref ref-type="table" rid="tbl5">Table 5</xref>), consistent with the likely effects of respectively increasing and decreasing tonic drive to the presumptive pattern generator for locomotion. Importantly, however, it is possible that both classes of mutation also alter the input resistance of the command neurons. The closure or removal of glutamate receptors in HYP mutants should increase input resistance whereas the introduction of constitutively active glutamate receptors in DEP mutants should decrease it. Thus, the previously observed effects of these mutations on locomotory state transitions (<xref ref-type="bibr" rid="bib108">Zheng et al., 1999</xref>) could be the result of changes in membrane potential (Δ<italic>V</italic>), input resistance (Δ<italic>r</italic>), or both.<table-wrap id="tbl5" position="float"><object-id pub-id-type="doi">10.7554/eLife.12572.022</object-id><label>Table 5.</label><caption><p>Effects of mutations on mean undulation frequency, mean forward velocity and mean reverse velocity.Values were computed separately for each worm and are shown as mean ± sem (<italic>n</italic> = 25–31). Undulation frequency was estimated as one-half of the reciprocal of the time of the first local minimum in the heading autocorrelation function. All <italic>p</italic>-values are from two-tailed <italic>t</italic>-tests and are shown without correction for multiple comparisons. Blue denotes significance at <italic>p</italic>&lt;0.05. Red denotes significance at <italic>p</italic>&lt;0.05 after Bonferroni correction for 15 comparisons.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.022">http://dx.doi.org/10.7554/eLife.12572.022</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th/><th colspan="3">Undulation frequency (Hz)</th><th colspan="3">Forward velocity (μm/s)</th><th colspan="3">Reverse velocity (μm/s)</th></tr><tr><th>Genotype</th><th>Class</th><th>Wild type</th><th>Mutant</th><th><italic>p</italic> &lt;</th><th>Wild type</th><th>Mutant</th><th><italic>p</italic> &lt;</th><th>Wild type</th><th>Mutant</th><th><italic>p</italic> &lt;</th></tr></thead><tbody><tr><td><italic>eat-4(ad572)</italic></td><td>HYP A</td><td>0.272 ± 0.011</td><td>0.222 ± 0.007</td><td style="color: #FF0000;"><styled-content>4x10<sup>-4</sup></styled-content></td><td>156 ± 5</td><td>122 ± 4</td><td style="color: #FF0000;"><styled-content>1x10<sup>-5</sup></styled-content></td><td>-228 ± 5</td><td>-236 ± 9</td><td>0.5</td></tr><tr><td><italic>eat-4(ky5)</italic></td><td>HYP B</td><td>0.317 ± 0.011</td><td>0.256 ± 0.009</td><td style="color: #FF0000;"><styled-content>2x10<sup>-4</sup></styled-content></td><td>184 ± 7</td><td>143 ± 6</td><td style="color: #FF0000;"><styled-content>5x10<sup>-5</sup></styled-content></td><td>-262 ± 10</td><td>-271 ± 7</td><td>0.5</td></tr><tr><td><italic>glr-1(n2461)</italic></td><td>HYP C</td><td>0.294 ± 0.008</td><td>0.291 ± 0.010</td><td>0.9</td><td>158 ± 5</td><td>166 ± 6</td><td>0.3</td><td>-236 ± 6</td><td>-236 ± 5</td><td>1</td></tr><tr><td><italic>glr-1::glr-1(A/T)</italic></td><td>DEP A</td><td>0.272 ± 0.011</td><td>0.642 ± 0.029</td><td style="color: #FF0000;"><styled-content>6x10<sup>-13</sup></styled-content></td><td>156 ± 5</td><td>112 ± 5</td><td style="color: #FF0000;"><styled-content>3x10<sup>-7</sup></styled-content></td><td>-228 ± 5</td><td>-143 ± 5</td><td style="color: #FF0000;"><styled-content>2x10<sup>-15</sup></styled-content></td></tr><tr><td><italic>nmr-1::glr-1(A/T)</italic></td><td>DEP B</td><td>0.294 ± 0.008</td><td>0.695 ± 0.037</td><td style="color: #FF0000;"><styled-content>2x10<sup>-12</sup></styled-content></td><td>158 ± 5</td><td>138 ± 5</td><td style="color: #33CCCC;"><styled-content>0.011</styled-content></td><td>-236 ± 6</td><td>-144 ± 5</td><td style="color: #FF0000;"><styled-content>7x10<sup>-15</sup></styled-content></td></tr></tbody></table></table-wrap></p><p>Changes in membrane potential and input resistance can both be represented in the stochastic switch model by changes in synaptic weights. We modeled the effects of Δ<italic>V</italic> by adding an increment <inline-formula><mml:math id="inf229"><mml:mo>∆</mml:mo><mml:mi>h</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf230"><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mo>∆</mml:mo><mml:mi>h</mml:mi><mml:mo>≤</mml:mo></mml:math></inline-formula> 1) to wild type <inline-formula><mml:math id="inf231"><mml:mi>h</mml:mi></mml:math></inline-formula> values, with negative <inline-formula><mml:math id="inf232"><mml:mo>∆</mml:mo><mml:mi>h</mml:mi></mml:math></inline-formula> for HYP mutations and positive <inline-formula><mml:math id="inf233"><mml:mo>∆</mml:mo><mml:mi>h</mml:mi></mml:math></inline-formula> for DEP mutations. We modeled the effect of Δr as a change in the magnitude of synaptic weights (<inline-formula><mml:math id="inf234"><mml:mi>h</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf235"><mml:mi>w</mml:mi></mml:math></inline-formula> quantities). This representation of Δr is appropriate because changes in input resistance alter the magnitude of the voltage change that would be produced by a fixed postsynaptic current. All weights were scaled by a common factor <inline-formula><mml:math id="inf236"><mml:mi>z</mml:mi></mml:math></inline-formula> (1 &lt; <inline-formula><mml:math id="inf237"><mml:mi>z</mml:mi></mml:math></inline-formula> &lt; 2 for HYP mutants; 0 &lt; <inline-formula><mml:math id="inf238"><mml:mi>z</mml:mi></mml:math></inline-formula> &lt; 1 for DEP mutants).</p><p>Here we consider the effects of Δ<italic>V</italic> and Δ<italic>r</italic> on dwell times in the stochastic switch model to enable direct comparison with the original study of HYP and DEP strains (<xref ref-type="bibr" rid="bib108">Zheng et al., 1999</xref>). Dwell times can be written as functions of weights:</p><p><disp-formula id="equ2"><label>(1)</label><mml:math id="m2"><mml:msub><mml:mi>d</mml:mi><mml:mtext>X</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mfenced><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>XF</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>XR</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mi>A</mml:mi><mml:mo> </mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>A</mml:mi><mml:mo> </mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo></mml:math></disp-formula></p><p><disp-formula id="equ3"><label>(2)</label><mml:math id="m3"><mml:msub><mml:mi>d</mml:mi><mml:mtext>F</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mfenced><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>FX</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>FY</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mi>A</mml:mi><mml:mo> </mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>A</mml:mi><mml:mo> </mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo></mml:math></disp-formula></p><p><disp-formula id="equ4"><label>(3)</label><mml:math id="m4"><mml:msub><mml:mi>d</mml:mi><mml:mtext>R</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mfenced><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>RX</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>RY</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mi>A</mml:mi><mml:mo> </mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>A</mml:mi><mml:mo> </mml:mo><mml:mi>e</mml:mi><mml:mi>xp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo></mml:math></disp-formula></p><p><disp-formula id="equ5"><label>(4)</label><mml:math id="m5"><mml:msub><mml:mi>d</mml:mi><mml:mtext>Y</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mfenced><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>YR</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>YF</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mi>A</mml:mi><mml:mo> </mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>A</mml:mi><mml:mo> </mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></disp-formula></p><p>These equations show that the Δ<italic>V</italic> and Δ<italic>r</italic> hypotheses make qualitatively distinct predictions. The simplest case is dwell <inline-formula><mml:math id="inf239"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>X</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>, which depends only on <inline-formula><mml:math id="inf240"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mo/></mml:mrow></mml:math></inline-formula>and <inline-formula><mml:math id="inf241"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. <xref ref-type="disp-formula" rid="equ2">Equation 1</xref> shows that <inline-formula><mml:math id="inf242"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>X</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> rises and falls as <inline-formula><mml:math id="inf243"><mml:mi>h</mml:mi></mml:math></inline-formula> terms are made more negative or positive, respectively. Thus, under the Δ<italic>V</italic> hypothesis, <inline-formula><mml:math id="inf244"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>X</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> should rise in HYP mutants and fall in DEP mutants (<xref ref-type="fig" rid="fig7">Figure 7A</xref>, row 4). In contrast, under the Δ<italic>r</italic> hypothesis, in which weight magnitudes (<inline-formula><mml:math id="inf245"><mml:mfenced close="|" open="|"><mml:mi>w</mml:mi></mml:mfenced></mml:math></inline-formula> and <inline-formula><mml:math id="inf246"><mml:mfenced close="|" open="|"><mml:mi>h</mml:mi></mml:mfenced></mml:math></inline-formula>) decrease in DEP mutants and increase in HYP mutants, <inline-formula><mml:math id="inf247"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>X</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> should rise in DEP mutants and fall in HYP. To distinguish between these hypotheses, we measured dwell times in mutants and wild type animals during local search. The pattern of observed changes in <inline-formula><mml:math id="inf248"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>X</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> matched the pattern predicted by the Δ<italic>V</italic> hypothesis but not the Δ<italic>r</italic> hypothesis (<xref ref-type="fig" rid="fig7">Figure 7C</xref>, row 4). Thus, the effects of membrane potential appear to dominate the effects of changes in synaptic strength in the case of mutant values of <inline-formula><mml:math id="inf249"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>X</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>.<fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.12572.023</object-id><label>Figure 7.</label><caption><title>Predicted and observed effects of HYP and DEP mutations on dwell times.</title><p>(<bold>A</bold>) Predicted effects of changes in membrane potential. (<bold>B</bold> ) Predicted effects of changes in input resistance. (<bold>C</bold>) Dwell times in F, R, and P for cohorts of HYP mutants, DEP mutants, and wild type animals. Stars indicate significant change in dwell time (<italic>p</italic>&lt;0.05 without (<inline-formula><mml:math id="inf250"><mml:mo>⋆</mml:mo></mml:math></inline-formula>) or with (<inline-formula><mml:math id="inf251"><mml:mrow><mml:mo>⋆</mml:mo><mml:mo>⋆</mml:mo></mml:mrow></mml:math></inline-formula>) correction for multiple comparisons; <xref ref-type="table" rid="tbl6">Table 6</xref>). In <bold>A-C</bold> wild type dwell times are indicated by gray bars. Horizontal lines indicate the estimated range of <inline-formula><mml:math id="inf252"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, the dwell time in the uncoupled state. In the Δ<italic>V</italic> model, <inline-formula><mml:math id="inf253"><mml:mi>h</mml:mi></mml:math></inline-formula> terms were made more negative to model HYP mutants and more positive to model DEP mutants by subtracting or adding a constant <inline-formula><mml:math id="inf254"><mml:mo>∆</mml:mo><mml:mi>h</mml:mi></mml:math></inline-formula> = 0.6; qualitatively similar results were obtained for 0 &lt; <inline-formula><mml:math id="inf255"><mml:mo>∆</mml:mo><mml:mi>h</mml:mi></mml:math></inline-formula> ≤ 0.8. In the Δ<italic>r</italic> model, <inline-formula><mml:math id="inf256"><mml:mi>h</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf257"><mml:mi>w</mml:mi></mml:math></inline-formula> terms were scaled by (1 + <italic>f</italic>) to model HYP mutants and by (1 - <italic>f</italic>) to model DEP mutants, with <italic>f</italic> = 0.6; qualitatively similar results were obtained for 0 &lt; <italic>f</italic> ≤ 1. Strains, <italic>HYP A</italic>: DA572 <italic>eat-4(ad572); HYP B</italic>: MT6308 <italic>eat-4(ky5); HYP C</italic>: KP4 <italic>glr-1(n2461); DEP A</italic>: VM1136 <italic>lin-15(n765); akIs9 [lin-15(+), Pglr-1::GLR-1(A/T)]; DEP B</italic>: VM188 <italic>lin-15(n765); akEx52[lin-15(+), Pnmr-1::GLR-1(A/T)].</italic></p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.023">http://dx.doi.org/10.7554/eLife.12572.023</ext-link></p></caption><graphic xlink:href="elife-12572-fig7-v2"/></fig><table-wrap id="tbl6" position="float"><object-id pub-id-type="doi">10.7554/eLife.12572.024</object-id><label>Table 6.</label><caption><p>Effects of mutations on model parameters. Significance was determined using the likelihood ratio test as described in <xref ref-type="table" rid="tbl4">Table 4</xref>. The sign of the change (Δ) caused by the mutation is shown as “+” if the value moved away from 0, “–” if the value moved towards 0. All <italic>p</italic>-values are shown without correction for multiple comparisons. Blue denotes significance at p&lt;0.05. Red denotes significance at p&lt;0.05 after Bonferroni correction for 27 comparisons.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.024">http://dx.doi.org/10.7554/eLife.12572.024</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="3"/><th colspan="12">HYP</th><th colspan="8">DEP</th></tr><tr><th colspan="4">HYP A: <italic>eat-4(ad572)</italic></th><th colspan="4">HYP B: <italic>eat-4(ky5)</italic></th><th colspan="4">HYP C: <italic>glr-1(n2461)</italic></th><th colspan="4">DEP A: <italic>glr-1::glr-1(A/T)</italic></th><th colspan="4">DEP B: <italic>nmr-1::glr-1(A/T)</italic></th></tr><tr><th>Control</th><th>Mutant</th><th><inline-formula><mml:math id="inf258"><mml:mo>∆</mml:mo></mml:math></inline-formula></th><th><italic>p</italic> &lt;</th><th>Control</th><th>Mutant</th><th>∆</th><th>p&lt;</th><th>Control</th><th>Mutant</th><th>∆</th><th>p&lt;</th><th>Control</th><th>Mutant</th><th>∆</th><th>p&lt;</th><th>Control</th><th>Mutant</th><th>∆</th><th>p&lt;</th></tr></thead><tbody><tr><td><inline-formula><mml:math id="inf260"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> (s)</td><td>4.771</td><td>9.564</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-87</sup></styled-content></td><td>4.956</td><td>8.643</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-64</sup></styled-content></td><td>5.181</td><td>7.871</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-33</sup></styled-content></td><td>4.771</td><td>0.940</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-99</sup></styled-content></td><td>5.181</td><td>0.742</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-99</sup></styled-content></td></tr><tr><td><inline-formula><mml:math id="inf262"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> (s)</td><td>2.043</td><td>2.821</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-7</sup></styled-content></td><td>1.910</td><td>2.769</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-12</sup></styled-content></td><td>2.018</td><td>3.004</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-16</sup></styled-content></td><td>2.045</td><td>0.875</td><td>–</td><td style="background: #FFFFFF; color: #FF0000;"><styled-content>10<sup>-99</sup></styled-content></td><td>2.018</td><td>0.709</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-9</sup></styled-content> <sup>9</sup></td></tr><tr><td><inline-formula><mml:math id="inf264"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>X</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> (s)</td><td>0.481</td><td>1.040</td><td>+</td><td style="color: #33CCCC;"><styled-content>0.005</styled-content></td><td>0.529</td><td>0.844</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-43</sup></styled-content></td><td>0.459</td><td>0.727</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-39</sup></styled-content></td><td>0.482</td><td>0.328</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-49</sup></styled-content></td><td>0.460</td><td>0.235</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-99</sup></styled-content></td></tr><tr><td><inline-formula><mml:math id="inf266"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>Y</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> (s)</td><td>0.247</td><td>0.382</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-5</sup></styled-content></td><td>0.238</td><td>0.290</td><td>+</td><td style="color: #33CCCC;"><styled-content>0.005</styled-content></td><td>0.221</td><td>0.164</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-5</sup></styled-content></td><td>0.247</td><td>0.097</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-93</sup></styled-content></td><td>0.221</td><td>0.079</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-99</sup></styled-content></td></tr><tr><td><inline-formula><mml:math id="inf268"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>P</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> (s)</td><td>0.428</td><td>0.982</td><td>+</td><td><styled-content>10<sup>-99</sup></styled-content></td><td>0.466</td><td>0.793</td><td>+</td><td><styled-content>10<sup>-52</sup></styled-content></td><td>0.409</td><td>0.677</td><td>+</td><td><styled-content>10<sup>-43</sup></styled-content></td><td>0.428</td><td>0.286</td><td>–</td><td><styled-content>10<sup>-61</sup></styled-content></td><td>0.409</td><td>0.204</td><td>–</td><td><styled-content>10<sup>-99</sup></styled-content></td></tr><tr><td><inline-formula><mml:math id="inf270"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td>0.729</td><td>0.839</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-27</sup></styled-content></td><td>0.734</td><td>0.832</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-26</sup></styled-content></td><td>0.755</td><td>0.785</td><td>+</td><td style="color: #33CCCC;"><styled-content>0.003</styled-content></td><td>0.728</td><td>0.410</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-99</sup></styled-content></td><td>0.755</td><td>0.407</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-99</sup></styled-content></td></tr><tr><td><inline-formula><mml:math id="inf272"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td>0.177</td><td>0.062</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-37</sup></styled-content></td><td>0.167</td><td>0.079</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-29</sup></styled-content></td><td>0.161</td><td>0.135</td><td>–</td><td style="color: #FF0000;"><styled-content>10<sup>-4</sup></styled-content></td><td>0.177</td><td>0.389</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-99</sup></styled-content></td><td>0.161</td><td>0.404</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-99</sup></styled-content></td></tr><tr><td><inline-formula><mml:math id="inf274"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>X</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td>0.073</td><td>0.090</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-5</sup></styled-content></td><td>0.077</td><td>0.081</td><td>+</td><td>0.3</td><td>0.067</td><td>0.073</td><td>+</td><td style="color: #33CCCC;"><styled-content>0.03</styled-content></td><td>0.073</td><td>0.164</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-99</sup></styled-content></td><td>0.067</td><td>0.151</td><td>+</td><td style="color: #FF0000;"><styled-content>10<sup>-99</sup></styled-content></td></tr><tr><td><inline-formula><mml:math id="inf276"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>Y</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula></td><td>0.022</td><td>0.009</td><td>–</td><td><styled-content>10<sup>-13</sup></styled-content></td><td>0.021</td><td>0.008</td><td>–</td><td><styled-content>10<sup>-25</sup></styled-content></td><td>0.018</td><td>0.007</td><td>–</td><td><styled-content>10<sup>-27</sup></styled-content></td><td>0.022</td><td>0.037</td><td>+</td><td><styled-content>10<sup>-21</sup></styled-content></td><td>0.018</td><td>0.037</td><td>+</td><td><styled-content>10<sup>-41</sup></styled-content></td></tr></tbody></table></table-wrap></p><p>In contrast to <inline-formula><mml:math id="inf278"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>X</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf279"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf280"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>R</mml:mtext></mml:msub><mml:mo/></mml:mrow></mml:math></inline-formula> depend on <inline-formula><mml:math id="inf281"><mml:mi>w</mml:mi></mml:math></inline-formula> terms as well as <inline-formula><mml:math id="inf282"><mml:mi>h</mml:mi></mml:math></inline-formula> terms. Under the Δ<italic>V</italic> hypothesis, the <inline-formula><mml:math id="inf283"><mml:mi>h</mml:mi></mml:math></inline-formula> terms but not the <inline-formula><mml:math id="inf284"><mml:mi>w</mml:mi></mml:math></inline-formula> terms would be affected by the mutations. Positive and negative increments in <inline-formula><mml:math id="inf285"><mml:mi>h</mml:mi></mml:math></inline-formula> have the effects shown in <xref ref-type="fig" rid="fig7">Figure 7A</xref>, rows 1 and 2; <inline-formula><mml:math id="inf286"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf287"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> are predicted to shift in opposite directions. Changes in <inline-formula><mml:math id="inf288"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> are dominated by the effects of <inline-formula><mml:math id="inf289"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> on the first term in <xref ref-type="disp-formula" rid="equ3">Equation 2</xref> (which represents <inline-formula><mml:math id="inf290"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>FX</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) because the second term in the equation (which represents <inline-formula><mml:math id="inf291"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>FY</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) remains close to zero in the mutants. Analogously, changes in <inline-formula><mml:math id="inf292"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>R</mml:mtext></mml:msub><mml:mo/></mml:mrow></mml:math></inline-formula> are dominated by the effects of <inline-formula><mml:math id="inf293"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> on the second term in <xref ref-type="disp-formula" rid="equ4">Equation 3</xref> (<inline-formula><mml:math id="inf294"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>RY</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) because the first term in the equation (<inline-formula><mml:math id="inf295"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>RX</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) remains close to zero in the mutants.</p><p>The Δ<italic>r</italic> hypothesis makes a distinctly different prediction. In this version of the model, <inline-formula><mml:math id="inf296"><mml:mi>w</mml:mi></mml:math></inline-formula> terms and <inline-formula><mml:math id="inf297"><mml:mi>h</mml:mi></mml:math></inline-formula> terms would both be affected by the mutations. Now, the predicted pattern of dwell time changes across both <inline-formula><mml:math id="inf298"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf299"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> is such the both dwell times shift in the same direction (<xref ref-type="fig" rid="fig7">Figure 7B</xref>, rows 1 and 2); specifically, dwell times in DEP and HYP mutants move toward or away from their uncoupled dwell times, respectively. Taken together, the pattern of observed changes in <inline-formula><mml:math id="inf300"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf301"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> matched the pattern predicted by the Δ<italic>r</italic> hypothesis (<xref ref-type="fig" rid="fig7">Figure 7C</xref>, rows 1 and 2) but not the Δ<italic>V</italic> hypothesis. We conclude that changes in synaptic strength may dominate the effects of changes in membrane potential on mutant values of <inline-formula><mml:math id="inf302"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf303"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>.</p><p>Neither hypothesis predicts the observed changes in <inline-formula><mml:math id="inf304"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>Y</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig7">Figure 7C</xref>, row 5) which resembled the pattern of changes in <inline-formula><mml:math id="inf305"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>X</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig7">Figure 7C</xref>, row 4). However, the Δ<italic>V</italic> hypothesis correctly predicts observed dwell times in the overall pause state <inline-formula><mml:math id="inf306"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>P</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig7">Figure 7C</xref> row 3). This is because <inline-formula><mml:math id="inf307"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>P</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> is dominated by <inline-formula><mml:math id="inf308"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>X</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> and changes in <inline-formula><mml:math id="inf309"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>X</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> are well-predicted by the Δ<italic>V</italic> model as noted above. Overall, our analysis of the effects of HYP and DEP mutations in terms of the Stochastic Switch Model points to a role for changes in both membrane potential and input resistance in regulating dwell times.</p></sec><sec id="s2-7"><title>Regulation of search scale</title><p>The Stochastic Switch Model immediately suggests a family of models for the regulation of the spatial scale of random search in response to the availability of food and the worm’s physiological state. The scale of random search is determined primarily by <inline-formula><mml:math id="inf310"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>, the mean distance traveled during a forward run. In <italic>C. elegans</italic>, a run begins with a transition from state R (via P) into state F and continues until the next transition into state R. Any run may include one or more visits to state P, but FPF transitions are not usually associated with changes in heading. In terms of the Stochastic Switch Model, <inline-formula><mml:math id="inf311"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mo/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo/><mml:msub><mml:mi>p</mml:mi><mml:mtext>F</mml:mtext></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mtext>RPF</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf312"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo/></mml:mrow></mml:math></inline-formula> is the average velocity in state F, <inline-formula><mml:math id="inf313"><mml:mrow><mml:mo/><mml:msub><mml:mi>p</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> is the probability of being in state F, and <inline-formula><mml:math id="inf314"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mtext>RPF</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the frequency of RPF transitions (Materials and methods, <xref ref-type="disp-formula" rid="equ40">Equation 39</xref>), which coincide with random reorientations. Importantly, under the approximation <inline-formula><mml:math id="inf315"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>FY</mml:mtext></mml:mrow></mml:msub><mml:mo>≅</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="table" rid="tbl1">Table 1</xref>, column A), <inline-formula><mml:math id="inf316"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> is can be expressed as a function of just three of the six weights in the network:</p><p><disp-formula id="equ6"><label>(5)</label><mml:math id="m6"><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub><mml:mo>≅</mml:mo><mml:mover accent="true"><mml:mfrac><mml:msub><mml:mi>v</mml:mi><mml:mtext>F</mml:mtext></mml:msub><mml:mi>A</mml:mi></mml:mfrac><mml:mo>¯</mml:mo></mml:mover><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>We refer to these weights as potential control points in the network. In a minimal model of search scale regulation, <inline-formula><mml:math id="inf317"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> could be controlled by sensory inputs represented by <inline-formula><mml:math id="inf318"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf319"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig8">Figure 8A</xref>).<fig-group><fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.12572.025</object-id><label>Figure 8.</label><caption><title>The Stochastic Switch Model accounts for the three main modes of random search in <italic>C. elegans</italic>.</title><p>(<bold>A</bold>) Plot of mean forward run length versus the weights <inline-formula><mml:math id="inf320"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf321"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, illustrating a minimal model of search-scale regulation. (<bold>B-H</bold>) Calculated effects on search mode of the weights indicated in parentheses. The frequency of reversals (<inline-formula><mml:math id="inf322"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mtext>FPR</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) is plotted against <inline-formula><mml:math id="inf323"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> while these three weights are scanned from -6 to 6 weight units in steps of 0.4. Each point was categorized as cropping (magenta), local search (green), ranging (blue), or indeterminate (grey) according to value of <inline-formula><mml:math id="inf324"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mtext>FPR</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf325"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>, and whether or not the associated value of <inline-formula><mml:math id="inf326"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> (not shown) indicated a short or long reversal; see Materials and methods for definitions of search modes. Yellow diamonds mark the scanned points modeled in <xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref>. <inline-formula><mml:math id="inf327"><mml:mi>A</mml:mi></mml:math></inline-formula> = 1 Hz; similar results were obtained for <inline-formula><mml:math id="inf328"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf329"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (<xref ref-type="table" rid="tbl7">Table 7</xref>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.025">http://dx.doi.org/10.7554/eLife.12572.025</ext-link></p></caption><graphic xlink:href="elife-12572-fig8-v2"/></fig><fig id="fig8s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.12572.026</object-id><label>Figure 8—figure supplement 1.</label><caption><title>Simulated worm tracks illustrating cropping, local search, and ranging as defined in the model.</title><p>( <bold>A-C</bold> ) Simulated time is 600 sec with four replicated per panel, each in a different color. <inline-formula><mml:math id="inf330"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>; similar results were obtained for <inline-formula><mml:math id="inf331"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.026">http://dx.doi.org/10.7554/eLife.12572.026</ext-link></p></caption><graphic xlink:href="elife-12572-fig8-figsupp1-v2"/></fig><fig id="fig8s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.12572.027</object-id><label>Figure 8—figure supplement 2.</label><caption><title>Extension of the Stochastic Switch Model to chemotaxis.</title><p>(<bold>A</bold>) Circuitry. Behavioral state (F, R, or P) was determined by a modified version of the Stochastic Switch Model in which on and off chemosensory neurons regulated the values of the inputs to the network. During movement up the gradient, the activation states of the on and off cells were set to 1 and 0, respectively, such that <inline-formula><mml:math id="inf332"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>∆</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf333"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mo>∆</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:math></inline-formula>, where <inline-formula><mml:math id="inf334"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf335"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are the values of the inputs to the network during local search (<xref ref-type="table" rid="tbl2">Table 2</xref>). Conversely, during movement down the gradient, the on and off activation states, and the signs of <inline-formula><mml:math id="inf336"><mml:mo>∆</mml:mo><mml:mi>h</mml:mi></mml:math></inline-formula>, were reversed. In the tracks shown, <inline-formula><mml:math id="inf337"><mml:mo>∆</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf338"><mml:mo>∆</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:math></inline-formula> were <inline-formula><mml:math id="inf339"><mml:mo>±</mml:mo></mml:math></inline-formula> 2.6, the value that optimized chemotaxis performance given the speed of the model worm and standard deviation of the gradient. (<bold>B</bold>) Simulated chemotaxis. The concentration gradient of chemical attractant was modeled as a two dimensional Gaussian (std. dev. = 1.6 cm) originating at the center of a circular arena. Similar tracks were obtained across the full range of values of <italic>A</italic>, the fundamental time scale of the model.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.027">http://dx.doi.org/10.7554/eLife.12572.027</ext-link></p></caption><graphic xlink:href="elife-12572-fig8-figsupp2-v2"/></fig></fig-group></p><p>Search scale (<inline-formula><mml:math id="inf340"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>) together with the frequency of reversals (FPR transitions), have been used to define the three search modes commonly recognized in <italic>C. elegans</italic>: cropping, local search, and ranging. To find minimal models for regulation of search mode, we performed exhaustive searches of subregions of network’s six-dimensional weight space. Subspaces, defined by one, two, or three weights, were scanned across a wide range of values (-6 ≤ <inline-formula><mml:math id="inf341"><mml:mi>w</mml:mi></mml:math></inline-formula> ≤ 6) while other weights remained fixed at their wild type levels (<xref ref-type="fig" rid="fig7">Figure 7B–H</xref>). The performance of each configuration of the network was scored according to whether it matched the range of <inline-formula><mml:math id="inf342"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> magnitudes and reversal frequencies characteristic of each mode (see Materials and methods). Another consideration was the number of distinct search modes available; accordingly, we also noted the density with which the plane defined by reversal frequency and <inline-formula><mml:math id="inf343"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> was covered in the scan (Figure. 8B-H, gray symbols).</p><p>All three search modes were available in the subspace defined by the control points <inline-formula><mml:math id="inf344"><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo/><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig8">Figure 8B</xref>, <xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref>). However, only cropping and local search were available in the complementary subspace <inline-formula><mml:math id="inf345"><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo/><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig8">Figure 8C</xref>); thus, to achieve the full set of search modes, at least one of the weights in <xref ref-type="disp-formula" rid="equ6">equation 5</xref> must be free to change. None of the control-point weights was sufficient on its own to produce all three search modes (<xref ref-type="fig" rid="fig8">Figure 8D–F</xref>). Scanning the subspaces <inline-formula><mml:math id="inf346"><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf347"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf348"><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf349"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> showed these pairs of weights to be sufficient for all modes (<xref ref-type="fig" rid="fig8">Figure 8G,H</xref>), but a three-dimensional subspace containing at least one of the control-point weights was a necessary condition for both dense coverage of this plane and the presence of all three search modes (<xref ref-type="table" rid="tbl7">Table 7</xref>). We suggest that these three-weight subspaces constitute the most likely minimal models for the regulation of search in <italic>C. elegans</italic>. They could be tested by chronic manipulation of control-point weights utilizing a variety of approaches, such as chemical or optical probes that alter tonic inputs to the command network from sensory neurons and interneurons represented by the parameters <inline-formula><mml:math id="inf350"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf351"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:math></inline-formula>.<table-wrap id="tbl7" position="float"><object-id pub-id-type="doi">10.7554/eLife.12572.028</object-id><label>Table 7.</label><caption><p>Regulation of search mode. The weights in each subspace were scanned from -6 to 6 weight units in steps of 0.4 with <inline-formula><mml:math id="inf352"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf353"><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mtext>max</mml:mtext></mml:msub></mml:math></inline-formula>. The letter x means that the indicated search mode was present for at least one point in the subspace when <inline-formula><mml:math id="inf354"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and when <inline-formula><mml:math id="inf355"><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mtext>max</mml:mtext></mml:msub></mml:math></inline-formula>; the letters y and z mean that the mode was present only when <inline-formula><mml:math id="inf356"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf357"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, respectively. See Materials and methods for definitions of search modes. Control-point weights as defined by the theoretical relationship between weights and search scale (<xref ref-type="disp-formula" rid="equ6">Equation 5</xref>) are shown in bold. Only the three-weight subspaces are sufficient for producing all three search modes and full coverage of the plane defined by reversal frequency and <inline-formula><mml:math id="inf358"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> plane as shown in <xref ref-type="fig" rid="fig8">Figure 8</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.028">http://dx.doi.org/10.7554/eLife.12572.028</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="center"><p>Subspace</p></th><th align="center" style="color: #FF00FF;"><p><styled-content>Cropping</styled-content></p> </th><th align="center" style="color: #00FF00;"><p><styled-content>Dwelling</styled-content></p> </th><th align="center" style="color: #0000FF;"><p><styled-content>Ranging</styled-content></p> </th><th align="center"><p><bold>Coverage</bold></p> </th></tr></thead><tbody><tr><td align="center"><p><inline-formula><mml:math id="inf359"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"> </td><td align="center"><bold>⋅ ⋅ ⋅</bold> <break/></td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf361"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center"><bold>⋅ ⋅ ⋅</bold></td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf363"><mml:msub><mml:mi>w</mml:mi><mml:mi>FF</mml:mi></mml:msub></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center"><bold>⋅ ⋅ ⋅</bold></td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf365"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"> </td><td align="center">. . .</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf367"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"> </td><td align="center">. . .</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf369"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"> </td><td align="center">. . .</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf371"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf373"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"><p><styled-content>y</styled-content></p> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">. . .</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf375"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf377"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">. . .</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf379"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf381"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">. . .</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf383"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf385"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">. . .</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf387"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf389"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">. . .</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf391"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf393"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">. . .</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf395"><mml:msub><mml:mi>w</mml:mi><mml:mi>FF</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf397"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">. . .</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf399"><mml:msub><mml:mi>w</mml:mi><mml:mi>FF</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf401"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">. . .</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf403"><mml:msub><mml:mi>w</mml:mi><mml:mi>FF</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf405"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">. . .</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf407"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf409"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">. . .</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf411"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf413"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">. . .</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf415"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf417"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">. . .</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf419"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf421"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"> </td><td align="center">.......</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf423"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf425"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"> </td><td align="center" style="color: #00FF00;"><p><styled-content>y</styled-content></p> </td><td align="center" style="color: #0000FF;"> </td><td align="center">. . .</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf427"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf429"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"> </td><td align="center">.......</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf431"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf433"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf435"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">.......</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf437"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf439"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf441"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">.......</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf443"><mml:msub><mml:mi>w</mml:mi><mml:mi>FF</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf445"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf447"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">.......</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf449"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf451"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf453"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">.......</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf455"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf457"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf459"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">.......</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf461"><mml:msub><mml:mi>w</mml:mi><mml:mi>FF</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf463"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf465"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">.......</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf467"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf469"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf471"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">.......</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf473"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf475"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf477"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"><p><styled-content>z</styled-content></p> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">.......</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf479"><mml:msub><mml:mi>w</mml:mi><mml:mi>FF</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf481"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf483"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">.......</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf485"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf487"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf489"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">.......</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf491"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf493"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf495"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">.......</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf497"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf499"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf501"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">.......</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf503"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf505"><mml:msub><mml:mi>w</mml:mi><mml:mi>FF</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf507"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">.......</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf509"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf511"><mml:msub><mml:mi>w</mml:mi><mml:mi>FF</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf513"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">.......</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf515"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf517"><mml:msub><mml:mi>w</mml:mi><mml:mi>FF</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf519"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">.......</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf521"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf523"><mml:msub><mml:mi>w</mml:mi><mml:mi>FF</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf525"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">.......</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf527"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf529"><mml:msub><mml:mi>w</mml:mi><mml:mi>FF</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf531"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">.......</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf533"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf535"><mml:msub><mml:mi>w</mml:mi><mml:mi>FF</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf537"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"><p><styled-content>y</styled-content></p> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">.......</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf539"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf541"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf543"><mml:msub><mml:mi>w</mml:mi><mml:mi>FF</mml:mi></mml:msub></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"><p><styled-content>x</styled-content></p> </td><td align="center">.......</td></tr><tr><td align="center"><p><inline-formula><mml:math id="inf545"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf547"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf549"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td align="center" style="color: #FF00FF;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #00FF00;"><p><styled-content>x</styled-content></p> </td><td align="center" style="color: #0000FF;"> </td><td align="center">.......</td></tr></tbody></table></table-wrap></p></sec><sec id="s2-8"><title>Biased random walks</title><p>Mean forward run length is also modulated during biased random walks, increasing or decreasing when the animal is moving in a favorable or unfavorable direction, respectively (<xref ref-type="bibr" rid="bib65">Pierce-Shimomura et al., 1999</xref>; <xref ref-type="bibr" rid="bib8">Block et al., 1982</xref>; <xref ref-type="bibr" rid="bib44">Iino and Yoshida, 2009</xref>; <xref ref-type="bibr" rid="bib58">Luo et al., 2014</xref>). When <italic>C. elegans</italic> is engaged in chemotaxis toward an attractive substance, the direction of motion relative to the gradient is represented by specialized chemosensory neurons that respond either to increases (ON cells) or decreases in concentration (OFF cells) (<xref ref-type="bibr" rid="bib94">Thiele et al., 2009</xref>) ; moreover, interventions that activate ON cells or OFF cells promote runs and pirouettes, respectively (<xref ref-type="bibr" rid="bib93">Suzuki et al., 2008</xref>). Thus, in one simple model of random-walk chemotaxis, ON cells increase <inline-formula><mml:math id="inf551"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:math></inline-formula> and decrease <inline-formula><mml:math id="inf552"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:math></inline-formula>, whereas OFF cells do the opposite. Simulations show that this model is sufficient to generate realistic chemotaxis in a point model of search behavior in <italic>C. elegans</italic> (<xref ref-type="fig" rid="fig8s2">Figure 8—figure supplement 2</xref>) when the worm is below the target concentration of attractant. Similar circuitry can explain biased random walks in response to other physical gradients (<xref ref-type="bibr" rid="bib57">Lockery, 2011</xref>).</p></sec><sec id="s2-9"><title>The Stochastic Switch Model and deterministic behaviors</title><p>In addition to random search, the command neurons in <italic>C. elegans</italic> are required for a variety of escape responses (<xref ref-type="bibr" rid="bib36">Hart et al., 1995</xref>) that are deterministic in that <inline-formula><mml:math id="inf553"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> closely approaches unity for strong stimuli (<xref ref-type="bibr" rid="bib105">Wittenburg and Baumeister, 1999</xref>; <xref ref-type="bibr" rid="bib95">Tobin et al., 2002</xref>; <xref ref-type="bibr" rid="bib53">Liu et al., 2012</xref>; <xref ref-type="bibr" rid="bib62">Mohammadi et al., 2013</xref>). <italic>C. elegans</italic> escape responses can be produced by two pathways, one that requires the reverse command neurons (<xref ref-type="bibr" rid="bib17">Chalfie et al., 1985</xref>) and one that does not (<xref ref-type="bibr" rid="bib66">Piggott et al., 2011</xref>). Three distinct circuit motifs for the functional connectivity underlying escape responses requiring reverse command neurons are conceivable (<xref ref-type="fig" rid="fig9">Figure 9A</xref>). In the Push motif, nociceptive neurons excite reverse command neurons via <inline-formula><mml:math id="inf554"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> thereby increasing the rate constants for transitions in which <inline-formula><mml:math id="inf555"><mml:mi>ℛ</mml:mi></mml:math></inline-formula> turns ON (<inline-formula><mml:math id="inf556"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>XR</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf557"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>FY</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>), and decreasing the rate constants for transitions in which <inline-formula><mml:math id="inf558"><mml:mi>ℛ</mml:mi></mml:math></inline-formula> turns OFF (<inline-formula><mml:math id="inf559"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>RX</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf560"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>YF</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>). In the limit where <inline-formula><mml:math id="inf561"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>→ ∞, both <inline-formula><mml:math id="inf562"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>XR</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf563"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>FY</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>→ ∞, whereas <inline-formula><mml:math id="inf564"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>RX</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf565"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>YF</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>→ 0 (<xref ref-type="fig" rid="fig9">Figure 9B</xref>). The system now inhabits only states R and Y, and <inline-formula><mml:math id="inf566"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>R</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>YR</mml:mtext></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>YR</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>RY</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. In the Pull motif, nociceptive neurons inhibit the forward command neurons via <inline-formula><mml:math id="inf567"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. In the limit where <inline-formula><mml:math id="inf568"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>→ -∞, the system switches only between states R and X and <inline-formula><mml:math id="inf569"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>R</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>XR</mml:mtext></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>XR</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>RX</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. In the third motif, in which Push and Pull are combined, R becomes an absorbing state (<inline-formula><mml:math id="inf570"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>R</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>. Using the rate constants shown in column A of <xref ref-type="table" rid="tbl1">Table 1</xref> to compute limiting values of <inline-formula><mml:math id="inf571"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> in each motif, we found that the Pull and Push-Pull motifs are sufficient for deterministic escape, whereas the Push motif is not (<xref ref-type="fig" rid="fig9">Figure 9B</xref>). Thus, inhibition of forward command neurons is required for deterministic escape, predicting that nociceptive neurons functionally inhibit these neurons.<fig id="fig9" position="float"><object-id pub-id-type="doi">10.7554/eLife.12572.029</object-id><label>Figure 9.</label><caption><title>Extension of the Stochastic Switch Model to deterministic behaviors.</title><p>(<bold>A</bold>) Three functional circuit motifs for deterministic escape behavior initiated by the nociceptive neuron ASH. (<bold>B</bold>) Predicted steady-state probability of reversal behavior in the resting state and the activated state of the three motifs shown in <bold>A</bold>. Plotted values are means across the five wild type cohorts shown in <xref ref-type="fig" rid="fig1">Figure 1F</xref>. Error bars are ± sem. Numbers in parenthesis are predicted mean first latency to a reversal response. (<bold>C</bold>) <italic>Left</italic>, synaptic current in AVB when ASH was photoactivated (blue line). <italic>Right</italic>, mean synaptic current during the first 100 ms of the stimulus plotted against holding potential in AVB. The line is fit to the data at negative holding potentials. (<bold>D</bold>) Mean zero-current holding potential and mean reversal potential of synaptic currents (± sem) in AVB (paired <italic>t</italic>-test: <italic>p</italic>= 0.013, <italic>n</italic> = 4).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12572.029">http://dx.doi.org/10.7554/eLife.12572.029</ext-link></p></caption><graphic xlink:href="elife-12572-fig9-v2"/></fig></p><p>To test this prediction we examined the ASH neurons, a pair of nociceptive sensory neurons required for the majority of escape responses in <italic>C. elegans</italic>. ASH neurons have anatomically defined monosynaptic and polysynaptic connections to both the behaviorally dominant command neurons AVB and AVA (<xref ref-type="bibr" rid="bib17">Chalfie et al., 1985</xref>; <xref ref-type="bibr" rid="bib103">White et al., 1986</xref>). We have previously shown that the functional connection from ASH to AVA is excitatory (<xref ref-type="bibr" rid="bib51">Lindsay et al., 2011</xref>). To test whether the functional connection from ASH to AVB is inhibitory, we photoactivated ASH neurons while recording from AVB (<xref ref-type="fig" rid="fig9">Figure 9C,D</xref>). The reversal potential of this connection was more negative than the zero current potential, indicating inhibition as predicted by the model. Thus, ASH-mediated escape may be controlled by a Push-Pull motif, further demonstrating the feasibility of using behavioral data to predict population-level synaptic connectivity. The source of the AVB inhibition could be the inhibitory connection from AVA, polysynaptic pathways from ASH to AVB, or both.</p><p>Notably, the Pull and Push-Pull motifs are equally effective in driving <inline-formula><mml:math id="inf572"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> to 1.0 (<xref ref-type="fig" rid="fig9">Figure 9B</xref>). Nevertheless, computation of the expected latency to the first reversal event when a forward moving animal suddenly encounters a strong nociceptive stimulus indicates a 2.3-fold reduction in latency for the Push-Pull motif (<xref ref-type="fig" rid="fig9">Figure 9B</xref>, parenthetical values). We conclude that the ASH mediated escape circuit in <italic>C. elegans</italic> may be specialized for short latency escape responses.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>The Stochastic Switch Model is cast at a level of biological detail that is minimally sufficient to capture the stochastic dynamics of <italic>C. elegans</italic> locomotion in neuronal terms. Despite its simplicity, the model predicts the unexpected effects of neuronal ablations and genetic manipulations. It also predicts the sign and strengths of key synaptic connections, which were confirmed by combining optogenetics with electrophysiology. The model is immediately extensible to random search at a variety of spatial scales, biased random walks such as chemotaxis, and deterministic escape behaviors. The predictive success of the model indicates that random search in <italic>C. elegans</italic> can be understood in terms of a neuronal flip-flop circuit involving reciprocal inhibition between two populations of stochastic neurons. Two likely sources of stochastic state transitions are quantal synaptic transmission and ion channel gating. Both of these sources derive their randomness from thermal fluctuations at the molecular level, a phenomenon that is common to all nervous systems. The stochasticity underlying search behavior in <italic>C. elegans</italic> could be intrinsic to the command neurons, their presynaptic neurons (<xref ref-type="bibr" rid="bib31">Gordus et al., 2015</xref>), or both.</p><p>The simplifying assumptions of the model introduce several limitations worth noting. (i) By representing the ten command neurons as only two functional units, the model ignores possible functional differences between individual neurons within each group. (ii) By design, the model predicts exponentially distributed dwell times, but <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref> shows that this relationship is only approximate. (iii) The model also has no provision to explain the strong correlation between locomotory phase and entry into state Y (<xref ref-type="fig" rid="fig4">Figure 4</xref>), although this could be added by modeling feedback from the pattern generator as a time-varying component of <inline-formula><mml:math id="inf573"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf574"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. (iv) The model does not take into account temporal correlations in velocity, but instead uses only the present velocity, along with the present state, to compute transition probabilities. For example, the fact that locomotion gradually slows before the worm enters the pause state (<xref ref-type="fig" rid="fig1">Figure 1G,H</xref>) suggests that transition probabilities might be more reliably calculated by including the recent velocity history, rather than just the present velocity. (v) Finally, the model does not attempt to explain the observation that the number of command neurons that are present and the degree of command neuron activation has an effect on velocity and undulation frequency (<xref ref-type="fig" rid="fig5">Figure 5A</xref>, <xref ref-type="table" rid="tbl3">Table 3</xref>, <xref ref-type="table" rid="tbl5">Table 5</xref>). Velocity modulation could be incorporated by relaxing the assumptions that command neurons within pools are co-active and have a single non-zero level of activation.</p><p>Although the model correctly predicts several unexpected and even paradoxical observations at the behavioral and electrophysiological levels, it would be premature to conclude that the biological system functions as assumed. This caution extends to all of the model's assumptions, including the mapping relationship between pause states X and Y and their behavioral correlates. We view the pause states as theoretical constructs having an epistemological status akin to theoretical constructs in many widely accepted models, such as the gating particles that were proposed in the Hodgkin-Huxley model of the squid action potential to explain the voltage sensitivity of ion channels.</p><p>An altogether different method for analyzing locomotory states in <italic>C. elegans</italic> also proposed the existence of two pause states (<xref ref-type="bibr" rid="bib87">Stephens et al., 2008</xref>). In that work, each pause state was associated with a particular locomotory phase. In contrast, we found that only state Y occurred in association with a particular posture (a ventral bend in the middle of the body), whereas state X occurred with essentially no postural preference. The reason for this discrepancy may be that pauses are identified in different ways in the two studies. Here pauses are identified in terms of tangential velocity. In Stephens et al. (<xref ref-type="bibr" rid="bib87">Stephens et al., 2008</xref>; 2011; 2010), however, pauses are identified in the phase space defined by the amplitudes of first two principle components of the worm's instantaneous shape. For the two approaches to yield the same result, minima in the magnitudes of tangential and phase velocity would have to be coincident at all times. We believe this outcome is unlikely because the third and fourth principle shape components, which account for approximately 30% of the shape variance (<xref ref-type="bibr" rid="bib87">Stephens et al., 2008</xref>), meet the necessary and sufficient conditions for generating tangential thrust: a gradient of curvature along the worm’s centerline (<xref ref-type="bibr" rid="bib32">Gray, 1946</xref>; <xref ref-type="bibr" rid="bib33">Gray, 1953</xref>; <xref ref-type="bibr" rid="bib34">Gray and Lissmann, 1964</xref>); this is one way thrust is believed to be generated during omega turns (<xref ref-type="bibr" rid="bib87">Stephens et al., 2008</xref>). Thus, the worm can be moving with respect to the substrate even when phase velocity is zero. Overall, we speculate that pauses in phase velocity are a subset of pauses in tangential velocity. The extent to which this is true could be determined by performing spot tracking and shape analysis on the same individual worms.</p><p>It will be interesting to test several additional predictions of Stochastic Switch Model:</p><list list-type="order"><list-item><p>The sign of the input weights, <inline-formula><mml:math id="inf575"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf576"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> predicts tonic excitation of the network. This could be the result of constitutive excitatory synaptic inputs, or depolarizing leakage currents in individual command neurons as has been proposed (<xref ref-type="bibr" rid="bib29">Gao et al., 2015</xref>).</p></list-item><list-item><p>The sign of the self-connections <inline-formula><mml:math id="inf577"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf578"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> predicts one or more mechanisms of self-excitation within command neuron pools. These might include excitatory connections between command neurons, or intrinsic membrane currents capable of producing plateau potentials (<xref ref-type="bibr" rid="bib60">Mellem et al., 2008</xref>).</p></list-item><list-item><p>The fate diagram (<xref ref-type="fig" rid="fig3">Figure 3</xref>) predicts that forward commands neurons generally lead the changes in direction during spontaneous locomotion. For example, transitions from F to R almost always begin with the <inline-formula><mml:math id="inf579"><mml:mi>ℱ</mml:mi></mml:math></inline-formula> unit turning off, whereas transitions from R to F almost always begin with the <inline-formula><mml:math id="inf580"><mml:mi>ℱ</mml:mi></mml:math></inline-formula> unit turning on. This prediction could be tested by calcium imaging in command neurons in freely moving animals (<xref ref-type="bibr" rid="bib63">Nguyen et al., 2015</xref>); <xref ref-type="bibr" rid="bib98">Venkatachalam et al., 2015</xref>).</p></list-item><list-item><p>Finally, the prediction that forward command neurons lead the changes in direction, coupled with the observation that transitions from R to Y occur at a particular phase, predicts that the forward command neurons are the predominant site at which phasic feedback from the locomotion pattern generator influences the network. Direct observation of neuronal activity in freely moving animals would be the ideal experiment to confirm the existence of the two pause states proposed in the Stochastic Switch Model (<xref ref-type="bibr" rid="bib63">Nguyen et al., 2015</xref>; <xref ref-type="bibr" rid="bib98">Venkatachalam et al., 2015</xref>). In particular, it will be necessary to show that whenever all command neurons are OFF, or all are ON, tangential velocity goes to zero. These experiments will be challenging because they must be done by imaging neuronal activity in freely moving animals at a temporal resolution that exceeds what can be obtained with the current generation of calcium probes. In fact, it may be necessary to use voltage probes rather than calcium indicators because even a very fast calcium probe will be limited by the dynamics of calcium accumulation, which is slow on the time scale of the pause dwell times predicted by the model. Another potential complication is that velocity may not change instantaneously with changes in the state of the command network, but with a delay imposed by time constants in the motor system. A less direct approach, although one with much higher temporal resolution, would be to make whole cell current clamp recordings from command neurons or motor neurons in restrained animals, which cycle through global brain states analogous to forward and reverse locomotion (<xref ref-type="bibr" rid="bib46">Kato et al., 2015</xref>) even though they cannot move. Instances in which both motor systems are OFF or ON would provide evidence for states X and Y, respectively.</p></list-item></list><p>Like the Stochastic Switch Model, a previous model of the command neuron circuit by Rakowski et al. (<xref ref-type="bibr" rid="bib75">Rakowski et al., 2013</xref>) predicts reciprocal inhibition between command neurons. Although the two models analyze locomotion behavior in terms of the same three behavioral states – forward, reverse, and pause – the models have essentially no points of mathematical contact. In the Rakowski model, neurons are deterministic electrical compartments and only the long-term average state probabilities of the network are computed. In the Stochastic Switch Model, by contrast, neurons are inherently stochastic and instantaneous state is computed. These disparities are significant because only the Stochastic Switch Model can predict temporal phenomena including such fundamental quantities as transition rates and mean dwell times. The fact that the both models predict reciprocal inhibition may reflect that fact that the behavioral signal of reciprocal inhibition is strong enough to transcend large differences between models.</p><p>Mammalian sleep, like <italic>C. elegans</italic> locomotion, is composed of numerous abrupt alternations between opposing behavioral states. Sleep is punctuated frequently by brief periods of wakefulness, and dwell time distributions in sleep and wake states indicate that switching between them is a stochastic process (<xref ref-type="bibr" rid="bib55">Lo et al., 2004</xref>). Sleep and wakefulness are controlled by mutually inhibitory brain-stem nuclei, implying a reciprocal inhibition motif. In a significant parallel to the effects of command neuron ablations on dwell times in <italic>C. elegans</italic> locomotion (<xref ref-type="fig" rid="fig5">Figure 5B</xref>), lesions of sleep-related nuclei simultaneously reduce the dwell times in both sleep and wake states, as do lesions of wakefulness nuclei (<xref ref-type="bibr" rid="bib79">Saper et al., 2010</xref>). Thus the relationship between synaptic uncoupling of the circuit and changes in dwell times may be a general principle of reciprocal inhibition in stochastic neuronal networks. Further study of invertebrate models of this circuit motif would be a productive means of identifying the genetic and physiological underpinnings of such circuits.</p><p>The debut of the essentially complete wiring diagram of the <italic>C. elegans</italic> nervous system raised the prospect of the first account of the entire behavioral repertoire of an organism at single-neuron resolution (<xref ref-type="bibr" rid="bib103">White et al., 1986</xref>; <xref ref-type="bibr" rid="bib97">Varshney et al., 2011</xref>). To date, the repertoire of behaviors commonly recognized in <italic>C. elegans</italic> can be divided into three main functional categories, subsuming 23 different elementary actions (<xref ref-type="bibr" rid="bib24">Faumont et al., 2012</xref>). Because the command neurons considered here are required for almost half of this repertoire, the Stochastic Switch Model is a significant step toward a comprehensive understanding of the neuronal basis of behavior in this animal, bringing us closer to the goal of computing the behavior of an entire organism. Though abstract by design in its representation of individual neurons and synapses, the model accommodates not only random search at multiple spatial scales (<xref ref-type="fig" rid="fig8">Figure 8</xref>), but also biased random walks (<xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref>) and deterministic escape behaviors (<xref ref-type="fig" rid="fig9">Figure 9</xref>). We propose, therefore, that the Stochastic Switch Model could serve as a multipurpose module for computing <italic>C. elegans</italic> behavior. Combining this mathematically tractable module with others representing sensory inputs, modulatory states, and the presumptive pattern generators for forward and reverse locomotion, could lead to essentially complete models of the <italic>C. elegans</italic> nervous system that are at once predictive and intuitively comprehensible (<xref ref-type="bibr" rid="bib1">Abbott, 2008</xref>).</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Strains</title><p>All strains were cultivated at 22.5°C on low-density NGM (nematode growth medium) agar plates seeded with the <italic>E. coli</italic> bacteria (OP50) as described by Brenner (<xref ref-type="bibr" rid="bib10">Brenner, 1974</xref>). Transgenic lines were made using standard protocols (<xref ref-type="bibr" rid="bib61">Mello and Fire, 1995</xref>).</p><table-wrap position="anchor"><table frame="hsides" rules="groups"><thead><tr><th>Experiment</th><th>Figure</th><th>Strains and genotypes</th></tr></thead><tbody><tr><td>Wild type</td><td>1-8</td><td>N2</td></tr><tr><td>AVA → AVB synaptic current</td><td>5B</td><td>XL238 <italic>ntIs[Prig-3::ChR2, Punc-122::dsRed]; ntIs35[Psra-11::tdTomato]; lite-1(ce314)</italic></td></tr><tr><td>AVB → AVA synaptic current</td><td>5C</td><td>XL237 <italic>kyEx3801[Psra-11::ChR2::GFP, Punc-122::dsRed]</italic>; ntIs29<italic>[Pnmr-1::tdTomato]; lite-1(ce314)</italic></td></tr><tr><td>AVA ablation</td><td>4</td><td>N2</td></tr><tr><td>AVD ablation</td><td>4</td><td>XL59 <italic>akIs [lin-15(+); Pnmr-1::GFP]</italic></td></tr><tr><td>AVE ablation</td><td>4</td><td>XL59 <italic>akIs [lin-15(+); Pnmr-1::GFP]</italic></td></tr><tr><td>AVB ablation</td><td>4</td><td>N2</td></tr><tr><td>PVC ablation</td><td>4</td><td>XL59 <italic>akIs [lin-15(+); Pnmr-1::GFP]</italic></td></tr><tr><td>HYP A<sup>†</sup></td><td>6</td><td>DA572 <italic>eat-4(ad572)</italic></td></tr><tr><td>HYP B<sup>†</sup></td><td>6</td><td>MT6308 <italic>eat-4(ky5)</italic></td></tr><tr><td>HYP C<sup>†</sup></td><td>6</td><td>KP4 <italic>glr-1(n2461</italic>)</td></tr><tr><td>DEP A<sup>†</sup></td><td>6</td><td>VM1136 <italic>lin-15(n765); akIs9 [lin-15(+), Pglr-1::GLR-1(A/T)]</italic></td></tr><tr><td>DEP B<sup>†</sup></td><td>6</td><td>VM188 <italic>lin-15(n765); akEx52[lin-15(+), Pnmr-1::GLR-1(A/T)</italic> ]</td></tr><tr><td>ASH → AVB synaptic current</td><td>8</td><td>XL194 <italic>ntIs27</italic> [ <italic>Psra-6::ChR2::YFP, Punc-122::dsRed]</italic>; <italic>ntIs35 [Psra-11::tdTomato]; lite-1(ce314)</italic></td></tr></tbody></table><table-wrap-foot><fn id="tblfn1"><p><sup>†</sup>Internal reference HYP A = <italic>HYP16</italic>, HYP B = <italic>HYP 56</italic>, HYP C = <italic>HYP20</italic>, DEP A = <italic>DEP14</italic>, DEP B = <italic>DEP19</italic>.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s4-2"><title>Physiological solutions</title><p>External saline for electrophysiology (mM): 5 KCl, 10 HEPES, 8 CaCl2, 143 NaCl, 30 glucose, pH 7.2 (NaOH); internal saline for electrophysiology (mM): 125K-gluconate, 1 CaCl2, 18 KCl, 4 NaCl, 1 MgCl2, 10 HEPES, 10 EGTA, pH 7.2 (KOH). Medium for behavioral assays (mM): NH<sub>4</sub>Cl 2, CaCl<sub>2</sub> 1, MgSO<sub>4</sub> 1, and KPO<sub>4</sub> 25, pH 6.5; M9 Buffer (grams): 3 KH<sub>2</sub>PO<sub>4</sub>, 6 Na<sub>2</sub>HPO<sub>4</sub>, 5 NaCl, 1 ml 1 M MgSO<sub>4</sub>, H<sub>2</sub>O to 1 liter.</p></sec><sec id="s4-3"><title>Behavior and tracking system</title><p>Prior to each assay, an individual adult hermaphrodite was picked to a bacteria-free agar transfer plate by means of a platinum-wire pick. The worm was then washed in M9 to remove excess bacteria, then transferred in a pipette filled with assay medium to a 10 cm petri plate containing 1.7% agarose in assay medium. A black dot approximately 40 microns in diameter was applied to the center of the body as shown in <xref ref-type="fig" rid="fig1">Figure 1A</xref> (see Spotting procedure). The worm was allowed to recover from transfer and handling for 2 min., then recorded for 10 min. The assay plate rested on a motorized microscope stage (Applied Scientific Instrumentation MS-2000, Eugene, OR USA) fitted with position encoders (Gurely Precision Instruments LE-1800, Troy, NY USA) having a resolution of 0.5 μm. Behavior was recorded using an analog video camera (CCD Sony XC-ST70, 29.97 frames per second) fitted with a 12× zoom lens (Navitar 50486D, Rochester, NY USA). For tracking purposes, video was analyzed in real time by custom software to calculate the eccentricity of the ink spot relative to the center of the field of view, and to compute the stage movements required to re-center the spot. Motion blur was minimized by making stage speed during corrective movements an increasing exponential function of target eccentricity such that small corrections were made more slowly than large corrections. Position encoders were read in synchrony with the video stream and this information was stored for off-line analysis. The overall trajectory of the worm was computed by combining the location of the spot in the field of view with stage position in each video frame. The direction of movement (forward or reverse) at the start of each recording was keyed by the observer and subsequent assignments were made automatically by computer. Each recording was spot-checked for correct assignments at four or more points during the recording. In experiments involving neuronal ablations or genetic mutations, recordings of sham operated controls or wild type worms, respectively, were interleaved with worms in each treatment group.</p></sec><sec id="s4-4"><title>Spotting procedure</title><p>The animal was immobilized by a stream of humidified CO<sub>2</sub> emitted by a 1.5 mm diameter glass pipette positioned near the worm. The spotting ink was comprised of petroleum jelly (1 ml), mineral oil (1 ml), and black iron oxide (3 g). Ink was applied by means of 1.5 mm diameter glass rod that had been pulled to a fine point, fire polished to produce a bulbous tip, and dipped in the ink. The rod was positioned by means of a micromanipulator. To control for the effects of the spotting procedure, we compared the speed of locomotion of worms that had been immobilized, or immobilized and spotted, to untreated worms. There were no significant differences between these three groups.</p></sec><sec id="s4-5"><title>Electrophysiology</title><p>Worms were glued to an agarose coated coverslip using cyanoacrylate adhesive as previously described (<xref ref-type="bibr" rid="bib51">Lindsay et al., 2011</xref>). The coverslip formed the bottom of the recording chamber, which was filled with external saline. The cell body of the neuron to be recorded was exposed by making a small slit in the cuticle using a finely drawn glass rod. Recording pipettes had resistances of 10–20 MΩ when filled with internal saline. Voltage- and current-clamp recordings were made with a modified Axopatch 200A amplifier (<xref ref-type="bibr" rid="bib56">Lockery and Goodman, 1998</xref>). In reversal potential measurements, recordings of photostimulation-evoked synaptic currents were filtered at 2 kHz and sampled at 10 kHz. Postsynaptic neurons (AVA, AVB) were identified using a combination of fluorescent markers and distinctive voltage clamp currents as described (<xref ref-type="bibr" rid="bib51">Lindsay et al., 2011</xref>). Presynaptic neurons (AVA, AVB, and ASH) were activated by expression of ChannelRhodopsin-2 expressed under the control of neuron-specific promoters as described (see “Strains”). Worms were photostimulated in electrophysiological experiments using the blue channel (470 nm) of a dual-wavelength LED module (Rapp OptoElectronic, Wedel, Germany) that was focused by a 63×, 1.4 NA oil immersion objective lens (Zeiss, part number 440762–9904). Irradiance (12.5 mW/mm<sup>2</sup>) was determined by measuring the power emitted from the objective using an optical power meter placed above the front lens of the objective and dividing by the area of the field of illumination at the focal plane of the preparation.</p></sec><sec id="s4-6"><title>Ablations</title><p>Neurons were ablated using a laser as described previously (<xref ref-type="bibr" rid="bib2">Bargmann and Avery, 1995</xref>). L1 larvae were mounted on 2.5% agarose pads containing 5–7 mM of the immobilizing agent NaN<sub>3</sub>. AVA and AVB neurons were ablated in N2 animals and identified by position. AVD, AVE and PVC were ablated in animals expressing <italic>nmr-1</italic>::GFP and identified by a combination of position and GFP expression. To limit potential behavioral differences in the two strains, we outcrossed (4×) the <italic>nmr-1</italic>::GFP strain to the N2 strain used for AVA and AVB ablations. All animals were remounted 1–3 hr after surgery to confirm the ablation; those with collateral damage were discarded. Sham-operated animals were treated in the same manner except that the laser was not fired.</p></sec><sec id="s4-7"><title>Statistical tests</title><p>Statistical significance for the results shown in <xref ref-type="fig" rid="fig4">Figures 4B</xref> and <xref ref-type="fig" rid="fig6">6C</xref>, and in <xref ref-type="table" rid="tbl4">Tables 4</xref> and <xref ref-type="table" rid="tbl6">6</xref> were obtained using the likelihood ratio test (see <xref ref-type="table" rid="tbl1">Table 1</xref> and <xref ref-type="table" rid="tbl4">4</xref> legends). Otherwise, two-tailed <italic>t</italic>-tests or 2-tailed Mann-Whitney U tests were used.</p></sec><sec id="s4-8"><title>Descriptive statistics</title><p>The worm’s position in video frame <inline-formula><mml:math id="inf581"><mml:mi>k</mml:mi></mml:math></inline-formula> is represented as the row vector:</p><p><disp-formula id="equ7"><label>(6)</label><mml:math id="m7"><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mi>x</mml:mi><mml:mfenced><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>y</mml:mi><mml:mfenced><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfenced><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mfenced><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mfenced></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf582"><mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf583"><mml:mrow><mml:mi>y</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are the coordinates of centroid of the tracking spot in the frame of reference of the agar plate, <inline-formula><mml:math id="inf584"><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>∆</mml:mo><mml:mi>t</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf585"><mml:mo>∆</mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo></mml:math></inline-formula>33 ms, and <inline-formula><mml:math id="inf586"><mml:mi>N</mml:mi><mml:mo>≅</mml:mo></mml:math></inline-formula>18000 is the number of video frames analyzed in a continuous recording of one worm. We made the following definitions:</p><sec id="s4-8-1"><title>Row vectors</title><p>Velocity:</p><p><disp-formula id="equ8"><label>(7)</label><mml:math id="m8"><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo></mml:mrow><mml:mrow><mml:mo>∆</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>Heading:</p><p><disp-formula id="equ9"><label>(8)</label><mml:math id="m9"><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math></disp-formula></p></sec><sec id="s4-8-2"><title>Scalar quantities</title><p>Speed:</p><p><disp-formula id="equ10"><label>(9)</label><mml:math id="m10"><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="||" open="||"><mml:mrow><mml:mi>V</mml:mi><mml:mfenced><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msqrt><mml:mi>V</mml:mi><mml:mfenced><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced><mml:mo>·</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mfenced><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced></mml:msqrt><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mfenced><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo>≡</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mo> </mml:mo><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mo> </mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mfenced></mml:math></disp-formula></p><p>Mean speed:</p><p><disp-formula id="equ11"><label>(10)</label><mml:math id="m11"><mml:mover><mml:mi>s</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>s</mml:mi><mml:mfenced><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced></mml:math></disp-formula></p><p>Instantaneous turn rate:</p><p><disp-formula id="equ12"><label>(11)</label><mml:math id="m12"><mml:mfenced close="|" open="|"><mml:mfrac><mml:mrow><mml:mo>∆</mml:mo><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mo>∆</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mfenced> <mml:mo/><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced><mml:mrow><mml:mi>H</mml:mi><mml:mfenced><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>·</mml:mo><mml:msup><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mfenced><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>∆</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mo>∆</mml:mo><mml:mi>φ</mml:mi><mml:mo>≤</mml:mo><mml:mi>π</mml:mi><mml:mo>)</mml:mo></mml:math></disp-formula></p><p>Mean heading change:</p><p><disp-formula id="equ13"><label>(12)</label><mml:math id="m13"><mml:mover><mml:mfenced close="|" open="|"><mml:mrow><mml:mo>∆</mml:mo><mml:mi>φ</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:mi>_</mml:mi><mml:mi>_</mml:mi><mml:mi>_</mml:mi><mml:mi>_</mml:mi><mml:mi>_</mml:mi></mml:mrow></mml:mover><mml:mfenced><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced><mml:mrow><mml:mi>H</mml:mi><mml:mfenced><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>·</mml:mo><mml:msup><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mfenced><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfenced><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mo>∆</mml:mo><mml:mi>φ</mml:mi><mml:mo>≤</mml:mo><mml:mi>π</mml:mi><mml:mo>)</mml:mo></mml:math></disp-formula></p><p>Speed autocovariance:</p><p><disp-formula id="equ14"><label>(13)</label><mml:math id="m14"><mml:msub><mml:mi>A</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mover><mml:mi>s</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mo>-</mml:mo><mml:mover><mml:mi>s</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math></disp-formula></p><p>Velocity autocorrelation:</p><p><disp-formula id="equ15"><label>(14)</label><mml:math id="m15"><mml:msub><mml:mi>A</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Heading autocorrelation:</p><p><disp-formula id="equ16"><label>(15)</label><mml:math id="m16"><mml:msub><mml:mi>A</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:msup><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Mean squared displacement:</p><p><disp-formula id="equ17"><label>(16)</label><mml:math id="m17"><mml:mover><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mi>_</mml:mi><mml:mi>_</mml:mi><mml:mi>_</mml:mi></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msup><mml:mo>|</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:math></disp-formula></p></sec></sec><sec id="s4-9"><title>Maximum likelihood estimation of state transition rates in a hidden Markov model</title><p>To analyze locomotory states we converted the velocity vector, <inline-formula><mml:math id="inf587"><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, into a signed scalar quantity <inline-formula><mml:math id="inf588"><mml:mrow><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> that represents the component of velocity in the direction of the worm’s track, with positive values indicating forward movement. We first smoothed <inline-formula><mml:math id="inf589"><mml:mrow><mml:mi>x</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf590"><mml:mrow><mml:mi>y</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> using an 11 frame window, assigned a direction to the smoothed track with respect to the head/tail orientation of the worm, and projected <inline-formula><mml:math id="inf591"><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> onto the smoothed track to obtain <inline-formula><mml:math id="inf592"><mml:mrow><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>. For each cohort of worms we collected all <inline-formula><mml:math id="inf593"><mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> values into a single velocity distribution <inline-formula><mml:math id="inf594"><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The central peak of <inline-formula><mml:math id="inf595"><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> was fit by a Cauchy distribution with median 0 and half-width <inline-formula><mml:math id="inf596"><mml:mi>b</mml:mi></mml:math></inline-formula> = 18 µm/s (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>), which we used to approximate the pause velocity distribution for states X and Y for all worms:</p><p><disp-formula id="equ18"><label>(17)</label><mml:math id="m18"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>X</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>Y</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>P</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mi>b</mml:mi><mml:mrow><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo> </mml:mo></mml:mrow></mml:math></disp-formula></p><p>We used a Cauchy distribution because it has long tails that describe the pause velocity distribution better than a Gaussian distribution (i.e., the worm does not stop instantaneously when it switches from forward or reverse locomotion into one of the pause states). We estimated the forward and reverse velocity distributions <inline-formula><mml:math id="inf597"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>F</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf598"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>R</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> by scaling <inline-formula><mml:math id="inf599"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>P</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to fit the peak at <inline-formula><mml:math id="inf600"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, subtracting it from the overall distribution and splitting the remaining distribution into <inline-formula><mml:math id="inf601"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>F</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf602"><mml:mrow><mml:mi>v</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf603"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mtext>R</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf604"><mml:mrow><mml:mi>v</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Velocity distributions were scaled to be probability densities (area =1) and collected into a row vector:</p><p><disp-formula id="equ19"><label>(18)</label><mml:math id="m19"><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>F</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>R</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>X</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mtext>Y</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf605"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the estimated probability density that worms move at velocity <inline-formula><mml:math id="inf606"><mml:mi>v</mml:mi></mml:math></inline-formula> when in state <inline-formula><mml:math id="inf607"><mml:mi>i</mml:mi></mml:math></inline-formula>.</p><p>The goal of the maximum likelihood fitting procedure is to find the set of state transition rates <inline-formula><mml:math id="inf608"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>XF</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>FX</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>XR</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>RX</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>FY</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>YF</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>RY</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>YR</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> that maximize the probability of the observed velocity time series <inline-formula><mml:math id="inf609"><mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> given the velocity distribution <inline-formula><mml:math id="inf610"><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>. All transition rates were constrained to be <inline-formula><mml:math id="inf611"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, and usually were additionally constrained to correspond to valid synaptic weights as described below<inline-formula><mml:math id="inf612"><mml:mrow><mml:mo>.</mml:mo><mml:mtext/></mml:mrow></mml:math></inline-formula> The likelihood is most conveniently calculated using matrix notation as follows; see <xref ref-type="bibr" rid="bib18">Colquhoun and Hawkes, 1995</xref> for a more complete explanation of these computations. Let:</p><p><disp-formula id="equ20"><label>(19)</label><mml:math id="m20"><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>FX</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>FY</mml:mtext></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mtext>XF</mml:mtext></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mtext>YF</mml:mtext></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>RX</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>RY</mml:mtext></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mtext>XR</mml:mtext></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mtext>YR</mml:mtext></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mtext>FX</mml:mtext></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mtext>RX</mml:mtext></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mtext>FY</mml:mtext></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mtext>RY</mml:mtext></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>YF</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>YR</mml:mtext></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math></disp-formula></p><p>Element <inline-formula><mml:math id="inf613"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf614"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> of matrix <inline-formula><mml:math id="inf615"><mml:mi>Q</mml:mi></mml:math></inline-formula> is the transition rate from state <inline-formula><mml:math id="inf616"><mml:mi>i</mml:mi></mml:math></inline-formula> to state <inline-formula><mml:math id="inf617"><mml:mi>j</mml:mi></mml:math></inline-formula> (i.e., the instantaneous probability per unit time that the system in state <inline-formula><mml:math id="inf618"><mml:mi>i</mml:mi></mml:math></inline-formula> will make a transition to state <inline-formula><mml:math id="inf619"><mml:mi>j</mml:mi></mml:math></inline-formula>, and element <inline-formula><mml:math id="inf620"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the negative of the total transition rate out of state <inline-formula><mml:math id="inf621"><mml:mi>i</mml:mi></mml:math></inline-formula>, which is related to the mean dwell time in state <inline-formula><mml:math id="inf622"><mml:mi>i</mml:mi></mml:math></inline-formula> by:</p><p><disp-formula id="equ21"><label>(20)</label><mml:math id="m21"><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula></p><p>Matrix <inline-formula><mml:math id="inf623"><mml:mi>Q</mml:mi></mml:math></inline-formula> is composed of instantaneous transition rates, which can be converted into the matrix of transition probabilities during a brief time interval of duration <inline-formula><mml:math id="inf624"><mml:mi>ε</mml:mi></mml:math></inline-formula> by multiplying <inline-formula><mml:math id="inf625"><mml:mi>Q</mml:mi></mml:math></inline-formula> by <inline-formula><mml:math id="inf626"><mml:mrow><mml:mo/><mml:mi>ε</mml:mi></mml:mrow></mml:math></inline-formula> and adding 1 to each diagonal element (i.e., by calculating <inline-formula><mml:math id="inf627"><mml:mi>ε</mml:mi><mml:mo>·</mml:mo><mml:mi>Q</mml:mi><mml:mo>+</mml:mo><mml:mi>I</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf628"><mml:mi>I</mml:mi></mml:math></inline-formula> is the 4×4 identity matrix). If <inline-formula><mml:math id="inf629"><mml:mi>ε</mml:mi></mml:math></inline-formula> is sufficiently small that multiple state transitions can be ignored, then element <inline-formula><mml:math id="inf630"><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula> of matrix <inline-formula><mml:math id="inf631"><mml:mi>ε</mml:mi><mml:mo>·</mml:mo><mml:mi>Q</mml:mi><mml:mo>+</mml:mo><mml:mi>I</mml:mi></mml:math></inline-formula> is the probability that the system is in state <inline-formula><mml:math id="inf632"><mml:mi>j</mml:mi></mml:math></inline-formula> at the end of a time interval of duration <inline-formula><mml:math id="inf633"><mml:mi>ε</mml:mi></mml:math></inline-formula> given that it was in state <inline-formula><mml:math id="inf634"><mml:mi>i</mml:mi></mml:math></inline-formula> at the beginning of the interval. For longer time intervals during which multiple state transitions may occur, transition probabilities can be calculated by repeatedly multiplying matrix <inline-formula><mml:math id="inf635"><mml:mi>ε</mml:mi><mml:mo>·</mml:mo><mml:mi>Q</mml:mi><mml:mo>+</mml:mo><mml:mi>I</mml:mi></mml:math></inline-formula> by itself. Thus, if</p><p><disp-formula id="equ22"><label>(21)</label><mml:math id="m22"><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>ε</mml:mi><mml:mo>·</mml:mo><mml:mi>Q</mml:mi><mml:mo>+</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>K</mml:mi></mml:msup></mml:math></disp-formula></p><p>then <inline-formula><mml:math id="inf636"><mml:mi>M</mml:mi></mml:math></inline-formula> is the matrix of transition probabilities during a time interval of duration <inline-formula><mml:math id="inf637"><mml:mi>K</mml:mi><mml:mi>ε</mml:mi></mml:math></inline-formula>. If <inline-formula><mml:math id="inf638"><mml:mi>K</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf639"><mml:mi>ε</mml:mi></mml:math></inline-formula> are chosen such that <inline-formula><mml:math id="inf640"><mml:mo>∆</mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mi>ε</mml:mi></mml:math></inline-formula>, then element <inline-formula><mml:math id="inf641"><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula> of matrix <inline-formula><mml:math id="inf642"><mml:mi>M</mml:mi></mml:math></inline-formula> is the transition probability from state <inline-formula><mml:math id="inf643"><mml:mi>i</mml:mi></mml:math></inline-formula> to state <inline-formula><mml:math id="inf644"><mml:mi>j</mml:mi></mml:math></inline-formula> during one video frame of duration <inline-formula><mml:math id="inf645"><mml:mo>∆</mml:mo><mml:mi>t</mml:mi></mml:math></inline-formula>. We chose <inline-formula><mml:math id="inf646"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mn>30</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and let <inline-formula><mml:math id="inf647"><mml:mi>ε</mml:mi><mml:mo>=</mml:mo><mml:mo>∆</mml:mo><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mo/><mml:mn>30.7</mml:mn></mml:math></inline-formula> picoseconds, a time interval during which multiple state transitions can safely be ignored. Since <inline-formula><mml:math id="inf648"><mml:mi>K</mml:mi></mml:math></inline-formula> was chosen to be a power of 2, <inline-formula><mml:math id="inf649"><mml:mi>M</mml:mi></mml:math></inline-formula> could be rapidly and accurately calculated by 30 serial multiplications using 64-bit floating point arithmetic.</p><p>Let <inline-formula><mml:math id="inf650"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> be the row vector of history-dependent state probabilities:</p><p><disp-formula id="equ23"><label>(22)</label><mml:math id="m23"><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mtext>F</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mtext>R</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mtext>X</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mtext>Y</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf651"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the probability of being in state <italic>i</italic> at time <inline-formula><mml:math id="inf652"><mml:mi>t</mml:mi></mml:math></inline-formula> given <inline-formula><mml:math id="inf653"><mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for all <inline-formula><mml:math id="inf654"><mml:mi>u</mml:mi></mml:math></inline-formula> up to and including the present time (<inline-formula><mml:math id="inf655"><mml:mrow><mml:mi>u</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>). The matrix product <inline-formula><mml:math id="inf656"><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>·</mml:mo></mml:mrow><mml:mi>M</mml:mi></mml:math></inline-formula> is the state probability vector at time <inline-formula><mml:math id="inf657"><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mo>∆</mml:mo><mml:mi>t</mml:mi></mml:math></inline-formula> prior to accounting for the observed velocity at time <inline-formula><mml:math id="inf658"><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mo>∆</mml:mo><mml:mi>t</mml:mi></mml:math></inline-formula>. To account for <inline-formula><mml:math id="inf659"><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mo>∆</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> we used the information contained in <inline-formula><mml:math id="inf660"><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mo>∆</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> and applied Bayes theorem:</p><p><disp-formula id="equ24"><label>(23)</label><mml:math id="m24"><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mo>∆</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo>·</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>·</mml:mo></mml:mrow><mml:mi>M</mml:mi><mml:mo>·</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mo>∆</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf661"><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mo>∆</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:math></inline-formula> is the 4×4 matrix with the elements of <inline-formula><mml:math id="inf662"><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mo>∆</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> along the diagonal, and <inline-formula><mml:math id="inf663"><mml:mi>l</mml:mi></mml:math></inline-formula> is the scalar multiplicative factor required for the sum of the four elements of <inline-formula><mml:math id="inf664"><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mo>∆</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> to equal 1 (i.e., <inline-formula><mml:math id="inf665"><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mo>∆</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> is a vector of probabilities). Initially (<inline-formula><mml:math id="inf666"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) we set <inline-formula><mml:math id="inf667"><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> equal to the steady-state probability vector <inline-formula><mml:math id="inf668"><mml:msub><mml:mi>P</mml:mi><mml:mi>∞</mml:mi></mml:msub></mml:math></inline-formula>, which is given by:</p><p><disp-formula id="equ25"><label>(24)</label><mml:math id="m25"><mml:msub><mml:mi>P</mml:mi><mml:mi>∞</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>⇒</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>∞</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>a</mml:mi><mml:mtext>t</mml:mtext></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf669"><mml:msub><mml:mi>U</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math></inline-formula> is the <inline-formula><mml:math id="inf670"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:mn>4</mml:mn><mml:mo/></mml:mrow></mml:math></inline-formula> row vector of ones and <inline-formula><mml:math id="inf671"><mml:msub><mml:mi>Q</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> is the <inline-formula><mml:math id="inf672"><mml:mrow><mml:mn>4</mml:mn><mml:mo>×</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> matrix constructed by appending a column of ones to <inline-formula><mml:math id="inf673"><mml:mi>Q</mml:mi></mml:math></inline-formula>. To break the symmetry between the behaviorally indistinguishable states X and Y, we identified X as the state with higher steady-state probability.</p><p>We then calculated the log-likelihood, summed over all worms in the cohort:</p><p><disp-formula id="equ26"><label>(25)</label><mml:math id="m26"><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mfenced><mml:mi>L</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:munder><mml:mo> </mml:mo><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:msup><mml:mi>G</mml:mi><mml:mtext>t</mml:mtext></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf674"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the velocity and <inline-formula><mml:math id="inf675"><mml:msub><mml:mi>P</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> is the history-dependent state probability vector of worm <inline-formula><mml:math id="inf676"><mml:mi>w</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf677"><mml:mi>t</mml:mi></mml:math></inline-formula>.</p><p>We used a random optimization algorithm to find the set of transition rates that maximized <inline-formula><mml:math id="inf678"><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mfenced><mml:mi>L</mml:mi></mml:mfenced></mml:math></inline-formula>. Initial guesses for 6 of the 8 rates were chosen independently from log uniform distribution between 0.01 Hz and 10 Hz. The remaining 2 rates were calculated to satisfy the constraints needed to generate valid synaptic weights (see below). At each iteration, each of the 6 independently chosen rates was altered by adding a random number chosen from a Cauchy distribution with median 0 and width <inline-formula><mml:math id="inf679"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (initially <inline-formula><mml:math id="inf680"><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:math></inline-formula> 0.01 Hz), and the remaining 2 rates were recalculated. To avoid getting trapped in local likelihood maxima, the new rates were rejected and another set was calculated if any of the new rates were &lt;0.01 Hz. If the new rates generated an increased likelihood, the new rates were accepted and <inline-formula><mml:math id="inf681"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> was increased by 3%. Otherwise the old rates were retained and <inline-formula><mml:math id="inf682"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> was decreased by 0.5%. The procedure was iterated until <inline-formula><mml:math id="inf683"><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mo/></mml:math></inline-formula> 0.001 Hz. The random optimization procedure was replicated 10 times for each cohort using different randomly chosen initial guesses. In 71% of the replicates the procedure converged on a set of transition rates in which none of the transition rates differed from the best set by more than 5%. The best set of transition rates was then refined by applying the optimization procedure using a success criterion of <inline-formula><mml:math id="inf684"><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo></mml:math></inline-formula> 10<sup>-5</sup> and constraining transition rates to be ≥ 10<sup>–4</sup> Hz.</p><p>The likelihood calculations described above use only past and present velocity observations to calculate <inline-formula><mml:math id="inf685"><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>, but once the optimal transition rates were determined, the Forward-Backward algorithm (<xref ref-type="bibr" rid="bib73">Rabiner, 1986</xref>) can be used to yield a better estimate of the state probabilities based on past, present and future velocity observations, and the Viterbi Algorithm can be used to find the sequence of states with the highest probability of producing the observed velocities (<xref ref-type="fig" rid="fig2">Figure 2E</xref>).</p></sec><sec id="s4-10"><title>Stochastic model neurons</title><p>We expressed the effect of synaptic inputs to command units <inline-formula><mml:math id="inf686"><mml:mi>ℱ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf687"><mml:mi>ℛ</mml:mi></mml:math></inline-formula> by equations of the form:</p><p><disp-formula id="equ27"><label>(26)</label><mml:math id="m27"><mml:msub><mml:mi>a</mml:mi><mml:mtext>ON</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo>·</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mi>S</mml:mi></mml:msup></mml:math></disp-formula></p><p><disp-formula id="equ28"><label>(27)</label><mml:math id="m28"><mml:msub><mml:mi>a</mml:mi><mml:mtext>OFF</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo>·</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msup></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf688"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>OFF</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the transition rate from ON to OFF, <inline-formula><mml:math id="inf689"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>ON</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the transition rate from OFF to ON, and <inline-formula><mml:math id="inf690"><mml:mi>S</mml:mi></mml:math></inline-formula> is the total synaptic input to the unit. We do not attach any mechanistic significance to these equations, but note that they are analogous to the Arrhenius Equation (<xref ref-type="bibr" rid="bib90">Stiller, 1989</xref>) an approximation commonly used to describe the rates of chemical reactions in terms of an activation energy, <inline-formula><mml:math id="inf691"><mml:mi>E</mml:mi></mml:math></inline-formula>:</p><p><disp-formula id="equ29"><label>(28)</label><mml:math id="m29"><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo>·</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:math></disp-formula></p><p>where <italic>a</italic> is the reaction rate constant, <inline-formula><mml:math id="inf692"><mml:mi>A</mml:mi></mml:math></inline-formula> is an empirically determined constant, <inline-formula><mml:math id="inf693"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the Boltzmann constant, and <inline-formula><mml:math id="inf694"><mml:mi>T</mml:mi></mml:math></inline-formula> is the absolute temperature. Under this interpretation, <inline-formula><mml:math id="inf695"><mml:mi>S</mml:mi></mml:math></inline-formula> is analogous to activation energy expressed in units of <inline-formula><mml:math id="inf696"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>. Thus, <inline-formula><mml:math id="inf697"><mml:mi>ℱ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf698"><mml:mi>ℛ</mml:mi></mml:math></inline-formula> are assumed to be symmetrical bi-stable units that change state at rate <inline-formula><mml:math id="inf699"><mml:mi>A</mml:mi></mml:math></inline-formula> when <inline-formula><mml:math id="inf700"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Deviations from this baseline condition are modelled as external synaptic inputs <inline-formula><mml:math id="inf701"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf702"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p><p>We represented the total synaptic input onto units <inline-formula><mml:math id="inf703"><mml:mi>ℱ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf704"><mml:mi>ℛ</mml:mi></mml:math></inline-formula>, respectively, by:</p><p><disp-formula id="equ30"><label>(29)</label><mml:math id="m30"><mml:msub><mml:mi>S</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mfenced><mml:mi>t</mml:mi></mml:mfenced><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mfenced><mml:mi>t</mml:mi></mml:mfenced><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula></p><p><disp-formula id="equ31"><label>(30)</label><mml:math id="m31"><mml:msub><mml:mi>S</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mfenced><mml:mi>t</mml:mi></mml:mfenced><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mfenced><mml:mi>t</mml:mi></mml:mfenced><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf705"><mml:msub><mml:mi>b</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mfenced><mml:mi>t</mml:mi></mml:mfenced></mml:math></inline-formula> and <inline-formula><mml:math id="inf706"><mml:msub><mml:mi>b</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mfenced><mml:mi>t</mml:mi></mml:mfenced></mml:math></inline-formula> are the states of <inline-formula><mml:math id="inf707"><mml:mi>ℱ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf708"><mml:mi>ℛ</mml:mi></mml:math></inline-formula> (1 = ON, 0 = OFF), <inline-formula><mml:math id="inf709"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf710"><mml:msub><mml:mi>w</mml:mi><mml:mi>FR</mml:mi></mml:msub></mml:math></inline-formula> are the synaptic weights from <inline-formula><mml:math id="inf711"><mml:mi>ℛ</mml:mi></mml:math></inline-formula> onto <inline-formula><mml:math id="inf712"><mml:mi>ℱ</mml:mi></mml:math></inline-formula> and from <inline-formula><mml:math id="inf713"><mml:mrow><mml:mo/><mml:mi>ℱ</mml:mi></mml:mrow></mml:math></inline-formula> onto <inline-formula><mml:math id="inf714"><mml:mi>ℛ</mml:mi></mml:math></inline-formula>, respectively, and <inline-formula><mml:math id="inf715"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf716"><mml:msub><mml:mi>w</mml:mi><mml:mi>RR</mml:mi></mml:msub></mml:math></inline-formula> represent synaptic interactions among command neurons of the same class, plus any intrinsic membrane properties that may promote bistability. Applying these definitions to the rate constants in <xref ref-type="fig" rid="fig2">Figure 2C</xref> gives:</p><p><disp-formula id="equ32"><label>(31)</label><mml:math id="m32"><mml:msub><mml:mi>a</mml:mi><mml:mtext>XF</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo> </mml:mo><mml:mo/><mml:mtext>exp</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>XR</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo> </mml:mo><mml:mo/><mml:mtext>exp</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo></mml:math></disp-formula></p><p><disp-formula id="equ33"><label>(32)</label><mml:math id="m33"><mml:msub><mml:mi>a</mml:mi><mml:mtext>FX</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo> </mml:mo><mml:mo/><mml:mtext>exp</mml:mtext><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>RX</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo> </mml:mo><mml:mo/><mml:mtext>exp</mml:mtext><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo></mml:math></disp-formula></p><p><disp-formula id="equ34"><label>(33)</label><mml:math id="m34"><mml:msub><mml:mi>a</mml:mi><mml:mtext>RY</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo> </mml:mo><mml:mo/><mml:mtext>exp</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>FY</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo> </mml:mo><mml:mo/><mml:mtext>exp</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo></mml:math></disp-formula></p><p><disp-formula id="equ35"><label>(34)</label><mml:math id="m35"><mml:msub><mml:mi>a</mml:mi><mml:mtext>YR</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo> </mml:mo><mml:mo/><mml:mtext>exp</mml:mtext><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>YF</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo> </mml:mo><mml:mo/><mml:mtext>exp</mml:mtext><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></disp-formula></p><p>In these experiments the sensory environment was kept constant (e.g., no chemical or temperature gradients). Therefore <inline-formula><mml:math id="inf717"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf718"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> were assumed to be constant. For simulations of chemotaxis <inline-formula><mml:math id="inf719"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf720"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> varied with position in the chemical gradient.</p><p><xref ref-type="disp-formula" rid="equ32 equ33 equ34 equ35">Equations 31–34</xref> express the 8 transition rates in terms of 6 parameters and yield the following two constraints on the transition rates:</p><p><disp-formula id="equ36"><label>(35)</label><mml:math id="m36"><mml:msub><mml:mi>a</mml:mi><mml:mtext>FX</mml:mtext></mml:msub><mml:mo> </mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>XF</mml:mtext></mml:msub><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>RY</mml:mtext></mml:msub><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>YR</mml:mtext></mml:msub><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>FY</mml:mi></mml:msub><mml:mo> </mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>YF</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>RX</mml:mi></mml:msub><mml:mo> </mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>XR</mml:mi></mml:msub></mml:math></disp-formula></p><p>The inverse relations between transition rates and synaptic parameters are:</p><p><disp-formula id="equ37"><label>(36)</label><mml:math id="m37"><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo/><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>XF</mml:mtext></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mfenced><mml:mi>A</mml:mi></mml:mfenced><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo/><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>XR</mml:mtext></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mfenced><mml:mi>A</mml:mi></mml:mfenced><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo></mml:math></disp-formula></p><p><disp-formula id="equ38"><label>(37)</label><mml:math id="m38"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>RY</mml:mtext></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>XF</mml:mtext></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>FY</mml:mtext></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>XR</mml:mtext></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo></mml:math></disp-formula></p><p><disp-formula id="equ39"><label>(38)</label><mml:math id="m39"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>XF</mml:mtext></mml:msub><mml:mo> </mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>FX</mml:mtext></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>·</mml:mo><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mfenced><mml:mi>A</mml:mi></mml:mfenced><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℛ</mml:mi><mml:mi>ℛ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>XR</mml:mtext></mml:msub><mml:mo> </mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>RX</mml:mtext></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>·</mml:mo><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mfenced><mml:mi>A</mml:mi></mml:mfenced></mml:math></disp-formula></p></sec><sec id="s4-11"><title>Derivation of the mean distance traveled during a forward run</title><p>The time series of the worm’s locomotory states can be divided into forward runs, during which the worm is in either the F or P state, and reverse runs, during which the worm is in either the R or P state. Forward runs always begin with an RPF transition and end with the next FPR transition, which marks the beginning of a reverse run. Thus forward runs and reverse runs occur in strict alternation, such that the number of forward runs equals the number of reverse runs.</p><p>Let <inline-formula><mml:math id="inf721"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> denote the mean distance traveled during a single forward run, assuming that forward runs are straight. The value of <inline-formula><mml:math id="inf722"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> is most easily calculated by dividing time into non-overlapping epochs, each of which begins with an RPF transition and ends immediately before the next RPF transition. Each epoch thus contains exactly one forward run, which includes all visits to state F during the epoch. Therefore, <inline-formula><mml:math id="inf723"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> is also equal to the mean distance travelled while in the forward state during a single epoch:</p><p><disp-formula id="equ40"><label>(39)</label><mml:math id="m40"><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>v</mml:mi><mml:mtext>F</mml:mtext></mml:msub><mml:mo>¯</mml:mo></mml:mover><mml:msub><mml:mi>p</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mtext>RPF</mml:mtext></mml:msub></mml:mfrac></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf724"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is the mean velocity in the forward state and <inline-formula><mml:math id="inf725"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mtext>RPF</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the frequency of RPF transitions. Since FPR and RPF transitions occur in strict alternation they must occur in equal numbers: <inline-formula><mml:math id="inf726"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mtext>RPF</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mtext>FPR</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Thus, eq. 39 can also be written with <inline-formula><mml:math id="inf727"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mtext>FPR</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> in the denominator, which is more useful for the calculation that follows, although the form shown above is more directly interpreted in terms of the frequency of random reorientations, which occur at the RPF transitions. It is straightforward to calculate <inline-formula><mml:math id="inf728"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mtext>FPR</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> given <inline-formula><mml:math id="inf729"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf730"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>FX</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf731"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>FY</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and the probabilities that the transitions out of states X and Y will be into state R:</p><p><disp-formula id="equ41"><label>(40)</label><mml:math id="m41"><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>X</mml:mtext><mml:mo>→</mml:mo><mml:mtext>R</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>XR</mml:mtext></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>XF</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>XR</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p><disp-formula id="equ42"><label>(41)</label><mml:math id="m42"><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>→</mml:mo><mml:mi>R</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>YR</mml:mtext></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>YF</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>YR</mml:mtext></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula></p><p><disp-formula id="equ43"><label>(42)</label><mml:math id="m43"><mml:msub><mml:mi>f</mml:mi><mml:mtext>FPR</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mtext>F</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>FX</mml:mtext></mml:msub><mml:mfrac><mml:msub><mml:mi>a</mml:mi><mml:mtext>XR</mml:mtext></mml:msub><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mtext>XF</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>XR</mml:mtext></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:msub><mml:mi>a</mml:mi><mml:mtext>YR</mml:mtext></mml:msub><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mtext>YF</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>YR</mml:mtext></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Combining eqns. 39 and 42 yields:</p><p><disp-formula id="equ44"><label>(43)</label><mml:math id="m44"><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>v</mml:mi><mml:mtext>F</mml:mtext></mml:msub><mml:mo>¯</mml:mo></mml:mover><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>XF</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>XR</mml:mtext></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>YF</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>YR</mml:mtext></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mtext>FX</mml:mtext></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mtext>XR</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>YF</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>YR</mml:mtext></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>FY</mml:mtext></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mtext>YR</mml:mtext></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>XF</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>XR</mml:mtext></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>An approximation to <inline-formula><mml:math id="inf732"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> in terms of synaptic weights is obtained by noting that transitions from F to Y were extremely rare (<inline-formula><mml:math id="inf733"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>FY</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo/></mml:mrow></mml:math></inline-formula>0.007 s<sup>-1</sup>; <xref ref-type="table" rid="tbl1">Table 1</xref>). Setting <inline-formula><mml:math id="inf734"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mtext>FY</mml:mtext></mml:mrow></mml:msub><mml:mo>≅</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> yields:</p><p><disp-formula id="equ45"><label>(44)</label><mml:math id="m45"><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub><mml:mo>≅</mml:mo><mml:mover><mml:msub><mml:mi>v</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mrow><mml:mi>_</mml:mi><mml:mi>_</mml:mi><mml:mi>_</mml:mi></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mtext>a</mml:mtext><mml:mtext>XF</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>XR</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mtext>FX</mml:mtext></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mtext>XR</mml:mtext></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mstyle displaystyle="true"><mml:mover><mml:msub><mml:mi>v</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mrow><mml:mi>_</mml:mi><mml:mi>_</mml:mi><mml:mi>_</mml:mi></mml:mrow></mml:mover></mml:mstyle><mml:mi>A</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ℱ</mml:mi><mml:mi>ℱ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec id="s4-12"><title>Simulations of worm behavior</title><p>In <xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref> and <xref ref-type="fig" rid="fig8s2">2</xref>, the worm was represented as a point that moved forward or backward at speeds of 0.2 and 0.3 mm/sec, respectively, and was stationary during the pause state. Rate constants were calculated according to <xref ref-type="disp-formula" rid="equ32 equ33 equ34 equ35">equations 31–34</xref> based on the weights that pertain under random search or chemotaxis, using either <inline-formula><mml:math id="inf735"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf736"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Weights were used to compute the state transition matrix <inline-formula><mml:math id="inf737"><mml:mi>M</mml:mi></mml:math></inline-formula>. At each time step (∆<italic>t</italic> = 33 ms), the next state was selected randomly according to the state probabilities given by <inline-formula><mml:math id="inf738"><mml:mi>M</mml:mi></mml:math></inline-formula>. When an RPF transition occurred, a new direction of movement (heading) was selected from a uniform distribution. The random component of the heading was modeled as Gaussian noise having a standard deviation of 0.001 degrees. In the case of chemotaxis simulations, the values of <inline-formula><mml:math id="inf739"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℱ</mml:mi></mml:msub><mml:mo/></mml:mrow></mml:math></inline-formula>and <inline-formula><mml:math id="inf740"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>ℛ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> were updated at every time step according to the direction in which the worm was heading, leading to an updated set of weights and a new <inline-formula><mml:math id="inf741"><mml:mi>M</mml:mi></mml:math></inline-formula> matrix.</p></sec><sec id="s4-13"><title>Definition of modes of random search in <italic>C. elegans</italic></title><p>To date, these behaviors have been defined mainly in operational terms. Following the terminology of <xref ref-type="bibr" rid="bib45">Jander 1975</xref>: (i) cropping is the locomotory behavior exhibited by well-fed worms on plates with densely populated patches of bacteria; (ii) local search (also “area restricted search” (<xref ref-type="bibr" rid="bib39">Hills et al., 2004</xref>) or “pivoting” (<xref ref-type="bibr" rid="bib101">Wakabayashi et al., 2004</xref>) is exhibited by well-fed worms within about 10 min after being transferred to a foodless plate; and (iii) ranging (“dispersal” (<xref ref-type="bibr" rid="bib35">Gray et al., 2005</xref>) or “traveling” (<xref ref-type="bibr" rid="bib101">Wakabayashi et al., 2004</xref>) is exhibited by well-fed worms tens of minutes after being transferred to a foodless plate. Each mode can be associated with approximate ranges of three parameters: mean forward run length (<inline-formula><mml:math id="inf742"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>), mean frequency of reversals (<inline-formula><mml:math id="inf743"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mtext>FPR</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>), and mean reverse run length (<inline-formula><mml:math id="inf744"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>). Local search serves as a useful reference point. During cropping, <inline-formula><mml:math id="inf745"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> is greatly reduced, <inline-formula><mml:math id="inf746"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mtext>FPR</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is greatly increased, and <inline-formula><mml:math id="inf747"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> is also reduced, being limited to “short reversals” (the distance traveled in one or two head sweeps, or about 0.5 mm (<xref ref-type="bibr" rid="bib35">Gray et al., 2005</xref>); during local search, reverse runs are almost always “long” (the distance traveled in at least three head sweeps). During ranging, <inline-formula><mml:math id="inf748"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> is greatly increased, <inline-formula><mml:math id="inf749"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mtext>RPF</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is reduced, and reversals are long. Cutoff values for search modes, inferred from behavioral data (<xref ref-type="bibr" rid="bib101">Wakabayashi et al., 2004</xref>; <xref ref-type="bibr" rid="bib35">Gray et al., 2005</xref>; <xref ref-type="bibr" rid="bib28">Fujiwara et al., 2002</xref>; <xref ref-type="bibr" rid="bib39">Hills et al., 2004</xref>) were: <italic>Dwelling</italic> – short forward run length (<inline-formula><mml:math id="inf750"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> &lt; 0.5 mm), high reversal frequency (<inline-formula><mml:math id="inf751"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mtext>FPR</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> &gt; 6.0/min), short reversals (<inline-formula><mml:math id="inf752"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> &lt; 0.5 mm); <italic>Local search</italic> – moderate forward run length (0.5 mm ≤ <inline-formula><mml:math id="inf753"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> &lt; 5.0 mm), moderate reversal frequency (2.0/min ≤ <inline-formula><mml:math id="inf754"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mtext>FPR</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> &lt; 6.0/min), non-short reversals (<inline-formula><mml:math id="inf755"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> ≥ 0.5 mm); R<italic>anging</italic> – long forward run length (<inline-formula><mml:math id="inf756"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>F</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> ≥ 5.0 mm), low reversal frequency (<inline-formula><mml:math id="inf757"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mtext>FPR</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>&lt; 2/min), non-short reversals (<inline-formula><mml:math id="inf758"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mtext>R</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> ≥ 0.5 mm).</p></sec><sec id="s4-14"><title>Data archive</title><p>All data and the analysis program are publicly available at doi:10.5061/dryad.35qv6.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>This research was supported by a grant MH051383 from the National Institute of Mental Health to SRL.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>WMR, Modeling, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con2"><p>SBA, Design and construction of tracking system, Acquisition of data</p></fn><fn fn-type="con" id="con3"><p>KJL, Behavior, Acquisition of data</p></fn><fn fn-type="con" id="con4"><p>THL, Electrophysiology, Acquisition of data</p></fn><fn fn-type="con" id="con5"><p>TRT, Neuronal ablations, Acquisition of data</p></fn><fn fn-type="con" id="con6"><p>EJI, Chemotaxis simulations, Analysis and interpretation of data</p></fn><fn fn-type="con" id="con7"><p>SF, Spotted worm tracking method, Acquisition of data</p></fn><fn fn-type="con" id="con8"><p>RAL, Behavior, Acquisition of data</p></fn><fn fn-type="con" id="con9"><p>MCB, Behavior, Acquisition of data</p></fn><fn fn-type="con" id="con10"><p>NP, Molecular biology, Contributed unpublished essential data or reagents</p></fn><fn fn-type="con" id="con11"><p>CIB, Molecular biology, Contributed unpublished essential data or reagents</p></fn><fn fn-type="con" id="con12"><p>SRL, Modeling, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><sec id="s7" sec-type="datasets"><title>Major datasets</title><p>The following datasets were generated:</p><p><related-object content-type="generated-dataset" id="dataro1" source-id="http://dx.doi.org/10.5061/dryad.35qv6" source-id-type="uri"><collab>Roberts WM</collab>, <collab>Augustine SB</collab>, <collab>Lawton KJ</collab>, <collab>Lindsay TH</collab>, <collab>Thiele TR</collab>, <collab>Izquierdo E</collab>, <collab>Faumont S</collab>, <collab>Lindsay RA</collab>, <collab>Britton MC</collab>, <collab>Pokala N</collab>, <collab>Bargmann CI</collab>, <collab>Lockery SR</collab><x>,</x> <year>2016</year><x>,</x><source>Data from: A stochastic neuronal model predicts random search behaviors at multiple spatial scales in C. elegans</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.35qv6">http://dx.doi.org/10.5061/dryad.35qv6</ext-link><x>,</x> <comment>Available at Dryad Digital Repository under a CC0 Public Domain Dedication</comment></related-object></p></sec></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abbott</surname><given-names>LF</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Theoretical neuroscience rising</article-title><source>Neuron</source><volume>60</volume><fpage>489</fpage><lpage>495</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2008.10.019</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bargmann</surname><given-names>CI</given-names></name><name><surname>Avery</surname><given-names>L</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Laser killing of cells in Caenorhabditis elegans</article-title><source>Methods in Cell Biology</source><volume>48</volume><fpage>225</fpage><lpage>250</lpage><pub-id pub-id-type="doi">10.1016/S0091-679X(08)61390-4</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ben Arous</surname><given-names>J</given-names></name><name><surname>Laffont</surname><given-names>S</given-names></name><name><surname>Chatenay</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Molecular and sensory basis of a food related two-state behavior in C. elegans</article-title><source>PloS One</source><volume>4</volume><elocation-id>e7584</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0007584</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bendesky</surname><given-names>A</given-names></name><name><surname>Tsunozaki</surname><given-names>M</given-names></name><name><surname>Rockman</surname><given-names>MV</given-names></name><name><surname>Kruglyak</surname><given-names>L</given-names></name><name><surname>Bargmann</surname><given-names>CI</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Catecholamine receptor polymorphisms affect decision-making in C. elegans</article-title><source>Nature</source><volume>472</volume><fpage>313</fpage><lpage>318</lpage><pub-id pub-id-type="doi">10.1038/nature09821</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berg</surname><given-names>HC</given-names></name><name><surname>Brown</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="1972">1972</year><article-title>Chemotaxis in Escherichia coli analysed by three-dimensional tracking</article-title><source>Nature</source><volume>239</volume><fpage>500</fpage><lpage>504</lpage><pub-id pub-id-type="doi">10.1038/239500a0</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bertrand</surname><given-names>S</given-names></name><name><surname>Bertrand</surname><given-names>A</given-names></name><name><surname>Guevara-Carrasco</surname><given-names>R</given-names></name><name><surname>Gerlotto</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Scale-invariant movements of fishermen: the same foraging strategy as natural predators</article-title><source>Ecological Applications : A Publication of the Ecological Society of America</source><volume>17</volume><fpage>331</fpage><lpage>337</lpage><pub-id pub-id-type="doi">10.1890/06-0303</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bhattacharya</surname><given-names>R</given-names></name><name><surname>Touroutine</surname><given-names>D</given-names></name><name><surname>Barbagallo</surname><given-names>B</given-names></name><name><surname>Climer</surname><given-names>J</given-names></name><name><surname>Lambert</surname><given-names>CM</given-names></name><name><surname>Clark</surname><given-names>CM</given-names></name><name><surname>Alkema</surname><given-names>MJ</given-names></name><name><surname>Francis</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A conserved dopamine-cholecystokinin signaling pathway shapes context-dependent Caenorhabditis elegans behavior</article-title><source>PLoS Genetics</source><volume>10</volume><elocation-id>e1004584</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1004584</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Block</surname><given-names>SM</given-names></name><name><surname>Segall</surname><given-names>JE</given-names></name><name><surname>Berg</surname><given-names>HC</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>Impulse responses in bacterial chemotaxis</article-title><source>Cell</source><volume>31</volume><fpage>215</fpage><lpage>226</lpage><pub-id pub-id-type="doi">10.1016/0092-8674(82)90421-4</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Boon</surname><given-names>JP</given-names></name><name><surname>Yip</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1980">1980</year><source> Molecular Hydrodynamics</source><publisher-name>Courier Dover Publications</publisher-name></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brenner</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1974">1974</year><article-title>The genetics of Caenorhabditis elegans</article-title><source>Genetics</source><volume>77</volume><fpage>71</fpage><lpage>94</lpage></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brockie</surname><given-names>PJ</given-names></name><name><surname>Mellem</surname><given-names>JE</given-names></name><name><surname>Hills</surname><given-names>T</given-names></name><name><surname>Madsen</surname><given-names>DM</given-names></name><name><surname>Maricq</surname><given-names>AV</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>The C. elegans glutamate receptor subunit NMR-1 is required for slow NMDA-activated currents that regulate reversal frequency during locomotion</article-title><source>Neuron</source><volume>31</volume><fpage>617</fpage><lpage>630</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(01)00394-4</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>CT</given-names></name><name><surname>Liebovitch</surname><given-names>LS</given-names></name><name><surname>Glendon</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Lvy flights in dobe ju/’hoansi foraging patternss</article-title><source>Human Ecology</source><volume>35</volume><fpage>129</fpage><lpage>138</lpage><pub-id pub-id-type="doi">10.1007/s10745-006-9083-4</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Böhm</surname><given-names>H</given-names></name><name><surname>Schildberger</surname><given-names>K</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Brain neurones involved in the control of walking in the cricket gryllus bimaculatus</article-title><source>Journal of Experimental Biology</source><volume>166</volume><fpage>113</fpage><lpage>130</lpage></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Calhoun</surname><given-names>AJ</given-names></name><name><surname>Chalasani</surname><given-names>SH</given-names></name><name><surname>Sharpee</surname><given-names>TO</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Maximally informative foraging by Caenorhabditis elegans</article-title><source>eLife</source><volume>3</volume><pub-id pub-id-type="doi">10.7554/eLife.04220</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Calhoun</surname><given-names>AJ</given-names></name><name><surname>Tong</surname><given-names>A</given-names></name><name><surname>Pokala</surname><given-names>N</given-names></name><name><surname>Fitzpatrick</surname><given-names>JA</given-names></name><name><surname>Sharpee</surname><given-names>TO</given-names></name><name><surname>Chalasani</surname><given-names>SH</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Neural Mechanisms for Evaluating Environmental Variability in Caenorhabditis elegans</article-title><source>Neuron</source><volume>86</volume><fpage>428</fpage><lpage>441</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.03.026</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chalasani</surname><given-names>SH</given-names></name><name><surname>Chronis</surname><given-names>N</given-names></name><name><surname>Tsunozaki</surname><given-names>M</given-names></name><name><surname>Gray</surname><given-names>JM</given-names></name><name><surname>Ramot</surname><given-names>D</given-names></name><name><surname>Goodman</surname><given-names>MB</given-names></name><name><surname>Bargmann</surname><given-names>CI</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Dissecting a circuit for olfactory behaviour in Caenorhabditis elegans</article-title><source>Nature</source><volume>450</volume><fpage>63</fpage><lpage>70</lpage><pub-id pub-id-type="doi">10.1038/nature06292</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chalfie</surname><given-names>M</given-names></name><name><surname>Sulston</surname><given-names>JE</given-names></name><name><surname>White</surname><given-names>JG</given-names></name><name><surname>Southgate</surname><given-names>E</given-names></name><name><surname>Thomson</surname><given-names>JN</given-names></name><name><surname>Brenner</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>The neural circuit for touch sensitivity in Caenorhabditis elegans</article-title><source>The Journal of Neuroscience</source><volume>5</volume><fpage>956</fpage><lpage>964</lpage></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Colquhoun</surname><given-names>D</given-names></name><name><surname>Hawkes</surname><given-names>AG</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>a q-matrix cookbook. how to write only one program to calculate the single-channel and macroscopic predictions for any kinetic mechanims</article-title><source>Single-Channel Recording</source><fpage>589</fpage><lpage>633</lpage><pub-id pub-id-type="doi">10.1007/978-1-4419-1229-9_20</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Croll</surname><given-names>NA</given-names></name></person-group><year iso-8601-date="1975">1975</year><article-title>Components and patterns in the behaviour of the nematode caenorhabditis elegans</article-title><source>Journal of Zoology</source><volume>176</volume><fpage>159</fpage><lpage>176</lpage><pub-id pub-id-type="doi">10.1111/j.1469-7998.1975.tb03191.x</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cronin</surname><given-names>CJ</given-names></name><name><surname>Mendel</surname><given-names>JE</given-names></name><name><surname>Mukhtar</surname><given-names>S</given-names></name><name><surname>Kim</surname><given-names>YM</given-names></name><name><surname>Stirbl</surname><given-names>RC</given-names></name><name><surname>Bruck</surname><given-names>J</given-names></name><name><surname>Sternberg</surname><given-names>PW</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>An automated system for measuring parameters of nematode sinusoidal movement</article-title><source>BMC Genetics</source><volume>6</volume><fpage>5</fpage><pub-id pub-id-type="doi">10.1186/1471-2156-6-5</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deliagina</surname><given-names>TG</given-names></name><name><surname>Zelenin</surname><given-names>PV</given-names></name><name><surname>Fagerstedt</surname><given-names>P</given-names></name><name><surname>Grillner</surname><given-names>S</given-names></name><name><surname>Orlovsky</surname><given-names>GN</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Activity of reticulospinal neurons during locomotion in the freely behaving lamprey</article-title><source>Journal of Neurophysiology</source><volume>83</volume><fpage>853</fpage><lpage>863</lpage></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dembrow</surname><given-names>NC</given-names></name><name><surname>Jing</surname><given-names>J</given-names></name><name><surname>Proekt</surname><given-names>A</given-names></name><name><surname>Romero</surname><given-names>A</given-names></name><name><surname>Vilim</surname><given-names>FS</given-names></name><name><surname>Cropper</surname><given-names>EC</given-names></name><name><surname>Weiss</surname><given-names>KR</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>A newly identified buccal interneuron initiates and modulates feeding motor programs in aplysia</article-title><source>Journal of Neurophysiology</source><volume>90</volume><fpage>2190</fpage><lpage>2204</lpage><pub-id pub-id-type="doi">10.1152/jn.00173.2003</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fang-Yen</surname><given-names>C</given-names></name><name><surname>Alkema</surname><given-names>MJ</given-names></name><name><surname>Samuel</surname><given-names>ADT</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Illuminating neural circuits and behaviour in <italic>caenorhabditis elegans</italic> with optogenetics</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>370</volume><fpage>20140212</fpage><pub-id pub-id-type="doi">10.1098/rstb.2014.0212</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faumont</surname><given-names>S</given-names></name><name><surname>Lindsay</surname><given-names>TH</given-names></name><name><surname>Lockery</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Neuronal microcircuits for decision making in C. elegans</article-title><source>Current Opinion in Neurobiology</source><volume>22</volume><fpage>580</fpage><lpage>591</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2012.05.005</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faumont</surname><given-names>S</given-names></name><name><surname>Rondeau</surname><given-names>G</given-names></name><name><surname>Thiele</surname><given-names>TR</given-names></name><name><surname>Lawton</surname><given-names>KJ</given-names></name><name><surname>McCormick</surname><given-names>KE</given-names></name><name><surname>Sottile</surname><given-names>M</given-names></name><name><surname>Griesbeck</surname><given-names>O</given-names></name><name><surname>Heckscher</surname><given-names>ES</given-names></name><name><surname>Roberts</surname><given-names>WM</given-names></name><name><surname>Doe</surname><given-names>CQ</given-names></name><name><surname>Lockery</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>An image-free opto-mechanical system for creating virtual environments and imaging neuronal activity in freely moving Caenorhabditis elegans</article-title><source>PloS One</source><volume>6</volume><elocation-id>e24666</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0024666</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flavell</surname><given-names>SW</given-names></name><name><surname>Pokala</surname><given-names>N</given-names></name><name><surname>Macosko</surname><given-names>EZ</given-names></name><name><surname>Albrecht</surname><given-names>DR</given-names></name><name><surname>Larsch</surname><given-names>J</given-names></name><name><surname>Bargmann</surname><given-names>CI</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Serotonin and the neuropeptide PDF initiate and extend opposing behavioral states in C. elegans</article-title><source>Cell</source><volume>154</volume><fpage>1023</fpage><lpage>1035</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2013.08.001</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fry</surname><given-names>AL</given-names></name><name><surname>Laboy</surname><given-names>JT</given-names></name><name><surname>Norman</surname><given-names>KR</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>VAV-1 acts in a single interneuron to inhibit motor circuit activity in Caenorhabditis elegans</article-title><source>Nature Communications</source><volume>5</volume><fpage>5579</fpage><pub-id pub-id-type="doi">10.1038/ncomms6579</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frézal</surname><given-names>L</given-names></name><name><surname>Félix</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>C. elegans outside the Petri dish</article-title><source>eLife</source><volume>4</volume><pub-id pub-id-type="doi">10.7554/eLife.05849</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fujiwara</surname><given-names>M</given-names></name><name><surname>Sengupta</surname><given-names>P</given-names></name><name><surname>McIntire</surname><given-names>SL</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Regulation of body size and behavioral state of C. elegans by sensory perception and the EGL-4 cGMP-dependent protein kinase</article-title><source>Neuron</source><volume>36</volume><fpage>1091</fpage><lpage>1102</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(02)01093-0</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname><given-names>S</given-names></name><name><surname>Xie</surname><given-names>L</given-names></name><name><surname>Kawano</surname><given-names>T</given-names></name><name><surname>Po</surname><given-names>MD</given-names></name><name><surname>Guan</surname><given-names>S</given-names></name><name><surname>Zhen</surname><given-names>M</given-names></name><name><surname>Pirri</surname><given-names>JK</given-names></name><name><surname>Alkema</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The NCA sodium leak channel is required for persistent motor circuit activity that sustains locomotion</article-title><source>Nature Communications</source><volume>6</volume><fpage>6323</fpage><pub-id pub-id-type="doi">10.1038/ncomms7323</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gloria-Soria</surname><given-names>A</given-names></name><name><surname>Azevedo</surname><given-names>RB</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>npr-1 Regulates foraging and dispersal strategies in Caenorhabditis elegans</article-title><source>Current Biology</source><volume>18</volume><fpage>1694</fpage><lpage>1699</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2008.09.043</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gordus</surname><given-names>A</given-names></name><name><surname>Pokala</surname><given-names>N</given-names></name><name><surname>Levy</surname><given-names>S</given-names></name><name><surname>Flavell</surname><given-names>SW</given-names></name><name><surname>Bargmann</surname><given-names>CI</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Feedback from network states generates variability in a probabilistic olfactory circuit</article-title><source>Cell</source><volume>161</volume><fpage>215</fpage><lpage>227</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.02.018</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gray</surname><given-names>J</given-names></name><name><surname>Lissmann</surname><given-names>HW</given-names></name></person-group><year iso-8601-date="1964">1964</year><article-title>The locomotion of nematodes</article-title><source>The Journal of Experimental Biology</source><volume>41</volume><fpage>135</fpage><lpage>154</lpage></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>GRAY</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1946">1946</year><article-title>The mechanism of locomotion in snakes</article-title><source>The Journal of Experimental Biology</source><volume>23</volume><fpage>101</fpage><lpage>120</lpage></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gray</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1953">1953</year><article-title>Undulatory propulsion</article-title><source>Quarterly Journal of Microscopical Science</source><volume>3</volume><fpage>551</fpage><lpage>578</lpage></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gray</surname><given-names>JM</given-names></name><name><surname>Hill</surname><given-names>JJ</given-names></name><name><surname>Bargmann</surname><given-names>CI</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>A circuit for navigation in Caenorhabditis elegans</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>102</volume><fpage>3184</fpage><lpage>3191</lpage><pub-id pub-id-type="doi">10.1073/pnas.0409009101</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hart</surname><given-names>AC</given-names></name><name><surname>Sims</surname><given-names>S</given-names></name><name><surname>Kaplan</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Synaptic code for sensory modalities revealed by C. elegans GLR-1 glutamate receptor</article-title><source>Nature</source><volume>378</volume><fpage>82</fpage><lpage>85</lpage><pub-id pub-id-type="doi">10.1038/378082a0</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harvey</surname><given-names>SC</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Non-dauer larval dispersal in <italic>caenorhabditis elegans</italic></article-title><source>Journal of Experimental Zoology Part B: Molecular and Developmental Evolution</source><volume>312B</volume><fpage>224</fpage><lpage>230</lpage><pub-id pub-id-type="doi">10.1002/jez.b.21287</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hedwig</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Control of cricket stridulation by a command neuron: efficacy depends on the behavioral state</article-title><source>Journal of Neurophysiology</source><volume>83</volume><fpage>712</fpage><lpage>722</lpage></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hills</surname><given-names>T</given-names></name><name><surname>Brockie</surname><given-names>PJ</given-names></name><name><surname>Maricq</surname><given-names>AV</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Dopamine and glutamate control area-restricted search behavior in Caenorhabditis elegans</article-title><source>The Journal of Neuroscience</source><volume>24</volume><fpage>1217</fpage><lpage>1225</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1569-03.2004</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hopfield</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>Neural networks and physical systems with emergent collective computational abilities</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>79</volume><fpage>2554</fpage><lpage>2558</lpage><pub-id pub-id-type="doi">10.1073/pnas.79.8.2554</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Humphries</surname><given-names>NE</given-names></name><name><surname>Queiroz</surname><given-names>N</given-names></name><name><surname>Dyer</surname><given-names>JR</given-names></name><name><surname>Pade</surname><given-names>NG</given-names></name><name><surname>Musyl</surname><given-names>MK</given-names></name><name><surname>Schaefer</surname><given-names>KM</given-names></name><name><surname>Fuller</surname><given-names>DW</given-names></name><name><surname>Brunnschweiler</surname><given-names>JM</given-names></name><name><surname>Doyle</surname><given-names>TK</given-names></name><name><surname>Houghton</surname><given-names>JD</given-names></name><name><surname>Hays</surname><given-names>GC</given-names></name><name><surname>Jones</surname><given-names>CS</given-names></name><name><surname>Noble</surname><given-names>LR</given-names></name><name><surname>Wearmouth</surname><given-names>VJ</given-names></name><name><surname>Southall</surname><given-names>EJ</given-names></name><name><surname>Sims</surname><given-names>DW</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Environmental context explains Lévy and Brownian movement patterns of marine predators</article-title><source>Nature</source><volume>465</volume><fpage>1066</fpage><lpage>1069</lpage><pub-id pub-id-type="doi">10.1038/nature09116</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Humphries</surname><given-names>NE</given-names></name><name><surname>Sims</surname><given-names>DW</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Optimal foraging strategies: Lévy walks balance searching and patch exploitation under a very broad range of conditions</article-title><source>Journal of Theoretical Biology</source><volume>358</volume><fpage>179</fpage><lpage>193</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2014.05.032</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Humphries</surname><given-names>NE</given-names></name><name><surname>Weimerskirch</surname><given-names>H</given-names></name><name><surname>Queiroz</surname><given-names>N</given-names></name><name><surname>Southall</surname><given-names>EJ</given-names></name><name><surname>Sims</surname><given-names>DW</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Foraging success of biological Lévy flights recorded in situ</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>109</volume><fpage>7169</fpage><lpage>7174</lpage><pub-id pub-id-type="doi">10.1073/pnas.1121201109</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iino</surname><given-names>Y</given-names></name><name><surname>Yoshida</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Parallel use of two behavioral mechanisms for chemotaxis in Caenorhabditis elegans</article-title><source>The Journal of Neuroscience</source><volume>29</volume><fpage>5370</fpage><lpage>5380</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3633-08.2009</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jander</surname><given-names>R</given-names></name></person-group><year iso-8601-date="1975">1975</year><article-title>Ecological aspects of spatial orientation</article-title><source>Annual Review of Ecology and Systematics</source><volume>6</volume><fpage>171</fpage><lpage>188</lpage><pub-id pub-id-type="doi">10.1146/annurev.es.06.110175.001131</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kato</surname><given-names>S</given-names></name><name><surname>Kaplan</surname><given-names>HS</given-names></name><name><surname>Schrödel</surname><given-names>T</given-names></name><name><surname>Skora</surname><given-names>S</given-names></name><name><surname>Lindsay</surname><given-names>TH</given-names></name><name><surname>Yemini</surname><given-names>E</given-names></name><name><surname>Lockery</surname><given-names>S</given-names></name><name><surname>Zimmer</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Global brain dynamics embed the motor command sequence of Caenorhabditis elegans</article-title><source>Cell</source><volume>163</volume><fpage>656</fpage><lpage>669</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.09.034</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kawano</surname><given-names>T</given-names></name><name><surname>Po</surname><given-names>MD</given-names></name><name><surname>Gao</surname><given-names>S</given-names></name><name><surname>Leung</surname><given-names>G</given-names></name><name><surname>Ryu</surname><given-names>WS</given-names></name><name><surname>Zhen</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>An imbalancing act: gap junctions reduce the backward motor circuit activity to bias C. elegans for forward locomotion</article-title><source>Neuron</source><volume>72</volume><fpage>572</fpage><lpage>586</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.09.005</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kocabas</surname><given-names>A</given-names></name><name><surname>Shen</surname><given-names>CH</given-names></name><name><surname>Guo</surname><given-names>ZV</given-names></name><name><surname>Ramanathan</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Controlling interneuron activity in Caenorhabditis elegans to evoke chemotactic behaviour</article-title><source>Nature</source><volume>490</volume><fpage>273</fpage><lpage>277</lpage><pub-id pub-id-type="doi">10.1038/nature11431</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kunert</surname><given-names>J</given-names></name><name><surname>Shlizerman</surname><given-names>E</given-names></name><name><surname>Kutz</surname><given-names>JN</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Low-dimensional functionality of complex network dynamics: neurosensory integration in the Caenorhabditis Elegans connectome</article-title><source>Physical Review. E, Statistical, Nonlinear, and Soft Matter Physics</source><volume>89</volume><pub-id pub-id-type="doi">10.1103/PhysRevE.89.052805</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>W</given-names></name><name><surname>Feng</surname><given-names>Z</given-names></name><name><surname>Sternberg</surname><given-names>PW</given-names></name><name><surname>Xu</surname><given-names>XZ</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>A C. elegans stretch receptor neuron revealed by a mechanosensitive TRP channel homologue</article-title><source>Nature</source><volume>440</volume><fpage>684</fpage><lpage>687</lpage><pub-id pub-id-type="doi">10.1038/nature04538</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lindsay</surname><given-names>TH</given-names></name><name><surname>Thiele</surname><given-names>TR</given-names></name><name><surname>Lockery</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Optogenetic analysis of synaptic transmission in the central nervous system of the nematode Caenorhabditis elegans</article-title><source>Nature Communications</source><volume>2</volume><fpage>306</fpage><pub-id pub-id-type="doi">10.1038/ncomms1304</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lipton</surname><given-names>J</given-names></name><name><surname>Kleemann</surname><given-names>G</given-names></name><name><surname>Ghosh</surname><given-names>R</given-names></name><name><surname>Lints</surname><given-names>R</given-names></name><name><surname>Emmons</surname><given-names>SW</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Mate searching in Caenorhabditis elegans: a genetic model for sex drive in a simple invertebrate</article-title><source>The Journal of Neuroscience</source><volume>24</volume><fpage>7427</fpage><lpage>7434</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1746-04.2004</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>P</given-names></name><name><surname>Chen</surname><given-names>B</given-names></name><name><surname>Wang</surname><given-names>ZW</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>SLO-2 potassium channel is an important regulator of neurotransmitter release in Caenorhabditis elegans</article-title><source>Nature Communications</source><volume>5</volume><fpage>5155</fpage><pub-id pub-id-type="doi">10.1038/ncomms6155</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Schulze</surname><given-names>E</given-names></name><name><surname>Baumeister</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Temperature- and touch-sensitive neurons couple CNG and TRPV channel activities to control heat avoidance in Caenorhabditis elegans</article-title><source>PloS One</source><volume>7</volume><elocation-id>e32360</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0032360</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lo</surname><given-names>CC</given-names></name><name><surname>Chou</surname><given-names>T</given-names></name><name><surname>Penzel</surname><given-names>T</given-names></name><name><surname>Scammell</surname><given-names>TE</given-names></name><name><surname>Strecker</surname><given-names>RE</given-names></name><name><surname>Stanley</surname><given-names>HE</given-names></name><name><surname>Ivanov</surname><given-names>PCh</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Common scale-invariant patterns of sleep-wake transitions across mammalian species</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>101</volume><fpage>17545</fpage><lpage>17548</lpage><pub-id pub-id-type="doi">10.1073/pnas.0408242101</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lockery</surname><given-names>SR</given-names></name><name><surname>Goodman</surname><given-names>MB</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Tight-seal whole-cell patch clamping of Caenorhabditis elegans neurons</article-title><source>Methods in Enzymology</source><volume>293</volume><fpage>201</fpage><lpage>217</lpage><pub-id pub-id-type="doi">10.1016/S0076-6879(98)93016-6</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lockery</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The computational worm: spatial orientation and its neuronal basis in C. elegans</article-title><source>Current Opinion in Neurobiology</source><volume>21</volume><fpage>782</fpage><lpage>790</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2011.06.009</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname><given-names>L</given-names></name><name><surname>Wen</surname><given-names>Q</given-names></name><name><surname>Ren</surname><given-names>J</given-names></name><name><surname>Hendricks</surname><given-names>M</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Qin</surname><given-names>Y</given-names></name><name><surname>Greenwood</surname><given-names>J</given-names></name><name><surname>Soucy</surname><given-names>ER</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Smith-Parker</surname><given-names>HK</given-names></name><name><surname>Calvo</surname><given-names>AC</given-names></name><name><surname>Colón-Ramos</surname><given-names>DA</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Dynamic encoding of perception, memory, and movement in a C. elegans chemotaxis circuit</article-title><source>Neuron</source><volume>82</volume><fpage>1115</fpage><lpage>1128</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.05.010</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mantegna</surname><given-names>RN</given-names></name><name><surname>Stanley</surname><given-names>HE</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Stochastic process with ultraslow convergence to a Gaussian: The truncated Lévy flight</article-title><source>Physical Review Letters</source><volume>73</volume><fpage>2946</fpage><lpage>2949</lpage><pub-id pub-id-type="doi">10.1103/PhysRevLett.73.2946</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mellem</surname><given-names>JE</given-names></name><name><surname>Brockie</surname><given-names>PJ</given-names></name><name><surname>Madsen</surname><given-names>DM</given-names></name><name><surname>Maricq</surname><given-names>AV</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Action potentials contribute to neuronal signaling in C. elegans</article-title><source>Nature Neuroscience</source><volume>11</volume><fpage>865</fpage><lpage>867</lpage><pub-id pub-id-type="doi">10.1038/nn.2131</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mello</surname><given-names>C</given-names></name><name><surname>Fire</surname><given-names>A</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>DNA transformation</article-title><source>Methods in Cell Biology</source><volume>48</volume><fpage>451</fpage><lpage>482</lpage><pub-id pub-id-type="doi">10.1016/S0091-679X(08)61399-0</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mohammadi</surname><given-names>A</given-names></name><name><surname>Byrne Rodgers</surname><given-names>J</given-names></name><name><surname>Kotera</surname><given-names>I</given-names></name><name><surname>Ryu</surname><given-names>WS</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Behavioral response of Caenorhabditis elegans to localized thermal stimuli</article-title><source>BMC Neuroscience</source><volume>14</volume><fpage>66</fpage><pub-id pub-id-type="doi">10.1186/1471-2202-14-66</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nguyen</surname><given-names>JP</given-names></name><name><surname>Shipley</surname><given-names>FB</given-names></name><name><surname>Linder</surname><given-names>AN</given-names></name><name><surname>Plummer</surname><given-names>GS</given-names></name><name><surname>Liu</surname><given-names>M</given-names></name><name><surname>Setru</surname><given-names>SU</given-names></name><name><surname>Shaevitz</surname><given-names>JW</given-names></name><name><surname>Leifer</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Whole-brain calcium imaging with cellular resolution in freely behaving caenorhabditis elegans</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><fpage>201507110</fpage><pub-id pub-id-type="doi">10.1073/pnas.1507110112</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peliti</surname><given-names>M</given-names></name><name><surname>Chuang</surname><given-names>JS</given-names></name><name><surname>Shaham</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Directional locomotion of C. elegans in the absence of external stimuli</article-title><source>PloS One</source><volume>8</volume><elocation-id>e78535</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0078535</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pereira</surname><given-names>L</given-names></name><name><surname>Kratsios</surname><given-names>P</given-names></name><name><surname>Serrano-Saiz</surname><given-names>E</given-names></name><name><surname>Sheftel</surname><given-names>H</given-names></name><name><surname>Mayo</surname><given-names>AE</given-names></name><name><surname>Hall</surname><given-names>DH</given-names></name><name><surname>White</surname><given-names>JG</given-names></name><name><surname>LeBoeuf</surname><given-names>B</given-names></name><name><surname>Garcia</surname><given-names>LR</given-names></name><name><surname>Alon</surname><given-names>U</given-names></name><name><surname>Hobert</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A cellular and regulatory map of the cholinergic nervous system of <italic>C. elegans</italic></article-title><source>eLife</source><volume>4</volume><pub-id pub-id-type="doi">10.7554/eLife.12432</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pierce-Shimomura</surname><given-names>JT</given-names></name><name><surname>Morse</surname><given-names>TM</given-names></name><name><surname>Lockery</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>The fundamental role of pirouettes in Caenorhabditis elegans chemotaxis</article-title><source>The Journal of Neuroscience</source><volume>19</volume><fpage>9557</fpage><lpage>9569</lpage></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Piggott</surname><given-names>BJ</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Feng</surname><given-names>Z</given-names></name><name><surname>Wescott</surname><given-names>SA</given-names></name><name><surname>Xu</surname><given-names>XZ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The neural circuits and synaptic mechanisms underlying motor initiation in C. elegans</article-title><source>Cell</source><volume>147</volume><fpage>922</fpage><lpage>933</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2011.08.053</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pokala</surname><given-names>N</given-names></name><name><surname>Liu</surname><given-names>Q</given-names></name><name><surname>Gordus</surname><given-names>A</given-names></name><name><surname>Bargmann</surname><given-names>CI</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Inducible and titratable silencing of Caenorhabditis elegans neurons in vivo with histamine-gated chloride channels</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>111</volume><fpage>2770</fpage><lpage>2775</lpage><pub-id pub-id-type="doi">10.1073/pnas.1400615111</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pradel</surname><given-names>E</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Pujol</surname><given-names>N</given-names></name><name><surname>Matsuyama</surname><given-names>T</given-names></name><name><surname>Bargmann</surname><given-names>CI</given-names></name><name><surname>Ewbank</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Detection and avoidance of a natural product from the pathogenic bacterium Serratia marcescens by Caenorhabditis elegans</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>104</volume><fpage>2295</fpage><lpage>2300</lpage><pub-id pub-id-type="doi">10.1073/pnas.0610281104</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prevedel</surname><given-names>R</given-names></name><name><surname>Yoon</surname><given-names>YG</given-names></name><name><surname>Hoffmann</surname><given-names>M</given-names></name><name><surname>Pak</surname><given-names>N</given-names></name><name><surname>Wetzstein</surname><given-names>G</given-names></name><name><surname>Kato</surname><given-names>S</given-names></name><name><surname>Schrödel</surname><given-names>T</given-names></name><name><surname>Raskar</surname><given-names>R</given-names></name><name><surname>Zimmer</surname><given-names>M</given-names></name><name><surname>Boyden</surname><given-names>ES</given-names></name><name><surname>Vaziri</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Simultaneous whole-animal 3D imaging of neuronal activity using light-field microscopy</article-title><source>Nature Methods</source><volume>11</volume><fpage>727</fpage><lpage>730</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2964</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pujol</surname><given-names>N</given-names></name><name><surname>Link</surname><given-names>EM</given-names></name><name><surname>Liu</surname><given-names>LX</given-names></name><name><surname>Kurz</surname><given-names>CL</given-names></name><name><surname>Alloing</surname><given-names>G</given-names></name><name><surname>Tan</surname><given-names>MW</given-names></name><name><surname>Ray</surname><given-names>KP</given-names></name><name><surname>Solari</surname><given-names>R</given-names></name><name><surname>Johnson</surname><given-names>CD</given-names></name><name><surname>Ewbank</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>A reverse genetic analysis of components of the Toll signaling pathway in Caenorhabditis elegans</article-title><source>Current Biology</source><volume>11</volume><fpage>809</fpage><lpage>821</lpage><pub-id pub-id-type="doi">10.1016/S0960-9822(01)00241-X</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qi</surname><given-names>YB</given-names></name><name><surname>Garren</surname><given-names>EJ</given-names></name><name><surname>Shu</surname><given-names>X</given-names></name><name><surname>Tsien</surname><given-names>RY</given-names></name><name><surname>Jin</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Photo-inducible cell ablation in Caenorhabditis elegans using the genetically encoded singlet oxygen generating protein miniSOG</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>109</volume><fpage>7499</fpage><lpage>7504</lpage><pub-id pub-id-type="doi">10.1073/pnas.1204096109</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qi</surname><given-names>YB</given-names></name><name><surname>Po</surname><given-names>MD</given-names></name><name><surname>Mac</surname><given-names>P</given-names></name><name><surname>Kawano</surname><given-names>T</given-names></name><name><surname>Jorgensen</surname><given-names>EM</given-names></name><name><surname>Zhen</surname><given-names>M</given-names></name><name><surname>Jin</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Hyperactivation of B-type motor neurons results in aberrant synchrony of the Caenorhabditis elegans motor circuit</article-title><source>The Journal of Neuroscience</source><volume>33</volume><fpage>5319</fpage><lpage>5325</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4017-12.2013</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rabiner</surname><given-names>L</given-names></name><name><surname>Juang</surname><given-names>B</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>An introduction to hidden markov models</article-title><source>IEEE ASSP Magazine</source><volume>3</volume><fpage>4</fpage><lpage>16</lpage><pub-id pub-id-type="doi">10.1109/MASSP.1986.1165342</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rabiner</surname><given-names>LR</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>A tutorial on hidden markov models and selected applications in speech recognition</article-title><source>Proceedings of the IEEE</source><volume>77</volume><fpage>257</fpage><lpage>286</lpage><pub-id pub-id-type="doi">10.1109/5.18626</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rakowski</surname><given-names>F</given-names></name><name><surname>Srinivasan</surname><given-names>J</given-names></name><name><surname>Sternberg</surname><given-names>PW</given-names></name><name><surname>Karbowski</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Synaptic polarity of the interneuron circuit controlling C. elegans locomotion</article-title><source>Frontiers in Computational Neuroscience</source><volume>7</volume><pub-id pub-id-type="doi">10.3389/fncom.2013.00128</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reddy</surname><given-names>KC</given-names></name><name><surname>Andersen</surname><given-names>EC</given-names></name><name><surname>Kruglyak</surname><given-names>L</given-names></name><name><surname>Kim</surname><given-names>DH</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>A polymorphism in npr-1 is a behavioral determinant of pathogen susceptibility in C. elegans</article-title><source>Science</source><volume>323</volume><fpage>382</fpage><lpage>384</lpage><pub-id pub-id-type="doi">10.1126/science.1166527</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ryu</surname><given-names>WS</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Thermotaxis in Caenorhabditis elegans analyzed by measuring responses to defined Thermal stimuli</article-title><source>The Journal of Neuroscience</source><volume>22</volume><fpage>5727</fpage><lpage>5733</lpage></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salvador</surname><given-names>LCM</given-names></name><name><surname>Bartumeus</surname><given-names>F</given-names></name><name><surname>Levin</surname><given-names>SA</given-names></name><name><surname>Ryu</surname><given-names>WS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Mechanistic analysis of the search behaviour of caenorhabditis elegans</article-title><source>Journal of the Royal Society Interface</source><volume>11</volume><fpage>20131092</fpage><pub-id pub-id-type="doi">10.1098/rsif.2013.1092</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saper</surname><given-names>CB</given-names></name><name><surname>Fuller</surname><given-names>PM</given-names></name><name><surname>Pedersen</surname><given-names>NP</given-names></name><name><surname>Lu</surname><given-names>J</given-names></name><name><surname>Scammell</surname><given-names>TE</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Sleep state switching</article-title><source>Neuron</source><volume>68</volume><fpage>1023</fpage><lpage>1042</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2010.11.032</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Satterlie</surname><given-names>RA</given-names></name><name><surname>Norekian</surname><given-names>TP</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Mechanisms of locomotory speed change: the pteropod solution</article-title><source>American Zoologist</source><volume>41</volume><fpage>1001</fpage><lpage>1008</lpage><pub-id pub-id-type="doi">10.1093/icb/41.4.1001</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmitt</surname><given-names>C</given-names></name><name><surname>Schultheis</surname><given-names>C</given-names></name><name><surname>Pokala</surname><given-names>N</given-names></name><name><surname>Husson</surname><given-names>SJ</given-names></name><name><surname>Liewald</surname><given-names>JF</given-names></name><name><surname>Bargmann</surname><given-names>CI</given-names></name><name><surname>Gottschalk</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Specific expression of channelrhodopsin-2 in single neurons of Caenorhabditis elegans</article-title><source>PloS One</source><volume>7</volume><elocation-id>e43164</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0043164</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schrödel</surname><given-names>T</given-names></name><name><surname>Prevedel</surname><given-names>R</given-names></name><name><surname>Aumayr</surname><given-names>K</given-names></name><name><surname>Zimmer</surname><given-names>M</given-names></name><name><surname>Vaziri</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Brain-wide 3D imaging of neuronal activity in Caenorhabditis elegans with sculpted light</article-title><source>Nature Methods</source><volume>10</volume><fpage>1013</fpage><lpage>1020</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2637</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shingai</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Durations and frequencies of free locomotion in wild type and GABAergic mutants of Caenorhabditis elegans</article-title><source>Neuroscience Research</source><volume>38</volume><fpage>71</fpage><lpage>84</lpage><pub-id pub-id-type="doi">10.1016/S0168-0102(00)00148-6</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shtonda</surname><given-names>BB</given-names></name><name><surname>Avery</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Dietary choice behavior in Caenorhabditis elegans</article-title><source>The Journal of Experimental Biology</source><volume>209</volume><fpage>89</fpage><lpage>102</lpage><pub-id pub-id-type="doi">10.1242/jeb.01955</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sims</surname><given-names>DW</given-names></name><name><surname>Humphries</surname><given-names>NE</given-names></name><name><surname>Bradford</surname><given-names>RW</given-names></name><name><surname>Bruce</surname><given-names>BD</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Lévy flight and Brownian search patterns of a free-ranging predator reflect different prey field characteristics</article-title><source>The Journal of Animal Ecology</source><volume>81</volume><fpage>432</fpage><lpage>442</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2656.2011.01914.x</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sirota</surname><given-names>MG</given-names></name><name><surname>Di Prisco</surname><given-names>GV</given-names></name><name><surname>Dubuc</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Stimulation of the mesencephalic locomotor region elicits controlled swimming in semi-intact lampreys</article-title><source>The European Journal of Neuroscience</source><volume>12</volume><fpage>4081</fpage><lpage>4092</lpage><pub-id pub-id-type="doi">10.1046/j.1460-9568.2000.00301.x</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stephens</surname><given-names>GJ</given-names></name><name><surname>Bueno de Mesquita</surname><given-names>M</given-names></name><name><surname>Ryu</surname><given-names>WS</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Emergence of long timescales and stereotyped behaviors in Caenorhabditis elegans</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>108</volume><fpage>7286</fpage><lpage>7289</lpage><pub-id pub-id-type="doi">10.1073/pnas.1007868108</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stephens</surname><given-names>GJ</given-names></name><name><surname>Johnson-Kerner</surname><given-names>B</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name><name><surname>Ryu</surname><given-names>WS</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Dimensionality and dynamics in the behavior of C. elegans</article-title><source>PLoS Computational Biology</source><volume>4</volume><elocation-id>e1000028</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000028</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stephens</surname><given-names>GJ</given-names></name><name><surname>Johnson-Kerner</surname><given-names>B</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name><name><surname>Ryu</surname><given-names>WS</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>From modes to movement in the behavior of Caenorhabditis elegans</article-title><source>PloS One</source><volume>5</volume><elocation-id>e13914</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0013914</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Stiller</surname><given-names>W</given-names></name></person-group><year iso-8601-date="1989">1989</year><source>Arrhenius Equation and Non-Equilibrium Kinetics: 100 Years Arrhenius Equation</source><publisher-name>BSB BG Teubner</publisher-name></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stirman</surname><given-names>JN</given-names></name><name><surname>Brauner</surname><given-names>M</given-names></name><name><surname>Gottschalk</surname><given-names>A</given-names></name><name><surname>Lu</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>High-throughput study of synaptic transmission at the neuromuscular junction enabled by optogenetics and microfluidics</article-title><source>Journal of Neuroscience Methods</source><volume>191</volume><fpage>90</fpage><lpage>93</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2010.05.019</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Styer</surname><given-names>KL</given-names></name><name><surname>Singh</surname><given-names>V</given-names></name><name><surname>Macosko</surname><given-names>E</given-names></name><name><surname>Steele</surname><given-names>SE</given-names></name><name><surname>Bargmann</surname><given-names>CI</given-names></name><name><surname>Aballay</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Innate immunity in Caenorhabditis elegans is regulated by neurons expressing NPR-1/GPCR</article-title><source>Science</source><volume>322</volume><fpage>460</fpage><lpage>464</lpage><pub-id pub-id-type="doi">10.1126/science.1163673</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suzuki</surname><given-names>H</given-names></name><name><surname>Thiele</surname><given-names>TR</given-names></name><name><surname>Faumont</surname><given-names>S</given-names></name><name><surname>Ezcurra</surname><given-names>M</given-names></name><name><surname>Lockery</surname><given-names>SR</given-names></name><name><surname>Schafer</surname><given-names>WR</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Functional asymmetry in Caenorhabditis elegans taste neurons and its computational role in chemotaxis</article-title><source>Nature</source><volume>454</volume><fpage>114</fpage><lpage>117</lpage><pub-id pub-id-type="doi">10.1038/nature06927</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thiele</surname><given-names>TR</given-names></name><name><surname>Faumont</surname><given-names>S</given-names></name><name><surname>Lockery</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The neural network for chemotaxis to tastants in Caenorhabditis elegans is specialized for temporal differentiation</article-title><source>The Journal of Neuroscience</source><volume>29</volume><fpage>11904</fpage><lpage>11911</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0594-09.2009</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tobin</surname><given-names>DM</given-names></name><name><surname>Madsen</surname><given-names>DM</given-names></name><name><surname>Kahn-Kirby</surname><given-names>A</given-names></name><name><surname>Peckol</surname><given-names>EL</given-names></name><name><surname>Moulder</surname><given-names>G</given-names></name><name><surname>Barstead</surname><given-names>R</given-names></name><name><surname>Maricq</surname><given-names>AV</given-names></name><name><surname>Bargmann</surname><given-names>CI</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Combinatorial expression of TRPV channel proteins defines their sensory functions and subcellular localization in C. elegans neurons</article-title><source>Neuron</source><volume>35</volume><fpage>307</fpage><lpage>318</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(02)00757-2</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsalik</surname><given-names>EL</given-names></name><name><surname>Hobert</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Functional mapping of neurons that control locomotory behavior in Caenorhabditis elegans</article-title><source>Journal of Neurobiology</source><volume>56</volume><fpage>178</fpage><lpage>197</lpage><pub-id pub-id-type="doi">10.1002/neu.10245</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Varshney</surname><given-names>LR</given-names></name><name><surname>Chen</surname><given-names>BL</given-names></name><name><surname>Paniagua</surname><given-names>E</given-names></name><name><surname>Hall</surname><given-names>DH</given-names></name><name><surname>Chklovskii</surname><given-names>DB</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Structural properties of the Caenorhabditis elegans neuronal network</article-title><source>PLoS Computational Biology</source><volume>7</volume><elocation-id>e1001066</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1001066</pub-id></element-citation></ref><ref id="bib100"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Venkatachalam</surname><given-names>V</given-names></name><name><surname>Ji</surname><given-names>N</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Clark</surname><given-names>C</given-names></name><name><surname>Mitchell</surname><given-names>JK</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Tabone</surname><given-names>CJ</given-names></name><name><surname>Florman</surname><given-names>J</given-names></name><name><surname>Ji</surname><given-names>H</given-names></name><name><surname>Greenwood</surname><given-names>J</given-names></name><name><surname>Chisholm</surname><given-names>AD</given-names></name><name><surname>Srinivasan</surname><given-names>J</given-names></name><name><surname>Alkema</surname><given-names>M</given-names></name><name><surname>Zhen</surname><given-names>M</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Pan-neuronal imaging in roaming Caenorhabditis elegans</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>113</volume><pub-id pub-id-type="doi">10.1073/pnas.1507109113</pub-id></element-citation></ref><ref id="bib101"><element-citation publication-type="other"><person-group person-group-type="author"><name><surname>Viswanathan</surname><given-names>GM</given-names></name></person-group><year iso-8601-date="2011">2011</year><chapter-title>The physics of foraging: an introduction to random searches and biological encounters</chapter-title><publisher-name>Cambridge University Press</publisher-name></element-citation></ref><ref id="bib102"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Viterbi</surname><given-names>A</given-names></name></person-group><year iso-8601-date="1967">1967</year><article-title>Error bounds for convolutional codes and an asymptotically optimum decoding algorithm</article-title><source>IEEE Transactions on Information Theory</source><volume>13</volume><fpage>260</fpage><lpage>269</lpage><pub-id pub-id-type="doi">10.1109/TIT.1967.1054010</pub-id></element-citation></ref><ref id="bib103"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wakabayashi</surname><given-names>T</given-names></name><name><surname>Kitagawa</surname><given-names>I</given-names></name><name><surname>Shingai</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Neurons regulating the duration of forward locomotion in Caenorhabditis elegans</article-title><source>Neuroscience Research</source><volume>50</volume><fpage>103</fpage><lpage>111</lpage><pub-id pub-id-type="doi">10.1016/j.neures.2004.06.005</pub-id></element-citation></ref><ref id="bib104"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weeks</surname><given-names>JC</given-names></name><name><surname>Kristan</surname> <given-names>WB</given-names> </name></person-group><year iso-8601-date="1978">1978</year><article-title>Initiation maintenance and modulation of swimming in the medicinal leech by the activity of a single neurone</article-title><source>the Journal of Experimental Biology</source><volume>77</volume><fpage>71</fpage><lpage>88</lpage></element-citation></ref><ref id="bib105"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>White</surname><given-names>JG</given-names></name><name><surname>Southgate</surname><given-names>E</given-names></name><name><surname>Thomson</surname><given-names>JN</given-names></name><name><surname>Brenner</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>The structure of the nervous system of the nematode caenorhabditis elegans</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>314</volume><fpage>1</fpage><lpage>340</lpage><pub-id pub-id-type="doi">10.1098/rstb.1986.0056</pub-id></element-citation></ref><ref id="bib106"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wicks</surname><given-names>SR</given-names></name><name><surname>Roehrig</surname><given-names>CJ</given-names></name><name><surname>Rankin</surname><given-names>CH</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>A dynamic network simulation of the nematode tap withdrawal circuit: predictions concerning synaptic function using behavioral criteria</article-title><source>The Journal of Neuroscience</source><volume>16</volume><fpage>4017</fpage><lpage>4031</lpage></element-citation></ref><ref id="bib107"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wittenburg</surname><given-names>N</given-names></name><name><surname>Baumeister</surname><given-names>R</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Thermal avoidance in Caenorhabditis elegans: an approach to the study of nociception</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>96</volume><fpage>10477</fpage><lpage>10482</lpage><pub-id pub-id-type="doi">10.1073/pnas.96.18.10477</pub-id></element-citation></ref><ref id="bib108"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xie</surname><given-names>L</given-names></name><name><surname>Gao</surname><given-names>S</given-names></name><name><surname>Alcaire</surname><given-names>SM</given-names></name><name><surname>Aoyagi</surname><given-names>K</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Griffin</surname><given-names>JK</given-names></name><name><surname>Stagljar</surname><given-names>I</given-names></name><name><surname>Nagamatsu</surname><given-names>S</given-names></name><name><surname>Zhen</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>NLF-1 delivers a sodium leak channel to regulate neuronal excitability and modulate rhythmic locomotion</article-title><source>Neuron</source><volume>77</volume><fpage>1069</fpage><lpage>1082</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.01.018</pub-id></element-citation></ref><ref id="bib109"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>B</given-names></name><name><surname>Khare</surname><given-names>P</given-names></name><name><surname>Feldman</surname><given-names>L</given-names></name><name><surname>Dent</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Reversal frequency in Caenorhabditis elegans represents an integrated response to the state of the animal and its environment</article-title><source>The Journal of Neuroscience</source><volume>23</volume><fpage>5319</fpage><lpage>5328</lpage></element-citation></ref><ref id="bib110"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>Y</given-names></name><name><surname>Brockie</surname><given-names>PJ</given-names></name><name><surname>Mellem</surname><given-names>JE</given-names></name><name><surname>Madsen</surname><given-names>DM</given-names></name><name><surname>Maricq</surname><given-names>AV</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Neuronal control of locomotion in C. elegans is modified by a dominant mutation in the GLR-1 ionotropic glutamate receptor</article-title><source>Neuron</source><volume>24</volume><fpage>347</fpage><lpage>361</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(00)80849-1</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.12572.032</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Reviewing editor</role><aff id="aff12"><institution>Emory University</institution>, <country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your work entitled &quot;A stochastic neuronal model predicts random search behaviors at multiple spatial scales in <italic>C. elegans</italic>&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by favorably evaluated by Eve Marder (Senior Editor) and three reviewers, one of whom, Ronald L. Calabrese, is a member of our Board of Reviewing Editors.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>The authors present a kinematic analysis of random local search behavior in <italic>C. elegans</italic> at high resolution. This analysis leads to a Markov model of underlying neuronal network based on the <italic>C. elegans</italic> connectome. This inherently stochastic model not only accounts for the data but also predicts the sign and strengths of key connections which are then confirmed by electrophysiology/optogenetics. The model can be adjusted easily to account for other types of random searches by adjusting parameters compatible with sensory input or modulation. Further the model can be expanded to incorporate directed searches as in chemotaxis and can also account for 'deterministic' behavior such as escape movements. The model also accounts for counter intuitive results on dwell times associated with genetic manipulation and laser ablation of key command neurons. These findings conceptually inform experiments in the mammalian sleep network. Altogether this work is an impressive display of the power of modeling when combined with detailed experimental manipulation. The authors make a strong effort to cast their results in the context of other efforts to measure search motion and define pause states. They also explicitly address more neuronal-based determinist models of the network underlying random searches.</p><p>Essential revisions:</p><p>1) Results, second paragraph: The claim that this study represents &quot;a 10-fold improvement over previously published tracking systems&quot; seems to be a stretch. In some sense, centerline-tracking experiments operate at a much finer resolution than tracking a single dot on a worm, with papers such as Brown, et al., PNAS (2013) tracking many more worms with more detail and higher resolution. I agree that the authors appear to have done a fine job at spot tracking, but we don't believe that they have a claim to novelty here.</p><p>2) The authors should address the Stephens et al. (2011) paper in a different manner than they do here (particularly in the Discussion section, fifth paragraph). To begin with, the statement that the &quot;mathematical relationship between tangential velocity and phase velocity (so defined) has not been delineated, but is likely to be complex&quot; largely due to slippage between the worm and the substrate seems an overstatement. If the paper is interested in modeling the animal's neural control of motion, then shouldn't the model be more concerned about the dynamics actually being controlled – in this case, the postural dynamics? And while it is indeed theoretically possible to produce thrust without advancing the phase, the collection of papers from Stephens et al. show that the worms' dynamics lie almost entirely on a manifold of remarkably small dimension, showing that these types of potential postural changes occur only rarely. Moreover, the authors themselves admit (in the subsection “Wild type locomotion”, fifth paragraph) that &quot;on an agar surface, the worm moves without slipping.&quot;</p><p>In addition, the authors state that the Stephens et al. (2010) paper shows that postural modeling does not accurately model the worm when its center of mass trajectory follows an arc. In fact, the cited paper shows the necessity of looking at arcing trajectories between reorientation events and not just using a run-and-tumble analogy from bacteria, showing that shape-space dynamics form a predictive relationship with foraging trajectories.</p><p>All this being said, we are not disputing the authors' modeling choice of only using the midpoint of the worm's body. We have no arguments that there is utility in using a simplified description of a system to gain quantitative insight, but we want to see the authors distinguish themselves from the Stephens (2011) paper differently, focusing instead on the fundamental difference of modeling via a hidden Markov model instead of fitting parameters in a set of deterministic/stochastic differential equations. The choice of measuring Euclidean velocity instead of phase velocity is a modeling choice. Put another way, if someone with comparable amounts of shape-space data were to fit a hidden Markov model of your form to their data using phase velocity instead of velocity, would they likely obtain the same results?</p><p>3) In <xref ref-type="fig" rid="fig4">Figure 4</xref>, could the result that there is no postural stereotypy entering into state <inline-formula><mml:math id="inf759"><mml:mi>X</mml:mi></mml:math></inline-formula> be the result of an over-zealous &quot;pause&quot; caller. Specifically, this model calls many more things pauses than other approaches because of the nature of the sub-frame-resolution hidden Markov fit. What do these plots look like if only the longest visits to the <inline-formula><mml:math id="inf760"><mml:mi>X</mml:mi></mml:math></inline-formula> states are included?</p><p>4) Is there any evidence that the time scales of neural activity in <italic>C. elegans</italic>' motor neurons can be as short as the pause states being predicted? Although the model is supposed to be an abstraction of what's occurring in the worm's nervous system, one should expect to predict reasonable numbers for this nonetheless.</p><p>5) In the first paragraph of the subsection “Wild type locomotion” the authors claim that their &quot;tracking system is capable of revealing briefer visits&quot; to the pause state and that this is the reason why their measured dwell time is much shorter than previously measured. Again, we are not yet convinced that this method is much more accurate than the posture tracking used in Stephens et al. (2011) to measure the forward dwell time. The Stephens paper, however, uses a slightly different definition of the dwell time, using cessation of the forward phase velocity instead. Although the paper here does not measure phase velocity, they could measure the dwell time between visits to the reversal state (i.e. ignoring <inline-formula><mml:math id="inf761"><mml:mi>F</mml:mi></mml:math></inline-formula>-&gt;<inline-formula><mml:math id="inf762"><mml:mi>P</mml:mi></mml:math></inline-formula>-&gt;<inline-formula><mml:math id="inf763"><mml:mi>F</mml:mi></mml:math></inline-formula> type transitions). What happens if this definition is used? Does the same result emerge?</p><p>6) A more general comment is that we would like to understand more what type of neural activity the authors would predict based on their model, connectome data, and polarity results from papers such as Rakowski (2013) despite imaging in a freely-behaving worm being well outside of the scope of this paper (although not nearly as impossible as the authors seem to suggest in the Discussion section). If this experiment were performed, what is the most likely neural instantiation of this model that is consistent with the current literature? The strength of this model is that it makes an attempt at getting at how this circuit may actually function. Accordingly, if possible, a concrete prediction or predictions to this end would greatly increase the value of this paper to researchers and could guide experimentalists performing imaging in freely-behaving animals in their measurements and analysis.</p><p>[Editors’ note: a previous version of this study was rejected after peer review, but the authors submitted for reconsideration. The previous decision letter after peer review is shown below.]</p><p>Thank you for choosing to send your work entitled &quot;A stochastic neuronal flip-flop circuit regulates random search during foraging behavior&quot; for consideration at <italic>eLife</italic>. Your full submission has been evaluated by Eve Marder (Senior editor) and three peer reviewers, one of whom, Ronald L. Calabrese, is a member of our Board of Reviewing Editors, and the decision was reached after discussions between the reviewers. Based on our discussions and the individual reviews below, we regret to inform you that your submission in its present form is not suitable for publication in <italic>eLife</italic>. That said, if you feel that you can adequately rebut, answer the reviews with a combination of rewriting or new work, we would be willing to consider a new submission of this material, as it clearly asks an important and interesting set of questions.</p><p>Consensus review:</p><p>The authors present a kinematic analysis of random local search behavior in <italic>C. elegans</italic>. The then use a Hidden Markov Model to quantitatively model such searches based their kinematic analyses. They then identify this HMM with known aspects of the worm connectome to understand the neural implementation of switches between different behavioral states. In particular, the model contains two populations of neurons, each controlling either forward or reverse locomotion, with the overall network resulting in four possible behaviors: forward, reverse, and two pause states. They perform a maximum likelihood fit of the model to measured time series, making predictions about the effect of neural ablations, the sign and strength of synaptic connections, effects of perturbations to membrane potentials. Moreover, they phenomenologically model a potential underlying neural mechanism for different search modalities.</p><p>The subject matter of the paper is definitely one of broad interest, and if the model is correct it would provide us with a substantive understanding into the neural implementation of the forward/pause/reversal/pause(?) dynamics it would be a major contribution. However, the reviewers are not fully convinced that the model is the simplest possible explanation of the animal's behavior and that the authors have shown that a clear connection can be drawn to neural correlates.</p><p>Enthusiasm for the subject matter and the potential neural correlates vs. concerns about the appropriateness of the approach and its rigor were weighed differently by the reviewers initially, but in consultation the concerns predominated. The detailed reviews of the expert reviewers are appended but their concerns are summarized below.</p><p>1) The model is not adequately placed within the context of previous work in the field. There have been other papers attempting to understand both exploitation/exploration behavioral generation (e.g. Flavell et al., Cell, 2013) and forward/reversing dynamics (e.g. Stephens, PNAS, 2011).</p><p>Moreover, a direct comparison to (Rakowski et al., 2013) is needed. This work, which is cited as Ref. 12, also develops a model of the command neuron network and uses this model to predict behavioral states and the effects of ablations.</p><p>2) The existence of two different pause states <inline-formula><mml:math id="inf764"><mml:mi>X</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf765"><mml:mi>Y</mml:mi></mml:math></inline-formula> is not well supported in the data and the HMM does not have the power to confirm their existence.</p><p>3) The mapping of the HMM onto the underlying neuronal network is not convincing. In particular there little data in this paper or in any of the citations to support the contention that pause state <inline-formula><mml:math id="inf766"><mml:mi>X</mml:mi></mml:math></inline-formula> = all command neurons off and pause state <inline-formula><mml:math id="inf767"><mml:mi>Y</mml:mi></mml:math></inline-formula> = all command neurons on. Mapping synaptic weights onto coupling in the HMM is not rigorous.</p><p>For the paper to be suitable for <italic>eLife</italic> the following extensive changes would have to be made.</p><p>1) Relax the claims about the model's prediction of synaptic weights.</p><p>2) The authors need to establish firmly that tracking a single point provides an unbiased estimate of trajectory in light of Stephens, PLoS One (2010). Given their extensive data set, we presume that converting their point imaging into centerline tracking would be extremely difficult and time consuming, but the authors should at least place their analysis in this light. They should also bolster their arguments that there are two behaviorally distinct pause states and discuss how they are related to the two pause states of Stephens.</p><p>3) The authors should differentiate their work with respect to Rakowski (2013). Does their model provide different predictions? Can they be disambiguated? It would be great if they could show this, but minimally, they should suggest what experiments should be performed in the future.</p><p>4) Similarly – what measurements should be made to distinguish <inline-formula><mml:math id="inf768"><mml:mi>X</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf769"><mml:mi>Y</mml:mi></mml:math></inline-formula> pause states map onto the electrical activity of the command neuron network at least at some coarse-grained level?</p><p><italic>Reviewer #1:</italic> </p><p>The authors present a kinematic analysis of random local search behavior in <italic>C. elegans</italic> at high resolution. This analysis leads to a Markov model of underlying neuronal network based on the <italic>C. elegans</italic> connectome. This inherently stochastic model not only accounts for the data but also predicts the sign and strengths of key connections which are then confirmed by electrophysiology/optogenetics. The model can be adjusted easily to account for other types of random searches by adjusting parameters compatible with sensory input or modulation. Further the model can be expanded to incorporate directed searches as in chemotaxis and can also account for 'deterministic' behavior such as escape movements. The model also accounts for counter intuitive results on dwell times associated with genetic manipulation and laser ablation of key command neurons. These findings conceptually inform experiments in the mammalian sleep network.</p><p>Altogether this work is an impressive display of the power of modeling when combined with detailed experimental manipulation. Moreover the approach complements and expands other efforts using unbiased approaches that make no assumptions about whether and how behavioral categories can be mapped to specific states of the nervous system. This approach allows mapping of states on to the neuronal network. The paper is very clearly and crisply written. The figures are clear and contain useful data well organized. All essential data is presented.</p><p>This reviewer is not an expert in Markov models and the associated mathematics, so I would defer to the experts on any potential flaws in this analysis, but the behavioral analyses are very straightforward and carefully done, the electrophysiology is state of the art for <italic>C. elegans</italic>, and the mutant analysis and cell ablation experiments seem carefully controlled. The statistical analysis seems appropriate but I defer to the other more expert reviewers. Methods are a model of completeness. There are no major concerns noted by this reviewer. I really enjoyed reading this paper and I learned a lot.</p><p><italic>Reviewer #2:</italic> </p><p>Roberts et al. present a study combining behavioral measurements of <italic>C. elegans</italic> locomotion, modeling of a two-state stochastic system, and measurements of functional connectivity between two command interneurons. The authors claim that using the stochastic model, they can make nontrivial predictions about the state of the underlying neural network, solely based on behavioral measurements. They also claim that using behavioral data and their two-state model they can predict the strengths of synaptic connections between interneurons. If these claims were valid, this would be a significant achievement and worthy of publication in <italic>eLife</italic>, although the novelty of this work is somewhat compromised by another recent publication (Rakowski et al., 2013).</p><p>My major concerns are:</p><p>1) The claim that there are two distinct pause states resulting from different levels of activity in the command interneurons is not supported by evidence presented in this paper or cited work.</p><p>2) The stochastic switch model is not grounded enough in the biology of the system to justify comparing model fit parameters to measurements made on individual neurons. In particular the comparison of the model fit parameters labeled &quot;synaptic weights&quot; to actual synaptic connections is inappropriate.</p><p>Behavioral Measurements and Hidden Markov Model:</p><p>In <xref ref-type="fig" rid="fig1">Figure 1</xref>, the authors present data obtained by tracking a fiducial marker painted onto the back of a freely moving worm. They show a distribution of &quot;velocities&quot; (1D) that appear to be the sum of 3 distributions, which they label &quot;reverse, pause,&quot; and &quot;forward.&quot; In <xref ref-type="fig" rid="fig1">Figure 1E</xref>, they then show a velocity vs. time graph that has been segmented into these states by thresholding the velocity at +/- 0.05 mm/s. In <xref ref-type="fig" rid="fig2">Figure 2E</xref>, they show a similar velocity vs. time graph that has been similarly segmented using a Hidden Markov Model. The claim is that this model does a much better job of describing the behavioral state than the process used in <xref ref-type="fig" rid="fig1">Figure 1E</xref>, although I cannot find any quantitative measures in the paper to support this assertion (more on this later).</p><p>The HMM differs from simple thresholding by (1) assigning different prior probabilities to transitions between states and staying in the same state and (2) including 2 pause states (called <inline-formula><mml:math id="inf770"><mml:mi>X</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf771"><mml:mi>Y</mml:mi></mml:math></inline-formula>). The states of the HMM are related to behavior and to the stochastic flip flop model as follows.</p><p><inline-formula><mml:math id="inf772"><mml:mi>F</mml:mi></mml:math></inline-formula>: worm is moving forward. &quot;<inline-formula><mml:math id="inf773"><mml:mi>F</mml:mi></mml:math></inline-formula>&quot; unit is active and &quot;<inline-formula><mml:math id="inf774"><mml:mi>R</mml:mi></mml:math></inline-formula>&quot; unit is inactive. What <inline-formula><mml:math id="inf775"><mml:mi>F</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf776"><mml:mi>R</mml:mi></mml:math></inline-formula> represent is unclear in the paper? They are described as &quot;binary stochastic elements,&quot; (subsection “The Stochastic Switch Model”, third paragraph), &quot;single binary neuron-like units&quot; (<xref ref-type="fig" rid="fig2">Figure 2</xref> caption), and as a collection of neurons as in &quot;self connections represent synaptic connections between neurons comprising a given unit.&quot; (<xref ref-type="fig" rid="fig2">Figure 2</xref> caption). I will come back to this under Stochastic Switch Model, but for discussion of the hidden Markov model, the distinctions are not important.</p><p><inline-formula><mml:math id="inf777"><mml:mi>R</mml:mi></mml:math></inline-formula>: worm is moving backward. &quot;<inline-formula><mml:math id="inf778"><mml:mi>R</mml:mi></mml:math></inline-formula>&quot; unit is active and &quot;<inline-formula><mml:math id="inf779"><mml:mi>F</mml:mi></mml:math></inline-formula>&quot; unit is inactive.</p><p><inline-formula><mml:math id="inf780"><mml:mi>X</mml:mi></mml:math></inline-formula>: worm is not moving/moving slowly. Both units are inactive.</p><p><inline-formula><mml:math id="inf781"><mml:mi>Y</mml:mi></mml:math></inline-formula>: worm is not moving/moving slowly. Both units are active.</p><p>A great deal of the argument in this paper relies on the existence of two pause states and of the identification of these two behaviorally identical pause states with specific patterns of activity in command interneurons, so I will go over in some detail the arguments the manuscript advances:</p><p>1) Using a speed threshold, pauses during forward-&gt;reverse transitions were found to be longer than pauses during reverse-&gt;forward transitions.</p><p>2) &quot;When both <inline-formula><mml:math id="inf782"><mml:mi>F</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf783"><mml:mi>R</mml:mi></mml:math></inline-formula> are OFF (state <inline-formula><mml:math id="inf784"><mml:mi>X</mml:mi></mml:math></inline-formula>) it is assumed that movement ceases, consistent with studies showing that genetic ablation or silencing of all command interneurons induces prolonged pauses (Kawano et al., 2011; Zheng et al., 1999).&quot; Zheng et. al (Zheng et al., 1999) report that glr-1::ICE (klys36) &quot;moved significantly slower than wild type worms and also had long pauses during which no movement occurred.&quot; Kawano et al. (Kawano et al., 2011) report that silencing all of AVA, AVB, AVE, AVD, and PVC led to prolonged pausing with the body in a straight position and that using a combination of genetic and laser ablation to destroy these same methods resulted in worms that were &quot;kinked&quot; with odd body postures.</p><p>3) &quot;In the event that <inline-formula><mml:math id="inf785"><mml:mi>F</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf786"><mml:mi>R</mml:mi></mml:math></inline-formula> are simultaneously ON (state <inline-formula><mml:math id="inf787"><mml:mi>Y</mml:mi></mml:math></inline-formula>), the resulting motor commands are assumed to conflict at the level of the motor neurons of the body wall muscles, resulting in a second motionless state, as has been observed (Kawano et al., 2011).&quot; The way this sentence is structured may leave a mistaken impression of what is reported in Kawano et al., 2011. Kawano et al., 2011 does not show that when <inline-formula><mml:math id="inf788"><mml:mi>F</mml:mi></mml:math></inline-formula>&amp;<inline-formula><mml:math id="inf789"><mml:mi>R</mml:mi></mml:math></inline-formula> command interneurons are simultaneously active, worms stop moving. Instead it shows that in innexin mutants (unc-7 and unc-9), the &quot;kink&quot; state is correlated with the A and B type motorneurons having similar levels of calcium.</p><p>4) In the second paragraph of the subsection “Wild type locomotion“. Removing state <inline-formula><mml:math id="inf790"><mml:mi>Y</mml:mi></mml:math></inline-formula> (i.e., setting <inline-formula><mml:math id="inf791"><mml:msub><mml:mi>a</mml:mi><mml:mi>FY</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>RY</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>) caused a large and highly significant reduction in the summed log-likelihood of the 5 wild type cohorts (𝑝 &lt; 10<sup>-100</sup>) demonstrating that the second pause state greatly improves the fit.</p><p>Taken individually or together, these arguments fail to support the existence of multiple pause states or that these states can be reached by co-activation or inactivation of command neurons.</p><p>Argument 1 merely shows that the speed of a dot on a worm's midline recovers more quickly in the reverse to forward transition than the forward to reverse. This could be due to measurement artifacts, biomechanical differences, differences in the response latencies of A and B motorneurons, or differences elsewhere in the neural network.</p><p>Argument 2 shows that permanent inactivation of all command motor neurons leads to a worm with severe motion defects. It's quite a stretch to go from there to saying that transient decreases in the activities of these neurons will lead to immediate cessation of movement. It does seem at least plausible that if both forward and reverse command neurons are &quot;off,&quot; the worm stops moving, although I question whether this cessation would really be immediate, especially since forward motion results from the propagation of a wave down the body due to proprioreceptive feedback (Wen et al., 2012)</p><p>Argument 3 does not show that co-activation of command neurons leads to pausing in wild type animals.</p><p>Argument 4 suffers from several flaws. First, the hidden Markov model used with the sole observable being the speed of a dot on the worm's midline may not be an appropriate description of the system (discussed in other comments). Second, the fact that one model produces a better fit than another does not show that either model is true. IE: that adding a state to the HMM improves the model's fit does not prove that state exists.</p><p>There are other ways we might improve the model fit that are incompatible with the stochastic switch model: Allowing the HMM to have 8 degrees of freedom rather than 6; adding a third pause state or a second forward state with a different velocity distribution; allowing direct transitions between <inline-formula><mml:math id="inf792"><mml:mi>X</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf793"><mml:mi>Y</mml:mi></mml:math></inline-formula> or <inline-formula><mml:math id="inf794"><mml:mi>F</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf795"><mml:mi>R</mml:mi></mml:math></inline-formula>. If any of these produce a significant improvement in the likelihood of the data given the model, what would that imply for the stochastic switch model? I would also like to see the likelihood ratio test applied to compare a model where the state is determined by simple thresholding (as in <xref ref-type="fig" rid="fig1">Figure 1E</xref>) to the 4-state HMM.</p><p>In summary, the authors present only weak evidence that there even are two distinct pause states. There is no data presented here or in the cited literature that show that simultaneous activation or deactivation of forward and reverse command neurons causes pausing. There is no evidence given for the correspondence of the two pause states in the HMM with two distinct states of the command neuron network. Finally, beyond a very thin justification about metabolic efficiency, there is nothing to support the assignment of state <inline-formula><mml:math id="inf796"><mml:mi>X</mml:mi></mml:math></inline-formula> to the <inline-formula><mml:math id="inf797"><mml:mi>R</mml:mi></mml:math></inline-formula>-&gt;<inline-formula><mml:math id="inf798"><mml:mi>F</mml:mi></mml:math></inline-formula> transition and state <inline-formula><mml:math id="inf799"><mml:mi>Y</mml:mi></mml:math></inline-formula> to the <inline-formula><mml:math id="inf800"><mml:mi>F</mml:mi></mml:math></inline-formula>-&gt;<inline-formula><mml:math id="inf801"><mml:mi>R</mml:mi></mml:math></inline-formula>.</p><p>I think the idea that the same behavioral state (pausing) can be the result of opposite patterns of activity in the command neurons is intriguing and worth pursuing.</p><p>The authors write that &quot;The currently available set of optical probes of neuronal activity do not have sufficient temporal resolution to allow direct observation of the underlying states of the command network in intact, freely moving animals.&quot; The recovery time of GCaMP3 is ~300 ms and faster dynamics can be inferred by deconvolving the observed signal with the known GCaMP3 filter (Kato et al., 2014). And faster indicators, like GCaMP6f, are now available. The mean duration of inferred state <inline-formula><mml:math id="inf802"><mml:mi>X</mml:mi></mml:math></inline-formula> pauses is 480 ms and 20% of inferred state <inline-formula><mml:math id="inf803"><mml:mi>Y</mml:mi></mml:math></inline-formula> pauses are over 300 ms (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>). The authors assert that in state <inline-formula><mml:math id="inf804"><mml:mi>X</mml:mi></mml:math></inline-formula> the activity in all command neurons will be much lower than in state <inline-formula><mml:math id="inf805"><mml:mi>Y</mml:mi></mml:math></inline-formula>. Surely in these longer pauses it would be possible to make a measurement that verifies this prediction.</p><p>A second approach would be to use optogenetic tools to determine the pause state. In state <inline-formula><mml:math id="inf806"><mml:mi>X</mml:mi></mml:math></inline-formula> (all command neurons off), ChR2 activation of AVB should induce forward locomotion by hyperpolarization of AVA via NpHR/halo should not. In state <inline-formula><mml:math id="inf807"><mml:mi>Y</mml:mi></mml:math></inline-formula> (all command neurons on), hyperpolarization of AVA should lead to forward locomotion.</p><p>The &quot;Stochastic Switch Model&quot;:</p><p>The stochastic switch model uses a nonstandard description of neural state. Instead of parameterizing the state of a neuron by a continuous variable, e.g. membrane potential, the neuron is treated as a binary element, existing in one of two discrete states. Synaptic connections are also represented/modeled in a non-standard way. Normally, if A is presynaptic to B, activity in A causes a change in the membrane potential of B by an amount set by the weight of the synaptic connection from A to B. In this model, if A is active, the probability that B will spontaneously switch states is modified by an amount that depends exponentially on the &quot;weight&quot; of the connection. As a model of coupled two state systems, there is nothing inherently wrong with this approach, but comparing the resulting model fit parameters to biological parameters is confusing and potentially misleading.</p><p><xref ref-type="fig" rid="fig5">Figure 5</xref>, &quot;the stochastic switch model correctly predicts the sign and strength of synaptic connections&quot; shows the confusion generated by the choice of terminology. <xref ref-type="fig" rid="fig5">Figure 5A</xref> shows model fit parameters that have no obvious biological interpretation, but the figure caption identifies these fit parameters as &quot;synaptic weights.&quot; Then <xref ref-type="fig" rid="fig5">Figure 5B and C</xref> show &quot;synaptic currents&quot; (currents that result from functional, but not necessarily direct synaptic, connections) measured by recording the amount of current received by neuron B when neuron A is activated. The figure invites the reader to compare 5A to the 5B-5E even though 5A shows fit parameters from a model that does not even have synaptic currents. This presentation is at best confusing and at worst misleading.</p><p>In their description of the stochastic switch model, the authors should only use the term &quot;binary stochastic elements&quot; to describe <inline-formula><mml:math id="inf808"><mml:mi>F</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf809"><mml:mi>R</mml:mi></mml:math></inline-formula>, and choose a term other than &quot;synaptic weights&quot; to describe the model fit parameters (hF, wff etc.), which are not synaptic weights as the term is commonly used. The chosen terminology will lead all but the most careful readers to misunderstand the work that has been done.</p><p>Measurements of functional connectivity, effect of ablations, and extensions to chemotaxis:</p><p>The measurements of functional connectivity appear to be well done; I have no major concerns with these, beyond that already noted in the text: different levels of ChR2 expression in AVA and AVB could complicate the interpretation of these results. Perhaps the current evoked by ChR2 activation could be directly measured and calibrated. In most of the literature about the <italic>C. elegans</italic> motor circuit, there is assumed to be reciprocal inhibition between AVA and AVB, but I think <xref ref-type="fig" rid="fig5">Figure 5</xref> shows the first direct measurement, a significant contribution.</p><p>The rest of the paper (<xref ref-type="fig" rid="fig4">Figures 4</xref>, <xref ref-type="fig" rid="fig6">6</xref>–<xref ref-type="fig" rid="fig8">8</xref>) relies on the results of the modeling and behavioral experiments.</p><p><italic>Reviewer #3:</italic> </p><p>The submission by Roberts, et al., uses a Hidden Markov Model to quantitatively model the locomotory behavior of <italic>C. elegans</italic>, with a particular emphasis on understanding the neural implementation of switches between different behavioral states. In particular, the model contains two populations of neurons, each controlling either forward or reverse locomotion, with the overall network resulting in four possible behaviors: forward, reverse, and two pause states. They perform a maximum likelihood fit of the model to measured time series, making predictions about the effect of neural ablations, the sign and strength of synaptic connections, effects of perturbations to membrane potentials. Moreover, the phenomenologically model a potential underlying neural mechanism for different search modalities.</p><p>In general, I found the work to be careful done, and understanding the mechanisms of behavioral control is an important question in the field. My major concerns have to do with the novelty of the work.</p><p>As far as novelty is concerned, there have been other papers attempting to understand both exploitation/exploration behavioral generation (e.g. Flavell, et al., Cell, 2013) and forward/reversing dynamics (e.g. Stephens, PNAS, 2011), with both of the cited examples leading to the generation of long behavioral time scales. It would be useful for the authors to place their results in the context of these papers. In particular, the Stephens (2011) paper uses an analogous (but non-identical approach) of fitting a dynamical system to the data and makes (highly accurate) predictions about forward/reversal switching rates using Arrhenius-like stochastic dynamics. In addition, an earlier paper from the same group (Stephens, PLoS Comp Bio, 2008) shows that a 4-state system emerges naturally from a data set. Here, this set-up is assumed a priori.</p><p>Specific comments:</p><p>1) In <xref ref-type="fig" rid="fig4">Figure 4B</xref>, I find the excuse for omitting error bars to be relatively weak. Minimally, bootstrapped confidence intervals could be found, which would be significantly better than the current lack of any measure of variability.</p><p>2) In the fifth paragraph of the subsection “Genetic effects on command neuron function” and <xref ref-type="fig" rid="fig6">Figure 6</xref>. The claim is made that &quot;changes in synaptic strength dominate the effects of changes in membrane potential on Δ<inline-formula><mml:math id="inf810"><mml:mi>F</mml:mi></mml:math></inline-formula> and Δ<inline-formula><mml:math id="inf811"><mml:mi>R</mml:mi></mml:math></inline-formula>.&quot; This certainly seems true for Δ<inline-formula><mml:math id="inf812"><mml:mi>F</mml:mi></mml:math></inline-formula>, but both models appear to give more-or-less identical predictions here for Δ<inline-formula><mml:math id="inf813"><mml:mi>R</mml:mi></mml:math></inline-formula>.</p><p>3) In the first paragraph of the subsection “The Stochastic Switch Model and other random search behaviors“. It is claimed that &quot;changes are required in at least three weights to produce the full range of search behaviors.&quot; This is not actually shown anywhere in the paper, just that three weights are sufficient to induce the full range. A supplementary figure to this effect would be useful.</p><p>4) The predicted value for the dwell time in the forward state is not comparable to the rest of the literature, as a different definition is used here. What would happen if a standard definition was used? Does the same rate result?</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.12572.033</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>Essential revisions: 1) Results, second paragraph: The claim that this study represents &quot;a 10-fold improvement over previously published tracking systems&quot; seems to be a stretch. In some sense, centerline-tracking experiments operate at a much finer resolution than tracking a single dot on a worm, with papers such as Brown, et al.,</italic></p><p><italic>PNAS (2013) tracking many more worms with more detail and higher resolution. I agree that the authors appear to have done a fine job at spot tracking, but we don't believe that they have a claim to novelty here.</italic> </p><p>None of the published centerline tracking papers cite the spatial resolution of the method, so the argument against our claim to novelty seems to be unfounded. However, we are willing to limit this claim to measurement oftangential velocityand have adjusted the manuscript accordingly (Introduction, last paragraph). Note that our demonstration of higher velocity resolution than other methods is significant because it provides with an explanation for why we obtained a lower value of mean dwell time in the forward state than previous studies (subsection “Wild type locomotion”, first paragraph).</p><p>In preparing this manuscript, we reviewed all <italic>C. elegans</italic> centerline tracking papers, including Brown et al., PNAS (2013) cited above, and the complete set of the Stephens/Bialek papers. As far as we can tell, none of them presents an explicit statement of spatial resolution or the information needed to compute spatial resolution (pixel size on the camera chip, and overall optical magnification), nor do any of them show data from motionless worms (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>), which would at least yield an estimate of resolution in the limiting case of no worm movement. Thus, we find no basis in the literature for the referee’s statement that centerline methods have higher spatial resolution.</p><p>Whereas we agree that centerline tracking is superior when the worm’s <italic>posture</italic> is the key datum, here our focus is on <italic>tangential velocity</italic>, for which centerline tracking is not the most direct measure possible. As we noted in the main text of the paper (Results, end of first paragraph), the centerline method computes tangential velocity by following virtual points rather than physical marks on the body. This is done by fitting a spline to the worm’s boundary, breaking the spline into a fixed number of segments, and computing the velocity of segment endpoints. The spline method is inaccurate because the tail of the worm, being faint, is differentially resolved from frame to frame. As a result, the length of the spline, and thus the distance between segment endpoints varies significantly (e.g. <xref ref-type="fig" rid="fig1">Figure 1B</xref> of Karbowski et al., 2008; <xref ref-type="fig" rid="fig2">Figure 2</xref> of Cronin et al., 2005 where centerline head and tail are chopped off and misaligned in comparison to real worm; <xref ref-type="fig" rid="fig1">Figure 1</xref> panel B of Karbowski et al. 2006). Thus the spline method adds segmentation noise to the velocity measurements. In contrast, the spot tracking method follows a sharply defined, high-contrast mark that is essentially unaffected by image segmentation noise. Our literature review revealed only one other <italic>C. elegans</italic> tracking paper that cites the accuracy of spot of tracking. Here the tracking object is a fluorescent neuron and the resolution is given as 5 µm (Guo, 2009). This paper is the basis of our statement that our method affords a 10-fold improvement, as the stage encoders we used had a resolution of 0.5 µm. Our dead worm experiments verify that encoder precision is the limiting factor in the overall spatial resolution.</p><p><italic>2) The authors should address the Stephens</italic> et al. <italic>(2011) paper in a different manner than they do here (particularly in the Discussion section, fifth paragraph).</italic> </p><p>We agree with the reviewers’ main points (see details below): (i) Worm's do not slip under our conditions, nor under those of Stephens et al. (ii) Thrust can be produced when phase velocity is zero. (iii) Midpoint tracking is a useful simplified description of the system. The main force of this critique is thus the request to distinguish our work from Stephens' in a different manner – by using the thought experiment in which phase velocity is substituted for tangential velocity when fitting and analyzing our Markov model. Would the two definitions of velocity yield the same results? We have now adopted this excellent suggestion in the Discussion (fourth paragraph).</p><p><italic>To begin with, the statement that the &quot;mathematical relationship between tangential velocity and phase velocity (so defined) has not been delineated, but is likely to be complex&quot; largely due to slippage between the worm and the substrate seems an overstatement.</italic> </p><p>We have removed the quoted statement, and the discussion of slippage. (As point of fact, however, we did not say that the complexity of the relationship between tangential and phase velocities is due to the possibility of slippage. Rather, this complexity is due the fact that tangential velocity in the worm is fully determined by thrust, and the higher order components of the worm’s shape, which are capable of generating thrust, are ignored by definition in computing phase velocity.)</p><p><italic>If the paper is interested in modeling the animal's neural control of motion, then shouldn't the model be more concerned about the dynamics actually being controlled</italic> – <italic>in this case, the postural dynamics?</italic> </p><p>We could just as easily argue that from the perspective of the command neurons, what is being controlled is the presence or absence of thrust, and its direction.</p><p><italic>And while it is indeed theoretically possible to produce thrust without advancing the phase, the collection of papers from Stephens et al.show that the worms' dynamics lie almost entirely on a manifold of remarkably small dimension, showing that these types of potential postural changes occur only rarely.</italic> </p><p>Shape components 3 and 4 account for approximately 30% of the shape variance (Stephens et al., 2008, <xref ref-type="fig" rid="fig2">Figure 2B</xref>), so it is hard to see how they can be characterized as “rare.” Moreover, these two components meet necessary and sufficient conditions for generating thrust: a gradient of curvature along the worm’s centerline (Gray 1946; Gray 1953; Gray 1964); Thus there are non-rare components that are generating thrust.</p><p><italic>Moreover, the authors themselves admit (in the subsection “</italic></p><p><italic>Wild type locomotion”, fifth paragraph) that &quot;on an agar surface, the worm moves without slipping.&quot;</italic> </p><p>Yes, we do believe that slip is generally minimal. Now, we no longer use slippage as a means of illustrating the differences between the two methods of analyzing behavior.</p><p><italic>In addition, the authors state that the Stephens et al.(2010) paper shows that postural modeling does not accurately model the worm when its center of mass trajectory follows an arc.</italic> </p><p>We are not saying that postural modeling – defined in terms of <italic>all</italic> shape components – is inaccurate; we are actually making a much more restricted assertion. We are merely saying that phase velocity, because it is based on components 1 and 2 alone, is not necessarily an accurate measure of tangential velocity. In particular, this mismatch is accentuated in arcs, including omega turns, where other thrust producing shape components are strongly engaged.</p><p><italic>In fact, the cited paper shows the necessity of looking at arcing trajectories between reorientation events and not just using a run-and-tumble analogy from bacteria, showing that shape-space dynamics form a predictive relationship with foraging trajectories.</italic> </p><p>We agree with this point. The work by Iino and colleagues (Iino, 2009) has shown that spatial orientation behavior is the product of two mechanisms: run-and-tumble (klinokinesis) and weathervaning (klinotaxis). However, klinotaxis, being deterministic rather than random, is outside the scope of the paper. We now make it clear that the type of chemotaxis modeled here is “random-walk chemotaxis” (Discussion, first paragraph).</p><p> <italic>All this being said, we are not disputing the authors' modeling choice of only using the midpoint of the worm's body. We have no arguments that there is utility in using a simplified description of a system to gain quantitative insight, but we want to see the authors distinguish themselves from the Stephens (2011) paper differently, focusing instead on the fundamental difference of modeling via a hidden Markov model instead of fitting parameters in a set of deterministic/stochastic differential equations. The choice of measuring Euclidean velocity instead of phase velocity is a modeling choice. Put another way, if someone with comparable amounts of shape-space data were to fit a hidden Markov model of your form to their data using phase velocity instead of velocity, would they likely obtain the same results?</italic> </p><p>We would not get the same results (rate constants, weights, etc.) because thrust (hence movement) can be generated even when phase velocity is zero (see point (ii) of agreement above). Thus some of the pauses identified phase velocity, would not be identified as pauses by tangential velocity because the worm is still moving. Would all pauses in tangential velocity be detected by the phase velocity method? We speculate that this is mainly true, because when tangential velocity is zero, net thrust is zero, so none of the shape components are generating thrust, including components 1 and 2.</p><p>3) In <xref ref-type="fig" rid="fig4">Figure 4</xref>, could the result that there is no postural stereotypy entering into state <inline-formula><mml:math id="inf814"><mml:mi>X</mml:mi></mml:math></inline-formula> be the result of an over-zealous &quot;pause&quot; caller. Specifically, this model calls many more things pauses than other approaches because of the nature of the sub-frame-resolution hidden Markov fit. What do these plots look like if only the longest visits to the <inline-formula><mml:math id="inf815"><mml:mi>X</mml:mi></mml:math></inline-formula> states are included?</p><p>We tested for this possibility by reanalyzing the average posture at <inline-formula><mml:math id="inf816"><mml:mi>FX</mml:mi></mml:math></inline-formula> transitions after eliminating all but long pauses, and found a similar lack of postural preference at <inline-formula><mml:math id="inf817"><mml:mi>FX</mml:mi></mml:math></inline-formula> transitions. This result held for any minimum pause duration up to 2 s; longer dwells in state <inline-formula><mml:math id="inf818"><mml:mi>X</mml:mi></mml:math></inline-formula> were too rare to analyze. We have added this result to the text (subsection “Wild type locomotion”, last paragraph).</p><p><italic>4) Is there any evidence that the time scales of neural activity in C. elegans' motor neurons can be as short as the pause states being predicted? Although the model is supposed to be an abstraction of what's occurring in the worm's nervous system, one should expect to predict reasonable numbers for this nonetheless.</italic> </p><p>To our knowledge, there is only one report of voltage recordings from body wall muscle motor neurons in <italic>C. elegans</italic> (Liu, 2014). Interestingly, these motor neurons, which happen to be in the pool of reverse motor neurons, exhibit distinct up and down states. Theoretically, the down states could be pauses of the state-<inline-formula><mml:math id="inf819"><mml:mi>X</mml:mi></mml:math></inline-formula> type in our model when they coincide with down states in forward motor neurons, whereas the up states could be pauses of the state-<inline-formula><mml:math id="inf820"><mml:mi>Y</mml:mi></mml:math></inline-formula> type in our model when they coincide with up states in forward motor neurons. Unfortunately, no simultaneous recordings of reverse and forward neurons were made so it is impossible to determine the duration of possible pause states. The Liu paper is now referenced in the third paragraph of the subsection “The Stochastic Switch Model”.</p><p><italic>5) In the first paragraph of the subsection “Wild type locomotion” the authors claim that their &quot;tracking system is capable of revealing briefer visits&quot; to the pause state and that this is the reason why their measured dwell time is much shorter than previously measured. Again, we are not yet convinced that this method is much more accurate than the posture tracking used in Stephens et al.</italic></p><p><italic>(2011) to measure the forward dwell time. The Stephens paper, however, uses a slightly different definition of the dwell time, using cessation of the forward phase velocity instead. Although the paper here does not measure phase velocity, they could measure the dwell time between visits to the reversal state (i.e. ignoring</italic> <inline-formula><mml:math id="inf821"><mml:mi>F</mml:mi></mml:math></inline-formula><italic>-&gt;<inline-formula><mml:math id="inf822"><mml:mi>P</mml:mi></mml:math></inline-formula>-&gt;</italic><inline-formula><mml:math id="inf823"><mml:mi>F</mml:mi></mml:math></inline-formula> <italic>type transitions). What happens if this definition is used? Does the same result emerge?</italic> </p><p>We have added this calculation to the text. The resulting mean dwell time in the forward state using the standard fixed velocity threshold of 0.5 mm/s and ignoring <inline-formula><mml:math id="inf824"><mml:mi>FPF</mml:mi></mml:math></inline-formula> transitions was 9.13 ± 0.15 s. which matches the value obtained by others using the same threshold (8.98 ± 0.57 s) (Rakowski, 2013). This result has been added to the text (subsection “Wild type locomotion”, first paragraph).</p><p><italic>6) A more general comment is that we would like to understand more what type of neural activity the authors would predict based on their model, connectome data, and polarity results from papers such as Rakowski (2013) despite imaging in a freely-behaving worm being well outside of the scope of this paper (although not nearly as impossible as the authors seem to suggest in the Discussion section). If this experiment were performed, what is the most likely neural instantiation of this model that is consistent with the current literature? The strength of this model is that it makes an attempt at getting at how this circuit may actually function. Accordingly, if possible, a concrete prediction or predictions to this end would greatly increase the value of this paper to researchers and could guide experimentalists performing imaging in freely-behaving animals in their measurements and analysis.</italic> </p><p>This is a great idea! We have now included a paragraph of predictions in the Discussion (fifth paragraph).</p><p>[Editors’ note: the author responses to the previous round of peer review follow.]</p><p><italic>Consensus review:</italic> </p><p> <italic>The authors present a kinematic analysis of random local search behavior in C. elegans. The then use a Hidden Markov Model to quantitatively model such searches based their kinematic analyses. They then identify this HMM with known aspects of the worm connectome to understand the neural implementation of switches between different behavioral states. In particular, the model contains two populations of neurons, each controlling either forward or reverse locomotion, with the overall network resulting in four possible behaviors: forward, reverse, and two pause states. They perform a maximum likelihood fit of the model to measured time series, making predictions about the effect of neural ablations, the sign and strength of synaptic connections, effects of perturbations to membrane potentials. Moreover, they phenomenologically model a potential underlying neural mechanism for different search modalities. The subject matter of the paper is definitely one of broad interest, and if the model is correct it would provide us with a substantive understanding into the neural implementation of the forward/pause/reversal/pause(?) dynamics it would be a major contribution. However, the reviewers are not fully convinced that the model is the simplest possible explanation of the animal's behavior and that the</italic></p><p><italic>authors have shown that a clear connection can be drawn to neural correlates. Enthusiasm for the subject matter and the potential neural correlates vs. concerns about the appropriateness of the approach and its rigor were weighed differently by the reviewers initially, but in consultation the concerns predominated. The detailed reviews of the expert reviewers are appended but their concerns are summarized below. 1) The model is not adequately placed within the context of previous work in the field. There have been other papers attempting to understand both exploitation/exploration behavioral generation (e.g. Flavell et al., Cell, 2013) and forward/reversing dynamics (e.g. Stephens, PNAS, 2011).</italic> </p><p>The requested context is now provided in the Introduction.</p><p><italic>Moreover, a direct comparison to (Rakowski</italic> et al.<italic>, 2013) is needed. This work, which is cited as Ref. 12, also develops a model of the command neuron network and uses this model to predict behavioral states and the effects of ablations.</italic> </p><p>The Rakowski paper is difficult to decipher at several key respects, but as we understand the text, reviewers’ points (i) and (ii) are almost certainly over-interpretations of what the Rakowski model (RM) achieves.</p><p>(i) Prediction of behavioral states. We agree that the RM enables one to predict/compute from a given weight matrix the quantity <inline-formula><mml:math id="inf825"><mml:mi>R</mml:mi></mml:math></inline-formula> = Tf/(Tf + Tb), where Tf and Tb are, respectively, the total time the animal spends in the forward and backward states during the observation period. Note, however, that <inline-formula><mml:math id="inf826"><mml:mi>R</mml:mi></mml:math></inline-formula> is not a state. Rather, it is the <italic>steady-state</italic> probability of forward locomotion (conditional on the animal not being in the pause state). The individual behavioral states themselves – forward, backward, and stopped, in their terminology – are <italic>not</italic> represented in the mathematics. It would therefore be impossible to derive mathematical expressions for mean dwell times in these states, nor could one simulate the network in time to produce a predicted sequence of behavioral states. Thus, it is simply not true that the RM predicts behavioral states.</p><p>(ii) Prediction of ablation effects. We agree that the RM computes the effects of ablations on the quantity <italic>R</italic>, but we don’t agree it predicts them. This is for the simple reason that the model is fitted to the ablation data, so it can’t be said to predict them. It should have been tested on data to which is was not fitted.</p><p>With respect to the question of ablation effects, we must call the reviewers' attention to the fact that the ablation data in Rakowski were not analyzed for statistical significance, and the Sternberg lab has confirmed this in personal communications. The absence of statistics means that the question of which purported &quot;effects&quot; are real, and which are false positives of false negatives simply cannot be addressed. Rakowski’s claims related to behavioral effects of ablations should therefore be put on hold until they have been subjected to the field’s common standard of validity.</p><p>In revising our manuscript, we nevertheless made the requested direct comparison be between the two models. We added a paragraph in Discussion that is dedicated to the comparison (sixth paragraph). We chose not to mention the missing statistics.</p><p> <italic>2) The existence of two different pause states <inline-formula><mml:math id="inf827"><mml:mi>X</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf828"><mml:mi>Y</mml:mi></mml:math></inline-formula> is not well supported in the data and the HMM does not have the power to confirm their existence.</italic> </p><p>This comment raises two separate questions: (a) Does the addition of a second pause state significantly improve the ability of the model to fit the data? (b) Do the two pause states correspond to “real’” physiological states? These two questions raise fundamentally different issues, which we consider separately below:</p><p>a) Does the addition of a second pause state significantly improve the ability of the model to fit the data? Yes, the second pause state improves the fit well beyond what can be attributed to the addition of two free parameters in the model (p&lt;10<sup>-100</sup> by likelihood ratio test (see subsection “Wild type locomotion“, fourth paragraph and <xref ref-type="table" rid="tbl1">Table 1</xref>). For this test we constrained the rates into state <inline-formula><mml:math id="inf829"><mml:mi>Y</mml:mi></mml:math></inline-formula> to be <inline-formula><mml:math id="inf830"><mml:msub><mml:mi>a</mml:mi><mml:mi>FY</mml:mi></mml:msub></mml:math></inline-formula> = <inline-formula><mml:math id="inf831"><mml:msub><mml:mi>a</mml:mi><mml:mi>RY</mml:mi></mml:msub></mml:math></inline-formula> = 10<sup>-10</sup> s<sup>-1</sup>, which effectively eliminates state <inline-formula><mml:math id="inf832"><mml:mi>Y</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf833"><mml:msub><mml:mi>p</mml:mi><mml:mi>Y</mml:mi></mml:msub></mml:math></inline-formula> &lt; 10<sup>-18</sup>); model B in <xref ref-type="table" rid="tbl1">Table 1</xref>). Because the model with one pause state (model B in <xref ref-type="table" rid="tbl1">Table 1</xref>) is a special case of the model with two pause states (model A in <xref ref-type="table" rid="tbl1">Table 1</xref>), we could apply the likelihood ratio test. The likelihood ratio test is designed specifically for the purpose of comparing two models, one of which is a constrained version of the other, by comparing the reduction in likelihood in the constrained model with the reduction that can be attributed to having fewer free parameters. We further showed that there is almost no benefit in allowing direct transitions between <inline-formula><mml:math id="inf834"><mml:mi>F</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf835"><mml:mi>R</mml:mi></mml:math></inline-formula> states (model C in <xref ref-type="table" rid="tbl1">Table 1</xref>; equivalent to the most general model with one pause state and all 6 transition rates left unconstrained). We conclude that our synaptic model with two pause states, which has 6 free parameters, fits the data far better than any similar model with only one pause state.</p><p>b) Do the two pause states correspond to “real’” physiological states? This is subtle question because “real” physiological state is not easily defined. Therefore, for the purpose of this rebuttal we will consider the strongest version of this question, which we infer to be the question that the reviewer is asking: Does the model have the power to confirm the hypothesis that state <inline-formula><mml:math id="inf836"><mml:mi>X</mml:mi></mml:math></inline-formula> corresponds to both pools of command neurons being “OFF”, whereas state <inline-formula><mml:math id="inf837"><mml:mi>Y</mml:mi></mml:math></inline-formula> corresponds to both pools being “ON”? Our answer is no, and we do not make this claim. Instead, we propose this as a working hypothesis that provides a useful framework in which to interpret results but which will need to be tested directly by physiological experiments when and if such experiments become technically feasible. In support of the working hypothesis, it is important to note that it is consistent with experimental observations beyond the well-known result that the forward command neurons promote forward locomotion and reverse command neurons promote reverse locomotion. It has also been shown that genetic ablation or silencing of both pools of command neurons induces long pauses (subsection “The Stochastic Switch Model, seventh paragraph), as expected for state <inline-formula><mml:math id="inf838"><mml:mi>X</mml:mi></mml:math></inline-formula>, and that worms pause when forward and reverse motor neurons simultaneously enter their activated state (in the eighth paragraph of the aforementioned subsection). Although the latter results are for the motor neurons, not the command neurons that drive them, the gap junction synapses known to exist between the command neurons and their motor neuron targets makes it reasonable to hypothesize that both pools of command neurons are also co-activated during these pauses, as expected for state <inline-formula><mml:math id="inf839"><mml:mi>Y</mml:mi></mml:math></inline-formula>. Thus, there is sufficient experimental evidence to justify proposing our working hypothesis. Additional evidence that states <inline-formula><mml:math id="inf840"><mml:mi>X</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf841"><mml:mi>Y</mml:mi></mml:math></inline-formula> are “real” by physiological criteria comes from our results showing that the two states have different properties. State <inline-formula><mml:math id="inf842"><mml:mi>Y</mml:mi></mml:math></inline-formula> is intimately associated with the termination of reverse locomotion, whereas state <inline-formula><mml:math id="inf843"><mml:mi>X</mml:mi></mml:math></inline-formula> is associated with the end of forward locomotion (<xref ref-type="fig" rid="fig3">Figure 3</xref>). Because worms typically end reverse locomotion with a ventral bend, state <inline-formula><mml:math id="inf844"><mml:mi>Y</mml:mi></mml:math></inline-formula> is associated with this posture (<xref ref-type="fig" rid="fig4">Figure 4</xref>), whereas state <inline-formula><mml:math id="inf845"><mml:mi>X</mml:mi></mml:math></inline-formula> has no strong postural preference. The two states also have different mean dwell times (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>), and state <inline-formula><mml:math id="inf846"><mml:mi>Y</mml:mi></mml:math></inline-formula> almost always leads into state <inline-formula><mml:math id="inf847"><mml:mi>F</mml:mi></mml:math></inline-formula>, whereas state <inline-formula><mml:math id="inf848"><mml:mi>X</mml:mi></mml:math></inline-formula> can exit to either state <inline-formula><mml:math id="inf849"><mml:mi>F</mml:mi></mml:math></inline-formula> or <inline-formula><mml:math id="inf850"><mml:mi>R</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3</xref>). Thus, pauses that follow reverse locomotion are different from pauses that follow forward locomotion, and can therefore be regarded as two different states of the system. It remains to be shown experimentally how closely the states of the model correspond to activity states of the command neurons</p><p>We have made three changes to the manuscript which we hope will limit the risk that other readers will over-interpret what we are claiming with respect to the possible association of states of the model with activity states of the command neurons:</p><p>A) We have rewritten the paragraphs that explain the model assumptions and the possible relationships between the four states of the model and the activity states of the command neurons (subsection “The Stochastic Switch Model”, third, seventh and eighth paragraphs).</p><p>B) The title has been changed from “A stochastic neuronal flip-flop circuit regulates random search during foraging behavior,” to “A stochastic neuronal model predicts random search behaviors at multiple spatial scales in <italic>C. elegans</italic>.”</p><p>C) We have re-stated the primary conclusion of the paper (Discussion, fourth paragraph): “Nevertheless, the predictive and explanatory successes of the model demonstrate the utility of present conceptualization of the network.”</p><p> <italic>3) The mapping of the HMM onto the underlying neuronal network is not convincing. In particular there little data in this paper or in any of the citations to support the contention that pause state <inline-formula><mml:math id="inf851"><mml:mi>X</mml:mi></mml:math></inline-formula> = all command neurons off and pause state <inline-formula><mml:math id="inf852"><mml:mi>Y</mml:mi></mml:math></inline-formula> = all command neurons on.</italic> </p><p>As noted in response to critique 2, this is an assumption, not a contention, and we have taken steps to clarify this point in the Discussion.</p><p><italic>Mapping synaptic weights onto coupling in the HMM is not rigorous.</italic> </p><p>We understand this statement to mean that we have not provided an equation for computing synaptic strength, as would be measured electrophysiologically in pairwise recordings quantifying synaptic currents, in terms of synaptic weights (<italic>w</italic>) as defined in the Stochastic Switch Model. We agree. As requested below, we have relaxed claims to have demonstrated prediction of synaptic weights in the electrophysiological sense of the term.</p><p> <italic>For the paper to be suitable for eLife the following extensive changes would have to be made.</italic> </p><p> <italic>1) Relax the claims about the model's prediction of synaptic weights.</italic> </p><p>We have relaxed these claims by pointing out that the term “synaptic weight” has different meanings in the neural-network versus the electrophysiological literature (neither field, of course, can be said to own the term). We now relax our claims by explicitly stating that the Stochastic Switch Model does not predict the magnitude of synaptic conductances (subsection “Synaptic weights in the stochastic switch model”, second paragraph). But it does predict aspects of functional connectivity, such as excitation or inhibition, because weights in the model are signed quantities. We also relax our claims of correspondence between the model and the electrophysiology by noting that our method of testing the model carries with it the assumption that functional connectivity between populations of neurons reflects the connectivity between the neurons in those pools that have the greatest effects on behavior (e.g. in ablations).</p><p><italic>2) The authors need to establish firmly that tracking a single point provides an unbiased estimate of trajectory in light of Stephens, PLoS One (2010). Given their extensive data set, we presume that converting their point imaging into centerline tracking would be extremely difficult and time consuming, but the authors should at least place their analysis in this light.</italic> </p><p>The field recognizes two definitions of trajectory. One is path of the centroid (Pierce- Shimomura et al., 1999), defined as the midpoint of the smallest rectangle that can enclose the worm. The other is the path taken by one or more points on the worm’s centerline (Cronin et al., 2005); spot tracking is an instance of the latter.</p><p>Centroid trajectory. Stephens et al. are mainly concerned with the time series of postural measurements, not trajectory. The 2010 paper is an exception, but it considers only centroid trajectory. The main point of that paper is to show that the centroid trajectories of real worms can be recovered from the time series of their posture. The authors report, however, that their “eigenworm model” can be expected to do this only when the trajectory of the real worm is relatively straight. The degree of fit between real and computed trajectories is shown in the supplemental material; the fits may or may not be convincing, depending upon one’s point of view. No attempt is made by Stephens et al. to compute centerline trajectories.</p><p>Centerline trajectory. According to the theory of thrust generation in sinusoidal locomotion, established by Gray (1946, 1953) and extended to nematodes by (Gray and Lissman, 1964), the spot tracking method should provide an accurate estimate of centerline trajectory, an estimate that is probably more accurate than previous centerline methods (Cronin et al., 2005). In the case of ideal sinusoidal locomotion (no lateral slip), each segment of the body recapitulates the path of the segment ahead of it, like train cars on a sinuous track; thus the trajectory is just the path taken by the segments. On agar plates, <italic>C. elegans</italic> plows a furrow as it crawls; surface tension provides the necessary downward pressure. The walls of this furrow, which provide the lateral resistance for thrust generation, are what causes each segment to follow the one ahead of it. It is general practice in the field to dry agar plates slightly before use to reduce slip, ensuring that the body stays within the furrow, and locomotion approaches the ideal case. Under these conditions, a radially symmetric tracking perfectly centered on the body axis introduces no bias into trajectory. Bias occurs only when the center of mass of the tracking spot is eccentric to the centerline. This offset shifts the trajectory by the extent of the eccentricity and can increase/decrease the curvature maxima/minima. But in practice eccentricities were small, probably less than 1/10 of the worm’s diameter, because spots with greater eccentricities were quickly rubbed off by friction with the substrate; such recordings were discarded. Another potential problem is deformation of the spot as the worm’s body undulates, but this was almost certainly not an issue in our experiments because the long axis of the spot was small with respect to the radius of curvature of the worm. Note: The first step in Stephens’ image analysis was to compute the worm’s centerline (Stephens et al., 2008), but centerlines were used only to compute posture. They were not used to compute the centerline velocity, although this would have been possible as previously shown (Cronin et al., 2005).</p><p>Conversion of spot-tracking to centerline tracking. Centerlines can be recovered easily from spot tracking data. We have now done this for the entire wild type data set and included it in the paper (<xref ref-type="fig" rid="fig4">Figure 4</xref>). Our goal was to ask whether the worm adopts a particular posture as it enters the pause state, as Stephens et al. report. In this analysis we were somewhat limited by the fact that in the spot tracking method, pause posture can be delineated only up to the anterior-posterior level of the spot (approximately the midpoint). This limitation occurs because the spot’s future trajectory after the pause has not yet occurred, but it is mitigated by the fact that postures in which curvature is discontinuous do not occur in live, wild type worms. We find that pauses following reversals occur at a particular posture whereas pauses following forward locomotion do not. In contrast, <xref ref-type="fig" rid="fig5">Figure 5D</xref> of Stephens et al. (2008) indicates pauses occur a particular postures regardless of the direction of movement. One obvious reason for the discrepancy between the two studies is the difference in definitions of velocity used to identify the pause state. This topic is addressed in detail in the Discussion (fifth paragraph).</p><p>In summary, the eigenworm model is based on postures, not trajectories. Centroid trajectory can be recovered in the eigenworm model, but it is inaccurate unless the worm is moving comparatively straight. In contrast, the spot tracking method provides an accurate measure of centerline trajectory without significant bias.</p><p><italic>They should also bolster their arguments that there are two behaviorally distinct pause states and discuss how they are related to the two pause states of Stephens.</italic> </p><p>(i) On the existence of two pause states. As stated above, we do not claim that the model has the power to confirm the existence of the two pause states. However, the model does provide reasons to believe such states might exist. As requested, we have reinforced these arguments, now devoting a whole new paragraph to the issue (subsection “Wild type locomotion“, fourth paragraph).</p><p>(ii) Discuss relationship to pause states of Stephens. Done. See fifth paragraph of the Discussion.</p><p> <italic>3) The authors should differentiate their work with respect to Rakowski, 2013. Does their model provide different predictions? Can they be disambiguated? It would be great if they could show this, but minimally, they should suggest what experiments should be performed in the future.</italic> </p><p>See Discussion, sixth paragraph.</p><p><italic>4) Similarly</italic> –</p><p><italic>what measurements should be made to distinguish <inline-formula><mml:math id="inf853"><mml:mi>X</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf854"><mml:mi>Y</mml:mi></mml:math></inline-formula> pause states map onto the electrical activity of the command neuron network at least at some coarse-grained level?</italic> </p><p>See Discussion, third and fourth paragraphs.</p><p>Reviewer #3: 1) In <xref ref-type="fig" rid="fig4">Figure 4B</xref>, I find the excuse for omitting error bars to be relatively weak. Minimally, bootstrapped confidence intervals could be found, which would be significantly better than the current lack of any measure of variability.</p><p>Note: <xref ref-type="fig" rid="fig4">Figure 4</xref> is now <xref ref-type="fig" rid="fig5">Figure 5</xref>.</p><p>Calculating confidence intervals would be nice for graphical representation, but was unnecessary to compute statistical significance of the differences shown in the figure, which was done using the likelihood ratio test, results of which are shown in <xref ref-type="table" rid="tbl4">Table 4</xref>. Computing the results shown in <xref ref-type="table" rid="tbl4">Table 4</xref> was extremely time-consuming; &gt;95% of the computation time for the entire data analysis presented in the paper was for computing the p-values in this table. Computing confidence intervals for <xref ref-type="fig" rid="fig5">Figure 5B</xref> (formerly <xref ref-type="fig" rid="fig4">Figure 4B</xref>) would require another ~10x increase in computation time, thousands of hours. Given that the confidence intervals would not be used to for the key statistical tests, which we already have done using the appropriate test, it would be an unnecessary burden to compute them.</p><p><italic>2) In the fifth paragraph of the subsection “Genetic effects on command neuron function “</italic>and <xref ref-type="fig" rid="fig6">Figure 6</xref>. The claim is made that &quot;changes in synaptic strength dominate the effects of changes in membrane potential on Δ<inline-formula><mml:math id="inf855"><mml:mi>F</mml:mi></mml:math></inline-formula> and</p><p><italic>Δ<inline-formula><mml:math id="inf856"><mml:mi>R</mml:mi></mml:math></inline-formula>.&quot; This certainly seems true for Δ<inline-formula><mml:math id="inf857"><mml:mi>F</mml:mi></mml:math></inline-formula>, but both models appear to give more-or-less identical predictions here for Δ<inline-formula><mml:math id="inf858"><mml:mi>R</mml:mi></mml:math></inline-formula>.</italic> </p><p>We understand the concern here to be that the ΔV and Δ<inline-formula><mml:math id="inf859"><mml:mi>R</mml:mi></mml:math></inline-formula> models make the same prediction for changes in Δ<inline-formula><mml:math id="inf860"><mml:mi>R</mml:mi></mml:math></inline-formula>, meaning that the Δ<inline-formula><mml:math id="inf861"><mml:mi>R</mml:mi></mml:math></inline-formula> data cannot be used to distinguish between the two models. However, taking a step back and looking across the Δ<inline-formula><mml:math id="inf862"><mml:mi>R</mml:mi></mml:math></inline-formula> and Δ<inline-formula><mml:math id="inf863"><mml:mi>F</mml:mi></mml:math></inline-formula> data simultaneously, it can be seen that the Δ<inline-formula><mml:math id="inf864"><mml:mi>R</mml:mi></mml:math></inline-formula> model gets both patterns right, whereas the ΔV model gets only one of them right. It is this fact that we take as evidence in support of the Δ<inline-formula><mml:math id="inf865"><mml:mi>R</mml:mi></mml:math></inline-formula> model for Δ<inline-formula><mml:math id="inf866"><mml:mi>F</mml:mi></mml:math></inline-formula> and Δ<inline-formula><mml:math id="inf867"><mml:mi>R</mml:mi></mml:math></inline-formula>. The text has been modified to make it more clear that we are looking across Δ<inline-formula><mml:math id="inf868"><mml:mi>F</mml:mi></mml:math></inline-formula><italic>and</italic> Δ<inline-formula><mml:math id="inf869"><mml:mi>R</mml:mi></mml:math></inline-formula> when comparing the models (subsection “Genetic effects on command neuron function”, sixth paragraph).</p><p><italic>3) In the first paragraph of the subsection “The Stochastic Switch Model and other random search behaviors“. It is claimed that &quot;changes are required in at least three weights to produce the full range of search behaviors.&quot; This is not actually shown anywhere in the paper, just that three weights are sufficient to induce the full range. A supplementary figure to this effect would be useful.</italic> </p><p>The revised text and figures now carefully document weight changes that are minimally required for the full range of search modes (<xref ref-type="fig" rid="fig8">Figure 8</xref> including supplementals, <xref ref-type="table" rid="tbl7">Table 7</xref> (new), and accompanying text (subsection “Regulation of search scale, last two paragraphs and subsection “Biased random walks”).</p><p><italic>4) The predicted value for the dwell time in the forward state is not comparable to the rest of the literature, as a different definition is used here. What would happen if a standard definition was used? Does the same rate result?</italic></p><p>We now report the mean dwell times for <inline-formula><mml:math id="inf870"><mml:mi>F</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf871"><mml:mi>R</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf872"><mml:mi>X</mml:mi></mml:math></inline-formula> based on fixed velocity thresholds of ± 0.05 mm/s. = 1.86 ± 0.03; = 1.23 ± 0.02; <inline-formula><mml:math id="inf873"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>05</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>= 0.14 ± 0.001. Thus, the short dwell times in the forward state that we observed were not due to the model. We attribute them instead to the higher time resolution of our tracking hardware (subsection “Wild type locomotion”, first paragraph).</p></body></sub-article></article>