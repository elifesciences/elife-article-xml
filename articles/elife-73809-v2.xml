<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">73809</article-id><article-id pub-id-type="doi">10.7554/eLife.73809</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Developmental Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Diversification of multipotential postmitotic mouse retinal ganglion cell precursors into discrete types</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-253019"><name><surname>Shekhar</surname><given-names>Karthik</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4349-6600</contrib-id><email>kshekhar@berkeley.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-255653"><name><surname>Whitney</surname><given-names>Irene E</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="pa1">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-255654"><name><surname>Butrus</surname><given-names>Salwan</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-255655"><name><surname>Peng</surname><given-names>Yi-Rong</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-2266"><name><surname>Sanes</surname><given-names>Joshua R</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8926-8836</contrib-id><email>sanesj@mcb.harvard.edu</email><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01an7q238</institution-id><institution>Department of Chemical and Biomolecular Engineering; Helen Wills Neuroscience Institute; Center for Computational Biology; California Institute for Quantitative Biosciences, QB3, University of California, Berkeley</institution></institution-wrap><addr-line><named-content content-type="city">Berkeley</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02jbv0t02</institution-id><institution>Biological Systems and Engineering Division, Lawrence Berkeley National Laboratory</institution></institution-wrap><addr-line><named-content content-type="city">Berkeley</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05a0ya142</institution-id><institution>Broad Institute of Harvard and MIT</institution></institution-wrap><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03vek6s52</institution-id><institution>Center for Brain Science and Department of Molecular and Cellular Biology, Harvard University</institution></institution-wrap><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff><aff id="aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/046rm7j60</institution-id><institution>Department of Ophthalmology, Stein Eye Institute, UCLA David Geffen School of Medicine</institution></institution-wrap><addr-line><named-content content-type="city">Los Angeles</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Mason</surname><given-names>Carol A</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00hj8s172</institution-id><institution>Columbia University</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Desplan</surname><given-names>Claude</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0190ak572</institution-id><institution>New York University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="present-address" id="pa1"><label>†</label><p>Honeycomb Biotechnologies, Waltham MA, United States</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>22</day><month>02</month><year>2022</year></pub-date><pub-date pub-type="collection"><year>2022</year></pub-date><volume>11</volume><elocation-id>e73809</elocation-id><history><date date-type="received" iso-8601-date="2021-09-11"><day>11</day><month>09</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2022-02-21"><day>21</day><month>02</month><year>2022</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2021-10-21"><day>21</day><month>10</month><year>2021</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2021.10.21.465277"/></event></pub-history><permissions><copyright-statement>© 2022, Shekhar et al</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>Shekhar et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-73809-v2.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-73809-figures-v2.pdf"/><abstract><p>The genesis of broad neuronal classes from multipotential neural progenitor cells has been extensively studied, but less is known about the diversification of a single neuronal class into multiple types. We used single-cell RNA-seq to study how newly born (postmitotic) mouse retinal ganglion cell (RGC) precursors diversify into ~45 discrete types. Computational analysis provides evidence that RGC transcriptomic type identity is not specified at mitotic exit, but acquired by gradual, asynchronous restriction of postmitotic multipotential precursors. Some types are not identifiable until a week after they are generated. Immature RGCs may be specified to project ipsilaterally or contralaterally to the rest of the brain before their type identity emerges. Optimal transport inference identifies groups of RGC precursors with largely nonoverlapping fates, distinguished by selectively expressed transcription factors that could act as fate determinants. Our study provides a framework for investigating the molecular diversification of discrete types within a neuronal class.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>retinal ganglion cells</kwd><kwd>single-cell RNA-seq</kwd><kwd>cell type diversification</kwd><kwd>optimal transport</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Mouse</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R37NS029169</award-id><principal-award-recipient><name><surname>Sanes</surname><given-names>Joshua R</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R01EY022073</award-id><principal-award-recipient><name><surname>Sanes</surname><given-names>Joshua R</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R00EY028625</award-id><principal-award-recipient><name><surname>Shekhar</surname><given-names>Karthik</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>GRP DGE1752814</award-id><principal-award-recipient><name><surname>Butrus</surname><given-names>Salwan</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Single-cell transcriptomic analysis of developing retinal ganglion cells in mice suggests that their diversification into 45 discrete types occurs via the gradual restriction of multipotential precursors.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>A central question in developmental neurobiology is how the brain’s diverse neuronal types arise from multipotential progenitors (<xref ref-type="bibr" rid="bib51">Lodato and Arlotta, 2015</xref>; <xref ref-type="bibr" rid="bib61">McConnell, 1991</xref>; <xref ref-type="bibr" rid="bib91">Wamsley and Fishell, 2017</xref>). The vertebrate retina has been a valuable model for addressing this question: it is about as complicated as any other region of the brain, but has several features that facilitate mechanistic analysis (<xref ref-type="bibr" rid="bib20">Dowling, 2012</xref>). The retina contains five classes of neurons – photoreceptors that sense light, three interneuronal classes (horizontal, bipolar, and amacrine cells) that process visual information, and retinal ganglion cells (RGCs) that pass the information to the rest of the brain through the optic nerve (<xref ref-type="fig" rid="fig1">Figure 1a</xref>; <xref ref-type="bibr" rid="bib59">Masland, 2012</xref>). These classes can be divided into numerous types, ~130 in mouse and chick, each of which has characteristic morphological, physiological, and molecular properties, and plays distinct roles in information processing (<xref ref-type="bibr" rid="bib1">Baden et al., 2016</xref>; <xref ref-type="bibr" rid="bib26">Franke et al., 2017</xref>; <xref ref-type="bibr" rid="bib30">Goetz et al., 2021</xref>; <xref ref-type="bibr" rid="bib53">Macosko et al., 2015</xref>; <xref ref-type="bibr" rid="bib71">Rheaume et al., 2018</xref>; <xref ref-type="bibr" rid="bib80">Shekhar et al., 2016</xref>; <xref ref-type="bibr" rid="bib81">Shekhar and Sanes, 2021</xref>; <xref ref-type="bibr" rid="bib85">Tran et al., 2019</xref>; <xref ref-type="bibr" rid="bib95">Yamagata et al., 2021</xref>; <xref ref-type="bibr" rid="bib96">Yan et al., 2020</xref>). Remarkably, nearly all types are distributed across the entire retina (<xref ref-type="bibr" rid="bib43">Kay et al., 2012</xref>; <xref ref-type="bibr" rid="bib44">Keeley et al., 2020</xref>; <xref ref-type="bibr" rid="bib72">Rockhill et al., 2000</xref>), so morphogen gradients, which play a critical role in other parts of the central nervous system (e.g., <xref ref-type="bibr" rid="bib74">Sagner and Briscoe, 2019</xref>), cannot provide an explanation for retinal neuronal diversification (<xref ref-type="bibr" rid="bib57">Marquardt and Gruss, 2002</xref>).</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Transcriptomic profiling of single postmitotic retinal ganglion cells (RGCs) during embryonic and postnatal development in mice.</title><p>(<bold>a</bold>) Sketch of a section of the mouse retina showing major cell classes – photoreceptors (PRs; rods and cones), horizontal cells (HCs), bipolar cells (BCs), amacrine cells (ACs), Müller glia (MGs), and RGCs. PRs reside in the outer nuclear layer (ONL), while BCs, HCs, and most ACs reside in the inner nuclear layer (INL). RGCs and some ACs reside in the ganglion cell layer (GCL). Axons of RGCs project to higher visual areas via the optic nerve. (<bold>b</bold>) Retinal section of the indicated ages labeled for the cell cycle marker <italic>MKI67</italic> (red) and the RGC marker <italic>RBPMS</italic> (green); nuclei are counterstained by the Hoeschst dye (blue). Micrographs are orientated as the schematic in panel (<bold>a</bold>). (<bold>c</bold>) Visualization of transcriptional diversity of 98,452 cells using Uniform Manifold Approximation and Projection (UMAP), a nonlinear dimensionality reduction algorithm that assigns proximal x-y coordinates to cells (dots) with similar transcriptional profiles (<xref ref-type="bibr" rid="bib7">Becht et al., 2018</xref>). (<bold>d</bold>) Same as (<bold>c</bold>), with cells colored by cell class, assigned based on transcriptional signatures displayed in panel (<bold>e</bold>). RPC, retinal progenitor cells; Ant. Seg., anterior segment cells. (<bold>e</bold>) Tracksplot showing expression patterns of cell class-specific marker genes (rows) across single cells (columns). Cells are grouped by class as in (<bold>d</bold>). For each class, we randomly sampled 20% of total cells covering all immature time points (embryonic day [E]13, E14, E16, postnatal day [P]0, P5). For each gene, the scale on the y-axis (right) corresponds to normalized, log-transformed transcript counts detected in each cell.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73809-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Separation of major transcriptomic groups and assessment of immature retinal ganglion cells (RGCs) at embryonic day (E)13 to postnatal day (P)5.</title><p>(<bold>a</bold>) Retinal sections stained with L1CAM (red), which was used to enrich for RGCs at early stages, and the pan-RGC marker RBPMS<italic>,</italic> (green) at E13, E14, E16, and P0. Nuclei are counterstained by the Hoeschst dye (blue). (<bold>b</bold>) Relative proportions (y-axis) of major cell classes shown in <xref ref-type="fig" rid="fig1">Figure 1c–e</xref> at each combination of age and enrichment method. Both anti-Thy1 and anti-L1cam were used to enrich RGCs at E13, E14, E16, and P0, but only anti-Thy1 was used at P5, because L1cam becomes localized to axons postnatally. AC, amacrine cells; RPC, retinal progenitor cells. (<bold>c</bold>) Box-and-whisker plots show gene expression levels of key markers by RGCs as a function of age and enrichment method. Markers shown are two pan-RGC markers, <italic>Rbpms, Nefl</italic>, and the two cell surface proteins used for enrichment, <italic>Thy1</italic> and <italic>L1cam</italic>. Note that <italic>Thy1</italic> expression is poor at E13, consistent with low RGC yield in anti-Thy1-enriched cells in panel (<bold>b</bold>). Black horizontal line, median; bars, interquartile range; vertical lines, range; dots, outliers. (<bold>d</bold>) Dotplot showing genes (columns) that are selectively expressed in RGCs and RPCs. The size of each circle is proportional to the percentage of cells expressing the gene, and the color depicts the average log-normalized expression. (<bold>e</bold>) Co-embedding analysis of E14, E16, and P0 data collected in this study with whole retina single-cell transcriptomes in independent studies: E14, E16, and P0 data from <xref ref-type="bibr" rid="bib17">Clark et al., 2019</xref> and E15.5 data from <xref ref-type="bibr" rid="bib50">Lo Giudice et al., 2019</xref>. Cells (points) are visualized in Uniform Manifold Approximation and Projection (UMAP) and colored by study of origin. (<bold>f</bold>) Same as (<bold>e</bold>), with cells colored by the expression level of <italic>Nefl,</italic> an RGC marker. This shows the higher enrichment of RGCs in our study compared to <xref ref-type="bibr" rid="bib17">Clark et al., 2019</xref> and <xref ref-type="bibr" rid="bib50">Lo Giudice et al., 2019</xref>. (<bold>g</bold>) Same as (e), with cells colored by expression level of <italic>Fgf15</italic>, an RPC marker. (<bold>h</bold>) Relative proportions of major cell classes across different datasets analyzed in panel (<bold>e</bold>) separated by age. T, this study. (<bold>i</bold>) Confusion matrix showing post hoc transcriptomic correspondence between P5 RGC types identified in <xref ref-type="bibr" rid="bib71">Rheaume et al., 2018</xref> (y-axis) and P5 RGC clusters reported in this study (x-axis). In each case, RGCs from Rheaume et al. were assigned P5 cluster labels using an XGBoost classifier trained on P5 RGCs profiled in this study.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73809-fig1-figsupp1-v2.tif"/></fig></fig-group><p>Seminal studies have provided deep insights into how retinal classes arise (<xref ref-type="bibr" rid="bib6">Bassett and Wallace, 2012</xref>; <xref ref-type="bibr" rid="bib13">Cepko, 2014</xref>). First, lineage tracing in rodents and frogs showed that single retinal progenitor cells (RPCs) can give rise to neurons of all classes as well as glia, and are therefore multipotential (<xref ref-type="bibr" rid="bib35">Holt et al., 1988</xref>; <xref ref-type="bibr" rid="bib87">Turner and Cepko, 1987</xref>; <xref ref-type="bibr" rid="bib88">Turner et al., 1990</xref>; <xref ref-type="bibr" rid="bib94">Wetts and Fraser, 1988</xref>). Second, the competence of multipotential RPCs to generate cells of particular classes changes over time, accounting for their sequential (but overlapping) birth windows (<xref ref-type="bibr" rid="bib13">Cepko, 2014</xref>; <xref ref-type="bibr" rid="bib49">Livesey and Cepko, 2001</xref>). Such segregation of birth windows is a hallmark of many neuronal systems (<xref ref-type="bibr" rid="bib34">Holguera and Desplan, 2018</xref>) and is believed to arise from the differential temporal regulation of gene expression in RPCs (<xref ref-type="bibr" rid="bib9">Blackshaw et al., 2004</xref>; <xref ref-type="bibr" rid="bib11">Brown et al., 2001</xref>; <xref ref-type="bibr" rid="bib14">Chen et al., 1997</xref>; <xref ref-type="bibr" rid="bib17">Clark et al., 2019</xref>; <xref ref-type="bibr" rid="bib86">Trimarchi et al., 2008</xref>). Third, competence is probabilistic rather than deterministic, with stochastic factors accounting for variations in the distribution of cell classes generated by individual RPCs (<xref ref-type="bibr" rid="bib10">Boije et al., 2014</xref>; <xref ref-type="bibr" rid="bib32">Gomes et al., 2011</xref>; <xref ref-type="bibr" rid="bib40">Johnston and Desplan, 2010</xref>).</p><p>In contrast to these well-established tenets of neuronal class generation, we know far less about how immature postmitotic neurons (which we call neuronal precursors here) committed to a specific class identity diversify into distinct types. We address this issue here, focusing on RGCs. All RGCs are similar in many respects: for example, they all elaborate dendrites that receive input from amacrine and bipolar interneurons, send axons through the optic nerve, and use glutamate as a neurotransmitter (<xref ref-type="bibr" rid="bib77">Sanes and Masland, 2015</xref>). However, they differ in molecular, morphological, and physiological details, which have led to their division into ~45 distinct types in mice (<xref ref-type="bibr" rid="bib1">Baden et al., 2016</xref>; <xref ref-type="bibr" rid="bib3">Bae et al., 2018</xref>; <xref ref-type="bibr" rid="bib30">Goetz et al., 2021</xref>; <xref ref-type="bibr" rid="bib71">Rheaume et al., 2018</xref>; <xref ref-type="bibr" rid="bib85">Tran et al., 2019</xref>). Most of these types appear to be feature detectors that collectively transmit a diverse set of highly processed images of the visual world to the rest of the brain (<xref ref-type="bibr" rid="bib2">Baden et al., 2020</xref>; <xref ref-type="bibr" rid="bib77">Sanes and Masland, 2015</xref>). Several genes have been implicated in maturation of a few mouse RGC types (<xref ref-type="bibr" rid="bib17">Clark et al., 2019</xref>; <xref ref-type="bibr" rid="bib46">Kiyama et al., 2019</xref>; <xref ref-type="bibr" rid="bib48">Liu et al., 2018</xref>; <xref ref-type="bibr" rid="bib50">Lo Giudice et al., 2019</xref>; <xref ref-type="bibr" rid="bib52">Lyu and Mu, 2021</xref>; <xref ref-type="bibr" rid="bib68">Peng et al., 2017</xref>; <xref ref-type="bibr" rid="bib75">Sajgo et al., 2017</xref>), but a comprehensive investigation of RGC diversification has been lacking.</p><p>To gain insight into how and when adult RGC types emerge, we used high-throughput single-cell RNA-seq (scRNA-seq) to profile RGC precursors during embryonic and postnatal life in mice. We find that the number and distinctiveness of molecularly defined groups of precursors increases with developmental age, implying that types arise by a gradual process rather than from ~45 committed precursor types. Using statistical inference approaches, we identify fate associations among immature RGCs as transcriptomically distinct types emerge. These analyses suggest a model in which types arise from multipotential precursors by a process of restriction that we term fate decoupling. The decoupling is gradual and asynchronous, resulting in different types emerging at different times. We also use markers of RGCs that project to contralateral or ipsilateral retinorecipient areas to subdivide each type by its projection pattern, leading to the conclusion that laterality may be specified prior to type identity is fixed. Together, our results provide both a model of RGC diversification and a computational framework that can be applied generally to analyze the diversification of closely related neuronal types within a class.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Transcriptomic atlas of developing mouse RGCs</title><p>Mouse RGCs are born between approximately embryonic days (E) 11 and 17 with newborn RGCs exiting the mitotic cycle near the apical margin, then migrating basally to form the ganglion cell layer (<xref ref-type="bibr" rid="bib21">Dräger, 1985</xref>; <xref ref-type="bibr" rid="bib56">Marcucci et al., 2019</xref>; <xref ref-type="bibr" rid="bib90">Voinescu et al., 2009</xref>; <xref ref-type="fig" rid="fig1">Figure 1b</xref>). Reported birthdates differ among publications and are complicated by naturally occurring cell death and the central-peripheral developmental gradient, but a detailed analysis concludes that &gt;95% of RGCs in adult mouse retina are born after E12.8 and &gt;85% before E16 (<xref ref-type="bibr" rid="bib24">Farah and Easter, 2005</xref>). Shortly after they are born, RGCs extend axons through the optic nerve, with some reaching retinorecipient areas by E15 (<xref ref-type="bibr" rid="bib29">Godement et al., 1984</xref>; <xref ref-type="bibr" rid="bib65">Osterhout et al., 2011</xref>) and forming diverse projection patterns (<xref ref-type="bibr" rid="bib58">Martersteck et al., 2017</xref>). During early postnatal life, they extend dendrites apically into the inner plexiform layer of the retina, receiving synapses from amacrine cells by postnatal day (P)4 and bipolar cells a few days later (<xref ref-type="bibr" rid="bib45">Kim et al., 2010</xref>; <xref ref-type="bibr" rid="bib47">Lefebvre et al., 2015</xref>). Light responses are detected in RGCs by P10 but image-forming vision does not begin until eye-opening, around P14 (<xref ref-type="bibr" rid="bib37">Hooks and Chen, 2020</xref>).</p><p>To determine when and how RGCs diversify, we used droplet-based scRNA-seq (<xref ref-type="bibr" rid="bib53">Macosko et al., 2015</xref>; <xref ref-type="bibr" rid="bib99">Zheng et al., 2017</xref>) to profile them at five stages: E13 and E14 (during the period of peak RGC genesis), E16 (by which time RGCs axons are reaching target retinorecipient areas), P0 (as dendrite elaboration begins), and P5 (shortly after RGCs begin to receive synapses). As RGCs comprise ≤1% of retinal cells (<xref ref-type="bibr" rid="bib38">Jeon et al., 1998</xref>), we enriched them with antibodies to two RGC-selective cell surface markers, Thy1/CD90 (<xref ref-type="bibr" rid="bib5">Barres et al., 1988</xref>) and L1cam (<xref ref-type="bibr" rid="bib18">Demyanenko and Maness, 2003</xref>; <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1a</xref>).</p><p>We obtained a total of 98,452 single-cell transcriptomes with acceptable quality metrics (Materials and methods). Of these, we identified 75,115 (76%) as RGCs based on their expression of canonical RGC markers, including <italic>Rbpms</italic> (an RNA-binding protein) and <italic>Slc17a6</italic> (the vesicular glutamate transporter VGLUT2) (<xref ref-type="fig" rid="fig1">Figure 1c–e</xref><bold>,</bold> <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1b and c</xref>). Non-RGCs included amacrine cells (<italic>Tfap2a+ Tfap2b+</italic>), cone photoreceptors (<italic>Otx2+ Crx</italic>+ ), microglia (<italic>P2ry12+ C1qa+</italic>), anterior segment cells (<italic>Mgp+ Bgn</italic>+ ), and RPCs. Anterior segment cells were found only in E13 and E14 samples because whole eyes were dissociated at these stages. RPCs formed a continuum, containing both ‘primary’ RPCs expressing cell cycle-related genes (e.g., <italic>Mki67, Ccnd5,</italic> and <italic>Birc5</italic>) and previously described RPC regulators (e.g., <italic>Sfrp2</italic>, <italic>Vsx2,</italic> and <italic>Fgf15</italic>), and ‘neurogenic’ RPCs expressing proneural transcription factors (TFs) (e.g., <italic>Hes6</italic>, <italic>Ascl1</italic>, and <italic>Neurog2</italic>) (<xref ref-type="bibr" rid="bib17">Clark et al., 2019</xref>). Importantly, these markers were not expressed in cells annotated as RGCs (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1d</xref>). These stringent criteria ensured that our dataset comprised postmitotic committed RGCs, allowing us to focus on their diversification and maturation.</p><p>Overall, we recovered ~5900–18,500 RGCs at each of the five time points. Of the two surface markers used for enriching RGCs, Thy1 was effective at later stages as shown previously (<xref ref-type="bibr" rid="bib42">Kay et al., 2011</xref>; <xref ref-type="bibr" rid="bib71">Rheaume et al., 2018</xref>; <xref ref-type="bibr" rid="bib85">Tran et al., 2019</xref>), whereas L1cam expression was more selective at E13 and E14 (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1b and c</xref>). However, identical clusters were observed with both methods at E13, E14, and E16, albeit with different frequencies. This concordance supports the idea that neither marker fails to capture particular RGC types. To further evaluate the effectiveness of our enrichment strategy at early stages, we compared our data with two recent studies in which developing retinal cells were profiled using scRNA-seq without any enrichment (<xref ref-type="bibr" rid="bib17">Clark et al., 2019</xref>; <xref ref-type="bibr" rid="bib50">Lo Giudice et al., 2019</xref>). A joint analysis of these datasets at embryonic time points showed consistency in the transcriptional signatures of major cell groups without discernible biases (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1e–g</xref>). However, our enrichment protocols increased the fractional yield of RGCs by &gt;3× at E14 and E16 and by &gt;100× at P0 (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1h</xref>), which enabled us to resolve heterogeneity within this class at immature stages. We also compared our P5 data with those from an earlier study in which P5 RGCs were profiled (<xref ref-type="bibr" rid="bib71">Rheaume et al., 2018</xref>) and found a good correspondence (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1i</xref>). For the analysis that follows, we combined precursor RGCs (E13–P5) with a previously described dataset of 35,699 mature RGCs at P56 (<xref ref-type="bibr" rid="bib85">Tran et al., 2019</xref>).</p></sec><sec id="s2-2"><title>Immature RGCs diversify postmitotically</title><p>One can envision two extreme models of RGC diversification. In one, RGC type would be specified at or before mitotic exit, with each type arising from a distinct set of committed precursors that are transcriptomically defined. At the other extreme, all precursor RGCs would be identical when they exit mitosis and gradually acquire distinct identities as they mature (<xref ref-type="fig" rid="fig2">Figure 2a</xref>). Intermediate models could involve multiple groups of precursor RGCs, each biased towards a distinct set of terminal types.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>The number and discreteness of transcriptomic clusters of retinal ganglion cells (RGCs) increase with age.</title><p>(<bold>a</bold>) Extreme models of RGC diversification. In one scenario (left), immature RGCs commit to one of the terminal types by the time of birth (i.e., mitotic exit) or shortly after. Alternatively (right), initially identical postmitotic RGC precursors acquire distinct molecular identities in a gradual process of restriction. (<bold>b–g</bold>) Visualization of transcriptomic diversity of immature RGCs at embryonic day (E)13 (<bold>b</bold>), E14 (<bold>c</bold>), E16 (<bold>d</bold>), postnatal day (P)0 (<bold>e</bold>), P5 (<bold>f</bold>), and P56 (<bold>g</bold>) using Uniform Manifold Approximation and Projection (UMAP). Cells are colored by their cluster identity, determined independently using dimensionality reduction and graph clustering (Materials and methods). Clusters are numbered based on decreasing size at each age. Data for adults (P56) are replotted from <xref ref-type="bibr" rid="bib85">Tran et al., 2019</xref>. In that study, 45 transcriptomic types were identified via unsupervised approaches, one of which was mapped to two known functional types by supervised approaches. We do not distinguish them in this study. (<bold>h</bold>) Transcriptional diversity of RGCs as measured by the Rao diversity index (y-axis) increases with age (x-axis). The trend is insensitive to the number of genes used to compute inter-cluster distance (colors). See Materials and methods for details underlying the calculation. (<bold>i</bold>) Transcriptomic distinctions between RGC clusters become sharper with age as shown by decreasing average per-cluster error of a multiclass classifier with age. Gradient boosted decision trees (<xref ref-type="bibr" rid="bib15">Chen and Guestrin, 2016</xref>) were trained on a subset of the data and applied on held-out samples to determine the test error. (<bold>j</bold>) RGC clusters also become better separated in the UMAP embedding, as shown by the decreasing values of the average relative cluster diameter with age.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73809-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Transcriptomic diversity of immature retinal ganglion cells (RGCs) by age.</title><p>(<bold>a–c</bold>) Uniform Manifold Approximation and Projection (UMAP) embedding for RGCs at embryonic day (E)14 (<bold>a</bold>, same as <xref ref-type="fig" rid="fig2">Figure 2c</xref>), E16 (<bold>b</bold>, same as <xref ref-type="fig" rid="fig2">Figure 2d</xref>), and postnatal day (P)0 (<bold>c</bold>, same as <xref ref-type="fig" rid="fig2">Figure 2e</xref>) with cells colored by enrichment method showing comparable transcriptomic diversity of immature RGCs enriched by L1cam or Thy1. All clusters are present in both collection types, although the relative frequencies vary. This concordance supports the idea that neither marker excludes particular types. (<bold>d</bold>) Simpson and Shannon diversity indices (see Materials and methods) associated with clustering decrease and increase with age, respectively, consistent with increasing transcriptomic diversity.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73809-fig2-figsupp1-v2.tif"/></fig></fig-group><p>To distinguish among these alternatives, we analyzed the transcriptomic diversity of RGCs at each developmental stage using the same dimensionality reduction and graph clustering approaches devised for analysis of adult RGCs (<xref ref-type="bibr" rid="bib85">Tran et al., 2019</xref>; see Materials and methods). This analysis led to three main results.</p><p>First, RGCs were already heterogeneous soon after mitotic exit. There were 10 transcriptionally defined precursor clusters at E13 (<xref ref-type="fig" rid="fig2">Figure 2b</xref>) before or at the peak time of RGC birth. The number of discrete clusters increased only slightly by E14 (from 10 to 12; <xref ref-type="fig" rid="fig2">Figure 2c</xref>), arguing against a model in which the number of precursor types extrapolated back to 1. No single cluster dominated the frequency distribution at either time as would be expected if a totipotent precursor RGC were to exist shortly after terminal mitosis.</p><p>Second, the number of transcriptionally defined clusters increased gradually, between E13 and adulthood, reaching 45 only after P5 (<xref ref-type="fig" rid="fig2">Figure 2b–g</xref>). Several arguments indicate that this increase is biologically significant rather than being an artifact of the data or computational analysis. (1) We used the same clustering procedure at all ages. (2) The qualitative trends were robust against variations in clustering parameters. (3) All embryonic clusters contained cells isolated with both cell markers, L1cam and <italic>Thy1</italic> (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1a–c</xref>), indicating that lower cluster numbers at early stages did not result from biased collection methods. (4) The increase in the number of effective molecular types was robust as demonstrated by three diversity indices – Rao, Simpson, and Shannon – all of which buffer against artificial inflation of diversity due to small clusters (<xref ref-type="fig" rid="fig2">Figure 2h</xref>, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1d</xref>; see Materials and methods). (5) There was no systematic dependence of the number of clusters on the number of cells. For example, we identified 12 clusters from 17,100 cells at E14 and 38 clusters from 17,386 cells at P5.</p><p>Third, the transcriptomic variation became increasingly discrete with age. We quantified this increase in inter-cluster separation by calculating (1) the average cross-validation error of a multi-class classifier, and (2) the ratio of mean cluster diameter to mean inter-cluster distance in the low dimensional embedding (Materials and methods). Both metrics decrease in numerical value as the clusters are more well defined. From these trends, we conclude that the boundaries between RGC clusters become sharper as development proceeds (<xref ref-type="fig" rid="fig2">Figure 2i and j</xref>).</p><p>Taken together, our results show that transcriptomic clusters of RGCs increase in number and distinctiveness over time, making it unlikely that RGC-type identity is fully specified at the progenitor stage.</p></sec><sec id="s2-3"><title>Temporal relationships among immature RGC clusters</title><p>We next investigated the temporal relationships among precursor RGC clusters identified at different ages. We again consider two extreme models. In a ‘specified’ model, each terminal type arises from a single cluster at every preceding developmental stage (<xref ref-type="fig" rid="fig3">Figure 3a</xref>, left). In this model, distinct transcriptomic states among precursor RGCs correspond to distinct groups of fates. At the other extreme, distinct clusters would share similar sets of fates (<xref ref-type="fig" rid="fig3">Figure 3a</xref>, right). In an intermediate model, fates of precursor clusters would exhibit partial overlap.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Incompletely specified temporal relationships among retinal ganglion cell (RGC) clusters.</title><p>(<bold>a</bold>) Top<italic>:</italic> specified (left) and nonspecified (right) modes of diversification. Nodes denote transcriptomic clusters of immature RGCs, and arrows denote fate relationships. Bottom<italic>:</italic> confusion matrices depicting transcriptomic correspondence between late and early clusters expected for the two modes. Circles and colors indicate the percentage of a given late cluster (row) assigned to a corresponding early cluster (column) by transcriptome-based classifier trained on early clusters. The number of late and early clusters has been set to 8 and 4 for illustration purposes. (<bold>b</bold>) Barplot showing values of the normalized conditional entropy (NCE) for each age calculated using the transcriptional cluster IDs and the XGBoost-assigned cluster IDs corresponding to the next age or to postnatal day (P)56 (e.g., for embryonic day [E1]3, the NCE was calculated across E13 RGCs by comparing their transcriptional cluster ID with the assigned E14 cluster IDs based on a classifier trained on the E14 data). Lower values indicate specific mappings. (<bold>c</bold>) Same as (<bold>b</bold>), but plotting values of the adjusted Rand Index (ARI), where larger values correspond to higher specificity. (<bold>d–h</bold>) Confusion matrices (representation as in <bold>a</bold>), showing transcriptomic correspondence between consecutive ages: E14–E13 (<bold>d</bold>), E16–E14 (<bold>e</bold>), P0–E16 (<bold>f</bold>), P5–P0 (<bold>g</bold>), and P56–P5 (<bold>h</bold>). In each case, the classifier was trained on the late time point and applied to the early time point. Rows sum to 100%.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73809-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Temporal correspondences between transcriptomic clusters evaluated using supervised classification.</title><p>(<bold>a–d</bold>) Confusion matrices showing transcriptomic correspondence between adult retinal ganglion cell (RGC) types at postnatal day (P)56 (rows) and immature RGC clusters (columns) at ages embryonic day (E)13 (<bold>a</bold>), E14 (<bold>b</bold>), E16 (<bold>c</bold>), and P0 (<bold>d</bold>). In each case, immature RGCs were assigned adult labels using an XGBoost classifier trained on adult RGCs. The P56 to P5 mapping is shown in <xref ref-type="fig" rid="fig3">Figure 3h</xref>. (<bold>e</bold>) Line plots showing occupancy fraction (OF) of mapping of an early cluster to cluster IDs at later ages. OF values quantify the specificity of mapping of an early cluster to late clusters, with lower values denoting higher specificity. The average OF across clusters decreases steadily with age consistent with the decrease and increase in normalized conditional entropy (NCE) and adjusted Rand Index (ARI), respectively (<xref ref-type="fig" rid="fig3">Figure 3b and c</xref>). Error bars indicate standard deviation computed across clusters. Also, as expected, the OF values are lower for mapping to adjacent time points than to P56.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73809-fig3-figsupp1-v2.tif"/></fig></fig-group><p>As a first step in discriminating among these scenarios, we used transcriptome-wide correspondence among clusters as a proxy for fate association. We identified mappings between clusters across each pair of consecutive developmental stages (E13–E14, E14–E16, E16–P0, P0–P5, and P5–P56) using gradient boosted trees (<xref ref-type="bibr" rid="bib15">Chen and Guestrin, 2016</xref>), a supervised classification approach (Materials and methods). In each case, a classifier trained on transcriptional clusters at the older stage was used to assign older cluster labels to cells at the younger stage (e.g., E16 labels assigned to E14 RGCs). Patterns expected for the extreme models are schematized as ‘confusion matrices’(<xref ref-type="bibr" rid="bib84">Stehman, 1997</xref>) in the lower panels of <xref ref-type="fig" rid="fig3">Figure 3a</xref>.</p><p>Correspondence fell between the two extremes (<xref ref-type="fig" rid="fig3">Figure 3d–h</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1a–d</xref>). We quantified the extent of correspondence using two metrics: normalized conditional entropy (NCE) and the adjusted Rand Index (ARI) (Materials and methods). Both NCE and ARI are restricted to the range (0,1), with lower values of NCE and higher values of ARI consistent with a specified mode of diversification. Both metrics exhibited an increased degree of specificity with age (<xref ref-type="fig" rid="fig3">Figure 3b and c</xref>). Since NCE and ARI provide a single measure of specificity for the entire datasets being compared, we also computed a ‘local metric,’ the occupancy fraction (OF), which quantifies mapping specificity for each cluster (Materials and methods). Results based on this metric were consistent with increased specificity of correspondence with age (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1e</xref>). Overall, this analysis of transcriptomic correspondence suggests that poorly specified relationships among transcriptomic clusters at early stages are gradually refined to yield increasingly specific associations at later stages.</p></sec><sec id="s2-4"><title>Immature RGCs are multipotential</title><p>The classification analysis presented so far relied on comparing clusters between ages and was therefore unable to link individual precursors to specific terminal fates. At one extreme, individual precursor clusters might contain several groups of cells, each committed to a distinct, small number of fates. Alternatively, individual cells might be as multipotential as the clusters in which they reside (<xref ref-type="fig" rid="fig4">Figure 4a</xref>).</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Multipotential fate associations between immature retinal ganglion cells (RGCs) and terminal types inferred via optimal transport.</title><p>(<bold>a</bold>) Extreme models of diversification at single-cell resolution. Multipotential fate associations in a transcriptionally defined cluster (ellipse) could arise from a mixture of unipotential RGCs (left) or from multipotential RGCs (right). (<bold>b</bold>) Distributions of potential <italic>P</italic> across immature RGCs by age showing that restriction increases with age. (<bold>c</bold>) Inter- and intra-cluster variation of potential by age. At each age, variation in the potential values is shown for each transcriptomically defined cluster at that age. Dots denote the average potential, and dotted lines depict the standard deviation for cells within each cluster. (<bold>d–h</bold>) Uniform Manifold Approximation and Projection (UMAP) projections of embryonic day (E)13 (<bold>d</bold>), E14 (<bold>e</bold>), E16 (<bold>f</bold>), postnatal day (P)0 (<bold>g</bold>), and P5 (<bold>h</bold>) RGCs as in <xref ref-type="fig" rid="fig2">Figure 2</xref>, but with individual cells colored by their inferred potential. Potential of all RGCs at P56 = 1. The colorbar on the lower right is common to all panels, and values are thresholded at <italic>P</italic> = 20.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73809-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Variations in Waddington optimal transport (WOT)-inferred temporal couplings and tests across variations in hyperparameters.</title><p>(<bold>a</bold>) Variations in WOT-inferred temporal couplings (<inline-formula><mml:math id="inf1"><mml:msub><mml:mrow><mml:mi>Π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) at the level of cells and clusters to changes in the set of highly variable genes (HVGs) used for computing transport maps. Four sets of features were tested corresponding to the top 800, 1100, 1400, and 1800 HVGs based on our previously described Poisson-Gamma model (<xref ref-type="bibr" rid="bib48">Liu et al., 2018</xref>). Using these sets, we inferred four corresponding transport maps at each of the five age pairs embryonic day (E)13–E14, E14–E16, E16–postnatal day (P0), P0–P5, and P5–P56. The entropic regularization hyperparameter <inline-formula><mml:math id="inf2"><mml:mi>ϵ</mml:mi></mml:math></inline-formula> (see panels <bold>b</bold>, <bold>c</bold>) was held constant at a value 2<sup>–7</sup> in these tests. At each age pair, we computed the Pearson correlation coefficient (PCC) between estimated temporal couplings for every older cell (column of the transport map <inline-formula><mml:math id="inf3"><mml:mi mathvariant="normal">Π</mml:mi></mml:math></inline-formula>) across each pairwise combination of the four transport maps, towards a total of six combinations. These are indicated as red dots and lines (mean ± SD). We then grouped (summed) the rows of the transport map by transcriptomic cluster at the younger age, such that each element of the new matrix indicates cell (column)–cluster (row) couplings. The PCC values of these couplings were computed for each older cell (column) within each pairwise combination of the four transport maps and are indicated as green dots and lines (mean ± SD). Finally, we grouped (summed) both the rows and columns of the transport map by transcriptomic cluster at either age to obtain a matrix of cluster–cluster couplings. The PCC values of these couplings were computed for each older cluster within each pairwise combination of the four transport maps and are indicated as blue dots and lines (mean ± SD). We find that the cell–cell couplings increase in robustness at later ages, but the cell–cluster and cluster–cluster couplings are quite robust (correlation &gt;0.6). (<bold>b</bold>) Variations in WOT-inferred temporal couplings at the level of cells and clusters as in panel (<bold>a</bold>), but to changes in the entropic regularization <inline-formula><mml:math id="inf4"><mml:mi>ϵ</mml:mi></mml:math></inline-formula>. Six values were used (2<sup>–8</sup> , 2<sup>–7</sup> , 2<sup>–6</sup>, 2<sup>–5</sup>, 2<sup>–4</sup>, 2<sup>–3</sup>) with increasing values corresponding to more transport maps with decreasingly localized (or increasingly distributed) couplings. At each age pair, six transport maps are computed and PCC values for cell–cell, cell–cluster, and cluster–cluster couplings are computed as in panel (<bold>a</bold>) for each of the 15 transport map pairs. Here too, the cluster–cluster and cell–cluster couplings show higher stability, although at later stages higher values of <inline-formula><mml:math id="inf5"><mml:mi>ϵ</mml:mi></mml:math></inline-formula> exhibit loss of stability even at the cluster–cluster level (see panel <bold>c</bold>). (<bold>c</bold>) Heatmap showing cluster–cluster PCC values for P5–P56 transport maps inferred using different values of the entropic regularization parameter, epsilon (rows and columns). Loss of stability occurs at higher values of the entropic regularization, consistent with panel (<bold>b</bold>). Based on this, we used ε = 2<sup>–7</sup> to calculate the results shown in <xref ref-type="fig" rid="fig4">Figure 4</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73809-fig4-figsupp1-v2.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>Temporal correspondences between transcriptomic clusters evaluated using Waddington optimal transport (WOT).</title><p>(<bold>a–e</bold>) Average temporal couplings at the level of clusters. Panels correspond to the pairs embryonic day (E14)–E13 (<bold>a</bold>), E16–E14 (<bold>b</bold>), postnatal day (P0)–E16 (<bold>c</bold>), P5–P0 (<bold>d</bold>), and P56–P5 (<bold>e</bold>), respectively. In each case, the WOT-inferred transport map was grouped along rows and columns based on transcriptomic cluster, and the elements were summed within each group. The resulting matrix was normalized such that each row sums to 100%. These matrices strongly resemble those in <xref ref-type="fig" rid="fig3">Figure 3d–h</xref>, as confirmed by the high values of the Pearson correlation coefficient (top, all <italic>P</italic> ≥ 0.92).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73809-fig4-figsupp2-v2.tif"/></fig></fig-group><p>Unfortunately, this approach does not afford a straightforward way to explore variations in patterns of fate associations within clusters. We therefore turned to Waddington optimal transport (WOT), a computational method rooted in optimal transport theory (<xref ref-type="bibr" rid="bib41">Kantorovich, 2006</xref>; <xref ref-type="bibr" rid="bib64">Monge, 1781</xref>) that utilizes scRNA-seq measurements at multiple stages to infer developmental relationships (<xref ref-type="bibr" rid="bib78">Schiebinger et al., 2019</xref>). Briefly, WOT computes a ‘transport matrix’ <inline-formula><mml:math id="inf6"><mml:mi mathvariant="normal">Π</mml:mi></mml:math></inline-formula> between each pair of consecutive ages with elements <inline-formula><mml:math id="inf7"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> encoding fate associations between a single RGC <italic>i</italic> at the younger age and RGC <italic>j</italic> at the older age (see Materials and methods). WOT directly computes fate associations at the level of individual cells without requiring clustering as a prior step. We conducted computational tests to assess the numerical stability of associations reported by WOT (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). We also determined that when collapsed to the level of clusters the WOT-inferred transport maps strikingly mirrored the confusion matrices obtained from multi-class classification (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>).</p><p>Based on the success of these tests, we applied WOT to compute the ‘terminal fate’ for each precursor RGC. We leveraged the fact that in WOT fate associations between RGCs at nonconsecutive ages (e.g., E16 and P56) can be estimated in a principled way by multiplying the intermediate transport matrices. This yielded a fate vector <inline-formula><mml:math id="inf8"><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mi> </mml:mi><mml:mi> </mml:mi></mml:math></inline-formula> for each of the 75,115 immature RGCs, whose <italic>k</italic>th element <inline-formula><mml:math id="inf9"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represents the predicted probability of commitment to adult type <inline-formula><mml:math id="inf10"><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mn>45</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula> (Materials and methods). A fully committed precursor would have all but one element of <inline-formula><mml:math id="inf11"><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math></inline-formula> equal to zero, whereas a partially committed precursor would have multiple nonzero elements in <inline-formula><mml:math id="inf12"><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math></inline-formula> . Since the elements of <inline-formula><mml:math id="inf13"><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math></inline-formula> are interpreted as probabilities, they are normalized such that <inline-formula><mml:math id="inf14"><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>.</p><p>We quantified the commitment of each precursor by computing its ‘potential’ <inline-formula><mml:math id="inf15"><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></inline-formula> , which is defined analogously to the ‘inverse participation ratio’ in physics (<xref ref-type="bibr" rid="bib28">Fyodorov and Mirlin, 1992</xref>). In our case, the value of <italic>P</italic> for a given RGC ranges continuously between 1 and 45, with lower values implying a commitment to specific fates and higher values reflecting indeterminacy. Importantly, this measure of commitment does not rely on arbitrary thresholding of the <inline-formula><mml:math id="inf16"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> values to assign precursors to types.</p><p>Five results emerged from this analysis.</p><list list-type="bullet"><list-item><p>Nearly all prenatal RGCs (i.e., on or before P0) were multipotential rather than committed to a single terminal fate, with individual potentials distributed across a range of values (<xref ref-type="fig" rid="fig4">Figure 4b</xref>).</p></list-item><list-item><p>Multipotentiality was a general feature of immature RGCs, being present in cells of all clusters at E13, E14, and E16 (<xref ref-type="fig" rid="fig4">Figure 4c–f</xref>).</p></list-item><list-item><p>At early stages, the average value of <italic>P</italic> varied among transcriptomic clusters, reflecting asynchronous specification (<xref ref-type="fig" rid="fig4">Figure 4c</xref>). The tempo of commitment is further explored in the next section.</p></list-item><list-item><p>Although they were multipotential, no precursor RGC was totipotential (i.e., completely unspecified, corresponding to <italic>P</italic> = 45). At E13, the average value of P was 11.6 ± 4.9, which was fourfold lower than the maximum possible value of 45, and no precursor had <italic>P</italic> &gt; 30.</p></list-item><list-item><p>Finally, inferred multipotentiality decreased gradually during development, and some persisted postnatally (average <italic>P</italic> = 3.4 ± 2.1 at P0, and 1.6 ± 0.9 at P5; <xref ref-type="fig" rid="fig4">Figure 4g and h</xref>).</p></list-item></list><p>From these results, we conclude that early postmitotic RGCs are multipotential but not totipotential, and that type identity is specified gradually via progressive restriction.</p></sec><sec id="s2-5"><title>Asynchronous specification of mouse RGC types via fate decoupling</title><p>As a first step in understanding the progressive restriction of RGC fate, we analyzed the extent to which pairs of mature types were likely to have arisen from the same set of immature precursors. To this end, we computed a ‘fate coupling’ value <inline-formula><mml:math id="inf17"><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>;</mml:mo><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> for each pair of terminal RGC types (<italic>l</italic> and <italic>m</italic>), defined as the Pearson correlation coefficient between the values of <inline-formula><mml:math id="inf18"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf19"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> across all precursors at a given age (Materials and methods). <inline-formula><mml:math id="inf20"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf21"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are fate probabilities corresponding to types <italic>l</italic> and <italic>m</italic> as defined in the previous section. Values of <inline-formula><mml:math id="inf22"><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>;</mml:mo><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> in our data ranged from –0.11 to 0.95. Higher values of <inline-formula><mml:math id="inf23"><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>;</mml:mo><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> indicate strong fate coupling between types <italic>l</italic> and <italic>m</italic>, implying the existence of common postmitotic precursors, whereas low <inline-formula><mml:math id="inf24"><mml:mi>C</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>;</mml:mo><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> values suggest that types <italic>l</italic> and <italic>m</italic> arose from largely nonoverlapping sets of precursors. We visualized the pattern of fate couplings as network graphs, where the nodes represent types and the edge weights represent values of <inline-formula><mml:math id="inf25"><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>;</mml:mo><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>. The arrangement of nodes was determined at E13 using a force-directed layout algorithm (<xref ref-type="bibr" rid="bib27">Fruchterman and Reingold, 1991</xref>), with pairwise distances being inversely proportional to the values of <inline-formula><mml:math id="inf26"><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>;</mml:mo><mml:mi>E</mml:mi><mml:mn>13</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>, the fate coupling values at E13 (<xref ref-type="fig" rid="fig5">Figure 5a</xref>). To visualize the temporal evolution of these fate couplings, we retained the same layout of nodes while updating edge weights according to <inline-formula><mml:math id="inf27"><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>;</mml:mo><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> (<xref ref-type="fig" rid="fig5">Figure 5b–e</xref>).</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Fate decoupling of retinal ganglion cell (RGC) types.</title><p>(<bold>a</bold>) Force-directed layout visualization of fate couplings at embryonic day (E)13, with nodes representing RGC types (numbered as in <xref ref-type="bibr" rid="bib85">Tran et al., 2019</xref>) and the thickness of edges representing values of <italic>C(l,m;E13</italic>). Edges with <italic>C(l,m; E13</italic>) &lt; 0.2 are not shown. Number of edges with <italic>C(l,m; E13</italic>) &gt; 0.2 are indicated on top. (<bold>b–e</bold>) Visualization of fate couplings at E14 (<bold>b</bold>), E16 (<bold>c</bold>), postnatal day (P)0 (<bold>d</bold>), and P5 (<bold>e</bold>). The positions of the nodes are maintained as in panel (<bold>a</bold>), but the edges are redrawn based on values of <italic>C(l,m;age</italic>) at each age. As in panel (<bold>a</bold>), we only show edges <italic>C(l,m; age</italic>) &gt; 0.2. (<bold>f</bold>) The decay of pairwise fate couplings (y-axis) with age (x-axis). Each line corresponds to the temporal decay of <italic>C(l,m</italic>) for RGC pair l and m estimated via a logistic model (Materials and methods). For each pair, couplings at each age were fit to a model <inline-formula><mml:math id="inf28"><mml:mi>C</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>;</mml:mo><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>*</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula> with <inline-formula><mml:math id="inf29"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> representing fitted parameters. The fitting was performed using data for ages E13, E14, E16, P0, and P5. The shaded portions correspond to the periods E8–E13 and P5 representing the extrapolations of the model. Black lines highlight the decay of all nonzero pairwise couplings for RGC type <italic>C8</italic> as an example. (<bold>g</bold>) Schematic showing logistic modeling to estimate specification time <inline-formula><mml:math id="inf30"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for a particular type. The y-axis is a measure of the extent to which precursors biased towards the type are present in a single transcriptomically defined cluster (i.e., localization, see Materials and methods for details). Localization is defined as a numerical value in the range (0, 1) with higher values consistent with increasing specification. Individual triangles represent the localization values computed using Waddington optimal transport (WOT)-inferred fate couplings at each age, while the curve represents the fit using the logistic model. Dotted line shows the minimum threshold a type to be specified at each age. Its curved shape arises due to the increase in the number of clusters with age. (<bold>h</bold>) Localization curves (as in <bold>g</bold>) for the 38 RGC types showing the range of inferred specification times. Seven low-frequency types have been excluded from display (see <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1d</xref>). (<bold>i</bold>) Scatter plot showing poor correlation between adult frequency of a type (from <xref ref-type="bibr" rid="bib85">Tran et al., 2019</xref>) and its predicated specification time (calculated from <bold>h</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73809-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Fate decoupling and temporal specification of retinal ganglion cell (RGC) types.</title><p>(<bold>a–c</bold>) Examples of fate decoupling. Panels from left to right correspond to ages embryonic day (E)13–postnatal day (P)5 with precursor RGCs shown on a reduced dimensional Uniform Manifold Approximation and Projection (UMAP) representation as in <xref ref-type="fig" rid="fig2">Figure 2c–g</xref>. Each RGC is colored using a biaxial color scale (legend) based on its predicted fate values. C12 and C22 are transcriptomically distinct as early as E13 (<bold>a</bold>). C19 and C20 exhibit high fate coupling at all embryonic ages and are only decoupled at P5 (<bold>b</bold>). C21 and C34 decouple around E16 (<bold>c</bold>). (<bold>d</bold>) Same as <xref ref-type="fig" rid="fig6">Figure 6h</xref> showing specification curves for RGC types, but in this case each curve is colored based on adult frequency (colorbar, right). The seven curves marked by asterisks correspond to late-specified types. As can be seen from their colors, they are also among the types with the lowest frequency (&lt;0.3%), which may result in the dropout of the corresponding precursors because of sampling fluctuations. Such dropouts at earlier time points give the appearance of late specification. Because of this issue, we exclude them from our analysis.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73809-fig5-figsupp1-v2.tif"/></fig></fig-group><p>Types that were coupled in fate at the earliest time point gradually decoupled as development proceed. For example, at E13, 118/990 pairs (12%) were strongly coupled (threshold of <inline-formula><mml:math id="inf31"><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>;</mml:mo><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>&gt;0.2 as determined by randomization tests; see Materials and methods), while at P5, only 8/990 (&lt;1%) passed this criterion (<xref ref-type="fig" rid="fig5">Figure 5a and e</xref>). Lowering this threshold for coupling to 0.05 increased the number of strongly coupled pairs at P5 to only 2% (20/990).</p><p>Different pairs of types decoupled at different rates (<xref ref-type="fig" rid="fig5">Figure 5f</xref>). As they decoupled, RGC precursors became increasingly restricted to a single type (i.e., <inline-formula><mml:math id="inf32"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>≫</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for a precursor favoring type <italic>k</italic>). This corresponded to a ‘localization’ of precursors in transcriptomic space and is a proxy for specification (see Materials and methods). We modeled the extent of localization vs. age via a logistic function (<xref ref-type="fig" rid="fig5">Figure 5g</xref>, <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1d</xref>) and used this to calculate a specification time for each type (<inline-formula><mml:math id="inf33"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) (see Materials and methods for details). Based on this analysis, 7/45 types are specified postnatally. The average <inline-formula><mml:math id="inf34"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for RGCs was E17.8, but individual RGC types exhibited a wide range from E13.9 to P5.2 (<xref ref-type="fig" rid="fig5">Figure 5h</xref>). The inferred specification time was not correlated with adult frequency (<xref ref-type="fig" rid="fig5">Figure 5i</xref>).</p><p>We illustrate this range by considering three pairs of RGC types in <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>. C12 and C22 (numbered as in <xref ref-type="bibr" rid="bib85">Tran et al., 2019</xref>; see <xref ref-type="fig" rid="fig2">Figure 2g</xref>) exhibit low fate coupling at all ages profiled (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1a</xref>), indicative of separate precursor populations. In contrast, C19 and C20 decouple only at P0, implying the existence of a common precursor throughout embryogenesis (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1b</xref>). C21 and C34 display an intermediate pattern, decoupling around E16 (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1c</xref>). Taken together, these results suggest that RGC types emerge by asynchronous fate decoupling of multipotential precursors.</p></sec><sec id="s2-6"><title>Fate decoupled groups of RGC types defined by transcription factors</title><p>Because fate coupling is a metric of inferred overlap of developmental history, it is likely that tightly coupled types share common precursors. This relationship implies that tightly coupled types might also be specified by common transcriptional programs. As a step towards identifying candidate fate determinants, we identified eight TFs that are expressed by distinct groups of mature RGC types (<xref ref-type="fig" rid="fig6">Figure 6a</xref>, <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1a</xref>). Three of these are well-characterized RGC-selective TFs: <italic>Foxp2</italic>, expressed by five F-RGC types (<xref ref-type="bibr" rid="bib73">Rousso et al., 2016</xref>); <italic>Tbr1</italic>, expressed by five T-RGC types (<xref ref-type="bibr" rid="bib48">Liu et al., 2018</xref>); and <italic>Eomes</italic> (also known as <italic>Tbr2</italic>), expressed by seven types (<xref ref-type="bibr" rid="bib55">Mao et al., 2020</xref>; <xref ref-type="bibr" rid="bib85">Tran et al., 2019</xref>). The seven Eomes/Tbr2 types include the melanopsin-expressing intrinsically photosensitive (ip) RGC types (<xref ref-type="bibr" rid="bib8">Berson et al., 2002</xref>). The remaining five were <italic>Neurod2</italic>, <italic>Irx3</italic>, <italic>Mafb</italic>, <italic>Tfap2d,</italic> and <italic>Bnc2,</italic> which label 8, 5, 4, 6, and 3 types, respectively. <italic>Eomes</italic> types also co-expressed <italic>Tbx20</italic> and <italic>Dmrbt1</italic> while <italic>Neurod2</italic> types also co-express <italic>Satb2</italic>. Together, 40/45 mature types expressed at least one of these TFs in a manner that was, with a few exceptions, mutually exclusive. In many cases, the fate proximity of types that shared TF expression was obvious (<xref ref-type="fig" rid="fig6">Figure 6a</xref>).</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Temporal dynamics of retinal ganglion cell (RGC) subsets expressing specific transcription factors (TFs).</title><p>(<bold>a</bold>) Embryonic day (E)13 network graph of fate couplings from <xref ref-type="fig" rid="fig5">Figure 5a</xref>, with RGC types colored based on their selective expression of TFs at postnatal day (P)56. Asterisks denote 3/45 types that express more than one TF (also see <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1a</xref>). (<bold>b</bold>) Box-and-whisker plots showing that pairwise fate couplings are higher between types within the same TF subclass than between types in different TF subclasses at all immature ages. Black horizontal line, median; bars, interquartile range; vertical lines, 1st and 99th percentile; dots, outliers. Asterisks indicate significant p-values based on a two-sided <italic>t</italic>-test (****p&lt;10<sup>–7</sup>; ***p&lt;10<sup>–5</sup>; **p&lt;10<sup>–2</sup>). (<bold>c</bold>) <italic>Eomes+</italic> types. Top: Uniform Manifold Approximation and Projection (UMAP) representation of E13 RGCs with cells colored based on their cumulative fate association towards the seven <italic>Eomes+</italic> types. Bottom: UMAP representation of P5 RGCs with cells colored based on their cumulative fate association towards the seven <italic>Eomes+</italic> types. The value corresponding to the color of each cell (colorbar, right) can be interpreted as the probability of commitment towards the corresponding subclass. Note that the color does not denote the expression level for the gene. (<bold>d</bold>) Same as (<bold>c</bold>) for <italic>Mafb</italic>+ types. (<bold>e</bold>) Same as (<bold>c</bold>) for <italic>Neurod2+</italic> types (<bold>f–h</bold>). Localization curves (as in <xref ref-type="fig" rid="fig5">Figure 5g</xref>) for <italic>Eomes+</italic> types (<bold>f</bold>), <italic>Mafb+</italic> types (<bold>g</bold>), and <italic>Neurod2+</italic> types (<bold>h</bold>). The mean inferred specification time <inline-formula><mml:math id="inf35"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for each group is indicated on the top of each panel.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73809-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Transcription factor (TF)-based subgroups.</title><p>(<bold>a</bold>) Dotplot showing mutually exclusive patterns of expression of TFs that mark groups of retinal ganglion cell (RGC) types. In addition to the eight TFs shown in <xref ref-type="fig" rid="fig6">Figure 6a</xref>, we highlight <italic>Zic1</italic>, which selectively labels C6. Selectively expressed TFs could not be identified for four types (C1, C2, C11, and C15). (<bold>b–e</bold>) Localization curves (as in <xref ref-type="fig" rid="fig5">Figure 5g</xref>) for <italic>Tbr1+</italic> types (<bold>b</bold>), <italic>Tfap2d</italic>+ types (<bold>c</bold>), <italic>Foxp2+</italic> types (<bold>d</bold>), and <italic>Bnc2+</italic> types (<bold>e</bold>). Note that the ‘low-frequency’ types labeled in <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1d</xref> are not shown. The mean specification time <inline-formula><mml:math id="inf36"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for each group is shown above the graphs. (<bold>f</bold>) Correlation of fate coupling at embryonic day (E)13 with transcriptomic correlation at postnatal day (P)56. (<bold>g</bold>) Same as <xref ref-type="fig" rid="fig6">Figure 6a</xref>, with nodes corresponding to subclasses defined in <xref ref-type="bibr" rid="bib85">Tran et al., 2019</xref>, which includes ipRGCs, alpha-RGCs, and T5-RGCs.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73809-fig6-figsupp1-v2.tif"/></fig></fig-group><p>We refer to these TF-based groups as fate-restricted RGC subclasses – an intermediate taxonomic level between class and type based on inferred fate relationships. Consistent with their definition, the pairwise fate coupling among types from different subclasses was significantly lower than among types from the same subclass (<xref ref-type="fig" rid="fig6">Figure 6b</xref>). Thus, precursor RGC states associated with any two subclasses are more distinct than those associated with any two types. This is evident by the significant separation at E13 and negligible overlap at P5 for precursors favoring the <italic>Eomes, Mafb,</italic> and <italic>Neurod2</italic> subclasses, respectively, as shown in <xref ref-type="fig" rid="fig6">Figure 6c–e</xref>.</p><p>We also asked whether the TF-based subclasses differed in inferred transcriptomic specification time <inline-formula><mml:math id="inf37"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> , as defined in <xref ref-type="fig" rid="fig5">Figure 5g</xref>. As shown in <xref ref-type="fig" rid="fig6">Figure 6f–h</xref> and <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1b–e</xref>, four subclasses were specified within a narrow interval (E16.8–E17.2), but three others differed substantially. The average specification time for the <italic>Eomes</italic> group was E14.6 (p&lt;0.0001, Student’s <italic>t</italic>-test, compared to the mean for all types), while that for the <italic>Mafb</italic> and <italic>Neurod2</italic> groups were E16.9 (p&lt;0.001) and E18.5 (p&lt;0.0001), respectively. The early specification of the <italic>Eomes</italic> group is consistent with birthdating studies showing the average earlier birthdate of ipRGCs compared to all RGCs (<xref ref-type="bibr" rid="bib63">McNeill et al., 2011</xref>).</p><p>In summary, our results suggest the existence of fate-restricted RGC subclasses that arise from distinct sets of precursors and diversify into individual types. This method of defining RGC groups, which relies on inferred proximity of precursors in transcriptomic space, is distinct from previous definitions of RGC subclass based on shared patterns of adult morphology, physiology, or gene expression (see Discussion). Accordingly, the fate couplings at E13 were only weakly correlated with transcriptomic proximity in the adult retina (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1f</xref>). Further, while TF-based groups align with some previously defined subclasses (e.g., ipRGCs or <italic>Tbr1+</italic> RGCs), they do not map to other subclasses such as alpha-RGCs (four types) or T5-RGCs (nine types) (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1g</xref>).</p></sec><sec id="s2-7"><title>Transcriptomic profiles of ipsilateral and contralateral RGCs</title><p>Finally, we considered the origin of two RGC groups defined by their projections: those with axons that remain ipsilateral at the optic chiasm (I-RGCs) and those that cross the midline to innervate contralateral brain structures (C-RGCs). The proportion of I-RGCs varies among vertebrates, in rough correspondence to the extent of binocular vision, ranging from none in most lower vertebrates to ~50% in primates. In mice, 3–5% of RGC axons remain ipsilateral, with most I-RGCs residing in the ventrotemporal (VT) retinal crescent (<xref ref-type="bibr" rid="bib60">Mason and Slavi, 2020</xref>). While some I-RGCs have been observed to project from the dorsocentral retina during embryonic stages, these are rapidly eliminated so-called ‘transient’ I-RGCs (<xref ref-type="bibr" rid="bib83">Soares and Mason, 2015</xref>). Thus, in adulthood, C-RGCs are present throughout the retina while ‘permanent’ I-RGCs are confined to the VT crescent.</p><p>The zinc-finger TF <italic>Zic2</italic> is expressed in a subset of postmitotic RGCs in VT retina and is both necessary and sufficient for establishing their ipsilateral identity (<xref ref-type="bibr" rid="bib33">Herrera et al., 2003</xref>); transient dorsolateral I-RGCs do not express <italic>Zic2</italic> (<xref ref-type="bibr" rid="bib66">Pak et al., 2004</xref>). <italic>Isl2</italic> marks a subset of C-RGCs throughout the retina and appears to specify a contralateral identity in part by repressing Zic2 (<xref ref-type="bibr" rid="bib66">Pak et al., 2004</xref>). These two TFs were expressed in a mutually exclusive fashion in RGC precursors between E13 and E16 (<xref ref-type="fig" rid="fig7">Figure 7a</xref>); <italic>Zic</italic>2 was downregulated at later ages (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1a</xref>). Furthermore, <italic>Zic2</italic> expression at E13 correlated with <italic>Igfbp5</italic> and <italic>Zic1,</italic> and anticorrelated with <italic>Igf1</italic> and <italic>Fgf12,</italic> consistent with recent reports (<xref ref-type="bibr" rid="bib92">Wang et al., 2016</xref>; <xref ref-type="fig" rid="fig7">Figure 7b</xref>, <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1b and c</xref>). We scored each cell at E13 based on its expression of ipsilateral genes (Materials and methods), confirming that the expression of ipsilateral and contralateral gene signatures was anticorrelated (<xref ref-type="fig" rid="fig7">Figure 7c</xref>). Together, these observations support the idea that at E13 <italic>Zic2+</italic> cells represent I-RGCs and <italic>Isl2+</italic> cells represent some but not all C-RGCs.</p><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Transcriptomic identification of ipsilaterally projecting retinal ganglion cells (RGCs).</title><p>(<bold>a</bold>) <italic>Zic2</italic>, an I-RGC marker, and <italic>Isl2</italic>, a C-RGC marker, are expressed in a mutually exclusive pattern at embryonic day (E)13 (left), E14 (middle), and E16 (right). <italic>Zic2</italic> is undetectable after E16 (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1a</xref>). Cells are colored based on a bivariate color scale representing co-expression of two markers (colorbar, right). (<bold>b</bold>) <italic>Zic2</italic> and <italic>Igfbp5,</italic> two I-RGC markers, are co-expressed at E13 (left) and E14 (middle). Representation as in panel (<bold>a</bold>). (<bold>c</bold>) Scatter plots of gene signatures used to identify I-RGCs (y-axis) and C-RGCs (x-axis) at E13 are negatively correlated (Pearson <italic>R</italic> = –0.61). Each dot corresponds to a cell, the color represents the number of cells located at a particular (x, y) location (see colorbar, right). (<bold>d</bold>) Barplot showing % of putative I-RGCs (y-axis) within each of the 45 adult RGC types, estimated by computing the descendants of E13 I-RGCs using Waddington optimal transport (WOT). RGC types are arranged along the x-axis based on their membership of transcription factor (TF) groups shown in <xref ref-type="fig" rid="fig6">Figure 6a</xref> (annotation matrix, bottom). (<bold>e</bold>) Volcano plot showing differentially expressed genes (MAST test) between predicted I-RGCs and C-RGCs at E13. The x- and the y-axes show the fold change and the p-value in log2- and log10- units, respectively. Dots represent genes, with red and blue dots highlighting I- and C-RGC-enriched genes, respectively, at fold change &gt;1.5 and Bonferroni-corrected p-value&lt;5 × 10<sup>–5</sup>. The two vertical bars correspond to a fold change of 1.5 in either direction. Select I-RGC- and C-RGC-enriched genes are labeled. (<bold>f</bold>) Same as panel (<bold>e</bold>), for E14.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73809-fig7-v2.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>Transcriptomic analysis of retinal ganglion cell (RGC) laterality.</title><p>(<bold>a</bold>) RGCs at embryonic day (E)13, E14, E16, postnatal day (P)0, and P5 colored by their expression of <italic>Zic2</italic>, an I-RGC marker. <italic>Zic2</italic> is expressed in a localized fashion until E16 and becomes undetectable beyond this age. (<bold>b</bold>) <italic>Zic2</italic>, an I-RGC marker, and <italic>Igf1</italic>, a C-RGC marker, are expressed in mutually exclusive patterns at E13–E16. (<bold>c</bold>) <italic>Zic2</italic> and <italic>Zic1,</italic> two I-RGC markers, are co-expressed in subsets of RGCs at E13–E16. (<bold>d</bold>) Volcano plot showing differentially expressed genes (MAST test, p&lt;10<sup>–6</sup>) between predicted I-RGCs and C-RGCs at E16. The x- and the y-axes show the fold change and the p-value in log2- and log10- units, respectively. Dots represent genes, with red and dots highlighting I- and C-RGC-enriched genes, respectively, at fold change &gt;1.5 and Bonferroni-corrected p-value&lt;5e-5. The two vertical bars correspond to a fold change of 1.5 in either direction. (<bold>e</bold>) Same as (<bold>d</bold>), for P0.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73809-fig7-figsupp1-v2.tif"/></fig></fig-group><p>Using WOT, we then identified the descendants of presumptive I-RGCs at later ages. We found that I-RGCs comprised 4.3% of adult RGCs, consistent with the range of 3–5% noted above. We queried these cells to identify the genes that distinguished putative I-RGCs and C-RGCs throughout the developmental time course. At a fold change of ≥1.5, we found 59 differentially expressed (DE) genes at E13 and 89 at E14 (<xref ref-type="fig" rid="fig7">Figure 7e and f</xref>). In addition to <italic>Zic2, Igfbp5, Isl2,</italic> and <italic>Igf1</italic>, which had been used to define I-RGCs and C-RGCs at E13, they included <italic>Igfbpl1, Pou3f1,</italic> and <italic>Cntn2</italic> enriched in I-RGCs, and <italic>Lmo2</italic>, <italic>Pcsk1n,</italic> and <italic>Syt4</italic> enriched in C-RGCs. The number of genes differentially expressed between I- and C-RGCs decreased after E14, with 20, 9, and 0 significant genes at E16, P0, and P5, respectively (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1d and e</xref>), presumably reflecting the downregulation of axon guidance programs once retinorecipient targets have been reached (see Discussion).</p><p>We also asked which RGC types included I-RGCs. At E13, putative I-RGCs were highly enriched in 2 of 10 clusters, comprising 38–40% of clusters 2 and 9, 9–14% of clusters 3 and 5, and &lt;2% of the other six clusters (<xref ref-type="fig" rid="fig7">Figure 7d</xref>). In adults, RGCs expressing <italic>Tbr1</italic>, <italic>Mafb, Foxp2,</italic> and <italic>Neurod2</italic> contained 3–4× more I-RGCs than RGCs expressing <italic>Eomes</italic>, <italic>Irx3,</italic> or <italic>Tfap2d</italic>. These results are consistent with previous observations that I-RGCs are morphologically and physiologically heterogenous but not uniformly distributed across types (<xref ref-type="bibr" rid="bib36">Hong et al., 2011</xref>; <xref ref-type="bibr" rid="bib39">Johnson et al., 2021</xref>). Lastly, the WOT-predicted relationship between E13 precursor RGC clusters and I-RGC-rich or -poor terminal types was consistent with these patterns. The top six I-RGC-rich types (C4, C15, C19, C20, C38, and C45) derived 14 and 4% of their relative fate association from E13 clusters 2 and 9, while the top six I-RGC-poor types (C8, C14, C18, C22, C31, and C41) derived only 3.8 and 0.2% of their relative fate association from E13 clusters 2 and 9. Thus, E13 clusters 2 and 9 are preferred precursors of adult types that are relatively rich in I-RGCs.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>The staggering diversity of its neurons underlies the computational power of the nervous system. Accordingly, a major quest in developmental neurobiology is to understand the mechanisms that diversify progenitors. A generally accepted way to deal with this diversity is to divide neurons into classes, and then subdivide classes into subclasses and subclasses into types (<xref ref-type="bibr" rid="bib98">Zeng and Sanes, 2017</xref>). While much has been learned about how neural progenitors give rise to distinct neuronal classes, little is known about how classes diversify into subclasses and types.</p><p>Here, we used mouse RGCs to address this issue. We recently generated a molecular atlas that divided RGCs into ~45 distinct types based on their patterns of gene expression (<xref ref-type="bibr" rid="bib85">Tran et al., 2019</xref>). We used this atlas here as a foundation to ask how these types are specified during development. We conclude that the earliest precursor RGCs are multipotential and exhibit continuous variation in transcriptomic identity, then diversify into definitive types by a gradual process of fate restriction. Interestingly, these features resemble those that have been discovered to control the generation of retinal cell classes from cycling progenitors (RPCs): multipotentiality, progressive restriction of fate, and stochastic rather than deterministic fate choice (see Introduction). We suggest that, at least in this case, similar strategies are used to generate cell classes from mitotically active progenitors and cell types from postmitotic precursors.</p><sec id="s3-1"><title>Classes, subclasses, and types</title><p>Definitions of neuronal class, subclass, and type have been contentious (<xref ref-type="bibr" rid="bib97">Yuste et al., 2020</xref>). In general, classes share general features of structure, function, molecular architecture, and location, whereas types comprise the smallest groups within classes that can be qualitatively distinguished from other groups based on these and other criteria. Subclasses lie in-between. For RGCs, class identity has been clear for a century, but inventories of subclasses and types have emerged only over the last few decades as high-throughput methods have been implemented for quantifying structural (primarily dendritic morphology), functional (responses to an array of visual stimuli), and molecular properties (gene and transgene expression) of large numbers of RGCs. Fortunately, to the extent that they have been compared, there is excellent concordance among types defined by molecular, structural, and physiological criteria (<xref ref-type="bibr" rid="bib3">Bae et al., 2018</xref>; <xref ref-type="bibr" rid="bib30">Goetz et al., 2021</xref>; <xref ref-type="bibr" rid="bib85">Tran et al., 2019</xref>; see <ext-link ext-link-type="uri" xlink:href="http://www.rgc.types.org">http://www.rgc.types.org</ext-link>). Moreover, RGCs of a single type exhibit a regular spacing, called a mosaic arrangement, in that they tend to avoid other members of the same cell type, whereas their association with members of other types is random (<xref ref-type="bibr" rid="bib43">Kay et al., 2012</xref>; <xref ref-type="bibr" rid="bib44">Keeley et al., 2020</xref>; <xref ref-type="bibr" rid="bib72">Rockhill et al., 2000</xref>). The molecular basis of this property is poorly understood, but it provides an additional criterion for defining a type. Thus, while no two RGCs are identical, and variation may be continuous in some other structures (<xref ref-type="bibr" rid="bib12">Cembrowski and Spruston, 2019</xref>), there is strong reason to believe that RGC types are discrete.</p></sec><sec id="s3-2"><title>The adult RGC atlas</title><p>Developmental trajectories of cell types cannot be better than the adult types at which they are aimed. We have two reasons to believe that our adult RGC atlas (<xref ref-type="bibr" rid="bib85">Tran et al., 2019</xref>) is accurate and complete.</p><p>First, the atlas is based on a detailed analysis of 35,699 cells and is therefore powered to detect types occurring at ~0.1% frequency (&gt;40 cells per type; <ext-link ext-link-type="uri" xlink:href="https://satijalab.org/howmanycells/">https://satijalab.org/howmanycells/</ext-link>). Results were stable over a variety of parameters (<xref ref-type="bibr" rid="bib85">Tran et al., 2019</xref>). Moreover, in the course of studies on responses of RGCs to injury, we recently profiled an additional ~120,000 cells (A. Jacobi, N. Tran, W Yan, and J.R.S, in preparation), without identifying additional types.</p><p>Second, RGCs have now been classified by functional and structural properties, based on physiological responses to visual stimuli (<xref ref-type="bibr" rid="bib1">Baden et al., 2016</xref>; <xref ref-type="bibr" rid="bib30">Goetz et al., 2021</xref>) and serial section electron microscopy (<xref ref-type="bibr" rid="bib3">Bae et al., 2018</xref>). The numbers of types defined in these ways (47 in <xref ref-type="bibr" rid="bib3">Bae et al., 2018</xref>, 42 in <xref ref-type="bibr" rid="bib30">Goetz et al., 2021</xref>, and &gt;32 in <xref ref-type="bibr" rid="bib1">Baden et al., 2016</xref>) match well to the 45–46 defined molecularly (<xref ref-type="bibr" rid="bib85">Tran et al., 2019</xref>).</p></sec><sec id="s3-3"><title>Multipotentiality of precursor RGCs</title><p>The multipotentiality of dividing progenitor cells can be demonstrated by indelibly labeling a progenitor and then examining its progeny at a later stage. For mammals, this was initially done by infecting single cells with a recombinant retrovirus encoding a reporter gene that could be detected following multiple cell divisions (<xref ref-type="bibr" rid="bib70">Price et al., 1987</xref>; <xref ref-type="bibr" rid="bib76">Sanes et al., 1986</xref>; <xref ref-type="bibr" rid="bib87">Turner and Cepko, 1987</xref>). More recently, it has become possible to greatly increase throughput by tracking scars or barcodes introduced by CRISPR/Cas9 (<xref ref-type="bibr" rid="bib4">Baron and van Oudenaarden, 2019</xref>; <xref ref-type="bibr" rid="bib22">Espinosa-Medina et al., 2019</xref>; <xref ref-type="bibr" rid="bib62">McKenna et al., 2016</xref>). In sharp contrast, conclusively demonstrating that a single postmitotic cell is multipotential would require following a cell from an unspecified to a specified state, then turning back time, watching it again, and asking if it acquired the same mature identity. Since this is impossible, we used computational methods to draw tentative conclusions about the extent to which newly postmitotic RGCs are committed to mature into a particular type based on their transcriptomic profiles. Consequently, our results are based on inferred rather than experimentally determined lineages.</p><p>Our analysis proceeded in three steps. First, to ask whether RGCs were committed to a particular fate before or shortly after they were born, we assessed transcriptomic heterogeneity at a time when a large fraction was newly postmitotic (E13 and E14). We found that heterogeneity was present but limited: 10 transcriptomic clusters were distinguishable at E13 and 12 at E14. Thus, some heterogeneity is present in precursor RGCs, but far less than would be required to specify type identity before or immediately after their birth. A relevant issue is whether at these early stages the transcriptomic variation among cells could reflect variation in their stages of differentiation, perhaps as a consequence of different intervals between birthdate and sampling. Although we cannot exclude this possibility, inter-cluster variability of key RGC-specific genes (e.g., <italic>Rbpms</italic>) was no greater at early times than in adults (data not shown).</p><p>Second, we used a supervised classification approach to ask whether precursor RGC clusters mature into mutually exclusive sets of adult types. This model would imply an orderly, step-wise restriction of cell fates. However, our results indicate substantial overlap in the types derived from cells in different immature clusters. This result argues against a deterministic model of diversification and suggests that precursor RGCs are incompletely committed to a specific type for a substantial period after they are generated.</p><p>Third, we used optimal transport inference (WOT) to ask whether the multipotentiality observed at the level of groups was also a property of individual cells. This approach circumvents the limitation of the supervised classification approach, which compares similarity only at the level of clusters. WOT utilizes time-course scRNA-seq snapshots to infer fate associations between individual cells sampled at different time points, without reference to the clusters in which they reside (<xref ref-type="bibr" rid="bib78">Schiebinger et al., 2019</xref>). While being consistent with supervised classification results at the cluster level, WOT indicated that the majority of individual RGCs were multipotential at E13 and E14. Of equal importance, immature RGCs were not totipotential: the average predicted potential (<italic>P</italic>) was 11.6 at E13, or ~25% of the maximum possible value of 45, and no RGCs had <italic>P</italic> &gt; 30. We conclude that single multipotential immature RGCs are biased in favor of particular groups of adult RGC types.</p></sec><sec id="s3-4"><title>Progressive restriction of RGC fate</title><p>Further analysis provided insight into the structure of multipotentiality among RGCs. The adult RGC types associated with a precursor RGC were not a randomly chosen subset; rather some were more likely to arise from a common precursor state (‘fate coupled’) than others. This suggests a model in which RGC types arise via a progressive decoupling of fates within multipotential precursors. Decoupling is asynchronously, with different types emerging at different times. By modeling the temporal kinetics of fate decoupling, we were able to estimate a tentative specification time for each type – that is, the time at which precursors acquire a distinct transcriptomic identity. Analysis of transcriptomic changes that occur during this process, and the effects of visual experience on maturation, will be presented elsewhere (K.S., I.E.W., S.B. and J.R.S., in preparation).</p><p>Our conclusions about fate restriction are based on analyzing cell states defined by expression patterns of highly variable genes (HVGs) identified in the data (<xref ref-type="fig" rid="fig2">Figure 2h</xref>). An alternative and common view is that if a small set of genes is sufficient to define cell state, they should be the focus of analysis. We believe this is an incorrect argument based on confusion between genes that determine a cell type or state and those that define it. The only way a small number of genes, whatever their functional role, can exclusively define cell state is if they are expressed at very high levels. If this were the case, they would be detected in our data and drive the clustering.</p></sec><sec id="s3-5"><title>Fate-restricted RGC subclasses</title><p>For RGCs, class identity has been clear for a century, and type identity has been solidified during over the last few decades, but criteria for defining subclasses remain unclear. Tentative classifications have used molecular, physiological, and morphological criteria (<xref ref-type="bibr" rid="bib77">Sanes and Masland, 2015</xref>; <xref ref-type="bibr" rid="bib85">Tran et al., 2019</xref>). In general, these criteria correlate imperfectly with each other, a main exception being that ON and OFF RGCs (responding preferentially to increases and decreases in illumination, respectively) have dendrites that arborize in the inner and outer portions of the inner plexiform layer (<xref ref-type="bibr" rid="bib23">Famiglietti and Kolb, 1976</xref>).</p><p>The pattern of fate couplings between RGC types at E13–14 provides an alternative way to define RGC subclasses – groups of RGC types that arise from the restriction of a common transcriptionally defined precursor state. We identified TFs selectively expressed within these subclasses. Our rationale was that among them would be fate determinants, an idea that could be tested by conventional genetic manipulations. Support for this idea is that there is already strong evidence that one such factor is a fate determinant in mouse: <italic>Eomes</italic> is selectively expressed by ipRGCs (and a few other types), and <italic>Eomes</italic> mutants fail to form ipRGCs although their retinas are normal in many respects (<xref ref-type="bibr" rid="bib54">Mao et al., 2014</xref>). This encourages the hope that some of the other TFs in this set are also fate determinants. It will also be interesting to determine whether members of fate-restricted subclasses share structural or functional properties.</p></sec><sec id="s3-6"><title>Laterality</title><p>The TFs <italic>Isl2</italic> and <italic>Zic2</italic> are selective markers of embryonic RGCs that project contralaterally or ipsilaterally, respectively, and are critical determinants of this choice (<xref ref-type="bibr" rid="bib33">Herrera et al., 2003</xref>; <xref ref-type="bibr" rid="bib66">Pak et al., 2004</xref>). We found that their expression was largely nonoverlapping in RGCs at E13, and that they were co-expressed with previously reported markers of contralaterally and ipsilaterally projecting RGCs, respectively. Because few RGC axons reach the optic chiasm before E14, our results are consistent with genetic evidence that this differential expression is a cause rather than a consequence of the divergent choices the axons make at the chiasm. Among many genes co-expressed with <italic>Isl2</italic> or <italic>Zic2</italic> may be others that play roles in this choice.</p><p><italic>Zic2</italic> is downregulated later in embryogenesis, so we selected some RGCs as putative I-RGCs using genes known to be expressed in them (<xref ref-type="bibr" rid="bib92">Wang et al., 2016</xref>), then used WOT to infer the RGC types to which they gave rise. Our analysis suggests that I-RGCs comprise many differentiated types, consistent with previous results (<xref ref-type="bibr" rid="bib36">Hong et al., 2011</xref>; <xref ref-type="bibr" rid="bib39">Johnson et al., 2021</xref>). Surprisingly, however, there were few if any genes differentially expressed between the putative mature I- and C-RGCs. Assuming that WOT results are valid – an assertion that can be tested directly in the future – this result suggests a model in which newborn RGCs are doubly specified – by laterality and type – but that once axonal choice has been made the laterality program is shut down.</p></sec><sec id="s3-7"><title>Beyond the retina</title><p>Generation of neuronal classes has been analyzed in many parts of the vertebrate nervous system, but we are aware of few reports on how classes diversify into types. A recent study addressed this issue for primary sensory neurons and reached the conclusion that newborn neurons in dorsal root ganglia are transcriptionally unspecialized and become type-restricted as development proceeds (<xref ref-type="bibr" rid="bib79">Sharma et al., 2020</xref>). Similarly, both excitatory neuronal subclasses appear to diversify postmitotically in the mouse cerebral cortex (<xref ref-type="bibr" rid="bib19">Di Bella et al., 2021</xref>; <xref ref-type="bibr" rid="bib51">Lodato and Arlotta, 2015</xref>), and there is suggestive evidence that the same is true for interneuronal subclasses (<xref ref-type="bibr" rid="bib91">Wamsley and Fishell, 2017</xref>). In all of these cases, it is attractive to speculate that diversification may occur by a process of fate decoupling in subpopulations of distinct multipotential precursors, akin to that documented here for RGCs. Our study provides a computational framework for investigating this issue.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Reagent type (species) or resource</th><th align="left" valign="bottom">Designation</th><th align="left" valign="bottom">Source or reference</th><th align="left" valign="bottom">Identifiers</th><th align="left" valign="bottom">Additional information</th></tr></thead><tbody><tr><td align="left" valign="bottom">Strain, strain background (<italic>Mus musculus</italic>)</td><td align="left" valign="bottom">C57BL/6</td><td align="left" valign="bottom">Charles River or Jackson Labs</td><td align="left" valign="bottom">Cat#JAX000664; RRID: <ext-link ext-link-type="uri" xlink:href="https://identifiers.org/RRID/RRID:IMSR_JAX:000664">IMSR_JAX:000664</ext-link></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Antibody</td><td align="left" valign="bottom">Anti-Thy1/anti-CD90(rat monoclonal)</td><td align="left" valign="bottom">Thermo Fisher Scientific</td><td align="left" valign="bottom">#17-0902-82</td><td align="left" valign="bottom">1:200</td></tr><tr><td align="left" valign="bottom">Antibody</td><td align="left" valign="bottom">Anti-L1cam(rat monoclonal)</td><td align="left" valign="bottom">Miltenyi Biotec</td><td align="left" valign="bottom">#130-102-243</td><td align="left" valign="bottom">1:10</td></tr><tr><td align="left" valign="bottom">Antibody</td><td align="left" valign="bottom">Anti-CD90 pre-conjugated (rat monoclonal)</td><td align="left" valign="bottom">Miltenyi Biotec</td><td align="left" valign="bottom">#130-049-101</td><td align="left" valign="bottom">1:200</td></tr><tr><td align="left" valign="bottom">Antibody</td><td align="left" valign="bottom">Anti-RBPMS (guinea pig polyclonal)</td><td align="left" valign="bottom">PhosphoSolutions</td><td align="left" valign="bottom">#1832-RBPMS</td><td align="left" valign="bottom">1:1000</td></tr><tr><td align="left" valign="bottom">Antibody</td><td align="left" valign="bottom">Anti-KI67 (rabbit monoclonal)</td><td align="left" valign="bottom">Thermo Fisher Scientific</td><td align="left" valign="bottom">#MA5-14520</td><td align="left" valign="bottom">1:250</td></tr><tr><td align="left" valign="bottom">Chemical compound, drug</td><td align="left" valign="bottom">Fluoro-Gel</td><td align="left" valign="bottom">Electron Microscopy Sciences</td><td align="left" valign="bottom">#17985</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Commercial assay or kit</td><td align="left" valign="bottom">MACS Large Cell Columns</td><td align="left" valign="bottom">Miltenyi Biotec</td><td align="left" valign="bottom">#130-042-202</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Sequence-based reagent</td><td align="left" valign="bottom">Drop-seq beads</td><td align="left" valign="bottom">ChemGenes Corporation</td><td align="left" valign="bottom">#Macosko201110</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Commercial assay or kit</td><td align="left" valign="bottom">Papain dissociation system</td><td align="left" valign="bottom">Worthington</td><td align="left" valign="bottom">#LK003160</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Commercial assay or kit</td><td align="left" valign="bottom">Chromium Single Cell 30Library and Gel Bead Kit v2, 10X Genomics 16rxns</td><td align="left" valign="bottom">10X Genomics</td><td align="left" valign="bottom">#120237</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">Cell Ranger v2.6.0</td><td align="left" valign="bottom">10X Genomics</td><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/software/downloads/latest">https://support.10xgenomics.com/single-cell-gene-expression/software/downloads/latest</ext-link></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">ImageJ (Fiji) version 2.1.0</td><td align="left" valign="bottom">Fiji</td><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://imagej.net/Fiji">https://imagej.net/Fiji</ext-link></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">R 3.6.2</td><td align="left" valign="bottom">The R Foundation</td><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://www.r-project.org/">https://www.r-project.org/</ext-link></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Software, algorithm</td><td align="left" valign="bottom">RStudio 1.3.1056</td><td align="left" valign="bottom">RStudio</td><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://www.adobe.com">https://www.adobe.com</ext-link></td><td align="left" valign="bottom"/></tr></tbody></table></table-wrap><sec id="s4-1"><title>Mice</title><p>All animal experiments were approved by the Institutional Animal Care and Use Committees (IACUC) at Harvard University. Mice were maintained in pathogen-free facilities under standard housing conditions with continuous access to food and water. Animals used in this study include both males and females. A meta-analysis (not shown) did not show any systematic sex-related effects in either DE genes or cell-type proportions. For scRNA-seq and histology, we used C57Bl/6J (JAX #000664). Embryonic and early postnatal C57Bl/6J mice were acquired either from Jackson Laboratories (JAX) from time-mated female mice or time-mated in-house. For timed-matings, a male was placed with a female overnight and removed the following morning (with the corresponding time recorded as E0.5).</p></sec><sec id="s4-2"><title>Cell preparation</title><p>RGCs were enriched from dissociated retinal cells as previously described with minor modifications (<xref ref-type="bibr" rid="bib85">Tran et al., 2019</xref>). All solutions were prepared using Ames' Medium with L-glutamine and sodium bicarbonate (equilibriated with 95% O<sub>2</sub>/5% CO<sub>2</sub>), and all spin steps were done at 450 × <italic>g</italic> for 8 min. Retinas were dissected out in their entirety immediately after enucleation and digested in ~80 U of papain at 37°C, with the exception of some E13 and E14 eyes that were digested whole, followed by manual trituration in ovomucoid solution. Clumps were removed using a 40 μm cell strainer and the cell suspension was spun down and resuspended in Ames + 4% BSA at a concentration of 10 million cells per 100 μl. Cells from E13, E14, E16, and P0 were incubated for 15 min at room temperature with antibodies to Thy1 (also known as CD90) and L1CAM pre-conjugated to the fluorophores APC (Thermo Fisher Scientific #17-0902-82) and PE (Miltenyi Biotec #130-102-243), respectively. Cells were washed with 6 ml of Ames + 4% BSA, spun down and resuspended at a concentration of ~7 million cells/ml, and calcein blue was added to label metabolically active cells.</p><p>Viable Thy1- or L1CAM-positive cells were sorted using a MoFlo Astrios sorter into ~100 μl of AMES + 4% BSA. Sorted cells were spun down a final time and resuspended in PBS + 0.1% BSA at a concentration of 500–2000 cells/μl. P5 RGCs were enriched using only CD90, with either magnetic-activated cell sorting (MACS) using large cell columns and CD90 pre-conjugated to microbeads (#130-042-202 and #130-049-101, Miltenyi Biotec) or fluorescence-activated cell sorting with CD90 pre-conjugated to PE/Cy7 (Thermo Fisher Scientific #25-0902-81), or both.</p></sec><sec id="s4-3"><title>Droplet-based single-cell RNA-seq</title><sec id="s4-3-1"><title>Statement on replicates</title><p>We profiled immature RGCs using scRNA-seq at five developmental time points: E13, E14, E16, P0, and P5. At each age, data was collected from four replicate experiments. Experiments at E13, E14, E16, and P0 involved two biological replicates (distinct mice). Each of these biological replicates was further subdivided into two equal pools, and the cells were subjected to two different enrichment methods (anti-Thy1 and anti-L1cam). Thus, each of these time points consisted of four replicate experiments. RGC enrichment at P5 exclusively utilized anti-Thy1, but four biological replicate experiments were performed. One of these was profiled using 10X, and three of these were profiled using Drop-seq.</p></sec><sec id="s4-3-2"><title>Drop-seq</title><p>A subset of P5 RGC dataset was collected using Drop-seq (<xref ref-type="bibr" rid="bib53">Macosko et al., 2015</xref>), performed largely as described previously (<xref ref-type="bibr" rid="bib80">Shekhar et al., 2016</xref>). Briefly, cells were diluted to an estimated final droplet occupancy of 0.05, and co-encapsulated in droplets with barcoded beads, which were diluted to an estimated final droplet occupancy of 0.06. The beads were purchased from ChemGenes Corporation, Wilmington, MA (# Macosko201110). Individual droplet aliquots of 2 ml of aqueous volume (1 ml each of cells and beads) were broken by perfluorooctanol, following which beads were harvested, and hybridized RNA was reverse transcribed. Populations of 2000 beads (~100 cells) were separately amplified for 14 cycles of PCR (primers, chemistry, and cycle conditions identical to those previously described) and pairs of PCR products were co-purified by the addition of 0.6x AMPure XP beads (Agencourt). Fifteen experimental replicates were sequenced in total from five biological replicates using an Illumina NextSeq 500. Read 1 was 20 bp; read 2 (paired-end) was 60 bp.</p></sec><sec id="s4-3-3"><title>10X Genomics</title><p>Single-cell libraries were prepared using the single-cell gene expression 3′ kit on the Chromium platform (10X Genomics, Pleasanton, CA) following the manufacturer’s protocol. As our datasets were collected over a long period of time, we used a combination of v1 (a single channel of P5 RGCs) and v2 (E13, E14, E16, P0). Briefly, single cells were partitioned into Gel beads in EMulsion (GEMs) in the 10X Chromium instrument followed by cell lysis and barcoded reverse transcription of RNA, amplification, enzymatic fragmentation, 5′ adaptor attachment, and sample indexing. On average, approximately 8000–12,000 single cells were loaded on each channel and approximately 3000–7000 cells were recovered. Libraries were sequenced on the Illumina HiSeq 2500 platforms at the Broad Institute (paired-end reads: read 1, 26 bases; read 2, 98 bases).</p></sec><sec id="s4-3-4"><title>Power analysis</title><p>An important question in all single-cell experiments is that of the number of cells to profile. A widely used approach is the power analysis tool published by the Satija lab (<ext-link ext-link-type="uri" xlink:href="https://satijalab.org/howmanycells/">https://satijalab.org/howmanycells/</ext-link>). Fortunately, in this study we were also guided by our previous study of adult RGCs, where we had knowledge of the frequency distribution of adult RGC types, with the rarest type being approximately 0.2% (<xref ref-type="bibr" rid="bib85">Tran et al., 2019</xref>). In that study, we also found that when classification is performed in a supervised fashion based on an existing atlas, approximately ~8000 RGCs were sufficient to recover the accurate relative frequency distribution of 45 RGC types. We therefore aimed to profile ~8000 cell at each time point as our analysis involved mapping immature RGCs to the adult atlas. With the exception of E13, all time points contain 1.5–2× more cells than this target value.</p></sec></sec><sec id="s4-4"><title>Histology</title><sec id="s4-4-1"><title>Tissue fixation</title><p>Adult (P56) mice were intracardially perfused with 2–5 ml of PBS followed by 15 ml of 4% PFA, followed by additional fixation of eyes for 15 min in 4% PFA. P0 and P5 mice were not perfused, rather eyes were fixed in 4% PFA for 30 min. At E13, 14, and 16, embryos were fixed whole for 30 min in 4% PFA, following which eyes were removed. Following fixation, eyes from all time points were transferred to PBS and stored at 4°C until subsequent use.</p></sec><sec id="s4-4-2"><title>Sectioning</title><p>Cross sections for immunohistochemistry (IHC) were generated using a Leica CM1850 cryostat. For some early developmental time points, eyes were kept whole for IHC, otherwise retinas were either (1) dissected out in their entirety from eyes or (2) the cornea, iris, and lens were removed, leaving the sclera and retina intact. Tissues were sunk in 30% sucrose overnight at 4°C, embedded in tissue freezing medium, and cryo-sectioned into 25 mm slices. Slides with tissue sections were air-dried for ~3 hr and stored at –80°C until staining.</p></sec><sec id="s4-4-3"><title>Immunohistochemistry</title><p>All IHC solutions were made up in PBS + 0.3% Triton-X, and all incubation steps were carried out in a humidified chamber. Following a 1 hr protein block in 5% normal donkey serum at room temperature, slides were incubated overnight at 4°C with primary antibodies, washed twice for 5 min each in PBS, incubated for 2 hr at room temperature with secondary antibodies conjugated to various fluorophores (1:1000, Jackson Immunological Research) and Hoechst (1:10,000, Life Technologies), and washed again twice for 5 min each in PBS before coverslipping with Fluoro-Gel (#17985, Electron Microscopy Sciences). Primary antibodies used include guinea pig anti-RBPMS (1:1000, #1832-RBPMS, PhosphoSolutions), rabbit anti-KI67 (1:250, #MA5-14520, Thermo Fisher Scientific), and rat anti-L1CAM (1:10, #130-102-243, Miltenyi Biotec).</p></sec><sec id="s4-4-4"><title>Imaging</title><p>All images were acquired using an Olympus Fluoview 1000 scanning laser confocal microscope, with a ×20 oil immersion objective and ×2 optical zoom. Optical slices were taken at 1 μm steps. Fiji was used to pseudocolor each channel and generate a maximum projection from image stacks. Brightness and contrast were adjusted in Adobe Photoshop.</p></sec></sec><sec id="s4-5"><title>Alignment and quantification of gene expression in single cells</title><p>All single-cell libraries were aligned to the UCSC mm10 transcriptomic reference (<italic>Mus musculus</italic>), and gene expression matrices were quantified using standard protocols described previously. For the single-cell libraries generated using the 10X platform (E13, E14, E16, P0, and P5), these steps were performed using cellranger v2.1.0 (10X Genomics). For the single-cell libraries generated using Drop-seq (P5), we used Drop-seq tools (v1.12; <xref ref-type="bibr" rid="bib53">Macosko et al., 2015</xref>), following the procedures described earlier (<xref ref-type="bibr" rid="bib80">Shekhar et al., 2016</xref>). Alignment and quantification was done for each sample library separately to generate a genes × cells expression matrix of transcript counts. These matrices were column-concatenated for further analysis.</p><p>We retained cells that expressed at least 700 genes, resulting in 98,452 cells. We also removed genes expressed in fewer than 10 cells. The resulting <italic>M</italic> genes × <italic>N</italic> cells matrix of UMI counts <inline-formula><mml:math id="inf38"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> was normalized along each column (cell) to sum to 8340, the median of the column sums resulting in a normalized matrix <inline-formula><mml:math id="inf39"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> . This was followed by the transformation <inline-formula><mml:math id="inf40"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mo>⁡</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>.</p></sec><sec id="s4-6"><title>Overview of clustering analysis</title><p>The following procedure was adopted to perform batch correction, dimensionality reduction, and clustering throughout the article. The procedure was first applied on the entire dataset to separate RGCs from other cell classes, and then to RGCs at each age to identify transcriptomically distinct groups.</p><list list-type="order"><list-item><p><italic>Identification of HVGs:</italic> We used the Gamma-Poisson framework described previously to identify HVGs (<xref ref-type="bibr" rid="bib67">Pandey et al., 2018</xref>). Briefly, we compute for each gene the mean (<inline-formula><mml:math id="inf41"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) and the coefficient of variation (<inline-formula><mml:math id="inf42"><mml:mi>C</mml:mi><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) for the UMI counts <inline-formula><mml:math id="inf43"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> ,</p><list list-type="simple"><list-item><p><inline-formula><mml:math id="inf44"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></p></list-item><list-item><p><inline-formula><mml:math id="inf45"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula></p></list-item><list-item><p><inline-formula><mml:math id="inf46"><mml:mi>C</mml:mi><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula></p></list-item><list-item><p>For a given <inline-formula><mml:math id="inf47"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> , the Gamma-Poisson model predicts a ‘null’ coefficient of variation (<inline-formula><mml:math id="inf48"><mml:mi>C</mml:mi><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>) arising from a combination of Poisson ‘shot’ noise and large variations in library size, assumed to be due to technical reasons,</p></list-item><list-item><p><inline-formula><mml:math id="inf49"><mml:mi>C</mml:mi><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula></p></list-item><list-item><p>Here, <inline-formula><mml:math id="inf50"><mml:mi>α</mml:mi></mml:math></inline-formula> is the shape parameter of a Gamma-distribution fit to the distribution of normalized library sizes <inline-formula><mml:math id="inf51"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (using the R package <monospace>MASS</monospace>),</p></list-item><list-item><p><inline-formula><mml:math id="inf52"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></inline-formula></p></list-item><list-item><p>In practice, <inline-formula><mml:math id="inf53"><mml:mi>C</mml:mi><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> serves as a tight lower bound for empirically observed values of <inline-formula><mml:math id="inf54"><mml:mi>C</mml:mi><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> across the full range of <inline-formula><mml:math id="inf55"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> . This enables us to compute for each gene <italic>m</italic>, a deviation score <inline-formula><mml:math id="inf56"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>C</mml:mi><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></inline-formula> , quantifying the extent to which its observed coefficient of variation exceeds the predicted null model. HVGs are selected if they satisfy <inline-formula><mml:math id="inf57"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>M</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:mn>0.8</mml:mn><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mi>t</mml:mi><mml:mi>d</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></list-item></list></list-item><list-item><p><italic>Batch correction and dimensionality reduction</italic>: We subsetted the rows of the expression matrix <inline-formula><mml:math id="inf58"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to the HVGs identified in Step 1. As our data comprised cells sampled at different developmental ages as well as multiple biological replicates within each age, we used Liger, a non-negative matrix factorization technique, to embed the data in a reduced dimensional latent space of shared factors (<xref ref-type="bibr" rid="bib93">Welch et al., 2019</xref>). Liger computes a factorized representation for each matrix that separates ‘shared’ and ‘dataset-specific’ gene expression modules (factors). We use Liger’s normalized <italic>H</italic> factor loadings for cells to build a nearest-neighbor graph and define clusters.</p><list list-type="simple"><list-item><p>As in any matrix factorization technique, Liger requires the user to choose <italic>k</italic>, the dimensionality of the latent space. To find <italic>k</italic>, we use a Random Matrix Theory approach (outlined in <xref ref-type="bibr" rid="bib69">Peng et al., 2019</xref>). Briefly, <italic>k</italic> is estimated as the number of eigenvalues of the sample gene–gene correlation matrix that exceed the 99th percentile of the distribution of the largest eigenvalue of a random Hermitian matrix of the same dimensions. This is given by the Tracy–Widom distribution. For these calculations, we used the R package RMTstat.</p></list-item></list></list-item><list-item><p><italic>Clustering and 2D visualization</italic>: To cluster cells based on transcriptomic similarity, we first built a nearest-neighbor graph on the cells based on their normalized <italic>H</italic> factor coordinates computed using Liger. The number of nearest neighbors was chosen to be 30. The edges were weighted based on the Jaccard overlap metric, and graph clustering was performed using the Louvain algorithm, as described previously (<xref ref-type="bibr" rid="bib80">Shekhar et al., 2016</xref>). The normalized <italic>H</italic> factor coordinates were also used as input to project cells on to a nonlinear 2D space using the Uniform Manifold Approximation and Projection algorithm (UMAP; <xref ref-type="bibr" rid="bib7">Becht et al., 2018</xref>). Graph construction, clustering, and the UMAP projection were performed using the R packages FNN, igraph, and umap, respectively.</p></list-item></list><p>We began by clustering the full dataset combining all ages using the procedure outlined above. We identified groups of clusters corresponding to cell classes, which included RGCs (<italic>Rbpms, Slc17a6, Sncg, Nefl</italic>), microglia (<italic>P2ry12, C1qa-c, Tmem119</italic>), photoreceptors (<italic>Otx2, Gngt2, Gnb3</italic>), amacrine cells (<italic>Tfap2a, Tfap2b, Onecut2</italic>), anterior segment cells (<italic>Mgp, Col3a1,Igfbp7</italic>), cycling progenitors (<italic>Ccnd1, Fgf15, Hes5</italic>), and neurogenic progenitors (<italic>Hes6, Ascl1, Neurog2</italic>). Deeper annotation (e.g., of RGC type) was not done at this stage. No other cellular classes were identified. Three clusters comprising fewer than 1.2% of the cells expressed markers of more than one class. These were flagged as doublets and removed from further analyses.</p></sec><sec id="s4-7"><title>Defining RGC precursor heterogeneity at each age</title><p>RGC precursors at each age were separately analyzed following the clustering pipeline outlined previously. When implementing Liger, each biological replicate was regarded as a separate batch. The nominal clusters identified by the Louvain algorithm were refined as follows:</p><list list-type="order"><list-item><p><italic>Removing contaminants</italic>: Clusters were flagged for further examination if they did not exclusively express RGC-specific markers (e.g., <italic>Rbpms, Slc17a6, Sncg, Nefl</italic>). These clusters were small (typically &lt;1–2% of cells) and in all cases expressed non-RGC markers (e.g., <italic>P2ry12</italic> or <italic>Tfap2b</italic>). These cells, which likely reflect trace contaminants, were discarded from further analysis.</p></list-item><list-item><p><italic>Merging proximal clusters</italic>: Transcriptomic relationships between nominated clusters were visualized on a dendrogram computed using hierarchical clustering, as noted above. Neighboring clusters on the dendrogram, which were leaves in a terminal branch, were assessed for differential expression using the MAST DE test (<xref ref-type="bibr" rid="bib25">Finak et al., 2015</xref>). A gene <italic>g</italic> was regarded as significantly DE between clusters <inline-formula><mml:math id="inf59"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> if it satisfied <inline-formula><mml:math id="inf61"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>F</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and MAST p-value was less than <inline-formula><mml:math id="inf62"><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> (false discovery rate [FDR] corrected), where</p><list list-type="simple"><list-item><p><inline-formula><mml:math id="inf63"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>F</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></inline-formula></p></list-item></list></list-item></list><p>is defined to be the log-fold change in expression. Clusters that showed fewer than 10 significant DE genes were merged. In this manner, we identified 10 RGC clusters at E13, 12 at E14, 19 at E16, 27 at P0, and 38 at P5. Using MAST, we identified DE genes that distinguished each cluster against the rest at any given age.</p></sec><sec id="s4-8"><title>Quantifying RGC diversity at different ages</title><p>We quantified the molecular diversity of RGCs based on clusters at each stage using three measures of population diversity – the Rao index (<xref ref-type="fig" rid="fig2">Figure 2</xref>), the Shannon index, and the Simpson index (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). For <italic>N</italic> clusters with relative frequencies <inline-formula><mml:math id="inf64"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> , these indices are defined as follows:</p><list list-type="order"><list-item><p>Let <inline-formula><mml:math id="inf65"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> be a distance measure between clusters <italic>i</italic> and <italic>j</italic> (<inline-formula><mml:math id="inf66"><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi> </mml:mi><mml:mn>1</mml:mn></mml:math></inline-formula>). The <italic>Rao index</italic> is defined as</p><list list-type="simple"><list-item><p>We used varying number of genes (≈1200–3000) to calculate <inline-formula><mml:math id="inf67"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> . The computed Rao index was insensitive to these variations.</p></list-item></list></list-item><list-item><p>The <italic>Shannon index</italic> is defined as</p><list list-type="simple"><list-item><p><inline-formula><mml:math id="inf68"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></p></list-item></list></list-item><list-item><p>The <italic>Simpson index</italic> is defined as</p><list list-type="simple"><list-item><p><inline-formula><mml:math id="inf69"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></list-item></list></list-item><list-item><p>While the Rao and Shannon indices increase with diversity, the Simpson index decreases with diversity.</p></list-item></list></sec><sec id="s4-9"><title>Analysis of cluster distinctiveness</title><p>We quantified the mutual separation of clusters at each age using two approaches:</p><list list-type="order"><list-item><p><italic>Multi-class classification</italic>: We trained a multi-class classifier (R package <monospace>xgboost</monospace>) at each age on 50% of the cells using their cluster IDs. The remaining 50% of the cells were used to test the learned classifier and estimate a classification error per cluster, which were averaged at each age. As clusters become better separated, the average classification error decreases.</p></list-item><list-item><p><italic>Relative positions in PC space</italic>: At each age, the top 20 principal component analysis (PCA) coordinates were first standardized by z-scoring. For each cluster <italic>C</italic> at a given age, we computed two quantities:</p><p>a. <inline-formula><mml:math id="inf70"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> , the median of Euclidean distances of each cell from the cluster centroid in the standardized PCA coordinates.</p><p>b. <inline-formula><mml:math id="inf71"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> , the median of Euclidean distances of each cell from the centroid of the nearest external cluster.</p></list-item></list><p>For a cluster C, a low of value <inline-formula><mml:math id="inf72"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> indicates a higher degree of separatedness. Averaging this metric across all the clusters at a given age quantifies the degree to which clusters are separated in the UMAP representation.</p></sec><sec id="s4-10"><title>Relating clusters across ages using supervised classification</title><sec id="s4-10-1"><title>Analysis overview</title><p>To distinguish between ‘specified’ and ‘nonspecified’ modes of diversification (<xref ref-type="fig" rid="fig3">Figure 3</xref>), we first used a supervised classification approach to associate immature RGC clusters at young ages (tests) to cluster IDs determined at older ages (references). We used XGBoost, a decision-tree-based ensemble learning algorithm (<xref ref-type="bibr" rid="bib15">Chen and Guestrin, 2016</xref>), to train multi-class classifiers on reference clusters and used these to assign labels to individual test RGCs.</p><p>Two kinds of references were used: (1) classifiers trained on the adult (P56) clusters were used to assign immature RGCs at each of the five developmental ages (five separate analyses) to adult labels. (2) Classifiers trained on E14, E16, P0, and P5 clusters were used to assign E13, E14, E16, and P0 RGCs to labels corresponding to the previous age, respectively (four separate analyses). The correspondence between classifier assigned labels and cluster IDs of test RGCs was visualized using confusion matrices (e.g., <xref ref-type="fig" rid="fig3">Figure 3d–h</xref>) and quantified using two metrics – the ARI and NCE metrics, described below.</p></sec><sec id="s4-10-2"><title>Classification overview</title><p>To describe our classification analysis, we introduce some notation to facilitate a description in general terms. Let <inline-formula><mml:math id="inf73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> denote the reference and the test atlases for the purpose of supervised classification. The number of cells (i.e., RGCs) contained in the reference and test atlases is denoted <inline-formula><mml:math id="inf75"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf76"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, respectively. <inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf78"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> could correspond to any pair of ages as described above. Without loss of generality, let us assume that <inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> contains <italic>r</italic> transcriptomic clusters denoted <inline-formula><mml:math id="inf80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mo>…</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. Similarly, <inline-formula><mml:math id="inf81"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is assumed to contain <italic>t</italic> transcriptomically defined clusters denoted <inline-formula><mml:math id="inf82"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mo>…</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>Each cell in our dataset is the member of a particular atlas and is assigned to a single cluster within the atlas based on its transcriptome. The transcriptome of each cell is a vector (denoted using lowercase boldface symbols, e.g., <inline-formula><mml:math id="inf83"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula> or <inline-formula><mml:math id="inf84"><mml:mi mathvariant="bold-italic">v</mml:mi></mml:math></inline-formula>) with the number of elements equal to the number of HVGs (the features used for classification). Let <inline-formula><mml:math id="inf85"><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> denote the transcriptionally assigned of cell <inline-formula><mml:math id="inf86"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula>. For example, the following statement,<disp-formula id="equ1">,<mml:math id="m1"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>∈</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></disp-formula></p><p>translates to ‘Cell <inline-formula><mml:math id="inf87"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula> in atlas <inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is a member of cluster <inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> .’ Our goal is to <italic>assign</italic> each cell <inline-formula><mml:math id="inf90"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> a second ID <inline-formula><mml:math id="inf91"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> based on its transcriptomic correspondence to the reference atlas <inline-formula><mml:math id="inf92"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> . We perform this via an XGBoost classifier trained on <inline-formula><mml:math id="inf93"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and applied it to every cell in <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> , allowing us to infer transcriptomic correspondences between the two sets of clusters. The main steps are as follows:</p><list list-type="bullet"><list-item><p>The expression matrices in <inline-formula><mml:math id="inf95"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf96"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> are z-scored along each feature. The initial set of features are chosen as the common HVGs in the two atlases. Parameters are adjusted to select the common top ~2000–3000 HVGs.</p></list-item><list-item><p>Classifiers <inline-formula><mml:math id="inf97"><mml:mi>C</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf98"><mml:mi>C</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> are trained on <inline-formula><mml:math id="inf99"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf100"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> independently. For training, we randomly sample 60% of cells in each cluster up to a maximum of 300 cells. The remaining ‘held-out’ cells are used for validation. We ran the training routine for XGBoost with the following parameter specification (see <ext-link ext-link-type="uri" xlink:href="https://xgboost.readthedocs.io/en/latest/parameter.html">https://xgboost.readthedocs.io/en/latest/parameter.html</ext-link>):</p></list-item></list><p><monospace>xgb_params &lt;- list(&quot;objective&quot; = &quot;multi:softprob&quot;</monospace>,</p><p><monospace>&quot;eval_metric&quot; = &quot;mlogloss&quot;</monospace>,</p><p><monospace>&quot;num_class&quot;= nClusters</monospace>,</p><p><monospace>&quot;eta&quot; = 0.2,&quot;max_depth&quot; = 6, subsample = 0.6)</monospace></p><list list-type="bullet"><list-item><p>When applied to a cell vector <inline-formula><mml:math id="inf101"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula>, the classifier <inline-formula><mml:math id="inf102"><mml:mi>C</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> (or <inline-formula><mml:math id="inf103"><mml:mi>C</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>) returns a vector of <inline-formula><mml:math id="inf104"><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>=</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo></mml:mrow></mml:mfenced></mml:math></inline-formula> of length <italic>r</italic> (or <italic>t</italic>) with entries representing probability values of predicted cluster memberships in the corresponding atlas. We use these values to compute the ‘softmax’ assignment of <inline-formula><mml:math id="inf105"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula>, so that <inline-formula><mml:math id="inf106"><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>`</mml:mi></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> .</p></list-item><list-item><p>Post training, <inline-formula><mml:math id="inf107"><mml:mi>C</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf108"><mml:mi>C</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> are evaluated on the respective validation sets. Using the predicted cluster assignments of the ‘held out’ cells, we compute for each cluster in <inline-formula><mml:math id="inf109"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf110"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> the error rate, defined as the fraction of held-out cells that were misclassified. If the error rate for any cluster was higher than 10%, the classifier is retrained by artificially upsampling cells from the high error rate clusters. In the final classifiers, the cluster-specific error rates were typically 1–4%, and in no case exceeded 10%.</p></list-item><list-item><p>The top 500 discriminatory features (genes) are identified based on average information gain (using the function <monospace>xgb.importance</monospace>) for each of <inline-formula><mml:math id="inf111"><mml:mi>C</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf112"><mml:mi>C</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> . These gene sets are denoted <inline-formula><mml:math id="inf113"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf114"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, respectively.</p></list-item><list-item><p>The common features <inline-formula><mml:math id="inf115"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msup><mml:mo>∩</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> are used to train a third classifier <inline-formula><mml:math id="inf116"><mml:mi>C</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> on the reference atlas <inline-formula><mml:math id="inf117"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> . This ensures that inferred transcriptomic correspondences are based on ‘core’ gene expression programs that are conserved at both time points rather than temporally regulated genes.</p></list-item><list-item><p>Finally, <inline-formula><mml:math id="inf118"><mml:mi>C</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is applied to each cell <inline-formula><mml:math id="inf119"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> to generate predicted labels <inline-formula><mml:math id="inf120"><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>`</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>. Global transcriptional correspondence was visualized using confusion matrices between cluster IDs <inline-formula><mml:math id="inf121"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mo>…</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and reference assignments <inline-formula><mml:math id="inf122"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mo>…</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, and their correspondence was quantified using the metrics described below.</p></list-item></list></sec></sec><sec id="s4-11"><title>Quantifying cluster correspondence using global and local metrics</title><p>Let <inline-formula><mml:math id="inf123"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denote the number of cells in <inline-formula><mml:math id="inf124"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> that are part of transcriptomic cluster <inline-formula><mml:math id="inf125"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> and are assigned by <inline-formula><mml:math id="inf126"><mml:mi>C</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> to reference cluster <inline-formula><mml:math id="inf127"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> . Thus,<disp-formula id="equ2"><mml:math id="m2"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">#</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">∀</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf128"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> defines a contingency table, whose marginal sums are defined as<disp-formula id="equ3"><mml:math id="m3"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ4"><mml:math id="m4"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Let <inline-formula><mml:math id="inf129"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>|</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> the number of cells in <inline-formula><mml:math id="inf130"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> . Then, the ARI corresponding to the assignments can be evaluated using the following equation:<disp-formula id="equ5"><mml:math id="m5"><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>-</mml:mo></mml:mrow></mml:mrow><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>+</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>The <italic>ARI</italic> ranges from 0 and 1, with extremes corresponding to random association and 1:1 correspondences between <inline-formula><mml:math id="inf131"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf132"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> , respectively. The ARI can technically also take on negative values for certain scenarios, but these are not observed in our data.</p><p>As an alternative, we also used the NCE, an information-theoretic measure. The NCE quantifies the extent to which knowledge of the value of <inline-formula><mml:math id="inf133"><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>`</mml:mi></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> reduces the uncertainty (measured in information bits) about the value of <inline-formula><mml:math id="inf134"><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> for <inline-formula><mml:math id="inf135"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> .</p><p>We introduce probability weights <inline-formula><mml:math id="inf136"><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and the corresponding marginals <inline-formula><mml:math id="inf137"><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf138"><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> as follows:<disp-formula id="equ6"><mml:math id="m6"><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:math></disp-formula><disp-formula id="equ7"><mml:math id="m7"><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:math></disp-formula><disp-formula id="equ8"><mml:math id="m8"><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>The conditional entropy (CE) is then given by the expression:<disp-formula id="equ9"><mml:math id="m9"><mml:mrow><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mtext> </mml:mtext></mml:mrow></mml:munder><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mfrac><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>Note that CE is asymmetric, that is, <inline-formula><mml:math id="inf139"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≠</mml:mo><mml:mtext> </mml:mtext><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. One notes that <italic>H = 0</italic> if for each cluster <inline-formula><mml:math id="inf140"><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi> </mml:mi><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi>r</mml:mi><mml:mo>}</mml:mo></mml:math></inline-formula>, <inline-formula><mml:math id="inf141"><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> for a single cluster <inline-formula><mml:math id="inf142"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> , where <inline-formula><mml:math id="inf143"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the Kronecker delta defined as<disp-formula id="equ10"><mml:math id="m10"><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mi> </mml:mi><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:math></disp-formula><disp-formula id="equ11"><mml:math id="m11"><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mi> </mml:mi><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:math></disp-formula></p><p>Finally, NCE is defined as<disp-formula id="equ12"><mml:math id="m12"><mml:mrow><mml:mi>N</mml:mi><mml:mi>C</mml:mi><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf144"><mml:mi>H</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the Shannon entropy. Due to this normalization, <italic>NCE</italic> values range from 0 to 1, with extremes corresponding to fully specific mapping or random association, respectively, between <inline-formula><mml:math id="inf145"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf146"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> . <italic>ARI</italic> and <italic>NCE</italic> are inversely related. Unlike <italic>ARI</italic>, however, <italic>NCE</italic> is able to detect specificity in both many:1 and 1:1 mappings. ARI returns a value lower than 1 for specific mappings if the number of clusters in <inline-formula><mml:math id="inf147"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf148"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is not equal.</p><p><italic>ARI</italic> and <italic>NCE</italic> quantify global correspondences between <inline-formula><mml:math id="inf149"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf150"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> . We also computed a local metric, the OF that quantified whether individual reference labels <inline-formula><mml:math id="inf151"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> were distributed in a ‘localized’ or ‘diffuse’ manner between test clusters<inline-formula><mml:math id="inf152"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mo>…</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula><disp-formula id="equ13"><mml:math id="m13"><mml:mrow><mml:mi>O</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Note that the term <inline-formula><mml:math id="inf153"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> is simply the fraction of the total test cells belonging to test cluster <inline-formula><mml:math id="inf154"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> that are assigned to reference cluster <inline-formula><mml:math id="inf155"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> by the classifier. Defined this way, the term in the square brackets computes an occupation number that ranges from 1 to <italic>t</italic> and can be interpreted as the number of test clusters that are specifically associated with <inline-formula><mml:math id="inf156"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> . Division by <italic>t</italic> the number of test clusters, therefore, converts this number into a fraction.</p></sec><sec id="s4-12"><title>Overview of WOT analysis</title><p>To identify fate relationships among maturing RGCs, we used WOT (<xref ref-type="bibr" rid="bib78">Schiebinger et al., 2019</xref>), a recently developed framework that is rooted in optimal transport theory (<xref ref-type="bibr" rid="bib89">Villani, 2009</xref>). WOT does not rely on clustering, and therefore is able to identify ancestor–descendant relationships between any pair of temporally separated RGCs in our data.</p><p>At its heart, WOT models cellular transcriptomes <inline-formula><mml:math id="inf157"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula> measured at a given age <italic>t</italic> as a probability distribution in gene expression space <inline-formula><mml:math id="inf158"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (note that <inline-formula><mml:math id="inf159"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula> may represent the original gene expression space or a reduced dimensional embedding estimated via PCA or diffusion maps). This probability distribution evolves with time as cells differentiate and mature. Different temporal measurements collected at times <inline-formula><mml:math id="inf160"><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mo>…</mml:mo></mml:math></inline-formula> represent temporal snapshots of the corresponding cell distributions <inline-formula><mml:math id="inf161"><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mo>…</mml:mo></mml:math></inline-formula> . Unfortunately, as each cell can only be measured once, the measurement at different times is from different cells. Therefore, for a particular cell <inline-formula><mml:math id="inf162"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf163"><mml:msub><mml:mrow><mml:mi> </mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> , it is not clear which cell(s) at time <inline-formula><mml:math id="inf164"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> are likely to be its ancestor(s) and which cell(s) at time <inline-formula><mml:math id="inf165"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> are likely to be descendant(s). It is this problem that WOT addresses.</p><p>Briefly, for a given pair of consecutive transcriptomic snapshots <inline-formula><mml:math id="inf166"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf167"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, we wish to estimate the joint distribution <inline-formula><mml:math id="inf168"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, representing the probability that a cell having an expression vector <inline-formula><mml:math id="inf169"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf170"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> transitions to a cell with an expression vector <inline-formula><mml:math id="inf171"><mml:mi mathvariant="bold-italic">v</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf172"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> . <inline-formula><mml:math id="inf173"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is also called the temporal coupling, which, owing to the destructive nature of scRNA-seq assays, is not directly observable. Under the assumption that cells move short distances in transcriptomic space when <inline-formula><mml:math id="inf174"><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is ‘reasonably close,’ WOT estimates <inline-formula><mml:math id="inf175"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> as the solution to the following convex optimization problem:<disp-formula id="equ14"><mml:math id="m14"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Π</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:munder><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:munder><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>ϵ</mml:mi><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>∫</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi>d</mml:mi><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mstyle></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>K</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>K</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>In the above equation,</p><list list-type="bullet"><list-item><p><inline-formula><mml:math id="inf176"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is an empirical distribution constructed from <inline-formula><mml:math id="inf177"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> , which denotes the scRNA-seq atlas at <inline-formula><mml:math id="inf178"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> ,</p><list list-type="simple"><list-item><p><inline-formula><mml:math id="inf179"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mtext> </mml:mtext><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></p></list-item></list></list-item><list-item><p>where <inline-formula><mml:math id="inf180"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> denotes the Dirac delta function, a probability distribution placing all its mass at the location <inline-formula><mml:math id="inf181"><mml:mi mathvariant="bold-italic">x</mml:mi></mml:math></inline-formula>.</p></list-item><list-item><p><inline-formula><mml:math id="inf182"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the cell distribution at <inline-formula><mml:math id="inf183"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> rescaled by the relative growth rate to account for cell division/death,</p><list list-type="simple"><list-item><p><inline-formula><mml:math id="inf184"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>g</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>∫</mml:mo><mml:mi>g</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula></p></list-item></list></list-item><list-item><p>Here, <inline-formula><mml:math id="inf185"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> represents the relative growth rate of cell <inline-formula><mml:math id="inf186"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula> in the time interval <inline-formula><mml:math id="inf187"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> and is estimated within the framework of unbalanced optimal transport (<xref ref-type="bibr" rid="bib16">Chizat et al., 2018</xref>). For more details, we refer the reader to the supplementary information of <xref ref-type="bibr" rid="bib78">Schiebinger et al., 2019</xref>.</p></list-item><list-item><p><inline-formula><mml:math id="inf188"><mml:mi>c</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> is a cost function defined as the Euclidean distance <inline-formula><mml:math id="inf189"><mml:msup><mml:mrow><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> . The first term of the objective function minimizes the cost function weighted by the temporal couplings, which may be interpreted as the transport distance between the distributions <inline-formula><mml:math id="inf190"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf191"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (also known as the Wasserstein distance).</p></list-item><list-item><p>The second term on the RHS represents entropic regularization, and <inline-formula><mml:math id="inf192"><mml:mi>ϵ</mml:mi></mml:math></inline-formula> is the corresponding strength. Classic OT identifies ‘deterministic’ couplings in that one cell at <inline-formula><mml:math id="inf193"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is transported to a single cell at <inline-formula><mml:math id="inf194"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> . Introduction of the entropic regularization term makes this problem nondeterministic, capturing the notion that there may exist immature cells whose fate is not completely determined. Our inferences of multipotentiality is directly a consequence of adding this entropic regularization term. Additionally, entropic regularization also makes the problem strongly convex, which is computationally beneficial.</p></list-item><list-item><p>The third and the fourth terms are features of unbalanced optimal transport, where equality constraints on the marginals (a consequence of mass conservation) are relaxed. <inline-formula><mml:math id="inf195"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf196"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> are the corresponding Lagrange multipliers.</p></list-item></list><p>We note that the values of the hyperparameters <inline-formula><mml:math id="inf197"><mml:mi>ϵ</mml:mi><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf198"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> are held fixed for all pairwise transport map calculations (E13, E14), (E14, E16), ….</p></sec><sec id="s4-13"><title>Application of WOT to RGC diversification and long-range couplings</title><p>We apply WOT to each pair of consecutive ages <inline-formula><mml:math id="inf199"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf200"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> to estimate the transport map <inline-formula><mml:math id="inf201"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> . Transport maps connecting nonconsecutive time points <inline-formula><mml:math id="inf202"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf203"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are estimated through a simple matrix multiplication of intermediate transport maps<disp-formula id="equ15"><mml:math id="m15"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>The transport matrices <inline-formula><mml:math id="inf204"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> encode fate relationships between cells at <inline-formula><mml:math id="inf205"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and cells at a later time <inline-formula><mml:math id="inf206"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> . These relationships can be analyzed at the level of clusters at <inline-formula><mml:math id="inf207"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to associate each cell <inline-formula><mml:math id="inf208"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> with transcriptomically defined cluster. This is particularly useful in estimating the terminal identity of immature RGCs.</p><p>Operationally we compute for each cell <inline-formula><mml:math id="inf209"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> a ‘cell fate vector’ <inline-formula><mml:math id="inf210"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mo>(</mml:mo><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mo>…</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula> encoding the probabilities that <inline-formula><mml:math id="inf211"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula> is associated with cluster <inline-formula><mml:math id="inf212"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> at time <inline-formula><mml:math id="inf213"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> ,<disp-formula id="equ16"><mml:math id="m16"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>β</mml:mi></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>It is easy to verify that<disp-formula id="equ17"><mml:math id="m17"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>β</mml:mi></mml:munder><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">∀</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula></p><p>The cell fate vector <inline-formula><mml:math id="inf214"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> encodes probabilistic associations between the cell <inline-formula><mml:math id="inf215"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula> and terminal clusters at <inline-formula><mml:math id="inf216"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> indexed by <inline-formula><mml:math id="inf217"><mml:mi>β</mml:mi></mml:math></inline-formula>. The ‘cluster ancestry vector’ at an earlier time <inline-formula><mml:math id="inf218"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of a cluster <inline-formula><mml:math id="inf219"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> at time <inline-formula><mml:math id="inf220"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> , denoted <inline-formula><mml:math id="inf221"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>;</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula> , is defined as follows:<disp-formula id="equ18"><mml:math id="m18"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mi>β</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:msub><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In a similar vein, the ‘cluster descendant vector’ at a later time <inline-formula><mml:math id="inf222"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of a cluster <inline-formula><mml:math id="inf223"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> at a time <inline-formula><mml:math id="inf224"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> , denoted <inline-formula><mml:math id="inf225"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>;</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math></inline-formula> , is defined as<disp-formula id="equ19"><mml:math id="m19"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>;</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>These equations can be used to compute the putative ancestral or descendent cells associated with a cluster <inline-formula><mml:math id="inf226"><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math></inline-formula> at time <inline-formula><mml:math id="inf227"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> .</p></sec><sec id="s4-14"><title>Implementation details of WOT</title><p>RGC vectors from all ages were combined, median-normalized, and log-transformed. 2854 HVGs were identified using the Gamma-Poisson model, and WOT was run on this matrix as follows:</p><p><monospace>wot optimal_transport --matrix RGC_mat.mtx --cell_days cell_day.txt --growth_iters 3 --epsilon 0.005 --out tmaps/RGC</monospace></p><p>Cell days were specified in <monospace>cell_day.txt</monospace> as 0, 1, 3, 6, 11, and 20 for E13, E14, E16, P0, P5, and P56, respectively. We computed trajectories and fates for each age using the following command illustrated for P0:</p><p><monospace>wot trajectory --tmap tmaps/RGC --cell_set cell_sets.gmt --day 6 --out tmaps/traj_RGC_P0.txt</monospace></p><p>Fates were computed as</p><p><monospace>wot fates --tmap tmaps/RGC --cell_set cell_sets.gmt --day 6 --out tmaps/fate_RGC_P0.txt</monospace></p><p>The above process was repeated for each age.</p><sec id="s4-14-1"><title>Multipotentiality of precursors</title><p>For each cell at ages E13–P5, we computed the terminal fate association <inline-formula><mml:math id="inf228"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mn>56</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mi> </mml:mi><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo>(</mml:mo><mml:mi>E</mml:mi><mml:mn>13</mml:mn><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi>E</mml:mi><mml:mn>14</mml:mn><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi>P</mml:mi><mml:mn>5</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>, quantifying the probability that it is a precursor of type <inline-formula><mml:math id="inf229"><mml:mi>β</mml:mi><mml:mo>∈</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mo>…</mml:mo><mml:mn>45</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>. Note that <inline-formula><mml:math id="inf230"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mn>56</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> is denoted <inline-formula><mml:math id="inf231"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for brevity in the main text. We define<disp-formula id="equ20"><mml:math id="m20"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mn>56</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>as the potential of precursor <inline-formula><mml:math id="inf232"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula> at age <italic>t</italic>. Values of <italic>P</italic> range between 1 and 45, with lower values indicating restriction of fate and higher values suggesting multipotentiality.</p></sec></sec><sec id="s4-15"><title>Network analysis of fate couplings</title><p>We define<disp-formula id="equ21"><mml:math id="m21"><mml:mrow><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>56</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mover><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mtext>56</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>;</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo accent="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>56</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mover><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mtext>56</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo accent="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msqrt><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>56</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mover><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mtext>56</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>;</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo accent="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:msqrt><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>56</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mover><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mtext>56</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>;</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo accent="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>as the fate coupling between RGC types <inline-formula><mml:math id="inf233"><mml:mi>α</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf234"><mml:mi>β</mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi></mml:math></inline-formula> at age <inline-formula><mml:math id="inf235"><mml:mi>t</mml:mi></mml:math></inline-formula>. Clearly, <inline-formula><mml:math id="inf236"><mml:mi>C</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> is simply the Pearson correlation coefficient between <inline-formula><mml:math id="inf237"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mn>56</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>α</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> and <inline-formula><mml:math id="inf238"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mn>56</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> , the probabilities that a cell <inline-formula><mml:math id="inf239"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is a precursor of <inline-formula><mml:math id="inf240"><mml:mi>α</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf241"><mml:mi>β</mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi></mml:math></inline-formula> precursor. Here,<disp-formula id="equ22"><mml:math id="m22"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>56</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>;</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>56</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>is the mean probability that a cell at age <italic>t</italic> is a precursor of type <inline-formula><mml:math id="inf242"><mml:mi>α</mml:mi></mml:math></inline-formula>. We computed <inline-formula><mml:math id="inf243"><mml:mi>C</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> across all 990 pairs of RGC types at each immature age <inline-formula><mml:math id="inf244"><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mi>E</mml:mi><mml:mn>13</mml:mn><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi>E</mml:mi><mml:mn>14</mml:mn><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi>P</mml:mi><mml:mn>5</mml:mn></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math></inline-formula> The values <inline-formula><mml:math id="inf245"><mml:mi>C</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi>E</mml:mi><mml:mn>13</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula> were used as edge weights to visualize the fate coupling network of RGC types using the force-directed layout method (<xref ref-type="bibr" rid="bib27">Fruchterman and Reingold, 1991</xref>) as implemented in the R package igraph. The node layout was computed using <inline-formula><mml:math id="inf246"><mml:mi>C</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi>E</mml:mi><mml:mn>13</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula> values. For other ages, the node layout at E13 was retained but the edges were replotted based on <inline-formula><mml:math id="inf247"><mml:mi>C</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> values at the corresponding age.</p><p>We computed a null distribution of <inline-formula><mml:math id="inf248"><mml:mi>C</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> by randomizing the values of <inline-formula><mml:math id="inf249"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mn>56</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>α</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> within each cell <inline-formula><mml:math id="inf250"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula> across types. The null values of <inline-formula><mml:math id="inf251"><mml:mi>C</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> rarely exceeded 0.1 and never exceeded 0.2, so only the edges with larger weights were visualized in <xref ref-type="fig" rid="fig5">Figure 5</xref>.</p></sec><sec id="s4-16"><title>Decay of pairwise couplings</title><p>For each pair of RGC types <inline-formula><mml:math id="inf252"><mml:mi>α</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf253"><mml:mi>β</mml:mi></mml:math></inline-formula>, we fitted a logistic equation to model the decay of pairwise couplings as<disp-formula id="equ23"><mml:math id="m23"><mml:mi>C</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mo>⁡</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>The values of <italic>t</italic> corresponding to E13, E14, E16, P0, and P5 were <italic>t</italic> = 0, 1, 3, 6, and 11, with <inline-formula><mml:math id="inf254"><mml:mi>C</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> computed as above. We also assumed that <inline-formula><mml:math id="inf255"><mml:mi>C</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> at <italic>t</italic> = 36, corresponding to P30. Thus, six data points were used to estimate two parameters for each of the 180 pairs of RGC types that had nonzero values of <inline-formula><mml:math id="inf256"><mml:mi>C</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> . The nls function from the R package <monospace>stats</monospace> was used to estimate <inline-formula><mml:math id="inf257"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf258"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> . The results are plotted in <xref ref-type="fig" rid="fig5">Figure 5f</xref>.</p></sec><sec id="s4-17"><title>Logistic modeling of specification and calculation of <inline-formula><mml:math id="inf259"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></title><p>We hypothesized that the specification of a type <inline-formula><mml:math id="inf260"><mml:mi>β</mml:mi></mml:math></inline-formula> corresponds to the localization of its precursors in transcriptomic space. The extent of localization for a RGC of type <inline-formula><mml:math id="inf261"><mml:mi>β</mml:mi></mml:math></inline-formula> across the time course was calculated as follows. At each age <italic>t</italic>, we identified the set of precursor RGCs <inline-formula><mml:math id="inf262"><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mo>(</mml:mo><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> showing the highest fate probability corresponding to type <inline-formula><mml:math id="inf263"><mml:mi>β</mml:mi></mml:math></inline-formula>:<disp-formula id="equ24"><mml:math id="m24"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>56</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>56</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>≠</mml:mo><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Next, we calculated how the precursors of <inline-formula><mml:math id="inf264"><mml:mi>β</mml:mi></mml:math></inline-formula> were distributed across clusters at time <italic>t</italic>. We computed the OFs (see above) of precursor cells for type <inline-formula><mml:math id="inf265"><mml:mi>β</mml:mi></mml:math></inline-formula> across all clusters <inline-formula><mml:math id="inf266"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> at a particular time <italic>t</italic> (<inline-formula><mml:math id="inf267"><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is the number of transcriptomically defined clusters at time <italic>t</italic>):<disp-formula id="equ25"><mml:math id="m25"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">#</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">∀</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>∈</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">#</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>∈</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>The localization score for each type <inline-formula><mml:math id="inf268"><mml:mi>β</mml:mi></mml:math></inline-formula> at a given time <italic>t</italic> was defined as<disp-formula id="equ26"><mml:math id="m26"><mml:mrow><mml:mi>L</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:msubsup><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>where the index <italic>k</italic> ranges over the number of clusters at time <italic>t</italic>. As defined, <inline-formula><mml:math id="inf269"><mml:mi>L</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is restricted to be between 0 and 1, with higher values representing a greater specification. We used a logistic model to approximate the localization of each type as<disp-formula id="equ27"><mml:math id="m27"><mml:mi>L</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mo>⁡</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mo>⁡</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>As in the previous section, the nls function was used to estimate the logistic parameters <inline-formula><mml:math id="inf270"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf271"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> . We consider a type <inline-formula><mml:math id="inf272"><mml:mi>β</mml:mi></mml:math></inline-formula> as specified if its specification crosses the line <inline-formula><mml:math id="inf273"><mml:mi>y</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn><mml:mi> </mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:math></inline-formula> . Thus, the specification time for a type <inline-formula><mml:math id="inf274"><mml:mi>β</mml:mi></mml:math></inline-formula> is defined as<disp-formula id="equ28"><mml:math id="m28"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi> </mml:mi><mml:mi>L</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>β</mml:mi><mml:mo>;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>≥</mml:mo><mml:mi>y</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></disp-formula></p><p>Note that, as defined, <inline-formula><mml:math id="inf275"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> can be any time point in the interval (E13, P30) corresponding to <inline-formula><mml:math id="inf276"><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo>(</mml:mo><mml:mn>0,36</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>.</p></sec><sec id="s4-18"><title>Inference of laterality in RGC types</title><p>To identify putative ipsilateral- and contralateral-specified RGC precursors at E13, we scored each precursor RGC based on their expression of bona fide ipsilateral genes (<italic>Zic2, Zic1,</italic> and <italic>Igfbp5</italic>) and bona fide contralateral genes (<italic>Isl2</italic>, <italic>Fgf12</italic>, <italic>Igf1</italic>) as in <xref ref-type="bibr" rid="bib92">Wang et al., 2016</xref>. We refer to these as I-RGC and C-RGC scores. Putative I-RGCs were those cells that expressed the I-RGC score at 1.5 standard deviations higher than the mean across all cells, and those that express the C-RGC score at 1.5 standard deviations lower than the mean across all cells. C-RGCs were defined analogously. Many cells did not express either of these marker sets as shown in <xref ref-type="fig" rid="fig7">Figure 7c</xref>. These are likely to be RGCs that have not declared their laterality or C-RGCs that are not defined by the expression of <italic>Isl2</italic>, <italic>Fgf12</italic>, and <italic>Igf1</italic>.</p><p>WOT was then used to compute the descendants of E13 I-RGCs at all subsequent ages through P56 using the <monospace>wot fates</monospace> command introduced above. These descendants were used for two purposes. First, we assessed the proportion of putative I-RGCs across types as in <xref ref-type="fig" rid="fig7">Figure 7d</xref>. We also performed a differential gene expression test between putative I-RGCs and the remaining RGCs at all ages, as shown in <xref ref-type="fig" rid="fig7">Figure 7e and f</xref> and <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1d and e</xref>.</p></sec><sec id="s4-19"><title>Comparison with previous retina scRNA-seq datasets</title><p>We compared our data with three scRNA-seq studies that profiled the whole retina during development:</p><list list-type="order"><list-item><p>(<xref ref-type="bibr" rid="bib17">Clark et al., 2019</xref>): Count matrices and cell-/gene-level annotations were downloaded from the author’s public repository <ext-link ext-link-type="uri" xlink:href="https://github.com/gofflab/developing_mouse_retina_scRNASeq">https://github.com/gofflab/developing_mouse_retina_scRNASeq</ext-link> (<xref ref-type="bibr" rid="bib31">Goff Lab, 2021</xref>). This dataset contains whole retinal cells sampled at 10 time points (E11, E12, E14, E16, E18, P0, P2, P5, P8, P14) with four of these (E14, E16, P0, P5) common with our study. We excluded P5 from our analysis as only N = 11 RGCs were identified by the authors at this time point.</p></list-item><list-item><p>(<xref ref-type="bibr" rid="bib50">Lo Giudice et al., 2019</xref>): Count matrix corresponding to E15.5 retinal cells was kindly provided by the authors.</p></list-item><list-item><p>(<xref ref-type="bibr" rid="bib71">Rheaume et al., 2018</xref>): Count matrix corresponding to P5 RGCs was downloaded from the online submission.</p></list-item></list><p>For consistency with our filtering parameters, we extracted cells based on a cutoff of 700 genes/cell from each of the above datasets. For the Clark et al. dataset, this selected 17,827 cells at E14, 1674 cells at E16, and 8343 cells at P0, respectively (N = 27,844 cells). In these samples, RGCs comprised 19, 28, and 0.45%. For the Giudice et al. dataset, this selected 5218 cells, of which 23% were RGCs.</p><p>The Rheaume et al. dataset was directly compared with P5 RGCs collected in this study using supervised classification (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1i</xref>). Clark et al. and Lo Giudice et al. data were combined with the retinal cells profiled in this study at corresponding time points (25,685 cells at E14; 21,274 cells at E16; and 23,251 cells at P0). Together, this resulted in a 14,350 genes × 103,272 cells expression matrix that was analyzed following the steps outlined previously. In the alignment step, cells from each combination of age and study were considered as a separate ‘batch.’ We visualized the transcriptional heterogeneity of the full dataset using UMAP and used the expression of canonical markers to confirm the co-clustering of cell classes in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> (<italic>Rbpms</italic> for RGCs, <italic>Tfap2b</italic> for ACs, <italic>Fgf15</italic> for RPCs, and <italic>Gngt2</italic> for RPCs).</p></sec><sec id="s4-20"><title>Data availability</title><p>All scRNA-seq data collected in this study were submitted to the Gene Expression Omnibus (GEO) under GSE185671. The data can be visualized on the Broad Institute’s Single Cell Portal under the identifier SCP1706.</p></sec><sec id="s4-21"><title>Code availability</title><p>The scripts (written in R) generated for this study are shared at <ext-link ext-link-type="uri" xlink:href="https://github.com/shekharlab/mouseRGCdev">https://github.com/shekharlab/mouseRGCdev</ext-link>, (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:c0459e5fd21b06247aea1c49b55e3dd691d8a5d9;origin=https://github.com/shekharlab/mouseRGCdev;visit=swh:1:snp:58bf7b67bd5b493c03bb11718a75b20536243730;anchor=swh:1:rev:ca6a97adabb7bc4ffb2fb1187c78cb277513665c">swh:1:rev:ca6a97adabb7bc4ffb2fb1187c78cb277513665c</ext-link>; <xref ref-type="bibr" rid="bib82">Shekhar, 2022</xref>).</p></sec></sec></body><back><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Formal analysis, Funding acquisition, Investigation, Methodology, Project administration, Resources, Software, Supervision, Validation, Visualization, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Formal analysis, Investigation, Methodology, Resources, Validation, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Formal analysis, Software, Visualization, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Investigation, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Formal analysis, Funding acquisition, Methodology, Project administration, Supervision, Visualization, Writing – original draft, Writing – review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>All animal experiments were approved by the Institutional Animal Care and Use Committees (IACUC) at Harvard University. Mice were maintained in pathogen-free facilities under standard housing conditions with continuous access to food and water. Animals used in this study include both males and females. A meta-analysis (not shown) did not show any systematic sex-related effects in either differentially expressed genes or cell-type proportions.</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-73809-transrepform1-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Sequencing data has been submitted under GSE185671. Reviewer token : evchicgutpqpnoj. Computational scripts are available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/shekharlab/mouseRGCdev">https://github.com/shekharlab/mouseRGCdev</ext-link>, (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:c0459e5fd21b06247aea1c49b55e3dd691d8a5d9;origin=https://github.com/shekharlab/mouseRGCdev;visit=swh:1:snp:58bf7b67bd5b493c03bb11718a75b20536243730;anchor=swh:1:rev:ca6a97adabb7bc4ffb2fb1187c78cb277513665c">swh:1:rev:ca6a97adabb7bc4ffb2fb1187c78cb277513665c</ext-link>).</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Shekhar</surname><given-names>K</given-names></name><name><surname>Whitney</surname><given-names>IE</given-names></name><name><surname>Butrus</surname><given-names>S</given-names></name><name><surname>Peng</surname><given-names>YR</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Diversification of multipotential postmitotic mouse retinal Diversification of multipotential postmitotic mouse retinal ganglion cell precursors into discrete types</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE185671">GSE185671</pub-id></element-citation></p><p>The following previously published dataset was used:</p><p><element-citation id="dataset2" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Tran</surname><given-names>NM</given-names></name><name><surname>Shekhar</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>Single-Cell Profiles of Retinal Ganglion Cells Differing in Resilience to Injury Reveal Neuroprotective Genes</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE137400">GSE137400</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>Funding for this study was provided by the National Institute of Health grants R37NS029169, R01EY022073 (JRS), NSF GRP DGE1752814 (SB), and R00EY028625 (KS), and startup funding from UC Berkeley (KS, SB). We are grateful to Prof. Seth Blackshaw for helpful suggestions on the preprint. We thank Joshua Hahn for valuable feedback.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baden</surname><given-names>T</given-names></name><name><surname>Berens</surname><given-names>P</given-names></name><name><surname>Franke</surname><given-names>K</given-names></name><name><surname>Román Rosón</surname><given-names>M</given-names></name><name><surname>Bethge</surname><given-names>M</given-names></name><name><surname>Euler</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The functional diversity of retinal ganglion cells in the mouse</article-title><source>Nature</source><volume>529</volume><fpage>345</fpage><lpage>350</lpage><pub-id pub-id-type="doi">10.1038/nature16468</pub-id><pub-id pub-id-type="pmid">26735013</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baden</surname><given-names>T</given-names></name><name><surname>Euler</surname><given-names>T</given-names></name><name><surname>Berens</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Understanding the retinal basis of vision across species</article-title><source>Nature Reviews. Neuroscience</source><volume>21</volume><fpage>5</fpage><lpage>20</lpage><pub-id pub-id-type="doi">10.1038/s41583-019-0242-1</pub-id><pub-id pub-id-type="pmid">31780820</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bae</surname><given-names>JA</given-names></name><name><surname>Mu</surname><given-names>S</given-names></name><name><surname>Kim</surname><given-names>JS</given-names></name><name><surname>Turner</surname><given-names>NL</given-names></name><name><surname>Tartavull</surname><given-names>I</given-names></name><name><surname>Kemnitz</surname><given-names>N</given-names></name><name><surname>Jordan</surname><given-names>CS</given-names></name><name><surname>Norton</surname><given-names>AD</given-names></name><name><surname>Silversmith</surname><given-names>WM</given-names></name><name><surname>Prentki</surname><given-names>R</given-names></name><name><surname>Sorek</surname><given-names>M</given-names></name><name><surname>David</surname><given-names>C</given-names></name><name><surname>Jones</surname><given-names>DL</given-names></name><name><surname>Bland</surname><given-names>D</given-names></name><name><surname>Sterling</surname><given-names>ALR</given-names></name><name><surname>Park</surname><given-names>J</given-names></name><name><surname>Briggman</surname><given-names>KL</given-names></name><name><surname>Seung</surname><given-names>HS</given-names></name><collab>Eyewirers</collab></person-group><year iso-8601-date="2018">2018</year><article-title>Digital Museum of Retinal Ganglion Cells with Dense Anatomy and Physiology</article-title><source>Cell</source><volume>173</volume><fpage>1293</fpage><lpage>1306</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2018.04.040</pub-id><pub-id pub-id-type="pmid">29775596</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baron</surname><given-names>CS</given-names></name><name><surname>van Oudenaarden</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Unravelling cellular relationships during development and regeneration using genetic lineage tracing</article-title><source>Nature Reviews. Molecular Cell Biology</source><volume>20</volume><fpage>753</fpage><lpage>765</lpage><pub-id pub-id-type="doi">10.1038/s41580-019-0186-3</pub-id><pub-id pub-id-type="pmid">31690888</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barres</surname><given-names>BA</given-names></name><name><surname>Silverstein</surname><given-names>BE</given-names></name><name><surname>Corey</surname><given-names>DP</given-names></name><name><surname>Chun</surname><given-names>LL</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>Immunological, morphological, and electrophysiological variation among retinal ganglion cells purified by panning</article-title><source>Neuron</source><volume>1</volume><fpage>791</fpage><lpage>803</lpage><pub-id pub-id-type="doi">10.1016/0896-6273(88)90127-4</pub-id><pub-id pub-id-type="pmid">2908449</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bassett</surname><given-names>EA</given-names></name><name><surname>Wallace</surname><given-names>VA</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Cell fate determination in the vertebrate retina</article-title><source>Trends in Neurosciences</source><volume>35</volume><fpage>565</fpage><lpage>573</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2012.05.004</pub-id><pub-id pub-id-type="pmid">22704732</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Becht</surname><given-names>E</given-names></name><name><surname>McInnes</surname><given-names>L</given-names></name><name><surname>Healy</surname><given-names>J</given-names></name><name><surname>Dutertre</surname><given-names>CA</given-names></name><name><surname>Kwok</surname><given-names>IWH</given-names></name><name><surname>Ng</surname><given-names>LG</given-names></name><name><surname>Ginhoux</surname><given-names>F</given-names></name><name><surname>Newell</surname><given-names>EW</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Dimensionality reduction for visualizing single-cell data using UMAP</article-title><source>Nature Biotechnology</source><volume>37</volume><fpage>38</fpage><lpage>44</lpage><pub-id pub-id-type="doi">10.1038/nbt.4314</pub-id><pub-id pub-id-type="pmid">30531897</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berson</surname><given-names>DM</given-names></name><name><surname>Dunn</surname><given-names>FA</given-names></name><name><surname>Takao</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Phototransduction by retinal ganglion cells that set the circadian clock</article-title><source>Science (New York, N.Y.)</source><volume>295</volume><fpage>1070</fpage><lpage>1073</lpage><pub-id pub-id-type="doi">10.1126/science.1067262</pub-id><pub-id pub-id-type="pmid">11834835</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blackshaw</surname><given-names>S</given-names></name><name><surname>Harpavat</surname><given-names>S</given-names></name><name><surname>Trimarchi</surname><given-names>J</given-names></name><name><surname>Cai</surname><given-names>L</given-names></name><name><surname>Huang</surname><given-names>H</given-names></name><name><surname>Kuo</surname><given-names>WP</given-names></name><name><surname>Weber</surname><given-names>G</given-names></name><name><surname>Lee</surname><given-names>K</given-names></name><name><surname>Fraioli</surname><given-names>RE</given-names></name><name><surname>Cho</surname><given-names>SH</given-names></name><name><surname>Yung</surname><given-names>R</given-names></name><name><surname>Asch</surname><given-names>E</given-names></name><name><surname>Ohno-Machado</surname><given-names>L</given-names></name><name><surname>Wong</surname><given-names>WH</given-names></name><name><surname>Cepko</surname><given-names>CL</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Genomic analysis of mouse retinal development</article-title><source>PLOS Biology</source><volume>2</volume><elocation-id>E247</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.0020247</pub-id><pub-id pub-id-type="pmid">15226823</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boije</surname><given-names>H</given-names></name><name><surname>MacDonald</surname><given-names>RB</given-names></name><name><surname>Harris</surname><given-names>WA</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Reconciling competence and transcriptional hierarchies with stochasticity in retinal lineages</article-title><source>Current Opinion in Neurobiology</source><volume>27</volume><fpage>68</fpage><lpage>74</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2014.02.014</pub-id><pub-id pub-id-type="pmid">24637222</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>NL</given-names></name><name><surname>Patel</surname><given-names>S</given-names></name><name><surname>Brzezinski</surname><given-names>J</given-names></name><name><surname>Glaser</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Math5 is required for retinal ganglion cell and optic nerve formation</article-title><source>Development (Cambridge, England)</source><volume>128</volume><fpage>2497</fpage><lpage>2508</lpage><pub-id pub-id-type="doi">10.1242/dev.128.13.2497</pub-id><pub-id pub-id-type="pmid">11493566</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cembrowski</surname><given-names>MS</given-names></name><name><surname>Spruston</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Heterogeneity within classical cell types is the rule: lessons from hippocampal pyramidal neurons</article-title><source>Nature Reviews. Neuroscience</source><volume>20</volume><fpage>193</fpage><lpage>204</lpage><pub-id pub-id-type="doi">10.1038/s41583-019-0125-5</pub-id><pub-id pub-id-type="pmid">30778192</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cepko</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Intrinsically different retinal progenitor cells produce specific types of progeny</article-title><source>Nature Reviews. Neuroscience</source><volume>15</volume><fpage>615</fpage><lpage>627</lpage><pub-id pub-id-type="doi">10.1038/nrn3767</pub-id><pub-id pub-id-type="pmid">25096185</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>S</given-names></name><name><surname>Wang</surname><given-names>QL</given-names></name><name><surname>Nie</surname><given-names>Z</given-names></name><name><surname>Sun</surname><given-names>H</given-names></name><name><surname>Lennon</surname><given-names>G</given-names></name><name><surname>Copeland</surname><given-names>NG</given-names></name><name><surname>Gilbert</surname><given-names>DJ</given-names></name><name><surname>Jenkins</surname><given-names>NA</given-names></name><name><surname>Zack</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Crx, a novel Otx-like paired-homeodomain protein, binds to and transactivates photoreceptor cell-specific genes</article-title><source>Neuron</source><volume>19</volume><fpage>1017</fpage><lpage>1030</lpage><pub-id pub-id-type="doi">10.1016/s0896-6273(00)80394-3</pub-id><pub-id pub-id-type="pmid">9390516</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>T.</given-names></name><name><surname>Guestrin</surname><given-names>C.</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Xgboost: A scalable tree boosting system</article-title><conf-name>Paper presented at the Proceedings of the 22nd acm sigkdd international conference on knowledge discovery and data mining</conf-name></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chizat</surname><given-names>L</given-names></name><name><surname>Peyré</surname><given-names>G</given-names></name><name><surname>Schmitzer</surname><given-names>B</given-names></name><name><surname>Vialard</surname><given-names>FX</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Scaling algorithms for unbalanced optimal transport problems</article-title><source>Mathematics of Computation</source><volume>87</volume><fpage>2563</fpage><lpage>2609</lpage><pub-id pub-id-type="doi">10.1090/mcom/3303</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clark</surname><given-names>BS</given-names></name><name><surname>Stein-O’Brien</surname><given-names>GL</given-names></name><name><surname>Shiau</surname><given-names>F</given-names></name><name><surname>Cannon</surname><given-names>GH</given-names></name><name><surname>Davis-Marcisak</surname><given-names>E</given-names></name><name><surname>Sherman</surname><given-names>T</given-names></name><name><surname>Santiago</surname><given-names>CP</given-names></name><name><surname>Hoang</surname><given-names>TV</given-names></name><name><surname>Rajaii</surname><given-names>F</given-names></name><name><surname>James-Esposito</surname><given-names>RE</given-names></name><name><surname>Gronostajski</surname><given-names>RM</given-names></name><name><surname>Fertig</surname><given-names>EJ</given-names></name><name><surname>Goff</surname><given-names>LA</given-names></name><name><surname>Blackshaw</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Single-Cell RNA-Seq Analysis of Retinal Development Identifies NFI Factors as Regulating Mitotic Exit and Late-Born Cell Specification</article-title><source>Neuron</source><volume>102</volume><fpage>1111</fpage><lpage>1126</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2019.04.010</pub-id><pub-id pub-id-type="pmid">31128945</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Demyanenko</surname><given-names>GP</given-names></name><name><surname>Maness</surname><given-names>PF</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>The L1 cell adhesion molecule is essential for topographic mapping of retinal axons</article-title><source>The Journal of Neuroscience</source><volume>23</volume><fpage>530</fpage><lpage>538</lpage><pub-id pub-id-type="pmid">12533613</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Di Bella</surname><given-names>DJ</given-names></name><name><surname>Habibi</surname><given-names>E</given-names></name><name><surname>Stickels</surname><given-names>RR</given-names></name><name><surname>Scalia</surname><given-names>G</given-names></name><name><surname>Brown</surname><given-names>J</given-names></name><name><surname>Yadollahpour</surname><given-names>P</given-names></name><name><surname>Yang</surname><given-names>SM</given-names></name><name><surname>Abbate</surname><given-names>C</given-names></name><name><surname>Biancalani</surname><given-names>T</given-names></name><name><surname>Macosko</surname><given-names>EZ</given-names></name><name><surname>Chen</surname><given-names>F</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Arlotta</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Molecular logic of cellular diversification in the mouse cerebral cortex</article-title><source>Nature</source><volume>595</volume><fpage>554</fpage><lpage>559</lpage><pub-id pub-id-type="doi">10.1038/s41586-021-03670-5</pub-id><pub-id pub-id-type="pmid">34163074</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Dowling</surname><given-names>JE</given-names></name></person-group><year iso-8601-date="2012">2012</year><source>The Retina: An Approachable Part of the Brain</source><edition>2nd ed</edition><publisher-name>Harvard University Press</publisher-name></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dräger</surname><given-names>UC</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>Birth dates of retinal ganglion cells giving rise to the crossed and uncrossed optic projections in the mouse</article-title><source>PNAS</source><volume>224</volume><fpage>57</fpage><lpage>77</lpage><pub-id pub-id-type="doi">10.1098/rspb.1985.0021</pub-id><pub-id pub-id-type="pmid">2581263</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Espinosa-Medina</surname><given-names>I</given-names></name><name><surname>Garcia-Marques</surname><given-names>J</given-names></name><name><surname>Cepko</surname><given-names>C</given-names></name><name><surname>Lee</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>High-throughput dense reconstruction of cell lineages</article-title><source>Open Biology</source><volume>9</volume><elocation-id>190229</elocation-id><pub-id pub-id-type="doi">10.1098/rsob.190229</pub-id><pub-id pub-id-type="pmid">31822210</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Famiglietti</surname><given-names>EV</given-names></name><name><surname>Kolb</surname><given-names>H</given-names></name></person-group><year iso-8601-date="1976">1976</year><article-title>Structural basis for ON-and OFF-center responses in retinal ganglion cells</article-title><source>Science (New York, N.Y.)</source><volume>194</volume><fpage>193</fpage><lpage>195</lpage><pub-id pub-id-type="doi">10.1126/science.959847</pub-id><pub-id pub-id-type="pmid">959847</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farah</surname><given-names>MH</given-names></name><name><surname>Easter</surname><given-names>SS</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Cell birth and death in the mouse retinal ganglion cell layer</article-title><source>The Journal of Comparative Neurology</source><volume>489</volume><fpage>120</fpage><lpage>134</lpage><pub-id pub-id-type="doi">10.1002/cne.20615</pub-id><pub-id pub-id-type="pmid">15977166</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Finak</surname><given-names>G</given-names></name><name><surname>McDavid</surname><given-names>A</given-names></name><name><surname>Yajima</surname><given-names>M</given-names></name><name><surname>Deng</surname><given-names>J</given-names></name><name><surname>Gersuk</surname><given-names>V</given-names></name><name><surname>Shalek</surname><given-names>AK</given-names></name><name><surname>Slichter</surname><given-names>CK</given-names></name><name><surname>Miller</surname><given-names>HW</given-names></name><name><surname>McElrath</surname><given-names>MJ</given-names></name><name><surname>Prlic</surname><given-names>M</given-names></name><name><surname>Linsley</surname><given-names>PS</given-names></name><name><surname>Gottardo</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title><source>Genome Biology</source><volume>16</volume><elocation-id>278</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-015-0844-5</pub-id><pub-id pub-id-type="pmid">26653891</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franke</surname><given-names>K</given-names></name><name><surname>Berens</surname><given-names>P</given-names></name><name><surname>Schubert</surname><given-names>T</given-names></name><name><surname>Bethge</surname><given-names>M</given-names></name><name><surname>Euler</surname><given-names>T</given-names></name><name><surname>Baden</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Inhibition decorrelates visual feature representations in the inner retina</article-title><source>Nature</source><volume>542</volume><fpage>439</fpage><lpage>444</lpage><pub-id pub-id-type="doi">10.1038/nature21394</pub-id><pub-id pub-id-type="pmid">28178238</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fruchterman</surname><given-names>TMJ</given-names></name><name><surname>Reingold</surname><given-names>EM</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Graph drawing by force-directed placement</article-title><source>Software</source><volume>21</volume><fpage>1129</fpage><lpage>1164</lpage><pub-id pub-id-type="doi">10.1002/spe.4380211102</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fyodorov</surname><given-names>YV</given-names></name><name><surname>Mirlin</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Analytical derivation of the scaling law for the inverse participation ratio in quasi-one-dimensional disordered systems</article-title><source>Physical Review Letters</source><volume>69</volume><fpage>1093</fpage><lpage>1096</lpage><pub-id pub-id-type="doi">10.1103/PhysRevLett.69.1093</pub-id><pub-id pub-id-type="pmid">10047121</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Godement</surname><given-names>P</given-names></name><name><surname>Salaün</surname><given-names>J</given-names></name><name><surname>Imbert</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1984">1984</year><article-title>Prenatal and postnatal development of retinogeniculate and retinocollicular projections in the mouse</article-title><source>The Journal of Comparative Neurology</source><volume>230</volume><fpage>552</fpage><lpage>575</lpage><pub-id pub-id-type="doi">10.1002/cne.902300406</pub-id><pub-id pub-id-type="pmid">6520251</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goetz</surname><given-names>J</given-names></name><name><surname>Jessen</surname><given-names>ZF</given-names></name><name><surname>Jacobi</surname><given-names>A</given-names></name><name><surname>Mani</surname><given-names>A</given-names></name><name><surname>Cooler</surname><given-names>S</given-names></name><name><surname>Greer</surname><given-names>D</given-names></name><name><surname>Kadri</surname><given-names>S</given-names></name><name><surname>Segal</surname><given-names>J</given-names></name><name><surname>Shekhar</surname><given-names>K</given-names></name><name><surname>Sanes</surname><given-names>J</given-names></name><name><surname>Schwartz</surname><given-names>GW</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Unified Classification of Mouse Retinal Ganglion Cells Using Function, Morphology, and Gene Expression</article-title><source>SSRN Electronic Journal</source><volume>4</volume><elocation-id>3867730</elocation-id><pub-id pub-id-type="doi">10.2139/ssrn.3867730</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="software"><person-group person-group-type="author"><collab>Goff Lab</collab></person-group><year iso-8601-date="2021">2021</year><data-title>developing_mouse_retina_scRNASeq</data-title><version designator="3bfeea2">3bfeea2</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/gofflab/developing_mouse_retina_scRNASeq">https://github.com/gofflab/developing_mouse_retina_scRNASeq</ext-link></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gomes</surname><given-names>FLAF</given-names></name><name><surname>Zhang</surname><given-names>G</given-names></name><name><surname>Carbonell</surname><given-names>F</given-names></name><name><surname>Correa</surname><given-names>JA</given-names></name><name><surname>Harris</surname><given-names>WA</given-names></name><name><surname>Simons</surname><given-names>BD</given-names></name><name><surname>Cayouette</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Reconstruction of rat retinal progenitor cell lineages in vitro reveals a surprising degree of stochasticity in cell fate decisions</article-title><source>Development (Cambridge, England)</source><volume>138</volume><fpage>227</fpage><lpage>235</lpage><pub-id pub-id-type="doi">10.1242/dev.059683</pub-id><pub-id pub-id-type="pmid">21148186</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Herrera</surname><given-names>E</given-names></name><name><surname>Brown</surname><given-names>L</given-names></name><name><surname>Aruga</surname><given-names>J</given-names></name><name><surname>Rachel</surname><given-names>RA</given-names></name><name><surname>Dolen</surname><given-names>G</given-names></name><name><surname>Mikoshiba</surname><given-names>K</given-names></name><name><surname>Brown</surname><given-names>S</given-names></name><name><surname>Mason</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Zic2 patterns binocular vision by specifying the uncrossed retinal projection</article-title><source>Cell</source><volume>114</volume><fpage>545</fpage><lpage>557</lpage><pub-id pub-id-type="doi">10.1016/s0092-8674(03)00684-6</pub-id><pub-id pub-id-type="pmid">13678579</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holguera</surname><given-names>I</given-names></name><name><surname>Desplan</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Neuronal specification in space and time</article-title><source>Science (New York, N.Y.)</source><volume>362</volume><fpage>176</fpage><lpage>180</lpage><pub-id pub-id-type="doi">10.1126/science.aas9435</pub-id><pub-id pub-id-type="pmid">30309944</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holt</surname><given-names>CE</given-names></name><name><surname>Bertsch</surname><given-names>TW</given-names></name><name><surname>Ellis</surname><given-names>HM</given-names></name><name><surname>Harris</surname><given-names>WA</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>Cellular determination in the <italic>Xenopus</italic> retina is independent of lineage and birth date</article-title><source>Neuron</source><volume>1</volume><fpage>15</fpage><lpage>26</lpage><pub-id pub-id-type="doi">10.1016/0896-6273(88)90205-x</pub-id><pub-id pub-id-type="pmid">3272153</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hong</surname><given-names>YK</given-names></name><name><surname>Kim</surname><given-names>IJ</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Stereotyped axonal arbors of retinal ganglion cell subsets in the mouse superior colliculus</article-title><source>The Journal of Comparative Neurology</source><volume>519</volume><fpage>1691</fpage><lpage>1711</lpage><pub-id pub-id-type="doi">10.1002/cne.22595</pub-id><pub-id pub-id-type="pmid">21452242</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hooks</surname><given-names>BM</given-names></name><name><surname>Chen</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Circuitry Underlying Experience-Dependent Plasticity in the Mouse Visual System</article-title><source>Neuron</source><volume>107</volume><fpage>986</fpage><lpage>987</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2020.08.004</pub-id><pub-id pub-id-type="pmid">32910891</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jeon</surname><given-names>CJ</given-names></name><name><surname>Strettoi</surname><given-names>E</given-names></name><name><surname>Masland</surname><given-names>RH</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>The major cell populations of the mouse retina</article-title><source>The Journal of Neuroscience</source><volume>18</volume><fpage>8936</fpage><lpage>8946</lpage><pub-id pub-id-type="pmid">9786999</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>KP</given-names></name><name><surname>Fitzpatrick</surname><given-names>MJ</given-names></name><name><surname>Zhao</surname><given-names>L</given-names></name><name><surname>Wang</surname><given-names>B</given-names></name><name><surname>McCracken</surname><given-names>S</given-names></name><name><surname>Williams</surname><given-names>PR</given-names></name><name><surname>Kerschensteiner</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Cell-type-specific binocular vision guides predation in mice</article-title><source>Neuron</source><volume>109</volume><fpage>1527</fpage><lpage>1539</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2021.03.010</pub-id><pub-id pub-id-type="pmid">33784498</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnston</surname><given-names>RJ</given-names></name><name><surname>Desplan</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Stochastic mechanisms of cell fate specification that yield random or robust outcomes</article-title><source>Annual Review of Cell and Developmental Biology</source><volume>26</volume><fpage>689</fpage><lpage>719</lpage><pub-id pub-id-type="doi">10.1146/annurev-cellbio-100109-104113</pub-id><pub-id pub-id-type="pmid">20590453</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kantorovich</surname><given-names>LV</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>On the Translocation of Masses</article-title><source>Journal of Mathematical Sciences</source><volume>133</volume><fpage>1381</fpage><lpage>1382</lpage><pub-id pub-id-type="doi">10.1007/s10958-006-0049-2</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kay</surname><given-names>JN</given-names></name><name><surname>Huerta</surname><given-names>I</given-names></name><name><surname>Kim</surname><given-names>IJ</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Yamagata</surname><given-names>M</given-names></name><name><surname>Chu</surname><given-names>MW</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Retinal ganglion cells with distinct directional preferences differ in molecular identity, structure, and central projections</article-title><source>The Journal of Neuroscience</source><volume>31</volume><fpage>7753</fpage><lpage>7762</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0907-11.2011</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kay</surname><given-names>JN</given-names></name><name><surname>Chu</surname><given-names>MW</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>MEGF10 and MEGF11 mediate homotypic interactions required for mosaic spacing of retinal neurons</article-title><source>Nature</source><volume>483</volume><fpage>465</fpage><lpage>469</lpage><pub-id pub-id-type="doi">10.1038/nature10877</pub-id><pub-id pub-id-type="pmid">22407321</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keeley</surname><given-names>PW</given-names></name><name><surname>Eglen</surname><given-names>SJ</given-names></name><name><surname>Reese</surname><given-names>BE</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>From random to regular: Variation in the patterning of retinal mosaics</article-title><source>The Journal of Comparative Neurology</source><volume>528</volume><fpage>2135</fpage><lpage>2160</lpage><pub-id pub-id-type="doi">10.1002/cne.24880</pub-id><pub-id pub-id-type="pmid">32026463</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>IJ</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Meister</surname><given-names>M</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Laminar restriction of retinal ganglion cell dendrites and axons: subtype-specific developmental patterns revealed with transgenic markers</article-title><source>The Journal of Neuroscience</source><volume>30</volume><fpage>1452</fpage><lpage>1462</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4779-09.2010</pub-id><pub-id pub-id-type="pmid">20107072</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kiyama</surname><given-names>T</given-names></name><name><surname>Long</surname><given-names>Y</given-names></name><name><surname>Chen</surname><given-names>C-K</given-names></name><name><surname>Whitaker</surname><given-names>CM</given-names></name><name><surname>Shay</surname><given-names>A</given-names></name><name><surname>Wu</surname><given-names>H</given-names></name><name><surname>Badea</surname><given-names>TC</given-names></name><name><surname>Mohsenin</surname><given-names>A</given-names></name><name><surname>Parker-Thornburg</surname><given-names>J</given-names></name><name><surname>Klein</surname><given-names>WH</given-names></name><name><surname>Mills</surname><given-names>SL</given-names></name><name><surname>Massey</surname><given-names>SC</given-names></name><name><surname>Mao</surname><given-names>C-A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Essential Roles of Tbr1 in the Formation and Maintenance of the Orientation-Selective J-RGCs and a Group of OFF-Sustained RGCs in Mouse</article-title><source>Cell Reports</source><volume>27</volume><fpage>900</fpage><lpage>915</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2019.03.077</pub-id><pub-id pub-id-type="pmid">30995485</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lefebvre</surname><given-names>JL</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name><name><surname>Kay</surname><given-names>JN</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Development of dendritic form and function</article-title><source>Annual Review of Cell and Developmental Biology</source><volume>31</volume><fpage>741</fpage><lpage>777</lpage><pub-id pub-id-type="doi">10.1146/annurev-cellbio-100913-013020</pub-id><pub-id pub-id-type="pmid">26422333</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Reggiani</surname><given-names>JDS</given-names></name><name><surname>Laboulaye</surname><given-names>MA</given-names></name><name><surname>Pandey</surname><given-names>S</given-names></name><name><surname>Chen</surname><given-names>B</given-names></name><name><surname>Rubenstein</surname><given-names>JLR</given-names></name><name><surname>Krishnaswamy</surname><given-names>A</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Tbr1 instructs laminar patterning of retinal ganglion cell dendrites</article-title><source>Nature Neuroscience</source><volume>21</volume><fpage>659</fpage><lpage>670</lpage><pub-id pub-id-type="doi">10.1038/s41593-018-0127-z</pub-id><pub-id pub-id-type="pmid">29632360</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Livesey</surname><given-names>FJ</given-names></name><name><surname>Cepko</surname><given-names>CL</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Vertebrate neural cell-fate determination: lessons from the retina</article-title><source>Nature Reviews. Neuroscience</source><volume>2</volume><fpage>109</fpage><lpage>118</lpage><pub-id pub-id-type="doi">10.1038/35053522</pub-id><pub-id pub-id-type="pmid">11252990</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lo Giudice</surname><given-names>Q</given-names></name><name><surname>Leleu</surname><given-names>M</given-names></name><name><surname>La Manno</surname><given-names>G</given-names></name><name><surname>Fabre</surname><given-names>PJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Single-cell transcriptional logic of cell-fate specification and axon guidance in early-born retinal neurons</article-title><source>Development (Cambridge, England)</source><volume>146</volume><elocation-id>17</elocation-id><pub-id pub-id-type="doi">10.1242/dev.178103</pub-id><pub-id pub-id-type="pmid">31399471</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lodato</surname><given-names>S</given-names></name><name><surname>Arlotta</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Generating neuronal diversity in the mammalian cerebral cortex</article-title><source>Annual Review of Cell and Developmental Biology</source><volume>31</volume><fpage>699</fpage><lpage>720</lpage><pub-id pub-id-type="doi">10.1146/annurev-cellbio-100814-125353</pub-id><pub-id pub-id-type="pmid">26359774</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lyu</surname><given-names>J</given-names></name><name><surname>Mu</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Genetic control of retinal ganglion cell genesis</article-title><source>Cellular and Molecular Life Sciences</source><volume>78</volume><fpage>4417</fpage><lpage>4433</lpage><pub-id pub-id-type="doi">10.1007/s00018-021-03814-w</pub-id><pub-id pub-id-type="pmid">33782712</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Macosko</surname><given-names>EZ</given-names></name><name><surname>Basu</surname><given-names>A</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name><name><surname>Nemesh</surname><given-names>J</given-names></name><name><surname>Shekhar</surname><given-names>K</given-names></name><name><surname>Goldman</surname><given-names>M</given-names></name><name><surname>Tirosh</surname><given-names>I</given-names></name><name><surname>Bialas</surname><given-names>AR</given-names></name><name><surname>Kamitaki</surname><given-names>N</given-names></name><name><surname>Martersteck</surname><given-names>EM</given-names></name><name><surname>Trombetta</surname><given-names>JJ</given-names></name><name><surname>Weitz</surname><given-names>DA</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name><name><surname>Shalek</surname><given-names>AK</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>McCarroll</surname><given-names>SA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Highly Parallel Genome-wide Expression Profiling of Individual Cells Using Nanoliter Droplets</article-title><source>Cell</source><volume>161</volume><fpage>1202</fpage><lpage>1214</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id><pub-id pub-id-type="pmid">26000488</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mao</surname><given-names>C-A</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Kiyama</surname><given-names>T</given-names></name><name><surname>Panda</surname><given-names>S</given-names></name><name><surname>Hattar</surname><given-names>S</given-names></name><name><surname>Ribelayga</surname><given-names>CP</given-names></name><name><surname>Mills</surname><given-names>SL</given-names></name><name><surname>Wang</surname><given-names>SW</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>T-box transcription regulator Tbr2 is essential for the formation and maintenance of Opn4/melanopsin-expressing intrinsically photosensitive retinal ganglion cells</article-title><source>The Journal of Neuroscience</source><volume>34</volume><fpage>13083</fpage><lpage>13095</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1027-14.2014</pub-id><pub-id pub-id-type="pmid">25253855</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Mao</surname><given-names>CA</given-names></name><name><surname>Chen</surname><given-names>CK</given-names></name><name><surname>Kiyama</surname><given-names>T</given-names></name><name><surname>Weber</surname><given-names>N</given-names></name><name><surname>Whitaker</surname><given-names>CM</given-names></name><name><surname>Pan</surname><given-names>P</given-names></name><name><surname>Badea</surname><given-names>TC</given-names></name><name><surname>Massey</surname><given-names>SC</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Tbr2-Expressing Retinal Ganglion Cells Are IpRGCs</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.06.17.153551</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marcucci</surname><given-names>F</given-names></name><name><surname>Soares</surname><given-names>CA</given-names></name><name><surname>Mason</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Distinct timing of neurogenesis of ipsilateral and contralateral retinal ganglion cells</article-title><source>The Journal of Comparative Neurology</source><volume>527</volume><fpage>212</fpage><lpage>224</lpage><pub-id pub-id-type="doi">10.1002/cne.24467</pub-id><pub-id pub-id-type="pmid">29761490</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marquardt</surname><given-names>T</given-names></name><name><surname>Gruss</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Generating neuronal diversity in the retina: one for nearly all</article-title><source>Trends in Neurosciences</source><volume>25</volume><fpage>32</fpage><lpage>38</lpage><pub-id pub-id-type="doi">10.1016/s0166-2236(00)02028-2</pub-id><pub-id pub-id-type="pmid">11801336</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martersteck</surname><given-names>EM</given-names></name><name><surname>Hirokawa</surname><given-names>KE</given-names></name><name><surname>Evarts</surname><given-names>M</given-names></name><name><surname>Bernard</surname><given-names>A</given-names></name><name><surname>Duan</surname><given-names>X</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Ng</surname><given-names>L</given-names></name><name><surname>Oh</surname><given-names>SW</given-names></name><name><surname>Ouellette</surname><given-names>B</given-names></name><name><surname>Royall</surname><given-names>JJ</given-names></name><name><surname>Stoecklin</surname><given-names>M</given-names></name><name><surname>Wang</surname><given-names>Q</given-names></name><name><surname>Zeng</surname><given-names>H</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name><name><surname>Harris</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Diverse Central Projection Patterns of Retinal Ganglion Cells</article-title><source>Cell Reports</source><volume>18</volume><fpage>2058</fpage><lpage>2072</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2017.01.075</pub-id><pub-id pub-id-type="pmid">28228269</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Masland</surname><given-names>RH</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The neuronal organization of the retina</article-title><source>Neuron</source><volume>76</volume><fpage>266</fpage><lpage>280</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.10.002</pub-id><pub-id pub-id-type="pmid">23083731</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mason</surname><given-names>C</given-names></name><name><surname>Slavi</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Retinal Ganglion Cell Axon Wiring Establishing the Binocular Circuit</article-title><source>Annual Review of Vision Science</source><volume>6</volume><fpage>215</fpage><lpage>236</lpage><pub-id pub-id-type="doi">10.1146/annurev-vision-091517-034306</pub-id><pub-id pub-id-type="pmid">32396770</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McConnell</surname><given-names>SK</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>The generation of neuronal diversity in the central nervous system</article-title><source>Annual Review of Neuroscience</source><volume>14</volume><fpage>269</fpage><lpage>300</lpage><pub-id pub-id-type="doi">10.1146/annurev.ne.14.030191.001413</pub-id><pub-id pub-id-type="pmid">2031572</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKenna</surname><given-names>A</given-names></name><name><surname>Findlay</surname><given-names>GM</given-names></name><name><surname>Gagnon</surname><given-names>JA</given-names></name><name><surname>Horwitz</surname><given-names>MS</given-names></name><name><surname>Schier</surname><given-names>AF</given-names></name><name><surname>Shendure</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Whole-organism lineage tracing by combinatorial and cumulative genome editing</article-title><source>Science (New York, N.Y.)</source><volume>353</volume><elocation-id>aaf7907</elocation-id><pub-id pub-id-type="doi">10.1126/science.aaf7907</pub-id><pub-id pub-id-type="pmid">27229144</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McNeill</surname><given-names>DS</given-names></name><name><surname>Sheely</surname><given-names>CJ</given-names></name><name><surname>Ecker</surname><given-names>JL</given-names></name><name><surname>Badea</surname><given-names>TC</given-names></name><name><surname>Morhardt</surname><given-names>D</given-names></name><name><surname>Guido</surname><given-names>W</given-names></name><name><surname>Hattar</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Development of melanopsin-based irradiance detecting circuitry</article-title><source>Neural Development</source><volume>6</volume><elocation-id>8</elocation-id><pub-id pub-id-type="doi">10.1186/1749-8104-6-8</pub-id><pub-id pub-id-type="pmid">21418557</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Monge</surname><given-names>G</given-names></name></person-group><year iso-8601-date="1781">1781</year><source>Mémoire Sur La Théorie Des Déblais et Des Remblais</source><publisher-loc>Paris, France</publisher-loc><publisher-name>De l’Imprimerie Royale</publisher-name></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Osterhout</surname><given-names>JA</given-names></name><name><surname>Josten</surname><given-names>N</given-names></name><name><surname>Yamada</surname><given-names>J</given-names></name><name><surname>Pan</surname><given-names>F</given-names></name><name><surname>Wu</surname><given-names>S</given-names></name><name><surname>Nguyen</surname><given-names>PL</given-names></name><name><surname>Panagiotakos</surname><given-names>G</given-names></name><name><surname>Inoue</surname><given-names>YU</given-names></name><name><surname>Egusa</surname><given-names>SF</given-names></name><name><surname>Volgyi</surname><given-names>B</given-names></name><name><surname>Inoue</surname><given-names>T</given-names></name><name><surname>Bloomfield</surname><given-names>SA</given-names></name><name><surname>Barres</surname><given-names>BA</given-names></name><name><surname>Berson</surname><given-names>DM</given-names></name><name><surname>Feldheim</surname><given-names>DA</given-names></name><name><surname>Huberman</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Cadherin-6 mediates axon-target matching in a non-image-forming visual circuit</article-title><source>Neuron</source><volume>71</volume><fpage>632</fpage><lpage>639</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.07.006</pub-id><pub-id pub-id-type="pmid">21867880</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pak</surname><given-names>W</given-names></name><name><surname>Hindges</surname><given-names>R</given-names></name><name><surname>Lim</surname><given-names>Y-S</given-names></name><name><surname>Pfaff</surname><given-names>SL</given-names></name><name><surname>O’Leary</surname><given-names>DDM</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Magnitude of binocular vision controlled by islet-2 repression of a genetic program that specifies laterality of retinal axon pathfinding</article-title><source>Cell</source><volume>119</volume><fpage>567</fpage><lpage>578</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2004.10.026</pub-id><pub-id pub-id-type="pmid">15537545</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pandey</surname><given-names>S</given-names></name><name><surname>Shekhar</surname><given-names>K</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Schier</surname><given-names>AF</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Comprehensive identification and spatial mapping of habenular neuronal types using single-cell RNA-seq</article-title><source>Current Biology</source><volume>28</volume><fpage>1052</fpage><lpage>1065</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2018.02.040</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peng</surname><given-names>YR</given-names></name><name><surname>Tran</surname><given-names>NM</given-names></name><name><surname>Krishnaswamy</surname><given-names>A</given-names></name><name><surname>Kostadinov</surname><given-names>D</given-names></name><name><surname>Martersteck</surname><given-names>EM</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Satb1 Regulates Contactin 5 to Pattern Dendrites of a Mammalian Retinal Ganglion Cell</article-title><source>Neuron</source><volume>95</volume><fpage>869</fpage><lpage>883</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.07.019</pub-id><pub-id pub-id-type="pmid">28781169</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peng</surname><given-names>Y-R</given-names></name><name><surname>Shekhar</surname><given-names>K</given-names></name><name><surname>Yan</surname><given-names>W</given-names></name><name><surname>Herrmann</surname><given-names>D</given-names></name><name><surname>Sappington</surname><given-names>A</given-names></name><name><surname>Bryman</surname><given-names>GS</given-names></name><name><surname>van Zyl</surname><given-names>T</given-names></name><name><surname>Do</surname><given-names>MTH</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Molecular classification and comparative taxonomics of foveal and peripheral cells in primate retina</article-title><source>Cell</source><volume>176</volume><fpage>1222</fpage><lpage>1237</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2019.01.004</pub-id><pub-id pub-id-type="pmid">30712875</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Price</surname><given-names>J</given-names></name><name><surname>Turner</surname><given-names>D</given-names></name><name><surname>Cepko</surname><given-names>C</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Lineage analysis in the vertebrate nervous system by retrovirus-mediated gene transfer</article-title><source>PNAS</source><volume>84</volume><fpage>156</fpage><lpage>160</lpage><pub-id pub-id-type="doi">10.1073/pnas.84.1.156</pub-id><pub-id pub-id-type="pmid">3099292</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rheaume</surname><given-names>BA</given-names></name><name><surname>Jereen</surname><given-names>A</given-names></name><name><surname>Bolisetty</surname><given-names>M</given-names></name><name><surname>Sajid</surname><given-names>MS</given-names></name><name><surname>Yang</surname><given-names>Y</given-names></name><name><surname>Renna</surname><given-names>K</given-names></name><name><surname>Sun</surname><given-names>L</given-names></name><name><surname>Robson</surname><given-names>P</given-names></name><name><surname>Trakhtenberg</surname><given-names>EF</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Single cell transcriptome profiling of retinal ganglion cells identifies cellular subtypes</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>2759</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-05134-3</pub-id><pub-id pub-id-type="pmid">30018341</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rockhill</surname><given-names>RL</given-names></name><name><surname>Euler</surname><given-names>T</given-names></name><name><surname>Masland</surname><given-names>RH</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Spatial order within but not between types of retinal neurons</article-title><source>PNAS</source><volume>97</volume><fpage>2303</fpage><lpage>2307</lpage><pub-id pub-id-type="doi">10.1073/pnas.030413497</pub-id><pub-id pub-id-type="pmid">10688875</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rousso</surname><given-names>DL</given-names></name><name><surname>Qiao</surname><given-names>M</given-names></name><name><surname>Kagan</surname><given-names>RD</given-names></name><name><surname>Yamagata</surname><given-names>M</given-names></name><name><surname>Palmiter</surname><given-names>RD</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Two Pairs of ON and OFF Retinal Ganglion Cells Are Defined by Intersectional Patterns of Transcription Factor Expression</article-title><source>Cell Reports</source><volume>15</volume><fpage>1930</fpage><lpage>1944</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2016.04.069</pub-id><pub-id pub-id-type="pmid">27210758</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sagner</surname><given-names>A</given-names></name><name><surname>Briscoe</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Establishing neuronal diversity in the spinal cord: a time and a place</article-title><source>Development (Cambridge, England)</source><volume>146</volume><elocation-id>22</elocation-id><pub-id pub-id-type="doi">10.1242/dev.182154</pub-id><pub-id pub-id-type="pmid">31767567</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sajgo</surname><given-names>S</given-names></name><name><surname>Ghinia</surname><given-names>MG</given-names></name><name><surname>Brooks</surname><given-names>M</given-names></name><name><surname>Kretschmer</surname><given-names>F</given-names></name><name><surname>Chuang</surname><given-names>K</given-names></name><name><surname>Hiriyanna</surname><given-names>S</given-names></name><name><surname>Wu</surname><given-names>Z</given-names></name><name><surname>Popescu</surname><given-names>O</given-names></name><name><surname>Badea</surname><given-names>TC</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Molecular codes for cell type specification in Brn3 retinal ganglion cells</article-title><source>PNAS</source><volume>114</volume><fpage>E3974</fpage><lpage>E3983</lpage><pub-id pub-id-type="doi">10.1073/pnas.1618551114</pub-id><pub-id pub-id-type="pmid">28465430</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanes</surname><given-names>JR</given-names></name><name><surname>Rubenstein</surname><given-names>JL</given-names></name><name><surname>Nicolas</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Use of a recombinant retrovirus to study post-implantation cell lineage in mouse embryos</article-title><source>The EMBO Journal</source><volume>5</volume><fpage>3133</fpage><lpage>3142</lpage><pub-id pub-id-type="pmid">3102226</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanes</surname><given-names>JR</given-names></name><name><surname>Masland</surname><given-names>RH</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The types of retinal ganglion cells: current status and implications for neuronal classification</article-title><source>Annual Review of Neuroscience</source><volume>38</volume><fpage>221</fpage><lpage>246</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-071714-034120</pub-id><pub-id pub-id-type="pmid">25897874</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schiebinger</surname><given-names>G</given-names></name><name><surname>Shu</surname><given-names>J</given-names></name><name><surname>Tabaka</surname><given-names>M</given-names></name><name><surname>Cleary</surname><given-names>B</given-names></name><name><surname>Subramanian</surname><given-names>V</given-names></name><name><surname>Solomon</surname><given-names>A</given-names></name><name><surname>Gould</surname><given-names>J</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Lin</surname><given-names>S</given-names></name><name><surname>Berube</surname><given-names>P</given-names></name><name><surname>Lee</surname><given-names>L</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Brumbaugh</surname><given-names>J</given-names></name><name><surname>Rigollet</surname><given-names>P</given-names></name><name><surname>Hochedlinger</surname><given-names>K</given-names></name><name><surname>Jaenisch</surname><given-names>R</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Lander</surname><given-names>ES</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Optimal-Transport Analysis of Single-Cell Gene Expression Identifies Developmental Trajectories in Reprogramming</article-title><source>Cell</source><volume>176</volume><elocation-id>1517</elocation-id><pub-id pub-id-type="doi">10.1016/j.cell.2019.02.026</pub-id><pub-id pub-id-type="pmid">30849376</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sharma</surname><given-names>N</given-names></name><name><surname>Flaherty</surname><given-names>K</given-names></name><name><surname>Lezgiyeva</surname><given-names>K</given-names></name><name><surname>Wagner</surname><given-names>DE</given-names></name><name><surname>Klein</surname><given-names>AM</given-names></name><name><surname>Ginty</surname><given-names>DD</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The emergence of transcriptional identity in somatosensory neurons</article-title><source>Nature</source><volume>577</volume><fpage>392</fpage><lpage>398</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-1900-1</pub-id><pub-id pub-id-type="pmid">31915380</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shekhar</surname><given-names>K</given-names></name><name><surname>Lapan</surname><given-names>SW</given-names></name><name><surname>Whitney</surname><given-names>IE</given-names></name><name><surname>Tran</surname><given-names>NM</given-names></name><name><surname>Macosko</surname><given-names>EZ</given-names></name><name><surname>Kowalczyk</surname><given-names>M</given-names></name><name><surname>Adiconis</surname><given-names>X</given-names></name><name><surname>Levin</surname><given-names>JZ</given-names></name><name><surname>Nemesh</surname><given-names>J</given-names></name><name><surname>Goldman</surname><given-names>M</given-names></name><name><surname>McCarroll</surname><given-names>SA</given-names></name><name><surname>Cepko</surname><given-names>CL</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Comprehensive Classification of Retinal Bipolar Neurons by Single-Cell Transcriptomics</article-title><source>Cell</source><volume>166</volume><fpage>1308</fpage><lpage>1323</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2016.07.054</pub-id><pub-id pub-id-type="pmid">27565351</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shekhar</surname><given-names>K.</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Generating and Using Transcriptomically Based Retinal Cell Atlases</article-title><source>Annual Review of Vision Science</source><volume>7</volume><fpage>43</fpage><lpage>72</lpage><pub-id pub-id-type="doi">10.1146/annurev-vision-032621-075200</pub-id><pub-id pub-id-type="pmid">34228938</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Shekhar</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>mouseRGCdev</data-title><version designator="swh:1:rev:ca6a97adabb7bc4ffb2fb1187c78cb277513665c">swh:1:rev:ca6a97adabb7bc4ffb2fb1187c78cb277513665c</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:c0459e5fd21b06247aea1c49b55e3dd691d8a5d9;origin=https://github.com/shekharlab/mouseRGCdev;visit=swh:1:snp:58bf7b67bd5b493c03bb11718a75b20536243730;anchor=swh:1:rev:ca6a97adabb7bc4ffb2fb1187c78cb277513665c">https://archive.softwareheritage.org/swh:1:dir:c0459e5fd21b06247aea1c49b55e3dd691d8a5d9;origin=https://github.com/shekharlab/mouseRGCdev;visit=swh:1:snp:58bf7b67bd5b493c03bb11718a75b20536243730;anchor=swh:1:rev:ca6a97adabb7bc4ffb2fb1187c78cb277513665c</ext-link></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soares</surname><given-names>CA</given-names></name><name><surname>Mason</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Transient ipsilateral retinal ganglion cell projections to the brain: Extent, targeting, and disappearance</article-title><source>Developmental Neurobiology</source><volume>75</volume><fpage>1385</fpage><lpage>1401</lpage><pub-id pub-id-type="doi">10.1002/dneu.22291</pub-id><pub-id pub-id-type="pmid">25788284</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stehman</surname><given-names>SV</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Selecting and interpreting measures of thematic classification accuracy</article-title><source>Remote Sensing of Environment</source><volume>62</volume><fpage>77</fpage><lpage>89</lpage><pub-id pub-id-type="doi">10.1016/S0034-4257(97)00083-7</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tran</surname><given-names>NM</given-names></name><name><surname>Shekhar</surname><given-names>K</given-names></name><name><surname>Whitney</surname><given-names>IE</given-names></name><name><surname>Jacobi</surname><given-names>A</given-names></name><name><surname>Benhar</surname><given-names>I</given-names></name><name><surname>Hong</surname><given-names>G</given-names></name><name><surname>Yan</surname><given-names>W</given-names></name><name><surname>Adiconis</surname><given-names>X</given-names></name><name><surname>Arnold</surname><given-names>ME</given-names></name><name><surname>Lee</surname><given-names>JM</given-names></name><name><surname>Levin</surname><given-names>JZ</given-names></name><name><surname>Lin</surname><given-names>D</given-names></name><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Lieber</surname><given-names>CM</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>He</surname><given-names>Z</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Single-Cell Profiles of Retinal Ganglion Cells Differing in Resilience to Injury Reveal Neuroprotective Genes</article-title><source>Neuron</source><volume>104</volume><fpage>1039</fpage><lpage>1055</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2019.11.006</pub-id><pub-id pub-id-type="pmid">31784286</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trimarchi</surname><given-names>JM</given-names></name><name><surname>Stadler</surname><given-names>MB</given-names></name><name><surname>Cepko</surname><given-names>CL</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Individual retinal progenitor cells display extensive heterogeneity of gene expression</article-title><source>PLOS ONE</source><volume>3</volume><elocation-id>e1588</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0001588</pub-id><pub-id pub-id-type="pmid">18270576</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turner</surname><given-names>DL</given-names></name><name><surname>Cepko</surname><given-names>CL</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>A common progenitor for neurons and glia persists in rat retina late in development</article-title><source>Nature</source><volume>328</volume><fpage>131</fpage><lpage>136</lpage><pub-id pub-id-type="doi">10.1038/328131a0</pub-id><pub-id pub-id-type="pmid">3600789</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turner</surname><given-names>DL</given-names></name><name><surname>Snyder</surname><given-names>EY</given-names></name><name><surname>Cepko</surname><given-names>CL</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Lineage-independent determination of cell type in the embryonic mouse retina</article-title><source>Neuron</source><volume>4</volume><fpage>833</fpage><lpage>845</lpage><pub-id pub-id-type="doi">10.1016/0896-6273(90)90136-4</pub-id><pub-id pub-id-type="pmid">2163263</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Villani</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2009">2009</year><source>Optimal Transport</source><publisher-loc>Berlin, Heidelberg</publisher-loc><publisher-name>Springer</publisher-name><pub-id pub-id-type="doi">10.1007/978-3-540-71050-9</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Voinescu</surname><given-names>PE</given-names></name><name><surname>Emanuela</surname><given-names>P</given-names></name><name><surname>Kay</surname><given-names>JN</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Birthdays of retinal amacrine cell subtypes are systematically related to their molecular identity and soma position</article-title><source>The Journal of Comparative Neurology</source><volume>517</volume><fpage>737</fpage><lpage>750</lpage><pub-id pub-id-type="doi">10.1002/cne.22200</pub-id><pub-id pub-id-type="pmid">19827163</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wamsley</surname><given-names>B</given-names></name><name><surname>Fishell</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Genetic and activity-dependent mechanisms underlying interneuron diversity</article-title><source>Nature Reviews. Neuroscience</source><volume>18</volume><fpage>299</fpage><lpage>309</lpage><pub-id pub-id-type="doi">10.1038/nrn.2017.30</pub-id><pub-id pub-id-type="pmid">28381833</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Q</given-names></name><name><surname>Marcucci</surname><given-names>F</given-names></name><name><surname>Cerullo</surname><given-names>I</given-names></name><name><surname>Mason</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Ipsilateral and Contralateral Retinal Ganglion Cells Express Distinct Genes during Decussation at the Optic Chiasm</article-title><source>ENeuro</source><volume>3</volume><elocation-id>ENEURO.0169-16.2016</elocation-id><pub-id pub-id-type="doi">10.1523/ENEURO.0169-16.2016</pub-id><pub-id pub-id-type="pmid">27957530</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Welch</surname><given-names>JD</given-names></name><name><surname>Kozareva</surname><given-names>V</given-names></name><name><surname>Ferreira</surname><given-names>A</given-names></name><name><surname>Vanderburg</surname><given-names>C</given-names></name><name><surname>Martin</surname><given-names>C</given-names></name><name><surname>Macosko</surname><given-names>EZ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Single-Cell Multi-omic Integration Compares and Contrasts Features of Brain Cell Identity</article-title><source>Cell</source><volume>177</volume><fpage>1873</fpage><lpage>1887</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2019.05.006</pub-id><pub-id pub-id-type="pmid">31178122</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wetts</surname><given-names>R</given-names></name><name><surname>Fraser</surname><given-names>SE</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>Multipotent precursors can give rise to all major cell types of the frog retina</article-title><source>Science (New York, N.Y.)</source><volume>239</volume><fpage>1142</fpage><lpage>1145</lpage><pub-id pub-id-type="doi">10.1126/science.2449732</pub-id><pub-id pub-id-type="pmid">2449732</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yamagata</surname><given-names>M</given-names></name><name><surname>Yan</surname><given-names>W</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A cell atlas of the chick retina based on single-cell transcriptomics</article-title><source>eLife</source><volume>10</volume><elocation-id>e63907</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.63907</pub-id><pub-id pub-id-type="pmid">33393903</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yan</surname><given-names>W</given-names></name><name><surname>Laboulaye</surname><given-names>MA</given-names></name><name><surname>Tran</surname><given-names>NM</given-names></name><name><surname>Whitney</surname><given-names>IE</given-names></name><name><surname>Benhar</surname><given-names>I</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Mouse Retinal Cell Atlas: Molecular Identification of over Sixty Amacrine Cell Types</article-title><source>The Journal of Neuroscience</source><volume>40</volume><fpage>5177</fpage><lpage>5195</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0471-20.2020</pub-id><pub-id pub-id-type="pmid">32457074</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yuste</surname><given-names>R</given-names></name><name><surname>Hawrylycz</surname><given-names>M</given-names></name><name><surname>Aalling</surname><given-names>N</given-names></name><name><surname>Aguilar-Valles</surname><given-names>A</given-names></name><name><surname>Arendt</surname><given-names>D</given-names></name><name><surname>Armañanzas</surname><given-names>R</given-names></name><name><surname>Ascoli</surname><given-names>GA</given-names></name><name><surname>Bielza</surname><given-names>C</given-names></name><name><surname>Bokharaie</surname><given-names>V</given-names></name><name><surname>Bergmann</surname><given-names>TB</given-names></name><name><surname>Bystron</surname><given-names>I</given-names></name><name><surname>Capogna</surname><given-names>M</given-names></name><name><surname>Chang</surname><given-names>Y</given-names></name><name><surname>Clemens</surname><given-names>A</given-names></name><name><surname>de Kock</surname><given-names>CPJ</given-names></name><name><surname>DeFelipe</surname><given-names>J</given-names></name><name><surname>Dos Santos</surname><given-names>SE</given-names></name><name><surname>Dunville</surname><given-names>K</given-names></name><name><surname>Feldmeyer</surname><given-names>D</given-names></name><name><surname>Fiáth</surname><given-names>R</given-names></name><name><surname>Fishell</surname><given-names>GJ</given-names></name><name><surname>Foggetti</surname><given-names>A</given-names></name><name><surname>Gao</surname><given-names>X</given-names></name><name><surname>Ghaderi</surname><given-names>P</given-names></name><name><surname>Goriounova</surname><given-names>NA</given-names></name><name><surname>Güntürkün</surname><given-names>O</given-names></name><name><surname>Hagihara</surname><given-names>K</given-names></name><name><surname>Hall</surname><given-names>VJ</given-names></name><name><surname>Helmstaedter</surname><given-names>M</given-names></name><name><surname>Herculano-Houzel</surname><given-names>S</given-names></name><name><surname>Hilscher</surname><given-names>MM</given-names></name><name><surname>Hirase</surname><given-names>H</given-names></name><name><surname>Hjerling-Leffler</surname><given-names>J</given-names></name><name><surname>Hodge</surname><given-names>R</given-names></name><name><surname>Huang</surname><given-names>J</given-names></name><name><surname>Huda</surname><given-names>R</given-names></name><name><surname>Khodosevich</surname><given-names>K</given-names></name><name><surname>Kiehn</surname><given-names>O</given-names></name><name><surname>Koch</surname><given-names>H</given-names></name><name><surname>Kuebler</surname><given-names>ES</given-names></name><name><surname>Kühnemund</surname><given-names>M</given-names></name><name><surname>Larrañaga</surname><given-names>P</given-names></name><name><surname>Lelieveldt</surname><given-names>B</given-names></name><name><surname>Louth</surname><given-names>EL</given-names></name><name><surname>Lui</surname><given-names>JH</given-names></name><name><surname>Mansvelder</surname><given-names>HD</given-names></name><name><surname>Marin</surname><given-names>O</given-names></name><name><surname>Martinez-Trujillo</surname><given-names>J</given-names></name><name><surname>Chameh</surname><given-names>HM</given-names></name><name><surname>Mohapatra</surname><given-names>AN</given-names></name><name><surname>Munguba</surname><given-names>H</given-names></name><name><surname>Nedergaard</surname><given-names>M</given-names></name><name><surname>Němec</surname><given-names>P</given-names></name><name><surname>Ofer</surname><given-names>N</given-names></name><name><surname>Pfisterer</surname><given-names>UG</given-names></name><name><surname>Pontes</surname><given-names>S</given-names></name><name><surname>Redmond</surname><given-names>W</given-names></name><name><surname>Rossier</surname><given-names>J</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name><name><surname>Scheuermann</surname><given-names>RH</given-names></name><name><surname>Serrano-Saiz</surname><given-names>E</given-names></name><name><surname>Staiger</surname><given-names>JF</given-names></name><name><surname>Somogyi</surname><given-names>P</given-names></name><name><surname>Tamás</surname><given-names>G</given-names></name><name><surname>Tolias</surname><given-names>AS</given-names></name><name><surname>Tosches</surname><given-names>MA</given-names></name><name><surname>García</surname><given-names>MT</given-names></name><name><surname>Wozny</surname><given-names>C</given-names></name><name><surname>Wuttke</surname><given-names>TV</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Yuan</surname><given-names>J</given-names></name><name><surname>Zeng</surname><given-names>H</given-names></name><name><surname>Lein</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A community-based transcriptomics classification and nomenclature of neocortical cell types</article-title><source>Nature Neuroscience</source><volume>23</volume><fpage>1456</fpage><lpage>1468</lpage><pub-id pub-id-type="doi">10.1038/s41593-020-0685-8</pub-id><pub-id pub-id-type="pmid">32839617</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zeng</surname><given-names>H</given-names></name><name><surname>Sanes</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Neuronal cell-type classification: challenges, opportunities and the path forward</article-title><source>Nature Reviews. Neuroscience</source><volume>18</volume><fpage>530</fpage><lpage>546</lpage><pub-id pub-id-type="doi">10.1038/nrn.2017.85</pub-id><pub-id pub-id-type="pmid">28775344</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>GXY</given-names></name><name><surname>Terry</surname><given-names>JM</given-names></name><name><surname>Belgrader</surname><given-names>P</given-names></name><name><surname>Ryvkin</surname><given-names>P</given-names></name><name><surname>Bent</surname><given-names>ZW</given-names></name><name><surname>Wilson</surname><given-names>R</given-names></name><name><surname>Ziraldo</surname><given-names>SB</given-names></name><name><surname>Wheeler</surname><given-names>TD</given-names></name><name><surname>McDermott</surname><given-names>GP</given-names></name><name><surname>Zhu</surname><given-names>J</given-names></name><name><surname>Gregory</surname><given-names>MT</given-names></name><name><surname>Shuga</surname><given-names>J</given-names></name><name><surname>Montesclaros</surname><given-names>L</given-names></name><name><surname>Underwood</surname><given-names>JG</given-names></name><name><surname>Masquelier</surname><given-names>DA</given-names></name><name><surname>Nishimura</surname><given-names>SY</given-names></name><name><surname>Schnall-Levin</surname><given-names>M</given-names></name><name><surname>Wyatt</surname><given-names>PW</given-names></name><name><surname>Hindson</surname><given-names>CM</given-names></name><name><surname>Bharadwaj</surname><given-names>R</given-names></name><name><surname>Wong</surname><given-names>A</given-names></name><name><surname>Ness</surname><given-names>KD</given-names></name><name><surname>Beppu</surname><given-names>LW</given-names></name><name><surname>Deeg</surname><given-names>HJ</given-names></name><name><surname>McFarland</surname><given-names>C</given-names></name><name><surname>Loeb</surname><given-names>KR</given-names></name><name><surname>Valente</surname><given-names>WJ</given-names></name><name><surname>Ericson</surname><given-names>NG</given-names></name><name><surname>Stevens</surname><given-names>EA</given-names></name><name><surname>Radich</surname><given-names>JP</given-names></name><name><surname>Mikkelsen</surname><given-names>TS</given-names></name><name><surname>Hindson</surname><given-names>BJ</given-names></name><name><surname>Bielas</surname><given-names>JH</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Massively parallel digital transcriptional profiling of single cells</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>14049</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms14049</pub-id><pub-id pub-id-type="pmid">28091601</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.73809.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Mason</surname><given-names>Carol A</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00hj8s172</institution-id><institution>Columbia University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><related-object id="sa0ro1" link-type="continued-by" object-id="10.1101/2021.10.21.465277" object-id-type="id" xlink:href="https://sciety.org/articles/activity/10.1101/2021.10.21.465277"/></front-stub><body><p>Your study using single-cell RNA-seq to profile developing retinal ganglion cells from embryonic and postnatal mouse retina showcases the diversification of this class of neuron into specific subtypes. The computational approaches you developed identify groups of RGC precursors with largely nonoverlapping fates, distinguished by selectively expressed transcription factors that could act as fate determinants. You then show that over time clusters of cells become ‘decoupled’ as they split into subclusters, indicating that subtype diversification arises as a gradual, asynchronous fate restriction of postmitotic multipotential precursors. Your data should enable the neural development community to generate new hypotheses in the field of retinal ganglion cell differentiation and beyond in other neural structures.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.73809.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Mason</surname><given-names>Carol A</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00hj8s172</institution-id><institution>Columbia University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Reh</surname><given-names>Tom</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00cvxb145</institution-id><institution>University of Washington</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2021.10.21.465277">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2021.10.21.465277v1">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Diversification of multipotential postmitotic mouse retinal ganglion cell precursors into discrete types&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 2 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Claude Desplan as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Tom Reh (Reviewer #1).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>The reviewers had several questions and comments that could be addressed textually or by delving further into existing data; these fall into five aspects:</p><p>1) The variability among the cells at the early time points may be due to their different stages of differentiation, since they are a composite of cells with different birthdates. This point should be noted and discussed, or you can try to tease out this aspect from the data.</p><p>2) The &quot;differential&quot; between ipsilateral and contralateral RGCs – timing of birth, and genes expressed.</p><p>3) The relationships among the cells are not true lineages, but inferred lineages. Reviewer 2 called for an additional method to confirm these potential relationships for at least a some of the subtypes, by retrograde tracing in postnatal stages to cull out the ipsilateral cells. Retrograde labeling is difficult past late embryonic stages. While genetic lineage tracing is beyond the scope of this paper, you could consider making use of the Sert-Cre mouse, which labels the ipsilateral RGCs in the ventrotemporal retina, in conjunction with validation of specific genes by in situ hybridization.</p><p>4) Describing the methods in a clearer, more accessible way.</p><p>5) Comparing your findings with the several recent studies on transcriptomics of the retina (e.g., Lo Giudice, Rheaume, etc..).</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>While the data presentation is very clear and data support the overall conclusions, there are a few points the authors could consider.</p><p>1. The authors initially use standard clustering approaches to determine when in development RGCs form distinct clusters. As early as E13, 10 distinct clusters were present (Figure 2B). It is not shown, however, how these clusters relate to those they define with the WOT analysis that follows. A similar UMAP plot in Figure 4d, for example, suggests that clusters 8 and 9 have less potential than cluster 6. It would be useful to see how the clustering and WOT analyses relate.</p><p>2. The authors turn to WOT analysis to examine the relationships among cells within clusters. They state &quot; Thus, WOT identifies fate associations between individual cells&quot;. This seems like an overstatement, since to my understanding methods like WOT can only infer relationships among cells based on their degree of transcriptomic similarity.</p><p>3.The authors find that over time, clusters of cells become &quot;decoupled&quot; as they split into subclusters. This process of fate decoupling is associated with changes in the expression of specific transcription factors. This allows them to both predict lineage relationships among RGC subtypes and the time during development when these specification events occur.</p><p>It would be nice if there was a single RGC type defined by an orthogonal method that showed these features of progressive restriction that corresponded with the computational prediction. For example, the senior author reported several years ago that the Cdh6+ RGCs are specified very early in the differentiation process (Huetra et al., 2012). This would suggest that not all subtypes are multipotential.</p><p>4. The authors also show that &quot;early specification of the Eomes group is consistent with birthdating studies showing the average earlier birthdate of ipRGCs compared to all RGCs (McNeill et al., 2011).&quot; It would be useful to show whether this is a more general feature of the data analysis. For example, Osterhout et al., 2014, has shown that Cdh3, Drd4 and Hoxd10 RGC subtypes have quite distinct periods of genesis. If these cell types can be identified as members of clusters at the relevant ages, the authors might be able to determine the relationship between birthdate and decoupling/specification.</p><p>5. Another feature of the RGCs at each age is that some of these were &quot;born yesterday&quot; while other may have been around for several days since they were generated. Therefore, there should be a gradient of RGC maturation, particularly at the later ages. It is not clear how this would affect the conclusions. I can imagine for example, that the degree of maturation of the RGC might affect the estimate of specification of the cell type in the overall population.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>Please find additional questions and comments, as well as suggestions for the authors:</p><p>– Is it possible to validate with more direct methods (instead of inference) the observation of a late diversification? Some efficient method to address this question have been described before, such as lineage tracing technique, either viral or CRISPR based methodology (eg. by Schier lab: DOI: 10.1038/nbt.4103; Junker lab; doi: 10.1038/nbt.4124 and Morris lab: 10.1038/s41586-018-0744-4 ; also reviewed by McKenna and Gagnon: https://doi.org/10.1242/dev.169730).</p><p>– The study is very descriptive and may benefit from an experimental set up showing this framework is related to functionally relevant features. As the stages chosen by the authors are based on (i) peak of RGC generation (E13/E14); (ii) peak of RGC axons reaching target and (iii) dendrite arborization. Would it be possible to challenge one of these processes to assess whether axon guidance choices or synaptic activity are important to instruct the diversity bursts that is observed after P0? (i.e., support with a functional perturbation the mere observations).</p><p>– The authors discuss the presence of transient (DV) ipsilateral RGC (Soares and Mason, 2015) and decide to analyze the non- transient population (Zic2+). Is this population present at E13?</p><p>– The I-RGC analysis is mostly based on the inference of their identity based on a few markers. To make a strong point, I-RGC shall be isolated at a stage of final maturation (P5?) and using a robust method such as retrograde labelling.</p><p>– RGC are known to undergo a significant wave of cell death between E16 and P5. How much the loss of this pool RGC could be associated in the increase in discreetness observed over time? Did the analysis take that into account?</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.73809.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>The reviewers had several questions and comments that could be addressed textually or by delving further into existing data; these fall into five aspects:</p><p>1) The variability among the cells at the early time points may be due to their different stages of differentiation, since they are a composite of cells with different birthdates. This point should be noted and discussed, or you can try to tease out this aspect from the data.</p></disp-quote><p>We agree that an important axis of transcriptomic variation in our data, especially at early stages, may be due to stages of differentiation associated with different birthdates (asynchrony). We considered the possibility of inferring birthdate based on transcriptional profiles, but were unsuccessful. For example, we searched for gradients of expression of RGC class markers within the immature clusters as a potential way to address this issue. However, we found no substantially greater inter-cluster variation at early times than in adults. We now mention this in the discussion.</p><disp-quote content-type="editor-comment"><p>2) The &quot;differential&quot; between ipsilateral and contralateral RGCs – timing of birth, and genes expressed.</p></disp-quote><p>We include additional discussion of the ways in which we defined ipsilateral and contralateral RGCs. We also re-emphasize that these are tentative identification, based on molecular markers obtained by other groups, primarily that of Carol Mason.</p><disp-quote content-type="editor-comment"><p>3) The relationships among the cells are not true lineages, but inferred lineages. Reviewer 2 called for an additional method to confirm these potential relationships for at least a some of the subtypes, by retrograde tracing in postnatal stages to cull out the ipsilateral cells. Retrograde labeling is difficult past late embryonic stages. While genetic lineage tracing is beyond the scope of this paper, you could consider making use of the Sert-Cre mouse, which labels the ipsilateral RGCs in the ventrotemporal retina, in conjunction with validation of specific genes by in situ hybridization.</p></disp-quote><p>We agree with this point and apologize if our attempts to acknowledge it fell short. Unfortunately, the suggested experiments are outside the scope of this paper as they would at least take a year for setup and analyses. This reflects not only their difficulty but also the sad fact that we are not currently equipped to perform them in our laboratories. Instead, we have added additional text to emphasize that these are inferred rather than true lineages.</p><disp-quote content-type="editor-comment"><p>4) Describing the methods in a clearer, more accessible way.</p></disp-quote><p>We have rearranged and edited the methods section in a number of places as requested to improve readability. We note, however, that a full description of the computational methods requires inclusion of mathematical detail that is not going to be accessible to those without some specialized knowledge.</p><disp-quote content-type="editor-comment"><p>5) Comparing your findings with the several recent studies on transcriptomics of the retina (e.g., Lo Giudice, Rheaume, etc..).</p></disp-quote><p>We had included comparisons with Lo Giudice et al. and Clark et al. in Figure S1e-h. As described, the main difference between our study and theirs is that we isolated RGCs, which are a minority subclass. Consequently, Lo Giudice et al. and Clark et al. lacked the resolution to resolve RGC diversity at later time points. Regarding Rheaume et al., who isolated and profiled RGCs at P5, we had cited that paper in several places and have now added a comparison between their and our P5 datasets, showing that both identified nearly identical types. Finally, we note that the concordance of RGC types isolated with two different markers supports the idea that we have not missed types.</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>While the data presentation is very clear and data support the overall conclusions, there are a few points the authors could consider.</p><p>1. The authors initially use standard clustering approaches to determine when in development RGCs form distinct clusters. As early as E13, 10 distinct clusters were present (Figure 2B). It is not shown, however, how these clusters relate to those they define with the WOT analysis that follows. A similar UMAP plot in Figure 4d, for example, suggests that clusters 8 and 9 have less potential than cluster 6. It would be useful to see how the clustering and WOT analyses relate.</p></disp-quote><p>We had performed an analysis of the type requested; results are presented in Figure 4—figure supplement 2, where the fate relationships inferred by WOT among individual cells is collapsed to a “cluster-cluster” association map similar to that produced by supervised classification in Figure 3. We find that the results are highly concordant – at all time points the Pearson correlation coefficients of the cluster-cluster associations between the two methods is greater than 0.9. With regards to the specific example of cluster 8 and 9 at E13, their pattern of association with E14 clusters is similar between Figure 3d (supervised classification) and Figure 4—figure supplement 2a (WOT). Thus, the two methods are consistent at the cluster level. We have noted this in the main text (lines 368-370).</p><p>In addition to the fact that it acts on cells rather than clusters, WOT provides long-range fate associations that allow us to directly relate each precursor to a terminal type (illustrated in Figure 4). It is for this reason that we used WOT for some subsequent analyses in the paper after demonstrating its concordance with the classification results at the level of clusters.</p><disp-quote content-type="editor-comment"><p>2. The authors turn to WOT analysis to examine the relationships among cells within clusters. They state &quot; Thus, WOT identifies fate associations between individual cells&quot;. This seems like an overstatement, since to my understanding methods like WOT can only infer relationships among cells based on their degree of transcriptomic similarity.</p></disp-quote><p>We apologize for the confusion. WOT, like all methods that infer developmental processes from single-cell RNA-seq data, relies on transcriptomic similarity as a proxy for fate proximity. Between the two methods used in this study, supervised classification and WOT, the key difference is that supervised classification relies on comparing similarity only at the level of pre-determined clusters. Thus, supervised classification yields a measure of transcriptomic similarity (i.e. fate association) between a cluster at a given time point and every cluster at a consecutive time point. In contrast, WOT computes fate associations between every <italic>cell</italic> at a given time point and <italic>every cell</italic> at a consecutive time point. The outcome is that for each cell at E14 (for example) we have a vector of fate associations with respect to each cell at E16 as well as each cell at E13.</p><p>While WOT results can be interpreted at the level of clusters <italic>post hoc</italic>, there is no principled way to resolve cellular relationships from the results of supervised classification. We have modified the wording in Results (line 365-366) to avoid giving the wrong impression, and added a form of the explanation above to the Discussion (line 748-749).</p><disp-quote content-type="editor-comment"><p>3.The authors find that over time, clusters of cells become &quot;decoupled&quot; as they split into subclusters. This process of fate decoupling is associated with changes in the expression of specific transcription factors. This allows them to both predict lineage relationships among RGC subtypes and the time during development when these specification events occur.</p><p>It would be nice if there was a single RGC type defined by an orthogonal method that showed these features of progressive restriction that corresponded with the computational prediction. For example, the senior author reported several years ago that the Cdh6+ RGCs are specified very early in the differentiation process (Huetra et al., 2012). This would suggest that not all subtypes are multipotential.</p></disp-quote><p>We agree that validation with a second method would be useful. Unfortunately, additional experiments using genetically engineered mice are outside the scope of this paper as they would at least take a year for setup and analyses. This reflects not only their difficulty but also the sad fact that we are not currently equipped to perform them in our laboratories. For example, we no longer maintain either the Cdh6-cre line or the Sert-cre line mentioned elsewhere. Instead, we have added additional text in a number of places to emphasize that these are inferred rather than true lineages.</p><p>Regarding the de la Huerta paper, we admit to ignorance and befuddlement. Cdh6 is expressed in multiple clusters at early stages but at exceedingly low levels (&lt;2% of cells; <xref ref-type="fig" rid="sa2fig1">Author response image 1</xref>) to be considered robust. We are therefore unable to identify <italic>Cdh6+</italic> precursor RGCs and examine their fate <italic>in silico</italic>. Since very low levels of <italic>cre</italic> expression can activate reporters it may be that the relevant levels of endogenous <italic>Cdh6</italic> are too low to be detected by the somewhat shallow sequencing of the scRNA-seq method.</p><fig id="sa2fig1" position="float"><label>Author response image 1.</label><caption><title>Low levels of expression of Cdh6 in immature clusters at E13 (left) and E16 (right).</title><p>Cdh6 is expressed at similarly low levels at all other time points (not shown). RGC markers Pou4f2 and Rbpms are shown for comparison.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-73809-sa2-fig1-v2.tif"/></fig><p>4. The authors also show that &quot;early specification of the Eomes group is consistent with birthdating studies showing the average earlier birthdate of ipRGCs compared to all RGCs (McNeill et al., 2011).&quot; It would be useful to show whether this is a more general feature of the data analysis. For example, Osterhout et al., 2014, has shown that Cdh3, Drd4 and Hoxd10 RGC subtypes have quite distinct periods of genesis. If these cell types can be identified as members of clusters at the relevant ages, the authors might be able to determine the relationship between birthdate and decoupling/specification.</p><p>This is a good idea but unfortunately these markers and lines cannot be used. For all three lines, there is a discrepancy between the cells that are labeled and expression of the endogenous gene. We obtained the <italic>Cdh3-GFP</italic> line to which the reviewer refers many years ago and studied it in some detail, but did not publish on it. It turns out that the line labels several different types of RGCs, of which many (perhaps most) of which don’t actually express <italic>Cdh3</italic>. Similarly, we showed several years ago that labeled cells in the <italic>Drd4-GFP</italic> line do not express detectable <italic>Drd4</italic> (Kay…Sanes, J. Neuroscience, 2011). We rechecked both genes in our new datasets and found very low levels of expression at all time points. We have no experience with the <italic>Hoxd10-GFP</italic> line but found no Hoxd10 expression at all in our dataset. We and others have previously discussed reasons why BAC transgenic lines such as these frequently lead to such “ectopic” expression.</p><disp-quote content-type="editor-comment"><p>5. Another feature of the RGCs at each age is that some of these were &quot;born yesterday&quot; while other may have been around for several days since they were generated. Therefore, there should be a gradient of RGC maturation, particularly at the later ages. It is not clear how this would affect the conclusions. I can imagine for example, that the degree of maturation of the RGC might affect the estimate of specification of the cell type in the overall population.</p></disp-quote><p>Thank you for raising this important point. At any of the stages profiled, the degree of maturation is likely to be an important axis of variation that is intermixed with transcriptional signatures of type-identity. However, in contrast to your expectation that it should be important at later stages, we believe this is likely important at earlier stages in the data. Empirically, the clusters defined at P5 exhibit highly specific correspondences to P56 clusters, where we assume that maturational gradients are absent. This suggests that the predominant axis of transcriptional variation at P5 is likely type-identity. Thus, although cells within a type-defining cluster may exhibit maturational differences, these are unlikely to impact any of the analysis or conclusions.</p><p>In contrast, these effects could be important at early stages where clusters are not very well separated, and the most multipotential precursors are intermixed with cells that are at advanced stages of commitment. Here, it is very much possible that some clusters are defined by maturational state rather than type-identity. However, we were unable to detect such patterns using the relevant transcriptional signatures. As both methods (supervised classification and WOT) connect clusters/cells across time points based on transcriptional proximity, less mature precursors and more mature precursors are likely to map to their counterparts across time points. Moreover, neither method forcefully maps every cellular state across time points. Thus, if multipotential RGC precursors are not present at time (t+1), the corresponding cells at time t do not contribute any forward weight.</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>Please find additional questions and comments, as well as suggestions for the authors:</p><p>– Is it possible to validate with more direct methods (instead of inference) the observation of a late diversification? Some efficient method to address this question have been described before, such as lineage tracing technique, either viral or CRISPR based methodology (eg. by Schier lab: DOI: 10.1038/nbt.4103; Junker lab; doi: 10.1038/nbt.4124 and Morris lab: 10.1038/s41586-018-0744-4 ; also reviewed by McKenna and Gagnon: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/dev.169730">https://doi.org/10.1242/dev.169730</ext-link>).</p></disp-quote><p>We believe that additional experiments of this type, while important and interesting, are beyond the scope of this study. Our reasoning is detailed above, and we note that we have checked with the editors on this point and received their assurance that additional experiments will not be required for acceptance.</p><disp-quote content-type="editor-comment"><p>– The study is very descriptive and may benefit from an experimental set up showing this framework is related to functionally relevant features. As the stages chosen by the authors are based on (i) peak of RGC generation (E13/E14); (ii) peak of RGC axons reaching target and (iii) dendrite arborization. Would it be possible to challenge one of these processes to assess whether axon guidance choices or synaptic activity are important to instruct the diversity bursts that is observed after P0? (i.e., support with a functional perturbation the mere observations).</p></disp-quote><p>We believe that functional perturbations experiments of this type are beyond the scope of this study. We are currently not set up to do experiments of the kind suggested. Our reasoning is detailed above, and we note that we have checked with the editors on this point and received their assurance that additional experiments will not be required for acceptance.</p><disp-quote content-type="editor-comment"><p>– The authors discuss the presence of transient (DV) ipsilateral RGC (Soares and Mason, 2015) and decide to analyze the non- transient population (Zic2+). Is this population present at E13?</p></disp-quote><p>We spent some time trying to find a way to identify transient I-RGCs and unfortunately found none. To our knowledge reliable molecular markers are not available to identify transient I-RGCs at E13.</p><disp-quote content-type="editor-comment"><p>– The I-RGC analysis is mostly based on the inference of their identity based on a few markers. To make a strong point, I-RGC shall be isolated at a stage of final maturation (P5?) and using a robust method such as retrograde labelling.</p></disp-quote><p>We believe that additional experiments of this type are beyond the scope of this study. Our reasoning is detailed above, and we note that we have checked with the editors on this point and received their assurance that additional experiments will not be required for acceptance.</p><disp-quote content-type="editor-comment"><p>– RGC are known to undergo a significant wave of cell death between E16 and P5. How much the loss of this pool RGC could be associated in the increase in discreetness observed over time? Did the analysis take that into account?</p></disp-quote><p>We spent some time trying to find a way to analyze whether naturally occurring cell death acts disproportionately on some RGC types or on RGCs that remain multipotential. Unfortunately, we found no way to address this issue.</p></body></sub-article></article>