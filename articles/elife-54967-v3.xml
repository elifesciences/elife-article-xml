<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">54967</article-id><article-id pub-id-type="doi">10.7554/eLife.54967</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>A community-maintained standard library of population genetic models</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-144664"><name><surname>Adrion</surname><given-names>Jeffrey R</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1021-6000</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="fn1">§</xref></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-172262"><name><surname>Cole</surname><given-names>Christopher B</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6733-633X</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="fn1">§</xref></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-172263"><name><surname>Dukler</surname><given-names>Noah</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-8739-8052</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="fn1">§</xref></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-144665"><name><surname>Galloway</surname><given-names>Jared G</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="fn1">§</xref></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-172264"><name><surname>Gladstein</surname><given-names>Ariella L</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7735-2336</contrib-id><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="fn1">§</xref></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-118323"><name><surname>Gower</surname><given-names>Graham</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6197-3872</contrib-id><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund7"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="fn1">§</xref></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-172265"><name><surname>Kyriazis</surname><given-names>Christopher C</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-8771-3681</contrib-id><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="fn1">§</xref></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-154258"><name><surname>Ragsdale</surname><given-names>Aaron P</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0715-3432</contrib-id><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="fn1">§</xref></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-172266"><name><surname>Tsambos</surname><given-names>Georgia</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7001-2275</contrib-id><xref ref-type="aff" rid="aff8">8</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="fn1">§</xref></contrib><contrib contrib-type="author" id="author-172267"><name><surname>Baumdicker</surname><given-names>Franz</given-names></name><xref ref-type="aff" rid="aff9">9</xref><xref ref-type="fn" rid="con10"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-172268"><name><surname>Carlson</surname><given-names>Jedidiah</given-names></name><xref ref-type="aff" rid="aff10">10</xref><xref ref-type="fn" rid="con11"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-172269"><name><surname>Cartwright</surname><given-names>Reed A</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0837-9380</contrib-id><xref ref-type="aff" rid="aff11">11</xref><xref ref-type="fn" rid="con12"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-153200"><name><surname>Durvasula</surname><given-names>Arun</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0631-3238</contrib-id><xref ref-type="aff" rid="aff12">12</xref><xref ref-type="fn" rid="con13"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-110045"><name><surname>Gronau</surname><given-names>Ilan</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8536-4062</contrib-id><xref ref-type="aff" rid="aff13">13</xref><xref ref-type="fn" rid="con14"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-172270"><name><surname>Kim</surname><given-names>Bernard Y</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5025-1292</contrib-id><xref ref-type="aff" rid="aff14">14</xref><xref ref-type="fn" rid="con15"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-172275"><name><surname>McKenzie</surname><given-names>Patrick</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-8983-6060</contrib-id><xref ref-type="aff" rid="aff15">15</xref><xref ref-type="fn" rid="con16"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-121051"><name><surname>Messer</surname><given-names>Philipp W</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8453-9377</contrib-id><xref ref-type="aff" rid="aff16">16</xref><xref ref-type="fn" rid="con17"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-172271"><name><surname>Noskova</surname><given-names>Ekaterina</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1168-0497</contrib-id><xref ref-type="aff" rid="aff17">17</xref><xref ref-type="fn" rid="con18"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-172272"><name><surname>Ortega-Del Vecchyo</surname><given-names>Diego</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4054-3766</contrib-id><xref ref-type="aff" rid="aff18">18</xref><xref ref-type="other" rid="fund8"/><xref ref-type="other" rid="fund10"/><xref ref-type="other" rid="fund11"/><xref ref-type="fn" rid="con19"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-172273"><name><surname>Racimo</surname><given-names>Fernando</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5025-2607</contrib-id><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="fund7"/><xref ref-type="fn" rid="con20"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-154255"><name><surname>Struck</surname><given-names>Travis J</given-names></name><xref ref-type="aff" rid="aff19">19</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con21"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-42913"><name><surname>Gravel</surname><given-names>Simon</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9183-964X</contrib-id><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="fn" rid="con22"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="fn2">#</xref></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-46219"><name><surname>Gutenkunst</surname><given-names>Ryan N</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-8659-0579</contrib-id><xref ref-type="aff" rid="aff19">19</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con23"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="fn2">#</xref></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-15634"><name><surname>Lohmueller</surname><given-names>Kirk E</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3874-369X</contrib-id><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="aff" rid="aff12">12</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con24"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="fn2">#</xref></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-169869"><name><surname>Ralph</surname><given-names>Peter L</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9459-6866</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff20">20</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="fn" rid="con25"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="fn2">#</xref></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-113288"><name><surname>Schrider</surname><given-names>Daniel R</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5249-4151</contrib-id><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con26"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="fn2">#</xref></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-12649"><name><surname>Siepel</surname><given-names>Adam</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3557-7219</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con27"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="fn2">#</xref></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-172274"><name><surname>Kelleher</surname><given-names>Jerome</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7894-5253</contrib-id><email>jerome.kelleher@bdi.ox.ac.uk</email><xref ref-type="aff" rid="aff21">21</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="other" rid="fund9"/><xref ref-type="fn" rid="con28"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="fn3">¶</xref></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-124313"><name><surname>Kern</surname><given-names>Andrew D</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4381-4680</contrib-id><email>adkern@uoregon.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con29"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="fn3">¶</xref></contrib><aff id="aff1"><label>1</label><institution>Department of Biology and Institute of Ecology and Evolution, University of Oregon</institution><addr-line><named-content content-type="city">Eugene</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution>Weatherall Institute of Molecular Medicine, University of Oxford</institution><addr-line><named-content content-type="city">Oxford</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff3"><label>3</label><institution>Simons Center for Quantitative Biology, Cold Spring Harbor Laboratory</institution><addr-line><named-content content-type="city">Cold Spring Harbor</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution>Department of Genetics, University of North Carolina at Chapel Hill</institution><addr-line><named-content content-type="city">Chapel Hill</named-content></addr-line><country>United States</country></aff><aff id="aff5"><label>5</label><institution>Lundbeck GeoGenetics Centre, Globe Institute, University of Copenhagen</institution><addr-line><named-content content-type="city">Copenhagen</named-content></addr-line><country>Denmark</country></aff><aff id="aff6"><label>6</label><institution>Department of Ecology and Evolutionary Biology, University of California, Los Angeles</institution><addr-line><named-content content-type="city">Los Angeles</named-content></addr-line><country>United States</country></aff><aff id="aff7"><label>7</label><institution>Department of Human Genetics, McGill University</institution><addr-line><named-content content-type="city">Montreal</named-content></addr-line><country>Canada</country></aff><aff id="aff8"><label>8</label><institution>Melbourne Integrative Genomics, School of Mathematics and Statistics, University of Melbourne</institution><addr-line><named-content content-type="city">Melbourne</named-content></addr-line><country>Australia</country></aff><aff id="aff9"><label>9</label><institution>Department of Mathematical Stochastics, University of Freiburg</institution><addr-line><named-content content-type="city">Freiburg</named-content></addr-line><country>Germany</country></aff><aff id="aff10"><label>10</label><institution>Department of Genome Sciences, University of Washington</institution><addr-line><named-content content-type="city">Seattle</named-content></addr-line><country>United States</country></aff><aff id="aff11"><label>11</label><institution>The Biodesign Institute and The School of Life Sciences, Arizona State University</institution><addr-line><named-content content-type="city">Tempe</named-content></addr-line><country>United States</country></aff><aff id="aff12"><label>12</label><institution>Department of Human Genetics, David Geffen School of Medicine, University of California, Los Angeles</institution><addr-line><named-content content-type="city">Los Angeles</named-content></addr-line><country>United States</country></aff><aff id="aff13"><label>13</label><institution>The Efi Arazi School of Computer Science, Herzliya Interdisciplinary Center</institution><addr-line><named-content content-type="city">Herzliya</named-content></addr-line><country>Israel</country></aff><aff id="aff14"><label>14</label><institution>Department of Biology, Stanford University</institution><addr-line><named-content content-type="city">Stanford</named-content></addr-line><country>United States</country></aff><aff id="aff15"><label>15</label><institution>Department of Ecology, Evolution, and Environmental Biology, Columbia University</institution><addr-line><named-content content-type="city">New York</named-content></addr-line><country>United States</country></aff><aff id="aff16"><label>16</label><institution>Department of Computational BiologyCornell University</institution><addr-line><named-content content-type="city">Ithaca</named-content></addr-line><country>United States</country></aff><aff id="aff17"><label>17</label><institution>Computer Technologies Laboratory, ITMO University</institution><addr-line><named-content content-type="city">Saint Petersburg</named-content></addr-line><country>Russian Federation</country></aff><aff id="aff18"><label>18</label><institution>International Laboratory for Human Genome Research, National Autonomous University of Mexico</institution><addr-line><named-content content-type="city">Juriquilla</named-content></addr-line><country>Mexico</country></aff><aff id="aff19"><label>19</label><institution>Departmentof Molecular and Cellular Biology, University of Arizona</institution><addr-line><named-content content-type="city">Tucson</named-content></addr-line><country>United States</country></aff><aff id="aff20"><label>20</label><institution>Department of Mathematics, University of Oregon</institution><addr-line><named-content content-type="city">Eugene</named-content></addr-line><country>United States</country></aff><aff id="aff21"><label>21</label><institution>Big Data Institute, Li Ka Shing Centre for Health Information and Discovery, University of Oxford</institution><addr-line><named-content content-type="city">Oxford</named-content></addr-line><country>United Kingdom</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Coop</surname><given-names>Graham</given-names></name><role>Reviewing Editor</role><aff><institution>University of California, Davis</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Wittkopp</surname><given-names>Patricia J</given-names></name><role>Senior Editor</role><aff><institution>University of Michigan</institution><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="other" id="fn1"><label>§</label><p>Co-first authors are listed alphabetically</p></fn><fn fn-type="other" id="fn2"><label>#</label><p>Co-senior authors are listed alphabetically</p></fn><fn fn-type="other" id="fn3"><label>¶</label><p>Co-corresponding authors are listed alphabetically</p></fn><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn><fn fn-type="con" id="equal-contrib2"><label>‡</label><p>These authors also contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>23</day><month>06</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e54967</elocation-id><history><date date-type="received" iso-8601-date="2020-01-07"><day>07</day><month>01</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2020-06-15"><day>15</day><month>06</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, Adrion et al</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Adrion et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-54967-v3.pdf"/><abstract><p>The explosion in population genomic data demands ever more complex modes of analysis, and increasingly, these analyses depend on sophisticated simulations. Recent advances in population genetic simulation have made it possible to simulate large and complex models, but specifying such models for a particular simulation engine remains a difficult and error-prone task. Computational genetics researchers currently re-implement simulation models independently, leading to inconsistency and duplication of effort. This situation presents a major barrier to empirical researchers seeking to use simulations for power analyses of upcoming studies or sanity checks on existing genomic data. Population genetics, as a field, also lacks standard benchmarks by which new tools for inference might be measured. Here, we describe a new resource, stdpopsim, that attempts to rectify this situation. Stdpopsim is a community-driven open source project, which provides easy access to a growing catalog of published simulation models from a range of organisms and supports multiple simulation engine backends. This resource is available as a well-documented python library with a simple command-line interface. We share some examples demonstrating how stdpopsim can be used to systematically compare demographic inference methods, and we encourage a broader community of developers to contribute to this growing resource.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>simulation</kwd><kwd>reproducibility</kwd><kwd>open source</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id><institution>National Institute of General Medical Sciences</institution></institution-wrap></funding-source><award-id>R35GM119856</award-id><principal-award-recipient><name><surname>Kyriazis</surname><given-names>Christopher C</given-names></name><name><surname>Lohmueller</surname><given-names>Kirk E</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id><institution>National Institute of General Medical Sciences</institution></institution-wrap></funding-source><award-id>R01GM117241</award-id><principal-award-recipient><name><surname>Adrion</surname><given-names>Jeffrey R</given-names></name><name><surname>Kern</surname><given-names>Andrew D</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id><institution>National Institute of General Medical Sciences</institution></institution-wrap></funding-source><award-id>R01GM127348</award-id><principal-award-recipient><name><surname>Struck</surname><given-names>Travis J</given-names></name><name><surname>Gutenkunst</surname><given-names>Ryan N</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id><institution>National Institute of General Medical Sciences</institution></institution-wrap></funding-source><award-id>R00HG008696</award-id><principal-award-recipient><name><surname>Gladstein</surname><given-names>Ariella L</given-names></name><name><surname>Schrider</surname><given-names>Daniel R</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id><institution>National Institute of General Medical Sciences</institution></institution-wrap></funding-source><award-id>R35GM127070</award-id><principal-award-recipient><name><surname>Dukler</surname><given-names>Noah</given-names></name><name><surname>Siepel</surname><given-names>Adam</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000051</institution-id><institution>National Human Genome Research Institute</institution></institution-wrap></funding-source><award-id>R01HG010346</award-id><principal-award-recipient><name><surname>Dukler</surname><given-names>Noah</given-names></name><name><surname>Siepel</surname><given-names>Adam</given-names></name></principal-award-recipient></award-group><award-group id="fund7"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008398</institution-id><institution>Villum Fonden</institution></institution-wrap></funding-source><award-id>00025300</award-id><principal-award-recipient><name><surname>Gower</surname><given-names>Graham</given-names></name><name><surname>Racimo</surname><given-names>Fernando</given-names></name></principal-award-recipient></award-group><award-group id="fund8"><funding-source><institution-wrap><institution>University of California Institute for Mexico and the United States</institution></institution-wrap></funding-source><award-id>UC MEXUS-CONACYT Collaborative Grant</award-id><principal-award-recipient><name><surname>Ortega Del Vecchyo</surname><given-names>Diego</given-names></name></principal-award-recipient></award-group><award-group id="fund10"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003141</institution-id><institution>Consejo Nacional de Ciencia y Tecnología</institution></institution-wrap></funding-source><award-id>UC MEXUS-CONACYT Collaborative Grant</award-id><principal-award-recipient><name><surname>Ortega Del Vecchyo</surname><given-names>Diego</given-names></name></principal-award-recipient></award-group><award-group id="fund11"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100006087</institution-id><institution>Dirección General de Asuntos del Personal Académico, Universidad Nacional Autónoma de México</institution></institution-wrap></funding-source><award-id>PAPIIT-IA200620</award-id><principal-award-recipient><name><surname>Ortega Del Vecchyo</surname><given-names>Diego</given-names></name></principal-award-recipient></award-group><award-group id="fund9"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100013961</institution-id><institution>Robertson Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Kelleher</surname><given-names>Jerome</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>The stdpopsim library, a community-driven open source project, is presented which provides easy access to a standard catalog of published simulation models for population genetics aimed at field-wide standardization.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>While population genetics has always used statistical methods to make inferences from data, the degree of sophistication of the questions, models, data, and computational approaches used have all increased over the past two decades. Currently, there exist a myriad of computational methods that can infer the histories of populations (<xref ref-type="bibr" rid="bib21">Gutenkunst et al., 2009</xref>; <xref ref-type="bibr" rid="bib39">Li and Durbin, 2011</xref>; <xref ref-type="bibr" rid="bib15">Excoffier et al., 2013</xref>; <xref ref-type="bibr" rid="bib50">Schiffels and Durbin, 2014</xref>; <xref ref-type="bibr" rid="bib55">Terhorst et al., 2017</xref>; <xref ref-type="bibr" rid="bib47">Ragsdale and Gravel, 2019</xref>), the distribution of fitness effects (<xref ref-type="bibr" rid="bib6">Boyko et al., 2008</xref>; <xref ref-type="bibr" rid="bib34">Kim et al., 2017</xref>; <xref ref-type="bibr" rid="bib53">Tataru et al., 2017</xref>; <xref ref-type="bibr" rid="bib17">Fortier et al., 2019</xref>; <xref ref-type="bibr" rid="bib25">Huang and Siepel, 2019</xref>; <xref ref-type="bibr" rid="bib58">Vecchyo et al., 2019</xref>), recombination rates (<xref ref-type="bibr" rid="bib44">McVean et al., 2004</xref>; <xref ref-type="bibr" rid="bib9">Chan et al., 2012</xref>; <xref ref-type="bibr" rid="bib41">Lin et al., 2013</xref>; <xref ref-type="bibr" rid="bib1">Adrion et al., 2020</xref>; <xref ref-type="bibr" rid="bib57">V Barroso et al., 2019</xref>), and the extent of positive selection in genome sequence data (<xref ref-type="bibr" rid="bib35">Kim and Stephan, 2002</xref>; <xref ref-type="bibr" rid="bib16">Eyre-Walker and Keightley, 2009</xref>; <xref ref-type="bibr" rid="bib2">Alachiotis et al., 2012</xref>; <xref ref-type="bibr" rid="bib19">Garud et al., 2015</xref>; <xref ref-type="bibr" rid="bib13">DeGiorgio et al., 2016</xref>; <xref ref-type="bibr" rid="bib33">Kern and Schrider, 2018</xref>; <xref ref-type="bibr" rid="bib52">Sugden et al., 2018</xref>). While these methods have undoubtedly increased our understanding of genetic and evolutionary processes, very little has been done to systematically benchmark the quality of these inferences or their robustness to deviations from their underlying assumptions. As large databases of population genetic variation begin to be used to inform public health procedures, the accuracy and quality of these inferences is becoming ever more important.</p><p>Assessing the accuracy of inference methods for population genetics is challenging in large part because the ‘ground-truth’ in question generally comes not from direct empirical observations, as the relevant historical processes can rarely be observed, but instead from simulations. Population genetic simulations are therefore critically important to the field, yet there has been no systematic attempt to establish community standards or best practices for executing them. Instead, the general modus operandi to date has been for individual groups to validate their own methods using simulations coded from scratch. Often these simulations are more useful to showcase a novel method than to rigorously compare it with competing methods. Moreover, this situation results in a great deal of duplicated effort, and contributes to decreased reproducibility and transparency across the entire field. It is also a barrier to entry to the field, because new researchers can struggle with the many steps involved in implementing a state-of-the-art population genetics simulation, including identifying appropriate demographic models from the literature, translating them into input for a simulator, and choosing appropriate values for key population genetic parameters, such as the mutation and recombination rates.</p><p>A related issue is that it has been challenging to assess the degree to which modeling assumptions and choices of data summaries can affect population genetic inferences. Standardized simulations would enable these questions to be systematically examined. Importantly, there are clear examples of different methods yielding fundamentally different conclusions. For example, Markovian coalescent methods applied to human genomes have suggested large ancient (&gt; 100,000 years ago) ancestral population sizes and bottlenecks that have not been detected by other methods based on allele frequency spectra (see <xref ref-type="bibr" rid="bib4">Beichman et al., 2017</xref>). These distinct methods differ in how they model, summarize, and optimize fit to genetic variation data, suggesting that such design choices can greatly affect the performance of the inference. Furthermore, some methods are likely to perform better than others under certain scenarios, but researchers lack principled guidelines for selecting the best method for addressing their particular questions. The need for guidance from simulated data will only increase as researchers seek to apply population genetic methods to a growing collection of non-model taxa.</p><p>For these reasons, we have generated a standardized, community-driven resource for simulating published demographic models from a number of popular study systems. This resource, which we call <monospace>stdpopsim</monospace>, makes running realistic simulations for population genetic analysis a simple matter of choosing pre-implemented models from a community-maintained catalog. The <monospace>stdpopsim</monospace> catalog currently contains six species: humans, <italic>Pongo abelii</italic>, <italic>Canis familiaris</italic>, <italic>Drosophila melanogaster</italic>, <italic>Arabidopsis thaliana</italic>, and <italic>Escherichia coli</italic>. For each species, the catalog contains curated information on our current understanding of the physical organization of its genome, inferred genetic maps, population-level parameters (e.g. mutation rate and generation time estimates), and published demographic models. These models and parameters are meant to represent the field’s current understanding, and we intend for this resource to evolve as new results become available, and other existing models are added to <monospace>stdpopsim</monospace> by the community. We have implemented both a command line interface and a simple Python API that can be used to simulate genomic data from a choice of organism, genetic map, chromosome, and demographic history. In this way, <monospace>stdpopsim</monospace> will lower the barrier to high-quality simulation for exploratory analyses, enable rigorous evaluation of population genetic software, and contribute to increased reliability of population genetic inferences.</p><p>The <monospace>stdpopsim</monospace> library has been developed by the <monospace>PopSim</monospace> Consortium using a distributed open source model, with strong procedures in place to continue its growth and maintain quality. Importantly, we developed rigorous quality control methods to ensure that we have correctly implemented the models as described in their original publication and provided documented methods for others to contribute new models. We invite new collaborators to join our community: those interested should visit our developer documentation at <ext-link ext-link-type="uri" xlink:href="https://stdpopsim.readthedocs.io/en/latest/development.html">https://stdpopsim.readthedocs.io/en/latest/development.html</ext-link>. Below we describe the resource and give examples of how it can be used to benchmark demographic inference methods.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>The <monospace>stdpopsim</monospace> library is a community-maintained collection of empirical genome data and population genetics simulation models, illustrated in <xref ref-type="fig" rid="fig1">Figure 1</xref>. The package (<ext-link ext-link-type="uri" xlink:href="https://github.com/popsim-consortium/stdpopsim">https://github.com/popsim-consortium/stdpopsim</ext-link>) centers on a catalog of genomic information and demographic models for a growing list of species (<xref ref-type="fig" rid="fig1">Figure 1A</xref>), and software resources to facilitate efficient simulations (<xref ref-type="fig" rid="fig1">Figure 1B–C</xref>). Given the genome data and simulation model descriptions defined within the library, it is straightforward to run standardized simulations across a range of organisms. <monospace>Stdpopsim</monospace> has a Python API and a user-friendly command line interface, allowing users with minimal experience direct access to state-of-the-art simulations. Simulations are output in the ‘succinct tree sequence’ format (<xref ref-type="bibr" rid="bib29">Kelleher et al., 2016</xref>; <xref ref-type="bibr" rid="bib30">Kelleher et al., 2018</xref>; <xref ref-type="bibr" rid="bib31">Kelleher et al., 2019</xref>), which contains complete genealogical information about the simulated samples, is extremely compact, and can be processed efficiently using the tskit library (<xref ref-type="bibr" rid="bib29">Kelleher et al., 2016</xref>; <xref ref-type="bibr" rid="bib30">Kelleher et al., 2018</xref>). The tree sequence format could also be converted to other formats (e.g., VCF) by the user if desired.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Structure of stdpopsim.</title><p>(<bold>A</bold>) The hierarchical organization of the stdpopsim catalog contains all model simulation information within individual species (expanded information shown here for <italic>H. sapiens</italic> only). Each species is associated with a representation of the physical genome, and one or more genetic maps and demographic models. Dotted lines indicate that only a subset of these categories is shown. At right we show example code to specify and simulate models using (<bold>B</bold>) the python API or (<bold>C</bold>) the command line interface.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54967-fig1-v3.tif"/></fig><sec id="s2-1"><title>The species catalog</title><p>The central feature of <monospace>stdpopsim</monospace> is the species catalog, a systematic organization of the key quantitative data needed to simulate a given species. Data are currently available for humans, <italic>P. abelii</italic>, <italic>C. familiaris</italic>, <italic>D. melanogaster</italic>, <italic>A. thaliana</italic>, and <italic>E. coli</italic>. A species definition consists of two key elements. Firstly, the library defines some basic information about our current understanding of each species’ genome, including information about chromosome lengths, average mutation rate estimates, and generation times. We also provide access to detailed empirical information such as inferred genetic maps, which model observed heterogeneity in recombination rate along chromosomes. Such maps are often large, so we do not distribute them directly with the software, but make them available for download in a standard format. When a simulation using such a map is requested by the user, <monospace>stdpopsim</monospace> will transparently download the map data into a local cache, where it can be quickly retrieved for subsequent simulations. In the initial version of <monospace>stdpopsim,</monospace> we support the HapMapII (<xref ref-type="bibr" rid="bib18">Frazer et al., 2007</xref>) and deCODE (<xref ref-type="bibr" rid="bib36">Kong et al., 2010</xref>) genetic maps for humans; the <xref ref-type="bibr" rid="bib46">Nater et al., 2017</xref> maps for <italic>P. abelii</italic>; the <xref ref-type="bibr" rid="bib8">Campbell et al., 2016</xref> map for <italic>C. familiaris</italic>; the <xref ref-type="bibr" rid="bib49">Salomé et al., 2012</xref> map for <italic>A. thaliana</italic>; and the <xref ref-type="bibr" rid="bib10">Comeron et al., 2012</xref> map for <italic>D. melanogaster</italic>. Adding further maps to the library is straightforward. The second key element of a species description within <monospace>stdpopsim</monospace> is a set of carefully curated population genetic model descriptions from the literature, which allow simulation under specific historical scenarios that have been fit to present-day patterns of genetic variation (see the Materials and methods for a description of the community development and quality-control process for these models.)</p><p>The current demographic models in the <monospace>stdpopsim</monospace> catalog are shown in <xref ref-type="table" rid="table1">Table 1</xref>. <italic>Homo sapiens</italic> currently has the richest selection of population models. These include: a simplified version of the <xref ref-type="bibr" rid="bib54">Tennessen et al., 2012</xref> model with only the African population specified (expansion from the ancestral population and recent growth; <monospace>Africa_1T12</monospace>); the three-population model of <xref ref-type="bibr" rid="bib21">Gutenkunst et al., 2009</xref>, which specifies the out-of-Africa bottleneck as well as the subsequent divergence of the European and Asian populations (OutOfAfrica_3G09); the <xref ref-type="bibr" rid="bib54">Tennessen et al., 2012</xref> two-population variant of the Gutenkunst et al. model, which does not include Asian populations but more explicitly models recent rapid human population growth in Europe (<monospace>OutOfAfrica_2T12</monospace>); the <xref ref-type="bibr" rid="bib7">Browning et al., 2018</xref> admixture model for American populations, which specifies ancestral African, European, and Asian population components (<monospace>AmericanAdmixture_4B11</monospace>); a three-population out-of-Africa model from <xref ref-type="bibr" rid="bib47">Ragsdale and Gravel, 2019</xref>, which includes archaic admixture (<monospace>OutOfAfricaArchaicAdmixture_5R19</monospace>); a complex model of ancient Eurasian admixture from <xref ref-type="bibr" rid="bib28">Kamm et al., 2019</xref> (<monospace>AncientEurasia_9K19</monospace>); and a synthetic model of oscillating population size from <xref ref-type="bibr" rid="bib50">Schiffels and Durbin, 2014</xref> (<monospace>Zigzag_1S14</monospace>).</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Initial set of demographic models in the catalog and summary of computing resources needed for simulation.</title><p>For each model, we report the CPU time, maximum memory usage and the size of the output tskit file, as simulated using the msprime simulation engine (version 0.7.4). In each case, we simulate 100 samples drawn from the first population, for the shortest chromosome of that species and a constant chromosome-specific recombination rate. The times reported are for a single run on an Intel i5-7600K CPU. Computing resources required will vary widely depending on sample sizes, chromosome length, recombination rates and other factors.</p></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top">Model ID</th><th valign="top">Citation</th><th valign="top">CPU(s)</th><th valign="top">Ram(MB)</th><th valign="top">File(MB)</th></tr></thead><tbody><tr><td valign="top">HomSap (<italic>Homo sapiens</italic>)</td><td valign="top"/><td valign="top"/><td valign="top"/><td valign="top"/></tr><tr><td valign="top"> Africa_1T12</td><td valign="top"><xref ref-type="bibr" rid="bib54">Tennessen et al., 2012</xref></td><td valign="top">10.0</td><td valign="top">194.2</td><td valign="top">23.3</td></tr><tr><td valign="top"> Zigzag_1S14</td><td valign="top"><xref ref-type="bibr" rid="bib50">Schiffels and Durbin, 2014</xref></td><td valign="top">3.3</td><td valign="top">106.1</td><td valign="top">7.9</td></tr><tr><td valign="top"> AshkSub_7G19</td><td valign="top"><xref ref-type="bibr" rid="bib20">Gladstein and Hammer, 2019</xref></td><td valign="top">13.8</td><td valign="top">216.3</td><td valign="top">26.4</td></tr><tr><td valign="top"> OutOfAfrica_3G09</td><td valign="top"><xref ref-type="bibr" rid="bib21">Gutenkunst et al., 2009</xref></td><td valign="top">10.2</td><td valign="top">182.0</td><td valign="top">21.1</td></tr><tr><td valign="top"> OutOfAfrica_2T12</td><td valign="top"><xref ref-type="bibr" rid="bib54">Tennessen et al., 2012</xref></td><td valign="top">10.7</td><td valign="top">198.4</td><td valign="top">24.1</td></tr><tr><td valign="top"> AncientEurasia_9K19</td><td valign="top"><xref ref-type="bibr" rid="bib28">Kamm et al., 2019</xref></td><td valign="top">63.1</td><td valign="top">304.4</td><td valign="top">41.2</td></tr><tr><td valign="top"> AmericanAdmixture_4B11</td><td valign="top"><xref ref-type="bibr" rid="bib7">Browning et al., 2018</xref></td><td valign="top">10.6</td><td valign="top">188.1</td><td valign="top">22.3</td></tr><tr><td valign="top"> PapuansOutOfAfrica_10J19</td><td valign="top"><xref ref-type="bibr" rid="bib27">Jacobs et al., 2019</xref></td><td valign="top">204.5</td><td valign="top">524.7</td><td valign="top">77.8</td></tr><tr><td valign="top"> OutOfAfricaArchaicAdmixture_5R19</td><td valign="top"><xref ref-type="bibr" rid="bib47">Ragsdale and Gravel, 2019</xref></td><td valign="top">8.8</td><td valign="top">185.4</td><td valign="top">21.7</td></tr><tr><td valign="top">DroMel (<italic>Drosophila melanogaster</italic>)</td><td valign="top"/><td valign="top"/><td valign="top"/><td valign="top"/></tr><tr><td valign="top"> OutOfAfrica_2L06</td><td valign="top"><xref ref-type="bibr" rid="bib40">Li and Stephan, 2006</xref></td><td valign="top">252.8</td><td valign="top">678.0</td><td valign="top">106.7</td></tr><tr><td valign="top"> African3Epoch_1S16</td><td valign="top"><xref ref-type="bibr" rid="bib51">Sheehan and Song, 2016</xref></td><td valign="top">3.0</td><td valign="top">123.9</td><td valign="top">11.5</td></tr><tr><td valign="top">AraTha (<italic>Arabidopsis thaliana</italic>)</td><td valign="top"/><td valign="top"/><td valign="top"/><td valign="top"/></tr><tr><td valign="top"> African2Epoch_1H18</td><td valign="top"><xref ref-type="bibr" rid="bib26">Huber et al., 2018</xref></td><td valign="top">4.3</td><td valign="top">220.5</td><td valign="top">16.5</td></tr><tr><td valign="top"> African3Epoch_1H18</td><td valign="top"><xref ref-type="bibr" rid="bib26">Huber et al., 2018</xref></td><td valign="top">2.6</td><td valign="top">241.3</td><td valign="top">18.4</td></tr><tr><td valign="top">PonAbe (<italic>Pongo abelii</italic>) </td><td valign="top"/><td valign="top"/><td valign="top"/><td valign="top"/></tr><tr><td rowspan="2" valign="top"> TwoSpecies_2L11</td><td valign="top"><xref ref-type="bibr" rid="bib43">Locke et al., 2011</xref></td><td rowspan="2" valign="top">7.2</td><td rowspan="2" valign="top">171.9</td><td rowspan="2" valign="top">14.7</td></tr></tbody></table></table-wrap><p>For <italic>D. melanogaster</italic>, we have implemented the three-epoch model estimated by <xref ref-type="bibr" rid="bib51">Sheehan and Song, 2016</xref> from an African sample (<monospace>African3Epoch_1S16</monospace>), as well as the out-of-Africa divergence and associated bottleneck model of <xref ref-type="bibr" rid="bib40">Li and Stephan, 2006</xref>, which jointly models African and European populations (<monospace>OutOfAfrica_2L06</monospace>). For <italic>A. thaliana</italic>, we implemented the model in <xref ref-type="bibr" rid="bib14">Durvasula et al., 2017</xref> inferred using <monospace>MSMC</monospace>. This model includes a continuous change in population size over time, rather than pre-specified epochs of different population sizes (<monospace>SouthMiddleAtlas_1D17</monospace>). We have also implemented a two-epoch and a three-epoch model estimated from African samples of <italic>A. thaliana</italic> in <xref ref-type="bibr" rid="bib26">Huber et al., 2018</xref> (<monospace>African2Epoch_1H18</monospace> and <monospace>African3Epoch_1H18</monospace>).</p><p>In addition to organism-specific models, <monospace>stdpopsim</monospace> also includes a generic piecewise constant size model and isolation with migration (IM) model which can be used with any genome and genetic map. Together, these models contain many features believed to affect observed patterns of polymorphism (e.g. bottlenecks, population growth, admixture) and therefore provide useful benchmarks for method development.</p><p>To guarantee reproducibility, we have standardized naming conventions for species, genetic maps, and demographic models that will enable long-term stability of unique identifiers used throughout <monospace>stdpopsim</monospace>, as described in our documentation (<ext-link ext-link-type="uri" xlink:href="https://stdpopsim.readthedocs.io/en/latest/development.html#naming-conventions">https://stdpopsim.readthedocs.io/en/latest/development.html#naming-conventions</ext-link>).</p></sec><sec id="s2-2"><title>Simulation engines</title><p>Currently, <monospace>stdpopsim</monospace> uses the <monospace>msprime</monospace> coalescent simulator (<xref ref-type="bibr" rid="bib29">Kelleher et al., 2016</xref>) as the default simulation engine. Coalescent simulations, while highly efficient, are limited in their ability to model continuous geography or complex selection scenarios, such as recurrent sweeps and background selection. For these reasons, we have also implemented the forward-time simulator, <monospace>SLiM</monospace> (<xref ref-type="bibr" rid="bib23">Haller and Messer, 2019</xref>; <xref ref-type="bibr" rid="bib23">Haller and Messer, 2019</xref>), as an alternative backend engine to <monospace>stdpopsim</monospace>, allowing for the simulation of processes that cannot be modeled under the coalescent. However, as forward-time simulators explicitly model all individuals in a population, simulating large population sizes can be highly demanding of computational resources. One common practice used to address this challenge is to simulate a <italic>smaller</italic> population, but to rescale resulting times, mutation rates, recombination rates, and selection coefficients so that the intensity of mutation, recombination, and allele frequency change due to selection per unit time remains the same (see the <monospace>SLiM</monospace> manual and <xref ref-type="bibr" rid="bib56">Uricchio and Hernandez, 2014</xref>). Our implementation of the <monospace>SLiM</monospace> backend allows easy use of this <italic>rescaling</italic> through a single ‘scaling factor’ argument. Such down-scaled simulations are not completely equivalent to simulating all individuals in the population, and may lead to subtle differences, especially in the presence of selection. However, since many sequence-based measures of population diversity remain nearly unchanged when rescaling in this fashion, this practice is effective for many purposes and widely employed.</p><p>We validated our implementation of the <monospace>SLiM</monospace> engine by comparing estimates of several population genetic summary statistics for neutral simulations generated by both <monospace>SLiM</monospace> and msprime. Examples of this validation for the <monospace>AncientEurasia_9K19</monospace> model (<xref ref-type="bibr" rid="bib28">Kamm et al., 2019</xref>) are shown in <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref> and <xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref>. For this model, down-scaling factors of up to 10 produce patterns of both diversity and linkage disequilibrium that are indistinguishable from those observed under the coalescent (i.e. msprime). Scaling down by a factor of 50 does appear to modify the distribution of these sequence statistics. Interestingly, the apparent difference between distributions is somewhat larger when simulating using a uniform recombination rate (<xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref>), likely due to the lower variation in the values of these statistics. Importantly, both comparisons validate the equivalence of SLiM and msprime when no down-scaling is applied. The results are also optimistic about the rescaling strategy to reduce computational burden, but the possible effects are not well-understood, so results relying on rescaled simulations should be carefully validated.</p></sec><sec id="s2-3"><title>Documentation and reproducibility</title><p>The <monospace>stdpopsim</monospace> command-line interface, by default, outputs citation information for the models, genetic maps, and simulation engines used in any particular run. We hope that this feature will encourage users to appropriately acknowledge the resources used in published work, and encourage authors publishing demographic models to contribute to our ongoing community-driven development process. Together with the <monospace>stdpopsim</monospace> version number and the long-term stable identifiers for population models and genetic maps, this citation information will result in well-documented and reproducible simulation workflows. The individual tree sequence files produced by <monospace>stdpopsim</monospace> also contain complete provenance information including the command line arguments, operating system environment and versions of key libraries used.</p></sec><sec id="s2-4"><title>Use case: comparing methods of demographic inference</title><p>As an example of the utility of <monospace>stdpopsim</monospace>, we demonstrate how it can be easily used to perform a fair comparison of popular demographic inference methods. Although we present comparison of results from several methods, our aim at this stage is not to provide an exhaustive evaluation or ranking of these methods. Our hope is instead to demonstrate how <monospace>stdpopsim</monospace> will facilitate more detailed future explorations of the strengths and weaknesses of the numerous inference methods that are available to the population genetics community (see Discussion).</p><p>We start by comparing popular methods for estimating population size histories of single populations and subsequently show simple examples of multi-population inference. To reproducibly evaluate and compare the performance of inference methods, we developed workflows using <monospace>snakemake</monospace> (<xref ref-type="bibr" rid="bib37">Köster and Rahmann, 2012</xref>), available from <ext-link ext-link-type="uri" xlink:href="https://github.com/popsim-consortium/analysis">https://github.com/popsim-consortium/analysis</ext-link>, that allow efficient computing in multicore or cluster environments. Our workflow generates <inline-formula><mml:math id="inf1"><mml:mi>R</mml:mi></mml:math></inline-formula> replicates of <inline-formula><mml:math id="inf2"><mml:mi>C</mml:mi></mml:math></inline-formula> chromosomes, producing <inline-formula><mml:math id="inf3"><mml:mi>n</mml:mi></mml:math></inline-formula> population samples in each of a total of <inline-formula><mml:math id="inf4"><mml:mrow><mml:mi>R</mml:mi><mml:mo>×</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula> simulations for each demographic model. After simulation, the workflow prepares input files for each inference method by grouping all <inline-formula><mml:math id="inf5"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>R</mml:mi><mml:mo>×</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula> simulated chromosomes into a single file. Each file is then converted into an input file appropriate for each inference method (such that all inference methods run on the same simulation replicates). Each of the inference programs are then run in parallel, and finally, estimates of population size history from each program are plotted.</p><sec id="s2-4-1"><title>Single-population demographic models</title><p>For single-population demographic models, we compared <monospace>MSMC</monospace> (<xref ref-type="bibr" rid="bib50">Schiffels and Durbin, 2014</xref>), SMC++ (<xref ref-type="bibr" rid="bib55">Terhorst et al., 2017</xref>), and <monospace>stairway plot</monospace> (<xref ref-type="bibr" rid="bib42">Liu and Fu, 2015</xref>) on simulated genomes sampled from a single population, under several of the demographic models described above. However, these experiments raise the question of what to use as the ‘true’ population sizes in the case of multi-population models with migration. In particular, a simple single-population model that is fit to data simulated under a multi-population model, is not expected to recover the actual simulated population sizes because of model misspecification. Instead, we argue that the best one may expect in such a scenario is to infer a model that accurately reflects the coalescence time distribution of the simulated model. Under a multi-population model, the coalescence time distribution is influenced by migration between the target population and populations not analyzed in inference, as well as by the ancestral effective population sizes. The inverse coalescence rate is commonly interpreted as the effective population size, since these are equal in a single-population model with random mating. We thus analytically computed inverse coalescence rates in <monospace>msprime</monospace> for each simulated model, and used them as benchmarks for the ‘true’ effective population sizes. See the Appendix for a precise definition and description of the inverse coalescence rate computation.</p><p><xref ref-type="fig" rid="fig2">Figure 2</xref> presents the results from simulations under <monospace>OutOfAfricaArchaicAdmixture_5R19</monospace>, a model of human migration out of Africa that includes archaic admixture (<xref ref-type="bibr" rid="bib47">Ragsdale and Gravel, 2019</xref>), along with an empirical genetic map.In each column of this figure we show the inferred population size history (denoted <inline-formula><mml:math id="inf6"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) from samples taken from each of the three extant populations in the model. In each row we show comparisons among the methods (including two sample sizes for MSMC). Blue lines show estimates from each of three replicate whole genome simulations, and black lines indicate the ‘true’ values depicted by the inverse coalescence rates (although in this specific model the inverse coalescence rates are very close to the simulated population sizes; <xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3</xref>). While there is variation in accuracy among methods, populations, and individual replicates, the methods generally produce a good estimate of the true effective population sizes of the simulations, with inferred values mostly within a factor of two of the truth, and most methods inferring a bottleneck at approximately the correct time.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Comparing estimates of <inline-formula><mml:math id="inf7"><mml:mrow><mml:mi>N</mml:mi><mml:mo mathvariant="bold">⁢</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in humans.</title><p>Here we show estimates of population size over time (<inline-formula><mml:math id="inf8"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) inferred using four different methods: smc++, stairway plot, and MSMC with <inline-formula><mml:math id="inf9"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf10"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula> samples. Data were generated by simulating replicate human genomes under the <monospace>OutOfAfricaArchaicAdmixture_5R19</monospace> model (<xref ref-type="bibr" rid="bib47">Ragsdale and Gravel, 2019</xref>) and using the <monospace>HapMapII_GRCh37</monospace> genetic map (<xref ref-type="bibr" rid="bib18">Frazer et al., 2007</xref>). From top to bottom, we show estimates for each of the three populations in the model (YRI, CEU, and CHB). In shades of blue we show the estimated <inline-formula><mml:math id="inf11"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> trajectories for each of three replicates. As a proxy for the ‘truth’, in black we show inverse coalescence rates as calculated from the demographic model used for simulation (see text).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54967-fig2-v3.tif"/></fig><p>Using <monospace>stdpopsim</monospace>, we can readily compare performance on this benchmark to that based on a different model of human history. In <xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4</xref>, we show estimates of <inline-formula><mml:math id="inf12"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> from simulations using the same physical and genetic maps, but from the <monospace>OutOfAfrica_3G09</monospace> demographic model that does not include archaic admixture. Again we see that each of the methods is capturing relevant parts of the population history, although the accuracy varies across time. In comparing inferences between the models it is interesting to note that <inline-formula><mml:math id="inf13"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> estimates for the CHB and CEU simulated populations are generally better across methods than estimates from the YRI simulated population.</p><p>We can also see how well methods might do at recovering the population history of a constant-sized population, with human genome architecture and genetic map. We show results of such an experiment in <xref ref-type="fig" rid="app1fig5">Appendix 1—figure 5</xref>. All methods recover population size within a factor of two of the simulated values; however, SMC-based methods tend to infer sinusoidal patterns of population size even though no such change is present.</p><p>As most method development for population genetics has been focused on human data, it is important to ask how such methods might perform in non-human genomes. <xref ref-type="fig" rid="fig3">Figure 3</xref> shows parameter estimates from the African3Epoch_1S16 model, originally estimated from an African sample of <italic>D. melanogaster</italic> (<xref ref-type="bibr" rid="bib51">Sheehan and Song, 2016</xref>), and <xref ref-type="fig" rid="app1fig6">Appendix 1—figure 6</xref> shows estimates from simulations of <italic>A. thaliana</italic> under the African2Epoch_1H18 model originally inferred by <xref ref-type="bibr" rid="bib26">Huber et al., 2018</xref>. In both cases, as with humans, we use stdpopsim to simulate replicate genomes using an empirically-derived genetic map, and try to infer back parameters of the simulation model. Accuracy is mixed among methods when doing inference on simulated data from these <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> models, and generally worse than what we observe for simulations of the human genome.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Comparing estimates of <inline-formula><mml:math id="inf14"><mml:mrow><mml:mi>N</mml:mi><mml:mo mathvariant="bold">⁢</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in <italic>Drosophila</italic>.</title><p>Population size over time (<inline-formula><mml:math id="inf15"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) estimated from an African population sample. Data were generated by simulating replicate <italic>D. melanogaster</italic> genomes under the African3Epoch_1S16 model (<xref ref-type="bibr" rid="bib51">Sheehan and Song, 2016</xref>) with the genetic map of <xref ref-type="bibr" rid="bib10">Comeron et al., 2012</xref>. In shades of blue we show the estimated <inline-formula><mml:math id="inf16"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> trajectories for each replicate. As a proxy for the ‘truth’, in black we show inverse coalescence rates as calculated from the demographic model used for simulation (see text).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54967-fig3-v3.tif"/></fig></sec><sec id="s2-4-2"><title>Multi-population demographic models</title><p>As <monospace>stdpopsim</monospace> implements multi-population demographic models, we also explored parameter estimation of population divergence parameters. In particular, we simulated data under multi-population models for humans and <italic>D. melanogaster</italic> and then inferred parameters using <inline-formula><mml:math id="inf17"><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <monospace>fastsimcoal2</monospace>, and <monospace>smc++</monospace>. For simplicity, we conducted inference in <inline-formula><mml:math id="inf18"><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <monospace>fastsimcoal2</monospace> by fitting an isolation with migration (IM) model with constant population sizes and bi-directional migration (<xref ref-type="bibr" rid="bib24">Hey and Nielsen, 2004</xref>). Our motivation for fitting this simple IM model was to mimic the typical approach of two population inference on empirical data, where the user is not aware of the ‘true’ underlying demography and the inference model is often misspecified. For human models with more than two populations (e.g. <xref ref-type="bibr" rid="bib21">Gutenkunst et al., 2009</xref>) this limitation means that users are inferring parameters for a model that does not match the model from which the data were generated (<xref ref-type="fig" rid="fig4">Figure 4A and B</xref>). However, since the model used for inference also allows gene flow between populations, we directly compare estimated effective population sizes to the values used in simulations (black line in <xref ref-type="fig" rid="fig4">Figure 4C</xref>) and not the inverse coalescence rates.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Parameters estimated using a multi-population human model.</title><p>Here we show estimates of <inline-formula><mml:math id="inf19"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> inferred using <inline-formula><mml:math id="inf20"><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, fastsimcoal2, and smc++. (<bold>A</bold>) Data were generated by simulating replicate human genomes under the OutOfAfrica_3G09 model and using the HapMapII_GRCh37 genetic map inferred in <xref ref-type="bibr" rid="bib18">Frazer et al., 2007</xref>. (<bold>B</bold>) For <inline-formula><mml:math id="inf21"><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and fastsimcoal2 we show parameters inferred by fitting the depicted IM model, which includes population sizes, migration rates, and a split time between CEU and YRI samples. (<bold>C</bold>) Population size estimates for each population (rows) from <inline-formula><mml:math id="inf22"><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, fastsimcoal2, and smc++ (columns). In shades of blue we show <inline-formula><mml:math id="inf23"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> trajectories estimated from each simulation, and in black simulated population sizes for the respective population. The population split time, <inline-formula><mml:math id="inf24"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, is shown at the bottom (simulated value in black and inferred values in blue), with a common <inline-formula><mml:math id="inf25"><mml:mi>x</mml:mi></mml:math></inline-formula>-axis to the population size panels.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54967-fig4-v3.tif"/></fig><p>In <xref ref-type="fig" rid="fig4">Figure 4C</xref>, we show estimates of population sizes and divergence time, for each of the inference methods, using samples drawn from African and European populations simulated under the <monospace>OutOfAfrica_3G09</monospace> model. Our results highlight many of the strengths and weaknesses of the different methods. For instance, the SFS-based approaches with simple IM models do not capture recent exponential growth in the CEU population, but do consistently recover the simulated YRI population size history. Moreover, these approaches allow migration rates to be estimated (<xref ref-type="fig" rid="app1fig7">Appendix 1—figure 7</xref>), and lead to more accurate inferences of divergence times. However, these migration rate estimates are somewhat biased. In contrast, <monospace>smc++</monospace> is much better at capturing the recent exponential growth in the CEU population, though it consistently underestimates divergence times because it assumes no migration between populations (<xref ref-type="fig" rid="fig4">Figure 4C</xref>).</p><p>Again, we can extend this analysis to other taxa and examine the performance of these methods for a two-population model of <italic>D. melanogaster</italic>. <xref ref-type="fig" rid="app1fig8">Appendix 1—figure 8</xref> shows inference results using data simulated under the <monospace>OutOfAfrica_2L06</monospace> model. This model includes an ancestral population in Africa from which a European population splits off following a bottleneck, with no post-divergence gene flow between the African and European population (<xref ref-type="fig" rid="app1fig8">Appendix 1—figure 8A</xref>). Here again, we find that <inline-formula><mml:math id="inf26"><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <monospace>fastsimcoal2</monospace> infer more consistent histories, but they do not detect the brief bottleneck in Europe, due to the inference model not allowing for population size changes after the population split. In addition, <inline-formula><mml:math id="inf27"><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <monospace>fastsimcoal2</monospace> both do reasonably well at correctly inferring the absence of migration (<xref ref-type="fig" rid="app1fig9">Appendix 1—figure 9</xref>). In contrast, the inferred demographic parameters from <monospace>smc++</monospace> are more noisy, though in some cases better capture the short bottleneck in the European population.</p><p>Although these results do not represent an exhaustive benchmarking, we have begun to highlight some of the strengths and weaknesses of these methods. Future work should build on these results and undertake more in-depth comparisons under a wider range of simulated demographic models.</p></sec></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Here, we have described the first major product from the <monospace>PopSim</monospace> Consortium: the <monospace>stdpopsim</monospace> library. We have founded the Consortium with a number of specific goals in mind: standardization of simulation within the population genetics community, increased reproducibility and ease of use of complex simulations, community-based development and decision making guiding best practices in population genetics, and benchmarking of inference methods.</p><p>The <monospace>stdpopsim</monospace> library allows for rigorous standardization of complex population genetic simulations. Population genetics, as a field, has yet to coalesce around a set of standards for the crucial task of method evaluation, which in our discipline hinges on simulation. In contrast, other fields such as structural biology (<xref ref-type="bibr" rid="bib45">Moult et al., 1995</xref>) and machine learning <xref ref-type="bibr" rid="bib48">Russakovsky et al., 2015</xref> have a long track record of standardized method testing. We hope that our efforts represent the beginning of what will prove to be an equally longstanding and valuable tradition in population genetics.</p><p>Besides being a resource for developers of computational methods, we aim for <monospace>stdpopsim</monospace> to be a resource for empirical researchers using genomic data. For instance, <monospace>stdpopsim</monospace> could be used in power analyses to determine adequate sample sizes, or in sanity checks to see if observed data (e.g. levels of divergence or the allele frequency spectrum) are roughly consistent with the hypothesized scenario. Currently, many studies would benefit from such simulation-based checks. However, there are major barriers to implementation, since individual research groups must reimplement complex, previously published demographic models, a task made especially daunting by additional layers of realism (e.g. recombination maps).</p><sec id="s3-1"><title>Benchmarking population size inference</title><p>We have illustrated in this paper how <monospace>stdpopsim</monospace> can be used for direct comparisons of inferential methods on a common set of simulations. Our benchmarking comparisons have been limited, but nevertheless reveal some informative features. For example, at the task of estimating population size histories for simulated human populations, we find that the sequence-based methods (<monospace>MSMC</monospace> and <monospace>smc++</monospace>) perform somewhat better overall—at least for moderate times in the past—than the site frequency spectrum-based method (<monospace>stairway plot</monospace>), which tends to over-estimate the sizes of oscillations (<xref ref-type="fig" rid="fig2">Figure 2</xref> and <xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4</xref>). In contrast, stairway plot outperforms the sequence-based methods on simulations of <italic>D. melanogaster</italic> or <italic>A. thaliana</italic> populations, in which linkage disequilibrium is reduced (<xref ref-type="fig" rid="fig3">Figure 3</xref> and <xref ref-type="fig" rid="app1fig6">Appendix 1—figure 6</xref>). In simulations of two human populations (<xref ref-type="fig" rid="fig4">Figure 4</xref>), <inline-formula><mml:math id="inf28"><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and fastsimcoal2 do reasonably well at reconstructing the simulated YRI history and estimating divergence times, but struggle with the more complex simulated CEU history, in large part because the methods assume constant population sizes. On the other hand, smc++ does not have the same restrictions on its inferred history, and as a result does much better with the CEU history but tends to underestimate divergence times due to the assumption of no migration. The results for the two-population <italic>D. melanogaster</italic> model (<xref ref-type="fig" rid="app1fig8">Appendix 1—figure 8</xref>) are generally similar. In these comparisons, fastsimcoal2 and <inline-formula><mml:math id="inf29"><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> perform almost identically, which is expected because they fit the same models to the same summaries of the data, differing only in how they calculate model expectations and optimize parameters.</p><p>All methods for inferring demographic history have strengths and weaknesses (as recently reviewed by <xref ref-type="bibr" rid="bib5">Beichman et al., 2018</xref>). We compared inferences from simulated whole genome data, but many factors affect choice of methodology. Markovian coalescent methods (MSMC and smc++) require long contiguous stretches of sequence data. In contrast, frequency spectrum methods (stairway plot, <inline-formula><mml:math id="inf30"><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, and <monospace>fastsimcoal2</monospace>) can use reduced-representation sequencing data, such as RADseq (<xref ref-type="bibr" rid="bib3">Andrews et al., 2016</xref>). <inline-formula><mml:math id="inf31"><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <monospace>fastsimcoal2</monospace> require a pre-specified parametric model, unlike <monospace>MSMC</monospace>, <monospace>smc++</monospace>, and stairway plot. Using a parametric approach yields less noisy results, but a model that is too simple may not capture important demographic events (<xref ref-type="fig" rid="fig4">Figure 4</xref> and <xref ref-type="fig" rid="app1fig8">Appendix 1—figure 8</xref>), and other forms of model misspecification may also produce undesirable behavior. From a software engineering perspective, methods also differ in their ease of installation and use. We hope our workflows will assist in the application of all the methods we have considered.</p><p>Altogether, these preliminary experiments highlight the utility of <monospace>stdpopsim</monospace> for comparing a variety of inference methods on the same footing, under a variety of different demographic models. In addition, the ability of <monospace>stdpopsim</monospace> to generate data with and without significant features, such as a genetic map or population-size changes (e.g., <xref ref-type="fig" rid="app1fig5">Appendix 1—figure 5</xref>), allows investigation of the failure modes of popular methods. Moreover the comparison of methods across the various genome organizations, genetic maps, and demographic histories of different organisms, provides valuable information about how methods might perform on non-human systems. Finally, comparison of results across methods or simulation runs provides an estimate of inference uncertainty, analogous to parametric bootstrapping, especially when different methods are vulnerable to model misspecification in different ways.</p></sec><sec id="s3-2"><title>Next steps</title><p><monospace>Stdpopsim</monospace> is intended to be a fully open, community-developed project. Our implementations of genome representations and genetic maps for the some of the most common study systems in computational genetics—humans, <italic>Drosophila</italic>, and <italic>Arabidopsis</italic> (among others)—are only intended to be a starting point for future development. Researchers are invited to contribute to the resource by adding their organisms and models of choice. The <monospace>stdpopsim</monospace> resource is accompanied by clearly documented standard operating procedures that are intended to minimize barriers to entry for new developers. In this way, we expect the resource to expand and adapt to meet the evolving needs of the population genomics community.</p><p>One of our goals is to engage research communities studying other taxa, so as to expand the resource to many more species. Although we have included demographic models and recombination maps, there are many biological processes that we do not model. Some of the additions that we are enthusiastic to add are: selection (including distributions of fitness effects, maps of functional elements, both single and recurrent hitchhiking events, and selection on polygenic traits), gene conversion, mutation models (rate heterogeneity), more realistic demography (overlapping generations, separate sexes, mortality/fecundity schedules), geographic population structure, and downstream aspects of data quality (genotyping and mapping error). Moreover, an in-depth investigation into the effects of population-size rescaling under many of the above scenarios is warranted, given our preliminary findings using neutral simulations (<xref ref-type="fig" rid="app1fig1">Appendix 1—figures 1</xref> and <xref ref-type="fig" rid="app1fig2">2</xref>). Some other important processes are more challenging to model with current simulation software, such as structural variation, changing recombination maps over time, transposable elements, and context-dependent mutation.</p><p>We wish to emphasize that although the included demographic histories are some of the most widely used models for our current set of species, we anticipate the set of available models to expand as new methods and new modeling frameworks are developed. For instance, the current models all describe a small set of discrete, randomly mating populations, which are likely good approximations for deep-time population history, but may be less useful for methods describing dynamics of contemporary populations. <monospace>Stdpopsim’s</monospace> framework is sufficiently general that more realistic population models will be easily incorporated, as they are published. Additional aspects of the framework, such as genome builds, will also continue to change as improvements are made to our understanding of genome structure.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Model quality control</title><p>As a consortium we have agreed to a standardized procedure for model inclusion into <monospace>stdpopsim</monospace> that allows for rigorous quality control. Imagine Developer A wants to introduce a new model into <monospace>stdpopsim</monospace>. Developer A implements the demographic model for the relevant organism along with clear documentation of the model parameters and populations. This model is submitted as a ‘pull request’, where it is evaluated by a reviewer and then included as ‘preliminary’, but is not linked to the online documentation nor the command line interface. Developer A submits a quality control (QC) issue, after which a second developer, Developer B (perhaps found by requesting review from the broader Consortium), then independently reimplements the model from the relevant primary sources and adds an automatic unit test for equality between the QC implementation and the preliminary production model. If the two implementations are equivalent, the original model is included in <monospace>stdpopsim</monospace>. If not, we move to an arbitration process whereby A and B first try to work out the details of what went wrong. If that fails, the original authors of the published model must be contacted to resolve ambiguities. Further details of our QC process can be found in our developer documentation (<ext-link ext-link-type="uri" xlink:href="https://stdpopsim.readthedocs.io/en/latest/development.html">https://stdpopsim.readthedocs.io/en/latest/development.html</ext-link>).</p><p>The possibility for error and the importance of careful qualty control was illustrated very clearly during our own development process: while carrying out the final revisions of this paper, we noticed that the <monospace>OutOfAfrica_3G09</monospace> model (<xref ref-type="bibr" rid="bib21">Gutenkunst et al., 2009</xref>) had not gone through our QC process. The subsequent QC revealed that our implementation was in fact slightly wrong—migration rates had not been set to zero to the European population in the most ancient time period when there should have only been a single population. This error was propagated from the msprime documentation, where the model was presented as an illustrative example. A number of studies have been published using copies of this erroneous example code.</p></sec><sec id="s4-2"><title>Workflow for analysis of simulated data</title><p>To demonstrate the utility of <monospace>stdpopsim</monospace> we created <monospace>Snakemake</monospace> workflows (<xref ref-type="bibr" rid="bib37">Köster and Rahmann, 2012</xref>) that perform demographic inference on tree sequence output from our package using a few common software packages (see <xref ref-type="fig" rid="app1fig10">Appendix 1—figure 10</xref> for an example workflow). Our choice of <monospace>Snakemake</monospace> allows complete reproducibility of the analyses shown, and all code is available from <ext-link ext-link-type="uri" xlink:href="https://github.com/popsim-consortium/analysis">https://github.com/popsim-consortium/analysis</ext-link>.</p><p>We performed two types of demographic inference. Our first task was to infer effective population size over time (denoted <inline-formula><mml:math id="inf32"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>). This was done using three software packages: <monospace>stairway plot</monospace>, which uses site frequency spectrum information only (<xref ref-type="bibr" rid="bib42">Liu and Fu, 2015</xref>); <monospace>MSMC</monospace> (<xref ref-type="bibr" rid="bib50">Schiffels and Durbin, 2014</xref>), which is based on the sequentially Markovian coalescent (SMC), run with two different sample sizes (<inline-formula><mml:math id="inf33"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>); and <monospace>smc++</monospace> (<xref ref-type="bibr" rid="bib55">Terhorst et al., 2017</xref>), which combines information from the site frequency spectrum with recombination information as in SMC-based methods. No attempt was made at trying to optimize the analysis from any particular software package, as our goal was not to benchmark performance of methods but instead show how such benchmarking could be easily done using the <monospace>stdpopsim</monospace> resource. In this spirit, we ran each software package as near to default parameters as possible. For <monospace>stairway plot,</monospace> we set the parameters <monospace>numRuns = 1</monospace> and <monospace>dimFactor = 5000</monospace>. For <monospace>smc++</monospace> we used the ‘estimate’ run mode to infer <inline-formula><mml:math id="inf34"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with all other parameters set to their default values. For <monospace>MSMC,</monospace> we used the <monospace>--fixedRecombination</monospace> option and used the default number of iterations.</p><p>For the single-population task, we ran human (<monospace>HomSap</monospace>) simulations using a variety of models (see <xref ref-type="table" rid="table1">Table 1</xref>): <monospace>OutOfAfricaArchaicAdmixture_5R19</monospace>, <monospace>OutOfAfrica_3G09</monospace>, and a constant-sized generic model. Each simulation used the <monospace>HapmapII_GRCh37</monospace> genetic map. For <italic>D. melanogaster</italic> we estimated <inline-formula><mml:math id="inf35"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> from an African sample simulated under the DroMel, African3Epoch_1S16 model using the <monospace>Comeron2012_dm6</monospace> map. Finally, we ran simulations of <italic>A. thaliana</italic> genomes using the AraTha <monospace>African2Epoch_1H18</monospace> model under the <monospace>Salome2012_TAIR7</monospace> map. For each model, three replicate whole genomes were simulated and the population size estimated from those data. In all cases, we set the sample size of the focal population to <inline-formula><mml:math id="inf36"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> chromosomes.</p><p>Following simulation, low-recombination portions of chromosomes were masked from the analysis in a manner that reflects the ‘accessible’ subset of sites used in empirical population genomic studies (e.g. <xref ref-type="bibr" rid="bib12">Danecek et al., 2011</xref>; <xref ref-type="bibr" rid="bib38">Langley et al., 2012</xref>). Specifically we masked all regions of 1 cM or greater in the lowest 5th percentile of the empirical distribution of recombination, regions which are nearly uniformly absent for empirical analysis. This approach to masking was chosen to prevent marginal trees with low or no recombination from biasing the comparisons of demographic inference methods. It should be noted that masking is not implemented within <monospace>stdpopsim</monospace> proper; tree sequences generated by <monospace>stdpopsim</monospace> are always raw and unmasked. This allows users the flexibility to implement masking approaches that are specific to their needs for downstream analysis.</p><p>Our second task was to explore inference with two-population models using some of the multi-population demographic models implemented in <monospace>stdpopsim</monospace>. For HomSap, we used the <monospace>OutOfAfrica_3G09</monospace> model with the <monospace>HapmapII_GRCh37</monospace> genetic map, and for DroMel we used the OutOfAfrica_2L06 model with the <monospace>Comeron2012_dm6</monospace> map. The HomSap model is a three population model (Africa, Europe, and Asia) including post-divergence migration and exponential growth (<xref ref-type="fig" rid="fig4">Figure 4C</xref>), whereas the DroMel model is a two population model (Africa and Europe) with no post-divergence migration and constant population sizes (<xref ref-type="fig" rid="app1fig8">Appendix 1—figure 8</xref>).</p><p>To conduct inference on these models, we applied three commonly used methods: <inline-formula><mml:math id="inf37"><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>(<xref ref-type="bibr" rid="bib21">Gutenkunst et al., 2009</xref>), <monospace>fastsimcoal2</monospace> (<xref ref-type="bibr" rid="bib15">Excoffier et al., 2013</xref>), and <monospace>smc++</monospace> (<xref ref-type="bibr" rid="bib55">Terhorst et al., 2017</xref>). As above, these methods were used generally with default settings and we did not attempt to optimize their performance or fit parameter-rich demographic models.</p><p>For both <inline-formula><mml:math id="inf38"><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <monospace>fastsimcoal2</monospace>, we fit a two population isolation-with-migration (IM) model with constant population sizes. This IM model contains six parameters: the ancestral population size, the sizes of each population after the split, the divergence time, and two migration rate parameters. Importantly, this meant that for both species, the fitted model did not match the simulated model (<xref ref-type="fig" rid="fig4">Figure 4</xref> and <xref ref-type="fig" rid="app1fig8">Appendix 1—figure 8</xref>). In the HomSap case, we therefore performed inference solely on the Africa and Europe populations, meaning that the Asia population functioned as a ‘ghost’ population that was ignored by our inference. To validate our inference approach, we also conducted inference on a generic IM model that was identical to the model used for inference (<xref ref-type="fig" rid="app1fig11">Appendix 1—figure 11</xref>).</p><p>From HomSap simulations, we took 20 whole genome samples each from the Europe and Africa populations from each replicate. Runtimes of DroMel simulations were prohibitively slow when simulating whole genomes with the <monospace>Comeron2012_dm6</monospace> map due to large effective population sizes leading to high effective recombination rates. For this reason, we present only data from 50 samples of a 3 MB region of chromosome 2R from simulations under <monospace>OutOfAfrica_2L06</monospace>. For the generic IM simulations, we used the HomSap genome along with the <monospace>HapmapII_GRCh37</monospace> genetic map and sampled 20 individuals from each population.</p><p>Following simulation, we output tree sequences and masked low-recombination regions using the same approach described for the single population workflow above. We converted tree sequences into a two-dimensional site frequency spectrum for all chromosomes in the appropriate format for <inline-formula><mml:math id="inf39"><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <monospace>fastsimcoal2</monospace>. For each simulation replicate, we performed 10 runs of <inline-formula><mml:math id="inf40"><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <monospace>fastsimcoal2</monospace>, checking to ensure that each method reached convergence.</p><p>Detailed settings for <inline-formula><mml:math id="inf41"><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <monospace>fastsimcoal2</monospace> can be found in the Snakefile on our git repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/popsim-consortium/analysis">https://github.com/popsim-consortium/analysis</ext-link>). Estimates from the highest log-likelihood (out of 10 runs) for each simulation replicate are shown in <xref ref-type="fig" rid="fig4">Figure 4C</xref> and <xref ref-type="fig" rid="app1fig8">Appendix 1—figure 8C</xref>.</p><p>For <monospace>smc++</monospace>, we converted the tree sequences into VCF format and performed inference with default settings. Importantly, <monospace>smc++</monospace> assumes no migration post-divergence, deviating from the simulated model. However, because <monospace>smc++</monospace> allows for continuous population size changes, it is better equipped to capture many of the more complex aspects of the simulated demographic models (e.g. exponential growth).</p><p>To visualize our results, we plotted the inferred population size trajectories for each simulation replicate alongside the simulated population sizes (<xref ref-type="fig" rid="fig4">Figure 4C</xref> and <xref ref-type="fig" rid="app1fig8">Appendix 1—figure 8C</xref>). Here, unlike the single-population workflow, we compare our inferred population sizes only to the simulated population sizes and not the inverse coalescence rates.</p></sec><sec id="s4-3"><title>Resource availability</title><p>The stdpopsim package is available for download on the Python Package Index: <ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/stdpopsim/">https://pypi.org/project/stdpopsim/</ext-link>. Documentation for the project can be found here: <ext-link ext-link-type="uri" xlink:href="https://stdpopsim.readthedocs.io/en/latest/">https://stdpopsim.readthedocs.io/en/latest/</ext-link>.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank the Probabilistic Modeling in Genomics conference organizers for making this collaboration possible, and the Simons Center for Quantitative Biology at Cold Spring Harbor Laboratory for sponsoring the first workshop. Early on in the project we were encouraged by many people including Patrick Phillips, Richard Durbin, Dmitri Petrov, and Sohini Ramachandran. In addition, we thank NESCENT and Matt Hahn, Victoria Sork, and Michael Whitlock for organizing a 2014 catalysis meeting in which many of the goals of this effort were first laid out. CCK and KEL were funded under NIH Award R35GM119856. JRA and ADK were funded under NIH Award R01GM117241. TJS and RNG were funded under NIH Award R01GM127348. ALG and DRS were funded under NIH award R00HG008696. ND and AS were supported in part by NIH Awards R01HG010346 and R35GM127070. FR and GG were supported by a Villum Young Investigator award (project no. 00025300). DODV is funded by a UC MEXUS-CONACYT Collaborative Grant and a DGAPA-PAPIIT grant (PAPIIT-IA200620). JK is supported by the Robertson Foundation.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf2"><p>Reviewing editor, <italic>eLife</italic></p></fn><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Major contribution to stdpopsim, documentation or analysis</p></fn><fn fn-type="con" id="con2"><p>Major contribution to stdpopsim, documentation or analysis</p></fn><fn fn-type="con" id="con3"><p>Major contribution to stdpopsim, documentation or analysis</p></fn><fn fn-type="con" id="con4"><p>Major contribution to stdpopsim, documentation or analysis</p></fn><fn fn-type="con" id="con5"><p>Major contribution to stdpopsim, documentation or analysis</p></fn><fn fn-type="con" id="con6"><p>Major contribution to stdpopsim, documentation or analysis</p></fn><fn fn-type="con" id="con7"><p>Major contribution to stdpopsim, documentation or analysis</p></fn><fn fn-type="con" id="con8"><p>Major contribution to stdpopsim, documentation or analysis</p></fn><fn fn-type="con" id="con9"><p>Major contribution to stdpopsim, documentation or analysis</p></fn><fn fn-type="con" id="con10"><p>Contribution to software/significant community contribution</p></fn><fn fn-type="con" id="con11"><p>Contribution to software/significant community contribution</p></fn><fn fn-type="con" id="con12"><p>Contribution to software/significant community contribution</p></fn><fn fn-type="con" id="con13"><p>Contribution to software/significant community contribution</p></fn><fn fn-type="con" id="con14"><p>Contribution to software/significant community contribution</p></fn><fn fn-type="con" id="con15"><p>Contribution to software/significant community contribution</p></fn><fn fn-type="con" id="con16"><p>Contribution to software/significant community contribution</p></fn><fn fn-type="con" id="con17"><p>Contribution to software/significant community contribution</p></fn><fn fn-type="con" id="con18"><p>Contribution to software/significant community contribution</p></fn><fn fn-type="con" id="con19"><p>Contribution to software/significant community contribution</p></fn><fn fn-type="con" id="con20"><p>Contribution to software/significant community contribution</p></fn><fn fn-type="con" id="con21"><p>Contribution to software/significant community contribution</p></fn><fn fn-type="con" id="con22"><p>Conceptualization, Methodology, Software, Validation, Formal Analysis, Resources, Data Curation, Writing - Original Draft Preparation, Writing - Review &amp; Editing, Supervision, Project Administration</p></fn><fn fn-type="con" id="con23"><p>Conceptualization, Methodology, Software, Validation, Formal Analysis, Resources, Data Curation, Writing - Original Draft Preparation, Writing - Review &amp; Editing, Supervision, Project Administration</p></fn><fn fn-type="con" id="con24"><p>Conceptualization, Methodology, Software, Validation, Formal Analysis, Resources, Data Curation, Writing - Original Draft Preparation, Writing - Review &amp; Editing, Supervision, Project Administration</p></fn><fn fn-type="con" id="con25"><p>Conceptualization, Methodology, Software, Validation, Formal Analysis, Resources, Data Curation, Writing - Original Draft Preparation, Writing - Review &amp; Editing, Supervision, Project Administration</p></fn><fn fn-type="con" id="con26"><p>Conceptualization, Methodology, Software, Validation, Formal Analysis, Resources, Data Curation, Writing - Original Draft Preparation, Writing - Review &amp; Editing, Supervision, Project Administration</p></fn><fn fn-type="con" id="con27"><p>Conceptualization, Methodology, Software, Validation, Formal Analysis, Resources, Data Curation, Writing - Original Draft Preparation, Writing - Review &amp; Editing, Supervision, Project Administration</p></fn><fn fn-type="con" id="con28"><p>Conceptualization, Methodology, Software, Validation, Formal Analysis, Resources, Data Curation, Writing - Original Draft Preparation, Writing - Review &amp; Editing, Supervision, Project Administration</p></fn><fn fn-type="con" id="con29"><p>Conceptualization, Methodology, Software, Validation, Formal Analysis, Resources, Data Curation, Writing - Original Draft Preparation, Writing - Review &amp; Editing, Supervision, Project Administration</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-54967-transrepform-v3.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All resources are available from <ext-link ext-link-type="uri" xlink:href="https://github.com/popsim-consortium/stdpopsim">https://github.com/popsim-consortium/stdpopsim</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/stdpopsim">https://github.com/elifesciences-publications/stdpopsim</ext-link>).</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adrion</surname> <given-names>JR</given-names></name><name><surname>Galloway</surname> <given-names>JG</given-names></name><name><surname>Kern</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Predicting the landscape of recombination using deep learning</article-title><source>Molecular Biology and Evolution</source><volume>37</volume><fpage>1790</fpage><lpage>1808</lpage><pub-id pub-id-type="doi">10.1093/molbev/msaa038</pub-id><pub-id pub-id-type="pmid">32077950</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alachiotis</surname> <given-names>N</given-names></name><name><surname>Stamatakis</surname> <given-names>A</given-names></name><name><surname>Pavlidis</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>OmegaPlus: a scalable tool for rapid detection of selective sweeps in whole-genome datasets</article-title><source>Bioinformatics</source><volume>28</volume><fpage>2274</fpage><lpage>2275</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts419</pub-id><pub-id pub-id-type="pmid">22760304</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andrews</surname> <given-names>KR</given-names></name><name><surname>Good</surname> <given-names>JM</given-names></name><name><surname>Miller</surname> <given-names>MR</given-names></name><name><surname>Luikart</surname> <given-names>G</given-names></name><name><surname>Hohenlohe</surname> <given-names>PA</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Harnessing the power of RADseq for ecological and evolutionary genomics</article-title><source>Nature Reviews Genetics</source><volume>17</volume><fpage>81</fpage><lpage>92</lpage><pub-id pub-id-type="doi">10.1038/nrg.2015.28</pub-id><pub-id pub-id-type="pmid">26729255</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beichman</surname> <given-names>AC</given-names></name><name><surname>Phung</surname> <given-names>TN</given-names></name><name><surname>Lohmueller</surname> <given-names>KE</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Comparison of single genome and allele frequency data reveals discordant demographic histories</article-title><source>G3: Genes, Genomes, Genetics</source><volume>7</volume><fpage>3605</fpage><lpage>3620</lpage><pub-id pub-id-type="doi">10.1534/g3.117.300259</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beichman</surname> <given-names>AC</given-names></name><name><surname>Huerta-Sanchez</surname> <given-names>E</given-names></name><name><surname>Lohmueller</surname> <given-names>KE</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Using genomic data to infer historic population dynamics of nonmodel organisms</article-title><source>Annual Review of Ecology, Evolution, and Systematics</source><volume>49</volume><fpage>433</fpage><lpage>456</lpage><pub-id pub-id-type="doi">10.1146/annurev-ecolsys-110617-062431</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boyko</surname> <given-names>AR</given-names></name><name><surname>Williamson</surname> <given-names>SH</given-names></name><name><surname>Indap</surname> <given-names>AR</given-names></name><name><surname>Degenhardt</surname> <given-names>JD</given-names></name><name><surname>Hernandez</surname> <given-names>RD</given-names></name><name><surname>Lohmueller</surname> <given-names>KE</given-names></name><name><surname>Adams</surname> <given-names>MD</given-names></name><name><surname>Schmidt</surname> <given-names>S</given-names></name><name><surname>Sninsky</surname> <given-names>JJ</given-names></name><name><surname>Sunyaev</surname> <given-names>SR</given-names></name><name><surname>White</surname> <given-names>TJ</given-names></name><name><surname>Nielsen</surname> <given-names>R</given-names></name><name><surname>Clark</surname> <given-names>AG</given-names></name><name><surname>Bustamante</surname> <given-names>CD</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Assessing the evolutionary impact of amino acid mutations in the human genome</article-title><source>PLOS Genetics</source><volume>4</volume><elocation-id>e1000083</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1000083</pub-id><pub-id pub-id-type="pmid">18516229</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Browning</surname> <given-names>SR</given-names></name><name><surname>Browning</surname> <given-names>BL</given-names></name><name><surname>Daviglus</surname> <given-names>ML</given-names></name><name><surname>Durazo-Arvizu</surname> <given-names>RA</given-names></name><name><surname>Schneiderman</surname> <given-names>N</given-names></name><name><surname>Kaplan</surname> <given-names>RC</given-names></name><name><surname>Laurie</surname> <given-names>CC</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Ancestry-specific recent effective population size in the americas</article-title><source>PLOS Genetics</source><volume>14</volume><elocation-id>e1007385</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1007385</pub-id><pub-id pub-id-type="pmid">29795556</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Campbell</surname> <given-names>CL</given-names></name><name><surname>Bhérer</surname> <given-names>C</given-names></name><name><surname>Morrow</surname> <given-names>BE</given-names></name><name><surname>Boyko</surname> <given-names>AR</given-names></name><name><surname>Auton</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A Pedigree-Based map of recombination in the domestic dog genome</article-title><source>G3: Genes, Genomes, Genetics</source><volume>6</volume><fpage>3517</fpage><lpage>3524</lpage><pub-id pub-id-type="doi">10.1534/g3.116.034678</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chan</surname> <given-names>AH</given-names></name><name><surname>Jenkins</surname> <given-names>PA</given-names></name><name><surname>Song</surname> <given-names>YS</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Genome-wide fine-scale recombination rate variation in <italic>Drosophila melanogaster</italic></article-title><source>PLOS Genetics</source><volume>8</volume><elocation-id>e1003090</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1003090</pub-id><pub-id pub-id-type="pmid">23284288</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Comeron</surname> <given-names>JM</given-names></name><name><surname>Ratnappan</surname> <given-names>R</given-names></name><name><surname>Bailin</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The many landscapes of recombination in <italic>Drosophila melanogaster</italic></article-title><source>PLOS Genetics</source><volume>8</volume><elocation-id>e1002905</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1002905</pub-id><pub-id pub-id-type="pmid">23071443</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crow</surname> <given-names>JF</given-names></name><name><surname>Denniston</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>Inbreeding and variance effective population numbers</article-title><source>Evolution</source><volume>42</volume><fpage>482</fpage><lpage>495</lpage><pub-id pub-id-type="doi">10.1111/j.1558-5646.1988.tb04154.x</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Danecek</surname> <given-names>P</given-names></name><name><surname>Auton</surname> <given-names>A</given-names></name><name><surname>Abecasis</surname> <given-names>G</given-names></name><name><surname>Albers</surname> <given-names>CA</given-names></name><name><surname>Banks</surname> <given-names>E</given-names></name><name><surname>DePristo</surname> <given-names>MA</given-names></name><name><surname>Handsaker</surname> <given-names>RE</given-names></name><name><surname>Lunter</surname> <given-names>G</given-names></name><name><surname>Marth</surname> <given-names>GT</given-names></name><name><surname>Sherry</surname> <given-names>ST</given-names></name><name><surname>McVean</surname> <given-names>G</given-names></name><name><surname>Durbin</surname> <given-names>R</given-names></name><collab>1000 Genomes Project Analysis Group</collab></person-group><year iso-8601-date="2011">2011</year><article-title>The variant call format and VCFtools</article-title><source>Bioinformatics</source><volume>27</volume><fpage>2156</fpage><lpage>2158</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr330</pub-id><pub-id pub-id-type="pmid">21653522</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DeGiorgio</surname> <given-names>M</given-names></name><name><surname>Huber</surname> <given-names>CD</given-names></name><name><surname>Hubisz</surname> <given-names>MJ</given-names></name><name><surname>Hellmann</surname> <given-names>I</given-names></name><name><surname>Nielsen</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>SweepFinder2: increased sensitivity, robustness and flexibility</article-title><source>Bioinformatics</source><volume>32</volume><fpage>1895</fpage><lpage>1897</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btw051</pub-id><pub-id pub-id-type="pmid">27153702</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Durvasula</surname> <given-names>A</given-names></name><name><surname>Fulgione</surname> <given-names>A</given-names></name><name><surname>Gutaker</surname> <given-names>RM</given-names></name><name><surname>Alacakaptan</surname> <given-names>SI</given-names></name><name><surname>Flood</surname> <given-names>PJ</given-names></name><name><surname>Neto</surname> <given-names>C</given-names></name><name><surname>Tsuchimatsu</surname> <given-names>T</given-names></name><name><surname>Burbano</surname> <given-names>HA</given-names></name><name><surname>Picó</surname> <given-names>FX</given-names></name><name><surname>Alonso-Blanco</surname> <given-names>C</given-names></name><name><surname>Hancock</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>African genomes illuminate the early history and transition to selfing in <italic>Arabidopsis thaliana</italic></article-title><source>PNAS</source><volume>114</volume><fpage>5213</fpage><lpage>5218</lpage><pub-id pub-id-type="doi">10.1073/pnas.1616736114</pub-id><pub-id pub-id-type="pmid">28473417</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Excoffier</surname> <given-names>L</given-names></name><name><surname>Dupanloup</surname> <given-names>I</given-names></name><name><surname>Huerta-Sánchez</surname> <given-names>E</given-names></name><name><surname>Sousa</surname> <given-names>VC</given-names></name><name><surname>Foll</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Robust demographic inference from genomic and SNP data</article-title><source>PLOS Genetics</source><volume>9</volume><elocation-id>e1003905</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1003905</pub-id><pub-id pub-id-type="pmid">24204310</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eyre-Walker</surname> <given-names>A</given-names></name><name><surname>Keightley</surname> <given-names>PD</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Estimating the rate of adaptive molecular evolution in the presence of slightly deleterious mutations and population size change</article-title><source>Molecular Biology and Evolution</source><volume>26</volume><fpage>2097</fpage><lpage>2108</lpage><pub-id pub-id-type="doi">10.1093/molbev/msp119</pub-id><pub-id pub-id-type="pmid">19535738</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Fortier</surname> <given-names>AL</given-names></name><name><surname>Coffman</surname> <given-names>AJ</given-names></name><name><surname>Struck</surname> <given-names>TJ</given-names></name><name><surname>Irby</surname> <given-names>MN</given-names></name><name><surname>Burguete</surname> <given-names>JEL</given-names></name><name><surname>Ragsdale</surname> <given-names>AP</given-names></name><name><surname>Gutenkunst</surname> <given-names>RN</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>DFEnitely different: genome-wide characterization of differences in mutation fitness effects between populations</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/703918</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frazer</surname> <given-names>KA</given-names></name><name><surname>Ballinger</surname> <given-names>DG</given-names></name><name><surname>Cox</surname> <given-names>DR</given-names></name><name><surname>Hinds</surname> <given-names>DA</given-names></name><name><surname>Stuve</surname> <given-names>LL</given-names></name><name><surname>Gibbs</surname> <given-names>RA</given-names></name><name><surname>Belmont</surname> <given-names>JW</given-names></name><name><surname>Boudreau</surname> <given-names>A</given-names></name><name><surname>Hardenbol</surname> <given-names>P</given-names></name><name><surname>Leal</surname> <given-names>SM</given-names></name><name><surname>Pasternak</surname> <given-names>S</given-names></name><name><surname>Wheeler</surname> <given-names>DA</given-names></name><name><surname>Willis</surname> <given-names>TD</given-names></name><name><surname>Yu</surname> <given-names>F</given-names></name><name><surname>Yang</surname> <given-names>H</given-names></name><name><surname>Zeng</surname> <given-names>C</given-names></name><name><surname>Gao</surname> <given-names>Y</given-names></name><name><surname>Hu</surname> <given-names>H</given-names></name><name><surname>Hu</surname> <given-names>W</given-names></name><name><surname>Li</surname> <given-names>C</given-names></name><name><surname>Lin</surname> <given-names>W</given-names></name><name><surname>Liu</surname> <given-names>S</given-names></name><name><surname>Pan</surname> <given-names>H</given-names></name><name><surname>Tang</surname> <given-names>X</given-names></name><name><surname>Wang</surname> <given-names>J</given-names></name><name><surname>Wang</surname> <given-names>W</given-names></name><name><surname>Yu</surname> <given-names>J</given-names></name><name><surname>Zhang</surname> <given-names>B</given-names></name><name><surname>Zhang</surname> <given-names>Q</given-names></name><name><surname>Zhao</surname> <given-names>H</given-names></name><name><surname>Zhao</surname> <given-names>H</given-names></name><name><surname>Zhou</surname> <given-names>J</given-names></name><name><surname>Gabriel</surname> <given-names>SB</given-names></name><name><surname>Barry</surname> <given-names>R</given-names></name><name><surname>Blumenstiel</surname> <given-names>B</given-names></name><name><surname>Camargo</surname> <given-names>A</given-names></name><name><surname>Defelice</surname> <given-names>M</given-names></name><name><surname>Faggart</surname> <given-names>M</given-names></name><name><surname>Goyette</surname> <given-names>M</given-names></name><name><surname>Gupta</surname> <given-names>S</given-names></name><name><surname>Moore</surname> <given-names>J</given-names></name><name><surname>Nguyen</surname> <given-names>H</given-names></name><name><surname>Onofrio</surname> <given-names>RC</given-names></name><name><surname>Parkin</surname> <given-names>M</given-names></name><name><surname>Roy</surname> <given-names>J</given-names></name><name><surname>Stahl</surname> <given-names>E</given-names></name><name><surname>Winchester</surname> <given-names>E</given-names></name><name><surname>Ziaugra</surname> <given-names>L</given-names></name><name><surname>Altshuler</surname> <given-names>D</given-names></name><name><surname>Shen</surname> <given-names>Y</given-names></name><name><surname>Yao</surname> <given-names>Z</given-names></name><name><surname>Huang</surname> <given-names>W</given-names></name><name><surname>Chu</surname> <given-names>X</given-names></name><name><surname>He</surname> <given-names>Y</given-names></name><name><surname>Jin</surname> <given-names>L</given-names></name><name><surname>Liu</surname> <given-names>Y</given-names></name><name><surname>Shen</surname> <given-names>Y</given-names></name><name><surname>Sun</surname> <given-names>W</given-names></name><name><surname>Wang</surname> <given-names>H</given-names></name><name><surname>Wang</surname> <given-names>Y</given-names></name><name><surname>Wang</surname> <given-names>Y</given-names></name><name><surname>Xiong</surname> <given-names>X</given-names></name><name><surname>Xu</surname> <given-names>L</given-names></name><name><surname>Waye</surname> <given-names>MM</given-names></name><name><surname>Tsui</surname> <given-names>SK</given-names></name><name><surname>Xue</surname> <given-names>H</given-names></name><name><surname>Wong</surname> <given-names>JT</given-names></name><name><surname>Galver</surname> <given-names>LM</given-names></name><name><surname>Fan</surname> <given-names>JB</given-names></name><name><surname>Gunderson</surname> <given-names>K</given-names></name><name><surname>Murray</surname> <given-names>SS</given-names></name><name><surname>Oliphant</surname> <given-names>AR</given-names></name><name><surname>Chee</surname> <given-names>MS</given-names></name><name><surname>Montpetit</surname> <given-names>A</given-names></name><name><surname>Chagnon</surname> <given-names>F</given-names></name><name><surname>Ferretti</surname> <given-names>V</given-names></name><name><surname>Leboeuf</surname> <given-names>M</given-names></name><name><surname>Olivier</surname> <given-names>JF</given-names></name><name><surname>Phillips</surname> <given-names>MS</given-names></name><name><surname>Roumy</surname> <given-names>S</given-names></name><name><surname>Sallée</surname> <given-names>C</given-names></name><name><surname>Verner</surname> <given-names>A</given-names></name><name><surname>Hudson</surname> <given-names>TJ</given-names></name><name><surname>Kwok</surname> <given-names>PY</given-names></name><name><surname>Cai</surname> <given-names>D</given-names></name><name><surname>Koboldt</surname> <given-names>DC</given-names></name><name><surname>Miller</surname> <given-names>RD</given-names></name><name><surname>Pawlikowska</surname> <given-names>L</given-names></name><name><surname>Taillon-Miller</surname> <given-names>P</given-names></name><name><surname>Xiao</surname> <given-names>M</given-names></name><name><surname>Tsui</surname> <given-names>LC</given-names></name><name><surname>Mak</surname> <given-names>W</given-names></name><name><surname>Song</surname> <given-names>YQ</given-names></name><name><surname>Tam</surname> <given-names>PK</given-names></name><name><surname>Nakamura</surname> <given-names>Y</given-names></name><name><surname>Kawaguchi</surname> <given-names>T</given-names></name><name><surname>Kitamoto</surname> <given-names>T</given-names></name><name><surname>Morizono</surname> <given-names>T</given-names></name><name><surname>Nagashima</surname> <given-names>A</given-names></name><name><surname>Ohnishi</surname> <given-names>Y</given-names></name><name><surname>Sekine</surname> <given-names>A</given-names></name><name><surname>Tanaka</surname> <given-names>T</given-names></name><name><surname>Tsunoda</surname> <given-names>T</given-names></name><name><surname>Deloukas</surname> <given-names>P</given-names></name><name><surname>Bird</surname> <given-names>CP</given-names></name><name><surname>Delgado</surname> <given-names>M</given-names></name><name><surname>Dermitzakis</surname> <given-names>ET</given-names></name><name><surname>Gwilliam</surname> <given-names>R</given-names></name><name><surname>Hunt</surname> <given-names>S</given-names></name><name><surname>Morrison</surname> <given-names>J</given-names></name><name><surname>Powell</surname> <given-names>D</given-names></name><name><surname>Stranger</surname> <given-names>BE</given-names></name><name><surname>Whittaker</surname> <given-names>P</given-names></name><name><surname>Bentley</surname> <given-names>DR</given-names></name><name><surname>Daly</surname> <given-names>MJ</given-names></name><name><surname>de Bakker</surname> <given-names>PI</given-names></name><name><surname>Barrett</surname> <given-names>J</given-names></name><name><surname>Chretien</surname> <given-names>YR</given-names></name><name><surname>Maller</surname> <given-names>J</given-names></name><name><surname>McCarroll</surname> <given-names>S</given-names></name><name><surname>Patterson</surname> <given-names>N</given-names></name><name><surname>Pe'er</surname> <given-names>I</given-names></name><name><surname>Price</surname> <given-names>A</given-names></name><name><surname>Purcell</surname> <given-names>S</given-names></name><name><surname>Richter</surname> <given-names>DJ</given-names></name><name><surname>Sabeti</surname> <given-names>P</given-names></name><name><surname>Saxena</surname> <given-names>R</given-names></name><name><surname>Schaffner</surname> <given-names>SF</given-names></name><name><surname>Sham</surname> <given-names>PC</given-names></name><name><surname>Varilly</surname> <given-names>P</given-names></name><name><surname>Altshuler</surname> <given-names>D</given-names></name><name><surname>Stein</surname> <given-names>LD</given-names></name><name><surname>Krishnan</surname> <given-names>L</given-names></name><name><surname>Smith</surname> <given-names>AV</given-names></name><name><surname>Tello-Ruiz</surname> <given-names>MK</given-names></name><name><surname>Thorisson</surname> <given-names>GA</given-names></name><name><surname>Chakravarti</surname> <given-names>A</given-names></name><name><surname>Chen</surname> <given-names>PE</given-names></name><name><surname>Cutler</surname> <given-names>DJ</given-names></name><name><surname>Kashuk</surname> <given-names>CS</given-names></name><name><surname>Lin</surname> <given-names>S</given-names></name><name><surname>Abecasis</surname> <given-names>GR</given-names></name><name><surname>Guan</surname> <given-names>W</given-names></name><name><surname>Li</surname> <given-names>Y</given-names></name><name><surname>Munro</surname> <given-names>HM</given-names></name><name><surname>Qin</surname> <given-names>ZS</given-names></name><name><surname>Thomas</surname> <given-names>DJ</given-names></name><name><surname>McVean</surname> <given-names>G</given-names></name><name><surname>Auton</surname> <given-names>A</given-names></name><name><surname>Bottolo</surname> <given-names>L</given-names></name><name><surname>Cardin</surname> <given-names>N</given-names></name><name><surname>Eyheramendy</surname> <given-names>S</given-names></name><name><surname>Freeman</surname> <given-names>C</given-names></name><name><surname>Marchini</surname> <given-names>J</given-names></name><name><surname>Myers</surname> <given-names>S</given-names></name><name><surname>Spencer</surname> <given-names>C</given-names></name><name><surname>Stephens</surname> <given-names>M</given-names></name><name><surname>Donnelly</surname> <given-names>P</given-names></name><name><surname>Cardon</surname> <given-names>LR</given-names></name><name><surname>Clarke</surname> <given-names>G</given-names></name><name><surname>Evans</surname> <given-names>DM</given-names></name><name><surname>Morris</surname> <given-names>AP</given-names></name><name><surname>Weir</surname> <given-names>BS</given-names></name><name><surname>Tsunoda</surname> <given-names>T</given-names></name><name><surname>Mullikin</surname> <given-names>JC</given-names></name><name><surname>Sherry</surname> <given-names>ST</given-names></name><name><surname>Feolo</surname> <given-names>M</given-names></name><name><surname>Skol</surname> <given-names>A</given-names></name><name><surname>Zhang</surname> <given-names>H</given-names></name><name><surname>Zeng</surname> <given-names>C</given-names></name><name><surname>Zhao</surname> <given-names>H</given-names></name><name><surname>Matsuda</surname> <given-names>I</given-names></name><name><surname>Fukushima</surname> <given-names>Y</given-names></name><name><surname>Macer</surname> <given-names>DR</given-names></name><name><surname>Suda</surname> <given-names>E</given-names></name><name><surname>Rotimi</surname> <given-names>CN</given-names></name><name><surname>Adebamowo</surname> <given-names>CA</given-names></name><name><surname>Ajayi</surname> <given-names>I</given-names></name><name><surname>Aniagwu</surname> <given-names>T</given-names></name><name><surname>Marshall</surname> <given-names>PA</given-names></name><name><surname>Nkwodimmah</surname> <given-names>C</given-names></name><name><surname>Royal</surname> <given-names>CD</given-names></name><name><surname>Leppert</surname> <given-names>MF</given-names></name><name><surname>Dixon</surname> <given-names>M</given-names></name><name><surname>Peiffer</surname> <given-names>A</given-names></name><name><surname>Qiu</surname> <given-names>R</given-names></name><name><surname>Kent</surname> <given-names>A</given-names></name><name><surname>Kato</surname> <given-names>K</given-names></name><name><surname>Niikawa</surname> <given-names>N</given-names></name><name><surname>Adewole</surname> <given-names>IF</given-names></name><name><surname>Knoppers</surname> <given-names>BM</given-names></name><name><surname>Foster</surname> <given-names>MW</given-names></name><name><surname>Clayton</surname> <given-names>EW</given-names></name><name><surname>Watkin</surname> <given-names>J</given-names></name><name><surname>Gibbs</surname> <given-names>RA</given-names></name><name><surname>Belmont</surname> <given-names>JW</given-names></name><name><surname>Muzny</surname> <given-names>D</given-names></name><name><surname>Nazareth</surname> <given-names>L</given-names></name><name><surname>Sodergren</surname> <given-names>E</given-names></name><name><surname>Weinstock</surname> <given-names>GM</given-names></name><name><surname>Wheeler</surname> <given-names>DA</given-names></name><name><surname>Yakub</surname> <given-names>I</given-names></name><name><surname>Gabriel</surname> <given-names>SB</given-names></name><name><surname>Onofrio</surname> <given-names>RC</given-names></name><name><surname>Richter</surname> <given-names>DJ</given-names></name><name><surname>Ziaugra</surname> <given-names>L</given-names></name><name><surname>Birren</surname> <given-names>BW</given-names></name><name><surname>Daly</surname> <given-names>MJ</given-names></name><name><surname>Altshuler</surname> <given-names>D</given-names></name><name><surname>Wilson</surname> <given-names>RK</given-names></name><name><surname>Fulton</surname> <given-names>LL</given-names></name><name><surname>Rogers</surname> <given-names>J</given-names></name><name><surname>Burton</surname> <given-names>J</given-names></name><name><surname>Carter</surname> <given-names>NP</given-names></name><name><surname>Clee</surname> <given-names>CM</given-names></name><name><surname>Griffiths</surname> <given-names>M</given-names></name><name><surname>Jones</surname> <given-names>MC</given-names></name><name><surname>McLay</surname> <given-names>K</given-names></name><name><surname>Plumb</surname> <given-names>RW</given-names></name><name><surname>Ross</surname> <given-names>MT</given-names></name><name><surname>Sims</surname> <given-names>SK</given-names></name><name><surname>Willey</surname> <given-names>DL</given-names></name><name><surname>Chen</surname> <given-names>Z</given-names></name><name><surname>Han</surname> <given-names>H</given-names></name><name><surname>Kang</surname> <given-names>L</given-names></name><name><surname>Godbout</surname> <given-names>M</given-names></name><name><surname>Wallenburg</surname> <given-names>JC</given-names></name><name><surname>L'Archevêque</surname> <given-names>P</given-names></name><name><surname>Bellemare</surname> <given-names>G</given-names></name><name><surname>Saeki</surname> <given-names>K</given-names></name><name><surname>Wang</surname> <given-names>H</given-names></name><name><surname>An</surname> <given-names>D</given-names></name><name><surname>Fu</surname> <given-names>H</given-names></name><name><surname>Li</surname> <given-names>Q</given-names></name><name><surname>Wang</surname> <given-names>Z</given-names></name><name><surname>Wang</surname> <given-names>R</given-names></name><name><surname>Holden</surname> <given-names>AL</given-names></name><name><surname>Brooks</surname> <given-names>LD</given-names></name><name><surname>McEwen</surname> <given-names>JE</given-names></name><name><surname>Guyer</surname> <given-names>MS</given-names></name><name><surname>Wang</surname> <given-names>VO</given-names></name><name><surname>Peterson</surname> <given-names>JL</given-names></name><name><surname>Shi</surname> <given-names>M</given-names></name><name><surname>Spiegel</surname> <given-names>J</given-names></name><name><surname>Sung</surname> <given-names>LM</given-names></name><name><surname>Zacharia</surname> <given-names>LF</given-names></name><name><surname>Collins</surname> <given-names>FS</given-names></name><name><surname>Kennedy</surname> <given-names>K</given-names></name><name><surname>Jamieson</surname> <given-names>R</given-names></name><name><surname>Stewart</surname> <given-names>J</given-names></name><collab>International HapMap Consortium</collab></person-group><year iso-8601-date="2007">2007</year><article-title>A second generation human haplotype map of over 3.1 million SNPs</article-title><source>Nature</source><volume>449</volume><fpage>851</fpage><lpage>861</lpage><pub-id pub-id-type="doi">10.1038/nature06258</pub-id><pub-id pub-id-type="pmid">17943122</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garud</surname> <given-names>NR</given-names></name><name><surname>Messer</surname> <given-names>PW</given-names></name><name><surname>Buzbas</surname> <given-names>EO</given-names></name><name><surname>Petrov</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Recent selective sweeps in north american <italic>Drosophila melanogaster</italic> show signatures of soft sweeps</article-title><source>PLOS Genetics</source><volume>11</volume><elocation-id>e1005004</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1005004</pub-id><pub-id pub-id-type="pmid">25706129</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gladstein</surname> <given-names>AL</given-names></name><name><surname>Hammer</surname> <given-names>MF</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Substructured population growth in the ashkenazi jews inferred with approximate bayesian computation</article-title><source>Molecular Biology and Evolution</source><volume>36</volume><fpage>1162</fpage><lpage>1171</lpage><pub-id pub-id-type="doi">10.1093/molbev/msz047</pub-id><pub-id pub-id-type="pmid">30840069</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gutenkunst</surname> <given-names>RN</given-names></name><name><surname>Hernandez</surname> <given-names>RD</given-names></name><name><surname>Williamson</surname> <given-names>SH</given-names></name><name><surname>Bustamante</surname> <given-names>CD</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Inferring the joint demographic history of multiple populations from multidimensional SNP frequency data</article-title><source>PLOS Genetics</source><volume>5</volume><elocation-id>e1000695</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1000695</pub-id><pub-id pub-id-type="pmid">19851460</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haller</surname> <given-names>BC</given-names></name><name><surname>Galloway</surname> <given-names>J</given-names></name><name><surname>Kelleher</surname> <given-names>J</given-names></name><name><surname>Messer</surname> <given-names>PW</given-names></name><name><surname>Ralph</surname> <given-names>PL</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Tree-sequence recording in SLiM opens new horizons for forward-time simulation of whole genomes</article-title><source>Molecular Ecology Resources</source><volume>19</volume><fpage>552</fpage><lpage>566</lpage><pub-id pub-id-type="doi">10.1111/1755-0998.12968</pub-id><pub-id pub-id-type="pmid">30565882</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haller</surname> <given-names>BC</given-names></name><name><surname>Messer</surname> <given-names>PW</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>SLiM 3: forward genetic simulations beyond the Wright-Fisher model</article-title><source>Molecular Biology and Evolution</source><volume>36</volume><fpage>632</fpage><lpage>637</lpage><pub-id pub-id-type="doi">10.1093/molbev/msy228</pub-id><pub-id pub-id-type="pmid">30517680</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hey</surname> <given-names>J</given-names></name><name><surname>Nielsen</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Multilocus methods for estimating population sizes, migration rates and divergence time, with applications to the divergence of <italic>Drosophila pseudoobscura</italic> and <italic>D. persimilis</italic></article-title><source>Genetics</source><volume>167</volume><fpage>747</fpage><lpage>760</lpage><pub-id pub-id-type="doi">10.1534/genetics.103.024182</pub-id><pub-id pub-id-type="pmid">15238526</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname> <given-names>YF</given-names></name><name><surname>Siepel</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Estimation of allele-specific fitness effects across human protein-coding sequences and implications for disease</article-title><source>Genome Research</source><volume>29</volume><fpage>1310</fpage><lpage>1321</lpage><pub-id pub-id-type="doi">10.1101/gr.245522.118</pub-id><pub-id pub-id-type="pmid">31249063</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huber</surname> <given-names>CD</given-names></name><name><surname>Durvasula</surname> <given-names>A</given-names></name><name><surname>Hancock</surname> <given-names>AM</given-names></name><name><surname>Lohmueller</surname> <given-names>KE</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Gene expression drives the evolution of dominance</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>7</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-05281-7</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jacobs</surname> <given-names>GS</given-names></name><name><surname>Hudjashov</surname> <given-names>G</given-names></name><name><surname>Saag</surname> <given-names>L</given-names></name><name><surname>Kusuma</surname> <given-names>P</given-names></name><name><surname>Darusallam</surname> <given-names>CC</given-names></name><name><surname>Lawson</surname> <given-names>DJ</given-names></name><name><surname>Mondal</surname> <given-names>M</given-names></name><name><surname>Pagani</surname> <given-names>L</given-names></name><name><surname>Ricaut</surname> <given-names>FX</given-names></name><name><surname>Stoneking</surname> <given-names>M</given-names></name><name><surname>Metspalu</surname> <given-names>M</given-names></name><name><surname>Sudoyo</surname> <given-names>H</given-names></name><name><surname>Lansing</surname> <given-names>JS</given-names></name><name><surname>Cox</surname> <given-names>MP</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Multiple deeply divergent denisovan ancestries in papuans</article-title><source>Cell</source><volume>177</volume><fpage>1010</fpage><lpage>1021</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2019.02.035</pub-id><pub-id pub-id-type="pmid">30981557</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kamm</surname> <given-names>J</given-names></name><name><surname>Terhorst</surname> <given-names>J</given-names></name><name><surname>Durbin</surname> <given-names>R</given-names></name><name><surname>Song</surname> <given-names>YS</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Efficiently inferring the demographic history of many populations with allele count data</article-title><source>Journal of the American Statistical Association</source><volume>155</volume><fpage>1</fpage><lpage>16</lpage><pub-id pub-id-type="doi">10.1080/01621459.2019.1635482</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kelleher</surname> <given-names>J</given-names></name><name><surname>Etheridge</surname> <given-names>AM</given-names></name><name><surname>McVean</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Efficient coalescent simulation and genealogical analysis for large sample sizes</article-title><source>PLOS Computational Biology</source><volume>12</volume><elocation-id>e1004842</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004842</pub-id><pub-id pub-id-type="pmid">27145223</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kelleher</surname> <given-names>J</given-names></name><name><surname>Thornton</surname> <given-names>KR</given-names></name><name><surname>Ashander</surname> <given-names>J</given-names></name><name><surname>Ralph</surname> <given-names>PL</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Efficient pedigree recording for fast population genetics simulation</article-title><source>PLOS Computational Biology</source><volume>14</volume><elocation-id>e1006581</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006581</pub-id><pub-id pub-id-type="pmid">30383757</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kelleher</surname> <given-names>J</given-names></name><name><surname>Wong</surname> <given-names>Y</given-names></name><name><surname>Wohns</surname> <given-names>AW</given-names></name><name><surname>Fadil</surname> <given-names>C</given-names></name><name><surname>Albers</surname> <given-names>PK</given-names></name><name><surname>McVean</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Inferring whole-genome histories in large population datasets</article-title><source>Nature Genetics</source><volume>51</volume><fpage>1330</fpage><lpage>1338</lpage><pub-id pub-id-type="doi">10.1038/s41588-019-0483-y</pub-id><pub-id pub-id-type="pmid">31477934</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Kemeny</surname> <given-names>JG</given-names></name><name><surname>Snell</surname> <given-names>JL</given-names></name><name><surname>Knapp</surname> <given-names>AW</given-names></name></person-group><year iso-8601-date="2012">2012</year><source>Denumerable Markov Chains</source><publisher-name>Springer Science &amp; Business Media</publisher-name><pub-id pub-id-type="doi">10.1007/978-1-4684-9455-6</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kern</surname> <given-names>AD</given-names></name><name><surname>Schrider</surname> <given-names>DR</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>diploS/HIC: an updated approach to classifying selective sweeps</article-title><source>G3: Genes, Genomes, Genetics</source><volume>8</volume><fpage>1959</fpage><lpage>1970</lpage><pub-id pub-id-type="doi">10.1534/g3.118.200262</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname> <given-names>BY</given-names></name><name><surname>Huber</surname> <given-names>CD</given-names></name><name><surname>Lohmueller</surname> <given-names>KE</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Inference of the distribution of selection coefficients for new nonsynonymous mutations using large samples</article-title><source>Genetics</source><volume>206</volume><fpage>345</fpage><lpage>361</lpage><pub-id pub-id-type="doi">10.1534/genetics.116.197145</pub-id><pub-id pub-id-type="pmid">28249985</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname> <given-names>Y</given-names></name><name><surname>Stephan</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Detecting a local signature of genetic hitchhiking along a recombining chromosome</article-title><source>Genetics</source><volume>160</volume><fpage>765</fpage><lpage>777</lpage><pub-id pub-id-type="pmid">11861577</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kong</surname> <given-names>A</given-names></name><name><surname>Thorleifsson</surname> <given-names>G</given-names></name><name><surname>Gudbjartsson</surname> <given-names>DF</given-names></name><name><surname>Masson</surname> <given-names>G</given-names></name><name><surname>Sigurdsson</surname> <given-names>A</given-names></name><name><surname>Jonasdottir</surname> <given-names>A</given-names></name><name><surname>Walters</surname> <given-names>GB</given-names></name><name><surname>Jonasdottir</surname> <given-names>A</given-names></name><name><surname>Gylfason</surname> <given-names>A</given-names></name><name><surname>Kristinsson</surname> <given-names>KT</given-names></name><name><surname>Gudjonsson</surname> <given-names>SA</given-names></name><name><surname>Frigge</surname> <given-names>ML</given-names></name><name><surname>Helgason</surname> <given-names>A</given-names></name><name><surname>Thorsteinsdottir</surname> <given-names>U</given-names></name><name><surname>Stefansson</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Fine-scale recombination rate differences between sexes, populations and individuals</article-title><source>Nature</source><volume>467</volume><fpage>1099</fpage><lpage>1103</lpage><pub-id pub-id-type="doi">10.1038/nature09525</pub-id><pub-id pub-id-type="pmid">20981099</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Köster</surname> <given-names>J</given-names></name><name><surname>Rahmann</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Snakemake--a scalable bioinformatics workflow engine</article-title><source>Bioinformatics</source><volume>28</volume><fpage>2520</fpage><lpage>2522</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts480</pub-id><pub-id pub-id-type="pmid">22908215</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langley</surname> <given-names>CH</given-names></name><name><surname>Stevens</surname> <given-names>K</given-names></name><name><surname>Cardeno</surname> <given-names>C</given-names></name><name><surname>Lee</surname> <given-names>YC</given-names></name><name><surname>Schrider</surname> <given-names>DR</given-names></name><name><surname>Pool</surname> <given-names>JE</given-names></name><name><surname>Langley</surname> <given-names>SA</given-names></name><name><surname>Suarez</surname> <given-names>C</given-names></name><name><surname>Corbett-Detig</surname> <given-names>RB</given-names></name><name><surname>Kolaczkowski</surname> <given-names>B</given-names></name><name><surname>Fang</surname> <given-names>S</given-names></name><name><surname>Nista</surname> <given-names>PM</given-names></name><name><surname>Holloway</surname> <given-names>AK</given-names></name><name><surname>Kern</surname> <given-names>AD</given-names></name><name><surname>Dewey</surname> <given-names>CN</given-names></name><name><surname>Song</surname> <given-names>YS</given-names></name><name><surname>Hahn</surname> <given-names>MW</given-names></name><name><surname>Begun</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Genomic variation in natural populations of <italic>Drosophila melanogaster</italic></article-title><source>Genetics</source><volume>192</volume><fpage>533</fpage><lpage>598</lpage><pub-id pub-id-type="doi">10.1534/genetics.112.142018</pub-id><pub-id pub-id-type="pmid">22673804</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname> <given-names>H</given-names></name><name><surname>Durbin</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Inference of human population history from individual whole-genome sequences</article-title><source>Nature</source><volume>475</volume><fpage>493</fpage><lpage>496</lpage><pub-id pub-id-type="doi">10.1038/nature10231</pub-id><pub-id pub-id-type="pmid">21753753</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname> <given-names>H</given-names></name><name><surname>Stephan</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Inferring the demographic history and rate of adaptive substitution in <italic>Drosophila</italic></article-title><source>PLOS Genetics</source><volume>2</volume><elocation-id>e166</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.0020166</pub-id><pub-id pub-id-type="pmid">17040129</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname> <given-names>K</given-names></name><name><surname>Futschik</surname> <given-names>A</given-names></name><name><surname>Li</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A fast estimate for the population recombination rate based on regression</article-title><source>Genetics</source><volume>194</volume><fpage>473</fpage><lpage>484</lpage><pub-id pub-id-type="doi">10.1534/genetics.113.150201</pub-id><pub-id pub-id-type="pmid">23589457</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname> <given-names>X</given-names></name><name><surname>Fu</surname> <given-names>YX</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Exploring population size changes using SNP frequency spectra</article-title><source>Nature Genetics</source><volume>47</volume><fpage>555</fpage><lpage>559</lpage><pub-id pub-id-type="doi">10.1038/ng.3254</pub-id><pub-id pub-id-type="pmid">25848749</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Locke</surname> <given-names>DP</given-names></name><name><surname>Hillier</surname> <given-names>LW</given-names></name><name><surname>Warren</surname> <given-names>WC</given-names></name><name><surname>Worley</surname> <given-names>KC</given-names></name><name><surname>Nazareth</surname> <given-names>LV</given-names></name><name><surname>Muzny</surname> <given-names>DM</given-names></name><name><surname>Yang</surname> <given-names>SP</given-names></name><name><surname>Wang</surname> <given-names>Z</given-names></name><name><surname>Chinwalla</surname> <given-names>AT</given-names></name><name><surname>Minx</surname> <given-names>P</given-names></name><name><surname>Mitreva</surname> <given-names>M</given-names></name><name><surname>Cook</surname> <given-names>L</given-names></name><name><surname>Delehaunty</surname> <given-names>KD</given-names></name><name><surname>Fronick</surname> <given-names>C</given-names></name><name><surname>Schmidt</surname> <given-names>H</given-names></name><name><surname>Fulton</surname> <given-names>LA</given-names></name><name><surname>Fulton</surname> <given-names>RS</given-names></name><name><surname>Nelson</surname> <given-names>JO</given-names></name><name><surname>Magrini</surname> <given-names>V</given-names></name><name><surname>Pohl</surname> <given-names>C</given-names></name><name><surname>Graves</surname> <given-names>TA</given-names></name><name><surname>Markovic</surname> <given-names>C</given-names></name><name><surname>Cree</surname> <given-names>A</given-names></name><name><surname>Dinh</surname> <given-names>HH</given-names></name><name><surname>Hume</surname> <given-names>J</given-names></name><name><surname>Kovar</surname> <given-names>CL</given-names></name><name><surname>Fowler</surname> <given-names>GR</given-names></name><name><surname>Lunter</surname> <given-names>G</given-names></name><name><surname>Meader</surname> <given-names>S</given-names></name><name><surname>Heger</surname> <given-names>A</given-names></name><name><surname>Ponting</surname> <given-names>CP</given-names></name><name><surname>Marques-Bonet</surname> <given-names>T</given-names></name><name><surname>Alkan</surname> <given-names>C</given-names></name><name><surname>Chen</surname> <given-names>L</given-names></name><name><surname>Cheng</surname> <given-names>Z</given-names></name><name><surname>Kidd</surname> <given-names>JM</given-names></name><name><surname>Eichler</surname> <given-names>EE</given-names></name><name><surname>White</surname> <given-names>S</given-names></name><name><surname>Searle</surname> <given-names>S</given-names></name><name><surname>Vilella</surname> <given-names>AJ</given-names></name><name><surname>Chen</surname> <given-names>Y</given-names></name><name><surname>Flicek</surname> <given-names>P</given-names></name><name><surname>Ma</surname> <given-names>J</given-names></name><name><surname>Raney</surname> <given-names>B</given-names></name><name><surname>Suh</surname> <given-names>B</given-names></name><name><surname>Burhans</surname> <given-names>R</given-names></name><name><surname>Herrero</surname> <given-names>J</given-names></name><name><surname>Haussler</surname> <given-names>D</given-names></name><name><surname>Faria</surname> <given-names>R</given-names></name><name><surname>Fernando</surname> <given-names>O</given-names></name><name><surname>Darré</surname> <given-names>F</given-names></name><name><surname>Farré</surname> <given-names>D</given-names></name><name><surname>Gazave</surname> <given-names>E</given-names></name><name><surname>Oliva</surname> <given-names>M</given-names></name><name><surname>Navarro</surname> <given-names>A</given-names></name><name><surname>Roberto</surname> <given-names>R</given-names></name><name><surname>Capozzi</surname> <given-names>O</given-names></name><name><surname>Archidiacono</surname> <given-names>N</given-names></name><name><surname>Della Valle</surname> <given-names>G</given-names></name><name><surname>Purgato</surname> <given-names>S</given-names></name><name><surname>Rocchi</surname> <given-names>M</given-names></name><name><surname>Konkel</surname> <given-names>MK</given-names></name><name><surname>Walker</surname> <given-names>JA</given-names></name><name><surname>Ullmer</surname> <given-names>B</given-names></name><name><surname>Batzer</surname> <given-names>MA</given-names></name><name><surname>Smit</surname> <given-names>AF</given-names></name><name><surname>Hubley</surname> <given-names>R</given-names></name><name><surname>Casola</surname> <given-names>C</given-names></name><name><surname>Schrider</surname> <given-names>DR</given-names></name><name><surname>Hahn</surname> <given-names>MW</given-names></name><name><surname>Quesada</surname> <given-names>V</given-names></name><name><surname>Puente</surname> <given-names>XS</given-names></name><name><surname>Ordoñez</surname> <given-names>GR</given-names></name><name><surname>López-Otín</surname> <given-names>C</given-names></name><name><surname>Vinar</surname> <given-names>T</given-names></name><name><surname>Brejova</surname> <given-names>B</given-names></name><name><surname>Ratan</surname> <given-names>A</given-names></name><name><surname>Harris</surname> <given-names>RS</given-names></name><name><surname>Miller</surname> <given-names>W</given-names></name><name><surname>Kosiol</surname> <given-names>C</given-names></name><name><surname>Lawson</surname> <given-names>HA</given-names></name><name><surname>Taliwal</surname> <given-names>V</given-names></name><name><surname>Martins</surname> <given-names>AL</given-names></name><name><surname>Siepel</surname> <given-names>A</given-names></name><name><surname>Roychoudhury</surname> <given-names>A</given-names></name><name><surname>Ma</surname> <given-names>X</given-names></name><name><surname>Degenhardt</surname> <given-names>J</given-names></name><name><surname>Bustamante</surname> <given-names>CD</given-names></name><name><surname>Gutenkunst</surname> <given-names>RN</given-names></name><name><surname>Mailund</surname> <given-names>T</given-names></name><name><surname>Dutheil</surname> <given-names>JY</given-names></name><name><surname>Hobolth</surname> <given-names>A</given-names></name><name><surname>Schierup</surname> <given-names>MH</given-names></name><name><surname>Ryder</surname> <given-names>OA</given-names></name><name><surname>Yoshinaga</surname> <given-names>Y</given-names></name><name><surname>de Jong</surname> <given-names>PJ</given-names></name><name><surname>Weinstock</surname> <given-names>GM</given-names></name><name><surname>Rogers</surname> <given-names>J</given-names></name><name><surname>Mardis</surname> <given-names>ER</given-names></name><name><surname>Gibbs</surname> <given-names>RA</given-names></name><name><surname>Wilson</surname> <given-names>RK</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Comparative and demographic analysis of orang-utan genomes</article-title><source>Nature</source><volume>469</volume><fpage>529</fpage><lpage>533</lpage><pub-id pub-id-type="doi">10.1038/nature09687</pub-id><pub-id pub-id-type="pmid">21270892</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McVean</surname> <given-names>GA</given-names></name><name><surname>Myers</surname> <given-names>SR</given-names></name><name><surname>Hunt</surname> <given-names>S</given-names></name><name><surname>Deloukas</surname> <given-names>P</given-names></name><name><surname>Bentley</surname> <given-names>DR</given-names></name><name><surname>Donnelly</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>The fine-scale structure of recombination rate variation in the human genome</article-title><source>Science</source><volume>304</volume><fpage>581</fpage><lpage>584</lpage><pub-id pub-id-type="doi">10.1126/science.1092500</pub-id><pub-id pub-id-type="pmid">15105499</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moult</surname> <given-names>J</given-names></name><name><surname>Pedersen</surname> <given-names>JT</given-names></name><name><surname>Judson</surname> <given-names>R</given-names></name><name><surname>Fidelis</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>A large-scale experiment to assess protein structure prediction methods</article-title><source>Proteins: Structure, Function, and Genetics</source><volume>23</volume><elocation-id>303</elocation-id><pub-id pub-id-type="doi">10.1002/prot.340230303</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nater</surname> <given-names>A</given-names></name><name><surname>Mattle-Greminger</surname> <given-names>MP</given-names></name><name><surname>Nurcahyo</surname> <given-names>A</given-names></name><name><surname>Nowak</surname> <given-names>MG</given-names></name><name><surname>de Manuel</surname> <given-names>M</given-names></name><name><surname>Desai</surname> <given-names>T</given-names></name><name><surname>Groves</surname> <given-names>C</given-names></name><name><surname>Pybus</surname> <given-names>M</given-names></name><name><surname>Sonay</surname> <given-names>TB</given-names></name><name><surname>Roos</surname> <given-names>C</given-names></name><name><surname>Lameira</surname> <given-names>AR</given-names></name><name><surname>Wich</surname> <given-names>SA</given-names></name><name><surname>Askew</surname> <given-names>J</given-names></name><name><surname>Davila-Ross</surname> <given-names>M</given-names></name><name><surname>Fredriksson</surname> <given-names>G</given-names></name><name><surname>de Valles</surname> <given-names>G</given-names></name><name><surname>Casals</surname> <given-names>F</given-names></name><name><surname>Prado-Martinez</surname> <given-names>J</given-names></name><name><surname>Goossens</surname> <given-names>B</given-names></name><name><surname>Verschoor</surname> <given-names>EJ</given-names></name><name><surname>Warren</surname> <given-names>KS</given-names></name><name><surname>Singleton</surname> <given-names>I</given-names></name><name><surname>Marques</surname> <given-names>DA</given-names></name><name><surname>Pamungkas</surname> <given-names>J</given-names></name><name><surname>Perwitasari-Farajallah</surname> <given-names>D</given-names></name><name><surname>Rianti</surname> <given-names>P</given-names></name><name><surname>Tuuga</surname> <given-names>A</given-names></name><name><surname>Gut</surname> <given-names>IG</given-names></name><name><surname>Gut</surname> <given-names>M</given-names></name><name><surname>Orozco-terWengel</surname> <given-names>P</given-names></name><name><surname>van Schaik</surname> <given-names>CP</given-names></name><name><surname>Bertranpetit</surname> <given-names>J</given-names></name><name><surname>Anisimova</surname> <given-names>M</given-names></name><name><surname>Scally</surname> <given-names>A</given-names></name><name><surname>Marques-Bonet</surname> <given-names>T</given-names></name><name><surname>Meijaard</surname> <given-names>E</given-names></name><name><surname>Krützen</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Morphometric, behavioral, and genomic evidence for a new orangutan species</article-title><source>Current Biology</source><volume>27</volume><fpage>3487</fpage><lpage>3498</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2017.09.047</pub-id><pub-id pub-id-type="pmid">29103940</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ragsdale</surname> <given-names>AP</given-names></name><name><surname>Gravel</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Models of archaic admixture and recent history from two-locus statistics</article-title><source>PLOS Genetics</source><volume>15</volume><elocation-id>e1008204</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1008204</pub-id><pub-id pub-id-type="pmid">31181058</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Russakovsky</surname> <given-names>O</given-names></name><name><surname>Deng</surname> <given-names>J</given-names></name><name><surname>Su</surname> <given-names>H</given-names></name><name><surname>Krause</surname> <given-names>J</given-names></name><name><surname>Satheesh</surname> <given-names>S</given-names></name><name><surname>Ma</surname> <given-names>S</given-names></name><name><surname>Huang</surname> <given-names>Z</given-names></name><name><surname>Karpathy</surname> <given-names>A</given-names></name><name><surname>Khosla</surname> <given-names>A</given-names></name><name><surname>Bernstein</surname> <given-names>M</given-names></name><name><surname>Berg</surname> <given-names>AC</given-names></name><name><surname>Fei-Fei</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>ImageNet large scale visual recognition challenge</article-title><source>International Journal of Computer Vision</source><volume>115</volume><fpage>211</fpage><lpage>252</lpage><pub-id pub-id-type="doi">10.1007/s11263-015-0816-y</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salomé</surname> <given-names>PA</given-names></name><name><surname>Bomblies</surname> <given-names>K</given-names></name><name><surname>Fitz</surname> <given-names>J</given-names></name><name><surname>Laitinen</surname> <given-names>RA</given-names></name><name><surname>Warthmann</surname> <given-names>N</given-names></name><name><surname>Yant</surname> <given-names>L</given-names></name><name><surname>Weigel</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The recombination landscape in <italic>Arabidopsis thaliana</italic> F2 populations</article-title><source>Heredity</source><volume>108</volume><fpage>447</fpage><lpage>455</lpage><pub-id pub-id-type="doi">10.1038/hdy.2011.95</pub-id><pub-id pub-id-type="pmid">22072068</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schiffels</surname> <given-names>S</given-names></name><name><surname>Durbin</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Inferring human population size and separation history from multiple genome sequences</article-title><source>Nature Genetics</source><volume>46</volume><fpage>919</fpage><lpage>925</lpage><pub-id pub-id-type="doi">10.1038/ng.3015</pub-id><pub-id pub-id-type="pmid">24952747</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sheehan</surname> <given-names>S</given-names></name><name><surname>Song</surname> <given-names>YS</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Deep learning for population genetic inference</article-title><source>PLOS Computational Biology</source><volume>12</volume><elocation-id>e1004845</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004845</pub-id><pub-id pub-id-type="pmid">27018908</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sugden</surname> <given-names>LA</given-names></name><name><surname>Atkinson</surname> <given-names>EG</given-names></name><name><surname>Fischer</surname> <given-names>AP</given-names></name><name><surname>Rong</surname> <given-names>S</given-names></name><name><surname>Henn</surname> <given-names>BM</given-names></name><name><surname>Ramachandran</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Localization of adaptive variants in human genomes using averaged one-dependence estimation</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>703</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-03100-7</pub-id><pub-id pub-id-type="pmid">29459739</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tataru</surname> <given-names>P</given-names></name><name><surname>Mollion</surname> <given-names>M</given-names></name><name><surname>Glémin</surname> <given-names>S</given-names></name><name><surname>Bataillon</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Inference of distribution of fitness effects and proportion of adaptive substitutions from polymorphism data</article-title><source>Genetics</source><volume>207</volume><fpage>1103</fpage><lpage>1119</lpage><pub-id pub-id-type="doi">10.1534/genetics.117.300323</pub-id><pub-id pub-id-type="pmid">28951530</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tennessen</surname> <given-names>JA</given-names></name><name><surname>Bigham</surname> <given-names>AW</given-names></name><name><surname>O'Connor</surname> <given-names>TD</given-names></name><name><surname>Fu</surname> <given-names>W</given-names></name><name><surname>Kenny</surname> <given-names>EE</given-names></name><name><surname>Gravel</surname> <given-names>S</given-names></name><name><surname>McGee</surname> <given-names>S</given-names></name><name><surname>Do</surname> <given-names>R</given-names></name><name><surname>Liu</surname> <given-names>X</given-names></name><name><surname>Jun</surname> <given-names>G</given-names></name><name><surname>Kang</surname> <given-names>HM</given-names></name><name><surname>Jordan</surname> <given-names>D</given-names></name><name><surname>Leal</surname> <given-names>SM</given-names></name><name><surname>Gabriel</surname> <given-names>S</given-names></name><name><surname>Rieder</surname> <given-names>MJ</given-names></name><name><surname>Abecasis</surname> <given-names>G</given-names></name><name><surname>Altshuler</surname> <given-names>D</given-names></name><name><surname>Nickerson</surname> <given-names>DA</given-names></name><name><surname>Boerwinkle</surname> <given-names>E</given-names></name><name><surname>Sunyaev</surname> <given-names>S</given-names></name><name><surname>Bustamante</surname> <given-names>CD</given-names></name><name><surname>Bamshad</surname> <given-names>MJ</given-names></name><name><surname>Akey</surname> <given-names>JM</given-names></name><collab>Broad GO, Seattle GO, NHLBI Exome Sequencing Project</collab></person-group><year iso-8601-date="2012">2012</year><article-title>Evolution and functional impact of rare coding variation from deep sequencing of human exomes</article-title><source>Science</source><volume>337</volume><fpage>64</fpage><lpage>69</lpage><pub-id pub-id-type="doi">10.1126/science.1219240</pub-id><pub-id pub-id-type="pmid">22604720</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Terhorst</surname> <given-names>J</given-names></name><name><surname>Kamm</surname> <given-names>JA</given-names></name><name><surname>Song</surname> <given-names>YS</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Robust and scalable inference of population history from hundreds of unphased whole genomes</article-title><source>Nature Genetics</source><volume>49</volume><fpage>303</fpage><lpage>309</lpage><pub-id pub-id-type="doi">10.1038/ng.3748</pub-id><pub-id pub-id-type="pmid">28024154</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Uricchio</surname> <given-names>LH</given-names></name><name><surname>Hernandez</surname> <given-names>RD</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Robust forward simulations of recurrent hitchhiking</article-title><source>Genetics</source><volume>197</volume><fpage>221</fpage><lpage>236</lpage><pub-id pub-id-type="doi">10.1534/genetics.113.156935</pub-id><pub-id pub-id-type="pmid">24561480</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>V Barroso</surname> <given-names>G</given-names></name><name><surname>Puzović</surname> <given-names>N</given-names></name><name><surname>Dutheil</surname> <given-names>JY</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Inference of recombination maps from a single pair of genomes and its application to ancient samples</article-title><source>PLOS Genetics</source><volume>15</volume><elocation-id>e1008449</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1008449</pub-id><pub-id pub-id-type="pmid">31725722</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Vecchyo</surname> <given-names>DOD</given-names></name><name><surname>Lohmueller</surname> <given-names>KE</given-names></name><name><surname>Novembre</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Haplotype-based inference of the distribution of fitness effects</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/770966</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="report"><person-group person-group-type="author"><name><surname>Wakeley</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2005">2005</year><source>Coalescent Theory, an Introduction.</source><publisher-name>Roberts and Company</publisher-name><ext-link ext-link-type="uri" xlink:href="http://www.coalescentheory.com/">http://www.coalescentheory.com/</ext-link></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec id="s8" sec-type="appendix"><title>Calculating coalescence rates</title><boxed-text><p>In population genetics, the ‘effective population size’ of a population model with constant (census) size is often defined to be the number of diploids in a Wright-Fisher population that would have the same coalescence rate (or, equivalently, genetic drift) as the population in question (reviewed in <xref ref-type="bibr" rid="bib11">Crow and Denniston, 1988</xref>). One reason the concept is useful is because theory predicts that genetic data from distinct populations with the same effective population size will look similar in many ways: for instance, their mean coalescence times will be the same. Conversely, this implies that effective population size should be easier to infer from genomic data than aspects of population demography that do not affect effective population size. An analogous observation holds for populations of changing size, if we define the ‘coalescence rate’ of a given demographic model at a particular point back in time to be the rate of coalescence of remaining lineages and define the ‘coalescence effective size’ at that time, denoted <inline-formula><mml:math id="inf42"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, so that the coalescence rate at time <inline-formula><mml:math id="inf43"><mml:mi>t</mml:mi></mml:math></inline-formula> in the past is <inline-formula><mml:math id="inf44"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. With these definitions, any two models with the same effective population size trajectory (<inline-formula><mml:math id="inf45"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) will have the same <italic>distribution</italic> of coalescence times. For this reason, we might guess that if we apply an inference method that assumes a Wright-Fisher population with changing size through time to a different population model, the inferred demographic history will match the ‘effective population size history’ defined in this way. These observations and the following calculations are standard in coalescent theory (see e.g. <xref ref-type="bibr" rid="bib59">Wakeley, 2005</xref>), but they are provided here for completeness.</p><p>We compute the coalescence rate of a collection of samples in a given demographic model at a particular point back in time as the expected number of coalescences happening at that time per unit of time and per pair of as-yet-uncoalesced lineages. More concretely, let <inline-formula><mml:math id="inf46"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> denote the probability that the lineages of a randomly chosen pair of samples have not yet coalesced <inline-formula><mml:math id="inf47"><mml:mi>t</mml:mi></mml:math></inline-formula> units of time ago, let <inline-formula><mml:math id="inf48"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> denote the probability that those lineages have not yet coalesced and are furthermore both in location <inline-formula><mml:math id="inf49"><mml:mi>z</mml:mi></mml:math></inline-formula>, and let <inline-formula><mml:math id="inf50"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> be the (effective) diploid population size in location <inline-formula><mml:math id="inf51"><mml:mi>z</mml:mi></mml:math></inline-formula> at the time, so that <inline-formula><mml:math id="inf52"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the rate of coalescence there. Then, we compute the mean coalescence rate as<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>z</mml:mi></mml:munder><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This follows because if we have <inline-formula><mml:math id="inf53"><mml:mi>m</mml:mi></mml:math></inline-formula> diploid samples, and hence <inline-formula><mml:math id="inf54"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> lineages, the expected number of coalescences in location <inline-formula><mml:math id="inf55"><mml:mi>z</mml:mi></mml:math></inline-formula> between times <inline-formula><mml:math id="inf56"><mml:mi>t</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf57"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> ago is<disp-formula id="equ2"><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>and the expected number of pairs of uncoalesced lineages at that time is<disp-formula id="equ3"><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The expression for <inline-formula><mml:math id="inf58"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a ratio of these two quantities; to obtain it we need to compute <inline-formula><mml:math id="inf59"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf60"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. This is relatively straightforward using the general theory of Markov chains (e.g,. <xref ref-type="bibr" rid="bib32">Kemeny et al., 2012</xref>), and is implemented in <monospace>msprime</monospace>.</p><p>Note that since these quantities are <italic>per pair of lineages</italic>, this definition depends on the locations of the samples. The coalescence rate also has the intuitive interpretation that it is the average between-lineage coalescence rate, averaged over where uncoalesced lineages might be. Since the local coalescence rate is the inverse of the population size, <inline-formula><mml:math id="inf61"><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (as shown for instance in <xref ref-type="fig" rid="fig2">Figure 2</xref>) is a weighted harmonic mean of the census sizes of the different populations present at that time. This is as expected: suppose that we have two populations, one big and one small, connected by migration. If all our samples are from the big population, the number of recent coalescences should be small, reflecting the large population size, while in the long run, the coalescence rate approaches an intermediate rate. On the other hand, more recent coalescences are expected if all samples are from the small population, A method that fits a single, time-varying population size to the data might be expected to find a population size trajectory to match these time-varying rates of coalescence.</p><p>We use the same computations to analytically compute <italic>mean coalescence times</italic>: since for any nonnegative random variable <inline-formula><mml:math id="inf62"><mml:mi>T</mml:mi></mml:math></inline-formula>, the mean value is <inline-formula><mml:math id="inf63"><mml:mrow><mml:mi>𝔼</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mn>0</mml:mn><mml:mi mathvariant="normal">∞</mml:mi></mml:msubsup><mml:mi>ℙ</mml:mi><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>T</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>, we can obtain the mean coalescence time as<disp-formula id="equ4"><mml:math id="m4"><mml:mrow><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mn>0</mml:mn><mml:mi mathvariant="normal">∞</mml:mi></mml:msubsup><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>𝑑</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf64"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is defined above.</p><p>The coalescence rate trajectories can be computed from a model in <monospace>msprime</monospace> using the <monospace>coalescence_rate_trajectory</monospace> method of the Demography Debugger class, which can be obtained from a stdpopsim model using the <monospace>model.get_demography_debugger()</monospace> method.</p><fig id="app1fig1" position="float"><label>Appendix 1—figure 1.</label><caption><title>Validating the <monospace>SLiM</monospace> engine backend under a genetic map.</title><p>Here, we validate our integration of the <monospace>SLiM</monospace> (<xref ref-type="bibr" rid="bib22">Haller et al., 2019</xref>; <xref ref-type="bibr" rid="bib23">Haller and Messer, 2019</xref>) engine backend. We show quantile-quantile plots between <monospace>SLiM</monospace> and <monospace>msprime</monospace> engines for three population genetic summary statistics: <italic>r<sup>2</sup></italic>, Tajima’s <inline-formula><mml:math id="inf65"><mml:mi>π</mml:mi></mml:math></inline-formula>, and Tajima’s D. Additionally, we show runtimes for generating each simulation replicate. Data were generated by simulating 100 replicates of human chromosome 22 under the AncientEurasia_9K19 model (<xref ref-type="bibr" rid="bib28">Kamm et al., 2019</xref>) using the <monospace>HapMapII_GRCh37</monospace> genetic map (<xref ref-type="bibr" rid="bib18">Frazer et al., 2007</xref>). 12 samples were drawn from each population (excluding basal Eurasians). From top to bottom, we show results using three scaling factors for the population sizes: Q = 1, Q = 10, and Q = 50. Kolmogorov-Smirnov two-sample test statistics (<bold>D</bold>) and p-values are shown, testing the null hypothesis that the quantiles were drawn from the same continuous distribution.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54967-app1-fig1-v3.tif"/></fig><fig id="app1fig2" position="float"><label>Appendix 1—figure 2.</label><caption><title>Validating the <monospace>SLiM</monospace> engine backend under uniform recombination.</title><p>Here, we validate our integration of the <monospace>SLiM</monospace> (<xref ref-type="bibr" rid="bib22">Haller et al., 2019</xref>; <xref ref-type="bibr" rid="bib23">Haller and Messer, 2019</xref>) engine backend. We show quantile-quantile plots between <monospace>SLiM</monospace> and <monospace>msprime</monospace> engines for three population genetic summary statistics: <italic>r<sup>2</sup></italic>, Tajima’s <inline-formula><mml:math id="inf66"><mml:mi>π</mml:mi></mml:math></inline-formula>, and Tajima’s D. Additionally, we show runtimes for generating each simulation replicate. Data were generated by simulating 100 replicates of human chromosome 22 under the AncientEurasia_9K19 model (<xref ref-type="bibr" rid="bib28">Kamm et al., 2019</xref>) using a uniform rate of recombination across the chromosome. 12 samples were drawn from each population (excluding basal Eurasians). From top to bottom, we show results using three scaling factors for the population sizes: Q = 1, Q = 10, and Q = 50. Kolmogorov-Smirnov two-sample test statistics (<bold>D</bold>) and p-values are shown, testing the null hypothesis that the quantiles were drawn from the same continuous distribution.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54967-app1-fig2-v3.tif"/></fig><fig id="app1fig3" position="float"><label>Appendix 1—figure 3.</label><caption><title>Comparing simulated population sizes and inverse coalescence rates in humans.</title><p>Data are shown from human genomes under the <monospace>OutOfAfricaArchaicAdmixture_5R19</monospace> model (<xref ref-type="bibr" rid="bib47">Ragsdale and Gravel, 2019</xref>) and using the HapMapII_GRCh37 genetic map (<xref ref-type="bibr" rid="bib18">Frazer et al., 2007</xref>). From left to right, we show sizes for each of the three populations in the model: YRI, CEU, and CHB. We plot the simulated sizes for each population in black, and in red we plot inverse coalescence rates as calculated from the demographic model used for simulation (see text). In this specific model, these two measures are near identical, but in other models with higher migration rates we expect to see a larger departure between the two.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54967-app1-fig3-v3.tif"/></fig><fig id="app1fig4" position="float"><label>Appendix 1—figure 4.</label><caption><title>Comparing estimates of <inline-formula><mml:math id="inf67"><mml:mrow><mml:mi>N</mml:mi><mml:mo mathvariant="bold">⁢</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in humans.</title><p>Estimates of population size over time (<inline-formula><mml:math id="inf68"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) inferred using four different methods, <monospace>smc++, stairway plot</monospace>, and <monospace>MSMC</monospace> with <inline-formula><mml:math id="inf69"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf70"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula>. Data were generated by simulating replicate human genomes under the OutOfAfrica_3G09 model (<xref ref-type="bibr" rid="bib21">Gutenkunst et al., 2009</xref>) and using the <monospace>HapMapII_GRCh37</monospace> genetic map (<xref ref-type="bibr" rid="bib18">Frazer et al., 2007</xref>). From top to bottom, we show estimates for each of the three populations in the model: YRI, CEU, and CHB. In shades of blue, we show the estimated <inline-formula><mml:math id="inf71"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> trajectories for each replicate. As a proxy for the ‘truth’, in black we show inverse coalescence rates as calculated from the demographic model used for simulation (see text).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54967-app1-fig4-v3.tif"/></fig><fig id="app1fig5" position="float"><label>Appendix 1—figure 5.</label><caption><title>Comparing estimates of <inline-formula><mml:math id="inf72"><mml:mrow><mml:mi>N</mml:mi><mml:mo mathvariant="bold">⁢</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in humans.</title><p>Here, we show estimates of population size over time (<inline-formula><mml:math id="inf73"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) inferred using fourdifferent methods, <monospace>smc+</monospace>, and <monospace>stairway plot</monospace>, and <monospace>MSMC</monospace> with <inline-formula><mml:math id="inf74"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf75"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula>. Data were generated by simulating replicate human genomes under a constant sized population model with <inline-formula><mml:math id="inf76"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> and using the <monospace>HapMapII_GRCh37</monospace> genetic map (<xref ref-type="bibr" rid="bib18">Frazer et al., 2007</xref>). As a proxy for the ‘truth’, in black we show inverse coalescence rates as calculated from the demographic model used for simulation (see text).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54967-app1-fig5-v3.tif"/></fig><fig id="app1fig6" position="float"><label>Appendix 1—figure 6.</label><caption><title>Comparing estimates of <inline-formula><mml:math id="inf77"><mml:mrow><mml:mi>N</mml:mi><mml:mo mathvariant="bold">⁢</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in <italic>A. thaliana</italic>.</title><p>Here, we show estimates of population size over time (<inline-formula><mml:math id="inf78"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) inferred using four different methods, <monospace>smc++</monospace>, and <monospace>stairway plot</monospace>, and <monospace>MSMC</monospace> with <inline-formula><mml:math id="inf79"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf80"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula>. Data were generated by simulating replicate <italic>A. thaliana</italic> genomes under the <monospace>African2Epoch_1H18</monospace> model (<xref ref-type="bibr" rid="bib14">Durvasula et al., 2017</xref>) and using the <monospace>SalomeAveraged_TAIR7</monospace> genetic map (<xref ref-type="bibr" rid="bib49">Salomé et al., 2012</xref>). As a proxy for the ‘truth’, in black we show inverse coalescence rates as calculated from the demographic model used for simulation (see text).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54967-app1-fig6-v3.tif"/></fig><fig id="app1fig7" position="float"><label>Appendix 1—figure 7.</label><caption><title>Migration rate estimates for the human Gutenkunst model.</title><p>Here, we show inferred migration rates from <inline-formula><mml:math id="inf81"><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <monospace>fastsimcoal2.</monospace> Data were generated by simulating replicate human genomes under the <xref ref-type="bibr" rid="bib21">Gutenkunst et al., 2009</xref> model and using the genetic map inferred in <xref ref-type="bibr" rid="bib18">Frazer et al., 2007</xref>. Directional migration from Europe to Africa is represented as <inline-formula><mml:math id="inf82"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">_</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">_</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>U</mml:mi></mml:mrow></mml:math></inline-formula> and migration from Africa to Europe is represented as <inline-formula><mml:math id="inf83"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">_</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">_</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:math></inline-formula>. Note that the <inline-formula><mml:math id="inf84"><mml:mi>x</mml:mi></mml:math></inline-formula>-axis coordinates are arbitrary.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54967-app1-fig7-v3.tif"/></fig><fig id="app1fig8" position="float"><label>Appendix 1—figure 8.</label><caption><title>Parameters estimated using a two-population <italic>Drosophila</italic> model.</title><p>Here, we show estimates of <inline-formula><mml:math id="inf85"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> inferred using <inline-formula><mml:math id="inf86"><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <monospace>fastsimcoal2</monospace>, and <monospace>smc++</monospace>. Data were generated by simulating replicate <italic>Drosophila</italic> genomes under the <xref ref-type="bibr" rid="bib40">Li and Stephan, 2006</xref> model and using the genetic map inferred in <xref ref-type="bibr" rid="bib10">Comeron et al., 2012</xref>. See legend of <xref ref-type="fig" rid="fig4">Figure 4</xref> for details. In shades of blue, we show the estimated <inline-formula><mml:math id="inf87"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> trajectories for each replicate. In black we show the simulated population sizes.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54967-app1-fig8-v3.tif"/></fig><fig id="app1fig9" position="float"><label>Appendix 1—figure 9.</label><caption><title>Migration rate parameters estimated under a two-population <italic>Drosophila</italic> model.</title><p>Here, we show inferred migration rates from <inline-formula><mml:math id="inf88"><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <monospace>fastsimcoal2</monospace>. Data were generated by simulating replicate <italic>Drosophila</italic> genomes under the <xref ref-type="bibr" rid="bib40">Li and Stephan, 2006</xref> model and using the genetic map inferred in <xref ref-type="bibr" rid="bib10">Comeron et al., 2012</xref>. Directional migration from Europe to Africa is represented as <inline-formula><mml:math id="inf89"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">_</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">_</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>U</mml:mi></mml:mrow></mml:math></inline-formula> and migration from Africa to Europe is represented as <inline-formula><mml:math id="inf90"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">_</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">_</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:math></inline-formula>. Note that the <inline-formula><mml:math id="inf91"><mml:mi>x</mml:mi></mml:math></inline-formula>-axis coordinates are arbitrary.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54967-app1-fig9-v3.tif"/></fig><fig id="app1fig10" position="float"><label>Appendix 1—figure 10.</label><caption><title>Workflow for our N(t) inference methods comparison.</title><p>Here, we show single replicate for two chromosomes, chr22 and chrX, simulated under the HomSap OutOfAfrica_3G09 demographic model, with a HapmapII_GRCh37 genetic map. Note that the data used as input by all inference methods <monospace>smc++, MSMC</monospace>, and <monospace>stairway plot</monospace>, come from the same set of simulations.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54967-app1-fig10-v3.tif"/></fig><fig id="app1fig11" position="float"><label>Appendix 1—figure 11.</label><caption><title>Parameters estimated from a generic IM model Here we show estimates of <inline-formula><mml:math id="inf92"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> inferred using <inline-formula><mml:math id="inf93"><mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <monospace>fastsimcoal2</monospace>, and <monospace>smc++</monospace>.</title><p>Data were generated by simulating under a generic IM model with a human genome and <xref ref-type="bibr" rid="bib18">Frazer et al., 2007</xref> genetic map. In shades of blue we show the estimated <inline-formula><mml:math id="inf94"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> trajectories for each replicate. In black we show the simulated population sizes.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-54967-app1-fig11-v3.tif"/></fig></boxed-text></sec></app></app-group></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.54967.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Coop</surname><given-names>Graham</given-names></name><role>Reviewing Editor</role><aff><institution>University of California, Davis</institution><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Novembre</surname><given-names>John</given-names> </name><role>Reviewer</role><aff><institution>University of Chicago</institution><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Sethuraman</surname><given-names>Arun</given-names> </name><role>Reviewer</role><aff><institution/></aff></contrib><contrib contrib-type="reviewer"><name><surname>Mathieson</surname><given-names>Sara</given-names> </name><role>Reviewer</role><aff><institution/></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>Simulations have long been central to population genetics. Population genomics has, in turn, become central to numerous areas of evolutionary biology and human genetics, and a vast array of different statistical methods have been developed. However, these methods are rarely ground-truthed in any truly reproducible manner. This paper takes an important set of steps in developing a flexible framework to standardize testing of population genetics software.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;A community-maintained standard library of population genetic models&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Patricia Wittkopp as the Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: John Novembre (Reviewer #1); Arun Sethuraman (Reviewer #2); Sara Mathieson (Reviewer #3).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Simulations have long been central to population genetics. Population genomics has, in turn, become central to numerous areas of evolutionary biology and human genetics, and a vast array of different statistical methods have been developed. However, these methods are rarely ground-truthed in any truly reproducible manner. This paper takes an important set of steps in developing a flexible framework to standardize testing of population genetics software.</p><p>The reviewers' comments are all reasonably straight forward, often hit on similar points, and so most should be easily addressable. Please respond to each point in your response to reviews. In our online discussions with the reviewers three points came the fore:</p><p>1) Ensuring that the language about the models and parameters conveys the correct sense of uncertainty. Obviously the reviewers and the authors know that these just represent best guesses at the moment, but as this platform catches on we don't want these numbers and models to be seen as gospel.</p><p>2) We would like to see the SLIM integration demonstrated with an application that MsPrime doesn't cover. This could be, for example, a figure of the average value some summary statistics surrounding a selective under the human demographic model. The reviewers didn't want this to be a lot of work, e.g. it would be outside of the scope of the current paper to demonstrate the power of a range of selection methods. However, we felt that a simple demonstration of the functionality would substantially increase the scenarios easily available and imaginable by readers of the paper.</p><p>3) We felt that the Discussion would benefit from a discussion of the details not yet incorporated into the platform, e.g. sex-specific recombination, gene conversion, assembly error, structural variants etc. Such an addition might spur future development, and also give the authors an opportunity to discuss general ways forward on these issues.</p><p>4) We would be interested to see more of a discussion of the strengths and weakness of the various demographic inference methods.</p><p>Beyond testing methods, another major use axis that I can personally see for this platform is for empirical researchers to see whether patterns they see in their data are consistent with known demographic models. For example, demonstrating whether the frequency spectrum in larger samples lines up with previously inferred models. Having all of these models implemented in a central place will significantly lower the barrier of entry of empirical researchers into rigorous simulation frameworks.</p><p>Overall we are very excited to see this big move forward and welcome the authors' careful work in this important area.</p><p><italic>Reviewer #1:</italic></p><p>The manuscript describes a community effort to standardize population genetic simulations and it presents an example of the resource's utility for method's testing. This development answers a long-standing need in the population genetics community for greater standardization and ease-of-implementation of simulation protocols. As such, I expect it will be a well-used resource and it represents an important advance for the field's practices. From the test implementation included in the paper, it was remarkable to see how highly variable (and often poor) the performance of the demographic inference methods was, and those results add to the scientific contribution of this manuscript.</p><p>Some of the specific features that are nice about the work are the incorporation of inferred genetic maps where possible, the automated output of citation information, the use of long-term stable identifiers for models and genetic maps, and the outputting of provenance information in the tree sequence files.</p><p>1) Emphasize parameters are current best-guesses:</p><p>a) I am most worried about the fragility of the models over time and the misperception one might have that these models are &quot;accurate&quot; for a species. Genome assemblies change, recombination rates improve, mutation rates change, etc. I would like to see that uncertainty reflected more in the language used in the paper so that it's clear the catalog is a collection of inferred parameters that are subject to change over time. This is a subtle and cosmetic, but important I think. For example, &quot;the library defines basic information about each species genome, including information about chromosome lengths, average mutation rates, and generation times.&quot; Yet, this is information we don't have – each of these parameters is actively under revision/discussion for even the best studied species. It would be great to hammer home these are all inferred values. (Also see sentence on &quot;details on the physical organization of its genome&quot;; the same comment applies, and an improvement might be something like &quot;details on the physical organization of the latest reference genome assembled for the species&quot;).</p><p>b) On a related note, there is wording regarding ensuring &quot;implemented models are accurate&quot; – I think what is meant is that the &quot;implemented models are faithful to the source publications from which they derive&quot;. As the second half of this paper makes clear, because of errors in inference, many of these models will not be accurate, in the sense of representing the true history of the species.</p><p>2) It would be wonderful to have a comments section for the models that would be either curated by a set of editors or crowd-sourced. I say this because overtime, models will proliferate, and some will come to be regarded as out-of-date. One can imagine those approaching the field afresh will be overwhelmed by the possible selections and possible implement models that become outdated. If the goal is standardization, how do we communicate that standards change? A comment system (or even star-rating system?) may be wise to implement now. Assuming it can be layered on top of the existing structure, it may be enough for this publication to note this as a future challenge that needs development/addressing.</p><p>3) In terms of the maturity of the examples developed for the initial release, I would have liked to see at least one simulation model with a selective sweep, one with background selection, and one with spatial stepping-stone structure. Each of these would be helpful test cases to implement to be sure that the existing catalog framework has the breadth/flexibility necessary to accommodate future use cases. I do not think this is a requirement for publication, but it would add great value to this initial release of the resource.</p><p>4) The approach of masking &quot;low-recombination&quot; portions of the chromosomes seems like an incomplete/indirect attempt to model the inherent limitations of sequencing to an &quot;accessible&quot; genome.</p><p>a) Shouldn't the approach instead be to drop &quot;low complexity&quot; regions (e.g., as defined by an excessive number of &quot;N&quot;'s in the reference, low mapability scores, or via tools like RepeatMasker?). This part of the pipeline seems open to refinement.</p><p>b) Are the &quot;masks&quot; a separate configuration file for the simulations? It seems that it would be preferable for them to be separate from the recombination rate files – right now it reads as if the mask applied is a function of the genetic map file, but this seems too inflexible for users who prefer an alternative approach to masking.</p><p><italic>Reviewer #2:</italic></p><p>The authors in this manuscript describe the implementation of a publicly curated, open source simulation package called stdpopsim – equipped with commonly utilized population genetic demographic models in humans, <italic>Drosophila melanogaster</italic>, and <italic>Arabidopsis thaliana</italic>. I am in awe of what these authors have achieved, in terms of benchmarking these standard models in an effort to avoid duplication of effort, and possibility of erroneous inference. The package is currently equipped with several &quot;in-built&quot; models that allow the simulation of trees with msprime and SLiM. The authors explain the application of these models by simulating and benchmarking estimates of Ne under a couple of scenarios. The manuscript is also well written, and use popular tools like dadi and smc++ to estimate and benchmark the simulations under a variety of models. Across all simulated scenarios (except under more complex models), the simulations seem relatively accurate.</p><p>Despite a little hiccup with python version mismatch prior to me successfully installing stdpopsim, I was able to successfully get the tutorials running within minutes after. I have one recommendation however for the tutorials – it would definitely help if the CLI versus python tutorials were kept separate. I found it a little confusing since they are all listed on the same page (https://stdpopsim.readthedocs.io/en/latest/tutorial.html). The simulations, testing models, calculating divergences, plotting ran without a hitch, and I am impressed and excited to play around with more models in coming days. Having also developed similar libraries/pipelines, I have also found it extremely useful for developers to provide some more detailed documentation/tutorials via Jupyter notebooks, or some similar platform. I did however notice that the authors have provided their analyses as Snakemake files in the interest of replication. I did not replicate their analyses, but I trust that the documentation for these analyses are detailed enough to aid readers/users in establishing similar analysis pipelines for stdpopsim simulated data.</p><p>I thoroughly enjoyed reading this manuscript, and learning of all the new features that have been written into stdpopsim, and believe that this will be an invaluable contribution to the population genomics community.</p><p><italic>Reviewer #3:</italic></p><p>The authors present a standardized framework for creating reproducible population genetic simulations. This resource will allow researchers to create models for new species/scenarios, and easily compare methods on the same dataset. The authors are correct that the current state of benchmarking in population genetics causes inconsistency, duplicated effort, and confusion about the performance of different methods. The authors highlight that creating a realistic and meaningful simulation study is a barrier to entering this field, and I absolutely agree. I will be passing this resource on to my students and look forward to using it myself. Stdpopsim is a crucial step forward. The manuscript itself is well-written and describes an extensive comparison of demography methods in a variety of species/scenarios. I have a few comments.</p><p>1) The authors mention that SLiM can be used as an alternative backend, which would presumably allow for simulations with selection. Although I don't think an extensive comparison of selection methods is necessary for this paper, it would be ideal if the authors can give some idea of how this would work (example command line, etc). There are also a myriad of methods for detecting/quantifying selection, and these simulations are not consistent either.</p><p>2) I like the inclusion of the &quot;zigzag&quot; history, as well as generic piecewise constant models and IM models (subsection “The Species Catalog”). I wonder if these could be included in a separate section (not organism specific) in the documentation and software (and then in Table 1). Right now the zigzag model is under humans in the catalog.</p><p>3) In the subsection “Use case: comparing methods of demographic inference”, the authors set up notation for the number of replicates (R), number of chromosomes (C), and sample size (n), but don't seem to use it afterward (or use it inconsistently). It would be helpful if all the figure legends and main text included this notation (I am guessing the number of replicates is 3 based on the images, but this should be clarified). The authors use N in the Materials and methods (i.e. subsection “Workflow for analysis of simulated data”) to refer to population size (which makes sense), but then also say &quot;In all cases we set the sample size of the focal population to N = 50 chromosomes.&quot; For MSMC, the sample size was set to n=2,8 which suggests haploid samples, but the &quot;Calculating coalescence rates&quot; section says that n is the diploid sample size.</p><p>4) &quot;Calculating coalescence rates&quot; section needs a read through. Reword first sentence and add some citations (especially regarding computing p(t) and p(z,t)). It was unclear to me how the &quot;mean coalescence times&quot; were used (the rate was used to compute the ground truth over time). This section is also referred to as the Appendix in the main text.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.54967.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>[…] In our online discussions with the reviewers three points came the fore:</p><p>1) Ensuring that the language about the models and parameters conveys the correct sense of uncertainty. Obviously the reviewers and the authors know that these just represent best guesses at the moment, but as this platform catches on we don't want these numbers and models to be seen as gospel.</p></disp-quote><p>We fully agree that the language in the original manuscript was not careful enough in conveying uncertainty about the models and parameters we discuss. We have made edited the text throughout the manuscript to address this. See our response to reviewer 1 below for examples. We have also added a bit more to the Discussion (below “next steps”) on this point.</p><disp-quote content-type="editor-comment"><p>2) We would like to see the SLIM integration demonstrated with an application that MsPrime doesn't cover. This could be, for example, a figure of the average value some summary statistics surrounding a selective under the human demographic model. The reviewers didn't want this to be a lot of work, e.g. it would be outside of the scope of the current paper to demonstrate the power of a range of selection methods. However, we felt that a simple demonstration of the functionality would substantially increase the scenarios easily available and imaginable by readers of the paper.</p></disp-quote><p>We would like to see this also and agree that it would be of great interest. However, we felt that performing adequate simulations with selection would require a substantial amount of additional work and would significantly expand the scope of the manuscript. Furthermore, discussing selection would distract from the current relatively simple focus on inference of demographic history. We definitely intend to include selection (and expand the available generic models) in future work, as we now discuss in greater detail in the Discussion (“next steps”).</p><p>Instead, we have decided to add a section validating the use of SLiM in stdpopsim neutral simulations (see “simulation engines” section in the Results and Appendix—figures 1 and 2). Our focus there was to show that under neutral simulations, SLiM produced data that were consistent with the coalescent simulations of msprime. To expand on this fundamental point, we also examined the influence of population size down-scaling, which is a common practice used in forward simulations, and indeed often crucial for tractable compute times. While this is by no means a comprehensive investigation into this issue, we do believe that it demonstrates the use of SLiM in future applications that will also simulate selection.</p><disp-quote content-type="editor-comment"><p>3) We felt that the Discussion would benefit from a discussion of the details not yet incorporated into the platform, e.g. sex-specific recombination, gene conversion, assembly error, structural variants etc. Such an addition might spur future development, and also give the authors an opportunity to discuss general ways forward on these issues.</p></disp-quote><p>Thank you for this good idea – we have expanded the section of the Discussion</p><p>(“next steps”) with more detail on our future plans. While that is so we are wary of promising too much at this point.</p><disp-quote content-type="editor-comment"><p>4) We would be interested to see more of a discussion of the strengths and weakness of the various demographic inference methods.</p></disp-quote><p>We have added an additional paragraph to the Discussion exploring various factors that may affect choice of inference method. These include the data required by the method, the type of model, and the implementation. We also provide a qualitative comparison between the performance of methods, as shown in our limited analysis. We believe that a more comprehensive comparison between methods is beyond the scope of the current manuscript, which focuses on the resource itself, rather than its application.</p><disp-quote content-type="editor-comment"><p>Beyond testing methods, another major use axis that I can personally see for this platform is for empirical researchers to see whether patterns they see in their data are consistent with known demographic models. For example, demonstrating whether the frequency spectrum in larger samples lines up with previously inferred models. Having all of these models implemented in a central place will significantly lower the barrier of entry of empirical researchers into rigorous simulation frameworks.</p></disp-quote><p>This is an important point – we have (naturally) focused on methods benchmarking, but our impact could well be greater if stdpopsim becomes widely used among empirical researchers (for whom on average running realistic simulations presents a greater barrier than to developers of computational methods). We’ve added a paragraph about this to the Discussion and additional words to the Abstract.</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>[…] 1) Emphasize parameters are current best-guesses:</p><p>a) I am most worried about the fragility of the models over time and the misperception one might have that these models are &quot;accurate&quot; for a species. Genome assemblies change, recombination rates improve, mutation rates change, etc. I would like to see that uncertainty reflected more in the language used in the paper so that it's clear the catalog is a collection of inferred parameters that are subject to change over time. This is a subtle and cosmetic, but important I think. For example, &quot;the library defines basic information about each species genome, including information about chromosome lengths, average mutation rates, and generation times.&quot; Yet, this is information we don't have – each of these parameters is actively under revision/discussion for even the best studied species. It would be great to hammer home these are all inferred values. (Also see sentence on &quot;details on the physical organization of its genome&quot;; the same comment applies, and an improvement might be something like &quot;details on the physical organization of the latest reference genome assembled for the species&quot;).</p></disp-quote><p>We thank the reviewer for bringing up this important point and fully agree that the language in the manuscript needs to better emphasize the uncertainty in our current parameter estimates. To address this, we have made several changes throughout the manuscript, including the passages cited above:</p><p>The first quoted passage now reads: “For each species, the catalog contains curated information on our current understanding of the physical organization of its genome, inferred genetic maps, population-level parameters (e.g., mutation rate and generation time estimates), and published demographic models. These models and parameters are meant to represent the field’s current understanding, and we intend for this resource to evolve as new results become available, and other existing models are added to stdpopsim by the community.”</p><p>The second passage now reads: “Firstly, the library defines some basic information about our current understanding of each species’ genome, including information about chromosome lengths, average mutation rate estimates, and generation times. We also provide access to detailed empirical information such as inferred genetic maps, which model observed heterogeneity in recombination rate along chromosomes.”</p><disp-quote content-type="editor-comment"><p>b) On a related note, there is wording regarding ensuring &quot;implemented models are accurate&quot; – I think what is meant is that the &quot;implemented models are faithful to the source publications from which they derive&quot;. As the second half of this paper makes clear, because of errors in inference, many of these models will not be accurate, in the sense of representing the true history of the species.</p></disp-quote><p>We made the suggested change: “Importantly, we developed rigorous quality control methods to ensure that we have correctly implemented the models as described in their original publication and provided documented methods for others to contribute new models.”</p><disp-quote content-type="editor-comment"><p>2) It would be wonderful to have a comments section for the models that would be either curated by a set of editors or crowd-sourced. I say this because overtime, models will proliferate, and some will come to be regarded as out-of-date. One can imagine those approaching the field afresh will be overwhelmed by the possible selections and possible implement models that become outdated. If the goal is standardization, how do we communicate that standards change? A comment system (or even star-rating system?) may be wise to implement now. Assuming it can be layered on top of the existing structure, it may be enough for this publication to note this as a future challenge that needs development/addressing.</p></disp-quote><p>Thank you for this forward-thinking comment. We considered various ways to do this (e.g., by enabling the wiki associated with the github repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/popsim-consortium/stdpopsim/issues/415">https://github.com/popsim-consortium/stdpopsim/issues/415</ext-link>)</p><disp-quote content-type="editor-comment"><p>3) In terms of the maturity of the examples developed for the initial release, I would have liked to see at least one simulation model with a selective sweep, one with background selection, and one with spatial stepping-stone structure. Each of these would be helpful test cases to implement to be sure that the existing catalog framework has the breadth/flexibility necessary to accommodate future use cases. I do not think this is a requirement for publication, but it would add great value to this initial release of the resource.</p></disp-quote><p>As mentioned in our response to the editor’s comments, we agree that this is an important avenue to pursue in the near future. However, performing adequate simulations with selection would require a substantial amount of additional work and would likely distract from the current relatively simple focus on inference of demographic history. We definitely intend to include selection (and expand the available generic models) in future work, as we now discuss in greater detail in the Discussion (“next steps”).</p><disp-quote content-type="editor-comment"><p>4) The approach of masking &quot;low-recombination&quot; portions of the chromosomes seems like an incomplete/indirect attempt to model the inherent limitations of sequencing to an &quot;accessible&quot; genome.</p><p>a) Shouldn't the approach instead be to drop &quot;low complexity&quot; regions (e.g., as defined by an excessive number of &quot;N&quot;'s in the reference, low mapability scores, or via tools like RepeatMasker?). This part of the pipeline seems open to refinement.</p></disp-quote><p>Our initial motivation for masking was to reduce the overrepresentation of marginal trees with little to no recombination from biasing patterns of diversity in such a way that demographic inference methods would be misled. While we agree with the reviewer that different masking approaches might better reflect the masking done on real genomic data, at this time the best way to mask remains an open question, and we feel that a nuanced analysis of masking is outside the scope of this paper. For these reasons, we feel that masking using a simple recombination rate threshold is a reasonable approach. We note that there is however a substantial correlation between recombination rate and mappability (by any of the measures mentioned above) wherein the notoriously difficult portions of genomes to assemble are generally in regions of low recombination. We agree that there may indeed be better ways to mask, which is why we allow users to mask their simulations as they see fit.</p><disp-quote content-type="editor-comment"><p>b) Are the &quot;masks&quot; a separate configuration file for the simulations? It seems that it would be preferable for them to be separate from the recombination rate files – right now it reads as if the mask applied is a function of the genetic map file, but this seems too inflexible for users who prefer an alternative approach to masking.</p></disp-quote><p>Mask files are not currently a component of stdpopsim proper, rather they were implemented separately from running stdpopsim, for the sole purpose of comparing demographic inference methods. All of the masks that we have used are available on the analysis repository that is associated with this manuscript. Users who download stdpopsim will always be simulating raw and unmasked tree sequence files, to which they can apply any variety of masks post hoc, if they so choose. We are currently making plans, however, to incorporate some version of this process into a future stdpopsim release.</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>[…] Despite a little hiccup with python version mismatch prior to me successfully installing stdpopsim, I was able to successfully get the tutorials running within minutes after. I have one recommendation however for the tutorials – it would definitely help if the CLI versus python tutorials were kept separate. I found it a little confusing since they are all listed on the same page (https://stdpopsim.readthedocs.io/en/latest/tutorial.html). The simulations, testing models, calculating divergences, plotting ran without a hitch, and I am impressed and excited to play around with more models in coming days. Having also developed similar libraries/pipelines, I have also found it extremely useful for developers to provide some more detailed documentation/tutorials via Jupyter notebooks, or some similar platform. I did however notice that the authors have provided their analyses as Snakemake files in the interest of replication. I did not replicate their analyses, but I trust that the documentation for these analyses are detailed enough to aid readers/users in establishing similar analysis pipelines for stdpopsim simulated data.</p></disp-quote><p>Good idea – we have reorganized the Tutorials and added to them, and have also added in a basic stdpopsim API and CLI example in a Jupyter Notebook that can be accessed and used interactively via Binder and encourage users to try out the tutorials there. We have linked to the Binder in the README on the GitHub. See https://mybinder.org/v2/gh/popsimconsortium/stdpopsim/master?filepath=stdpopsim_example.ipynb</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>[…] I have a few comments.</p><p>1) The authors mention that SLiM can be used as an alternative backend, which would presumably allow for simulations with selection. Although I don't think an extensive comparison of selection methods is necessary for this paper, it would be ideal if the authors can give some idea of how this would work (example command line, etc). There are also a myriad of methods for detecting/quantifying selection, and these simulations are not consistent either.</p></disp-quote><p>As mentioned in our response to the editor’s comment, we added a demonstration of the use of SLiM to the Results (see “Simulation engines” section and Appendix—figures 2 and 2). See also our response to related comments made by reviewers #1 and #2.</p><disp-quote content-type="editor-comment"><p>2) I like the inclusion of the &quot;zigzag&quot; history, as well as generic piecewise constant models and IM models (subsection “The Species Catalog”). I wonder if these could be included in a separate section (not organism specific) in the documentation and software (and then in Table 1). Right now the zigzag model is under humans in the catalog.</p></disp-quote><p>We considered both of these suggestions, and here’s why we’ve left it the way it is. Most of the columns of the table don’t apply to generic models, so it seems strange to include them there. The “zigzag” model could definitely be a generic model, and indeed was initially implemented as such. However, the reason we settled on the zigzag model is being defined as a human model (see discussion at https://github.com/popsim-consortium/stdpopsim/issues/106) is that its effective population size values are taken from (or at least inspired by) values inferred from human genomes: as implemented, it is not as “generic” as it might seem.</p><disp-quote content-type="editor-comment"><p>3) In the subsection “Use case: comparing methods of demographic inference”, the authors set up notation for the number of replicates (R), number of chromosomes (C), and sample size (n), but don't seem to use it afterward (or use it inconsistently). It would be helpful if all the figure legends and main text included this notation (I am guessing the number of replicates is 3 based on the images, but this should be clarified). The authors use N in the Materials and methods (i.e. subsection “Workflow for analysis of simulated data”) to refer to population size (which makes sense), but then also say &quot;In all cases we set the sample size of the focal population to N = 50 chromosomes.&quot; For MSMC, the sample size was set to n=2,8 which suggests haploid samples, but the &quot;Calculating coalescence rates&quot; section says that n is the diploid sample size.</p></disp-quote><p>This is a good catch! We see why this is confusing. We introduced this notation</p><p>(R, C, and n) to make it completely clear in this paragraph what exactly was being simulated, but we feel that continuing to use this notation elsewhere would actually obscure things, since we don’t do any calculations with these quantities. We have changed the “n” in the Appendix to an “m”.</p><disp-quote content-type="editor-comment"><p>4) &quot;Calculating coalescence rates&quot; section needs a read through. Reword first sentence and add some citations (especially regarding computing p(t) and p(z,t)). It was unclear to me how the &quot;mean coalescence times&quot; were used (the rate was used to compute the ground truth over time). This section is also referred to as the Appendix in the main text.</p></disp-quote><p>We’ve expanded the first sentence substantially, and added a few more citations. We apologize that we don’t know of a paper to cite that does precisely the same calculations (but don’t doubt that such a paper exists), and instead refer only vaguely to “general theory of Markov chains” (but now with a citation). The section is now explicitly labeled “Appendix”. Hopefully this is more clear now.</p></body></sub-article></article>