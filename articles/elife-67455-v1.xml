<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">67455</article-id><article-id pub-id-type="doi">10.7554/eLife.67455</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Physics of Living Systems</subject></subj-group></article-categories><title-group><article-title>A simple regulatory architecture allows learning the statistical structure of a changing environment</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-226954"><name><surname>Landmann</surname><given-names>Stefan</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-226953"><name><surname>Holmes</surname><given-names>Caroline M</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9885-4933</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-52589"><name><surname>Tikhonov</surname><given-names>Mikhail</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9558-1121</contrib-id><email>tikhonov@wustl.edu</email><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Institute of Physics, Carl von Ossietzky University of Oldenburg</institution><addr-line><named-content content-type="city">Oldenburg</named-content></addr-line><country>Germany</country></aff><aff id="aff2"><label>2</label><institution>Department of Physics, Princeton University</institution><addr-line><named-content content-type="city">Princeton</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution>Department of Physics, Center for Science and Engineering of Living Systems, Washington University in St. Louis</institution><addr-line><named-content content-type="city">St. Louis</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="senior_editor"><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><role>Senior Editor</role><aff><institution>École Normale Supérieure</institution><country>France</country></aff></contrib><contrib contrib-type="editor"><name><surname>Murugan</surname><given-names>Arvind</given-names></name><role>Reviewing Editor</role><aff><institution>University of Chicago</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>07</day><month>09</month><year>2021</year></pub-date><pub-date pub-type="collection"><year>2021</year></pub-date><volume>10</volume><elocation-id>e67455</elocation-id><history><date date-type="received" iso-8601-date="2021-02-11"><day>11</day><month>02</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2021-07-30"><day>30</day><month>07</month><year>2021</year></date></history><permissions><copyright-statement>© 2021, Landmann et al</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>Landmann et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-67455-v1.pdf"/><abstract><p>Bacteria live in environments that are continuously fluctuating and changing. Exploiting any predictability of such fluctuations can lead to an increased fitness. On longer timescales, bacteria can ‘learn’ the structure of these fluctuations through evolution. However, on shorter timescales, inferring the statistics of the environment and acting upon this information would need to be accomplished by physiological mechanisms. Here, we use a model of metabolism to show that a simple generalization of a common regulatory motif (end-product inhibition) is sufficient both for learning continuous-valued features of the statistical structure of the environment and for translating this information into predictive behavior; moreover, it accomplishes these tasks near-optimally. We discuss plausible genetic circuits that could instantiate the mechanism we describe, including one similar to the architecture of two-component signaling, and argue that the key ingredients required for such predictive behavior are readily accessible to bacteria.</p></abstract><abstract abstract-type="executive-summary"><title>eLife digest</title><p>Associations inferred from previous experience can help an organism predict what might happen the next time it faces a similar situation. For example, it could anticipate the presence of certain resources based on a correlated environmental cue.</p><p>The complex neural circuitry of the brain allows such associations to be learned and unlearned quickly, certainly within the lifetime of an animal. In contrast, the sub-cellular regulatory circuits of bacteria are only capable of very simple information processing. Thus, in bacteria, the ‘learning’ of environmental patterns is believed to mostly occur by evolutionary mechanisms, over many generations.</p><p>Landmann et al. used computer simulations and a simple theoretical model to show that bacteria need not be limited by the slow speed of evolutionary trial and error. A basic regulatory circuit could, theoretically, allow a bacterium to learn subtle relationships between environmental factors within its lifetime. The essential components for this simulation can all be found in bacteria – including a large number of ‘regulators’, the molecules that control the rate of biochemical processes. And indeed, some organisms often have more of these biological actors than appears to be necessary. The results of Landmann et al. provide new hypothesis for how such seemingly ‘superfluous’ elements might actually be useful.</p><p>Knowing that a learning process is theoretically possible, experimental biologists could now test if it appears in nature. Placing bacteria in more realistic, fluctuating conditions instead of a typical stable laboratory environment could demonstrate the role of the extra regulators in helping the microorganisms to adapt by ‘learning’.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>fluctuating environment</kwd><kwd>metabolic regulation</kwd><kwd>learning</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id><institution>Deutsche Forschungsgemeinschaft</institution></institution-wrap></funding-source><award-id>EN 278/10-1</award-id><principal-award-recipient><name><surname>Landmann</surname><given-names>Stefan</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>PHY-1734030</award-id><principal-award-recipient><name><surname>Holmes</surname><given-names>Caroline M</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>Graduate Research Fellowship</award-id><principal-award-recipient><name><surname>Holmes</surname><given-names>Caroline M</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Minimal modifications of common regulatory circuits can allow bacteria to learn from the past to better predict the future, on a physiological, rather than evolutionary, timescale.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Organisms that live in changing environments evolve strategies to respond to the fluctuations. Many such adaptations are reactive, for example sensory systems that allow detecting changes when they occur and responding to them. However, adaptations can be not only reactive, but also predictive. For example, circadian clocks allow photosynthetic algae to reorganize their metabolism in preparation for the rising sun (<xref ref-type="bibr" rid="bib3">Bell-Pedersen et al., 2005</xref>; <xref ref-type="bibr" rid="bib10">Husain et al., 2019</xref>). Another example is the anticipatory behavior in <italic>E. coli</italic>, which allows it to prepare for the next environment under its normal cycling through the mammalian digestive tract (<xref ref-type="bibr" rid="bib20">Savageau, 1983</xref>); similar behaviors have been observed in many species (<xref ref-type="bibr" rid="bib23">Tagkopoulos et al., 2008</xref>; <xref ref-type="bibr" rid="bib17">Mitchell et al., 2009</xref>).</p><p>All these behaviors effectively constitute predictions about a future environment: the organism improves its fitness by exploiting the regularities it ‘learns’ over the course of its evolution (<xref ref-type="bibr" rid="bib18">Mitchell and Lim, 2016</xref>). Learning such regularities can be beneficial even if they are merely statistical in nature. A prime example is bet hedging: even if the environment changes stochastically and without warning, a population that learns the statistics of switching can improve its long-term fitness, for example, by adopting persistor phenotypes with appropriate probability (<xref ref-type="bibr" rid="bib14">Kussell and Leibler, 2005</xref>; <xref ref-type="bibr" rid="bib24">Veening et al., 2008</xref>). The seemingly limitless ingenuity of evolutionary trial-and-error makes it plausible that virtually any statistical structure of the environment that remains constant over an evolutionary timescale could, in principle, be learnt by an evolving system, and harnessed to improve its fitness (<xref ref-type="bibr" rid="bib25">Watson and Szathmáry, 2016</xref>).</p><p>However, the statistical structure of the environment can itself change, and this change can be too quick to be learned by evolution (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). For example, an organism might experience a period of stability followed by a period of large fluctuations, or an environment where two resources are correlated, and then another where they are not. Note that there are two key timescales here – that of the fluctuations themselves (which we assume to be fast), and the slower timescale on which the <italic>structure</italic> of those fluctuations changes. One expects such scenarios to be common in an eco-evolutionary context. As an example, consider a bacterium in a small pool of water. Its immediate environment, shaped by local interactions, is fluctuating on the timescale at which the bacterium changes neighbors. The statistical properties of these fluctuations depend on the species composition of the pool. As such, the fast fluctuations are partially predictable, and learning their structure could help inform the fitness-optimizing strategy: a neighbor encountered in a recent past is likely to be seen again in the near future. However, these statistics change on an ecological timescale, and such learning would therefore need to be accomplished by physiological, rather than evolutionary, mechanisms.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Learning environment statistics can benefit living systems, but is a difficult problem.</title><p>(<bold>A</bold>) An environment is characterized not only by its current state, but also by its <italic>fluctuation structure</italic>, such as variances and correlations of fluctuating environmental parameters. In this work, we consider an environment undergoing epochs that differ in their fluctuation structure. Epochs are long compared to the physiological timescale, but switch faster than the evolutionary timescale. (<bold>B</bold>) The fluctuation structure can inform the fitness-maximizing strategy, but cannot be sensed directly. Instead, it would need to be learned from past observations, and used to inform future behavior. (<bold>C</bold>) To formalize the problem, we consider a situation where some internal physiological quantities <inline-formula><mml:math id="inf1"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> must track fluctuating external factors <inline-formula><mml:math id="inf2"><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> undergoing a random walk. Since it is impossible to react instantaneously, <inline-formula><mml:math id="inf3"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> always lags behind <inline-formula><mml:math id="inf4"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>. The dashed ellipse illustrates the fluctuation structure of <inline-formula><mml:math id="inf5"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> (encoded in parameters <inline-formula><mml:math id="inf6"><mml:mi>M</mml:mi></mml:math></inline-formula> and Γ, see text), and changes on a slower timescale than the fluctuations of <inline-formula><mml:math id="inf7"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>. (<bold>D, E</bold>) The optimal behavior in the two-dimensional version of our problem, under a constrained maximal rate of change <inline-formula><mml:math id="inf8"><mml:msup><mml:mrow><mml:mo>∥</mml:mo><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>∥</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>. For a given current <inline-formula><mml:math id="inf9"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> (blue dot), the optimal control strategy would steer any current <inline-formula><mml:math id="inf10"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> (green arrows) toward the best guess of the future <inline-formula><mml:math id="inf11"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>, which depends on the fluctuation structure (red ellipse: (<bold>D</bold>) fluctuations are uncorrelated and isotropic; (<bold>E</bold>) fluctuations have a preferred direction). The optimal strategy is derived using control theory (Appendix 1, section 'Control theory calculation').</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-67455-fig1-v1.tif"/></fig><p>On a physiological timescale, this problem is highly nontrivial: the organism would have to perform inference from prior observations, encode them in memory, and act upon this knowledge (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). It is clear that solutions to this problem do exist: such behaviors, common in neural systems, can be implemented by neural-network-like architectures; and these known architectures can be translated into biochemical networks (<xref ref-type="bibr" rid="bib8">Hjelmfelt et al., 1991</xref>; <xref ref-type="bibr" rid="bib13">Kobayashi, 2010</xref>; <xref ref-type="bibr" rid="bib4">Fages et al., 2017</xref>; <xref ref-type="bibr" rid="bib12">Katz and Springer, 2016</xref>; <xref ref-type="bibr" rid="bib11">Katz et al., 2018</xref>). But single-celled organisms operate in a severely hardware-limited regime rarely probed by neuroscience. Streamlined by evolution, bacterial genomes quickly shed any unused complexity. Whether we could expect learning-like behaviors from bacteria depends on whether useful networks could be simple enough to plausibly be beneficial.</p><p>Known examples of phenotypic memory, for example, when the response is mediated by a long-lived protein, can be interpreted as a simple form of learning (<xref ref-type="bibr" rid="bib15">Lambert et al., 2014</xref>; <xref ref-type="bibr" rid="bib9">Hoffer et al., 2001</xref>); circuits capable of adapting to the current mean of a fluctuating signal, as in bacterial chemotaxis (<xref ref-type="bibr" rid="bib1">Barkai and Leibler, 1997</xref>), also belong in this category. Prior theory work has also proposed that simple genetic circuits could learn more subtle binary features, such as a (transient) presence or absence of a correlation between two signals (<xref ref-type="bibr" rid="bib22">Sorek et al., 2013</xref>).</p><p>Here, we show that a simple generalization of a ubiquitous regulatory motif, the end-product inhibition, can learn, store, and ‘act upon’ the information on continuous-valued features such as timescales and correlations of environmental fluctuations, and moreover, can do so near-optimally. We identify the key ingredients giving rise to this behavior, and argue that their applicability is likely more general than the simple metabolically inspired example used here.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>The setup</title><p>For a simple model capturing some of the challenges of surviving in a fluctuating environment, consider a situation where some internal physiological quantities <inline-formula><mml:math id="inf12"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> must track fluctuating external variables <inline-formula><mml:math id="inf13"><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. For example, the expression of a costly metabolic pathway would ideally track the availability of the relevant nutrient, or the solute concentration in the cytoplasm might track the osmolarity of the environment. In abstract terms, we describe these environmental pressures by the time-dependent <inline-formula><mml:math id="inf14"><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and postulate that the organism fitness is determined by the average mismatch <inline-formula><mml:math id="inf15"><mml:mrow><mml:mo>-</mml:mo><mml:msqrt><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>, a quantity we will henceforth call ‘performance’. Here and below, angular brackets denote averaging over time.</p><p>In this simple model, a given static <inline-formula><mml:math id="inf16"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> clearly defines a unique optimal state <inline-formula><mml:math id="inf17"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>; the regulatory challenge is entirely due to <inline-formula><mml:math id="inf18"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> being a fluctuating quantity. The challenges faced by real organisms are certainly vastly more rich: even in the static case, the optimal behavior may not be unique, or even well-defined (optimal under what constraints?); and in the dynamic case, the future state of the environment could be affected by past actions of the organism. These considerations can add layers of complexity to the problem, but our minimal model is sufficient to focus on the basic issues of sensing, learning and responding to changing fluctuation statistics of external factors.</p><p>If <inline-formula><mml:math id="inf19"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> changes sufficiently slowly, the organism can sense it and adapt <inline-formula><mml:math id="inf20"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> accordingly. We, instead, are interested in the regime of rapid fluctuations. When changes in <inline-formula><mml:math id="inf21"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> are too rapid for the organism to match <inline-formula><mml:math id="inf22"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> to <inline-formula><mml:math id="inf23"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> exactly, it can rely on statistical structure. At the simplest level, the organism could match the mean, setting <inline-formula><mml:math id="inf24"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>≡</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. However, information on higher-order statistics, for example correlations between <italic>D</italic><sub>1</sub> and <italic>D</italic><sub>2</sub>, can further inform the behavior and improve fitness.</p><p>To see this, in what follows, we will consider the minimal case of such structured fluctuations, namely a <inline-formula><mml:math id="inf25"><mml:mi>N</mml:mi></mml:math></inline-formula>-dimensional vector <inline-formula><mml:math id="inf26"><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> undergoing a random walk in a quadratic potential (the Ornstein—Uhlenbeck process):<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msqrt></mml:mpadded><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>with mean <inline-formula><mml:math id="inf27"><mml:mover accent="true"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>, fluctuation strength Γ, independent Gaussian random variables <inline-formula><mml:math id="inf28"><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> with zero mean and unit variance, and the matrix <inline-formula><mml:math id="inf29"><mml:mi>M</mml:mi></mml:math></inline-formula> defining the potential.</p><p>In this system, the relevant ‘fluctuation structure’ is determined by <inline-formula><mml:math id="inf30"><mml:mi>M</mml:mi></mml:math></inline-formula> and Γ. In one dimension, <xref ref-type="disp-formula" rid="equ1">Equation (1)</xref> gives <inline-formula><mml:math id="inf31"><mml:mi>D</mml:mi></mml:math></inline-formula> a variance of <inline-formula><mml:math id="inf32"><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula>. In two dimensions, denoting the eigenvalues of <inline-formula><mml:math id="inf33"><mml:mi>M</mml:mi></mml:math></inline-formula> as <inline-formula><mml:math id="inf34"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, the stationary distribution of the fluctuating <inline-formula><mml:math id="inf35"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> is a Gaussian distribution with principal axes oriented along the eigenvectors of <inline-formula><mml:math id="inf36"><mml:mi>M</mml:mi></mml:math></inline-formula>, and standard deviations along these directions given by <inline-formula><mml:math id="inf37"><mml:msqrt><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:math></inline-formula> and <inline-formula><mml:math id="inf38"><mml:msqrt><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:math></inline-formula>. Intuitively, we can think of the fluctuating <inline-formula><mml:math id="inf39"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> as filling out an ellipse (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). Going forward, when we refer to learning fluctuation structure, we mean learning properties of <inline-formula><mml:math id="inf40"><mml:mi>M</mml:mi></mml:math></inline-formula> and Γ.</p><p>If <inline-formula><mml:math id="inf41"><mml:mi>M</mml:mi></mml:math></inline-formula> and Γ are known, the optimal strategy minimizing <inline-formula><mml:math id="inf42"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf43"><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is set by <xref ref-type="disp-formula" rid="equ1">Equation (1)</xref>, can be computed exactly, as a function of the maximum allowed rate of change <inline-formula><mml:math id="inf44"><mml:msup><mml:mrow><mml:mo>∥</mml:mo><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>∥</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib16">Liberzon, 2011</xref>). (If we do not constrain <inline-formula><mml:math id="inf45"><mml:msup><mml:mrow><mml:mo>∥</mml:mo><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>∥</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>, the optimal behavior is of course <inline-formula><mml:math id="inf46"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>.) Briefly, the optimal behavior is to steer <inline-formula><mml:math id="inf47"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> toward the best guess of the expected future <inline-formula><mml:math id="inf48"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> (see Appendix 1, section 'Control theory calculation'). This best guess depends on the fluctuation structure, as illustrated by the comparison between <xref ref-type="fig" rid="fig1">Figure 1D and E</xref> for an isotropic and an anisotropic <inline-formula><mml:math id="inf49"><mml:mi>M</mml:mi></mml:math></inline-formula>.</p><p>However, in our problem, we will assume that <inline-formula><mml:math id="inf50"><mml:mi>M</mml:mi></mml:math></inline-formula> and Γ do not stay constant long enough to be learned by evolution, and thus are unknown to the system. In this regime, it is not clear that the behavior of an <inline-formula><mml:math id="inf51"><mml:mi>M</mml:mi></mml:math></inline-formula>- and Γ-optimized system is relevant. Nevertheless, we will describe a regulatory architecture consisting of common regulatory elements that will adapt its responsiveness to the fluctuation structure of its input (‘learn’); for example, in the two-dimensional case, it will indeed develop the anisotropic response shown in <xref ref-type="fig" rid="fig1">Figure 1E</xref>. Moreover, we will find the steady-state performance of our architecture to be near-optimal, when compared to the theoretical ceiling of a system that knows <inline-formula><mml:math id="inf52"><mml:mi>M</mml:mi></mml:math></inline-formula> and Γ perfectly.</p></sec><sec id="s2-2"><title>Proposed architecture: end-product inhibition with an excess of regulators</title><p>The section above was intentionally very general. To discuss solutions available to cells, it is convenient to restrict the scope from this general formulation to a more specific metabolically-inspired case. From here onwards, let <inline-formula><mml:math id="inf53"><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> be the instantaneous demand in metabolite <italic>x</italic><sub><italic>i</italic></sub> (determined by external factors), and <inline-formula><mml:math id="inf54"><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> be the rate at which the metabolite is produced, with both defined in units of metabolite concentration per unit time. The number of components of the vector <inline-formula><mml:math id="inf55"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> now has the meaning of the number of metabolites, and we will denote it as <inline-formula><mml:math id="inf56"><mml:msub><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula>. The cell needs to match <inline-formula><mml:math id="inf57"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> to <inline-formula><mml:math id="inf58"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> (or, equivalently, maintain the homeostasis of the internal metabolite concentrations <italic>x</italic><sub><italic>i</italic></sub>).</p><p>The simplest way to solve this problem is via feedback inhibition. Consider first the case of a single metabolite <inline-formula><mml:math id="inf59"><mml:mi>x</mml:mi></mml:math></inline-formula>. If an accumulation of <inline-formula><mml:math id="inf60"><mml:mi>x</mml:mi></mml:math></inline-formula> inhibits its own synthesis, a decreased demand will automatically translate into a decreased production. For our purposes, we will model this scenario by placing the synthesis of metabolite <inline-formula><mml:math id="inf61"><mml:mi>x</mml:mi></mml:math></inline-formula> under the control of a regulator <inline-formula><mml:math id="inf62"><mml:mi>a</mml:mi></mml:math></inline-formula> (e.g. a transcription factor), which is, in turn, inhibited by <inline-formula><mml:math id="inf63"><mml:mi>x</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). For simplicity, we will measure regulator activity <inline-formula><mml:math id="inf64"><mml:mi>a</mml:mi></mml:math></inline-formula> directly in units of equivalent production of <inline-formula><mml:math id="inf65"><mml:mi>x</mml:mi></mml:math></inline-formula>. The dynamics of this system, linearized for small fluctuations of metabolite concentration <inline-formula><mml:math id="inf66"><mml:mi>x</mml:mi></mml:math></inline-formula>, can be written in the following form (see Appendix 1, section 'Simple end-product inhibition): <disp-formula id="equ2"><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mlabeledtr><mml:mtd><mml:mtext>(2a)</mml:mtext></mml:mtd><mml:mtd><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mfrac><mml:mi>x</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext>-</mml:mtext><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mi>x</mml:mi></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd><mml:mtext>(2b)</mml:mtext></mml:mtd><mml:mtd><mml:mi>P</mml:mi></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mi>a</mml:mi></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd><mml:mtext>(2c)</mml:mtext></mml:mtd><mml:mtd><mml:mrow><mml:mover><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mi>λ</mml:mi></mml:mfrac><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mi>x</mml:mi></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>The regulatory architecture we consider is a simple generalization of end-product inhibition.</title><p>(<bold>A</bold>) Simple end-product inhibition (SEPI) for one metabolite. Green arrows show activation, red arrows inhibition. (<bold>B</bold>) Natural extension of SEPI to several metabolites. (<bold>C</bold>) We consider regulatory architectures with more regulators than metabolites, with added self-activation (circular arrows) and a nonlinear activation/repression of regulators <inline-formula><mml:math id="inf67"><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> by the metabolite concentrations <italic>x</italic><sub><italic>i</italic></sub> (pictograms in circles). (<bold>D</bold>) Visualizing a regulation matrix <inline-formula><mml:math id="inf68"><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for two metabolites. In this example, the first regulator described by <inline-formula><mml:math id="inf69"><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> activates the production of <italic>x</italic><sub>1</sub>; the second inhibits <italic>x</italic><sub>1</sub> and activates <italic>x</italic><sub>2</sub>. For simplicity, we choose vectors of unit length, which can be represented by a dot on the unit circle. This provides a convenient way to visualize a given regulatory architecture. (<bold>E</bold>) The nonlinear dependence of regulator activity dynamics <inline-formula><mml:math id="inf70"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>μ</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> on metabolite concentrations <italic>x</italic><sub><italic>i</italic></sub> in our model (see <xref ref-type="disp-formula" rid="equ4">Equation 4</xref>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-67455-fig2-v1.tif"/></fig><p>Here, we introduced <italic>P</italic><sub>0</sub> with dimension of production (concentration per time) to render <inline-formula><mml:math id="inf71"><mml:mi>a</mml:mi></mml:math></inline-formula> dimensionless. In <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>c, λ has the units of concentration × time, and setting <inline-formula><mml:math id="inf72"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>≡</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> defines a time scale for changes in regulator activity. Assuming the dynamics of metabolite concentrations <inline-formula><mml:math id="inf73"><mml:mi>x</mml:mi></mml:math></inline-formula> are faster than regulatory processes, and choosing the units so that <inline-formula><mml:math id="inf74"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf75"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, we simplify the equations to: <disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>x</mml:mi></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>D</mml:mi></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>P</mml:mi></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mover><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>.</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We will refer to this architecture as simple end-product inhibition (SEPI). For two metabolites <inline-formula><mml:math id="inf76"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the straightforward generalization is to have two independent copies of this circuit, with two regulators <italic>a</italic><sub>1</sub>, <italic>a</italic><sub>2</sub> (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). Denoting the number of regulators as <inline-formula><mml:math id="inf77"><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula>, we note that in the SEPI architecture, there are as many regulators as there are metabolites: <inline-formula><mml:math id="inf78"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p><p>The architecture we will describe builds on this widely used regulatory motif, and relies on three added ingredients:</p><list list-type="order"><list-item><p>An excess of regulators: <inline-formula><mml:math id="inf79"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>;</p></list-item><list-item><p>Self-activation of regulators;</p></list-item><list-item><p>Nonlinear activation/repression of the regulators <inline-formula><mml:math id="inf80"><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> by the metabolite concentrations <italic>x</italic><sub><italic>i</italic></sub>.</p></list-item></list><p>Here and below, we use index μ for regulators (<inline-formula><mml:math id="inf81"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>) and index <inline-formula><mml:math id="inf82"><mml:mi>i</mml:mi></mml:math></inline-formula> for metabolites (<inline-formula><mml:math id="inf83"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>).</p><p>These three ingredients, we claim, will be sufficient for the circuit to both learn higher order statistics and to use this information appropriately when matching the production to demand. It is important to emphasize that all three are readily accessible to cells. In fact, there are multiple ways to build regulatory circuits exhibiting the proposed behavior using common regulatory elements. To focus on the general mechanism rather than any one particular implementation, we will defer describing these example circuits until later in the text (Figure 6); here, we will consider a minimal modification of <xref ref-type="disp-formula" rid="equ3">Equation (3)</xref> that contains the required ingredients:<disp-formula id="equ4"><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mlabeledtr><mml:mtd><mml:mtext>(4a)</mml:mtext></mml:mtd><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd><mml:mtext>(4b)</mml:mtext></mml:mtd><mml:mtd><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd><mml:mtext>(4c)</mml:mtext></mml:mtd><mml:mtd><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo form="prefix" movablelimits="true">max</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mspace width="thickmathspace"/><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>κ</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>This architecture bears a similarity to neural networks, and, as we will see, the familiar intuition about the value of extra ‘hidden nodes’ indeed holds. However, we caution the reader not to rely too heavily on this analogy. For example, here <inline-formula><mml:math id="inf84"><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a <italic>constant</italic> matrix describing how the activities of regulators <inline-formula><mml:math id="inf85"><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> control the synthesis of metabolites <italic>x</italic><sub><italic>i</italic></sub>.</p><p>For two metabolites (<inline-formula><mml:math id="inf86"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>) as in <xref ref-type="fig" rid="fig2">Figure 2C</xref>, each regulator is summarized by a 2-component vector <inline-formula><mml:math id="inf87"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>μ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>; its components can be of either sign (or zero) and specify how strongly the regulator <inline-formula><mml:math id="inf88"><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> is activating or repressing the synthesis of metabolite <italic>x</italic><sub><italic>i</italic></sub>. For simplicity, below, we will choose these vectors to be of unit length. Then, each regulator <inline-formula><mml:math id="inf89"><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> is fully characterized by an angle in the <inline-formula><mml:math id="inf90"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> plane, which allows for a convenient visualization of the regulatory systems (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). The <inline-formula><mml:math id="inf91"><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> defines the regulatory logic of our system and does not change with time. The parameter <inline-formula><mml:math id="inf92"><mml:mrow><mml:mi>d</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> allows us to tune the strength of the simple nonlinearity (<xref ref-type="fig" rid="fig2">Figure 2E</xref>); below we set <inline-formula><mml:math id="inf93"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (strong nonlinearity) unless explicitly stated otherwise. As we will show later, the learning behavior is also observed for more realistic functions such as the Hill function, but the simple piece-wise linear form of <xref ref-type="disp-formula" rid="equ4">Equation (4)</xref> will help us relate the observed behavior to specifically nonlinearity as opposed to, for example, cooperativity (the Hill parameter tunes both simultaneously). Finally, the parameter κ reflects degradation and is assumed to be small: <inline-formula><mml:math id="inf94"><mml:mrow><mml:mi>κ</mml:mi><mml:mo>≪</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. Previously, for SEPI, it could be neglected, but here, it will matter due to the nonlinearity; for more details, see Appendix 1, section 'Simple end-product inhibition'. The parameters used in simulations are all listed in Appendix 1, section 'Parameters used in figures'.</p><p>Just like simple end-product inhibition in <xref ref-type="disp-formula" rid="equ3">Equation (3)</xref>, the modified system <xref ref-type="disp-formula" rid="equ4">Equation (4)</xref> will correctly adapt production to any static demand (see Appendix 1, section 'Adaptation to static demand'). In the following, we will show that the added ingredients also enable learning the structure of fluctuating environments. For this purpose, we expose our system to demands <inline-formula><mml:math id="inf95"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with fixed means (<inline-formula><mml:math id="inf96"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) but a changing fluctuation structure.</p></sec><sec id="s2-3"><title>The regulatory architecture described above outperforms simple end-product inhibition by learning environment statistics</title><p>To show that our system is able to adapt to different fluctuation structures, we probe it with changing environmental statistics, and show that it, first, learns these statistics, and, second, is able to make use of this information in its behavior.</p><p>For simplicity, we start with the 1-dimensional case (<xref ref-type="fig" rid="fig3">Figure 3A–F</xref>). In dimension <inline-formula><mml:math id="inf97"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, an excess of regulators means we have both an activator <inline-formula><mml:math id="inf98"><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> and a repressor <inline-formula><mml:math id="inf99"><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula> for the production of <inline-formula><mml:math id="inf100"><mml:mi>x</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). This is reminiscent of paradoxical regulation (<xref ref-type="bibr" rid="bib7">Hart et al., 2012</xref>). We probe our system with changing environmental statistics by exposing it to a demand <inline-formula><mml:math id="inf101"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with an increasing variance (<xref ref-type="fig" rid="fig3">Figure 3B,C</xref>). As a reminder, here and below, the mean demand is fixed at 1.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>The regulatory architecture we consider successfully learns environment statistics, and outperforms simple end-product inhibition.</title><p>Left column in one dimension, right column in two. (<bold>A</bold>) Regulation of a single metabolite <inline-formula><mml:math id="inf102"><mml:mi>x</mml:mi></mml:math></inline-formula> with one activator <inline-formula><mml:math id="inf103"><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> and one repressor <inline-formula><mml:math id="inf104"><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula>. (<bold>B, C</bold>) The variance of <inline-formula><mml:math id="inf105"><mml:mi>D</mml:mi></mml:math></inline-formula> is increased step-wise (by increasing Γ). (<bold>D</bold>) Regulator activities <inline-formula><mml:math id="inf106"><mml:msub><mml:mi>a</mml:mi><mml:mo>±</mml:mo></mml:msub></mml:math></inline-formula> respond to the changing statistics of <inline-formula><mml:math id="inf107"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>. For SEPI, the activity of its single regulator is unchanged. (<bold>E</bold>) Faced with larger fluctuations, our system becomes more responsive. (<bold>F</bold>) As fluctuations increase, SEPI performance drops, while the circuit of panel A retains its performance. (<bold>G</bold>) In the 2d case, we consider a system with <inline-formula><mml:math id="inf108"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> regulators; visualization as in <xref ref-type="fig" rid="fig2">Figure 2D</xref>. (<bold>H</bold>) Cartoon of correlated demands with a dominant fluctuation direction (angle α). (<bold>I</bold>) We use α to change the fluctuation structure of the input. (<bold>J</bold>) Regulator activities respond to the changing statistics of <inline-formula><mml:math id="inf109"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>. Colors as in panel G. (<bold>K</bold>) The direction of largest responsiveness (‘learned angle’; see text) tracks the α of the input. (<bold>L</bold>) The system able to learn the dominant direction of fluctuations outperforms the SEPI architecture, even if the timescale <inline-formula><mml:math id="inf110"><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> of SEPI is adjusted to match the faster responsiveness of the <inline-formula><mml:math id="inf111"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> system (see Appendix 1, section 'Parameters used in figures'). Panels B and H are cartoons.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-67455-fig3-v1.tif"/></fig><p>Faced with a faster fluctuating input, our system upregulates both <inline-formula><mml:math id="inf112"><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf113"><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula> while keeping <inline-formula><mml:math id="inf114"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> constant (<inline-formula><mml:math id="inf115"><mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:mrow><mml:mo>≈</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>; <xref ref-type="fig" rid="fig3">Figure 3D</xref>). In this way, the two activity levels <inline-formula><mml:math id="inf116"><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf117"><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula> encode both the mean and the variance of fluctuations. Crucially, the system makes use of the information it stores: The increased regulator activities allow future changes in <inline-formula><mml:math id="inf118"><mml:mi>P</mml:mi></mml:math></inline-formula> to be faster. The system’s <italic>responsiveness</italic>, which we can define as <inline-formula><mml:math id="inf119"><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">ℛ</mml:mi><mml:mo>≡</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, increases as <inline-formula><mml:math id="inf120"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3E</xref>; see also Appendix 1, section 'Defining the system's responsiveness'). As a result, as shown in <xref ref-type="fig" rid="fig3">Figure 3F</xref>, our system is able to perform approximately equally well (after adaptation time) in each environment, unlike a system like simple end-product inhibition, which is unable to adapt its sensitivity. In summary, <xref ref-type="fig" rid="fig3">Figure 3D–F</xref> show that the simple architecture of <xref ref-type="fig" rid="fig3">Figure 3A</xref> can not only learn the statistics of environment fluctuations, but also ‘act upon this knowledge,’ effectively performing both computations of <xref ref-type="fig" rid="fig1">Figure 1B</xref>.</p><p>The idea of learning the fluctuation structure is perhaps clearer in dimension <inline-formula><mml:math id="inf121"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, since the two demands can now be correlated with each other, and it seems intuitive that a system able to learn the typical direction of fluctuations (the angle α in <xref ref-type="fig" rid="fig3">Figure 3H</xref>) should be able to track the input better. Indeed, as we saw in <xref ref-type="fig" rid="fig1">Figure 1D–E</xref>, when environment fluctuations are anisotropic, the responsiveness of a well-adapted strategy must be anisotropic as well: the preferred direction must elicit a stronger response. Mathematically, the responsiveness <inline-formula><mml:math id="inf122"><mml:mi class="ltx_font_mathcaligraphic">ℛ</mml:mi></mml:math></inline-formula> is now a matrix <inline-formula><mml:math id="inf123"><mml:mrow><mml:msub><mml:mi class="ltx_font_mathcaligraphic">ℛ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, and for a well-adapted system we expect its eigenvectors to align with the principal directions of <inline-formula><mml:math id="inf124"><mml:mi>M</mml:mi></mml:math></inline-formula>. In <xref ref-type="fig" rid="fig3">Figure 3G–L</xref>, <xref ref-type="fig" rid="fig4">Figure 4</xref> and <xref ref-type="fig" rid="fig5">Figure 5</xref>, our discussion will focus on this two-dimensional case.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>The ability to learn statistics is most useful when fluctuations are large and/or strongly correlated.</title><p>(<bold>A</bold>) The performance of different circuits shown as a function of Γ, which scales the fluctuation magnitude (input is two-dimensional and correlated, angle <inline-formula><mml:math id="inf125"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, anisotropy <inline-formula><mml:math id="inf126"><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msqrt><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>). Once the fluctuations become large enough to activate the learning mechanism, performance stabilizes; in contrast, the SEPI performance continues to decline. Arrows indicate the theoretical prediction for the threshold value of Γ; see Appendix 1, section 'The minimal Γ needed to initiate adaptation'. Dashed lines indicate the theoretical performance ceiling (calculated at equivalent Control Input Power, see text). (<bold>B</bold>) Comparison of circuit performance for inputs of the same variance, but different correlation strengths. <inline-formula><mml:math id="inf127"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> regulators arranged as shown can learn the variance but not correlation; the SEPI architecture is unable to adapt to either. Parameter Γ is held constant at 0.05; the marked points are identical to those highlighted in panel A (and correspond to fluctuation anisotropy <inline-formula><mml:math id="inf128"><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msqrt><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-67455-fig4-v1.tif"/></fig><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>The key ingredients enabling learning are an excess of regulators, nonlinearity, and self-activation.</title><p>(<bold>A</bold>) System performance in the two-dimensional case <inline-formula><mml:math id="inf129"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, shown as a function of the number of regulators <inline-formula><mml:math id="inf130"><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> (vertical axis) and the strength of nonlinearity <inline-formula><mml:math id="inf131"><mml:mi>d</mml:mi></mml:math></inline-formula> (horizontal axis; <inline-formula><mml:math id="inf132"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> is indistinguishable from a linear system with <inline-formula><mml:math id="inf133"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>). Color indicates performance gain relative to the SEPI architecture; performance is averaged over angle α (see <xref ref-type="fig" rid="fig3">Figure 3H</xref>). (<bold>B</bold>) Same as panel A, for a model without self-activation (see text). The SEPI-like architecture (linear with <inline-formula><mml:math id="inf134"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>) is highlighted.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-67455-fig5-v1.tif"/></fig><p><xref ref-type="fig" rid="fig3">Figure 3G–L</xref> show the behavior of our system (<xref ref-type="disp-formula" rid="equ4">Equation 4</xref>) with <inline-formula><mml:math id="inf135"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> regulators (<xref ref-type="fig" rid="fig3">Figure 3G</xref>), exposed to an input structured as shown in <xref ref-type="fig" rid="fig3">Figure 3H</xref>, where we vary α. As represented pictorially in <xref ref-type="fig" rid="fig3">Figure 3I</xref>, we rotate the fluctuation structure matrix <inline-formula><mml:math id="inf136"><mml:mi>M</mml:mi></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ1">Equation (1)</xref>, keeping its eigenvalues <inline-formula><mml:math id="inf137"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> fixed with <inline-formula><mml:math id="inf138"><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msqrt><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> (this fixes the ratio of major to minor semi-axis lengths).</p><p>With <inline-formula><mml:math id="inf139"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> regulators, matching the mean value of <inline-formula><mml:math id="inf140"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> would leave <inline-formula><mml:math id="inf141"><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> degrees of freedom that can be influenced by other parameters (such as variance in each dimension and correlation between different demands). And indeed, changing environment statistics induces strong changes in the regulator state adopted by the system, with regulators better aligned to the input fluctuations reaching higher expression (<xref ref-type="fig" rid="fig3">Figure 3J</xref>; note the diagrams at the top, where dot size reflects the activity reached by the corresponding regulator at the end of each epoch; compare to the diagrams in <xref ref-type="fig" rid="fig3">Figure 3I</xref>). This activity pattern shapes the responsiveness matrix <inline-formula><mml:math id="inf142"><mml:mi class="ltx_font_mathcaligraphic">ℛ</mml:mi></mml:math></inline-formula>. <xref ref-type="fig" rid="fig3">Figure 3K</xref> plots the ‘learned angle’, defined as the direction of the dominant eigenvector of <inline-formula><mml:math id="inf143"><mml:mi class="ltx_font_mathcaligraphic">ℛ</mml:mi></mml:math></inline-formula>; we find that it tracks the stimulus angle. Finally, <xref ref-type="fig" rid="fig3">Figure 3L</xref> demonstrates that our architecture is able to make use of this learning, outperforming the SEPI system, whose responsiveness is isotropic and fixed.</p></sec><sec id="s2-4"><title>The performance is near-optimal</title><p>In the previous section, we have shown by example (<xref ref-type="fig" rid="fig3">Figure 3</xref>) that the proposed regulatory architecture can learn the statistics of the environment. We now characterize systematically the conditions under which learning improves performance and compare our system to the theoretical performance ceiling. Note that unlike the general statement that learning correlations improves performance, the <italic>optimal</italic> performance ceiling is necessarily specific to a given model of the environmental fluctuations. Nevertheless, this comparison is informative.</p><p>The fluctuation structure in our model is defined by Γ and <inline-formula><mml:math id="inf144"><mml:mi>M</mml:mi></mml:math></inline-formula>. We first investigate the dependence of performance on Γ (<xref ref-type="fig" rid="fig4">Figure 4A</xref>), exposing our system to a two-dimensional input structured as in <xref ref-type="fig" rid="fig3">Figure 3H</xref> with <inline-formula><mml:math id="inf145"><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msqrt><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> as before, <inline-formula><mml:math id="inf146"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, and a changing Γ.</p><p>Although the input is two-dimensional, changing Γ scales the overall magnitude of fluctuations, and the behavior is analogous to the simpler one-dimensional example shown in the first column of <xref ref-type="fig" rid="fig3">Figure 3</xref>. At <inline-formula><mml:math id="inf147"><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (static input), and by extension, for Γ finite but small, examining the steady state of <xref ref-type="disp-formula" rid="equ4">Equation (4)</xref> shows that only <inline-formula><mml:math id="inf148"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> out of <inline-formula><mml:math id="inf149"><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> regulators can be active. In this regime, our system is essentially identical to SEPI—the extra regulators, though available, are inactive—and in fact performs slightly worse. This is because at nonzero κ, the steady state of <xref ref-type="disp-formula" rid="equ4">Equation (4)</xref> is slightly offset from the ideal state <inline-formula><mml:math id="inf150"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. (While this effect can be corrected, it is only relevant in the parameter regime where no learning occurs, so we chose to keep <xref ref-type="disp-formula" rid="equ4">Equation (4)</xref> as simple as possible; for additional discussion, see Appendix 1, section 'Performance penalty from the degradation term').</p><p>When Γ becomes sufficiently large, the first term in <xref ref-type="disp-formula" rid="equ4">Equation (4)</xref> (proportional to the fluctuation size <inline-formula><mml:math id="inf151"><mml:msqrt><mml:mi mathvariant="normal">Γ</mml:mi></mml:msqrt></mml:math></inline-formula>) for one of the inactive regulators finally exceeds, on average, the degradation term. At this point, the system enters the regime where the number of active regulators exceeds <inline-formula><mml:math id="inf152"><mml:msub><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula>, and its performance deviates from the SEPI curve. Beyond this point, further changes to the stimulus no longer affect performance, as our system is able to adapt its responsiveness to the changing fluctuation magnitude (compare to <xref ref-type="fig" rid="fig3">Figure 3F</xref>). The threshold value of Γ satisfies <inline-formula><mml:math id="inf153"><mml:mrow><mml:msqrt><mml:mi mathvariant="normal">Γ</mml:mi></mml:msqrt><mml:mo>∝</mml:mo><mml:mi>κ</mml:mi></mml:mrow></mml:math></inline-formula>; the proportionality coefficient of order 1 depends on the specific arrangement of regulators but can be estimated analytically (see Appendix 1, section 'The minimal Γ needed to initiate adaptation'). The theoretically predicted deviation points are indicated with arrows, and are in agreement with the simulation results. When a regulator in the system is particularly well-aligned with the dominant direction of fluctuations, the deviation occurs sooner, explaining the better performance of our system when the regulators are more numerous.</p><p>To better assess the performance of our system, we compare it to the theoretical optimum derived from control theory, which we represent with dotted lines in <xref ref-type="fig" rid="fig4">Figure 4A</xref>. For given <inline-formula><mml:math id="inf154"><mml:mi>M</mml:mi></mml:math></inline-formula> and Γ, the family of optimal behaviors is parameterized by Control Input Power (CIP), defined as <inline-formula><mml:math id="inf155"><mml:mrow><mml:mo largeop="true" rspace="0.8pt" symmetric="true">∫</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msup><mml:mrow><mml:mo>∥</mml:mo><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>∥</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mpadded><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>𝑑</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. If <inline-formula><mml:math id="inf156"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> could react infinitely fast, it would track <inline-formula><mml:math id="inf157"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> perfectly, but increasing response speed necessarily comes at a cost (of making more sensors, or more enzymes for faster synthesis / degradation of <italic>x</italic><sub><italic>i</italic></sub>); constraining the CIP is thus a proxy for specifying the maximum tolerable cost. In order to compare our system with the optimal family of solutions, we compute <inline-formula><mml:math id="inf158"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mpadded width="-1.7pt"><mml:msubsup><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup></mml:mpadded><mml:mrow><mml:mpadded width="+1.7pt"><mml:msup><mml:mrow><mml:mo>∥</mml:mo><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>∥</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mpadded><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>𝑑</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> of our system at each Γ (<inline-formula><mml:math id="inf159"><mml:mi>T</mml:mi></mml:math></inline-formula> is the simulation time), and compare to the performance of the optimally steered solution with a matched CIP; details of the calculation can be found in Appendix 1, section 'Control theory calculation'. <xref ref-type="fig" rid="fig4">Figure 4A</xref> demonstrates that the simple architecture we described not only benefits from matching its responsiveness to its input, but is in fact near-optimal when compared to <italic>any</italic> system of equivalent responsiveness.</p><p>It is important to note that for low Γ, the performance of the SEPI architecture also tracks the optimal curve. Throughout this work, our intention is not to demonstrate that SEPI is a ‘poor’ architecture. To the contrary, the surprising efficiency of SEPI has been noted before (<xref ref-type="bibr" rid="bib6">Goyal et al., 2010</xref>; <xref ref-type="bibr" rid="bib19">Pavlov and Ehrenberg, 2013</xref>), and <xref ref-type="fig" rid="fig4">Figure 4</xref> similarly shows that at its own CIP, its performance is virtually optimal. The advantage of our learning-capable architecture derives from its ability to increase responsiveness when necessary, in the correct direction. Our simplified treatment of the SEPI architecture is not a strawman we seek to dismiss, but an example of a system that exhibits no learning.</p><p>Having investigated the effect of fluctuation variance (changing Γ), we turn to the effect of their correlation. Up to now, we subjected our system to a strongly correlated two-dimensional input with anisotropy <inline-formula><mml:math id="inf160"><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msqrt><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> (illustrated, to scale, in <xref ref-type="fig" rid="fig1">Figure 1E</xref>). We will now consider a range of anisotropy values, down to anisotropy 1 (uncorrelated fluctuations, <xref ref-type="fig" rid="fig1">Figure 1D</xref>), keeping the variances of <italic>D</italic><sub>1</sub> and <italic>D</italic><sub>2</sub> constant, <inline-formula><mml:math id="inf161"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> as before, and <inline-formula><mml:math id="inf162"><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>The result is presented in <xref ref-type="fig" rid="fig4">Figure 4B</xref>. With <inline-formula><mml:math id="inf163"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> or larger, our system is able to take advantage of the correlation, assuming it is strong enough to activate the learning mechanism. (In fact, its performance can reach values that exceed the theoretical ceiling achievable by any system that assumes the two dimensions of <inline-formula><mml:math id="inf164"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> to be independent, and thus <italic>must</italic> be exploiting the correlation in its inputs; see Appendix 1, section 'The system makes use of correlations in the input' and <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>). For <inline-formula><mml:math id="inf165"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>, the performance curve remains flat. This is because the four regulators are arranged as two independent copies of the system shown in <xref ref-type="fig" rid="fig3">Figure 3A</xref> (one <inline-formula><mml:math id="inf166"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> pair for each of the two inputs); this architecture can take advantage of the learned variance, but not the correlation. Finally, the SEPI architecture can adapt to neither variance nor correlation; its performance curve is also flat, but is lower. As expected, the advantage of our architecture manifests itself in environments with periods of large and/or strongly correlated fluctuations.</p></sec><sec id="s2-5"><title>The behavior is generalizable</title><p>The model described above was a proof of principle, showing that simple regulatory circuits could learn the fluctuation structure of their inputs. Given the simplicity of our model, it is not to be expected that the exact dynamics of <xref ref-type="disp-formula" rid="equ4">Equation (4)</xref> are replicated in real cells. However, the benefit of this simplicity is that we can now trace this behavior to its key ingredients, which we expect to be more general than the model itself: an excess of regulators, nonlinearity, and self-activation. In this section, we examine their role: first in our model (<xref ref-type="fig" rid="fig5">Figure 5</xref>), and then in more realistic circuits, relaxing our simplifying assumptions (<xref ref-type="fig" rid="fig6">Figure 6</xref>).</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Realistic implementations.</title><p>(<bold>A</bold>) An alternative circuit that implements the logic described above, but with different forms of the key ingredients, including a Hill-function nonlinearity. Here, the circuit is based on a pair of self-activating enzymes which can be in an active (<inline-formula><mml:math id="inf167"><mml:msup><mml:mi>E</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>) or inactive state (<inline-formula><mml:math id="inf168"><mml:mi>E</mml:mi></mml:math></inline-formula>). For details see <xref ref-type="disp-formula" rid="equ5">Equation (5)</xref>. (<bold>B</bold>) Another circuit capable of learning fluctuation variance to better maintain homeostasis of a quantity <inline-formula><mml:math id="inf169"><mml:mi>x</mml:mi></mml:math></inline-formula>. Synthesis and degradation of <inline-formula><mml:math id="inf170"><mml:mi>x</mml:mi></mml:math></inline-formula> are catalyzed by the same bifunctional enzyme, whose production is regulated nonlinearly by <inline-formula><mml:math id="inf171"><mml:mi>x</mml:mi></mml:math></inline-formula> itself. For more details see <xref ref-type="disp-formula" rid="equ6 equ7">Equations (6) and (7)</xref>. (<bold>C</bold>) The circuit in panel A performs well at the homeostasis task of maintaining <inline-formula><mml:math id="inf172"><mml:mi>x</mml:mi></mml:math></inline-formula>’s concentration at 1, despite the changing variance of the input. For comparison, we’ve included a SEPI analogue of the circuit, described in Appendix 1, section 'Realistic biochemical implementations'. (<bold>D</bold>) Same as panel C, but with the circuit from panel B. Note that the ’SEPI’ line is different here, and is now a SEPI analogue of the circuit in panel B. (<bold>E</bold>) Solid arrows: a common two-component architecture of bacterial sensory systems with a bifunctional histidine kinase (X) and its cognate response regulator (Y). Adding an extra regulatory link (nonlinear auto-amplification, dashed arrow) can endow this system with self-tuned reactivity learning the statistics of the input; see text.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-67455-fig6-v1.tif"/></fig><p>In <xref ref-type="fig" rid="fig5">Figure 5</xref>, the parameter <inline-formula><mml:math id="inf173"><mml:mi>d</mml:mi></mml:math></inline-formula> on the horizontal axis is the strength of nonlinearity (see <xref ref-type="fig" rid="fig2">Figure 2E</xref>), from perfectly linear at <inline-formula><mml:math id="inf174"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, to strongly nonlinear at <inline-formula><mml:math id="inf175"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. The vertical axis corresponds to an increasing number of regulators <inline-formula><mml:math id="inf176"><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula>, which we label as in <xref ref-type="fig" rid="fig2">Figure 2D</xref>; for completeness, we also include the simplest system with a single regulator co-activating both <italic>x</italic><sub>1</sub> and <italic>x</italic><sub>2</sub> (bottom row). Panel A examines the performance of our system as defined in <xref ref-type="disp-formula" rid="equ4">Equation (4)</xref>, that is, with self-activation included. In panel B, we remove self-activation by omitting the prefactor <inline-formula><mml:math id="inf177"><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> in front of the max function in <xref ref-type="disp-formula" rid="equ4">Equation (4)</xref>. The color scheme is chosen so that red indicates an improvement, and blue a deterioration, of the circuit performance relative to the SEPI architecture, which approximately corresponds to the point highlighted in <xref ref-type="fig" rid="fig5">Figure 5B</xref>. The difference between the labeled point and the SEPI architecture is that all models represented in <xref ref-type="fig" rid="fig5">Figure 5</xref> include a small degradation term, which becomes important in the nonlinear regime. For the SEPI-like case, its effect on performance is negligible (see Appendix 1, section 'Performance penalty from the degradation term') . Performance is averaged over five angles α; see Appendix 1, section 'Parameters used in figures'.</p><p>Unsurprisingly, the performance of the simple SEPI-like architecture can be improved by adding extra regulators (pink region in <xref ref-type="fig" rid="fig5">Figure 5B</xref>): each new regulator allows the system to respond more quickly in a yet another direction of perturbation, with which it is ‘aligned’. However, such a strategy would have limited utility in a biological setting, since the marginal improvement per regulator must offset the cost of added complexity. The mechanism described here corresponds to the red area in <xref ref-type="fig" rid="fig5">Figure 5A</xref>. Importantly, in the presence of both nonlinearity and self-activation, even a single extra regulator (<inline-formula><mml:math id="inf178"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>) can already provide a significant benefit.</p><p><xref ref-type="fig" rid="fig5">Figure 5A</xref> shows that in the context of our model, the reported behavior requires <inline-formula><mml:math id="inf179"><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> to exceed <inline-formula><mml:math id="inf180"><mml:msub><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf181"><mml:mi>d</mml:mi></mml:math></inline-formula> to be sufficiently large. However, these ingredients are more general than the specific implementation in <xref ref-type="disp-formula" rid="equ4">Equation (4)</xref>. In our model, additional regulators were required because they supplied the slow degrees of freedom to serve as memory; such degrees of freedom could be implemented in other ways, for example, as phosphorylation or methylation (<xref ref-type="bibr" rid="bib1">Barkai and Leibler, 1997</xref>). Similarly, while nonlinearity is essential (linear dynamics cannot couple to higher-order terms, such as fluctuation magnitude), its exact functional form may be changed while retaining the learning behavior (see Appendix 1, section 'Nonlinearity acts as a sensor of fluctuation variance'). Finally, the explicitly self-catalytic behavior of <inline-formula><mml:math id="inf182"><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> in our model is only one possible strategy for translating the stored memory into a faster response.</p><p>To demonstrate the generality of these ingredients, we constructed two circuits with very different architectures (<xref ref-type="fig" rid="fig6">Figure 6A,B</xref>), both reproducing the results of <xref ref-type="fig" rid="fig3">Figure 3C–F</xref>. These are not the only ways that the logic described above can be implemented; rather, our intention is to show that as long as we keep the key elements, we can relax our simplifying assumptions, such as the form of the nonlinearity and self-activation, while still retaining the ability to learn.</p><p>The first of these proposed circuits (<xref ref-type="fig" rid="fig6">Figure 6A</xref>) is based on a pair of allosteric enzymes with the toy nonlinearity of <xref ref-type="fig" rid="fig2">Figure 2E</xref> replaced by more realistic cooperative binding, and implements dynamics otherwise very similar to those shown above. In this circuit, the enzymes <inline-formula><mml:math id="inf183"><mml:msub><mml:mi>E</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf184"><mml:msub><mml:mi>E</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula> can be in an active or inactive state: The active form of <inline-formula><mml:math id="inf185"><mml:msub><mml:mi>E</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula>, which we denote <inline-formula><mml:math id="inf186"><mml:msubsup><mml:mi>E</mml:mi><mml:mo>+</mml:mo><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula>, catalyzes the production of <inline-formula><mml:math id="inf187"><mml:mi>x</mml:mi></mml:math></inline-formula>; similarly, <inline-formula><mml:math id="inf188"><mml:msubsup><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> catalyzes degradation of <inline-formula><mml:math id="inf189"><mml:mi>x</mml:mi></mml:math></inline-formula>. In addition, the active enzymes can bind to molecules of the metabolite <inline-formula><mml:math id="inf190"><mml:mi>x</mml:mi></mml:math></inline-formula> to control the self-catalytic activity. The total concentration of <inline-formula><mml:math id="inf191"><mml:msubsup><mml:mi>E</mml:mi><mml:mo>+</mml:mo><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula>, bound and unbound, then plays the role of the activating regulator <inline-formula><mml:math id="inf192"><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> from above (<inline-formula><mml:math id="inf193"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mo>+</mml:mo><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mo>+</mml:mo><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>), while <inline-formula><mml:math id="inf194"><mml:msubsup><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> plays the role of the inhibitor <inline-formula><mml:math id="inf195"><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula> (<inline-formula><mml:math id="inf196"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>). The equations defining the dynamics are then:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="right left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mi>x</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mfrac><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>κ</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mfrac><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>κ</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Despite the extensive changes relative to <xref ref-type="fig" rid="fig3">Figure 3A</xref>, the system is still able to learn. <xref ref-type="fig" rid="fig6">Figure 6C</xref> compares its performance to a non-learning version with only the activating branch <inline-formula><mml:math id="inf197"><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula>, which is analogous to the single-activator SEPI architecture (compare to <xref ref-type="fig" rid="fig3">Figure 3F</xref>). For a detailed discussion of this more biologically plausible model, see Appendix 1, section 'A pair of allosteric enzymes'.</p><p>Our other proposed circuit (<xref ref-type="fig" rid="fig6">Figure 6B</xref>) differs significantly. Here, instead of seeking to match <inline-formula><mml:math id="inf198"><mml:mi>P</mml:mi></mml:math></inline-formula> to <inline-formula><mml:math id="inf199"><mml:mi>D</mml:mi></mml:math></inline-formula>, the system maintains the homeostasis of a concentration <inline-formula><mml:math id="inf200"><mml:mi>x</mml:mi></mml:math></inline-formula> perturbed by external factors. In this implementation, the production and degradation of <inline-formula><mml:math id="inf201"><mml:mi>x</mml:mi></mml:math></inline-formula> are both catalyzed by a single bifunctional enzyme; the responsiveness of this circuit scales with the overall expression of the enzyme <inline-formula><mml:math id="inf202"><mml:mi>E</mml:mi></mml:math></inline-formula>, and larger fluctuations of <inline-formula><mml:math id="inf203"><mml:mi>x</mml:mi></mml:math></inline-formula> lead to upregulation of <inline-formula><mml:math id="inf204"><mml:mi>E</mml:mi></mml:math></inline-formula> due to the nonlinearity, as before. (For a detailed discussion, see e Appendix 1, section 'An architecture based on a bifunctional enzyme'.) Defining <inline-formula><mml:math id="inf205"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> as the total concentration of the enzyme <inline-formula><mml:math id="inf206"><mml:mi>E</mml:mi></mml:math></inline-formula> in both its bound and unbound states, the bound and unbound fractions are described by Hill equations,<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mfrac><mml:msup><mml:mi>c</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo rspace="11pt">,</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The dynamics of our system are:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="right left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mi>x</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mi>κ</mml:mi><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Despite its compactness, this circuit is also able to learn (<xref ref-type="fig" rid="fig6">Figure 6D</xref>; compare to <xref ref-type="fig" rid="fig3">Figures 3F</xref> and <xref ref-type="fig" rid="fig6">6C</xref>).</p><p>Interestingly, this particular logic is very similar to a small modification of the standard two-component signaling architecture (<xref ref-type="fig" rid="fig6">Figure 6E</xref>). In this architecture, the signal <inline-formula><mml:math id="inf207"><mml:mi>s</mml:mi></mml:math></inline-formula> determines the concentration of the phosphorylated form <inline-formula><mml:math id="inf208"><mml:msub><mml:mi>Y</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math></inline-formula> of the response regulator <inline-formula><mml:math id="inf209"><mml:mi>Y</mml:mi></mml:math></inline-formula>; the rapidity of the response is determined by the expression of the histidine kinase <inline-formula><mml:math id="inf210"><mml:mi>X</mml:mi></mml:math></inline-formula>, present at a much lower copy number. Although the signaling architecture of <xref ref-type="fig" rid="fig6">Figure 6E</xref>, at least in some parameter regimes, is known to be robust to the overall concentrations of <inline-formula><mml:math id="inf211"><mml:mi>X</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf212"><mml:mi>Y</mml:mi></mml:math></inline-formula>(<xref ref-type="bibr" rid="bib2">Batchelor and Goulian, 2003</xref>), this robustness property applies only to the steady-state mapping from <inline-formula><mml:math id="inf213"><mml:mi>s</mml:mi></mml:math></inline-formula> to <inline-formula><mml:math id="inf214"><mml:msub><mml:mi>Y</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math></inline-formula>, not the kinetics. Thus, much like in <xref ref-type="fig" rid="fig6">Figure 6B,a</xref> nonlinear activation of <inline-formula><mml:math id="inf215"><mml:mi>X</mml:mi></mml:math></inline-formula> by <inline-formula><mml:math id="inf216"><mml:msub><mml:mi>Y</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math></inline-formula> (known as autoregulation [<xref ref-type="bibr" rid="bib5">Goulian, 2010</xref>] or autoamplification [<xref ref-type="bibr" rid="bib9">Hoffer et al., 2001</xref>], and shown as a dashed arrow in <xref ref-type="fig" rid="fig6">Figure 6E</xref>) would endow this signaling system with self-tuned reactivity that learns the statistics of the input.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In this paper, we have studied a regulatory architecture which is able to infer higher-order statistics from fluctuating environments and use this information to inform behavior. For concreteness, we phrased the regulatory task as seeking to match the production <inline-formula><mml:math id="inf217"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> of one or two metabolites to a rapidly fluctuating demand <inline-formula><mml:math id="inf218"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>. Alternatively, and perhaps more generally, the circuits we constructed can be seen as maintaining the homeostasis in a quantity <inline-formula><mml:math id="inf219"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> that is continually perturbed by external factors. We demonstrated that a simple architecture was capable of learning the statistics of fluctuations of its inputs and successfully using this information to optimize its performance. We considered one-dimensional and two-dimensional examples of such behavior.</p><p>In one dimension, learning the statistics of the input meant our circuit exhibited a self-tuned reactivity, learning to become more responsive during periods of larger fluctuations. Importantly, we have shown that this behavior can be achieved by circuits that are highly similar to known motifs, such as feedback inhibition (<xref ref-type="fig" rid="fig2">Figure 2A–C</xref>) or two-component signaling (<xref ref-type="fig" rid="fig6">Figure 6B,E</xref>). The latter connection is especially interesting: There are at least a few examples of two-component systems where autoamplification, a necessary ingredient for the learning behavior discussed here, has been reported (<xref ref-type="bibr" rid="bib21">Shin et al., 2006</xref>; <xref ref-type="bibr" rid="bib26">Williams and Cotter, 2007</xref>). Moreover, in the case of the PhoR/PhoB two-component system in <italic>E. coli</italic>, such autoamplification has been experimentally observed to allow cells to retain memory of a previously experienced signal (phosphate limitation; <xref ref-type="bibr" rid="bib9">Hoffer et al., 2001</xref>), a behavior the authors described as learning-like. As reported, this behavior constitutes a response to the signal mean and is similar to other examples of simple phenotypic memory (e.g. <xref ref-type="bibr" rid="bib15">Lambert et al., 2014</xref>); however, our analysis demonstrates that a similar architecture may also be able to learn more complex features. Such a capability would be most useful in contexts where the timescale of sensing could plausibly be the performance bottleneck. Since transcriptional processes are generally slower than the two-component kinetics, we expect our discussion to be more relevant for two-component systems with non-transcriptional readout, such as those involved in chemotaxis or efflux pump regulation.</p><p>In the two-dimensional case, our simple circuit was able to learn and unlearn transient correlation structures of its inputs, storing this information in expression levels of different regulators. Our argument was a proof of principle that, for example, the gut bacteria could have the means to not only sense, but also predict nutrient availability based on correlations learned from the past, including correlations that change over faster-than-evolutionary timescales, such as the life cycle (or dietary preferences) of the host. Importantly, we showed that this ability could come cheaply, requiring only a few ingredients beyond simple end-product inhibition.</p><p>The mechanism described here could suggest new hypotheses for the functional role of systems with an excess of regulators, as well as new hypotheses for bacterial function in environments with changing structure.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><p>All simulations performed in Python 3.7.4. Simulation scripts reproducing all figures are included as <xref ref-type="supplementary-material" rid="scode1">Source code 1</xref>.</p></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank M Goulian, A Murugan, and B Weiner for helpful discussions. SL was supported by the German Science Foundation under project EN 278/10–1; CMH was supported by the National Science Foundation, through the Center for the Physics of Biological Function (PHY-1734030) and the Graduate Research Fellowship Program.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Formal analysis, Investigation, Visualization, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Investigation, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Formal analysis, Supervision, Investigation, Writing - original draft, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="scode1"><label>Source code 1.</label><caption><title>Python 3.7.4 simulation code and scripts to reproduce all figures.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-67455-code1-v1.zip"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-67455-transrepform-v1.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Python simulation scripts reproducing all figures in the paper from scratch, as well as pre-computed simulation data files for faster plotting, are provided as Source code 1 (and are also publicly available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.17632/5xngwv5kps.2">https://doi.org/10.17632/5xngwv5kps.2</ext-link>).</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barkai</surname> <given-names>N</given-names></name><name><surname>Leibler</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Robustness in simple biochemical networks</article-title><source>Nature</source><volume>387</volume><fpage>913</fpage><lpage>917</lpage><pub-id pub-id-type="doi">10.1038/43199</pub-id><pub-id pub-id-type="pmid">9202124</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Batchelor</surname> <given-names>E</given-names></name><name><surname>Goulian</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Robustness and the cycle of phosphorylation and dephosphorylation in a two-component regulatory system</article-title><source>PNAS</source><volume>100</volume><fpage>691</fpage><lpage>696</lpage><pub-id pub-id-type="doi">10.1073/pnas.0234782100</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bell-Pedersen</surname> <given-names>D</given-names></name><name><surname>Cassone</surname> <given-names>VM</given-names></name><name><surname>Earnest</surname> <given-names>DJ</given-names></name><name><surname>Golden</surname> <given-names>SS</given-names></name><name><surname>Hardin</surname> <given-names>PE</given-names></name><name><surname>Thomas</surname> <given-names>TL</given-names></name><name><surname>Zoran</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Circadian rhythms from multiple oscillators: lessons from diverse organisms</article-title><source>Nature Reviews Genetics</source><volume>6</volume><fpage>544</fpage><lpage>556</lpage><pub-id pub-id-type="doi">10.1038/nrg1633</pub-id><pub-id pub-id-type="pmid">15951747</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Fages</surname> <given-names>F</given-names></name><name><surname>Le Guludec</surname> <given-names>G</given-names></name><name><surname>Bournez</surname> <given-names>O</given-names></name><name><surname>Pouly</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Strong turing completeness of continuous chemical reaction networks and compilation of mixed analog-digital programs</article-title><conf-name>International Conference on Computational Methods in Systems Biology</conf-name><fpage>108</fpage><lpage>127</lpage></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goulian</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Two-component signaling circuit structure and properties</article-title><source>Current Opinion in Microbiology</source><volume>13</volume><fpage>184</fpage><lpage>189</lpage><pub-id pub-id-type="doi">10.1016/j.mib.2010.01.009</pub-id><pub-id pub-id-type="pmid">20149717</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goyal</surname> <given-names>S</given-names></name><name><surname>Yuan</surname> <given-names>J</given-names></name><name><surname>Chen</surname> <given-names>T</given-names></name><name><surname>Rabinowitz</surname> <given-names>JD</given-names></name><name><surname>Wingreen</surname> <given-names>NS</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Achieving optimal growth through product feedback inhibition in metabolism</article-title><source>PLOS Computational Biology</source><volume>6</volume><elocation-id>e1000802</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000802</pub-id><pub-id pub-id-type="pmid">20532205</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hart</surname> <given-names>Y</given-names></name><name><surname>Antebi</surname> <given-names>YE</given-names></name><name><surname>Mayo</surname> <given-names>AE</given-names></name><name><surname>Friedman</surname> <given-names>N</given-names></name><name><surname>Alon</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Design principles of cell circuits with paradoxical components</article-title><source>PNAS</source><volume>109</volume><fpage>8346</fpage><lpage>8351</lpage><pub-id pub-id-type="doi">10.1073/pnas.1117475109</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hjelmfelt</surname> <given-names>A</given-names></name><name><surname>Weinberger</surname> <given-names>ED</given-names></name><name><surname>Ross</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Chemical implementation of neural networks and Turing machines</article-title><source>PNAS</source><volume>88</volume><fpage>10983</fpage><lpage>10987</lpage><pub-id pub-id-type="doi">10.1073/pnas.88.24.10983</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoffer</surname> <given-names>SM</given-names></name><name><surname>Westerhoff</surname> <given-names>HV</given-names></name><name><surname>Hellingwerf</surname> <given-names>KJ</given-names></name><name><surname>Postma</surname> <given-names>PW</given-names></name><name><surname>Tommassen</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Autoamplification of a two-component regulatory system results in &quot;learning&quot; behavior</article-title><source>Journal of Bacteriology</source><volume>183</volume><fpage>4914</fpage><lpage>4917</lpage><pub-id pub-id-type="doi">10.1128/JB.183.16.4914-4917.2001</pub-id><pub-id pub-id-type="pmid">11466297</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Husain</surname> <given-names>K</given-names></name><name><surname>Pittayakanchit</surname> <given-names>W</given-names></name><name><surname>Pattanayak</surname> <given-names>G</given-names></name><name><surname>Rust</surname> <given-names>MJ</given-names></name><name><surname>Murugan</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Kalman-like Self-Tuned Sensitivity in Biophysical Sensing</article-title><source>Cell Systems</source><volume>9</volume><fpage>459</fpage><lpage>465</lpage><pub-id pub-id-type="doi">10.1016/j.cels.2019.08.008</pub-id><pub-id pub-id-type="pmid">31563474</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Katz</surname> <given-names>Y</given-names></name><name><surname>Springer</surname> <given-names>M</given-names></name><name><surname>Fontana</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Embodying probabilistic inference in biochemical circuits</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1806.10161">https://arxiv.org/abs/1806.10161</ext-link></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Katz</surname> <given-names>Y</given-names></name><name><surname>Springer</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Probabilistic adaptation in changing microbial environments</article-title><source>PeerJ</source><volume>4</volume><elocation-id>e2716</elocation-id><pub-id pub-id-type="doi">10.7717/peerj.2716</pub-id><pub-id pub-id-type="pmid">27994963</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kobayashi</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Implementation of dynamic Bayesian decision making by intracellular kinetics</article-title><source>Physical Review Letters</source><volume>104</volume><elocation-id>228104</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.104.228104</pub-id><pub-id pub-id-type="pmid">20867209</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kussell</surname> <given-names>E</given-names></name><name><surname>Leibler</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Phenotypic diversity, population growth, and information in fluctuating environments</article-title><source>Science</source><volume>309</volume><fpage>2075</fpage><lpage>2078</lpage><pub-id pub-id-type="doi">10.1126/science.1114383</pub-id><pub-id pub-id-type="pmid">16123265</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lambert</surname> <given-names>G</given-names></name><name><surname>Kussell</surname> <given-names>E</given-names></name><name><surname>Kussel</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Memory and fitness optimization of bacteria under fluctuating environments</article-title><source>PLOS Genetics</source><volume>10</volume><elocation-id>e1004556</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1004556</pub-id><pub-id pub-id-type="pmid">25255314</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Liberzon</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2011">2011</year><source>Calculus of Variations and Optimal Control Theory: A Concise Introduction</source><publisher-name>Princeton University Press</publisher-name></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mitchell</surname> <given-names>A</given-names></name><name><surname>Romano</surname> <given-names>GH</given-names></name><name><surname>Groisman</surname> <given-names>B</given-names></name><name><surname>Yona</surname> <given-names>A</given-names></name><name><surname>Dekel</surname> <given-names>E</given-names></name><name><surname>Kupiec</surname> <given-names>M</given-names></name><name><surname>Dahan</surname> <given-names>O</given-names></name><name><surname>Pilpel</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Adaptive prediction of environmental changes by microorganisms</article-title><source>Nature</source><volume>460</volume><fpage>220</fpage><lpage>224</lpage><pub-id pub-id-type="doi">10.1038/nature08112</pub-id><pub-id pub-id-type="pmid">19536156</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mitchell</surname> <given-names>A</given-names></name><name><surname>Lim</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Cellular perception and misperception: Internal models for decision-making shaped by evolutionary experience</article-title><source>BioEssays</source><volume>38</volume><fpage>845</fpage><lpage>849</lpage><pub-id pub-id-type="doi">10.1002/bies.201600090</pub-id><pub-id pub-id-type="pmid">27461864</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pavlov</surname> <given-names>MY</given-names></name><name><surname>Ehrenberg</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Optimal control of gene expression for fast proteome adaptation to environmental change</article-title><source>PNAS</source><volume>110</volume><fpage>20527</fpage><lpage>20532</lpage><pub-id pub-id-type="doi">10.1073/pnas.1309356110</pub-id><pub-id pub-id-type="pmid">24297927</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Savageau</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title><italic>Escherichia coli</italic> Habitats, Cell Types, and Molecular Mechanisms of Gene Control</article-title><source>The American Naturalist</source><volume>122</volume><fpage>732</fpage><lpage>744</lpage><pub-id pub-id-type="doi">10.1086/284168</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shin</surname> <given-names>D</given-names></name><name><surname>Lee</surname> <given-names>EJ</given-names></name><name><surname>Huang</surname> <given-names>H</given-names></name><name><surname>Groisman</surname> <given-names>EA</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>A positive feedback loop promotes transcription surge that jump-starts Salmonella virulence circuit</article-title><source>Science</source><volume>314</volume><fpage>1607</fpage><lpage>1609</lpage><pub-id pub-id-type="doi">10.1126/science.1134930</pub-id><pub-id pub-id-type="pmid">17158330</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sorek</surname> <given-names>M</given-names></name><name><surname>Balaban</surname> <given-names>NQ</given-names></name><name><surname>Loewenstein</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Stochasticity, bistability and the wisdom of crowds: a model for associative learning in genetic regulatory networks</article-title><source>PLOS Computational Biology</source><volume>9</volume><elocation-id>e1003179</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003179</pub-id><pub-id pub-id-type="pmid">23990765</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tagkopoulos</surname> <given-names>I</given-names></name><name><surname>Liu</surname> <given-names>YC</given-names></name><name><surname>Tavazoie</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Predictive behavior within microbial genetic networks</article-title><source>Science</source><volume>320</volume><fpage>1313</fpage><lpage>1317</lpage><pub-id pub-id-type="doi">10.1126/science.1154456</pub-id><pub-id pub-id-type="pmid">18467556</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Veening</surname> <given-names>JW</given-names></name><name><surname>Smits</surname> <given-names>WK</given-names></name><name><surname>Kuipers</surname> <given-names>OP</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Bistability, epigenetics, and bet-hedging in bacteria</article-title><source>Annual Review of Microbiology</source><volume>62</volume><fpage>193</fpage><lpage>210</lpage><pub-id pub-id-type="doi">10.1146/annurev.micro.62.081307.163002</pub-id><pub-id pub-id-type="pmid">18537474</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Watson</surname> <given-names>RA</given-names></name><name><surname>Szathmáry</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>How Can Evolution Learn?</article-title><source>Trends in Ecology &amp; Evolution</source><volume>31</volume><fpage>147</fpage><lpage>157</lpage><pub-id pub-id-type="doi">10.1016/j.tree.2015.11.009</pub-id><pub-id pub-id-type="pmid">26705684</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Williams</surname> <given-names>CL</given-names></name><name><surname>Cotter</surname> <given-names>PA</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Autoregulation is essential for precise temporal and steady-state regulation by the Bordetella BvgAS phosphorelay</article-title><source>Journal of Bacteriology</source><volume>189</volume><fpage>1974</fpage><lpage>1982</lpage><pub-id pub-id-type="doi">10.1128/JB.01684-06</pub-id><pub-id pub-id-type="pmid">17158656</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><p>This text contains supplementary information on modeling details, the analytical calculations, and the exact parameters used in figures.</p><sec id="s8" sec-type="appendix"><title>S1 Simple end-product inhibition</title><p>As the starting point of our regulatory architecture, we consider a basic form of end-product inhibition (SEPI). The environment is modeled by a time-dependent (externally induced) demand <inline-formula><mml:math id="inf220"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for metabolite <inline-formula><mml:math id="inf221"><mml:mi>x</mml:mi></mml:math></inline-formula> which is produced at a rate <inline-formula><mml:math id="inf222"><mml:mi>P</mml:mi></mml:math></inline-formula> (controlled by the system); both <inline-formula><mml:math id="inf223"><mml:mi>D</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf224"><mml:mi>P</mml:mi></mml:math></inline-formula> are defined in units of metabolite concentration per unit time. The depletion of the metabolite depends on its concentration <inline-formula><mml:math id="inf225"><mml:mi>x</mml:mi></mml:math></inline-formula> and the demand <inline-formula><mml:math id="inf226"><mml:mi>D</mml:mi></mml:math></inline-formula>. Assuming first-order kinetics (or, alternatively, expanding a general function to linear order in small fluctuations of <inline-formula><mml:math id="inf227"><mml:mi>x</mml:mi></mml:math></inline-formula>) the dynamics of <inline-formula><mml:math id="inf228"><mml:mi>x</mml:mi></mml:math></inline-formula> is:<disp-formula id="equ8"><label>(S1)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mfrac><mml:mi>x</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Further, we consider the temporal evolution of the regulator activity <inline-formula><mml:math id="inf229"><mml:mi>a</mml:mi></mml:math></inline-formula><disp-formula id="equ9"><label>(S2)</label><mml:math id="m9"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>By linearizing <inline-formula><mml:math id="inf230"><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> around the stationary values <inline-formula><mml:math id="inf231"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> we get<disp-formula id="equ10"><label>(S3)</label><mml:math id="m10"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>To examine this equation, we introduce the Fourier transforms <inline-formula><mml:math id="inf232"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf233"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and get <disp-formula id="equ11"><label>(S4)</label><mml:math id="m11"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo mathvariant="italic" separator="true"> </mml:mo><mml:mo>⇒</mml:mo></mml:mrow></mml:mrow><mml:mo mathvariant="italic" separator="true"> </mml:mo><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ω</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ11">Equation (S4)</xref> shows that if the support of <inline-formula><mml:math id="inf234"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is restricted to high frequencies, <inline-formula><mml:math id="inf235"><mml:mrow><mml:mi>ω</mml:mi><mml:mo>≫</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, then the degradation term <inline-formula><mml:math id="inf236"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ10">Equation (S3)</xref> is negligible. Including it would only add a restoring force, reducing the amplitude of fluctuations of <inline-formula><mml:math id="inf237"><mml:mi>a</mml:mi></mml:math></inline-formula>, and decreasing the performance of the system. Since we are interested in the regime of fast fluctuations of <inline-formula><mml:math id="inf238"><mml:mi>x</mml:mi></mml:math></inline-formula>, we choose to omit this term in the SEPI system. With <inline-formula><mml:math id="inf239"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> we arrive at the dynamics used in the main text:<disp-formula id="equ12"><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="right left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mfrac><mml:mi>x</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mspace width="2em"/><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext>-</mml:mtext><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mi>x</mml:mi></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>P</mml:mi></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mspace width="2em"/><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mi>a</mml:mi></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mi>λ</mml:mi></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mspace width="2em"/><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mi>x</mml:mi></mml:mstyle></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>In the nonlinear system (<xref ref-type="disp-formula" rid="equ3">Equation (3)</xref> of the main text), however, fast fluctuations of <inline-formula><mml:math id="inf240"><mml:mi>x</mml:mi></mml:math></inline-formula> can cause the growth of <inline-formula><mml:math id="inf241"><mml:mi>a</mml:mi></mml:math></inline-formula> (as discussed in the section ‘The nonlinearity as a sensor of the fluctuation variance’), thereby inducing slow frequency modes to its dynamics. Thus, in the nonlinear case, we cannot omit the degradation term.</p></sec><sec id="s9" sec-type="appendix"><title>S2 Performance penalty from the degradation term</title><p>The model considered in the main text modifies the SEPI architecture as follows:<disp-formula id="equ13"><label>(S5)</label><mml:math id="m13"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ14"><label>(S6)</label><mml:math id="m14"><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ15"><label>(S7)</label><mml:math id="m15"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>μ</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo rspace="5.3pt">,</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder></mml:mstyle><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>κ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Consider the case of a static input. We observe that if <italic>x</italic><sub>0</sub> is set to 1, as in the main text, the presence of the degradation term causes the equilibrium point of these dynamics to be displaced away from <inline-formula><mml:math id="inf242"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Therefore, for a static input, the performance of this system—the degree of mismatch between <inline-formula><mml:math id="inf243"><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf244"><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, or, equivalently, the deviation of <italic>x</italic><sub><italic>i</italic></sub> from 1—is actually worse than the performance of the original SEPI.</p><p>While the case of a static input is irrelevant for the discussion in the main text, this slight offset leads to a performance penalty also for a fluctuating input. Indeed, time-averaging <xref ref-type="disp-formula" rid="equ15">Equation (S7)</xref> shows that for any active regulator, we must have<disp-formula id="equ16"><label>(S8)</label><mml:math id="m16"><mml:mrow><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>κ</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf245"><mml:mi>f</mml:mi></mml:math></inline-formula> is the nonlinearity in our equation, <inline-formula><mml:math id="inf246"><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>γ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>γ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Clearly, we will in general again have <inline-formula><mml:math id="inf247"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>≠</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>; this is particularly obvious in the limit of small fluctuations when the nonlinearity is ‘not active’, such that <inline-formula><mml:math id="inf248"><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>γ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:math></inline-formula>.</p><p>This effect could be corrected by shifting <italic>x</italic><sub>0</sub>. In the interest of keeping our model as close to SEPI as possible, we chose not to do so: this penalty is only significant in the regime where no learning occurs, and is otherwise outweighed by the performance increase due to self-tuned responsiveness, with the additional benefit of simplifying the discussion in the main text. Even if optimizing <italic>x</italic><sub>0</sub> could make the performance slightly closer to the optimal bound, this kind of fine-tuning seems irrelevant in a biological context.</p></sec><sec id="s10" sec-type="appendix"><title>S3 Defining the system’s responsiveness</title><p>In the main text, we use a measure for the ‘responsiveness’ of our system to changes in the demand <inline-formula><mml:math id="inf249"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. In this section it is shown in detail how this measure is defined. The central aim of the considered regulatory model is to match the time-dependent demand <inline-formula><mml:math id="inf250"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> with the regulated production <inline-formula><mml:math id="inf251"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>. The temporal evolution of <inline-formula><mml:math id="inf252"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> is given by:<disp-formula id="equ17"><label>(S9)</label><mml:math id="m17"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>μ</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>μ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>with<disp-formula id="equ18"><label>(S10)</label><mml:math id="m18"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>μ</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo rspace="5.3pt">,</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>κ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>For a static demand <inline-formula><mml:math id="inf253"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> the production relaxes to a constant value <inline-formula><mml:math id="inf254"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (where we assumed small κ) and consequently <inline-formula><mml:math id="inf255"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. A deviation <inline-formula><mml:math id="inf256"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> from the static demand will lead to a change of the production <inline-formula><mml:math id="inf257"><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> - the larger <inline-formula><mml:math id="inf258"><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, the faster the response to the changed demand. Therefore, we define the responsiveness of the production <inline-formula><mml:math id="inf259"><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> to the demand <inline-formula><mml:math id="inf260"><mml:msub><mml:mi>D</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> as <inline-formula><mml:math id="inf261"><mml:mrow><mml:msub><mml:mi class="ltx_font_mathcaligraphic">ℛ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. When assuming small fluctuations the explicit expression for the responsiveness is then given by: <disp-formula id="equ19"><label>(S11)</label><mml:math id="m19"><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>μ</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>μ</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>μ</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mi>D</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>μ</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>As an example we consider the one-dimensional system studied in <xref ref-type="fig" rid="fig3">Figure 3A-F</xref> in the main text for which the responsiveness is<disp-formula id="equ20"><label>(S12)</label><mml:math id="m20"><mml:mrow><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">ℛ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where we used that <inline-formula><mml:math id="inf262"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf263"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s11" sec-type="appendix"><title>S4 Control theory calculation</title><p>The calculation below follows the standard procedure known as Linear-Quadratic Optimal Control (LQC). For more details, we refer the reader to standard sources (e.g. <xref ref-type="bibr" rid="bib16">Liberzon, 2011</xref>).</p><p>The problem we set is minimizing <inline-formula><mml:math id="inf264"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf265"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> follows the dynamics of <xref ref-type="disp-formula" rid="equ1">Equation (1)</xref> in the main text,<disp-formula id="equ21"><label>(S13)</label><mml:math id="m21"><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msqrt></mml:mpadded><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We then wish to calculate the optimal way of steering <inline-formula><mml:math id="inf266"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>. For simplicity, we will set the mean <inline-formula><mml:math id="inf267"><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (in the context of this abstract problem, this is equivalent to working with mean-shifted variables <inline-formula><mml:math id="inf268"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>≡</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula> and similarly <inline-formula><mml:math id="inf269"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>≡</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>). We can start by discretizing the above equation,<disp-formula id="equ22"><label>(S14)</label><mml:math id="m22"><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p> where <inline-formula><mml:math id="inf270"><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>≡</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, and ξ has variance <inline-formula><mml:math id="inf271"><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>. We seek to determine the optimal way to steer <inline-formula><mml:math id="inf272"><mml:mi>P</mml:mi></mml:math></inline-formula>; in other words, the function <inline-formula><mml:math id="inf273"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (‘control policy’) dictating how <inline-formula><mml:math id="inf274"><mml:mi>P</mml:mi></mml:math></inline-formula> should be changed in a given time step:<disp-formula id="equ23"><label>(S15)</label><mml:math id="m23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ24"><label>(S16)</label><mml:math id="m24"><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We then can define our cost function, which combines a cost for the magnitude of <italic>u</italic><sub><italic>t</italic></sub> (how quickly we can change <inline-formula><mml:math id="inf275"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>), and the difference between <inline-formula><mml:math id="inf276"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf277"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>:<disp-formula id="equ25"><label>(S17)</label><mml:math id="m25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ρ</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The <inline-formula><mml:math id="inf278"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> describing the optimal behavior is the one that minimizes this cost. In order to solve for <inline-formula><mml:math id="inf279"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, we follow standard control theory techniques and define the ‘cost-to-go’ function,<disp-formula id="equ26"><label>(S18)</label><mml:math id="m26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo form="prefix" movablelimits="true">min</mml:mo><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ρ</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mtable columnalign="right left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>M</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>This function defines the smallest cost of all remaining steps; in particular, the total cost that we are trying to minimize is <inline-formula><mml:math id="inf280"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The cost-to-go satisfies the boundary condition<disp-formula id="equ27"><label>(S19)</label><mml:math id="m27"><mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>∥</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></disp-formula>and the following recursive relation:<disp-formula id="equ28"><label>(S20)</label><mml:math id="m28"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mi>min</mml:mi><mml:mi>v</mml:mi></mml:munder><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="160%" minsize="160%">{</mml:mo><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>∥</mml:mo><mml:mi>v</mml:mi><mml:mo>∥</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>𝔼</mml:mi><mml:mi>ξ</mml:mi></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mi>ξ</mml:mi></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo maxsize="160%" minsize="160%">}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Since our system is Gaussian, this recursive relation can be solved by adopting a quadratic ansatz:<disp-formula id="equ29"><label>(S21)</label><mml:math id="m29"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Solving for the matrices <inline-formula><mml:math id="inf281"><mml:msub><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf282"><mml:msub><mml:mi>B</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf283"><mml:msub><mml:mi>C</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf284"><mml:msub><mml:mi>Q</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, gives us the following recursive relations:<disp-formula id="equ30"><label>(S22)</label><mml:math id="m30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="right left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi mathvariant="normal">Γ</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>M</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>M</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">⊤</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>M</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Since our problem is to minimize the cost at steady state (known in control theory as an ‘infinite horizon’ problem, <inline-formula><mml:math id="inf285"><mml:mrow><mml:mi>N</mml:mi><mml:mo>↦</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula>), we are interested in the fixed point of this mapping, specifically the matrices <inline-formula><mml:math id="inf286"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msub><mml:mo rspace="4.2pt">,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to which this mapping converges when we start from <inline-formula><mml:math id="inf287"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf288"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (as defined by <xref ref-type="disp-formula" rid="equ27">Equation (S19)</xref>).</p><p>Since <inline-formula><mml:math id="inf289"><mml:msub><mml:mi>A</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math></inline-formula> is the identity matrix, all <inline-formula><mml:math id="inf290"><mml:msub><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> are proportional to the identity matrix as well: <inline-formula><mml:math id="inf291"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf292"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></inline-formula>. The fixed point of this mapping is <inline-formula><mml:math id="inf293"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:mrow></mml:msqrt></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Similarly, the fixed point of <inline-formula><mml:math id="inf294"><mml:msub><mml:mi>B</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is <inline-formula><mml:math id="inf295"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>M</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. Expressing this in terms of α only:<disp-formula id="equ31"><mml:math id="m31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mover><mml:mi>M</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>With these expressions, the optimal ‘control policy’ is defined by the value of <inline-formula><mml:math id="inf296"><mml:mi>v</mml:mi></mml:math></inline-formula> that minimizes <xref ref-type="disp-formula" rid="equ28">Equation S20</xref>. This defines the optimal way to change <inline-formula><mml:math id="inf297"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> for a given observed <inline-formula><mml:math id="inf298"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>:<disp-formula id="equ32"><label>(S23)</label><mml:math id="m32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>α</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mover><mml:mi>M</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>M</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mover><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>or, restoring the notations of the main text, including a non-zero <inline-formula><mml:math id="inf299"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>:<disp-formula id="equ33"><label>(S24)</label><mml:math id="m33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>α</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>M</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow><mml:mo>−</mml:mo><mml:mi>M</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mover><mml:mi>D</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>This <inline-formula><mml:math id="inf300"><mml:mi>u</mml:mi></mml:math></inline-formula> is the <italic>exact</italic> solution to the discrete version of the problem we considered. Since our simulations in this work use a discrete timestep, this is the form we use. Nevertheless, it is instructive to consider the small-<inline-formula><mml:math id="inf301"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>, large-CIP limit such that <inline-formula><mml:math id="inf302"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf303"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> are both small compared to inverse eigenvalues of <inline-formula><mml:math id="inf304"><mml:mi>M</mml:mi></mml:math></inline-formula>. In this case we have, to first order in <inline-formula><mml:math id="inf305"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ34"><mml:math id="m34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>α</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mi>M</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mover><mml:mi>D</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>This leads to the following, and very intuitive, form of the optimal control dynamics:<disp-formula id="equ35"><label>(S25)</label><mml:math id="m35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">↦</mml:mo><mml:mrow><mml:mover><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:mi>M</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mover><mml:mi>D</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">↦</mml:mo><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:mi>M</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mover><mml:mi>D</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>α</mml:mi></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mover><mml:mi>D</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>In other words, at every step the change in <inline-formula><mml:math id="inf306"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> mirrors the average expected change in <inline-formula><mml:math id="inf307"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>, with an extra term seeking to reduce their deviation. Note also that setting <inline-formula><mml:math id="inf308"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (infinite CIP) corresponds to steering <inline-formula><mml:math id="inf309"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> directly to the expected value of <inline-formula><mml:math id="inf310"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> at the next timestep, as expected.</p></sec><sec id="s12" sec-type="appendix"><title>S5 The system makes use of correlations in the input</title><p><xref ref-type="fig" rid="fig4">Figure 4B</xref> in the main text demonstrated that, as the fluctuating inputs become increasingly correlated, our architecture is able to outperform SEPI by an increasingly wide margin. The natural interpretation of this result is that the system is able to learn and exploit this correlation. Technically, however, one might note that this observation alone does not yet prove that our architecture is able to appropriately use the information it learned about specifically <italic>correlation</italic>. For example, it could be that strongly correlated inputs are somehow inducing a stronger increase in reactivity, causing the system to be generally faster, but without benefiting specifically from the correlated nature of its inputs.</p><p>Rather than focusing on excluding this specific scenario (which could be done by comparing the CIP values along the curves shown in <xref ref-type="fig" rid="fig4">Figure 4B</xref>), we will show that with a sufficient number of regulators, our architecture can perform better than the theoretical ceiling achievable by <italic>any</italic> strategy that assumes the inputs to be independent. This will formally prove that, at least for some parameters, our system’s improved performance must necessarily make use of the correlation of its inputs. Although the argument is somewhat academic in nature (we will prove our point using <inline-formula><mml:math id="inf311"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math></inline-formula> regulators), it is theoretically pleasing, and so we present it here.</p><p>Specifically, we consider a system subjected to inputs structured as shown in <xref ref-type="fig" rid="fig3">Figure 3H</xref>, with angle <inline-formula><mml:math id="inf312"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> so that the two inputs have the same variance. <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref> shows the performance of our architecture for several values of the number of regulators <inline-formula><mml:math id="inf313"><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula>, plotted as curves parameterized by the degradation rate κ. The degradation rate controls how large the <inline-formula><mml:math id="inf314"><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> can become: a high value of κ leads to lower average steady-state values of the regulator activities, causing the system to be less responsive to changes in <inline-formula><mml:math id="inf315"><mml:mi>D</mml:mi></mml:math></inline-formula>. Thus, κ can be used to set the CIP of the regulatory system, allowing us to plot these performance curves in the ‘performance vs. CIP’ axes traditional for control theory.</p><fig id="app1fig1" position="float"><label>Appendix 1—figure 1.</label><caption><title>The adapting system can perform better than the best independence-assuming strategy.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-67455-app1-fig1-v1.tif"/></fig><p>Reassuringly, all these performance curves are located below the optimal control-theory ceiling computed for the true correlation structure of the input. However, the plot also shows the ‘best independent’ curve, defined as follows. Consider all possible matrices <inline-formula><mml:math id="inf316"><mml:mi>M</mml:mi></mml:math></inline-formula> corresponding to uncorrelated inputs: <inline-formula><mml:math id="inf317"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. Each such <inline-formula><mml:math id="inf318"><mml:mi>M</mml:mi></mml:math></inline-formula> defines a family of control strategies (that would have been optimal if this <inline-formula><mml:math id="inf319"><mml:mi>M</mml:mi></mml:math></inline-formula> were the true <inline-formula><mml:math id="inf320"><mml:mi>M</mml:mi></mml:math></inline-formula> governing the dynamics of the input); this family is indexed by a parameter ρ as described above. A system following an (independence-assuming) strategy <inline-formula><mml:math id="inf321"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> while faced with the actual (partially correlated) inputs will exhibit a certain performance <inline-formula><mml:math id="inf322"><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">𝒫</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and a certain CIP, which we denote <inline-formula><mml:math id="inf323"><mml:mrow><mml:mi>CIP</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. With these notations, the ‘best independent’ curve is defined as<disp-formula id="equ36"><mml:math id="m36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">℘</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mi>χ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="script">℘</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi>ρ</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>χ</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We note that the correlated-input CIP is different from the independent-input CIP that a given strategy would have incurred if faced by the input for which it is optimal. In particular, while the latter can be computed analytically, the former has to be evaluated in simulations. This makes the optimization procedure computationally costly; thankfully, the symmetry ensured by choosing <inline-formula><mml:math id="inf324"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> allows restricting the search to isotropic strategies <inline-formula><mml:math id="inf325"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>λ</mml:mi></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mi>λ</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, reducing the problem dimensionality from three parameters <inline-formula><mml:math id="inf326"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> to more manageable two <inline-formula><mml:math id="inf327"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>λ</mml:mi><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>.</p><p>The result is shown in <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref> as a dashed line. As highlighted in the inset, with enough regulators, our architecture is indeed able to outperform the theoretical ceiling of the best independence-assuming strategy. Although <inline-formula><mml:math id="inf328"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math></inline-formula> regulators is of course a regime irrelevant for biological applications, the aim of this argument was to formally prove a theoretical point, namely that the system as constructed must necessarily be making use of the correlation in the input signal, at least for some values of the parameters; by construction, the ‘best independent’ curve is a high bar to clear.</p></sec><sec id="s13" sec-type="appendix"><title>S6 Model predictive control</title><p>When framing the problem in the main text, we discussed it as consisting of two tasks, learning the fluctuation structure of the environment and ‘applying that knowledge’ (<xref ref-type="fig" rid="fig1">Figure 1B</xref>), and treated the two as conceptually separate. In particular, the calculation in section ‘S4 Control theory calculation’ is known as linear-quadratic Gaussian control (LQG) that assumes the correct model of the environment to already be known. This separation was done to simplify presentation, allowing us to encapsulate the control theory discussion, potentially less familiar to our audience, to a smaller portion of the narrative. In addition, the LQG calculation is simple, exact, and provides an upper bound on how well any other control strategy could perform.</p><p>Mechanistically, however, the two tasks are inseparable. In the language of control theory, our architecture implements an example of model predictive control: a strategy where the system response is governed by a continually updated internal model of the environment (here, the activity levels of the regulators, which encode the learned correlations between the inputs).</p><p>How could one distinguish a predictive vs. non-predictive control scheme in practice, when measuring all internal variables to decipher whether or not they encode an ‘internal model of the environment’ is infeasible? For our scheme, its ‘predictive’ ability manifests itself as follows. Imagine exposing our system to two inputs <inline-formula><mml:math id="inf329"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> which for a period of time are strongly correlated, with <inline-formula><mml:math id="inf330"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. The learning process will drive the responsiveness matrix from one that was initially isotropic to one aligned with the correlated direction (in the notation of the main text, <inline-formula><mml:math id="inf331"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>). Compare now the response of the system to an increase in <italic>D</italic><sub>1</sub>: <inline-formula><mml:math id="inf332"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The naÃ¯ve (untrained) system would respond by increasing <italic>P</italic><sub>1</sub> only, as would the SEPI architecture. In contrast, the ‘trained’ system, having learned the correlation between <italic>D</italic><sub>1</sub> and <italic>D</italic><sub>2</sub>, responds by upregulating both <italic>P</italic><sub>1</sub> and <italic>P</italic><sub>2</sub> together. In this hypothetical example, our analysis predicts that deleting seemingly superfluous regulators would hinder or remove this ability (depending on the implementation, possibly without even affecting fitness in a static environment).</p><p>This is the behavior expected of a predictive controller: Under a model where <inline-formula><mml:math id="inf333"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf334"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are strongly correlated, one expects this state of the environment to relax back to the diagonal <inline-formula><mml:math id="inf335"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> in the near future. This kind of associative learning is experimentally measurable and, on an evolutionary scale, is well-known. Our scheme provides a mechanism for implementing this behavior on a physiological timescale. Another mechanism focusing on binary associations was previously described by <xref ref-type="bibr" rid="bib22">Sorek et al., 2013</xref>.</p></sec><sec id="s14" sec-type="appendix"><title>S7 Nonlinearity acts as a sensor of fluctuation variance</title><p>In the main text, we argue that the nonlinearity in the dynamics of the regulator concentrations acts as a senor for the variance of the fluctuations. To see this, we consider the dynamics of one regulator that is controlling the production of one metabolite:<disp-formula id="equ37"><label>(S26)</label><mml:math id="m37"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mn> 1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>/</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>κ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>To simplify notation, we define <inline-formula><mml:math id="inf336"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>:=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>/</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Since the dynamics of <inline-formula><mml:math id="inf337"><mml:mi>a</mml:mi></mml:math></inline-formula> are slow compared to <inline-formula><mml:math id="inf338"><mml:mi>D</mml:mi></mml:math></inline-formula>, the fluctuations of γ are on a faster timescale than the regulator dynamics. If the fluctuations of γ are small, the nonlinearity in the <inline-formula><mml:math id="inf339"><mml:mi>max</mml:mi></mml:math></inline-formula> function is ‘not activated’: <inline-formula><mml:math id="inf340"><mml:mrow><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo rspace="5.3pt">,</mml:mo><mml:mi>γ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:math></inline-formula>. In this case, the temporal average of <inline-formula><mml:math id="inf341"><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo rspace="5.3pt">,</mml:mo><mml:mi>γ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is zero. In contrast, if the fluctuations are strong enough, the nonlinearity is activated (see <xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref>). Then, the temporal average is positive, leading to an additional growth of <inline-formula><mml:math id="inf342"><mml:mi>a</mml:mi></mml:math></inline-formula>. Due to the resulting larger values of <inline-formula><mml:math id="inf343"><mml:mi>a</mml:mi></mml:math></inline-formula>, the response of the system becomes faster, making the match between <inline-formula><mml:math id="inf344"><mml:mi>P</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf345"><mml:mi>D</mml:mi></mml:math></inline-formula> better and thus serving to decrease the variance of γ. As a result, the final average steady-state regulator concentration is reached if the system has decreased the variance of γ sufficiently by increasing the rapidity of its response.</p><fig id="app1fig2" position="float"><label>Appendix 1—figure 2.</label><caption><title>The nonlinearity in the regulatory architecture.</title><p>If the fluctuations of the input <inline-formula><mml:math id="inf346"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> are large enough, the average over the nonlinearity is positive, causing additional growth of the regulator concentration <inline-formula><mml:math id="inf347"><mml:mi>a</mml:mi></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-67455-app1-fig2-v1.tif"/></fig><p>This argument makes it clear why the specific choice of nonlinearity is not particularly important. If <inline-formula><mml:math id="inf348"><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, then the static steady state satisfies <inline-formula><mml:math id="inf349"><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. For a fast-fluctuating input this becomes<disp-formula id="equ38"><mml:math id="m38"><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">…</mml:mi></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>For any nonlinear <inline-formula><mml:math id="inf350"><mml:mi>f</mml:mi></mml:math></inline-formula>, as long as <inline-formula><mml:math id="inf351"><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, the displacement of the original steady state will be determined by higher order statistics of the input. In particular, the rectified-linear nonlinearity in our equations can be replaced, for example, by a Hill function. Note that for the argument presented here, the eventual saturation of the response at large argument is irrelevant: the system will retain all the relevant behavior as long as the new nonlinearity is cup-convex in a sufficiently large vicinity of its static fixed point; see section ‘S9.1 A pair of allosteric enzymes’ for an explicit example.</p><p>The assumption <inline-formula><mml:math id="inf352"><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> is not innocuous; in general, of course, the value of <inline-formula><mml:math id="inf353"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula> is sensitive not only to the variance of <inline-formula><mml:math id="inf354"><mml:mi>x</mml:mi></mml:math></inline-formula> (or other higher-order terms), but also to its mean, and building a system that is sensitive to specifically the variance requires adapting to the mean first. In our model, this is automatically accomplished by the underlying end-product inhibition architecture, which adapts the mean <inline-formula><mml:math id="inf355"><mml:mi>P</mml:mi></mml:math></inline-formula> to mean <inline-formula><mml:math id="inf356"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, after which <inline-formula><mml:math id="inf357"><mml:mi>x</mml:mi></mml:math></inline-formula> fluctuates around 1, no matter the value of <inline-formula><mml:math id="inf358"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>.</p></sec><sec id="s15" sec-type="appendix"><title>S8 The minimal Γ needed to initiate adaptation</title><p><xref ref-type="fig" rid="fig4">Figure 4A</xref> in the main text includes arrows indicating theoretically derived threshold values of Γ above which our system (with a given <inline-formula><mml:math id="inf359"><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) will begin to adapt its timescale of response, deviating from SEPI in its behavior. Here, we show how this threshold value of Γ can be determined.</p><p>As discussed in the main text, at static input (<inline-formula><mml:math id="inf360"><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) only <inline-formula><mml:math id="inf361"><mml:msub><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula> out of <inline-formula><mml:math id="inf362"><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> regulators can be active. Consider the regulators that remain inactive in the static case, and imagine gradually increasing the fluctuation magnitude. Recall the equation for regulator activity dynamics:<disp-formula id="equ39"><label>(S27)</label><mml:math id="m39"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>μ</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo rspace="5.3pt">,</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>κ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>After introducing <inline-formula><mml:math id="inf363"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> we can write<disp-formula id="equ40"><label>(S28)</label><mml:math id="m40"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>μ</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo rspace="5.3pt">,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>κ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>If we chose <inline-formula><mml:math id="inf364"><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> as one of the regulators that remained inactive in the static case, we have <inline-formula><mml:math id="inf365"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> at <inline-formula><mml:math id="inf366"><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>; as we begin increasing the fluctuation magnitude, the time-averaged <inline-formula><mml:math id="inf367"><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> will at first remain negative. The threshold Γ we seek is the one where the first (time-averaged) <inline-formula><mml:math id="inf368"><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> crosses into positive values. It is clear that if the fluctuations of <inline-formula><mml:math id="inf369"><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> are so small that <inline-formula><mml:math id="inf370"><mml:mrow><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> at all times, the system does not adapt. On the other hand, if the fluctuations are large enough and fast compared to the response of the system, they generate an effective additional growth of <inline-formula><mml:math id="inf371"><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula>. To first order, this additional growth term is proportional to the standard deviation <inline-formula><mml:math id="inf372"><mml:msqrt><mml:msub><mml:mi>ω</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:msqrt></mml:math></inline-formula> of <inline-formula><mml:math id="inf373"><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula>. Therefore, we expect the fluctuations to cause a growth of <inline-formula><mml:math id="inf374"><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> if the additional growth term is large compared to κ, i.e. <inline-formula><mml:math id="inf375"><mml:mrow><mml:msqrt><mml:mi>ω</mml:mi></mml:msqrt><mml:mo>⪆</mml:mo><mml:mrow><mml:mtext>c</mml:mtext><mml:mo>⋅</mml:mo><mml:mi>κ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="inf376"><mml:mi>c</mml:mi></mml:math></inline-formula> a constant of order 1.</p><p>The approximate value of <inline-formula><mml:math id="inf377"><mml:mi>c</mml:mi></mml:math></inline-formula> can be determined using the following argument. With <inline-formula><mml:math id="inf378"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, and assuming that <inline-formula><mml:math id="inf379"><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> is, first, fluctuating on a fast timescale compared to <inline-formula><mml:math id="inf380"><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> and, second, is Gaussian with mean <inline-formula><mml:math id="inf381"><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> and variance <inline-formula><mml:math id="inf382"><mml:msub><mml:mi>ω</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula>, we can average over the fluctuations in <xref ref-type="disp-formula" rid="equ40">Equation (S28)</xref>:<disp-formula id="equ41"><label>(S29)</label><mml:math id="m41"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mfrac><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>μ</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:msqrt><mml:mfrac><mml:msub><mml:mi>ω</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:mfrac></mml:msqrt><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:msubsup><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>μ</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mi>erf</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>μ</mml:mi></mml:msub><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mi>κ</mml:mi></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The system is in a stable steady state if either <inline-formula><mml:math id="inf383"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf384"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf385"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf386"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. In the non-trivial first case we get the condition <inline-formula><mml:math id="inf387"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>μ</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mi>κ</mml:mi></mml:mrow></mml:math></inline-formula>. Approximating <inline-formula><mml:math id="inf388"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>μ</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> one sees that the average growth rate <inline-formula><mml:math id="inf389"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula> is positive if <inline-formula><mml:math id="inf390"><mml:mrow><mml:msqrt><mml:msub><mml:mi>ω</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:msqrt><mml:mo>&gt;</mml:mo><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:msqrt><mml:mo>⁢</mml:mo><mml:mi>κ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, so that <inline-formula><mml:math id="inf391"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>. If this condition is satisfied, <inline-formula><mml:math id="inf392"><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> continues its growth until the separation of timescales between <inline-formula><mml:math id="inf393"><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf394"><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> becomes invalid and <inline-formula><mml:math id="inf395"><mml:msub><mml:mi>ω</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> decreases; this is the mechanism by which the system adapts to fast fluctuations.</p><p>The variance <inline-formula><mml:math id="inf396"><mml:msub><mml:mi>ω</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> can be derived from the statistical properties of <inline-formula><mml:math id="inf397"><mml:mi>D</mml:mi></mml:math></inline-formula>. If the fluctuations of the demand <inline-formula><mml:math id="inf398"><mml:mi>D</mml:mi></mml:math></inline-formula> are small it holds that <inline-formula><mml:math id="inf399"><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf400"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is the covariance matrix of the stationary probability distribution of the fluctuations <inline-formula><mml:math id="inf401"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="inf402"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>cos</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁡</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>sin</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁡</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf403"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. The variance <inline-formula><mml:math id="inf404"><mml:msub><mml:mi>ω</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> is then given by <inline-formula><mml:math id="inf405"><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>μ</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>μ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and the minimal value of Γ is set by the largest <inline-formula><mml:math id="inf406"><mml:msub><mml:mi>ω</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> of the considered system.</p></sec><sec id="s16" sec-type="appendix"><title>S9 Realistic biochemical implementations</title><p>In the main text, we proposed a simple model of metabolic regulation which highlighted the necessary properties for learning environment statistics, namely an excess of regulators <inline-formula><mml:math id="inf407"><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula>, self-activation, and a nonlinear regulation of <inline-formula><mml:math id="inf408"><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> by the metabolite concentrations <italic>x</italic><sub><italic>i</italic></sub>. To show how these properties can enable more realistic systems to learn the statistics of a fluctuating environment, here we present two biochemical implementations. The first of these implements dynamics nearly identical to those described in the main text, and the second, illustrated in <xref ref-type="fig" rid="fig5">Figure 5b</xref>, bears resemblance to two-component systems. As described in the main text, we do not necessarily expect either of these networks to be implemented in real biological systems ‘as is’. Instead, we use these to illustrate the diversity of systems that could use the logic described in this paper to learn statistics of their environment. For simplicity, we consider the one-dimensional case (first column of <xref ref-type="fig" rid="fig3">Figure 3</xref> in the main text).</p><sec id="s16-1"><title>S9.1 A pair of allosteric enzymes</title><p>The circuit is shown in <xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3</xref>. The enzymes <inline-formula><mml:math id="inf409"><mml:msub><mml:mi>E</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf410"><mml:msub><mml:mi>E</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula> can be in an active or inactive state: The active form of <inline-formula><mml:math id="inf411"><mml:msub><mml:mi>E</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula>, which we denote <inline-formula><mml:math id="inf412"><mml:msubsup><mml:mi>E</mml:mi><mml:mo>+</mml:mo><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula>, catalyzes the production of <inline-formula><mml:math id="inf413"><mml:mi>x</mml:mi></mml:math></inline-formula>; similarly, <inline-formula><mml:math id="inf414"><mml:msubsup><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> catalyzes degradation of <inline-formula><mml:math id="inf415"><mml:mi>x</mml:mi></mml:math></inline-formula>. In addition, we postulate that active enzymes can bind to molecules of the metabolite <inline-formula><mml:math id="inf416"><mml:mi>x</mml:mi></mml:math></inline-formula>, which controls self-catalytic activity (see diagram). The total concentration of <inline-formula><mml:math id="inf417"><mml:msubsup><mml:mi>E</mml:mi><mml:mo>+</mml:mo><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula>, bound and unbound, plays the role of the activating regulator <inline-formula><mml:math id="inf418"><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> from the main text (<inline-formula><mml:math id="inf419"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mo>+</mml:mo><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mo>+</mml:mo><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>), while <inline-formula><mml:math id="inf420"><mml:msubsup><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> plays the role of the inhibitor <inline-formula><mml:math id="inf421"><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula> (<inline-formula><mml:math id="inf422"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>).</p><fig id="app1fig3" position="float"><label>Appendix 1—figure 3.</label><caption><title>Implementation of the regulatory mechanism based on a pair of self-activating enzymes which can be in an active (<inline-formula><mml:math id="inf423"><mml:msup><mml:mi>E</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>) or inactive state (<inline-formula><mml:math id="inf424"><mml:mi>E</mml:mi></mml:math></inline-formula>).</title><p>Gray shading indicates catalysts of reactions.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-67455-app1-fig3-v1.tif"/></fig><p>The same regulatory structure could be realized with transcription factor regulation, with the role of the active enzymes (<inline-formula><mml:math id="inf425"><mml:msub><mml:mi>E</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf426"><mml:msub><mml:mi>E</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula>) played by two transcription factors. In this version, activation/deactivation of enzymes is replaced by the simpler process of transcription factor synthesis/degradation. For concreteness, here, we focus on the enzymatic case, largely because we expect architectures like ours to be more relevant in fast-responding circuits, which tend to be non-transcriptional. However, except for the difference of timescales, the dynamics of the two versions would otherwise be identical; in particular, both implementations would ‘learn’ in the same way.</p><p>For this discussion, it is convenient to have timescales of dynamics of <inline-formula><mml:math id="inf427"><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> and <italic>x</italic><sub><italic>i</italic></sub> encoded as explicit parameters. Assuming first-order kinetics, the dynamics of the network can then be described by:<disp-formula id="equ42"><label>(S30)</label><mml:math id="m42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="right left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mi>x</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mfrac><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>κ</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mfrac><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>κ</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here, we assume that the metabolite <inline-formula><mml:math id="inf428"><mml:mi>x</mml:mi></mml:math></inline-formula> is much more abundant than the active enzymes <inline-formula><mml:math id="inf429"><mml:msubsup><mml:mi>E</mml:mi><mml:mo>+</mml:mo><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf430"><mml:msubsup><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula>, meaning that the relative amount of bound <inline-formula><mml:math id="inf431"><mml:mi>x</mml:mi></mml:math></inline-formula> is very small. This allows us to neglect, in the dynamics of <inline-formula><mml:math id="inf432"><mml:mi>x</mml:mi></mml:math></inline-formula>, the source and sink terms due to binding and unbinding of <inline-formula><mml:math id="inf433"><mml:mi>x</mml:mi></mml:math></inline-formula> to the enzymes. We also assume that this binding and unbinding occurs on a much faster timescale than all other processes.</p><p><xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4</xref> shows an example of simulation results for these dynamics (for the full list of parameters used, see section ‘S11 Parameters used in figures’). We see that the system reacts to an increasing variance of environmental fluctuations (A) by increasing regulator activities (B). The figure also shows the behavior of a SEPI system which only consists of one <inline-formula><mml:math id="inf434"><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> regulator described by the dynamics in <xref ref-type="disp-formula" rid="equ42">Equation (S30)</xref>. <xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4C</xref> shows that the response strength, defined as discussed in the SI section ‘Defining the system’s responsiveness,’<disp-formula id="equ43"><label>(S31)</label><mml:math id="m43"><mml:mrow><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">ℛ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mfrac><mml:mo>≈</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:msubsup></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mfrac></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mo>-</mml:mo><mml:mi>m</mml:mi></mml:msubsup></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mo>-</mml:mo><mml:mi>m</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mfrac></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>is increasing due to the changed regulator activities. Finally, <xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4D</xref> compares the performance of the system <xref ref-type="disp-formula" rid="equ42">Equation (S30)</xref> with the corresponding SEPI system (which, again, we define by the same equations as <xref ref-type="disp-formula" rid="equ42">Equation (S30)</xref>, except without the <inline-formula><mml:math id="inf435"><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula> regulator). Similar to <xref ref-type="fig" rid="fig3">Figure 3F</xref> in the main text, the performance of the adapting system does not change as the variance of the stimulus increases, while the SEPI system becomes worse.</p><fig id="app1fig4" position="float"><label>Appendix 1—figure 4.</label><caption><title>Adaptation of responsiveness to an increasing variance of environmental fluctuations.</title><p>(<bold>A</bold>) Step-wise increase of the variance of <inline-formula><mml:math id="inf436"><mml:mi>D</mml:mi></mml:math></inline-formula>. (<bold>B</bold>) Time-series of regulator concentrations, where <inline-formula><mml:math id="inf437"><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf438"><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula> correspond to the total concentrations of <inline-formula><mml:math id="inf439"><mml:msub><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf440"><mml:msub><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula> respectively. (<bold>C</bold>) The responsiveness of the system as defined in <xref ref-type="disp-formula" rid="equ43">Equation (S31)</xref>. (<bold>D</bold>) The deviation of the metabolite concentration <inline-formula><mml:math id="inf441"><mml:mi>x</mml:mi></mml:math></inline-formula> from its target value.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-67455-app1-fig4-v1.tif"/></fig></sec><sec id="s16-2"><title>S9.2 An architecture based on a bifunctional enzyme</title><p>For the reader’s convenience, we reproduce this circuit in <xref ref-type="fig" rid="app1fig5">Appendix 1—figure 5</xref> (identical to <xref ref-type="fig" rid="fig6">Figure 6B</xref> in the main text). As described in the main text, for greater generality, we will here rephrase the task: instead of matching production to demand, we will think of maintaining the homeostasis of a quantity <inline-formula><mml:math id="inf442"><mml:mi>x</mml:mi></mml:math></inline-formula> perturbed by external factors. For example, instead of being a metabolite concentration, <inline-formula><mml:math id="inf443"><mml:mi>x</mml:mi></mml:math></inline-formula> could be osmolarity mismatch, and our circuit a hypothetical architecture for active control of osmotic pressure. In this interpretation, the enzyme <inline-formula><mml:math id="inf444"><mml:mi>E</mml:mi></mml:math></inline-formula> might be a mechanosensor triggered by tension in the membrane or cell wall, while ‘production’ and ‘degradation’ of <inline-formula><mml:math id="inf445"><mml:mi>x</mml:mi></mml:math></inline-formula> could be activities of opposing pumps, or regulators of glycerol export or metabolism.</p><fig id="app1fig5" position="float"><label>Appendix 1—figure 5.</label><caption><title>Regulation by allosteric forms of one enzyme <inline-formula><mml:math id="inf446"><mml:mi>E</mml:mi></mml:math></inline-formula>.</title><p>The unbound form <inline-formula><mml:math id="inf447"><mml:mi>E</mml:mi></mml:math></inline-formula> activates the production of <inline-formula><mml:math id="inf448"><mml:mi>x</mml:mi></mml:math></inline-formula>, while the bound form <inline-formula><mml:math id="inf449"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> promotes its degradation. The synthesis of <inline-formula><mml:math id="inf450"><mml:mi>E</mml:mi></mml:math></inline-formula> is regulated nonlinearly by the metabolite concentration <inline-formula><mml:math id="inf451"><mml:mi>x</mml:mi></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-67455-app1-fig5-v1.tif"/></fig><p>To simplify our language when describing the terms in the specific equations we simulate, we will still talk of a metabolite <inline-formula><mml:math id="inf452"><mml:mi>x</mml:mi></mml:math></inline-formula> being produced and degraded. However, to better accommodate alternative interpretations, the regulator activities will now be defined so that <inline-formula><mml:math id="inf453"><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf454"><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula> would be equal on average (for example, the activities of pumps in opposite directions should, on average, balance). This homeostasis-maintaining formulation is in contrast to <xref ref-type="fig" rid="fig3">Figure 3D</xref> in the main text, where regulators satisfied the constraint <inline-formula><mml:math id="inf455"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>The production and degradation of <inline-formula><mml:math id="inf456"><mml:mi>x</mml:mi></mml:math></inline-formula> are catalyzed by a bifunctional enzyme that changes its activity when bound to <inline-formula><mml:math id="inf457"><mml:mi>x</mml:mi></mml:math></inline-formula> forming the compound <inline-formula><mml:math id="inf458"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula>. The concentration of the unbound form <inline-formula><mml:math id="inf459"><mml:mi>E</mml:mi></mml:math></inline-formula> corresponds to the activating regulator, <inline-formula><mml:math id="inf460"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and increases the production <inline-formula><mml:math id="inf461"><mml:mi>P</mml:mi></mml:math></inline-formula> of <inline-formula><mml:math id="inf462"><mml:mi>x</mml:mi></mml:math></inline-formula>, while <inline-formula><mml:math id="inf463"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> plays the role of the inhibiting regulator, <inline-formula><mml:math id="inf464"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and promotes the degradation of <inline-formula><mml:math id="inf465"><mml:mi>x</mml:mi></mml:math></inline-formula>.</p><p>As above, we assume first-order kinetics for the production and degradation of <inline-formula><mml:math id="inf466"><mml:mi>x</mml:mi></mml:math></inline-formula>, and that the binding kinetics are fast compared to the other timescales in the problem. Defining <inline-formula><mml:math id="inf467"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> as the total concentration of the enzyme <inline-formula><mml:math id="inf468"><mml:mi>E</mml:mi></mml:math></inline-formula> in both its bound and unbound states, the bound and unbound fractions are described by Hill equations:<disp-formula id="equ44"><label>(S32)</label><mml:math id="m44"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mfrac><mml:msup><mml:mi>c</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo rspace="11pt">,</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mfrac><mml:msup><mml:mi>x</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>These expressions make it explicit that a small change in the concentration <inline-formula><mml:math id="inf469"><mml:mi>x</mml:mi></mml:math></inline-formula> induces a change in <inline-formula><mml:math id="inf470"><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf471"><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula> that is proportional to their sum, <inline-formula><mml:math id="inf472"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. In this way, the circuit shown in <xref ref-type="fig" rid="app1fig6">Appendix 1—figure 6</xref> does include an element of self-activation (one of our ‘key ingredients’), even though no interaction in the diagram is explicitly self-catalytic.</p><fig id="app1fig6" position="float"><label>Appendix 1—figure 6.</label><caption><title>Adaptation of responsiveness for the circuit architecture based on a bifunctional enzyme.</title><p>(<bold>A</bold>) The variance of <inline-formula><mml:math id="inf473"><mml:mi>D</mml:mi></mml:math></inline-formula> is increased step-wise. (<bold>B</bold>) Change of regulator activities. The regulator activities <inline-formula><mml:math id="inf474"><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf475"><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula> overlap strongly and cannot be distinguished in this panel. (<bold>C</bold>) The response strength of the system. (<bold>D</bold>) The mismatch of the metabolite concentration <inline-formula><mml:math id="inf476"><mml:mi>x</mml:mi></mml:math></inline-formula> from its target value.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-67455-app1-fig6-v1.tif"/></fig><p>With these notations, the dynamics of our system are:<disp-formula id="equ45"><label>(S33)</label><mml:math id="m45"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="right left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mi>x</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mover><mml:mi>A</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mi>κ</mml:mi><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where we assumed that modifying the enzyme <inline-formula><mml:math id="inf477"><mml:mi>E</mml:mi></mml:math></inline-formula> does not significantly affect the quantity <inline-formula><mml:math id="inf478"><mml:mi>x</mml:mi></mml:math></inline-formula>. (In the metabolic formulation, this corresponds to the assumption that <inline-formula><mml:math id="inf479"><mml:mi>x</mml:mi></mml:math></inline-formula> is much more abundant than <inline-formula><mml:math id="inf480"><mml:mi>E</mml:mi></mml:math></inline-formula>, so that the sequestration of <inline-formula><mml:math id="inf481"><mml:mi>x</mml:mi></mml:math></inline-formula> by <inline-formula><mml:math id="inf482"><mml:mi>E</mml:mi></mml:math></inline-formula> has negligible effect on the free concentration of <inline-formula><mml:math id="inf483"><mml:mi>x</mml:mi></mml:math></inline-formula>; in the osmotic formulation, the act of triggering a mechanosensor has negligible instantaneous effect on pressure). In the second equation, the synthesis of the enzyme <inline-formula><mml:math id="inf484"><mml:mi>E</mml:mi></mml:math></inline-formula> depends nonlinearly on the metabolite concentration <inline-formula><mml:math id="inf485"><mml:mi>x</mml:mi></mml:math></inline-formula>. The specific form of nonlinearity does not significantly affect the results, as long as it is sufficiently cup-convex in the vicinity of the operating point: As described in the section ‘S7 Nonlinearity acts as a sensor of fluctuation variance’, we can think of the nonlinearity <inline-formula><mml:math id="inf486"><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as a ‘sensor’ for the variance of environmental fluctuations. Whenever fluctuations in <inline-formula><mml:math id="inf487"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> increase such that the current responsiveness of the system fails to maintain the homeostasis of <inline-formula><mml:math id="inf488"><mml:mi>x</mml:mi></mml:math></inline-formula> within previous bounds of fluctuation magnitude, the fluctuations of <inline-formula><mml:math id="inf489"><mml:mi>x</mml:mi></mml:math></inline-formula> will lead to growth of <inline-formula><mml:math id="inf490"><mml:mi>A</mml:mi></mml:math></inline-formula>, increasing the responsiveness until it is again able to reduce the fluctuations of <inline-formula><mml:math id="inf491"><mml:mi>x</mml:mi></mml:math></inline-formula>. In our simulations we chose a Hill function with cooperativity 4 (see section ‘S11 Parameters used in figures’).</p><p><xref ref-type="fig" rid="app1fig6">Appendix 1—figure 6</xref> shows simulation results for this system. As in the first column of <xref ref-type="fig" rid="fig3">Figure 3</xref>, the variance of <inline-formula><mml:math id="inf492"><mml:mi>D</mml:mi></mml:math></inline-formula> is increased and the response of the system to this change is monitored. We see that the regulator concentrations correspondingly increase, causing a larger response strength <inline-formula><mml:math id="inf493"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mfrac></mml:mrow></mml:mrow></mml:math></inline-formula>. The increase in response strength is able to compensate for most of the performance loss, which shows that the system successfully adapts its timescale of response. This is in contrast to the ‘SEPI-like’ system with a fixed value <inline-formula><mml:math id="inf494"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, which cannot adapt its responsiveness and whose performance drops with every increase in fluctuation variance.</p></sec></sec><sec id="s17" sec-type="appendix"><title>S10 Adaptation to static demand</title><p>In the main text, we argue that the production <inline-formula><mml:math id="inf495"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> of the proposed system <xref ref-type="disp-formula" rid="equ3">Equation (3)</xref> adapts to any static demand <inline-formula><mml:math id="inf496"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>. The full dynamics of the system is<disp-formula id="equ46"><label>(S34)</label><mml:math id="m46"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>μ</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo rspace="5.3pt">,</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>κ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>With a static demand, <xref ref-type="disp-formula" rid="equ46">Equation (S34)</xref> possesses the same fixed points as the simplified dynamics:<disp-formula id="equ47"><label>(S35)</label><mml:math id="m47"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>μ</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mi>κ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>These dynamics have a Lyapunov-function<disp-formula id="equ48"><label>(S36)</label><mml:math id="m48"><mml:mrow><mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>κ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>μ</mml:mi></mml:munder><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This can be verified by considering the temporal change of <inline-formula><mml:math id="inf497"><mml:mi>F</mml:mi></mml:math></inline-formula><disp-formula id="equ49"><label>(S37)</label><mml:math id="m49"><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>μ</mml:mi></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>μ</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>with <inline-formula><mml:math id="inf498"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mi>κ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. Thus, <inline-formula><mml:math id="inf499"><mml:mi>F</mml:mi></mml:math></inline-formula> always increases and is obviously bound from above. For small κ, the maximum of <inline-formula><mml:math id="inf500"><mml:mi>F</mml:mi></mml:math></inline-formula> is reached for <inline-formula><mml:math id="inf501"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>≈</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, showing that the system adapts to any static demand.</p></sec><sec id="s18" sec-type="appendix"><title>S11 Parameters used in figures</title><p>If not stated otherwise, we use the following parameters: <inline-formula><mml:math id="inf502"><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf503"><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.35</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf504"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf505"><mml:mrow><mml:mi>κ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.015</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf506"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf507"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>45</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf508"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>8.75</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf509"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>875</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf510"><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mn>1.14</mml:mn><mml:mo>⋅</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. Since the demand <inline-formula><mml:math id="inf511"><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is modeled by a stochastic process which is, in principle, unbounded, there is a non-zero probability that the demand <inline-formula><mml:math id="inf512"><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> becomes negative. To prevent this behavior in the simulations we set <inline-formula><mml:math id="inf513"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="inf514"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>.</p><sec id="s18-1"><title><xref ref-type="fig" rid="fig3">Figure 3C–F</xref></title><p>Fluctuations: In 1D the matrix <inline-formula><mml:math id="inf515"><mml:mi>M</mml:mi></mml:math></inline-formula> only has one element which we set to <inline-formula><mml:math id="inf516"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>7.5</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf517"><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0.048</mml:mn><mml:mo>,</mml:mo><mml:mn>0.082</mml:mn><mml:mo>,</mml:mo><mml:mn>0.16</mml:mn><mml:mo>,</mml:mo><mml:mn>0.3</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>System: <inline-formula><mml:math id="inf518"><mml:mrow><mml:mi>κ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.03</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>Timescales: <inline-formula><mml:math id="inf519"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p><xref ref-type="fig" rid="fig3">Figure 3F</xref> shows a running average over 100 steps.</p></sec><sec id="s18-2"><title><xref ref-type="fig" rid="fig3">Figure 3I–L</xref></title><p>Fluctuations: <inline-formula><mml:math id="inf520"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>60</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mn>30</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>30</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mn>60</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></p><p>System: <inline-formula><mml:math id="inf521"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf522"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf523"><mml:mrow><mml:mi>κ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.02</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>SEPI: For a fair comparison, the timescale of SEPI is chosen such that its responsiveness matches the faster responsiveness of the <inline-formula><mml:math id="inf524"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> adapting system (measured in an environment with an isotropic <inline-formula><mml:math id="inf525"><mml:mi>M</mml:mi></mml:math></inline-formula> with the same determinant as used in <xref ref-type="fig" rid="fig3">Figure 3J–L</xref>): <inline-formula><mml:math id="inf526"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mn>4.9</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>For visualization purposes, to prevent long transients after changes of the activation angle, the regulator activities were capped from below at <inline-formula><mml:math id="inf527"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p><xref ref-type="fig" rid="fig3">Figure 3L</xref> shows a running average over 100 steps.</p></sec><sec id="s18-3"><title><xref ref-type="fig" rid="fig4">Figure 4A</xref></title><p>Fluctuations: Γ from 0 to 0.1 in 40 equidistant steps.</p><p>Timescale SEPI: <inline-formula><mml:math id="inf528"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>Simulation length: 5 · 10<sup>7</sup> steps.</p></sec><sec id="s18-4"><title><xref ref-type="fig" rid="fig4">Figure 4B</xref></title><p>Fluctuations: <inline-formula><mml:math id="inf529"><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>, anisotropy A=[ 1, 1.05,1.1, 1.15, 1.2 , 1.25, 1.3 , 1.35, 1.4, 1.45, 1.5, 1.55, 1.6 , 1.65, 1.7, 1.75, 1.8, 1.85, 1.9, 1.95, 2, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.25, 3.5, 4, 4.5, 5, 6, 7, 8, 9, 10]. For each value of <inline-formula><mml:math id="inf530"><mml:mi>A</mml:mi><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf531"><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> are chosen as: <inline-formula><mml:math id="inf532"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf533"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="inf534"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>8.75</mml:mn></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>875</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>Timescale SEPI: <inline-formula><mml:math id="inf535"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>Simulation length: 5 · 10<sup>7</sup> steps.</p></sec><sec id="s18-5"><title><xref ref-type="fig" rid="fig5">Figure 5A and B</xref></title><p>Fluctuations: Results averaged over activation angles <inline-formula><mml:math id="inf536"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>45</mml:mn><mml:mo>,</mml:mo><mml:mn>85</mml:mn><mml:mo>,</mml:mo><mml:mn>125</mml:mn><mml:mo>,</mml:mo><mml:mn>165</mml:mn><mml:mo>,</mml:mo><mml:mn>205</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>System: <inline-formula><mml:math id="inf537"><mml:mrow><mml:mi>κ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.02</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf538"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>Simulation length: 10<sup>7</sup> steps.</p></sec><sec id="s18-6"><title><xref ref-type="fig" rid="fig6">Figure 6C</xref> and <xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4</xref></title><p>The parameters in the simulation were chosen so as to ensure that, first, <inline-formula><mml:math id="inf539"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>≪</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>; and second, the steady-state <inline-formula><mml:math id="inf540"><mml:mi>x</mml:mi></mml:math></inline-formula> stays at 1 (this is analogous to setting <inline-formula><mml:math id="inf541"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> in the main text). Specifically, we used: <inline-formula><mml:math id="inf542"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf543"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf544"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf545"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf546"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf547"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf548"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mo>-</mml:mo><mml:mi>m</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf549"><mml:mrow><mml:msub><mml:mi>κ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1.0025</mml:mn><mml:mo>⁢</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf550"><mml:mrow><mml:msub><mml:mi>κ</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1.0025</mml:mn><mml:mo>⁢</mml:mo><mml:mfrac><mml:msubsup><mml:mi>c</mml:mi><mml:mo>-</mml:mo><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mo>-</mml:mo><mml:mi>m</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></inline-formula>. The parameters describing the fluctuations of <inline-formula><mml:math id="inf551"><mml:mi>D</mml:mi></mml:math></inline-formula> are chosen as: <inline-formula><mml:math id="inf552"><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf553"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf554"><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0.015</mml:mn><mml:mo>,</mml:mo><mml:mn> 0.025</mml:mn><mml:mo>,</mml:mo><mml:mn> 0.04</mml:mn><mml:mo>,</mml:mo><mml:mn> 0.055</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>A brief explanation: While the parameter list is long, there is a simple reasoning which sets most of these choices, and explains how the parameters of this model need to be related to each other in order for the adaptation of responsiveness to occur. First of all, we assume that the concentration <inline-formula><mml:math id="inf555"><mml:mi>x</mml:mi></mml:math></inline-formula> changes on a much faster timescale than the regulator concentrations <inline-formula><mml:math id="inf556"><mml:mi>a</mml:mi></mml:math></inline-formula>; here we choose <inline-formula><mml:math id="inf557"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf558"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">0.01</mml:mn></mml:mrow></mml:math></inline-formula>. Further, the average of <inline-formula><mml:math id="inf559"><mml:mrow><mml:mi>D</mml:mi><mml:mo mathvariant="normal">⁢</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is chosen to be equal to one. Then, for small fluctuations of <inline-formula><mml:math id="inf560"><mml:mi>D</mml:mi></mml:math></inline-formula> we have <inline-formula><mml:math id="inf561"><mml:mrow><mml:mi>x</mml:mi><mml:mo mathvariant="normal">≈</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo mathvariant="normal">⁢</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mo mathvariant="normal">+</mml:mo></mml:msub><mml:mo mathvariant="normal">-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mo mathvariant="normal">-</mml:mo></mml:msub></mml:mrow><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. On the other hand, the non-trivial fixed points of the regulator concentration dynamics are reached if <disp-formula id="equ50"><label>(S38)</label><mml:math id="m50"><mml:mrow><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:msubsup><mml:mi mathsize="90%">c</mml:mi><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:mi mathsize="90%">n</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mi mathsize="90%">c</mml:mi><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:mi mathsize="90%">n</mml:mi></mml:msubsup><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:msup><mml:mi mathsize="90%">x</mml:mi><mml:mi mathsize="90%">n</mml:mi></mml:msup></mml:mrow></mml:mfrac></mml:mstyle><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:msub><mml:mi mathsize="90%">κ</mml:mi><mml:mo mathsize="90%" stretchy="false">+</mml:mo></mml:msub><mml:mo mathsize="90%" mathvariant="italic" separator="true" stretchy="false"> </mml:mo><mml:mtext mathsize="90%">and</mml:mtext></mml:mrow></mml:mrow><mml:mo mathsize="90%" mathvariant="italic" separator="true" stretchy="false"> </mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:msup><mml:mi mathsize="90%">x</mml:mi><mml:mi mathsize="90%">m</mml:mi></mml:msup><mml:mrow><mml:msubsup><mml:mi mathsize="90%">c</mml:mi><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:mi mathsize="90%">m</mml:mi></mml:msubsup><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:msup><mml:mi mathsize="90%">x</mml:mi><mml:mi mathsize="90%">m</mml:mi></mml:msup></mml:mrow></mml:mfrac></mml:mstyle><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:msub><mml:mi mathsize="90%">κ</mml:mi><mml:mo mathsize="90%" stretchy="false">-</mml:mo></mml:msub></mml:mrow></mml:mrow><mml:mo mathsize="90%" stretchy="false">.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Thus, we can set the equilibrium point of <inline-formula><mml:math id="inf562"><mml:mi>x</mml:mi></mml:math></inline-formula> by choosing <inline-formula><mml:math id="inf563"><mml:msub><mml:mi>κ</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf564"><mml:msub><mml:mi>κ</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf565"><mml:msub><mml:mi>c</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf566"><mml:msub><mml:mi>c</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula>. Here, without loss of generality, we choose that the fixed point is reached at <inline-formula><mml:math id="inf567"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> by setting<disp-formula id="equ51"><label>(S39)</label><mml:math id="m51"><mml:mrow><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:msubsup><mml:mi mathsize="90%">c</mml:mi><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:mi mathsize="90%">n</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mi mathsize="90%">c</mml:mi><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:mi mathsize="90%">n</mml:mi></mml:msubsup><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:mn mathsize="90%">1</mml:mn></mml:mrow></mml:mfrac></mml:mstyle><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:mrow><mml:msub><mml:mi mathsize="90%">κ</mml:mi><mml:mo mathsize="90%" stretchy="false">+</mml:mo></mml:msub><mml:mo mathsize="90%" mathvariant="italic" separator="true" stretchy="false"> </mml:mo><mml:mtext mathsize="90%">and</mml:mtext></mml:mrow></mml:mrow><mml:mo mathsize="90%" mathvariant="italic" separator="true" stretchy="false"> </mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mn mathsize="90%">1</mml:mn><mml:mrow><mml:msubsup><mml:mi mathsize="90%">c</mml:mi><mml:mo mathsize="90%" stretchy="false">-</mml:mo><mml:mi mathsize="90%">m</mml:mi></mml:msubsup><mml:mo mathsize="90%" stretchy="false">+</mml:mo><mml:mn mathsize="90%">1</mml:mn></mml:mrow></mml:mfrac></mml:mstyle><mml:mo mathsize="90%" stretchy="false">=</mml:mo><mml:msub><mml:mi mathsize="90%">κ</mml:mi><mml:mo mathsize="90%" stretchy="false">-</mml:mo></mml:msub></mml:mrow></mml:mrow><mml:mo mathsize="90%" stretchy="false">.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>For the sought-after effect to occur, the fast fluctuations of <inline-formula><mml:math id="inf568"><mml:mi>x</mml:mi></mml:math></inline-formula> around <inline-formula><mml:math id="inf569"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> need to result in an effective additional growth of <inline-formula><mml:math id="inf570"><mml:msub><mml:mi>a</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf571"><mml:msub><mml:mi>a</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula>, providing a ‘sensor’ for the variance of <inline-formula><mml:math id="inf572"><mml:mi>D</mml:mi></mml:math></inline-formula>. One possibility to get this behavior is to set <inline-formula><mml:math id="inf573"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mo>-</mml:mo><mml:mi>m</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf574"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>. To avoid the regulator concentrations to grow indefinitely, <inline-formula><mml:math id="inf575"><mml:msub><mml:mi>κ</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf576"><mml:msub><mml:mi>κ</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula> need to be a little larger than the determined values in <xref ref-type="disp-formula" rid="equ51">Equation (S39)</xref>. Finally, the parameter γ can be chosen rather freely; here we choose <inline-formula><mml:math id="inf577"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Simulation length: 3.2 · 10<sup>7</sup> steps with <inline-formula><mml:math id="inf578"><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>⋅</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. Panels 6C and S4 D show a running average over 100 timesteps.</p></sec><sec id="s18-7"><title><xref ref-type="fig" rid="fig6">Figure 6D</xref> and <xref ref-type="fig" rid="app1fig6">Appendix 1—figure 6</xref>:</title><p>We used the following parameters for the simulations: <inline-formula><mml:math id="inf579"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf580"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf581"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf582"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf583"><mml:mrow><mml:mi>κ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf584"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf585"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. The nonlinearity was chosen as: <inline-formula><mml:math id="inf586"><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mfrac><mml:msup><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>-</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="inf587"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf588"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf589"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf590"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>5</mml:mn><mml:mo>⋅</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. The parameters describing the fluctuations of <inline-formula><mml:math id="inf591"><mml:mi>D</mml:mi></mml:math></inline-formula> are set to: <inline-formula><mml:math id="inf592"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf593"><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0.025</mml:mn><mml:mo>,</mml:mo><mml:mn> 0.05</mml:mn><mml:mo>,</mml:mo><mml:mn> 0.1</mml:mn><mml:mo>,</mml:mo><mml:mn> 0.2</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. For the mechanism to work, the timescales need to fulfill <inline-formula><mml:math id="inf594"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>≫</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. The parameters <italic>P</italic><sub>0</sub>, <inline-formula><mml:math id="inf595"><mml:mi>m</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf596"><mml:mi>c</mml:mi></mml:math></inline-formula> are set by the choice of the fixed-point <italic>x</italic><sub>0</sub> (here <inline-formula><mml:math id="inf597"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>). Simulation length: 3.2 · 10<sup>7</sup> steps with <inline-formula><mml:math id="inf598"><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>⋅</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. Panels 6D and S6 D show a running average over 100 timesteps.</p></sec><sec id="s18-8"><title><xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref></title><p>System: κ from 0.01 to 0.025 in steps of size 1.25 · 10<sup>−4</sup>.</p><p>Simulation length = 5 · 10<sup>7</sup> steps.</p><p>For each simulation, the performance was averaged over the last 10<sup>7</sup> time steps.</p></sec><sec id="s18-9"><title><xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref> inset</title><p>All system parameters as in Figure S1 except for: κ from 0.013 to 0.014 in steps of size 2.5 · 10<sup>−5</sup>.</p><p>Simulation length: 10<sup>8</sup> steps.</p><p>For each simulation, the performance was averaged over the last 2 · 10<sup>7</sup> steps.</p><p>The results are binned in 20 equal-width bins.</p></sec></sec></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.67455.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Murugan</surname><given-names>Arvind</given-names></name><role>Reviewing Editor</role><aff><institution>University of Chicago</institution><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Pugatch</surname><given-names>Rami</given-names> </name><role>Reviewer</role><aff><institution>Ben-Gurion University of the Negev</institution><country>Israel</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Lambert</surname><given-names>Guillaume</given-names> </name><role>Reviewer</role><aff><institution>The University of Chicago</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>This paper shows how a common biochemical motif enables an organism to learn parameters describing the statistical structure of environmental fluctuations. The inferred parameters (here, the mean and variance) can be used to mount an adaptive response. The work shows a simple design principle to achieve control over phenotype, homeostasis and growth.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;A simple regulatory architecture allows learning the statistical structure of a changing environment&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 2 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Aleksandra Walczak as the Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Rami Pugatch (Reviewer #1); Guillaume Lambert (Reviewer #2).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential Revisions:</p><p>1) How would results change if the threshold-linear model is replaced by a Hill function? Some discussion is currently in the SI. More discussion is needed in the main text of how all results would change if a hill function is used throughout.</p><p>2) A unified compact discussion of self-activation, non-linearity and regulator excess in the main text.</p><p>3) Discuss the cost/benefits of the proposed learning mechanisms if the environment doesn't fit the internal model discussed here – e.g., requires more than a binary on-vs-off response or environmental statistics varies very fast.</p><p><italic>Reviewer #1:</italic></p><p>My recommendation is a to reorganize the paper according to the following comments:</p><p>Weaknesses:</p><p>The first weakness I wish to discuss is the oversimplification of the model. The authors assume a set of parameters D<sub>i</sub> (demand) has to be tracked by a set of internal parameters P<sub>i</sub> and define a quadratic penalty term, (which happens to be the only choice that is amenable to analytical treatment in control theory). To motivate this modeling approach they give two examples, one of which is the expression of a costly metabolic pathway that ideally should track the relevant nutrient. The problem with this model is the assumption that there is only one optimal solution <inline-formula><mml:math id="inf599"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>. This I think is too simplistic since (i) the dimension of the internal set of parameters π at least in the metabolic example is typically larger than the state parameters D<sub>i</sub> (even if they represent the demand for a metabolite there are typically multiple alternative supply pathways) ; (ii) The possibility of multiple solutions P<sub>1</sub>,…, P<sub>m</sub> which are equally optimal is ignored.</p><p>For example, absence amino-acid requires expression of proteins that can metabolize these amino-acids from an inorganic nitrogen source. However, presence of both amino-acids and inorganic nitrogen source poses a dilemma to the cell, and a solution that optimize say growth rate depends subtly on both the relative concentration of the inorganic nitrogen source vs. the concentration and availability of external amino-acids, as well as the protein investment in transporting vs. making the amino-acids from scratch. If these relative concentrations fluctuate, an optimal solution in terms of growth rate can either be to ignore the amino-acids, or to ignore the inorganic nitrogen source or to express a mixture of both and this is not captured by the model presented by the authors. And there are other cases where multiple alternative pathways in metabolism are present to satisfy a given demand.</p><p>As the great William Feller used to tell his students, the best in science consists of the general embodied in the concrete. I like the general result but I urge the authors to take Feller's challenge and find a concrete example to demonstrate the merit of their approach and use it in the paper.</p><p>This biological concreteness will also solve a second weakness I found in the paper, namely the form of the nonlinear response used by the authors in the main text and in preparing the main figures (to my understanding). The nonlinearity is of the form of 'threshold-linear' response. This is not biologically feasible as there is always some upper saturation in the response. I expected to see the results presented in the main text in terms of a Michaelis-Menten (MM) or Hill function form which saturate both at low and at high concentrations. Although such cases were analyzed in the SI, it wasn't clear to me whether the main conclusions would change if such functions were used instead throughout the paper.</p><p>Since the author emphasize the role of (i) excess of regulators, (ii) self-activation, and (iii) non-linearity of the regulators, I think it is appropriate to analyze their importance in the main text. For some reason the role of self-activation was deferred to the SI.</p><p>Also, I would have liked to understand their relative importance (with realistic MM or Hill non-linearity) keeping in mind that proteins are costly for the cell to make, so a minimal excess is perhaps better.</p><p>Finally, I would expect a discussion of an hypothetical experiment, where such excess is deliberately removed by say gene deletion by the experimenter – what would be the simplest experiment that will ascertain the effect you predict be? Will a simple up-shift / down-shift will do the job?</p><p>Another more technical weakness is the statistical model being a Gaussian process. The authors claim their result is more general so I wonder how their result change for processes without time scale or to processes with power-law correlations?</p><p>A weakness in the analysis of the benefit of having such mechanisms for 'learning' the statistics of the environment requires some attention. If the environments statistics changes rapidly, or if the environment poses more complex challenges that require a response which is not all-or-none I would expect a reduction in the benefit of such a mechanism. An example that was discussed, is the case where the environment statistics varies too fast compared to the time-scale for learning a new environment statistic. It would be nice to see a simple summary of when the authors predict such a system will be advantageous for cells, considering e.g. the excess cost of building and maintaining such machinery. This naturally leads to a discussion of possible experimental verification as mentioned before.</p><p>More importantly, if we consider an ensemble of cells with such control mechanisms, their mutual interaction can lead to complex dynamics, and it is not clear if in such a setting where each cell response to the global change caused by all other cells, there is still benefit for learning the statistics which now become intertwined with the behavior of the average of all cells.</p><p>Finally, I find a weakness in the modeling of the &quot;nominal&quot; product feedback inhibition (PFI). It is not fair to compare to a naïve single-step PFI since actual PFI's are not single step and there is much work on the topic, see in particular the set of papers by Ned Wingreen from Princeton and his collogues.</p><p>I like the paper, and I think my comments benefits the paper. I also understand that doing it all over again might require too much effort, so I leave it to you and to the editor to think what it the best way to address my concerns. Perhaps (hopefully) some of my comments are already taken care of, and the only change is to better explain what you already did. I apologize in advance if I misread or misunderstood parts of the paper and because of that made an unnecessary comment.</p><p>I suggest you take a look at the following work:</p><p>Goyal, Sidhartha, et al., &quot;Achieving optimal growth through product feedback inhibition in metabolism.&quot;. PLoS Comput Biol 66 (2010):, 6, 6, e1000802. Web and the PRL they cite.</p><p>I also vaguely recall Stanislas Leibler had a PNAS paper on learning with Bin Kan Xue as first author, perhaps it is relevant too.</p><p>I too had a paper that is somewhat relevant (That Kobayashi which you cite, cites in his paper) --- https://arxiv.org/abs/1308.0623</p><p>Please do not cite it unless you find it relevant, I only mention it because after reading your work I realized that I can use your method to test my formula..</p><p>Regarding the prediction issue (that such a system predicts the future and respond to the prediction which it constantly updates). This sound to me a lot like model predictive control. So I think a comparison with model predictive control literature might be in place. In particular, a clear discussion of how do you experimentally differ between non-predictive to predictive control schemes, given that most if not all of the internal variables are not measured in a typical experiment seems necessary.</p><p><italic>Reviewer #2:</italic></p><p>Overall, I recommend the publication of this manuscript as long as the authors address the following minor comments and suggestions.</p><p>1. A piecewise linear model for the regulator activity like the one presented in Eqn. 2c and 4c may not be biologically realistic. Although it is clear that the linear model was chosen because of the ubiquity of linear activation functions in neural networks, the authors may need to better justify why they chose a linear function, or whether it matters at all what the activity function looks like. Indeed, the authors do look into using a Hill-like function to describe the regulation of biochemical activity in section S8.2, it would be illuminating to emphasize this observation and discuss the role of choosing a specific activity function.</p><p>2. Line 389: &quot;...but maintaining such a perfect regulatory system would presumably be costly;&quot;. Please explain why or provide a citation supporting this claim.</p><p>3. Line 777: (typo) &quot;...acts as a senor&quot;</p><p>Fig. 1A: Not sure what this panel is trying to show (even from the figure caption). Perhaps show a third panel above the other two where the information about the exterior is removed but the cell &quot;sees&quot; the same environmental composition?</p><p>Fig. 2C: The subscripts for a<sub>1</sub> and a<sub>2</sub> are missing.</p><p>Fig. 2E: It is unclear what the x-axis and y-axis labels are. X = and Y =</p><p>Fig. 3H: the &quot;H&quot; label for panel 4H is not there.</p><p>Fig. 3I+J: It is unclear how the regulator levels map back to the environment. Perhaps show a small ellipse with the correct orientation alpha (ie. -60, +30, -30, +60) in each sector, at the top of the graph, with the corresponding magnitude of each vector \sigma?.</p><p>Fig. 3J: Similarly, the main message of this panel is not very clear: several lines overlap and it is difficult to track a single one over time. Split that panel into 5 graphs arranged vertically, each showing the trace of a single regulator?</p><p>Fig. 4: Panel labels &quot;A&quot; and &quot;B&quot; are missing</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.67455.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential Revisions:</p><p>1) How would results change if the threshold-linear model is replaced by a Hill function? Some discussion is currently in the SI. More discussion is needed in the main text of how all results would change if a hill function is used throughout.</p></disp-quote><p>This is indeed a very important point. To exhibit the generality of the learning behavior we describe, we used a minimal model which allowed us to characterize the minimal set of key ingredients without obscuring them by the (inevitably large) parameter space of any realistic implementation. However, the fact that the behavior is retained in a realistic implementation is, of course, a crucial part of the argument. Relegating this discussion to the supplement was a poor decision.</p><p>A literal interpretation of the reviewers’ suggestions here might have been to regenerate the plots of Figure 3 &amp; Figure 4 using a Hill function instead of the threshold-linear model. With an appropriate choice of the Hill parameters, this could be done so that the panels barely change (for reasons explained in SI lines 663-670). However, we felt that doing so would have addressed only the letter of the comment, not the spirit; in fact, including such plots could almost be construed as misleading. Our minimal model includes several simplifications. Adding figures with “partial realism” while retaining other simplifications would implicitly suggest that the form of nonlinearity is the biggest concern one might have; but in fact, the simplistic treatment of regulator self-activation in Eq. (4c) is no less important.</p><p>The questions raised by the reviewers – namely, robustness of the behavior to the simplifications of our model – are issues we thought a lot about while writing the paper, and we felt that any claims about generalizability of the behavior must be validated in a reasonably realistic setting – with not only Hill-shaped activation curves, but also a biochemically plausible self-activation. We completely agree that this discussion belongs in the main text, not the supplement. Thus, to address the reviewers’ concerns, we added a figure 6 to the main text (“Realistic implementations”, which includes two panels that were previously in the supplement), and greatly expanded the corresponding section of Results (lines 341-374; see also lines 174-177).</p><disp-quote content-type="editor-comment"><p>2) A unified compact discussion of self-activation, non-linearity and regulator excess in the main text.</p></disp-quote><p>We have merged the relevant material, previously fragmented between the main text and the SI, into a single section of the main text (revised Figure 5; lines 305-329).</p><disp-quote content-type="editor-comment"><p>3) Discuss the cost/benefits of the proposed learning mechanisms if the environment doesn't fit the internal model discussed here – e.g., requires more than a binary on-vs-off response or environmental statistics varies very fast.</p></disp-quote><p>To address this point we, first, changed Figure 1A, replacing the (unclear) original cartoon by a concise summary identifying the context where the problem we are considering / the mechanism we are presenting are relevant (new Figure 1A and its legend; also lines 45-48). Second, the revised manuscript identifies the control theory calculation (and thus our findings of near-optimality) as being model-specific; of biological relevance is the ability of the circuit to learn correlations of fluctuations, which is not specific to the Gaussian model (lines 235-238). Additional suggestions from Reviewer #1 related to this point were incorporated in lines 88-94 and 266-268.</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>My recommendation is a to reorganize the paper according to the following comments:</p><p>Weaknesses:</p><p>The first weakness I wish to discuss is the oversimplification of the model. The authors assume a set of parameters D<sub>i</sub> (demand) has to be tracked by a set of internal parameters P<sub>i</sub> and define a quadratic penalty term, (which happens to be the only choice that is amenable to analytical treatment in control theory). To motivate this modeling approach they give two examples, one of which is the expression of a costly metabolic pathway that ideally should track the relevant nutrient. The problem with this model is the assumption that there is only one optimal solution <inline-formula><mml:math id="inf600"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>. This I think is too simplistic since (i) the dimension of the internal set of parameters π at least in the metabolic example is typically larger than the state parameters D<sub>i</sub> (even if they represent the demand for a metabolite there are typically multiple alternative supply pathways) ; (ii) The possibility of multiple solutions P<sub>1</sub>,…, P<sub>m</sub> which are equally optimal is ignored.</p><p>For example, absence amino-acid requires expression of proteins that can metabolize these amino-acids from an inorganic nitrogen source. However, presence of both amino-acids and inorganic nitrogen source poses a dilemma to the cell, and a solution that optimize say growth rate depends subtly on both the relative concentration of the inorganic nitrogen source vs. the concentration and availability of external amino-acids, as well as the protein investment in transporting vs. making the amino-acids from scratch. If these relative concentrations fluctuate, an optimal solution in terms of growth rate can either be to ignore the amino-acids, or to ignore the inorganic nitrogen source or to express a mixture of both and this is not captured by the model presented by the authors. And there are other cases where multiple alternative pathways in metabolism are present to satisfy a given demand.</p></disp-quote><p>The biological question of determining the optimal behavior in a fluctuating environment is subtle. The optimal behavior may indeed not be unique, or even well-defined (optimal given what constraints?) The challenges faced by real organisms are certainly vastly more rich than our simplistic setup.</p><p>Nevertheless, generically, the most appropriate behavior will depend on statistics of fluctuations; and any organism attempting to make use of this would at a minimum need (1) a mechanism for sensing these statistics. Moreover, such a mechanism would (2) need to be simple enough to have plausibly evolved and be retained by evolution. Our minimal model allows us to focus on these two basic challenges.</p><p>In light of this, we agree with the reviewer that introducing our setup as a way to &quot;model the general challenges of surviving in a fluctuating environment&quot; in the original manuscript was poor phrasing. Our aim was to show that a simple circuit is capable of learning environment statistics, in a setup that could have plausibly benefited fitness. For this aim, we believe the simplifications of our setup (such as a unique optimum) are appropriate, and we added a paragraph (lines 88-94) to explicitly address this important point.</p><disp-quote content-type="editor-comment"><p>As the great William Feller used to tell his students, the best in science consists of the general embodied in the concrete. I like the general result but I urge the authors to take Feller's challenge and find a concrete example to demonstrate the merit of their approach and use it in the paper.</p></disp-quote><p>We certainly do agree with the sentiment. The metabolic motivation of the problem (line 128-132, lines 385-388 in discussion), the osmotic example (line 83-84) and the possible relation to two-component system architecture (lines 375-381, 395-400) represent our best attempt to include plausible concreteness without straying too far from the domain of our expertise. For example, we were quite intrigued by a possible implementation of our scheme in the context of protein synthesis and tRNA regulation, but we worried our distance from the subject would make it too cartoonish and naive. Similarly, our discussion of the two-component systems goes as far as we were comfortable taking it after a literature review and conversation with an expert (M. Goulian in acknowledgments). We therefore opted for explaining the idea in a theoretical language, explicitly separating it from examples. While a concrete and realistic example would have helped with making the message more broadly accessible, the fact that a reader like yourself saw possible parallels with e.g. the regulation of ribosome production -- a topic we ourselves did not consider -- appears to show that we did overall succeed at our intention.</p><disp-quote content-type="editor-comment"><p>This biological concreteness will also solve a second weakness I found in the paper, namely the form of the nonlinear response used by the authors in the main text and in preparing the main figures (to my understanding). The nonlinearity is of the form of 'threshold-linear' response. This is not biologically feasible as there is always some upper saturation in the response. I expected to see the results presented in the main text in terms of a Michaelis-Menten (MM) or Hill function form which saturate both at low and at high concentrations. Although such cases were analyzed in the SI, it wasn't clear to me whether the main conclusions would change if such functions were used instead throughout the paper.</p></disp-quote><p>This is an excellent point; please see the “essential revisions” section above (point #1) for a detailed list of changes we made to address it. For specifically the point on upper saturation in the response, see the edit in lines 667-668.</p><disp-quote content-type="editor-comment"><p>Since the author emphasize the role of (i) excess of regulators, (ii) self-activation, and (iii) non-linearity of the regulators, I think it is appropriate to analyze their importance in the main text. For some reason the role of self-activation was deferred to the SI.</p></disp-quote><p>Another excellent point; thank you. For the list of edits, see “essential revisions” section, point #2.</p><disp-quote content-type="editor-comment"><p>Also, I would have liked to understand their relative importance (with realistic MM or Hill non-linearity) keeping in mind that proteins are costly for the cell to make, so a minimal excess is perhaps better.</p></disp-quote><p>For relative importance: none of the three ingredients are sufficient on their own (Figure 5); in that sense, all are equally important. For minimal excess being better: indeed! The main feature of our scheme that (hopefully) makes it of plausible relevance to real living systems is that in the presence of nonlinearity &amp; self-activation, a single additional regulator can already provide substantial benefit. We added a more nuanced discussion of these points (new panel Figure 5B; lines 317-329, especially 328-329).</p><p>For the purposes of this work, we postulated that sensing/learning fluctuations was desirable, and asked if it was possible. In any specific context, the full cost-benefit analysis would indeed weigh the benefit against the cost of making the necessary regulatory machinery. We did not perform this analysis; this is acknowledged in line 269 stating we use CIP as only a “proxy” for specifying the maximum tolerable cost.</p><disp-quote content-type="editor-comment"><p>Finally, I would expect a discussion of an hypothetical experiment, where such excess is deliberately removed by say gene deletion by the experimenter – what would be the simplest experiment that will ascertain the effect you predict be? Will a simple up-shift / down-shift will do the job?</p></disp-quote><p>One feature of the mechanism we described is that the excess regulators would appear fully redundant / dispensable in any static environment: the fitness penalty from their deletion would only manifest itself in a complex fluctuating environment, as a failure to learn. Of course, there are a great many functions whose benefits are masked in the simplified lab environment, so this feature is hardly a decisive identifying criterion. We added a discussion of a hypothetical experiment that could detect specifically the predictive nature of a regulatory scheme (lines 631-642). Our hope with this paper is that experts in any given system are better positioned to map the general idea onto their domain than we could ourselves.</p><disp-quote content-type="editor-comment"><p>Another more technical weakness is the statistical model being a Gaussian process. The authors claim their result is more general so I wonder how their result change for processes without time scale or to processes with power-law correlations?</p></disp-quote><p>Another good point; please see our response to the “essential revisions”, point #3.</p><disp-quote content-type="editor-comment"><p>A weakness in the analysis of the benefit of having such mechanisms for 'learning' the statistics of the environment requires some attention. If the environments statistics changes rapidly, or if the environment poses more complex challenges that require a response which is not all-or-none I would expect a reduction in the benefit of such a mechanism. An example that was discussed, is the case where the environment statistics varies too fast compared to the time-scale for learning a new environment statistic. It would be nice to see a simple summary of when the authors predict such a system will be advantageous for cells, considering e.g. the excess cost of building and maintaining such machinery. This naturally leads to a discussion of possible experimental verification as mentioned before.</p></disp-quote><p>To address this point, we made a new Figure 1A; the legend specifies that “In this work, we consider an environment undergoing epochs that differ in their fluctuation structure. Epochs are long compared to the physiological timescale, but switch faster than the evolutionary timescale.” The reviewer is correct in saying that, in principle, the discussion of the benefits would need to be offset by the cost of building/maintaining the relevant machinery. We did not perform this analysis here, and do not know how to do it in a way that is not system-specific; this limitation is acknowledged in lines 267-269.</p><disp-quote content-type="editor-comment"><p>More importantly, if we consider an ensemble of cells with such control mechanisms, their mutual interaction can lead to complex dynamics, and it is not clear if in such a setting where each cell response to the global change caused by all other cells, there is still benefit for learning the statistics which now become intertwined with the behavior of the average of all cells.</p></disp-quote><p>This is a very interesting comment. We edited the framing of the problem to specify we consider the fluctuations structure of externally imposed conditions (lines 82, 94). However, as the reviewer points out, the organisms also influence their own environment. Whether this fact makes the problem more relevant or less relevant is something that would be interesting to think about. Still, we feel that such a discussion lies outside of the scope of this manuscript. (However, we added a mention to lines 91-92.)</p><disp-quote content-type="editor-comment"><p>Finally, I find a weakness in the modeling of the &quot;nominal&quot; product feedback inhibition (PFI). It is not fair to compare to a naïve single-step PFI since actual PFI's are not single step and there is much work on the topic, see in particular the set of papers by Ned Wingreen from Princeton and his colleagues.</p></disp-quote><p>This is a good point. Although we keep comparing the performance of our scheme with product feedback inhibition, our intention is not to claim that this scheme is “worse” than ours; we simply use it as an example of a circuit that manifestly does not learn input statistics, in order to show that our circuit does. Our simplified treatment of PFI is not unfair to this scheme: if anything, our results actually reinforce prior findings (Pavlov et al., 2013, Goyal et al. 2010) that despite its simplicity, PFI is a remarkably efficient scheme -- in our Figure 4A, up until the separation indicated by the arrow, the SEPI curve is in fact optimal given its CIP! Our scheme is not generally better at the same CIP (note that before the arrow, our performance is worse than the blue “SEPI” curve), it just “knows” to upregulate the CIP to a larger value when fluctuations become large enough to activate the “learning”, and therefore performs better in some parameter regimes.</p><p>We added a paragraph to the main text stating the above (lines 276-282); and both references.</p><disp-quote content-type="editor-comment"><p>I like the paper, and I think my comments benefits the paper. I also understand that doing it all over again might require too much effort, so I leave it to you and to the editor to think what it the best way to address my concerns. Perhaps (hopefully) some of my comments are already taken care of, and the only change is to better explain what you already did. I apologize in advance if I misread or misunderstood parts of the paper and because of that made an unnecessary comment.</p></disp-quote><p>Thank you for your careful read of our manuscript and for the valuable suggestions that helped improve the work.</p><disp-quote content-type="editor-comment"><p>I suggest you take a look at the following work:</p><p>Goyal, Sidhartha, et al., &quot;Achieving optimal growth through product feedback inhibition in metabolism.&quot;. PLoS Comput Biol 66 (2010):, 6, 6, e1000802. Web and the PRL they cite.</p><p>I also vaguely recall Stanislas Leibler had a PNAS paper on learning with Bin Kan Xue as first author, perhaps it is relevant too.</p><p>I too had a paper that is somewhat relevant (That Kobayashi which you cite, cites in his paper) --- https://arxiv.org/abs/1308.0623</p><p>Please do not cite it unless you find it relevant, I only mention it because after reading your work I realized that I can use your method to test my formula..</p></disp-quote><p>Thank you for the pointers. We read them all with great interest. The Goyal et al., is particularly relevant and we should have included it from the start; we added this reference as well as another one that seemed the most relevant (Pavlov et al., 2013).</p><disp-quote content-type="editor-comment"><p>Regarding the prediction issue (that such a system predicts the future and respond to the prediction which it constantly updates). This sound to me a lot like model predictive control. So I think a comparison with model predictive control literature might be in place. In particular, a clear discussion of how do you experimentally differ between non-predictive to predictive control schemes, given that most if not all of the internal variables are not measured in a typical experiment seems necessary.</p></disp-quote><p>We added a paragraph commenting on this to the SI section on control theory (section “Model predictive control”; lines 618-649).</p><disp-quote content-type="editor-comment"><p>Reviewer 2:</p><p>Overall, I recommend the publication of this manuscript as long as the authors address the following minor comments and suggestions.</p><p>1. A piecewise linear model for the regulator activity like the one presented in Eqn. 2c and 4c may not be biologically realistic. Although it is clear that the linear model was chosen because of the ubiquity of linear activation functions in neural networks, the authors may need to better justify why they chose a linear function, or whether it matters at all what the activity function looks like. Indeed, the authors do look into using a Hill-like function to describe the regulation of biochemical activity in section S8.2, it would be illuminating to emphasize this observation and discuss the role of choosing a specific activity function.</p></disp-quote><p>This is a very good point. Please see the “essential revisions” section above (point #1) for a detailed list of changes we made to address it.</p><disp-quote content-type="editor-comment"><p>2. Line 389: &quot;...but maintaining such a perfect regulatory system would presumably be costly;&quot;. Please explain why or provide a citation supporting this claim.</p></disp-quote><p>Done (line 268).</p><disp-quote content-type="editor-comment"><p>Fig. 1A: Not sure what this panel is trying to show (even from the figure caption). Perhaps show a third panel above the other two where the information about the exterior is removed but the cell &quot;sees&quot; the same environmental composition?</p></disp-quote><p>Yes; we had tried many versions of this cartoon but in retrospect, it’s still confusing. In the revised manuscript, we replaced it by a concise summary identifying the context where the problem we are considering / the mechanism we are presenting are relevant. (New Fig. 1A)</p><disp-quote content-type="editor-comment"><p>Fig. 3I+J: It is unclear how the regulator levels map back to the environment. Perhaps show a small ellipse with the correct orientation alpha (ie. -60, +30, -30, +60) in each sector, at the top of the graph, with the corresponding magnitude of each vector \sigma?.</p><p>Fig. 3J: Similarly, the main message of this panel is not very clear: several lines overlap and it is difficult to track a single one over time. Split that panel into 5 graphs arranged vertically, each showing the trace of a single regulator?</p></disp-quote><p>This was an excellent suggestion! We followed the reviewer’s advice to improve the labeling in these two panels, and find them to be much improved. (Updated panels 3I, 3J.)</p><disp-quote content-type="editor-comment"><p>Fig. 3H: the &quot;H&quot; label for panel 4H is not there.</p><p>Fig. 2C: The subscripts for a<sub>1</sub> and a<sub>2</sub> are missing.</p></disp-quote><p>This may have been due to issues with PDF rendering on the reviewer’s machine; we do see these labels correctly on ours. If the paper is accepted for publication, we will make sure all labels are correctly displayed in the proofs.</p><disp-quote content-type="editor-comment"><p>3. Line 777: (typo) &quot;...acts as a senor&quot;</p><p>Fig. 2E: It is unclear what the x-axis and y-axis labels are. X = and Y =</p><p>Fig. 4: Panel labels &quot;A&quot; and &quot;B&quot; are missing</p></disp-quote><p>Corrected; thank you for pointing these out.</p></body></sub-article></article>