<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">74987</article-id><article-id pub-id-type="doi">10.7554/eLife.74987</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Ecology</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>Interactions between strains govern the eco-evolutionary dynamics of microbial communities</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-233952"><name><surname>Goyal</surname><given-names>Akshit</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9425-8269</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-237169"><name><surname>Bittleston</surname><given-names>Leonora S</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-259985"><name><surname>Leventhal</surname><given-names>Gabriel E</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-259986"><name><surname>Lu</surname><given-names>Lu</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-109882"><name><surname>Cordero</surname><given-names>Otto X</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2695-270X</contrib-id><email>ottox@mit.edu</email><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/042nb2s44</institution-id><institution>Physics of Living Systems, Department of Physics, Massachusetts Institute of Technology</institution></institution-wrap><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/042nb2s44</institution-id><institution>Department of Civil and Environmental Engineering, Massachusetts Institute of Technology</institution></institution-wrap><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02e3zdp86</institution-id><institution>Department of Biological Sciences, Boise State University</institution></institution-wrap><addr-line><named-content content-type="city">Boise</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Weigel</surname><given-names>Detlef</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0243gzr89</institution-id><institution>Max Planck Institute for Biology Tübingen</institution></institution-wrap><country>Germany</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Weigel</surname><given-names>Detlef</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0243gzr89</institution-id><institution>Max Planck Institute for Biology Tübingen</institution></institution-wrap><country>Germany</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>04</day><month>02</month><year>2022</year></pub-date><pub-date pub-type="collection"><year>2022</year></pub-date><volume>11</volume><elocation-id>e74987</elocation-id><history><date date-type="received" iso-8601-date="2021-10-25"><day>25</day><month>10</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2022-02-03"><day>03</day><month>02</month><year>2022</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2021-01-04"><day>04</day><month>01</month><year>2021</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2021.01.04.425224"/></event></pub-history><permissions><copyright-statement>© 2022, Goyal et al</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>Goyal et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-74987-v2.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-74987-figures-v2.pdf"/><abstract><p>Genomic data has revealed that genotypic variants of the same species, that is, strains, coexist and are abundant in natural microbial communities. However, it is not clear if strains are ecologically equivalent, and at what characteristic genetic distance they might exhibit distinct interactions and dynamics. Here, we address this problem by tracking 10 taxonomically diverse microbial communities from the pitcher plant <italic>Sarracenia purpurea</italic> in the laboratory for more than 300 generations. Using metagenomic sequencing, we reconstruct their dynamics over time and across scales, from distant phyla to closely related genotypes. We find that most strains are not ecologically equivalent and exhibit distinct dynamical patterns, often being significantly more correlated with strains from another species than their own. Although even a single mutation can affect laboratory strains, on average, natural strains typically decouple in their dynamics beyond a genetic distance of 100 base pairs. Using mathematical consumer-resource models, we show that these taxonomic patterns emerge naturally from ecological interactions between community members, but only if the interactions are coarse-grained at the level of strains, not species. Finally, by analyzing genomic differences between strains, we identify major functional hubs such as transporters, regulators, and carbohydrate-catabolizing enzymes, which might be the basis for strain-specific interactions. Our work suggests that fine-scale genetic differences in natural communities could be created and stabilized via the rapid diversification of ecological interactions between strains.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>eco-evolutionary</kwd><kwd>strains</kwd><kwd>biodiversity</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Other</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000936</institution-id><institution>Gordon and Betty Moore Foundation</institution></institution-wrap></funding-source><award-id>GBMF4513</award-id><principal-award-recipient><name><surname>Goyal</surname><given-names>Akshit</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution>Human Frontiers Science Program</institution></institution-wrap></funding-source><award-id>LT000643/2016-L</award-id><principal-award-recipient><name><surname>Leventhal</surname><given-names>Gabriel E</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000913</institution-id><institution>James S. McDonnell Foundation</institution></institution-wrap></funding-source><award-id>220020477</award-id><principal-award-recipient><name><surname>Bittleston</surname><given-names>Leonora S</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>1655983</award-id><principal-award-recipient><name><surname>Cordero</surname><given-names>Otto X</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000893</institution-id><institution>Simons Foundation</institution></institution-wrap></funding-source><award-id>542395</award-id><principal-award-recipient><name><surname>Cordero</surname><given-names>Otto X</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Rapidly diversifying biotic interactions decouple the dynamics of nearly identical strains.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>In nature, microbial communities contain individuals on a continuum of phylogenetic diversity, where both evolutionarily distant and proximate members coexist (<xref ref-type="bibr" rid="bib12">Ding et al., 2016</xref>; <xref ref-type="bibr" rid="bib16">Fierer et al., 2007</xref>). Members in the same communities can belong to different domains of life, such as archaea, bacteria, and fungi, and at the same time, can stably exist with extremely closely related relatives, a few single-nucleotide polymorphisms (SNPs) apart (<xref ref-type="bibr" rid="bib49">Schloissnig et al., 2013</xref>; <xref ref-type="bibr" rid="bib27">Han et al., 2014</xref>; <xref ref-type="bibr" rid="bib13">Faith et al., 2013</xref>; <xref ref-type="bibr" rid="bib33">Kashtan et al., 2014</xref>). Collectively, closely and distantly related community members perform many vital ecological functions such as the regulation of biogeochemical cycles and fiber digestion in animal guts (<xref ref-type="bibr" rid="bib48">Rousk and Bengtson, 2014</xref>; <xref ref-type="bibr" rid="bib8">David et al., 2014</xref>). However, identifying how these different levels of diversity interact and co-evolve in complex communities remains an elusive and challenging problem.</p><p>A common strategy to study this problem is to analyze the dynamics of complex communities at different levels of diversity with metagenomic sequence data. Such data have been successfully leveraged to reconstruct the linkage between polymorphic sites in natural microbial populations, effectively allowing one to resolve both species and strain abundances (<xref ref-type="bibr" rid="bib23">Good et al., 2017</xref>; <xref ref-type="bibr" rid="bib20">Garud et al., 2019</xref>; <xref ref-type="bibr" rid="bib44">Plucain et al., 2014</xref>; <xref ref-type="bibr" rid="bib18">Frenkel et al., 2015</xref>). With these data, we can ask the important question: which level of diversity—strains, species, genera, families (or even broader taxonomic units)—have the strongest interactions and influence on community dynamics? In other words, what is the appropriate level of coarse-graining to describe and predict microbial community dynamics? To illustrate, if interactions at the species level are conserved (similar) at lower levels (like strains), but not at higher levels (like genera or families), then a species-level description would be appropriate. However, if strains within species display distinct dynamics and interactions with strains of other species, then a coarse-grained, species-level description would not be appropriate to describe long-term dynamics. This question is hard to answer using natural systems such as mammalian guts since they are often far from equilibrium, where extrinsic factors like host control can be much stronger drivers of community dynamics than interactions between the community members themselves (<xref ref-type="bibr" rid="bib50">Spor et al., 2011</xref>). By domesticating natural communities in controlled laboratory conditions, however, we can study community dynamics near equilibrium (<xref ref-type="bibr" rid="bib17">Frazão et al., 2019</xref>). In such domesticated communities, we expect changes in community composition to be induced primarily by intrinsic factors such as biological interactions. Further, by studying multiple communities domesticated in parallel in the same abiotic environment, we can disentangle which observations about community dynamics are repeatable and general, and which ones are chance and context-specific.</p><p>Here, we show that strains—which are genetic variants of the same species—exhibit the strongest dynamical correlations across all taxonomic levels in microbial communities. These results stem from tracking 10 domesticated microbial communities from the pitcher plant <italic>Sarracenia purpurea</italic> for more than 300 generations. By analyzing dynamics at several phylogenetic levels, we show that community composition varies most strongly at the level of strains. Further, interactions within each community were strain-specific: at times decoupling the dynamics of one strain from its close relative. Remarkably, as few as 100 base pair differences across strain genomes (~99.99% similarity) were sufficient for strain dynamics to diverge from each other. Finally, we show that strains can differentiate by fine-tuning only a handful of functional categories in their genomes, such as transcriptional regulators, metabolite transporters, and tricarboxylic acid (TCA) cycle enzymes. Together, our results highlight that while broader taxonomic units like families may help predict community dynamics at short timescales, strains may be the relevant unit of taxonomic coarse-graining at which to study interactions and dynamics in microbiomes at longer timescales, not merely a descriptive detail.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Naturally occurring strains coexist for hundreds of generations in laboratory microcosms</title><p>We followed the eco-evolutionary dynamics of 10 replicate microbial communities derived from the carnivorous pitcher plant <italic>S. purpurea</italic> (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). We began by sampling communities from 10 distinct pitchers from plants belonging to the same bog, and after sampling, filtered out particles larger than 3 μm (to focus on bacteria). We then transferred and propagated each ecological replicate community separately through serial passaging in a medium consisting solely of acidified water and ground cricket powder as the nutrient source (see Materials and methods). This medium mimics, in part, the ecological conditions of the pitchers from which we derived these microbes.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Closely related strains coexist for hundreds of generations in pitcher plant-derived microbial communities.</title><p>(<bold>a</bold>) Diagram illustrating our experimental protocol. Stacked bar plots show the composition of one community (M06) at the amplicon sequence variant (ASV) (species) level sampled at each transfer; each color corresponds to a unique ASV that we tracked further using metagenomic sequencing, with their genera in the legend. (Illustration credit: Michelle Oraa Ali.) (<bold>b</bold>) Relative abundances of ASV27 (blue) and ASV14 (pink) with the approximate number of generations (see Materials and methods); the eight time points shown correspond to those for which we collected metagenomic data. (<bold>c</bold>) Relative abundances of strains identified in ASV27 and ASV14 using metagenomes. The shaded colors correspond to the abundance of each of the two strains. (<bold>d</bold>) Phylogenetic tree of the dominant strain-containing taxa across all 10 communities, with the identified genus names labeled. Brackets indicate the number of detected strains belonging to each genus. (<bold>e</bold>) Distribution of the genetic distance (divergence) between strains belonging to the same species, measured in the number of detected single-nucleotide polymorphisms (SNPs) differentiating them. (<bold>f</bold>) Bar plot showing the probability with which two members of the same taxonomic group (family, genus, species, etc.) co-occurred in a sample, normalized with a null model where all members were distributed randomly across communities. Dashed line indicates the null expectation.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Long-term species dynamics of all 10 experimental microbial communities.</title><p>Stacked bar plots show the composition of all 10 communities (M01–M10) at the amplicon sequence variant (ASV) (species) level sampled at each transfer; each color corresponds to a unique ASV that we tracked further using metagenomic sequencing.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig1-figsupp1-v2.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>Non-metric multidimensional scaling (NMDS) plot of community compositions at the species level.</title><p>Two-dimensional NMDS plot of the 16S community compositions (species level) using Bray–Curtis dissimilarity. Each point represents a community at a particular sequenced time points, and lines connect the same community at adjacent time points. Colors represent different communities (names labeled).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig1-figsupp2-v2.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 3.</label><caption><title>Most (&gt;99%) single-nucleotide polymorphisms (SNPs) are biallelic (have two alleles).</title><p>Histogram showing the fraction of SNPs corresponding to each species in each metagenomic sample for which we could detect only two alleles. The dashed line shows the mean fraction of SNPs that are biallelic (0.99).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig1-figsupp3-v2.tif"/></fig><fig id="fig1s4" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 4.</label><caption><title>Single-nucleotide polymorphism (SNP) trajectories within a species are highly correlated.</title><p>Histogram showing the distribution of the Pearson correlation coefficient between all pairs of SNP trajectories belonging to the same species in the same community, measured across all species and communities. The mean correlation between SNPs was 0.78.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig1-figsupp4-v2.tif"/></fig><fig id="fig1s5" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 5.</label><caption><title>Single-nucleotide polymorphisms (SNPs) within strains tightly cluster together.</title><p>Examples of allele frequency trajectories of SNPs belonging to the same species in the same community for amplicon sequence variant (ASV)1, belonging to the genus <italic>Aquitalea</italic>, in communities (<bold>a</bold>) M03 and (<bold>b</bold>) M01, respectively. SNP trajectories are colored and marked according to the cluster they were identified to be part of using <italic>k</italic>-means clustering (see Materials and methods). (<bold>a</bold>) shows an example where only one cluster was identified, whereas (<bold>b</bold>) shows an example of two clusters. SNP cluster 2 consisted of SNPs with an allele frequency near 1, and were therefore assumed to be shared between and common to both strains (but different from the reference genome; see Materials and methods).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig1-figsupp5-v2.tif"/></fig><fig id="fig1s6" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 6.</label><caption><title>Single-nucleotide polymorphism (SNP) clusters are robust to alternate clustering methods.</title><p>Examples of correlation matrices between SNP trajectories belonging to the same species in the same community for amplicon sequence variant (ASV)1, belonging to the genus <italic>Aquitalea</italic>, in communities (<bold>a</bold>) M03 and (<bold>b</bold>) M01, respectively. Each row and column represents a distinct SNP trajectory for that species, and colors represent the Pearson correlation coefficient between them. SNPs are ordered according to the clusters identified using a hierarchical clustering algorithm (see Materials and methods).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig1-figsupp6-v2.tif"/></fig><fig id="fig1s7" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 7.</label><caption><title>More examples of single-nucleotide polymorphism (SNP) clusters.</title><p>Examples of correlation matrices between SNP trajectories belonging to different species and communities across the dataset, specifically (<bold>a</bold>) amplicon sequence variant (ASV)31 from M02, (<bold>b</bold>) ASV15 from M09, and (<bold>c</bold>) ASV21 from M04, respectively. Each row and column represents a distinct SNP trajectory for that species, and colors represent the Pearson correlation coefficient between them. SNPs are ordered according to the clusters identified using a hierarchical clustering algorithm (see Materials and methods). (<bold>d</bold>) Histogram showing the number of correlated clusters identified using the unweighted pair group method with arithmetic mean (UPGMA) clustering method throughout all species in our dataset (see Materials and methods).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig1-figsupp7-v2.tif"/></fig><fig id="fig1s8" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 8.</label><caption><title>Changes in strain relative frequencies.</title><p>Distribution of the overall change in relative strain frequency between conspecific strains across all species in our communities. The overall change was measured as the difference between the maximum and minimum frequency of the major strain, where the major strain was defined as the one whose frequency was higher at the first metagenomic time point (~21 generations into the experiment). The distribution has been smoothened using Gaussian kernel density estimation.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig1-figsupp8-v2.tif"/></fig><fig id="fig1s9" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 9.</label><caption><title>Changes in strain frequencies often influence their overall species abundances.</title><p>Distribution of the eco-evolutionary influence between a species and its constituent strains across all communities (see supplementary text), measured as the magnitude of the correlation between the species’ relative abundance trajectory, and the relative frequency of its major strain. The red distribution shows the observed distribution while the gray distribution shows the expectation under a random shuffling of strains across species labels (see Materials and methods).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig1-figsupp9-v2.tif"/></fig><fig id="fig1s10" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 10.</label><caption><title>Distribution of correlations between species’ relative abundances inferred using read mapping and 16S rRNA sequencing.</title><p>Distribution of the correlations between the relative read abundance (fraction of shotgun metagenomic reads mapped to each species, after normalizing for genome length) with its relative abundance estimated independently using 16S rRNA sequencing.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig1-figsupp10-v2.tif"/></fig></fig-group><p>To stably maintain high diversity, we initially propagated communities at a low dilution factor (1:2) every 3 days for 21 transfers, during which they reached distinct, rich, and stable equilibria (<xref ref-type="fig" rid="fig1">Figure 1a</xref>; ecological dynamics studied in a previous publication [<xref ref-type="bibr" rid="bib3">Bittleston et al., 2020</xref>]). To study community dynamics over evolutionary timescales, we followed them using a similar protocol, but at a higher dilution factor (1:100) and less frequent transfer rate (every 7 days) for more than 300 generations (46 additional transfers). An increased dilution factor allowed a higher number of generations to pass between successive passages, and a weekly transfer rate made community propagation experimentally manageable over a full year. To resolve both coarse- (species) and fine (genotype)-scale dynamics, we performed 16S rRNA and deep metagenomic sequencing, respectively. Specifically, we used 16S rRNA sequencing to follow species composition (with species defined as having identical 16S rRNA); this gave us the ‘ecological’ dynamics of each community. Metagenomic sequencing, which we performed at eight evenly spaced time points between transfers 23 and 67, allowed us to follow ‘evolutionary,’ or genotype-level, changes in each community (<xref ref-type="fig" rid="fig1">Figure 1c</xref>). Together, this setup enabled us to track the eco-evolutionary dynamics of all 10 communities.</p><p>At the species level (variants with the same 16S rRNA sequence), the composition of each community fluctuated dynamically, but remained around the same equilibrium state for &gt;300 generations (<xref ref-type="fig" rid="fig1">Figure 1a</xref>; median ~31% temporal coefficient of variation in the abundance of a species, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>; and tightly clustered low-dimensional dynamics, <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). We hypothesized that the genetic variation occurring during the experiment, through mutations and recombination, might be responsible for these fluctuations. To test this, we mapped metagenomic reads from each sample to a database of 33 reference genomes belonging to isolates from our communities (see Materials and methods). To avoid sequencing-related artifacts, we ensured that read mapping was competitive, that is, we only used those sequenced reads that mapped unambiguously to one genome. Importantly, because our reference genomes belonged to isolates from our communities, any detected genetic variation indicated the presence of variants relative to a resident of these communities.</p><p>Most (97%) genetic changes were in the form of SNPs, an overwhelming majority (~98%) of which were detected in the first sequenced time point (~23 generations). This suggested that the communities had significant preexisting, or standing, genetic variation. Given the large degree of divergence (~1% genome-wide divergence for some pairs; <xref ref-type="fig" rid="fig1">Figure 1e</xref>) and estimated divergence time based on bacterial mutation rates (~100 generations to diverge by one SNP; see Materials and methods), the preexisting variation likely came from genetic variants in the plants rather than from variants arising during the first 23 generations of lab propagation. Interestingly, the large divergence times of the genetic variants (~100 s of years) were much larger than the age of the pitchers we sampled (~3 months; see Materials and methods). This suggested that the preexisting variants represented different isolates (or strains) that had arrived in the pitchers through separate colonization events rather than having diversified within a pitcher during its lifetime. Therefore, we rejected our original hypothesis that mutations and recombination occurring during the experiment were the main driver of community dynamics. Instead, we focused on the dynamics of preexisting variants. Almost all (~99%) SNPs were biallelic (had only two variants; <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>), which allowed us to track variant dynamics in terms of the temporal trajectory of each SNP.</p><p>The temporal trajectories of SNPs in the same reference genome (species) were highly correlated, with their allele frequencies increasing and decreasing together (mean correlation coefficient 0.8; p&lt;0.01; <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>). Such highly correlated allele frequency trajectories are hallmarks of genetic linkage (<xref ref-type="bibr" rid="bib23">Good et al., 2017</xref>; <xref ref-type="bibr" rid="bib47">Roodgar et al., 2009</xref>) and suggest that the large number of SNPs in each species were co-localized in a small number of genotypes or strains. We clustered the allele frequency trajectories and could statistically detect at most two strains for each species (see Materials and methods and <xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5</xref>). For each cluster (strain), we estimated its frequency within the whole community as the fraction of the species’ abundance that corresponded to the strain (see Materials and methods). We calculated the relative abundance of each strain by multiplying its frequency with the relative abundance of the species it belonged to. Together, we concluded that within each community there was a pair of strains underlying most taxa, including the phylogenetically diverse <italic>Elizabethkingia</italic>, <italic>Aquitalea</italic>, and <italic>Delftia</italic> (<xref ref-type="fig" rid="fig1">Figure 1d</xref>). Within each species, strain dynamics displayed vastly different patterns. For some species, only one of the strains changed appreciably in abundance over the experiment (<xref ref-type="fig" rid="fig1">Figure 1c</xref>, top; <italic>Xylophilus</italic> sp<italic>.</italic>). For other species, both strains fluctuated constantly throughout the experiment (<xref ref-type="fig" rid="fig1">Figure 1c</xref>, bottom; <italic>Pseudomonas</italic> sp<italic>.</italic>). From an evolutionary standpoint, we observed a roughly bimodal distribution of the overall change in strain frequencies across different species in our communities (<xref ref-type="fig" rid="fig1s8">Figure 1—figure supplement 8</xref>, <xref ref-type="fig" rid="fig1s9">Figure 1—figure supplement 9</xref>). In some cases, the abundance of a species stayed relatively constant while the strains comprising it fluctuated relatively, similar to what has been observed in other systems such as the human gut (<xref ref-type="bibr" rid="bib20">Garud et al., 2019</xref>; <xref ref-type="bibr" rid="bib47">Roodgar et al., 2009</xref>; <xref ref-type="bibr" rid="bib57">Zhao et al., 2019</xref>).</p><p>Since we observed different conspecific strains in different communities, we next asked at which phylogenetic level the 10 replicate communities were most variable at, that is, strains, species, genera, or families. For this, we calculated the probability that two members of the same taxonomic group (family, genus, species, etc.) co-occurred in a sample, normalized against a null model where all members were distributed randomly across communities (see Materials and methods). We found that community composition across all 10 replicates was much more variable at the level of strains than species (<xref ref-type="fig" rid="fig1">Figure 1f</xref>). This result is consistent with previous work that natural microbial communities are taxonomically variable at finer phylogenetic levels (strains and species), but more similar at coarser levels (families) (<xref ref-type="bibr" rid="bib22">Goldford et al., 2018</xref>; <xref ref-type="bibr" rid="bib37">Louca et al., 2016</xref>). Together, we concluded that natural strains of the same species can coexist in microbial communities over hundreds of generations, maintaining the communities in distinct stable states.</p></sec><sec id="s2-2"><title>Highly related strains can decouple in their dynamics</title><p>Motivated by the observation that closely related strains persisted in communities, we asked whether the dynamics of each strain were similar, or coupled, to that of their closest relatives. To answer this question, we measured a strain–strain coupling for strains of the same species, defined as the correlation between their abundance trajectories (<xref ref-type="fig" rid="fig2">Figure 2a</xref> and Materials and methods). Strain dynamics could either be highly correlated (‘coupled strains,’ <xref ref-type="fig" rid="fig2">Figure 2a</xref>) or be uncorrelated (‘decoupled strains’). Measuring strain–strain coupling for each species across all 10 communities revealed a bimodal distribution, whose two modes were occupied by highly correlated and uncorrelated strain pairs, respectively (<xref ref-type="fig" rid="fig2">Figure 2b</xref>). The shape of this distribution allowed us to reliably classify strain pairs as either decoupled (coupling &lt;0.4, the inflection point of the distribution; see Materials and methods) or coupled (coupling &gt;0.4). A null model with no ecological differences between conspecific strains instead showed a unimodal distribution of coupling (mean coupling 0.95, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref> and Materials and methods). This control suggested that the observed incidences of strain decoupling were much higher than expected simply by chance (p&lt;10<sup>–3</sup>; Kolmogorov–Smirnov test). We thus concluded that ~20% of conspecific strains, belonging to the same species, displayed rather dissimilar or decoupled dynamics.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Even highly related strains (~100 single-nucleotide polymorphisms [SNPs] apart) can decouple in their dynamics.</title><p>(<bold>a</bold>) Schematic showing examples of strain–strain coupling. We defined strain–strain coupling as the temporal correlation between strain abundances belonging to the same species in a community; coupled strains (left) had highly correlated abundances while decoupled strains (right) were uncorrelated. (<bold>b</bold>) Distribution of the strain–strain coupling across all species and communities, smoothed using Gaussian kernel density estimation; dashed line shows the threshold coupling used to classify strains as coupled and decoupled (see Materials and methods). (<bold>c</bold>) Strain–strain coupling as a function of the genetic distance between strains. Each gray point represents a conspecific strain pair. The solid red line shows a moving average (LOESS fit). (<bold>d</bold>) Relative abundance of the species labeled ASV14 of the genus <italic>Pseudomonas</italic> in community M03, and its underlying strains over time; the blue shaded region represents strain 1 while the green region represents strain 2. The solid blue line shows the total species abundance. (<bold>e</bold>) Bar plot showing the number and genetic location of SNPs in the core genome of ASV31 from community M04, whose strains were decoupled and differed by 186 SNPs. Each bar shows the number of SNPs in one gene along with its annotation. Only SNPs belonging to annotated genes are shown.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Null distribution of strain–strain coupling from a consumer-resource model with no differences between conspecific strains.</title><p>Distribution of the strain–strain coupling across all species and communities (similar to <xref ref-type="fig" rid="fig2">Figure 2b</xref>) but using trajectories generated from our second consumer-resource model, where strains are ecologically identical, and minor stochastic fluctuations (with mean 0% and variance 5%) change the relative frequency between strains. This null distribution estimates the chance of ecologically identical conspecifics appearing to be decoupled by chance.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Strain–strain coupling distribution is robust to using an alternate measure.</title><p>Distribution of the strain–strain coupling across all species and communities (similar to <xref ref-type="fig" rid="fig2">Figure 2b</xref>) but measured using the nonparametric Spearman correlation coefficient (see Materials and methods); dashed line shows the internal inflection point of the distribution, separating decoupled and coupled strains.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig2-figsupp2-v2.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Distribution of strain–strain coupling with the sign of the correlation.</title><p>Distribution of the strain–strain coupling across all species and communities (similar to <xref ref-type="fig" rid="fig2">Figure 2b</xref>) but with the sign of the Pearson correlation coefficient, rather than the magnitude (see Materials and methods). Most correlations were positive, and there were no negative correlations of large magnitude.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig2-figsupp3-v2.tif"/></fig></fig-group><p>To test if the genetic distance between strains influenced their strain–strain coupling, we plotted the average coupling as a function of the genetic distance between a conspecific strain pair (see Materials and methods). Remarkably, the average strain–strain coupling decreased sharply beyond a genetic distance of just about 100 SNPs (<xref ref-type="fig" rid="fig2">Figure 2c</xref>). This suggested that changes in as few as 100 bps, corresponding to roughly 0.01% of these genomes, were sufficient to decouple strain dynamics. A consequence of such decoupling was that in species with decoupled strains drastic changes in the species’ abundance were driven only by changes in one of the strains (<xref ref-type="fig" rid="fig1">Figure 1c</xref> and <xref ref-type="fig" rid="fig2">Figure 2d</xref>, top).</p><p>To understand the genomic signatures of strain decoupling, we examined the location and putative function of SNPs in a pair of highly related but decoupled strains (see Materials and methods). To serve as an illustration, we chose the <italic>Delftia</italic> genome in community M04, which had the fewest (186) SNPs among its decoupled strains, which shed light on which functions may be associated with decoupling. The SNPs differentiating these strains were scattered throughout the core genome, with 62% in the coding regions of genes with known functional annotations. Broadly, these genes corresponded to transcriptional regulators such as <italic>gbdR</italic>, transmembrane proteins such as the nitrate transporter <italic>nitT</italic>, and enzymes implicated in central carbon metabolism, such as <italic>aceE</italic>, <italic>murA,</italic> and <italic>ppsA</italic> (<xref ref-type="fig" rid="fig2">Figure 2e</xref>). The <italic>gbdR</italic> protein is a known transcriptional regulator of amino acid metabolism, glycine betaine catabolism, as well as phosphatase activity in bacteria, and may play a role in differentiating metabolic flux balance between strains (<xref ref-type="bibr" rid="bib56">Wargo et al., 2008</xref>). The <italic>nitT</italic> protein is a member of the major facilitator superfamily (MFS) and a transporter that controls the uptake of nitrate available in the environment (<xref ref-type="bibr" rid="bib38">Maeda and Omata, 1997</xref>). Finally, <italic>ppsA</italic> and <italic>murA</italic> are enzymes that metabolize pyruvate and its derivatives, and may determine how strains catabolize metabolic intermediates before they enter the TCA cycle (<xref ref-type="bibr" rid="bib40">Mikkelsen et al., 2004</xref>; <xref ref-type="bibr" rid="bib39">Marquardt et al., 1992</xref>). Together, this evidence suggests that diversifying in a handful of functional categories is sufficient for strains to decouple in their ecological dynamics.</p></sec><sec id="s2-3"><title>Dynamical correlations suggest that interactions are strain-specific</title><p>Equipped with the understanding that conspecific strains could display decoupled dynamics, we asked which ecological factors were responsible for the observed differences in strain dynamics. Our experimental setup explicitly controlled for abiotic ecological factors since all communities were grown in the same environmental conditions. Therefore, any dynamical differences between strains must have emerged as a result of biotic factors, such as ecological interactions. To detect and measure interactions between community members, we exploited the fact that all 10 communities were at equilibrium (median ~31% temporal coefficient of variation in the abundance of a species; <xref ref-type="fig" rid="fig1">Figure 1a</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>, <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). In a controlled environment, interactions between community members at equilibrium are expected to induce temporal correlations between their abundances (<xref ref-type="bibr" rid="bib15">Faust et al., 2015</xref>; <xref ref-type="bibr" rid="bib53">Tikhonov et al., 2015</xref>; <xref ref-type="bibr" rid="bib14">Faust and Raes, 2012</xref>). In contrast, we expect almost no correlations if all abundance fluctuations are purely stochastic (due to neutral drift) (<xref ref-type="bibr" rid="bib29">Hubbell, 2001</xref>; <xref ref-type="bibr" rid="bib11">Descheemaeker and de Buyl, 2020</xref>; <xref ref-type="bibr" rid="bib26">Grilli, 2020</xref>; <xref ref-type="bibr" rid="bib46">Ramsayer et al., 2012</xref>). Motivated by this logic, we measured dynamical correlations between the abundance trajectories of pairs of community members.</p><p>To determine which level of taxonomy (strains or species) had the strongest interactions, we compared the strength of correlations between the two levels of taxonomic grouping. Specifically, at the species level, we measured a species–species correlation between each co-occurring species pair as the magnitude of the correlation between the relative abundances that pair (<xref ref-type="fig" rid="fig3">Figure 3a</xref>). At the strain level, we only measured correlations between strain pairs belonging to different species, not between conspecifics (which we had already measured in <xref ref-type="fig" rid="fig2">Figure 2a–c</xref>). To compare strain correlations with their corresponding species correlations, we measured a strain–strain correlation between each species pair; we used the correlation with the highest magnitude among all four possible pairs as the strongest strain pair for a given species pair (<xref ref-type="fig" rid="fig3">Figure 3a</xref> and Materials and methods).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Community interactions are strain-specific.</title><p>(<bold>a</bold>) Schematic showing how we measured dynamical correlations at the strain and species level for a species pair <italic>A</italic> and <italic>B</italic>. For any species pair, we defined strain–strain correlations as the highest magnitude of correlation among all four strain pairs from different species (left), never the same species. The species–species correlation for the same pair was simply the correlation between the two species (right). (<bold>b</bold>) Scatter plot of the dynamical correlation between species in a community and the highest correlation between their corresponding strain pairs. Each point represents one species in one of the 10 communities. The shaded region indicates strain–strain correlations higher than species–species correlations. Inset shows a pie chart of the fraction of points supporting higher strain-level interactions (76%) versus species-level interactions (24%). Triangle indicates a pair of <italic>Achromobacter</italic> (red) and <italic>Delftia</italic> (blue) species, shown in (<bold>c</bold>). Top: relative abundance plots of two uncorrelated species measured over the experiment. Bottom: relative abundances of the minor strains for the same species, which are strongly negatively correlated. (<bold>d, e</bold>) Schematics of our models showing how species are split into strains, with tunable differences in their consumption rates for each resource, as well as the serial dilution protocol that we simulate, where we slightly change the growth medium from transfer to transfer. (<bold>f, g</bold>) Scatter plots of the expected dynamical correlations using our models, (<bold>f</bold>) where strains are ecologically distinct (hypothesis 1) and (<bold>g</bold>) identical (hypothesis 2), similar to (<bold>b</bold>). Schematics of the consumption rate matrices for both models (hypotheses) are also shown.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Null model where we shuffled species–strain associations does not show the observed strain specificity.</title><p>Scatter plot of the dynamical correlation between species in a community and the highest correlation between their corresponding strain pairs (similar to <xref ref-type="fig" rid="fig3">Figure 3b</xref>) but with species and strain associations shuffled within a community (see Materials and methods). Each point represents one species in one of the 10 communities, but is composed of two randomly chosen and unrelated strains from the community. Doing so results in a much lower fraction of correlations that are higher for strains (in this example, 62%, compared with 76% for real data; mean shuffled data fraction was 64%). The probability of observing a fraction greater than or equal to the observed fraction in <xref ref-type="fig" rid="fig3">Figure 3b</xref> by removing any species–strain associations was less than 0.1% (p&lt;10<sup>–3</sup>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Dynamical correlations between species and strains do not cluster by community identity.</title><p>Scatter plot of the dynamical correlation between species in a community and the highest correlation between their corresponding strain pairs (similar to <xref ref-type="fig" rid="fig3">Figure 3b</xref>) but with strain pairs being colored by the community ID (1–10) in which they were detected. Each point represents one species in one of the 10 communities. Species do not cluster by community ID on this scatter plot, suggesting that there are no systematic differences from one community to another.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig3-figsupp2-v2.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 3.</label><caption><title>Strain-specific interactions are stronger even when estimating abundances purely from metagenomic reads.</title><p>Scatter plot of the dynamical correlation between species in a community and the highest correlation between their corresponding strain pairs (similar to <xref ref-type="fig" rid="fig3">Figure 3b</xref>) but with species abundances estimated using metagenomic reads, not 16S reads (see Materials and methods). Each point represents one species in one of the 10 communities. Similar to the fraction of strain-specific interactions observed in <xref ref-type="fig" rid="fig3">Figure 3b</xref> (76%), we see a large fraction of interaction strengths (78%) skewed towards strains.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig3-figsupp3-v2.tif"/></fig><fig id="fig3s4" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 4.</label><caption><title>Strain-specific interactions are stronger even when using an alternate measure.</title><p>Scatter plot of the dynamical correlation between species in a community and the highest correlation between their corresponding strain pairs (similar to <xref ref-type="fig" rid="fig3">Figure 3b</xref>) but correlations measured using the nonparametric Spearman correlation coefficient (see Materials and methods). Each point represents one species in one of the 10 communities. Similar to the fraction of strain-specific interactions observed in <xref ref-type="fig" rid="fig3">Figure 3b</xref> (76%), we see a large fraction of interaction strengths (80%) skewed towards strains.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig3-figsupp4-v2.tif"/></fig><fig id="fig3s5" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 5.</label><caption><title>Interaction networks inferred at the level of species and strains.</title><p>Interaction networks inferred using dynamical correlations from community M07, measured at the species (left) and strain level (right) (see supplementary text and Materials and methods). Each node represents a species (left) or strain (right), and link indicates the presence of a detected interaction; Ac: <italic>Achromobacter</italic>; Pe: <italic>Pedobacter</italic>; Ps: <italic>Pseudomonas</italic>; Aq: <italic>Aquitalea</italic>; Sp: <italic>Sphingomonas</italic>; Rh: <italic>Rhodobacter</italic>; Xy: <italic>Xylophilus</italic>; De: <italic>Delftia</italic>; Br: <italic>Brevundimonas</italic>; Bo: <italic>Bosea</italic>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig3-figsupp5-v2.tif"/></fig><fig id="fig3s6" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 6.</label><caption><title>Examples of shuffled cases where species correlations are higher than strain correlations.</title><p>(<bold>a, b</bold>) Top: relative abundance time-series plots of two correlated species (one each in <bold>a</bold> and <bold>b</bold>) obtained from the shuffling analysis (see Materials and methods). Bottom: relative abundances of each of the species, with its underlying mock strains shown. Each shaded region represents the abundance of one of the strains. In the cases shown, the underlying strains have lower interspecific strain correlations than the species correlations themselves.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig3-figsupp6-v2.tif"/></fig><fig id="fig3s7" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 7.</label><caption><title>Model recapitulates distance-dependent strain decoupling.</title><p>Strain–strain coupling as a function of the competitive distance, <italic>D</italic>, between strains, in the first consumer-resource model, where strains are ecologically distinct (see Materials and methods). Each gray point represents a conspecific strain pair obtained from simulations of the model. The solid red line shows a moving average (LOESS fit).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig3-figsupp7-v2.tif"/></fig><fig id="fig3s8" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 8.</label><caption><title>Geometric interpretation of strain–strain and species–species correlations in our models.</title><p>(<bold>a</bold>) Schematic showing the phenotypes (e.g., resource consumption rates) of strains belonging to two different species, <italic>A</italic> (green) and <italic>B</italic> (red), generated by our first consumer-resource model, where strains are ecologically distinct, a distance <italic>D</italic> apart in phenotypic space. Each point represents the consumption rate of a particular strain on three hypothetical resources, shown on a triangular simplex. The effective species consumption rates (obtained by coalescing the two conspecific strains) are shown as pointed shapes with the species’ color. In our space, the average distance between species is normalized to 1. (<bold>b</bold>) When <italic>D</italic> is small (~0.1), a pair of interspecific strains can often be closer to each other, and hence more correlated, than the corresponding species themselves (<xref ref-type="fig" rid="fig3s7">Figure 3—figure supplement 7</xref> shows that distance is a proxy for dynamical correlations). (<bold>c</bold>) When <italic>D</italic> is large (~1), the effective species can instead be closer than any of the interspecific strains, leading to higher species–species correlations.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig3-figsupp8-v2.tif"/></fig></fig-group><p>Remarkably, we found that in the majority of comparisons (76%), at least one pair of strains from two different species was more strongly correlated than the corresponding species themselves (<xref ref-type="fig" rid="fig3">Figure 3b</xref>, <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>, <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>; p&lt;10<sup>–6</sup>, Wilcoxon signed-rank test adjusted for multiple comparisons). In most cases, even when both strain- and species-level correlations were high, the values of at least one pair of strain correlations were often higher, on average being larger by 0.17 ± 0.01 (one-sample Student’s <italic>t</italic>-test, p&lt;10<sup>–3</sup>). To test if this result could arise purely because we compared four pairs of strains for each pair of species, we used a null model in which strains were randomly sampled from the dataset and combined into new mock ‘species’ (see Materials and methods). This shuffling coalesced unrelated pairs of strains, but preserved the bias in the number of comparisons performed and the abundance data themselves, and revealed that the observed high fraction of strain-dominant interactions was not a statistical artifact (p&lt;10<sup>–3</sup>, permutation test; <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>, <xref ref-type="fig" rid="fig3s6">Figure 3—figure supplement 6</xref>). Additionally, interaction networks were, on average, 30% denser at the strain level than the species level (<xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5</xref> and supplementary text). Finally, in 7% of cases, our analysis revealed so-called ‘hidden’ interactions, masked at the species level but visible with strains. In these cases, while there was virtually no correlation between species dynamics (<xref ref-type="fig" rid="fig3">Figure 3c</xref>; Pearson correlation 0.02, p=0.9), the dynamics of their minor strains were strongly correlated (<xref ref-type="fig" rid="fig3">Figure 3c</xref>; Pearson correlation – 0.71, p&lt;0.01, after a Benjamini–Hochberg correction). These results suggest that coarse-graining communities beyond strains, say into species, decreases dynamical correlations. Strains of the same species often correlate more strongly with strains of another species than with their own conspecifics. One reason for this may be that conspecific strains interact differently with the same community members, making community interactions strain-specific.</p></sec><sec id="s2-4"><title>Minimal models support strain-specific, not species-specific, interactions</title><p>Two different hypotheses could potentially explain the observation that strain correlations are typically higher than the corresponding species correlations. First, conspecific strains have different interactions, and the increased strain correlations point to systematic differences in, say, the metabolic abilities of conspecific strains. Second, interactions are conserved at the species level (strains are ecologically equivalent, i.e., phenotypically identical), but the increased strain correlations arise from a combination of stochastic effects, such as a higher number of comparisons, measurement noise, and abundance fluctuations within species.</p><p>To compare the dynamical patterns expected under both hypotheses, we simulated community dynamics under two scenarios using two minimal consumer-resource models where interactions were mediated by resource competition. In the first model, strains were phenotypically distinct (hypothesis 1; <xref ref-type="fig" rid="fig3">Figure 3f</xref>), while in the second, strains were phenotypically identical (hypothesis 2; <xref ref-type="fig" rid="fig3">Figure 3g</xref>). In both models, we simulated the assembly of 10 independent communities under serial propagation in the same environment (see Materials and methods). To model abundance fluctuations, we introduced minor variations in the proportion of resources supplied during each transfer (<xref ref-type="fig" rid="fig3">Figure 3e</xref>). We encoded competitive interactions through a matrix of resource consumption rates; the difference between the rates of two taxa (hereafter referred to as <italic>D</italic>) inversely controlled the strength of competition between them (<xref ref-type="fig" rid="fig3">Figure 3d</xref>). In the first model, each conspecific pair had a different set of consumption rates, tuned by the ‘competitive distances’ <italic>D</italic> between them (<xref ref-type="fig" rid="fig3">Figure 3f</xref>). In the second model, interactions were instead species-specific, that is, both conspecific strains had identical consumption rates (<italic>D</italic> = 0), with stochastic fluctuations being the only way to alter their frequencies relative to each other (<xref ref-type="fig" rid="fig3">Figure 3g</xref>).</p><p>Remarkably, only one of the models, where conspecific strains have different interactions, produced patterns that were consistent with the data (78% strain correlations greater than species correlations; <xref ref-type="fig" rid="fig3">Figure 3f</xref>). The alternate model, with phenotypically identical strain interactions, produced strain correlations that were greater in only 19% of simulated species (<xref ref-type="fig" rid="fig3">Figure 3g</xref>). Encouragingly, strain–strain correlations produced by the first model could also recapitulate the decoupling between conspecifics beyond a characteristic phenotypic distance (<xref ref-type="fig" rid="fig3s7">Figure 3—figure supplement 7</xref>), consistent with our experimental observation of strain decoupling beyond a characteristic genetic distance (<xref ref-type="fig" rid="fig2">Figure 2c</xref>). We will provide a geometric intuition for this later in the article (Figure 5; <xref ref-type="fig" rid="fig3s8">Figure 3—figure supplement 8</xref>). Together, our results show that the patterns observed in the data are consistent with a model in which resource-mediated interactions are stronger between strains, not species.</p></sec><sec id="s2-5"><title>Genetic variation in transporters, regulators, and pseudogenes differentiates strains</title><p>We finally asked what differentiated strains at the genomic level—in particular, at the level of the core genome, where SNPs can be reliably identified. We had already explored a specific example while studying decoupled strains (<xref ref-type="fig" rid="fig2">Figure 2e</xref>); we now asked for more general features that differentiated coexisting strains. Most (97%) of the differences between strains in their core genomes were in the form of SNPs; the remaining 3% constituted insertions and deletions (average 4 bp per event; see Materials and methods). We had only one reference genome for each ASV, thus we could not detect changes in the flexible genome, such as gene gains in a specific strain. For all 163 strains, there was no significant bias in the distribution of SNPs between coding and non-coding regions, implying that most (&gt;80%) of the SNPs were found in the coding regions (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>).</p><p>We next asked which functional categories of genes were enriched in strain-differentiating SNPs. For this, we performed a broad categorical analysis, giving us a bird’s eye view of the cellular functions likely to be variable in strains (we used annotations and categories from the KEGG database, respectively; see Materials and methods) (<xref ref-type="bibr" rid="bib31">Kanehisa et al., 2017</xref>). Four major functional categories differentiating strains emerged: (1) two-component systems, (2) enzymes involved in carbon metabolism, (3) transcription factors, and (4) transporters (<xref ref-type="fig" rid="fig4">Figure 4a</xref>). To get a closer look at specific examples of pathways affected by each of these four categories, we examined ASV11, belonging to the genus <italic>Aquitalea</italic> in M04, which contained SNPs in genes from all four categories (<xref ref-type="fig" rid="fig4">Figure 4b</xref>; <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>). For two-component systems, we found the <italic>dctD</italic> protein, which, along with <italic>dctB</italic>, regulates the uptake of C4-dicarboxylates such as aspartate, malate, fumarate, and succinate (<xref ref-type="bibr" rid="bib43">Park et al., 2002</xref>). The enzyme <italic>korB</italic> is an oxidoreductase, known to decarboxylate 2-oxoglutarate, a key intermediate in the TCA cycle (<xref ref-type="bibr" rid="bib52">Tersteegen et al., 1997</xref>). The transcription factor <italic>phnF</italic> represses the <italic>phnCDE</italic> operon and regulates the biosynthesis of amino acids such as glutamate (<xref ref-type="bibr" rid="bib1">Aravind and Anantharaman, 2003</xref>). Finally, we found many diverse sugar and amino acid transporters (of the ABC and MFS families), ion transporters like <italic>corA</italic> (<xref ref-type="bibr" rid="bib42">Papp-Wallace and Maguire, 2007</xref>), as well as <italic>iutA</italic>, which mediates siderophore uptake and competition for iron in bacteria (<xref ref-type="fig" rid="fig4">Figure 4b</xref>; <xref ref-type="bibr" rid="bib34">Krewulak and Vogel, 2008</xref>). Many of these functional categories were specific to the coexisting strains in our communities, and not generic differences between members of the same taxa (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> and Materials and methods). These examples typify some key functional signatures that differentiate strains and suggest that variation in transporters, regulators, and enzymes in central carbon metabolism may be the basis for strain-specific ecological interactions, for example, by separating the metabolic niches of strains, as in our models.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Genetic variation in regulators, transporters, and pseudogenes differentiates strains.</title><p>(<bold>a</bold>) Bar plot showing the four functional categories of genes most enriched in strain-differentiating single-nucleotide polymorphisms (SNPs). The x-axis represents the mean number of SNPs belonging to the category in a strain pair. (<bold>b</bold>) Table showing an example of a gene in each functional category identified in (<bold>a</bold>); the middle column shows a schematic of the gene with its name (italics). (<bold>c</bold>) The average number of pseudogenes detected in strains per strain as a function of time. The solid line shows a linear regression, whose intercept shows the number of pseudogenes detected at the first sequenced time point; the shaded region represents the standard error of the mean (s.e.m.). (<bold>d</bold>) Bar plot showing the two functional categories most enriched in strain-differentiating pseudogenes. The x-axis represents the median number of genes belonging to the category in a strain pair. (<bold>e</bold>) Bar plot showing the mean pN/pS of mutations detected in pseudogenes (red) and all other strain-differentiating genes (gray). Dashed line represents the expected pN/pS under a neutral model. All error bars represent s.e.m.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Most single-nucleotide polymorphisms (SNPs) that differentiate strains are in the coding regions.</title><p>Stacked bar plots showing the distribution of genetic differences between strains in our communities (left) and variants in the <italic>Escherichia coli</italic> long-term evolution experiment after 60,000 generations (LTEE) (data from <xref ref-type="bibr" rid="bib23">Good et al., 2017</xref>). The top stack shows all multiple nucleotide polymorphisms (MNPs) and insertions–deletions (indels); the middle stack shows the SNPs in noncoding regions of strain genomes, and the bottom stack shows SNPs in the coding regions.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig4-figsupp1-v2.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>Mutations accumulate at a similar rate in both pseudogenes and other genes.</title><p>Bar plots showing the average number of mutations detected in a pseudogene (left) and any other gene (right) in strains within our 10 communities. The number of mutations was measured per gene per time point to correspond to a rate of mutation accumulation per gene per time point. (Each time point corresponds to about 40 microbial generations.) Error bars show standard error of the mean (s.e.m.). n.s. indicates that there was no significant difference in mutation rate between pseudogenes and other genes (p&gt;0.05, according to a two-sample Student’s <italic>t</italic>-test).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig4-figsupp2-v2.tif"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 3.</label><caption><title>Functional differences enriched in single-nucleotide polymorphisms (SNPs) differentiating strains of <italic>Aquitalea magnusonii</italic> from the NCBI GenBank database.</title><p>Bar plot showing the four functional categories of genes most enriched in strain-differentiating SNPs from random strains of the species <italic>Aquitalea magnusonii</italic>, derived from the NCBI GenBank database (see Materials and methods). The x-axis represents the mean number of SNPs belonging to the category in a strain pair.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig4-figsupp3-v2.tif"/></fig><fig id="fig4s4" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 4.</label><caption><title>Dynamics of a de novo loss-of-function (pseudogenizing) mutation.</title><p>Time course of single-nucleotide polymorphisms (SNPs) in a <italic>Pseudomonas</italic> species from community M05, where we observe a new loss-of-function mutation (red) appearing at the fourth time point (zero frequency at the first three time points). All other SNPs detected in the species are shown in gray.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig4-figsupp4-v2.tif"/></fig></fig-group><p>Another key genomic signature was the presence of several strain-specific pseudogenes in strain genomes. Pseudogenes are genes that contain a premature stop codon and are not expected to produce functional proteins (<xref ref-type="bibr" rid="bib2">Balakirev and Ayala, 2003</xref>). Conspecific strains differed from each other not just by mutations, but also by differential pseudogenization. Not only did one of the two conspecific strains in each pair have several (~5) pseudogenes at the first time point (~23 generations), but we could detect new pseudogenes being generated throughout the experiment (<xref ref-type="fig" rid="fig4">Figure 4c</xref>, <xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>; see Materials and methods for how we detected pseudogenes and assigned them to strains). This suggested that pseudogenization was both extensive and rampant during community evolution. Pseudogenes that differentiated conspecific strains were enriched in two functional categories: (1) motility proteins such as <italic>cheA</italic>, responsible for chemotaxis (<xref ref-type="bibr" rid="bib32">Karatan et al., 2001</xref>), and (2) phage proteins such as <italic>fii</italic> and <italic>gpdD</italic>, known to constitute viral tails (<xref ref-type="fig" rid="fig4">Figure 4d</xref>; <xref ref-type="bibr" rid="bib51">Temple et al., 1991</xref>). Functions such as chemotaxis and structural viral proteins are not expected to be advantageous for bacterial growth in the environmental conditions of our experiment, and are thus likely to face weak, or no, selection. Indeed, while pseudogenes did not accumulate mutations faster than other genes (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>), their mutational profile had a pN/pS ~ 1, consistent with neutral evolution (<xref ref-type="fig" rid="fig4">Figure 4e</xref>). In contrast, other genes showed signatures of purifying selection, with a pN/pS ~ 0.2, significantly lower than 1 (<xref ref-type="fig" rid="fig4">Figure 4e</xref>). The rampant pseudogenization observed in our communities suggests that evolution tends to deactivate genes that do not contribute to fitness, such as chemotaxis and viral genes in stable, well-mixed environments. The end products of such nonfunctional pseudogenization and functional genomic variation may lead to further phenotypic differences between strains, allowing even highly related strains to show decoupled dynamics.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Understanding the role of strains in microbiomes is crucial to the study of microbial ecology and evolution (<xref ref-type="bibr" rid="bib54">Van Rossum et al., 2020</xref>). Here, we addressed this question by propagating microbial communities from pitcher plants for more than 300 generations. We found that strains that were preexisting genetic variants belonging to the same species were the key determinants of long-term community dynamics. Differing by between 1 and ~10,000 SNPs, strains imparted both compositional and dynamical variability to communities. Compositionally, we found that communities were most variable in terms of strains, with each community carrying a unique set of strains even when they carried the same species. This variability was likely the result of two chance events: stochastic sampling and laboratory selection. Dynamically, once the communities settled into unique equilibria, we found that the dynamics of even extremely closely related strains, with as few as 100 SNPs, could be decoupled from each other. Even when a species’ abundance appeared relatively stable over time, strains comprising it could be highly dynamic. Such strains were temporally correlated with other strains belonging to different species. Mathematical consumer-resource models capturing our experiment suggested that these observations and patterns were consistent with resource-mediated competitive interactions between strains, not species.</p><p>Our observation that correlated fluctuations among existing strains dominate evolutionary dynamics is perhaps somewhat different from one’s naïve expectation, anticipating new mutations and recombination events to be the dominant forces driving evolution within communities (<xref ref-type="bibr" rid="bib44">Plucain et al., 2014</xref>). Once our communities reached a stable equilibrium, their evolution was marked by the dynamics of the preexisting strains, which could stably coexist for hundreds of generations. Thus, in both cases, either by mutation and recombination (in single-species laboratory evolution) or by assembly (in complex communities as in this article), the dynamics of populations are determined by the ecological interactions between fine-scale genetic variants, or strains (<xref ref-type="bibr" rid="bib23">Good et al., 2017</xref>; <xref ref-type="bibr" rid="bib47">Roodgar et al., 2009</xref>). Moreover, in both cases, the interactions between strains are likely resource-mediated since the genetic differences between ecologically divergent strains are concentrated in metabolic genes (<xref ref-type="bibr" rid="bib44">Plucain et al., 2014</xref>). Taken together, these results suggest a striking parallel between the eco-evolutionary dynamics of both isogenic populations as well as complex communities.</p><p>The patterns we observed, such as conspecific strain decoupling and higher strain correlations beyond species boundaries, underscore the emerging view that strains are the most dynamic and interactive units of microbiomes (<xref ref-type="bibr" rid="bib47">Roodgar et al., 2009</xref>; <xref ref-type="bibr" rid="bib35">Leventhal et al., 2018</xref>; <xref ref-type="bibr" rid="bib24">Goyal, 2018</xref>). Our study has one major advantage over previous work where natural communities, such as human gut microbiomes, were sampled over time without environmental control. That is, that, by experimentally propagating natural samples, we shielded the communities from external host-induced perturbations such as the migration of new genetic variants or immune system control. Therefore, any observed community dynamics were a result of intrinsic causes, such as strain-specific interactions, not extrinsic causes, such as host-induced shifts. The reproducibility of these patterns across 10 independent replicate communities further strengthens our findings.</p><p>Finally, our results raise a question about the appropriate level at which to monitor microbial community composition. On one hand, our results show that strains as few as 100 SNPs apart can have independent ecological dynamics and interactions, and as such, represent distinct ecological variables. On the other hand, consistent with previous work, our results also show that the presence of strains is highly variable across communities, even in the same abiotic environmental conditions (<xref ref-type="bibr" rid="bib35">Leventhal et al., 2018</xref>). Therefore, coarse-grained assemblages (e.g., members of the same taxonomic family) should better represent the relationship between metabolic niches and community composition, especially for short-term community assembly dynamics (<xref ref-type="bibr" rid="bib22">Goldford et al., 2018</xref>; <xref ref-type="bibr" rid="bib37">Louca et al., 2016</xref>). But it is not clear how such assemblages should be defined in general, and what type of functional redundancy they capture. This is because there are numerous definitions of what constitutes ‘function.’ In the study that preceded this article, we found that the substrate consumption profile of the community was strongly correlated with community composition (at the 16S rRNA level), indicating thus that there is, at best, weak functional redundancy in the community if substrate preference is what we define as ‘function’ (<xref ref-type="bibr" rid="bib3">Bittleston et al., 2020</xref>). However, if what we care about is the conversion of organic carbon to CO<sub>2</sub>, for instance, community composition is indeed highly redundant (most species in the community could perform aerobic respiration and yield similar amounts of CO<sub>2</sub>). More work is needed in this arena to clarify how relevant ecological functions diverge across the microbial phylogeny. However, at the very least, we can say that if our questions pertain long-term dynamics <xref ref-type="fig" rid="fig5">Figure 5</xref>, or (eco)-evolution, strains are the appropriate variables with which to study the system.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Conceptual model of strain-dominated long-term dynamics.</title><p>(Diversity pre-assembly) Schematic showing the phenotypes (e.g., resource consumption rates) of strains belonging to two different species, <italic>A</italic> (green) and <italic>B</italic> (red), in a large strain pool in nature. Each point represents the consumption rate of a particular strain on two hypothetical resources. (Diversity post-assembly) When assembled in a community (e.g., domesticated in the lab), a subset of the strains from each species (here, two from each species) may survive and coexist once the community reaches equilibrium. (Dynamics around equilibrium) The strains from each species influence each other’s long-term dynamics around equilibrium. Strains from different species that are closer in phenotype space (<italic>A</italic><sub>1</sub> and <italic>B</italic><sub>1</sub>) will display strongly correlated dynamics while phenotypically distant strains (<italic>A</italic><sub>2</sub> and <italic>B</italic><sub>2</sub>) will be weakly correlated.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-74987-fig5-v2.tif"/></fig></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Experimental methods</title><sec id="s4-1-1"><title>Sampling, experimental design, and DNA extraction</title><p>We collected aquatic samples from 10 healthy <italic>S. purpurea</italic> pitchers at Harvard Pond (Petersham, MA), filtered them through 3 µm syringe filters, combined them in a 1:1 ratio with sterilized cricket media, and grew them in 48-well plates in a 25°C incubator. The sampling and experimental design was identical to, and is described in detail in, <xref ref-type="bibr" rid="bib3">Bittleston et al., 2020</xref>. For the first 63 days (21 transfers), every 3 days each sample was mixed well and 500 µL was transferred to a new plate with 500 µL of sterile cricket media. After this point, we shifted to sampling every 7 days using a larger dilution ratio of 1:100, with 20 µL of each community mixed into 1980 µL of cricket media. At every transfer, we froze a portion of each sample at –80°C for later DNA extraction and sequencing. We extracted and quantified DNA as described in <xref ref-type="bibr" rid="bib3">Bittleston et al., 2020</xref> using the Agencourt DNAdvance kit (Beckman Coulter) the Quant-iT PicoGreen dsDNA Assay kit (Invitrogen), respectively, from transfers 23–67. The intermediate transfer between the two serial propagation regimes, numbered 22, was not sequenced.</p></sec><sec id="s4-1-2"><title>Strain isolation</title><p>Individual strains were isolated from 5 of the 10 microcosms (M03, M05, M07, M09, and M10) by plating the culture fluid and picking around 100 colonies per microcosm. Details of the isolation methods and preliminary strain identification are described in <xref ref-type="bibr" rid="bib3">Bittleston et al., 2020</xref>. We chose a set of 33 diverse strains that were well-represented in the amplicon sequencing data from the first 63 days and extracted DNA using the same procedure as the community samples (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>).</p></sec><sec id="s4-1-3"><title>Sequencing</title><p>Amplicons were sequenced at the Environmental Sample Preparation and Sequencing Facility at Argonne National Laboratory on a MiSeq targeting the V4 region of 16S rRNA using the 515F and 806R primers (<xref ref-type="bibr" rid="bib6">Caporaso et al., 2012</xref>; <xref ref-type="bibr" rid="bib5">Caporaso et al., 2011</xref>) and using the same procedure as described in <xref ref-type="bibr" rid="bib3">Bittleston et al., 2020</xref>. Metagenomes from all 10 communities were sequenced across eight evenly spaced time points, resulting in 80 samples. Genomic and metagenomic libraries were prepared at the BioMicro Center at MIT using NexteraFlex and sequenced on a NovaSeq SP500 run, aiming for 20× more sequencing depth for strains relative to metagenomes.</p></sec></sec><sec id="s4-2"><title>Bioinformatic methods</title><sec id="s4-2-1"><title>Species abundance estimation</title><p>We defined each species in our analysis as a unique amplicon sequence variant (ASV). Our definition of species as exact 16S rRNA variants, or ASVs, is consistent with recent community analyses, which increasingly prefer analyzing communities at the level of ASVs over the historical operational taxonomic units (OTUs). To analyze the amplicon sequencing data, we used the same ASV assignments and sequence analysis procedure described in <xref ref-type="bibr" rid="bib3">Bittleston et al., 2020</xref>. Each species (or ASV) was identified with a unique ~250-bp-long sequence. In each sample, we estimated the relative abundance of a species as the number of reads that mapped to it, normalized by the total number of reads in the sample. We estimated the number of elapsed generations after each cycle in the experiment as <inline-formula><mml:math id="inf1"><mml:mtext>lo</mml:mtext><mml:msub><mml:mrow><mml:mtext>g</mml:mtext></mml:mrow><mml:mrow><mml:mtext>2</mml:mtext></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> , with the dilution factor <italic>D</italic> = 100. Unless stated otherwise, we performed all subsequent analyses using Python v3.7.3 and the NumPy and SciPy packages (<xref ref-type="bibr" rid="bib28">Harris et al., 2020</xref>; <xref ref-type="bibr" rid="bib55">Virtanen et al., 2020</xref>).</p></sec><sec id="s4-2-2"><title>Reference genome database construction</title><p>We built a reference genome database by sequencing 33 out of the 100 isolates extracted from our communities (described above). After trimming raw sequencing reads with Trimmomatic 0.36 (<xref ref-type="bibr" rid="bib4">Bolger et al., 2014</xref>), we assembled genomes using SPAdes v3.13 (<xref ref-type="bibr" rid="bib9">Deng et al., 2013</xref>). We removed all assembled contigs less than 200 bp in length. We then used the Genome Taxonomy Database (GTDB-Tk) to assign genus-level identity to each genome and generate a phylogenetic tree (<xref ref-type="bibr" rid="bib7">Chaumeil et al., 2019</xref>).</p></sec><sec id="s4-2-3"><title>Read mapping</title><p>After trimming reads with Trimmomatic 0.36, we mapped each read against our reference genome database using Minimap2 v2.17 (<xref ref-type="bibr" rid="bib36">Li, 2018</xref>). Since our reference genomes were assembled using isolates from the same communities as the reads, we used stringent settings for short reads (<bold>-ax sr</bold>) and to ensure unambiguous read mapping only kept mapped reads longer than 100 bp with the highest MAPQ quality score of 60. Further, we filtered out any remaining reads that mapped equally well to more than one location in the reference database. We mapped reads sample by sample, each sample corresponding to a unique time point from among one of our 10 communities.</p><p>To minimize read stealing, we took three crucial steps. First, we only used reads that mapped to the 33 reference genomes we sequenced and assembled from the communities in this study, ensuring that they were representative of the species being studied. Second, we filtered out all reads mapping to genes that were &gt;98% identical across any reference genomes in our database. Finally, we filtered out those reads that mapped to genes with anomalous coverage (either less than half the median coverage in a sample or greater than thrice the median coverage in any sample). The resulting fraction of reads mapped to each species, after normalizing for genome length, was well-correlated with its relative abundance estimated independently using 16S rRNA sequencing, suggesting that read stealing was minimal (mean correlation 0.8; <xref ref-type="fig" rid="fig1s10">Figure 1—figure supplement 10</xref>). Further, using species abundances estimated from metagenomic sequencing, rather than 16S sequencing, did not affect our main results (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref> shows a version of <xref ref-type="fig" rid="fig3">Figure 3b</xref> using only metagenomic abundance estimates).</p></sec><sec id="s4-2-4"><title>Variant calling</title><p>To identify genetic variants using the aligned reads, we used the Bayesian genetic variant detector FreeBayes v1.3.2, which prioritizes variation in literal read sequences over variation in their exact alignment (<xref ref-type="bibr" rid="bib19">Garrison and Marth, 2012</xref>). To calibrate the variant caller for haploid prokaryotic genomes, we used the settings <bold><monospace>--ploidy 1</monospace> <monospace>--haplotype-length 0</monospace> <monospace>--min-alternate-count 1</monospace><monospace> --min-alternate-fraction 0</monospace> <monospace>--pooled-continuous </monospace><monospace>--report-monomorphic -m 60 -e 1,000</monospace></bold>. For downstream analysis, we only considered biallelic (only one alternate allele observed at the site, &gt;97%) SNPs that had a Phred quality score ≥20 and a local read depth ≥10 (i.e., allele frequency least count: 10%). To avoid sequencing errors and read mapping artifacts, once an SNP was detected at a certain time point in a community, we required that it be detected across all subsequent time points, or until the time point at which the species containing it reached a relative abundance of zero.</p></sec><sec id="s4-2-5"><title>Strain identification</title><p>For each community, we chose all SNPs detected at the first time point and partitioned them among the 33 reference genomes (unique 16S rRNA sequences, or species) they were detected in. For each set of SNPs detected in a species, we clustered the frequency trajectories of their major allele (reference or alternate allele, whichever was higher) using dynamic time warping, a generalized <italic>k</italic>-means clustering algorithm for time-series data (<xref ref-type="bibr" rid="bib10">Deng et al., 2020</xref>). We performed clustering for one, two, and three clusters for each species. In all cases, a third cluster had a low Euclidean distance (mean &lt; 0.15) from and was visually indistinguishable from one of the other two clusters (<xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5</xref>). We thus rejected it. A second cluster was either also visually indistinguishable from the previous clusters, or comprised a set of SNPs which with nearly fixed allele frequencies (&gt;0.9). We inferred the latter clusters as belonging to those loci that were shared by all conspecific strains in the sample but differentiated them from the reference genome. If the latter type of cluster was present, we assigned two clusters to each species. If not, we assigned one cluster. The first two clusters always accounted for &gt;80% of SNPs in a species, which increased our confidence in cluster assignment. Clustering using an alternate method, such as the unweighted pair group method with arithmetic mean (UPGMA) clustering on the data (using the Euclidean distance between SNP trajectory correlations as a distance metric), yielded similar results (<xref ref-type="fig" rid="fig1s6">Figure 1—figure supplement 6</xref>). Always, one cluster consisted of SNPs differentiating the two strains, and the second cluster consisted of shared SNPs between them (<xref ref-type="fig" rid="fig1s7">Figure 1—figure supplement 7d</xref>). In a few cases, there was a set of unclustered, loose SNPs (e.g., <xref ref-type="fig" rid="fig1s6">Figure 1—figure supplement 6b</xref>), which we verified also corresponded to nearly fixed SNPs (allele frequency ~1 at all times; <xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5b</xref>), which, using the pigeonhole principle, we interpreted to be mutations common to both strains. The coverage-dependent noise in SNP frequency measurements creates a relatively wide cluster, which we suspect somewhat affects our ability to discern several strains. However, a similar small number of strains (usually two) are commonly found in other communities via metagenomic techniques.</p></sec><sec id="s4-2-6"><title>Strain abundance estimation</title><p>We identified each strain as being represented by its reference genome along with the cumulative set of SNPs in both clusters. To assign each strain as major or minor, we estimated their frequency within each species. For this, we only used the allele frequencies of SNPs in the first cluster. Specifically, we calculated the average allele frequency weighted by the local read depth for each SNP in the cluster. The strain with a higher weighted mean frequency at the first time point was classified as the major strain. The abundance of each strain was calculated as its frequency at the time point (between 0% and 100%) times the relative abundance of the species in the community at that time point. Thus, each strain pair partitioned the abundance of its species into two abundance trajectories, that of a major and a minor strain.</p></sec><sec id="s4-2-7"><title>Functional annotation of strain-differentiating SNPs</title><p>We performed a categorical enrichment analysis of strain-differentiating SNPs (first SNP cluster, described above). First, we extracted those SNPs detected in the genes of each reference genome, on average 82% of SNPs. We annotated the proteins corresponding to each gene using eggNOG-mapper v2 (<xref ref-type="bibr" rid="bib30">Huerta-Cepas et al., 2017</xref>), with the parameters<monospace> -<bold>-go_evidence non-electronic</bold></monospace> <bold><monospace>--target_orthologs all</monospace> <monospace>--seed_ortholog_evalue 0.001 </monospace><monospace>--seed_ortholog_score 60</monospace></bold>. After filtering out genes with unknown functional annotations such as hypothetical proteins and proteins with domains of unknown functions, as well as genes with no known KEGG Orthology (KO) group (30% of SNP-containing genes), we asked which functional categories of genes had more SNPs than expected by chance. Each KO was associated with a specific functional category in the associated BRITE hierarchy. For the BRITE category ‘Enzymes,’ which is extremely broad, we manually chose finer functional categories, such as carbon, nitrogen, and sulfur metabolism, based on what compounds the enzymes acted on. For each functional category containing at least one SNP, we calculated an enrichment score, given by the inverse of the p-value of the observed number of SNPs in the category when compared against the expected number of SNPs (given by a binomial distribution with success rate equal to the fraction of the genome corresponding to that category of genes; we accounted for the number and length of genes in each category while computing the expected distribution). Gene annotations and names in examples were derived manually using the KEGG and UniProt entries corresponding to each gene’s KO numbers.</p><p>As a control, we measured the functional differences among conspecific strains from the NCBI GenBank database, which did not coexist in the same community. The results of such an analysis could depend strongly on which species we chose. To ensure a fair comparison, we chose a species from the most common genus in our communities, <italic>Aquitalea magnusonii</italic>. There were five strains whose genomes were available, all of which we used for our analysis. We arbitrarily chose one of the strains (GCA_003202035.1) as the reference and repeated our analysis exactly as described for the strains in our communities.</p></sec><sec id="s4-2-8"><title>Pseudogene detection and analysis</title><p>To detect pseudogenes, we used those strain-differentiating SNPs that were localized in genes (described above). Specifically, we identified the codon-level changes engendered by each SNP, and a pseudogene was identified as one that resulted in a premature stop codon. Like all SNPs, we required that this stop codon-enabling SNP be detected at all subsequent time points once detected. For functional analysis, we used the same procedure as described above but restricted to pseudogenes. To detect mutations in genes, we counted those SNPs that were not detected at the first metagenomic time point but detected at later time points; like other SNPs, once detected, we required mutations to be repeatedly detected at all subsequent time points (see <xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref> for an example). If an SNP was not detected at the first time point, but was detected later at a frequency consistent with one (or both) of the strains within a species, then we could not confidently assign it as a de novo or preexisting mutation, and we thus refrained from assigning it to either category. To assign a pseudogene to a specific strain, we checked whether the allele frequency of the loss-of-function SNP was consistent with the frequency of one of the two strains. When it was consistent with only one of the strains, but inconsistent with the other, we assigned it to the consistent strain. If the SNP frequency was consistent with both strains (or inconsistent with both strains), then we did not assign it to a unique strain. To calculate pN/pS for each gene (at the final time point), we accumulated all SNPs detected in that gene and classified them as synonymous or nonsynonymous based on whether they led to an expected amino acid change; we then calculated pN/pS using standard techniques.</p></sec></sec><sec id="s4-3"><title>Statistical methods and models</title><sec id="s4-3-1"><title>Community compositional variability</title><p>We measured the variability in community composition across our 10 communities at different taxonomic levels. At each taxonomic level, we partitioned all community members into groups; members within a group differed at that taxonomic level but shared a common ancestor just one taxonomic level above. As an example, to measure variability at the species level, we partitioned all members into groups; each group contained different species belonging to the same genus (say all three species belonging to the genus <italic>Aquitalea</italic>). After partitioning, we measured the probability with (or frequency at) which two members of a group co-occurred in a sample (how often two different <italic>Aquitalea</italic> species co-occurred). This gave us a measure of how different two communities were at a given taxonomic level (in this example, to what extent different communities had different species of the same genus).</p><p>To normalize the observed probability of co-occurrence against the expected probability at each level, we repeated the calculation by randomly shuffling member labels across groups. This procedure destroyed any phylogenetic relationship between members of a group, but preserved both the number of groups and their sizes.</p></sec><sec id="s4-3-2"><title>Divergence time between strains</title><p>From previous literature, we estimated the mutation rates of soil bacteria (10<sup>–8</sup> per nucleotide per generation), genome size of roughly 10<sup>6</sup> bp, and an average doubling estimate of ~100 generations per year for soil bacteria in the wild (<xref ref-type="bibr" rid="bib41">Ochman et al., 1999</xref>). Using these estimates and ideas from molecular clock analyses, which suggest that the divergence rate of neutral mutations in a population is equal to the per individual mutation rate (independent of population size), we calculated the average fixation time for one mutation to be about 1 year. This estimate is consistent with known mutation accumulation rates in bacterial genomes (<xref ref-type="bibr" rid="bib21">Gibson and Eyre-Walker, 2019</xref>). The pitchers of <italic>S. purpurea</italic> that we sampled were a few months old (between 3 and 4 months; we sampled in September and new pitchers open in June). Based on these rough estimates, we believe that it is highly unlikely that any pair of strains, which we observed to coexist, diverged during the lifetime of a single pitcher.</p></sec><sec id="s4-3-3"><title>Strain–strain coupling</title><p>We measured a strain–strain coupling between each conspecific pair of strains (belonging to the same species) that co-occurred in a community. For each conspecific strain pair, we calculated their temporal abundance trajectories, that is, their relative abundances at all eight time points (described above), and then measured the magnitude (or absolute value) of the Pearson correlation coefficient between them. We measured only the magnitude of each correlation (regardless of its o-value) because we were interested only in the extent of covariance between two conspecific strains, and not in the statistical significance of their association. Further, we used the absolute value of each correlation and ignored their sign for simplicity since there were very few negative correlations, most of which had a low magnitude (&lt;0.3; <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>). The latter were correctly classified as decoupled even under the simpler magnitude-only definition of coupling. We verified that using a nonparametric covariance measure such as the Spearman correlation did not affect our results (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>).</p><p>Since we metagenomically sequenced the communities roughly once every 37 generations (298 generations evenly sampled eight times), we could not resolve dynamics finer than that timescale. As a result, while our method would be able to resolve a time lag between strain dynamics, the time lag could be no finer than our limit of resolution, that is, 37 generations. No strain dynamics lagged or led the other by greater than 37 generations. Since the presence of any undetected correlations between strains at finer temporal resolutions would only strengthen our claims, we believe that our results are robust to our limited temporal sampling. Further, while our correlation-based method would be able to detect higher-order interactions between strains, we would require data from many more communities than the 10 we sampled here. This is because resolving higher-order interactions between any trio of strains requires tracking the dynamics of each pair of the trio, both in the presence and absence of the third strain.</p></sec><sec id="s4-3-4"><title>Interactions between strains and species</title><p>We measured putative signatures of interaction in each community separately at the level of species and strains. At each level (say species), we first calculated the temporal abundance trajectories of all members, that is, their relative abundances at all eight time points (described above). Then, for each inter-species pair, we then measured the Pearson correlation coefficient between their abundance trajectories (similar results with Spearman correlations, <xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>). We used the magnitude of the correlation as a proxy for interaction strength. Relative abundance data can exhibit spurious correlations because of finite sampling and the constraint that abundances must sum up to 1. To account for this while detecting the presence of an interaction, we calculated the statistical significance of each correlation against an expected correlation distribution, described as follows.</p><sec id="s4-3-4-1"><title>Null model to detect interactions</title><p>To estimate the expected correlation distribution between the abundance trajectories of two species (or strains) in a community, we used a null model to simulate community abundances. The null model made two key assumptions: the abundance fluctuations of each member were independent of each other (as expected when there are no interactions) and followed a gamma distribution, which empirically describe abundance fluctuations in microbial communities (<xref ref-type="bibr" rid="bib26">Grilli, 2020</xref>; <xref ref-type="bibr" rid="bib46">Ramsayer et al., 2012</xref>). For each species <inline-formula><mml:math id="inf2"><mml:mi>i</mml:mi></mml:math></inline-formula>, we used the observed mean (<inline-formula><mml:math id="inf3"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:math></inline-formula>) and variance (<inline-formula><mml:math id="inf4"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula>) of its abundance, <inline-formula><mml:math id="inf5"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> , from all our communities to fix the parameters of its expected abundance distribution <inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> as follows:<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mover><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo></mml:mover></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mi>x</mml:mi><mml:mover><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo></mml:mover></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf7"><mml:msub><mml:mrow><mml:mi mathvariant="normal">β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> . We then simulated the abundance trajectories of each community with the same species or strains as laboratory communities. At each time point, we randomly picked the abundance of each community member from its expected abundance distribution. After picking the abundance of all members, we renormalized them (divided each abundance by the total sum) to obtain relative abundances. We then measured the correlations between each pair of species (or strains) using this synthetic abundance data and using the same procedure described for real data. We repeated the simulations and correlation measurements 1000 times to build an expected correlation distribution. To measure the statistical significance of a specific correlation observed between two species or strains, we calculated its p-value using this expected distribution, that is, the probability of obtaining this correlation by chance. We called an interaction ‘present’ if its p-value was &lt;0.05 (<xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5</xref>). Since the expected distribution already accounted for multiple comparisons, we did not perform an additional correction.</p></sec><sec id="s4-3-4-2"><title>Null model to control for phylogenetic association</title><p>To control for the association between species and strains while comparing species–species and strain–strain interaction strengths, we calculated the fraction of cases where strains were more interactive than species in a null model. To do this, we shuffled the association between species and strains by redistributing strains across species. In each community, we randomly shuffled strain labels, thus splitting conspecific strains across different species and coalescing interspecific strains into the same species. We repeated our measurement of strain–strain and species–species interaction strengths on these shuffled data and calculated the fraction <inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> of cases where the magnitude of correlation between a pair of strains from different (relabeled) species was higher than the correlation between the (relabeled) species themselves. We repeated this shuffling (permutation) 1000 times, thus obtaining a null distribution <inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> , with a mean 64% and standard deviation 3%, and a corresponding p-value for our experimentally measured fraction <inline-formula><mml:math id="inf10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = 76%, that is, the probability of observing a fraction <inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> equal to or greater than 76% (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>).</p></sec></sec></sec><sec id="s4-4"><title>Measuring eco-evolutionary influence from strains on species</title><p>Communities can be characterized by two kinds of dynamics: (1) ecological dynamics describe the changes in community composition at the level of species while (2) evolutionary dynamics describe the changes in the composition of each species at the level of the genotypes or strains that constitute them. A hallmark of microbial communities is that ecological and evolutionary dynamics are often coupled to each other due to the short generation times of microbes. Namely, changes in strain frequencies affect subsequent changes in species’ relative abundances, which then drive further changes in strain frequencies. This phenomenon has been extensively studied in two-species communities and has been termed eco-evolutionary feedback. Inspired by this idea, we wondered to what extent the changes in species’ relative abundances were driven by the changes in the frequencies of their underlying strains. Our communities, which had much higher species diversity (~10 species per community) and 10 independent replicates, allowed us to perform a more extensive test of this idea. Due to the low temporal resolution of our measurements (eight time points per community), we would not be able to discern a continuous feedback between the species and the underlying strain dynamics, but would still be able to detect some signature of one influencing the other. For example, in <xref ref-type="fig" rid="fig2">Figure 2d</xref>, the dynamics of an <italic>Aquitalea</italic> species could be almost entirely explained by the growth of its minor strain. We termed such a phenomenon—where the abundance fluctuations of a species coincided with the fluctuations in its underlying strain frequencies—‘eco-evolutionary influence.</p><p>To quantify how common this phenomenon was in diverse microbial communities, we calculated the eco-evolutionary influence for all species across all 10 communities. Specifically, we calculated the correlation between two quantities: (1) the relative abundance of each species trajectory over time and (2) the frequency of its major strain or genotype of that species over time. A high correlation would indicate the presence of an eco-evolutionary influence (<xref ref-type="fig" rid="fig2">Figure 2d</xref>) while a low correlation would not. To ascertain the boundary between a low and high correlation, we employed a null model. Namely, in this null model, we shuffled all species and major strain trajectories, and measured their correlations to generate an expected distribution of eco-evolutionary influence (<xref ref-type="fig" rid="fig1s9">Figure 1—figure supplement 9</xref>, gray).</p><p>We found that a majority of species trajectories (51%) had a greater eco-evolutionary influence than expected by chance (<xref ref-type="fig" rid="fig1s9">Figure 1—figure supplement 9</xref>, red), suggesting that eco-evolutionary influence is common in complex communities.</p></sec><sec id="s4-5"><title>Constructing community interaction networks</title><p>We looked for the presence of interactions between members for each community separately. To do this, we inferred two interaction networks: one at the level of species and the other at the level of strains. To infer an interaction network, say at the species level, we measured all pairwise correlations between the abundances of species in the community. Two species were said to interact if the correlation between them was statistically significant compared with an ecological neutral model. Briefly, this model computed the expected distribution of correlations between noninteracting members of a community by simulating their abundance trajectories under known empirical laws using only the mean and variance of their observed relative abundances (see Materials and methods). Importantly, even at the level of strains, we specifically looked for interactions between strains belonging to different species, not between strains of the same species.</p><p>To illustrate our results, we focused on community M07 as an example (<xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5</xref>). We found that the strain-level interaction network of this community was 90% denser in interactions (38 interactions across 24 strains; density measured as the number of interactions per node) than the species-level network (10 interactions across 12 species). In fact, this observation of denser strain-level interaction networks was true for all communities (mean ~ 70% denser networks at the strain-level). Most strain-level networks revealed interactions that could only be observed at the level of strains, not species (e.g., <xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5</xref>, <italic>Rh</italic>). These results suggested that in terms of the presence/absence of interactions community interactions were likely strain specific.</p><p>Note that in this analysis we were interested in measuring the density of interactions as the number of interactions (edges) detected per node (strain or species), not the number of interactions (edges) per possible edge, which would control for a fixed false-positive rate of observing interactions. This is because we were interested in measuring how many other community members each constituent strain or species interacted with. Specifically, with this analysis, we wanted to ask if strains had more interacting partners than species, on average.</p></sec><sec id="s4-6"><title>Measuring functional differences between generic strains</title><p>As a control, we measured the functional differences among conspecific strains from the NCBI GenBank database, which did not coexist in the same community. The results of such an analysis could depend strongly on which species we chose. To ensure a fair comparison, we chose a species from the most common genus in our communities, <italic>A. magnusonii</italic>. We found that the functions differentiating <italic>A. magnusonii</italic> strains had very little overlap (~10%) with those differentiating coexisting <italic>Aquitalea</italic> strains in our communities. Enriched functions in the controls comprised translation factors, motility genes, antimicrobial resistance genes, and transporters (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>). Even though transporters were variable across both kinds of strains, upon closer inspection, we found differences in the types of transporters enriched in our strains and controls. Unlike coexisting strains, where most variable transporters belonged to sugar, amino acid, and siderophore transporters, among non-coexisting strains, variable transporters instead belonged to outer membrane porins like <italic>bamA</italic>, metal ion transporters like <italic>cbiN</italic>, and multidrug resistance pumps like <italic>emrE</italic> and <italic>qac</italic>.</p></sec><sec id="s4-7"><title>Minimal consumer-resource models of strain interactions</title><p>To compare the dynamical patterns expected under both hypotheses, we simulated community dynamics under two model scenarios using two similar consumer-resource models where interactions were mediated by resource competition.</p><p>We initially populated each community with a randomly generated ensemble of species, consisting of 50 species or 100 strains. For simplicity, each species was composed of two strains. We encoded competitive interactions through a matrix of resource consumption rates; the difference between the rates of two taxa inversely controlled the strength of competition between them. In the matrix, each species was represented by a randomly chosen vector of consumption rates. Each set of consumption rates was represented by a vector of dimension 30 (equal to the number of resources), sampled uniformly from the unit simplex, such that all resource consumption rates summed to 1. This well-studied assumption is common to consumer-resource models since it mimics a fixed ‘enzyme budget’ for each strain and allows strains to coexist (<xref ref-type="bibr" rid="bib22">Goldford et al., 2018</xref>; <xref ref-type="bibr" rid="bib45">Posfai et al., 2017</xref>; <xref ref-type="bibr" rid="bib25">Goyal and Maslov, 2018</xref>). This assumption greatly simplified the analysis of our model since we were primarily interested in studying the dynamical correlations between strains rather than their coexistence. We simulated the model in discrete growth-dilution cycles, where in each cycle we simulated the dynamics of strains and resources using the standard consumer-resource equations with resource competition as follows:<disp-formula id="equ2">,<mml:math id="m2"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">α</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula></p><p>and<disp-formula id="equ3">,<mml:math id="m3"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">α</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where strains’ population sizes are represented by <inline-formula><mml:math id="inf12"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> , resource concentrations by <inline-formula><mml:math id="inf13"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> , and <inline-formula><mml:math id="inf14"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">α</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represents the consumption rate of strain α for resource <italic>i</italic>.</p><p>Mimicking the experimental protocol, we simulated the assembly of 10 independent communities under serial propagation in the same balanced resource environment, with a dilution factor of 100, until all communities reached an equilibrium. To obtain abundance fluctuations around equilibrium, we utilized the fact that the experimental medium was complex, not well-defined. While the medium had an average composition, the amount of each resource in it would have differed slightly from transfer to transfer. To model this, we introduced minor variations in the relative proportion of resources supplied during each transfer, such that all communities experienced the same resource environment on average. Specifically, we chose a medium with 30 resources, such that all resources were supplied in equal proportions on average, with the total resource supply summing to 1 in units of microbial biomass. Variations in the resource supply were modeled as Gaussian-distributed noise with mean 0 and variance 0.05. We verified that changing the number of resources did not quantitatively affect our results.</p><p>When interactions were strain-specific, each conspecific pair had a different set of consumption rates, with a chosen ‘competitive distance’ <italic>D</italic> between them, where <italic>D</italic> represents the average difference in the consumption rates of any one resource. Here, each strain was represented by a set of consumption rates that summed to 1, but such that its Euclidean distance from its conspecific strain’s consumption rates was <italic>D</italic>. Similar to our observation that strains had a broad distribution of genetic distances, pairs of strains in our model had a wide range of competitive distances, <italic>D</italic>. Specifically, we chose 15% of strain pairs with a distance <italic>D</italic> = 0.01, 20% with <italic>D</italic> = 0.1, 50% with <italic>D</italic> = 0.3, and 15% with <italic>D</italic> = 1.0. This choice was arbitrary but somewhat mimicked the observed distribution of genetic distances between strains.</p><p>When interactions were instead species-specific, both conspecific strains had identical consumption rates (<italic>D</italic> = 0), with stochastic noise being the only way to alter their abundances. To implement noise, we simulated a random walk of the relative frequency of each strain pair within a species at each generation, with mean zero and variance <inline-formula><mml:math id="inf15"><mml:msqrt><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:msqrt></mml:math></inline-formula> , where <italic>N</italic> represents the relative abundance of the species to which the strains belonged, and <inline-formula><mml:math id="inf16"><mml:mi mathvariant="normal">v</mml:mi></mml:math></inline-formula> is the fit from the data, as the variance in the relative frequency fluctuations of strains, averaged across all species and communities.</p></sec></sec></body><back><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Formal analysis, Investigation, Methodology, Software, Validation, Visualization, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Data curation, Formal analysis, Methodology</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Data curation, Methodology, Software</p></fn><fn fn-type="con" id="con4"><p>Methodology</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Formal analysis, Funding acquisition, Project administration, Supervision, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Metadata and accession numbers for all 33 assembled genomes used in the study.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-74987-supp1-v2.xlsx"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>Set of single-nucleotide polymorphism (SNP) locations and corresponding gene annotations for members of an example community M04.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-74987-supp2-v2.xlsx"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-74987-transrepform1-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Raw sequencing reads are available in the NCBI Sequence Read Archive (BioSample SAMN17005333). Assembled genomes have been deposited in the NCBI GenBank database (BioProject PRJNA682646). Genome metadata and accession numbers are provided in Supplementary file 1.</p><p>The following datasets were generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><collab>Goyal et al</collab></person-group><year iso-8601-date="2021">2021</year><data-title>Interactions between strains govern the eco-evolutionary dynamics of microbial communities</data-title><source>NCBI BioSample</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/biosample/?term=SAMN17005333">SAMN17005333</pub-id></element-citation></p><p><element-citation id="dataset2" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><collab>Goyal et al</collab></person-group><year iso-8601-date="2021">2021</year><data-title>Interactions between strains govern the eco-evolutionary dynamics of microbial communities</data-title><source>NCBI BioProject</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA682646">PRJNA682646</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank Michelle Oraa Ali for their illustration in <xref ref-type="fig" rid="fig1">Figure 1</xref>. We are grateful to Shaul Pollak for stimulating discussions about the models. This work was supported by the Gordon and Betty Moore Foundation Physics of Living Systems Fellowship grant # GBMF4513 (AG), the Human Frontiers Science Program grant # LT000643/2016L (GEL), the James S McDonnell Foundation Postdoctoral Fellowship award # 220020477 (LSB), the NSF-DEB grant # 1655983 (OXC), and the Simons Foundation Collaboration: Principles of Microbial Ecosystems (PriME) award # 542395 (OXC).</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aravind</surname><given-names>L</given-names></name><name><surname>Anantharaman</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>HutC/FarR-like bacterial transcription factors of the GntR family contain a small molecule-binding domain of the chorismate lyase fold</article-title><source>FEMS Microbiology Letters</source><volume>222</volume><fpage>17</fpage><lpage>23</lpage><pub-id pub-id-type="doi">10.1016/S0378-1097(03)00242-8</pub-id><pub-id pub-id-type="pmid">12757941</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balakirev</surname><given-names>ES</given-names></name><name><surname>Ayala</surname><given-names>FJ</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Pseudogenes: are they “junk” or functional DNA?</article-title><source>Annual Review of Genetics</source><volume>37</volume><fpage>123</fpage><lpage>151</lpage><pub-id pub-id-type="doi">10.1146/annurev.genet.37.040103.103949</pub-id><pub-id pub-id-type="pmid">14616058</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bittleston</surname><given-names>LS</given-names></name><name><surname>Gralka</surname><given-names>M</given-names></name><name><surname>Leventhal</surname><given-names>GE</given-names></name><name><surname>Mizrahi</surname><given-names>I</given-names></name><name><surname>Cordero</surname><given-names>OX</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Context-dependent dynamics lead to the assembly of functionally distinct microbial communities</article-title><source>Nature Communications</source><volume>11</volume><elocation-id>1440</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-020-15169-0</pub-id><pub-id pub-id-type="pmid">32188849</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bolger</surname><given-names>AM</given-names></name><name><surname>Lohse</surname><given-names>M</given-names></name><name><surname>Usadel</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Trimmomatic: a flexible trimmer for Illumina sequence data</article-title><source>Bioinformatics (Oxford, England)</source><volume>30</volume><fpage>2114</fpage><lpage>2120</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btu170</pub-id><pub-id pub-id-type="pmid">24695404</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caporaso</surname><given-names>JG</given-names></name><name><surname>Lauber</surname><given-names>CL</given-names></name><name><surname>Walters</surname><given-names>WA</given-names></name><name><surname>Berg-Lyons</surname><given-names>D</given-names></name><name><surname>Lozupone</surname><given-names>CA</given-names></name><name><surname>Turnbaugh</surname><given-names>PJ</given-names></name><name><surname>Fierer</surname><given-names>N</given-names></name><name><surname>Knight</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Global patterns of 16S rRNA diversity at a depth of millions of sequences per sample</article-title><source>PNAS</source><volume>108 Suppl 1</volume><fpage>4516</fpage><lpage>4522</lpage><pub-id pub-id-type="doi">10.1073/pnas.1000080107</pub-id><pub-id pub-id-type="pmid">20534432</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caporaso</surname><given-names>JG</given-names></name><name><surname>Lauber</surname><given-names>CL</given-names></name><name><surname>Walters</surname><given-names>WA</given-names></name><name><surname>Berg-Lyons</surname><given-names>D</given-names></name><name><surname>Huntley</surname><given-names>J</given-names></name><name><surname>Fierer</surname><given-names>N</given-names></name><name><surname>Owens</surname><given-names>SM</given-names></name><name><surname>Betley</surname><given-names>J</given-names></name><name><surname>Fraser</surname><given-names>L</given-names></name><name><surname>Bauer</surname><given-names>M</given-names></name><name><surname>Gormley</surname><given-names>N</given-names></name><name><surname>Gilbert</surname><given-names>JA</given-names></name><name><surname>Smith</surname><given-names>G</given-names></name><name><surname>Knight</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Ultra-high-throughput microbial community analysis on the Illumina HiSeq and MiSeq platforms</article-title><source>The ISME Journal</source><volume>6</volume><fpage>1621</fpage><lpage>1624</lpage><pub-id pub-id-type="doi">10.1038/ismej.2012.8</pub-id><pub-id pub-id-type="pmid">22402401</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chaumeil</surname><given-names>PA</given-names></name><name><surname>Mussig</surname><given-names>AJ</given-names></name><name><surname>Hugenholtz</surname><given-names>P</given-names></name><name><surname>Parks</surname><given-names>DH</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>GTDB-Tk: a toolkit to classify genomes with the Genome Taxonomy Database</article-title><source>Bioinformatics (Oxford, England)</source><volume>36</volume><fpage>1925</fpage><lpage>1927</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btz848</pub-id><pub-id pub-id-type="pmid">31730192</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>David</surname><given-names>LA</given-names></name><name><surname>Maurice</surname><given-names>CF</given-names></name><name><surname>Carmody</surname><given-names>RN</given-names></name><name><surname>Gootenberg</surname><given-names>DB</given-names></name><name><surname>Button</surname><given-names>JE</given-names></name><name><surname>Wolfe</surname><given-names>BE</given-names></name><name><surname>Ling</surname><given-names>AV</given-names></name><name><surname>Devlin</surname><given-names>AS</given-names></name><name><surname>Varma</surname><given-names>Y</given-names></name><name><surname>Fischbach</surname><given-names>MA</given-names></name><name><surname>Biddinger</surname><given-names>SB</given-names></name><name><surname>Dutton</surname><given-names>RJ</given-names></name><name><surname>Turnbaugh</surname><given-names>PJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Diet rapidly and reproducibly alters the human gut microbiome</article-title><source>Nature</source><volume>505</volume><fpage>559</fpage><lpage>563</lpage><pub-id pub-id-type="doi">10.1038/nature12820</pub-id><pub-id pub-id-type="pmid">24336217</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Deng</surname><given-names>M</given-names></name><name><surname>Jiang</surname><given-names>R</given-names></name><name><surname>Sun</surname><given-names>F</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2013">2013</year><chapter-title>Research in Computational Molecular Biology.</chapter-title><person-group person-group-type="editor"><name><surname>Deng</surname><given-names>M</given-names></name><name><surname>Jiang</surname><given-names>R</given-names></name><name><surname>Sun</surname><given-names>F</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name></person-group><source>Lecture Notes in Computer Science</source><publisher-name>Springer</publisher-name><publisher-loc>Berlin, Heidelberg</publisher-loc><fpage>158</fpage><lpage>170</lpage><pub-id pub-id-type="doi">10.1007/978-3-642-37195-0</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deng</surname><given-names>H</given-names></name><name><surname>Chen</surname><given-names>W</given-names></name><name><surname>Shen</surname><given-names>Q</given-names></name><name><surname>Ma</surname><given-names>AJ</given-names></name><name><surname>Yuen</surname><given-names>PC</given-names></name><name><surname>Feng</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Invariant subspace learning for time series data based on dynamic time warping distance</article-title><source>Pattern Recognition</source><volume>102</volume><elocation-id>107210</elocation-id><pub-id pub-id-type="doi">10.1016/j.patcog.2020.107210</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Descheemaeker</surname><given-names>L</given-names></name><name><surname>de Buyl</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Stochastic logistic models reproduce experimental time series of microbial communities</article-title><source>eLife</source><volume>9</volume><elocation-id>e55650</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.55650</pub-id><pub-id pub-id-type="pmid">32687052</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ding</surname><given-names>J</given-names></name><name><surname>Fu</surname><given-names>L</given-names></name><name><surname>Ding</surname><given-names>ZW</given-names></name><name><surname>Lu</surname><given-names>YZ</given-names></name><name><surname>Cheng</surname><given-names>SH</given-names></name><name><surname>Zeng</surname><given-names>RJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Environmental evaluation of coexistence of denitrifying anaerobic methane-oxidizing archaea and bacteria in a paddy field</article-title><source>Applied Microbiology and Biotechnology</source><volume>100</volume><fpage>439</fpage><lpage>446</lpage><pub-id pub-id-type="doi">10.1007/s00253-015-6986-2</pub-id><pub-id pub-id-type="pmid">26394860</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faith</surname><given-names>JJ</given-names></name><name><surname>Guruge</surname><given-names>JL</given-names></name><name><surname>Charbonneau</surname><given-names>M</given-names></name><name><surname>Subramanian</surname><given-names>S</given-names></name><name><surname>Seedorf</surname><given-names>H</given-names></name><name><surname>Goodman</surname><given-names>AL</given-names></name><name><surname>Clemente</surname><given-names>JC</given-names></name><name><surname>Knight</surname><given-names>R</given-names></name><name><surname>Heath</surname><given-names>AC</given-names></name><name><surname>Leibel</surname><given-names>RL</given-names></name><name><surname>Rosenbaum</surname><given-names>M</given-names></name><name><surname>Gordon</surname><given-names>JI</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The long-term stability of the human gut microbiota</article-title><source>Science (New York, N.Y.)</source><volume>341</volume><elocation-id>1237439</elocation-id><pub-id pub-id-type="doi">10.1126/science.1237439</pub-id><pub-id pub-id-type="pmid">23828941</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faust</surname><given-names>K</given-names></name><name><surname>Raes</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Microbial interactions: from networks to models</article-title><source>Nature Reviews. Microbiology</source><volume>10</volume><fpage>538</fpage><lpage>550</lpage><pub-id pub-id-type="doi">10.1038/nrmicro2832</pub-id><pub-id pub-id-type="pmid">22796884</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faust</surname><given-names>K</given-names></name><name><surname>Lahti</surname><given-names>L</given-names></name><name><surname>Gonze</surname><given-names>D</given-names></name><name><surname>de Vos</surname><given-names>WM</given-names></name><name><surname>Raes</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Metagenomics meets time series analysis: unraveling microbial community dynamics</article-title><source>Current Opinion in Microbiology</source><volume>25</volume><fpage>56</fpage><lpage>66</lpage><pub-id pub-id-type="doi">10.1016/j.mib.2015.04.004</pub-id><pub-id pub-id-type="pmid">26005845</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fierer</surname><given-names>N</given-names></name><name><surname>Breitbart</surname><given-names>M</given-names></name><name><surname>Nulton</surname><given-names>J</given-names></name><name><surname>Salamon</surname><given-names>P</given-names></name><name><surname>Lozupone</surname><given-names>C</given-names></name><name><surname>Jones</surname><given-names>R</given-names></name><name><surname>Robeson</surname><given-names>M</given-names></name><name><surname>Edwards</surname><given-names>RA</given-names></name><name><surname>Felts</surname><given-names>B</given-names></name><name><surname>Rayhawk</surname><given-names>S</given-names></name><name><surname>Knight</surname><given-names>R</given-names></name><name><surname>Rohwer</surname><given-names>F</given-names></name><name><surname>Jackson</surname><given-names>RB</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Metagenomic and small-subunit rRNA analyses reveal the genetic diversity of bacteria, archaea, fungi, and viruses in soil</article-title><source>Applied and Environmental Microbiology</source><volume>73</volume><fpage>7059</fpage><lpage>7066</lpage><pub-id pub-id-type="doi">10.1128/AEM.00358-07</pub-id><pub-id pub-id-type="pmid">17827313</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frazão</surname><given-names>N</given-names></name><name><surname>Sousa</surname><given-names>A</given-names></name><name><surname>Lässig</surname><given-names>M</given-names></name><name><surname>Gordo</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Horizontal gene transfer overrides mutation in <italic>Escherichia coli</italic> colonizing the mammalian gut</article-title><source>PNAS</source><volume>116</volume><fpage>17906</fpage><lpage>17915</lpage><pub-id pub-id-type="doi">10.1073/pnas.1906958116</pub-id><pub-id pub-id-type="pmid">31431529</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frenkel</surname><given-names>EM</given-names></name><name><surname>McDonald</surname><given-names>MJ</given-names></name><name><surname>Van Dyken</surname><given-names>JD</given-names></name><name><surname>Kosheleva</surname><given-names>K</given-names></name><name><surname>Lang</surname><given-names>GI</given-names></name><name><surname>Desai</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Crowded growth leads to the spontaneous evolution of semistable coexistence in laboratory yeast populations</article-title><source>PNAS</source><volume>112</volume><fpage>11306</fpage><lpage>11311</lpage><pub-id pub-id-type="doi">10.1073/pnas.1506184112</pub-id><pub-id pub-id-type="pmid">26240355</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Garrison</surname><given-names>E</given-names></name><name><surname>Marth</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Haplotype-Based Variant Detection from Short-Read Sequencing</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1207.3907">http://arxiv.org/abs/1207.3907</ext-link></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garud</surname><given-names>NR</given-names></name><name><surname>Good</surname><given-names>BH</given-names></name><name><surname>Hallatschek</surname><given-names>O</given-names></name><name><surname>Pollard</surname><given-names>KS</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Evolutionary dynamics of bacteria in the gut microbiome within and across hosts</article-title><source>PLOS Biology</source><volume>17</volume><elocation-id>e3000102</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.3000102</pub-id><pub-id pub-id-type="pmid">30673701</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gibson</surname><given-names>B</given-names></name><name><surname>Eyre-Walker</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Investigating Evolutionary Rate Variation in Bacteria</article-title><source>Journal of Molecular Evolution</source><volume>87</volume><fpage>317</fpage><lpage>326</lpage><pub-id pub-id-type="doi">10.1007/s00239-019-09912-5</pub-id><pub-id pub-id-type="pmid">31570957</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldford</surname><given-names>JE</given-names></name><name><surname>Lu</surname><given-names>N</given-names></name><name><surname>Bajić</surname><given-names>D</given-names></name><name><surname>Estrela</surname><given-names>S</given-names></name><name><surname>Tikhonov</surname><given-names>M</given-names></name><name><surname>Sanchez-Gorostiaga</surname><given-names>A</given-names></name><name><surname>Segrè</surname><given-names>D</given-names></name><name><surname>Mehta</surname><given-names>P</given-names></name><name><surname>Sanchez</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Emergent simplicity in microbial community assembly</article-title><source>Science (New York, N.Y.)</source><volume>361</volume><fpage>469</fpage><lpage>474</lpage><pub-id pub-id-type="doi">10.1126/science.aat1168</pub-id><pub-id pub-id-type="pmid">30072533</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Good</surname><given-names>BH</given-names></name><name><surname>McDonald</surname><given-names>MJ</given-names></name><name><surname>Barrick</surname><given-names>JE</given-names></name><name><surname>Lenski</surname><given-names>RE</given-names></name><name><surname>Desai</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The dynamics of molecular evolution over 60,000 generations</article-title><source>Nature</source><volume>551</volume><fpage>45</fpage><lpage>50</lpage><pub-id pub-id-type="doi">10.1038/nature24287</pub-id><pub-id pub-id-type="pmid">29045390</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goyal</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Metabolic adaptations underlying genome flexibility in prokaryotes</article-title><source>PLOS Genetics</source><volume>14</volume><elocation-id>e1007763</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1007763</pub-id><pub-id pub-id-type="pmid">30372443</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goyal</surname><given-names>A</given-names></name><name><surname>Maslov</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Diversity, Stability, and Reproducibility in Stochastically Assembled Microbial Ecosystems</article-title><source>Physical Review Letters</source><volume>120</volume><elocation-id>158102</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.120.158102</pub-id><pub-id pub-id-type="pmid">29756882</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grilli</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Macroecological laws describe variation and diversity in microbial communities</article-title><source>Nature Communications</source><volume>11</volume><elocation-id>4743</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-020-18529-y</pub-id><pub-id pub-id-type="pmid">32958773</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Han</surname><given-names>D</given-names></name><name><surname>Tang</surname><given-names>H</given-names></name><name><surname>Lu</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>G</given-names></name><name><surname>Zhou</surname><given-names>L</given-names></name><name><surname>Min</surname><given-names>L</given-names></name><name><surname>Han</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Population structure of clinical Vibrio parahaemolyticus from 17 coastal countries, determined through multilocus sequence analysis</article-title><source>PLOS ONE</source><volume>9</volume><elocation-id>e107371</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0107371</pub-id><pub-id pub-id-type="pmid">25225911</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname><given-names>CR</given-names></name><name><surname>Millman</surname><given-names>KJ</given-names></name><name><surname>van der Walt</surname><given-names>SJ</given-names></name><name><surname>Gommers</surname><given-names>R</given-names></name><name><surname>Virtanen</surname><given-names>P</given-names></name><name><surname>Cournapeau</surname><given-names>D</given-names></name><name><surname>Wieser</surname><given-names>E</given-names></name><name><surname>Taylor</surname><given-names>J</given-names></name><name><surname>Berg</surname><given-names>S</given-names></name><name><surname>Smith</surname><given-names>NJ</given-names></name><name><surname>Kern</surname><given-names>R</given-names></name><name><surname>Picus</surname><given-names>M</given-names></name><name><surname>Hoyer</surname><given-names>S</given-names></name><name><surname>van Kerkwijk</surname><given-names>MH</given-names></name><name><surname>Brett</surname><given-names>M</given-names></name><name><surname>Haldane</surname><given-names>A</given-names></name><name><surname>Del Río</surname><given-names>JF</given-names></name><name><surname>Wiebe</surname><given-names>M</given-names></name><name><surname>Peterson</surname><given-names>P</given-names></name><name><surname>Gérard-Marchant</surname><given-names>P</given-names></name><name><surname>Sheppard</surname><given-names>K</given-names></name><name><surname>Reddy</surname><given-names>T</given-names></name><name><surname>Weckesser</surname><given-names>W</given-names></name><name><surname>Abbasi</surname><given-names>H</given-names></name><name><surname>Gohlke</surname><given-names>C</given-names></name><name><surname>Oliphant</surname><given-names>TE</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Array programming with NumPy</article-title><source>Nature</source><volume>585</volume><fpage>357</fpage><lpage>362</lpage><pub-id pub-id-type="doi">10.1038/s41586-020-2649-2</pub-id><pub-id pub-id-type="pmid">32939066</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hubbell</surname><given-names>SP</given-names></name></person-group><year iso-8601-date="2001">2001</year><source>The Unified Neutral Theory of Biodiversity and Biogeography (MPB-32)</source><publisher-name>Princeton University Press</publisher-name></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huerta-Cepas</surname><given-names>J</given-names></name><name><surname>Forslund</surname><given-names>K</given-names></name><name><surname>Coelho</surname><given-names>LP</given-names></name><name><surname>Szklarczyk</surname><given-names>D</given-names></name><name><surname>Jensen</surname><given-names>LJ</given-names></name><name><surname>von Mering</surname><given-names>C</given-names></name><name><surname>Bork</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Fast Genome-Wide Functional Annotation through Orthology Assignment by eggNOG-Mapper</article-title><source>Molecular Biology and Evolution</source><volume>34</volume><fpage>2115</fpage><lpage>2122</lpage><pub-id pub-id-type="doi">10.1093/molbev/msx148</pub-id><pub-id pub-id-type="pmid">28460117</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kanehisa</surname><given-names>M</given-names></name><name><surname>Furumichi</surname><given-names>M</given-names></name><name><surname>Tanabe</surname><given-names>M</given-names></name><name><surname>Sato</surname><given-names>Y</given-names></name><name><surname>Morishima</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>KEGG: new perspectives on genomes, pathways, diseases and drugs</article-title><source>Nucleic Acids Research</source><volume>45</volume><fpage>D353</fpage><lpage>D361</lpage><pub-id pub-id-type="doi">10.1093/nar/gkw1092</pub-id><pub-id pub-id-type="pmid">27899662</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karatan</surname><given-names>E</given-names></name><name><surname>Saulmon</surname><given-names>MM</given-names></name><name><surname>Bunn</surname><given-names>MW</given-names></name><name><surname>Ordal</surname><given-names>GW</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Phosphorylation of the response regulator CheV is required for adaptation to attractants during <italic>Bacillus subtilis</italic> chemotaxis</article-title><source>The Journal of Biological Chemistry</source><volume>276</volume><fpage>43618</fpage><lpage>43626</lpage><pub-id pub-id-type="doi">10.1074/jbc.M104955200</pub-id><pub-id pub-id-type="pmid">11553614</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kashtan</surname><given-names>N</given-names></name><name><surname>Roggensack</surname><given-names>SE</given-names></name><name><surname>Rodrigue</surname><given-names>S</given-names></name><name><surname>Thompson</surname><given-names>JW</given-names></name><name><surname>Biller</surname><given-names>SJ</given-names></name><name><surname>Coe</surname><given-names>A</given-names></name><name><surname>Ding</surname><given-names>H</given-names></name><name><surname>Marttinen</surname><given-names>P</given-names></name><name><surname>Malmstrom</surname><given-names>RR</given-names></name><name><surname>Stocker</surname><given-names>R</given-names></name><name><surname>Follows</surname><given-names>MJ</given-names></name><name><surname>Stepanauskas</surname><given-names>R</given-names></name><name><surname>Chisholm</surname><given-names>SW</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Single-cell genomics reveals hundreds of coexisting subpopulations in wild Prochlorococcus</article-title><source>Science (New York, N.Y.)</source><volume>344</volume><fpage>416</fpage><lpage>420</lpage><pub-id pub-id-type="doi">10.1126/science.1248575</pub-id><pub-id pub-id-type="pmid">24763590</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krewulak</surname><given-names>KD</given-names></name><name><surname>Vogel</surname><given-names>HJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Structural biology of bacterial iron uptake</article-title><source>Biochimica et Biophysica Acta</source><volume>1778</volume><fpage>1781</fpage><lpage>1804</lpage><pub-id pub-id-type="doi">10.1016/j.bbamem.2007.07.026</pub-id><pub-id pub-id-type="pmid">17916327</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leventhal</surname><given-names>GE</given-names></name><name><surname>Boix</surname><given-names>C</given-names></name><name><surname>Kuechler</surname><given-names>U</given-names></name><name><surname>Enke</surname><given-names>TN</given-names></name><name><surname>Sliwerska</surname><given-names>E</given-names></name><name><surname>Holliger</surname><given-names>C</given-names></name><name><surname>Cordero</surname><given-names>OX</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Strain-level diversity drives alternative community types in millimetre-scale granular biofilms</article-title><source>Nature Microbiology</source><volume>3</volume><fpage>1295</fpage><lpage>1303</lpage><pub-id pub-id-type="doi">10.1038/s41564-018-0242-3</pub-id><pub-id pub-id-type="pmid">30250246</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title><source>Bioinformatics (Oxford, England)</source><volume>34</volume><fpage>3094</fpage><lpage>3100</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id><pub-id pub-id-type="pmid">29750242</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Louca</surname><given-names>S</given-names></name><name><surname>Jacques</surname><given-names>SMS</given-names></name><name><surname>Pires</surname><given-names>APF</given-names></name><name><surname>Leal</surname><given-names>JS</given-names></name><name><surname>Srivastava</surname><given-names>DS</given-names></name><name><surname>Parfrey</surname><given-names>LW</given-names></name><name><surname>Farjalla</surname><given-names>VF</given-names></name><name><surname>Doebeli</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>High taxonomic variability despite stable functional structure across microbial communities</article-title><source>Nature Ecology &amp; Evolution</source><volume>1</volume><elocation-id>e15</elocation-id><pub-id pub-id-type="doi">10.1038/s41559-016-0015</pub-id><pub-id pub-id-type="pmid">28812567</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maeda</surname><given-names>S</given-names></name><name><surname>Omata</surname><given-names>T</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Substrate-binding lipoprotein of the cyanobacterium Synechococcus sp. strain PCC 7942 involved in the transport of nitrate and nitrite</article-title><source>The Journal of Biological Chemistry</source><volume>272</volume><fpage>3036</fpage><lpage>3041</lpage><pub-id pub-id-type="doi">10.1074/jbc.272.5.3036</pub-id><pub-id pub-id-type="pmid">9006953</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marquardt</surname><given-names>JL</given-names></name><name><surname>Siegele</surname><given-names>DA</given-names></name><name><surname>Kolter</surname><given-names>R</given-names></name><name><surname>Walsh</surname><given-names>CT</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Cloning and sequencing of <italic>Escherichia coli</italic> murZ and purification of its product, a UDP-N-acetylglucosamine enolpyruvyl transferase</article-title><source>Journal of Bacteriology</source><volume>174</volume><fpage>5748</fpage><lpage>5752</lpage><pub-id pub-id-type="doi">10.1128/jb.174.17.5748-5752.1992</pub-id><pub-id pub-id-type="pmid">1512209</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mikkelsen</surname><given-names>R</given-names></name><name><surname>Baunsgaard</surname><given-names>L</given-names></name><name><surname>Blennow</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Functional characterization of alpha-glucan,water dikinase, the starch phosphorylating enzyme</article-title><source>The Biochemical Journal</source><volume>377</volume><fpage>525</fpage><lpage>532</lpage><pub-id pub-id-type="doi">10.1042/BJ20030999</pub-id><pub-id pub-id-type="pmid">14525539</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ochman</surname><given-names>H</given-names></name><name><surname>Elwyn</surname><given-names>S</given-names></name><name><surname>Moran</surname><given-names>NA</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Calibrating bacterial evolution</article-title><source>PNAS</source><volume>96</volume><fpage>12638</fpage><lpage>12643</lpage><pub-id pub-id-type="doi">10.1073/pnas.96.22.12638</pub-id><pub-id pub-id-type="pmid">10535975</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Papp-Wallace</surname><given-names>KM</given-names></name><name><surname>Maguire</surname><given-names>ME</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Bacterial homologs of eukaryotic membrane proteins: the 2-TM-GxN family of Mg(2+) transporters</article-title><source>Molecular Membrane Biology</source><volume>24</volume><fpage>351</fpage><lpage>356</lpage><pub-id pub-id-type="doi">10.1080/09687680701441883</pub-id><pub-id pub-id-type="pmid">17710639</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Park</surname><given-names>S</given-names></name><name><surname>Meyer</surname><given-names>M</given-names></name><name><surname>Jones</surname><given-names>AD</given-names></name><name><surname>Yennawar</surname><given-names>HP</given-names></name><name><surname>Yennawar</surname><given-names>NH</given-names></name><name><surname>Nixon</surname><given-names>BT</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Two-component signaling in the AAA + ATPase DctD: binding Mg2+ and BeF3- selects between alternate dimeric states of the receiver domain</article-title><source>FASEB Journal</source><volume>16</volume><fpage>1964</fpage><lpage>1966</lpage><pub-id pub-id-type="doi">10.1096/fj.02-0395fje</pub-id><pub-id pub-id-type="pmid">12368235</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Plucain</surname><given-names>J</given-names></name><name><surname>Hindré</surname><given-names>T</given-names></name><name><surname>Le Gac</surname><given-names>M</given-names></name><name><surname>Tenaillon</surname><given-names>O</given-names></name><name><surname>Cruveiller</surname><given-names>S</given-names></name><name><surname>Médigue</surname><given-names>C</given-names></name><name><surname>Leiby</surname><given-names>N</given-names></name><name><surname>Harcombe</surname><given-names>WR</given-names></name><name><surname>Marx</surname><given-names>CJ</given-names></name><name><surname>Lenski</surname><given-names>RE</given-names></name><name><surname>Schneider</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Epistasis and allele specificity in the emergence of a stable polymorphism in <italic>Escherichia coli</italic></article-title><source>Science (New York, N.Y.)</source><volume>343</volume><fpage>1366</fpage><lpage>1369</lpage><pub-id pub-id-type="doi">10.1126/science.1248688</pub-id><pub-id pub-id-type="pmid">24603152</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Posfai</surname><given-names>A</given-names></name><name><surname>Taillefumier</surname><given-names>T</given-names></name><name><surname>Wingreen</surname><given-names>NS</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Metabolic Trade-Offs Promote Diversity in a Model Ecosystem</article-title><source>Physical Review Letters</source><volume>118</volume><elocation-id>028103</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.118.028103</pub-id><pub-id pub-id-type="pmid">28128613</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramsayer</surname><given-names>J</given-names></name><name><surname>Fellous</surname><given-names>S</given-names></name><name><surname>Cohen</surname><given-names>JE</given-names></name><name><surname>Hochberg</surname><given-names>ME</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Taylor’s Law holds in experimental bacterial populations but competition does not influence the slope</article-title><source>Biology Letters</source><volume>8</volume><fpage>316</fpage><lpage>319</lpage><pub-id pub-id-type="doi">10.1098/rsbl.2011.0895</pub-id><pub-id pub-id-type="pmid">22072282</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Roodgar</surname><given-names>M</given-names></name><name><surname>Good</surname><given-names>BH</given-names></name><name><surname>Garud</surname><given-names>NR</given-names></name><name><surname>Martis</surname><given-names>S</given-names></name><name><surname>Avula</surname><given-names>M</given-names></name><name><surname>Zhou</surname><given-names>W</given-names></name><name><surname>Lancaster</surname><given-names>S</given-names></name><name><surname>Lee</surname><given-names>H</given-names></name><name><surname>Babveyh</surname><given-names>A</given-names></name><name><surname>Nesamoney</surname><given-names>S</given-names></name><name><surname>Pollard</surname><given-names>KS</given-names></name><name><surname>Snyder</surname><given-names>MP</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Phospho-Signal Flow from a Pole-Localized Microdomain Spatially Patterns Transcription Factor Activity</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2019.12.21.886093</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rousk</surname><given-names>J</given-names></name><name><surname>Bengtson</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Microbial regulation of global biogeochemical cycles</article-title><source>Frontiers in Microbiology</source><volume>5</volume><elocation-id>103</elocation-id><pub-id pub-id-type="doi">10.3389/fmicb.2014.00103</pub-id><pub-id pub-id-type="pmid">24672519</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schloissnig</surname><given-names>S</given-names></name><name><surname>Arumugam</surname><given-names>M</given-names></name><name><surname>Sunagawa</surname><given-names>S</given-names></name><name><surname>Mitreva</surname><given-names>M</given-names></name><name><surname>Tap</surname><given-names>J</given-names></name><name><surname>Zhu</surname><given-names>A</given-names></name><name><surname>Waller</surname><given-names>A</given-names></name><name><surname>Mende</surname><given-names>DR</given-names></name><name><surname>Kultima</surname><given-names>JR</given-names></name><name><surname>Martin</surname><given-names>J</given-names></name><name><surname>Kota</surname><given-names>K</given-names></name><name><surname>Sunyaev</surname><given-names>SR</given-names></name><name><surname>Weinstock</surname><given-names>GM</given-names></name><name><surname>Bork</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Genomic variation landscape of the human gut microbiome</article-title><source>Nature</source><volume>493</volume><fpage>45</fpage><lpage>50</lpage><pub-id pub-id-type="doi">10.1038/nature11711</pub-id><pub-id pub-id-type="pmid">23222524</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spor</surname><given-names>A</given-names></name><name><surname>Koren</surname><given-names>O</given-names></name><name><surname>Ley</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Unravelling the effects of the environment and host genotype on the gut microbiome</article-title><source>Nature Reviews. Microbiology</source><volume>9</volume><fpage>279</fpage><lpage>290</lpage><pub-id pub-id-type="doi">10.1038/nrmicro2540</pub-id><pub-id pub-id-type="pmid">21407244</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Temple</surname><given-names>LM</given-names></name><name><surname>Forsburg</surname><given-names>SL</given-names></name><name><surname>Calendar</surname><given-names>R</given-names></name><name><surname>Christie</surname><given-names>GE</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Nucleotide sequence of the genes encoding the major tail sheath and tail tube proteins of bacteriophage P2</article-title><source>Virology</source><volume>181</volume><fpage>353</fpage><lpage>358</lpage><pub-id pub-id-type="doi">10.1016/0042-6822(91)90502-3</pub-id><pub-id pub-id-type="pmid">1825255</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tersteegen</surname><given-names>A</given-names></name><name><surname>Linder</surname><given-names>D</given-names></name><name><surname>Thauer</surname><given-names>RK</given-names></name><name><surname>Hedderich</surname><given-names>R</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Structures and functions of four anabolic 2-oxoacid oxidoreductases in Methanobacterium thermoautotrophicum</article-title><source>European Journal of Biochemistry</source><volume>244</volume><fpage>862</fpage><lpage>868</lpage><pub-id pub-id-type="doi">10.1111/j.1432-1033.1997.00862.x</pub-id><pub-id pub-id-type="pmid">9108258</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tikhonov</surname><given-names>M</given-names></name><name><surname>Leach</surname><given-names>RW</given-names></name><name><surname>Wingreen</surname><given-names>NS</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Interpreting 16S metagenomic data without clustering to achieve sub-OTU resolution</article-title><source>The ISME Journal</source><volume>9</volume><fpage>68</fpage><lpage>80</lpage><pub-id pub-id-type="doi">10.1038/ismej.2014.117</pub-id><pub-id pub-id-type="pmid">25012900</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Rossum</surname><given-names>T</given-names></name><name><surname>Ferretti</surname><given-names>P</given-names></name><name><surname>Maistrenko</surname><given-names>OM</given-names></name><name><surname>Bork</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Diversity within species: interpreting strains in microbiomes</article-title><source>Nature Reviews. Microbiology</source><volume>18</volume><fpage>491</fpage><lpage>506</lpage><pub-id pub-id-type="doi">10.1038/s41579-020-0368-1</pub-id><pub-id pub-id-type="pmid">32499497</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Virtanen</surname><given-names>P</given-names></name><name><surname>Gommers</surname><given-names>R</given-names></name><name><surname>Oliphant</surname><given-names>TE</given-names></name><name><surname>Haberland</surname><given-names>M</given-names></name><name><surname>Reddy</surname><given-names>T</given-names></name><name><surname>Cournapeau</surname><given-names>D</given-names></name><name><surname>Burovski</surname><given-names>E</given-names></name><name><surname>Peterson</surname><given-names>P</given-names></name><name><surname>Weckesser</surname><given-names>W</given-names></name><name><surname>Bright</surname><given-names>J</given-names></name><name><surname>van der Walt</surname><given-names>SJ</given-names></name><name><surname>Brett</surname><given-names>M</given-names></name><name><surname>Wilson</surname><given-names>J</given-names></name><name><surname>Millman</surname><given-names>KJ</given-names></name><name><surname>Mayorov</surname><given-names>N</given-names></name><name><surname>Nelson</surname><given-names>ARJ</given-names></name><name><surname>Jones</surname><given-names>E</given-names></name><name><surname>Kern</surname><given-names>R</given-names></name><name><surname>Larson</surname><given-names>E</given-names></name><name><surname>Carey</surname><given-names>CJ</given-names></name><name><surname>Polat</surname><given-names>İ</given-names></name><name><surname>Feng</surname><given-names>Y</given-names></name><name><surname>Moore</surname><given-names>EW</given-names></name><name><surname>VanderPlas</surname><given-names>J</given-names></name><name><surname>Laxalde</surname><given-names>D</given-names></name><name><surname>Perktold</surname><given-names>J</given-names></name><name><surname>Cimrman</surname><given-names>R</given-names></name><name><surname>Henriksen</surname><given-names>I</given-names></name><name><surname>Quintero</surname><given-names>EA</given-names></name><name><surname>Harris</surname><given-names>CR</given-names></name><name><surname>Archibald</surname><given-names>AM</given-names></name><name><surname>Ribeiro</surname><given-names>AH</given-names></name><name><surname>Pedregosa</surname><given-names>F</given-names></name><name><surname>van Mulbregt</surname><given-names>P</given-names></name><collab>SciPy 1.0 Contributors</collab></person-group><year iso-8601-date="2020">2020</year><article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title><source>Nature Methods</source><volume>17</volume><fpage>261</fpage><lpage>272</lpage><pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id><pub-id pub-id-type="pmid">32015543</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wargo</surname><given-names>MJ</given-names></name><name><surname>Szwergold</surname><given-names>BS</given-names></name><name><surname>Hogan</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Identification of two gene clusters and a transcriptional regulator required for <italic>Pseudomonas aeruginosa</italic> glycine betaine catabolism</article-title><source>Journal of Bacteriology</source><volume>190</volume><fpage>2690</fpage><lpage>2699</lpage><pub-id pub-id-type="doi">10.1128/JB.01393-07</pub-id><pub-id pub-id-type="pmid">17951379</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>S</given-names></name><name><surname>Lieberman</surname><given-names>TD</given-names></name><name><surname>Poyet</surname><given-names>M</given-names></name><name><surname>Kauffman</surname><given-names>KM</given-names></name><name><surname>Gibbons</surname><given-names>SM</given-names></name><name><surname>Groussin</surname><given-names>M</given-names></name><name><surname>Xavier</surname><given-names>RJ</given-names></name><name><surname>Alm</surname><given-names>EJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Adaptive Evolution within Gut Microbiomes of Healthy People</article-title><source>Cell Host &amp; Microbe</source><volume>25</volume><fpage>656</fpage><lpage>667</lpage><pub-id pub-id-type="doi">10.1016/j.chom.2019.03.007</pub-id><pub-id pub-id-type="pmid">31028005</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.74987.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Weigel</surname><given-names>Detlef</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0243gzr89</institution-id><institution>Max Planck Institute for Biology Tübingen</institution></institution-wrap><country>Germany</country></aff></contrib></contrib-group><related-object id="sa0ro1" link-type="continued-by" object-id="10.1101/2021.01.04.425224" object-id-type="id" xlink:href="https://sciety.org/articles/activity/10.1101/2021.01.04.425224"/></front-stub><body><p>How easily is one species replaced by another system in an ecosystem, and what does it take so that two species are no longer equivalent? This is a central issue of ecology, which has been addressed in this elegant study. The rule of thumb the authors come up with, that genetic differences between two bacterial strains greater than about 100 bp are a good predictor of these strains being no longer ecologically equivalent, is likely to be one that will be highly cited in future.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.74987.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Weigel</surname><given-names>Detlef</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0243gzr89</institution-id><institution>Max Planck Institute for Biology Tübingen</institution></institution-wrap><country>Germany</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2021.01.04.425224">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2021.01.04.425224v1">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Interactions between strains govern the eco-evolutionary dynamics of microbial communities&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, and the evaluation has been overseen by me as Senior and Reviewing Editor. The reviewers have opted to remain anonymous.</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>A central question in ecology is to what extent individual species can be replaced by other species with similar functional attributes. This study addresses this question using an innovative approach that begins with natural microbial communities harvested from similar niches in nature, bringing these communities to the lab and then letting them evolve under identical conditions. The conclusion is that even seemingly minor genetic differences can have outsized effects. Importantly, the authors come up with a rule of thumb, that genetic differences between two strains greater than about 100 bp are a good predictor of these strains being no longer ecologically equivalent. Because this number is easy to remember, it will likely be broadly cited, and it is therefore important to ensure that this estimate is not too far off the mark.</p><p>Essential revisions:</p><p>I would like you to address all the comments of the reviewers, but please pay particular attention to the following items:</p><p>1. There needs to be a better understanding of what &quot;strain&quot; means. Please explore the data more fully to estimate how many different lineages correspond to single &quot;strains&quot;. If you have good arguments that strains are the equivalent of isolates, please state so.</p><p>2. Determine whether different strains are likely to have diverged within the host, or whether they constitute different colonization events.</p><p>3. State effect sizes when discussing inter-specific versus intra-specific correlations.</p><p>4. State how well the statistical approach used can detect positively or negatively coupled oscillations with or without a time-lag between strains, and explore how robust the conclusions are if these patterns remain undetected.</p><p>5. State if the correlational analysis would allow the identification of higher-order interactions.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>Species were defined as having identical 16S rRNA (l. 97-98), a practice known as amplicon sequence variants (ASVs). Normally, V4 region sequencing is usually resolved to operational taxonomic units (OTUs) of 97% similarity representing something between the species and general level. There are benefits for either method, and ASVs may be problematic due to dissimilarities between different copies of the 16S rRNA V4 region in the same microbe. Also, different species in certain genera may have similar V4 regions. Since much of the accuracy of their method depends on this species inference, the authors should detail how they resolve species and possibly compare it to alternative methods.</p><p>Strains were resolved from SNPs that were highly correlated (mean R=0.8 according to line 144-145). What if this threshold changed? Would there be additional strains? How would that affect the cross correlation between strains within a species? Does the number of reads mapped to a certain genome affect this figure? Figure S5 shows a clear separation between strains (although in both panels one could spot 3 and not 2 strains), but how does this look in other species? If it's not as clear, this requires some benchmarking of clustering thresholds to see if the conclusion still holds.</p><p>Some of the results depend on the steady-state of the microbial community. The authors state there is a 31% temporal coefficient of variation (l. 106). Is that a little? A lot? How does it affect the relevant results? Figure S1 shows communities that are more stable than others: while M01 and M08 seem very stable, M02, M04, M06 and M10 seem quite variable. How do the results differ between stable and unstable communities?</p><p>All strain-strain correlation histograms and plots show a range of [0,1], but the range of coefficients for the Pearson correlation is [-1,1]. How do the authors explain this discrepancy? I could not understand it from the Methods section. In the case that only the magnitude of correlation (its absolute value) was considered, this is probably wrong, as two strains that have a negative correlation should probably not be considered coupled.</p><p>Question:</p><p>Does the distribution across genes of the SNPs separating two across genes determine strain dynamics? I.e., do you see clearer separation between strains if the SNPs fall within a certain functional group?</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>1. The authors have performed a number of interesting analyses of the genetic basis of strain coexistence. Looking at Figure 2C, it is clear that when there are O(104), strains are nearly always decoupled, whereas strains with &lt;O(102) SNVs between them are nearly always coupled (a fact which the authors comment on). Interestingly, recent studies on the human gut microbiome (Garud, Good et al., 2019 and Zhao, Lieberman et al., 2019) estimated the number of SNVs which segregate between strains of a species found in unrelated human hosts is also O(104), while much smaller numbers of segregating sites (O(102)) accumulate due to clonal diversification within the host. This opens the interesting possibility, which the authors might consider exploring, that “coupled” strains are lineages which diversified within the host plant at some point prior to transplantation to the lab, while “decoupled” strains are strains which independently colonized the host. If the authors are able to confidently reconstruct haplotypes using the strai“ phasin” scheme employed, it should be straightforward to estimate the time to the most recent common ancestor (TMRCA) between coexisting strains, and then compare this number with the lifespan of the plant host species. This analysis would be highly interesting, as it might clarify the timescales over which evolutionary modifications accumulate into meaningful ecological differences between strains.</p><p>2. The authors outline an elegant model to determine if strain interactions are stronger than expected under an ecological null model in their Methods section (lines 652 – 686) and then actually use the significance test developed there to show that strains have a denser network of interactions than species in one community (M07), a result which is only shown in Supplementary Figure 15. Why is this analysis relegated to the Supplement? So far as I can tell, this network of interactions analysis is in fact not referenced in the main text, which seems a pity as it is an interesting analysis. Additionally, what do the results of this network of interactions analysis look like in the other 9 communities? If strains typically have a denser network of interactions across communities – if not, does this impact the conclusions of the paper?</p><p>3. I personally feel this test of interaction significance is in fact stronger than the relabeling scheme outlined in the main text as it tests for the significance of interactions relative to a well-defined model.</p><p>4. To build off the previous point, it strikes me as necessary to actually establish that inter-specific strain correlations are actually meaningfully stronger than species correlations, rather than just stronger. Are 76% of strain couplings significantly stronger than the corresponding species abundance trajectories, or marginally so? It would be helpful if the authors could mention the effect sizes at play here</p><p>5. Additionally, I am confused as to why the correlation between species abundance trajectories is not simply a weighted average of the respective strain abundance correlations.</p><p>6. I would argue that the model outlined in the Methods, which is used to build the interaction network is not a “neutral” model (line 664), as the authors state. Rather, it is an ecological null model.</p><p>7. Could the reason that strain abundances appear more “dynamic” have something to do with the relatively greater strength of sampling noise within vs. between species? I would imagine that there could be greater variance in strain abundances/differences in correlations due to the fact that species abundances/correlations were measured using 16S and strain dynamics were measured with shotgun reads. Why not standardize everything with shotgun reads? Species abundances can be estimated using shotgun reads, as well. This strikes me as a potentially important source of technical noise.</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>– Please explain in the main manuscript (i) how sensitive the statistical approach used is to also detect positively or negatively coupled oscillations with or without a time-lag between strains, (ii) how robust the conclusion are if these patterns remain undetected, and (iii) if the correlational analysis would allow to identify also higher-order interactions (i.e. beyond pairwise, including dynamics resulting from &gt;3 way interactions).</p><p>– I do not fully understand the importance of pseudogenization for this study. The statement in Line 386 about deactivation of genes that do not contribute to fitness is very general and I would expect this phenomenon to be independent of strain-level differentiation. Therefore, also the conclusion in Line 388, that non-functional pseudogenization contributes to strain-specific interactions is not fully clear. Please clarify.</p><p>– I would like to suggest the following (new) title to better reflect the main finding of the study: „Strain-level rather than species-level differences govern eco-evolutionary dynamics in microbial communities”.</p><p>– The authors ask what SNPs lead to a decoupling of strains. However, would it also be possible to define a set of genes that lead to coupling? For example, can some metabolic interactions (cross-feeding, competition, etc.) be inferred from strains that showed coupling? This would significantly enhance the manuscript, because it would provide a mechanistic explanation for the observed pattern.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.74987.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>I would like you to address all the comments of the reviewers, but please pay particular attention to the following items:</p><p>1. There needs to be a better understanding of what “strain” means. Please explore the data more fully to estimate how many different lineages correspond to single “strains”. If you have good arguments that strains are the equivalent of isolates, please state so.</p></disp-quote><p>We have added new text and analysis to support the notion that each of our strains correspond to distinct lineages, which diverged outside the pitchers from which they were sampled. We have also clarified our usage of the word “strain”, both in the Results and Methods sections, as well as new Supplementary Figures showing that our assignment of strains is robust to the clustering methods we employed.</p><disp-quote content-type="editor-comment"><p>2. Determine whether different strains are likely to have diverged within the host, or whether they constitute different colonization events.</p></disp-quote><p>As suggested, we have now performed this analysis, based on which we believe that the presence of each separate strain corresponds to a different colonization event (Reviewer #2, point 1).</p><disp-quote content-type="editor-comment"><p>3. State effect sizes when discussing inter-specific versus intra-specific correlations.</p></disp-quote><p>We have now calculated and reported the effect sizes of the greater strength of intra-specific correlations in the text (lines 271).</p><disp-quote content-type="editor-comment"><p>4. State how well the statistical approach used can detect positively or negatively coupled oscillations with or without a time-lag between strains, and explore how robust the conclusions are if these patterns remain undetected.</p></disp-quote><p>The revised text now explicitly states our temporal limit of resolution, and argues why our results are robust to only being able to correlations within this resolution (lines 703-713).</p><disp-quote content-type="editor-comment"><p>5. State if the correlational analysis would allow the identification of higher-order interactions.</p></disp-quote><p>We have now discussed that more data would be needed to identify higher-order interactions using our method (lines 709-713).</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>Species were defined as having identical 16S rRNA (l. 97-98), a practice known as amplicon sequence variants (ASVs). Normally, V4 region sequencing is usually resolved to operational taxonomic units (OTUs) of 97% similarity representing something between the species and general level. There are benefits for either method, and ASVs may be problematic due to dissimilarities between different copies of the 16S rRNA V4 region in the same microbe. Also, different species in certain genera may have similar V4 regions. Since much of the accuracy of their method depends on this species inference, the authors should detail how they resolve species and possibly compare it to alternative methods.</p></disp-quote><p>We understand the reviewer’s concern that there might be a few different ways to identify “species” in our communities: either coarsely-resolved OTUs or finely-resolved ASVs. We have two points to make in this regard, depending on two possible interpretations of their comment.</p><p>First: the reviewer is asking us to be more careful and explicit about using the term &quot;species&quot; for identical 16S ribotypes or ASVs, because historically species used to imply OTUs. As suggested, in the revised manuscript, we have included new text clarifying our usage of the term, as well as clearly explaining in detail how we resolved species (lines 142 and 517).</p><p>Second: the reviewer is asking us to be more coarse in our resolution by looking at OTUs. However, we believe that for our manuscript, it’s essential to work at the highest level of resolution, since our point is that even at finer resolutions, there are differences in eco-evolutionary dynamics. Even when we resolve dynamics finer than identical 16S ribotypes (ASVs), we see strains with decoupled dynamics. This key takeaway of our work will remain unchanged even if we coarsen the resolution and perform our analysis at the OTU level, which was historically used to delineate species due to the lack of accurate sequencing technology and ASV-resolving algorithms.</p><disp-quote content-type="editor-comment"><p>Strains were resolved from SNPs that were highly correlated (mean R=0.8 according to line 144-145). What if this threshold changed? Would there be additional strains? How would that affect the cross correlation between strains within a species? Does the number of reads mapped to a certain genome affect this figure? Figure S5 shows a clear separation between strains (although in both panels one could spot 3 and not 2 strains), but how does this look in other species? If it's not as clear, this requires some benchmarking of clustering thresholds to see if the conclusion still holds.</p></disp-quote><p>As requested by the reviewer, in the revised manuscript, we have included a new Figure 1 —figure supplement 7 showing more examples of SNP clusters, as well as a histogram of the number of clusters observed across the entire dataset. In what follows, we will respond to the reviewer’s questions in this comment.</p><p>First, we wish to clarify that we did not use a threshold correlation value to resolve strains from SNPs. In lines 151 of the original manuscript, we reported the average correlation between the SNPs trajectories of a species, which we stated was quite high (0.8). The value of the average correlation coefficient suggests genetic linkage between SNPs. Importantly, it was not used to calculate the number of strains; for that, we used the clustering approaches outlined in Methods (lines 570-582). Two different approaches suggested that we could not resolve more than two strains for any species in our data, in part due to limitations of sequencing depth, temporal sampling, etc., which we have highlighted in lines 592-595. Thus, we believe that our results regarding strain-strain correlations, given our data, are robust to methodological changes.</p><p>Second, Figure 1 —figure supplement 6 shows 2 clusters of SNPs and one set of unclustered SNPs (which do not cluster together by temporal correlation), but as shown in Figure 1 —figure supplement 5 and explained in lines 570-582, the last set of unclustered SNPs always corresponds to a set of ‘nearly fixed’ SNPs, with frequencies close to 1. Using the pigeonhole principle, our interpretation of such a cluster of fixed SNPs is that these SNPs don’t represent a distinct strain; instead they represent mutations in both strains relative to our reference genome (which is why they show up as SNPs), and that these mutations are common to both strains (which is why their frequency is always ~1 in the sample).</p><disp-quote content-type="editor-comment"><p>Some of the results depend on the steady-state of the microbial community. The authors state there is a 31% temporal coefficient of variation (l. 106). Is that a little? A lot? How does it affect the relevant results? Figure S1 shows communities that are more stable than others: while M01 and M08 seem very stable, M02, M04, M06 and M10 seem quite variable. How do the results differ between stable and unstable communities?</p></disp-quote><p>To us, a temporal coefficient of variation of 0.31 implies low abundance fluctuations compared to the mean abundance of each species. When communities are far from steady state (as in the first 3-4 transfers of our experiment, see Bittleston et al., <italic>Nat. Comms.</italic> (2020)), changes in relative abundances are much larger than the mean abundance (temporal coefficient of variation much larger than 1).</p><p>Further, we have more evidence which suggests that the communities are near steady-state. Figure 1 —figure supplement 2 shows a low-dimensional representation of the dynamics of all communities at the 16S level, using NMDS. This plot also shows that community compositions do not fluctuate wildly, instead staying within a small region of NMDS space around their respective equilibria.</p><p>That being said, we understand the reviewer’s concern that some communities will have more variable dynamics than others. To demonstrate that the variability in dynamics does not systematically affect our main results, we have included a new Figure 3 —figure supplement 2, similar to Figure 3b, which shows a scatter plot of species- and strain-level correlations colored by individual communities. This plot shows that more variable communities (M02 or M10) are not more likely to have higher strain-level correlations than less variable communities (M01 or M08).</p><disp-quote content-type="editor-comment"><p>All strain-strain correlation histograms and plots show a range of [0,1], but the range of coefficients for the Pearson correlation is [-1,1]. How do the authors explain this discrepancy? I could not understand it from the Methods section. In the case that only the magnitude of correlation (its absolute value) was considered, this is probably wrong, as two strains that have a negative correlation should probably not be considered coupled.</p></disp-quote><p>We only plotted the magnitude of strain-strain correlations, but we understand the reviewer’s concern regarding negative correlations. There are two reasons why we plotted the magnitude of correlation coefficients: (1) for simplicity, and (2) because there were very few negative correlations, most of low magnitude (&lt;0.3). The latter were correctly classified as decoupled even under the simpler magnitude-only definition of coupling. In the revised manuscript, we have included the full distribution of strain-strain correlations, with their sign, to demonstrate our point (Figure 2 —figure supplement 3). We have also explicitly discussed it in lines 696-699 of the revised manuscript.</p><disp-quote content-type="editor-comment"><p>Question:</p><p>Does the distribution across genes of the SNPs separating two across genes determine strain dynamics? I.e., do you see clearer separation between strains if the SNPs fall within a certain functional group?</p></disp-quote><p>This is an intriguing point, one that we had also thought about while originally analyzing the data. Unfortunately we found no such clear functional gene groups that distinguished strains based on their dynamics, outside of the usual gene groups that differentiated coexisting strains, i.e., transporters, regulators and carbon-catabolizing enzymes (Figure 4a).</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>1. The authors have performed a number of interesting analyses of the genetic basis of strain coexistence. Looking at Figure 2C, it is clear that when there are O(104), strains are nearly always decoupled, whereas strains with &lt;O(102) SNVs between them are nearly always coupled (a fact which the authors comment on). Interestingly, recent studies on the human gut microbiome (Garud, Good et al., 2019 and Zhao, Lieberman et al., 2019) estimated the number of SNVs which segregate between strains of a species found in unrelated human hosts is also O(104), while much smaller numbers of segregating sites (O(102)) accumulate due to clonal diversification within the host. This opens the interesting possibility, which the authors might consider exploring, that &quot;coupled&quot; strains are lineages which diversified within the host plant at some point prior to transplantation to the lab, while &quot;decoupled&quot; strains are strains which independently colonized the host. If the authors are able to confidently reconstruct haplotypes using the strain phasing scheme employed, it should be straightforward to estimate the time to the most recent common ancestor (TMRCA) between coexisting strains, and then compare this number with the lifespan of the plant host species. This analysis would be highly interesting, as it might clarify the timescales over which evolutionary modifications accumulate into meaningful ecological differences between strains.</p></disp-quote><p>This is an excellent and very interesting suggestion, and we would like to thank the reviewer for it. In the revised manuscript, we have reported the results of the suggested analysis (lines 141-144 and lines 677-687). We found that the lifetime of a single pitcher (~3 months) is much shorter than the average fixation time for even a single mutation (~1 year; details of the calculation in Methods, lines 677-687). Therefore, we believe that it is highly unlikely that any pair of strains, which we observed to coexist, diverged during the lifetime of a single pitcher.</p><p>Our understanding is thus that each strain pair most likely arrived in the same pitcher via distinct colonization events. They may have diverged in association with other pitchers in the same population (the community persists in a frozen block of ice in a pitcher over winter). From this metapopulation, the strains may have dispersed into the pitchers we sampled (perhaps from older, neighboring pitchers).</p><disp-quote content-type="editor-comment"><p>2. The authors outline an elegant model to determine if strain interactions are stronger than expected under an ecological null model in their Methods section (lines 652 – 686) and then actually use the significance test developed there to show that strains have a denser network of interactions than species in one community (M07), a result which is only shown in Supplementary Figure 15. Why is this analysis relegated to the Supplement? So far as I can tell, this network of interactions analysis is in fact not referenced in the main text, which seems a pity as it is an interesting analysis. Additionally, what do the results of this network of interactions analysis look like in the other 9 communities? If strains typically have a denser network of interactions across communities – if not, does this impact the conclusions of the paper?</p></disp-quote><p>We thank the reviewer for their interest in this analysis. In the revised manuscript, we have referenced and summarized this analysis in the main text (lines 278-289). The reason that we shifted this analysis to the supplement is we were repeatedly suggested to do so by colleagues in previous drafts of the manuscript, since they believed the consumer-resource model made a stronger, more convincing claim about the observed correlations being strain-specific.</p><p>With respect to the reviewer’s follow-up question: we have moved the section to Methods, and in it, we state that across all 10 communities, strain interaction networks were denser than species interaction networks, about 70% denser on average (lines 811-819 and lines 273-274 in the main text).</p><disp-quote content-type="editor-comment"><p>3. I personally feel this test of interaction significance is in fact stronger than the relabeling scheme outlined in the main text as it tests for the significance of interactions relative to a well-defined model.</p></disp-quote><p>In our opinion, both tests apply to different questions. The test of interaction significance asks for the presence of a specific interaction (whether a correlation is meaningfully different from zero), while the relabeling scheme asks about the relative magnitude of a pool of interactions. We agree that the relabeling scheme does not contain a well-defined model, but we believe our analysis using a consumer-resource model (Figure 3e-g) remedies this. Specifically, it shows that the relatively higher magnitude of strain-strain correlations compared with species-species correlations is expected only when strains are phenotypically distinct in how rapidly they grow on a variety of resources.</p><disp-quote content-type="editor-comment"><p>4. To build off the previous point, it strikes me as necessary to actually establish that inter-specific strain correlations are actually meaningfully stronger than species correlations, rather than just stronger. Are 76% of strain couplings significantly stronger than the corresponding species abundance trajectories, or marginally so? It would be helpful if the authors could mention the effect sizes at play here</p></disp-quote><p>In the revised manuscript, we have mentioned the effect sizes associated with the correlational analysis in Figure 3b (line 271). Strain-strain correlations are indeed meaningfully stronger than species-species correlations after accounting for their effect sizes, on average being larger by 0.17 ± 0.01 (one sample Student <italic>t</italic>-test, <italic>P</italic> &lt; 10<sup>-3</sup> for the mean being significantly different from zero).</p><disp-quote content-type="editor-comment"><p>5. Additionally, I am confused as to why the correlation between species abundance trajectories is not simply a weighted average of the respective strain abundance correlations.</p></disp-quote><p>We do not believe the correlation between species abundances can be obtained using only a weighted average, since the underlying strain dynamics can be decomposed in complicated ways. Consider, for instance, two species, both of whose abundance remains constant over time, but each with two strains whose dynamics are completely anticorrelated with each other. One can see through this simple example that no weighted average between the respective strain abundances (which can be quite high if constructed so), would yield a species-species correlation of zero, which is what the correlation between the two constant-abundance species would be.</p><disp-quote content-type="editor-comment"><p>6. I would argue that the model outlined in the Methods, which is used to build the interaction network is not a &quot;neutral&quot; model (line 664), as the authors state. Rather, it is an ecological null model.</p></disp-quote><p>In the original manuscript, we used the term “neutral model” because our model assumed no fitness differences between different strains (fitness represented by population growth rate at equilibrium). The term “ecological null model” is also appropriate and easier to interpret, and as suggested by the reviewer, we have replaced neutral with null in the revised manuscript. We thank the reviewer for this suggestion.</p><disp-quote content-type="editor-comment"><p>7. Could the reason that strain abundances appear more &quot;dynamic&quot; have something to do with the relatively greater strength of sampling noise within vs. between species? I would imagine that there could be greater variance in strain abundances/differences in correlations due to the fact that species abundances/correlations were measured using 16S and strain dynamics were measured with shotgun reads. Why not standardize everything with shotgun reads? Species abundances can be estimated using shotgun reads, as well. This strikes me as a potentially important source of technical noise.</p></disp-quote><p>This is a useful control. As we showed in the original manuscript, species abundance estimates from both 16S and shotgun reads agree with each other, evidenced by a strong positive correlation between them (Figure 1 —figure supplement 10). In the revised manuscript, we have included a new Figure 3 —figure supplement 3, showing our correlational analysis from Figure 3b repeated using species abundance estimated using shotgun reads. This new analysis shows that our key results still hold, i.e., the majority of strain-strain correlations are greater than species-species correlations.</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>– Please explain in the main manuscript (i) how sensitive the statistical approach used is to also detect positively or negatively coupled oscillations with or without a time-lag between strains, (ii) how robust the conclusion are if these patterns remain undetected, and (iii) if the correlational analysis would allow to identify also higher-order interactions (i.e. beyond pairwise, including dynamics resulting from &gt;3 way interactions).</p></disp-quote><p>Thank you for this suggestion. In the revised manuscript, we have now included text explaining the following:</p><p>i) our limit of detection of the time-lag between strain coupling is 37 generations, owing to our temporal resolution; we cannot detect correlations with a time lag less than this [lines 703-707];</p><p>ii) the robustness of our conclusions still stands, since the presence of any undetected correlations between strains, with a shorter time lag, would only strengthen our conclusions [lines 707-709];</p><p>iii) we do not believe that we have enough data to detect higher-order interactions with our current methods; for that, we will need to sample many more than 10 communities, so that we have plenty of cases where two strains A and B are present both in a community with another strain C, and in one without strain C [lines 709-713].</p><disp-quote content-type="editor-comment"><p>– I do not fully understand the importance of pseudogenization for this study. The statement in Line 386 about deactivation of genes that do not contribute to fitness is very general and I would expect this phenomenon to be independent of strain-level differentiation. Therefore, also the conclusion in Line 388, that non-functional pseudogenization contributes to strain-specific interactions is not fully clear. Please clarify.</p></disp-quote><p>In the revised manuscript, we have clarified how pseudogenization may contribute to strain decoupling (lines 380 and lines 398). Our goal in the section on pseudogenization was to point out that conspecific strains are different from each other not just by mutations, but also by differential pseudogenization. One of the two coexisting strains had a set of genes pseudogenized, while the other didn’t. Thus, decoupled strains might have different dynamics either due to their mutations, or their pseudogenes.</p><p>Mechanistically, our rationale was as follows: since the genes that were pseudogenized in our communities had functions that, to us, seemed irrelevant in our experimental conditions, we conjectured that strains with pseudogenes might provide a fitness advantage, in turn leading to dynamical differences, or decoupling.</p><disp-quote content-type="editor-comment"><p>– I would like to suggest the following (new) title to better reflect the main finding of the study: “Strain-level rather than species-level differences govern eco-evolutionary dynamics in microbial communities&quot;.</p></disp-quote><p>We thank the reviewer for this suggestion. We agree that the suggestion reflects the key finding of our work. We feel that our current title is shorter and easier to read, and hence we prefer to stick to it.</p><disp-quote content-type="editor-comment"><p>– The authors ask what SNPs lead to a decoupling of strains. However, would it also be possible to define a set of genes that lead to coupling? For example, can some metabolic interactions (cross-feeding, competition, etc.) be inferred from strains that showed coupling? This would significantly enhance the manuscript, because it would provide a mechanistic explanation for the observed pattern.</p></disp-quote><p>This is an interesting suggestion, and as we stated in an earlier response, one that we tried to explore in our original analysis. However, we could not detect statistical differences between gene categories of coupled and decoupled strains, only coexisting from non-coexisting strains (Figure 4 and Figure 4 —figure supplement 3 respectively).</p></body></sub-article></article>