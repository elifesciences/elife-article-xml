<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">55130</article-id><article-id pub-id-type="doi">10.7554/eLife.55130</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Short Report</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>VIP interneurons in mouse primary visual cortex selectively enhance responses to weak but specific stimuli</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-171186"><name><surname>Millman</surname><given-names>Daniel J</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6255-6085</contrib-id><email>danielm@alleninstitute.org</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-131735"><name><surname>Ocker</surname><given-names>Gabriel Koch</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-9627-9576</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-85295"><name><surname>Caldejon</surname><given-names>Shiella</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-171497"><name><surname>Kato</surname><given-names>India</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-171498"><name><surname>Larkin</surname><given-names>Josh D</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-95180"><name><surname>Lee</surname><given-names>Eric Kenji</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7166-0909</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-171499"><name><surname>Luviano</surname><given-names>Jennifer</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-171500"><name><surname>Nayan</surname><given-names>Chelsea</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-171501"><name><surname>Nguyen</surname><given-names>Thuyanh V</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-171502"><name><surname>North</surname><given-names>Kat</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con10"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-171503"><name><surname>Seid</surname><given-names>Sam</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con11"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-171504"><name><surname>White</surname><given-names>Cassandra</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con12"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-121413"><name><surname>Lecoq</surname><given-names>Jerome</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con13"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-4315"><name><surname>Reid</surname><given-names>Clay</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8697-6797</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con14"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-95966"><name><surname>Buice</surname><given-names>Michael A</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con15"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-159461"><name><surname>de Vries</surname><given-names>Saskia EJ</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3704-3499</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con16"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Allen Institute for Brain Science</institution><addr-line><named-content content-type="city">Seattle</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Vinck</surname><given-names>Martin</given-names></name><role>Reviewing Editor</role><aff><institution>Ernst Strüngmann Institute (ESI) for Neuroscience in Cooperation with Max Planck Society</institution><country>Germany</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Wassum</surname><given-names>Kate M</given-names></name><role>Senior Editor</role><aff><institution>University of California, Los Angeles</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>27</day><month>10</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e55130</elocation-id><history><date date-type="received" iso-8601-date="2020-01-13"><day>13</day><month>01</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2020-10-11"><day>11</day><month>10</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, Millman et al</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Millman et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-55130-v1.pdf"/><abstract><p>Vasoactive intestinal peptide-expressing (VIP) interneurons in the cortex regulate feedback inhibition of pyramidal neurons through suppression of somatostatin-expressing (SST) interneurons and, reciprocally, SST neurons inhibit VIP neurons. Although VIP neuron activity in the primary visual cortex (V1) of mouse is highly correlated with locomotion, the relevance of locomotion-related VIP neuron activity to visual coding is not known. Here we show that VIP neurons in mouse V1 respond strongly to low contrast front-to-back motion that is congruent with self-motion during locomotion but are suppressed by other directions and contrasts. VIP and SST neurons have complementary contrast tuning. Layer 2/3 contains a substantially larger population of low contrast preferring pyramidal neurons than deeper layers, and layer 2/3 (but not deeper layer) pyramidal neurons show bias for front-to-back motion specifically at low contrast. Network modeling indicates that VIP-SST mutual antagonism regulates the gain of the cortex to achieve sensitivity to specific weak stimuli without compromising network stability.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>Vision</kwd><kwd>cortex</kwd><kwd>inhibition</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Mouse</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution>Allen Institute for Brain Science</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Millman</surname><given-names>Daniel J</given-names></name><name><surname>Ocker</surname><given-names>Gabriel Koch</given-names></name><name><surname>Caldejon</surname><given-names>Shiella</given-names></name><name><surname>Kato</surname><given-names>India</given-names></name><name><surname>Larkin</surname><given-names>Josh D</given-names></name><name><surname>Lee</surname><given-names>Eric Kenji</given-names></name><name><surname>Luviano</surname><given-names>Jennifer</given-names></name><name><surname>Nayan</surname><given-names>Chelsea</given-names></name><name><surname>Nguyen</surname><given-names>Thuyanh V</given-names></name><name><surname>North</surname><given-names>Kat</given-names></name><name><surname>Seid</surname><given-names>Sam</given-names></name><name><surname>White</surname><given-names>Cassandra</given-names></name><name><surname>Lecoq</surname><given-names>Jerome</given-names></name><name><surname>Reid</surname><given-names>Clay</given-names></name><name><surname>Buice</surname><given-names>Michael A</given-names></name><name><surname>de Vries</surname><given-names>Saskia EJ</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Measurements of visual response to motion of different contrasts along with network modeling reveals a microcircuit in superficial layers of cortex that regulates the gain regime.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Inhibitory interneurons play a major role in establishing the dynamics of cortical microcircuits (<xref ref-type="bibr" rid="bib34">Roux and Buzsáki, 2015</xref>; <xref ref-type="bibr" rid="bib5">Cardin, 2018</xref>). In the superficial layers of the cortex, vasoactive intestinal peptide-expressing (VIP) interneurons regulate feedback inhibition of pyramidal neurons through suppression of Martinotti-type somatostatin-expressing (SST) interneurons (<xref ref-type="bibr" rid="bib30">Pfeffer et al., 2013</xref>). Through this disinhibitory mechanism, VIP interneurons are believed to modulate network dynamics based on the behavioral state of the animal; for instance, VIP neurons in mouse primary visual cortex (V1) are reliably active during periods of locomotion (<xref ref-type="bibr" rid="bib11">Fu et al., 2014</xref>). Moreover, VIP neurons in V1 are a target of top-down inputs and mediate enhancement of local pyramidal cell activity in response to activation of those inputs (<xref ref-type="bibr" rid="bib40">Zhang et al., 2014</xref>). Behaviorally, mouse V1 is necessary for the detection of low contrast visual stimuli (<xref ref-type="bibr" rid="bib12">Glickfeld et al., 2013</xref>), and the optogenetic activation of VIP neurons in mouse V1 lowers contrast detection thresholds whereas the activation of SST or PV neurons raises it (<xref ref-type="bibr" rid="bib7">Cone et al., 2019</xref>). This suggests that the perception of low contrast stimuli is strongly enhanced by VIP neuron activity in V1. Although the activity of VIP neurons has been shown to be suppressed below baseline in response to high contrast full-field grating stimuli of all tested spatial and temporal frequencies (<xref ref-type="bibr" rid="bib9">de Vries et al., 2020</xref>), the responses of VIP neurons to low contrast visual stimuli are not known. To this end, we investigated the influence of stimulus contrast and locomotion on the visual responses of VIP, SST, and pyramidal neurons in mouse V1. SST neurons responded exclusively at high contrast whereas VIP neurons responded exclusively at low contrast with a strong preference for front-to-back motion that is congruent with self-motion during locomotion. As a population, layer 2/3 – but not deeper layer – pyramidal neurons responded more strongly at low contrast than high contrast and showed a slight, but significant, bias for front-to-back motion. Finally, we made novel extensions of stabilized supralinear network (SSN) models to incorporate the diversity of inhibitory interneuron types and used these models to demonstrate that VIP-driven disinhibition at low contrast can drive large increases in pyramidal neuron activity, despite the relatively low activity of both SST and pyramidal neurons in this contrast regime. The selective enhancement of front-to-back motion could increase the detection of obstacles approaching head-on during locomotion. Based on these results, we conclude that VIP neurons amplify responses of pyramidal neurons to weak but behaviorally-relevant stimuli.</p></sec><sec id="s2" sec-type="results|discussion"><title>Results and discussion</title><p>We recorded responses to full-field (approximately 120° x 90° of visual space) drifting gratings at eight directions (with a spatial frequency of 0.04 cpd and temporal frequency of 1 Hz) and six contrasts (5–80%) during calcium imaging of mouse Cre lines for <italic>Vip</italic> and <italic>Sst</italic> as well as pyramidal neurons across cortical layers (<italic>Cux2</italic>: layer 2/3; <italic>Rorb</italic>: layer 4; <italic>Rbp4</italic>: layer 5; <italic>Ntsr1</italic>: layer 6) transgenically expressing GCaMP6f (see <xref ref-type="supplementary-material" rid="fig1sdata1">Figure 1—source data 1</xref> for numbers of neurons, sessions, and mice in the dataset). The four Cre lines used to image pyramidal neurons were chosen to limit GCaMP expression to neurons in a single layer such that fluorescence contamination from processes (e.g. axons or dendrites) of neurons with somata in different layers is minimized, while providing broad coverage of excitatory neuron types within the target layer (see Materials and methods: Experimental Animals). Although <italic>Cux2</italic> is expressed in both layers 2/3 and 4, it was only imaged in layer 2/3. <italic>Vip</italic> mice were imaged in layer 2/3 where VIP neurons are most abundant (<xref ref-type="bibr" rid="bib39">Tremblay et al., 2016</xref>), whereas <italic>Sst</italic> mice were imaged in layer 4 where SST neurons are most abundant. Notably, most, if not all, SST neurons in layer 4 of V1 are Martinotti cells (<xref ref-type="bibr" rid="bib37">Scala et al., 2019</xref>).</p><p><xref ref-type="fig" rid="fig1">Figure 1</xref> shows fluorescence traces for four example neurons, of the key Cre lines, as well as stepwise transformations to ‘events’ in the fluorescence traces and, finally, stimulus-response magnitudes and tuning curves. Events in the fluorescence trace for each neuron were detected using a changepoint detection algorithm with an L0-regularization penalty (<xref ref-type="bibr" rid="bib9">de Vries et al., 2020</xref>; <xref ref-type="bibr" rid="bib18">Jewell and Witten, 2018</xref>; <xref ref-type="bibr" rid="bib17">Jewell et al., 2019</xref>). The result is a time series of event onset times and magnitudes proportional to the change in GCaMP fluorescence; individual events likely do not correspond to single action potentials but have a bias toward bursts (<xref ref-type="bibr" rid="bib21">Ledochowitsch et al., 2019</xref>; <xref ref-type="bibr" rid="bib16">Huang et al., 2019</xref>). The response for each trial was computed as the mean event magnitude per second and averaged across trials for each condition.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Single neurons are tuned for stimulus direction and contrast.</title><p>(<bold>a</bold>) A single VIP interneuron recorded in layer 2/3 of a Vip mouse responds to low contrast with a preference for motion with a direction of 0 degrees (front-to-back). Top: In blue, 20 s of the dF/F trace for this neuron and, in black, the corresponding events extracted from the dF/F trace. Left: Event rasters for each contrast at the peak direction (0 degrees), each direction at the peak contrast (10%), and blank (i.e. 0% contrast) trials. Middle: Contrast tuning curve at the peak direction and direction tuning curve at the peak contrast; mean ± SEM. Right: Heatmap shows the mean response for all stimulus contrasts and directions. (<bold>b</bold>) Same as a, for a single SST neuron recorded in layer 4 of an Sst mouse. This neuron is tuned for high contrast with a preference for motion with a direction of ±90 (up/down). (<bold>c</bold>) Same as a, for a pyramidal neuron recorded in layer 2/3 of a Cux2 mouse. This neuron is tuned for low contrast with a preference for motion with a direction of -45 degrees. (<bold>d</bold>) Same as a, for pyramidal neuron recorded in layer 4 of a Rorb mouse. This neuron is tuned for high contrast with a preference for motion with a direction of 180 degrees (back-to-front).</p><p><supplementary-material id="fig1sdata1"><label>Figure 1—source data 1.</label><caption><title>The total number of cells, experimental sessions, and mice per Cre line.</title></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-55130-fig1-data1-v1.docx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55130-fig1-v1.tif"/></fig><p>We observed direction- or orientation-tuned neurons that responded preferentially either to high contrast gratings or low contrast gratings. The majority of neurons were responsive to the stimulus set (<xref ref-type="fig" rid="fig2">Figure 2a</xref>), measured as a statistically significant bias in responses depending on grating contrast and direction (bootstrapped χ<sup>2</sup>test, p&lt;0.01; see Materials and methods). Substantial differences in contrast and direction tuning were apparent across Cre lines (<xref ref-type="fig" rid="fig2">Figure 2b–h</xref>). Virtually all VIP neurons responded only at low (&lt;20%) contrast to front-to-back motion (0 degrees; nasal-to-temporal) or an adjacent direction (<xref ref-type="fig" rid="fig2">Figure 2b</xref>), yielding the greatest direction bias among Cre lines as quantified by the vector sum of direction preferences (<xref ref-type="fig" rid="fig2">Figure 2c</xref>). The direction of bias was consistent across all <italic>Vip</italic> mice (n = 6 sessions, 3 mice; <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>) and did not result from stimulus direction-selective running behavior (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B</xref>). High contrast gratings of all directions significantly suppressed activity in a substantial fraction of VIP neurons whereas such suppression was rare in other Cre lines (<xref ref-type="fig" rid="fig2">Figure 2d</xref>; <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). SST neurons had high contrast selectivity, weak direction and orientation selectivity, and varied direction preference (<xref ref-type="fig" rid="fig2">Figure 2b,e,g,h</xref>), resulting in an average population response that was strong at high contrast across all directions, complementing the non-direction selective suppression at high contrast observed in VIP neurons. Unlike inhibitory interneurons, pyramidal neurons exhibited substantial direction and orientation selectivity and tiled all eight possible direction preferences (<xref ref-type="fig" rid="fig2">Figure 2b,g,h</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Contrast and direction preferences are cell-type and layer specific.</title><p>(<bold>a</bold>) The fraction of imaged cells that were significantly responsive to the gratings stimulus (bootstrapped χ<sup>2</sup> test, p&lt;0.01). (<bold>b</bold>) Waterfall plots showing the response significance at each contrast and direction of all responsive cells (χ<sup>2</sup> test; p &lt; 0.01) from mice of each Cre line. Each row is one neuron and neurons are ordered by direction preference at the cell’s peak contrast. The responses to each stimulus condition are normalized per neuron to be <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>R</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the normalized response, <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the mean response to a grating with direction <italic>d</italic> and contrast <italic>c</italic>, <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the mean blank (0% contrast) response, and <inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>R</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the mean response to gratings across all directions and contrasts. (<bold>c</bold>) Radial plot of the average direction preference of cells of each Cre line at each contrast. Arrows are the vector sum of all responsive cells at a given contrast. Gray shaded region indicates a 95% confidence interval of the vector sum for a population with uniformly-distributed direction preferences, multiple comparisons corrected for the six contrasts. Scale: The distance between each pair of concentric dashed rings is 25%. N: Nasal, T: Temporal, U: Up, D: Down. (<bold>d</bold>) Fraction of all cells of each Cre line that are suppressed by contrast. The mean response to all grating directions at 80% contrast must be significantly below the mean blank response (bootstrapped distribution of mean response differences; family-wise type 1 error &lt; 0.05; see Materials and methods). (<bold>e</bold>) Distribution of contrast response types by Cre line determined by fitting of rising sigmoid (high contrast preferring), falling sigmoid (low contrast preferring), or the product of rising and falling sigmoids (intermediate contrast preferring; not shown due to a very small percentage of neurons tuned for intermediate contrasts). P-values are shown for pairwise comparisons of the fraction of high contrast preferring pyramidal neurons in each layer (bootstrap test of difference of sample proportions). See Materials and methods. (<bold>f</bold>) Cumulative distribution of contrast preferences (center-of-mass of a cell’s contrast response function; CoM) across Cre lines. (<bold>g</bold>) Cumulative distribution of global orientation selectivity indices (gOSI) across Cre lines. (<bold>h</bold>) Cumulative distribution of direction selectivity indices across Cre lines.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55130-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>The direction of VIP neuron bias was consistent across mice and did not result from stimulus direction-selective running behavior.</title><p>(<bold>a</bold>) Vector sums for each of the six Vip-Cre experiments. N: Nasal, T: Temporal, U: Up, D: Down. (<bold>b</bold>) Performance of a linear support vector classifier trained to decode the direction of grating (1-of-8 classification) from the running speed of the mouse. The average validation performance for three-fold cross-validation is shown. Each dot is the performance for one experiment; bars are the mean across experiments of a given Cre line.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55130-fig2-figsupp1-v1.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>VIP neurons have evoked responses to low contrast gratings but response suppression to high contrast gratings.</title><p>Average fluorescence responses of all VIP neurons to low (left) and high (right) contrast gratings are shown at the neuron’s preferred direction (n=63 neurons; mean ± SEM). Gray shading indicates the stimulus presentation window of 2 s; time is relative to stimulus onset.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55130-fig2-figsupp2-v1.tif"/></fig></fig-group><p>We statistically-validated the contrast tuning of neurons with a model selection procedure (see Materials and methods: Contrast response function fitting and model comparison) comparing low contrast preference, high contrast preference, and intermediate contrast preference. This analysis confirmed that nearly all VIP neurons were low contrast-preferring and nearly all SST neurons were high contrast-preferring (<xref ref-type="fig" rid="fig2">Figure 2e</xref>). Contrast preference among pyramidal neurons systematically varied across cortical layers, exhibiting a progression from a mixture of low and high contrast-preferring neurons in layer 2/3 to almost exclusively high contrast-preferring neurons in layers 5 and 6. Like VIP neurons, pyramidal neurons in layer 2/3 showed direction bias toward front-to-back motion at 5% and 10% contrast but not at higher contrasts (<xref ref-type="fig" rid="fig2">Figure 2c</xref>); pyramidal neurons in deeper layers did not have direction bias. Taken together, concerted changes in response magnitude near 20% contrast across all Cre lines and layers indicate the presence of a phase transition in cortical dynamics between a low contrast regime exemplified by relatively inactive SST neurons and a high contrast regime exemplified by highly active SST neurons.</p><p>A previous survey of transcriptomic neuron types using single-cell RNA sequencing identified 16 VIP neuron subtypes, 21 SST neuron subtypes, 3 excitatory neuron subtypes in layer 2/3, 1 excitatory type in layer 4, 12 excitatory types in layer 5, and 17 excitatory types in layer 6 (<xref ref-type="bibr" rid="bib38">Tasic et al., 2018</xref>). That study also investigated the transcriptomic neuron types labeled by the Cre lines used in the present study (see Extended Data Figure 8 of <xref ref-type="bibr" rid="bib38">Tasic et al., 2018</xref>). The <italic>Vip</italic> and <italic>Sst</italic> Cre lines label all transcriptomic subtypes of VIP and SST neurons, respectively, suggesting that common subtypes of SST neurons, such as Martinotti-type SST neurons, are all high contrast-preferring and common subtypes of VIP neurons are all low contrast-preferring. Furthermore, the <italic>Cux2</italic> and <italic>Rorb</italic> Cre lines label all transcriptomic excitatory neuron types in layers 2/3 and 4, respectively. Our finding of substantial populations of both high contrast-preferring and low contrast-preferring neurons in layer 4, where there is only a single transcriptomic excitatory neuron type, demonstrates that neurons of the same transcriptomic subtype can differ in contrast preference. In other layers, whether all neurons of a particular transcriptomic type have the same contrast tuning and, conversely, all neurons with the same contrast tuning correspond to the same transcriptomic type, are important open questions.</p><p>Studies of stimulus tuning in the visual system have long reported (<xref ref-type="bibr" rid="bib22">Levick, 1967</xref>; <xref ref-type="bibr" rid="bib33">Rodieck, 1967</xref>) a small but consistent fraction (1–5%) of neurons that exhibit firing rate suppression in response to all stimuli presented, which typically comprised of high contrast gratings, termed ‘suppressed-by-contrast’ (SbC) neurons. Consistent with a recent report (<xref ref-type="bibr" rid="bib9">de Vries et al., 2020</xref>), these results identify VIP neurons as a major source of SbC neurons in V1. Surprisingly, we observe that not only are these SbC neurons not suppressed at low contrast but that they exhibit robust visual responses to front-to-back motion in such conditions. This contributes new information to our understanding of SbC neurons in the visual circuit. The finding that VIP neurons are suppressed <italic>below</italic> baseline in response to high contrast gratings, rather than suppressed <italic>to</italic> baseline, might be due to the high spontaneous activity of VIP neurons that is available to be suppressed compared to the other neuron types measured here (see Figure 3 as well as Extended Data Figure 1 of <xref ref-type="bibr" rid="bib9">de Vries et al., 2020</xref>). Our measurements of contrast tuning suggest that the high spontaneous activity of VIP neurons enables the cortical circuit to raise or lower the amount of disinhibition of pyramidal neurons depending on stimulus contrast.</p><p>To assess the circuit-wide effects of locomotion on cortical dynamics, we examined the average activity of each neuron population as a whole. We focused here on the responses at low contrast in layers 2/3 and 4, but not layers 5 and 6 which did not respond at low contrast. Pyramidal neurons in layers 2/3 and 4, as well as VIP and SST interneurons, had increased activity during stimulus presentations when the mouse was running compared with stimulus presentations when the mouse was stationary (<xref ref-type="fig" rid="fig3">Figure 3</xref>; <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). During locomotion, the low contrast and front-to-back direction selectivity that was common to nearly all VIP neurons resulted in an average VIP population response that had tuning closely resembling the tuning of any individual VIP neuron (<xref ref-type="fig" rid="fig3">Figure 3</xref>, first column). By comparison, the VIP population only weakly responded to front-to-back motion at low contrast when the mice were stationary and did not respond to gratings of any other direction or contrast. Running also increased the SST population response to high contrast gratings, which also had the highest average response to front-to-back motion but responded strongly as a population to other directions as well (<xref ref-type="fig" rid="fig3">Figure 3</xref>, second column). The pyramidal population in layer 2/3 (CUX2) responded broadly across directions but more strongly at low than high contrast (<xref ref-type="fig" rid="fig3">Figure 3</xref>, third column), whereas the pyramidal population in layer 4 (RORB) had comparable response magnitude and running enhancement across contrasts (<xref ref-type="fig" rid="fig3">Figure 3</xref>, fourth column). This analysis demonstrates a substantial enhancement of responses to low contrast visual stimuli during locomotion that is specific to layer 2/3 pyramidal neurons and VIP neurons.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Average population responses of inhibitory, but not excitatory, cells are strongly biased toward front-to-back visual motion which is enhanced during locomotion.</title><p>(<bold>a</bold>) Mean blank-subtracted event magnitude (a.u.; extracted events derived from dF/F trace) of all neurons from mice of each superficial Cre line during stationary periods. Gray boxes in Rorb plots indicate insufficient run and stationary data. (<bold>b</bold>) Same as a, for running periods. (<bold>c</bold>) Mean population contrast responses tuning at peak direction during stationary (faint lines) and running (bold lines) periods. (<bold>d</bold>) Mean population direction response tuning at low (5-10%) contrast. Insets: mean population direction response tuning at high (60-80%) contrast. (<bold>e</bold>) Mean single-neuron direction tuning (i.e. aligned to each neuron’s peak direction). Insets: mean single-neuron direction tuning at high (60-80%) contrast. All error bars are SEM. Sample size indicates number of neurons with number of experiments in parenthesis.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55130-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Distributions of single neuron response magnitudes across stimulus conditions for key Cre lines.</title><p>(<bold>a</bold>) The distribution of responses of all VIP neurons in layer 2/3 of Vip mice by grating direction and contrast. Each dot is one neuron. Box plots show lower quartile, median (red bar), and upper quartile. (<bold>b</bold>) Same as a but for all SST neurons in layer 4 of Sst mice. (<bold>c</bold>) Same as a but for all pyramidal neurons in layer 2/3 of Cux2 mice. (<bold>d</bold>) Same as a but for all pyramidal neurons in layer 4 of Rorb mice. (<bold>e</bold>) Same as a but shown for stimulus direction relative to the cell’s peak direction (i.e. stimulus direction – peak direction). (<bold>f</bold>) Same as e but for all SST neurons in layer 4 of Sst mice. (<bold>g</bold>) Same as e but for all pyramidal neurons in layer 2/3 of Cux2 mice. (<bold>h</bold>) Same as e but for all pyramidal neurons in layer 4 of Rorb mice.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55130-fig3-figsupp1-v1.tif"/></fig></fig-group><p>We built a Generalized Linear Model of VIP, SST, and layer 2/3 pyramidal neuron responses to investigate the contribution of stimulus contrast, stimulus direction, locomotion, and the interactions between these terms to the average activity of each neuron population using a Poisson model to predict responses (<xref ref-type="fig" rid="fig4">Figure 4a</xref>). To identify only the terms that significantly contribute to activity, we included an L1-regularization penalty in the cost function which resulted in relatively few non-zero terms (12–15 non-zero out of 126 total terms). VIP neurons had the highest weights for blank sweep, low contrasts (5–20%), running, directions of 0° and 180°, running by direction interactions at 0° and 45°, and direction by contrast interactions at ±45° and low contrasts (<xref ref-type="fig" rid="fig4">Figure 4b</xref>). SST neurons had the highest weights for high contrasts (40–80%), direction of 0°, and running by direction interactions at all directions (<xref ref-type="fig" rid="fig4">Figure 4c</xref>). Layer 2/3 pyramidal neurons have significant weights only for running, low contrasts (5–20%), and all directions (<xref ref-type="fig" rid="fig4">Figure 4d</xref>). Overall, this analysis confirms the influence of running, stimulus direction, and stimulus contrast but suggests that interactions among these variables is limited.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Generalized Linear Models reveal the contribution of stimulus direction, stimulus contrast, locomotion, and the interactions between these terms, to the activity of neuronal populations.</title><p>(<bold>a</bold>) Schematic of the Poisson GLM consisting of a blank term, a binary run state term (1 for running, 0 for stationary), 8 direction terms, 6 contrast terms, 8 run x direction interaction terms, 6 run x contrast interaction terms, 48 direction x contrast interaction terms, and 48 run x direction x contrast interaction terms. The responses are predicted by summing these 126 terms and raising the sum to an exponential. (<bold>b</bold>) GLM results for the population of layer 2/3 VIP neurons recorded from Vip mice. Left: The model weights are shown as heatmaps (top) as well as means and 95% confidence intervals (bottom). Sparse weights were obtained using an L1-regularization penalty, resulting in the majority of weights to be zero. For direction x contrast and run x direction x contrast interaction terms, means and confidence intervals are only shown for terms with non-zero weights. Right: Predicted responses to stimulus conditions minus predicted blank response when the mouse is stationary (top) and running (bottom). (<bold>c</bold>) Same as b, but for the population of layer 4 SST neurons recorded from Sst mice. (<bold>d</bold>) Same as b, but for the population of layer 2/3 pyramidal neurons recorded from Cux2 mice.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55130-fig4-v1.tif"/></fig><p>Anatomical and optogenetic perturbation experiments suggest that VIP neurons disinhibit pyramidal neurons through their inhibition of SST neurons (<xref ref-type="bibr" rid="bib30">Pfeffer et al., 2013</xref>; <xref ref-type="bibr" rid="bib40">Zhang et al., 2014</xref>; <xref ref-type="bibr" rid="bib31">Pi et al., 2013</xref>). However, VIP neurons only respond to one direction of low contrast grating and SST neurons have very weak responses to low contrast gratings of any direction, potentially limiting the magnitude of SST activity that is available to be inhibited by VIP neurons and, consequently, limiting the magnitude of disinhibition of pyramidal neurons. Evidence that visual cortex has higher gain at low contrast than high contrast (<xref ref-type="bibr" rid="bib15">Heuer and Britten, 2002</xref>; <xref ref-type="bibr" rid="bib6">Cavanaugh et al., 2002</xref>; <xref ref-type="bibr" rid="bib4">Carandini and Heeger, 2012</xref>) suggests that a small reduction in feedback inhibition (e.g. disinhibition) is capable of driving a large increase in pyramidal neuron activity (<xref ref-type="bibr" rid="bib14">Hertäg and Sprekeler, 2019</xref>). We hypothesized that VIP neurons are essential to establishing the high gain regime at low contrast as a result of VIP-mediated disinhibition forming a positive feedback loop (i.e. Pyr → VIP → SST → Pyr) that depends upon, and contributes to, network dynamics. Stabilized supralinear network (SSN) models have been proposed to account for a variety of contrast-dependent response properties in visual cortex (<xref ref-type="bibr" rid="bib35">Rubin et al., 2015</xref>; <xref ref-type="bibr" rid="bib3">Ahmadian et al., 2013</xref>), including the transition from a high gain regime at low contrast to a feedback inhibition dominated low gain regime at high contrast (<xref ref-type="bibr" rid="bib2">Adesnik, 2017</xref>; <xref ref-type="bibr" rid="bib36">Sanzeni et al., 2020</xref>), as well as cortical noise correlations (<xref ref-type="bibr" rid="bib13">Hennequin et al., 2018</xref>), surround suppression (<xref ref-type="bibr" rid="bib25">Liu et al., 2018</xref>), and effects of feature and spatial attention on neural activity (<xref ref-type="bibr" rid="bib24">Lindsay et al., 2020</xref>). In SSNs, high gain is achieved through supralinear single-neuron transfer functions (e.g. f-I curve) and strong recurrent excitatory connections but the gain is eventually reduced as external input strength increases due to the recruitment of inhibitory neurons which also have supralinear transfer functions (<xref ref-type="bibr" rid="bib29">Miller and Troyer, 2002</xref>; <xref ref-type="bibr" rid="bib32">Priebe and Ferster, 2008</xref>; <xref ref-type="bibr" rid="bib26">Margrie et al., 2002</xref>; <xref ref-type="bibr" rid="bib23">Linaro et al., 2019</xref>). The ability of SSNs to account for a wide variety of phenomenology by utilizing only a few simplified but universal features of cortical circuits (e.g. recurrent excitation, feedback inhibition, and supralinear f-I curves) has established them as attractive models for explaining cortical dynamics (<xref ref-type="bibr" rid="bib20">Kraynyukova and Tchumatchenko, 2018</xref>). However, the impact of interneuron diversity on the behavior of SSNs is largely unknown.</p><p>To investigate the distinct roles of each interneuron type, we extended the SSN model from one homogeneous population of interneurons to three populations corresponding to VIP, SST, and parvalbumin-expressing (PV) neurons to model layer 2/3 of mouse V1 (<xref ref-type="fig" rid="fig5">Figure 5a</xref>; see Materials and methods for further details). Briefly, the network is a ring model in which each layer 2/3 pyramidal neuron (‘CUX2’) receives external (‘sensory’) excitatory input that has Gaussian tuning with mean (i.e. peak/preferred direction) corresponding to the neuron’s position on the ring and standard deviation of 30 degrees; PV neurons also receive external input which is not tuned (<xref ref-type="bibr" rid="bib19">Kerlin et al., 2010</xref>). SST neurons do not receive external input in our model to incorporate the finding of weak or no thalamocortical input to SST neurons in mouse somatosensory cortex (<xref ref-type="bibr" rid="bib8">Cruikshank et al., 2010</xref>). VIP neurons also do not receive external input in our model since experimental measurements of this input to VIP neurons are lacking, and eliminating this potential source of excitatory input to VIP neurons is the most conservative assumption for reproducing the strong responses of VIP neurons to weak stimuli. The strength of external input is intended to represent a monotonically-increasing function of stimulus contrast, though no specific relationship is claimed here. Connections from CUX2 neurons (i.e. excitatory connections) also have Gaussian tuning that depends on the difference between the orientation preferences of the pre- and post-synaptic neurons (<xref ref-type="fig" rid="fig5">Figure 5b</xref> top), with broader tuning of connections targeting SST and PV neurons (standard deviation of 100 degrees) than those targeting pyramidal and VIP neurons (standard deviation of 30 degrees) to reflect the relative tuning of the postsynaptic neurons types (<xref ref-type="bibr" rid="bib9">de Vries et al., 2020</xref>; <xref ref-type="bibr" rid="bib19">Kerlin et al., 2010</xref>). Connections from inhibitory neurons (i.e. inhibitory connections) were broadly tuned as well (standard deviation of 100 degrees; <xref ref-type="fig" rid="fig5">Figure 5b</xref> bottom). To incorporate the bias we measured in direction tuning, we included a minor (~2%) over-representation of pyramidal neurons that prefer the zero degrees direction as well as a bias in the direction tuning of external input for zero degrees to account for the known direction bias of thalamocortical inputs (<xref ref-type="bibr" rid="bib27">Marshel et al., 2012</xref>; <xref ref-type="bibr" rid="bib41">Zhang et al., 2020</xref>). All neurons are modeled as rate units with rectified quadratic transfer function, the simplest supralinear polynomial.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>A stabilized supralinear network (SSN) model with three interneuron populations reproduces contrast and direction tuning of multiple neuron types and implicates VIP neurons in enhancement of network gain for weak inputs.</title><p>(<bold>a</bold>) Top: The network architecture is a ring corresponding to the peak of each L2/3 pyramidal (“CUX2”) neuron’s direction tuning curve. The entire ring spans 180 degrees of direction. Bottom: A schematic illustrates the connectivity among neuron types. (<bold>b</bold>) Top: The distribution of excitatory connection strength from CUX2 pyramidal neurons onto each neuron type is Gaussian with mean equal to the difference in orientation preference of pre- and post-synaptic neurons. The distributions of recurrent connections onto CUX2 neurons and connections onto VIP neurons are narrow (standard deviation of 30 degrees) compared to the distributions onto PV and SST neurons (standard deviation of 100 degrees). Bottom: Inhibitory connection weights are all broadly tuned (standard deviation of 100 degrees). (<bold>c</bold>) The average population responses across direction and contrast conditions qualitatively reproduce experimental data for CUX2, SST, and VIP neurons shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>. (<bold>d</bold>) Left: The steady state firing rates are shown for model neurons of each type with peak direction tuning of zero degrees in response to an external input of zero degrees. Right: The steady state firing rates of the same model neurons in response to an external input of zero degrees with the VIP-to-SST connection strength set to zero demonstrates that this connection is necessary for a high gain of CUX2 and PV neurons at the low input levels for which VIP neurons are most responsive. (<bold>e</bold>) Currents to the pyramidal neurons in panel d show that most additional external excitatory input above 15 is offset by the recruitment of inhibition. Inhibition from PV neurons dominates at weak external input strengths while inhibition from SST neurons dominates at strong external input strengths. (<bold>f</bold>) The relative fraction of currents that pyramidal neurons receive from other pyramidal neurons, rather than inhibitory neurons, decreases as external input strength increases. This shows the relative dominance of inhibition over excitation in the network. (<bold>g</bold>) The linear stability of the E-E subnetwork shows a transition from non-ISN dynamics (E-E stability &lt; 0) to ISN dynamics (E-E stability &gt; 0) at an external input strength of ~55 for networks with connection weight from VIP to SST neurons below a critical value (W<sub>VIP→SST≈</sub>-0.6). Above the critical value, the E-E subnetwork is highly unstable for all external input strengths greater than ~20. (<bold>h</bold>) The firing rates of all four neuron types remain similar below the critical value of W<sub>VIP→SST</sub>, except VIP neurons which increase substantially with increasing W<sub>VIP→SST</sub> but remain most active at weak external input strengths. Above the critical value, rates of pyramidal, PV and VIP neurons increase substantially, and SST neuron rates are near zero, for all external input strengths. (<bold>i</bold>) The effect of the VIP-to-SST neuron connection on pyramidal neuron gain shows that the increase in gain occurs only at weak external input strengths. The gain effect increases with increasing W<sub>VIP→SST</sub> below the critical value. W/Wcritical for the networks shown in panels b-f is 0.99, where W is -0.6. (<bold>j-l</bold>) Same as (<bold>g-i</bold>), except varying the weight of PV inputs onto pyramidal neurons relative to the total weight of inhibitory (i.e. PV and SST) inputs onto pyramidal neurons. The external input strength at which the E-E stability (panel <bold>j</bold>) transitions from non-ISN to ISN decreases as the relative weight from PV neurons increase, but the stability behavior, firing rates (panel <bold>k</bold>), and gain effect (panel l) remain the similar until a bifurcation near W<sub>PV</sub>/(W<sub>PV</sub>+W<sub>SST</sub>)=0.8. The network becomes unstable at very high relative PV weights (W<sub>PV</sub>/(W<sub>PV</sub>+W<sub>SST</sub>) &gt;0.95). W<sub>PV</sub>/(W<sub>PV</sub>+W<sub>SST</sub>) for the networks shown in panels b-f is 0.5.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55130-fig5-v1.tif"/></fig><p>This model is able to qualitatively reproduce the population direction and contrast tuning we observed for VIP, SST, and layer 2/3 pyramidal (CUX2) neurons as well as make a prediction for the tuning of PV neurons (<xref ref-type="fig" rid="fig5">Figure 5c</xref>). Model VIP neurons are suppressed at high levels of external input regardless of stimulus direction, reproducing the suppressed-by-contrast behavior we observed in our imaging experiments, and active for all stimulus direction at low contrast but most active for the zero degrees direction, again reproducing VIP neuron tuning (<xref ref-type="fig" rid="fig3">Figure 3b</xref>). The external input strength for which VIP neurons are most active (~10 a.u.) corresponds to the highest gain (‘supralinear’) regime for L2/3 pyramidal and PV activity (<xref ref-type="fig" rid="fig5">Figure 5d</xref>: left). Ablating the VIP-to-SST inhibitory connection, the only output of VIP neurons contained in the model, results in a large reduction in the gain and activity of VIP, L2/3 pyramidal, and PV populations at low input (<xref ref-type="fig" rid="fig5">Figure 5d</xref>: right). Even in the absence of inhibition from VIP neurons, SST neurons have relatively low activity at a low level of external input, demonstrating that suppression of a relatively small amount of SST neuron activity can drive large increases in pyramidal neuron gain. These results indicate that VIP-mediated disinhibition is capable of producing substantial increases in gain at weak inputs, despite low activity of the intermediate SST neuron population, in networks with supralinear single neuron transfer functions and recurrent excitation.</p><p>The introduction of a positive feedback loop into the SSN model in the form of VIP-mediated disinhibition could have a destabilizing effect on network dynamics. A key aspect of the stability of network dynamics is whether recurrent excitation required feedback inhibition to prevent runaway activity; that is, whether the network is inhibitory stabilized (‘ISN’) or non-inhibitory stabilized (‘non-ISN’). In this context, achieving a high gain might push networks to the brink of instability. Conversely, suppressing VIP neuron activity <italic>below</italic> baseline, rather than <italic>to</italic> baseline, for high external input strength could be an important component of ensuring network stability. We assessed the stabilization regime by a linear stability analysis of the network’s response to a perturbation of the inputs that uniformly targeted all locations on the ring (Materials and methods). The excitatory-excitatory (E-E) component of the network’s linear response matrix exposes inhibitory stabilization: if it is negative, the excitatory-excitatory subnetwork has weak effective coupling and does not require inhibition to stabilize it. On the other hand, if the E-E subnetwork’s linear response is positive, but the network as a whole is stable (e.g. converges to stable steady-state rates), inhibition is required to stabilize the recurrent excitation and the network is inhibitory-stabilized, an ISN. We find that the network transitions from non-ISN to ISN as external input strength increases with a transition between stability regimes around an external input strength of 50 a.u. (<xref ref-type="fig" rid="fig5">Figure 5g</xref>), as long as the VIP-to-SST connection strength is below a critical value (normalized to be 1.0 in <xref ref-type="fig" rid="fig5">Figure 5g–i</xref>). Above the critical VIP-to-SST connection strength, the network becomes highly unstable even for low external input strengths and firing rates of pyramidal, PV, and VIP neurons explode while SST neuron activity is suppressed (<xref ref-type="fig" rid="fig5">Figure 5h</xref>). To determine the impact of VIP neurons on circuit gain, we measured the pyramidal neuron gain (i.e. the slope with respect to external input strength in <xref ref-type="fig" rid="fig5">Figure 5h</xref>) and examined the difference between that gain and the gain in a network with VIP-to-SST connection strength set to zero (but otherwise identical). This difference is greatest at the same low external input strengths for which VIP neuron activity is high and monotonically increases as a function of the VIP-to-SST connection strength until the transition to instability at the critical value (<xref ref-type="fig" rid="fig5">Figure 5i</xref>). The gain enhancement is present only at low external input strengths for which the network is in a non-ISN regime, ensuring that the impact of VIP neurons on gain does not disrupt inhibitory stabilization. Still, the external input strength at which VIP rates explode <italic>above</italic> the critical VIP-to-SST connection strength (<xref ref-type="fig" rid="fig5">Figure 5h</xref>) closely matches the external input strength at which VIP rates and network gain are the highest <italic>below</italic> the critical VIP-to-SST connection strength (<xref ref-type="fig" rid="fig5">Figure 5i</xref>), emphasizing the delicate balance of gain and stability in the cortical network. Although VIP-mediated disinhibition and increase in network gain can be destabilizing above a critical strength, this analysis demonstrates that a substantial increase in gain can be achieved over a wide range of VIP-to-SST strengths.</p><p>Finally, we also investigated the impact of the relative strength of the weight of PV inputs versus SST inputs to pyramidal neurons (W<sub>PV</sub>/(W<sub>PV</sub>+W<sub>SST</sub>); <xref ref-type="fig" rid="fig5">Figure 5j–l</xref>). Along with the strength of the VIP-to-SST connection, this ratio is a key determinant of how inhibition is recruited in the SSN. Although the external input strength at which the network transitions from non-ISN to ISN decreases as the relative weight from PV neurons increase, the stability behavior (<xref ref-type="fig" rid="fig5">Figure 5j</xref>), firing rates (<xref ref-type="fig" rid="fig5">Figure 5k</xref>), and gain effect (<xref ref-type="fig" rid="fig5">Figure 5l</xref>) remain similar over a broad range of the W<sub>PV</sub>/(W<sub>PV</sub>+W<sub>SST</sub>) ratio. Only when input from PV neurons greatly outweighs input from SST neurons, a bifurcation occurs (near W<sub>PV</sub>/(W<sub>PV</sub>+W<sub>SST</sub>)=0.8) and the network ultimately becomes unstable (near W<sub>PV</sub>/(W<sub>PV</sub>+W<sub>SST</sub>)=0.95). These results demonstrate that the stability behavior and gain effects we observe in SSNs with three interneuron populations are robust over a wide range of values for key model parameters.</p><p>This survey of contrast tuning in mouse V1 revealed two distinct regimes of cortical dynamics in superficial layers of cortex. At high contrast, SST neuron activity is high, VIP neuron activity is suppressed, and layer 2/3 pyramidal neuron activity is lower than it is at low contrast; at low contrast, SST neuron activity is low, VIP neuron activity is direction tuned and gated by locomotion, and layer 2/3 pyramidal neuron activity is higher and more enhanced by locomotion. Measurements of size tuning with high contrast gratings have shown that SST neurons prefer large gratings, suggestive of a role mediating surround suppression, whereas VIP neurons only respond to gratings smaller than those that drive SST neurons (<xref ref-type="bibr" rid="bib1">Adesnik et al., 2012</xref>; <xref ref-type="bibr" rid="bib10">Dipoppa et al., 2018</xref>). Interestingly, the receptive fields of VIP neurons are larger than those of SST or pyramidal neurons when measured with sparse noise stimuli (<xref ref-type="bibr" rid="bib9">de Vries et al., 2020</xref>), indicating that the selectivity of VIP neurons for small stimuli does not arise simply from having small linear receptive fields. This complementary size tuning parallels the complementary contrast tuning observed here, suggesting that VIP and SST neurons in V1 are tuned for weak and strong inputs, respectively, across multiple stimulus dimensions. Indeed, this relationship appears to hold across sensory modalities as VIP neurons in mouse primary auditory cortex are selective for lower sound intensities than SST or PV neurons (<xref ref-type="bibr" rid="bib28">Mesik et al., 2015</xref>). Taken together, a parsimonious explanation of these results is that VIP neuron activity supports a high gain regime that increases sensitivity to weak inputs, whereas SST neuron activity promotes a low gain regime that decreases sensitivity to strong inputs and maintains network stability. Heightened sensitivity to detect low contrast objects or obstacles approaching head-on during locomotion might be more behaviorally relevant than other directions of motion. This ability of VIP neurons to promote a high gain in the local microcircuit might be indicative of a more general role at the nexus of top-down (e.g. attention) and bottom-up (e.g. saliency) processes.</p></sec><sec id="s3" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th valign="top">Reagent type (species) <break/>or resource</th><th valign="top">Designation</th><th valign="top">Source or reference</th><th valign="top">Identifiers</th><th valign="top">Additional <break/>information</th></tr></thead><tbody><tr><td valign="top">Genetic reagent (<italic>M. musculus</italic>)</td><td valign="top"><italic>Vip</italic>-IRES-Cre</td><td valign="top">Jackson Laboratory</td><td valign="top">Stock #: 010908; RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/MGI:4436915">MGI:4436915</ext-link></td><td valign="top">Dr. Z Josh Huang (Cold Spring Harbor Laboratory)</td></tr><tr><td valign="top">Genetic reagent (<italic>M. musculus</italic>)</td><td valign="top"><italic>Sst</italic>-IRES-Cre</td><td valign="top">Jackson Laboratory</td><td valign="top">Stock #: 013044; <break/>RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/IMSR_JAX:013044">IMSR_JAX:013044</ext-link></td><td valign="top">Dr. Z Josh Huang (Cold Spring Harbor Laboratory)</td></tr><tr><td valign="top">Genetic reagent (<italic>M. musculus</italic>)</td><td valign="top"><italic>Cux2</italic>-CreERT2</td><td valign="top">MMRRC</td><td valign="top">RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/MMRRC_032779-MU">MMRRC_032779-MU</ext-link></td><td valign="top">PMID:<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pubmed/22879516">22879516</ext-link></td></tr><tr><td valign="top">Genetic reagent (<italic>M. musculus</italic>)</td><td valign="top"><italic>Rorb</italic>-IRES2-Cre</td><td valign="top">Jackson Laboratory</td><td valign="top">Stock #: 023526 <break/>RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/IMSR_JAX:023526">IMSR_JAX:023526</ext-link></td><td valign="top">PMID:<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pubmed/25071457">25071457</ext-link></td></tr><tr><td valign="top">Genetic reagent (<italic>M. musculus</italic>)</td><td valign="top"><italic>Rbp4</italic>-Cre_KL100</td><td valign="top">MMRRC</td><td valign="top">RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/MMRRC_031125-UCD">MMRRC_031125-UCD</ext-link></td><td valign="top">PMID:<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pubmed/24360541">24360541</ext-link></td></tr><tr><td valign="top">Genetic reagent (<italic>M. musculus</italic>)</td><td valign="top"><italic>Ntsr1</italic>-Cre_GN220</td><td valign="top">Jackson Laboratory</td><td valign="top">Stock #: 017266; <break/>RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/MMRRC_030648-UCD">MMRRC_030648-UCD</ext-link></td><td valign="top">PMID:<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pubmed/24360541">24360541</ext-link></td></tr><tr><td valign="top">Genetic reagent (<italic>M. musculus</italic>)</td><td valign="top"><italic>CaMKII</italic>-tTA x Ai93-GCaMP6f</td><td valign="top">Jackson Laboratory</td><td valign="top">Stock #: 024108; RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/IMSR_JAX:024108">IMSR_JAX:024108</ext-link></td><td valign="top">PMID:<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pubmed/22855807">22855807</ext-link>; PMID:<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pubmed/25741722">25741722</ext-link></td></tr><tr><td valign="top">Genetic reagent (<italic>M. musculus</italic>)</td><td valign="top">Ai148-GCaMP6f</td><td valign="top">Jackson Laboratory</td><td valign="top">Stock #: 030328; RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/IMSR_JAX:030328">IMSR_JAX:030328</ext-link></td><td valign="top">PMID:<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pubmed/30007418">30007418</ext-link></td></tr><tr><td valign="top">Software, algorithm</td><td valign="top">NumPy</td><td valign="top">NumPy</td><td valign="top">RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_008633">SCR_008633</ext-link></td><td valign="top"/></tr><tr><td valign="top">Software, algorithm</td><td valign="top">Matplotlib</td><td valign="top">MatPlotLib</td><td valign="top">RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_008624">SCR_008624</ext-link></td><td valign="top"/></tr><tr><td valign="top">Software, algorithm</td><td valign="top">pandas</td><td valign="top">pandas</td><td valign="top">DOI:<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.3509134">10.5281/zenodo.3509134</ext-link></td><td valign="top"/></tr><tr><td valign="top">Software, algorithm</td><td valign="top">statsmodel</td><td valign="top">statsmodel</td><td valign="top">RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_016074">SCR_016074</ext-link></td><td valign="top"/></tr><tr><td valign="top">Software, algorithm</td><td valign="top">scipy</td><td valign="top">SciPy</td><td valign="top">RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_008058">SCR_008058</ext-link></td><td valign="top"/></tr><tr><td valign="top">Software, algorithm</td><td valign="top">scikit-learn</td><td valign="top">scikit-learn</td><td valign="top">RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_002577">SCR_002577</ext-link></td><td valign="top"/></tr></tbody></table></table-wrap><sec id="s3-1"><title>Experimental animals</title><p>All animal procedures were approved by the Institutional Animal Care and Use Committee (IACUC) at the Allen Institute for Brain Science. Six double or triple transgenic mouse lines were used to drive expression of GCamp6/f in genetically-defined cell types, including four excitatory (<italic>Cux2</italic>-CreERT2;<italic>Camk2a</italic>-tTA;Ai93, <italic>Rorb</italic>-IRES2-Cre;<italic>Camk2a</italic>-tTA;Ai93, <italic>Rbp4</italic>-Cre_KL100;<italic>Camk2a</italic>-tTA;Ai93, and <italic>Ntsr1</italic>-Cre_GN220;Ai148) and two inhibitory (<italic>Vip</italic>-IRES-Cre;Ai148 and <italic>Sst</italic>-IRES-Cre;Ai148) mouse lines. Mice were habituated to head fixation and visual stimulus presentation for 2 weeks before data collection. Post-surgical experimental mice were housed in cages individually and maintained on a reverse dark-light cycle with experiments conducted during the dark phase. (See <xref ref-type="bibr" rid="bib9">de Vries et al., 2020</xref> for further Cre line, surgical, and habituation details). Sample size was determined qualitatively to balance repeated experiments for each layer/Cre-line and to preserve the breadth of the survey.</p><p>The correspondence between Cre lines (including all six Cre lines used in this study) and transcriptomic neuron subtypes as measured with single-cell RNA sequencing has been reported in Extended Figure 8 of <xref ref-type="bibr" rid="bib38">Tasic et al., 2018</xref>. <italic>Vip</italic>-Cre and <italic>Sst</italic>-Cre lines provide broad coverage of VIP and SST neuron transcriptomic subtypes (16 and 21 subtypes, respectively). In layer 2/3, <italic>Cux2</italic>-CreERT2 labels all three excitatory neuron transcriptomic subtypes. Layer 4 contains only a single transcriptomic neuron type, which is sampled by the <italic>Rorb</italic>-Cre line. <italic>Rbp4</italic>-Cre_KL100 labels all twelve layer 5 neuron transcriptomic subtypes; note that layer 5 was imaged at a single depth in this study, which might result in sampling only a subset of the layer 5 transcriptomic types. <italic>Ntsr1</italic>-Cre labels all six layer 6 corticothalamic neuron transcriptomic subtypes.</p></sec><sec id="s3-2"><title>Two-photon imaging platform and image processing</title><p>Data was collected using the same data collection pipeline as the Allen Brain Observatory and processed using the same image processing and event detection methods (See <xref ref-type="bibr" rid="bib9">de Vries et al., 2020</xref> for further imaging and image processing details). Calcium imaging was performed with Nikon A1R MP+ two-photon microscopes adapted to provide space to accommodate the running disc. Laser excitation with a wavelength of 910 nm was provided by a Ti:Sapphire laser (Chameleon Vision—Coherent). Precompensation was fixed at 10,000 fs<sup>2</sup>. Movies were recorded at 30 Hz with resonant scanners over a 400 μm field of view with a resolution of 512 × 512 pixels. Temporal synchronization of calcium imaging, visual stimulation, and running wheel movement was achieved by recording all experimental clocks on a single NI PCI-6612 digital IO board at 100 kHz. PMT gain and laser power were chosen for each experiment to maximize dynamic range while saturating fewer than 1000 pixels in the field of view. Two z-stacks, one local (±30 μm from imaging depth in 0.1 μm steps) and one full-depth of the cortex (~700 μm total depth in 5 μm steps), were acquired at the end of each imaging session. Z-drift was calculated from the local z-stack and experiments with z-drift of more than 10 μm during the experiment were excluded. The imaging depth of the field of view was confirmed from the full-depth cortical z-stack.</p><p>Calcium fluorescence movies were motion corrected for rigid translational errors using an algorithm based on phase correlation. ROI masks of neuronal somata were segmented from motion-corrected movies by (1) creating initial binarized masks using an adaptive fluorescence threshold, (2) applying a succession of morphological operations to fill closed holes and concave shapes, (3) computing a feature vector of each mask that included morphological attributes such as location, area, perimeter, and compactness, (4) combining or eliminating ROIs based on heuristic decisions, including attributes from the feature vectors, and (5) applying a final discrimination step using a binary relevance classifier fed by experimental metadata (e.g. Cre line and imaging depth) as well as the morphological feature vectors. Fluorescence traces were then extracted for each final ROI, which were then neuropil subtracted and corrected for overlapping ROIs by demixing traces. Neuropil contamination into the ROI contributed by the surrounding neuropil was estimated by modeling the measured ROI fluorescence as the sum of the true ROI fluorescence and a weighting of the surrounding neuropil fluorescence, <inline-formula><mml:math id="inf6"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo> <mml:mi/><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, where <inline-formula><mml:math id="inf7"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the measured fluorescence trace, <inline-formula><mml:math id="inf8"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the unknown true ROI fluorescence trace that we are trying to estimate, <inline-formula><mml:math id="inf9"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the fluorescence of the surrounding neuropil and <inline-formula><mml:math id="inf10"><mml:mi>r</mml:mi></mml:math></inline-formula> is the contamination ratio. The contamination ratio was estimated for each ROI by selecting the value for <inline-formula><mml:math id="inf11"><mml:mi>r</mml:mi></mml:math></inline-formula> that minimizes the cross-validation error, <inline-formula><mml:math id="inf12"><mml:mi>E</mml:mi><mml:mo>=</mml:mo> <mml:mi/><mml:msup><mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, over four folds. Overlapping ROIs were demixed by modeling the measured fluorescence <inline-formula><mml:math id="inf13"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of each pixel <inline-formula><mml:math id="inf14"><mml:mi>i</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf15"><mml:mi>t</mml:mi></mml:math></inline-formula> as <inline-formula><mml:math id="inf16"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo> <mml:mi/><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf17"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are time-dependent weighted masks that describe how much of each neuron <inline-formula><mml:math id="inf18"><mml:mi>k</mml:mi></mml:math></inline-formula>’s fluorescence is contained in each pixel at each timestep, and <inline-formula><mml:math id="inf19"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the fluorescence trace of the neurons that we seek to estimate. Reconstruction of calcium movies is modeled as <inline-formula><mml:math id="inf20"><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf21"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the binary spatial masks obtained in the earlier segmentation step in which <inline-formula><mml:math id="inf22"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> equals 1 if pixel <inline-formula><mml:math id="inf23"><mml:mi>i</mml:mi></mml:math></inline-formula> is in ROI <inline-formula><mml:math id="inf24"><mml:mi>k</mml:mi></mml:math></inline-formula> and equals 0 otherwise. To solve for <inline-formula><mml:math id="inf25"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> at each time <inline-formula><mml:math id="inf26"><mml:mi>t</mml:mi></mml:math></inline-formula>, we first estimated the weighted masks <inline-formula><mml:math id="inf27"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> by projection of the recorded fluorescence <inline-formula><mml:math id="inf28"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> onto the binary masks <inline-formula><mml:math id="inf29"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, then computed the linear least-squares solution <inline-formula><mml:math id="inf30"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to extract each ROI trace’s value. To calculate ΔF/F traces from each fluorescence trace, a fluorescence baseline was determined by median filtering the fluorescence trace with a window of 180 s (5401 samples); the ΔF/F trace was then produced by subtracting the fluorescence baseline from the original trace followed by dividing the fluorescence baseline. To prevent very small or negative baselines, we set the baseline as the maximum of the median filter-estimated baseline and the standard deviation of the estimated noise of the fluorescence trace. All analyses of cell responses were performed on L0 penalized detected events (<xref ref-type="bibr" rid="bib18">Jewell and Witten, 2018</xref>; <xref ref-type="bibr" rid="bib17">Jewell et al., 2019</xref>).</p><p>Two-photon imaging data was collected from the retinotopic center of primary visual cortex that was identified through mapping during widefield intrinsic signal imaging. <italic>Cux2</italic>-CreERT2;<italic>Camk2a</italic>-tTA;Ai93 and <italic>Vip</italic>-IRES-Cre;Ai148 were imaged at 175 um below the cortical surface in layer 2/3; <italic>Sst</italic>-IRES-Cre;Ai148 mice and <italic>Rorb</italic>-IRES2-Cre;<italic>Camk2a</italic>-tTA;Ai93 mice were imaged at 275 um below the cortical surface in layer 4; <italic>Rbp4</italic>-Cre_KL100;<italic>Camk2a</italic>-tTA;Ai93 mice were imaged at 375 um below the cortical surface in layer 5; and <italic>Ntsr1</italic>-Cre_GN220;Ai148 mice were imaged at 550 um below the cortical surface in layer 6. (These Cre lines and imaging depths match those used in the Allen Brain Observatory.) Some mice were imaged in two different fields of view at the same depth; the sample sizes for number of imaging sessions and mice are given in <xref ref-type="supplementary-material" rid="fig1sdata1">Figure 1—source data 1</xref>. Some mice were imaged in multiple sessions; in cases in which a subset of cells was imaged in multiple sessions, only data from the first imaging session for each cell was analyzed. Mice were excluded for evidence of epileptiform activity, and individual imaging sessions were failed if there were signs of bleaching, saturation, excessive z-drift, or animal stress, among other factors.</p></sec><sec id="s3-3"><title>Visual stimulus</title><p>As experimental sessions took place on the same data collection pipeline as the Allen Brain Observatory, visual stimulus monitor calibration and positioning (ASUS PA248Q LCD monitor with 1920×1200 pixels; center of monitor was 118.6 mm lateral, 86.2 mm anterior, and 31.6 mm dorsal to the right eye; normal distance from the right eye to center of monitor was 15 cm) were identical. Each monitor was gamma corrected and had a mean luminance of 50 cd m<sup>−2</sup>. Spherical warping was applied to all stimuli to ensure constant spatial and temporal frequencies across the monitor as seen from the mouse’s perspective. See <xref ref-type="bibr" rid="bib9">de Vries et al., 2020</xref> for further visual stimulus presentation details. The stimulus consisted of a full field drifting sinusoidal grating that was presented at a single spatial frequency (0.04 cycles/degree) and temporal frequency (1 Hz), eight directions uniformly distributed in 45 degree increments (0 degrees = horizontal front-to-back motion), and six contrasts (5%, 10%, 20%, 40%, 60%, and 80%). Direction of motion was always orthogonal to the orientation of the grating. Each grating was presented for 2 s, followed by 1 s of mean luminance gray before the next grating. Each grating condition (direction, contrast combination) was presented 15–24 times. Trials were randomized with 30 randomly interleaved blank (i.e. mean luminance gray, zero contrast) trials.</p></sec><sec id="s3-4"><title>Analysis</title><sec id="s3-4-1"><title>Statistical test for responsiveness</title><p>A chi-square test for independence was used to determine significantly responsive cells to the drifting grating stimulus set. A chi-square test statistic was computed <inline-formula><mml:math id="inf31"><mml:msup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo> <mml:mi/><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf32"><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo> <mml:mi/><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the observed average response (<inline-formula><mml:math id="inf33"><mml:mi>R</mml:mi></mml:math></inline-formula>) of the neuron over <inline-formula><mml:math id="inf34"><mml:mi>m</mml:mi></mml:math></inline-formula> presentations of a grating stimulus of a particular condition (i.e. direction-by-contrast pair or blank, n = 49 total conditions), and <inline-formula><mml:math id="inf35"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo> <mml:mi/><mml:mfrac><mml:mrow><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfrac> <mml:mi/></mml:math></inline-formula> is the expected (grand average) response per stimulus presentation. A p-value was then calculated for each cell by comparing the test statistic against a null distribution of 200,000 test statistics, each computed from the cell’s responses after shuffling (with replacement) cell responses across all presentations.</p></sec><sec id="s3-4-2"><title>Response significance by stimulus condition and test for suppression by contrast</title><p>The distribution of responses to stimulus presentations varied substantially across cells. A statistical measure was used to normalize response magnitudes. The mean blank-subtracted response to a given stimulus condition was calculated as: <inline-formula><mml:math id="inf36"><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:mover><mml:mo>=</mml:mo> <mml:mi/><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>-</mml:mo> <mml:mi/> <mml:mi/><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. Then, a bootstrapped null distribution of such mean (blank-subtracted) condition responses was generated by sampling with replacement from all of the cell’s responses across all stimulus presentations. The percentiles of each cell’s observed mean condition response within its own bootstrapped distribution was then computed. Cells were determined to be suppressed by high contrast if this percentile for the peak direction grating condition at 80% contrast was below 0.05.</p></sec><sec id="s3-4-3"><title>Orientation and direction selectivity metrics</title><p>Global orientation selectivity was computed from mean extracted event responses to drifting gratings, at the cell’s preferred contrast as,<disp-formula id="equ1"><mml:math id="m1"><mml:mi>g</mml:mi><mml:mi>O</mml:mi><mml:mi>S</mml:mi><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfrac> <mml:mi/></mml:math></disp-formula>where <inline-formula><mml:math id="inf37"><mml:mi>θ</mml:mi></mml:math></inline-formula> is the direction of grating movement, and <inline-formula><mml:math id="inf38"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the mean response to that direction of motion.</p><p>Direction selectivity was computed from mean extracted event responses to drifting gratings, at the cell’s preferred contrast, as<disp-formula id="equ2"><mml:math id="m2"><mml:mi>D</mml:mi><mml:mi>S</mml:mi><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></disp-formula>where <italic>R<sub>pref</sub></italic> is a cell’s mean response in its preferred direction (i.e. largest response-evoking direction) and <italic>R<sub>null</sub></italic> is its mean response to the opposite direction.</p></sec><sec id="s3-4-4"><title>Contrast preference metric</title><p>Contrast preference was computed from mean extracted event responses to drifting gratings, at the cell’s preferred direction, as<disp-formula id="equ3"><mml:math id="m3"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo> <mml:mi/><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ln</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:math></disp-formula>where c is the contrast of the drifting grating, <inline-formula><mml:math id="inf39"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a cell’s mean response at contrast c, and <inline-formula><mml:math id="inf40"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the log-scaled center of mass of the cell’s contrast response tuning.</p></sec><sec id="s3-4-5"><title>Bias in population direction preference</title><p>The direction and magnitude of bias in direction preference for a population of cells (e.g. all cells recorded from one mouse or all cells recorded from all mice of a particular Cre line) was calculated as the direction and magnitude of the vector sum of the direction preferences of the cells that comprise the population, at a particular contrast as,<disp-formula id="equ4"><mml:math id="m4"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">tan</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">sin</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cos</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ5"><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msqrt><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>∑</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>∑</mml:mo><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf41"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the preferred direction of cell <inline-formula><mml:math id="inf42"><mml:mi>i</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf43"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the number of cells in the population, <inline-formula><mml:math id="inf44"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the direction of the vector sum over the population, and <inline-formula><mml:math id="inf45"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the magnitude of the vector sum over the population.</p></sec><sec id="s3-4-6"><title>Stimulus tuning conditioned on locomotion behavior</title><p>As part of the standardized pipeline for the Allen Brain Observatory, mice were held on a running wheel during experimental sessions and locomotion behavior was recorded (See <xref ref-type="bibr" rid="bib9">de Vries et al., 2020</xref> for further run speed measurement details). The mean running speed was calculated for each trial over the same time window as the mean cellular response was calculated. Trials for which the mean running speed was greater than or equal to 1 cm/s were categorized as running trials, whereas trials for which the mean running speed was below 1 cm/s were categorized as stationary trials. The mean and standard error of the mean event magnitude for each contrast and direction condition shown in <xref ref-type="fig" rid="fig3">Figure 3</xref> was calculated separately for running and stationary trials. The criterion for a cell to be included in the calculation for a given direction-by-contrast condition was that the mouse had to be running for a minimum of four trials <italic>and</italic> be stationary for a minimum of four trials of that condition. At least three responsive neurons needed to be present to include an experiment in this analysis.</p></sec><sec id="s3-4-7"><title>Contrast response function fitting and model comparison</title><p>Event responses as a function of contrast, at a cell’s preferred direction, were fit to a rising sigmoid (‘high pass’), a falling sigmoid (‘low pass’), and the product of one rising and one falling sigmoid (‘band pass’).<disp-formula id="equ6"><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>;</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mn>50</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mn>50</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>;</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mn>50</mml:mn></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mn>50</mml:mn></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>;</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mn>50</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mn>50</mml:mn></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mn>50</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mn>50</mml:mn></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf46"><mml:mi>c</mml:mi></mml:math></inline-formula> is the contrast, <inline-formula><mml:math id="inf47"><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is the contrast at which the response rises halfway between the base and height, <inline-formula><mml:math id="inf48"><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is the contrast at which the response falls halfway between the base and height, <inline-formula><mml:math id="inf49"><mml:mi>b</mml:mi></mml:math></inline-formula> is the lowest response, <inline-formula><mml:math id="inf50"><mml:mi>h</mml:mi></mml:math></inline-formula> is the response amplitude, and <inline-formula><mml:math id="inf51"><mml:mi>s</mml:mi></mml:math></inline-formula> is the slope of the sigmoid (fixed at <inline-formula><mml:math id="inf52"><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:math></inline-formula>). The best fit model was determined by calculating the Akaike Information Criterion (AIC) for each model and selecting the model with the lowest AIC.</p><p>The AIC can be calculated as:<disp-formula id="equ7"><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>A</mml:mi><mml:mi>I</mml:mi><mml:mi>C</mml:mi></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mi mathvariant="fraktur">L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="fraktur">L</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi mathvariant="fraktur">N</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi>R</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mi mathvariant="fraktur">L</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi>R</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf53"><mml:mi>k</mml:mi></mml:math></inline-formula> is the number of parameters fit in the model, <inline-formula><mml:math id="inf54"><mml:mi mathvariant="script">ℒ</mml:mi></mml:math></inline-formula> is the likelihood of observing the responses given the fitted model and response distribution, <inline-formula><mml:math id="inf55"><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is the cell’s response to a grating stimulus of contrast c (at the cell’s preferred direction) on trial <inline-formula><mml:math id="inf56"><mml:mi>i</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf57"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the response predicted by the model to a grating stimulus of contrast c, <inline-formula><mml:math id="inf58"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> is the variance of all of the cell’s responses, and <inline-formula><mml:math id="inf59"><mml:mi mathvariant="script">𝒩</mml:mi></mml:math></inline-formula> is the normal distribution. In practice, it is more convenient to directly calculate the log-likelihood than to calculate the likelihood and subsequently take the log, and the constant can be ignored for model selection since the same constant applies to all models being compared.</p><p>Due to the non-normal response distribution, possibly arising from calcium imaging as well as an underlying non-normal spiking distribution, we bootstrapped the log-likelihood rather than assume normality. Therefore, the likelihood was calculated numerically by shuffling responses across trials 1000 times and calculating the sum of square residuals from the predicted responses as <inline-formula><mml:math id="inf60"><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> for each shuffle. The likelihood was taken as the fraction of shuffles for which <inline-formula><mml:math id="inf61"><mml:mi>S</mml:mi><mml:mi>S</mml:mi></mml:math></inline-formula> was greater than the observed <inline-formula><mml:math id="inf62"><mml:mi>S</mml:mi><mml:mi>S</mml:mi></mml:math></inline-formula>.</p></sec><sec id="s3-4-8"><title>Generalized linear model</title><p>We constructed Generalized Linear Models, specifically a Poisson (i.e. exponential function) models, to predict the population response of each neuron type (e.g. VIP neurons) on each trial from stimulus contrast, stimulus direction, locomotion state (i.e. binary run or not run variable), and the interactions between these terms. The model was<disp-formula id="equ8"><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>R</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf63"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>R</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the predicted response for a trial, <inline-formula><mml:math id="inf64"><mml:mi>w</mml:mi></mml:math></inline-formula> terms are the weights of the model, <inline-formula><mml:math id="inf65"><mml:mi>a</mml:mi></mml:math></inline-formula> terms are binary variables that equal 1 if the trial attribute is true and equal 0 otherwise; the trial attributes are blank (<inline-formula><mml:math id="inf66"><mml:mi>b</mml:mi></mml:math></inline-formula>), run state (<inline-formula><mml:math id="inf67"><mml:mi>r</mml:mi></mml:math></inline-formula>), stimulus direction (<inline-formula><mml:math id="inf68"><mml:mi>d</mml:mi></mml:math></inline-formula>), and stimulus contrast (<inline-formula><mml:math id="inf69"><mml:mi>c</mml:mi></mml:math></inline-formula>); and <inline-formula><mml:math id="inf70"><mml:mi>k</mml:mi></mml:math></inline-formula> is a constant. The weights of the model were computed by minimizing the cost function <inline-formula><mml:math id="inf71"><mml:mi>L</mml:mi></mml:math></inline-formula> using iterative reweighted least squares,<disp-formula id="equ9"><mml:math id="m9"><mml:mi>L</mml:mi><mml:mo>=</mml:mo> <mml:mi/><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mo>+</mml:mo> <mml:mi/><mml:mi>λ</mml:mi><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></disp-formula>where SSE is the reconstruction error.<disp-formula id="equ10"><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>R</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula>and <inline-formula><mml:math id="inf72"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is an L1-regularization penalty that serves to identify only weights that significantly contribute to neuronal responses,<disp-formula id="equ11"><mml:math id="m11"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo> <mml:mi/><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The strength of regularization, <inline-formula><mml:math id="inf73"><mml:mi>λ</mml:mi></mml:math></inline-formula>, was determined through leave-one-out cross validation in which one experimental session was left out for each fold.</p></sec><sec id="s3-4-9"><title>Stabilized supralinear network (SSN) model</title><p>The SSN was modeled as a ring network, largely maintaining the basic architecture and dynamics described in <xref ref-type="bibr" rid="bib35">Rubin et al., 2015</xref> but deviating primarily in the diversity of inhibitory neurons and distributions of connections between neuron populations (including untuned inhibitory connections, described below). Our network consisted of one excitatory population (representing layer 2/3 CUX2 pyramidal neurons) and three inhibitory populations (representing PV, SST, and VIP interneurons, respectively). The ring network structure was imposed by providing each excitatory neuron with external (‘sensory’) excitatory input that had Gaussian tuning with the mean (i.e. peak/preferred direction) corresponding to the neuron’s position on the ring and standard deviation of 30 degrees; PV neurons also received external input which was not tuned (i.e. all PV cells receive input of equal strength). The entire network covered 180 degrees of orientation (or direction). The strength of external input was intended to represent a monotonically-increasing function of stimulus contrast, though no specific relationship between input magnitude and contrast is claimed here.</p><p>Connections between neurons also had Gaussian tuning that depended on the difference between the orientation preferences of the pre- and post-synaptic neurons (<xref ref-type="fig" rid="fig5">Figure 5b</xref>). The distributions of recurrent excitatory connections onto CUX2 cells and excitatory connections onto Vip cells were narrow (standard deviation of 30 degrees) compared to the distributions of connections to and from PV and Sst cells (standard deviation of 100 degrees).</p><p>The network consisted of 184 excitatory neurons, 40 PV neurons, 15 SST neurons, and 15 VIP neurons. The excitatory population had 180 neurons with uniform 1-degree spacing of peak directions to tile the ring, plus four extra neurons with peak direction of zero degrees to capture the slight bias of the CUX2 neurons. All model VIP neurons had a peak direction of zero degrees to capture the strong bias for front-to-back motion observed for VIP neurons. In addition, all SST and PV model neurons also had a peak direction of zero degrees, though the very broadly-tuned inputs to these neurons results in a much weaker bias of net input to these neurons than the bias to VIP neurons. All neurons were implemented as rate models with firing rate that was a rectified quadratic function of the summed input to the neuron,<disp-formula id="equ12"><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" displaystyle="false" rowspacing=".2em"><mml:mtr><mml:mtd><mml:mi>k</mml:mi><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mi>I</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mtext> </mml:mtext><mml:mi>I</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf74"><mml:mi>I</mml:mi></mml:math></inline-formula> is the input strength, <inline-formula><mml:math id="inf75"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the steady state firing rate, and <inline-formula><mml:math id="inf76"><mml:mi>k</mml:mi></mml:math></inline-formula> is a constant of proportionality. For ease of comparison with the SSN models developed by <xref ref-type="bibr" rid="bib35">Rubin et al., 2015</xref>, we used <inline-formula><mml:math id="inf77"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0.04</mml:mn></mml:math></inline-formula> for all models.</p><p>For a given external input, the firing rates of all neurons in the network were obtained by evolving the network in time, with dynamics:<disp-formula id="equ13"><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf78"><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is the time-dependent firing rate, <inline-formula><mml:math id="inf79"><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> is the time derivate of the neuron’s firing rate, <inline-formula><mml:math id="inf80"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the steady state firing rate that varies in time based on the inputs to the neuron, <inline-formula><mml:math id="inf81"><mml:msubsup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is the net input to neuron <inline-formula><mml:math id="inf82"><mml:mi>j</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf83"><mml:msubsup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is a constant spontaneous input to neuron <inline-formula><mml:math id="inf84"><mml:mi>j</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf85"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the connection strength from presynaptic neuron <inline-formula><mml:math id="inf86"><mml:mi>i</mml:mi></mml:math></inline-formula> onto postsynaptic neuron <inline-formula><mml:math id="inf87"><mml:mi>j</mml:mi></mml:math></inline-formula>. To provide a spontaneous activity to the network, and account for the higher spontaneous activity of VIP neurons (<xref ref-type="bibr" rid="bib34">Roux and Buzsáki, 2015</xref>), we set <inline-formula><mml:math id="inf88"><mml:msubsup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>U</mml:mi><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>V</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf89"><mml:msubsup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mi>I</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:math></inline-formula>. The network is evolved with Euler integration with updates of <inline-formula><mml:math id="inf90"><mml:mo>∆</mml:mo><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>∆</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> at each time step of <inline-formula><mml:math id="inf91"><mml:mo>∆</mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn> <mml:mi/><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:math></inline-formula>, where the time constants of the different neuron types are <inline-formula><mml:math id="inf92"><mml:msup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>U</mml:mi><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mi>I</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>20</mml:mn> <mml:mi/><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf93"><mml:msup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>V</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>10</mml:mn> <mml:mi/><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:math></inline-formula>.</p><p>We calculated the stability of the steady state of activity at zero degrees with respect to a spatially homogenous perturbation of the inputs. The stability matrix is, in the spatial Fourier domain,<disp-formula id="equ14"><mml:math id="m14"><mml:mi>J</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:math></disp-formula>where <inline-formula><mml:math id="inf94"><mml:mi>x</mml:mi></mml:math></inline-formula> is the postsynaptic location in degrees, <inline-formula><mml:math id="inf95"><mml:mi>n</mml:mi></mml:math></inline-formula> is the spatial frequency corresponding to the orientation difference between the presynaptic and postsynaptic cells, <inline-formula><mml:math id="inf96"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is the postsynaptic gain at its steady-state rate, <inline-formula><mml:math id="inf97"><mml:mi>W</mml:mi></mml:math></inline-formula> is the weight matrix and <inline-formula><mml:math id="inf98"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is the Fourier transform of the wrapped Gaussian connectivity profile:<disp-formula id="equ15"><mml:math id="m15"><mml:mi>G</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>30</mml:mn><mml:msqrt><mml:mfrac><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:mfrac></mml:msqrt> <mml:mi/><mml:mfenced separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mi>π</mml:mi><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mi>π</mml:mi><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mi>π</mml:mi><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mi>π</mml:mi><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mtd><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mi>π</mml:mi><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mi>π</mml:mi><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mi>π</mml:mi><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mi>π</mml:mi><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mi>π</mml:mi><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mi>π</mml:mi><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mi>π</mml:mi><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mi>π</mml:mi><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mtd><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mi>π</mml:mi><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mi>π</mml:mi><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mi>π</mml:mi><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mi>π</mml:mi><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math></disp-formula>where <inline-formula><mml:math id="inf99"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:math></inline-formula> degrees is the projection width for E→E, E→VIP and VIP projections and <inline-formula><mml:math id="inf100"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:math></inline-formula> degrees is the projection width for the remaining inhibitory projections. If <inline-formula><mml:math id="inf101"><mml:mi>E</mml:mi><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mn>00</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> is greater than zero, the network at orientation <inline-formula><mml:math id="inf102"><mml:mi>x</mml:mi></mml:math></inline-formula> is in an inhibitory-stabilized state with respect to perturbations at spatial frequency <inline-formula><mml:math id="inf103"><mml:mi>n</mml:mi></mml:math></inline-formula>.</p></sec></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>The authors wish to thank the Allen Institute founder, Paul G Allen, for his vision, encouragement, and support.</p></ack><sec id="s4" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Formal analysis, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Formal analysis, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Investigation</p></fn><fn fn-type="con" id="con4"><p>Investigation</p></fn><fn fn-type="con" id="con5"><p>Investigation</p></fn><fn fn-type="con" id="con6"><p>Investigation</p></fn><fn fn-type="con" id="con7"><p>Investigation</p></fn><fn fn-type="con" id="con8"><p>Investigation</p></fn><fn fn-type="con" id="con9"><p>Investigation</p></fn><fn fn-type="con" id="con10"><p>Investigation</p></fn><fn fn-type="con" id="con11"><p>Investigation</p></fn><fn fn-type="con" id="con12"><p>Investigation</p></fn><fn fn-type="con" id="con13"><p>Supervision, Methodology</p></fn><fn fn-type="con" id="con14"><p>Supervision</p></fn><fn fn-type="con" id="con15"><p>Conceptualization, Supervision, Writing - review and editing</p></fn><fn fn-type="con" id="con16"><p>Conceptualization, Formal analysis, Supervision, Methodology, Writing - review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Animal experimentation: All animal procedures were approved by the Institutional Animal Care and Use Committee (IACUC) at the Allen Institute for Brain Science.</p></fn></fn-group></sec><sec id="s5" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-55130-transrepform-v1.pdf"/></supplementary-material></sec><sec id="s6" sec-type="data-availability"><title>Data availability</title><p>The data generated and analyzed in this study are available on DANDI: Distributed Archives for Neurophysiology Data Integration. All analyses were performed using custom scripts written in Python 2.7, using NumPy, SciPy, Pandas, Matplotlib, statsmodel, and Scikit-learn. Analysis code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/AllenInstitute/Contrast_Analysis">https://github.com/AllenInstitute/Contrast_Analysis</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:rev:c7ddda11647093e8a0173dbd2a1986ac6239c821/">https://archive.softwareheritage.org/swh:1:rev:c7ddda11647093e8a0173dbd2a1986ac6239c821/</ext-link>). Event extraction was performed using FastLZeroSpikeInference available at <ext-link ext-link-type="uri" xlink:href="https://github.com/jewellsean/FastLZeroSpikeInference">https://github.com/jewellsean/FastLZeroSpikeInference</ext-link>.</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Millman</surname><given-names>DJ</given-names></name><name><surname>de</surname><given-names>Vries SE</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Allen Institute – Contrast tuning in mouse visual cortex with calcium imaging</data-title><source>DANDI</source><pub-id assigning-authority="other" pub-id-type="accession" xlink:href="https://dandiarchive.org/dandiset/000039/draft">000039</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adesnik</surname> <given-names>H</given-names></name><name><surname>Bruns</surname> <given-names>W</given-names></name><name><surname>Taniguchi</surname> <given-names>H</given-names></name><name><surname>Huang</surname> <given-names>ZJ</given-names></name><name><surname>Scanziani</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>A neural circuit for spatial summation in visual cortex</article-title><source>Nature</source><volume>490</volume><fpage>226</fpage><lpage>231</lpage><pub-id pub-id-type="doi">10.1038/nature11526</pub-id><pub-id pub-id-type="pmid">23060193</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adesnik</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Synaptic mechanisms of feature coding in the visual cortex of awake mice</article-title><source>Neuron</source><volume>95</volume><fpage>1147</fpage><lpage>1159</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.08.014</pub-id><pub-id pub-id-type="pmid">28858618</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahmadian</surname> <given-names>Y</given-names></name><name><surname>Rubin</surname> <given-names>DB</given-names></name><name><surname>Miller</surname> <given-names>KD</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Analysis of the stabilized supralinear network</article-title><source>Neural Computation</source><volume>25</volume><fpage>1994</fpage><lpage>2037</lpage><pub-id pub-id-type="doi">10.1162/NECO_a_00472</pub-id><pub-id pub-id-type="pmid">23663149</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carandini</surname> <given-names>M</given-names></name><name><surname>Heeger</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Normalization as a canonical neural computation</article-title><source>Nature Reviews Neuroscience</source><volume>13</volume><fpage>51</fpage><lpage>62</lpage><pub-id pub-id-type="doi">10.1038/nrn3136</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cardin</surname> <given-names>JA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Inhibitory interneurons regulate temporal precision and correlations in cortical circuits</article-title><source>Trends in Neurosciences</source><volume>41</volume><fpage>689</fpage><lpage>700</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2018.07.015</pub-id><pub-id pub-id-type="pmid">30274604</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cavanaugh</surname> <given-names>JR</given-names></name><name><surname>Bair</surname> <given-names>W</given-names></name><name><surname>Movshon</surname> <given-names>JA</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Nature and interaction of signals from the receptive field center and surround in macaque V1 neurons</article-title><source>Journal of Neurophysiology</source><volume>88</volume><fpage>2530</fpage><lpage>2546</lpage><pub-id pub-id-type="doi">10.1152/jn.00692.2001</pub-id><pub-id pub-id-type="pmid">12424292</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cone</surname> <given-names>JJ</given-names></name><name><surname>Scantlen</surname> <given-names>MD</given-names></name><name><surname>Histed</surname> <given-names>MH</given-names></name><name><surname>Maunsell</surname> <given-names>JHR</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Different inhibitory interneuron cell classes make distinct contributions to visual contrast perception</article-title><source>Eneuro</source><volume>6</volume><elocation-id>ENEURO.0337-18.2019</elocation-id><pub-id pub-id-type="doi">10.1523/ENEURO.0337-18.2019</pub-id><pub-id pub-id-type="pmid">30868104</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cruikshank</surname> <given-names>SJ</given-names></name><name><surname>Urabe</surname> <given-names>H</given-names></name><name><surname>Nurmikko</surname> <given-names>AV</given-names></name><name><surname>Connors</surname> <given-names>BW</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Pathway-specific feedforward circuits between thalamus and neocortex revealed by selective optical stimulation of axons</article-title><source>Neuron</source><volume>65</volume><fpage>230</fpage><lpage>245</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.12.025</pub-id><pub-id pub-id-type="pmid">20152129</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Vries</surname> <given-names>SEJ</given-names></name><name><surname>Lecoq</surname> <given-names>JA</given-names></name><name><surname>Buice</surname> <given-names>MA</given-names></name><name><surname>Groblewski</surname> <given-names>PA</given-names></name><name><surname>Ocker</surname> <given-names>GK</given-names></name><name><surname>Oliver</surname> <given-names>M</given-names></name><name><surname>Feng</surname> <given-names>D</given-names></name><name><surname>Cain</surname> <given-names>N</given-names></name><name><surname>Ledochowitsch</surname> <given-names>P</given-names></name><name><surname>Millman</surname> <given-names>D</given-names></name><name><surname>Roll</surname> <given-names>K</given-names></name><name><surname>Garrett</surname> <given-names>M</given-names></name><name><surname>Keenan</surname> <given-names>T</given-names></name><name><surname>Kuan</surname> <given-names>L</given-names></name><name><surname>Mihalas</surname> <given-names>S</given-names></name><name><surname>Olsen</surname> <given-names>S</given-names></name><name><surname>Thompson</surname> <given-names>C</given-names></name><name><surname>Wakeman</surname> <given-names>W</given-names></name><name><surname>Waters</surname> <given-names>J</given-names></name><name><surname>Williams</surname> <given-names>D</given-names></name><name><surname>Barber</surname> <given-names>C</given-names></name><name><surname>Berbesque</surname> <given-names>N</given-names></name><name><surname>Blanchard</surname> <given-names>B</given-names></name><name><surname>Bowles</surname> <given-names>N</given-names></name><name><surname>Caldejon</surname> <given-names>SD</given-names></name><name><surname>Casal</surname> <given-names>L</given-names></name><name><surname>Cho</surname> <given-names>A</given-names></name><name><surname>Cross</surname> <given-names>S</given-names></name><name><surname>Dang</surname> <given-names>C</given-names></name><name><surname>Dolbeare</surname> <given-names>T</given-names></name><name><surname>Edwards</surname> <given-names>M</given-names></name><name><surname>Galbraith</surname> <given-names>J</given-names></name><name><surname>Gaudreault</surname> <given-names>N</given-names></name><name><surname>Gilbert</surname> <given-names>TL</given-names></name><name><surname>Griffin</surname> <given-names>F</given-names></name><name><surname>Hargrave</surname> <given-names>P</given-names></name><name><surname>Howard</surname> <given-names>R</given-names></name><name><surname>Huang</surname> <given-names>L</given-names></name><name><surname>Jewell</surname> <given-names>S</given-names></name><name><surname>Keller</surname> <given-names>N</given-names></name><name><surname>Knoblich</surname> <given-names>U</given-names></name><name><surname>Larkin</surname> <given-names>JD</given-names></name><name><surname>Larsen</surname> <given-names>R</given-names></name><name><surname>Lau</surname> <given-names>C</given-names></name><name><surname>Lee</surname> <given-names>E</given-names></name><name><surname>Lee</surname> <given-names>F</given-names></name><name><surname>Leon</surname> <given-names>A</given-names></name><name><surname>Li</surname> <given-names>L</given-names></name><name><surname>Long</surname> <given-names>F</given-names></name><name><surname>Luviano</surname> <given-names>J</given-names></name><name><surname>Mace</surname> <given-names>K</given-names></name><name><surname>Nguyen</surname> <given-names>T</given-names></name><name><surname>Perkins</surname> <given-names>J</given-names></name><name><surname>Robertson</surname> <given-names>M</given-names></name><name><surname>Seid</surname> <given-names>S</given-names></name><name><surname>Shea-Brown</surname> <given-names>E</given-names></name><name><surname>Shi</surname> <given-names>J</given-names></name><name><surname>Sjoquist</surname> <given-names>N</given-names></name><name><surname>Slaughterbeck</surname> <given-names>C</given-names></name><name><surname>Sullivan</surname> <given-names>D</given-names></name><name><surname>Valenza</surname> <given-names>R</given-names></name><name><surname>White</surname> <given-names>C</given-names></name><name><surname>Williford</surname> <given-names>A</given-names></name><name><surname>Witten</surname> <given-names>DM</given-names></name><name><surname>Zhuang</surname> <given-names>J</given-names></name><name><surname>Zeng</surname> <given-names>H</given-names></name><name><surname>Farrell</surname> <given-names>C</given-names></name><name><surname>Ng</surname> <given-names>L</given-names></name><name><surname>Bernard</surname> <given-names>A</given-names></name><name><surname>Phillips</surname> <given-names>JW</given-names></name><name><surname>Reid</surname> <given-names>RC</given-names></name><name><surname>Koch</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A large-scale standardized physiological survey reveals functional organization of the mouse visual cortex</article-title><source>Nature Neuroscience</source><volume>23</volume><fpage>138</fpage><lpage>151</lpage><pub-id pub-id-type="doi">10.1038/s41593-019-0550-9</pub-id><pub-id pub-id-type="pmid">31844315</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dipoppa</surname> <given-names>M</given-names></name><name><surname>Ranson</surname> <given-names>A</given-names></name><name><surname>Krumin</surname> <given-names>M</given-names></name><name><surname>Pachitariu</surname> <given-names>M</given-names></name><name><surname>Carandini</surname> <given-names>M</given-names></name><name><surname>Harris</surname> <given-names>KD</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Vision and locomotion shape the interactions between neuron types in mouse visual cortex</article-title><source>Neuron</source><volume>98</volume><fpage>602</fpage><lpage>615</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.03.037</pub-id><pub-id pub-id-type="pmid">29656873</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fu</surname> <given-names>Y</given-names></name><name><surname>Tucciarone</surname> <given-names>JM</given-names></name><name><surname>Espinosa</surname> <given-names>JS</given-names></name><name><surname>Sheng</surname> <given-names>N</given-names></name><name><surname>Darcy</surname> <given-names>DP</given-names></name><name><surname>Nicoll</surname> <given-names>RA</given-names></name><name><surname>Huang</surname> <given-names>ZJ</given-names></name><name><surname>Stryker</surname> <given-names>MP</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A cortical circuit for gain control by behavioral state</article-title><source>Cell</source><volume>156</volume><fpage>1139</fpage><lpage>1152</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2014.01.050</pub-id><pub-id pub-id-type="pmid">24630718</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glickfeld</surname> <given-names>LL</given-names></name><name><surname>Histed</surname> <given-names>MH</given-names></name><name><surname>Maunsell</surname> <given-names>JH</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Mouse primary visual cortex is used to detect both orientation and contrast changes</article-title><source>Journal of Neuroscience</source><volume>33</volume><fpage>19416</fpage><lpage>19422</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3560-13.2013</pub-id><pub-id pub-id-type="pmid">24336708</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hennequin</surname> <given-names>G</given-names></name><name><surname>Ahmadian</surname> <given-names>Y</given-names></name><name><surname>Rubin</surname> <given-names>DB</given-names></name><name><surname>Lengyel</surname> <given-names>M</given-names></name><name><surname>Miller</surname> <given-names>KD</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The dynamical regime of sensory cortex: stable dynamics around a single Stimulus-Tuned attractor account for patterns of noise variability</article-title><source>Neuron</source><volume>98</volume><fpage>846</fpage><lpage>860</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.04.017</pub-id><pub-id pub-id-type="pmid">29772203</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hertäg</surname> <given-names>L</given-names></name><name><surname>Sprekeler</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Amplifying the redistribution of somato-dendritic inhibition by the interplay of three interneuron types</article-title><source>PLOS Computational Biology</source><volume>15</volume><elocation-id>e1006999</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006999</pub-id><pub-id pub-id-type="pmid">31095556</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heuer</surname> <given-names>HW</given-names></name><name><surname>Britten</surname> <given-names>KH</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Contrast dependence of response normalization in area MT of the rhesus macaque</article-title><source>Journal of Neurophysiology</source><volume>88</volume><fpage>3398</fpage><lpage>3408</lpage><pub-id pub-id-type="doi">10.1152/jn.00255.2002</pub-id><pub-id pub-id-type="pmid">12466456</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Huang</surname> <given-names>L</given-names></name><name><surname>Knoblich</surname> <given-names>U</given-names></name><name><surname>Ledochowitsch</surname> <given-names>P</given-names></name><name><surname>Lecoq</surname> <given-names>J</given-names></name><name><surname>Reid</surname> <given-names>RD</given-names></name><name><surname>de Vries</surname> <given-names>SEJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Relationship between simultaneously recorded spiking activity and fluorescence signal in GCaMP6 transgenic mice</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/788802</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jewell</surname> <given-names>SW</given-names></name><name><surname>Hocking</surname> <given-names>TD</given-names></name><name><surname>Fearnhead</surname> <given-names>P</given-names></name><name><surname>Witten</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Fast nonconvex deconvolution of calcium imaging data</article-title><source>Biostatistics</source><volume>10</volume><elocation-id>kxy083</elocation-id><pub-id pub-id-type="doi">10.1093/biostatistics/kxy083</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jewell</surname> <given-names>S</given-names></name><name><surname>Witten</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Exact spike train inference via $\ell_{0}$ optimization</article-title><source>The Annals of Applied Statistics</source><volume>12</volume><fpage>2457</fpage><lpage>2482</lpage><pub-id pub-id-type="doi">10.1214/18-AOAS1162</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kerlin</surname> <given-names>AM</given-names></name><name><surname>Andermann</surname> <given-names>ML</given-names></name><name><surname>Berezovskii</surname> <given-names>VK</given-names></name><name><surname>Reid</surname> <given-names>RC</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Broadly tuned response properties of diverse inhibitory neuron subtypes in mouse visual cortex</article-title><source>Neuron</source><volume>67</volume><fpage>858</fpage><lpage>871</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2010.08.002</pub-id><pub-id pub-id-type="pmid">20826316</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kraynyukova</surname> <given-names>N</given-names></name><name><surname>Tchumatchenko</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Stabilized supralinear network can give rise to Bistable, Oscillatory, and persistent activity</article-title><source>PNAS</source><volume>115</volume><fpage>3464</fpage><lpage>3469</lpage><pub-id pub-id-type="doi">10.1073/pnas.1700080115</pub-id><pub-id pub-id-type="pmid">29531035</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Ledochowitsch</surname> <given-names>P</given-names></name><name><surname>Huang</surname> <given-names>L</given-names></name><name><surname>Knoblich</surname> <given-names>U</given-names></name><name><surname>Oliver</surname> <given-names>M</given-names></name><name><surname>Lecoq</surname> <given-names>J</given-names></name><name><surname>Reid</surname> <given-names>C</given-names></name><name><surname>Li</surname> <given-names>L</given-names></name><name><surname>Zeng</surname> <given-names>H</given-names></name><name><surname>Koch</surname> <given-names>C</given-names></name><name><surname>Water</surname> <given-names>J</given-names></name><name><surname>de Vries</surname> <given-names>SEJ</given-names></name><name><surname>Buice</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>On the correspondence of electrical and optical physiology in in vivo population-scale two-photon calcium imaging</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/800102</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levick</surname> <given-names>WR</given-names></name></person-group><year iso-8601-date="1967">1967</year><article-title>Receptive fields and trigger features of ganglion cells in the visual streak of the rabbits retina</article-title><source>The Journal of Physiology</source><volume>188</volume><fpage>285</fpage><lpage>307</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1967.sp008140</pub-id><pub-id pub-id-type="pmid">6032202</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Linaro</surname> <given-names>D</given-names></name><name><surname>Ocker</surname> <given-names>GK</given-names></name><name><surname>Doiron</surname> <given-names>B</given-names></name><name><surname>Giugliano</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Correlation transfer by layer 5 cortical neurons under recreated synaptic inputs <italic>In Vitro</italic></article-title><source>The Journal of Neuroscience</source><volume>39</volume><fpage>7648</fpage><lpage>7663</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3169-18.2019</pub-id><pub-id pub-id-type="pmid">31346031</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Lindsay</surname> <given-names>GW</given-names></name><name><surname>Rubin</surname> <given-names>DB</given-names></name><name><surname>Miller</surname> <given-names>KD</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A unified circuit model of attention: neural and behavioral effects</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2019.12.13.875534</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname> <given-names>LD</given-names></name><name><surname>Miller</surname> <given-names>KD</given-names></name><name><surname>Pack</surname> <given-names>CC</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A unifying motif for spatial and directional surround suppression</article-title><source>The Journal of Neuroscience</source><volume>38</volume><fpage>989</fpage><lpage>999</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2386-17.2017</pub-id><pub-id pub-id-type="pmid">29229704</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Margrie</surname> <given-names>T</given-names></name><name><surname>Brecht</surname> <given-names>M</given-names></name><name><surname>Sakmann</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>In vivo, low-resistance, whole-cell recordings from neurons in the anaesthetized and awake mammalian brain</article-title><source>Pflugers Archiv European Journal of Physiology</source><volume>444</volume><fpage>491</fpage><lpage>498</lpage><pub-id pub-id-type="doi">10.1007/s00424-002-0831-z</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marshel</surname> <given-names>JH</given-names></name><name><surname>Kaye</surname> <given-names>AP</given-names></name><name><surname>Nauhaus</surname> <given-names>I</given-names></name><name><surname>Callaway</surname> <given-names>EM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Anterior-posterior direction opponency in the superficial mouse lateral geniculate nucleus</article-title><source>Neuron</source><volume>76</volume><fpage>713</fpage><lpage>720</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.09.021</pub-id><pub-id pub-id-type="pmid">23177957</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mesik</surname> <given-names>L</given-names></name><name><surname>Ma</surname> <given-names>W</given-names></name><name><surname>Li</surname> <given-names>L</given-names></name><name><surname>Ibrahim</surname> <given-names>LA</given-names></name><name><surname>Huang</surname> <given-names>ZJ</given-names></name><name><surname>Zhang</surname> <given-names>LI</given-names></name><name><surname>Tao</surname> <given-names>HW</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Functional response properties of VIP-expressing inhibitory neurons in mouse visual and auditory cortex</article-title><source>Frontiers in Neural Circuits</source><volume>09</volume><fpage>1</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.3389/fncir.2015.00022</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname> <given-names>KD</given-names></name><name><surname>Troyer</surname> <given-names>TW</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Visual cortex neurons of monkeys and cats: temporal dynamics of the contrast response function</article-title><source>Journal of Neurophysiology</source><volume>88</volume><fpage>652</fpage><lpage>659</lpage><pub-id pub-id-type="doi">10.1152/jn.2002.88.2.888</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfeffer</surname> <given-names>CK</given-names></name><name><surname>Xue</surname> <given-names>M</given-names></name><name><surname>He</surname> <given-names>M</given-names></name><name><surname>Huang</surname> <given-names>ZJ</given-names></name><name><surname>Scanziani</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Inhibition of inhibition in visual cortex: the logic of connections between molecularly distinct interneurons</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1068</fpage><lpage>1076</lpage><pub-id pub-id-type="doi">10.1038/nn.3446</pub-id><pub-id pub-id-type="pmid">23817549</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pi</surname> <given-names>HJ</given-names></name><name><surname>Hangya</surname> <given-names>B</given-names></name><name><surname>Kvitsiani</surname> <given-names>D</given-names></name><name><surname>Sanders</surname> <given-names>JI</given-names></name><name><surname>Huang</surname> <given-names>ZJ</given-names></name><name><surname>Kepecs</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Cortical interneurons that specialize in disinhibitory control</article-title><source>Nature</source><volume>503</volume><fpage>521</fpage><lpage>524</lpage><pub-id pub-id-type="doi">10.1038/nature12676</pub-id><pub-id pub-id-type="pmid">24097352</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Priebe</surname> <given-names>NJ</given-names></name><name><surname>Ferster</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Inhibition, spike threshold, and stimulus selectivity in primary visual cortex</article-title><source>Neuron</source><volume>57</volume><fpage>482</fpage><lpage>497</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2008.02.005</pub-id><pub-id pub-id-type="pmid">18304479</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rodieck</surname> <given-names>RW</given-names></name></person-group><year iso-8601-date="1967">1967</year><article-title>Receptive fields in the cat retina: a new type</article-title><source>Science</source><volume>157</volume><fpage>90</fpage><lpage>92</lpage><pub-id pub-id-type="doi">10.1126/science.157.3784.90</pub-id><pub-id pub-id-type="pmid">6026674</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roux</surname> <given-names>L</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Tasks for inhibitory interneurons in intact brain circuits</article-title><source>Neuropharmacology</source><volume>88</volume><fpage>10</fpage><lpage>23</lpage><pub-id pub-id-type="doi">10.1016/j.neuropharm.2014.09.011</pub-id><pub-id pub-id-type="pmid">25239808</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rubin</surname> <given-names>DB</given-names></name><name><surname>Van Hooser</surname> <given-names>SD</given-names></name><name><surname>Miller</surname> <given-names>KD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The stabilized supralinear network: a unifying circuit motif underlying multi-input integration in sensory cortex</article-title><source>Neuron</source><volume>85</volume><fpage>402</fpage><lpage>417</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.12.026</pub-id><pub-id pub-id-type="pmid">25611511</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanzeni</surname> <given-names>A</given-names></name><name><surname>Akitake</surname> <given-names>B</given-names></name><name><surname>Goldbach</surname> <given-names>HC</given-names></name><name><surname>Leedy</surname> <given-names>CE</given-names></name><name><surname>Brunel</surname> <given-names>N</given-names></name><name><surname>Histed</surname> <given-names>MH</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Inhibition stabilization is a widespread property of cortical networks</article-title><source>eLife</source><volume>9</volume><elocation-id>e54875</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.54875</pub-id><pub-id pub-id-type="pmid">32598278</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scala</surname> <given-names>F</given-names></name><name><surname>Kobak</surname> <given-names>D</given-names></name><name><surname>Shan</surname> <given-names>S</given-names></name><name><surname>Bernaerts</surname> <given-names>Y</given-names></name><name><surname>Laturnus</surname> <given-names>S</given-names></name><name><surname>Cadwell</surname> <given-names>CR</given-names></name><name><surname>Hartmanis</surname> <given-names>L</given-names></name><name><surname>Froudarakis</surname> <given-names>E</given-names></name><name><surname>Castro</surname> <given-names>JR</given-names></name><name><surname>Tan</surname> <given-names>ZH</given-names></name><name><surname>Papadopoulos</surname> <given-names>S</given-names></name><name><surname>Patel</surname> <given-names>SS</given-names></name><name><surname>Sandberg</surname> <given-names>R</given-names></name><name><surname>Berens</surname> <given-names>P</given-names></name><name><surname>Jiang</surname> <given-names>X</given-names></name><name><surname>Tolias</surname> <given-names>AS</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Layer 4 of mouse neocortex differs in cell types and circuit organization between sensory Areas</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>4174</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-12058-z</pub-id><pub-id pub-id-type="pmid">31519874</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tasic</surname> <given-names>B</given-names></name><name><surname>Yao</surname> <given-names>Z</given-names></name><name><surname>Graybuck</surname> <given-names>LT</given-names></name><name><surname>Smith</surname> <given-names>KA</given-names></name><name><surname>Nguyen</surname> <given-names>TN</given-names></name><name><surname>Bertagnolli</surname> <given-names>D</given-names></name><name><surname>Goldy</surname> <given-names>J</given-names></name><name><surname>Garren</surname> <given-names>E</given-names></name><name><surname>Economo</surname> <given-names>MN</given-names></name><name><surname>Viswanathan</surname> <given-names>S</given-names></name><name><surname>Penn</surname> <given-names>O</given-names></name><name><surname>Bakken</surname> <given-names>T</given-names></name><name><surname>Menon</surname> <given-names>V</given-names></name><name><surname>Miller</surname> <given-names>J</given-names></name><name><surname>Fong</surname> <given-names>O</given-names></name><name><surname>Hirokawa</surname> <given-names>KE</given-names></name><name><surname>Lathia</surname> <given-names>K</given-names></name><name><surname>Rimorin</surname> <given-names>C</given-names></name><name><surname>Tieu</surname> <given-names>M</given-names></name><name><surname>Larsen</surname> <given-names>R</given-names></name><name><surname>Casper</surname> <given-names>T</given-names></name><name><surname>Barkan</surname> <given-names>E</given-names></name><name><surname>Kroll</surname> <given-names>M</given-names></name><name><surname>Parry</surname> <given-names>S</given-names></name><name><surname>Shapovalova</surname> <given-names>NV</given-names></name><name><surname>Hirschstein</surname> <given-names>D</given-names></name><name><surname>Pendergraft</surname> <given-names>J</given-names></name><name><surname>Sullivan</surname> <given-names>HA</given-names></name><name><surname>Kim</surname> <given-names>TK</given-names></name><name><surname>Szafer</surname> <given-names>A</given-names></name><name><surname>Dee</surname> <given-names>N</given-names></name><name><surname>Groblewski</surname> <given-names>P</given-names></name><name><surname>Wickersham</surname> <given-names>I</given-names></name><name><surname>Cetin</surname> <given-names>A</given-names></name><name><surname>Harris</surname> <given-names>JA</given-names></name><name><surname>Levi</surname> <given-names>BP</given-names></name><name><surname>Sunkin</surname> <given-names>SM</given-names></name><name><surname>Madisen</surname> <given-names>L</given-names></name><name><surname>Daigle</surname> <given-names>TL</given-names></name><name><surname>Looger</surname> <given-names>L</given-names></name><name><surname>Bernard</surname> <given-names>A</given-names></name><name><surname>Phillips</surname> <given-names>J</given-names></name><name><surname>Lein</surname> <given-names>E</given-names></name><name><surname>Hawrylycz</surname> <given-names>M</given-names></name><name><surname>Svoboda</surname> <given-names>K</given-names></name><name><surname>Jones</surname> <given-names>AR</given-names></name><name><surname>Koch</surname> <given-names>C</given-names></name><name><surname>Zeng</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Shared and distinct transcriptomic cell types across neocortical Areas</article-title><source>Nature</source><volume>563</volume><fpage>72</fpage><lpage>78</lpage><pub-id pub-id-type="doi">10.1038/s41586-018-0654-5</pub-id><pub-id pub-id-type="pmid">30382198</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tremblay</surname> <given-names>R</given-names></name><name><surname>Lee</surname> <given-names>S</given-names></name><name><surname>Rudy</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>GABAergic interneurons in the neocortex: from cellular properties to circuits</article-title><source>Neuron</source><volume>91</volume><fpage>260</fpage><lpage>292</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.06.033</pub-id><pub-id pub-id-type="pmid">27477017</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname> <given-names>S</given-names></name><name><surname>Xu</surname> <given-names>M</given-names></name><name><surname>Kamigaki</surname> <given-names>T</given-names></name><name><surname>Hoang Do</surname> <given-names>JP</given-names></name><name><surname>Chang</surname> <given-names>WC</given-names></name><name><surname>Jenvay</surname> <given-names>S</given-names></name><name><surname>Miyamichi</surname> <given-names>K</given-names></name><name><surname>Luo</surname> <given-names>L</given-names></name><name><surname>Dan</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Long-range and local circuits for top-down modulation of visual cortex processing</article-title><source>Science</source><volume>345</volume><fpage>660</fpage><lpage>665</lpage><pub-id pub-id-type="doi">10.1126/science.1254126</pub-id><pub-id pub-id-type="pmid">25104383</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Zhang</surname> <given-names>J</given-names></name><name><surname>Larsen</surname> <given-names>RS</given-names></name><name><surname>Takasaki</surname> <given-names>KT</given-names></name><name><surname>Ouellette</surname> <given-names>ND</given-names></name><name><surname>Daigle</surname> <given-names>TL</given-names></name><name><surname>Tasic</surname> <given-names>B</given-names></name><name><surname>Waters</surname> <given-names>J</given-names></name><name><surname>Zeng</surname> <given-names>H</given-names></name><name><surname>Reid</surname> <given-names>RC</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The spatial structure of feedforward information in mouse primary visual cortex</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2019.12.24.888156</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.55130.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Vinck</surname><given-names>Martin</given-names></name><role>Reviewing Editor</role><aff><institution>Ernst Strüngmann Institute (ESI) for Neuroscience in Cooperation with Max Planck Society</institution><country>Germany</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>Millman et al. show new insights into the function and visual response properties of a main subclass of vasoactive intestinal peptide-expressing (VIP) interneurons in area V1 of the mouse. They find that VIP interneurons are most strongly activated by low-contrast stimuli with front-to-back motion, which is congruent with self-motion that occurs during locomotion, another main factor that is known to drive VIP interneuron activity. The authors develop a model suggesting that this accounts for the suppression of SSt+ (Somatostatin) interneurons at low luminance-contrasts, and the surprising preference of Layer 2/3 pyramidal cells for low-contrast stimuli.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;VIP interneurons selectively enhance weak but behaviorally-relevant stimuli&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by four peer reviewers, one of whom, Martin Vinck, is a member of our Board of Reviewing Editors, and the evaluation has been overseen by Kate Wassum as the Senior Editor. The other reviewers have opted to remain anonymous.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>VIP interneurons are a class of GABAergic interneurons that can disinhibit pyramidal neurons via inhibition of SST interneurons. Millman et al. describe a novel role for VIP-driven disinhibition of pyramidal cells in the mouse primary visual cortex (V1). They report surprising and novel cell type-specific responses in the mouse visual cortex. First, VIP-positive interneurons show stereotyped direction tuning, strikingly different from the pyramidal cell population, suggesting that inputs to these neurons are related to a top-down input that signals behavioral relevance of the stimulus. The finding that VIP responses are enhanced by locomotion fits with this hypothesis. Second, VIP responses are suppressed at high contrast. Finally, a model based on the SSN architecture can reproduce some of the major features of the data. Together, this work supports the notion that VIP neuron activity increases sensitivity to weak inputs, whereas SST neuron activity decreases sensitivity to strong inputs and maintains network stability. This interesting conjunction leads to heightened sensitivity to detect low-contrast objects or obstacles approaching head-on during locomotion. Thus, VIP neurons promote high gain in the local microcircuit at low contrast conditions.</p><p>General assessment:</p><p>All reviewers agreed that the study has substantial merits and makes an important, novel contribution to the field.</p><p>Essential revisions:</p><p>The reviewers raise a number of concerns that must be adequately addressed before the paper can be accepted. Some of the required revisions will require further data analysis.</p><p>1) Data representation and interpretation of calcium signals</p><p>The data shown are highly overprocessed. The authors should include raw data traces and images, and describe their methods comprehensively in the paper. Data in Figure 1 should be shown with proper normalization (percent change) as well as raw data, and not as percentiles. While the authors use an established &quot;pipeline&quot; for data collection, they should include raw calcium imaging traces and images (at least in the Materials and methods), They should describe their methods comprehensively in the paper. The paper should be self-contained, and the authors should provide a representation of how fluorescence images were converted into the color maps in Figure 1. Inclusion of raw data is necessary for readers to get a sense of what is measured and possible caveats. For example, it could be possible that VIP neurons have saturating response at high contrast and the calcium does not decrease to baseline between trials, resulting in what looks like a suppressed response. A further consideration is the fact that imaging depths vary throughout the manuscript, and GABAergic neuronal activity can be substantially higher than pyramidal cell activity, which should have a &quot;smoothing&quot; impact on calcium traces. The authors should better explain how they took this into consideration in their estimation of various metrics. The authors should further motivate why data was averaged over running and stationary trials in Figure 1.</p><p>2) Authors should discuss how GCaMP signals relate to spikes across different cell types (for example see Khan et al., Nat Nsci 2018, Figure 2E and Supplementary Figure 6, where a comparison is made with calcium imaging and extracellular recording in Vip, PV and Sst neurons) (and Huang et al-Biorxiv).</p><p>3) It is unclear why the authors used Cre lines to image different pyramidal neuron populations, along with imaging at different depths. A possible reason could be to avoid contamination from dendrites of neurons in different layers. If this is the reason it should be stated in the paper. In addition, they asked for something to be said about the idiosyncrasies of the cre lines in light of recent scRNAseq data.</p><p>4) Response percentiles in Figure 1B are reported, but these are never corrected for the many multiple comparisons, such that the significance is merely a normalized measure of strength. However percentiles are deceiving because they hide the amplitude of the responses. Data should be represented as percent change to obtain an idea about the effect sizes shown in this study, because a small effect might correspond to a large normalized measure of strength. In general, the color map in Figures 1 and 2 are unconventional and needs to be justified better. It is hard to judge how strong the responses are overall, and what the differences between cell types mean.</p><p>With respect to questions about effect size: reviewers asked whether the small numbers throughout Figure 1B are significant, and pointed out that some of these cells appear to be barely responsive. Reviewers were surprised about the seemingly tiny responses in Figure 2O and P, and questioned whether this can be a meaningful code for direction? What do these magnitudes mean in terms of spike numbers?</p><p>5) Averaging across the raw magnitudes in Figure 2 across neurons could be a highly insensitive analysis and lead to conclusions that are dominated by a few neurons with high baseline firing rates. A standard way to analyze this kind of data would be to normalize the responses per neurons by for example dividing by the number of baseline events. Further why are the response magnitudes in Figure 2 not normalized as in Figure 1B?</p><p>6) Figure 1C: It appears that no multiple-comparison corrected statistics are provided on the differences in population orientation tuning between different lines. Given that this study is explorative, inferential statistics should be performed to compare mice lines and should be corrected for multiple comparisons (contrasts x cre lines). The text sections, &quot;CUX2 neurons in layer 2/3 showed direction bias toward front-to-back motion at 5% and 10% contrast but not at higher contrasts (Figure 1C);. pyramidal neurons in deeper layers did not 83 have direction bias.&quot; seems not motivated by statistics. A statistical test should be provided for the difference between low and high contrasts. Furthermore, the statistical difference between superficial layer and deep layer is suggested by the text, but appears to be never explicitly tested. The authors should carefully check that all of their claims on differences between groups or conditions are supported by multiple-comparison corrected statistics. A general problem in this study is that claims on differences between lines are made, but never made explicit through testing. An example is the description: &quot;79: Contrast preference among pyramidal neurons systematically varied across cortical layers, exhibiting a progression from a mixture of low and high contrast-preferring neurons in layer 2/3 to almost exclusively high contrast-preferring neurons in layers 5 and 6 (Figure 1F, G).&quot; The claim of differences among cell lines should be substantiated with statistics that test whether the different mouse lines are significantly different (the unit of analysis should be the mouse).</p><p>7) Claims on interactions between variables</p><p>Claims about the interactions between variables needs to be demonstrated by statistics. In principal cells, direction tuning is canonically thought to be largely invariant to contrast tuning. The authors should explicitly analyse whether the direction tuning for VIP interneurons is invariant to contrast, and whether the front-to-back preference is indeed specific for low contrast (as the authors suggest) – i.e. test against the alternative that contrast simply gain-modulates the direction tuning. A similar question pertains to the interaction between locomotion and direction tuning. The manuscript description of Figure 2 suggests an interaction between the Locomotion/Stationary variable with contrast and direction tuning. However this does not appear to be statistically quantified, and that it is possible that contrast tuning curves are modulated in a multiplicative way (i.e. invariant to locomotion). A similar comment pertains to, &quot;This analysis demonstrates a substantial enhancement of responses to low contrast visual stimuli during locomotion that is specific to layer 2/3 pyramidal neurons and VIP neurons.&quot; There could be a general multiplicative increase in firing across cell lines and contrasts, and Figure 2 does not demonstrate that low contrast visual stimuli are enhanced specifically during locomotion.</p><p>8) Imaging depths and layers</p><p>The authors need to carefully check their depths and laminar assignments and update the text on this. The authors should more carefully discuss in the manuscript what type of SSt and VIP cells were imaged and discuss the implications of interneuron heterogeneity. Is there any particular reason the mice from SSt-Cre mouse line were imaged in layer 4 as stated in the Materials and methods? As the authors know, dendrite-targeting Martinotti cells are more likely to be found in Layers 2/3 and 5 (Munoz et al., 2017, Science), and the Agmon Lab found that SSt-expressing neurons from layer 4 barrel cortex had unique and different electrophysiological properties from other SSt neurons (Ma et al., 2006, J.Neurosci). If indeed, this is the only imaging plane used for in the SSt-Cre mouse line, how come the authors describe the activity of SSt neurons in layers 2/3 (main text, fourth paragraph)? Similarly for layer 4 VIP cells activity (same lines). Generally there is a bit of confusion with the reported imaging depths and the authors should comment on this. In particular the laminar assignment of the SSt neurons to be clarified. According to the depth 275 micrometer one would say these are layer 2/3, but the authors write layer 4. In general, the laminar assignment based on depth should be justified if it is not based on a layer-specific mouse line.</p><p>9) Generalizability</p><p>Due to the focus on very specific stimuli, the scope of the study is limited and the results do maybe not generalize beyond large drifting gratings. For instance, it is unclear whether these findings will hold up for smaller stimuli. Other stimulus parameters are not explored systematically (spatial frequency or temporal frequency). Stimulus size is ignored, even though stimulus size could have dramatic effects on the findings presented here. The authors need to discuss these limitations in the manuscript. In particular they should comment on the issue of size tuning, which is missing in the manuscript. Previous studies have shown a very clear size dependence of VIP and SSt neurons (Adesnik and Scanziani, 2012; DiPoppa et al., 2018). The contrast dependence of the VIP and SSt neurons is likely strongly dependent on stimulus size. For instance VIP neurons have small receptive fields (DiPoppa et al., 2018). Because surround modulation is contrast dependent, suppression of PC L2/3 cell activity and VIP activity likely depends on the stimulus size. The authors to discuss these limitations.</p><p>10) Interpretation of SSt direction tuning and VIP suppression</p><p>The authors should discuss the interpretation of some of the main effects. In particular, reviewers wondered why VIP neurons are suppressed at high contrast? They also wondered why the response of SST neurons at low contrast is not direction modulated – given that the VIP neurons have strong direction tuning? Do VIP interneurons indeed suppress the SSt neurons recorded here? This assumption is being made but it is never tested or argued for these specific laminar recordings from the literature.</p><p>11) Optic Flow</p><p>The interpretation of optic flow appears to be problematic and needs to be discussed. The authors interpret their data in terms of optic flow related to locomotion. However, the peak of VIP neurons occurs at 45 degrees rather than 0 degrees, but the authors write that 0 degrees corresponds to front-to-back motion (main text, second paragraph). Does the interpretation of the authors make sense given this discrepancy?</p><p>12) Modelling:</p><p>There are major concerns about parameter and model selection. Several findings hard to account for with the model. The description of the model needs to be substantially improved. The tuning of VIP cells in 3b is much wider than that observed in the data (1b), and this could be a major problem for the model. The authors should explain this. The authors should make a better effort to explain the model better in the text. For the modelling, authors need to provide more explanation on why SSNs were selected, and how they work etc. In the current version of the paper, it is necessary to refer to the very difficult Rubin et al., 2015 paper to understand what the model does. Also, reviewers would like to see that the canonical results from Rubin et al. still work in the revised model, and commented that this is an essential addition to the paper. The authors should include a discussion of the process of parameter selection for the model (how much fine tuning was required, what happens when connection weights deviate somewhat etc). In general, the scope of the model to be somewhat limited given that model parameters are not systematically explored or fitted based on the data. Further, the model makes strong assumptions on the inputs that these different neuron types presumably receive from external drive. These limitations need to be discussed. The main text to be improved with a more in-depth explanation for using SSNs (stabilized supra-linear network). Finally, rectified quadratic response functions for neurons are not common in RNNs, and should be motivated. Also, no explanation/citation is provided for the choice of parameters (input, connections) for PV neurons.</p><p>With respect to the conclusion – &quot;These results indicate that Vip-mediated disinhibition is capable of producing substantial increases in gain at low contrast despite low activity of the intermediate SST neuron population.&quot; The authors should explain why this is not a circular argument and a strange way to summarize the results of the model. Reviewers pointed out that it is clear from Figure 3D that the suppression of Sst activity by Vip neurons at low contrast is what enables supra-linear responses of Cux2 neurons at low contrast.</p><p>The bias of direction tuning in L2/3 neurons is very weak. How can the authors account for the contrast enhancement of these neurons in their VIP model? Should this enhancement not be extremely specific to the 45 degrees angle?</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.55130.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>The reviewers raise a number of concerns that must be adequately addressed before the paper can be accepted. Some of the required revisions will require further data analysis.</p><p>1) Data representation and interpretation of calcium signals</p><p>The data shown are highly overprocessed. The authors should include raw data traces and images, and describe their methods comprehensively in the paper. Data in Figure 1 should be shown with proper normalization (percent change) as well as raw data, and not as percentiles. While the authors use an established &quot;pipeline&quot; for data collection, they should include raw calcium imaging traces and images (at least in the Materials and methods), They should describe their methods comprehensively in the paper. The paper should be self-contained, and the authors should provide a representation of how fluorescence images were converted into the color maps in Figure 1. Inclusion of raw data is necessary for readers to get a sense of what is measured and possible caveats. For example, it could be possible that VIP neurons have saturating response at high contrast and the calcium does not decrease to baseline between trials, resulting in what looks like a suppressed response. A further consideration is the fact that imaging depths vary throughout the manuscript, and GABAergic neuronal activity can be substantially higher than pyramidal cell activity, which should have a &quot;smoothing&quot; impact on calcium traces. The authors should better explain how they took this into consideration in their estimation of various metrics.</p></disp-quote><p>We have made several, substantial changes to the main text, Materials and methods section, and figures to address these points. Together, we believe that these additions will resolve these issues.</p><p>– The revised manuscript includes a new Figure 1 that shows fluorescence traces for four example neurons, of the key Cre lines, as well as stepwise transformations to “events” in the fluorescence traces and, finally, stimulus response magnitudes and tuning curves.</p><p>– We changed the normalization used in Figure 2B (previously Figure 1B), which we discuss further in our response to point 4 below.</p><p>– We have expanded the description of the processing of calcium imaging data in the Materials and methods section to make this paper self-contained.</p><p>– We have added additional detail on the imaging depths in the Materials and methods section and have carefully documented the imaged layer in the text and figures. See our reply to point 8 below for an extended discussion of imaging depths.</p><p>– We show that the fluorescence traces of VIP neurons are substantially suppressed in response to high contrast gratings, not saturated, in Figure 2—figure supplement 2. Therefore, the suppression of VIP responses as measured in events does not result from fluorescence saturation during high contrast grating presentations.</p><p>– As can be seen in the example dF/F traces in Figure 1, we observe clear calcium transients for inhibitory interneurons that are not substantially “smoother” than those of excitatory neurons. We are aware that the high spike rates and calcium buffering in PV+ interneurons can lead to highly smoothed traces, but that does not appear to be the case for the VIP and SST interneurons imaged in this study.</p><p>Based on this, we do not believe that our conclusions based on the tuning metrics we calculate (e.g. DSI, gOSI, etc.) are likely to be impacted by higher spontaneous rates of interneurons.</p><disp-quote content-type="editor-comment"><p>The authors should further motivate why data was averaged over running and stationary trials in Figure 1.</p></disp-quote><p>The motivation for this study was to investigate the influence of stimulus contrast and direction on neuron responses across Cre lines and layers. The findings regarding contrast and direction tuning described in Figure 2 (previously Figure 1) which is already a very dense full-page figure, motivate further examination of locomotion. Therefore, we address the influence of locomotion on contrast and direction tuning in the subsequent two figures. In particular, related to reviewers’ point 7 below, we have added a Generalized Linear Model analysis to specifically address the relationship between locomotion and stimulus direction and contrast.</p><disp-quote content-type="editor-comment"><p>2) Authors should discuss how GCaMP signals relate to spikes across different cell types (for example see Khan et al., Nat Nsci 2018, Figure 2E and Supplementary Figure 6, where a comparison is made with calcium imaging and extracellular recording in Vip, PV and Sst neurons) (and Huang et al-Biorxiv).</p></disp-quote><p>Khan et al., 2018, show that the relationship between DF/F transients and spikes, for combined loose path and 2P recordings in cortical slices, using injected GCaMP6 and imaged at an unknown magnification. These show that VIP and SST neurons exhibit the same relationship between DF/F and spikes, while the slope of that relationship is different for PV neurons.</p><p>Huang et al., 2019, shows the relationship between multiple excitatory Cre lines in layer 2/3. The paper focuses mostly on differences between GCaMP6s and GCaMP6f, comparing transgenically expressed GCaMP with data for virally expressed GCaMP6 from Chen et al. The different Cre lines used for GCaMP6f (the reporter used in our study) are Cux2-CreERT2 (which we use) and Emx1-IRES-Cre. Within layer 2/3, these are both considered to be pan-excitatory, and the results in Huang et al. reveal that they show the same relationship as each other between spikes and DF/F amplitude.</p><p>Further, as Huang et al., 2019, alludes to, and is further examined in Ledochowitsch et al., 2019, the spatial and temporal imaging resolution is a critical parameter in this relationship. The analysis in Ledochowitsch et al., 2019, approximates the imaging resolutions used in our study, but again only considers two pan-excitatory Cre lines within layer 2/3.</p><p>Since the two studies use different imaging paradigms (slice vs. in vivo, unknown magnifications, etc.), we are unable to meaningfully compare the data in Khan et al. with Huang et al. Further, neither dataset speaks to potential differences in the relationship of spikes and DF/F between the VIP and SST inhibitory populations and pyramidal neurons, or between different pyramidal Cre lines at different imaging depths. As these are the questions we believe the reviewers are asking, and are most relevant to this study, it is unclear how we can address this without doing a separate study on this specific issue. While we agree that this is an important question for the field, it is beyond the scope of this paper.</p><disp-quote content-type="editor-comment"><p>3) It is unclear why the authors used Cre lines to image different pyramidal neuron populations, along with imaging at different depths. A possible reason could be to avoid contamination from dendrites of neurons in different layers. If this is the reason it should be stated in the paper.</p></disp-quote><p>The reviewers are precisely correct that the Cre lines were used in order to target neurons in specific layers without contamination from processes of neurons in different layers. We have now stated this point in the second paragraph of the main text.</p><disp-quote content-type="editor-comment"><p>In addition, they asked for something to be said about the idiosyncrasies of the cre lines in light of recent scRNAseq data.</p></disp-quote><p>Extended Figure 8 of Tasic et al., 2018, provides a summary table of the correspondence between Cre lines (including all 6 used here) and transcriptomic neuron subtypes. We have now discussed the transcriptomic types labeled by the Cre lines used in this study in the Materials and methods under the “Experimental Animals” section (second paragraph) and discuss the potential relationships between transcriptomic types and contrast tuning in the sixth paragraph of the main text. Briefly, scRNA-seq data has shown that the Vip-Cre and Sst-Cre lines provide broad coverage of VIP and SST neuron transcriptomic subtypes (16 and 21 subtypes). In layer 2/3, Cux2-CreERT2 labels all three excitatory neuron transcriptomic subtypes. Layer 4 contains only a single transcriptomic neuron type, which is sampled by the Rorb-Cre line. Rbp4-Cre_KL100 labels all twelve layer 5 neuron transcriptomic subtypes. Ntsr1-Cre labels all six layer 6 corticothalamic neuron transcriptomic subtypes.</p><disp-quote content-type="editor-comment"><p>4) Response percentiles in Figure 1B are reported, but these are never corrected for the many multiple comparisons, such that the significance is merely a normalized measure of strength. However percentiles are deceiving because they hide the amplitude of the responses. Data should be represented as percent change to obtain an idea about the effect sizes shown in this study, because a small effect might correspond to a large normalized measure of strength. In general, the color map in Figures 1 and 2 are unconventional and needs to be justified better. It is hard to judge how strong the responses are overall, and what the differences between cell types mean.</p></disp-quote><p>We understand that the metric we had used, the percentile of the response in a bootstrapped distribution, was a source of confusion. The motivation behind this normalization is analogous to z-scoring the responses, with the additional step of generating a baseline distribution through bootstrapping rather than assuming a normal distribution since the responses with calcium imaging are non-Gaussian and highly skewed. Given the confusion, however, we have followed the reviewers’ suggestion and changed the metric to be fractional change.</p><p>The color map used is “RdBu” for the Matplotlib python package. We chose this color map specifically because it is perceptually uniform.</p><disp-quote content-type="editor-comment"><p>With respect to questions about effect size: reviewers asked whether the small numbers throughout Figure 1B are significant, and pointed out that some of these cells appear to be barely responsive. Reviewers were surprised about the seemingly tiny responses in Figure 2-0 and P, and questioned whether this can be a meaningful code for direction? What do these magnitudes mean in terms of spike numbers?</p></disp-quote><p>Note that this figure shows population average responses. The panels in question are for pyramidal neurons which have narrow direction tuning (relative to SST neurons) and varied peak directions. Therefore, we expect the response strength <italic>averaged over neurons</italic> to any direction in particular to be small. Also, we suspect that the potentially unfamiliar units we used (event magnitude per frame) led to the interpretation that the responses were very small. We have changed the units to “event magnitude per second” and show it as a percent rather than fraction. The relationship between these response magnitudes and the calcium fluorescence traces is now illustrated for example neurons in a new Figure 1.</p><disp-quote content-type="editor-comment"><p>5) Averaging across the raw magnitudes in Figure 2 across neurons could be a highly insensitive analysis and lead to conclusions that are dominated by a few neurons with high baseline firing rates. A standard way to analyze this kind of data would be to normalize the responses per neurons by for example dividing by the number of baseline events.</p></disp-quote><p>We have added a new supplementary figure (Figure 3—figure supplement 1) in which we show the full distribution of single neuron response magnitudes as well as box plots to show the quartiles of the distributions.</p><disp-quote content-type="editor-comment"><p>Further why are the response magnitudes in Figure 2 not normalized as in Figure 1B?</p></disp-quote><p>The normalization in Figure 2B (previously Figure 1B) has changed in response to point 4.</p><disp-quote content-type="editor-comment"><p>6) Figure 1C: It appears that no multiple-comparison corrected statistics are provided on the differences in population orientation tuning between different lines. Given that this study is explorative, inferential statistics should be performed to compare mice lines and should be corrected for multiple comparisons (contrasts x cre lines). The text sections, &quot;CUX2 neurons in layer 2/3 showed direction bias toward front-to-back motion at 5% and 10% contrast but not at higher contrasts (Figure 1C);. pyramidal neurons in deeper layers did not 83 have direction bias.&quot; seems not motivated by statistics. A statistical test should be provided for the difference between low and high contrasts.</p></disp-quote><p>The 95% confidence intervals shown in Figure 2C (previously Figure 1C) are now corrected for multiple comparisons and the figure legend has been updated to reflect this change.</p><disp-quote content-type="editor-comment"><p>Furthermore, the statistical difference between superficial layer and deep layer is suggested by the text, but appears to be never explicitly tested. The authors should carefully check that all of their claims on differences between groups or conditions are supported by multiple-comparison corrected statistics. A general problem in this study is that claims on differences between lines are made, but never made explicit through testing. An example is the description: &quot;79: Contrast preference among pyramidal neurons systematically varied across cortical layers, exhibiting a progression from a mixture of low and high contrast-preferring neurons in layer 2/3 to almost exclusively high contrast-preferring neurons in layers 5 and 6 (Figure 1F, G).&quot; The claim of differences among cell lines should be substantiated with statistics that test whether the different mouse lines are significantly different (the unit of analysis should be the mouse).</p></disp-quote><p>The revised manuscript includes a new Figure 2E that shows the results of new statistical analysis of contrast tuning across Cre lines and layers. In this panel, we show bootstrapped confidence intervals on the fractions of low contrast preferring neurons and high contrast preferring neurons as well as pairwise tests between the fractions of low contrast preferring pyramidal neurons across layers. We use the mouse as the unit of analysis and bootstrapping.</p><disp-quote content-type="editor-comment"><p>7) Claims on interactions between variables</p><p>Claims about the interactions between variables needs to be demonstrated by statistics. In principal cells, direction tuning is canonically thought to be largely invariant to contrast tuning. The authors should explicitly analyse whether the direction tuning for VIP interneurons is invariant to contrast, and whether the front-to-back preference is indeed specific for low contrast (as the authors suggest) – i.e. test against the alternative that contrast simply gain-modulates the direction tuning. A similar question pertains to the interaction between locomotion and direction tuning. The manuscript description of Figure 2 suggests an interaction between the Locomotion/Stationary variable with contrast and direction tuning. However this does not appear to be statistically quantified, and that it is possible that contrast tuning curves are modulated in a multiplicative way (i.e. invariant to locomotion). A similar comment pertains to, &quot;This analysis demonstrates a substantial enhancement of responses to low contrast visual stimuli during locomotion that is specific to layer 2/3 pyramidal neurons and VIP neurons.&quot; There could be a general multiplicative increase in firing across cell lines and contrasts, and Figure 2 does not demonstrate that low contrast visual stimuli are enhanced specifically during locomotion.</p></disp-quote><p>The revised manuscript includes a new section and Figure 4 in which we model responses of VIP, SST, and L2/3 pyramidal neurons with a Generalized Linear Model to investigate the contribution of stimulus direction, stimulus contrast, running, and the interactions between these terms. We did not find strong interactions between stimulus direction and contrast for any neuron type, but we did find significant interactions between running and stimulus contrast as well as running and stimulus direction. We have edited the text of the manuscript to more precisely describe the interactions among these variables.</p><disp-quote content-type="editor-comment"><p>8) Imaging depths and layers</p><p>The authors need to carefully check their depths and laminar assignments and update the text on this. The authors should more carefully discuss in the manuscript what type of SSt and VIP cells were imaged and discuss the implications of interneuron heterogeneity. Is there any particular reason the mice from SSt-Cre mouse line were imaged in layer 4 as stated in the Materials and methods? As the authors know, dendrite-targeting Martinotti cells are more likely to be found in Layers 2/3 and 5 (Munoz et al., 2017, Science), and the Agmon Lab found that SSt-expressing neurons from layer 4 barrel cortex had unique and different electrophysiological properties from other SSt neurons (Ma et al., 2006, J.Neurosci). If indeed, this is the only imaging plane used for in the SSt-Cre mouse line, how come the authors describe the activity of SSt neurons in layers 2/3 (main text, fourth paragraph)? Similarly for layer 4 VIP cells activity (same lines). Generally there is a bit of confusion with the reported imaging depths and the authors should comment on this. In particular the laminar assignment of the SSt neurons to be clarified. According to the depth 275 micrometer one would say these are layer 2/3, but the authors write layer 4. In general, the laminar assignment based on depth should be justified if it is not based on a layer-specific mouse line.</p></disp-quote><p>The cranial window used for 2P imaging put pressure on the brain, and results in a compression of the cortical layers. The cortical thickness is compressed to ~700um, and the compression is not consistent across layers, such that, for example, layer 5 shows more compression and layer 4 shows less compression, on average (see de Vries, Lecoq, Buice et al. Supplementary Figure 12D and E). Based on this compression, as well as the density of neurons labeled by layer 4 specific excitatory Cre lines (e.g. Rorb, Scnn1a), we estimate that layer 4 begins at ~250um, and layer 5 begins at ~375 um, below surface.</p><p>The inhibitory neurons were imaged where they are most densely labeled. For VIP, this is shallower than for SST which we find to be densest at 275-375 μm below the surface. Based on our depth estimate, this puts the SST somata in layer 4, while the VIP neurons that are densest at ~175 μm are in layer 2/3. We believe, related to lines 96-98, that ambiguous wording led to the misinterpretation that VIP and SST neurons were imaged in both layers 2/3 and 4 – this wording has now been changed to clarify that <italic>pyramidal neurons</italic> were imaged in layers 2/3 and 4.</p><p>Although the referees are correct to point out that some properties of layer 4 SST neurons differ from SST neurons in other layers in barrel cortex, recent work finds a clear difference between mouse V1 and S1 – in particular that the vast majority of layer 4 SST neurons in V1 are Martinotti cells (Scala et al., 2019, now stated and cited in the second paragraph of the main text). Furthermore, all of the L4 SST neurons in our study prefer high contrast and have weak direction selectivity, suggesting that these properties are very likely to apply to the subset of L4 SST neurons that are Martinotti cells. Finally, we have also observed in previous work (de Vries et al., 2020) robust reliable responses to high contrast full-field drifting gratings for SST neurons in both layers 4 and 5, suggesting that at least this aspect of SST neuron tuning in layer 4 is not different from layer 5.</p><disp-quote content-type="editor-comment"><p>9) Generalizability</p><p>Due to the focus on very specific stimuli, the scope of the study is limited and the results do maybe not generalize beyond large drifting gratings. For instance, it is unclear whether these findings will hold up for smaller stimuli. Other stimulus parameters are not explored systematically (spatial frequency or temporal frequency). Stimulus size is ignored, even though stimulus size could have dramatic effects on the findings presented here. The authors need to discuss these limitations in the manuscript. In particular they should comment on the issue of size tuning, which is missing in the manuscript. Previous studies have shown a very clear size dependence of VIP and SSt neurons (Adesnik and Scanziani, 2012; DiPoppa et al., 2018). The contrast dependence of the VIP and SSt neurons is likely strongly dependent on stimulus size. For instance VIP neurons have small receptive fields (DiPoppa et al., 2018). Because surround modulation is contrast dependent, suppression of PC L2/3 cell activity and VIP activity likely depends on the stimulus size. The authors to discuss these limitations.</p></disp-quote><p>Although we have not explored spatial or temporal frequency in this study, we note that suppression of VIP neurons by high-contrast large gratings has been observed across spatial and temporal frequencies (de Vries et al., 2020). For size tuning, we explicitly address this question in the final paragraph with the sentences, “Measurements of size tuning have shown that SST neurons prefer large gratings, suggestive of a role mediating surround suppression, whereas VIP neurons only respond to gratings smaller than those that drive SST neurons. This complementary size tuning parallels the complementary contrast tuning observed here, suggesting that VIP and SST neurons in V1 are tuned for weak and strong inputs, respectively, across multiple stimulus dimensions.” Following those sentences, we also now point to our previous finding that VIP neuron receptive fields as measured with sparse noise stimuli are <italic>largerthan</italic> those of SST and pyramidal neurons (de Vries et al., 2020). This result shows that the relatively small size tuning of VIP neurons does not arise simply from having small linear receptive fields; instead, we believe that VIP neurons have small size tuning due to the weaker stimulus energy of small versus large features. We certainly agree with the reviewers’ point that both size and contrast contribute to VIP and SST responses. Our discussion acknowledges this point and goes further to propose that the parsimonious explanation is that both size and contrast determine the <italic>strength of input</italic> to the cortical circuit which is the determining factor.</p><disp-quote content-type="editor-comment"><p>10) Interpretation of SSt direction tuning and VIP suppression</p><p>The authors should discuss the interpretation of some of the main effects. In particular, reviewers wondered why VIP neurons are suppressed at high contrast?</p></disp-quote><p>We have added a discussion of this point in the seventh paragraph of the main text. Given that VIP neurons have the highest spontaneous activity among the neuron types sampled here (Figure 3; see also Extended Data Figure 1 in de Vries et al., 2020), one possibility is that VIP neurons simply have non-zero spontaneous activity whereas the other neuron types are already close to zero making suppression impossible. Another, related possibility is that suppression of other neuron types <italic>occurs but goes undetected</italic> because both the suppressed and non-suppressed activity levels are below the detection threshold of calcium imaging. Functionally, the high spontaneous activity of VIP neurons enables the cortical circuit to raise or lower the amount of disinhibition of pyramidal neurons depending on stimulus contrast. Our SSN modeling results demonstrate that suppression of VIP neurons below baseline helps the network to maintain stability in response to strong external inputs.</p><disp-quote content-type="editor-comment"><p>They also wondered why the response of SST neurons at low contrast is not direction modulated – given that the VIP neurons have strong direction tuning?</p></disp-quote><p>This is a very interesting question. Note that the SST neurons have a bias toward zero degrees at contrasts greater than 20% whereas SST neurons have weak or no response to any direction at contrasts less than or equal to 20%. One possibility is that SST neurons would also respond to zero degrees at low contrast in the absence of inhibition from VIP neurons. Another possibility is that the responses of SST neurons are simply too small at low contrast to detect direction tuning.</p><disp-quote content-type="editor-comment"><p>Do VIP interneurons indeed suppress the SSt neurons recorded here? This assumption is being made but it is never tested or argued for these specific laminar recordings from the literature.</p></disp-quote><p>Layer 4 SST neurons in V1 are mostly, but not entirely, Martinotti cells (Scala et al., 2019). Although we cannot be certain which of the SST neurons that we recorded are Martinotti cells, the tuning curves of all of the SST neurons look very similar suggesting that our findings apply to Martinotti cells and possibly also non-Martinotti SST neurons. We have added a statement to the main text clarifying this distinction between subtypes of SST neurons and motivating the imaging of Sst mice in layer 4.</p><disp-quote content-type="editor-comment"><p>11) Optic Flow</p><p>The interpretation of optic flow appears to be problematic and needs to be discussed. The authors interpret their data in terms of optic flow related to locomotion. However, the peak of VIP neurons occurs at 45 degrees rather than 0 degrees, but the authors write that 0 degrees corresponds to front-to-back motion (main text, second paragraph). Does the interpretation of the authors make sense given this discrepancy?</p></disp-quote><p>We do not believe that the discrepancy is large enough to warrant an interpretation that the mice perceive the direction of motion to be substantially different from front-to-back. First, the peak of VIP neurons is fairly centered between 0 and 45 degrees (new Figure 3D), suggesting a more modest discrepancy of 20 to 25 degrees. Second, our imaging experiments were performed on head-fixed mice that were standing on a wheel that permits them to run in place. The running wheel is angled slightly upward a few degrees to facilitate running during head-fixation which might also influence the mouse’s perception of egocentric angle of visual motion.</p><disp-quote content-type="editor-comment"><p>12) Modelling:</p><p>There are major concerns about parameter and model selection. Several findings hard to account for with the model. The description of the model needs to be substantially improved.</p></disp-quote><p>These points are addressed where they are raised in detail below.</p><disp-quote content-type="editor-comment"><p>The tuning of VIP cells in 3b is much wider than that observed in the data (1b), and this could be a major problem for the model. The authors should explain this.</p></disp-quote><p>Figure 5B (previously Figure 3B) shows the tuning of pyramidal to VIP connections. Perhaps this comment was intended to refer to Figure 5C (previously Figure 3C) which shows the direction (and contrast) tuning of VIP neuron activity. The tuning of the VIP responses in the SSN shown in Figure 5C (previously Figure 3C) are on the order of 10 to 20 degrees, which is not much wider than the tuning of VIP neurons in mouse V1 shown in Figure 2 (previously Figure 1). Our experiments measured direction responses at increments of 45 degrees and we do not claim that the width of direction tuning for VIP neurons is substantially narrower than this sampling permits us to discern.</p><disp-quote content-type="editor-comment"><p>The authors should make a better effort to explain the model better in the text. For the modelling, authors need to provide more explanation on why SSNs were selected, and how they work etc. In the current version of the paper, it is necessary to refer to the very difficult Rubin et al., 2015 paper to understand what the model does.</p></disp-quote><p>The revised manuscript has a more thorough motivation and introduction to SSNs. In brief, SSNs were selected because a few universal features of cortical circuits (e.g. recurrent excitation, feedback inhibition, and supralinear f-I curves) can account for a wide variety of contrast-dependent phenomenology (Rubin et al., 2015) in addition to a variety of other phenomenology that we now state and cite.</p><disp-quote content-type="editor-comment"><p>Also, reviewers would like to see that the canonical results from Rubin et al. still work in the revised model, and commented that this is an essential addition to the paper.</p></disp-quote><p>In addition to further exploration of network behavior across model parameters (see next point), we have added a section (main text) and Figure 5G-L on the analysis of the inhibitory stabilization behavior of the network as a function of the model parameters. Specifically, we performed linear stability analysis of the excitatory portion of the network (by computing the eigenvalues of the excitatory-to-excitatory submatrix of the Jacobian for the linearized network dynamics; full details in the Materials and methods section) to determine whether or not the steady state firing rates of the network would be stable in the absence of feedback inhibition. In other words, this analysis shows whether the network is inhibitory stabilized or not inhibitory stabilized. It is possible that achieving a high gain makes the recurrent excitation unstable, requiring strong inhibitory stabilization to prevent runaway excitation. Surprisingly, we found that high gain at low contrast effect due to VIP neurons does not require the network to be in an inhibitory stabilized regime.</p><disp-quote content-type="editor-comment"><p>The authors should include a discussion of the process of parameter selection for the model (how much fine tuning was required, what happens when connection weights deviate somewhat etc). In general, the scope of the model to be somewhat limited given that model parameters are not systematically explored or fitted based on the data.</p></disp-quote><p>The revised manuscript includes a wider exploration of model parameters which has yielded additional insights into the behavior of the model. In particular, we have examined the network dynamics as a function of two crucial parameters: 1) the strength of the VIP to SST connection (Figure 5G-I and main text) and 2) the relative amount of inhibition that pyramidal neurons receive from PV versus SST neurons (Figure 5J-L and main text). We show in Figure 5 (previously Figure 3) that our main findings (specifically, increased gain at low contrast due to VIP neurons) hold across a wide range of values for these parameters as well as how the magnitude of the gain effect varies with these parameters.</p><disp-quote content-type="editor-comment"><p>Further, the model makes strong assumptions on the inputs that these different neuron types presumably receive from external drive. These limitations need to be discussed.</p></disp-quote><p>Correct, our model assumes that pyramidal and PV neurons receive direct external (e.g. thalamic) input whereas VIP and SST neurons do not. The lack of direct thalamocortical input to SST neurons (and confirmation of direct thalamocortical input to pyramidal and fast-spiking putative PV neurons) has been observed in mouse somatosensory cortex (Cruikshank et al., 2010). While we also assume that VIP neurons do not receive direct external input, the responses of VIP neurons to weak stimuli would be expected to increase if this additional excitatory input to VIP neurons were added to the model; therefore, our assumption of no direct external input to VIP neurons is conservative in relation to our main conclusion. We have now elaborated on this reasoning in the eleventh paragraph of the main text.</p><disp-quote content-type="editor-comment"><p>The main text to be improved with a more in-depth explanation for using SSNs (stabilized supra-linear network).</p></disp-quote><p>Again, the revised manuscript has a more thorough motivation and introduction to SSNs.</p><disp-quote content-type="editor-comment"><p>Finally, rectified quadratic response functions for neurons are not common in RNNs, and should be motivated.</p></disp-quote><p>Rectified quadratic single neuron transfer functions have been used in previous studies of SSNs (Ahmadian et al., 2013, Rubin et al., 2015) for simplicity of mathematical analysis (e.g. the derivative of x<sup>2</sup> is simply 2x) while still having the supralinear property. We use the same single neuron transfer function to maintain consistency with the existing SSN literature.</p><disp-quote content-type="editor-comment"><p>Also, no explanation/citation is provided for the choice of parameters (input, connections) for PV neurons.</p></disp-quote><p>We thank the reviewer’s for pointing out that a citation was not provided. We have now cited work that found the orientation tuning of PV neurons to be broad (Kerlin et al., 2010) in the eleventh paragraph of the main text.</p><disp-quote content-type="editor-comment"><p>With respect to the conclusion – &quot;These results indicate that Vip-mediated disinhibition is capable of producing substantial increases in gain at low contrast despite low activity of the intermediate SST neuron population.&quot; The authors should explain why this is not a circular argument and a strange way to summarize the results of the model. Reviewers pointed out that it is clear from Figure 3D that the suppression of Sst activity by Vip neurons at low contrast is what enables supra-linear responses of Cux2 neurons at low contrast.</p></disp-quote><p>SST neurons have very weak responses to low contrast gratings. One might (mistakenly) conclude that even full suppression of a small amount of SST activity can only result in a small increase in pyramidal neuron activity. Our intention with this sentence was to emphasize that, due to recurrent excitation and supralinear single neuron transfer functions, the suppression of a relatively <italic>small</italic> amount of SST neuron activity can drive <italic>large</italic> increases in pyramidal neuron activity. We have now elaborated this reasoning in the tenth and twelfth paragraphs of the main text.</p><disp-quote content-type="editor-comment"><p>The bias of direction tuning in L2/3 neurons is very weak. How can the authors account for the contrast enhancement of these neurons in their VIP model? Should this enhancement not be extremely specific to the 45 degrees angle?</p></disp-quote><p>Approximately half of the L2/3 pyramidal neurons are low contrast preferring (Figure 2E) whereas the over-representation of 0 and 45 degrees-preferring L2/3 pyramidal neurons is relatively small. Our measurements of VIP neuron contrast and direction tuning is consistent with the hypothesis that VIP neurons can cause a larger over-representation based on (low) contrast preference than (front-to-back) direction preference. Indeed, VIP neuron activity is higher at low contrast than high contrast across all directions (i.e. the suppressed by high contrast effect) <italic>andVIP neuron activity is even higher</italic> for front-to-back motion than other directions of motion at low contrast (Figure 3D). We now discuss this aspect of the model explicitly in the main text.</p></body></sub-article></article>